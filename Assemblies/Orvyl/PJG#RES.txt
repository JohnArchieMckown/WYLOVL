1                        J E S 2  J O B  L O G  --  S Y S T E M  S Y S B  --  N O D E  R L G
0
 09.43.45 JOB05959 ---- MONDAY,    22 MAR 2004 ----
 09.43.45 JOB05959  ICH70001I GG$PJG   LAST ACCESS AT 09:43:38 ON MONDAY, MARCH 22, 2004
 09.43.45 JOB05959  $HASP373 PJG#RES  STARTED - INIT 2    - CLASS E - SYS SYSB
 09.43.45 JOB05959  ***  HCMD      STEP $$QUIET
 09.43.45 JOB05959  PURGE * Q=OUTPUT MULTIPLE
 09.43.45 JOB05959  JOB PJG#RES NOT IN OUTPUT QUEUE
 09.43.46 JOB05959  PJG#RES .$$QUIET .         RC=0008 TapeIO=0000 DiskIO=0000 CPU=  .01s Elapsed=25.27s
 09.43.46 JOB05959  PJG#RES .$CND    .         RC=Zero TapeIO=0000 DiskIO=0002 CPU=  .01s Elapsed=26.31s
 09.43.46 JOB05959  PJG#RES .$UNP    .         RC=Zero TapeIO=0000 DiskIO=0046 CPU=  .06s Elapsed=26.41s
 09.43.56 JOB05959  PJG#RES .ASM     .         RC=Zero TapeIO=0000 DiskIO=0628 CPU= 5.36s Elapsed=26.67s
 09.44.00 JOB05959  PJG#RES .$EDIT   .         RC=Zero TapeIO=0000 DiskIO=0303 CPU= 1.19s Elapsed=36.59s
 09.44.00 JOB05959  PJG#RES  Ended.  Name=Module: RESMAN                 Total CPU= 6.63s Elapsed=25.27s
 09.44.00 JOB05959
 09.44.00 JOB05959  Execution charges   Priority=Standard   Block=Day
 09.44.00 JOB05959
 09.44.00 JOB05959  CPU Usage         122.62          $76.02   Standard Processing Unit Equivalent
 09.44.00 JOB05959                                   =======
 09.44.00 JOB05959                                    $76.02   Total Job execution charge
 09.44.00 JOB05959
 09.44.00 JOB05959  See back separator page for print charges
 09.44.01 JOB05959
 09.44.01 JOB05959  $HASP395 PJG#RES  ENDED  ASM=0
1        1 //PJG#RES  JOB PJG$GG,'Module: RESMAN',TIME=1,MSGCLASS=C                JOB05959
           /*JOBPARM HOLD=OUTPUT,LINES=50,CHARS=TN15,NOTIFY=YES
         2 //       EXEC PURGEOLD
         3 XXPURGEOLD PROC
           XX*
           XX* This proc is maintained by Jim Stosick
           XX*
         4 XX$$QUIET  EXEC PGM=HCMDX,PARM='PURGE * Q=OUTPUT MULTIPLE',
           XX         ACCT=(PURGEOLD,SYS3)
         5 //$CND   EXEC PGM=BILBO,REGION=512K,PARM='RECS=100'
         6 //STEPLIB  DD DSN=WYL.GG.ORV.LINKLIB,DISP=SHR
         7 //SYSPRINT DD SYSOUT=$
         8 //SYSUT1   DD DSN=WYL.GG.PJG.OBJ,DISP=OLD
         9 //SYSUT2   DD DSN=WYL.GG.PJG.OBJ,DISP=OLD
        10 //SYSIN    DD DUMMY
        11 //$UNP   EXEC PGM=WUNPRESS,PARM='NUM'
        12 //SYSPRINT DD SYSOUT=$
        13 //SYSUT1   DD DSN=WYL.GG.ORV.SOURCE(RESMAN),DISP=SHR
        14 //SYSUT2   DD DSN=&&INPUT,DISP=(,PASS),UNIT=SYSDA,
           //            SPACE=(TRK,(25,25),RLSE),DCB=CARD
        15 //ASM    EXEC PGM=ASMA90,REGION=8M,COND=(0,NE,$UNP),
           //            PARM=('SYSPARM(RESMAN),TERM,LANG(EN),OBJ',
           //          'LC(32500),XREF(SHORT),NODECK,NORLD,NODX,NOUS')
           //*STEPLIB  DD DSN=SYS1.SASMMOD1,DISP=SHR
        16 //SYSLIB   DD DSN=SYS3.DUMMYMAC,DISP=SHR,DCB=BLKSIZE=27920
        17 //         DD DSN=WYL.GG.ORV.MACLIB,DISP=SHR
        18 //         DD DSN=WYL.GG.SYS.MACLIB,DISP=SHR
        19 //SYSUT1   DD DSN=&&SYSUT1,UNIT=VIO,DISP=(,DELETE),
           //            SPACE=(4088,(500,250),,CONTIG,ROUND)
        20 //SYSTERM  DD SYSOUT=$
        21 //SYSPRINT DD DSN=&&PRINT,UNIT=SYSDA,DISP=(,PASS),
           //            SPACE=(6650,(250,250),RLSE),
           //            DCB=(BLKSIZE=6650,LRECL=133,RECFM=FB)
        22 //SYSLIN   DD DSN=WYL.GG.PJG.OBJ(RESMAN),DISP=OLD
        23 //SYSUDUMP DD SYSOUT=A
        24 //SYSIN    DD DSN=&&INPUT,DISP=(OLD,DELETE)
        25 //$EDIT  EXEC PGM=ASMEDIT,REGION=1M,
           //            COND=EVEN,PARM='STMT,DATA'
        26 //STEPLIB  DD DSN=WYL.GG.SYS.LINKLIB,DISP=SHR
        27 //ASMOUT   DD DSN=&&PRINT,DISP=(OLD,DELETE)
        28 //SYSPRINT DD SYSOUT=A
        29 //SYSUDUMP DD SYSOUT=A
1 STMT NO. MESSAGE
         2 IEFC001I PROCEDURE PURGEOLD WAS EXPANDED USING SYSTEM LIBRARY SYS3.BETAPROC
        14 IGD01010I STORCLAS= TEMP STORGROUP =
        14 IGD01010I STORGRP=VIO ASSIGNED.
        19 IGD01010I STORCLAS= TEMP STORGROUP =
        19 IGD01010I STORGRP=VIO ASSIGNED.
        21 IGD01010I STORCLAS= TEMP STORGROUP =
        21 IGD01010I STORGRP=VIO ASSIGNED.
 ICH70001I GG$PJG   LAST ACCESS AT 09:43:38 ON MONDAY, MARCH 22, 2004
 IEF142I PJG#RES $$QUIET - STEP WAS EXECUTED - COND CODE 0008
 *********************************************************************************
 *   PJG#RES /$$QUIET /                    Return Code      0008                 *
 *   Region used      260K (16K user + 244K system)                              *
 *   Extended region  9352K (4K user + 9348K system)                             *
 *                                                                               *
 *   Paging              In      Out                                             *
 *   Private <-> Aux      0        0       CPU time (TCB)   00:00:00.01          *
 *   Private <-> Exp      0        0       CPU time (SRB)   00:00:00.00          *
 *   VIO                  0        0       Elapsed time    920:44:07.69          *
 *   Common               0      ---                                             *
 *                                                                               *
 *                                                                               *
 *   CPU Usage          0.18         $0.11  Standard Processing Unit Equivalent  *
 *                                   $0.11  Total Step execution charge          *
 *                                                                               *
 *    I/O count  DDname   Type Addr           I/O count  DDname   Type Addr      *
 *                         *** No I/O for this step ***                          *
 *********************************************************************************
 IEF373I STEP/$$QUIET /START 2004082.0943
 IEF374I STEP/$$QUIET /STOP  2004082.0943 CPU    0MIN 00.01SEC SRB    0MIN 00.00SEC VIRT    16K SYS   244K EXT       4K SYS    9348K
 IEF236I ALLOC. FOR PJG#RES $CND
 IEF237I 0401 ALLOCATED TO STEPLIB
 IEF237I JES2 ALLOCATED TO SYSPRINT
 IEF237I 04DC ALLOCATED TO SYSUT1
 IEF237I 04DC ALLOCATED TO SYSUT2
 IEF237I DMY  ALLOCATED TO SYSIN
 IEF142I PJG#RES $CND - STEP WAS EXECUTED - COND CODE 0000
 IEF285I   WYL.GG.ORV.LINKLIB                           KEPT
 IEF285I   VOL SER NOS= SYSB01.
 IEF285I   GG$PJG.PJG#RES.JOB05959.D0000101.?           SYSOUT
 IEF285I   WYL.GG.PJG.OBJ                               KEPT
 IEF285I   VOL SER NOS= SYSB05.
 IEF285I   WYL.GG.PJG.OBJ                               KEPT
 IEF285I   VOL SER NOS= SYSB05.
 *********************************************************************************
 *   PJG#RES /$CND    /                    Return Code      Zero                 *
 *   Region used      280K (16K user + 264K system)                              *
 *   Extended region  9392K (4K user + 9388K system)                             *
 *                                                                               *
 *   Paging              In      Out                                             *
 *   Private <-> Aux      0        0       CPU time (TCB)   00:00:00.01          *
 *   Private <-> Exp      0        0       CPU time (SRB)   00:00:00.00          *
 *   VIO                  0        0       Elapsed time    920:44:06.65          *
 *   Common               0      ---                                             *
 *                                                                               *
 *                                                                               *
 *   CPU Usage          0.18         $0.11  Standard Processing Unit Equivalent  *
 *                                   $0.11  Total Step execution charge          *
 *                                                                               *
 *    I/O count  DDname   Type Addr           I/O count  DDname   Type Addr      *
 *            2  STEPLIB  Disk 0401                   0  SYSPRINT      ----      *
 *            0  SYSUT1   Disk 04DC                   0  SYSUT2   Disk 04DC      *
 *            0  SYSIN         ----                                              *
 *********************************************************************************
 IEF373I STEP/$CND    /START 2004082.0943
 IEF374I STEP/$CND    /STOP  2004082.0943 CPU    0MIN 00.01SEC SRB    0MIN 00.00SEC VIRT    16K SYS   264K EXT       4K SYS    9388K
 IEF236I ALLOC. FOR PJG#RES $UNP
 IEF237I JES2 ALLOCATED TO SYSPRINT
 IEF237I 0402 ALLOCATED TO SYSUT1
 IGD101I SMS ALLOCATED TO DDNAME (SYSUT2  )
         DSN (SYS04082.T094345.RA000.PJG#RES.INPUT.H01    )
         STORCLAS (TEMP) MGMTCLAS (        ) DATACLAS (        )
         VOL SER NOS= SCR100
 IEF142I PJG#RES $UNP - STEP WAS EXECUTED - COND CODE 0000
 IEF285I   GG$PJG.PJG#RES.JOB05959.D0000102.?           SYSOUT
 IEF285I   WYL.GG.ORV.SOURCE                            KEPT
 IEF285I   VOL SER NOS= SYSB02.
 IGD106I SYS04082.T094345.RA000.PJG#RES.INPUT.H01     PASSED,    DDNAME=SYSUT2
 *********************************************************************************
 *   PJG#RES /$UNP    /                    Return Code      Zero                 *
 *   Region used      380K (108K user + 272K system)                             *
 *   Extended region  9468K (4K user + 9464K system)                             *
 *                                                                               *
 *   Paging              In      Out                                             *
 *   Private <-> Aux      0        0       CPU time (TCB)   00:00:00.06          *
 *   Private <-> Exp      0        0       CPU time (SRB)   00:00:00.00          *
 *   VIO                  0        0       Elapsed time    920:44:06.55          *
 *   Common               0      ---                                             *
 *                                                                               *
 *                                                                               *
 *   CPU Usage          1.12         $0.69  Standard Processing Unit Equivalent  *
 *                                   $0.69  Total Step execution charge          *
 *                                                                               *
 *    I/O count  DDname   Type Addr           I/O count  DDname   Type Addr      *
 *            0  SYSPRINT      ----                   5  SYSUT1   Disk 0402      *
 *           41  SYSUT2   Disk 038B                                              *
 *********************************************************************************
 IEF373I STEP/$UNP    /START 2004082.0943
 IEF374I STEP/$UNP    /STOP  2004082.0943 CPU    0MIN 00.06SEC SRB    0MIN 00.00SEC VIRT   108K SYS   272K EXT       4K SYS    9464K
 IEF236I ALLOC. FOR PJG#RES ASM
 IEF237I 0402 ALLOCATED TO SYSLIB
 IEF237I 0402 ALLOCATED TO
 IEF237I 04DC ALLOCATED TO
 IGD101I SMS ALLOCATED TO DDNAME (SYSUT1  )
         DSN (SYS04082.T094345.RA000.PJG#RES.SYSUT1.H01   )
         STORCLAS (TEMP) MGMTCLAS (        ) DATACLAS (        )
         VOL SER NOS= VIO
 IEF237I JES2 ALLOCATED TO SYSTERM
 IGD101I SMS ALLOCATED TO DDNAME (SYSPRINT)
         DSN (SYS04082.T094345.RA000.PJG#RES.PRINT.H01    )
         STORCLAS (TEMP) MGMTCLAS (        ) DATACLAS (        )
         VOL SER NOS= SCR100
 IEF237I 04DC ALLOCATED TO SYSLIN
 IEF237I JES2 ALLOCATED TO SYSUDUMP
 IGD103I SMS ALLOCATED TO DDNAME SYSIN
 IEF142I PJG#RES ASM - STEP WAS EXECUTED - COND CODE 0000
 IEF285I   SYS3.DUMMYMAC                                KEPT
 IEF285I   VOL SER NOS= SYSB02.
 IEF285I   WYL.GG.ORV.MACLIB                            KEPT
 IEF285I   VOL SER NOS= SYSB02.
 IEF285I   WYL.GG.SYS.MACLIB                            KEPT
 IEF285I   VOL SER NOS= SYSB05.
 IGD105I SYS04082.T094345.RA000.PJG#RES.SYSUT1.H01    DELETED,   DDNAME=SYSUT1
 IEF285I   GG$PJG.PJG#RES.JOB05959.D0000103.?           SYSOUT
 IGD106I SYS04082.T094345.RA000.PJG#RES.PRINT.H01     PASSED,    DDNAME=SYSPRINT
 IEF285I   WYL.GG.PJG.OBJ                               KEPT
 IEF285I   VOL SER NOS= SYSB05.
 IEF285I   GG$PJG.PJG#RES.JOB05959.D0000104.?           SYSOUT
 IGD105I SYS04082.T094345.RA000.PJG#RES.INPUT.H01     DELETED,   DDNAME=SYSIN
 *********************************************************************************
 *   PJG#RES /ASM     /                    Return Code      Zero                 *
 *   Region used      8476K (8192K user + 284K system)                           *
 *   Extended region  9952K (412K user + 9540K system)                           *
 *                                                                               *
 *   Paging              In      Out                                             *
 *   Private <-> Aux      0        0       CPU time (TCB)   00:00:05.30          *
 *   Private <-> Exp      0        0       CPU time (SRB)   00:00:00.06          *
 *   VIO                  0        0       Elapsed time    920:44:06.29          *
 *   Common               0      ---                                             *
 *                                                                               *
 *                                                                               *
 *   CPU Usage         99.37        $61.60  Standard Processing Unit Equivalent  *
 *                                  $61.60  Total Step execution charge          *
 *                                                                               *
 *    I/O count  DDname   Type Addr           I/O count  DDname   Type Addr      *
 *          139  SYSLIB   Disk 0402                   0  SYSLIB   Disk 0402      *
 *          138  SYSLIB   Disk 04DC                   0  SYSUT1   VIO  ----      *
 *            0  SYSTERM       ----                 300  SYSPRINT Disk 038B      *
 *            9  SYSLIN   Disk 04DC                   0  SYSUDUMP      ----      *
 *           42  SYSIN    Disk 038B                                              *
 *********************************************************************************
 IEF373I STEP/ASM     /START 2004082.0943
 IEF374I STEP/ASM     /STOP  2004082.0943 CPU    0MIN 05.30SEC SRB    0MIN 00.06SEC VIRT  8192K SYS   284K EXT     412K SYS    9540K
 IEF236I ALLOC. FOR PJG#RES $EDIT
 IEF237I 0402 ALLOCATED TO STEPLIB
 IGD103I SMS ALLOCATED TO DDNAME ASMOUT
 IEF237I JES2 ALLOCATED TO SYSPRINT
 IEF237I JES2 ALLOCATED TO SYSUDUMP
 IEF142I PJG#RES $EDIT - STEP WAS EXECUTED - COND CODE 0000
 IEF285I   WYL.GG.SYS.LINKLIB                           KEPT
 IEF285I   VOL SER NOS= SYSB02.
 IGD105I SYS04082.T094345.RA000.PJG#RES.PRINT.H01     DELETED,   DDNAME=ASMOUT
 IEF285I   GG$PJG.PJG#RES.JOB05959.D0000105.?           SYSOUT
 IEF285I   GG$PJG.PJG#RES.JOB05959.D0000106.?           SYSOUT
 *********************************************************************************
 *   PJG#RES /$EDIT   /                    Return Code      Zero                 *
 *   Region used      388K (116K user + 272K system)                             *
 *   Extended region  9472K (4K user + 9468K system)                             *
 *                                                                               *
 *   Paging              In      Out                                             *
 *   Private <-> Aux      0        0       CPU time (TCB)   00:00:01.16          *
 *   Private <-> Exp      0        0       CPU time (SRB)   00:00:00.03          *
 *   VIO                  0        0       Elapsed time    920:43:56.37          *
 *   Common               0      ---                                             *
 *                                                                               *
 *                                                                               *
 *   CPU Usage         21.75        $13.48  Standard Processing Unit Equivalent  *
 *                                  $13.48  Total Step execution charge          *
 *                                                                               *
 *    I/O count  DDname   Type Addr           I/O count  DDname   Type Addr      *
 *            2  STEPLIB  Disk 0402                 301  ASMOUT   Disk 038B      *
 *            0  SYSPRINT      ----                   0  SYSUDUMP      ----      *
 *********************************************************************************
 IEF373I STEP/$EDIT   /START 2004082.0943
 IEF374I STEP/$EDIT   /STOP  2004082.0944 CPU    0MIN 01.16SEC SRB    0MIN 00.03SEC VIRT   116K SYS   272K EXT       4K SYS    9468K
 *********************************************************************************
 *                                                                               *
 *                      S t a n f o r d   U n i v e r s i t y                    *
 *                                                                               *
 *                              *** Job Summary ***                              *
 *                                                                               *
 *   System Id      SYSB                   Input time     09:38:26  Mar 22, 2004 *
 *                                                                               *
 *   System Release SP6.1.0                Start time     09:43:45  Mar 22, 2004 *
 *                                                                               *
 *   Job name       PJG#RES                Stop  time     00:00:00  Mar 22, 2004 *
 *                                                                               *
 *   Account        PJG$GG                 Elapsed time  920:44:07.69            *
 *                                                                               *
 *   User Name      Module: RESMAN         CPU time       00:00:06.54            *
 *                                                                               *
 *   Job class      E                      SRB Time       00:00:00.09            *
 *                                                                               *
 *********************************************************************************
 IEF375I  JOB/PJG#RES /START 2004082.0943
 IEF376I  JOB/PJG#RES /STOP  2004082.0944 CPU    0MIN 06.54SEC SRB    0MIN 00.09SEC
1Data set successfully converted from EDIT to FB format
1Assembler Done RESMAN No Statements Flagged
1         High Level Assembler Option Summary                   (PTF UQ57391)                                               Page    1
-                                                                                            HLASM R4.0  2004/03/22 09.43
0  No Overriding ASMAOPT Parameters
   Overriding Parameters-  SYSPARM(RESMAN),TERM,LANG(EN),OBJ,LC(32500),XREF(SHORT),NODECK,NORLD,NODX,NOUS
   No Process Statements


   Options for this Assembly
0  NOADATA
     ALIGN
   NOASA
     BATCH
     CODEPAGE(047C)
   NOCOMPAT
   NODBCS
 3 NODECK
 3 NODXREF
     ESD
   NOEXIT
     FLAG(0,ALIGN,CONT,NOIMPLEN,NOPAGE0,PUSH,RECORD,NOSUBSTR,USING0)
   NOFOLD
   NOGOFF
   NOINFO
 3   LANGUAGE(EN)
   NOLIBMAC
 3   LINECOUNT(32500)
     LIST(121)
     MXREF(SOURCE)
 3   OBJECT
     OPTABLE(UNI,NOLIST)
   NOPCONTROL
   NOPESTOP
   NOPROFILE
   NORA2
   NORENT
 3 NORLD
     RXREF
     SIZE(MAX)
 3   SYSPARM(RESMAN)
 3   TERM(WIDE)
   NOTEST
     THREAD
   NOTRANSLATE
 3 NOUSING
 3   XREF(SHORT)

   No Overriding DD Names

1RESMAN   External Symbol Dictionary                                                                                        Page    2
-Symbol   Type   Id     Address  Length     LD ID  Flags Alias-of                            HLASM R4.0  2004/03/22 09.43
0RESMAN    SD 00000001 00000000 00003638             06
 RESM00    LD          00000000           00000001
 GRINIT    LD          00000022           00000001
 GRCRE     LD          000000B2           00000001
 GRDEL     LD          0000017A           00000001
 GRGET     LD          000001D8           00000001
 GRREL     LD          0000043E           00000001
 GRX2S     LD          000006AC           00000001
 GRCAN     LD          0000087C           00000001
 QUEUE     LD          000009A0           00000001
 QUEPUSH   LD          00000A58           00000001
 QUEREM    LD          00000B10           00000001
 VMGET     ER 00000002
 AWAIT     ER 00000003
 SYSRDEL   ER 00000004
 QUEREM    ER 00000005
 SYSRNEW   ER 00000006
 SIGNAL    ER 00000007
 SBUFGET   LD          00000C0E           00000001
 SBUFREE   LD          00000DDE           00000001
 SBUFINIT  LD          00000EE0           00000001
 PAGFIX    ER 00000008
 QUEUE     ER 00000009
 PAGUFIX   ER 0000000A
 LKCRE     LD          00001166           00000001
 LKDEL     LD          000012BC           00000001
 LKOB      LD          00001464           00000001
 LKREL     LD          000016BC           00000001
 LKINIT    LD          000018B6           00000001
 LQEALL    LD          000019EC           00000001
 LQEDALL   LD          00001A58           00000001
 LQEGET7   LD          00001A90           00000001
 VMFREE    ER 0000000B
 CPLOCK    ER 0000000C
 ASLOCK    ER 0000000D
 DISPSHLD  ER 0000000E
 AWAITAS   ER 0000000F
 CPULOCK   ER 00000010
 SIGNALAS  ER 00000011
 DISPSREL  ER 00000012
 ASULOCK   ER 00000013
 ENQINIT   LD          00001BE4           00000001
 ENQUEUE   LD          00001C88           00000001
 DEQUEUE   LD          00001F08           00000001
 REQUEUE   LD          00002142           00000001
 ENQHALT   LD          00002384           00000001
 LKCRE     ER 00000014
 LKOB      ER 00000015
 HASHIT    ER 00000016
 LKREL     ER 00000017
 ENQASTRM  LD          000025D2           00000001
 ENQASCN7  LD          00002628           00000001
 ENQWAIT7  LD          00002806           00000001
 ENQPOST7  LD          000028BA           00000001
 FINDQCB7  LD          00002982           00000001
1RESMAN   External Symbol Dictionary                                                                                        Page    3
 GETQRB7   LD          00002B06           00000001
 FREEQRB7  LD          00002BFC           00000001
 GETQOE7   LD          00002C86           00000001
 FREEQOE7  LD          00002D76           00000001
 GETQAO7   LD          00002E00           00000001
 FREEQAO7  LD          00002EEA           00000001
 ENQDUMP   LD          00002FE0           00000001
 ENQASDMP  LD          00003414           00000001
 SEG       ER 00000018
 SEGCOL    ER 00000019
 SEGHEX    ER 0000001A

1RESMAN   ORVYL'S Resource Management Services                                                                              Page    4
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement                    (Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                      2       2.              COPY  HEADER
                                       3             =*********************************************************************
                                       4             =*                                                                   *
                                       5             =*                                                                   *
                                       6             =*                          M P - O R V Y L                          *
                                       7             =*                                                                   *
                                       8             =*       ORVYL - Release 5.0 - Class I - Stanford Proprietary        *
                                       9             =*                                                                   *
                                      10             =*                                                                   *
                                      11             =*********************************************************************
-
-                                     13             =         SPLEVEL SET=2
                                      16             =         HIBAL ASSOC=YES
-
                                     998             =*
                                     999             =* REGISTER CONVENTIONS (USE ONLY THE SYMBOLS)
                                    1000             =*
                                    1001             =*                     CLASS  USAGE
                                    1002             =*                     -----  -----------------------------
                                    1003             =RVR      REG   0        1    RETURN VALUE REGISTER
                                    1015             =RS       REG   1        *    SCRATCH
                                    1027             =RA       REG   2        *    SCRATCH
                                    1039             =RB       REG   3        *    SCRATCH
                                    1051             =RJ       REG   4        *    SCRATCH
                                    1063             =RK       REG   5        *    SCRATCH
                                    1075             =RX       REG   6        *    SCRATCH
                                    1087             =RY       REG   7        *    SCRATCH
                                    1099             =RM       REG   8        *    SCRATCH
                                    1111             =RN       REG   9        *    SCRATCH (In Guest)
                                    1123             =RTCBR    REG   9        -    POINTER TO THE RTCB (In Host)
                                    1135             =BR       REG   10       -    FIRST BASE REGISTER
                                    1147             =BRR      REG   11       -    SECOND BASE REGISTER
                                    1159             =WAR      REG   12       -    WORK AREA POINTER
                                    1171             =SPR      REG   13       -    STACK TOP POINTER
                                    1183             =RAR      REG   14       1    RETURN ADDRESS REGISTER
                                    1195             =EPAR     REG   15       1    ENTRY POINT ADDRESS
                                    1207             =*
                                    1208             =*      CLASS   MEANING
                                    1209             =*      -----   --------------------------------------------------
                                    1210             =*        *     Register may be freely used for scratch
                                    1211             =*        -     Register may not be used
                                    1212             =*        1     Available but may change on subroutine calls
                                    1213             =*
1RESMAN   ORVYL'S Resource Management Services                                                                              Page    5
0D-Loc  Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+_____  ______ ____    _____ _____  ____ __ ______    ______ _________
0000000                00000 03638  1215       3.     RESMAN   MODULE TRCNUM=7
                                    1225             +*
                                    1226    02-IDENT +         ENTRY RESM00
                                    1227             +
 000000 14D9C5E2D4F0F06B            1228    02-IDENT +RESM00   DC    AL1(20),C'RESM00,22MAR04,09:43'
                                    1229             +*
-
0                                   1232       5.     DISABLE  EQU   X'04'                   Disable 'AND' mask
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page    6
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1234       7.              COPY  PZERO
 000000                00000 00280  1235             =PZERO    RECORD BEGIN
                                    1243  1          =*
                                    1244  1          =* Real Page 0.  Each CPU has its own copy of this area.
                                    1245  1          =*
-                                   1247  1          =****************************************************************
                                    1248  1          =*               Fields Fixed by the Architecture               *
                                    1249  1          =*               ********************************               *
                                    1250  1          =*                                                              *
 000000                             1251  1          =PZRSNPSW   DS    D             Restart new PSW                 *
 000008                             1252  1          =PZRSOPSW   DS    D             Restart old PSW                 *
 000010                             1253  1          =           DS    D                                             *
 000018                             1254  1          =PZEXOPSW   DS    D             External old PSW                *
 000020                             1255  1          =PZSVOPSW   DS    D             Supervisor old PSW              *
 000028                             1256  1          =PZPIOPSW   DS    D             Program old PSW                 *
 000030                             1257  1          =PZMCOPSW   DS    D             Machine check old PSW           *
 000038                             1258  1          =PZIOOPSW   DS    D             I/O old PSW                     *
 000040                             1259  1          =           DS    3D                                            *
 000058                             1260  1          =PZEXNPSW   DS    D             External new PSW                *
 000060                             1261  1          =PZSVNPSW   DS    D             Supervisor new PSW              *
 000068                             1262  1          =PZPINPSW   DS    D             Program new PSW                 *
 000070                             1263  1          =PZMCNPSW   DS    D             Machine check new PSW           *
 000078                             1264  1          =PZIONPSW   DS    D             I/O new PSW                     *
 000080                             1265  1          =           DS    F                                             *
 000084                             1266  1          =PZEXCPU    DS    H             CPU address for EXT int         *
 000086                             1267  1          =PZEXIC     DS    H             External interrupt code         *
 000088                             1268  1          =PZSVILC    DS    H             Supervisor call ILC             *
 00008A                             1269  1          =PZSVIC     DS    H             Supervisor interrupt code       *
 00008C                             1270  1          =PZPIILC    DS    H             Program ILC                     *
 00008E                             1271  1          =PZPIIC     DS    H             Program interrupt code          *
 000090                             1272  1          =PZTREXA    DS    A             Translation exception address   *
 000094                             1273  1          =PZMONCL    DS    H             Monitor Class number            *
 000096                             1274  1          =PZPERCD    DS    H             PER code                        *
 000098                             1275  1          =PZPERA     DS    A             PER Address                     *
 00009C                             1276  1          =PZMONCD    DS    A             Monitor Code                    *
 0000A0                             1277  1          =           DS    3D                                            *
 0000B8                             1278  1          =PZIOSID    DS    A             I/O subsystem ID word           *
 0000BC                             1279  1          =PZIOPRM    DS    A             I/O Parameter                   *
 0000C0                             1280  1          =PZIOSCS    DS    A             I/O subchannel ending status    *
 0000C4                             1281  1          =           DS    A                                             *
 0000C8                             1282  1          =           DS    39D                                           *
                                    1283  1          =*                                                              *
                                    1284  1          =*            ***************************************           *
                                    1285  1          =*            End of Fields fixed by the architecture           *
                                    1286  1          =****************************************************************
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page    7
0D-Loc  Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+_____  ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1288  1          =*
                                    1289  1          =* Fields of general interest
                                    1290  1          =*
 000200                             1291  1          =PZMATP     DS    A             Address of the MAT
 000204                             1292  1          =           DS    A             ** Reserved **
 000208                             1293  1          =PZCURPID   DS    0D            Unique ID of the current process
 000208                             1294  1          =PZCURASB   DS    A             Addr of ASB for current Address space
 00020C                             1295  1          =PZCURTSK   DS    A             ID of current task in the Address space
 000210                             1296  1          =PZLCPUA    DS    A             Logical CPU address
 000214                             1297  1          =PZCPUMSK   DS    A             CPU address mask bit
 000218                             1298  1          =PZPSWM     DS    X             PSW mask for disabling
 000219                             1299  1          =           DS    X             ** Reserved **
                                    1300  1          =*
                                    1301  1          =* Termination/Trace information
                                    1302  1          =*
 00021A 00                          1303  1          =PZTERMFL   FLAG  ,             Termination flags
 PZTERMFL.PZABORT  80 ONES          1307  1          =           FLAG  PZABORT         ABORT macro issued
 PZTERMFL.PZATERM  40 ONES          1312  1          =           FLAG  PZATERM         Start termination processing
 00021B                             1317  1          =PZABSM     DS    X             Save area for system mask in ABORT
 00021C                             1318  1          =PZABR15    DS    A             Save area for R15 in an ABORT
 000220                             1319  1          =PZTZOFF    DS    D             Time zone offset
 000228                             1320  1          =           DS    22A           ** Reserved **
                                    1321  1          =*         DS    24A           ** Reserved **
 000280                00280 00280  1322             =         END   ,
 USING  PZERO,R0                    1331       8.              USING PZERO,R0
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page    8
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1341      10.              COPY  MAT
                                    1342             =*****************************************************************
                                    1343             =*                                                               *
                                    1344             =*        *** M A S T E R   A D D R E S S   T A B L E ***        *
                                    1345             =*                                                               *
                                    1346             =*****************************************************************
-000000                00000 00100  1348             =MAT      RECORD BEGIN
                                    1356  1          =MATPTR     EQU   X'200',4,C'A' Address of the MAT in PZERO
 000000 D4C1E340                    1357  1          =           DC    CL4'MAT'      Control block ID
                                    1358  1          =*
                                    1359  1          =* Addresses of global control blocks
                                    1360  1          =*
 000004                             1361  1          =MATVMCB    DS    A             Virtual memory control block
 000008                             1362  1          =MATDCT     DS    A             Dispatcher control table
 00000C                             1363  1          =MATPAGCB   DS    A             Real memory control block
 000010                             1364  1          =MATM1CT    DS    A             CT for Mode 1 users
 000014                             1365  1          =MATLCT     DS    A             Lock manager control table
 000018                             1366  1          =MATQCT     DS    A             Queue manager control table
 00001C                             1367  1          =MATIOCB    DS    A             I/O Manager control block
 000020                             1368  1          =MATSBWB    DS    A             System buffer wait blocks
 000024                             1369  1          =MATGTCT    DS    A             Terminal global control table
 000028                             1370  1          =MATFILCB   DS    A             File master control table
 00002C                             1371  1          =MATJESCB   DS    A             JES master control table
 000030                             1372  1          =MATSYSCB   DS    A             System task control table
 000034                             1373  1          =MATACCT    DS    A             Accounting control table
 000038                             1374  1          =MATGRCT    DS    A             General Resource control table
 00003C                             1375  1          =MATGNCT    DS    A             Global Network Control table
 000040                             1376  1          =MATTECB    DS    D             Termination wait ECB
 000048                             1377  1          =           DS    25A           Reserved
                                    1378  1          =*
                                    1379  1          =* Control Block Chains
                                    1380  1          =*
 0000AC                             1381  1          =MATASBS    DS    A             Pointer to chain of ASBs
 0000B0                             1382  1          =MATASBL    DS    A             Id of suspend lock for ASB chain
 0000B4                             1383  1          =           DS    8A            **  RESERVED
                                    1384  1          =*
                                    1385  1          =* Control information
                                    1386  1          =*
 0000D4                             1387  1          =MATSNAME   DS    CL8           System Name
 0000DC                             1388  1          =MATPAGFN   DS    A             Current value of the Paging function
 0000E0                             1389  1          =MATSKEY    DS    X             SYSTEM storage key (in high 4 bits)
 0000E1                             1390  1          =MATUKEY    DS    X             USER storage key
                                    1391= 1          =           ¿þþþþþþþþþþþþþþþþþþþþþþþþþþþþþþþþÜ
                                    1392= 1          =           Ÿ  Information about the Kernel  Ÿ
                                    1393= 1          =           ¾þþþþþþþþþþþþþþþþþþþþþþþþþþþþþþþþ»
 0000E4                             1394  1          =MATKSTRT   DS    A             Starting address of the Kernel
 0000E8                             1395  1          =MATKMAP    DS    A             Address of the Kernel map
 0000EC                             1396  1          =MATKMAPL   DS    A             Length of the Kernel map
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page    9
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1397= 1          =           ¿þþþþþþþþþþþþþþþþþþþþþþþþþÜ
                                    1398= 1          =           Ÿ  Failsoft information.  Ÿ
                                    1399= 1          =           ¾þþþþþþþþþþþþþþþþþþþþþþþþþ»
 0000F0                             1400  1          =MATNCLPE   DS    F             Number of CLP errors
 0000F4                             1401  1          =MATNFAIL   DS    F             Number of failsofts
 0000F8                             1402  1          =           DS    2A            Reserved
 000100                00100 00100  1403             =         END
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   10
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1413      12.              COPY  ASB
 000000                00000 00044  1414             =ASB      RECORD BEGIN
 000000 C1E2C240                    1422  1          =ASBID      DC    CL4'ASB'
 000004                             1423  1          =ASBNEXT    DS    A                       Next ASB in system
                                    1424  1          =*
                                    1425  1          =*  Load Address Space Parameters area
                                    1426  1          =*
 000008                             1427  1          =ASBLASP    DS    0D                      Load Addr Space Parms
 000008                             1428  1          =ASBPKM     DS    H                       Program Key Mask
 00000A                             1429  1          =ASBSASN    DS    H                       Secondary ASN
 00000C                             1430  1          =ASBAX      DS    H                       Authorization index
 00000E                             1431  1          =ASBPASN    DS    H                       Primary ASN
                                    1432  1          =ASBLPARM   EQU   3                       LASP parameter
                                    1433  1          =
 000010                             1434  1          =ASBSASB    DS    A                       Address of secondary ASB
 000014 00                          1435  1          =ASBGCFLG   FLAG  ,
 ASBGCFLG.ASBFGBLC 80 ONES          1439  1          =           FLAG  ASBFGBLC                This is ASB for global/common
 000015                             1444  1          =           DS    3X                      - Available -
                                    1445  1          =*
                                    1446  1          =*  Related control blocks
                                    1447  1          =*
 000018                             1448  1          =ASBVSCT    DS    A                       VSCT for the Address space
 00001C                             1449  1          =ASBASDB    DS    A                       AS dispatching block
 000020                             1450  1          =ASBPAGB    DS    A                       AS paging block
 000024                             1451  1          =ASBIOB     DS    A                       AS I/O block
 000028                             1452  1          =ASBENQ     DS    A                       AS Enqueue table
 00002C                             1453  1          =ASBM1SCP   DS    A                       Mode 1 SCP
 000030                             1454  1          =ASBTCCB    DS    A                       Terminal Control block
 000034                             1455  1          =ASBAIB     DS    A                       Accouting information
 000038                             1456  1          =ASBASFB    DS    A                       File services control block
 00003C                             1457  1          =ASBMSTR    DS    A                       AS Master Control block
 000040                             1458  1          =ASBNET     DS    A                       Local Network Control Block
                                    1459  1          =*ASBLW    DS    A     ** Temp RESMAN ** Lock waiting for
                                    1460  1          =*ASBLH    DS    A     ** Temp RESMAN ** Lock held
 000044                00044 00044  1461             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   11
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1471      14.              COPY  SLISTMAC
                                    1472             =*******************************************************************
                                    1473             =*                                                                 *
                                    1474             =* Macros for the serialized manipulation of single linked lists   *
                                    1475             =* in memory.  These lists are of the PUSH/POP (LIFO) variety.     *
                                    1476             =* Serialization is achieved using the CDS and CS instructions.    *
                                    1477             =*                                                                 *
                                    1478             =*******************************************************************
0                                   1480             =*******************************************************************
                                    1481             =*                                                                 *
                                    1482             =* Single linked list head fields                                  *
                                    1483             =*                                                                 *
                                    1484             =*******************************************************************
                                    1485             =         MACRO
                                    1486             =&LAB     SHEAD
                                    1487             =         AIF   ('&LAB' EQ '').ERR
                                    1488             =&LAB     DS   0D                   Single linked CDS list
                                    1489             =&LAB.FP  DS    A                   Forward pointer
                                    1490             =&LAB.SEQ DS    A                   CDS sequence number
                                    1491             =         MEXIT
                                    1492             =.ERR     MNOTE 8,'Label (list name) required'
                                    1493             =         MEND
0                                   1495             =*******************************************************************
                                    1496             =*                                                                 *
                                    1497             =* Push an item onto a single linked list                          *
                                    1498             =*                                                                 *
                                    1499             =*******************************************************************
                                    1500             =         MACRO
                                    1501             =&LABEL   SPUSH &HEAD=,&ITEM=
                                    1502             =         LCLC  &X
                                    1503             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1504             =&LABEL   LABEL ,
                                    1505             =.NOLAB   ANOP  ,
                                    1506             =         AIF   ('&HEAD' EQ '').ERR1
                                    1507             =         AIF   ('&ITEM' EQ '').ERR2
                                    1509             =         LM    R14,R15,&HEAD       Get fwd ptr and sequence number
                                    1510             =         LA    RVR,&ITEM           Point to new item
                                    1511             =         LOOP  BEGIN
                                    1512             =         LA    RS,1(R15)           Increment sequence
                                    1513             =         MVC   &ITEM.(L'&HEAD.FP),&HEAD.FP Set item fwd ptr
                                    1514             =         CDS   R14,RVR,&HEAD       Add item to list
                                    1515             =         UNTIL (Z),END
                                    1517             =         AGO   .EXIT
                                    1518             =.ERR1    MNOTE 8,'Head is a required parameter'
                                    1519             =         AGO   .EXIT
                                    1520             =.ERR2    MNOTE 8,'Item is a required parameter'
                                    1521             =.EXIT    ANOP  ,
                                    1522             =         MEND  ,
0                                   1524             =*******************************************************************
                                    1525             =*                                                                 *
                                    1526             =* Pop an item from a single linked list. Addr returned in RVR     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   12
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1527             =* (zero if the list was empty).                                   *
                                    1528             =*                                                                 *
                                    1529             =*******************************************************************
                                    1530             =         MACRO
                                    1531             =&LABEL   SPOP  &HEAD=
                                    1532             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1533             =&LABEL   LABEL ,
                                    1534             =.NOLAB   ANOP  ,
                                    1535             =         AIF   ('&HEAD' EQ '').ERR1
                                    1537             =         LM    RVR,RS,&HEAD        Get fwd and sequence number
                                    1538             =         LOOP  BEGIN
                                    1539             =         IF    (RVR,Z),EXIT        None to get
                                    1540             =         LR    R14,RVR             Point to first item
                                    1541             =         L     R14,0(R14)          Get fwd pointer
                                    1542             =         LA    R15,1(RS)           Increment sequence
                                    1543             =         CDS   RVR,R14,&HEAD       Remove item from list
                                    1544             =         UNTIL (Z),END
                                    1546             =         AGO   .EXIT
                                    1547             =.ERR1    MNOTE 8,'Head is a required parameter'
                                    1548             =.EXIT    ANOP  ,
                                    1549             =         MEND  ,
0                                   1551             =*******************************************************************
                                    1552             =*                                                                 *
                                    1553             =* Get an available item from list (ptr returned in RVR). Memory   *
                                    1554             =* will be obtained if the list is empty.                          *
                                    1555             =*                                                                 *
                                    1556             =*******************************************************************
                                    1557             =         MACRO
                                    1558             =&LABEL   SAVAIL &HEAD=,&LEN=,&LOC=GLOBHI,&FIX=,&PAGE=
                                    1559             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1560             =&LABEL   LABEL ,
                                    1561             =.NOLAB   ANOP  ,
                                    1562             =         AIF   ('&HEAD' EQ '').ERR1
                                    1563             =         AIF   ('&LEN' EQ '').ERR2
                                    1564             =         SPOP  HEAD=&HEAD          pop a free item
                                    1565             =         IF    (RVR,Z),BEGIN       empty list
                                    1566             =         VMGET &LEN,LOC=&LOC,FIX=&FIX,PAGE=&PAGE
                                    1567             =         IF    ('LTR RVR,RVR',ZERO),'ABORT NO_MEM_&HEAD'
                                    1568             =         END   ,
                                    1569             =         AGO   .EXIT
                                    1570             =.ERR1    MNOTE 8,'Head is a required parameter'
                                    1571             =         AGO   .EXIT
                                    1572             =.ERR2    MNOTE 8,'Len is a required parameter'
                                    1573             =.EXIT    ANOP  ,
                                    1574             =         MEND  ,
0000000                00000 00008  1576             =SLDUMMY  RECORD BEGIN
                                    1584  1          =SLDUM      SHEAD ,
 000000                             1585  1 01-01488 +SLDUM      DS   0D                   Single linked CDS list
 000000                             1586  1 01-01489 +SLDUMFP    DS    A                   Forward pointer
 000004                             1587  1 01-01490 +SLDUMSEQ   DS    A                   CDS sequence number
 000008                00008 00008  1588             =         END
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   13
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1598      16.              COPY  QLISTMAC
                                    1599             =*******************************************************************
                                    1600             =*                                                                 *
                                    1601             =* These macros are used to update double linked memory lists.     *
                                    1602             =* Serialization is achieved using the PLO instruction. If a       *
                                    1603             =* memory block containing the list head needs to be locked anyway *
                                    1604             =* then the macros in LSTMAC would be better than these.           *
                                    1605             =* Conversely any existing use of LSTMAC macros might be           *
                                    1606             =* converted to this mechanism to avoid using locking.             *
                                    1607             =*                                                                 *
                                    1608             =*******************************************************************
0                                   1610             =*******************************************************************
                                    1611             =*                                                                 *
                                    1612             =* Double linked list head fields                                  *
                                    1613             =*                                                                 *
                                    1614             =*******************************************************************
                                    1615             =         MACRO
                                    1616             =&LAB     QHEAD
                                    1617             =         AIF   ('&LAB' EQ '').ERR
                                    1618             =         DS   0D
                                    1619             =&LAB     DS   0XL(16)              Double linked PLO list
                                    1620             =&LAB.FP  DS    A                   Forward pointer
                                    1621             =&LAB.BP  DS    A                   Backward pointer
                                    1622             =&LAB.SEQ DS    A                   CDS sequence number
                                    1623             =&LAB.CNT DS    A                   Count of items
                                    1624             =         MEXIT
                                    1625             =.ERR     MNOTE 8,'Label (list name) required'
                                    1626             =         MEND
0                                   1628             =*******************************************************************
                                    1629             =*                                                                 *
                                    1630             =* Parameters for the double linked list manipulation routines     *
                                    1631             =* in RESMAN                                                       *
                                    1632             =*                                                                 *
                                    1633             =*******************************************************************
 000000                00000 00010  1634             =@QUE    RECORD BEGIN               List Add/Remove
 000000                             1642  1          =@QUESEQ    DS    D                   Doubleword sequence value
 000008                             1643  1          =@QUEITM    DS    A                   Address of item
 00000C                             1644  1          =@QUELHD    DS    A                   Address of list head
 000010                00010 00010  1645             =         END   ,
0                                   1655             =*******************************************************************
                                    1656             =*                                                                 *
                                    1657             =* Add an item to the end of a double linked list                  *
                                    1658             =*                                                                 *
                                    1659             =*******************************************************************
                                    1660             =         MACRO
                                    1661             =&LABEL   Q_QUE &HEAD=,&ITEM=
                                    1662             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1663             =&LABEL   LABEL ,
                                    1664             =.NOLAB   ANOP  ,
                                    1665             =         AIF   ('&HEAD' EQ '').ERR1
                                    1666             =         AIF   ('&ITEM' EQ '').ERR2
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   14
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1668             =         PSET  @QUE,CLEAR=NO
                                    1669             =         LM    R14,R15,&HEAD.SEQ
                                    1670             =         STM   R14,R15,@QUESEQ     Set sequence stuff
                                    1671             =         PMOV  @QUELHD,LA:&HEAD
                                    1672             =         PMOV  @QUEITM,LA:&ITEM
                                    1673             =         LOOP  BEGIN
                                    1674             =         VCALL QUEUE               Add item to end of list
                                    1675             =         UNTIL (RVR,Z),END
                                    1677             =         AGO   .EXIT
                                    1678             =.ERR1    MNOTE 8,'Head is a required parameter'
                                    1679             =         AGO   .EXIT
                                    1680             =.ERR2    MNOTE 8,'Item is a required parameter'
                                    1681             =.EXIT    ANOP  ,
                                    1682             =         MEND  ,
0                                   1684             =*******************************************************************
                                    1685             =*                                                                 *
                                    1686             =* Remove an item from a double linked list                        *
                                    1687             =*                                                                 *
                                    1688             =*******************************************************************
                                    1689             =         MACRO
                                    1690             =&LABEL   Q_REM &HEAD=,&ITEM=
                                    1691             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1692             =&LABEL   LABEL ,
                                    1693             =.NOLAB   ANOP  ,
                                    1694             =         AIF   ('&HEAD' EQ '').ERR1
                                    1695             =         AIF   ('&ITEM' EQ '').ERR2
                                    1697             =         PSET  @QUE,CLEAR=NO
                                    1698             =         LM    R14,R15,&HEAD.SEQ
                                    1699             =         STM   R14,R15,@QUESEQ     Set sequence stuff
                                    1700             =         PMOV  @QUELHD,LA:&HEAD
                                    1701             =         PMOV  @QUEITM,LA:&ITEM
                                    1702             =         LOOP  BEGIN
                                    1703             =         VCALL QUEREM              Add item to nd of list
                                    1704             =         UNTIL (RVR,Z),END
                                    1706             =         AGO   .EXIT
                                    1707             =.ERR1    MNOTE 8,'Head is a required parameter'
                                    1708             =         AGO   .EXIT
                                    1709             =.ERR2    MNOTE 8,'Item is a required parameter'
                                    1710             =.EXIT    ANOP  ,
                                    1711             =         MEND  ,
0                                   1713             =*******************************************************************
                                    1714             =*                                                                 *
                                    1715             =* Add item to beginning of double linked list                     *
                                    1716             =*                                                                 *
                                    1717             =*******************************************************************
                                    1718             =         MACRO
                                    1719             =&LABEL   Q_PSH &HEAD=,&ITEM=
                                    1720             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1721             =&LABEL   LABEL ,
                                    1722             =.NOLAB   ANOP  ,
                                    1723             =         AIF   ('&HEAD' EQ '').ERR1
                                    1724             =         AIF   ('&ITEM' EQ '').ERR2
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   15
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1726             =         PSET  @QUE,CLEAR=NO
                                    1727             =         LM    R14,R15,&HEAD.SEQ
                                    1728             =         STM   R14,R15,@QUESEQ     Set sequence stuff
                                    1729             =         PMOV  @QUELHD,LA:&HEAD
                                    1730             =         PMOV  @QUEITM,LA:&ITEM
                                    1731             =         LOOP  BEGIN
                                    1732             =         VCALL QUEPUSH             Add item to end of list
                                    1733             =         UNTIL (RVR,Z),END
                                    1735             =         AGO   .EXIT
                                    1736             =.ERR1    MNOTE 8,'Head is a required parameter'
                                    1737             =         AGO   .EXIT
                                    1738             =.ERR2    MNOTE 8,'Item is a required parameter'
                                    1739             =.EXIT    ANOP  ,
                                    1740             =         MEND  ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   16
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1743      18.              COPY  GRPARM
                                    1744             =*****************************************************************
                                    1745             =*
                                    1746             =* General Resource API
                                    1747             =*
                                    1748             =*****************************************************************
 000000                00000 00009  1749             =@GRES   RECORD BEGIN               General Resource Routine api
0000000                             1758  1          =@GRCID     DS    A                   Caller id
 000004                             1759  1          =@GRID      DS    A                   Resource id
0000008 00                          1761  1          =@GRFLAG    FLAG  ,
 @GRFLAG.@GRWAIT   80 ONES          1765  1          =           FLAG  @GRWAIT             Wait for resource to come free
 @GRFLAG.@GREXCL   40 ONES          1770  1          =           FLAG  @GREXCL             Get hold exclusively
 @GRFLAG.@GRCANAS  20 ONES          1775  1          =           FLAG  @GRCANAS            Cancel only this address space
0000009                00009 00009  1781             =         END   ,
0                                   1791             =*****************************************************************
                                    1792             =*
                                    1793             =* Create a general resource item
                                    1794             =*
                                    1795             =*   CALLID is a four byte caller identifier
                                    1796             =*
                                    1797             =*   The resource id is returned in RVR
                                    1798             =*
                                    1799             =*****************************************************************
                                    1800             =         MACRO ,
                                    1801             =&LABEL   GRCRE &CID=
                                    1802             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1803             =&LABEL   LABEL ,
                                    1804             =.NOLAB   ANOP  ,
                                    1805             =         AIF   ('&CID' EQ '').ERR
                                    1806             =         PSET  @GRES
                                    1807             =         PMOV  @GRCID,&CID         Set caller id
                                    1808             =         VCALL GRCRE               Create a general resource item
                                    1809             =         AGO   .EXIT
                                    1810             =.ERR     MNOTE 8,'CID is a required parameter'
                                    1811             =.EXIT    ANOP  ,
                                    1812             =         MEND  ,
0                                   1814             =*****************************************************************
                                    1815             =*
                                    1816             =* Delete a general resource item
                                    1817             =*
                                    1818             =*   RID is a four byte resource id returned from GRCRE
                                    1819             =*
                                    1820             =*****************************************************************
                                    1821             =         MACRO ,
                                    1822             =&LABEL   GRDEL &RID=
                                    1823             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1824             =&LABEL   LABEL ,
                                    1825             =.NOLAB   ANOP  ,
                                    1826             =         AIF   ('&RID' EQ '').ERR
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   17
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1827             =         PSET  @GRES
                                    1828             =         PMOV  @GRID,&RID          Set resource id
                                    1829             =         VCALL GRDEL               Delete a general resource item
                                    1830             =         AGO   .EXIT
                                    1831             =.ERR     MNOTE 8,'Resource ID is a requried parameter'
                                    1832             =.EXIT    ANOP  ,
                                    1833             =         MEND  ,
0                                   1835             =*****************************************************************
                                    1836             =*
                                    1837             =* Get a general resource item hold
                                    1838             =*
                                    1839             =*   RID is a four byte resource id returned from GRCRE
                                    1840             =*
                                    1841             =*   The resource hold id is returned in RVR
                                    1842             =*
                                    1843             =*****************************************************************
                                    1844             =         MACRO ,
                                    1845             =&LABEL   GRGET &RID=,&WAIT=YES,&EXCL=NO
                                    1846             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1847             =&LABEL   LABEL ,
                                    1848             =.NOLAB   ANOP  ,
                                    1849             =         AIF   ('&RID' EQ '').ERR1
                                    1850             =         PSET  @GRES
                                    1851             =         PMOV  @GRID,&RID
                                    1852             =         AIF   ('&WAIT' EQ 'NO').EXCL
                                    1853             =         AIF   ('&WAIT' NE 'YES').ERR2
                                    1854             =         SET   @GRWAIT
                                    1855             =.EXCL    AIF   ('&EXCL' EQ 'NO').VCALL
                                    1856             =         AIF   ('&EXCL' NE 'YES').ERR3
                                    1857             =         SET   @GREXCL
                                    1858             =.VCALL   VCALL GRGET               Get general resource item
                                    1859             =         AGO   .EXIT
                                    1860             =.ERR1    MNOTE 8,'Resource ID is a requried parameter'
                                    1861             =         AGO   .EXIT
                                    1862             =.ERR2    MNOTE 8,'Valid values for WAIT= are YES or NO'
                                    1863             =         AGO   .EXIT
                                    1864             =.ERR3    MNOTE 8,'Valid values for EXCL= are YES or NO'
                                    1865             =.EXIT    ANOP  ,
                                    1866             =         MEND  ,
0                                   1868             =*****************************************************************
                                    1869             =*
                                    1870             =* Release a general resource item hold
                                    1871             =*
                                    1872             =*   RID is a four byte resource hold id returned from GRGET
                                    1873             =*     Note: The RID can be the resource id or hold id if the
                                    1874             =*           get was exclusive. See GRREL in RESMAN.
                                    1875             =*
                                    1876             =*****************************************************************
                                    1877             =         MACRO ,
                                    1878             =&LABEL   GRREL &RID=
                                    1879             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1880             =&LABEL   LABEL ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   18
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1881             =.NOLAB   ANOP  ,
                                    1882             =         AIF   ('&RID' EQ '').ERR
                                    1883             =         PSET  @GRES
                                    1884             =         PMOV  @GRID,&RID
                                    1885             =         VCALL GRREL               Release a general resource item
                                    1886             =         AGO   .EXIT
                                    1887             =.ERR     MNOTE 8,'Resource ID is a requried parameter'
                                    1888             =         AGO   .EXIT
                                    1889             =.EXIT    ANOP  ,
                                    1890             =         MEND  ,
0                                   1892             =*****************************************************************
                                    1893             =*
                                    1894             =* Change an exclusive hold to a share hold
                                    1895             =*
                                    1896             =*   RID is a four byte resource id returned from GRGET
                                    1897             =*
                                    1898             =*****************************************************************
                                    1899             =         MACRO ,
                                    1900             =&LABEL   GRX2S &RID=
                                    1901             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1902             =&LABEL   LABEL ,
                                    1903             =.NOLAB   ANOP  ,
                                    1904             =         AIF   ('&RID' EQ '').ERR
                                    1905             =         PSET  @GRES
                                    1906             =         PMOV  @GRID,&RID
                                    1907             =         VCALL GRX2S     Change an exclusive hold to a share hold
                                    1908             =         AGO   .EXIT
                                    1909             =.ERR     MNOTE 8,'Resource ID is a requried parameter'
                                    1910             =         AGO   .EXIT
                                    1911             =.EXIT    ANOP  ,
                                    1912             =         MEND  ,
0                                   1914             =*****************************************************************
                                    1915             =*
                                    1916             =* Cancel a general resource item waiting for hold
                                    1917             =*
                                    1918             =*   RID is a four byte resource id returned from GRGET
                                    1919             =*   TYPE is either ALL for cancel all waiters or AS for all
                                    1920             =*        waiters in this address space only
                                    1921             =*
                                    1922             =*****************************************************************
                                    1923             =         MACRO ,
                                    1924             =&LABEL   GRCAN &RID=,&TYPE=AS
                                    1925             =         AIF   ('&LABEL' EQ '').NOLAB
                                    1926             =&LABEL   LABEL ,
                                    1927             =.NOLAB   ANOP  ,
                                    1928             =         AIF   ('&RID' EQ '').ERR
                                    1929             =         PSET  @GRES
                                    1930             =         AIF   ('&TYPE' EQ 'ALL').CANALL
                                    1931             =         AIF   ('&TYPE' NE 'AS').ERR2
                                    1932             =         SET   @GRCANAS            Cancel only waiters of this AS
                                    1933             =.CANALL  ANOP  ,
                                    1934             =         PMOV  @GRID,&RID
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   19
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1935             =         VCALL GRCAN               Cancel a general resource item
                                    1936             =         AGO   .EXIT
                                    1937             =.ERR2    MNOTE 8,'Type must be ALL or AS'
                                    1938             =         AGO   .EXIT
                                    1939             =.ERR     MNOTE 8,'Resource ID is a requried parameter'
                                    1940             =.EXIT    ANOP  ,
                                    1941             =         MEND  ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   20
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   1945      20.              COPY  SBPARM
                                    1946             =*******************************************************************
                                    1947             =*                                                                 *
                                    1948             =* Macros for the inialization and manipulation of system buffer   *
                                    1949             =* pools for the orvyl file system.                                *
                                    1950             =*                                                                 *
                                    1951             =*******************************************************************
0                                   1953             =*******************************************************************
                                    1954             =*                                                                 *
                                    1955             =* Buffer pool initialization                                      *
                                    1956             =*                                                                 *
                                    1957             =*******************************************************************
 000000                00000 00009  1958             =@SBINIT RECORD BEGIN
 000000                             1966  1          =@SBILEN   DS    A                   Length of a buffer
 000004                             1967  1          =@SBICNT   DS    A                   Count of buffers in pool
 000008 00                          1968  1          =@SBIFLG   FLAG  ,                   Where to create pool flags
                                    1972  1          =*Not supported yet FLAG  @SBLUSR User memory local to the addr space
 @SBIFLG.@SBLSYS   80 ONES          1973  1          =           FLAG  @SBLSYS            Sys memory local to the addr space
                                    1978  1          =*Not supported yet FLAG  @SBGLLO Global memory below the line
 @SBIFLG.@SBGLHI   40 ONES          1979  1          =           FLAG  @SBGLHI            Global memory above the line
 @SBIFLG.@SBFIX    20 ONES          1984  1          =           FLAG  @SBFIX             Create in fixed memory
 000009                00009 00009  1989             =         END   ,
0                                   1999             =*******************************************************************
                                    2000             =*                                                                 *
                                    2001             =* Buffer pool get                                                 *
                                    2002             =*                                                                 *
                                    2003             =*******************************************************************
 000000                00000 0000C  2004             =@SBGET  RECORD BEGIN
 000000                             2012  1          =@SBGPOO   DS    A                   Buffer pool address
 000004                             2013  1          =@SBGADR   DS    A                   Buffer address
 000008                             2014  1          =@SBGLEN   DS    A                   Buffer length
 00000C                0000C 0000C  2015             =         END   ,
0                                   2025             =*******************************************************************
                                    2026             =*                                                                 *
                                    2027             =* Buffer pool free                                                *
                                    2028             =*                                                                 *
                                    2029             =*******************************************************************
 000000                00000 00008  2030             =@SBFREE RECORD BEGIN
 000000                             2038  1          =@SBFPOO   DS    A                   Buffer pool address
 000004                             2039  1          =@SBFADR   DS    A                   Buffer address
 000008                00008 00008  2040             =         END   ,
0000000                00000 00020  2050             =SBWAIT  RECORD BEGIN               System buffer wait block
 000000                             2058  1          =SBWFP      DS    A
 000004                             2059  1          =SBWBP      DS    A
 000008 E2C2E640                    2060  1          =SBWBID     DC    CL4'SBW'
 00000C                             2061  1          =SBWADR     DS   0A                   Address of buffer now available
 00000C                             2062  1          =SBWASB     DS    A                   Address space
 000010                             2063  1          =SBWECB     DS    D                   Wait ECB
 000018                             2064  1          =SBWORD1    DS    A                   Various
 00001C                             2065  1          =SBWORD2    DS    A                   Various
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   21
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000020                00020 00020  2066             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   22
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2076      22.              COPY  VMPARM
                                    2077             =*******************************************************************
                                    2078             =*                                                                 *
                                    2079             =*    Memory parms for inside the virtual machine.                 *
                                    2080             =*                                                                 *
                                    2081             =*******************************************************************
-000000                00000 0000B  2083             =@VMGET   RECORD BEGIN        Parm area for getting virtual memory
 000000                             2091  1          =@VMGLEN    DS    A             Amount of memory needed
 000004                             2092  1          =@VMGDAT    DS    A             More data. Address or maxlen.
 000008                             2093  1          =@VMGPOOL   DS    H             Pool/Subpool to get the memory from
 00000A 00                          2094  1          =@VMGFLG    FLAG  ,
 @VMGFLG.@VMGPAGE  80 ONES          2098  1          =           FLAG  @VMGPAGE      Page Aligned
 @VMGFLG.@VMGONEP  40 ONES          2103  1          =           FLAG  @VMGONEP      Don't cross page boundary
 00000B                0000B 0000B  2108             =         END   ,
-000000                00000 0000A  2118             =@VMFREE  RECORD BEGIN        Used for VMFREE and VMCHECK
 000000                             2126  1          =@VMFLOC    DS    A             Location of the storage to free
 000004                             2127  1          =@VMFLEN    DS    A             Amount to free
 000008                             2128  1          =@VMFPOOL   DS    H             Pool/Subpool where the storage lives
 00000A                0000A 0000A  2129             =         END   ,
-000000                00000 00009  2139             =@VMINFO  RECORD BEGIN        Returns User address limits/hash val
 000000                             2147  1          =@VMIUST    DS    A             Start of the user address space
 000004                             2148  1          =@VMIULEN   DS    A             Length of the user address space
 000008                             2149  1          =@VMITRSH   DS    X             Trash value
 000009                00009 00009  2150             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   23
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2160      24.              COPY  DISPPARM
                                    2161             =*****************************************************************
                                    2162             =*                                                               *
                                    2163             =*  DISPPARM -- Parameters for the dispatcher global routines.   *
                                    2164             =*                                                               *
                                    2165             =*****************************************************************
-                                   2167             =*
                                    2168             =* Routines to indicate completion of a page or swap I/O
                                    2169             =*
 000000                00000 00004  2170             =@DISPPIOC RECORD BEGIN                 Page I/O completion parms
 000000                             2178  1          =@DPIOASB   DS    A                       ASB of completing I/O
 000004                00004 00004  2179             =         END   ,
0000000                00000 00004  2189             =@DISPSIOC RECORD BEGIN                 Swap I/O completion parms
 000000                             2197  1          =@DSIOASB   DS    A                       ASB of completing I/O
 000004                00004 00004  2198             =         END   ,
-                                   2208             =*
                                    2209             =* SUSPEND parameters
                                    2210             =*
0000000                00000 00009  2212             =@SUSPEND RECORD BEGIN
 000000                             2220  1          =@SUSPCTL   DS    0D            ID of the Control level suspended
 000000                             2221  1          =@SUSPID    DS    A             ID of the task/address space suspended
 000004                             2222  1          =@SUSPLC    DS    A             For tasks: Level of control suspended
 000008 00                          2223  1          =@SUSPFLG   FLAG  ,
 @SUSPFLG.@SUSPLNG 80 ONES          2227  1          =           FLAG  @SUSPLNG      This will be of long duration
 @SUSPFLG.@SUSPAS  40 ONES          2232  1          =           FLAG  @SUSPAS       Suspend the entire address space
 @SUSPFLG.@SUSPPLC 20 ONES          2237  1          =           FLAG  @SUSPPLC      Suspend previous level of control
 000009                00009 00009  2242             =         END   ,
-                                   2252             =*
                                    2253             =* RESUMAS/RESUMTS parameters
                                    2254             =*
0000000                00000 00008  2256             =@RESUME  RECORD BEGIN
 000000                             2264  1          =@RESCTL    DS    0D            ID of the unit of work to be resumed
 000000                             2265  1          =@RESUNIT   DS    A             Address of the ASB/task Id to resume
 000004                             2266  1          =@RESLC     DS    A             Level of control in a task
 000008                00008 00008  2267             =         END   ,
-                                   2277             =*
                                    2278             =* DISPSHLD/DISPSREL parmameters
                                    2279             =*
0000000                00000 00004  2281             =@DISPSWP RECORD BEGIN
 000000                             2289  1          =@DISPSAS   DS    A             Address of the ASB being manipulated
 000004                00004 00004  2290             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   24
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2300             =*
                                    2301             =* ACREATE parameters
                                    2302             =*
0000000                00000 00008  2304             =@ACREATE RECORD BEGIN
 000000                             2312  1          =@ACRPSW    DS    D             Instruction address for task
 000008                00008 00008  2313             =         END   ,
-                                   2323             =*
                                    2324             =* TCREATE parameters
                                    2325             =*
0000000                00000 00015  2327             =@TCREATE RECORD BEGIN
 000000                             2335  1          =@TCRPSW    DS    D             Initial PSW for the task
 000008                             2336  1          =@TCRPARM   DS    2A            Parameter for the task
 000010                             2337  1          =@TCRPRIO   DS    A             Adjustment to priority from Current task
 000014 00                          2338  1          =@TCRFLAG   FLAG  ,             Task creation flags
 @TCRFLAG.@TCRFSTK 80 ONES          2342  1          =           FLAG  @TCRFSTK        Task entered with a stack
 @TCRFLAG.@TCRFPAB 40 ONES          2347  1          =           FLAG  @TCRFPABS       Prio is absolute
 000015                00015 00015  2352             =         END   ,
-                                   2362             =*
                                    2363             =* TREMOVE parameters
                                    2364             =*
0000000                00000 00004  2366             =@TREMOVE RECORD BEGIN
 000000                             2374  1          =@TREID     DS    A             ID of the task to be removed
 000004                00004 00004  2375             =         END   ,
-                                   2385             =*
                                    2386             =* TENTRY Parameters  (on entry to a created task)
                                    2387             =*
0000000                00000 00008  2389             =@TENTRY  RECORD BEGIN
 000000                             2397  1          =@TEPARM    DS    2A            Entry parm for the task
 000008                00008 00008  2398             =         END   ,
-                                   2408             =*
                                    2409             =* TEXIT parameters
                                    2410             =*
0000000                00000 00004  2412             =@TEXIT   RECORD BEGIN
 000000                             2420  1          =           DS    A             Not used
 000004                00004 00004  2421             =         END   ,
-                                   2431             =*
                                    2432             =* SYSRNEW -- Get a new SYSR ID
                                    2433             =*
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   25
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000000                00000 00004  2435             =@SYSRNEW RECORD BEGIN
 000000                             2443  1          =           DS    A             Not used
 000004                00004 00004  2444             =         END   ,
-                                   2454             =*
                                    2455             =* SYSRDEL -- Delete a previous SYSR ID
                                    2456             =*
 000000                00000 00004  2457             =@SYSRDEL RECORD BEGIN
 000000                             2465  1          =@SYSRDID   DS    A             Id of the SYSR
 000004                00004 00004  2466             =         END   ,
-                                   2476             =*
                                    2477             =* SYSRDO -- Schedule a system routine to run in another address space
                                    2478             =*
0000000                00000 0001C  2480             =@SYSRDO  RECORD BEGIN
 000000                             2488  1          =@SYSRID    DS    A             Id from SYSRNEW
 000004                             2489  1          =@SYSRASB   DS    A             ASB of the Address space where it goes
 000008                             2490  1          =@SYSRLOC   DS    A             Location of the system routine
 00000C                             2491  1          =@SYSRPRM   DS    4A            Parameters for the routine
 00001C                0001C 0001C  2492             =         END   ,
-                                   2502             =*
                                    2503             =* SYSRTN -- Parameter passed to a system routine
                                    2504             =*
0000000                00000 00010  2506             =@SYSRTN  RECORD BEGIN
 000000                             2514  1          =@SYSPARS   DS    4A            Parameters
 000010                00010 00010  2515             =         END   ,
-                                   2525             =*
                                    2526             =* PERSET -- Set the Per registers
                                    2527             =*
0000000                00000 0000C  2529             =@PERSET  RECORD BEGIN
 000000                             2537  1          =@PERSDAT   DS    3F            3 Registers (corresponds to CRs 9-11)
 00000C                0000C 0000C  2538             =         END   ,
-                                   2548             =*
                                    2549             =* MONSET -- Set the MON masks
                                    2550             =*
0000000                00000 00002  2552             =@MONSET  RECORD BEGIN
 000000                             2560  1          =@MONSDAT   DS    H             Monitor Class Mask
 000002                00002 00002  2561             =         END   ,
-                                   2571             =*
                                    2572             =* DSPSTAT -- Return Dispatcher Statistics
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   26
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2573             =*
0000000                00000 00020  2575             =@DSPSTAT RECORD BEGIN
 000000                             2583  1          =@DSPSST    DS    D             TOD clock when system started
 000008                             2584  1          =@DSPSCHG   DS    D             Total CPU time charged (TOD)
 000010                             2585  1          =@DSPSDSP   DS    D             Dispatch CPU time (TOD)
 000018                             2586  1          =@DSPSIOS   DS    D             I/O Service time (TOD)
 000020                00020 00020  2587             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   27
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2597      26.              COPY  SIGPARM
                                    2598             =*
                                    2599             =*  AWAIT/AWAITAS parameters
                                    2600             =*    For task based calls, the ECB is a double word.
                                    2601             =*    For address space based calls, the ECB is a word.
                                    2602             =*
 000000                00000 00005  2603             =@AWAIT   RECORD BEGIN
 000000                             2611  1          =@AWTECB    DS    A                       Address of ECB
 000004 00                          2612  1          =@AWTFLG    FLAG  ,
 @AWTFLG.@AWTLONG  80 ONES          2616  1          =           FLAG  @AWTLONG                Long term wait
 000005                00005 00005  2621             =         END   ,
0                                   2631             =*
                                    2632             =*  SIGNAL/SIGNALAS parameters
                                    2633             =*    For task based calls, the ECB and post code is a double word.
                                    2634             =*    For address space based calls, the ECB and post code is a word.
                                    2635             =*
 000000                00000 00014  2636             =@SIGNAL  RECORD BEGIN
 000000                             2644  1          =@SGCODE    DS    D                       Post code
 000008                             2645  1          =@SGECB     DS    A                       Address of ECB
                                    2646  1          =*  -- Parms for task signal --
                                    2647  1          =*    Zero ASB means post in this AS
                                    2648  1          =*    @PSSRID is only used for cross AS posts
 00000C                             2649  1          =@SGASB     DS    A                       ASB to be posted
 000010                             2650  1          =@SGSRID    DS    A                       System routine ID for cross
                                    2651  1          =*                                          AS posting
 000014                00014 00014  2652             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   28
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2662      28.              COPY  XITPARM
                                    2663             =*****************************************************************
                                    2664             =*                                                               *
                                    2665             =*  XITPARM --  Parameters for the routines dealing with exit    *
                                    2666             =*              routine definition and execution.                *
                                    2667             =*                                                               *
                                    2668             =*****************************************************************
-                                   2670             =*
                                    2671             =*  @EXRADD -- Define a new exit routine.
                                    2672             =*
0000000                00000 00015  2674             =@EXRADD  RECORD BEGIN
 000000                             2682  1          =@EXRTYPE   DS    A             Exit type bit map
 000004                             2683  1          =@EXRQUAL   DS    A             Exit Qualifier
 000008                             2684  1          =@EXRPSW    DS    D             Exit PSW
 000010                             2685  1          =@EXRPARM   DS    A             Parm for the exit
 000014 00                          2686  1          =@EXRAFLG   FLAG  ,
 @EXRAFLG.@EXRAFQ  80 ONES          2690  1          =           FLAG  @EXRAFQ       Exit should be qualified
 @EXRAFLG.@EXRAFS  40 ONES          2695  1          =           FLAG  @EXRAFS       System exit (entered with a stack)
 000015                00015 00015  2700             =         END   ,
-                                   2710             =*
                                    2711             =*  @EXRDEL -- Remove an exit routine definition.
                                    2712             =*
0000000                00000 00004  2714             =@EXRDEL  RECORD BEGIN
 000000                             2722  1          =@EXRDID    DS    A             Exit routine ID
 000004                00004 00004  2723             =         END   ,
-                                   2733             =*
                                    2734             =*  @EXRDONE -- Complete exit processing.
                                    2735             =*
0000000                00000 00001  2737             =@EXRDONE RECORD BEGIN
 000000 00                          2745  1          =@EXRDCD    FLAG  ,
 @EXRDCD.@EXRDFIN  00 EQ            2749  1          =           FLAG  (@EXRDFIN,0,EQ)         No further processing needed
 @EXRDCD.@EXRDNXT  01 EQ            2759  1          =           FLAG  (@EXRDNXT,1,EQ)         Percolate the exit request
 000001                00001 00001  2769             =         END   ,
-                                   2779             =*
                                    2780             =*  @XITNEW -- Define a new exit request.
                                    2781             =*
0000000                00000 00001  2783             =@XITNEW  RECORD BEGIN
 000000 00                          2791  1          =@XITNFL    FLAG  ,
 @XITNFL.@XITNFG   80 ONES          2795  1          =           FLAG  @XITNFG       Global exit request
 000001                00001 00001  2800             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   29
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2810             =*
                                    2811             =*  @XITDEL -- Delete an exit request
                                    2812             =*
0000000                00000 00004  2814             =@XITDEL  RECORD BEGIN
 000000                             2822  1          =@XITDID    DS    A             Exit request ID
 000004                00004 00004  2823             =         END   ,
-                                   2833             =*
                                    2834             =*  @XITDO -- Schedule an exit.
                                    2835             =*
 000000                00000 00020  2836             =@XITDO   RECORD BEGIN
 000000                             2844  1          =@XITRQID   DS    A             Request ID (from XITNEW)
 000004                             2845  1          =@XITTSK    DS    A             Task Id where this exit is to run
 000008                             2846  1          =@XITTYPE   DS    X             Exit type (Integer)
 00000C                             2847  1          =@XITQUAL   DS    A             Exit qualifier
 000010                             2848  1          =@XITPARM   DS    XL16          Exit parameter area
 000020                00020 00020  2849             =         END   ,
-                                   2859             =*
                                    2860             =*  @XITGPST -- Info about the status of the previous level of control
                                    2861             =*              used by XITGST and XITPST
                                    2862             =*
0000000                00000 00068  2864             =@XITGPST RECORD BEGIN
 000000                             2872  1          =@XITSPSW   DS    D             PSW
 000008                             2873  1          =@XITSGPR   DS    16F           GPRs
 000048                             2874  1          =@XITSFPR   DS    4D            FPRs
 000068                00068 00068  2875             =         END   ,
-                                   2885             =*
                                    2886             =*  @XITMASK -- Modify the current exit mask
                                    2887             =*
0000000                00000 00005  2889             =@XITMASK RECORD BEGIN
 000000                             2897  1          =@XITMSK    DS    A             Bit mask of the data
 000004 00                          2898  1          =@XITMREQ   FLAG  ,             Request type
 @XITMREQ.@XITMSO  00 EQ            2902  1          =           FLAG  (@XITMSO,0,EQ)  OR this data into the mask
 @XITMREQ.@XITMSN  01 EQ            2912  1          =           FLAG  (@XITMSN,1,EQ)  AND this data into the mask
 @XITMREQ.@XITMSS  02 EQ            2922  1          =           FLAG  (@XITMSS,2,EQ)  Store this data into the mask
 000005                00005 00005  2932             =         END   ,
-                                   2942             =*
                                    2943             =* Definition of the types of exits
                                    2944             =*
0                                   2946             =XITTPI   EQU    0          * Program interrupt
                                    2947             =XITTSVC  EQU    1          * Supervisor Call
                                    2948             =XITTRTC  EQU    2            Real time clock expiration
                                    2949             =XITTCTC  EQU    3            CPU time clock expiration
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   30
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   2950             =XITTPER  EQU    4            Program Event
                                    2951             =XITTMON  EQU    5            Monitor Call
                                    2952             =XITTLGO  EQU    6            Logoff
                                    2953             =XITTR07  EQU    7            -- reserved --
                                    2954             =XITTATTN EQU    8            Attention
                                    2955             =XITTIOCN EQU    9            I/O Completed normally
                                    2956             =XITTIOCA EQU   10            I/O Completed abnormally
-                                   2958             =*
                                    2959             =* Definition of the exit mask
                                    2960             =*
0000000                00000 00004  2962             =XITMSKD  RECORD BEGIN
                                    2970  1          =
 000000 00                          2971  1          =MITMK1     FLAG  ,             First byte of the mask
 MITMK1.XITMPI     80 ONES          2975  1          =           FLAG  XITMPI          Program interrupt
 MITMK1.XITMSVC    40 ONES          2980  1          =           FLAG  XITMSVC         Supervisor Call
 MITMK1.XITMRTC    20 ONES          2985  1          =           FLAG  XITMRTC         Real time clock expiration
 MITMK1.XITMCTC    10 ONES          2990  1          =           FLAG  XITMCTC         CPU time clock expiration
 MITMK1.XITMPER    08 ONES          2995  1          =           FLAG  XITMPER         Program Event
 MITMK1.XITMMON    04 ONES          3000  1          =           FLAG  XITMMON         Monitor Call
 MITMK1.XITMLGO    02 ONES          3005  1          =           FLAG  XITMLGO         Logoff
 MITMK1.XITMR07    01 ONES          3010  1          =           FLAG  XITMR07         -- reserved --
                                    3015  1          =
 000001 00                          3016  1          =MITMK2     FLAG  ,             Second byte of the mask
 MITMK2.XITMATTN   80 ONES          3020  1          =           FLAG  XITMATTN        Attention
 MITMK2.XITMIOCN   40 ONES          3025  1          =           FLAG  XITMIOCN        I/O Completed normally
 MITMK2.XITMIOCA   20 ONES          3030  1          =           FLAG  XITMIOCA        I/O Completed abnormally
                                    3035  1          =
 000002 00                          3036  1          =MITMK3     FLAG  ,             Third byte of the mask
                                    3040  1          =
 000003 00                          3041  1          =MITMK4     FLAG  ,             Fourth byte of the mask
 000004                00004 00004  3045             =         END   ,
-                                   3055             =*
                                    3056             =* Definition of Exit routine entry data area
                                    3057             =*
0000000                00000 00004  3059             =@XITDATA RECORD BEGIN
 000000                             3067  1          =@XITDSA    DS    A             Pointer to XITSAREA (exit status area)
 000004                00004 00004  3068             =         END   ,
-                                   3078             =*
                                    3079             =* Definition of the Exit Status area
                                    3080             =*
0000000                00000 0001C  3082             =XITSAREA RECORD BEGIN
 000000                             3090  1          =XITSRPRM   DS    A             Parm value for the Routine
 000004                             3091  1          =XITSTYPE   DS    X             Type of the exit
 000008                             3092  1          =XITSQUAL   DS    A             Exit Qualifier
 00000C                             3093  1          =XITSXPRM   DS    XL16          Exit parameter area
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   31
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000001C                0001C 0001C  3094             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   32
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   3104      30.              COPY  LOCKPARM
                                    3105             =*******************************************************************
                                    3106             =*                                                                 *
                                    3107             =*    LOCKPARM - Lock routine calling parms                        *
                                    3108             =*                                                                 *
                                    3109             =*******************************************************************
0000000                00000 00011  3111             =@LOCKCRE RECORD BEGIN
 000000                             3119  1          =@LOCKNAM   DS    CL16          Name of the lock
 000010 00                          3120  1          =@LOCKFL    FLAG  ,
 @LOCKFL.@LFSPIN   80 ONES          3124  1          =           FLAG  @LFSPIN       Spin type lock
 000011                00011 00011  3129             =         END   ,
                                    3138             =*
 000000                00000 00004  3139             =@LOCKS   RECORD BEGIN
 000000                             3147  1          =@LOCKID    DS    A             Lock id
 000004                00004 00004  3148             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   33
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   3158      32.              COPY  LISTPARM
                                    3159             =*   A list header block is used to control access to a chain
                                    3160             =* of resources.  All elements which are to be linked together on
                                    3161             =* these doubly linked circular lists must have the elements
                                    3162             =* first word be space for a forward list pointer, and the second
                                    3163             =* word space for a backward list pointer.
 000000                00000 0000C  3164             =LHEAD    RECORD BEGIN                  List descriptor
                                    3172  1          =           LHEAD PFX=LH
 000000                             3173  1 01-LHEAD +LHFP       DS    A                       Forward pointer
 000004                             3174  1 01-LHEAD +LHBP       DS    A                       Backward pointer
 000008                             3175  1 01-LHEAD +LHCNT      DS    A                       Number of elements in list
 00000C                0000C 0000C  3176             =         END   ,
0000000                00000 00008  3186             =LELEM    RECORD BEGIN                  Common start of list items
                                    3194  1          =           LELEM PFX=L
 000000                             3195  1 01-LELEM +LFP        DS    A                       Forward pointer
 000004                             3196  1 01-LELEM +LBP        DS    A                       Backward pointer
 000008                00008 00008  3197             =         END   ,
0000000                00000 00010  3207             =@LADD    RECORD BEGIN                  Add items to a list
 000000                             3215  1          =@LAHEAD    DS    A                       Header block of list
 000004                             3216  1          =@LA1ST     DS    A                       First item being added
 000008                             3217  1          =@LALAST    DS    A                       Last item being added
 00000C                             3218  1          =@LACNT     DS    A                       Number of items being added
 000010                00010 00010  3219             =         END   ,
0000000                00000 00010  3229             =@LREM    RECORD BEGIN                  Remove items from a list
 000000                             3237  1          =@LRHEAD    DS    A                       Header block of list
 000004                             3238  1          =@LR1ST     DS    A                       First item being removed
 000008                             3239  1          =@LRCNT     DS    A                       Number of items being removed
                                    3240  1          =* -- Return Parms --
 00000C                             3241  1          =@LRLAST    DS    A                       Last item removed
 000010                00010 00010  3242             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   34
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   3252      34.              COPY  SEGPARM
 000000                00000 0000D  3253             =@SEG     RECORD BEGIN        Used for SEG,T,B,TB,EOR,EOB
 000000                             3261  1          =@SEGCB     DS    A             Address of the seg control block
 000004                             3262  1          =@SEGLOC    DS    A             Location of the text segment to be added
 000008                             3263  1          =@SEGLEN    DS    A             Length of the text segment to be added
 00000C 00                          3264  1          =@SEGTYPE   FLAG  ,
 @SEGTYPE.@SEGB    80 ONES          3268  1          =           FLAG  @SEGB         Add a blank after the segment
 @SEGTYPE.@SEGT    40 ONES          3273  1          =           FLAG  @SEGT         Trim trailing blanks from the segment
 @SEGTYPE.@SEGTB   C0 NZ            3278  1          =           FLAG  (@SEGTB,@SEGB+@SEGT)    Trim trailing, and add 1 blank
 @SEGTYPE.@SEGMK   20 ONES          3289  1          =           FLAG  @SEGMK        Mark the buffer after this segment
 @SEGTYPE.@SEGEOR  10 ONES          3294  1          =           FLAG  @SEGEOR       This is the end of a logical record
 @SEGTYPE.@SEGEOB  08 ONES          3299  1          =           FLAG  @SEGEOB       This is the last segment for the buffer
 00000D                0000D 0000D  3304             =         END   ,
-000000                00000 0000E  3314             =@SEGINIT RECORD BEGIN
 000000                             3322  1          =@SEGICB    DS    A
 000004                             3323  1          =@SEGIRTN   DS    A             Address of the processing routine
 000008                             3324  1          =@SEGILOC   DS    A             Location of the buffer
 00000C                             3325  1          =@SEGILEN   DS    Y             Length of the buffer
 00000E                0000E 0000E  3326             =         END   ,
-000000                00000 00008  3336             =@SEGCOL  RECORD BEGIN
 000000                             3344  1          =@SEGCCB    DS    A             Address of the control block
 000004                             3345  1          =@SEGCNUM   DS    A             Column number to go to
 000008                00008 00008  3346             =         END   ,
-000000                00000 00018  3356             =@SEGCORE RECORD BEGIN
 000000                             3364  1          =@SEGXCB    DS    A             Control block address
 000004                             3365  1          =@SEGXLOC   DS    A             Location of the core (MVS VA)
 000008                             3366  1          =@SEGXLEN   DS    A             Length of the core to dump
 00000C                             3367  1          =@SEGXSPA   DS    X             # blank lines between each dump line
 00000D 00                          3368  1          =@SEGXFLG   FLAG  ,
 @SEGXFLG.@SEGXF16 80 ONES          3372  1          =           FLAG  @SEGXF16      16 Bytes per line  (32 bytes per line)
 @SEGXFLG.@SEGXFAL 40 ONES          3377  1          =           FLAG  @SEGXFAL      Alpha (EBCDIC)     (no EBCDIC)
 @SEGXFLG.@SEGXFOF 20 ONES          3382  1          =           FLAG  @SEGXFOF      Print offsets      (Print Addresses)
 @SEGXFLG.@SEGXFID 10 ONES          3387  1          =           FLAG  @SEGXFID      Print the id       (Dont print it)
 @SEGXFLG.@SEGXFRL 08 ONES          3392  1          =           FLAG  @SEGXFRL      Print repeat lines (Print summary)
 000010                             3397  1          =@SEGXOFF   DS    A             Address to be 0 offset
 000014                             3398  1          =@SEGXID    DS    CL4           Control block id
 000018                00018 00018  3399             =         END   ,
-000000                00000 00004  3409             =@SEGRTN  RECORD BEGIN                  Parameters to pass to proc rtn
 000000                             3417  1          =@SEGRCB    DS    A                       Address of control block
 000004                00004 00004  3418             =         END   ,
-000000                00000 00008  3428             =@SEGSTK  RECORD BEGIN
 000000                             3436  1          =@SEGSCB    DS    A                       Address of seg control block
 000004                             3437  1          =@SEGSST    DS    A                       Start of stack (from RTCB)
 000008                00008 00008  3438             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   35
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   3448      36.              COPY  PARMPARM
                                    3449             =*********************************************************************
                                    3450             =*                                                                   *
                                    3451             =*          Parameters to obtain initialization parameters           *
                                    3452             =*                                                                   *
                                    3453             =*********************************************************************
0000000                00000 00010  3455             =@PARMDO  RECORD BEGIN
 000000                             3463  1          =@PARILOC   DS    A                       Input location
 000004                             3464  1          =@PARILEN   DS    A                       | length
 000008                             3465  1          =@PAROLOC   DS    A                       Output location
 00000C                             3466  1          =@PAROLEN   DS    A                       | length
 000010                00010 00010  3467             =         END   ,
0000000                00000 00004  3477             =PARMIN   RECORD BEGIN
 000000 00                          3485  1          =PARMTYPE   FLAG  ,
 PARMTYPE.PARMFSTR 00 EQ            3489  1          =           FLAG  (PARMFSTR,0,EQ)         Return a string
 PARMTYPE.PARMFINT 04 EQ            3499  1          =           FLAG  (PARMFINT,4,EQ)         Return an integer
 PARMTYPE.PARMFYN  08 EQ            3509  1          =           FLAG  (PARMFYN,8,EQ)          Return Yea or Nay
 PARMTYPE.PARMFFLT 0C EQ            3519  1          =           FLAG  (PARMFFLT,12,EQ)        Return a floating point
 000001                             3529  1          =           DS    3X                      - Available -
 000004                             3530  1          =PARMKEYS   DS    0A                      Start of 8 byte keys
 000004                00004 00004  3531             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   36
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   3541      38.              COPY  PAGEPARM
                                    3542             =*
                                    3543             =*  Page fault return codes
                                    3544             =*
                                    3545             =@PFRINP  EQU   0                       Fault in progress
                                    3546             =@PFRADDR EQU   4                       Addressing exception
                                    3547             =@PFROK   EQU   8                       Fault resolved
                                    3548             =@PFRWAIT EQU   12                      Must wait for some resource
0000000                00000 00005  3550             =@PAGSWAP RECORD BEGIN
 000000                             3558  1          =@SWASB     DS    A                       Address of ASB being swapped
                                    3559  1          =* -- Return parameters --
 000004 00                          3560  1          =@SWFLG     FLAG  ,
 @SWFLG.@SWFINP    00 EQ            3564  1          =           FLAG  (@SWFINP,0,EQ)          Swap in progress
 @SWFLG.@SWFOK     04 EQ            3574  1          =           FLAG  (@SWFOK,4,EQ)           Swap done now
 @SWFLG.@SWFWAIT   08 EQ            3584  1          =           FLAG  (@SWFWAIT,8,EQ)         Must wait for some resource
 000005                00005 00005  3594             =         END   ,
0000000                00000 00004  3604             =@PAGSWADV RECORD BEGIN                 Give swap advice
 000000                             3612  1          =@ADVASB    DS    A                       ASB of advice
 000004                00004 00004  3613             =         END   ,
0000000                00000 0000D  3623             =@PAGWSMA RECORD BEGIN                  Working Set management
 000000                             3631  1          =@WSASB     DS    A                       ASB of AS to be managed
 000004                             3632  1          =@WSINT     DS    A                       Number of elapsed intervals
 000008                             3633  1          =@WSLIMIT   DS    A                       Maximum number of frames
 00000C 00                          3634  1          =@WSFLG     FLAG  ,
 @WSFLG.@WSFGLOB   80 ONES          3638  1          =           FLAG  @WSFGLOB                Manage Global AS
 00000D                0000D 0000D  3643             =         END   ,
0000000                00000 0000A  3653             =@PAGDEF  RECORD BEGIN                  Define a page
 000000                             3661  1          =@PDADDR    DS    A                       Page VA
 000004                             3662  1          =@PDLEN     DS    A                       Length of definition (bytes)
 000008                             3663  1          =@PDKEY     DS    X                       Storage key (+ key protect)
                                    3664  1          =* @PDHASH  DS    X                       Hash value for page
 000009 00                          3665  1          =@PDF1      FLAG  @PDFGLOB                In global memory
 @PDF1.@PDFGLOB    80 ONES
 @PDF1.@PDFPROT    40 ONES          3671  1          =           FLAG  @PDFPROT                Page table protection
 00000A                0000A 0000A  3676             =         END   ,
0000000                00000 0000A  3686             =@PAGSEGD RECORD BEGIN                  Define a segment
 000000                             3694  1          =@SDADDR    DS    A                       Segment address
 000004                             3695  1          =@SDLEN     DS    A                       Length of definition (bytes)
 000008                             3696  1          =@SDHASH    DS    X                       Hash value for segment
 000009 00                          3697  1          =@SDF1      FLAG  @SDFGLOB                In global memory
 @SDF1.@SDFGLOB    80 ONES
 00000A                0000A 0000A  3703             =         END   ,
0000000                00000 00008  3713             =@PAGASC1 RECORD BEGIN
 000000                             3721  1          =@ASCASB    DS    A                       ASB for AS being created
 000004                             3722  1          =@ASCWSLM   DS    A                       Maximum size of working set
 000008                00008 00008  3723             =         END   ,
0000000                00000 00005  3733             =@PAGASC2 RECORD BEGIN                  Address space creation
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   37
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000000                             3741  1          =@ASCVA     DS    A                       Virtual address of 1st PT
 000004                             3742  1          =@ASCKEY    DS    X                       Storage key (+ key protect)
 000005                00005 00005  3743             =         END   ,
0000000                00000 00009  3753             =@PAGE    RECORD BEGIN                  General paging routine parms
 000000                             3761  1          =@PAGLOC    DS    A                       Virtual address
 000004                             3762  1          =@PAGLEN    DS    A                       Length (in bytes)
 000008                             3763  1          =@PAGKEY    DS    X                       Key - where required
                                    3764  1          =@PAGHASH   EQU   @PAGKEY                 Hash - where required
 000009                00009 00009  3765             =         END   ,
0000000                00000 00008  3775             =@PAGRV   RECORD BEGIN                  Real to virtual translation
 000000                             3783  1          =@PAGRVAD   DS    A                       Real addr to be translated
                                    3784  1          =* -- Return parms --
 000004                             3785  1          =@PAGRVASB   DS   A                       Address space block
 000008                00008 00008  3786             =         END   ,
0000000                00000 00004  3796             =@PAGINTV RECORD BEGIN                  Paging management interval
 000000                             3804  1          =@PAGINT    DS    A                       Number of intervals in cycle
 000004                00004 00004  3805             =         END   ,
0000000                00000 00008  3815             =@PAGINIT RECORD BEGIN                  Global initialization
 000000                             3823  1          =@PAGIASB   DS    A                       Global ASB address
 000004                             3824  1          =@PAGIMEG   DS    A                       Maximum number of bytes in VA
 000008                00008 00008  3825             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   38
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   3835      40.     *******************************************************************
                                    3836      41.     *                                                                 *
                                    3837      42.     * This is the parameter list used in the PLO instruction. Refer   *
                                    3838      43.     * to the Principals of Operation for the format of this area.     *
                                    3839      44.     *                                                                 *
                                    3840      45.     *******************************************************************
 000000                00000 00090  3841      46.     #QUEPLO RECORD BEGIN
 000000                             3849  1   47.                DS    XL(4*36)            PLO parm list
 000090                00090 00090  3850      48.              END   ,
0                                   3860      50.     *******************************************************************
                                    3861      51.     *                                                                 *
                                    3862      52.     * Generic record for a double linked list head used in the list   *
                                    3863      53.     * manipulation routines.                                          *
                                    3864      54.     *                                                                 *
                                    3865      55.     *******************************************************************
 000000                00000 00010  3866      56.     #QUEW   RECORD BEGIN               Work record
                                    3874  1   57.     #QUE       QHEAD
 000000                             3875  1 01-01618 +           DS   0D
 000000                             3876  1 01-01619 +#QUE       DS   0XL(16)              Double linked PLO list
 000000                             3877  1 01-01620 +#QUEFP     DS    A                   Forward pointer
 000004                             3878  1 01-01621 +#QUEBP     DS    A                   Backward pointer
 000008                             3879  1 01-01622 +#QUESEQ    DS    A                   CDS sequence number
 00000C                             3880  1 01-01623 +#QUECNT    DS    A                   Count of items
 000010                00010 00010  3881      58.              END   ,
0                                   3891      60.              COPY  GRCOPY              Needed for VFILES display also
                                    3892             =*******************************************************************
                                    3893             =*                                                                 *
                                    3894             =* GRCT - General Resource Control Table                           *
                                    3895             =*        Pointed to out of the MAT                                *
                                    3896             =*                                                                 *
                                    3897             =*******************************************************************
 000000                00000 00020  3898             =GRCT    RECORD BEGIN               General Resource Pool Control
0000000 C7D9C3E3                    3907  1          =GRCBID     DC    CL4'GRCT'
 000004                             3908  1          =           DS    XL12                Spare
0                                   3910  1          =GRCAR      SHEAD                     Avail resource item list
 000010                             3911  1 01-01488 +GRCAR      DS   0D                   Single linked CDS list
 000010                             3912  1 01-01489 +GRCARFP    DS    A                   Forward pointer
 000014                             3913  1 01-01490 +GRCARSEQ   DS    A                   CDS sequence number
                                    3914  1          =GRCAH      SHEAD                     Avail resource hold item list
 000018                             3915  1 01-01488 +GRCAH      DS   0D                   Single linked CDS list
 000018                             3916  1 01-01489 +GRCAHFP    DS    A                   Forward pointer
 00001C                             3917  1 01-01490 +GRCAHSEQ   DS    A                   CDS sequence number
0000020                00020 00020  3919             =         END   ,
0                                   3929             =*******************************************************************
                                    3930             =*                                                                 *
                                    3931             =* GRITEM - General Resource Item                                  *
                                    3932             =*          There is an item for each General Resource defined in  *
                                    3933             =*          the system.                                            *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   39
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   3934             =*                                                                 *
                                    3935             =*******************************************************************
 000000                00000 00020  3936             =GRITEM  RECORD BEGIN               General Resource DCB Item
0000000 C7D9C5E2                    3945  1          =GRIBID     DC    CL4'GRES'
0000004                             3947  1          =GRICID     DS    A                   Creater id
0000008                             3949  1          =GRIHCNT    DS    A                   Count of holds
 00000C                             3950  1          =GRIWCNT    DS    A                   Count of waits
0                                   3952  1          =GRIHL      QHEAD                     Resource hold item list
 000010                             3953  1 01-01618 +           DS   0D
 000010                             3954  1 01-01619 +GRIHL      DS   0XL(16)              Double linked PLO list
 000010                             3955  1 01-01620 +GRIHLFP    DS    A                   Forward pointer
 000014                             3956  1 01-01621 +GRIHLBP    DS    A                   Backward pointer
 000018                             3957  1 01-01622 +GRIHLSEQ   DS    A                   CDS sequence number
 00001C                             3958  1 01-01623 +GRIHLCNT   DS    A                   Count of items
0000020                00020 00020  3960             =         END   ,
0                                   3970             =*******************************************************************
                                    3971             =*                                                                 *
                                    3972             =* GRHITM - General Resource Hold item                             *
                                    3973             =*          One of these is created for every hold request for a   *
                                    3974             =*          resource item and is deleted when the resource hold is *
                                    3975             =*          released.                                              *
                                    3976             =*                                                                 *
                                    3977             =*******************************************************************
 000000                00000 00020  3978             =GRHITM   RECORD BEGIN              General Resource Hold Item
0000000                             3987  1          =GRHFP      DS    A                   Forward chain pointer
 000004                             3988  1          =GRHBP      DS    A                   Backward chain pointer
0000008 C7D9C840                    3990  1          =GRHBID     DC    CL4'GRH'
000000C 00                          3992  1          =GRHXBS     FLAG  ,
 GRHXBS.GRHXHOLD   80 ONES          3996  1          =           FLAG  GRHXHOLD            Resource held (not waiting)
 GRHXBS.GRHXEXCL   40 ONES          4001  1          =           FLAG  GRHXEXCL            Hold resource exclusivly
 GRHXBS.GRHXX2S    20 ONES          4006  1          =           FLAG  GRHXX2S             Hold changed from excl to shr
 GRHXBS.GRHXCANC   10 ONES          4011  1          =           FLAG  GRHXCANC            Wait cancelled
 00000D                             4016  1          =GRHRTN     DS    XL3                 Caller return address
0000010                             4018  1          =GRHGRIT    DS    A                   GR item this belongs to
0000014                             4020  1          =GRHASB     DS    A                   Address space id
 000018                             4021  1          =GRHPIDP    DS    D                   Post ID
 000020                00020 00020  4022             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   40
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   4032      62.     *******************************************************************
                                    4033      63.     *                                                                 *
                                    4034      64.     *   GRINI - Initialize a General Resource Control Table           *
                                    4035      65.     *                                                                 *
                                    4036      66.     *     Input - None                                                *
                                    4037      67.     *                                                                 *
                                    4038      68.     *     Output - None                                               *
                                    4039      69.     *                                                                 *
                                    4040      70.     *     This table is anchored out of the MAT. Modifications to     *
                                    4041      71.     *     this control block are serialized using the PLO, CDS and    *
                                    4042      72.     *     CS instruchtions.                                           *
                                    4043      73.     *                                                                 *
                                    4044      74.     *******************************************************************
 000016                             4045      75.     GRINIT   PROC  SCOPE=GLOBAL
 000016 C7D9C9D5C9E34040            4051             +
 00001E 0000/0000                   4052             +
 000022 900F D004/18AF       00004  4054             +
 USING  GRINIT,R10
 000028 50D0 C000/18CD       00000  4069             +
 00002E 9680 C000      00000        4071             +
 000032 41D0 C048            00048  4072             +
 USING  GRCT,R6                     4073      76.              WITH  (GRCT,RX)
 USING  @VMGET-72,R13               4086      77.              VMGET L'GRCT,LOC=GLOBHI,FIX=YES
 000036 D70A D048 D048 00000 00000  4110             +
 00003C 4100 0020            00020  4122             +
 000040 5000 D048            00000  4127             +
 000044 D201 D050 ABDE 00008 00C00  4128             +
 00004A 58F0 AB9E/0DEF       00BC0  4131             +
 000050 1260/4770 A064       00086  4133      78.              IF    ('LTR RX,RVR',ZERO),'ABORT NOGRCTMEM'
 000056 AC04 021B      0021B        4150  1          +
 00005A 9680 021A      0021A        4156  1          +
 00005E 50F0 021C            0021C  4157  1          +
 000062 58F0 0210            00210  4158  1          +
 000066 89F0 0010            00010  4159  1          +
 00006A 88F0 0010            00010  4160  1          +
 00006E 41F0 F000            00000  4161  1          +
 000072 AEFF 0006            00006  4162  1          +
 000076 D5D6C7D9C3E3D4C5            4163             +
 000086                             4168      79.              CLEAR GRCT
 000086 D71F 6000 6000 00000 00000  4174             +
 00008C D203 6000 ABA2 00000 00BC4  4175      80.              MVC   GRCBID,=CL4'GRCT'   Set block id
 000092 5810 0200            00200  4176      81.              L     R1,MATPTR
 000096 5060 1038            00038  4177      82.              WITH  (MAT,R1),'ST RX,MATGRCT' Set GRCT pointer
 USING  MAT,R1
 DROP   MAT,R1
 00009A 1B00                        4201      83.              CLEAR RVR
 00009C 981F C008            00008  4205      84.              PEND  ,
 DROP   GRCT,R6
 DROP   GRINIT,R10
 0000A0 9680 C000/0B0E 00000        4220             +
 DROP   @VMGET-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   41
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   4230      86.     *******************************************************************
                                    4231      87.     *                                                                 *
                                    4232      88.     *   GRCRE - Create a new General Resource item                    *
                                    4233      89.     *                                                                 *
                                    4234      90.     *     Input - None                                                *
                                    4235      91.     *                                                                 *
                                    4236      92.     *     Output - General Resource ID (pointer to the table item)    *
                                    4237      93.     *                                                                 *
                                    4238      94.     *     This table is anchored out of the GRCT in a double linked   *
                                    4239      95.     *     list. It is not really necessary to have these items linked *
                                    4240      96.     *     together and this may be changed later. This feature will   *
                                    4241      97.     *     assist in problem determination during this phase of        *
                                    4242      98.     *     development. It may also be used in gathering performance   *
                                    4243      99.     *     statistics in which case it would not be removed.           *
                                    4244     100.     *     Modifications to this memory block are serialized using the *
                                    4245     101.     *     PLO instruction.                                            *
                                    4246     102.     *                                                                 *
                                    4247     103.     *******************************************************************
 0000A6                             4248     104.     GRCRE    PROC  @GRES,SCOPE=GLOBAL
 0000A6 C7D9C3D9C5404040            4254             +
 0000AE 0010/0000                   4255             +
 0000B2 900F D004/18AF       00004  4257             +
 USING  GRCRE,R10
 0000B8 50D0 C000/18CD       00000  4272             +
 0000BE 9680 C000      00000        4274             +
 USING  @GRES-72,R12
 0000C2 41D0 C058            00058  4288             +
0USING  GRCT,R6                     4290     106.              WITH  ((GRCT,RX),(GRITEM,RJ))
 USING  GRITEM,R4
00000C6 5810 0200            00200  4314     108.              L     R1,MATPTR
 0000CA 5860 1038            00038  4315     109.              WITH  (MAT,R1),'L RX,MATGRCT' Get control block ptr
 USING  MAT,R1
 DROP   MAT,R1
0                                   4340     111.              SAVAIL HEAD=GRCAR,LEN=L'GRITEM,FIX=YES Get an avail res item
 0000CE 9801 6010            00010  4343    02-01537 +         LM    RVR,RS,GRCAR        Get fwd and sequence number
 0000D2                             4348    05-LABEL +$$$15S   DS    0H
 0000D2 1200                        4358  1 05-$REL  +           LTR   RVR,RVR
 0000D4 4780 A038            000EA  4361  1 04-$BC   +           BC    8,$$$15F
 0000D8                             4364  1 05-LABEL +$$$16F     DS    0H
 0000D8 18E0                        4367  1 02-01540 +           LR    R14,RVR             Point to first item
 0000DA 58EE 0000            00000  4368  1 02-01541 +           L     R14,0(R14)          Get fwd pointer
 0000DE 41F1 0001            00001  4369  1 02-01542 +           LA    R15,1(RS)           Increment sequence
 0000E2 BB0E 6010            00010  4370    02-01543 +         CDS   RVR,R14,GRCAR       Remove item from list
 0000E6 4770 A020            000D2  4384    06-$BC   +         BC    7,$$$15S
 0000EA 1200/4770 A08E       00140  4387    07-LABEL +$$$15F   DS    0H
 USING  @VMGET-72,R13               4406  1 02-VMGET +*,                                     Storage from pool 63
 0000F0 D70A D048 D048 00000 00000  4429  1          +
 0000F6 4100 0020            00020  4441  1          +
 0000FA 5000 D048            00000  4446  1          +
 0000FE D201 D050 AB4E 00008 00C00  4447  1          +
 000104 58F0 AB0E/0DEF       00BC0  4450  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   42
0Current Usings:  (PZERO,R0) (GRITEM,R4) (GRCT,R6) (GRCRE,R10) (@GRES-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000010A 1200/4770 A08E       00140  4459  1          +
 000110 AC04 021B      0021B        4469  2          +
 000114 9680 021A      0021A        4475  2          +
 000118 50F0 021C            0021C  4476  2          +
 00011C 58F0 0210            00210  4477  2          +
 000120 89F0 0010            00010  4478  2          +
 000124 88F0 0010            00010  4479  2          +
 000128 41F0 F000            00000  4480  2          +
 00012C AEFF 0006            00006  4481  2          +
 000130 D5D66DD4C5D46DC7            4482  1          +
 000140 1840                        4491     112.              LR    RJ,RVR              Set pointer
0000142                             4493     114.              CLEAR GRITEM              Clear the item
 000142 D71F 4000 4000 00000 00000  4499             +
 000148 D203 4000 AB16 00000 00BC8  4500     115.              MVC   GRIBID,=CL4'GRES' Set id
 00014E D203 4004 C048 00004 00000  4501     116.              MVC   GRICID,@GRCID       Set caller id
0000154 4110 4010            00010  4503     118.              LA    R1,GRIHL            Initialize list
 000158 5010 4010            00010  4504     119.              ST    R1,GRIHLFP
 00015C 5010 4014            00014  4505     120.              ST    R1,GRIHLBP
0000160 4100 4000            00000  4507     122.              LA    RVR,GRITEM          Set return
 000164 981F C008            00008  4508     123.              PEND  ,
 DROP   GRITEM,R4
 DROP   GRCT,R6
 DROP   @GRES-72,R12
 DROP   GRCRE,R10
 000168 9680 C000/0B0E 00000        4533             +
 DROP   @VMGET-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   43
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   4543     125.     *******************************************************************
                                    4544     126.     *                                                                 *
                                    4545     127.     *   GRDEL - Delete a General Resource item (oposite of create)    *
                                    4546     128.     *                                                                 *
                                    4547     129.     *     Input - General Resource ID (pointer to the table item)     *
                                    4548     130.     *                                                                 *
                                    4549     131.     *     Output - None                                               *
                                    4550     132.     *                                                                 *
                                    4551     133.     *******************************************************************
 00016E                             4552     134.     GRDEL    PROC  @GRES,SCOPE=GLOBAL
 00016E C7D9C4C5D3404040            4558             +
 000176 0010/0000                   4559             +
 00017A 900F D004/18AF       00004  4561             +
 USING  GRDEL,R10
 000180 50D0 C000/18CD       00000  4576             +
 000186 9680 C000      00000        4578             +
 USING  @GRES-72,R12
 00018A 41D0 C058            00058  4592             +
0USING  GRCT,R6                     4594     136.              WITH  ((GRCT,RX),(GRITEM,RJ))
 USING  GRITEM,R4
 00018E 5840 C04C            00004  4617     137.              L     RJ,@GRID            Set item base
 000192 5810 0200            00200  4618     138.              L     R1,MATPTR
 000196 5860 1038            00038  4619     139.              WITH  (MAT,R1),'L RX,MATGRCT' Get control block ptr
 USING  MAT,R1
 DROP   MAT,R1
000019A                             4644     141.              CLEAR GRITEM              Clear the avail item
 00019A D71F 4000 4000 00000 00000  4650             +
                                    4651     142.     * Note: GRIBID is not used here because of free list chain address
 0001A0 D203 4004 AA52 00004 00BCC  4652     143.              MVC   GRICID,=CL4'gRES'   Set id
0                                   4654     145.              SPUSH HEAD=GRCAR,ITEM=GRITEM Add to avail res item list
 0001A6 98EF 6010            00010  4656    01-01509 +         LM    R14,R15,GRCAR       Get fwd ptr and sequence number
 0001AA 4100 4000            00000  4657    01-01510 +         LA    RVR,GRITEM          Point to new item
 0001AE                             4662    04-LABEL +$$$22S   DS    0H
 0001AE 411F 0001            00001  4664  1 01-01512 +           LA    RS,1(R15)           Increment sequence
 0001B2 D203 4000 6010 00000 00010  4665  1 01-01513 +           MVC   GRITEM(L'GRCARFP),GRCARFP   Set item fwd ptr
 0001B8 BBE0 6010            00010  4666    01-01514 +         CDS   R14,RVR,GRCAR       Add item to list
 0001BC 4770 A034            001AE  4680    05-$BC   +         BC    7,$$$22S
 0001C0                             4683    06-LABEL +$$$22F   DS    0H
00001C0 1B00                        4688     147.              CLEAR RVR                 Set return ok
 0001C2 981F C008            00008  4692     148.              PEND  ,
 DROP   GRITEM,R4
 DROP   GRCT,R6
 DROP   @GRES-72,R12
 DROP   GRDEL,R10
 0001C6 9680 C000/0B0E 00000        4717             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   44
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   4724     150.     *******************************************************************
                                    4725     151.     *                                                                 *
                                    4726     152.     *   GRGET - Get a hold of a General Resource item                 *
                                    4727     153.     *                                                                 *
                                    4728     154.     *     Input - General Resource ID (pointer to the table item)     *
                                    4729     155.     *                                                                 *
                                    4730     156.     *     Output - General Resource Hold ID (pointer to hold item)    *
                                    4731     157.     *                                                                 *
                                    4732     158.     *                    -- or --                                     *
                                    4733     159.     *                                                                 *
                                    4734     160.     *              Zero under two conditions:                         *
                                    4735     161.     *                                                                 *
                                    4736     162.     *               WAIT=NO and a wait for hold would be required     *
                                    4737     163.     *                                                                 *
                                    4738     164.     *               WAIT=YES and the hold request was cancelled       *
                                    4739     165.     *                        while it was waiting for hold            *
                                    4740     166.     *                                                                 *
                                    4741     167.     *******************************************************************
 000000                00000 00001  4742     168.     #GRGET  RECORD BEGIN
 000000 00                          4750  1  169.     #GRGETF    FLAG  ,
 #GRGETF.#GRGETW   80 ONES          4754  1  170.                FLAG  #GRGETW             Wait flag
 000001                00001 00001  4759     171.              END   ,
00001CC                             4769     173.     GRGET    PROC  @GRES,#GRGET,SCOPE=GLOBAL
 0001CC C7D9C7C5E3404040            4775             +
 0001D4 0010/0008                   4776             +
 0001D8 900F D004/18AF       00004  4778             +
 USING  GRGET,R10
 0001DE 50D0 C000/18CD       00000  4793             +
 0001E4 9680 C000      00000        4795             +
 USING  @GRES-72,R12
 AUSING (#GRGET,@GRES+16)
 0001E8 41D0 C060            00060  4814             +
0USING  GRCT,R6                     4816     175.              WITH  ((GRCT,RX),(GRITEM,RJ),(GRHITM,RM))
 USING  GRITEM,R4
 USING  GRHITM,R8
 USING  H.GRHITM,R5                 4848     176.              WITH  (GRHITM,RK),LABEL=H Last hold item in list
00001EC 187E                        4857     178.              LR    RY,R14              Save return address
 0001EE 5840 C04C            00004  4858     179.              L     RJ,@GRID            Set res item base
 0001F2                             4859     180.              IF    (GRIBID,NE,=CL4'GRES'),'ABORT BADGRGET1'
 0001F2 D503 A9F0 4000 00BC8 00000  4870             +
 0001F8 4780 A054            0022C  4871             +
 0001FC AC04 021B      0021B        4880  1          +
 000200 9680 021A      0021A        4886  1          +
 000204 50F0 021C            0021C  4887  1          +
 000208 58F0 0210            00210  4888  1          +
 00020C 89F0 0010            00010  4889  1          +
 000210 88F0 0010            00010  4890  1          +
 000214 41F0 F000            00000  4891  1          +
 000218 AEFF 0006            00006  4892  1          +
 00021C C2C1C4C7D9C7C5E3            4893             +
 00022C 5810 0200            00200  4898     181.              L     R1,MATPTR
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   45
0Current Usings:  (PZERO,R0) (GRITEM,R4) (H.GRHITM,R5) (GRCT,R6) (GRHITM,R8) (GRGET,R10) (@GRES-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000230 5860 1038            00038  4899     182.              WITH  (MAT,R1),'L RX,MATGRCT' Get control block ptr
 USING  MAT,R1
 DROP   MAT,R1
0                                   4924     184.              SAVAIL HEAD=GRCAH,LEN=L'GRHITM,FIX=YES Get an avail hold item
 000234 9801 6018            00018  4927    02-01537 +         LM    RVR,RS,GRCAH        Get fwd and sequence number
 000238                             4932    05-LABEL +$$$27S   DS    0H
 000238 1200                        4942  1 05-$REL  +           LTR   RVR,RVR
 00023A 4780 A078            00250  4945  1 04-$BC   +           BC    8,$$$27F
 00023E                             4948  1 05-LABEL +$$$28F     DS    0H
 00023E 18E0                        4951  1 02-01540 +           LR    R14,RVR             Point to first item
 000240 58EE 0000            00000  4952  1 02-01541 +           L     R14,0(R14)          Get fwd pointer
 000244 41F1 0001            00001  4953  1 02-01542 +           LA    R15,1(RS)           Increment sequence
 000248 BB0E 6018            00018  4954    02-01543 +         CDS   RVR,R14,GRCAH       Remove item from list
 00024C 4770 A060            00238  4968    06-$BC   +         BC    7,$$$27S
 000250 1200/4770 A0CE       002A6  4971    07-LABEL +$$$27F   DS    0H
 USING  @VMGET-72,R13               4990  1 02-VMGET +*,                                     Storage from pool 63
 000256 D70A D048 D048 00000 00000  5013  1          +
 00025C 4100 0020            00020  5025  1          +
 000260 5000 D048            00000  5030  1          +
 000264 D201 D050 AA28 00008 00C00  5031  1          +
 00026A 58F0 A9E8/0DEF       00BC0  5034  1          +
 000270 1200/4770 A0CE       002A6  5043  1          +
 000276 AC04 021B      0021B        5053  2          +
 00027A 9680 021A      0021A        5059  2          +
 00027E 50F0 021C            0021C  5060  2          +
 000282 58F0 0210            00210  5061  2          +
 000286 89F0 0010            00010  5062  2          +
 00028A 88F0 0010            00010  5063  2          +
 00028E 41F0 F000            00000  5064  2          +
 000292 AEFF 0006            00006  5065  2          +
 000296 D5D66DD4C5D46DC7            5066  1          +
 0002A6 1880                        5075     185.              LR    RM,RVR              Set pointer
 0002A8                             5076     186.              CLEAR GRHITM
 0002A8 D71F 8000 8000 00000 00000  5082             +
 0002AE D203 8008 A9F8 00008 00BD0  5083     187.              MVC   GRHBID,=CL4'GRH'
 0002B4 5040 8010            00010  5084     188.              ST    RJ,GRHGRIT          set GRITEM ptr
 0002B8 D203 8014 0208 00014 00208  5085     189.              MVC   GRHASB,PZCURASB     set addr space id
 0002BE BE77 800D            0000D  5086     190.              ST3   RY,GRHRTN           save return addr (dump clue)
 0002C2 9140 C050      00008        5088     191.              IF    (@GREXCL),'SET GRHXEXCL' set to exclusive hold
 0002C6 47E0 A0F6            002CE  5098             +
 0002CA 9640 800C      0000C        5109             +
0DROP   @VMGET-72,R13               5115     193.              PSET  @QUE
 USING  @QUE-72,R13
 0002CE D70F D048 D048 00000 00000  5135             +
 0002D4 9823 4018            00018  5136     194.              LM    RA,RB,GRIHLSEQ
 0002D8 9023 D048            00000  5137     195.              STM   RA,RB,@QUESEQ       Set sequence stuff
 0002DC 5080 D050            00008  5138     196.              PMOV  @QUEITM,LA:GRHITM   Set item to add
 0002E0 4100 4010            00010  5149     197.              PMOV  @QUELHD,LA:GRIHL    Set list head
 0002E4 5000 D054            0000C  5165             +
00002E8                             5167     199.              LOOP  BEGIN
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   46
0Current Usings:  (PZERO,R0) (GRITEM,R4) (H.GRHITM,R5) (GRCT,R6) (GRHITM,R8) (GRGET,R10) (@GRES-72,R12) (@QUE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00002E8                             5174  1  201.                IF    (GRIBID,NE,=CL4'GRES'),'ABORT BADGRGET2'
 0002E8 D503 A9F0 4000 00BC8 00000  5185  1          +
 0002EE 4780 A14A            00322  5186  1          +
 0002F2 AC04 021B      0021B        5195  2          +
 0002F6 9680 021A      0021A        5201  2          +
 0002FA 50F0 021C            0021C  5202  2          +
 0002FE 58F0 0210            00210  5203  2          +
 000302 89F0 0010            00010  5204  2          +
 000306 88F0 0010            00010  5205  2          +
 00030A 41F0 F000            00000  5206  2          +
 00030E AEFF 0006            00006  5207  2          +
 000312 C2C1C4C7D9C7C5E3            5208  1          +
0000322 5850 4014            00014  5214  1  203.                L     RK,GRIHLBP          Point to last item
0                                   5216  1  205.     * Check if new entry needs to wait
0                                   5218  1  207.     * First, empty hold list
 000326                             5219  1  208.                IF    (GRIHLCNT,EQ,=A(0)),'SET GRHXHOLD' Empty list
 000326 D503 A9FC 401C 00BD4 0001C  5230  1          +
 00032C 4770 A15C            00334  5231  1          +
 000330 9680 800C      0000C        5242  1          +
                                    5247  1  209.     * Second, last item waiting
 000334 A160           00334 0032E  5248  1  210.                ELSEIF (~H:GRHXHOLD),'CLEAR GRHXHOLD' must wait too
 000334 47F0 A16C            00344  5254  1          +
 000338 9180 500C      0000C        5266  1          +
 00033C 4710 A16C            00344  5267  1          +
 000340 947F 800C      0000C        5279  1          +
                                    5284  1  211.     * Third, resource held exclusive or this wants excl
 000344 A170           00344 0033E  5285  1  212.                ELSEIF (H:GRHXEXCL,OR,GRHXEXCL),'CLEAR GRHXHOLD'
 000344 47F0 A184            0035C  5291  1          +
 000348 9140 500C      0000C        5305  1          +
 00034C 4710 A180            00358  5308  1          +
 000350 9140 800C      0000C        5317  1          +
 000354 47E0 A184            0035C  5318  1          +
 000358 947F 800C      0000C        5330  1          +
                                    5335  1  213.     * Fourth, resource held in share mode
 00035C A188           0035C 00356  5336  1  214.                ELSE   'SET GRHXHOLD'     It is nice to share
 00035C 47F0 A18C            00364  5341  1          +
 000360 9680 800C      0000C        5353  1          +
0000364 1B99                        5359  1  216.                CLEAR RN                  Init return value
 000366 947F C058      00000        5363  1  217.                CLEAR #GRGETW             Clear wait flag
000036A 9180 C050      00008        5371  1  219.                IF    (~@GRWAIT,AND,~GRHXHOLD),EXIT must wait but can't
 00036E 4710 A1A2            0037A  5383  1          +
 000372 9180 800C      0000C        5394  1          +
 000376 47E0 A1BC            00394  5397  1          +
000037A 1898                        5404  1  221.                LR    RN,RM               Set return value
 00037C 9180 800C      0000C        5405  1  222.                IF    (~GRHXHOLD),'SET #GRGETW' Set to wait necessary
 000380 4710 A1B0            00388  5415  1          +
 000384 9680 C058      00000        5426  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   47
0Current Usings:  (PZERO,R0) (GRITEM,R4) (H.GRHITM,R5) (GRCT,R6) (GRHITM,R8) (GRGET,R10) (@GRES-72,R12) (@QUE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000388 58F0 AA00/0DEF       00BD8  5432  1  224.                ACALL QUEUE               Add to the end of the list
000038E 1200/4770 A110       002E8  5440     226.              UNTIL (RVR,Z),END
0000394 9180 C058      00000        5463     228.              IF    (#GRGETW),BEGIN     must wait
 000398 47E0 A20C            003E4  5473             +
 DROP   @QUE-72,R13                 5478  1  229.                AWAIT GRHPIDP,LEN=LONG    wait for hold
 USING  @AWAIT-72,R13
 00039C D704 D048 D048 00000 00000  5499  1          +
 0003A2 4100 8018            00018  5511  1          +
 0003A6 5000 D048            00000  5516  1          +
 0003AA 9680 D04C      00004        5522  1          +
 0003AE 58F0 AA04/0DEF       00BDC  5525  1          +
 DROP   @AWAIT-72,R13               5527  1  230.                PSET  @SYSRDEL            Release system routine ID
 USING  @SYSRDEL-72,R13
 0003B4 D703 D048 D048 00000 00000  5547  1          +
 0003BA 5000 D048            00000  5548  1  231.                PMOV  @SYSRDID,(RVR)
 0003BE 58F0 AA08/0DEF       00BE0  5558  1  232.                VCALL SYSRDEL
0                                   5563  1  234.     * Note: item not anchored if cancelled (see grcan)
 0003C4 9110 800C      0000C        5564  1  235.                IF    (GRHXCANC),BEGIN
 0003C8 47E0 A1F6            003CE  5574  1          +
 0003CC 1B99                        5579  2  236.                  CLEAR RN                  Posted by cancel request
 0003CE                             5583  1  237.                END   ,                   End if
 0003CE A1FA           003CE 003CA  5587  1  238.                ELSE  'INCRS GRIWCNT'     Count number of waits
 0003CE 47F0 A20C            003E4  5592  1          +
 0003D2 58E0 400C/18FE       0000C  5600  2          +
 0003D8 5EF0 AA0C            00BE4  5610  3          +
 0003DC BAEF 400C            0000C  5611  2          +
 0003E0 4770 A1FE            003D6  5625  1          +
 0003E4                             5635     239.              END
00003E4 1299/4770 A238       00410  5640     241.              IF    (RN,Z),BEGIN        No hold, put it back
 0003EA                             5654  1  242.                CLEAR GRHITM
 0003EA D71F 8000 8000 00000 00000  5660  1          +
 0003F0 D203 8008 AA10 00008 00BE8  5661  1  243.                MVC   GRHBID,=CL4'gRH'
                                    5662  1  244.                SPUSH HEAD=GRCAH,ITEM=GRHITM Add to avail hold item list
 0003F6 98EF 6018            00018  5664  1 01-01509 +           LM    R14,R15,GRCAH       Get fwd ptr and sequence number
 0003FA 4100 8000            00000  5665  1 01-01510 +           LA    RVR,GRHITM          Point to new item
 0003FE                             5670  1 04-LABEL +$$$55S     DS    0H
 0003FE 411F 0001            00001  5672  2 01-01512 +             LA    RS,1(R15)           Increment sequence
 000402 D203 8000 6018 00000 00018  5673  2 01-01513 +             MVC   GRHITM(L'GRCAHFP),GRCAHFP   Set item fwd ptr
 000408 BBE0 6018            00018  5674  1 01-01514 +           CDS   R14,RVR,GRCAH       Add item to list
 00040C 4770 A226            003FE  5688  1 05-$BC   +           BC    7,$$$55S
 000410                             5691  1 06-LABEL +$$$55F     DS    0H
 000410                             5695     245.              END   ,
 000410 A23C           00410 003E8  5699     246.              ELSE  BEGIN
 000410 47F0 A24E            00426  5704             +
 000414 58E0 4008/18FE       00008  5710  1  247.                INCRS GRIHCNT             Count number of holds
 00041A 5EF0 AA0C            00BE4  5721  2          +
 00041E BAEF 4008            00008  5722  1          +
 000422 4770 A240            00418  5736  1          +
 000426                             5742     248.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   48
0Current Usings:  (PZERO,R0) (GRITEM,R4) (H.GRHITM,R5) (GRCT,R6) (GRHITM,R8) (GRGET,R10) (@GRES-72,R12) (@SYSRDEL-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000426 1809                        5747     250.              LR    RVR,RN              Set return value
0000428 981F C008            00008  5749     252.              PEND  ,
 DROP   H.GRHITM,R5
 DROP   GRHITM,R8
 DROP   GRITEM,R4
 DROP   GRCT,R6
 DROP   @GRES-72,R12
 DROP   GRGET,R10
 00042C 9680 C000/0B0E 00000        5787             +
 DROP   @SYSRDEL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   49
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   5797     254.     *******************************************************************
                                    5798     255.     *                                                                 *
                                    5799     256.     *   GRREL - Release a general resource hold                       *
                                    5800     257.     *                                                                 *
                                    5801     258.     *     Input - General Resource Hold ID (pointer to hold item)     *
                                    5802     259.     *             or General Resource ID (not valid to release holds  *
                                    5803     260.     *             obtained in share mode)                             *
                                    5804     261.     *                                                                 *
                                    5805     262.     *     Output - None                                               *
                                    5806     263.     *                                                                 *
                                    5807     264.     *******************************************************************
 000000                00000 00001  5808     265.     #GRREL  RECORD BEGIN
 000000                             5816  1  266.                DS    XL(L'GRHXBS)          Work record
 000001                00001 00001  5817     267.              END   ,
0000432                             5827     269.     GRREL    PROC  @GRES,#GRREL,SCOPE=GLOBAL
 000432 C7D9D9C5D3404040            5833             +
 00043A 0010/0008                   5834             +
 00043E 900F D004/18AF       00004  5836             +
 USING  GRREL,R10
 000444 50D0 C000/18CD       00000  5851             +
 00044A 9680 C000      00000        5853             +
 USING  @GRES-72,R12
 AUSING (#GRREL,@GRES+16)
 00044E 41D0 C060            00060  5872             +
 USING  GRCT,R6                     5873     270.              WITH  ((GRCT,RX),(GRITEM,RJ),(GRHITM,RM))
 USING  GRITEM,R4
 USING  GRHITM,R8
 USING  N.GRHITM,R9                 5905     271.              WITH  (GRHITM,RN),LABEL=N Next item
 USING  W.GRHXBS,R5                 5913     272.              WITH  (GRHXBS,RK),LABEL=W Work flags
0000452 5880 C04C            00004  5922     274.              L     RM,@GRID            Set hold item pointer
 000456 1848                        5923     275.              LR    RJ,RM               Might be a Resource id
0000458                             5925     277.              IF    (GRIBID,EQ,=CL4'GRES'),BEGIN
 000458 D503 A78A 4000 00BC8 00000  5936             +
 00045E 4770 A0A2            004E0  5937             +
                                    5942  1  278.     * Must be exclusive or had been exclusive changed to share
                                    5943  1  279.     * so that the item is necessarily the first on the hold list
 000462 5880 4010            00010  5944  1  280.                L     RM,GRIHLFP          Get first hold item
 000466                             5945  1  281.                IF    (GRIHLCNT,EQ,=A(0)),'ABORT BADGRREL0'
 000466 D503 A796 401C 00BD4 0001C  5956  1          +
 00046C 4770 A062            004A0  5957  1          +
 000470 AC04 021B      0021B        5966  2          +
 000474 9680 021A      0021A        5972  2          +
 000478 50F0 021C            0021C  5973  2          +
 00047C 58F0 0210            00210  5974  2          +
 000480 89F0 0010            00010  5975  2          +
 000484 88F0 0010            00010  5976  2          +
 000488 41F0 F000            00000  5977  2          +
 00048C AEFF 0006            00006  5978  2          +
 000490 C2C1C4C7D9D9C5D3            5979  1          +
 0004A0 9140 800C      0000C        5984  1  282.                IF    (~GRHXEXCL,AND,~GRHXX2S),'ABORT BADGRREL1'
 0004A4 4710 A0A2            004E0  5996  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   50
0Current Usings:  (PZERO,R0) (GRITEM,R4) (W.GRHXBS,R5) (GRCT,R6) (GRHITM,R8) (N.GRHITM,R9) (GRREL,R10) (@GRES-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00004A8 9120 800C      0000C        6007  1          +
 0004AC 4710 A0A2            004E0  6008  1          +
 0004B0 AC04 021B      0021B        6017  2          +
 0004B4 9680 021A      0021A        6023  2          +
 0004B8 50F0 021C            0021C  6024  2          +
 0004BC 58F0 0210            00210  6025  2          +
 0004C0 89F0 0010            00010  6026  2          +
 0004C4 88F0 0010            00010  6027  2          +
 0004C8 41F0 F000            00000  6028  2          +
 0004CC AEFF 0006            00006  6029  2          +
 0004D0 C2C1C4C7D9D9C5D3            6030  1          +
 0004E0                             6035     283.              END   ,                   End if
 0004E0 A0A6           004E0 00460  6039     284.              ELSE  'L RJ,GRHGRIT'      Set res item base
 0004E0 47F0 A0AA            004E8  6044             +
 0004E4 5840 8010            00010  6051             +
00004E8                             6057     286.              IF    (GRHBID,NE,=CL4'GRH'),'ABORT BADGRREL2'
 0004E8 D503 A792 8008 00BD0 00008  6068             +
 0004EE 4780 A0E4            00522  6069             +
 0004F2 AC04 021B      0021B        6078  1          +
 0004F6 9680 021A      0021A        6084  1          +
 0004FA 50F0 021C            0021C  6085  1          +
 0004FE 58F0 0210            00210  6086  1          +
 000502 89F0 0010            00010  6087  1          +
 000506 88F0 0010            00010  6088  1          +
 00050A 41F0 F000            00000  6089  1          +
 00050E AEFF 0006            00006  6090  1          +
 000512 C2C1C4C7D9D9C5D3            6091             +
 000522                             6096     287.              IF    (GRHASB,NE,PZCURASB),'ABORT BADGRREL3' not allowed
 000522 D503 8014 0208 00014 00208  6108             +
 000528 4780 A11E            0055C  6109             +
 00052C AC04 021B      0021B        6118  1          +
 000530 9680 021A      0021A        6124  1          +
 000534 50F0 021C            0021C  6125  1          +
 000538 58F0 0210            00210  6126  1          +
 00053C 89F0 0010            00010  6127  1          +
 000540 88F0 0010            00010  6128  1          +
 000544 41F0 F000            00000  6129  1          +
 000548 AEFF 0006            00006  6130  1          +
 00054C C2C1C4C7D9D9C5D3            6131             +
000055C 5810 0200            00200  6137     289.              L     R1,MATPTR
 000560 5860 1038            00038  6138     290.              WITH  (MAT,R1),'L RX,MATGRCT' Get control block ptr
 USING  MAT,R1
 DROP   MAT,R1
                                    6162     291.              Q_REM HEAD=GRIHL,ITEM=GRHITM Remove item from hold list
 USING  @QUE-72,R13                 6173    03-00188 +       $$USING @QUE-72,SPR
 000564 98EF 4018            00018  6175    01-01698 +         LM    R14,R15,GRIHLSEQ
 000568 90EF D048            00000  6176    01-01699 +         STM   R14,R15,@QUESEQ     Set sequence stuff
 00056C 4100 4010            00010  6188    04-$L    +         LA    RVR,GRIHL
                                    6192    03-STF   +$$JR8    EQU   0,4,C'N'
 000570 5000 D054            0000C  6193    03-STF   +         ST    0,@QUELHD
                                    6203    03-STF   +$$JR9    EQU   0,4,C'N'
 000574 5080 D050            00008  6204    03-STF   +         ST    8,@QUEITM
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   51
0Current Usings:  (PZERO,R0) (GRITEM,R4) (W.GRHXBS,R5) (GRCT,R6) (GRHITM,R8) (N.GRHITM,R9) (GRREL,R10) (@GRES-72,R12) (@QUE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000578                             6209    04-LABEL +$$$70S   DS    0H
 000578 58F0 A7AE            00BEC  6213  1 02-VCALL +           L     EPAR,=V(QUEREM)
 00057C 0DEF                        6214    02-VCALL +         BASR  RAR,EPAR
 00057E 1200                        6228    07-$REL  +         LTR   RVR,RVR
 000580 4770 A13A            00578  6231    05-$BC   +         BC    7,$$$70S
 000584                             6234    06-LABEL +$$$70F   DS    0H
 000584                             6238     292.              CLEAR GRHITM
 000584 D71F 8000 8000 00000 00000  6244             +
 00058A D203 8008 A7AA 00008 00BE8  6245     293.              MVC   GRHBID,=CL4'gRH'
                                    6246     294.              SPUSH HEAD=GRCAH,ITEM=GRHITM Add to avail hold item list
 000590 98EF 6018            00018  6248    01-01509 +         LM    R14,R15,GRCAH       Get fwd ptr and sequence number
 000594 4100 8000            00000  6249    01-01510 +         LA    RVR,GRHITM          Point to new item
 000598                             6254    04-LABEL +$$$73S   DS    0H
 000598 411F 0001            00001  6256  1 01-01512 +           LA    RS,1(R15)           Increment sequence
 00059C D203 8000 6018 00000 00018  6257  1 01-01513 +           MVC   GRHITM(L'GRCAHFP),GRCAHFP   Set item fwd ptr
 0005A2 BBE0 6018            00018  6258    01-01514 +         CDS   R14,RVR,GRCAH       Add item to list
 0005A6 4770 A15A            00598  6272    05-$BC   +         BC    7,$$$73S
 0005AA                             6275    06-LABEL +$$$73F   DS    0H
0                                   6280     296.     * The hold is released. Now see if the hold can be given to any
                                    6281     297.     * waiting items. There must be no other holds in effect (the released
                                    6282     298.     * resource was not being held in share mode). If the first waiting
                                    6283     299.     * resource is for hold exclusive, then only that one gets the hold.
                                    6284     300.     * Otherwise, all the next items waiting for hold share get the hold.
00005AA 4150 C058            00000  6286     302.              LA    RK,#GRREL           Set work pointer
 0005AE 5820 4018            00018  6287     303.              L     RA,GRIHLSEQ         Get sequence stuff
 0005B2 4110 4010            00010  6288     304.              LA    R1,GRIHL            Lock token
00005B6                             6290     306.     GRREL4   BEGIN ,
 0005B6 1B00                        6295  1  307.                CLEAR R0                         Compare and load
 0005B8 EE28 4018 4010 00018 00010  6299  1  308.                PLO   RA,GRIHLSEQ,RM,GRIHLFP     First hold item
 0005BE 4780 A188            005C6  6300  1  309.                IF    (NZ),'NEXT GRREL4'         Take it from the top
 0005C2 47F0 A178            005B6  6314  1          +
 0005C6 1981/4770 A192       005D0  6319  1  310.                IF    (RM,EQ,R1),'EXIT GRREL4'   Empty list
 0005CC 47F0 A256            00694  6337  1          +
 0005D0 5860 800C            0000C  6342  1  311.                L     RX,GRHXBS                  Get the flags
 0005D4 5060 5000            0000C  6343  1  312.                ST    RX,W.GRHXBS                Set work flags
 0005D8 9180 5000      0000C        6344  1  313.                IF    (W:GRHXHOLD),'EXIT GRREL4' Aready holding
 0005DC 47E0 A1A6            005E4  6354  1          +
 0005E0 47F0 A256            00694  6362  1          +
                                    6367  1  314.     * Give this guy the hold
 0005E4 9680 5000      0000C        6368  1  315.                SET   W:GRHXHOLD            Set to hold status
 0005E8 5870 5000            0000C  6374  1  316.                L     RY,W.GRHXBS           Get new flags
 0005EC 4132 0001            00001  6375  1  317.                LA    RB,1(RA)              Increment sequence
 0005F0 4100 0008            00008  6376  1  318.                LA    R0,8                  Double compare and swap
 0005F4 EE26 4018 800C 00018 0000C  6377  1  319.                PLO   RA,GRIHLSEQ,RX,GRHXBS Set the new flags
 0005FA 4780 A1C4            00602  6378  1  320.                IF    (NZ),'NEXT GRREL4'    Take it from the top
 0005FE 47F0 A178            005B6  6392  1          +
 000602 1823                        6397  1  321.                LR    RA,RB                 Set new sequence stuff
0                                   6399  1  323.     * Note: The new item to get the hold is 'locked' by the logic because
                                    6400  1  324.     *       the only code that touches an item with hold is in this routine
                                    6401  1  325.     *       and this routine can only be called by the requestor of the
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   52
0Current Usings:  (PZERO,R0) (GRITEM,R4) (W.GRHXBS,R5) (GRCT,R6) (GRHITM,R8) (N.GRHITM,R9) (GRREL,R10) (@GRES-72,R12) (@QUE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   6402  1  326.     *       hold which has not awaken yet.
0000604 9140 800C      0000C        6404  1  328.                IF    (~GRHXEXCL),BEGIN        If willing to share
 000608 4710 A21A            00658  6414  1          +
                                    6419  2  329.     * Set all the next waits for hold share to hold
 00060C                             6420  2  330.                  LOOP  BEGIN                    Forever
 00060C 1B00                        6426  3  331.                    CLEAR R0                       Compare and load
 00060E EE29 4018 8000 00018 00000  6430  3  332.                    PLO   RA,GRIHLSEQ,RN,GRHFP     Point to next item
 000614 4770 A1CE            0060C  6431  3  333.                    IF    (NZ),NEXT                Take it from the top
 000618 1991/4780 A21A       00658  6445  3  334.                    IF    (RN,EQ,R1),EXIT          End of list
 00061E 5860 900C            0000C  6463  3  335.                    L     RX,N.GRHXBS              Get the flags
 000622 5060 5000            0000C  6464  3  336.                    ST    RX,W.GRHXBS              Save flags
                                    6465  3  337.     * Next wants exclusive or is already holding
 000626 9140 5000      0000C        6466  3  338.                    IF    (W:GRHXEXCL,OR,W:GRHXHOLD),EXIT
 00062A 4710 A21A            00658  6480  3          +
 00062E 9180 5000      0000C        6489  3          +
 000632 4710 A21A            00658  6492  3          +
 000636 9680 5000      0000C        6498  3  339.                    SET   W:GRHXHOLD               Set to hold status
 00063A 5870 5000            0000C  6504  3  340.                    L     RY,W.GRHXBS              Get new flags
 00063E 4132 0001            00001  6505  3  341.                    LA    RB,1(RA)                 Increment sequence
 000642 4100 0008            00008  6506  3  342.                    LA    R0,8                     Double compare and swap
0000646 EE26 4018 900C 00018 0000C  6508  3  344.                    PLO   RA,GRIHLSEQ,RX,N.GRHXBS  Set the new flags
 00064C 4770 A1CE            0060C  6509  3  345.                    IF    (NZ),NEXT                Take it from the top
0000650 1823                        6524  3  347.                    LR    RA,RB                    Set new sequence
                                    6525  3  348.     * Now the 'next' item is 'locked'
 000652 1889                        6526  3  349.                    LR    RM,RN               Point to next item
0000654 47F0 A1CE            0060C  6528  2  351.                  END   ,                   End loop
 000658                             6533  1  352.                END   ,                   End if
0                                   6538  1  354.     * Signal these guys
 000658                             6539  1  355.                LOOP  BEGIN
 000658 5890 8004            00004  6545  2  356.                  L     RN,GRHBP            Get back pointer
 DROP   @QUE-72,R13                 6546  2  357.                  PSET  @SYSRNEW            Get system routine ID
 USING  @SYSRNEW-72,R13
 00065C D703 D048 D048 00000 00000  6566  2          +
 000662 58F0 A7B2/0DEF       00BF0  6567  2  358.                  VCALL SYSRNEW
 000668 18F0                        6571  2  359.                  LR    R15,RVR
 DROP   @SYSRNEW-72,R13             6572  2  360.                  SIGNL GRHPIDP,(R15),GRHASB,(R15) wake up post haste!!!
 USING  @SIGNAL-72,R13
 00066A D713 D048 D048 00000 00000  6593  2          +
 000670 4100 8018            00018  6605  2          +
 000674 5000 D050            00008  6610  2          +
 000678 50F0 D04C            00004  6620  2          +
 00067C D203 D054 8014 0000C 00014  6625  2          +
 000682 50F0 D058            00010  6635  2          +
 000686 58F0 A7B6/0DEF       00BF4  6638  2          +
 00068C 1889                        6640  2  361.                  LR    RM,RN               point back
 00068E 1981/4770 A21A       00658  6641  1  362.                UNTIL (RM,EQ,R1),END
 000694                             6664     363.              END   ,                   End begin GRREL4
0000694 1804                        6669     365.              LR    RVR,RJ              Return the resource id
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   53
0Current Usings:  (PZERO,R0) (@SIGNAL-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000696 981F C008            00008  6670     366.              PEND  ,
 DROP   W.GRHXBS,R5
 DROP   N.GRHITM,R9
 DROP   GRHITM,R8
 DROP   GRITEM,R4
 DROP   GRCT,R6
 DROP   @GRES-72,R12
 DROP   GRREL,R10
 00069A 9680 C000/0B0E 00000        6716             +
 DROP   @SIGNAL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   54
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   6726     368.     *******************************************************************
                                    6727     369.     *                                                                 *
                                    6728     370.     *   GRX2S - Change an exclusive hold to a share hold              *
                                    6729     371.     *                                                                 *
                                    6730     372.     *     Input - General Resource Hold ID (pointer to hold item)     *
                                    6731     373.     *             or General Resource ID (not valid to release holds  *
                                    6732     374.     *             obtained in share mode)                             *
                                    6733     375.     *                                                                 *
                                    6734     376.     *     Output - None                                               *
                                    6735     377.     *                                                                 *
                                    6736     378.     *******************************************************************
 0006A0                             6737     379.     GRX2S    PROC  @GRES,#GRREL,SCOPE=GLOBAL
 0006A0 C7D9E7F2E2404040            6743             +
 0006A8 0010/0008                   6744             +
 0006AC 900F D004/18AF       00004  6746             +
 USING  GRX2S,R10
 0006B2 50D0 C000/18CD       00000  6761             +
 0006B8 9680 C000      00000        6763             +
 USING  @GRES-72,R12
 AUSING (#GRREL,@GRES+16)
 0006BC 41D0 C060            00060  6782             +
 USING  GRCT,R6                     6783     380.              WITH  ((GRCT,RX),(GRITEM,RJ),(GRHITM,RM))
 USING  GRITEM,R4
 USING  GRHITM,R8
 USING  N.GRHITM,R9                 6815     381.              WITH  (GRHITM,RN),LABEL=N Next item
 USING  W.GRHXBS,R5                 6823     382.              WITH  (GRHXBS,RK),LABEL=W Work flags
00006C0 5880 C04C            00004  6832     384.              L     RM,@GRID            Set hold item pointer
 0006C4 1848                        6833     385.              LR    RJ,RM               Might be a Resource id
00006C6                             6835     387.              IF    (GRIBID,EQ,=CL4'GRES'),BEGIN
 0006C6 D503 A51C 4000 00BC8 00000  6846             +
 0006CC 4770 A062            0070E  6847             +
 0006D0 5880 4010            00010  6852  1  388.                L     RM,GRIHLFP          Get first hold item
 0006D4                             6853  1  389.                IF    (GRIHLCNT,EQ,=A(0)),'ABORT BADGRX2S0'
 0006D4 D503 A528 401C 00BD4 0001C  6864  1          +
 0006DA 4770 A062            0070E  6865  1          +
 0006DE AC04 021B      0021B        6874  2          +
 0006E2 9680 021A      0021A        6880  2          +
 0006E6 50F0 021C            0021C  6881  2          +
 0006EA 58F0 0210            00210  6882  2          +
 0006EE 89F0 0010            00010  6883  2          +
 0006F2 88F0 0010            00010  6884  2          +
 0006F6 41F0 F000            00000  6885  2          +
 0006FA AEFF 0006            00006  6886  2          +
 0006FE C2C1C4C7D9E7F2E2            6887  1          +
 00070E                             6892     390.              END   ,                   End if
 00070E A066           0070E 006CE  6896     391.              ELSE  'L RJ,GRHGRIT'      Set res item base
 00070E 47F0 A06A            00716  6901             +
 000712 5840 8010            00010  6908             +
0000716 9140 800C      0000C        6914     393.              IF    (~GRHXEXCL),'ABORT BADGRX2S1'
 00071A 4710 A0A2            0074E  6924             +
 00071E AC04 021B      0021B        6933  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   55
0Current Usings:  (PZERO,R0) (GRITEM,R4) (W.GRHXBS,R5) (GRCT,R6) (GRHITM,R8) (N.GRHITM,R9) (GRX2S,R10) (@GRES-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000722 9680 021A      0021A        6939  1          +
 000726 50F0 021C            0021C  6940  1          +
 00072A 58F0 0210            00210  6941  1          +
 00072E 89F0 0010            00010  6942  1          +
 000732 88F0 0010            00010  6943  1          +
 000736 41F0 F000            00000  6944  1          +
 00073A AEFF 0006            00006  6945  1          +
 00073E C2C1C4C7D9E7F2E2            6946             +
 00074E                             6951     394.              IF    (GRHBID,NE,=CL4'GRH'),'ABORT BADGRX2S2'
 00074E D503 A524 8008 00BD0 00008  6962             +
 000754 4780 A0DC            00788  6963             +
 000758 AC04 021B      0021B        6972  1          +
 00075C 9680 021A      0021A        6978  1          +
 000760 50F0 021C            0021C  6979  1          +
 000764 58F0 0210            00210  6980  1          +
 000768 89F0 0010            00010  6981  1          +
 00076C 88F0 0010            00010  6982  1          +
 000770 41F0 F000            00000  6983  1          +
 000774 AEFF 0006            00006  6984  1          +
 000778 C2C1C4C7D9E7F2E2            6985             +
 000788                             6990     395.              IF    (GRHASB,NE,PZCURASB),'ABORT BADGRX2S3' not allowed
 000788 D503 8014 0208 00014 00208  7002             +
 00078E 4780 A116            007C2  7003             +
 000792 AC04 021B      0021B        7012  1          +
 000796 9680 021A      0021A        7018  1          +
 00079A 50F0 021C            0021C  7019  1          +
 00079E 58F0 0210            00210  7020  1          +
 0007A2 89F0 0010            00010  7021  1          +
 0007A6 88F0 0010            00010  7022  1          +
 0007AA 41F0 F000            00000  7023  1          +
 0007AE AEFF 0006            00006  7024  1          +
 0007B2 C2C1C4C7D9E7F2E2            7025             +
00007C2 94BF 800C      0000C        7031     397.              CLEAR GRHXEXCL            Set to shared mode
 0007C6 9620 800C      0000C        7038     398.              SET   GRHXX2S             Note that this has occured
0                                   7045     400.     * The hold is shared. Now the hold can be given to any of the next
                                    7046     401.     * items waiting for a shared hold.
00007CA 4150 C058            00000  7048     403.              LA    RK,#GRREL           Set work pointer
 0007CE 5820 4018            00018  7049     404.              L     RA,GRIHLSEQ         Get sequence stuff
 0007D2 4110 4010            00010  7050     405.              LA    R1,GRIHL            Lock token
0                                   7052     407.     * Set all the next waits for hold share to hold
 0007D6                             7053     408.              LOOP  BEGIN                    Forever
 0007D6 1B00                        7059  1  409.                CLEAR R0                       Compare and load
 0007D8 EE29 4018 8000 00018 00000  7063  1  410.                PLO   RA,GRIHLSEQ,RN,GRHFP     Point to next item
 0007DE 4770 A12A            007D6  7064  1  411.                IF    (NZ),NEXT                Take it from the top
 0007E2 1991/4780 A176       00822  7078  1  412.                IF    (RN,EQ,R1),EXIT          End of list
 0007E8 5860 900C            0000C  7096  1  413.                L     RX,N.GRHXBS              Get the flags
 0007EC 5060 5000            0000C  7097  1  414.                ST    RX,W.GRHXBS              Save flags
                                    7098  1  415.     * Next wants exclusive or is already holding
 0007F0 9140 5000      0000C        7099  1  416.                IF    (W:GRHXEXCL,OR,W:GRHXHOLD),EXIT
 0007F4 4710 A176            00822  7113  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   56
0Current Usings:  (PZERO,R0) (GRITEM,R4) (W.GRHXBS,R5) (GRCT,R6) (GRHITM,R8) (N.GRHITM,R9) (GRX2S,R10) (@GRES-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00007F8 9180 5000      0000C        7122  1          +
 0007FC 4710 A176            00822  7125  1          +
 000800 9680 5000      0000C        7131  1  417.                SET   W:GRHXHOLD               Set to hold status
 000804 5870 5000            0000C  7137  1  418.                L     RY,W.GRHXBS              Get new flags
 000808 4132 0001            00001  7138  1  419.                LA    RB,1(RA)                 Increment sequence
 00080C 4100 0008            00008  7139  1  420.                LA    R0,8                     Double compare and swap
0000810 EE26 4018 900C 00018 0000C  7141  1  422.                PLO   RA,GRIHLSEQ,RX,N.GRHXBS  Set the new flags
 000816 4770 A12A            007D6  7142  1  423.                IF    (NZ),NEXT                Take it from the top
000081A 1823                        7157  1  425.                LR    RA,RB                    Set new sequence
                                    7158  1  426.     * Now the 'next' item is 'locked'
 00081C 1889                        7159  1  427.                LR    RM,RN               Point to next item
000081E 47F0 A12A            007D6  7161     429.              END   ,                   End loop
0                                   7167     431.     * Signal these guys
 000822 5980 4010            00010  7168     432.              WHILE (RM,NE,GRIHLFP),BEGIN While not the first one
 000826 4780 A1B8            00864  7182             +
 00082A 5890 8004            00004  7187  1  433.                L     RN,GRHBP            Get back pointer
 USING  @SYSRNEW-72,R13             7188  1  434.                PSET  @SYSRNEW            Get system routine ID
 00082E D703 D048 D048 00000 00000  7205  1          +
 000834 58F0 A544/0DEF       00BF0  7206  1  435.                VCALL SYSRNEW
 00083A 18F0                        7210  1  436.                LR    R15,RVR
 DROP   @SYSRNEW-72,R13             7211  1  437.                SIGNL GRHPIDP,(R15),GRHASB,(R15) wake up post haste!!!
 USING  @SIGNAL-72,R13
 00083C D713 D048 D048 00000 00000  7232  1          +
 000842 4100 8018            00018  7244  1          +
 000846 5000 D050            00008  7249  1          +
 00084A 50F0 D04C            00004  7259  1          +
 00084E D203 D054 8014 0000C 00014  7264  1          +
 000854 50F0 D058            00010  7274  1          +
 000858 58F0 A548/0DEF       00BF4  7277  1          +
 00085E 1889                        7279  1  438.                LR    RM,RN               point back
 000860 47F0 A176            00822  7280     439.              END   ,                   End while
0000864 1808                        7286     441.              LR    RVR,RM              return hold id
 000866 981F C008            00008  7287     442.              PEND  ,
 DROP   W.GRHXBS,R5
 DROP   N.GRHITM,R9
 DROP   GRHITM,R8
 DROP   GRITEM,R4
 DROP   GRCT,R6
 DROP   @GRES-72,R12
 DROP   GRX2S,R10
 00086A 9680 C000/0B0E 00000        7333             +
 DROP   @SIGNAL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   57
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   7343     444.     *******************************************************************
                                    7344     445.     *                                                                 *
                                    7345     446.     *   GRCAN - Cancel any waiting resource holds for this addr space *
                                    7346     447.     *                                                                 *
                                    7347     448.     *     Input -  General Resource ID (pointer to the table item)    *
                                    7348     449.     *                                                                 *
                                    7349     450.     *     Output - None                                               *
                                    7350     451.     *                                                                 *
                                    7351     452.     *     All outstanding waits for holds that were requested for     *
                                    7352     453.     *     this address space are cancelled.                           *
                                    7353     454.     *                                                                 *
                                    7354     455.     *******************************************************************
 000000                00000 00020  7355     456.     #GRCAN  RECORD BEGIN
 000000                             7363  1  457.                DS    XL(L'GRHITM)        Work record
 000020                00020 00020  7364     458.              END   ,
0000870                             7374     460.     GRCAN    PROC  @GRES,#GRCAN,SCOPE=GLOBAL
 000870 C7D9C3C1D5404040            7380             +
 000878 0010/0020                   7381             +
 00087C 900F D004/18AF       00004  7383             +
 USING  GRCAN,R10
 000882 50D0 C000/18CD       00000  7398             +
 000888 9680 C000      00000        7400             +
 USING  @GRES-72,R12
 AUSING (#GRCAN,@GRES+16)
 00088C 41D0 C078            00078  7419             +
 USING  GRITEM,R4                   7420     461.              WITH  ((GRITEM,RJ),(GRHITM,RM))
 USING  GRHITM,R8
0000890 5840 C04C            00004  7444     463.              L     RJ,@GRID            Set res item base
 000894                             7445     464.              IF    (GRIBID,NE,=CL4'GRES'),'ABORT BADGRCAN1'
 000894 D503 A34C 4000 00BC8 00000  7456             +
 00089A 4780 A052            008CE  7457             +
 00089E AC04 021B      0021B        7466  1          +
 0008A2 9680 021A      0021A        7472  1          +
 0008A6 50F0 021C            0021C  7473  1          +
 0008AA 58F0 0210            00210  7474  1          +
 0008AE 89F0 0010            00010  7475  1          +
 0008B2 88F0 0010            00010  7476  1          +
 0008B6 41F0 F000            00000  7477  1          +
 0008BA AEFF 0006            00006  7478  1          +
 0008BE C2C1C4C7D9C3C1D5            7479             +
00008CE 4110 4010            00010  7485     466.              LA    R1,GRIHL            Lock token
 0008D2 4150 C058            00000  7486     467.              LA    RK,#GRCAN           Work record
 USING  W.GRHITM,R5                 7487     468.              WITH  (GRHITM,RK),LABEL=W Work record
0USING  @QUE-72,R13                 7496     470.              PSET  @QUE
 0008D6 D70F D048 D048 00000 00000  7513             +
 0008DC 4100 4010            00010  7514     471.              PMOV  @QUELHD,LA:GRIHL    Set list head
 0008E0 5000 D054            0000C  7530             +
00008E4                             7532     473.     GRCAN2   BEGIN
 0008E4 9823 4018            00018  7537  1  474.                LM    RA,RB,GRIHLSEQ      Get sequence and count
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   58
0Current Usings:  (PZERO,R0) (GRITEM,R4) (W.GRHITM,R5) (GRHITM,R8) (GRCAN,R10) (@GRES-72,R12) (@QUE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00008E8 9023 D048            00000  7538  1  475.                STM   RA,RB,@QUESEQ       Set sequence stuff
 0008EC 1B00                        7539  1  476.                CLEAR R0                  Compare and load
 0008EE EE28 4018 4010 00018 00010  7543  1  477.                PLO   RA,GRIHLSEQ,RM,GRIHLFP Point to first one
 0008F4 4780 A080            008FC  7544  1  478.                IF    (NZ),'NEXT GRCAN2'  Take it from the top
 0008F8 47F0 A068            008E4  7558  1          +
00008FC 1981/4780 A10C       00988  7564  1  480.                WHILE (RM,NE,R1),BEGIN    While not end of the list
 000902 D21F 5000 8000 00000 00000  7581  2  481.                  MVC   W.GRHITM,GRHITM     Copy Record
 000908 EE29 4018 8000 00018 00000  7582  2  482.                  PLO   RA,GRIHLSEQ,RN,GRHFP Get next item pointer
 00090E 4780 A09A            00916  7583  2  483.                  IF    (NZ),'NEXT GRCAN2'  Take it from the top
 000912 47F0 A068            008E4  7597  2          +
0000916 9180 500C      0000C        7603  2  485.                  IF    ~W:GRHXHOLD,BEGIN   Item waiting
 00091A 4710 A106            00982  7613  2          +
                                    7618  3  486.     * AS option and item does not belong to this address space
 00091E 9120 C050      00008        7619  3  487.                    IF    (@GRCANAS,AND,(PZCURASB,NE,W.GRHASB)),EXIT
 000922 47E0 A0B4            00930  7631  3          +
 000926 D503 0208 5014 00208 00014  7645  3          +
 00092C 4770 A106            00982  7648  3          +
 000930 5080 D050            00008  7654  3  488.                    PMOV  @QUEITM,LA:GRHITM   Set item to remove
 000934 58F0 A37C/0DEF       00BF8  7665  3  489.                    ACALL QUEREM
 00093A 1200/4780 A0C8       00944  7672  3  490.                    IF    (RVR,NZ),'NEXT GRCAN2' Take it from the top
 000940 47F0 A068            008E4  7689  3          +
 000944 9823 D048            00000  7694  3  491.                    LM    RA,RB,@QUESEQ       Pick up new sequence stuff
 000948 D203 8008 A380 00008 00BFC  7695  3  492.                    MVC   GRHBID,=CL4'GRXX'   Incase of subsequent release
 00094E 9610 800C      0000C        7696  3  493.                    SET   GRHXCANC            Set to cancelled
                                    7702  3  494.     * Note: the wait item is not anchored at this point (see grget)
 DROP   @QUE-72,R13                 7703  3  495.                    PSET  @SYSRNEW            Get system routine ID
 USING  @SYSRNEW-72,R13
 000952 D703 D048 D048 00000 00000  7723  3          +
 000958 58F0 A374/0DEF       00BF0  7724  3  496.                    VCALL SYSRNEW
 00095E 18F0                        7728  3  497.                    LR    R15,RVR
 DROP   @SYSRNEW-72,R13             7729  3  498.                    SIGNL GRHPIDP,(R15),GRHASB,(R15) wake up post haste!!!
 USING  @SIGNAL-72,R13
 000960 D713 D048 D048 00000 00000  7750  3          +
 000966 4100 8018            00018  7762  3          +
 00096A 5000 D050            00008  7767  3          +
 00096E 50F0 D04C            00004  7777  3          +
 000972 D203 D054 8014 0000C 00014  7782  3          +
 000978 50F0 D058            00010  7792  3          +
 00097C 58F0 A378/0DEF       00BF4  7795  3          +
 000982                             7797  2  499.                  END   ,                   End if
 000982 1889                        7801  2  500.                  LR    RM,RN               Point to next one
 000984 47F0 A080            008FC  7802  1  501.                END   ,                   End while
 000988                             7807     502.              END   ,                   End begin
0000988 1B00                        7812     504.              CLEAR RVR                 set return code
000098A 981F C008            00008  7817     506.              PEND  ,
 DROP   W.GRHITM,R5
 DROP   GRHITM,R8
 DROP   GRITEM,R4
 DROP   @GRES-72,R12
 DROP   GRCAN,R10
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   59
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000098E 9680 C000/0B0E 00000        7850             +
 DROP   @SIGNAL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   60
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   7860     508.     *******************************************************************
                                    7861     509.     *                                                                 *
                                    7862     510.     *   QUEUE - Add an item to the end of a list                      *
                                    7863     511.     *                                                                 *
                                    7864     512.     *     Input -  @QUESEQ  Sequence value                            *
                                    7865     513.     *              @QUEITM  Address of item                           *
                                    7866     514.     *              @QUELHD  Address of list head                      *
                                    7867     515.     *                                                                 *
                                    7868     516.     *     Output - Zero if remove successfull, one if not             *
                                    7869     517.     *                                                                 *
                                    7870     518.     *     Serialization for memory manipulation is achived using the  *
                                    7871     519.     *     PLO instruction.                                            *
                                    7872     520.     *                                                                 *
                                    7873     521.     *     The list is double linked and the head includes a list item *
                                    7874     522.     *     count and a list access count used as a serialization field.*
                                    7875     523.     *                                                                 *
                                    7876     524.     *                                                                 *
                                    7877     525.     *******************************************************************
 000994                             7878     526.     QUEUE    PROC  @QUE,#QUEPLO,SCOPE=GLOBAL
 000994 D8E4C5E4C5404040            7884             +
 00099C 0010/0090                   7885             +
 0009A0 900F D004/18AF       00004  7887             +
 USING  QUEUE,R10
 0009A6 50D0 C000/18CD       00000  7902             +
 0009AC 9680 C000      00000        7904             +
 USING  @QUE-72,R12
 AUSING (#QUEPLO,@QUE+16)
 0009B0 41D0 C0E8            000E8  7923             +
0USING  I.#QUEW,R1                  7925     528.              WITH  (#QUEW,R1),LABEL=I Add item
 USING  H.#QUEW,R2                  7933     529.              WITH  (#QUEW,RA),LABEL=H Head of list
 USING  L.#QUEW,R3                  7941     530.              WITH  (#QUEW,RB),LABEL=L Last item on list
00009B4 5810 C050            00008  7950     532.              L     R1,@QUEITM          Item to add
 0009B8 5820 C054            0000C  7951     533.              L     RA,@QUELHD          Head of list
 0009BC 5830 2004            00004  7952     534.              L     RB,H.#QUEBP         Last item on list
00009C0                             7954     536.              CLEAR #QUEPLO
 0009C0 D78F C058 C058 00000 00000  7960             +
00009C6 9867 C048            00000  7962     538.              LM    RX,RY,@QUESEQ       Sequence value
 0009CA 9067 C060            00008  7963     539.              STM   RX,RY,#QUEPLO+(4*2)  Compare value
 0009CE 4166 0001            00001  7964     540.              LA    RX,1(RX)            Increment sequence value
 0009D2 4177 0001            00001  7965     541.              LA    RY,1(RY)            Increment count
 0009D6 9067 C070            00018  7966     542.              STM   RX,RY,#QUEPLO+(4*6)  Replacement value
00009DA 5010 C0A4            0004C  7968     544.              ST    R1,#QUEPLO+(4*19)          Item
 0009DE D203 C090 3000 00038 00000  7969     545.              MVC   #QUEPLO+(4*14)(4),L.#QUEFP Item FP
 0009E4 D203 C094 2004 0003C 00004  7970     546.              MVC   #QUEPLO+(4*15)(4),H.#QUEBP Item BP
00009EA 1923/4770 A060       00A00  7972     548.              IF    (RA,EQ,RB),BEGIN    Empty list
00009F0 5020 C0C4            0006C  7988  1  550.                ST    RA,#QUEPLO+(4*27)          Head of list
 0009F4 5010 C0B0            00058  7989  1  551.                ST    R1,#QUEPLO+(4*22)          Head FP
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   61
0Current Usings:  (PZERO,R0) (I.#QUEW,R1) (H.#QUEW,R2) (L.#QUEW,R3) (QUEUE,R10) (@QUE-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00009F8 5010 C0B4            0005C  7990  1  552.                ST    R1,#QUEPLO+(4*23)          Head BP
00009FC 4100 0011            00011  7992  1  554.                LA    R0,17         Compare double & swap & store double
0000A00                             7994     556.              END   ,                   end if
 000A00 A064           00A00 009EE  7998     557.              ELSE  BEGIN
 000A00 47F0 A084            00A24  8003             +
0000A04 5020 C0C4            0006C  8010  1  559.                ST    RA,#QUEPLO+(4*27)          Head of list
 000A08 D203 C0B0 2000 00058 00000  8011  1  560.                MVC   #QUEPLO+(4*22)(4),H.#QUEFP Head FP (same)
 000A0E 5010 C0B4            0005C  8012  1  561.                ST    R1,#QUEPLO+(4*23)          Head BP
0000A12 5030 C0E4            0008C  8014  1  563.                ST    RB,#QUEPLO+(4*35)          Last item on list
 000A16 5010 C0D0            00078  8015  1  564.                ST    R1,#QUEPLO+(4*30)          Last FP
 000A1A D203 C0D4 3004 0007C 00004  8016  1  565.                MVC   #QUEPLO+(4*31)(4),L.#QUEBP Last BP (same)
0000A20 4100 0015            00015  8018  1  567.                LA    R0,21         Compare double & swap & store triple
0000A24                             8020     569.              END   ,                   end else
0000A24 4110 2000            00000  8025     571.              LA    R1,H.#QUEW    Lock token
0000A28 EE00 2008 C058 00008 00000  8027     573.              PLO   0,H.#QUESEQ,0,#QUEPLO      Hard to explain
0000A2E 4770 A094/1B00       00A34  8029     575.              IF    (Z),'CLEAR RVR'
 000A34 A098           00A34 00A30  8049     576.              ELSE  'LA RVR,1'
 000A34 47F0 A09C            00A3C  8054             +
 000A38 4100 0001            00001  8061             +
0000A3C D207 C048 C060 00000 00008  8067     578.              MVC   @QUESEQ,#QUEPLO+(4*2)      Reset sequence value
0000A42 981F C008            00008  8069     580.              PEND
 DROP   L.#QUEW,R3
 DROP   H.#QUEW,R2
 DROP   I.#QUEW,R1
 DROP   @QUE-72,R12
 DROP   QUEUE,R10
 000A46 9680 C000/0B0E 00000        8108             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   62
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   8115     582.     *******************************************************************
                                    8116     583.     *                                                                 *
                                    8117     584.     *   QUEPUSH - Add an item to the beginning of a list              *
                                    8118     585.     *                                                                 *
                                    8119     586.     *     Input -  @QUESEQ  Sequence value                            *
                                    8120     587.     *              @QUEITM  Address of item                           *
                                    8121     588.     *              @QUELHD  Address of list head                      *
                                    8122     589.     *                                                                 *
                                    8123     590.     *     Output - Zero if remove successfull, one if not             *
                                    8124     591.     *                                                                 *
                                    8125     592.     *     Serialization for memory manipulation is achived using the  *
                                    8126     593.     *     PLO instruction.                                            *
                                    8127     594.     *                                                                 *
                                    8128     595.     *     The list is double linked and the head includes a list item *
                                    8129     596.     *     count and a list access count used as a serialization field.*
                                    8130     597.     *                                                                 *
                                    8131     598.     *                                                                 *
                                    8132     599.     *******************************************************************
 000A4C                             8133     600.     QUEPUSH  PROC  @QUE,#QUEPLO,SCOPE=GLOBAL
 000A4C D8E4C5D7E4E2C840            8139             +
 000A54 0010/0090                   8140             +
 000A58 900F D004/18AF       00004  8142             +
 USING  QUEPUSH,R10
 000A5E 50D0 C000/18CD       00000  8157             +
 000A64 9680 C000      00000        8159             +
 USING  @QUE-72,R12
 AUSING (#QUEPLO,@QUE+16)
 000A68 41D0 C0E8            000E8  8178             +
0USING  I.#QUEW,R1                  8180     602.              WITH  (#QUEW,R1),LABEL=I Add item
 USING  H.#QUEW,R2                  8188     603.              WITH  (#QUEW,RA),LABEL=H Head of list
 USING  F.#QUEW,R3                  8196     604.              WITH  (#QUEW,RB),LABEL=F First item on list
0000A6C 5810 C050            00008  8205     606.              L     R1,@QUEITM          Item to add
 000A70 5820 C054            0000C  8206     607.              L     RA,@QUELHD          Head of list
 000A74 5830 2000            00000  8207     608.              L     RB,H.#QUEFP         First item on list
0000A78                             8209     610.              CLEAR #QUEPLO
 000A78 D78F C058 C058 00000 00000  8215             +
0000A7E 9867 C048            00000  8217     612.              LM    RX,RY,@QUESEQ       Sequence value
 000A82 9067 C060            00008  8218     613.              STM   RX,RY,#QUEPLO+(4*2)  Compare value
 000A86 4166 0001            00001  8219     614.              LA    RX,1(RX)            Increment sequence value
 000A8A 4177 0001            00001  8220     615.              LA    RY,1(RY)            Increment count
 000A8E 9067 C070            00018  8221     616.              STM   RX,RY,#QUEPLO+(4*6)  Replacement value
0000A92 5010 C0A4            0004C  8223     618.              ST    R1,#QUEPLO+(4*19)          Item
 000A96 D203 C090 2000 00038 00000  8224     619.              MVC   #QUEPLO+(4*14)(4),H.#QUEFP Item FP
 000A9C D203 C094 3004 0003C 00004  8225     620.              MVC   #QUEPLO+(4*15)(4),F.#QUEBP Item BP
0000AA2 1923/4770 A060       00AB8  8227     622.              IF    (RA,EQ,RB),BEGIN    Empty list
0000AA8 5020 C0C4            0006C  8243  1  624.                ST    RA,#QUEPLO+(4*27)          Head of list
 000AAC 5010 C0B0            00058  8244  1  625.                ST    R1,#QUEPLO+(4*22)          Head FP
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   63
0Current Usings:  (PZERO,R0) (I.#QUEW,R1) (H.#QUEW,R2) (F.#QUEW,R3) (QUEPUSH,R10) (@QUE-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000AB0 5010 C0B4            0005C  8245  1  626.                ST    R1,#QUEPLO+(4*23)          Head BP
0000AB4 4100 0011            00011  8247  1  628.                LA    R0,17         Compare double & swap & store double
0000AB8                             8249     630.              END   ,                   end if
 000AB8 A064           00AB8 00AA6  8253     631.              ELSE  BEGIN
 000AB8 47F0 A084            00ADC  8258             +
0000ABC 5020 C0C4            0006C  8265  1  633.                ST    RA,#QUEPLO+(4*27)          Head of list
 000AC0 5010 C0B0            00058  8266  1  634.                ST    R1,#QUEPLO+(4*22)          Head FP
 000AC4 D203 C0B4 2004 0005C 00004  8267  1  635.                MVC   #QUEPLO+(4*23)(4),H.#QUEBP Head BP (same)
0000ACA 5030 C0E4            0008C  8269  1  637.                ST    RB,#QUEPLO+(4*35)          First item on list
 000ACE D203 C0D0 3000 00078 00000  8270  1  638.                MVC   #QUEPLO+(4*30)(4),F.#QUEFP First FP (same)
 000AD4 5010 C0D4            0007C  8271  1  639.                ST    R1,#QUEPLO+(4*31)          First BP
0000AD8 4100 0015            00015  8273  1  641.                LA    R0,21         Compare double & swap & store triple
0000ADC                             8275     643.              END   ,                   end else
0000ADC 4110 2000            00000  8280     645.              LA    R1,H.#QUEW   Lock token
0000AE0 EE00 2008 C058 00008 00000  8282     647.              PLO   0,H.#QUESEQ,0,#QUEPLO      Hard to explain
0000AE6 4770 A094/1B00       00AEC  8284     649.              IF    (Z),'CLEAR RVR'
 000AEC A098           00AEC 00AE8  8304     650.              ELSE  'LA RVR,1'
 000AEC 47F0 A09C            00AF4  8309             +
 000AF0 4100 0001            00001  8316             +
0000AF4 D207 C048 C060 00000 00008  8322     652.              MVC   @QUESEQ,#QUEPLO+(4*2)      Reset sequence value
0000AFA 981F C008            00008  8324     654.              PEND
 DROP   F.#QUEW,R3
 DROP   H.#QUEW,R2
 DROP   I.#QUEW,R1
 DROP   @QUE-72,R12
 DROP   QUEPUSH,R10
 000AFE 9680 C000/0B0E 00000        8363             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   64
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   8370     656.     *******************************************************************
                                    8371     657.     *                                                                 *
                                    8372     658.     *   QUEREM - Remove an item from a list                           *
                                    8373     659.     *                                                                 *
                                    8374     660.     *     Input -  @QUESEQ  Sequence value                            *
                                    8375     661.     *              @QUEITM  Address of item                           *
                                    8376     662.     *              @QUELHD  Address of list head                      *
                                    8377     663.     *                                                                 *
                                    8378     664.     *     Output - Zero if remove successfull, one if not             *
                                    8379     665.     *                                                                 *
                                    8380     666.     *     Serialization for memory manipulation is achived using the  *
                                    8381     667.     *     PLO instruction.                                            *
                                    8382     668.     *                                                                 *
                                    8383     669.     *     The list is double linked and the head includes a list item *
                                    8384     670.     *     count and a list access count used as a serialization field.*
                                    8385     671.     *                                                                 *
                                    8386     672.     *                                                                 *
                                    8387     673.     *******************************************************************
 000B04                             8388     674.     QUEREM   PROC  @QUE,#QUEPLO,SCOPE=GLOBAL
 000B04 D8E4C5D9C5D44040            8394             +
 000B0C 0010/0090                   8395             +
 000B10 900F D004/18AF       00004  8397             +
 USING  QUEREM,R10
 000B16 50D0 C000/18CD       00000  8412             +
 000B1C 9680 C000      00000        8414             +
 USING  @QUE-72,R12
 AUSING (#QUEPLO,@QUE+16)
 000B20 41D0 C0E8            000E8  8433             +
0USING  I.#QUEW,R1                  8435     676.              WITH  (#QUEW,R1),LABEL=I Remove item
 USING  H.#QUEW,R2                  8443     677.              WITH  (#QUEW,RA),LABEL=H Head of list
 USING  B.#QUEW,R3                  8451     678.              WITH  (#QUEW,RB),LABEL=B Item before remove item
 USING  F.#QUEW,R4                  8459     679.              WITH  (#QUEW,RJ),LABEL=F Item after remove item
0000B24 5810 C050            00008  8468     681.              L     R1,@QUEITM          Item to remove
 000B28 5820 C054            0000C  8469     682.              L     RA,@QUELHD          Head of list
 000B2C 5830 1004            00004  8470     683.              L     RB,I.#QUEBP         Item before remove item
 000B30 5840 1000            00000  8471     684.              L     RJ,I.#QUEFP         Item after remove item
0000B34                             8473     686.              CLEAR #QUEPLO
 000B34 D78F C058 C058 00000 00000  8479             +
0000B3A 9867 C048            00000  8481     688.              LM    RX,RY,@QUESEQ       Sequence value
 000B3E 9067 C060            00008  8482     689.              STM   RX,RY,#QUEPLO+(4*2)  Compare value
 000B42 4166 0001            00001  8483     690.              LA    RX,1(RX)            Increment sequence value
 000B46 0670                        8484     691.              BCTR  RY,0                Decrement count
 000B48 9067 C070            00018  8485     692.              STM   RX,RY,#QUEPLO+(4*6)  Replacement value
0000B4C 5010 C0A4            0004C  8487     694.              ST    R1,#QUEPLO+(4*19)          Item
                                    8488     695.     *                                  Clear Item FP
                                    8489     696.     *                                  Clear Item BP
0000B50 1934/4770 A05A       00B6A  8491     698.              IF    (RB,EQ,RJ),BEGIN    Item to remove is the last one
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   65
0Current Usings:  (PZERO,R0) (I.#QUEW,R1) (H.#QUEW,R2) (B.#QUEW,R3) (F.#QUEW,R4) (QUEREM,R10) (@QUE-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000B56 5030 C0C4            0006C  8507  1  700.                ST    RB,#QUEPLO+(4*27)          Item before remove item
 000B5A D203 C0B0 1000 00058 00000  8508  1  701.                MVC   #QUEPLO+(4*22)(4),I.#QUEFP Item FP
 000B60 D203 C0B4 1004 0005C 00004  8509  1  702.                MVC   #QUEPLO+(4*23)(4),I.#QUEBP Item BP
0000B66 4100 0011            00011  8511  1  704.                LA    R0,17         Compare double & swap & store double
0000B6A                             8513     706.              END   ,                   end if
 000B6A A05E           00B6A 00B54  8517     707.              ELSE  BEGIN
 000B6A 47F0 A082            00B92  8522             +
0000B6E 5030 C0C4            0006C  8529  1  709.                ST    RB,#QUEPLO+(4*27)          Item before remove item
 000B72 D203 C0B0 1000 00058 00000  8530  1  710.                MVC   #QUEPLO+(4*22)(4),I.#QUEFP Item FP
 000B78 D203 C0B4 3004 0005C 00004  8531  1  711.                MVC   #QUEPLO+(4*23)(4),B.#QUEBP Item BP (same)
0000B7E 5040 C0E4            0008C  8533  1  713.                ST    RJ,#QUEPLO+(4*35)          Item after remove item
 000B82 D203 C0D0 4000 00078 00000  8534  1  714.                MVC   #QUEPLO+(4*30)(4),F.#QUEFP Item FP (same)
 000B88 D203 C0D4 1004 0007C 00004  8535  1  715.                MVC   #QUEPLO+(4*31)(4),I.#QUEBP Item BP
0000B8E 4100 0015            00015  8537  1  717.                LA    R0,21         Compare double & swap & store triple
0000B92                             8539     719.              END   ,                   end else
0000B92 4110 2000            00000  8544     721.              LA    R1,H.#QUEW   Lock token
0000B96 EE00 2008 C058 00008 00000  8546     723.              PLO   0,H.#QUESEQ,0,#QUEPLO      Hard to explain
0000B9C 4770 A092/1B00       00BA2  8548     725.              IF    (Z),'CLEAR RVR'
 000BA2 A096           00BA2 00B9E  8568     726.              ELSE  'LA RVR,1'
 000BA2 47F0 A09A            00BAA  8573             +
 000BA6 4100 0001            00001  8580             +
0000BAA D207 C048 C060 00000 00008  8586     728.              MVC   @QUESEQ,#QUEPLO+(4*2)      Reset sequence value
0000BB0 981F C008            00008  8588     730.              PEND
 DROP   F.#QUEW,R4
 DROP   B.#QUEW,R3
 DROP   H.#QUEW,R2
 DROP   I.#QUEW,R1
 DROP   @QUE-72,R12
 DROP   QUEREM,R10
 000BB4 9680 C000/0B0E 00000        8635             +
 000BC0                             8641     731.              LTORG ,
 000BC0 00000000                    8643                             =V(VMGET)
 000BC4 C7D9C3E3                    8644                             =CL4'GRCT'
 000BC8 C7D9C5E2                    8645                             =CL4'GRES'
 000BCC 87D9C5E2                    8646                             =CL4'gRES'
 000BD0 C7D9C840                    8647                             =CL4'GRH'
 000BD4 00000000                    8648                             =A(0)
 000BD8 000009A0                    8649                             =A(QUEUE)
 000BDC 00000000                    8650                             =V(AWAIT)
 000BE0 00000000                    8651                             =V(SYSRDEL)
 000BE4 00000001                    8652                             =A(1)
 000BE8 87D9C840                    8653                             =CL4'gRH'
 000BEC 00000000                    8654                             =V(QUEREM)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S General Resource Services                                                      Page   66
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000BF0 00000000                    8655                             =V(SYSRNEW)
 000BF4 00000000                    8656                             =V(SIGNAL)
 000BF8 00000B10                    8657                             =A(QUEREM)
 000BFC C7D9E7E7                    8658                             =CL4'GRXX'
 000C00 3F00           00C02 03638  8659                             =Y(63*256+0)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   67
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000000                00000 00038  8664     733.     SBCNTRL RECORD BEGIN               System buffer pool control area
 000000 E2C2C3C2                    8672  1  734.     SBCBID     DC    CL4'SBCB'
 000004                             8673  1  735.     SBCLEN     DS    A                   Length of a buffer
                                    8674  1  736.     SBCFIX     EQU   SBCLEN,X'80'        1 = Area in fixed mem, 0 = not
 000008                             8675  1  737.     SBCHII     DS    A                   Inuse high-water mark
 00000C                             8676  1  738.     SBCHIW     DS    A                   Wait queue high-water mark
                                    8677  1  739.     SBCW       QHEAD ,                   Waiting for a free buffer
 000010                             8678  1 01-01618 +           DS   0D
 000010                             8679  1 01-01619 +SBCW       DS   0XL(16)              Double linked PLO list
 000010                             8680  1 01-01620 +SBCWFP     DS    A                   Forward pointer
 000014                             8681  1 01-01621 +SBCWBP     DS    A                   Backward pointer
 000018                             8682  1 01-01622 +SBCWSEQ    DS    A                   CDS sequence number
 00001C                             8683  1 01-01623 +SBCWCNT    DS    A                   Count of items
                                    8684  1  740.     SBCF       SHEAD ,                   Free buffers
 000020                             8685  1 01-01488 +SBCF       DS   0D                   Single linked CDS list
 000020                             8686  1 01-01489 +SBCFFP     DS    A                   Forward pointer
 000024                             8687  1 01-01490 +SBCFSEQ    DS    A                   CDS sequence number
 000028                             8688  1  741.     SBCFCNT    DS    A                   Free count
 00002C                             8689  1  742.     SBCTCNT    DS    A                   Total blocks
 000030                             8690  1  743.     SBCBSTRT   DS    A                   Buffer area start *** temp ***
 000034                             8691  1  744.     SBCBLEN    DS    A                   Length of buffer area *** temp ***
 000038                00038 00038  8692     745.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   68
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   8702     747.     *******************************************************************
                                    8703     748.     *                                                                 *
                                    8704     749.     *   SBUFGET - Get a buffer from the buffer pool                   *
                                    8705     750.     *                                                                 *
                                    8706     751.     *     Input - @SBFGET                                             *
                                    8707     752.     *                                                                 *
                                    8708     753.     *     Output - A buffer fixed in memory                           *
                                    8709     754.     *                                                                 *
                                    8710     755.     *******************************************************************
 000C02                             8711     756.     SBUFGET  PROC  @SBGET,SCOPE=GLOBAL
 000C02 E2C2E4C6C7C5E340            8717             +
 000C0A 0010/0000                   8718             +
 000C0E 900F D004/18AF       00004  8720             +
 USING  SBUFGET,R10
 000C14 50D0 C000/18CD       00000  8735             +
 000C1A 9680 C000      00000        8737             +
 USING  @SBGET-72,R12
 000C1E 41D0 C058            00058  8751             +
 USING  SBCNTRL,R2                  8752     757.              WITH  (SBCNTRL,RA)
 000C22 5820 C048            00000  8765     758.              L     RA,@SBGPOO          Point to pool control
 000C26 58F0 2004            00004  8766     759.              L     R15,SBCLEN          Get buffer length
 000C2A 41F0 F000            00000  8767     760.              LA    R15,@R15            Clear high order bit
 000C2E 50F0 C050            00008  8768     761.              ST    R15,@SBGLEN         Set length
                                    8769     762.              SPOP  HEAD=SBCF           Get a buffer
 000C32 9801 2020            00020  8771    01-01537 +         LM    RVR,RS,SBCF         Get fwd and sequence number
 000C36                             8776    04-LABEL +$$$133S  DS    0H
 000C36 1200                        8786  1 04-$REL  +           LTR   RVR,RVR
 000C38 4780 A040            00C4E  8789  1 03-$BC   +           BC    8,$$$133F
 000C3C                             8792  1 04-LABEL +$$$134F    DS    0H
 000C3C 18E0                        8795  1 01-01540 +           LR    R14,RVR             Point to first item
 000C3E 58EE 0000            00000  8796  1 01-01541 +           L     R14,0(R14)          Get fwd pointer
 000C42 41F1 0001            00001  8797  1 01-01542 +           LA    R15,1(RS)           Increment sequence
 000C46 BB0E 2020            00020  8798    01-01543 +         CDS   RVR,R14,SBCF        Remove item from list
 000C4A 4770 A028            00C36  8812    05-$BC   +         BC    7,$$$133S
 000C4E                             8815    06-LABEL +$$$133F  DS    0H
 000C4E 1200/4780 A092       00CA0  8819     763.              IF    (RVR,NZ),BEGIN
 000C54 5000 C04C            00004  8833  1  764.                ST    RVR,@SBGADR         Set buffer address
 000C58 58E0 2028/18FE       00028  8834  1  765.                DECRS SBCFCNT             One less free buffer
 000C5E 06F0/BAEF 2028       00028  8844  1          +
 000C64 4770 A04E            00C5C  8859  1          +
 000C68 58F0 202C            0002C  8865  1  766.                L     R15,SBCTCNT         Get total count of blocks
 000C6C 5BF0 2028            00028  8866  1  767.                S     R15,SBCFCNT         Calc count inuse
 000C70 58E0 2008            00008  8867  1  768.                L     R14,SBCHII          Get high-water
 000C74                             8868  1  769.                LOOP  BEGIN
 000C74 19EF/47A0 A074       00C82  8874  2  770.                  IF    (R14,GE,R15),EXIT   Not a new high-water mark
 000C7A BAEF 2008            00008  8892  2  771.                  CS    R14,R15,SBCHII      Set new high-water mark
 000C7E 4770 A066            00C74  8893  1  772.                UNTIL Z,END
 000C82 9180 2004      00004        8912  1  773.                IF    ('TM SBCFIX,L"SBCFIX',Z),BEGIN Not in fixed core
 000C86 4770 A092            00CA0  8920  1          +
 USING  @PAGE-72,R13                8925  2  774.                  PSET  @PAGE
 000C8A D708 D048 D048 00000 00000  8942  2          +
 000C90 5000 D048            00000  8943  2  775.                  PMOV  @PAGLOC,(RVR)       Buffer address
 000C94                             8953  2  776.                  PMOV  @PAGLEN,SBCLEN      Buffer length
 000C94 D203 D04C 2004 00004 00004  8957  2          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   69
0Current Usings:  (PZERO,R0) (SBCNTRL,R2) (SBUFGET,R10) (@SBGET-72,R12) (@PAGE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000C9A 58F0 A50A/0DEF       01118  8958  2  777.                  VCALL PAGFIX              Fix in core
 000CA0                             8962  1  778.                END   ,
 000CA0                             8966     779.              END   ,
 000CA0 A096           00CA0 00C52  8970     780.              ELSE  BEGIN               Must wait for buffer
 000CA0 47F0 A1AE            00DBC  8975             +
 000CA4 5870 0200            00200  8981  1  781.                L     RY,MATPTR           Point to MAT
 000CA8 5870 7020            00020  8982  1  782.                WITH  (MAT,RY),'L RY,MATSBWB' Point to free buff waits
 USING  MAT,R7
 DROP   MAT,R7
 USING  SLDUMMY,R7                  9006  1  783.                WITH  (SLDUMMY,RY)
                                    9019  1  784.                SAVAIL HEAD=SLDUM,LEN=L'SBWAIT Get a buffer wait block
 000CAC 9801 7000            00000  9022  1 02-01537 +           LM    RVR,RS,SLDUM        Get fwd and sequence number
 000CB0                             9027  1 05-LABEL +$$$147S    DS    0H
 000CB0 1200                        9037  2 05-$REL  +             LTR   RVR,RVR
 000CB2 4780 A0BA            00CC8  9040  2 04-$BC   +             BC    8,$$$147F
 000CB6                             9043  2 05-LABEL +$$$148F      DS    0H
 000CB6 18E0                        9046  2 02-01540 +             LR    R14,RVR             Point to first item
 000CB8 58EE 0000            00000  9047  2 02-01541 +             L     R14,0(R14)          Get fwd pointer
 000CBC 41F1 0001            00001  9048  2 02-01542 +             LA    R15,1(RS)           Increment sequence
 000CC0 BB0E 7000            00000  9049  1 02-01543 +           CDS   RVR,R14,SLDUM       Remove item from list
 000CC4 4770 A0A2            00CB0  9063  1 06-$BC   +           BC    7,$$$147S
 000CC8 1200/4770 A110       00D1E  9066  1 07-LABEL +$$$147F    DS    0H
 DROP   @PAGE-72,R13                9085  2 02-VMGET +*,                                     Storage from pool 59
 USING  @VMGET-72,R13
 000CCE D70A D048 D048 00000 00000  9111  2          +
 000CD4 4100 0020            00020  9123  2          +
 000CD8 5000 D048            00000  9128  2          +
 000CDC D201 D050 A546 00008 01154  9129  2          +
 000CE2 58F0 A50E/0DEF       0111C  9132  2          +
 000CE8 1200/4770 A110       00D1E  9141  2          +
 000CEE AC04 021B      0021B        9151  3          +
 000CF2 9680 021A      0021A        9157  3          +
 000CF6 50F0 021C            0021C  9158  3          +
 000CFA 58F0 0210            00210  9159  3          +
 000CFE 89F0 0010            00010  9160  3          +
 000D02 88F0 0010            00010  9161  3          +
 000D06 41F0 F000            00000  9162  3          +
 000D0A AEFF 0006            00006  9163  3          +
 000D0E D5D66DD4C5D46DE2            9164  2          +
 000D1E 1860                        9173  1  785.                LR    RX,RVR              Get pointer
 USING  SBWAIT,R6                   9174  1  786.                WITH  (SBWAIT,RX)
 000D20                             9187  1  787.                CLEAR SBWAIT
 000D20 D71F 6000 6000 00000 00000  9193  1          +
 000D26 D203 6008 A512 00008 01120  9194  1  788.                MVC   SBWBID,=CL4'SBUF'
 000D2C D203 600C 0208 0000C 00208  9195  1  789.                MVC   SBWASB,PZCURASB     Our address space
                                    9196  1  790.                Q_QUE HEAD=SBCW,ITEM=SBWAIT Put on the wait queue
 DROP   @VMGET-72,R13               9207  1 05-00188 +         $$USING @R13,13
 USING  @QUE-72,R13                 9210  1 03-00188 +         $$USING @QUE-72,SPR
 000D32 98EF 2018            00018  9212  1 01-01669 +           LM    R14,R15,SBCWSEQ
 000D36 90EF D048            00000  9213  1 01-01670 +           STM   R14,R15,@QUESEQ     Set sequence stuff
 000D3A 4100 2010            00010  9225  1 04-$L    +           LA    RVR,SBCW
                                    9229  1 03-STF   +$$JR23     EQU   0,4,C'N'
 000D3E 5000 D054            0000C  9230  1 03-STF   +           ST    0,@QUELHD
                                    9240  1 03-STF   +$$JR24     EQU   0,4,C'N'
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   70
0Current Usings:  (PZERO,R0) (SBCNTRL,R2) (SBWAIT,R6) (SLDUMMY,R7) (SBUFGET,R10) (@SBGET-72,R12) (@QUE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000D42 5060 D050            00008  9241  1 03-STF   +           ST    6,@QUEITM
 000D46                             9246  1 04-LABEL +$$$153S    DS    0H
 000D46 58F0 A516            01124  9250  2 02-VCALL +             L     EPAR,=V(QUEUE)
 000D4A 0DEF                        9251  1 02-VCALL +           BASR  RAR,EPAR
 000D4C 1200                        9265  1 07-$REL  +           LTR   RVR,RVR
 000D4E 4770 A138            00D46  9268  1 05-$BC   +           BC    7,$$$153S
 000D52                             9271  1 06-LABEL +$$$153F    DS    0H
 000D52 58E0 200C            0000C  9275  1  791.                L     R14,SBCHIW          Get high-water count
 000D56 58F0 201C            0001C  9276  1  792.                L     R15,SBCWCNT         Get wait count
 000D5A                             9277  1  793.                LOOP  BEGIN
 000D5A 19EF/47A0 A15A       00D68  9283  2  794.                  IF    (R14,GE,R15),EXIT   Not a new high-water mark
 000D60 BAEF 200C            0000C  9301  2  795.                  CS    R14,R15,SBCHIW      Set new high-water mark
 000D64 4770 A14C            00D5A  9302  1  796.                UNTIL Z,END
 DROP   @QUE-72,R13                 9321  1  797.                AWAIT SBWECB,LEN=LONG     Wait for hold
 USING  @AWAIT-72,R13
 000D68 D704 D048 D048 00000 00000  9342  1          +
 000D6E 4100 6010            00010  9354  1          +
 000D72 5000 D048            00000  9359  1          +
 000D76 9680 D04C      00004        9365  1          +
 000D7A 58F0 A51A/0DEF       01128  9368  1          +
 DROP   @AWAIT-72,R13               9370  1  798.                PSET  @SYSRDEL
 USING  @SYSRDEL-72,R13
 000D80 D703 D048 D048 00000 00000  9390  1          +
 000D86 5000 D048            00000  9391  1  799.                PMOV  @SYSRDID,(RVR)
 000D8A 58F0 A51E/0DEF       0112C  9401  1  800.                VCALL SYSRDEL
 000D90 D203 C04C 600C 00004 0000C  9405  1  801.                MVC   @SBGADR,SBWADR      Set buffer address (still fixed)
 000D96                             9406  1  802.                CLEAR SBWAIT
 000D96 D71F 6000 6000 00000 00000  9412  1          +
 000D9C D203 6008 A522 00008 01130  9413  1  803.                MVC   SBWBID,=C'sBWB'
                                    9414  1  804.                SPUSH HEAD=SLDUM,ITEM=SBWAIT Put away the wait block
 000DA2 98EF 7000            00000  9416  1 01-01509 +           LM    R14,R15,SLDUM       Get fwd ptr and sequence number
 000DA6 4100 6000            00000  9417  1 01-01510 +           LA    RVR,SBWAIT          Point to new item
 000DAA                             9422  1 04-LABEL +$$$160S    DS    0H
 000DAA 411F 0001            00001  9424  2 01-01512 +             LA    RS,1(R15)           Increment sequence
 000DAE D203 6000 7000 00000 00000  9425  2 01-01513 +             MVC   SBWAIT(L'SLDUMFP),SLDUMFP   Set item fwd ptr
 000DB4 BBE0 7000            00000  9426  1 01-01514 +           CDS   R14,RVR,SLDUM       Add item to list
 000DB8 4770 A19C            00DAA  9440  1 05-$BC   +           BC    7,$$$160S
 000DBC                             9443  1 06-LABEL +$$$160F    DS    0H
 DROP   SBWAIT,R6                   9447     805.              END   ,                   End else
 DROP   SLDUMMY,R7
 000DBC 58E0 C04C            00004  9461     806.              L     R14,@SBGADR         Get buffer address
 000DC0                             9462     807.              CLEAR (@R14,8)            Clear out free list stuff
 000DC0 D707 E000 E000 00000 00000  9468             +
0000DC6 1B00                        9470     809.              CLEAR RVR
 000DC8 981F C008            00008  9474     810.              PEND  ,
 DROP   SBCNTRL,R2
 DROP   @SBGET-72,R12
 DROP   SBUFGET,R10
 000DCC 9680 C000/0B0E 00000        9494             +
 DROP   @SYSRDEL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   71
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   9504     812.     *******************************************************************
                                    9505     813.     *                                                                 *
                                    9506     814.     *   SBUFREE - Give a buffer back to the pool                      *
                                    9507     815.     *                                                                 *
                                    9508     816.     *     Input - @SBFAPI                                             *
                                    9509     817.     *                                                                 *
                                    9510     818.     *     Output - None                                               *
                                    9511     819.     *                                                                 *
                                    9512     820.     *******************************************************************
 000DD2                             9513     821.     SBUFREE  PROC  @SBFREE,SCOPE=GLOBAL
 000DD2 E2C2E4C6D9C5C540            9519             +
 000DDA 0008/0000                   9520             +
 000DDE 900F D004/18AF       00004  9522             +
 USING  SBUFREE,R10
 000DE4 50D0 C000/18CD       00000  9537             +
 000DEA 9680 C000      00000        9539             +
 USING  @SBFREE-72,R12
 000DEE 41D0 C050            00050  9553             +
 USING  SBCNTRL,R2                  9554     822.              WITH  (SBCNTRL,RA)
 000DF2 5820 C048            00000  9567     823.              L     RA,@SBFPOO          Point to buffer pool control
 000DF6 5880 C04C            00004  9568     824.              L     RM,@SBFADR          Returned buffer address
 000DFA 5890 2004            00004  9569     825.              L     RN,SBCLEN           Get buffer length
 000DFE 4190 9000            00000  9570     826.              LA    RN,@RN              Clear high order bit
 000E02 1B11                        9571     827.              CLEAR R1
 000E04 0E80                        9575     828.              MVCL  RM,R0               Clean the buffer
 000E06                             9576     829.     SBUFREE3 BEGIN ,
 000E06 98EF 2018            00018  9581  1  830.                LM    R14,R15,SBCWSEQ     Get queue sequence stuff
 000E0A 12FF/4780 A090       00E6E  9582  1  831.                IF    (R15,NZ),BEGIN      Someone waiting for buffer
 USING  @QUE-72,R13                 9596  2  832.                  PSET  @QUE,CLEAR=NO
 000E10 90EF D048            00000  9607  2  833.                  STM   R14,R15,@QUESEQ     Set sequence stuff
 000E14 4100 2010            00010  9608  2  834.                  PMOV  @QUELHD,LA:SBCW
 000E18 5000 D054            0000C  9624  2          +
 000E1C                             9625  2  835.                  PMOV  @QUEITM,SBCWFP
 000E1C D203 D050 2010 00008 00010  9629  2          +
 000E22 58F0 A356/0DEF       01134  9630  2  836.                  ACALL QUEREM              Remove from queue
 000E28 1200/4780 A054       00E32  9637  2  837.                  IF    (RVR,NZ),'NEXT SBUFREE3' Take it from the top
 000E2E 47F0 A028            00E06  9654  2          +
 000E32 5860 D050            00008  9659  2  838.                  L     RX,@QUEITM          Point to the wait block
 USING  SBWAIT,R6                   9660  2  839.                  WITH  (SBWAIT,RX)
 DROP   @QUE-72,R13                 9673  2  840.                  PSET  @SYSRNEW            Get system routine ID
 USING  @SYSRNEW-72,R13
 000E36 D703 D048 D048 00000 00000  9693  2          +
 000E3C 58F0 A35A/0DEF       01138  9694  2  841.                  VCALL SYSRNEW
 000E42 18F0                        9698  2  842.                  LR    R15,RVR
 000E44 58E0 600C            0000C  9699  2  843.                  L     R14,SBWASB          Get the address space
                                    9700  2  844.     * Note: SBWASB and SBWADR overlap
 000E48 D203 600C C04C 0000C 00004  9701  2  845.                  MVC   SBWADR,@SBFADR      They can have this one
 DROP   @SYSRNEW-72,R13             9702  2  846.                  SIGNL SBWECB,(R15),(R14),(R15) wake up post haste!!!
 USING  @SIGNAL-72,R13
 000E4E D713 D048 D048 00000 00000  9723  2          +
 000E54 4100 6010            00010  9735  2          +
 000E58 5000 D050            00008  9740  2          +
 000E5C 50F0 D04C            00004  9750  2          +
 000E60 50E0 D054            0000C  9760  2          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   72
0Current Usings:  (PZERO,R0) (SBCNTRL,R2) (SBWAIT,R6) (SBUFREE,R10) (@SBFREE-72,R12) (@SIGNAL-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000E64 50F0 D058            00010  9770  2          +
 000E68 58F0 A35E/0DEF       0113C  9773  2          +
 DROP   SBWAIT,R6                   9775  1  847.                END   ,                   End if
 000E6E A094           00E6E 00E0E  9784  1  848.                ELSE  BEGIN
 000E6E 47F0 A0EA            00EC8  9789  1          +
 000E72 9180 2004      00004        9795  2  849.                  IF    ('TM SBCFIX,L"SBCFIX',Z),BEGIN Not in fixed core
 000E76 4770 A0B4            00E92  9803  2          +
 DROP   @SIGNAL-72,R13              9808  3  850.                    PSET  @PAGE
 USING  @PAGE-72,R13
 000E7A D708 D048 D048 00000 00000  9828  3          +
 000E80                             9829  3  851.                    PMOV  @PAGLOC,@SBFADR     Buffer address
 000E80 D203 D048 C04C 00000 00004  9833  3          +
 000E86                             9834  3  852.                    PMOV  @PAGLEN,SBCLEN      Buffer length
 000E86 D203 D04C 2004 00004 00004  9838  3          +
 000E8C 58F0 A362/0DEF       01140  9839  3  853.                    VCALL PAGUFIX             Unfix in core
 000E92                             9843  2  854.                  END   ,                   End if
 000E92 5880 C04C            00004  9847  2  855.                  L     RM,@SBFADR
 000E96 D203 8004 A366 00004 01144  9848  2  856.                  MVC   4(4,RM),=C'BUFF'
                                    9849  2  857.                  SPUSH HEAD=SBCF,ITEM=@RM  Put back on free list
 000E9C 98EF 2020            00020  9851  2 01-01509 +             LM    R14,R15,SBCF        Get fwd ptr and sequence number
 000EA0 4100 8000            00000  9852  2 01-01510 +             LA    RVR,@RM             Point to new item
 000EA4                             9857  2 04-LABEL +$$$170S      DS    0H
 000EA4 411F 0001            00001  9859  3 01-01512 +               LA    RS,1(R15)           Increment sequence
 000EA8 D203 8000 2020 00000 00020  9860  3 01-01513 +               MVC   @RM(L'SBCFFP),SBCFFP        Set item fwd ptr
 000EAE BBE0 2020            00020  9861  2 01-01514 +             CDS   R14,RVR,SBCF        Add item to list
 000EB2 4770 A0C6            00EA4  9875  2 05-$BC   +             BC    7,$$$170S
 000EB6                             9878  2 06-LABEL +$$$170F      DS    0H
 000EB6 58E0 2028/18FE       00028  9882  2  858.                  INCRS SBCFCNT             Increment count
 000EBC 5EF0 A36A            01148  9893  3          +
 000EC0 BAEF 2028            00028  9894  2          +
 000EC4 4770 A0DC            00EBA  9908  2          +
 000EC8                             9914  1  859.                END   ,                   End else
 000EC8                             9918     860.              END   ,                   End begin
 000EC8 1B00                        9922     861.              CLEAR RVR
 000ECA 981F C008            00008  9926     862.              PEND  ,
 DROP   SBCNTRL,R2
 DROP   @SBFREE-72,R12
 DROP   SBUFREE,R10
 000ECE 9680 C000/0B0E 00000        9946             +
 DROP   @PAGE-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   73
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                   9956     864.     *******************************************************************
                                    9957     865.     *                                                                 *
                                    9958     866.     *   SBUFINIT - Initialize a system buffer pool                    *
                                    9959     867.     *              No buffer will straddle a page boundry             *
                                    9960     868.     *                                                                 *
                                    9961     869.     *     Input - @SBINIT                                             *
                                    9962     870.     *                                                                 *
                                    9963     871.     *     Output - System buffer pool contorl address                 *
                                    9964     872.     *                                                                 *
                                    9965     873.     *******************************************************************
 000ED4                             9966     874.     SBUFINIT PROC  @SBINIT,SCOPE=GLOBAL
 000ED4 E2C2E4C6C9D5C9E3            9972             +
 000EDC 0010/0000                   9973             +
 000EE0 900F D004/18AF       00004  9975             +
 USING  SBUFINIT,R10
 000EE6 50D0 C000/18CD       00000  9990             +
 000EEC 9680 C000      00000        9992             +
 USING  @SBINIT-72,R12
 000EF0 41D0 C058            00058 10006             +
 USING  SBCNTRL,R2                 10007     875.              WITH  (SBCNTRL,RA)
 USING  @VMGET-72,R13              10020     876.              VMGET L'SBCNTRL,LOC=GLOBHI,FIX=YES
 000EF4 D70A D048 D048 00000 00000 10044             +
 000EFA 4100 0038            00038 10056             +
 000EFE 5000 D048            00000 10061             +
 000F02 D201 D050 A276 00008 01156 10062             +
 000F08 58F0 A23C/0DEF       0111C 10065             +
 000F0E 1220/4770 A064       00F44 10067     877.              IF    ('LTR RA,RVR',Z),'ABORT NOBUFCNTMEM'
 000F14 AC04 021B      0021B       10084  1          +
 000F18 9680 021A      0021A       10090  1          +
 000F1C 50F0 021C            0021C 10091  1          +
 000F20 58F0 0210            00210 10092  1          +
 000F24 89F0 0010            00010 10093  1          +
 000F28 88F0 0010            00010 10094  1          +
 000F2C 41F0 F000            00000 10095  1          +
 000F30 AEFF 0006            00006 10096  1          +
 000F34 D5D6C2E4C6C3D5E3           10097             +
 000F44                            10102     878.              CLEAR SBCNTRL             Clear buffer pool control
 000F44 D737 2000 2000 00000 00000 10108             +
 000F4A D203 2000 A26C 00000 0114C 10109     879.              MVC   SBCBID,=CL4'SBCB'   Set id
 000F50 4110 2010            00010 10110     880.              LA    RS,SBCW
 000F54 5010 2010            00010 10111     881.              ST    RS,SBCWFP           Init wait queue head
 000F58 5010 2014            00014 10112     882.              ST    RS,SBCWBP
 000F5C 5810 C048            00000 10113     883.              L     RS,@SBILEN
 000F60 4110 1007            00007 10114     884.              LA    RS,@RS+7            Round up to even dword
 000F64 5010 2004            00004 10115     885.              ST    RS,SBCLEN           Set buffer length
 000F68 94F8 2007      00007       10116     886.              NI    SBCLEN+L'SBCLEN-1,B'11111000'
 000F6C 5810 2004            00004 10117     887.              L     RS,SBCLEN           Get it back
 000F70                            10118     888.              IF    (SBCLEN,GT,=A(4096)),'ABORT BADBIGBUFFER' Do your own
 000F70 D503 A270 2004 01150 00004 10129             +
 000F76 47B0 A0CA            00FAA 10130             +
 000F7A AC04 021B      0021B       10139  1          +
 000F7E 9680 021A      0021A       10145  1          +
 000F82 50F0 021C            0021C 10146  1          +
 000F86 58F0 0210            00210 10147  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   74
0Current Usings:  (PZERO,R0) (SBCNTRL,R2) (SBUFINIT,R10) (@SBINIT-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0000F8A 89F0 0010            00010 10148  1          +
 000F8E 88F0 0010            00010 10149  1          +
 000F92 41F0 F000            00000 10150  1          +
 000F96 AEFF 0006            00006 10151  1          +
 000F9A C2C1C4C2C9C7C2E4           10152             +
 000FAA 9120 C050      00008       10157     889.              IF    @SBFIX,'OI SBCFIX,L"SBCFIX' Set fixed memory
 000FAE 47E0 A0D6            00FB6 10167             +
 000FB2 9680 2004      00004       10173             +
 000FB6 1BEE                       10178     890.              CLEAR R14
 000FB8 58F0 A270            01150 10182     891.              L     R15,=A(4096)
 000FBC 1DE1                       10183     892.              DR    R14,RS              Calc buffers per page
 000FBE 5810 C04C            00004 10184     893.              L     RS,@SBICNT          Get count of buffers
 000FC2 1B00                       10185     894.              CLEAR R0
 000FC4 1D0F                       10189     895.              DR    R0,R15              Calc number of pages
 000FC6 1200/4780 A0F0       00FD0 10190     896.              IF    (R0,NZ),'INCR RS'   Round up
 000FCC 5E10 A268            01148 10207             +
 000FD0 1831                       10212     897.              LR    RB,RS               Save for loop count later
 000FD2 8910 000C            0000C 10213     898.              SLL   RS,12               Calc number of bytes
 000FD6 5010 2034            00034 10214     899.              ST    RS,SBCBLEN          Save *** temp ***
 000FDA 9180 C050      00008       10215     900.              IF    @SBLSYS,BEGIN
 000FDE 47E0 A11C            00FFC 10225             +
 000FE2                            10230  1  901.                VMGET (RS),LOC=LOCSYS,PAGE=YES
 000FE2 D70A D048 D048 00000 00000 10247  1          +
 000FE8 5010 D048            00000 10257  1          +
 000FEC D201 D050 A278 00008 01158 10258  1          +
 000FF2 9680 D052      0000A       10264  1          +
 000FF6 58F0 A23C/0DEF       0111C 10267  1          +
 000FFC                            10269     902.              END   ,
 000FFC A120           00FFC 00FE0 10273     903.              ELSEIF @SBGLHI,BEGIN
 000FFC 47F0 A168            01048 10279             +
 001000 9140 C050      00008       10291             +
 001004 47E0 A168            01048 10292             +
 001008 9120 C050      00008       10297  1  904.                IF    @SBFIX,BEGIN
 00100C 47E0 A14A            0102A 10307  1          +
 001010                            10312  2  905.                  VMGET (RS),LOC=GLOBHI,FIX=YES,PAGE=YES
 001010 D70A D048 D048 00000 00000 10329  2          +
 001016 5010 D048            00000 10339  2          +
 00101A D201 D050 A276 00008 01156 10340  2          +
 001020 9680 D052      0000A       10346  2          +
 001024 58F0 A23C/0DEF       0111C 10349  2          +
 00102A                            10351  1  906.                END
 00102A A14E           0102A 0100E 10355  1  907.                ELSE  BEGIN
 00102A 47F0 A168            01048 10360  1          +
 00102E                            10366  2  908.                  VMGET (RS),LOC=GLOBHI,FIX=NO,PAGE=YES
 00102E D70A D048 D048 00000 00000 10383  2          +
 001034 5010 D048            00000 10393  2          +
 001038 D201 D050 A274 00008 01154 10394  2          +
 00103E 9680 D052      0000A       10400  2          +
 001042 58F0 A23C/0DEF       0111C 10403  2          +
 001048                            10405  1  909.                END   ,
 001048                            10409     910.              END   ,
 001048 A16C           01048 01006 10413     911.              ELSE  'ABORT BADBUFFLOCATION' No default, be specific
 001048 47F0 A19C            0107C 10418             +
 00104C AC04 021B      0021B       10428  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   75
0Current Usings:  (PZERO,R0) (SBCNTRL,R2) (SBUFINIT,R10) (@SBINIT-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001050 9680 021A      0021A       10434  1          +
 001054 50F0 021C            0021C 10435  1          +
 001058 58F0 0210            00210 10436  1          +
 00105C 89F0 0010            00010 10437  1          +
 001060 88F0 0010            00010 10438  1          +
 001064 41F0 F000            00000 10439  1          +
 001068 AEFF 0006            00006 10440  1          +
 00106C C2C1C4C2E4C6C6D3           10441             +
 00107C 1260/4770 A1D2       010B2 10446     912.              IF    ('LTR RX,RVR',Z),'ABORT NOBUFFERMEMORY'
 001082 AC04 021B      0021B       10463  1          +
 001086 9680 021A      0021A       10469  1          +
 00108A 50F0 021C            0021C 10470  1          +
 00108E 58F0 0210            00210 10471  1          +
 001092 89F0 0010            00010 10472  1          +
 001096 88F0 0010            00010 10473  1          +
 00109A 41F0 F000            00000 10474  1          +
 00109E AEFF 0006            00006 10475  1          +
 0010A2 D5D6C2E4C6C6C5D9           10476             +
 0010B2 1BFF                       10481     913.              CLEAR R15
 0010B4 0E0E                       10485     914.              MVCL  R0,R14              Clear the area
 0010B6 5060 2020            00020 10486     915.              ST    RX,SBCFFP           Set free list pointer
 0010BA 5060 2030            00030 10487     916.              ST    RX,SBCBSTRT         Save *** temp ***
 0010BE 5870 2004            00004 10488     917.              L     RY,SBCLEN           Length of a buffer
 0010C2 4170 7000            00000 10489     918.              LA    RY,@RY              Clear high order bit
 0010C6 1B00                       10490     919.              CLEAR R0
 0010C8 5810 A270            01150 10494     920.              L     RS,=A(4096)
 0010CC 1D07                       10495     921.              DR    R0,RY               Calc count of buffers per page
 0010CE 1B88                       10496     922.              CLEAR RM
 0010D0 1893                       10500     923.              LR    RN,RB               Get count of pages
 0010D2 1C81                       10501     924.              MR    RM,RS               Calc count of buffers
 0010D4 5090 202C            0002C 10502     925.              ST    RN,SBCTCNT          Set total count
 0010D8 5090 2028            00028 10503     926.              ST    RN,SBCFCNT          Set free count
 0010DC                            10504     927.              LOOP  BEGIN               String'em up
 0010DC 18E6                       10510  1  928.                LR    R14,RX              Point to first buff this page
 0010DE 1801                       10511  1  929.                LR    R0,RS               Count of buffers per page
 0010E0 18FE                       10512  1  930.                LR    R15,R14             Init
 0010E2                            10513  1  931.                LOOP  BEGIN
 0010E2 18EF                       10519  2  932.                  LR    R14,R15             Point to next buffer
 0010E4 41F7 E000            00000 10520  2  933.                  LA    R15,@R14(RY)        Point to next next buffer
 0010E8 50F0 E000            00000 10521  2  934.                  ST    R15,@R14            Set fwd pointer
 0010EC D203 E004 A264 00004 01144 10522  2  935.                  MVC   4(4,R14),=C'BUFF'
 0010F2 4600 A202            010E2 10523  1  936.                UNTIL (BCT,R0),END        Until this page is linked
 0010F6 5A60 A270            01150 10533  1  937.                A     RX,=A(4096)         Point to next page
 0010FA 5060 E000            00000 10534  1  938.                ST    RX,@R14             Reset this one
 0010FE 4630 A1FC            010DC 10535     939.              UNTIL (BCT,RB),END        Until all pages are linked
 001102 5030 E000            00000 10545     940.              ST    RB,@R14             Last one is zero
 001106 4100 2000            00000 10546     941.              LA    RVR,SBCNTRL         Return pointer
 00110A 981F C008            00008 10547     942.              PEND  ,
 DROP   SBCNTRL,R2
 DROP   @SBINIT-72,R12
 DROP   SBUFINIT,R10
 00110E 9680 C000/0B0E 00000       10567             +
 DROP   @VMGET-72,R13
 001118                            10576     943.              LTORG ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   76
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001118 00000000                   10578                             =V(PAGFIX)
 00111C 00000000                   10579                             =V(VMGET)
 001120 E2C2E4C6                   10580                             =CL4'SBUF'
 001124 00000000                   10581                             =V(QUEUE)
 001128 00000000                   10582                             =V(AWAIT)
 00112C 00000000                   10583                             =V(SYSRDEL)
 001130 A2C2E6C2                   10584                             =C'sBWB'
 001134 00000B10                   10585                             =A(QUEREM)
 001138 00000000                   10586                             =V(SYSRNEW)
 00113C 00000000                   10587                             =V(SIGNAL)
 001140 00000000                   10588                             =V(PAGUFIX)
 001144 C2E4C6C6                   10589                             =C'BUFF'
 001148 00000001                   10590                             =A(1)
 00114C E2C2C3C2                   10591                             =CL4'SBCB'
 001150 00001000                   10592                             =A(4096)
 001154 3B00                       10593                             =Y(59*256+0)
 001156 3F00                       10594                             =Y(63*256+0)
 001158 1B00           0115A 03638 10595                             =Y(27*256+0)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   77
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  10600     945.     *******************************************************************
                                   10601     946.     *                                                                 *
                                   10602     947.     *    LOCKCT - Lock manager CT -- Pointed to by MAT                *
                                   10603     948.     *                                                                 *
                                   10604     949.     *******************************************************************
0000000                00000 0001D 10606     951.     LOCKCT   RECORD BEGIN
 000000                            10614  1  952.                DS    CL4'LKCT'
 000004                            10615  1  953.     LOCKFCNT   DS    A             Number of free lock elements we have
 000008                            10616  1  954.                DS    0D
 000008                            10617  1  955.     LOCKFLQE   DS    A             Queue of free LQEs
 00000C                            10618  1  956.                DS    A             | control word
 000010                            10619  1  957.     LOCKECHN   DS    A             Queue of all LQEs
 000014                            10620  1  958.                DS    A             | control word
 000018                            10621  1  959.     LOCKSCNT   DS    A             Number of times to 'spin' for lock
 00001C 00                         10622  1  960.     LOCKFL     FLAG  ,             Lock flags
 LOCKFL.LKFINIT    80 ONES         10626  1  961.                FLAG  LKFINIT       Initialization
                                   10631  1  962.
                                   10632  1  963.     LOCKECNT   EQU   40            Number of elements to get at first
                                   10633  1  964.     CLKSCNT    EQU   50            Number of times to spin for s-locks
 00001D                0001D 0001D 10634     965.              END   ,
-                                  10644     967.     *******************************************************************
                                   10645     968.     *                                                                 *
                                   10646     969.     *    LOCKCB - Lock Control Block                                  *
                                   10647     970.     *                                                                 *
                                   10648     971.     *******************************************************************
0000000                00000 00031 10650     973.     LOCKCB   RECORD BEGIN
 000000 D3D6C3D2                   10658  1  974.                DC    CL4'LOCK'     Control block id
 000004                            10659  1  975.     LOCKNAME   DS    CL16          Name of this lock
 000014                            10660  1  976.     LOCKCHN    DS    A             Pointer to LOCKCB chain
                                   10661  1  977.     *
                                   10662  1  978.     *  Spin style lock
                                   10663  1  979.     *
 000018                            10664  1  980.     LOCKCTL    DS    D             Control word for spin locks
                                   10665  1  981.     *
                                   10666  1  982.     *  Suspend style lock
                                   10667  1  983.     *
 000020                00020 00018 10668  1  984.                ORG   LOCKCTL
 000018                            10669  1  985.     LOCKPLUM   DS    A             Pointer to the 'plum' LQE
 00001C                            10670  1  986.     LOCKOWNR   DS    A             Lock owner's LQE address
 000020                00020 00020 10671  1  987.                ORG   ,
                                   10672  1  988.
 000020                            10673  1  989.     LOCKCNT    DS    A             Number of 'obtains' by this task
 000024                            10674  1  990.     LOCKSRID   DS    A             System Routine ID for this lock
                                   10675  1  991.     *
                                   10676  1  992.     *  Stats, etc
                                   10677  1  993.     *
 000028                            10678  1  994.     LOCKWCNT   DS    A             Count of waits
 00002C                            10679  1  995.     LOCKRCNT   DS    A             Count of requests
 000030 00                         10680  1  996.     LOCKCFL    FLAG
 LOCKCFL.LCFSPIN   80 ONES         10684  1  997.                FLAG  LCFSPIN       Spin lock
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   78
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0LOCKCFL.LCFOWNED  40 ONES         10689  1  998.                FLAG  LCFOWNED      Suspend lock owned
 000031                00031 00031 10694     999.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   79
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  10704    1001.     *******************************************************************
                                   10705    1002.     *                                                                 *
                                   10706    1003.     *    LQE - Lock Queue Element
                                   10707    1004.     *                                                                 *
                                   10708    1005.     *******************************************************************
0000000                00000 00020 10710    1007.     LQE      RECORD BEGIN
 000000 D3D8C540                   10718  1 1008.     LQEID      DC    CL4'LQE'      Control block id
 000004                            10719  1 1009.     LQELOCK    DS    A             Pointer to the LOCKCB for the lock
 000008                            10720  1 1010.     LQEECB     DS    D             Synchronization word
 000010                            10721  1 1011.     LQEPID     DS    0D            Owning Process ID - Zero if free
 000010                            10722  1 1012.     LQEASB     DS    A             | Address space block
 000014                            10723  1 1013.     LQETID     DS    A             | Task ID
 000018                            10724  1 1014.     LQENEXT    DS    A             Next on free queue/Element to post
 00001C                            10725  1 1015.     LQECHAIN   DS    A             Chain of all LQES
 000020                00020 00020 10726    1016.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   80
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  10736    1018.     *******************************************************************
                                   10737    1019.     *                                                                 *
                                   10738    1020.     *   LOCKCRE - Create a lock.                                      *
                                   10739    1021.     *                                                                 *
                                   10740    1022.     *     Input - @LOCKCRE                                            *
                                   10741    1023.     *                                                                 *
                                   10742    1024.     *    Output - Returns a 32 bit lock id.                           *
                                   10743    1025.     *                                                                 *
                                   10744    1026.     *******************************************************************
-
 00115A                            10746    1028.     LKCRE    PROC  @LOCKCRE,SCOPE=GLOBAL
 00115A D3D2C3D9C5404040           10752             +
 001162 0018/0000                  10753             +
 001166 900F D004/18AF       00004 10755             +
 USING  LKCRE,R10
 00116C 50D0 C000/18CD       00000 10770             +
 001172 9680 C000      00000       10772             +
 USING  @LOCKCRE-72,R12
 001176 41D0 C060            00060 10786             +
 00117A 5870 0200            00200 10787    1029.              L     RY,MATPTR               MAT POINTER
 00117E 5870 7014            00014 10788    1030.              WITH  (MAT,RY),'L RY,MATLCT'  Get the LOCKCT
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  10812    1031.              WITH  (LOCKCT,RY)             Address it
 001182 9180 C058      00010       10825    1032.              IF    @LFSPIN,BEGIN
 001186 47E0 A03E            011A4 10835             +
 USING  @VMGET-72,R13              10840  1 1033.                VMGET L'LOCKCB,LOC=GLOBHI,FIX=YES   Get space for the lock
 00118A D70A D048 D048 00000 00000 10864  1          +
 001190 4100 0031            00031 10876  1          +
 001194 5000 D048            00000 10881  1          +
 001198 D201 D050 AA6E 00008 01BD4 10882  1          +
 00119E 58F0 AA1A/0DEF       01B80 10885  1          +
 0011A4 A042           011A4 01188 10887    1034.              END   ELSE,BEGIN
 0011A4 47F0 A05C            011C2 10896             +
 0011A8                            10902  1 1035.                VMGET L'LOCKCB,LOC=GLOBHI    Get space for the lock
 0011A8 D70A D048 D048 00000 00000 10919  1          +
 0011AE 4100 0031            00031 10931  1          +
 0011B2 5000 D048            00000 10936  1          +
 0011B6 D201 D050 AA70 00008 01BD6 10937  1          +
 0011BC 58F0 AA1A/0DEF       01B80 10940  1          +
 0011C2                            10942    1036.              END
 0011C2 1260/4770 A092       011F8 10946    1037.              IF    ('LTR  RX,RVR',Z),'ABORT LOCKCB'
 0011C8 AC04 021B      0021B       10963  1          +
 0011CC 9680 021A      0021A       10969  1          +
 0011D0 50F0 021C            0021C 10970  1          +
 0011D4 58F0 0210            00210 10971  1          +
 0011D8 89F0 0010            00010 10972  1          +
 0011DC 88F0 0010            00010 10973  1          +
 0011E0 41F0 F000            00000 10974  1          +
 0011E4 AEFF 0006            00006 10975  1          +
 0011E8 D3D6C3D2C3C24040           10976             +
 USING  LOCKCB,R6                  10981    1038.              WITH  (LOCKCB,RX)              and address it
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   81
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LOCKCT,R7) (LKCRE,R10) (@LOCKCRE-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00011F8                            10994    1039.              CLEAR LOCKCB
 0011F8 D730 6000 6000 00000 00000 11000             +
 0011FE D203 6000 AA1E 00000 01B84 11001    1040.              MVC   LOCKCB(4),=C'LOCK'      Move in the cb id
 001204 D20F 6004 C048 00004 00000 11002    1041.              MVC   LOCKNAME,@LOCKNAM       save the name
 00120A 9180 C058      00010       11003    1042.              IF    @LFSPIN,BEGIN           Spin style lock init
 00120E 47E0 A0B0            01216 11013             +
 001212 9680 6030      00030       11018  1 1043.                SET   LCFSPIN
 001216                            11024    1044.              END   ,                       OF Spin style lock init
                                   11028    1045.     *
                                   11029    1046.     *  Suspend style lock initialization
                                   11030    1047.     *
 001216 A0B4           01216 01210 11031    1048.              ELSE  BEGIN
 001216 47F0 A13E            012A4 11036             +
                                   11042  1 1049.     *
                                   11043  1 1050.     *  Get 2 LQEs per suspend lock
                                   11044  1 1051.     *
 00121A 4110 0002            00002 11045  1 1052.                LA    RS,2
 00121E                            11046  1 1053.                LOOP  BEGIN
 00121E 41F0 A886/0DEF       019EC 11052  2 1054.                  LCALL LQEALL
 001224 4610 A0B8            0121E 11061  1 1055.                UNTIL (BCT,RS),END
                                   11071  1 1056.     *
                                   11072  1 1057.     *  Get an LQE for the 'plum' of this lock.
                                   11073  1 1058.     *
 001228 9823 7008            00008 11074  1 1059.                LM    RA,RB,LOCKFLQE          Get first free
 00122C                            11075  1 1060.                LOOP  BEGIN                   |
 00122C 1222/4770 A0FC       01262 11081  2 1061.                  IF    (RA,ZERO),'ABORT NOLQE' -->
 001232 AC04 021B      0021B       11099  3          +
 001236 9680 021A      0021A       11105  3          +
 00123A 50F0 021C            0021C 11106  3          +
 00123E 58F0 0210            00210 11107  3          +
 001242 89F0 0010            00010 11108  3          +
 001246 88F0 0010            00010 11109  3          +
 00124A 41F0 F000            00000 11110  3          +
 00124E AEFF 0006            00006 11111  3          +
 001252 D5D6D3D8C5404040           11112  2          +
 001262 5840 2018            00018 11117  2 1062.                  WITH  (LQE,RA),'L RJ,LQENEXT' Next in the queue
 USING  LQE,R2
 DROP   LQE,R2
 001266 4150 0001            00001 11141  2 1063.                  LA    RK,1
 00126A 1E53                       11142  2 1064.                  ALR   RK,RB                   Update the control word
 00126C BB24 7008            00008 11143  2 1065.                  CDS   RA,RJ,LOCKFLQE          Do the actual removal
 001270 4770 A0C6            0122C 11144  1 1066.                UNTIL EQUAL,END               OF Get first free
                                   11163  1 1067.     *
                                   11164  1 1068.     *  Get System routine ID for this lock
                                   11165  1 1069.     *
 DROP   @VMGET-72,R13              11166  1 1070.                PSET  @SYSRNEW
 USING  @SYSRNEW-72,R13
 001274 D703 D048 D048 00000 00000 11186  1          +
 00127A 58F0 AA22/0DEF       01B88 11187  1 1071.                VCALL SYSRNEW
 001280 5000 6024            00024 11191  1 1072.                ST    RVR,LOCKSRID
                                   11192  1 1073.     *
                                   11193  1 1074.     *  Post this lock ECB
                                   11194  1 1075.     *
 USING  LQE,R2                     11195  1 1076.                WITH  (LQE,RA),BEGIN
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   82
0Current Usings:  (PZERO,R0) (LQE,R2) (LOCKCB,R6) (LOCKCT,R7) (LKCRE,R10) (@LOCKCRE-72,R12) (@SYSRNEW-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001284 5060 2004            00004 11209  2 1077.                  ST    RX,LQELOCK              -->
 DROP   @SYSRNEW-72,R13            11210  2 1078.                  PSET  @SIGNAL                 Post in this AS
 USING  @SIGNAL-72,R13
 001288 D713 D048 D048 00000 00000 11230  2          +
 00128E 4100 2008            00008 11231  2 1079.                  PMOV  @SGECB,LA:LQEECB        | zero post code
 001292 5000 D050            00008 11247  2          +
 001296 58F0 AA26/0DEF       01B8C 11248  2 1080.                  VCALL SIGNAL                  |
 00129C 5020 6018            00018 11252  2 1081.                  ST    RA,LOCKPLUM             Save as the current
 0012A0 5020 601C            0001C 11253  2 1082.                  ST    RA,LOCKOWNR             And owner (free owner = plum)
 DROP   LQE,R2                     11254  1 1083.                END   ,                       OF LQE addr
 0012A4                            11262    1084.              END   ,                       OF Suspend style lock init
                                   11266    1085.     *
                                   11267    1086.     * Time to return to caller
                                   11268    1087.     *
 0012A4 1806                       11269    1088.              LR    RVR,RX                  Get the lock id (address)
 0012A6 981F C008            00008 11270    1089.              PEND
 DROP   LOCKCB,R6
 DROP   LOCKCT,R7
 DROP   @LOCKCRE-72,R12
 DROP   LKCRE,R10
 0012AA 9680 C000/0B0E 00000       11295             +
 DROP   @SIGNAL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   83
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  11305    1091.     *******************************************************************
                                   11306    1092.     *                                                                 *
                                   11307    1093.     *   LKDEL - Delete a lock.                                        *
                                   11308    1094.     *                                                                 *
                                   11309    1095.     *     Input - @LOCKS                                              *
                                   11310    1096.     *                                                                 *
                                   11311    1097.     *    Output - none                                                *
                                   11312    1098.     *                                                                 *
                                   11313    1099.     *******************************************************************
-
 0012B0                            11315    1101.     LKDEL    PROC  @LOCKS,SCOPE=GLOBAL
 0012B0 D3D2C4C5D3404040           11321             +
 0012B8 0008/0000                  11322             +
 0012BC 900F D004/18AF       00004 11324             +
 USING  LKDEL,R10
 0012C2 50D0 C000/18CD       00000 11339             +
 0012C8 9680 C000      00000       11341             +
 USING  @LOCKS-72,R12
 0012CC 41D0 C050            00050 11355             +
 0012D0 5870 0200            00200 11356    1102.              L     RY,MATPTR               MAT POINTER
 0012D4 5870 7014            00014 11357    1103.              WITH  (MAT,RY),'L RY,MATLCT'  Get the LOCKCT
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  11381    1104.              WITH  (LOCKCT,RY)             Address it
 0012D8 5860 C048            00000 11394    1105.              L     RX,@LOCKID
 USING  LOCKCB,R6                  11395    1106.              WITH  (LOCKCB,RX)
 0012DC                            11408    1107.              IF    (LOCKCB,NE,'LOCK'),'ABORT LOCKDEL'
 0012DC D503 A8C8 6000 01B84 00000 11419             +
 0012E2 4780 A05A            01316 11420             +
 0012E6 AC04 021B      0021B       11429  1          +
 0012EA 9680 021A      0021A       11435  1          +
 0012EE 50F0 021C            0021C 11436  1          +
 0012F2 58F0 0210            00210 11437  1          +
 0012F6 89F0 0010            00010 11438  1          +
 0012FA 88F0 0010            00010 11439  1          +
 0012FE 41F0 F000            00000 11440  1          +
 001302 AEFF 0006            00006 11441  1          +
 001306 D3D6C3D2C4C5D340           11442             +
 001316 9293 6000      00000       11447    1108.              MVI   LOCKCB,C'l'             Change ID
                                   11448    1109.     *
                                   11449    1110.     *  Delete a spin lock
                                   11450    1111.     *
 00131A 9180 6030      00030       11451    1112.              IF    LCFSPIN,BEGIN           Delete a spin lock
 00131E 47E0 A0AA            01366 11461             +
 001322 9823 6018            00018 11466  1 1113.                LM    RA,RB,LOCKCTL           Get
                                   11467  1 1114.     *
                                   11468  1 1115.     *  This must be a free lock, and not waited on
 001326 1222/4770 A076       01332 11469  1 1116.                IF    ((RA,NZ),OR,(RB,NZ)),'BAS RS,BADSPIN'
 00132C 1233/4780 A07A       01336 11490  1          +
 001332 4D10 A16C            01428 11497  1          +
 001336 5840 A8D4            01B90 11502  1 1117.                L     RJ,=X'FFFFFFFF'         Set this lock going away
 00133A 1B55                       11503  1 1118.                CLEAR RK                      | none waiting
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   84
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LOCKCT,R7) (LKDEL,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000133C BB24 6018            00018 11507  1 1119.                CDS   RA,RJ,LOCKCTL
 001340 4780 A08C            01348 11508  1 1120.                IF    NZ,'BAS RS,BADSPIN'     Couldn't get it - error
 001344 4D10 A16C            01428 11520  1          +
 USING  @VMFREE-72,R13             11525  1 1121.                VMFREE L'LOCKCB,A=LA:LOCKCB,LOC=GLOBHI,FIX=YES
 001348 D709 D048 D048 00000 00000 11549  1          +
 00134E 4100 0031            00031 11561  1          +
 001352 5000 D04C            00004 11566  1          +
 001356 5060 D048            00000 11577  1          +
 00135A D201 D050 A918 00008 01BD4 11578  1          +
 001360 58F0 A8D8/0DEF       01B94 11581  1          +
 001366                            11583    1122.              END   ,                       OF Delete a spin lock
                                   11587    1123.     *
                                   11588    1124.     *  Delete a suspend lock
                                   11589    1125.     *
 001366 A0AE           01366 01320 11590    1126.              ELSE  BEGIN                   Delete a suspend lock
 001366 47F0 A132            013EE 11595             +
                                   11601  1 1127.     *
                                   11602  1 1128.     *  Put a zero as 'plum'
 00136A 1B55                       11603  1 1129.                CLEAR RK
 00136C 5840 6018            00018 11607  1 1130.                L     RJ,LOCKPLUM
 001370 BA45 6018            00018 11608  1 1131.                CS    RJ,RK,LOCKPLUM
 001374 4780 A0C0            0137C 11609  1 1132.                IF    NZ,'BAS RS,BADSUSP'     Still action on lock
 001378 4D10 A13C            013F8 11621  1          +
                                   11626  1 1133.     *
                                   11627  1 1134.     *  Check for ID
 USING  LQE,R4                     11628  1 1135.                WITH  (LQE,RJ),BEGIN          LQE addr
 00137C                            11642  2 1136.                  IF    (LQEID,NE,=CL4'LQE'),'BAS RS,BADSUSP'
 00137C D503 A8DC 4000 01B98 00000 11653  2          +
 001382 4780 A0CE            0138A 11654  2          +
 001386 4D10 A13C            013F8 11660  2          +
 00138A 5850 4008            00008 11665  2 1137.                  L     RK,LQEECB
 00138E 5450 A8E0            01B9C 11666  2 1138.                  N     RK,=X'40000000'
 001392 4770 A0DE            0139A 11667  2 1139.                  IF    ZERO,'BAS RS,BADSUSP'   Still action on lock
 001396 4D10 A13C            013F8 11679  2          +
                                   11684  2 1140.     *
                                   11685  2 1141.     *  Release system routine ID
                                   11686  2 1142.     *
 DROP   @VMFREE-72,R13             11687  2 1143.                  PSET  @SYSRDEL
 USING  @SYSRDEL-72,R13
 00139A D703 D048 D048 00000 00000 11707  2          +
 0013A0                            11708  2 1144.                  PMOV  @SYSRDID,LOCKSRID
 0013A0 D203 D048 6024 00000 00024 11712  2          +
 0013A6 58F0 A8E4/0DEF       01BA0 11713  2 1145.                  VCALL SYSRDEL
                                   11717  2 1146.     *
                                   11718  2 1147.     *  Put LQE on free list again
 0013AC 9823 7008            00008 11719  2 1148.                  LM    RA,RB,LOCKFLQE
 0013B0                            11720  2 1149.                  LOOP  BEGIN
 0013B0 5020 4018            00018 11726  3 1150.                    ST    RA,LQENEXT
 0013B4 4150 0001            00001 11727  3 1151.                    LA    RK,1
 0013B8 1E53                       11728  3 1152.                    ALR   RK,RB
 0013BA BB24 7008            00008 11729  3 1153.                    CDS   RA,RJ,LOCKFLQE
 0013BE 4770 A0F4            013B0 11730  2 1154.                  UNTIL EQUAL,END
 DROP   LQE,R4                     11749  1 1155.                END   ,                       OF LQE addr
                                   11757  1 1156.     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   85
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LOCKCT,R7) (LKDEL,R10) (@LOCKS-72,R12) (@SYSRDEL-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  11758  1 1157.     *  Deallocate LQEs (so we don't have to VMGET more of them)
                                   11759  1 1158.     *
 0013C2 4110 0002            00002 11760  1 1159.                LA    RS,2
 0013C6                            11761  1 1160.                LOOP  BEGIN
 0013C6 41F0 A79C/0DEF       01A58 11767  2 1161.                  LCALL LQEDALL
 0013CC 4610 A10A            013C6 11776  1 1162.                UNTIL (BCT,RS),END
                                   11786  1 1163.     *
                                   11787  1 1164.     *  Release lock memory
 DROP   @SYSRDEL-72,R13            11788  1 1165.                VMFREE L'LOCKCB,A=LA:LOCKCB,LOC=GLOBHI
 USING  @VMFREE-72,R13
 0013D0 D709 D048 D048 00000 00000 11815  1          +
 0013D6 4100 0031            00031 11827  1          +
 0013DA 5000 D04C            00004 11832  1          +
 0013DE 5060 D048            00000 11843  1          +
 0013E2 D201 D050 A91A 00008 01BD6 11844  1          +
 0013E8 58F0 A8D8/0DEF       01B94 11847  1          +
 0013EE                            11849    1166.              END   ,                       OF Delete a suspend lock
 0013EE 981F C008            00008 11853    1167.              PEND  ,
 DROP   LOCKCB,R6
 DROP   LOCKCT,R7
 DROP   @LOCKS-72,R12
 DROP   LKDEL,R10
 0013F2 9680 C000/0B0E 00000       11878             +
 DROP   @VMFREE-72,R13
00013F8 AC04 021B      0021B       11888    1169.     BADSUSP  ABORT LOCKDEL                 Bad suspend lock delete
 0013FC 9680 021A      0021A       11898             +
 001400 50F0 021C            0021C 11899             +
 001404 58F0 0210            00210 11900             +
 001408 89F0 0010            00010 11901             +
 00140C 88F0 0010            00010 11902             +
 001410 41F0 F000            00000 11903             +
 001414 AEFF 0006            00006 11904             +
 001418 D3D6C3D2C4C5D340           11905             +
0001428 AC04 021B      0021B       11907    1171.     BADSPIN  ABORT LOCKDEL                 Bad spin lock delete
 00142C 9680 021A      0021A       11917             +
 001430 50F0 021C            0021C 11918             +
 001434 58F0 0210            00210 11919             +
 001438 89F0 0010            00010 11920             +
 00143C 88F0 0010            00010 11921             +
 001440 41F0 F000            00000 11922             +
 001444 AEFF 0006            00006 11923             +
 001448 D3D6C3D2C4C5D340           11924             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   86
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  11926    1173.     *******************************************************************
                                   11927    1174.     *                                                                 *
                                   11928    1175.     *   LKOB  - Obtain a lock.                                        *
                                   11929    1176.     *                                                                 *
                                   11930    1177.     *     Input - @LOCKS                                              *
                                   11931    1178.     *                                                                 *
                                   11932    1179.     *    Output - None                                                *
                                   11933    1180.     *                                                                 *
                                   11934    1181.     *******************************************************************
0000000                00000 00001 11936    1183.     #SLOCK   RECORD BEGIN
 000000 00                         11944  1 1184.     #SLKPSWM   FLAG  ,                       Check for "disabled" PSW
 #SLKPSWM.PSWPER   40 ONES         11948  1 1185.                FLAG  (PSWPER,X'40')
 #SLKPSWM.PSWIO    02 ONES         11957  1 1186.                FLAG  (PSWIO,X'02')
 #SLKPSWM.PSWEX    01 ONES         11966  1 1187.                FLAG  (PSWEX,X'01')
 000001                00001 00001 11975    1188.              END   ,
-
 001458                            11985    1190.     LKOB     PROC  @LOCKS,#SLOCK,SCOPE=GLOBAL
 001458 D3D2D6C240404040           11991             +
 001460 0008/0008                  11992             +
 001464 900F D004/18AF       00004 11994             +
 USING  LKOB,R10
 00146A 50D0 C000/18CD       00000 12009             +
 001470 9680 C000      00000       12011             +
 USING  @LOCKS-72,R12
 AUSING (#SLOCK,@LOCKS+8)
 001474 41D0 C058            00058 12030             +
 001478 5860 C048            00000 12031    1191.              L     RX,@LOCKID              Get the lock id
 USING  LOCKCB,R6                  12032    1192.              WITH  (LOCKCB,RX)
 00147C                            12045    1193.              IF    (LOCKCB,NE,'LOCK'),LKOBKAP
 00147C D503 A720 6000 01B84 00000 12056             +
 001482 4770 A1EC            01650 12059             +
                                   12065    1194.     *--------------
                                   12066    1195.     *  Get a spin lock
                                   12067    1196.     *--------------
 001486 9180 6030      00030       12068    1197.              IF    LCFSPIN,BEGIN           Get a spin lock
 00148A 47E0 A0E0            01544 12078             +
 00148E 5880 0214            00214 12083  1 1198.                L     RM,PZCPUMSK             CPU mask
 001492 1898                       12084  1 1199.                LR    RN,RM                   Complement of CPU mask
 001494 5790 A72C            01B90 12085  1 1200.                X     RN,=X'FFFFFFFF'
 001498 9823 6018            00018 12086  1 1201.                LM    RA,RB,LOCKCTL
 00149C                            12087  1 1202.     NOTOWN     BEGIN ,
 00149C 1928/4780 A0C8       0152C 12092  2 1203.                  IF    (RA,EQ,RM),EXIT,NOTOWN  This CPU does own lock
 0014A2 1222/4780 A050       014B4 12110  2 1204.                  IF    (RA,NZ),'INCR RS,LOCKWCNT'       One more "wait"
 0014A8 4110 0001            00001 12128  3          +
 0014AC 5E10 6028            00028 12129  3          +
 0014B0 5010 6028            00028 12130  2          +
                                   12135  2 1205.     *
                                   12136  2 1206.     *  Check that caller is disabled
                                   12137  2 1207.     *
 0014B4 AD00 C050      00000       12138  2 1208.                  STOSM #SLKPSWM,0              Check for disabled
 0014B8 9143 C050      00000       12139  2 1209.                  IF    PSWPER+PSWIO+PSWEX,SLKKAP
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   87
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LKOB,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00014BC 4770 A21C            01680 12158  2          +
 0014C0 5870 0200            00200 12164  2 1210.                  L     RY,MATPTR               Get addr to lock CT
 0014C4 5870 7014            00014 12165  2 1211.                  WITH  (MAT,RY),'L RY,MATLCT'  |
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  12189  2 1212.                  WITH  (LOCKCT,RY)             |
                                   12202  2 1213.     *
                                   12203  2 1214.     *  Try for lock 1st time
                                   12204  2 1215.     *
 0014C8                            12205  2 1216.     TRY1ST       BEGIN ,                       Try for lock 1st time
 0014C8                            12210  3 1217.                    LOOP  BEGIN
 0014C8 5800 7018            00018 12216  4 1218.                      L     RVR,LOCKSCNT
 0014CC 1222/4770 A086       014EA 12217  4 1219.                      IF    (RA,NZ),TRYSPIN
                                   12234  4 1220.     *
                                   12235  4 1221.     *  Try to take the lock - no CPUs have it now
                                   12236  4 1222.     *
 0014D2                            12237  4 1223.     TRYTAKE          LOOP  BEGIN
 0014D2 1848                       12244  5 1224.                        LR    RJ,RM                   Mask bit of this CPU
 0014D4 1853                       12245  5 1225.                        LR    RK,RB                   Same old waiting bits
 0014D6 1459                       12246  5 1226.                        NR    RK,RN
 0014D8 BB24 6018            00018 12247  5 1227.                        CDS   RA,RJ,LOCKCTL           Try taking lock
 0014DC 4780 A0C2            01526 12248  5 1228.                        IF    EQUAL,EXIT,TRY1ST       ** WE OWN LOCK NOW **
 0014E0 1222/4770 A086       014EA 12262  5 1229.                        IF    (RA,~ZERO),EXIT         If not available - exit
 0014E6 47F0 A06E            014D2 12279  4 1230.                      END   ,                       Always try again if available
                                   12284  4 1231.     *
                                   12285  4 1232.     *  Spin on unavailable lock
                                   12286  4 1233.     *
 0014EA 1200/4780 A09A       014FE 12287  4 1234.     TRYSPIN          IF    (RVR,NZ),BEGIN          More spinning
 0014F0                            12302  5 1235.                        LOOP  BEGIN                   Spin on unavailable
 0014F0 9823 6018            00018 12308  6 1236.                          LM    RA,RB,LOCKCTL
 0014F4 1222/4780 A06E       014D2 12309  6 1237.                          IF    (RA,ZERO),TRYTAKE
 0014FA 4600 A08C            014F0 12326  5 1238.                        UNTIL (BCT,RVR),END           OF Spin on unavailable
 0014FE                            12336  4 1239.                      END   ,                       OF More spinning
                                   12340  4 1240.     *
                                   12341  4 1241.     *  Indicate we want this lock as we 'spin'
                                   12342  4 1242.     *
 0014FE                            12343  4 1243.                      LOOP  BEGIN
 0014FE 1842                       12349  5 1244.                        LR    RJ,RA
 001500 1853                       12350  5 1245.                        LR    RK,RB                   Mask of 'spinning' CPUs
 001502 1658                       12351  5 1246.                        OR    RK,RM                   | put ourselves in 'spin'
 001504 BB24 6018            00018 12352  5 1247.                        CDS   RA,RJ,LOCKCTL           | say we want lock
 001508 4780 A0B2            01516 12353  5 1248.                        IF    EQUAL,EXIT              Marked as 'spinning'
 00150C 1222/4780 A06E       014D2 12367  5 1249.                        IF    (RA,ZERO),TRYTAKE
 001512 47F0 A09A            014FE 12384  4 1250.                      UNTIL FALSE,END
                                   12403  4 1251.     *
                                   12404  4 1252.     *  Now we can 'spin'
                                   12405  4 1253.     *
 001516 B100 6000            00000 12406  4 1254.                      LRA    RVR,LOCKCB
 00151A 83000008                   12407  4 1255.                      SYSCTL TYPE=SPIN
                                   12410  4 1256.     *
                                   12411  4 1257.     *  After 'spinning', try to get lock again.
                                   12412  4 1258.     *
 00151E 9823 6018            00018 12413  4 1259.                      LM    RA,RB,LOCKCTL           Try for lock again
 001522 47F0 A064            014C8 12414  3 1260.                    UNTIL FALSE,END               Keep trying
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   88
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LOCKCT,R7) (LKOB,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001526                            12433  2 1261.                  END   ,                       OF Try for lock 1st time
                                   12437  2 1262.     *
                                   12438  2 1263.     *  Get CPU lock
                                   12439  2 1264.     *
 001526 58F0 A740/0DEF       01BA4 12440  2 1265.                  VCALL CPLOCK                  Get CPU lock 1st time
 DROP   LOCKCT,R7                  12444  1 1266.                END   ,                       OF Not owned by this CPU
 00152C 4110 0001            00001 12453  1 1267.                INCR  RS,LOCKRCNT             One more lock request
 001530 5E10 602C            0002C 12457  1          +
 001534 5010 602C            0002C 12458  1          +
 001538 4110 0001            00001 12459  1 1268.                INCR  RS,LOCKCNT              One more lock-obtain
 00153C 5E10 6020            00020 12463  1          +
 001540 5010 6020            00020 12464  1          +
 001544                            12465    1269.              END   ,                       OF Get a spin lock
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   89
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LKOB,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  12470    1271.     *--------------
                                   12471    1272.     *  Get a suspend lock
                                   12472    1273.     *--------------
 001544 A0E4           01544 0148C 12473    1274.              ELSE  BEGIN
 001544 47F0 A1E2            01646 12478             +
 001548                            12484  1 1275.     LOCKASL    BEGIN ,                       ASLOCK portion of code
                                   12489  2 1276.     *    Get local dispatch lock to prevent any other level of control
                                   12490  2 1277.     *  in this address space from becoming active.
                                   12491  2 1278.     *  (PIs/SVCs may still become active - be warned!)
 001548 58F0 A744/0DEF       01BA8 12492  2 1279.                  VCALL ASLOCK
                                   12496  2 1280.     *    Does this task currently own the lock?  If this task owns
                                   12497  2 1281.     *  the lock already, by virtue of ASLOCK being held,
                                   12498  2 1282.     *  this will be the only level of control active in the lock update
                                   12499  2 1283.     *  portion of code.
                                   12500  2 1284.     *
 00154E 5810 601C            0001C 12501  2 1285.                  L     RS,LOCKOWNR
 USING  LQE,R1                     12502  2 1286.                  WITH  (LQE,RS),BEGIN
 001552 9140 6030      00030       12516  3 1287.                    IF    (LCFOWNED,AND,(RS,NZ),AND,(LQEPID,EQ,PZCURPID)),BEGIN
 001556 47E0 A116/1211       0157A 12528  3          +
 00155C 4780 A116            0157A 12539  3          +
 001560 D507 1010 0208 00010 00208 12553  3          +
 001566 4770 A116            0157A 12554  3          +
 00156A 4120 0001            00001 12559  4 1288.                      INCR  RA,LOCKCNT
 00156E 5E20 6020            00020 12563  4          +
 001572 5020 6020            00020 12564  4          +
                                   12565  4 1289.     *        VCALL ASULOCK                 --> task +
 001576 47F0 A1E2            01646 12566  4 1290.                      EXIT  LOCKASL
 00157A                            12569  3 1291.                    END   ,                       OF This task owns lock now
 DROP   LQE,R1                     12573  2 1292.                  END   ,                       OF LQE addr
                                   12581  2 1293.     *        VCALL ASULOCK                 --> task +
                                   12582  2 1294.     *
                                   12583  2 1295.     *  First get an element off the free queue
                                   12584  2 1296.     *
 00157A 5870 0200            00200 12585  2 1297.                  L     RY,MATPTR
 00157E 5870 7014            00014 12586  2 1298.                  WITH  (MAT,RY),'L RY,MATLCT'
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  12610  2 1299.                  WITH  (LOCKCT,RY)
 001582 9823 7008            00008 12623  2 1300.                  LM    RA,RB,LOCKFLQE          Get first free and control
 001586                            12624  2 1301.                  LOOP  BEGIN                   |
 001586 1222/4770 A158       015BC 12630  3 1302.                    IF    (RA,ZERO),'ABORT NOLQE' -->
 00158C AC04 021B      0021B       12648  4          +
 001590 9680 021A      0021A       12654  4          +
 001594 50F0 021C            0021C 12655  4          +
 001598 58F0 0210            00210 12656  4          +
 00159C 89F0 0010            00010 12657  4          +
 0015A0 88F0 0010            00010 12658  4          +
 0015A4 41F0 F000            00000 12659  4          +
 0015A8 AEFF 0006            00006 12660  4          +
 0015AC D5D6D3D8C5404040           12661  3          +
 0015BC 5840 2018            00018 12666  3 1303.                    WITH  (LQE,RA),'L RJ,LQENEXT' Next in the queue
 USING  LQE,R2
 DROP   LQE,R2
 0015C0 4150 0001            00001 12690  3 1304.                    LA    RK,1
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   90
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LOCKCT,R7) (LKOB,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00015C4 1E53                       12691  3 1305.                    ALR   RK,RB                   Update the control word
 0015C6 BB24 7008            00008 12692  3 1306.                    CDS   RA,RJ,LOCKFLQE          Do the actual removal
 0015CA 4770 A122            01586 12693  2 1307.                  UNTIL EQUAL,END               OF Get first free and control
                                   12712  2 1308.     *
                                   12713  2 1309.     *  Tell dispatcher not to swap us while we hold the lock
                                   12714  2 1310.     *
 USING  @DISPSWP-72,R13            12715  2 1311.                  PSET  @DISPSWP
 0015CE D703 D048 D048 00000 00000 12732  2          +
 0015D4                            12733  2 1312.                  PMOV  @DISPSAS,PZCURASB
 0015D4 D203 D048 0208 00000 00208 12737  2          +
 0015DA 58F0 A748/0DEF       01BAC 12738  2 1313.                  VCALL DISPSHLD
                                   12742  2 1314.     *
                                   12743  2 1315.     * Exchange the free one we just got with the 'plum'
                                   12744  2 1316.     *
 0015E0 5830 6018            00018 12745  2 1317.                  L     RB,LOCKPLUM             Get the current plum
 USING  LQE,R2                     12746  2 1318.                  WITH  (LQE,RA),BEGIN          -->
 0015E4 5060 2004            00004 12760  3 1319.                    ST    RX,LQELOCK              -->
 0015E8                            12761  3 1320.                    CLEAR LQENEXT                 -->
 0015E8 D703 2018 2018 00018 00018 12767  3          +
 DROP   LQE,R2                     12768  2 1321.                  END   ,                       -->
 0015EE                            12776  2 1322.                  LOOP  BEGIN
 0015EE BA32 6018            00018 12782  3 1323.                    CS    RB,RA,LOCKPLUM          And replace with our free
 0015F2 4770 A18A            015EE 12783  2 1324.                  UNTIL EQUAL,END
                                   12802  2 1325.     *
                                   12803  2 1326.     * Now we update our element
                                   12804  2 1327.     *
 USING  LQE,R3                     12805  2 1328.                  WITH  (LQE,RB)                Address it
 0015F6 5020 3018            00018 12818  2 1329.                  ST    RA,LQENEXT              Address of who we must signal
 0015FA 5060 3004            00004 12819  2 1330.                  ST    RX,LQELOCK              LQE is for this lock
 0015FE D207 3010 0208 00010 00208 12820  2 1331.                  MVC   LQEPID,PZCURPID         Mark it as belonging to us
                                   12821  2 1332.     *
                                   12822  2 1333.     * Wait for the lock
                                   12823  2 1334.     *
 001604 5880 0208            00208 12824  2 1335.                  L     RM,PZCURASB             -->
 USING  ASB,R8                     12825  2 1336.                  WITH  (ASB,RM),BEGIN          --> ASB addr
                                   12839  3 1337.     *        PMOV  ASBLW,LA:LOCKCB         --> Waiting
 001608 9140 3008      00008       12840  3 1338.                    IF    ~LQEECB.X'40','INCR RS,LOCKWCNT'
 00160C 4710 A1B8            0161C 12851  3          +
 001610 4110 0001            00001 12860  4          +
 001614 5E10 6028            00028 12861  4          +
 001618 5010 6028            00028 12862  3          +
 DROP   @DISPSWP-72,R13            12867  3 1339.                    AWAIT LQEECB,TYPE=AS          Wait for it --> task -
 USING  @AWAIT-72,R13
 00161C D704 D048 D048 00000 00000 12888  3          +
 001622 4100 3008            00008 12900  3          +
 001626 5000 D048            00000 12905  3          +
 00162A 58F0 A74C/0DEF       01BB0 12908  3          +
                                   12910  3 1340.     *        AWAIT LQEECB                  Wait for it --> task +
                                   12911  3 1341.     *        PMOV  ASBLH,LA:LOCKCB         --> Hold this one
                                   12912  3 1342.     *        CLEAR ASBLW                   --> Not waiting
 DROP   ASB,R8                     12913  2 1343.                  END   ,                       --> OF ASB addr
                                   12921  2 1344.     *
                                   12922  2 1345.     * When we get the lock, mark the LOCKCB then return to the user
                                   12923  2 1346.     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   91
0Current Usings:  (PZERO,R0) (LQE,R3) (LOCKCB,R6) (LOCKCT,R7) (LKOB,R10) (@LOCKS-72,R12) (@AWAIT-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001630 D203 6020 A750 00020 01BB4 12924  2 1347.                  MVC   LOCKCNT,=A(1)           Mark us as first owner
 001636 9640 6030      00030       12925  2 1348.                  SET   LCFOWNED                |
 00163A 4110 0001            00001 12931  2 1349.                  INCR  RS,LOCKRCNT             Count the request
 00163E 5E10 602C            0002C 12935  2          +
 001642 5010 602C            0002C 12936  2          +
 DROP   LQE,R3                     12937  1 1350.                END   ,                       OF ASLOCK portion of code
 DROP   LOCKCT,R7
 001646                            12951    1351.              END   ,                       OF Suspend style locks
 001646 981F C008            00008 12955    1352.              PEND                          Return to caller, lock held
 DROP   LOCKCB,R6
 DROP   @LOCKS-72,R12
 DROP   LKOB,R10
 00164A 9680 C000/0B0E 00000       12975             +
 DROP   @AWAIT-72,R13
0001650 AC04 021B      0021B       12985    1354.     LKOBKAP  ABORT LOCKCB
 001654 9680 021A      0021A       12995             +
 001658 50F0 021C            0021C 12996             +
 00165C 58F0 0210            00210 12997             +
 001660 89F0 0010            00010 12998             +
 001664 88F0 0010            00010 12999             +
 001668 41F0 F000            00000 13000             +
 00166C AEFF 0006            00006 13001             +
 001670 D3D6C3D2C3C24040           13002             +
0001680 AC04 021B      0021B       13004    1356.     SLKKAP   ABORT LOCKDIS                 Not disabled for spin locks
 001684 9680 021A      0021A       13014             +
 001688 50F0 021C            0021C 13015             +
 00168C 58F0 0210            00210 13016             +
 001690 89F0 0010            00010 13017             +
 001694 88F0 0010            00010 13018             +
 001698 41F0 F000            00000 13019             +
 00169C AEFF 0006            00006 13020             +
 0016A0 D3D6C3D2C4C9E240           13021             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   92
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  13023    1358.     *******************************************************************
                                   13024    1359.     *                                                                 *
                                   13025    1360.     *   LKREL - Release a lock.                                       *
                                   13026    1361.     *                                                                 *
                                   13027    1362.     *     Input - @LOCKS                                              *
                                   13028    1363.     *                                                                 *
                                   13029    1364.     *    Output - SUSPEND locks: none                                 *
                                   13030    1365.     *           - SPIN    locks: RVR = the number of lock obtains     *
                                   13031    1366.     *                            still outstanding for this lock.     *
                                   13032    1367.     *                                                                 *
                                   13033    1368.     *******************************************************************
-
 0016B0                            13035    1370.     LKREL    PROC  @LOCKS,SCOPE=GLOBAL
 0016B0 D3D2D9C5D3404040           13041             +
 0016B8 0008/0000                  13042             +
 0016BC 900F D004/18AF       00004 13044             +
 USING  LKREL,R10
 0016C2 50D0 C000/18CD       00000 13059             +
 0016C8 9680 C000      00000       13061             +
 USING  @LOCKS-72,R12
 0016CC 41D0 C050            00050 13075             +
                                   13076    1371.     *
                                   13077    1372.     * Get and validity check the parm and calling circumstances
                                   13078    1373.     *
 0016D0 5860 C048            00000 13079    1374.              L     RX,@LOCKID              GET THE LOCK IDENTITY
 USING  LOCKCB,R6                  13080    1375.              WITH  (LOCKCB,RX)
                                   13093    1376.     *--------------
                                   13094    1377.     *  Free a spin style lock
                                   13095    1378.     *--------------
 0016D4 9180 6030      00030       13096    1379.              IF    LCFSPIN,BEGIN           Free spin style lock
 0016D8 47E0 A07C            01738 13106             +
 0016DC                            13111  1 1380.                IF    ('CLC PZCPUMSK,LOCKCTL',NE),LKRKAP2
 0016DC D503 0214 6018 00214 00018 13118  1          +
 0016E2 4770 A1BE            0187A 13121  1          +
 0016E6 5800 6020/0600       00020 13127  1 1381.                DECR  RVR,LOCKCNT             Do we keep lock?
 0016EC 5000 6020            00020 13131  1          +
                                   13132  1 1382.     *
                                   13133  1 1383.     *  Lock needs to be freed - any waiting let in
                                   13134  1 1384.     *
 0016F0 1200/4770 A07C       01738 13135  1 1385.                IF    (RVR,ZERO),BEGIN        Free lock
 0016F6 9823 6018            00018 13149  2 1386.                  LM    RA,RB,LOCKCTL
 0016FA                            13150  2 1387.                  LOOP  BEGIN                   Try to free lock
 0016FA 1B44                       13156  3 1388.                    CLEAR RJ                      Free lock code
 0016FC 1B11                       13160  3 1389.                    CLEAR RS                      Init CPU address counter
 0016FE 1253                       13164  3 1390.                    LTR   RK,RB
                                   13165  3 1391.     *
                                   13166  3 1392.     *  If any CPU is 'spinning', find out who and notify
                                   13167  3 1393.     *
 001700 4780 A062            0171E 13168  3 1394.                    IF    ~ZERO,BEGIN             There is a 'spinning' CPU
 001704 1255/4740 A05A       01716 13179  4 1395.                      WHILE (RK,~NEG),BEGIN         Find 'spinning' CPU
 00170A 5E10 A4F8            01BB4 13195  5 1396.                        INCR  RS
 00170E 8950 0001            00001 13198  5 1397.                        SLL   RK,1
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   93
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LKREL,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001712 47F0 A048            01704 13199  4 1398.                      END   ,                       OF Find 'spinning' CPU
 001716 5450 A4FC            01BB8 13204  4 1399.                      N     RK,=X'7FFFFFFF'
 00171A 8850 1000            00000 13205  4 1400.                      SRL   RK,@RS
 00171E                            13206  3 1401.                    END   ,                       OF There is a 'spinning' CPU
                                   13210  3 1402.     *
                                   13211  3 1403.     *  Do free of lock
                                   13212  3 1404.     *
 00171E BB24 6018            00018 13213  3 1405.                    CDS   RA,RJ,LOCKCTL
 001722 4770 A03E            016FA 13214  2 1406.                  UNTIL EQUAL,END               OF Try to free lock
                                   13233  2 1407.     *
                                   13234  2 1408.     *  A CPU was 'spinning', so we notify it
                                   13235  2 1409.     *
 001726 1233/4780 A074       01730 13236  2 1410.                  IF    (RB,NZ),BEGIN           Notify 'spinning'
 00172C 83100009                   13250  3 1411.                    SYSCTL RS,TYPE=NOSPIN         RS = CPU addr
 001730                            13253  2 1412.                  END   ,                       OF Notify 'spinning'
                                   13257  2 1413.     *
                                   13258  2 1414.     *  Free CPU lock
                                   13259  2 1415.     *
 001730 58F0 A500/0DEF       01BBC 13260  2 1416.                  VCALL CPULOCK                 Free CPU lock
 001736 1B00                       13264  2 1417.                  CLEAR RVR
 001738                            13268  1 1418.                END   ,                       OF Free lock
 001738                            13272    1419.              END   ,                       OF Free spin style lock
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   94
0Current Usings:  (PZERO,R0) (LOCKCB,R6) (LKREL,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  13277    1421.     *--------------
                                   13278    1422.     *  Free a suspend style lock
                                   13279    1423.     *--------------
 001738 A080           01738 016DA 13280    1424.              ELSE  BEGIN
 001738 47F0 A184            01840 13285             +
                                   13291  1 1425.     *  Get LQE ID of owner
 00173C 5820 601C/1222       0001C 13292  1 1426.                IF    ('LT RA,LOCKOWNR',ZERO),LKRKAP
 001742 4780 A18E            0184A 13305  1          +
 001746                            13311  1 1427.                IF    (@RA,NE,'LQE '),LKRKAP
 001746 D503 A504 2000 01BC0 00000 13321  1          +
 00174C 4770 A18E            0184A 13324  1          +
 USING  LQE,R2                     13330  1 1428.                WITH  (LQE,RA)
 001750                            13343  1 1429.                IF    (PZCURPID,NE,LQEPID),LKRKAP2
 001750 D507 0208 2010 00208 00010 13355  1          +
 001756 4770 A1BE            0187A 13358  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   95
0Current Usings:  (PZERO,R0) (LQE,R2) (LOCKCB,R6) (LKREL,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000175A                            13365  1 1431.     LKRASL     BEGIN ,                       ASLOCK portion of code
                                   13370  2 1432.     *        VCALL ASLOCK                  --> task +
 00175A 5810 6020/0610       00020 13371  2 1433.                  DECR  RS,LOCKCNT              One less lock count
 001760 5010 6020            00020 13375  2          +
 001764 1211/4780 A0B2       0176E 13376  2 1434.                  IF    (RS,NZ),BEGIN           | still held by task
                                   13390  3 1435.     *        VCALL ASULOCK                 --> task +
 00176A 47F0 A17E            0183A 13391  3 1436.                    EXIT  LKRASL
 00176E                            13394  2 1437.                  END   ,
                                   13398  2 1438.     *
                                   13399  2 1439.     * Clean up info
                                   13400  2 1440.     *
 00176E 9140 2008      00008       13401  2 1441.                  IF    LQEECB.X'40','ABORT LQEPOSTFREE'
 001772 47E0 A0EA            017A6 13412  2          +
 001776 AC04 021B      0021B       13421  3          +
 00177A 9680 021A      0021A       13427  3          +
 00177E 50F0 021C            0021C 13428  3          +
 001782 58F0 0210            00210 13429  3          +
 001786 89F0 0010            00010 13430  3          +
 00178A 88F0 0010            00010 13431  3          +
 00178E 41F0 F000            00000 13432  3          +
 001792 AEFF 0006            00006 13433  3          +
 001796 D3D8C5D7D6E2E3C6           13434  2          +
 0017A6 5810 2018            00018 13439  2 1442.                  L     RS,LQENEXT              Get the fellow we must signal
 0017AA 5010 601C            0001C 13440  2 1443.                  ST    RS,LOCKOWNR             Disconnect this LQE and lock
 0017AE 94BF 6030      00030       13441  2 1444.                  CLEAR LCFOWNED                |
                                   13448  2 1445.     *        VCALL ASULOCK                 --> task +
                                   13449  2 1446.     *
 0017B2                            13450  2 1447.                  CLEAR LQELOCK                 | LQE ptr to LOCKCB
 0017B2 D703 2004 2004 00004 00004 13456  2          +
 0017B8                            13457  2 1448.                  CLEAR LQEPID                  | LQE free now
 0017B8 D707 2010 2010 00010 00010 13463  2          +
                                   13464  2 1449.     *
                                   13465  2 1450.     * Free our element
                                   13466  2 1451.     *
 0017BE 5870 0200            00200 13467  2 1452.                  L     RY,MATPTR
 0017C2 5870 7014            00014 13468  2 1453.                  WITH  (MAT,RY),'L RY,MATLCT'
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  13492  2 1454.                  WITH  (LOCKCT,RY)
 0017C6 9845 7008            00008 13505  2 1455.                  LM    RJ,RK,LOCKFLQE          First on the free chain
 0017CA                            13506  2 1456.                  LOOP  BEGIN                   Free our element
 0017CA 5040 2018            00018 13512  3 1457.                    ST    RJ,LQENEXT              Update pointer
 0017CE 4130 0001            00001 13513  3 1458.                    LA    RB,1
 0017D2 1E35                       13514  3 1459.                    ALR   RB,RK                   Update the control field
 0017D4 BB42 7008            00008 13515  3 1460.                    CDS   RJ,RA,LOCKFLQE          Free the LQE
 0017D8 4770 A10E            017CA 13516  2 1461.                  UNTIL EQUAL,END               OF Free our element
                                   13535  2 1462.     *
                                   13536  2 1463.     * Signal the next fellow - RS contains his LQE addr
                                   13537  2 1464.     *
 DROP   LQE,R2                     13538  2 1465.                  WITH  (LQE,RS),BEGIN          LQE of one to signal
 USING  LQE,R1
 0017DC 5960 1004            00004 13560  3 1466.                    IF    (LQELOCK,NE,RX),'ABORT BADLKPOST'        -->
 0017E0 4780 A158            01814 13572  3          +
 0017E4 AC04 021B      0021B       13581  4          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   96
0Current Usings:  (PZERO,R0) (LQE,R1) (LOCKCB,R6) (LOCKCT,R7) (LKREL,R10) (@LOCKS-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00017E8 9680 021A      0021A       13587  4          +
 0017EC 50F0 021C            0021C 13588  4          +
 0017F0 58F0 0210            00210 13589  4          +
 0017F4 89F0 0010            00010 13590  4          +
 0017F8 88F0 0010            00010 13591  4          +
 0017FC 41F0 F000            00000 13592  4          +
 001800 AEFF 0006            00006 13593  4          +
 001804 C2C1C4D3D2D7D6E2           13594  3          +
 USING  @SIGNAL-72,R13             13599  3 1467.                    SIGNL LQEECB,TYPE=AS                           --> task -
 001814 D713 D048 D048 00000 00000 13617  3          +
 00181A 4100 1008            00008 13629  3          +
 00181E 5000 D050            00008 13634  3          +
 001822 58F0 A508/0DEF       01BC4 13637  3          +
                                   13639  3 1468.     *        SIGNL LQEECB,,LQEASB,LOCKSRID,TYPE=TASK        --> task +
 USING  LQE,R2                     13640  2 1469.                  END   ,                       OF LQE of one to signal
 DROP   LQE,R1
                                   13657  2 1470.     *
                                   13658  2 1471.     *  Tell dispatcher we can be swapped now that we have freed the lock
                                   13659  2 1472.     *
 DROP   @SIGNAL-72,R13             13660  2 1473.                  PSET  @DISPSWP
 USING  @DISPSWP-72,R13
 001828 D703 D048 D048 00000 00000 13680  2          +
 00182E                            13681  2 1474.                  PMOV  @DISPSAS,PZCURASB
 00182E D203 D048 0208 00000 00208 13685  2          +
 001834 58F0 A50C/0DEF       01BC8 13686  2 1475.                  VCALL DISPSREL
 DROP   LOCKCT,R7                  13690  1 1476.                END   ,                       OF ASLOCK portion of code
                                   13699  1 1477.     *
                                   13700  1 1478.     *  Free local dispatch lock
                                   13701  1 1479.     *
 00183A 58F0 A510/0DEF       01BCC 13702  1 1480.                VCALL ASULOCK                 --> task -
 DROP   LQE,R2                     13706    1481.              END   ,                       OF Free a suspend style lock
 001840 981F C008            00008 13715    1482.              PEND  ,                       Return to caller
 DROP   LOCKCB,R6
 DROP   @LOCKS-72,R12
 DROP   LKREL,R10
 001844 9680 C000/0B0E 00000       13735             +
 DROP   @DISPSWP-72,R13
000184A AC04 021B      0021B       13745    1484.     LKRKAP   ABORT BADLQID                 Bad LQE ID
 00184E 9680 021A      0021A       13755             +
 001852 50F0 021C            0021C 13756             +
 001856 58F0 0210            00210 13757             +
 00185A 89F0 0010            00010 13758             +
 00185E 88F0 0010            00010 13759             +
 001862 41F0 F000            00000 13760             +
 001866 AEFF 0006            00006 13761             +
 00186A C2C1C4D3D8C9C440           13762             +
 00187A AC04 021B      0021B       13763    1485.     LKRKAP2  ABORT BADOWNR                 Bad lock owner
 00187E 9680 021A      0021A       13773             +
 001882 50F0 021C            0021C 13774             +
 001886 58F0 0210            00210 13775             +
 00188A 89F0 0010            00010 13776             +
 00188E 88F0 0010            00010 13777             +
 001892 41F0 F000            00000 13778             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S System Buffer Services                                                         Page   97
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001896 AEFF 0006            00006 13779             +
 00189A C2C1C4D6E6D5D940           13780             +
                                   13781    1486.     *    Output - RVR = the number of lock obtains still outstanding  *
                                   13782    1487.     *                   for this lock.                                *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   98
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  13784    1489.     *******************************************************************
                                   13785    1490.     *                                                                 *
                                   13786    1491.     *   LOCKINIT - Initialize the Lock Manager                        *
                                   13787    1492.     *                                                                 *
                                   13788    1493.     *     Input - Init parm pointer                                   *
                                   13789    1494.     *                                                                 *
                                   13790    1495.     *    Output - none                                                *
                                   13791    1496.     *                                                                 *
                                   13792    1497.     *******************************************************************
 000000                00000 00020 13793    1498.     LKIPARM  RECORD BEGIN
 000000                            13801  1 1499.     LKIPWA     DS    XL(L'PARMIN)
 000004                            13802  1 1500.                DS    3CL8                    Room for 3 keys
 00001C                            13803  1 1501.     LKIECNT    DS    A                       LQE count
 000020                00020 00020 13804    1502.              END   ,
-
 0018AA                            13814    1504.     LKINIT   PROC  SCOPE=GLOBAL
 0018AA D3D2C9D5C9E34040           13820             +
 0018B2 0000/0000                  13821             +
 0018B6 900F D004/18AF       00004 13823             +
 USING  LKINIT,R10
 0018BC 50D0 C000/18CD       00000 13838             +
 0018C2 9680 C000      00000       13840             +
 0018C6 41D0 C048            00048 13841             +
                                   13842    1505.     *
                                   13843    1506.     * First thing we do is allocate the Lockct
                                   13844    1507.     *
 USING  @VMGET-72,R13              13845    1508.              VMGET L'LOCKCT,LOC=GLOBHI,FIX=YES   Get the storage
 0018CA D70A D048 D048 00000 00000 13869             +
 0018D0 4100 001D            0001D 13881             +
 0018D4 5000 D048            00000 13886             +
 0018D8 D201 D050 A31E 00008 01BD4 13887             +
 0018DE 58F0 A2CA/0DEF       01B80 13890             +
 0018E4 1270/4770 A064       0191A 13892    1509.              IF    ('LTR  RY,RVR',Z),'ABORT LOCKCB'
 0018EA AC04 021B      0021B       13909  1          +
 0018EE 9680 021A      0021A       13915  1          +
 0018F2 50F0 021C            0021C 13916  1          +
 0018F6 58F0 0210            00210 13917  1          +
 0018FA 89F0 0010            00010 13918  1          +
 0018FE 88F0 0010            00010 13919  1          +
 001902 41F0 F000            00000 13920  1          +
 001906 AEFF 0006            00006 13921  1          +
 00190A D3D6C3D2C3C24040           13922             +
 USING  LOCKCT,R7                  13927    1510.              WITH  (LOCKCT,RY)
 00191A                            13940    1511.              CLEAR LOCKCT
 00191A D71C 7000 7000 00000 00000 13946             +
 001920 D203 7000 A31A 00000 01BD0 13947    1512.              MVC   LOCKCT(4),=CL4'LKCT'    Control block id
 001926 9680 701C      0001C       13948    1513.              SET   LKFINIT                 Note initialization
                                   13954    1514.     *
                                   13955    1515.     *  Set Lock CT anchor
                                   13956    1516.     *
 00192A 5820 0200            00200 13957    1517.              L     RA,PZMATP               MAT POINTER
 00192E 5070 2014            00014 13958    1518.              WITH  (MAT,RA),'ST  RY,MATLCT'  Save our roots
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page   99
0Current Usings:  (PZERO,R0) (LOCKCT,R7) (LKINIT,R10) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0USING  MAT,R2
 DROP   MAT,R2
                                   13982    1519.     *
                                   13983    1520.     *  Get our initialization parameters
                                   13984    1521.     *
 001932                            13985    1522.              VMGET L'LKIPARM,LOC=GLOBHI,FIX=YES
 001932 D70A D048 D048 00000 00000 14002             +
 001938 4100 0020            00020 14014             +
 00193C 5000 D048            00000 14019             +
 001940 D201 D050 A31E 00008 01BD4 14020             +
 001946 58F0 A2CA/0DEF       01B80 14023             +
 00194C 1880                       14025    1523.              LR    RM,RVR
 USING  LKIPARM,R8                 14026    1524.              WITH  (LKIPARM,RM),BEGIN
 AUSING (PARMIN,LKIPWA)            14040  1 1525.                WITH  (PARMIN,LKIPWA)
 00194E 9204 8000      00000       14047  1 1526.                GETPARM2 KEY=(RESOURCE,SPINCNT),REGS=(RVR,RAR)
 001952 D207 8004 A2B2 00004 01B68 14054  1          +
 001958 D207 800C A2BA 0000C 01B70 14055  1          +
 00195E 41E0 8000            00000 14062  1          +
 001962 41F0 0014            00014 14069  1          +
 001966 830E0016                   14072  1          +
 00196A 4130 0032            00032 14073  1 1527.                LA    RB,CLKSCNT              Default
 00196E 4770 A0BE/1830       01974 14074  1 1528.                IF    ZERO,'LR RB,RVR'        Supplied parameter
 001974 5030 7018            00018 14091  1 1529.                ST    RB,LOCKSCNT             Save it
                                   14092  1 1530.     *
                                   14093  1 1531.     *  Get some LQEs
                                   14094  1 1532.     *
 001978 9204 8000      00000       14095  1 1533.                GETPARM2 KEY=(,LQECNT),REGS=(RVR,RAR)
 00197C D207 800C A2C2 0000C 01B78 14102  1          +
 001982 41E0 8000            00000 14109  1          +
 001986 41F0 0014            00014 14116  1          +
 00198A 830E0016                   14119  1          +
 00198E 4160 0028            00028 14120  1 1534.                LA    RX,LOCKECNT             Default
 001992 4770 A0E2/1860       01998 14121  1 1535.                IF    ZERO,'LR RX,RVR'        Supplied parameter
                                   14138  1 1536.     *
 DROP   @VMGET-72,R13              14139  1 1537.                PSET  @LQEGET
 USING  @LQEGET-72,R13
 001998 D703 D048 D048 00000 00000 14159  1          +
 00199E 5060 D048            00000 14160  1 1538.                PMOV  @LQENUM,(RX)
 0019A2 41F0 A1E6/0DEF       01A9C 14170  1 1539.                LCALL LQEGET
                                   14179  1 1540.     *
                                   14180  1 1541.     *  Update free count
                                   14181  1 1542.     *
 0019A8 5820 7004            00004 14182  1 1543.                L     RA,LOCKFCNT             This many free ones
 0019AC                            14183  1 1544.                LOOP  BEGIN
 0019AC 1832                       14189  2 1545.                  LR    RB,RA
 0019AE 1E36                       14190  2 1546.                  ALR   RB,RX                   This many more
 0019B0 BA23 7004            00004 14191  2 1547.                  CS    RA,RB,LOCKFCNT
 0019B4 4770 A0F6            019AC 14192  1 1548.                UNTIL EQUAL,END
                                   14211  1 1549.     *
                                   14212  1 1550.     *  Free parameter work area
                                   14213  1 1551.     *
 DROP   @LQEGET-72,R13             14214  1 1552.                VMFREE L'LKIPARM,A=LA:LKIPARM,LOC=GLOBHI,FIX=YES
 USING  @VMFREE-72,R13
 0019B8 D709 D048 D048 00000 00000 14241  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page  100
0Current Usings:  (PZERO,R0) (LOCKCT,R7) (LKIPARM,R8) (LKINIT,R10) (@VMFREE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00019BE 4100 0020            00020 14253  1          +
 0019C2 5000 D04C            00004 14258  1          +
 0019C6 5080 D048            00000 14269  1          +
 0019CA D201 D050 A31E 00008 01BD4 14270  1          +
 0019D0 58F0 A2DE/0DEF       01B94 14273  1          +
 DROP   LKIPARM,R8                 14275    1553.              END   ,                       OF Addr to LKIPARM
 0019D6 981F C008            00008 14283    1554.              PEND  ,
 DROP   LOCKCT,R7
 DROP   LKINIT,R10
 0019DA 9680 C000/0B0E 00000       14298             +
 DROP   @VMFREE-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) LQE allocation/deallocation                                                            Page  101
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  14308    1556.     *********************************************************************
                                   14309    1557.     *  Allocate and add new LQEs to free queue                          *
                                   14310    1558.     *                                                                   *
                                   14311    1559.     *   Input - None                                                    *
                                   14312    1560.     *                                                                   *
                                   14313    1561.     *  Output - None                                                    *
                                   14314    1562.     *                                                                   *
                                   14315    1563.     *********************************************************************
 0019E0                            14316    1564.     LQEALL   PROC  SCOPE=GLOBAL
 0019E0 D3D8C5C1D3D34040           14322             +
 0019E8 0000/0000                  14323             +
 0019EC 900F D004/18AF       00004 14325             +
 USING  LQEALL,R10
 0019F2 50D0 C000/18CD       00000 14340             +
 0019F8 9680 C000      00000       14342             +
 0019FC 41D0 C048            00048 14343             +
 001A00 5870 0200            00200 14344    1565.              L     RY,MATPTR
 001A04 5870 7014            00014 14345    1566.              WITH  (MAT,RY),'L RY,MATLCT'
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  14369    1567.              WITH  (LOCKCT,RY)
                                   14382    1568.     *
                                   14383    1569.     *  One less free LQE
                                   14384    1570.     *
 001A08 5820 7004            00004 14385    1571.              L     RA,LOCKFCNT
 001A0C                            14386    1572.              LOOP  BEGIN
 001A0C 1832                       14392  1 1573.                LR    RB,RA
 001A0E 0630                       14393  1 1574.                DECR  RB
 001A10 BA23 7004            00004 14395  1 1575.                CS    RA,RB,LOCKFCNT
 001A14 4770 A020            01A0C 14396    1576.              UNTIL EQUAL,END
                                   14415    1577.
 001A18 1233/4720 A056       01A42 14416    1578.              IF    (RB,~POS),BEGIN         Need more cells
 001A1E 4160 0001            00001 14430  1 1579.                LA    RX,1                    Number to get
 USING  @LQEGET-72,R13             14431  1 1580.                PSET  @LQEGET
 001A22 D703 D048 D048 00000 00000 14448  1          +
 001A28 5060 D048            00000 14449  1 1581.                PMOV  @LQENUM,(RX)
 001A2C 41F0 A0B0/0DEF       01A9C 14459  1 1582.                LCALL LQEGET
                                   14468  1 1583.     *
                                   14469  1 1584.     *  Update free count
                                   14470  1 1585.     *
 001A32 5820 7004            00004 14471  1 1586.                L     RA,LOCKFCNT             This many free ones
 001A36                            14472  1 1587.                LOOP  BEGIN
 001A36 1832                       14478  2 1588.                  LR    RB,RA
 001A38 1E36                       14479  2 1589.                  ALR   RB,RX                   This many more
 001A3A BA23 7004            00004 14480  2 1590.                  CS    RA,RB,LOCKFCNT
 001A3E 4770 A04A            01A36 14481  1 1591.                UNTIL EQUAL,END
 001A42                            14500    1592.              END   ,                       OF Need more cells
 001A42 981F C008            00008 14504    1593.              PEND  ,
 DROP   LOCKCT,R7
 DROP   LQEALL,R10
 001A46 9680 C000/0B0E 00000       14519             +
 DROP   @LQEGET-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) LQE allocation/deallocation                                                            Page  102
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  14529    1595.     *********************************************************************
                                   14530    1596.     *  Deallocate a cell - make it available                            *
                                   14531    1597.     *                                                                   *
                                   14532    1598.     *   Input - None                                                    *
                                   14533    1599.     *                                                                   *
                                   14534    1600.     *  Output - None                                                    *
                                   14535    1601.     *                                                                   *
                                   14536    1602.     *********************************************************************
 001A4C                            14537    1603.     LQEDALL  PROC  SCOPE=GLOBAL
 001A4C D3D8C5C4C1D3D340           14543             +
 001A54 0000/0000                  14544             +
 001A58 900F D004/18AF       00004 14546             +
 USING  LQEDALL,R10
 001A5E 50D0 C000/18CD       00000 14561             +
 001A64 9680 C000      00000       14563             +
 001A68 41D0 C048            00048 14564             +
 001A6C 5870 0200            00200 14565    1604.              L     RY,MATPTR
 001A70 5870 7014            00014 14566    1605.              WITH  (MAT,RY),'L RY,MATLCT'
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  14590    1606.              WITH  (LOCKCT,RY)
                                   14603    1607.     *
                                   14604    1608.     *  One more available LQE - update free count
                                   14605    1609.     *
 001A74 5820 7004            00004 14606    1610.              L     RA,LOCKFCNT             This many free ones
 001A78                            14607    1611.              LOOP  BEGIN
 001A78 1832                       14613  1 1612.                LR    RB,RA
 001A7A 5E30 A15C            01BB4 14614  1 1613.                INCR  RB                      This many more
 001A7E BA23 7004            00004 14617  1 1614.                CS    RA,RB,LOCKFCNT
 001A82 4770 A020            01A78 14618    1615.              UNTIL EQUAL,END
 001A86 981F C008            00008 14637    1616.              PEND  ,
 DROP   LOCKCT,R7
 DROP   LQEDALL,R10
 001A8A 9680 C000/0B0E 00000       14652             +
1RESMAN   (RESM00) (09:43) (22MAR04) Allocate LQEs                                                                          Page  103
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0
 000000                00000 00004 14660    1619.     @LQEGET  RECORD BEGIN
 000000                            14668  1 1620.     @LQENUM    DS    A                       Number of LQEs to get
 000004                00004 00004 14669    1621.              END   ,
0000000                00000 00020 14679    1623.     #LQEGET  RECORD BEGIN
 000000                            14687  1 1624.                DS    XL(L'LQE)
 000020                00020 00020 14688    1625.              END   ,
0001A90                            14698    1627.     LQEGET   PROC  @LQEGET,#LQEGET
 001A90 D3D8C5C7C5E34040           14705             +
 001A98 0008/0020                  14706             +
 001A9C 900F D004/18AF       00004 14708             +
 USING  LQEGET,R10
 001AA2 50D0 C000/18CD       00000 14723             +
 001AA8 9680 C000      00000       14725             +
 USING  @LQEGET-72,R12
 AUSING (#LQEGET,@LQEGET+8)
 001AAC 41D0 C070            00070 14744             +
 001AB0 5870 0200            00200 14745    1628.              L     RY,MATPTR
 001AB4 5870 7014            00014 14746    1629.              WITH  (MAT,RY),'L RY,MATLCT'
 USING  MAT,R7
 DROP   MAT,R7
 USING  LOCKCT,R7                  14770    1630.              WITH  (LOCKCT,RY)
                                   14783    1631.     *
                                   14784    1632.     *    Now allocate some lock elements for suspend locks.
                                   14785    1633.     *
 001AB8 5850 C048            00000 14786    1634.              L     RK,@LQENUM              Number of LQEs to get
 001ABC 1865                       14787    1635.              LR    RX,RK                   | save for updating later
 001ABE 4110 C050            00000 14788    1636.              LA    RS,#LQEGET
 001AC2                            14789    1637.              LOOP  BEGIN                   Get a few LQEs
 USING  LQE,R1                     14795  1 1638.                WITH  (LQE,RS)
 USING  @VMGET-72,R13              14808  1 1639.                VMGET L'LQE,LOC=GLOBHI,FIX=YES ,SP=01   Long term allocate
 001AC2 D70A D048 D048 00000 00000 14832  1          +
 001AC8 4100 0020            00020 14844  1          +
 001ACC 5000 D048            00000 14849  1          +
 001AD0 D201 D050 A138 00008 01BD4 14850  1          +
 001AD6 58F0 A0E4/0DEF       01B80 14853  1          +
 001ADC 1200/4770 A076       01B12 14855  1 1640.                IF    (RVR,Z),'ABORT LQE'
 001AE2 AC04 021B      0021B       14873  2          +
 001AE6 9680 021A      0021A       14879  2          +
 001AEA 50F0 021C            0021C 14880  2          +
 001AEE 58F0 0210            00210 14881  2          +
 001AF2 89F0 0010            00010 14882  2          +
 001AF6 88F0 0010            00010 14883  2          +
 001AFA 41F0 F000            00000 14884  2          +
 001AFE AEFF 0006            00006 14885  2          +
 001B02 D3D8C54040404040           14886  1          +
 001B12 5000 101C            0001C 14891  1 1641.                ST    RVR,LQECHAIN            Link up all LQEs
 001B16 5000 1018            00018 14892  1 1642.                ST    RVR,LQENEXT             | all free to start
 001B1A 1810                       14893  1 1643.                LR    RS,RVR                  Address the new one
 001B1C                            14894  1 1644.                CLEAR LQE
 001B1C D71F 1000 1000 00000 00000 14900  1          +
 001B22 D203 1000 A0FC 00000 01B98 14901  1 1645.                MVC   LQE(4),=CL4'LQE'        Move in the ID
1RESMAN   (RESM00) (09:43) (22MAR04) Allocate LQEs                                                                          Page  104
0Current Usings:  (PZERO,R0) (LOCKCT,R7) (LQEGET,R10) (@LQEGET-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001B28 4650 A026            01AC2 14902    1646.              UNTIL (BCT,RK),END            Continue till we get em all
 DROP   LQE,R1
                                   14917    1647.
 AUSING (LQE,#LQEGET)              14918    1648.              WITH  (LQE,#LQEGET),BEGIN
 001B2C 5840 C068            00018 14928  1 1649.                L     RJ,LQENEXT              RJ=first of new/RS=last of new
                                   14929    1650.              END   ,
                                   14932    1651.     *
                                   14933    1652.     *  Put elements on chain of all LQEs
                                   14934    1653.     *
 001B30 9823 7010            00010 14935    1654.              LM    RA,RB,LOCKECHN          Old list of all LQEs
 001B34                            14936    1655.              LOOP  BEGIN
 001B34 5020 101C            0001C 14942  1 1656.                WITH  (LQE,RS),'ST RA,LQECHAIN'
 USING  LQE,R1
 DROP   LQE,R1
 001B38 4150 0001            00001 14966  1 1657.                LA    RK,1
 001B3C 1E53                       14967  1 1658.                ALR   RK,RB
 001B3E BB24 7010            00010 14968  1 1659.                CDS   RA,RJ,LOCKECHN
 001B42 4770 A098            01B34 14969    1660.              UNTIL EQUAL,END
                                   14988    1661.     *
                                   14989    1662.     *  Put elements on chain of free LQEs
                                   14990    1663.     *
 001B46 9823 7008            00008 14991    1664.              LM    RA,RB,LOCKFLQE          Old list of free LQEs
 001B4A                            14992    1665.              LOOP  BEGIN
 001B4A 5020 1018            00018 14998  1 1666.                WITH  (LQE,RS),'ST RA,LQENEXT'
 USING  LQE,R1
 DROP   LQE,R1
 001B4E 4150 0001            00001 15022  1 1667.                LA    RK,1
 001B52 1E53                       15023  1 1668.                ALR   RK,RB
 001B54 BB24 7008            00008 15024  1 1669.                CDS   RA,RJ,LOCKFLQE
 001B58 4770 A0AE            01B4A 15025    1670.              UNTIL EQUAL,END
 001B5C 981F C008            00008 15044    1671.              PEND  ,
 DROP   LOCKCT,R7
 DROP   @LQEGET-72,R12
 DROP   LQEGET,R10
 001B60 9680 C000/0B0E 00000       15064             +
 DROP   @VMGET-72,R13
                                   15073    1672.              AGO   .NOLIST
                                   15074    1806.     .NOLIST  ANOP  ,
1RESMAN   (RESM00) (09:43) (22MAR04) Allocate LQEs                                                                          Page  105
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001B68                            15076    1808.              LTORG
 001B68 D9C5E2D6E4D9C3C5           15078                             =CL8'RESOURCE'
 001B70 E2D7C9D5C3D5E340           15079                             =CL8'SPINCNT'
 001B78 D3D8C5C3D5E34040           15080                             =CL8'LQECNT'
 001B80 00000000                   15081                             =V(VMGET)
 001B84 D3D6C3D2                   15082                             =C'LOCK'
 001B88 00000000                   15083                             =V(SYSRNEW)
 001B8C 00000000                   15084                             =V(SIGNAL)
 001B90 FFFFFFFF                   15085                             =X'FFFFFFFF'
 001B94 00000000                   15086                             =V(VMFREE)
 001B98 D3D8C540                   15087                             =CL4'LQE'
 001B9C 40000000                   15088                             =X'40000000'
 001BA0 00000000                   15089                             =V(SYSRDEL)
 001BA4 00000000                   15090                             =V(CPLOCK)
 001BA8 00000000                   15091                             =V(ASLOCK)
 001BAC 00000000                   15092                             =V(DISPSHLD)
 001BB0 00000000                   15093                             =V(AWAITAS)
 001BB4 00000001                   15094                             =A(1)
 001BB8 7FFFFFFF                   15095                             =X'7FFFFFFF'
 001BBC 00000000                   15096                             =V(CPULOCK)
 001BC0 D3D8C540                   15097                             =C'LQE '
 001BC4 00000000                   15098                             =V(SIGNALAS)
 001BC8 00000000                   15099                             =V(DISPSREL)
 001BCC 00000000                   15100                             =V(ASULOCK)
 001BD0 D3D2C3E3                   15101                             =CL4'LKCT'
 001BD4 3F00                       15102                             =Y(63*256+0)
 001BD6 3B00           01BD8 03638 15103                             =Y(59*256+0)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  106
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15108    1810.              COPY  ENQPARM
                                   15109             =*******************************************************************
                                   15110             =*                                                                 *
                                   15111             =*    @ENQUEUE - Enqueue service parameters                        *
                                   15112             =*                                                                 *
                                   15113             =*******************************************************************
0000000                00000 00039 15115             =@ENQUEUE RECORD BEGIN
 000000                            15123  1          =@ENQID     DS    A                       Enqueue id (Test only)
 000004                            15124  1          =@ENQQNM    DS    CL8                     Queue Name
 00000C                            15125  1          =@ENQRNM    DS    CL44                    Resource name
                                   15126  1          =*@ENQNUM  DS    A                       Enqueue number
                                   15127  1          =*@ENQFNT  DS    A                       Resource No. table ptr
 000038 00                         15128  1          =@ENQFL     FLAG
 @ENQFL.@ENQSHR    80 ONES         15132  1          =           FLAG  @ENQSHR                 Enqueue resource shared
 @ENQFL.@ENQSUSP   40 ONES         15137  1          =           FLAG  @ENQSUSP                Wait for resource
 @ENQFL.@ENQTEST   20 ONES         15142  1          =           FLAG  @ENQTEST                Resource inquiry
                                   15147  1          =*         FLAG  @ENQAEN                 Assign enqueue number
 000039                00039 00039 15148             =         END   ,
-
                                   15158             =*******************************************************************
                                   15159             =*                                                                 *
                                   15160             =*   @DEQUEUE - Dequeue service parameters                         *
                                   15161             =*                                                                 *
                                   15162             =*******************************************************************
0000000                00000 00039 15164             =@DEQUEUE RECORD BEGIN
 000000                            15172  1          =@DEQID     DS    A                       Enqueue id
 000004                            15173  1          =@DEQQNM    DS    CL8                     Queue Name
 00000C                            15174  1          =@DEQRNM    DS    CL44                    Resource name
 000038 00                         15175  1          =@DEQFL     FLAG
 @DEQFL.@DEQCAN    80 ONES         15179  1          =           FLAG  @DEQCAN                 Cancel enqueue
 000039                00039 00039 15184             =         END   ,
-
                                   15194             =*******************************************************************
                                   15195             =*                                                                 *
                                   15196             =*   @REQUEUE - Requeue service parameters                         *
                                   15197             =*                                                                 *
                                   15198             =*******************************************************************
0000000                00000 00039 15200             =@REQUEUE RECORD BEGIN
 000000                            15208  1          =@REQID     DS    A                       Enqueue id
 000004                            15209  1          =@REQQNM    DS    CL8                     Queue Name
 00000C                            15210  1          =@REQRNM    DS    CL44                    Resource name
 000038 00                         15211  1          =@REQFL     FLAG
 @REQFL.@REQSHR    80 ONES         15215  1          =           FLAG  @REQSHR                 Requeue resource shared
 @REQFL.@REQSUSP   40 ONES         15220  1          =           FLAG  @REQSUSP                Wait for resource
 000039                00039 00039 15225             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  107
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15235             =*******************************************************************
                                   15236             =*                                                                 *
                                   15237             =*   @ENQHALT - Halt Enqueue service parameters                    *
                                   15238             =*                                                                 *
                                   15239             =*******************************************************************
0000000                00000 00034 15241             =@ENQHALT RECORD BEGIN
 000000                            15249  1          =@EQHQNM    DS    CL8                     Queue Name
 000008                            15250  1          =@EQHRNM    DS    CL44                    Resource name
 000034                00034 00034 15251             =         END   ,
-
                                   15261    1812.              COPY  HASHPARM
                                   15262             =*******************************************************************
                                   15263             =*                                                                 *
                                   15264             =*   HASHPARM - Hash routine parameters                            *
                                   15265             =*                                                                 *
                                   15266             =*******************************************************************
0000000                00000 0000D 15268             =@HASH    RECORD BEGIN
 000000                            15276  1          =@HSHSTR    DS    A                       String pointer
 000004                            15277  1          =@HSHLEN    DS    A                       Length of string
 000008                            15278  1          =@HSHVAL    DS    A                       Hash value (a prime number)
 00000C 00                         15279  1          =@HSHFL     FLAG  ,
 @HSHFL.@HSHBLNK   80 ONES         15283  1          =           FLAG  @HSHBLNK                Ignore trailing blanks
 00000D                0000D 0000D 15288             =         END   ,
-
                                   15298    1814.     *******************************************************************
                                   15299    1815.     *                                                                 *
                                   15300    1816.     *    ENQDWORK - Enqueue dump work area                            *
                                   15301    1817.     *                                                                 *
                                   15302    1818.     *******************************************************************
0000000                00000 00004 15304    1820.     ENQDWORK RECORD BEGIN
 000000                            15312  1 1821.     EQDUMPCB   DS    A                       DUMP CB
 000004                00004 00004 15313    1822.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  108
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15323    1824.              COPY  QCB                 Enqueue control blocks
                                   15324             =*******************************************************************
                                   15325             =*                                                                 *
                                   15326             =*    QCT - Enqueue Control Table                                  *
                                   15327             =*                                                                 *
                                   15328             =*******************************************************************
0000000                00000 00020 15330             =QCT      RECORD BEGIN
 000000                            15338  1          =           DS    CL4'QCT'                Id
 000004                            15339  1          =QCTLOCK    DS    A                       Queue lock
 000008                            15340  1          =QCTQCBS    DS    A                       QCB chain
 000010                            15341  1          =QCTQRBS    DS    D                       QRB Free pool
 000018                            15342  1          =QCTQOES    DS    D                       QOE Free pool
 000020                00020 00020 15343             =         END   ,
-
                                   15353             =*******************************************************************
                                   15354             =*                                                                 *
                                   15355             =*    QCB - Enqueue Queue Control Block                            *
                                   15356             =*                                                                 *
                                   15357             =*******************************************************************
0000000                00000 006AC 15359             =QCB      RECORD BEGIN
 000000                            15367  1          =QCBID      DS    CL4'QCB'
 000004                            15368  1          =QCBNAME    DS    CL8                     Queue name
 00000C                            15369  1          =QCBLOCK    DS    A                       Queue lock
 000010                            15370  1          =QCBNEXT    DS    A                       QCB chain
                                   15371  1          =
                                   15372  1          =QCBNQRB    EQU   211                     Num QRB chains (prime number)
 000014                            15373  1          =QCBQRBS    DS    (QCBNQRB)A(0,0)         QRB chains
 0006AC                006AC 006AC 15374             =         END   ,
-
                                   15384             =*******************************************************************
                                   15385             =*                                                                 *
                                   15386             =*    QRB - Enqueue Resource Control Block                         *
                                   15387             =*                                                                 *
                                   15388             =*******************************************************************
0000000                00000 0004C 15390             =QRB      RECORD BEGIN
 000000                            15398  1          =QRBFP      DS    A                       Forward chain
 000004                            15399  1          =QRBBP      DS    A                       Backward chain
 000008                            15400  1          =QRBID      DS    CL4'QRB'                Id
 00000C                            15401  1          =QRBQCB     DS    A                       Back pointer to QCB
 000010                            15402  1          =QRBWFP     DS    A                       Forward wait chain
 000014                            15403  1          =QRBWBP     DS    A                       Backward wait chain
 000018                            15404  1          =QRBNAME    DS    CL44                    Resource name
 000044                            15405  1          =QRBOWNF    DS    A                       Forward owner chain
 000048                            15406  1          =QRBOWNB    DS    A                       Backward owner chain
 00004C                0004C 0004C 15407             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  109
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15417             =*******************************************************************
                                   15418             =*                                                                 *
                                   15419             =*    QOE - Enqueue Ownership Element                              *
                                   15420             =*                                                                 *
                                   15421             =*******************************************************************
0000000                00000 00025 15423             =QOE      RECORD BEGIN
 000000                            15431  1          =QOEFP      DS    A                       Forward chain
 000004                            15432  1          =QOEBP      DS    A                       Backward chain
 000008                            15433  1          =QOEID      DS    CL4'QOE'                Id
 00000C                            15434  1          =QOEQRB     DS    A                       QRB pointer
 000010                            15435  1          =QOEPID     DS    D                       Process id
                                   15436  1          =QOEASB     EQU   QOEPID,4,C'A'           Address space id
 000018                            15437  1          =QOEECB     DS    D                       ECB
 000020                            15438  1          =QOESYR     DS    A                       System routine id
                                   15439  1          =
 000024 00                         15440  1          =QOEFL      FLAG  ,
 QOEFL.QOESHR      80 ONES         15444  1          =           FLAG  QOESHR                  Wants it shared
 QOEFL.QOEWAIT     40 ONES         15449  1          =           FLAG  QOEWAIT                 Element is on wait queue
 QOEFL.QOERMARK    20 ONES         15454  1          =           FLAG  QOERMARK                This Owner has it reserved
 000025                00025 00025 15459             =         END   ,
-
                                   15469             =*******************************************************************
                                   15470             =*                                                                 *
                                   15471             =*    QAS - Enqueue Address Space Control                          *
                                   15472             =*                                                                 *
                                   15473             =*******************************************************************
0000000                00000 00010 15475             =QAS      RECORD BEGIN
 000000                            15483  1          =QASID      DS    CL4'QAS'                Id
 000004                            15484  1          =QASCHN     DS    A                       Active QAO Chain
 000008                            15485  1          =QASFQAO    DS    D                       Free QAO chain
 000010                00010 00010 15486             =         END   ,
-
                                   15496             =*******************************************************************
                                   15497             =*                                                                 *
                                   15498             =*    QAO - Enqueue Address Space Ownership Block                  *
                                   15499             =*                                                                 *
                                   15500             =*******************************************************************
0000000                00000 00041 15502             =QAO      RECORD BEGIN
 000000                            15510  1          =QAOID      DS    CL4'QAO'                Id
 000004                            15511  1          =QAOCHN     DS    A                       Chain
 000008                            15512  1          =QAOQOE     DS    A                       QOE pointer
 00000C                            15513  1          =QAOQNAME   DS    CL8                     Queue name
 000014                            15514  1          =QAORNAME   DS    CL44                    Resource name
                                   15515  1          =
 000040 00                         15516  1          =QAOFL      FLAG  ,
 QAOFL.QAOSHR      80 ONES         15520  1          =           FLAG  QAOSHR                  Owns it shared
 000041                00041 00041 15525             =         END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  110
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15535    1826.     *******************************************************************
                                   15536    1827.     *                                                                 *
                                   15537    1828.     *    @ENQWAIT - Enqueue suspend routine parameters                *
                                   15538    1829.     *                                                                 *
                                   15539    1830.     *******************************************************************
0000000                00000 00005 15541    1832.     @ENQWAIT RECORD BEGIN
 000000                            15549  1 1833.     @EQWQOE    DS    A                       Pointer to QOE
 000004 00                         15550  1 1834.     @EQWFLG    FLAG  ,
 @EQWFLG.@EQWFHD   80 ONES         15554  1 1835.                FLAG  @EQWFHD                 Request to head of queue
 000005                00005 00005 15559    1836.              END   ,
-
                                   15569    1838.     *******************************************************************
                                   15570    1839.     *                                                                 *
                                   15571    1840.     *    @ENQPOST - Enqueue post routine parameters                   *
                                   15572    1841.     *                                                                 *
                                   15573    1842.     *******************************************************************
0000000                00000 00009 15575    1844.     @ENQPOST RECORD BEGIN
 000000                            15583  1 1845.     @EQPQRB    DS    A                       Pointer to QRB
 000004                            15584  1 1846.     @EQPCODE   DS    A                       Post code
 000008 00                         15585  1 1847.     @EQPFLG    FLAG  ,
 @EQPFLG.@EQPFSHR  80 ONES         15589  1 1848.                FLAG  @EQPFSHR                Post share waiters
 @EQPFLG.@EQPFALL  40 ONES         15594  1 1849.                FLAG  @EQPFALL                Post all waiters
 000009                00009 00009 15599    1850.              END   ,
-
                                   15609    1852.     *******************************************************************
                                   15610    1853.     *                                                                 *
                                   15611    1854.     *    @ENQASCN - Address space table search parameters             *
                                   15612    1855.     *                                                                 *
                                   15613    1856.     *******************************************************************
0000000                00000 0000D 15615    1858.     @ENQASCN RECORD BEGIN
 000000                            15623  1 1859.     @EQSQNM    DS    A                       Pointer to Queue Name
 000004                            15624  1 1860.     @EQSRNM    DS    A                       Pointer to Resource name
 000008                            15625  1 1861.     @EQSID     DS    A                       Enqueue Id
 00000C 00                         15626  1 1862.     @EQSFLG    FLAG  ,
 @EQSFLG.@EQSFADD  80 ONES         15630  1 1863.                FLAG  @EQSFADD                Add QAO if not there
 @EQSFLG.@EQSFDEL  40 ONES         15635  1 1864.                FLAG  @EQSFDEL                Delete QAO if found
 @EQSFLG.@EQSFSHR  20 ONES         15640  1 1865.                FLAG  @EQSFSHR                Mark QAO shared
 00000D                0000D 0000D 15645    1866.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  111
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15655    1868.     *******************************************************************
                                   15656    1869.     *                                                                 *
                                   15657    1870.     *    @FINDQCB - Enqueue QCB scan parameters                       *
                                   15658    1871.     *                                                                 *
                                   15659    1872.     *******************************************************************
0000000                00000 00008 15661    1874.     @FINDQCB RECORD BEGIN
 000000                            15669  1 1875.     @ENQCQNM   DS    CL8                     Queue name
 000008                00008 00008 15670    1876.              END   ,
-
                                   15680    1878.     *******************************************************************
                                   15681    1879.     *                                                                 *
                                   15682    1880.     *    @FREEQRB - Add QRB to free list parameters                   *
                                   15683    1881.     *                                                                 *
                                   15684    1882.     *******************************************************************
0000000                00000 00004 15686    1884.     @FREEQRB RECORD BEGIN
 000000                            15694  1 1885.     @FRQRBP    DS    A                       Queue name
 000004                00004 00004 15695    1886.              END   ,
-
                                   15705    1888.     *******************************************************************
                                   15706    1889.     *                                                                 *
                                   15707    1890.     *    @FREEQOE - Add QOE to free list parameters                   *
                                   15708    1891.     *                                                                 *
                                   15709    1892.     *******************************************************************
0000000                00000 00004 15711    1894.     @FREEQOE RECORD BEGIN
 000000                            15719  1 1895.     @FRQOEP    DS    A                       Queue name
 000004                00004 00004 15720    1896.              END   ,
-
                                   15730    1898.     *******************************************************************
                                   15731    1899.     *                                                                 *
                                   15732    1900.     *    @FREEQAO - Add QAO to free list parameters                   *
                                   15733    1901.     *                                                                 *
                                   15734    1902.     *******************************************************************
0000000                00000 00004 15736    1904.     @FREEQAO RECORD BEGIN
 000000                            15744  1 1905.     @FRQAOP    DS    A                       Queue name
 000004                00004 00004 15745    1906.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  112
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15755    1908.     *******************************************************************
                                   15756    1909.     *                                                                 *
                                   15757    1910.     *   ENQINIT - Initialize the Enqueue - Dequeue Service            *
                                   15758    1911.     *                                                                 *
                                   15759    1912.     *     Input -                                                     *
                                   15760    1913.     *                                                                 *
                                   15761    1914.     *    Output - none                                                *
                                   15762    1915.     *                                                                 *
                                   15763    1916.     *******************************************************************
-
 001BD8                            15765    1918.     ENQINIT  PROC  SCOPE=GLOBAL
 001BD8 C5D5D8C9D5C9E340           15771             +
 001BE0 0000/0000                  15772             +
 001BE4 900F D004/18AF       00004 15774             +
 USING  ENQINIT,R10
 001BEA 50D0 C000/18CD       00000 15789             +
 001BF0 9680 C000      00000       15791             +
 001BF4 41D0 C048            00048 15792             +
                                   15793    1919.     *
                                   15794    1920.     *  Create the QCT
                                   15795    1921.     *
 USING  @VMGET-72,R13              15796    1922.              VMGET L'QCT,LOC=GLOBHI        Get the storage
 001BF8 D70A D048 D048 00000 00000 15820             +
 001BFE 4100 0020            00020 15832             +
 001C02 5000 D048            00000 15837             +
 001C06 D201 D050 A9E0 00008 025C4 15838             +
 001C0C 58F0 A99C/0DEF       02580 15841             +
 001C12 1270/4770 A064       01C48 15843    1923.              IF    ('LTR  RY,RVR',Z),'ABORT QCT'
 001C18 AC04 021B      0021B       15860  1          +
 001C1C 9680 021A      0021A       15866  1          +
 001C20 50F0 021C            0021C 15867  1          +
 001C24 58F0 0210            00210 15868  1          +
 001C28 89F0 0010            00010 15869  1          +
 001C2C 88F0 0010            00010 15870  1          +
 001C30 41F0 F000            00000 15871  1          +
 001C34 AEFF 0006            00006 15872  1          +
 001C38 D8C3E34040404040           15873             +
 USING  QCT,R7                     15878    1924.              WITH  (QCT,RY)
 001C48                            15891    1925.              CLEAR QCT
 001C48 D71F 7000 7000 00000 00000 15897             +
 001C4E D203 7000 A9A0 00000 02584 15898    1926.              MVC   QCT(4),=CL4'QCT'        Control block id
 DROP   @VMGET-72,R13              15899    1927.              LKCRE ENQUEUE
 USING  @LOCKCRE-72,R13
 001C54 D710 D048 D048 00000 00000 15920             +
 001C5A D20F D048 A98C 00000 02570 15926             +
 001C60 58F0 A9A4/0DEF       02588 15929             +
 001C66 5000 7004            00004 15931    1928.              ST    RVR,QCTLOCK             Set lock id
                                   15932    1929.     *
                                   15933    1930.     *  Set anchor
                                   15934    1931.     *
 001C6A 5820 0200            00200 15935    1932.              L     RA,PZMATP               MAT POINTER
 001C6E 5070 2018            00018 15936    1933.              WITH  (MAT,RA),'ST  RY,MATQCT'  Save our roots
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  113
0Current Usings:  (PZERO,R0) (QCT,R7) (ENQINIT,R10) (@LOCKCRE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0USING  MAT,R2
 DROP   MAT,R2
 001C72 981F C008            00008 15960    1934.              PEND
 DROP   QCT,R7
 DROP   ENQINIT,R10
 001C76 9680 C000/0B0E 00000       15975             +
 DROP   @LOCKCRE-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  114
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  15985    1936.     *******************************************************************
                                   15986    1937.     *                                                                 *
                                   15987    1938.     *   ENQUEUE - Enqueue a resource                                  *
                                   15988    1939.     *                                                                 *
                                   15989    1940.     *     Input - @ENQUEUE                                            *
                                   15990    1941.     *                                                                 *
                                   15991    1942.     *    Output - RVR contains enqueue id                             *
                                   15992    1943.     *                                                                 *
                                   15993    1944.     *******************************************************************
-
 001C7C                            15995    1946.     ENQUEUE  PROC  @ENQUEUE,SCOPE=GLOBAL
 001C7C C5D5D8E4C5E4C540           16001             +
 001C84 0040/0000                  16002             +
 001C88 900F D004/18AF       00004 16004             +
 USING  ENQUEUE,R10
 001C8E 50D0 C000/18CD       00000 16019             +
 001C94 9680 C000      00000       16021             +
 USING  @ENQUEUE-72,R12
 001C98 41D0 C088            00088 16035             +
 001C9C 58F0 A904/0DEF       0258C 16036    1947.              VCALL ASLOCK                  Get address space lock
                                   16040    1948.     *
                                   16041    1949.     *  First search address space table
                                   16042    1950.     *
 USING  @ENQASCN-72,R13            16043    1951.              PSET  @ENQASCN
 001CA2 D70C D048 D048 00000 00000 16060             +
 001CA8 5810 C048            00000 16061    1952.              L     RS,@ENQID               ENQUEUE ID
 001CAC 9120 C080      00038       16062    1953.              IF    (@ENQTEST,AND,(RS,NZ)),'ST  RS,@EQSID'   TEST ONLY
 001CB0 47E0 A036/1211       01CBE 16074             +
 001CB6 4780 A036            01CBE 16085             +
 001CBA 5010 D050            00008 16091             +
 001CBE A03A           01CBE 01CB2 16096    1954.              ELSE  BEGIN
 001CB8 A03A           01CBA 01CBE 16101             +
 001CBE 47F0 A04A            01CD2 16103             +
 001CC2 4110 C04C            00004 16109  1 1955.                LA    RS,@ENQQNM              QNAME POINTER
 001CC6 5010 D048            00000 16110  1 1956.                ST    RS,@EQSQNM               TO PARAMETER LIST
 001CCA 4110 C054            0000C 16111  1 1957.                LA    RS,@ENQRNM              RESOURCE NAME POINTER
 001CCE 5010 D04C            00004 16112  1 1958.                ST    RS,@EQSRNM               TO PARAMETER LIST
 001CD2                            16113    1959.              END   ,
 001CD2 9120 C080      00038       16117    1960.              IF    ~@ENQTEST,'SET  @EQSFADD'    ADD TYPE REQUEST
 001CD6 4710 A056            01CDE 16127             +
 001CDA 9680 D054      0000C       16138             +
 001CDE 9180 C080      00038       16143    1961.              IF    @ENQSHR,'SET  @EQSFSHR'    SHARE TYPE REQUEST
 001CE2 47E0 A062            01CEA 16153             +
 001CE6 9620 D054      0000C       16164             +
 001CEA 41F0 A9AC/0DEF       02634 16169    1962.              LCALL ENQASCN                 CALL SCAN ROUTINE
 USING  QAO,R5                     16178    1963.              WITH  (QAO,RK)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  115
0Current Usings:  (PZERO,R0) (QAO,R5) (ENQUEUE,R10) (@ENQUEUE-72,R12) (@ENQASCN-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  16192    1965.     *
                                   16193    1966.     *  Process test mode requests
                                   16194    1967.     *
 001CF0 9120 C080      00038       16195    1968.              IF    @ENQTEST,BEGIN
 001CF4 47E0 A096            01D1E 16205             +
 001CF8 1250/4780 A08A       01D12 16210  1 1969.                IF    ('LTR RK,RVR',NZ),BEGIN
 001CFE 9180 5040      00040       16223  2 1970.                  IF    QAOSHR,'SET  @ENQSHR'   NOTE SHARED
 001D02 47E0 A082            01D0A 16233  2          +
 001D06 9680 C080      00038       16244  2          +
 001D0A A086           01D0A 01D04 16249  2 1971.                  ELSE  'CLEAR @ENQSHR'          OR EXCLUSIVE
 001D0A 47F0 A08A            01D12 16254  2          +
 001D0E 947F C080      00038       16267  2          +
 001D12                            16272  1 1972.                END   ,
 001D12 58F0 A908/0DEF       02590 16276  1 1973.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 001D18 1805                       16280  1 1974.                LR    RVR,RK
 001D1A 47F0 A26A            01EF2 16281  1 1975.                EXIT  ENQUEUE
 001D1E                            16284    1976.              END   ,
                                   16288    1977.     *
                                   16289    1978.     *  QAO found (already enqueued)
                                   16290    1979.     *
 001D1E 1250/47B0 A0BC       01D44 16291    1980.              IF    ('LTR RK,RVR',M),BEGIN
 001D24 9180 5040      00040       16304  1 1981.                IF    QAOSHR,'SET  @ENQSHR'   NOTE SHARED
 001D28 47E0 A0A8            01D30 16314  1          +
 001D2C 9680 C080      00038       16325  1          +
 001D30 A0AC           01D30 01D2A 16330  1 1982.                ELSE  'CLEAR @ENQSHR'          OR EXCLUSIVE
 001D30 47F0 A0B0            01D38 16335  1          +
 001D34 947F C080      00038       16348  1          +
 001D38 58F0 A908/0DEF       02590 16353  1 1983.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 001D3E 1805                       16357  1 1984.                LR    RVR,RK
 001D40 47F0 A26A            01EF2 16358  1 1985.                EXIT  ENQUEUE
 001D44                            16361    1986.              END   ,
                                   16365    1987.     *
                                   16366    1988.     *  BUILD OWNERSHIP ELEMENT
                                   16367    1989.     *
 001D44 58F0 A90C/0DEF       02594 16368    1990.              ACALL GETQOE                  GET AN ELEMENT
 001D4A 1840                       16375    1991.              LR    RJ,RVR
 USING  QOE,R4                     16376    1992.              WITH  (QOE,RJ)
 001D4C 9180 C080      00038       16389    1993.              IF    @ENQSHR,'SET  QOESHR'   WANTS IT SHARED
 001D50 47E0 A0D0            01D58 16399             +
 001D54 9680 4024      00024       16410             +
 001D58 5040 5008            00008 16415    1994.              ST    RJ,QAOQOE               SET POINTER IN QAO
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  116
0Current Usings:  (PZERO,R0) (QOE,R4) (QAO,R5) (ENQUEUE,R10) (@ENQUEUE-72,R12) (@ENQASCN-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  16417    1996.     *
                                   16418    1997.     *  Find the Queue Control Block and get QCB lock
                                   16419    1998.     *
 DROP   @ENQASCN-72,R13            16420    1999.              PSET  @FINDQCB
 USING  @FINDQCB-72,R13
 001D5C D707 D048 D048 00000 00000 16440             +
 001D62 D207 D048 C04C 00000 00004 16441    2000.              MVC   @ENQCQNM,@ENQQNM        Queue name
 001D68 58F0 A910/0DEF       02598 16442    2001.              ACALL FINDQCB
 001D6E 1860                       16449    2002.              LR    RX,RVR                  QCB POINTER
 USING  QCB,R6                     16450    2003.              WITH  (QCB,RX)
 DROP   @FINDQCB-72,R13            16463    2004.              LKOB  QCBLOCK
 USING  @LOCKS-72,R13
 001D70 D203 D048 600C 00000 0000C 16482             +
 001D76 58F0 A914/0DEF       0259C 16485             +
                                   16487    2005.     *
                                   16488    2006.     *  Hash resource name to determine chain
                                   16489    2007.     *
 DROP   @LOCKS-72,R13              16490    2008.              PSET  @HASH
 USING  @HASH-72,R13
 001D7C D70C D048 D048 00000 00000 16510             +
 001D82 4110 C054            0000C 16511    2009.              LA    RS,@ENQRNM              RESOURCE NAME
 001D86 5010 D048            00000 16512    2010.              ST    RS,@HSHSTR              SET STRING POINTER
 001D8A 4110 002C            0002C 16513    2011.              LA    RS,L'@ENQRNM            NAME LENGTH
 001D8E 5010 D04C            00004 16514    2012.              ST    RS,@HSHLEN               SET
 001D92 4110 00D3            000D3 16515    2013.              LA    RS,QCBNQRB              HASH VALUE
 001D96 5010 D050            00008 16516    2014.              ST    RS,@HSHVAL
 001D9A 9680 D054      0000C       16517    2015.              SET   @HSHBLNK                STRIP TRAILING BLANKS
 001D9E 58F0 A918/0DEF       025A0 16523    2016.              VCALL HASHIT                  MUNCH A BUNCH
                                   16527    2017.     *
                                   16528    2018.     *  Search resource chain QRBs
                                   16529    2019.     *
 001DA4 8900 0003            00003 16530    2020.              SLL   RVR,3                   INDEX INTO QRB CHAINS
 001DA8 4170 6014            00014 16531    2021.              LA    RY,QCBQRBS              QRB chain
 001DAC 1E70                       16532    2022.              ALR   RY,RVR                  PROPER ONE
 001DAE 1827                       16533    2023.              LR    RA,RY                   Chain ANCHOR
 USING  QRB,R7                     16534    2024.              WITH  (QRB,RY)
 001DB0                            16547    2025.              LOOP  BEGIN
 001DB0 5870 7000            00000 16553  1 2026.                L     RY,QRBFP                GET NEXT ENTRY
 001DB4 1972/4780 A140       01DC8 16554  1 2027.                IF    (RY,EQ,RA),EXIT         End of chain
 001DBA                            16572  1 2028.                IF    (QRBNAME,EQ,@ENQRNM),EXIT     Found Queue element
 001DBA D52B 7018 C054 00018 0000C 16583  1          +
 001DC0 4780 A140            01DC8 16586  1          +
 001DC4 47F0 A128            01DB0 16592    2029.              END   ,
                                   16597    2030.     *
                                   16598    2031.     *  Create QRB and add it to the chain
                                   16599    2032.     *
 001DC8 1972/4770 A198       01E20 16600    2033.              IF    (RY,EQ,RA),BEGIN
 001DCE 41F0 AE8A/0DEF       02B12 16615  1 2034.                LCALL GETQRB
 001DD4 1870                       16624  1 2035.                LR    RY,RVR
 001DD6 5060 700C            0000C 16625  1 2036.                ST    RX,QRBQCB               Queue pointer
 001DDA D22B 7018 C054 00018 0000C 16626  1 2037.                MVC   QRBNAME,@ENQRNM         Resource name
                                   16627  1 2038.     *
                                   16628  1 2039.     *  SET QOE IN OWNER CHAIN
                                   16629  1 2040.     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  117
0Current Usings:  (PZERO,R0) (QOE,R4) (QAO,R5) (QCB,R6) (QRB,R7) (ENQUEUE,R10) (@ENQUEUE-72,R12) (@HASH-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001DE0 4110 7044            00044 16630  1 2041.                LA    RS,QRBOWNF              QRB OWNER POINTER
 001DE4 5010 4000            00000 16631  1 2042.                ST    RS,QOEFP                 TO QOE
 001DE8 5010 4004            00004 16632  1 2043.                ST    RS,QOEBP
 001DEC 5040 7044            00044 16633  1 2044.                ST    RJ,QRBOWNF              SET FORWARD POINTER
 001DF0 5040 7048            00048 16634  1 2045.                ST    RJ,QRBOWNB               AND BACK POINTER
 001DF4 5070 400C            0000C 16635  1 2046.                ST    RY,QOEQRB               CONNECT QRB TO QOE
                                   16636  1 2047.     *
                                   16637  1 2048.     *  GET ENQUEUE NUMBER
                                   16638  1 2049.     *
                                   16639  1 2050.     *         IF    @ENQAEN,BEGIN
                                   16640  1 2051.     *         MVC   QRBFNT,@ENQFNT          Set FNT for enqueue number
                                   16641  1 2052.     *         PSET  @DSIFN
                                   16642  1 2053.     *         PMOV  @DSIFNA,QRBFNT          Pass the pointer along
                                   16643  1 2054.     *         VCALL DSIFNEW                 GET ENQUEUE NUMBER
                                   16644  1 2055.     *         IF    (RVR,Z),'ABORT BADFN'
                                   16645  1 2056.     *         ST    RVR,QRBNUM              SET
                                   16646  1 2057.     *         SET   QRBAEN                  NOTE ENQUEUE NUMBER ASSIGNED
                                   16647  1 2058.     *         MVC   @ENQNUM,QRBNUM          RETURN NUMBER TO USER
                                   16648  1 2059.     *         END   ,
                                   16649  1 2060.     *
                                   16650  1 2061.     *  Add QRB to the end of the chain
                                   16651  1 2062.     *
 001DF8 5020 7004            00004 16652  1 2063.                ST    RA,QRBBP                ANCHOR IS OUR BACK POINTER
 001DFC 5810 2000            00000 16653  1 2064.                L     RS,@RA                  PREVIOUS FORWARD IS NOW
 001E00 5010 7000            00000 16654  1 2065.                ST    RS,QRBFP                 OUR FORWARD POINTER
 001E04 5070 1004            00004 16655  1 2066.                WITH  (QRB,RS),'ST  RY,QRBBP'  PREVIOUS POINTS BACK HERE
 DROP   QRB,R7
 USING  QRB,R1
 USING  QRB,R7
 DROP   QRB,R1
 001E08 5070 2000            00000 16696  1 2067.                ST    RY,@RA                  ANCHOR FORWARD POINTS HERE
 DROP   @HASH-72,R13               16697  1 2068.                LKREL QCBLOCK                 RELEASE THE QUEUE LOCK
 USING  @LOCKS-72,R13
 001E0C D203 D048 600C 00000 0000C 16716  1          +
 001E12 58F0 A91C/0DEF       025A4 16719  1          +
 001E18 58F0 A908/0DEF       02590 16721  1 2069.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 001E1E 1805                       16725  1 2070.                LR    RVR,RK                  ENQUEUE ID
 001E20                            16726    2071.              END   ,
                                   16730    2072.     *
                                   16731    2073.     *  QRB found - try to get on the band wagon
                                   16732    2074.     *
 001E20 A19C           01E20 01DCC 16733    2075.              ELSE  BEGIN
 001E20 47F0 A26A            01EF2 16738             +
 001E24 5070 400C            0000C 16744  1 2076.                ST    RY,QOEQRB               CONNECT QRB TO QOE
                                   16745  1 2077.     *         IF    @ENQAEN,BEGIN
                                   16746  1 2078.     *         IF    (~QRBAEN,OR,('LT RS,QRBNUM',Z)),'ABORT QRBFNERR'
                                   16747  1 2079.     *         IF    (@ENQFNT,NE,QRBFNT),'ABORT QRBFNT_NE_ENQFNT'
                                   16748  1 2080.     *         MVC   @ENQNUM,QRBNUM          RETURN NUMBER TO USER
                                   16749  1 2081.     *         END   ,
 001E28 4110 7010            00010 16750  1 2082.                LA    RS,QRBWFP                WAIT QUEUE HEAD
                                   16751  1 2083.     *
                                   16752  1 2084.     * IF NO ONE IS WAITING CHECK FOR SHARE
                                   16753  1 2085.     *
 001E2C 5910 7010            00010 16754  1 2086.                IF    (RS,EQ,QRBWFP),BEGIN
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  118
0Current Usings:  (PZERO,R0) (QOE,R4) (QAO,R5) (QCB,R6) (QRB,R7) (ENQUEUE,R10) (@ENQUEUE-72,R12) (@LOCKS-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0001E30 4770 A1F4            01E7C 16766  1          +
 001E34 9180 4024      00024       16771  2 2087.                  IF    ~QOESHR,EXIT            THIS CALLER ISN'T SHARE
 001E38 47E0 A1F4            01E7C 16783  2          +
 001E3C 5810 7044            00044 16789  2 2088.                  L     RS,QRBOWNF              FIRST OWNER
 USING  FIRST.QOE,R1               16790  2 2089.                  WITH  (QOE,RS),LABEL=FIRST
 001E40 9180 1024      00024       16798  2 2090.                  IF    ~FIRST:QOESHR,EXIT      FIRST OWNER ISN'T SHARE
 001E44 47E0 A1F4            01E7C 16810  2          +
                                   16816  2 2091.     *
                                   16817  2 2092.     *  RESOURCE CAN BE SHARED - ADD QOE TO OWNERSHIP CHAIN
                                   16818  2 2093.     *
 001E48 41E0 7044            00044 16819  2 2094.                  LA    R14,QRBOWNF             END OF CHAIN ANCHOR
 001E4C 50E0 4000            00000 16820  2 2095.                  ST    R14,QOEFP                TO THIS ELEMENT
 001E50 58E0 7048            00048 16821  2 2096.                  L     R14,QRBOWNB             LAST ELEMENT IN CHAIN
 001E54 50E0 4004            00004 16822  2 2097.                  ST    R14,QOEBP                IS NOW PREVIOUS
 001E58 5040 7048            00048 16823  2 2098.                  ST    RJ,QRBOWNB              PUT THIS ONE AT END
 001E5C 5040 E000            00000 16824  2 2099.                  WITH  (QOE,R14),'ST  RJ,QOEFP'   (BEHIND PREVIOUS)
 USING  QOE,R14
 DROP   QOE,R14
 001E60 5070 400C            0000C 16848  2 2100.                  ST    RY,QOEQRB               CONNECT QRB TO QOE
 001E64                            16849  2 2101.                  LKREL QCBLOCK                 RELEASE THE QUEUE LOCK
 001E64 D203 D048 600C 00000 0000C 16858  2          +
 001E6A 58F0 A91C/0DEF       025A4 16861  2          +
 001E70 58F0 A908/0DEF       02590 16863  2 2102.                  VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 001E76 1805                       16867  2 2103.                  LR    RVR,RK                  ENQUEUE ID
 001E78 47F0 A26A            01EF2 16868  2 2104.                  EXIT  ENQUEUE
 DROP   FIRST.QOE,R1               16871  1 2105.                END   ,
                                   16883  1 2106.     *
                                   16884  1 2107.     *  RESOURCE NOT AVAILABLE AND CALLER WILL WAIT
                                   16885  1 2108.     *
 001E7C 9140 C080      00038       16886  1 2109.                IF    @ENQSUSP,BEGIN
 001E80 47E0 A21E            01EA6 16896  1          +
 DROP   @LOCKS-72,R13              16901  2 2110.                  PSET  @ENQWAIT
 USING  @ENQWAIT-72,R13
 001E84 D704 D048 D048 00000 00000 16921  2          +
 001E8A 5040 D048            00000 16922  2 2111.                  ST    RJ,@EQWQOE              QOE POINTER
 001E8E 41F0 AB8A/0DEF       02812 16923  2 2112.                  LCALL ENQWAIT                 WAIT FOR IT
                                   16932  2 2113.     *
                                   16933  2 2114.     *  CALLER NOW HAS RESOURCE
                                   16934  2 2115.     *
 001E94 1200/4770 A218       01EA0 16935  2 2116.                  IF    (RVR,Z),BEGIN
 001E9A 1805                       16949  3 2117.                    LR    RVR,RK                  Return QAO pointer
 001E9C 47F0 A26A            01EF2 16950  3 2118.                    EXIT  ENQUEUE
 001EA0                            16953  2 2119.                  END   ,
 001EA0 58F0 A904/0DEF       0258C 16957  2 2120.                  VCALL ASLOCK                  Get address space lock
 001EA6                            16961  1 2121.                END   ,
                                   16965  1 2122.     *
                                   16966  1 2123.     *  CALLER DOESN'T WANT TO WAIT
                                   16967  1 2124.     *
 001EA6 A222           01EA6 01E82 16968  1 2125.                ELSE  'LKREL QCBLOCK'         RELEASE THE QUEUE LOCK
 001EA6 47F0 A22E            01EB6 16973  1          +
 DROP   @ENQWAIT-72,R13
 USING  @LOCKS-72,R13
 001EAA D203 D048 600C 00000 0000C 16999  2          +
 001EB0 58F0 A91C/0DEF       025A4 17002  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  119
0Current Usings:  (PZERO,R0) (QOE,R4) (QAO,R5) (QCB,R6) (QRB,R7) (ENQUEUE,R10) (@ENQUEUE-72,R12) (@LOCKS-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  17008  1 2126.     *
                                   17009  1 2127.     *  RESOURCE CANCELLED OR CALLER WOULDN'T WAIT
                                   17010  1 2128.     *
 DROP   @LOCKS-72,R13              17011  1 2129.                PSET  @ENQASCN
 USING  @ENQASCN-72,R13
 001EB6 D70C D048 D048 00000 00000 17031  1          +
 001EBC 5050 D050            00008 17032  1 2130.                ST    RK,@EQSID               QAO POINTER TO PARAMETER LIST
 001EC0 9640 D054      0000C       17033  1 2131.                SET   @EQSFDEL                DELETE REQUEST
 001EC4 41F0 A9AC/0DEF       02634 17039  1 2132.                LCALL ENQASCN                 CALL SCAN ROUTINE
 001ECA 58F0 A908/0DEF       02590 17048  1 2133.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
                                   17052  1 2134.     *
                                   17053  1 2135.     *  RELEASE QAO
                                   17054  1 2136.     *
 DROP   @ENQASCN-72,R13            17055  1 2137.                PSET  @FREEQAO
 USING  @FREEQAO-72,R13
 001ED0 D703 D048 D048 00000 00000 17075  1          +
 001ED6 5050 D048            00000 17076  1 2138.                ST    RK,@FRQAOP              QAO pointer
 001EDA 58F0 A920/0DEF       025A8 17077  1 2139.                ACALL FREEQAO                 Free it
                                   17084  1 2140.     *
                                   17085  1 2141.     *  RELEASE QOE
                                   17086  1 2142.     *
 DROP   @FREEQAO-72,R13            17087  1 2143.                PSET  @FREEQOE
 USING  @FREEQOE-72,R13
 001EE0 D703 D048 D048 00000 00000 17107  1          +
 001EE6 5040 D048            00000 17108  1 2144.                ST    RJ,@FRQOEP
 001EEA 58F0 A924/0DEF       025AC 17109  1 2145.                ACALL FREEQOE
 001EF0 1B00                       17116  1 2146.                CLEAR RVR
 001EF2                            17120    2147.              END   ,
 001EF2 981F C008            00008 17124    2148.              PEND
 DROP   QRB,R7
 DROP   QCB,R6
 DROP   QOE,R4
 DROP   QAO,R5
 DROP   @ENQUEUE-72,R12
 DROP   ENQUEUE,R10
 001EF6 9680 C000/0B0E 00000       17159             +
 DROP   @FREEQOE-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  120
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  17169    2150.     *******************************************************************
                                   17170    2151.     *                                                                 *
                                   17171    2152.     *   DEQUEUE - Dequeue a resource                                  *
                                   17172    2153.     *                                                                 *
                                   17173    2154.     *     Input - @DEQUEUE                                            *
                                   17174    2155.     *                                                                 *
                                   17175    2156.     *    Output - RVR = 0  Dequeue complete                           *
                                   17176    2157.     *             RVR = 4  Dequeue error                              *
                                   17177    2158.     *                                                                 *
                                   17178    2159.     *******************************************************************
-
 001EFC                            17180    2161.     DEQUEUE  PROC  @DEQUEUE,SCOPE=GLOBAL
 001EFC C4C5D8E4C5E4C540           17186             +
 001F04 0040/0000                  17187             +
 001F08 900F D004/18AF       00004 17189             +
 USING  DEQUEUE,R10
 001F0E 50D0 C000/18CD       00000 17204             +
 001F14 9680 C000      00000       17206             +
 USING  @DEQUEUE-72,R12
 001F18 41D0 C088            00088 17220             +
 001F1C 58F0 A684/0DEF       0258C 17221    2162.              VCALL ASLOCK                  Get address space lock
                                   17225    2163.     *
                                   17226    2164.     *  Remove QAO from address space table
                                   17227    2165.     *
 USING  @ENQASCN-72,R13            17228    2166.              PSET  @ENQASCN
 001F22 D70C D048 D048 00000 00000 17245             +
 001F28 5810 C048            00000 17246    2167.              L     RS,@DEQID               ENQUEUE ID
 001F2C 1211/4780 A02E       01F36 17247    2168.              IF    (RS,NZ),'ST  RS,@EQSID'    TO PARAMETER LIST
 001F32 5010 D050            00008 17262             +
 001F36 A032           01F36 01F30 17267    2169.              ELSE  BEGIN
 001F36 47F0 A042            01F4A 17272             +
 001F3A 4110 C04C            00004 17278  1 2170.                LA    RS,@DEQQNM              QNAME POINTER
 001F3E 5010 D048            00000 17279  1 2171.                ST    RS,@EQSQNM               TO PARAMETER LIST
 001F42 4110 C054            0000C 17280  1 2172.                LA    RS,@DEQRNM              RESOURCE NAME POINTER
 001F46 5010 D04C            00004 17281  1 2173.                ST    RS,@EQSRNM               TO PARAMETER LIST
 001F4A                            17282    2174.              END   ,
 001F4A 9640 D054      0000C       17286    2175.              SET   @EQSFDEL                DELETE REQUEST
 001F4E 41F0 A72C/0DEF       02634 17292    2176.              LCALL ENQASCN                 CALL SCAN ROUTINE
 001F54 1850                       17301    2177.              LR    RK,RVR                  QAO RETURNED
 001F56 58F0 A688/0DEF       02590 17302    2178.              VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
                                   17306    2179.     *
                                   17307    2180.     *  QAO NOT FOUND - RESOURCE NOT ENQUEUED
                                   17308    2181.     *
 001F5C 1255/4770 A062       01F6A 17309    2182.              IF    (RK,Z),BEGIN
 001F62 4100 0004            00004 17323  1 2183.                LA    RVR,4                   RESOURCE NOT ENQUEUED
 001F66 47F0 A224            0212C 17324  1 2184.                EXIT  DEQUEUE
 001F6A                            17327    2185.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  121
0Current Usings:  (PZERO,R0) (DEQUEUE,R10) (@DEQUEUE-72,R12) (@ENQASCN-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  17332    2187.     *
                                   17333    2188.     *  GET QOE POINTER
                                   17334    2189.     *
 001F6A 5860 5008            00008 17335    2190.              WITH  (QAO,RK),'L  RX,QAOQOE'    OWNERSHIP ELEMENT
 USING  QAO,R5
 DROP   QAO,R5
 001F6E 1266/4770 A09C       01FA4 17359    2191.              IF    (RX,Z),'ABORT DEQOEP'
 001F74 AC04 021B      0021B       17377  1          +
 001F78 9680 021A      0021A       17383  1          +
 001F7C 50F0 021C            0021C 17384  1          +
 001F80 58F0 0210            00210 17385  1          +
 001F84 89F0 0010            00010 17386  1          +
 001F88 88F0 0010            00010 17387  1          +
 001F8C 41F0 F000            00000 17388  1          +
 001F90 AEFF 0006            00006 17389  1          +
 001F94 C4C5D8D6C5D74040           17390             +
 USING  QOE,R6                     17395    2192.              WITH  (QOE,RX)
                                   17408    2193.     *
                                   17409    2194.     *  GET QRB POINTER
                                   17410    2195.     *
 001FA4 5840 600C            0000C 17411    2196.              L     RJ,QOEQRB               RESOURCE BLOCK
 001FA8 1244/4770 A0D6       01FDE 17412    2197.              IF    (RJ,Z),'ABORT DEQRBP'
 001FAE AC04 021B      0021B       17430  1          +
 001FB2 9680 021A      0021A       17436  1          +
 001FB6 50F0 021C            0021C 17437  1          +
 001FBA 58F0 0210            00210 17438  1          +
 001FBE 89F0 0010            00010 17439  1          +
 001FC2 88F0 0010            00010 17440  1          +
 001FC6 41F0 F000            00000 17441  1          +
 001FCA AEFF 0006            00006 17442  1          +
 001FCE C4C5D8D9C2D74040           17443             +
                                   17448    2198.     *
                                   17449    2199.     *  RELEASE QAO
                                   17450    2200.     *
 DROP   @ENQASCN-72,R13            17451    2201.              PSET  @FREEQAO
 USING  @FREEQAO-72,R13
 001FDE D703 D048 D048 00000 00000 17471             +
 001FE4 5050 D048            00000 17472    2202.              ST    RK,@FRQAOP              QAO pointer
 001FE8 58F0 A6A0/0DEF       025A8 17473    2203.              ACALL FREEQAO                 Free it
                                   17480    2204.     *
                                   17481    2205.     *  LOCK QCB CHAIN
                                   17482    2206.     *
 USING  QRB,R4                     17483    2207.              WITH  (QRB,RJ)
 001FEE                            17496    2208.              IF    (QRBID,NE,=CL4'QRB'),'ABORT  DEQRBID'
 001FEE D503 A6A8 4008 025B0 00008 17507             +
 001FF4 4780 A120            02028 17508             +
 001FF8 AC04 021B      0021B       17517  1          +
 001FFC 9680 021A      0021A       17523  1          +
 002000 50F0 021C            0021C 17524  1          +
 002004 58F0 0210            00210 17525  1          +
 002008 89F0 0010            00010 17526  1          +
 00200C 88F0 0010            00010 17527  1          +
 002010 41F0 F000            00000 17528  1          +
 002014 AEFF 0006            00006 17529  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  122
0Current Usings:  (PZERO,R0) (QRB,R4) (QOE,R6) (DEQUEUE,R10) (@DEQUEUE-72,R12) (@FREEQAO-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002018 C4C5D8D9C2C9C440           17530             +
 002028 5830 400C            0000C 17535    2209.              L     RB,QRBQCB               QCB POINTER
 USING  QCB,R3                     17536    2210.              WITH  (QCB,RB)
 00202C                            17549    2211.              IF    (QCBID,NE,=CL4'QCB'),'ABORT  DEQCBID'
 00202C D503 A6AC 3000 025B4 00000 17560             +
 002032 4780 A15E            02066 17561             +
 002036 AC04 021B      0021B       17570  1          +
 00203A 9680 021A      0021A       17576  1          +
 00203E 50F0 021C            0021C 17577  1          +
 002042 58F0 0210            00210 17578  1          +
 002046 89F0 0010            00010 17579  1          +
 00204A 88F0 0010            00010 17580  1          +
 00204E 41F0 F000            00000 17581  1          +
 002052 AEFF 0006            00006 17582  1          +
 002056 C4C5D8C3C2C9C440           17583             +
 DROP   @FREEQAO-72,R13            17588    2212.              LKOB  QCBLOCK                 GET QUEUE LOCK
 USING  @LOCKS-72,R13
 002066 D203 D048 300C 00000 0000C 17607             +
 00206C 58F0 A694/0DEF       0259C 17610             +
                                   17612    2213.     *
                                   17613    2214.     *  REMOVE CALLER FROM RESOURCE
                                   17614    2215.     *
 002072 98EF 6000            00000 17615    2216.              LM    R14,R15,QOEFP           FORWARD AND BACKWARD POINTERS
 002076 50F0 E004            00004 17616    2217.              WITH  (QOE,R14),'ST  R15,QOEBP'  NEXT POINTS TO PREVIOUS
 USING  QOE,R14
 DROP   QOE,R14
 00207A 50E0 F000            00000 17640    2218.              WITH  (QOE,R15),'ST  R14,QOEFP'  PREVIOUS POINTS TO NEXT
 USING  QOE,R15
 DROP   QOE,R15
                                   17664    2219.     *
                                   17665    2220.     *  RELEASE QOE
                                   17666    2221.     *
 DROP   @LOCKS-72,R13              17667    2222.              PSET  @FREEQOE
 USING  @FREEQOE-72,R13
 00207E D703 D048 D048 00000 00000 17687             +
 002084 5060 D048            00000 17688    2223.              ST    RX,@FRQOEP
 002088 41F0 AE7A/0DEF       02D82 17689    2224.              LCALL FREEQOE
                                   17698    2225.     *
                                   17699    2226.     *  NO MORE OWNERS - CHECK STATUS
                                   17700    2227.     *
 00208E 4120 4044            00044 17701    2228.              LA    RA,QRBOWNF
 002092 5920 4044            00044 17702    2229.              IF    (RA,EQ,QRBOWNF),BEGIN
 002096 4770 A216            0211E 17714             +
                                   17719  1 2230.     *
                                   17720  1 2231.     *  REMOVE QRB IF CANCEL REQUEST OR NO WAITERS
                                   17721  1 2232.     *
 00209A 4120 4010            00010 17722  1 2233.                LA    RA,QRBWFP
 00209E 9180 C080      00038       17723  1 2234.                IF    (@DEQCAN,OR,(RA,EQ,QRBWFP)),BEGIN
 0020A2 4710 A1A6            020AE 17737  1          +
 0020A6 5920 4010            00010 17748  1          +
 0020AA 4770 A1EC            020F4 17749  1          +
 0020AE 98EF 4000            00000 17754  2 2235.                  LM    R14,R15,QRBFP           FORWARD AND BACKWARD POINTERS
 0020B2 50F0 E004            00004 17755  2 2236.                  WITH  (QRB,R14),'ST  R15,QRBBP'  NEXT POINTS TO PREVIOUS
 USING  QRB,R14
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  123
0Current Usings:  (PZERO,R0) (QCB,R3) (QRB,R4) (QOE,R6) (DEQUEUE,R10) (@DEQUEUE-72,R12) (@FREEQOE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0DROP   QRB,R14
 0020B6 50E0 F000            00000 17779  2 2237.                  WITH  (QRB,R15),'ST  R14,QRBFP'  PREVIOUS POINTS TO NEXT
 USING  QRB,R15
 DROP   QRB,R15
                                   17803  2 2238.     *
                                   17804  2 2239.     *  FREE ENQUEUE NUMBER
                                   17805  2 2240.     *
                                   17806  2 2241.     *         IF    QRBAEN,BEGIN            ENQUEUE NUMBER WAS ASSIGNED
                                   17807  2 2242.     *         PSET  @DSIFN
                                   17808  2 2243.     *         MVC   @DSIFNO,QRBNUM          SET NUMBER
                                   17809  2 2244.     *         MVC   @DSIFNA,QRBFNT          SET TABLE PTR
                                   17810  2 2245.     *         VCALL DSIFNFRE                 AND RELEASE IT
                                   17811  2 2246.     *         END   ,
                                   17812  2 2247.     *
                                   17813  2 2248.     *  POST WAITERS ON CANCEL REQUESTS
                                   17814  2 2249.     *
 0020BA 9180 C080      00038       17815  2 2250.                  IF    @DEQCAN,BEGIN
 0020BE 47E0 A1DC            020E4 17825  2          +
 0020C2 5920 4010            00010 17830  3 2251.                    IF    (RA,EQ,QRBWFP),EXIT     NONE WAITING
 0020C6 4780 A1DC            020E4 17844  3          +
 DROP   @FREEQOE-72,R13            17850  3 2252.                    PSET  @ENQPOST
 USING  @ENQPOST-72,R13
 0020CA D708 D048 D048 00000 00000 17870  3          +
 0020D0 5040 D048            00000 17871  3 2253.                    ST    RJ,@EQPQRB              QRB POINTER
 0020D4 D203 D04C A6B0 00004 025B8 17872  3 2254.                    MVC   @EQPCODE,=A(4)          POST CODE
 0020DA 9640 D050      00008       17873  3 2255.                    SET   @EQPFALL                POST ALL WAITERS
 0020DE 41F0 A9BE/0DEF       028C6 17879  3 2256.                    LCALL ENQPOST                 GO FOR IT
 0020E4                            17888  2 2257.                  END   ,
                                   17892  2 2258.     *
                                   17893  2 2259.     *  RELEASE THE QRB
                                   17894  2 2260.     *
 DROP   @ENQPOST-72,R13            17895  2 2261.                  PSET  @FREEQRB
 USING  @FREEQRB-72,R13
 0020E4 D703 D048 D048 00000 00000 17915  2          +
 0020EA 5040 D048            00000 17916  2 2262.                  ST    RJ,@FRQRBP
 0020EE 41F0 AD00/0DEF       02C08 17917  2 2263.                  LCALL FREEQRB
 0020F4                            17926  1 2264.                END   ,
                                   17930  1 2265.     *
                                   17931  1 2266.     *  POST WAITERS
                                   17932  1 2267.     *
 0020F4 A1F0           020F4 020AC 17933  1 2268.                ELSE  BEGIN
 0020F4 47F0 A216            0211E 17938  1          +
 DROP   @FREEQRB-72,R13            17944  2 2269.                  PSET  @ENQPOST
 USING  @ENQPOST-72,R13
 0020F8 D708 D048 D048 00000 00000 17964  2          +
 0020FE 5040 D048            00000 17965  2 2270.                  ST    RJ,@EQPQRB              QRB POINTER
 002102 D203 D04C A6B4 00004 025BC 17966  2 2271.                  MVC   @EQPCODE,=A(0)          POST CODE
                                   17967  2 2272.     *
                                   17968  2 2273.     *  FIRST TASK IS SHARE - POST ALL WAITING SHARERS
                                   17969  2 2274.     *
 002108 5810 4010            00010 17970  2 2275.                  L     RS,QRBWFP               FIRST QOE ON WAIT QUEUE
 DROP   QOE,R6                     17971  2 2276.                  WITH  (QOE,RS)
 USING  QOE,R1
 00210C 9180 1024      00024       17992  2 2277.                  IF    QOESHR,'SET  @EQPFSHR'  POST ALL SHARE WAITERS
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  124
0Current Usings:  (PZERO,R0) (QOE,R1) (QCB,R3) (QRB,R4) (DEQUEUE,R10) (@DEQUEUE-72,R12) (@ENQPOST-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002110 47E0 A210            02118 18002  2          +
 002114 9680 D050      00008       18013  2          +
 002118 41F0 A9BE/0DEF       028C6 18018  2 2278.                  LCALL ENQPOST                 GO FOR IT
 USING  QOE,R6                     18027  1 2279.                END   ,
 DROP   QOE,R1
 00211E                            18045    2280.              END   ,
 DROP   @ENQPOST-72,R13            18049    2281.              LKREL QCBLOCK                 RELEASE QCB LOCK
 USING  @LOCKS-72,R13
 00211E D203 D048 300C 00000 0000C 18068             +
 002124 58F0 A69C/0DEF       025A4 18071             +
 00212A 1B00                       18073    2282.              CLEAR RVR
 00212C 981F C008            00008 18077    2283.              PEND
 DROP   QCB,R3
 DROP   QRB,R4
 DROP   QOE,R6
 DROP   @DEQUEUE-72,R12
 DROP   DEQUEUE,R10
 002130 9680 C000/0B0E 00000       18107             +
 DROP   @LOCKS-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  125
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  18117    2285.     *******************************************************************
                                   18118    2286.     *                                                                 *
                                   18119    2287.     *   REQUEUE - Requeue a resource from share to exclusive          *
                                   18120    2288.     *               or vice versa                                     *
                                   18121    2289.     *                                                                 *
                                   18122    2290.     *     Input - @REQUEUE                                            *
                                   18123    2291.     *                                                                 *
                                   18124    2292.     *    Output - RVR = 0  Requeue complete                           *
                                   18125    2293.     *             RVR = 4  Requeue error                              *
                                   18126    2294.     *             RVR = 8  Resource already owned as requested        *
                                   18127    2295.     *             RVR =12  Resource being shared - requeue needs wait *
                                   18128    2296.     *                                                                 *
                                   18129    2297.     *******************************************************************
-
 002136                            18131    2299.     REQUEUE  PROC  @REQUEUE,SCOPE=GLOBAL
 002136 D9C5D8E4C5E4C540           18137             +
 00213E 0040/0000                  18138             +
 002142 900F D004/18AF       00004 18140             +
 USING  REQUEUE,R10
 002148 50D0 C000/18CD       00000 18155             +
 00214E 9680 C000      00000       18157             +
 USING  @REQUEUE-72,R12
 002152 41D0 C088            00088 18171             +
                                   18172    2300.     *
                                   18173    2301.     *  Find QAO in address space table
                                   18174    2302.     *
 USING  @ENQASCN-72,R13            18175    2303.              PSET  @ENQASCN
 002156 D70C D048 D048 00000 00000 18192             +
 00215C 5810 C048            00000 18193    2304.              L     RS,@REQID               ENQUEUE ID
 002160 1211/4780 A028       0216A 18194    2305.              IF    (RS,NZ),'ST  RS,@EQSID'    TO PARAMETER LIST
 002166 5010 D050            00008 18209             +
 00216A A02C           0216A 02164 18214    2306.              ELSE  BEGIN
 00216A 47F0 A03C            0217E 18219             +
 00216E 4110 C04C            00004 18225  1 2307.                LA    RS,@REQQNM              QNAME POINTER
 002172 5010 D048            00000 18226  1 2308.                ST    RS,@EQSQNM               TO PARAMETER LIST
 002176 4110 C054            0000C 18227  1 2309.                LA    RS,@REQRNM              RESOURCE NAME POINTER
 00217A 5010 D04C            00004 18228  1 2310.                ST    RS,@EQSRNM               TO PARAMETER LIST
 00217E                            18229    2311.              END   ,
 00217E 58F0 A44A/0DEF       0258C 18233    2312.              VCALL ASLOCK                  Get address space lock
 002184 41F0 A4F2/0DEF       02634 18237    2313.              LCALL ENQASCN                 CALL SCAN ROUTINE
                                   18246    2314.     *
                                   18247    2315.     *  QAO NOT FOUND - RESOURCE NOT ENQUEUED
                                   18248    2316.     *
 00218A 1250/4770 A05C       0219E 18249    2317.              IF    ('LTR  RK,RVR',Z),BEGIN
 002190 58F0 A44E/0DEF       02590 18262  1 2318.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 002196 4100 0004            00004 18266  1 2319.                LA    RVR,4                   RESOURCE NOT ENQUEUED
 00219A 47F0 A22C            0236E 18267  1 2320.                EXIT  REQUEUE
 00219E                            18270    2321.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  126
0Current Usings:  (PZERO,R0) (REQUEUE,R10) (@REQUEUE-72,R12) (@ENQASCN-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  18275    2323.     *
                                   18276    2324.     *  GET QOE POINTER
                                   18277    2325.     *
 USING  QAO,R5                     18278    2326.              WITH  (QAO,RK)
 00219E 5860 5008            00008 18291    2327.              L     RX,QAOQOE               OWNERSHIP ELEMENT
 0021A2 1266/4770 A096       021D8 18292    2328.              IF    (RX,Z),'ABORT REQOEP'
 0021A8 AC04 021B      0021B       18310  1          +
 0021AC 9680 021A      0021A       18316  1          +
 0021B0 50F0 021C            0021C 18317  1          +
 0021B4 58F0 0210            00210 18318  1          +
 0021B8 89F0 0010            00010 18319  1          +
 0021BC 88F0 0010            00010 18320  1          +
 0021C0 41F0 F000            00000 18321  1          +
 0021C4 AEFF 0006            00006 18322  1          +
 0021C8 D9C5D8D6C5D74040           18323             +
 USING  QOE,R6                     18328    2329.              WITH  (QOE,RX)
                                   18341    2330.     *
                                   18342    2331.     *  SEE IF RESOURCE ALREADY IN REQUESTED MODE
                                   18343    2332.     *
                                   18344    2333.   C          IF    ((@REQSHR,AND,QOESHR),OR,
 0021D8 9180 C080      00038                2334.                    (~@REQSHR,AND,~QOESHR)),BEGIN
 0021DC 47E0 A0A6            021E8 18358             +
 0021E0 9180 6024      00024       18369             +
 0021E4 4710 A0B6            021F8 18372             +
 0021E8 9180 C080      00038       18383             +
 0021EC 4710 A0C4            02206 18384             +
 0021F0 9180 6024      00024       18395             +
 0021F4 4710 A0C4            02206 18396             +
 0021F8 58F0 A44E/0DEF       02590 18401  1 2335.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 0021FE 4100 0008            00008 18405  1 2336.                LA    RVR,8                   ALREADY ENQUEUED AS REQUESTED
 002202 47F0 A22C            0236E 18406  1 2337.                EXIT  REQUEUE
 002206                            18409    2338.              END   ,
 002206 58F0 A44E/0DEF       02590 18413    2339.              VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
                                   18417    2340.     *
                                   18418    2341.     *  GET QRB POINTER
                                   18419    2342.     *
 00220C 5840 600C            0000C 18420    2343.              L     RJ,QOEQRB               RESOURCE BLOCK
 002210 1244/4770 A104       02246 18421    2344.              IF    (RJ,Z),'ABORT REQRBP'
 002216 AC04 021B      0021B       18439  1          +
 00221A 9680 021A      0021A       18445  1          +
 00221E 50F0 021C            0021C 18446  1          +
 002222 58F0 0210            00210 18447  1          +
 002226 89F0 0010            00010 18448  1          +
 00222A 88F0 0010            00010 18449  1          +
 00222E 41F0 F000            00000 18450  1          +
 002232 AEFF 0006            00006 18451  1          +
 002236 D9C5D8D9C2D74040           18452             +
 USING  QRB,R4                     18457    2345.              WITH  (QRB,RJ)
 002246                            18470    2346.              IF    (QRBID,NE,=CL4'QRB'),'ABORT  REQRBID'
 002246 D503 A46E 4008 025B0 00008 18481             +
 00224C 4780 A13E            02280 18482             +
 002250 AC04 021B      0021B       18491  1          +
 002254 9680 021A      0021A       18497  1          +
 002258 50F0 021C            0021C 18498  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  127
0Current Usings:  (PZERO,R0) (QRB,R4) (QAO,R5) (QOE,R6) (REQUEUE,R10) (@REQUEUE-72,R12) (@ENQASCN-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000225C 58F0 0210            00210 18499  1          +
 002260 89F0 0010            00010 18500  1          +
 002264 88F0 0010            00010 18501  1          +
 002268 41F0 F000            00000 18502  1          +
 00226C AEFF 0006            00006 18503  1          +
 002270 D9C5D8D9C2C9C440           18504             +
                                   18509    2347.     *
                                   18510    2348.     *  LOCK QCB CHAIN
                                   18511    2349.     *
 002280 5830 400C            0000C 18512    2350.              L     RB,QRBQCB               QCB POINTER
 USING  QCB,R3                     18513    2351.              WITH  (QCB,RB)
 002284                            18526    2352.              IF    (QCBID,NE,=CL4'QCB'),'ABORT  REQCBID'
 002284 D503 A472 3000 025B4 00000 18537             +
 00228A 4780 A17C            022BE 18538             +
 00228E AC04 021B      0021B       18547  1          +
 002292 9680 021A      0021A       18553  1          +
 002296 50F0 021C            0021C 18554  1          +
 00229A 58F0 0210            00210 18555  1          +
 00229E 89F0 0010            00010 18556  1          +
 0022A2 88F0 0010            00010 18557  1          +
 0022A6 41F0 F000            00000 18558  1          +
 0022AA AEFF 0006            00006 18559  1          +
 0022AE D9C5D8C3C2C9C440           18560             +
 DROP   @ENQASCN-72,R13            18565    2353.              LKOB  QCBLOCK                 GET QUEUE LOCK
 USING  @LOCKS-72,R13
 0022BE D203 D048 300C 00000 0000C 18584             +
 0022C4 58F0 A45A/0DEF       0259C 18587             +
                                   18589    2354.     *
                                   18590    2355.     *  CHANGE CALLER FROM EXCLUSIVE TO SHARE
                                   18591    2356.     *
 0022CA 9180 6024      00024       18592    2357.              IF    ~QOESHR,BEGIN
 0022CE 4710 A1B2            022F4 18602             +
 0022D2 9680 6024      00024       18607  1 2358.                SET   QOESHR                  MARK RESOURCE SHARED
 0022D6 9680 5040      00040       18613  1 2359.                SET   QAOSHR
                                   18619  1 2360.     *
                                   18620  1 2361.     *  POST WAITING TASKS
                                   18621  1 2362.     *
 DROP   @LOCKS-72,R13              18622  1 2363.                PSET  @ENQPOST
 USING  @ENQPOST-72,R13
 0022DA D708 D048 D048 00000 00000 18642  1          +
 0022E0 5040 D048            00000 18643  1 2364.                ST    RJ,@EQPQRB              QRB POINTER
 0022E4 D203 D04C A47A 00004 025BC 18644  1 2365.                MVC   @EQPCODE,=A(0)          POST CODE
 0022EA 9680 D050      00008       18645  1 2366.                SET   @EQPFSHR                POST ALL SHARE WAITERS
 0022EE 41F0 A784/0DEF       028C6 18651  1 2367.                LCALL ENQPOST                 GO FOR IT
 0022F4                            18660    2368.              END   ,
                                   18664    2369.     *
                                   18665    2370.     *  CHANGE CALLER FROM SHARE TO EXCLUSIVE
                                   18666    2371.     *
 0022F4 A1B6           022F4 022D0 18667    2372.              ELSE  BEGIN
 0022F4 47F0 A21E            02360 18672             +
                                   18678  1 2373.     *
                                   18679  1 2374.     *  NO OTHERS SHARING - SO CALLER GETS IT EXCLUSIVE
                                   18680  1 2375.     *
 0022F8 5960 4044            00044 18681  1 2376.                IF    ((RX,EQ,QRBOWNF),AND,(RX,EQ,QRBOWNB)),BEGIN
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  128
0Current Usings:  (PZERO,R0) (QCB,R3) (QRB,R4) (QAO,R5) (QOE,R6) (REQUEUE,R10) (@REQUEUE-72,R12) (@ENQPOST-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00022FC 4770 A1CE            02310 18695  1          +
 002300 5960 4048            00048 18708  1          +
 002304 4770 A1CE            02310 18709  1          +
 002308 947F 6024      00024       18714  2 2377.                  CLEAR QOESHR                  NOW OWNS IT EXCLUSIVE
 00230C 947F 5040      00040       18721  2 2378.                  CLEAR QAOSHR
 002310                            18728  1 2379.                END   ,
                                   18732  1 2380.     *
                                   18733  1 2381.     *  STILL SOME SHARING
                                   18734  1 2382.     *
 002310 A1D2           02310 022FE 18735  1 2383.                ELSE  BEGIN
 002306 A1D2           02308 02310 18740  1          +
 002310 47F0 A21E            02360 18742  1          +
                                   18748  2 2384.     *
                                   18749  2 2385.     *  CALLER WON'T WAIT - RETURN
                                   18750  2 2386.     *
 002314 9140 C080      00038       18751  2 2387.                  IF    ~@REQSUSP,BEGIN
 002318 4710 A1E2            02324 18761  2          +
 00231C 4100 000C            0000C 18766  3 2388.                    LA    RVR,12                  RESOURCE NOT REQUEUED
 002320 47F0 A22C            0236E 18767  3 2389.                    EXIT  REQUEUE
 002324                            18770  2 2390.                  END   ,
                                   18774  2 2391.     *
                                   18775  2 2392.     *  CALLER WILL WAIT - REMOVE ELEMENT FROM OWNER CHAIN
                                   18776  2 2393.     *
 002324 98EF 6000            00000 18777  2 2394.                  LM    R14,R15,QOEFP           FORWARD AND BACKWARD POINTERS
 002328 50F0 E004            00004 18778  2 2395.                  WITH  (QOE,R14),'ST  R15,QOEBP'   NEXT POINTS TO PREV
 USING  QOE,R14
 DROP   QOE,R14
 00232C 50E0 F000            00000 18802  2 2396.                  WITH  (QOE,R15),'ST  R14,QOEFP'   PREV POINTS TO NEXT
 USING  QOE,R15
 DROP   QOE,R15
 002330 9180 C080      00038       18826  2 2397.                  IF    @REQSHR,BEGIN           REQUEUE SHARED
 002334 47E0 A1FE            02340 18836  2          +
 002338 9680 5040      00040       18841  3 2398.                    SET   QAOSHR
 00233C 9680 6024      00024       18847  3 2399.                    SET   QOESHR
 002340                            18853  2 2400.                  END   ,
 002340 A202           02340 02336 18857  2 2401.                  ELSE  BEGIN
 002340 47F0 A20A            0234C 18862  2          +
 002344 947F 6024      00024       18868  3 2402.                    CLEAR QOESHR                  WANTS IT EXCLUSIVE
 002348 947F 5040      00040       18875  3 2403.                    CLEAR QAOSHR
 00234C                            18882  2 2404.                  END   ,
                                   18886  2 2405.     *
                                   18887  2 2406.     *  WAIT CALLER - AT HEAD OF QUEUE
                                   18888  2 2407.     *
 DROP   @ENQPOST-72,R13            18889  2 2408.                  PSET  @ENQWAIT
 USING  @ENQWAIT-72,R13
 00234C D704 D048 D048 00000 00000 18909  2          +
 002352 5060 D048            00000 18910  2 2409.                  ST    RX,@EQWQOE              QOE POINTER
 002356 9680 D04C      00004       18911  2 2410.                  SET   @EQWFHD                 PUT AT QUEUE HEAD
 00235A 41F0 A6D0/0DEF       02812 18917  2 2411.                  LCALL ENQWAIT                 WAIT FOR IT
 002360                            18926  1 2412.                END   ,
 002360                            18930    2413.              END   ,
 DROP   @ENQWAIT-72,R13            18934    2414.              LKREL QCBLOCK                 RELEASE QCB LOCK
 USING  @LOCKS-72,R13
 002360 D203 D048 300C 00000 0000C 18953             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  129
0Current Usings:  (PZERO,R0) (QCB,R3) (QRB,R4) (QAO,R5) (QOE,R6) (REQUEUE,R10) (@REQUEUE-72,R12) (@LOCKS-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002366 58F0 A462/0DEF       025A4 18956             +
 00236C 1B00                       18958    2415.              CLEAR RVR
 00236E 981F C008            00008 18962    2416.              PEND
 DROP   QCB,R3
 DROP   QRB,R4
 DROP   QOE,R6
 DROP   QAO,R5
 DROP   @REQUEUE-72,R12
 DROP   REQUEUE,R10
 002372 9680 C000/0B0E 00000       18997             +
 DROP   @LOCKS-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  130
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  19007    2418.     *******************************************************************
                                   19008    2419.     *                                                                 *
                                   19009    2420.     *   ENQHALT - Cancel a waiting enqueue request                    *
                                   19010    2421.     *                                                                 *
                                   19011    2422.     *     Input - @ENQHALT                                            *
                                   19012    2423.     *                                                                 *
                                   19013    2424.     *    Output - RVR = 0  Enqhalt complete                           *
                                   19014    2425.     *             RVR = 4  Enqhalt error                              *
                                   19015    2426.     *                                                                 *
                                   19016    2427.     *******************************************************************
-
 002378                            19018    2429.     ENQHALT  PROC  @ENQHALT,SCOPE=GLOBAL
 002378 C5D5D8C8C1D3E340           19024             +
 002380 0038/0000                  19025             +
 002384 900F D004/18AF       00004 19027             +
 USING  ENQHALT,R10
 00238A 50D0 C000/18CD       00000 19042             +
 002390 9680 C000      00000       19044             +
 USING  @ENQHALT-72,R12
 002394 41D0 C080            00080 19058             +
                                   19059    2430.     *
                                   19060    2431.     *  Find QAO in address space table
                                   19061    2432.     *
 USING  @ENQASCN-72,R13            19062    2433.              PSET  @ENQASCN
 002398 D70C D048 D048 00000 00000 19079             +
 00239E 4110 C048            00000 19080    2434.              LA    RS,@EQHQNM              QNAME POINTER
 0023A2 5010 D048            00000 19081    2435.              ST    RS,@EQSQNM               TO PARAMETER LIST
 0023A6 4110 C050            00008 19082    2436.              LA    RS,@EQHRNM              RESOURCE NAME POINTER
 0023AA 5010 D04C            00004 19083    2437.              ST    RS,@EQSRNM               TO PARAMETER LIST
 0023AE 58F0 A208/0DEF       0258C 19084    2438.              VCALL ASLOCK                  Get address space lock
 0023B4 41F0 A2B0/0DEF       02634 19088    2439.              LCALL ENQASCN                 CALL SCAN ROUTINE
                                   19097    2440.     *
                                   19098    2441.     *  QAO NOT FOUND - RESOURCE NOT ENQUEUED
                                   19099    2442.     *
 0023BA 1250/4770 A04A       023CE 19100    2443.              IF    ('LTR  RK,RVR',Z),BEGIN
 0023C0 58F0 A20C/0DEF       02590 19113  1 2444.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 0023C6 4100 0004            00004 19117  1 2445.                LA    RVR,4                   RESOURCE NOT ENQUEUED
 0023CA 47F0 A1DC            02560 19118  1 2446.                EXIT  ENQHALT
 0023CE                            19121    2447.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  131
0Current Usings:  (PZERO,R0) (ENQHALT,R10) (@ENQHALT-72,R12) (@ENQASCN-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  19126    2449.     *
                                   19127    2450.     *  GET QOE POINTER
                                   19128    2451.     *
 0023CE 5860 5008            00008 19129    2452.              WITH  (QAO,RK),'L  RX,QAOQOE'    OWNERSHIP ELEMENT
 USING  QAO,R5
 DROP   QAO,R5
 0023D2 1266/4770 A084       02408 19153    2453.              IF    (RX,Z),'ABORT HLTQOEP'
 0023D8 AC04 021B      0021B       19171  1          +
 0023DC 9680 021A      0021A       19177  1          +
 0023E0 50F0 021C            0021C 19178  1          +
 0023E4 58F0 0210            00210 19179  1          +
 0023E8 89F0 0010            00010 19180  1          +
 0023EC 88F0 0010            00010 19181  1          +
 0023F0 41F0 F000            00000 19182  1          +
 0023F4 AEFF 0006            00006 19183  1          +
 0023F8 C8D3E3D8D6C5D740           19184             +
 USING  QOE,R6                     19189    2454.              WITH  (QOE,RX)
                                   19202    2455.     *
                                   19203    2456.     *  GET QRB POINTER
                                   19204    2457.     *
 002408 5840 600C            0000C 19205    2458.              L     RJ,QOEQRB               RESOURCE BLOCK
 00240C 1244/4770 A0BE       02442 19206    2459.              IF    (RJ,Z),'ABORT HLTQRBP'
 002412 AC04 021B      0021B       19224  1          +
 002416 9680 021A      0021A       19230  1          +
 00241A 50F0 021C            0021C 19231  1          +
 00241E 58F0 0210            00210 19232  1          +
 002422 89F0 0010            00010 19233  1          +
 002426 88F0 0010            00010 19234  1          +
 00242A 41F0 F000            00000 19235  1          +
 00242E AEFF 0006            00006 19236  1          +
 002432 C8D3E3D8D9C2D740           19237             +
                                   19242    2460.     *
                                   19243    2461.     *  LOCK QCB CHAIN
                                   19244    2462.     *
 USING  QRB,R4                     19245    2463.              WITH  (QRB,RJ)
 002442                            19258    2464.              IF    (QRBID,NE,=CL4'QRB'),'ABORT  HLTQRBID'
 002442 D503 A22C 4008 025B0 00008 19269             +
 002448 4780 A0F8            0247C 19270             +
 00244C AC04 021B      0021B       19279  1          +
 002450 9680 021A      0021A       19285  1          +
 002454 50F0 021C            0021C 19286  1          +
 002458 58F0 0210            00210 19287  1          +
 00245C 89F0 0010            00010 19288  1          +
 002460 88F0 0010            00010 19289  1          +
 002464 41F0 F000            00000 19290  1          +
 002468 AEFF 0006            00006 19291  1          +
 00246C C8D3E3D8D9C2C9C4           19292             +
 00247C 5830 400C            0000C 19297    2465.              L     RB,QRBQCB               QCB POINTER
 USING  QCB,R3                     19298    2466.              WITH  (QCB,RB)
 002480                            19311    2467.              IF    (QCBID,NE,=CL4'QCB'),'ABORT  HLTQCBID'
 002480 D503 A230 3000 025B4 00000 19322             +
 002486 4780 A136            024BA 19323             +
 00248A AC04 021B      0021B       19332  1          +
 00248E 9680 021A      0021A       19338  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  132
0Current Usings:  (PZERO,R0) (QCB,R3) (QRB,R4) (QOE,R6) (ENQHALT,R10) (@ENQHALT-72,R12) (@ENQASCN-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002492 50F0 021C            0021C 19339  1          +
 002496 58F0 0210            00210 19340  1          +
 00249A 89F0 0010            00010 19341  1          +
 00249E 88F0 0010            00010 19342  1          +
 0024A2 41F0 F000            00000 19343  1          +
 0024A6 AEFF 0006            00006 19344  1          +
 0024AA C8D3E3D8C3C2C9C4           19345             +
 DROP   @ENQASCN-72,R13            19350    2468.              LKOB  QCBLOCK                 GET QUEUE LOCK
 USING  @LOCKS-72,R13
 0024BA D203 D048 300C 00000 0000C 19369             +
 0024C0 58F0 A218/0DEF       0259C 19372             +
                                   19374    2469.     *
                                   19375    2470.     *  IF QOE NOT WAITING - UNLOCK AND RETURN
                                   19376    2471.     *
 0024C6 9140 6024      00024       19377    2472.              IF    ~QOEWAIT,BEGIN
 0024CA 4710 A164            024E8 19387             +
 0024CE                            19392  1 2473.                LKREL QCBLOCK                 RELEASE QUEUE LOCK
 0024CE D203 D048 300C 00000 0000C 19401  1          +
 0024D4 58F0 A220/0DEF       025A4 19404  1          +
 0024DA 58F0 A20C/0DEF       02590 19406  1 2474.                VCALL ASULOCK                 RELEASE ADDRESS SPACE LOCK
 0024E0 4100 0004            00004 19410  1 2475.                LA    RVR,4                   RESOURCE NOT WAITING
 0024E4 47F0 A1DC            02560 19411  1 2476.                EXIT  ENQHALT
 0024E8                            19414    2477.              END   ,
                                   19418    2478.     *
                                   19419    2479.     *  REMOVE THIS REQUEST FROM WAIT QUEUE
                                   19420    2480.     *
 0024E8 98EF 6000            00000 19421    2481.              LM    R14,R15,QOEFP           FORWARD AND BACKWARD POINTERS
 0024EC 50F0 E004            00004 19422    2482.              WITH  (QOE,R14),'ST  R15,QOEBP'  NEXT POINTS TO PREVIOUS
 USING  QOE,R14
 DROP   QOE,R14
 0024F0 50E0 F000            00000 19446    2483.              WITH  (QOE,R15),'ST  R14,QOEFP'  PREVIOUS POINTS TO NEXT
 USING  QOE,R15
 DROP   QOE,R15
                                   19470    2484.     *
                                   19471    2485.     *  POST THIS REQUEST WITH ERROR
                                   19472    2486.     *
 DROP   @LOCKS-72,R13              19473    2487.              SIGNL QOEECB,=A(4),QOEASB,QOESYR
 USING  @SIGNAL-72,R13
 0024F4 D713 D048 D048 00000 00000 19494             +
 0024FA 4100 6018            00018 19506             +
 0024FE 5000 D050            00008 19511             +
 002502 D203 D04C A234 00004 025B8 19516             +
 002508 D203 D054 6010 0000C 00010 19521             +
 00250E D203 D058 6020 00010 00020 19526             +
 002514 58F0 A23C/0DEF       025C0 19529             +
                                   19531    2488.     *
                                   19532    2489.     *  OWNER IS SHARE - CHECK STATUS OF WAITERS
                                   19533    2490.     *
 00251A 5860 4044            00044 19534    2491.              L     RX,QRBOWNF
 00251E 9180 6024      00024       19535    2492.              IF    QOESHR,BEGIN
 002522 47E0 A1C8            0254C 19545             +
                                   19550  1 2493.     *
                                   19551  1 2494.     *  FIRST TASK IS SHARE - POST ALL WAITING SHARERS
                                   19552  1 2495.     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  133
0Current Usings:  (PZERO,R0) (QCB,R3) (QRB,R4) (QOE,R6) (ENQHALT,R10) (@ENQHALT-72,R12) (@SIGNAL-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002526 5860 4010            00010 19553  1 2496.                L     RX,QRBWFP               FIRST QOE ON WAIT QUEUE
 00252A 9180 6024      00024       19554  1 2497.                IF    ~QOESHR,EXIT
 00252E 47E0 A1C8            0254C 19566  1          +
 DROP   @SIGNAL-72,R13             19572  1 2498.                PSET  @ENQPOST
 USING  @ENQPOST-72,R13
 002532 D708 D048 D048 00000 00000 19592  1          +
 002538 5040 D048            00000 19593  1 2499.                ST    RJ,@EQPQRB              QRB POINTER
 00253C D203 D04C A238 00004 025BC 19594  1 2500.                MVC   @EQPCODE,=A(0)          POST CODE
 002542 9680 D050      00008       19595  1 2501.                SET   @EQPFSHR                POST ALL SHARE WAITERS
 002546 41F0 A542/0DEF       028C6 19601  1 2502.                LCALL ENQPOST                 GO FOR IT
 00254C                            19610    2503.              END   ,
 DROP   @ENQPOST-72,R13            19614    2504.              LKREL QCBLOCK                 RELEASE QCB LOCK
 USING  @LOCKS-72,R13
 00254C D203 D048 300C 00000 0000C 19633             +
 002552 58F0 A220/0DEF       025A4 19636             +
                                   19638    2505.     *
                                   19639    2506.     *  HALT PROCESSING COMPLETE
                                   19640    2507.     *
 002558 58F0 A20C/0DEF       02590 19641    2508.              VCALL ASULOCK                 RELEASE THE ASLOCK
 00255E 1B00                       19645    2509.              CLEAR RVR
 002560 981F C008            00008 19649    2510.              PEND
 DROP   QCB,R3
 DROP   QRB,R4
 DROP   QOE,R6
 DROP   @ENQHALT-72,R12
 DROP   ENQHALT,R10
 002564 9680 C000/0B0E 00000       19679             +
 DROP   @LOCKS-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  134
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002570                            19689    2512.              LTORG
 002570 C5D5D8E4C5E4C540           19691                             =CL16'ENQUEUE'
 002580 00000000                   19692                             =V(VMGET)
 002584 D8C3E340                   19693                             =CL4'QCT'
 002588 00000000                   19694                             =V(LKCRE)
 00258C 00000000                   19695                             =V(ASLOCK)
 002590 00000000                   19696                             =V(ASULOCK)
 002594 00002C92                   19697                             =A(GETQOE)
 002598 0000298E                   19698                             =A(FINDQCB)
 00259C 00000000                   19699                             =V(LKOB)
 0025A0 00000000                   19700                             =V(HASHIT)
 0025A4 00000000                   19701                             =V(LKREL)
 0025A8 00002EF6                   19702                             =A(FREEQAO)
 0025AC 00002D82                   19703                             =A(FREEQOE)
 0025B0 D8D9C240                   19704                             =CL4'QRB'
 0025B4 D8C3C240                   19705                             =CL4'QCB'
 0025B8 00000004                   19706                             =A(4)
 0025BC 00000000                   19707                             =A(0)
 0025C0 00000000                   19708                             =V(SIGNAL)
 0025C4 3B00           025C6 03638 19709                             =Y(59*256+0)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  135
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  19714    2514.     *******************************************************************
                                   19715    2515.     *                                                                 *
                                   19716    2516.     *   ENQASTRM - Enqueue Address space termination cleanup          *
                                   19717    2517.     *                                                                 *
                                   19718    2518.     *     Input - None                                                *
                                   19719    2519.     *                                                                 *
                                   19720    2520.     *    Output - None                                                *
                                   19721    2521.     *                                                                 *
                                   19722    2522.     *******************************************************************
-
 0025C6                            19724    2524.     ENQASTRM PROC  ,SCOPE=GLOBAL
 0025C6 C5D5D8C1E2E3D9D4           19730             +
 0025CE 0000/0000                  19731             +
 0025D2 900F D004/18AF       00004 19733             +
 USING  ENQASTRM,R10
 0025D8 50D0 C000/18CD       00000 19748             +
 0025DE 9680 C000      00000       19750             +
 0025E2 41D0 C048            00048 19751             +
 0025E6 5820 0208            00208 19752    2525.              L     RA,PZCURASB             CURRENT ASB
 0025EA 5820 2028            00028 19753    2526.              WITH  (ASB,RA),'L  RA,ASBENQ'   LOCAL ENQUEUE CONTROL
 USING  ASB,R2
 DROP   ASB,R2
 USING  QAS,R2                     19777    2527.              WITH  (QAS,RA)
 0025EE 1222/4780 A04C       0261E 19790    2528.              IF    (RA,NZ),BEGIN
 0025F4 58F0 A9A6/0DEF       02F78 19804  1 2529.                VCALL ASLOCK                  GET ADDRESS SPACE LOCK
                                   19808  1 2530.     *
                                   19809  1 2531.     *  LOOP THROUGH RESOURCE LIST AND RELEASE
                                   19810  1 2532.     *
 0025FA 5830 2004/1233       00004 19811  1 2533.                WHILE ('LT  RB,QASCHN',NZ),BEGIN
 002600 4780 A046            02618 19824  1          +
 USING  @DEQUEUE-72,R13            19829  2 2534.                  PSET  @DEQUEUE
 002604 D738 D048 D048 00000 00000 19846  2          +
 00260A 5030 D048            00000 19847  2 2535.                  ST    RB,@DEQID               SET ID
 00260E 58F0 A9AA/0DEF       02F7C 19848  2 2536.                  ACALL DEQUEUE
 002614 47F0 A028            025FA 19855  1 2537.                END   ,
 002618 58F0 A9AE/0DEF       02F80 19860  1 2538.                VCALL ASULOCK                 UNLOCK ADDRESS SPACE
 00261E                            19864    2539.              END
 00261E 981F C008            00008 19868    2540.              PEND
 DROP   QAS,R2
 DROP   ENQASTRM,R10
 002622 9680 C000/0B0E 00000       19883             +
 DROP   @DEQUEUE-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  136
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  19893    2542.     *******************************************************************
                                   19894    2543.     *                                                                 *
                                   19895    2544.     *   ENQASCN - Scan address space table for resource               *
                                   19896    2545.     *                                                                 *
                                   19897    2546.     *     Input - @ENQASCN                                            *
                                   19898    2547.     *             Address space lock held                             *
                                   19899    2548.     *                                                                 *
                                   19900    2549.     *    Output - RVR contains QAO pointer if found                   *
                                   19901    2550.     *                                                                 *
                                   19902    2551.     *******************************************************************
-
 002628                            19904    2553.     ENQASCN  PROC  @ENQASCN,SCOPE=LOCAL
 002628 C5D5D8C1E2C3D540           19911             +
 002630 0010/0000                  19912             +
 002634 900F D004/18AF       00004 19914             +
 USING  ENQASCN,R10
 00263A 50D0 C000/18CD       00000 19929             +
 002640 9680 C000      00000       19931             +
 USING  @ENQASCN-72,R12
 002644 41D0 C058            00058 19945             +
                                   19946    2554.     *
                                   19947    2555.     *  Set address space table
                                   19948    2556.     *
 002648 5860 0208            00208 19949    2557.              L     RX,PZCURASB             ASB POINTER
 00264C 5860 6028            00028 19950    2558.              WITH  (ASB,RX),'L  RX,ASBENQ'   Address space Enqueue table
 USING  ASB,R6
 DROP   ASB,R6
 USING  QAS,R6                     19974    2559.              WITH  (QAS,RX)
                                   19987    2560.     *
                                   19988    2561.     *  ADDRESS TABLE NOT YET CREATED
                                   19989    2562.     *
 002650 1266/4770 A094       026C8 19990    2563.              IF    (RX,Z),BEGIN
                                   20004  1 2564.     *
                                   20005  1 2565.     *  IF NOT ADD REQUEST - RETURN NOT FOUND
                                   20006  1 2566.     *
 002656 9180 C054      0000C       20007  1 2567.                IF    ~@EQSFADD,BEGIN
 00265A 4710 A030            02664 20017  1          +
 00265E 1B00                       20022  2 2568.                  CLEAR RVR                     RESOURCE NOT ENQUEUED
 002660 47F0 A1C8            027FC 20026  2 2569.                  EXIT  ENQASCN
 002664                            20029  1 2570.                END   ,
                                   20033  1 2571.     *
                                   20034  1 2572.     *  CREATE ADDRESS SPACE TABLE
                                   20035  1 2573.     *
 USING  @VMGET-72,R13              20036  1 2574.                VMGET L'QAS,LOC=LOCSYS
 002664 D70A D048 D048 00000 00000 20060  1          +
 00266A 4100 0010            00010 20072  1          +
 00266E 5000 D048            00000 20077  1          +
 002672 D201 D050 A998 00008 02FCC 20078  1          +
 002678 58F0 A950/0DEF       02F84 20081  1          +
 00267E 1260/4770 A080       026B4 20083  1 2575.                IF    ('LTR  RX,RVR',Z),'ABORT ENQQAS'
 002684 AC04 021B      0021B       20100  2          +
 002688 9680 021A      0021A       20106  2          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  137
0Current Usings:  (PZERO,R0) (QAS,R6) (ENQASCN,R10) (@ENQASCN-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000268C 50F0 021C            0021C 20107  2          +
 002690 58F0 0210            00210 20108  2          +
 002694 89F0 0010            00010 20109  2          +
 002698 88F0 0010            00010 20110  2          +
 00269C 41F0 F000            00000 20111  2          +
 0026A0 AEFF 0006            00006 20112  2          +
 0026A4 C5D5D8D8C1E24040           20113  1          +
 0026B4                            20118  1 2576.                CLEAR QAS
 0026B4 D70F 6000 6000 00000 00000 20124  1          +
 0026BA D203 6000 A954 00000 02F88 20125  1 2577.                MVC   QASID,=CL4'QAS'         SET ID
 0026C0 5810 0208            00208 20126  1 2578.                L     RS,PZCURASB             ASB POINTER
 0026C4 5060 1028            00028 20127  1 2579.                WITH  (ASB,RS),'ST  RX,ASBENQ'   SET POINTER IN ASB
 USING  ASB,R1
 DROP   ASB,R1
 0026C8                            20151    2580.              END   ,
                                   20155    2581.     *
                                   20156    2582.     *  VALIDATE QAS
                                   20157    2583.     *
 0026C8 A098           026C8 02654 20158    2584.              ELSE  BEGIN
 0026C8 47F0 A0D2            02706 20163             +
 0026CC                            20169  1 2585.                IF    (QASID,NE,=CL4'QAS'),'ABORT ENQAST'
 0026CC D503 A954 6000 02F88 00000 20180  1          +
 0026D2 4780 A0D2            02706 20181  1          +
 0026D6 AC04 021B      0021B       20190  2          +
 0026DA 9680 021A      0021A       20196  2          +
 0026DE 50F0 021C            0021C 20197  2          +
 0026E2 58F0 0210            00210 20198  2          +
 0026E6 89F0 0010            00010 20199  2          +
 0026EA 88F0 0010            00010 20200  2          +
 0026EE 41F0 F000            00000 20201  2          +
 0026F2 AEFF 0006            00006 20202  2          +
 0026F6 C5D5D8C1E2E34040           20203  1          +
 002706                            20208    2586.              END   ,
                                   20212    2587.     *
                                   20213    2588.     *  CALLER SUPPLIED ENQUEUE ID - FIND IT IN CHAIN
                                   20214    2589.     *
 002706 5850 C050            00008 20215    2590.              L     RK,@EQSID               GET RESOURCE ID
 USING  QAO,R5                     20216    2591.              WITH  (QAO,RK)
 00270A 1255/4780 A136       0276A 20229    2592.              IF    (RK,NZ),BEGIN
 002710                            20243  1 2593.                IF    (QAOID,NE,=CL4'QAO'),'ABORT QAOID'
 002710 D503 A958 5000 02F8C 00000 20254  1          +
 002716 4780 A116            0274A 20255  1          +
 00271A AC04 021B      0021B       20264  2          +
 00271E 9680 021A      0021A       20270  2          +
 002722 50F0 021C            0021C 20271  2          +
 002726 58F0 0210            00210 20272  2          +
 00272A 89F0 0010            00010 20273  2          +
 00272E 88F0 0010            00010 20274  2          +
 002732 41F0 F000            00000 20275  2          +
 002736 AEFF 0006            00006 20276  2          +
 00273A D8C1D6C9C4404040           20277  1          +
 00274A 4140 6000            00000 20282  1 2594.                LA    RJ,QASCHN-(QAOCHN-QAO)   Chain ANCHOR
 00274E                            20283  1 2595.                LOOP  BEGIN
 DROP   QAO,R5                     20289  2 2596.                  WITH  (QAO,RJ)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  138
0Current Usings:  (PZERO,R0) (QAO,R4) (QAS,R6) (ENQASCN,R10) (@ENQASCN-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0USING  QAO,R4
 00274E 5950 4004            00004 20310  2 2597.                  IF    (RK,EQ,QAOCHN),EXIT     FOUND IT
 002752 4780 A136            0276A 20324  2          +
 002756 5840 4004            00004 20330  2 2598.                  L     RJ,QAOCHN               GET NEXT ENTRY
 00275A 1244/4770 A11A       0274E 20331  2 2599.                  IF    (RJ,NZ),NEXT            Go to end of chain
                                   20348  2 2600.     *
                                   20349  2 2601.     *  RESOURCE NOT IN QAO CHAIN
                                   20350  2 2602.     *
 002760 1B00                       20351  2 2603.                  CLEAR RVR                     RESOURCE NOT ENQUEUED
 002762 47F0 A1C8            027FC 20355  2 2604.                  EXIT  ENQASCN
 002766 47F0 A11A            0274E 20358  1 2605.                END   ,
 USING  QAO,R5
 DROP   QAO,R4
 00276A                            20377    2606.              END   ,
                                   20381    2607.     *
                                   20382    2608.     *  SEARCH ADDRESS SPACE ENQUEUE CHAIN
                                   20383    2609.     *
 00276A A13A           0276A 0270E 20384    2610.              ELSE  BEGIN
 00276A 47F0 A16A            0279E 20389             +
 00276E 4150 6000            00000 20395  1 2611.                LA    RK,QASCHN-(QAOCHN-QAO)  Chain ANCHOR
                                   20396  1 2612.                WITH  (QAO,RK)
 002772 5820 C048            00000 20400  1 2613.                L     RA,@EQSQNM              Queue name pointer
 002776 5830 C04C            00004 20401  1 2614.                L     RB,@EQSRNM              Resource name pointer
 00277A                            20402  1 2615.                LOOP  BEGIN
 00277A 1845                       20408  2 2616.                  LR    RJ,RK                   SAVE PREVIOUS POINTER
 00277C 5850 5004            00004 20409  2 2617.                  L     RK,QAOCHN               GET NEXT ENTRY
 002780 1255/4780 A16A       0279E 20410  2 2618.                  IF    (RK,Z),EXIT             END OF CHAIN
 002786                            20427  2 2619.                  IF    (QAOQNAME,NE,@RA),NEXT    NOT THIS ONE
 002786 D507 500C 2000 0000C 00000 20438  2          +
 00278C 4770 A146            0277A 20441  2          +
 002790                            20447  2 2620.                  IF    (QAORNAME,EQ,@RB),EXIT    FOUND IT
 002790 D52B 5014 3000 00014 00000 20458  2          +
 002796 4780 A16A            0279E 20461  2          +
 00279A 47F0 A146            0277A 20467  1 2621.                END   ,
 00279E                            20472    2622.              END   ,
                                   20476    2623.     *
                                   20477    2624.     *  RESOURCE NOT IN QAO CHAIN
                                   20478    2625.     *
 00279E 1255/4770 A1A8       027DC 20479    2626.              IF    (RK,Z),BEGIN
                                   20493  1 2627.     *
                                   20494  1 2628.     *  IF NOT ADD REQUEST - RETURN NOT FOUND
                                   20495  1 2629.     *
 0027A4 9180 C054      0000C       20496  1 2630.                IF    ~@EQSFADD,BEGIN
 0027A8 4710 A17E            027B2 20506  1          +
 0027AC 1B00                       20511  2 2631.                  CLEAR RVR                     RESOURCE NOT ENQUEUED
 0027AE 47F0 A1C8            027FC 20515  2 2632.                  EXIT  ENQASCN
 0027B2                            20518  1 2633.                END   ,
                                   20522  1 2634.     *
                                   20523  1 2635.     *  Get a QAO and add it to the chain
                                   20524  1 2636.     *
 0027B2 41F0 A7D8/0DEF       02E0C 20525  1 2637.                LCALL GETQAO
 0027B8 1850                       20534  1 2638.                LR    RK,RVR
 0027BA D207 500C 2000 0000C 00000 20535  1 2639.                MVC   QAOQNAME,@RA            Queue name
 0027C0 D22B 5014 3000 00014 00000 20536  1 2640.                MVC   QAORNAME,@RB            Resource name
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  139
0Current Usings:  (PZERO,R0) (QAO,R5) (QAS,R6) (ENQASCN,R10) (@ENQASCN-72,R12) (@VMGET-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00027C6 9120 C054      0000C       20537  1 2641.                IF    @EQSFSHR,'SET  QAOSHR'  Shared
 0027CA 47E0 A19E            027D2 20547  1          +
 0027CE 9680 5040      00040       20558  1          +
 0027D2 D203 5004 6004 00004 00004 20563  1 2642.                MVC   QAOCHN,QASCHN           PUT THIS ONE
 0027D8 5050 6004            00004 20564  1 2643.                ST    RK,QASCHN                AT THE HEAD
 0027DC                            20565    2644.              END   ,
                                   20569    2645.     *
                                   20570    2646.     *  RESOURCE WAS FOUND IN QAO CHAIN
                                   20571    2647.     *
 0027DC A1AC           027DC 027A2 20572    2648.              ELSE  BEGIN
 0027DC 47F0 A1C6            027FA 20577             +
                                   20583  1 2649.     *
                                   20584  1 2650.     *  REMOVE QAO FROM ADDRESS SPACE CHAIN
                                   20585  1 2651.     *
 0027E0 9140 C054      0000C       20586  1 2652.                IF    @EQSFDEL,BEGIN
 0027E4 47E0 A1BA            027EE 20596  1          +
 0027E8 D203 4004 5004 00004 00004 20601  2 2653.                  MVC   QAOCHN-QAO(4,RJ),QAOCHN   REMOVE THIS ELEMENT
 0027EE                            20602  1 2654.                END   ,
                                   20606  1 2655.     *
                                   20607  1 2656.     *  FOR ADD REQUESTS - NOTE ALREADY IN LIST
                                   20608  1 2657.     *
 0027EE 9180 C054      0000C       20609  1 2658.                IF    @EQSFADD,BEGIN
 0027F2 47E0 A1C6            027FA 20619  1          +
 0027F6 5650 A95C            02F90 20624  2 2659.                  O     RK,=X'80000000'
 0027FA                            20625  1 2660.                END   ,
 0027FA                            20629    2661.              END   ,
 0027FA 1805                       20633    2662.              LR    RVR,RK                  RETURN QAO POINTER
 0027FC 981F C008            00008 20634    2663.              PEND
 DROP   QAO,R5
 DROP   QAS,R6
 DROP   @ENQASCN-72,R12
 DROP   ENQASCN,R10
 002800 9680 C000/0B0E 00000       20659             +
 DROP   @VMGET-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  140
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  20669    2665.     *******************************************************************
                                   20670    2666.     *                                                                 *
                                   20671    2667.     *   ENQWAIT - Enqueue wait routine                                *
                                   20672    2668.     *                                                                 *
                                   20673    2669.     *     Input - @ENQWAIT                                            *
                                   20674    2670.     *             Queue lock held                                     *
                                   20675    2671.     *                                                                 *
                                   20676    2672.     *    Output - RVR contains post code                              *
                                   20677    2673.     *                                                                 *
                                   20678    2674.     *******************************************************************
-
 002806                            20680    2676.     ENQWAIT  PROC  @ENQWAIT,SCOPE=LOCAL
 002806 C5D5D8E6C1C9E340           20687             +
 00280E 0008/0000                  20688             +
 002812 900F D004/18AF       00004 20690             +
 USING  ENQWAIT,R10
 002818 50D0 C000/18CD       00000 20705             +
 00281E 9680 C000      00000       20707             +
 USING  @ENQWAIT-72,R12
 002822 41D0 C050            00050 20721             +
 002826 5850 C048            00000 20722    2677.              L     RK,@EQWQOE              QOE POINTER
 USING  QOE,R5                     20723    2678.              WITH  (QOE,RK)
 00282A 5840 500C            0000C 20736    2679.              L     RJ,QOEQRB               QRB POINTER
 USING  QRB,R4                     20737    2680.              WITH  (QRB,RJ)
 00282E 9640 5024      00024       20750    2681.              SET   QOEWAIT                 MARK ELEMENT AS WAITING
                                   20756    2682.     *
                                   20757    2683.     *  ADD WAIT ELEMENT TO END OF QRB WAIT CHAIN
                                   20758    2684.     *
 002832 9180 C04C      00004       20759    2685.              IF    ~@EQWFHD,BEGIN
 002836 4710 A040            02852 20769             +
 00283A 4110 4010            00010 20774  1 2686.                LA    RS,QRBWFP               END OF CHAIN ANCHOR
 00283E 5010 5000            00000 20775  1 2687.                ST    RS,QOEFP                 TO THIS ELEMENT
 002842 5810 4014            00014 20776  1 2688.                L     RS,QRBWBP               LAST ELEMENT IN CHAIN
 002846 5010 5004            00004 20777  1 2689.                ST    RS,QOEBP                 IS NOW PREVIOUS
 00284A 5050 4014            00014 20778  1 2690.                ST    RK,QRBWBP               PUT THIS ONE AT END
 00284E 5050 1000            00000 20779  1 2691.                WITH  (QOE,RS),'ST  RK,QOEFP'   (BEHIND PREVIOUS)
 DROP   QOE,R5
 USING  QOE,R1
 USING  QOE,R5
 DROP   QOE,R1
 002852                            20820    2692.              END   ,
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  141
0Current Usings:  (PZERO,R0) (QRB,R4) (QOE,R5) (ENQWAIT,R10) (@ENQWAIT-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  20825    2694.     *
                                   20826    2695.     *  ADD WAIT ELEMENT TO HEAD OF QRB WAIT CHAIN
                                   20827    2696.     *
 002852 A044           02852 02838 20828    2697.              ELSE  BEGIN
 002852 47F0 A05C            0286E 20833             +
 002856 4110 4010            00010 20839  1 2698.                LA    RS,QRBWFP               END OF CHAIN ANCHOR
 00285A 5010 5004            00004 20840  1 2699.                ST    RS,QOEBP                 TO THIS ELEMENT
 00285E 5810 4010            00010 20841  1 2700.                L     RS,QRBWFP               FIRST ELEMENT IN CHAIN
 002862 5010 5000            00000 20842  1 2701.                ST    RS,QOEFP                 IS NOW SECOND
 002866 5050 1004            00004 20843  1 2702.                WITH  (QOE,RS),'ST  RK,QOEBP'    SECOND POINTS BACK
 DROP   QOE,R5
 USING  QOE,R1
 USING  QOE,R5
 DROP   QOE,R1
 00286A 5050 4010            00010 20884  1 2703.                ST    RK,QRBWFP               PUT THIS ONE AT HEAD
 00286E                            20885    2704.              END   ,
                                   20889    2705.     *
                                   20890    2706.     *  FORCE CALLER TO WAIT
                                   20891    2707.     *
 00286E 5810 400C            0000C 20892    2708.              L     RS,QRBQCB               QCB POINTER
 USING  QCB,R1                     20893    2709.              WITH  (QCB,RS),BEGIN
 USING  @LOCKS-72,R13              20907  1 2710.                LKREL QCBLOCK                 Release the QCB lock
 002872 D203 D048 100C 00000 0000C 20923  1          +
 002878 58F0 A782/0DEF       02F94 20926  1          +
 DROP   QCB,R1                     20928    2711.              END   ,
 00287E 58F0 A76E/0DEF       02F80 20936    2712.              VCALL ASULOCK                 Release address space lock
 DROP   @LOCKS-72,R13              20940    2713.              AWAIT QOEECB
 USING  @AWAIT-72,R13
 002884 D704 D048 D048 00000 00000 20961             +
 00288A 4100 5018            00018 20973             +
 00288E 5000 D048            00000 20978             +
 002892 58F0 A786/0DEF       02F98 20981             +
                                   20983    2714.     *
                                   20984    2715.     *  WAIT HAS ENDED DELETE SYSR
                                   20985    2716.     *
 002898 5800 5020            00020 20986    2717.              L     RVR,QOESYR              IF SYSR CREATED
 00289C 1200/4780 A09A       028AC 20987    2718.              IF    (RVR,NZ),BEGIN           DELETE IT
 DROP   @AWAIT-72,R13              21001  1 2719.                PSET  @SYSRDEL,CLEAR=NO
 USING  @SYSRDEL-72,R13
 0028A2 5000 D048            00000 21015  1 2720.                ST    RVR,@SYSRDID            SET SYSR ID
 0028A6 58F0 A78A/0DEF       02F9C 21016  1 2721.                VCALL SYSRDEL                 DELETE THE EXIT
 0028AC                            21020    2722.              END   ,
 0028AC 5800 501C            0001C 21024    2723.              L     RVR,QOEECB+4            COMPLETION CODE
 0028B0 981F C008            00008 21025    2724.              PEND
 DROP   QRB,R4
 DROP   QOE,R5
 DROP   @ENQWAIT-72,R12
 DROP   ENQWAIT,R10
 0028B4 9680 C000/0B0E 00000       21050             +
 DROP   @SYSRDEL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  142
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  21060    2726.     *******************************************************************
                                   21061    2727.     *                                                                 *
                                   21062    2728.     *   ENQPOST - Enqueue post routine                                *
                                   21063    2729.     *                                                                 *
                                   21064    2730.     *     Input - @ENQPOST                                            *
                                   21065    2731.     *             Queue lock held                                     *
                                   21066    2732.     *                                                                 *
                                   21067    2733.     *    Output - None                                                *
                                   21068    2734.     *                                                                 *
                                   21069    2735.     *******************************************************************
-
 0028BA                            21071    2737.     ENQPOST  PROC  @ENQPOST,SCOPE=LOCAL
 0028BA C5D5D8D7D6E2E340           21078             +
 0028C2 0010/0000                  21079             +
 0028C6 900F D004/18AF       00004 21081             +
 USING  ENQPOST,R10
 0028CC 50D0 C000/18CD       00000 21096             +
 0028D2 9680 C000      00000       21098             +
 USING  @ENQPOST-72,R12
 0028D6 41D0 C058            00058 21112             +
 0028DA 5840 C048            00000 21113    2738.              L     RJ,@EQPQRB              QRB POINTER
 USING  QRB,R4                     21114    2739.              WITH  (QRB,RJ)
 0028DE 4120 4010            00010 21127    2740.              LA    RA,QRBWFP               WAIT CHAIN
                                   21128    2741.     *
                                   21129    2742.     *  POST WAITER
                                   21130    2743.     *
 0028E2 5920 4010            00010 21131    2744.              WHILE (RA,NE,QRBWFP),BEGIN
 0028E6 4780 A0B2            02978 21145             +
 0028EA 5850 4010            00010 21150  1 2745.                L     RK,QRBWFP               GET FIRST WAITEE
 USING  QOE,R5                     21151  1 2746.                WITH  (QOE,RK)
                                   21164  1 2747.     *
                                   21165  1 2748.     *  PROCESSING ONLY SHARE WAITERS
                                   21166  1 2749.     *
 0028EE 9180 C050      00008       21167  1 2750.                IF    (@EQPFSHR,AND,~QOESHR),EXIT,ENQPOST    RETURN DONE
 0028F2 47E0 A038            028FE 21179  1          +
 0028F6 9180 5024      00024       21190  1          +
 0028FA 47E0 A0B2            02978 21193  1          +
                                   21199  1 2751.     *
                                   21200  1 2752.     *  REMOVE ELEMENT FROM WAIT CHAIN
                                   21201  1 2753.     *
 0028FE 98EF 5000            00000 21202  1 2754.                LM    R14,R15,QOEFP           FORWARD AND BACKWARD POINTERS
 002902 50F0 E004            00004 21203  1 2755.                WITH  (QOE,R14),'ST  R15,QOEBP'   NEXT POINTS TO PREV
 USING  QOE,R14
 DROP   QOE,R14
 002906 50E0 F000            00000 21227  1 2756.                WITH  (QOE,R15),'ST  R14,QOEFP'   PREV POINTS TO NEXT
 USING  QOE,R15
 DROP   QOE,R15
 00290A 94BF 5024      00024       21251  1 2757.                CLEAR QOEWAIT                 NO LONGER WAITING
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  143
0Current Usings:  (PZERO,R0) (QRB,R4) (QOE,R5) (ENQPOST,R10) (@ENQPOST-72,R12)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  21259  1 2759.     *
                                   21260  1 2760.     *  ADD ELEMENT TO END OF QRB OWNERSHIP CHAIN
                                   21261  1 2761.     *
 00290E 5810 C04C            00004 21262  1 2762.                L     RS,@EQPCODE             COMPLETION CODE
 002912 1211/4770 A06A       02930 21263  1 2763.                IF    (RS,Z),BEGIN
 002918 41E0 4044            00044 21277  2 2764.                  LA    R14,QRBOWNF             END OF CHAIN ANCHOR
 00291C 50E0 5000            00000 21278  2 2765.                  ST    R14,QOEFP                TO THIS ELEMENT
 002920 58E0 4048            00048 21279  2 2766.                  L     R14,QRBOWNB             LAST ELEMENT IN CHAIN
 002924 50E0 5004            00004 21280  2 2767.                  ST    R14,QOEBP                IS NOW PREVIOUS
 002928 5050 4048            00048 21281  2 2768.                  ST    RK,QRBOWNB              PUT THIS ONE AT END
 00292C 5050 E000            00000 21282  2 2769.                  WITH  (QOE,R14),'ST  RK,QOEFP'   (BEHIND PREVIOUS)
 USING  QOE,R14
 DROP   QOE,R14
 002930                            21306  1 2770.                END   ,
                                   21310  1 2771.     *
                                   21311  1 2772.     *  CREATE SYSTEM ROUTINE IF POSTEE IN ANOTHER ADDRESS SPACE
                                   21312  1 2773.     *
 002930 5810 0208            00208 21313  1 2774.                L     RS,PZCURASB             CURRENT ASB
 002934 5910 5010            00010 21314  1 2775.                IF    (RS,NE,QOEASB),BEGIN    POSTEE ANOTHER ASB
 002938 4780 A080            02946 21326  1          +
 00293C 58F0 A6DA/0DEF       02FA0 21331  2 2776.                  VCALL SYSRNEW
 002942 5000 5020            00020 21335  2 2777.                  ST    RVR,QOESYR              SYSR ID
 002946                            21336  1 2778.                END   ,
                                   21340  1 2779.     *
                                   21341  1 2780.     *  POST THE WAITEE
                                   21342  1 2781.     *
 USING  @SIGNAL-72,R13             21343  1 2782.                SIGNL QOEECB,@EQPCODE,QOEASB,QOESYR
 002946 D713 D048 D048 00000 00000 21361  1          +
 00294C 4100 5018            00018 21373  1          +
 002950 5000 D050            00008 21378  1          +
 002954 D203 D04C C04C 00004 00004 21383  1          +
 00295A D203 D054 5010 0000C 00010 21388  1          +
 002960 D203 D058 5020 00010 00020 21393  1          +
 002966 58F0 A6DE/0DEF       02FA4 21396  1          +
 00296C 91C0 C050      00008       21398  1 2783.                IF    (@EQPFALL+@EQPFSHR,Z),EXIT
 002970 4780 A0B2            02978 21415  1          +
 002974 47F0 A01C            028E2 21421    2784.              END   ,
 DROP   QOE,R5
 002978 981F C008            00008 21431    2785.              PEND
 DROP   QRB,R4
 DROP   @ENQPOST-72,R12
 DROP   ENQPOST,R10
 00297C 9680 C000/0B0E 00000       21451             +
 DROP   @SIGNAL-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  144
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  21461    2787.     *******************************************************************
                                   21462    2788.     *                                                                 *
                                   21463    2789.     *   FINDQCB - Enqueue QCB Search Service                          *
                                   21464    2790.     *                                                                 *
                                   21465    2791.     *     Input - @FINDQCB                                            *
                                   21466    2792.     *                                                                 *
                                   21467    2793.     *    Output - None                                                *
                                   21468    2794.     *                                                                 *
                                   21469    2795.     *******************************************************************
-
 002982                            21471    2797.     FINDQCB  PROC  @FINDQCB,SCOPE=LOCAL
 002982 C6C9D5C4D8C3C240           21478             +
 00298A 0008/0000                  21479             +
 00298E 900F D004/18AF       00004 21481             +
 USING  FINDQCB,R10
 002994 50D0 C000/18CD       00000 21496             +
 00299A 9680 C000      00000       21498             +
 USING  @FINDQCB-72,R12
 00299E 41D0 C050            00050 21512             +
                                   21513    2798.     *
                                   21514    2799.     *  Address the QCT and get the QCT lock
                                   21515    2800.     *
 0029A2 5870 0200            00200 21516    2801.              L     RY,PZMATP               MAT POINTER
 0029A6 5870 7018            00018 21517    2802.              WITH  (MAT,RY),'L  RY,MATQCT'  Get pointer
 USING  MAT,R7
 DROP   MAT,R7
 USING  QCT,R7                     21541    2803.              WITH  (QCT,RY)
 0029AA                            21554    2804.              IF    (QCT,NE,=CL4'QCT'),'ABORT QCT'
 0029AA D503 A61A 7000 02FA8 00000 21565             +
 0029B0 4780 A056            029E4 21566             +
 0029B4 AC04 021B      0021B       21575  1          +
 0029B8 9680 021A      0021A       21581  1          +
 0029BC 50F0 021C            0021C 21582  1          +
 0029C0 58F0 0210            00210 21583  1          +
 0029C4 89F0 0010            00010 21584  1          +
 0029C8 88F0 0010            00010 21585  1          +
 0029CC 41F0 F000            00000 21586  1          +
 0029D0 AEFF 0006            00006 21587  1          +
 0029D4 D8C3E34040404040           21588             +
 USING  @LOCKS-72,R13              21593    2805.              LKOB  QCTLOCK
 0029E4 D203 D048 7004 00000 00004 21609             +
 0029EA 58F0 A61E/0DEF       02FAC 21612             +
                                   21614    2806.     *
                                   21615    2807.     *  Search the Queue chain
                                   21616    2808.     *
 0029F0 4160 7008            00008 21617    2809.              LA    RX,QCTQCBS              QCB chain
 0029F4 4B60 A640            02FCE 21618    2810.              SH    RX,=Y(QCBNEXT-QCB)      Offset
 USING  QCB,R6                     21619    2811.              WITH  (QCB,RX)
 0029F8                            21632    2812.              LOOP  BEGIN
 0029F8 5860 6010            00010 21638  1 2813.                L     RX,QCBNEXT              Next in chain
                                   21639  1 2814.     *
                                   21640  1 2815.     *  Create a new QCB if necessary
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  145
0Current Usings:  (PZERO,R0) (QCB,R6) (QCT,R7) (FINDQCB,R10) (@FINDQCB-72,R12) (@LOCKS-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  21641  1 2816.     *
 0029FC 1266/4770 A152       02AE0 21642  1 2817.                IF    (RX,Z),BEGIN
 DROP   @LOCKS-72,R13              21656  2 2818.                  VMGET L'QCB,LOC=GLOBHI
 USING  @VMGET-72,R13
 002A02 D70A D048 D048 00000 00000 21683  2          +
 002A08 4100 06AC            006AC 21695  2          +
 002A0C 5000 D048            00000 21700  2          +
 002A10 D201 D050 A642 00008 02FD0 21701  2          +
 002A16 58F0 A5F6/0DEF       02F84 21704  2          +
 002A1C 1260/4770 A0C4       02A52 21706  2 2819.                  IF    ('LTR  RX,RVR',Z),'ABORT QCB'   No memory
 002A22 AC04 021B      0021B       21723  3          +
 002A26 9680 021A      0021A       21729  3          +
 002A2A 50F0 021C            0021C 21730  3          +
 002A2E 58F0 0210            00210 21731  3          +
 002A32 89F0 0010            00010 21732  3          +
 002A36 88F0 0010            00010 21733  3          +
 002A3A 41F0 F000            00000 21734  3          +
 002A3E AEFF 0006            00006 21735  3          +
 002A42 D8C3C24040404040           21736  2          +
 002A52 4110 06AC            006AC 21741  2 2820.                  LA    R1,L'QCB
 002A56 1BFF                       21742  2 2821.                  CLEAR R15
 002A58 0E0E                       21746  2 2822.                  MVCL  R0,R14
 002A5A D203 6000 A622 00000 02FB0 21747  2 2823.                  MVC   QCB(4),=CL4'QCB'
 002A60 D207 6004 C048 00004 00000 21748  2 2824.                  MVC   QCBNAME,@ENQCQNM        Queue name
 DROP   @VMGET-72,R13              21749  2 2825.                  PSET  @LOCKCRE
 USING  @LOCKCRE-72,R13
 002A66 D710 D048 D048 00000 00000 21769  2          +
 002A6C D207 D048 6004 00000 00004 21770  2 2826.                  MVC   @LOCKNAM(L'QCBNAME),QCBNAME
 002A72 58F0 A626/0DEF       02FB4 21771  2 2827.                  VCALL LKCRE
 002A78 1200/4770 A120       02AAE 21775  2 2828.                  IF    (RVR,Z),'ABORT QCBLOCK'
 002A7E AC04 021B      0021B       21793  3          +
 002A82 9680 021A      0021A       21799  3          +
 002A86 50F0 021C            0021C 21800  3          +
 002A8A 58F0 0210            00210 21801  3          +
 002A8E 89F0 0010            00010 21802  3          +
 002A92 88F0 0010            00010 21803  3          +
 002A96 41F0 F000            00000 21804  3          +
 002A9A AEFF 0006            00006 21805  3          +
 002A9E D8C3C2D3D6C3D240           21806  2          +
 002AAE 5000 600C            0000C 21811  2 2829.                  ST    RVR,QCBLOCK             SET LOCK
                                   21812  2 2830.     *
                                   21813  2 2831.     *  SET CHAIN HEAD AND TAIL POINTERS
                                   21814  2 2832.     *
 002AB2 4100 00D3            000D3 21815  2 2833.                  LA    RVR,QCBNQRB             NUMBER OF QRB CHAINS
 002AB6 4110 6014            00014 21816  2 2834.                  LA    RS,QCBQRBS              FIRST QRB POINTER SET
 002ABA 1200/47D0 A148       02AD6 21817  2 2835.                  WHILE (RVR,P),BEGIN
 002AC0 41F0 1000            00000 21833  3 2836.                    LA    R15,@RS                 CHAIN HEAD
 002AC4 50F0 1000            00000 21834  3 2837.                    ST    R15,@RS                 SET FORWARD POINTER
 002AC8 50F0 1004            00004 21835  3 2838.                    ST    R15,@RS+4                AND BACK POINTER
 002ACC 4110 1008            00008 21836  3 2839.                    LA    RS,@RS+8                NEXT CHAIN
 002AD0 0600                       21837  3 2840.                    DECR  RVR
 002AD2 47F0 A12C            02ABA 21839  2 2841.                  END   ,
                                   21844  2 2842.     *
                                   21845  2 2843.     *  Add QCB to the chain
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  146
0Current Usings:  (PZERO,R0) (QCB,R6) (QCT,R7) (FINDQCB,R10) (@FINDQCB-72,R12) (@LOCKCRE-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  21846  2 2844.     *
 002AD6 D203 6010 7008 00010 00008 21847  2 2845.                  MVC   QCBNEXT,QCTQCBS         Previous QCB
 002ADC 5060 7008            00008 21848  2 2846.                  ST    RX,QCTQCBS              Add this one to the chain
 002AE0                            21849  1 2847.                END   ,
                                   21853  1 2848.     *
                                   21854  1 2849.     *  EXIT IF QCB FOUND
                                   21855  1 2850.     *
 002AE0                            21856  1 2851.                IF    (QCBNAME,EQ,@ENQCQNM),EXIT     Found Queue element
 002AE0 D507 6004 C048 00004 00000 21867  1          +
 002AE6 4780 A160            02AEE 21870  1          +
 002AEA 47F0 A06A            029F8 21876    2852.              END   ,
                                   21881    2853.     *
                                   21882    2854.     *  QCB in hand, release QCT lock, get QCB lock
                                   21883    2855.     *
 DROP   @LOCKCRE-72,R13            21884    2856.              LKREL QCTLOCK
 USING  @LOCKS-72,R13
 002AEE D203 D048 7004 00000 00004 21903             +
 002AF4 58F0 A606/0DEF       02F94 21906             +
 002AFA 1806                       21908    2857.              LR    RVR,RX                  RETURN QCB POINTER
 002AFC 981F C008            00008 21909    2858.              PEND
 DROP   QCB,R6
 DROP   QCT,R7
 DROP   @FINDQCB-72,R12
 DROP   FINDQCB,R10
 002B00 9680 C000/0B0E 00000       21934             +
 DROP   @LOCKS-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  147
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  21944    2860.     *******************************************************************
                                   21945    2861.     *                                                                 *
                                   21946    2862.     *   GETQRB  - Obtain a Queue Resource Block                       *
                                   21947    2863.     *                                                                 *
                                   21948    2864.     *     Input - None                                                *
                                   21949    2865.     *                                                                 *
                                   21950    2866.     *    Output - QRB Pointer in RVR                                  *
                                   21951    2867.     *                                                                 *
                                   21952    2868.     *******************************************************************
-
 002B06                            21954    2870.     GETQRB   PROC  ,SCOPE=LOCAL
 002B06 C7C5E3D8D9C24040           21961             +
 002B0E 0000/0000                  21962             +
 002B12 900F D004/18AF       00004 21964             +
 USING  GETQRB,R10
 002B18 50D0 C000/18CD       00000 21979             +
 002B1E 9680 C000      00000       21981             +
 002B22 41D0 C048            00048 21982             +
                                   21983    2871.     *
                                   21984    2872.     *  Address the QCT
                                   21985    2873.     *
 002B26 5870 0200            00200 21986    2874.              L     RY,PZMATP               MAT POINTER
 002B2A 5870 7018            00018 21987    2875.              WITH  (MAT,RY),'L  RY,MATQCT'  Get pointer
 USING  MAT,R7
 DROP   MAT,R7
 USING  QCT,R7                     22011    2876.              WITH  (QCT,RY)
 002B2E                            22024    2877.              IF    (QCT,NE,=CL4'QCT'),'ABORT QCT'
 002B2E D503 A496 7000 02FA8 00000 22035             +
 002B34 4780 A056            02B68 22036             +
 002B38 AC04 021B      0021B       22045  1          +
 002B3C 9680 021A      0021A       22051  1          +
 002B40 50F0 021C            0021C 22052  1          +
 002B44 58F0 0210            00210 22053  1          +
 002B48 89F0 0010            00010 22054  1          +
 002B4C 88F0 0010            00010 22055  1          +
 002B50 41F0 F000            00000 22056  1          +
 002B54 AEFF 0006            00006 22057  1          +
 002B58 D8C3E34040404040           22058             +
                                   22063    2878.     *
                                   22064    2879.     * Try to get a QRB off the free queue
                                   22065    2880.     *
 002B68 9823 7010            00010 22066    2881.              LM    RA,RB,QCTQRBS           Get free queue info
 USING  QRB,R2                     22067    2882.              WITH  (QRB,RA)
 002B6C                            22080    2883.              LOOP  BEGIN
 002B6C 1222/4780 A070       02B82 22086  1 2884.                IF    (RA,Z),EXIT             No free ones left
 002B72 58E0 2000            00000 22103  1 2885.                L     R14,QRBFP               Get pointer to the next one
 002B76 41F0 3001            00001 22104  1 2886.                LA    R15,@RB+1               Set the control word
 002B7A BB2E 7010            00010 22105  1 2887.                CDS   RA,R14,QCTQRBS          Remove it from the queue
 002B7E 4770 A05A            02B6C 22106    2888.              UNTIL Z,END                   Keep on trying
                                   22125    2889.     *
                                   22126    2890.     * None available, create a new one
                                   22127    2891.     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  148
0Current Usings:  (PZERO,R0) (QRB,R2) (QCT,R7) (GETQRB,R10)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002B82 1222/4770 A0C6       02BD8 22128    2892.              IF    (RA,Z),BEGIN
 USING  @VMGET-72,R13              22142  1 2893.                VMGET L'QRB,LOC=GLOBHI,SP=02
 002B88 D70A D048 D048 00000 00000 22166  1          +
 002B8E 4100 004C            0004C 22178  1          +
 002B92 5000 D048            00000 22183  1          +
 002B96 D201 D050 A4C0 00008 02FD2 22184  1          +
 002B9C 58F0 A472/0DEF       02F84 22187  1          +
 002BA2 1220/4770 A0C6       02BD8 22189  1 2894.                IF    ('LTR  RA,RVR',Z),'ABORT QRBMEM'   No memory
 002BA8 AC04 021B      0021B       22206  2          +
 002BAC 9680 021A      0021A       22212  2          +
 002BB0 50F0 021C            0021C 22213  2          +
 002BB4 58F0 0210            00210 22214  2          +
 002BB8 89F0 0010            00010 22215  2          +
 002BBC 88F0 0010            00010 22216  2          +
 002BC0 41F0 F000            00000 22217  2          +
 002BC4 AEFF 0006            00006 22218  2          +
 002BC8 D8D9C2D4C5D44040           22219  1          +
 002BD8                            22224    2895.              END   ,
                                   22228    2896.     *
                                   22229    2897.     *  Initialize the QRB
                                   22230    2898.     *
 002BD8                            22231    2899.              CLEAR QRB
 002BD8 D74B 2000 2000 00000 00000 22237             +
 002BDE D203 2008 A4A6 00008 02FB8 22238    2900.              MVC   QRBID,=CL4'QRB'         Set ID
 002BE4 4110 2010            00010 22239    2901.              LA    RS,QRBWFP               QRB wait pointers
 002BE8 5010 2010            00010 22240    2902.              ST    RS,QRBWFP               Set forward
 002BEC 5010 2014            00014 22241    2903.              ST    RS,QRBWBP                and back pointers
 002BF0 1802                       22242    2904.              LR    RVR,RA                  Return the QRB address
 002BF2 981F C008            00008 22243    2905.              PEND
 DROP   QRB,R2
 DROP   QCT,R7
 DROP   GETQRB,R10
 002BF6 9680 C000/0B0E 00000       22263             +
 DROP   @VMGET-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  149
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  22273    2907.     *******************************************************************
                                   22274    2908.     *                                                                 *
                                   22275    2909.     *   FREEQRB - Return a QRB to the available pool                  *
                                   22276    2910.     *                                                                 *
                                   22277    2911.     *     Input - @FREEQRB                                            *
                                   22278    2912.     *                                                                 *
                                   22279    2913.     *    Output - None                                                *
                                   22280    2914.     *                                                                 *
                                   22281    2915.     *******************************************************************
-
 002BFC                            22283    2917.     FREEQRB  PROC  @FREEQRB,SCOPE=LOCAL
 002BFC C6D9C5C5D8D9C240           22290             +
 002C04 0008/0000                  22291             +
 002C08 900F D004/18AF       00004 22293             +
 USING  FREEQRB,R10
 002C0E 50D0 C000/18CD       00000 22308             +
 002C14 9680 C000      00000       22310             +
 USING  @FREEQRB-72,R12
 002C18 41D0 C050            00050 22324             +
                                   22325    2918.     *
                                   22326    2919.     *  Address the QCT
                                   22327    2920.     *
 002C1C 5870 0200            00200 22328    2921.              L     RY,PZMATP               MAT POINTER
 002C20 5870 7018            00018 22329    2922.              WITH  (MAT,RY),'L  RY,MATQCT'  Get pointer
 USING  MAT,R7
 DROP   MAT,R7
 USING  QCT,R7                     22353    2923.              WITH  (QCT,RY)
 002C24                            22366    2924.              IF    (QCT,NE,=CL4'QCT'),'ABORT QCT'
 002C24 D503 A3A0 7000 02FA8 00000 22377             +
 002C2A 4780 A056            02C5E 22378             +
 002C2E AC04 021B      0021B       22387  1          +
 002C32 9680 021A      0021A       22393  1          +
 002C36 50F0 021C            0021C 22394  1          +
 002C3A 58F0 0210            00210 22395  1          +
 002C3E 89F0 0010            00010 22396  1          +
 002C42 88F0 0010            00010 22397  1          +
 002C46 41F0 F000            00000 22398  1          +
 002C4A AEFF 0006            00006 22399  1          +
 002C4E D8C3E34040404040           22400             +
                                   22405    2925.     *
                                   22406    2926.     *  Add the QRB to the free chain
                                   22407    2927.     *
 002C5E 5820 C048            00000 22408    2928.              L     RA,@FRQRBP              Address of QRB to free
 USING  QRB,R2                     22409    2929.              WITH  (QRB,RA)
 002C62 D203 2008 A3B4 00008 02FBC 22422    2930.              MVC   QRBID,=CL4'qrb'         Set ID
 002C68 98EF 7010            00010 22423    2931.              LM    R14,R15,QCTQRBS         Get current top, control
 002C6C                            22424    2932.              LOOP  BEGIN
 002C6C 50E0 2000            00000 22430  1 2933.                ST    R14,QRBFP               Make ours point at theirs
 002C70 4130 F001            00001 22431  1 2934.                LA    RB,@R15+1               Copy and update the control
 002C74 BBE2 7010            00010 22432  1 2935.                CDS   R14,RA,QCTQRBS          Update the values
 002C78 4770 A064            02C6C 22433    2936.              UNTIL Z,END
 002C7C 981F C008            00008 22452    2937.              PEND
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  150
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0DROP   QRB,R2
 DROP   QCT,R7
 DROP   @FREEQRB-72,R12
 DROP   FREEQRB,R10
 002C80 9680 C000/0B0E 00000       22477             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  151
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  22484    2939.     *******************************************************************
                                   22485    2940.     *                                                                 *
                                   22486    2941.     *   GETQOE  - Obtain a Queue Ownership Element                    *
                                   22487    2942.     *                                                                 *
                                   22488    2943.     *     Input - None                                                *
                                   22489    2944.     *                                                                 *
                                   22490    2945.     *    Output - QOE Pointer in RVR                                  *
                                   22491    2946.     *                                                                 *
                                   22492    2947.     *******************************************************************
-
 002C86                            22494    2949.     GETQOE   PROC  ,SCOPE=LOCAL
 002C86 C7C5E3D8D6C54040           22501             +
 002C8E 0000/0000                  22502             +
 002C92 900F D004/18AF       00004 22504             +
 USING  GETQOE,R10
 002C98 50D0 C000/18CD       00000 22519             +
 002C9E 9680 C000      00000       22521             +
 002CA2 41D0 C048            00048 22522             +
                                   22523    2950.     *
                                   22524    2951.     *  Address the QCT
                                   22525    2952.     *
 002CA6 5870 0200            00200 22526    2953.              L     RY,PZMATP               MAT POINTER
 002CAA 5870 7018            00018 22527    2954.              WITH  (MAT,RY),'L  RY,MATQCT'  Get pointer
 USING  MAT,R7
 DROP   MAT,R7
 USING  QCT,R7                     22551    2955.              WITH  (QCT,RY)
 002CAE                            22564    2956.              IF    (QCT,NE,=CL4'QCT'),'ABORT QCT'
 002CAE D503 A316 7000 02FA8 00000 22575             +
 002CB4 4780 A056            02CE8 22576             +
 002CB8 AC04 021B      0021B       22585  1          +
 002CBC 9680 021A      0021A       22591  1          +
 002CC0 50F0 021C            0021C 22592  1          +
 002CC4 58F0 0210            00210 22593  1          +
 002CC8 89F0 0010            00010 22594  1          +
 002CCC 88F0 0010            00010 22595  1          +
 002CD0 41F0 F000            00000 22596  1          +
 002CD4 AEFF 0006            00006 22597  1          +
 002CD8 D8C3E34040404040           22598             +
                                   22603    2957.     *
                                   22604    2958.     * Try to get a QOE off the free queue
                                   22605    2959.     *
 002CE8 9823 7018            00018 22606    2960.              LM    RA,RB,QCTQOES           Get free queue info
 USING  QOE,R2                     22607    2961.              WITH  (QOE,RA)
 002CEC                            22620    2962.              LOOP  BEGIN
 002CEC 1222/4780 A070       02D02 22626  1 2963.                IF    (RA,Z),EXIT             No free ones left
 002CF2 58E0 2000            00000 22643  1 2964.                L     R14,QOEFP               Get pointer to the next one
 002CF6 41F0 3001            00001 22644  1 2965.                LA    R15,@RB+1               Set the control word
 002CFA BB2E 7018            00018 22645  1 2966.                CDS   RA,R14,QCTQOES          Remove it from the queue
 002CFE 4770 A05A            02CEC 22646    2967.              UNTIL Z,END                   Keep on trying
                                   22665    2968.     *
                                   22666    2969.     * None available, create a new one
                                   22667    2970.     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  152
0Current Usings:  (PZERO,R0) (QOE,R2) (QCT,R7) (GETQOE,R10)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002D02 1222/4770 A0C6       02D58 22668    2971.              IF    (RA,Z),BEGIN
 USING  @VMGET-72,R13              22682  1 2972.                VMGET L'QOE,LOC=GLOBHI,SP=02
 002D08 D70A D048 D048 00000 00000 22706  1          +
 002D0E 4100 0025            00025 22718  1          +
 002D12 5000 D048            00000 22723  1          +
 002D16 D201 D050 A340 00008 02FD2 22724  1          +
 002D1C 58F0 A2F2/0DEF       02F84 22727  1          +
 002D22 1220/4770 A0C6       02D58 22729  1 2973.                IF    ('LTR  RA,RVR',Z),'ABORT QOEMEM'   No memory
 002D28 AC04 021B      0021B       22746  2          +
 002D2C 9680 021A      0021A       22752  2          +
 002D30 50F0 021C            0021C 22753  2          +
 002D34 58F0 0210            00210 22754  2          +
 002D38 89F0 0010            00010 22755  2          +
 002D3C 88F0 0010            00010 22756  2          +
 002D40 41F0 F000            00000 22757  2          +
 002D44 AEFF 0006            00006 22758  2          +
 002D48 D8D6C5D4C5D44040           22759  1          +
 002D58                            22764    2974.              END   ,
                                   22768    2975.     *
                                   22769    2976.     *  Initialize the QOE
                                   22770    2977.     *
 002D58                            22771    2978.              CLEAR QOE
 002D58 D724 2000 2000 00000 00000 22777             +
 002D5E D203 2008 A32E 00008 02FC0 22778    2979.              MVC   QOEID,=CL4'QOE'         Set ID
 002D64 D207 2010 0208 00010 00208 22779    2980.              MVC   QOEPID,PZCURPID         PROCESS ID
 002D6A 1802                       22780    2981.              LR    RVR,RA                  Return the QOE address
 002D6C 981F C008            00008 22781    2982.              PEND
 DROP   QOE,R2
 DROP   QCT,R7
 DROP   GETQOE,R10
 002D70 9680 C000/0B0E 00000       22801             +
 DROP   @VMGET-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  153
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  22811    2984.     *******************************************************************
                                   22812    2985.     *                                                                 *
                                   22813    2986.     *   FREEQOE - Return a QOE to the available pool                  *
                                   22814    2987.     *                                                                 *
                                   22815    2988.     *     Input - @FREEQOE                                            *
                                   22816    2989.     *                                                                 *
                                   22817    2990.     *    Output - None                                                *
                                   22818    2991.     *                                                                 *
                                   22819    2992.     *******************************************************************
-
 002D76                            22821    2994.     FREEQOE  PROC  @FREEQOE,SCOPE=LOCAL
 002D76 C6D9C5C5D8D6C540           22828             +
 002D7E 0008/0000                  22829             +
 002D82 900F D004/18AF       00004 22831             +
 USING  FREEQOE,R10
 002D88 50D0 C000/18CD       00000 22846             +
 002D8E 9680 C000      00000       22848             +
 USING  @FREEQOE-72,R12
 002D92 41D0 C050            00050 22862             +
                                   22863    2995.     *
                                   22864    2996.     *  Address the QCT
                                   22865    2997.     *
 002D96 5870 0200            00200 22866    2998.              L     RY,PZMATP               MAT POINTER
 002D9A 5870 7018            00018 22867    2999.              WITH  (MAT,RY),'L  RY,MATQCT'  Get pointer
 USING  MAT,R7
 DROP   MAT,R7
 USING  QCT,R7                     22891    3000.              WITH  (QCT,RY)
 002D9E                            22904    3001.              IF    (QCT,NE,=CL4'QCT'),'ABORT QCT'
 002D9E D503 A226 7000 02FA8 00000 22915             +
 002DA4 4780 A056            02DD8 22916             +
 002DA8 AC04 021B      0021B       22925  1          +
 002DAC 9680 021A      0021A       22931  1          +
 002DB0 50F0 021C            0021C 22932  1          +
 002DB4 58F0 0210            00210 22933  1          +
 002DB8 89F0 0010            00010 22934  1          +
 002DBC 88F0 0010            00010 22935  1          +
 002DC0 41F0 F000            00000 22936  1          +
 002DC4 AEFF 0006            00006 22937  1          +
 002DC8 D8C3E34040404040           22938             +
                                   22943    3002.     *
                                   22944    3003.     *  Add the QOE to the free chain
                                   22945    3004.     *
 002DD8 5820 C048            00000 22946    3005.              L     RA,@FRQOEP              Address of QOE to free
 USING  QOE,R2                     22947    3006.              WITH  (QOE,RA)
 002DDC D203 2008 A242 00008 02FC4 22960    3007.              MVC   QOEID,=CL4'qoe'         Set ID
 002DE2 98EF 7018            00018 22961    3008.              LM    R14,R15,QCTQOES         Get current top, control
 002DE6                            22962    3009.              LOOP  BEGIN
 002DE6 50E0 2000            00000 22968  1 3010.                ST    R14,QOEFP               Make ours point at theirs
 002DEA 4130 F001            00001 22969  1 3011.                LA    RB,@R15+1               Copy and update the control
 002DEE BBE2 7018            00018 22970  1 3012.                CDS   R14,RA,QCTQOES          Update the values
 002DF2 4770 A064            02DE6 22971    3013.              UNTIL Z,END
 002DF6 981F C008            00008 22990    3014.              PEND
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  154
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0DROP   QOE,R2
 DROP   QCT,R7
 DROP   @FREEQOE-72,R12
 DROP   FREEQOE,R10
 002DFA 9680 C000/0B0E 00000       23015             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  155
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  23022    3016.     *******************************************************************
                                   23023    3017.     *                                                                 *
                                   23024    3018.     *   GETQAO  - Obtain a Queue Address space Ownership element      *
                                   23025    3019.     *                                                                 *
                                   23026    3020.     *     Input - None                                                *
                                   23027    3021.     *                                                                 *
                                   23028    3022.     *    Output - QAO Pointer in RVR                                  *
                                   23029    3023.     *                                                                 *
                                   23030    3024.     *******************************************************************
-
 002E00                            23032    3026.     GETQAO   PROC  ,SCOPE=LOCAL
 002E00 C7C5E3D8C1D64040           23039             +
 002E08 0000/0000                  23040             +
 002E0C 900F D004/18AF       00004 23042             +
 USING  GETQAO,R10
 002E12 50D0 C000/18CD       00000 23057             +
 002E18 9680 C000      00000       23059             +
 002E1C 41D0 C048            00048 23060             +
                                   23061    3027.     *
                                   23062    3028.     *  Address the QAS
                                   23063    3029.     *
 002E20 5860 0208            00208 23064    3030.              L     RX,PZCURASB             ASB POINTER
 002E24 5860 6028            00028 23065    3031.              WITH  (ASB,RX),'L  RX,ASBENQ'   Address space Enqueue table
 USING  ASB,R6
 DROP   ASB,R6
 USING  QAS,R6                     23089    3032.              WITH  (QAS,RX)
 002E28                            23102    3033.              IF    (QAS,NE,=CL4'QAS'),'ABORT QAS'
 002E28 D503 A17C 6000 02F88 00000 23113             +
 002E2E 4780 A056            02E62 23114             +
 002E32 AC04 021B      0021B       23123  1          +
 002E36 9680 021A      0021A       23129  1          +
 002E3A 50F0 021C            0021C 23130  1          +
 002E3E 58F0 0210            00210 23131  1          +
 002E42 89F0 0010            00010 23132  1          +
 002E46 88F0 0010            00010 23133  1          +
 002E4A 41F0 F000            00000 23134  1          +
 002E4E AEFF 0006            00006 23135  1          +
 002E52 D8C1E24040404040           23136             +
                                   23141    3034.     *
                                   23142    3035.     * Try to get a QAO off the free queue
                                   23143    3036.     *
 002E62 9823 6008            00008 23144    3037.              LM    RA,RB,QASFQAO           Get free queue info
 USING  QAO,R2                     23145    3038.              WITH  (QAO,RA)
 002E66                            23158    3039.              LOOP  BEGIN
 002E66 1222/4780 A070       02E7C 23164  1 3040.                IF    (RA,Z),EXIT             No free ones left
 002E6C 58E0 2004            00004 23181  1 3041.                L     R14,QAOCHN              Get pointer to the next one
 002E70 41F0 3001            00001 23182  1 3042.                LA    R15,@RB+1               Set the control word
 002E74 BB2E 6008            00008 23183  1 3043.                CDS   RA,R14,QASFQAO          Remove it from the queue
 002E78 4770 A05A            02E66 23184    3044.              UNTIL Z,END                   Keep on trying
                                   23203    3045.     *
                                   23204    3046.     * None available, create a new one
                                   23205    3047.     *
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  156
0Current Usings:  (PZERO,R0) (QAO,R2) (QAS,R6) (GETQAO,R10)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002E7C 1222/4770 A0C6       02ED2 23206    3048.              IF    (RA,Z),BEGIN
 USING  @VMGET-72,R13              23220  1 3049.                VMGET L'QAO,LOC=LOCSYS
 002E82 D70A D048 D048 00000 00000 23244  1          +
 002E88 4100 0041            00041 23256  1          +
 002E8C 5000 D048            00000 23261  1          +
 002E90 D201 D050 A1C0 00008 02FCC 23262  1          +
 002E96 58F0 A178/0DEF       02F84 23265  1          +
 002E9C 1220/4770 A0C6       02ED2 23267  1 3050.                IF    ('LTR  RA,RVR',Z),'ABORT QAOMEM'   No memory
 002EA2 AC04 021B      0021B       23284  2          +
 002EA6 9680 021A      0021A       23290  2          +
 002EAA 50F0 021C            0021C 23291  2          +
 002EAE 58F0 0210            00210 23292  2          +
 002EB2 89F0 0010            00010 23293  2          +
 002EB6 88F0 0010            00010 23294  2          +
 002EBA 41F0 F000            00000 23295  2          +
 002EBE AEFF 0006            00006 23296  2          +
 002EC2 D8C1D6D4C5D44040           23297  1          +
 002ED2                            23302    3051.              END   ,
                                   23306    3052.     *
                                   23307    3053.     *  Initialize the QAO
                                   23308    3054.     *
 002ED2                            23309    3055.              CLEAR QAO
 002ED2 D740 2000 2000 00000 00000 23315             +
 002ED8 D203 2000 A180 00000 02F8C 23316    3056.              MVC   QAOID,=CL4'QAO'         Set ID
 002EDE 1802                       23317    3057.              LR    RVR,RA                  Return the QAO address
 002EE0 981F C008            00008 23318    3058.              PEND
 DROP   QAO,R2
 DROP   QAS,R6
 DROP   GETQAO,R10
 002EE4 9680 C000/0B0E 00000       23338             +
 DROP   @VMGET-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  157
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  23348    3060.     *******************************************************************
                                   23349    3061.     *                                                                 *
                                   23350    3062.     *   FREEQAO - Return a QAO to the available pool                  *
                                   23351    3063.     *                                                                 *
                                   23352    3064.     *     Input - @FREEQAO                                            *
                                   23353    3065.     *                                                                 *
                                   23354    3066.     *    Output - None                                                *
                                   23355    3067.     *                                                                 *
                                   23356    3068.     *******************************************************************
-
 002EEA                            23358    3070.     FREEQAO  PROC  @FREEQAO,SCOPE=LOCAL
 002EEA C6D9C5C5D8C1D640           23365             +
 002EF2 0008/0000                  23366             +
 002EF6 900F D004/18AF       00004 23368             +
 USING  FREEQAO,R10
 002EFC 50D0 C000/18CD       00000 23383             +
 002F02 9680 C000      00000       23385             +
 USING  @FREEQAO-72,R12
 002F06 41D0 C050            00050 23399             +
                                   23400    3071.     *
                                   23401    3072.     *  Address the QAS
                                   23402    3073.     *
 002F0A 5860 0208            00208 23403    3074.              L     RX,PZCURASB             ASB POINTER
 002F0E 5860 6028            00028 23404    3075.              WITH  (ASB,RX),'L  RX,ASBENQ'   Address space Enqueue table
 USING  ASB,R6
 DROP   ASB,R6
 USING  QAS,R6                     23428    3076.              WITH  (QAS,RX)
 002F12                            23441    3077.              IF    (QAS,NE,=CL4'QAS'),'ABORT QAS'
 002F12 D503 A092 6000 02F88 00000 23452             +
 002F18 4780 A056            02F4C 23453             +
 002F1C AC04 021B      0021B       23462  1          +
 002F20 9680 021A      0021A       23468  1          +
 002F24 50F0 021C            0021C 23469  1          +
 002F28 58F0 0210            00210 23470  1          +
 002F2C 89F0 0010            00010 23471  1          +
 002F30 88F0 0010            00010 23472  1          +
 002F34 41F0 F000            00000 23473  1          +
 002F38 AEFF 0006            00006 23474  1          +
 002F3C D8C1E24040404040           23475             +
                                   23480    3078.     *
                                   23481    3079.     *  Add the QAO to the free chain
                                   23482    3080.     *
 002F4C 5820 C048            00000 23483    3081.              L     RA,@FRQAOP              Address of QAO to free
 USING  QAO,R2                     23484    3082.              WITH  (QAO,RA)
 002F50 D203 2000 A0D2 00000 02FC8 23497    3083.              MVC   QAOID,=CL4'qao'         Set ID
 002F56 98EF 6008            00008 23498    3084.              LM    R14,R15,QASFQAO         Get current top, control
 002F5A                            23499    3085.              LOOP  BEGIN
 002F5A 50E0 2004            00004 23505  1 3086.                ST    R14,QAOCHN              Make ours point at theirs
 002F5E 4130 F001            00001 23506  1 3087.                LA    RB,@R15+1               Copy and update the control
 002F62 BBE2 6008            00008 23507  1 3088.                CDS   R14,RA,QASFQAO          Update the values
 002F66 4770 A064            02F5A 23508    3089.              UNTIL Z,END
 002F6A 981F C008            00008 23527    3090.              PEND
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  158
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0DROP   QAO,R2
 DROP   QAS,R6
 DROP   @FREEQAO-72,R12
 DROP   FREEQAO,R10
 002F6E 9680 C000/0B0E 00000       23552             +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  159
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0002F78                            23559    3092.              LTORG
 002F78 00000000                   23561                             =V(ASLOCK)
 002F7C 00001F08                   23562                             =A(DEQUEUE)
 002F80 00000000                   23563                             =V(ASULOCK)
 002F84 00000000                   23564                             =V(VMGET)
 002F88 D8C1E240                   23565                             =CL4'QAS'
 002F8C D8C1D640                   23566                             =CL4'QAO'
 002F90 80000000                   23567                             =X'80000000'
 002F94 00000000                   23568                             =V(LKREL)
 002F98 00000000                   23569                             =V(AWAIT)
 002F9C 00000000                   23570                             =V(SYSRDEL)
 002FA0 00000000                   23571                             =V(SYSRNEW)
 002FA4 00000000                   23572                             =V(SIGNAL)
 002FA8 D8C3E340                   23573                             =CL4'QCT'
 002FAC 00000000                   23574                             =V(LKOB)
 002FB0 D8C3C240                   23575                             =CL4'QCB'
 002FB4 00000000                   23576                             =V(LKCRE)
 002FB8 D8D9C240                   23577                             =CL4'QRB'
 002FBC 98998240                   23578                             =CL4'qrb'
 002FC0 D8D6C540                   23579                             =CL4'QOE'
 002FC4 98968540                   23580                             =CL4'qoe'
 002FC8 98819640                   23581                             =CL4'qao'
 002FCC 1B00                       23582                             =Y(27*256+0)
 002FCE 0010                       23583                             =Y(QCBNEXT-QCB)
 002FD0 3B00                       23584                             =Y(59*256+0)
 002FD2 3B02           02FD4 03638 23585                             =Y(59*256+2)
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  160
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  23590    3094.     *******************************************************************
                                   23591    3095.     *                                                                 *
                                   23592    3096.     *   ENQDUMP  - Enqueue Services Global Dump Processing            *
                                   23593    3097.     *                                                                 *
                                   23594    3098.     *     Input -                                                     *
                                   23595    3099.     *                                                                 *
                                   23596    3100.     *    Output - None                                                *
                                   23597    3101.     *                                                                 *
                                   23598    3102.     *******************************************************************
-
 002FD4                            23600    3104.     ENQDUMP  PROC  ,ENQDWORK,SCOPE=GLOBAL
 002FD4 C5D5D8C4E4D4D740           23606             +
 002FDC 0000/0008                  23607             +
 002FE0 900F D004/18AF       00004 23609             +
 USING  ENQDUMP,R10
 002FE6 50D0 C000/18CD       00000 23624             +
 002FEC 9680 C000      00000       23626             +
 USING  ENQDWORK-72,R12
 002FF0 41D0 C050            00050 23640             +
                                   23641    3105.     *
                                   23642    3106.     *  Address the QCT
                                   23643    3107.     *
 002FF4 5870 0200            00200 23644    3108.              L     RY,PZMATP               MAT POINTER
 002FF8 5870 7018            00018 23645    3109.              WITH  (MAT,RY),'L  RY,MATQCT'  Get pointer
 USING  MAT,R7
 DROP   MAT,R7
 USING  QCT,R7                     23669    3110.              WITH  (QCT,RY)
 USING  @SEG-72,R13                23682    3111.              SEGEOR '*** ENQUEUE Service ***',,EQDUMPCB
 002FFC D70C D048 D048 00000 00000 23701             +
 003002 4100 A600            035E0 23710             +
 003006 5000 D04C            00004 23715             +
 00300A 4100 0017            00017 23727             +
 00300E 5000 D050            00008 23732             +
 003012 D203 D048 C048 00000 00000 23739             +
 003018 9610 D054      0000C       23745             +
 00301C 58F0 A5C8/0DEF       035A8 23748             +
 003022                            23750    3112.              SEGEOR ,
 003022 D70C D048 D048 00000 00000 23762             +
 003028 D703 D050 D050 00008 00008 23770             +
 00302E D203 D048 C048 00000 00000 23777             +
 003034 9610 D054      0000C       23783             +
 003038 58F0 A5C8/0DEF       035A8 23786             +
 00303E 1277/4770 A08E       0306E 23788    3113.              IF    (RY,Z),BEGIN
 003044                            23802  1 3114.                SEGEOR '  *** Not initialized ***'
 003044 D70C D048 D048 00000 00000 23814  1          +
 00304A 4100 A617            035F7 23823  1          +
 00304E 5000 D04C            00004 23828  1          +
 003052 4100 0019            00019 23840  1          +
 003056 5000 D050            00008 23845  1          +
 00305A D203 D048 C048 00000 00000 23852  1          +
 003060 9610 D054      0000C       23858  1          +
 003064 58F0 A5C8/0DEF       035A8 23861  1          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  161
0Current Usings:  (PZERO,R0) (QCT,R7) (ENQDUMP,R10) (ENQDWORK-72,R12) (@SEG-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000306A 47F0 A41E            033FE 23863  1 3115.                EXIT  ENQDUMP
 00306E                            23866    3116.              END   ,
                                   23870    3117.     *
                                   23871    3118.     *  QCB CHAIN
                                   23872    3119.     *
 00306E 5860 7008            00008 23873    3120.              L     RX,QCTQCBS
 USING  QCB,R6                     23874    3121.              WITH  (QCB,RX)
 003072 1266/4780 A402       033E2 23887    3122.              WHILE (RX,NZ),BEGIN
                                   23903  1 3123.     *
                                   23904  1 3124.     *  QRB CHAINS
                                   23905  1 3125.     *
 003078 4130 00D3            000D3 23906  1 3126.                LA    RB,QCBNQRB              NUMBER OF CHAINS
 00307C 4120 6014            00014 23907  1 3127.                LA    RA,QCBQRBS              FIRST CHAIN
 003080 1211/47D0 A3FA       033DA 23908  1 3128.                WHILE (RS,P),BEGIN
 003086 5850 2000            00000 23924  2 3129.                  L     RK,@RA
 00308A 1952/4780 A3F0       033D0 23925  2 3130.                  WHILE (RK,NE,RA),BEGIN
 USING  QRB,R5                     23942  3 3131.                    WITH  (QRB,RK)
                                   23955  3 3132.     *
                                   23956  3 3133.     *  PRINT RESOURCE INFO
                                   23957  3 3134.     *
 003090                            23958  3 3135.                    SEGB  QCBNAME                 QUEUE NAME
 003090 D70C D048 D048 00000 00000 23970  3          +
 003096 4100 6004            00004 23983  3          +
 00309A 5000 D04C            00004 23988  3          +
 00309E 4100 0008            00008 24000  3          +
 0030A2 5000 D050            00008 24005  3          +
 0030A6 D203 D048 C048 00000 00000 24012  3          +
 0030AC 9680 D054      0000C       24018  3          +
 0030B0 58F0 A5C8/0DEF       035A8 24021  3          +
 0030B6                            24023  3 3136.                    SEGEOR QRBNAME                RESOURCE NAME
 0030B6 D70C D048 D048 00000 00000 24035  3          +
 0030BC 4100 5018            00018 24048  3          +
 0030C0 5000 D04C            00004 24053  3          +
 0030C4 4100 002C            0002C 24065  3          +
 0030C8 5000 D050            00008 24070  3          +
 0030CC D203 D048 C048 00000 00000 24077  3          +
 0030D2 9610 D054      0000C       24083  3          +
 0030D6 58F0 A5C8/0DEF       035A8 24086  3          +
 DROP   @SEG-72,R13                24088  3 3137.                    SEGCOL 5
 USING  @SEGCOL-72,R13
 0030DC D707 D048 D048 00000 00000 24109  3          +
 0030E2 4100 0005            00005 24121  3          +
 0030E6 5000 D04C            00004 24126  3          +
 0030EA D203 D048 C048 00000 00000 24133  3          +
 0030F0 58F0 A5CC/0DEF       035AC 24136  3          +
 0030F6 5840 5044            00044 24138  3 3138.                    L     RJ,QRBOWNF              OWNERSHIP ELEMENT
 USING  QOE,R4                     24139  3 3139.                    WITH  (QOE,RJ)
 0030FA 9180 4024      00024       24152  3 3140.                    IF    QOESHR,BEGIN
 0030FE 47E0 A1F2            031D2 24162  3          +
 DROP   @SEGCOL-72,R13             24167  4 3141.                      SEG   'SHARING PIDS: '          SHARED
 USING  @SEG-72,R13
 003102 D70C D048 D048 00000 00000 24188  4          +
 003108 4100 A5E4            035C4 24197  4          +
 00310C 5000 D04C            00004 24202  4          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  162
0Current Usings:  (PZERO,R0) (QOE,R4) (QRB,R5) (QCB,R6) (QCT,R7) (ENQDUMP,R10) (ENQDWORK-72,R12) (@SEG-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0003110 4100 000E            0000E 24214  4          +
 003114 5000 D050            00008 24219  4          +
 003118 D203 D048 C048 00000 00000 24226  4          +
 00311E 58F0 A5C8/0DEF       035A8 24229  4          +
 003124 4110 5044            00044 24231  4 3142.                      LA    RS,QRBOWNF
 003128 1941/4780 A1F2       031D2 24232  4 3143.                      WHILE (RJ,NE,RS),BEGIN
 DROP   @SEG-72,R13                24249  5 3144.                        SEGCOL 19
 USING  @SEGCOL-72,R13
 00312E D707 D048 D048 00000 00000 24270  5          +
 003134 4100 0013            00013 24282  5          +
 003138 5000 D04C            00004 24287  5          +
 00313C D203 D048 C048 00000 00000 24294  5          +
 003142 58F0 A5CC/0DEF       035AC 24297  5          +
 DROP   @SEGCOL-72,R13             24299  5 3145.                        SEGHEX QOEPID,4
 USING  @SEG-72,R13
 003148 D70C D048 D048 00000 00000 24320  5          +
 00314E 4100 4010            00010 24333  5          +
 003152 5000 D04C            00004 24338  5          +
 003156 4100 0004            00004 24350  5          +
 00315A 5000 D050            00008 24355  5          +
 00315E D203 D048 C048 00000 00000 24362  5          +
 003164 58F0 A5D0/0DEF       035B0 24365  5          +
 00316A                            24367  5 3146.                        SEG   ' '
 00316A D70C D048 D048 00000 00000 24378  5          +
 003170 4100 A630            03610 24387  5          +
 003174 5000 D04C            00004 24392  5          +
 003178 4100 0001            00001 24404  5          +
 00317C 5000 D050            00008 24409  5          +
 003180 D203 D048 C048 00000 00000 24416  5          +
 003186 58F0 A5C8/0DEF       035A8 24419  5          +
 00318C                            24421  5 3147.                        SEGHEX QOEPID+4,4
 00318C D70C D048 D048 00000 00000 24432  5          +
 003192 4100 4014            00014 24445  5          +
 003196 5000 D04C            00004 24450  5          +
 00319A 4100 0004            00004 24462  5          +
 00319E 5000 D050            00008 24467  5          +
 0031A2 D203 D048 C048 00000 00000 24474  5          +
 0031A8 58F0 A5D0/0DEF       035B0 24477  5          +
 0031AE                            24479  5 3148.                        SEGEOR
 0031AE D70C D048 D048 00000 00000 24491  5          +
 0031B4 D703 D050 D050 00008 00008 24499  5          +
 0031BA D203 D048 C048 00000 00000 24506  5          +
 0031C0 9610 D054      0000C       24512  5          +
 0031C4 58F0 A5C8/0DEF       035A8 24515  5          +
 0031CA 5840 4000            00000 24517  5 3149.                        L     RJ,QOEFP                NEXT IN THE LIST
 0031CE 47F0 A148            03128 24518  4 3150.                      END   ,
 0031D2                            24523  3 3151.                    END   ,
 0031D2 A1F6           031D2 03100 24527  3 3152.                    ELSE  BEGIN
 0031D2 47F0 A29A            0327A 24532  3          +
 0031D6                            24538  4 3153.                      SEG   'OWNER PID: '
 0031D6 D70C D048 D048 00000 00000 24549  4          +
 0031DC 4100 A631            03611 24558  4          +
 0031E0 5000 D04C            00004 24563  4          +
 0031E4 4100 000B            0000B 24575  4          +
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  163
0Current Usings:  (PZERO,R0) (QOE,R4) (QRB,R5) (QCB,R6) (QCT,R7) (ENQDUMP,R10) (ENQDWORK-72,R12) (@SEG-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00031E8 5000 D050            00008 24580  4          +
 0031EC D203 D048 C048 00000 00000 24587  4          +
 0031F2 58F0 A5C8/0DEF       035A8 24590  4          +
 0031F8                            24592  4 3154.                      SEGHEX QOEPID,4
 0031F8 D70C D048 D048 00000 00000 24603  4          +
 0031FE 4100 4010            00010 24616  4          +
 003202 5000 D04C            00004 24621  4          +
 003206 4100 0004            00004 24633  4          +
 00320A 5000 D050            00008 24638  4          +
 00320E D203 D048 C048 00000 00000 24645  4          +
 003214 58F0 A5D0/0DEF       035B0 24648  4          +
 00321A                            24650  4 3155.                      SEG   ' '
 00321A D70C D048 D048 00000 00000 24661  4          +
 003220 4100 A630            03610 24670  4          +
 003224 5000 D04C            00004 24675  4          +
 003228 4100 0001            00001 24687  4          +
 00322C 5000 D050            00008 24692  4          +
 003230 D203 D048 C048 00000 00000 24699  4          +
 003236 58F0 A5C8/0DEF       035A8 24702  4          +
 00323C                            24704  4 3156.                      SEGHEX QOEPID+4,4
 00323C D70C D048 D048 00000 00000 24715  4          +
 003242 4100 4014            00014 24728  4          +
 003246 5000 D04C            00004 24733  4          +
 00324A 4100 0004            00004 24745  4          +
 00324E 5000 D050            00008 24750  4          +
 003252 D203 D048 C048 00000 00000 24757  4          +
 003258 58F0 A5D0/0DEF       035B0 24760  4          +
 00325E                            24762  4 3157.                      SEGEOR
 00325E D70C D048 D048 00000 00000 24774  4          +
 003264 D703 D050 D050 00008 00008 24782  4          +
 00326A D203 D048 C048 00000 00000 24789  4          +
 003270 9610 D054      0000C       24795  4          +
 003274 58F0 A5C8/0DEF       035A8 24798  4          +
 00327A                            24800  3 3158.                    END   ,
 00327A 5840 5010            00010 24804  3 3159.                    L     RJ,QRBWFP               WAITING
 00327E 4110 5010            00010 24805  3 3160.                    LA    RS,QRBWFP
 DROP   @SEG-72,R13                24806  3 3161.                    SEGCOL 6
 USING  @SEGCOL-72,R13
 003282 D707 D048 D048 00000 00000 24827  3          +
 003288 4100 0006            00006 24839  3          +
 00328C 5000 D04C            00004 24844  3          +
 003290 D203 D048 C048 00000 00000 24851  3          +
 003296 58F0 A5CC/0DEF       035AC 24854  3          +
 DROP   @SEGCOL-72,R13             24856  3 3162.                    SEG   'WAITING PIDS: '
 USING  @SEG-72,R13
 00329C D70C D048 D048 00000 00000 24877  3          +
 0032A2 4100 A5F2            035D2 24886  3          +
 0032A6 5000 D04C            00004 24891  3          +
 0032AA 4100 000E            0000E 24903  3          +
 0032AE 5000 D050            00008 24908  3          +
 0032B2 D203 D048 C048 00000 00000 24915  3          +
 0032B8 58F0 A5C8/0DEF       035A8 24918  3          +
 0032BE 1941/4770 A30A       032EA 24920  3 3163.                    IF    (RJ,EQ,RS),BEGIN
 0032C4                            24935  4 3164.                      SEGEOR 'None'
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  164
0Current Usings:  (PZERO,R0) (QOE,R4) (QRB,R5) (QCB,R6) (QCT,R7) (ENQDUMP,R10) (ENQDWORK-72,R12) (@SEG-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00032C4 D70C D048 D048 00000 00000 24947  4          +
 0032CA 4100 A5D4            035B4 24956  4          +
 0032CE 5000 D04C            00004 24961  4          +
 0032D2 4100 0004            00004 24973  4          +
 0032D6 5000 D050            00008 24978  4          +
 0032DA D203 D048 C048 00000 00000 24985  4          +
 0032E0 9610 D054      0000C       24991  4          +
 0032E4 58F0 A5C8/0DEF       035A8 24994  4          +
 0032EA                            24996  3 3165.                    END   ,
 0032EA A30E           032EA 032C2 25000  3 3166.                    ELSE  BEGIN
 0032EA 47F0 A3EC            033CC 25005  3          +
 0032EE 1941/4780 A3EC       033CC 25011  4 3167.                      WHILE (RJ,NE,RS),BEGIN
 DROP   @SEG-72,R13                25028  5 3168.                        SEGCOL 20
 USING  @SEGCOL-72,R13
 0032F4 D707 D048 D048 00000 00000 25049  5          +
 0032FA 4100 0014            00014 25061  5          +
 0032FE 5000 D04C            00004 25066  5          +
 003302 D203 D048 C048 00000 00000 25073  5          +
 003308 58F0 A5CC/0DEF       035AC 25076  5          +
 DROP   @SEGCOL-72,R13             25078  5 3169.                        SEGHEX QOEPID,4
 USING  @SEG-72,R13
 00330E D70C D048 D048 00000 00000 25099  5          +
 003314 4100 4010            00010 25112  5          +
 003318 5000 D04C            00004 25117  5          +
 00331C 4100 0004            00004 25129  5          +
 003320 5000 D050            00008 25134  5          +
 003324 D203 D048 C048 00000 00000 25141  5          +
 00332A 58F0 A5D0/0DEF       035B0 25144  5          +
 003330                            25146  5 3170.                        SEG   ' '
 003330 D70C D048 D048 00000 00000 25157  5          +
 003336 4100 A630            03610 25166  5          +
 00333A 5000 D04C            00004 25171  5          +
 00333E 4100 0001            00001 25183  5          +
 003342 5000 D050            00008 25188  5          +
 003346 D203 D048 C048 00000 00000 25195  5          +
 00334C 58F0 A5C8/0DEF       035A8 25198  5          +
 003352                            25200  5 3171.                        SEGHEX QOEPID+4,4
 003352 D70C D048 D048 00000 00000 25211  5          +
 003358 4100 4014            00014 25224  5          +
 00335C 5000 D04C            00004 25229  5          +
 003360 4100 0004            00004 25241  5          +
 003364 5000 D050            00008 25246  5          +
 003368 D203 D048 C048 00000 00000 25253  5          +
 00336E 58F0 A5D0/0DEF       035B0 25256  5          +
 003374 9180 4024      00024       25258  5 3172.                        IF    QOESHR,'SEG  "SHR "'    SHARED
 003378 47E0 A3BE            0339E 25268  5          +
 00337C D70C D048 D048 00000 00000 25285  6          +
 003382 4100 A5D8            035B8 25294  6          +
 003386 5000 D04C            00004 25299  6          +
 00338A 4100 0004            00004 25311  6          +
 00338E 5000 D050            00008 25316  6          +
 003392 D203 D048 C048 00000 00000 25323  6          +
 003398 58F0 A5C8/0DEF       035A8 25326  5          +
 00339E A3C2           0339E 0337A 25332  5 3173.                        ELSE  'SEG  "EXC "'            OR EXCLUSIVE
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  165
0Current Usings:  (PZERO,R0) (QOE,R4) (QRB,R5) (QCB,R6) (QCT,R7) (ENQDUMP,R10) (ENQDWORK-72,R12) (@SEG-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000339E 47F0 A3E4            033C4 25337  5          +
 0033A2 D70C D048 D048 00000 00000 25355  6          +
 0033A8 4100 A5DC            035BC 25364  6          +
 0033AC 5000 D04C            00004 25369  6          +
 0033B0 4100 0004            00004 25381  6          +
 0033B4 5000 D050            00008 25386  6          +
 0033B8 D203 D048 C048 00000 00000 25393  6          +
 0033BE 58F0 A5C8/0DEF       035A8 25396  5          +
 0033C4 5840 4000            00000 25402  5 3174.                        L     RJ,QOEFP                NEXT ELEMENT ON THE CHAIN
 0033C8 47F0 A30E            032EE 25403  4 3175.                      END   ,
 0033CC                            25408  3 3176.                    END   ,
 0033CC 47F0 A0AA            0308A 25412  2 3177.                  END   ,
 DROP   QOE,R4
 DROP   QRB,R5
 0033D0 4120 2008            00008 25427  2 3178.                  LA    RA,@RA+8                TO NEXT CHAIN
 0033D4 0630                       25428  2 3179.                  DECR  RB
 0033D6 47F0 A0A0            03080 25430  1 3180.                END   ,
 0033DA 5860 6010            00010 25435  1 3181.                L     RX,QCBNEXT              NEXT QCB ON THE CHAIN
 0033DE 47F0 A092            03072 25436    3182.              END   ,
 0033E2                            25441    3183.              SEGEOR
 0033E2 D70C D048 D048 00000 00000 25453             +
 0033E8 D703 D050 D050 00008 00008 25461             +
 0033EE D203 D048 C048 00000 00000 25468             +
 0033F4 9610 D054      0000C       25474             +
 0033F8 58F0 A5C8/0DEF       035A8 25477             +
 0033FE 981F C008            00008 25479    3184.              PEND
 DROP   QCB,R6
 DROP   QCT,R7
 DROP   ENQDWORK-72,R12
 DROP   ENQDUMP,R10
 003402 9680 C000/0B0E 00000       25504             +
 DROP   @SEG-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  166
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
0                                  25514    3186.     *******************************************************************
                                   25515    3187.     *                                                                 *
                                   25516    3188.     *   ENQASDMP - Enqueue Services Address Space Dump Processing     *
                                   25517    3189.     *                                                                 *
                                   25518    3190.     *     Input -                                                     *
                                   25519    3191.     *                                                                 *
                                   25520    3192.     *    Output - None                                                *
                                   25521    3193.     *                                                                 *
                                   25522    3194.     *******************************************************************
-
 003408                            25524    3196.     ENQASDMP PROC  ,ENQDWORK,SCOPE=GLOBAL
 003408 C5D5D8C1E2C4D4D7           25530             +
 003410 0000/0008                  25531             +
 003414 900F D004/18AF       00004 25533             +
 USING  ENQASDMP,R10
 00341A 50D0 C000/18CD       00000 25548             +
 003420 9680 C000      00000       25550             +
 USING  ENQDWORK-72,R12
 003424 41D0 C050            00050 25564             +
                                   25565    3197.     *
                                   25566    3198.     *  Set address space table
                                   25567    3199.     *
 003428 5820 0208            00208 25568    3200.              L     RA,PZCURASB             CURRENT ASB
 00342C 5820 2028            00028 25569    3201.              WITH  (ASB,RA),'L  RA,ASBENQ'   LOCAL ENQUEUE CONTROL
 USING  ASB,R2
 DROP   ASB,R2
 USING  QAS,R2                     25593    3202.              WITH  (QAS,RA)
 003430 1222/4780 A184       03598 25606    3203.              IF    (RA,NZ),BEGIN
 003436                            25620  1 3204.                IF    (QASID,NE,=CL4'QAS'),EXIT
 003436 D503 A1AC 2000 035C0 00000 25631  1          +
 00343C 4770 A184            03598 25634  1          +
 USING  @SEG-72,R13                25640  1 3205.                SEGEOR 'Enqueue Table',,EQDUMPCB
 003440 D70C D048 D048 00000 00000 25659  1          +
 003446 4100 A208            0361C 25668  1          +
 00344A 5000 D04C            00004 25673  1          +
 00344E 4100 000D            0000D 25685  1          +
 003452 5000 D050            00008 25690  1          +
 003456 D203 D048 C048 00000 00000 25697  1          +
 00345C 9610 D054      0000C       25703  1          +
 003460 58F0 A194/0DEF       035A8 25706  1          +
 003466 5830 2004/1233       00004 25708  1 3206.                IF    ('LT  RB,QASCHN',Z),BEGIN
 00346C 4770 A086            0349A 25719  1          +
 003470                            25724  2 3207.                  SEGEOR '  *** Not initialized ***'
 003470 D70C D048 D048 00000 00000 25736  2          +
 003476 4100 A1E3            035F7 25745  2          +
 00347A 5000 D04C            00004 25750  2          +
 00347E 4100 0019            00019 25762  2          +
 003482 5000 D050            00008 25767  2          +
 003486 D203 D048 C048 00000 00000 25774  2          +
 00348C 9610 D054      0000C       25780  2          +
 003490 58F0 A194/0DEF       035A8 25783  2          +
 003496 47F0 A184            03598 25785  2 3208.                  EXIT  ENQASDMP
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  167
0Current Usings:  (PZERO,R0) (QAS,R2) (ENQASDMP,R10) (ENQDWORK-72,R12) (@SEG-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000349A                            25788  1 3209.                END   ,
                                   25792  1 3210.     *
                                   25793  1 3211.     *  LOOP THROUGH RESOURCE LIST
                                   25794  1 3212.     *
 00349A 1233/4780 A184       03598 25795  1 3213.                WHILE (RB,NZ),BEGIN
 USING  QAO,R3                     25811  2 3214.                  WITH  (QAO,RB)
 0034A0 5840 3008            00008 25824  2 3215.                  L     RJ,QAOQOE               OWNERSHIP ELEMENT
 USING  QOE,R4                     25825  2 3216.                  WITH  (QOE,RJ)
 0034A4 9140 4024      00024       25838  2 3217.                  IF    QOEWAIT,'SEG  "  WAIT "'
 0034A8 47E0 A0BA            034CE 25848  2          +
 0034AC D70C D048 D048 00000 00000 25865  3          +
 0034B2 4100 A215            03629 25874  3          +
 0034B6 5000 D04C            00004 25879  3          +
 0034BA 4100 0007            00007 25891  3          +
 0034BE 5000 D050            00008 25896  3          +
 0034C2 D203 D048 C048 00000 00000 25903  3          +
 0034C8 58F0 A194/0DEF       035A8 25906  2          +
 0034CE A0BE           034CE 034AA 25912  2 3218.                  ELSE  'SEG  "       "'
 0034CE 47F0 A0E0            034F4 25917  2          +
 0034D2 D70C D048 D048 00000 00000 25935  3          +
 0034D8 4100 A21C            03630 25944  3          +
 0034DC 5000 D04C            00004 25949  3          +
 0034E0 4100 0007            00007 25961  3          +
 0034E4 5000 D050            00008 25966  3          +
 0034E8 D203 D048 C048 00000 00000 25973  3          +
 0034EE 58F0 A194/0DEF       035A8 25976  2          +
 0034F4 9180 3040      00040       25982  2 3219.                  IF    QAOSHR,'SEG  "SHR "'    SHARED
 0034F8 47E0 A10A            0351E 25992  2          +
 0034FC D70C D048 D048 00000 00000 26009  3          +
 003502 4100 A1A4            035B8 26018  3          +
 003506 5000 D04C            00004 26023  3          +
 00350A 4100 0004            00004 26035  3          +
 00350E 5000 D050            00008 26040  3          +
 003512 D203 D048 C048 00000 00000 26047  3          +
 003518 58F0 A194/0DEF       035A8 26050  2          +
 00351E A10E           0351E 034FA 26056  2 3220.                  ELSE  'SEG  "EXC "'            OR EXCLUSIVE
 00351E 47F0 A130            03544 26061  2          +
 003522 D70C D048 D048 00000 00000 26079  3          +
 003528 4100 A1A8            035BC 26088  3          +
 00352C 5000 D04C            00004 26093  3          +
 003530 4100 0004            00004 26105  3          +
 003534 5000 D050            00008 26110  3          +
 003538 D203 D048 C048 00000 00000 26117  3          +
 00353E 58F0 A194/0DEF       035A8 26120  2          +
 003544                            26126  2 3221.                  SEGB  QAOQNAME                QUEUE NAME
 003544 D70C D048 D048 00000 00000 26138  2          +
 00354A 4100 300C            0000C 26151  2          +
 00354E 5000 D04C            00004 26156  2          +
 003552 4100 0008            00008 26168  2          +
 003556 5000 D050            00008 26173  2          +
 00355A D203 D048 C048 00000 00000 26180  2          +
 003560 9680 D054      0000C       26186  2          +
 003564 58F0 A194/0DEF       035A8 26189  2          +
 00356A                            26191  2 3222.                  SEGEOR QAORNAME                RESOURCE NAME
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Enqueue/Dequeue Services                                                       Page  168
0Current Usings:  (PZERO,R0) (QAS,R2) (QAO,R3) (QOE,R4) (ENQASDMP,R10) (ENQDWORK-72,R12) (@SEG-72,R13)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
000356A D70C D048 D048 00000 00000 26203  2          +
 003570 4100 3014            00014 26216  2          +
 003574 5000 D04C            00004 26221  2          +
 003578 4100 002C            0002C 26233  2          +
 00357C 5000 D050            00008 26238  2          +
 003580 D203 D048 C048 00000 00000 26245  2          +
 003586 9610 D054      0000C       26251  2          +
 00358A 58F0 A194/0DEF       035A8 26254  2          +
 003590 5830 3004            00004 26256  2 3223.                  L     RB,QAOCHN               NEXT ENTRY
 003594 47F0 A086            0349A 26257  1 3224.                END   ,
 DROP   QOE,R4
 DROP   QAO,R3
 003598                            26272    3225.              END   ,
 003598 981F C008            00008 26276    3226.              PEND
 DROP   QAS,R2
 DROP   ENQDWORK-72,R12
 DROP   ENQASDMP,R10
 00359C 9680 C000/0B0E 00000       26296             +
 DROP   @SEG-72,R13
1RESMAN   (RESM00) (09:43) (22MAR04) ORVYL'S Resource Management Services                                                   Page  169
0Current Usings:  (PZERO,R0)
0Loc    Object Code    Addr1 Addr2  Stmt Lv Lineno    Source Statement           (Hibal 5, Asmedit 3.3)  HLASM R4.0  2004/03/22 09.43
+___    ______ ____    _____ _____  ____ __ ______    ______ _________
00035A8                            26306    3228.              LTORG
 0035A8 00000000                   26308                             =V(SEG)
 0035AC 00000000                   26309                             =V(SEGCOL)
 0035B0 00000000                   26310                             =V(SEGHEX)
 0035B4 D5969585                   26311                             =C'None'
 0035B8 E2C8D940                   26312                             =C'SHR '
 0035BC C5E7C340                   26313                             =C'EXC '
 0035C0 D8C1E240                   26314                             =CL4'QAS'
 0035C4 E2C8C1D9C9D5C740           26315                             =C'SHARING PIDS: '
 0035D2 E6C1C9E3C9D5C740           26316                             =C'WAITING PIDS: '
 0035E0 5C5C5C40C5D5D8E4           26317                             =C'*** ENQUEUE Service ***'
 0035F7 40405C5C5C40D596           26318                             =C'  *** Not initialized ***'
 003610 40                         26319                             =C' '
 003611 D6E6D5C5D940D7C9           26320                             =C'OWNER PID: '
 00361C C59598A485A48540           26321                             =C'Enqueue Table'
 003629 4040E6C1C9E340             26322                             =C'  WAIT '
 003630 40404040404040             26323                             =C'       '
 003638                03638 03638 26327    3229.              END   .

1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  170
-Symbol   Length   Value     Id    R Type   Defn References                                  HLASM R4.0  2004/03/22 09.43
0$$$@R0        1 00000000 FFFFFFFE     J     714  1010
 $$$@R1        1 00000000 FFFFFFFD     J     727  1022
 $$$@R10       1 00000000 FFFFFFF4     J     844  1142
 $$$@R11       1 00000000 FFFFFFF3     J     857  1154
 $$$@R12       1 00000000 FFFFFFF2     J     870  1166
 $$$@R13       1 00000000 FFFFFFF1     J     883  1178
 $$$@R14       1 00000000 FFFFFFF0     J     896  1190
 $$$@R15       1 00000000 FFFFFFEF     J     909  1202
 $$$@R2        1 00000000 FFFFFFFC     J     740  1034
 $$$@R3        1 00000000 FFFFFFFB     J     753  1046
 $$$@R4        1 00000000 FFFFFFFA     J     766  1058
 $$$@R5        1 00000000 FFFFFFF9     J     779  1070
 $$$@R6        1 00000000 FFFFFFF8     J     792  1082
 $$$@R7        1 00000000 FFFFFFF7     J     805  1094
 $$$@R8        1 00000000 FFFFFFF6     J     818  1106
 $$$@R9        1 00000000 FFFFFFF5     J     831  1118   1130
 $$$C1RESMAN
               1 00000C02 00000001     J    8660  8662   8699
 $$$C2RESMAN
               1 0000115A 00000001     J   10596 10598  10641  10701  10733  11982  13811  14676  14695
 $$$C3RESMAN
               1 00001BD8 00000001     J   15104 15106  15155  15191  15232  15258  15295  15320  15350  15381  15414
                                                 15466  15493  15532  15566  15606  15652  15677  15702  15727  15752
 $$$C4RESMAN
               1 000025C6 00000001     J   19710 19712
 $$$C5RESMAN
               1 00002FD4 00000001     J   23586 23588
 $$$C6RESMAN
               1 00003637 00000001     J   26324 26326
 $$$C7RESMAN
               1 00003638 00000001     J   26330 26332
 $$$R#GRCAN
               1 00000000 FFFFFFA3     J    7357  7370   7370
 $$$R#GRGET
               1 00000000 FFFFFFA5     J    4744  4765   4765
 $$$R#GRREL
               1 00000000 FFFFFFA4     J    5810  5823   5823
 $$$R#LQEGET
               1 00000000 FFFFFF9B     J   14681 14694  14694
 $$$R#QUEPLO
               1 00000000 FFFFFFAA     J    3843  3856   3856
 $$$R#QUEW
               1 00000000 FFFFFFA9     J    3868  3887   3887
 $$$R#SLOCK
               1 00000000 FFFFFF9E     J   11938 11981  11981
 $$$R@ACREATE
               1 00000000 FFFFFFDC     J    2306  2319   2319
 $$$R@AWAIT
               1 00000000 FFFFFFD0     J    2605  2627   2627
 $$$R@DEQUEUE
               1 00000000 FFFFFF99     J   15166 15190  15190
 $$$R@DISPPIOC
               1 00000000 FFFFFFE1     J    2172  2185   2185
 $$$R@DISPSIOC
               1 00000000 FFFFFFE0     J    2191  2204   2204
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  171
 $$$R@DISPSWP
               1 00000000 FFFFFFDD     J    2283  2296   2296
 $$$R@DSPSTAT
               1 00000000 FFFFFFD1     J    2577  2593   2593
 $$$R@ENQASCN
               1 00000000 FFFFFF8C     J   15617 15651  15651
 $$$R@ENQHALT
               1 00000000 FFFFFF97     J   15243 15257  15257
 $$$R@ENQPOST
               1 00000000 FFFFFF8D     J   15577 15605  15605
 $$$R@ENQUEUE
               1 00000000 FFFFFF9A     J   15117 15154  15154
 $$$R@ENQWAIT
               1 00000000 FFFFFF8E     J   15543 15565  15565
 $$$R@EXRADD
               1 00000000 FFFFFFCE     J    2676  2706   2706
 $$$R@EXRDEL
               1 00000000 FFFFFFCD     J    2716  2729   2729
 $$$R@EXRDONE
               1 00000000 FFFFFFCC     J    2739  2775   2775
 $$$R@FINDQCB
               1 00000000 FFFFFF8B     J   15663 15676  15676
 $$$R@FREEQAO
               1 00000000 FFFFFF88     J   15738 15751  15751
 $$$R@FREEQOE
               1 00000000 FFFFFF89     J   15713 15726  15726
 $$$R@FREEQRB
               1 00000000 FFFFFF8A     J   15688 15701  15701
 $$$R@GRES
               1 00000000 FFFFFFE9     J    1751  1787   1787
 $$$R@HASH
               1 00000000 FFFFFF96     J   15270 15294  15294
 $$$R@LADD
               1 00000000 FFFFFFBF     J    3209  3225   3225
 $$$R@LOCKCRE
               1 00000000 FFFFFFC3     J    3113  3135   3135
 $$$R@LOCKS
               1 00000000 FFFFFFC2     J    3141  3154   3154
 $$$R@LQEGET
               1 00000000 FFFFFF9C     J   14662 14675  14675
 $$$R@LREM
               1 00000000 FFFFFFBE     J    3231  3248   3248
 $$$R@MONSET
               1 00000000 FFFFFFD2     J    2554  2567   2567
 $$$R@PAGASC1
               1 00000000 FFFFFFB0     J    3715  3729   3729
 $$$R@PAGASC2
               1 00000000 FFFFFFAF     J    3735  3749   3749
 $$$R@PAGDEF
               1 00000000 FFFFFFB2     J    3655  3682   3682
 $$$R@PAGE
               1 00000000 FFFFFFAE     J    3755  3771   3771
 $$$R@PAGINIT
               1 00000000 FFFFFFAB     J    3817  3831   3831
 $$$R@PAGINTV
               1 00000000 FFFFFFAC     J    3798  3811   3811
 $$$R@PAGRV
               1 00000000 FFFFFFAD     J    3777  3792   3792
 $$$R@PAGSEGD
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  172
               1 00000000 FFFFFFB1     J    3688  3709   3709
 $$$R@PAGSWADV
               1 00000000 FFFFFFB4     J    3606  3619   3619
 $$$R@PAGSWAP
               1 00000000 FFFFFFB5     J    3552  3600   3600
 $$$R@PAGWSMA
               1 00000000 FFFFFFB3     J    3625  3649   3649
 $$$R@PARMDO
               1 00000000 FFFFFFB7     J    3457  3473   3473
 $$$R@PERSET
               1 00000000 FFFFFFD3     J    2531  2544   2544
 $$$R@QUE      1 00000000 FFFFFFEA     J    1636  1651   1651
 $$$R@REQUEUE
               1 00000000 FFFFFF98     J   15202 15231  15231
 $$$R@RESUME
               1 00000000 FFFFFFDE     J    2258  2273   2273
 $$$R@SBFREE
               1 00000000 FFFFFFE6     J    2032  2046   2046
 $$$R@SBGET
               1 00000000 FFFFFFE7     J    2006  2021   2021
 $$$R@SBINIT
               1 00000000 FFFFFFE8     J    1960  1995   1995
 $$$R@SEG      1 00000000 FFFFFFBD     J    3255  3310   3310
 $$$R@SEGCOL
               1 00000000 FFFFFFBB     J    3338  3352   3352
 $$$R@SEGCORE
               1 00000000 FFFFFFBA     J    3358  3405   3405
 $$$R@SEGINIT
               1 00000000 FFFFFFBC     J    3316  3332   3332
 $$$R@SEGRTN
               1 00000000 FFFFFFB9     J    3411  3424   3424
 $$$R@SEGSTK
               1 00000000 FFFFFFB8     J    3430  3444   3444
 $$$R@SIGNAL
               1 00000000 FFFFFFCF     J    2638  2658   2658
 $$$R@SUSPEND
               1 00000000 FFFFFFDF     J    2214  2248   2248
 $$$R@SYSRDEL
               1 00000000 FFFFFFD6     J    2459  2472   2472
 $$$R@SYSRDO
               1 00000000 FFFFFFD5     J    2482  2498   2498
 $$$R@SYSRNEW
               1 00000000 FFFFFFD7     J    2437  2450   2450
 $$$R@SYSRTN
               1 00000000 FFFFFFD4     J    2508  2521   2521
 $$$R@TCREATE
               1 00000000 FFFFFFDB     J    2329  2358   2358
 $$$R@TENTRY
               1 00000000 FFFFFFD9     J    2391  2404   2404
 $$$R@TEXIT
               1 00000000 FFFFFFD8     J    2414  2427   2427
 $$$R@TREMOVE
               1 00000000 FFFFFFDA     J    2368  2381   2381
 $$$R@VMFREE
               1 00000000 FFFFFFE3     J    2120  2135   2135
 $$$R@VMGET
               1 00000000 FFFFFFE4     J    2085  2114   2114
 $$$R@VMINFO
               1 00000000 FFFFFFE2     J    2141  2156   2156
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  173
 $$$R@XITDATA
               1 00000000 FFFFFFC5     J    3061  3074   3074
 $$$R@XITDEL
               1 00000000 FFFFFFCA     J    2816  2829   2829
 $$$R@XITDO
               1 00000000 FFFFFFC9     J    2838  2855   2855
 $$$R@XITGPST
               1 00000000 FFFFFFC8     J    2866  2881   2881
 $$$R@XITMASK
               1 00000000 FFFFFFC7     J    2891  2938   2938
 $$$R@XITNEW
               1 00000000 FFFFFFCB     J    2785  2806   2806
 $$$RASB       1 00000000 FFFFFFEC     J    1416  1467   1467
 $$$RENQDWORK
               1 00000000 FFFFFF95     J   15306 15319  15319
 $$$RGRCT      1 00000000 FFFFFFA8     J    3900  3925   3925
 $$$RGRHITM
               1 00000000 FFFFFFA6     J    3980  4028   4028
 $$$RGRITEM
               1 00000000 FFFFFFA7     J    3938  3966   3966
 $$$RLELEM
               1 00000000 FFFFFFC0     J    3188  3203   3203
 $$$RLHEAD
               1 00000000 FFFFFFC1     J    3166  3182   3182
 $$$RLKIPARM
               1 00000000 FFFFFF9D     J   13795 13810  13810
 $$$RLOCKCB
               1 00000000 FFFFFFA0     J   10652 10700  10700
 $$$RLOCKCT
               1 00000000 FFFFFFA1     J   10608 10640  10640
 $$$RLQE       1 00000000 FFFFFF9F     J   10712 10732  10732
 $$$RMAT       1 00000000 FFFFFFED     J    1350  1409   1409
 $$$RPARMIN
               1 00000000 FFFFFFB6     J    3479  3537   3537
 $$$RPZERO
               1 00000000 FFFFFFEE     J    1237  1328   1328
 $$$RQAO       1 00000000 FFFFFF8F     J   15504 15531  15531
 $$$RQAS       1 00000000 FFFFFF90     J   15477 15492  15492
 $$$RQCB       1 00000000 FFFFFF93     J   15361 15380  15380
 $$$RQCT       1 00000000 FFFFFF94     J   15332 15349  15349
 $$$RQOE       1 00000000 FFFFFF91     J   15425 15465  15465
 $$$RQRB       1 00000000 FFFFFF92     J   15392 15413  15413
 $$$RSBCNTRL
               1 00000000 FFFFFFA2     J    8666  8698   8698
 $$$RSBWAIT
               1 00000000 FFFFFFE5     J    2052  2072   2072
 $$$RSLDUMMY
               1 00000000 FFFFFFEB     J    1578  1594   1594
 $$$RXITMSKD
               1 00000000 FFFFFFC6     J    2964  3051   3051
 $$$RXITSAREA
               1 00000000 FFFFFFC4     J    3084  3100   3100
 $$$104F       2 00000864 00000001     H    7284  7182B
 $$$104S       2 00000822 00000001     H    7173  7283B
 $$$107F       2 000008CE 00000001     H    7483  7457B
 $$$108S       2 000008E4 00000001     H    7536  7558B  7597B  7689B
 $$$109F       2 000008FC 00000001     H    7562  7550B
 $$$110F       2 00000988 00000001     H    7806  7576B
 $$$110S       2 000008FC 00000001     H    7569  7805B
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  174
 $$$112F       2 00000916 00000001     H    7601  7589B
 $$$113F       2 00000982 00000001     H    7800  7613B  7648B
 $$$114F       2 00000930 00000001     H    7651  7631B
 $$$116F       2 00000944 00000001     H    7693  7681B
 $$$118B       4 000009EC 00000001     I    7982  8000
 $$$118F       2 00000A00 00000001     H    7997  7982B  7999
 $$$119E       2 00000A04 00000001     H    8007  8001
 $$$119F       2 00000A24 00000001     H    8023  8003B
 $$$120B       4 00000A2E 00000001     I    8035  8051
 $$$120F       2 00000A34 00000001     H    8048  8035B  8050
 $$$121E       2 00000A38 00000001     H    8058  8052
 $$$121F       2 00000A3C 00000001     H    8065  8054B
 $$$123B       4 00000AA4 00000001     I    8237  8255
 $$$123F       2 00000AB8 00000001     H    8252  8237B  8254
 $$$124E       2 00000ABC 00000001     H    8262  8256
 $$$124F       2 00000ADC 00000001     H    8278  8258B
 $$$125B       4 00000AE6 00000001     I    8290  8306
 $$$125F       2 00000AEC 00000001     H    8303  8290B  8305
 $$$126E       2 00000AF0 00000001     H    8313  8307
 $$$126F       2 00000AF4 00000001     H    8320  8309B
 $$$128B       4 00000B52 00000001     I    8501  8519
 $$$128F       2 00000B6A 00000001     H    8516  8501B  8518
 $$$129E       2 00000B6E 00000001     H    8526  8520
 $$$129F       2 00000B92 00000001     H    8542  8522B
 $$$13F        2 00000086 00000001     H    4167  4141B
 $$$130B       4 00000B9C 00000001     I    8554  8570
 $$$130F       2 00000BA2 00000001     H    8567  8554B  8569
 $$$131E       2 00000BA6 00000001     H    8577  8571
 $$$131F       2 00000BAA 00000001     H    8584  8573B
 $$$133F       2 00000C4E 00000001     H    8815  8789B
 $$$133S       2 00000C36 00000001     H    8776  8812B
 $$$137B       4 00000C50 00000001     I    8828  8972
 $$$137F       2 00000CA0 00000001     H    8969  8828B  8971
 $$$138S       2 00000C5C 00000001     H    8840  8859B
 $$$141F       2 00000C82 00000001     H    8909  8886B
 $$$141S       2 00000C74 00000001     H    8872  8906B
 $$$145F       2 00000CA0 00000001     H    8965  8920B
 $$$146E       2 00000CA4 00000001     H    8979  8973
 $$$146F       2 00000DBC 00000001     H    9460  8975B
 $$$147F       2 00000CC8 00000001     H    9066  9040B
 $$$147S       2 00000CB0 00000001     H    9027  9063B
 $$$15F        2 000000EA 00000001     H    4387  4361B
 $$$15S        2 000000D2 00000001     H    4348  4384B
 $$$151F       2 00000D1E 00000001     H    9172  9079B
 $$$152F       2 00000D1E 00000001     H    9168  9142B
 $$$153S       2 00000D46 00000001     H    9246  9268B
 $$$156F       2 00000D68 00000001     H    9318  9295B
 $$$156S       2 00000D5A 00000001     H    9281  9315B
 $$$160S       2 00000DAA 00000001     H    9422  9440B
 $$$165S       2 00000E06 00000001     H    9580  9654B
 $$$166B       4 00000E0C 00000001     I    9591  9786
 $$$166F       2 00000E6E 00000001     H    9783  9591B  9785
 $$$167F       2 00000E32 00000001     H    9658  9646B
 $$$168E       2 00000E72 00000001     H    9793  9787
 $$$168F       2 00000EC8 00000001     H    9917  9789B
 $$$169F       2 00000E92 00000001     H    9846  9803B
 $$$170S       2 00000EA4 00000001     H    9857  9875B
 $$$173S       2 00000EBA 00000001     H    9888  9908B
 $$$177F       2 00000F44 00000001     H   10101 10075B
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  175
 $$$178F       2 00000FAA 00000001     H   10156 10130B
 $$$179F       2 00000FB6 00000001     H   10177 10167B
 $$$180F       2 00000FD0 00000001     H   10211 10199B
 $$$181B       4 00000FDE 00000001     I   10225 10276
 $$$181F       2 00000FFC 00000001     H   10272 10225B 10275
 $$$182B       4 00001004 00000001     I   10292 10415
 $$$182E       2 00001000 00000001     H   10283 10277
 $$$182F       2 00001048 00000001     H   10412 10279B 10292B 10414
 $$$184B       4 0000100C 00000001     I   10307 10357
 $$$184F       2 0000102A 00000001     H   10354 10307B 10356
 $$$185E       2 0000102E 00000001     H   10364 10358
 $$$185F       2 00001048 00000001     H   10408 10360B
 $$$186E       2 0000104C 00000001     H   10422 10416
 $$$186F       2 0000107C 00000001     H   10445 10418B
 $$$187F       2 000010B2 00000001     H   10480 10454B
 $$$188S       2 000010DC 00000001     H   10508 10540B
 $$$189S       2 000010E2 00000001     H   10517 10528B
 $$$19F        2 00000140 00000001     H    4490  4400B
 $$$193B       4 00001186 00000001     I   10835 10893
 $$$193F       2 000011A4 00000001     H   10890 10835B 10892
 $$$194E       2 000011A8 00000001     H   10900 10894
 $$$194F       2 000011C2 00000001     H   10945 10896B
 $$$195F       2 000011F8 00000001     H   10980 10954B
 $$$196B       4 0000120E 00000001     I   11013 11033
 $$$196F       2 00001216 00000001     H   11027 11013B 11032
 $$$197E       2 0000121A 00000001     H   11040 11034
 $$$197F       2 000012A4 00000001     H   11265 11036B
 $$$198S       2 0000121E 00000001     H   11050 11066B
 $$$20F        2 00000140 00000001     H    4486  4460B
 $$$200S       2 0000122C 00000001     H   11079 11157B
 $$$201F       2 00001262 00000001     H   11116 11090B
 $$$205F       2 00001316 00000001     H   11446 11420B
 $$$206B       4 0000131E 00000001     I   11461 11592
 $$$206F       2 00001366 00000001     H   11586 11461B 11591
 $$$207F       2 00001336 00000001     H   11501 11491B
 $$$207T       2 00001332 00000001     H   11494 11482B
 $$$209F       2 00001348 00000001     H   11524 11514B
 $$$210E       2 0000136A 00000001     H   11599 11593
 $$$210F       2 000013EE 00000001     H   11852 11595B
 $$$211F       2 0000137C 00000001     H   11625 11615B
 $$$212F       2 0000138A 00000001     H   11664 11654B
 $$$213F       2 0000139A 00000001     H   11683 11673B
 $$$214S       2 000013B0 00000001     H   11724 11743B
 $$$217S       2 000013C6 00000001     H   11765 11781B
 $$$22S        2 000001AE 00000001     H    4662  4680B
 $$$224B       4 0000148A 00000001     I   12078 12475
 $$$224F       2 00001544 00000001     H   12468 12078B 12474
 $$$225F       2 0000152C 00000001     H   12452 12104B
 $$$227F       2 000014B4 00000001     H   12134 12119B
 $$$229F       2 00001526 00000001     H   12436 12256B
 $$$230S       2 000014C8 00000001     H   12214 12427B
 $$$232F       2 000014EA 00000001     H   12283 12273B
 $$$232S       2 000014D2 00000001     H   12242 12282B
 $$$235F       2 000014FE 00000001     H   12339 12297B
 $$$236S       2 000014F0 00000001     H   12306 12331B
 $$$239F       2 00001516 00000001     H   12400 12361B
 $$$239S       2 000014FE 00000001     H   12347 12397B
 $$$246E       2 00001548 00000001     H   12482 12476
 $$$246F       2 00001646 00000001     H   12954 12478B
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  176
 $$$247F       2 00001646 00000001     H   12950 12568B
 $$$248F       2 0000157A 00000001     H   12572 12528B 12539B 12554B
 $$$251S       2 00001586 00000001     H   12628 12706B
 $$$252F       2 000015BC 00000001     H   12665 12639B
 $$$255S       2 000015EE 00000001     H   12780 12796B
 $$$258F       2 0000161C 00000001     H   12866 12851B
 $$$26F        2 0000022C 00000001     H    4897  4871B
 $$$261B       4 000016D8 00000001     I   13106 13282
 $$$261F       2 00001738 00000001     H   13275 13106B 13281
 $$$263F       2 00001738 00000001     H   13271 13144B
 $$$264S       2 000016FA 00000001     H   13154 13227B
 $$$265F       2 0000171E 00000001     H   13209 13174B
 $$$266F       2 00001716 00000001     H   13203 13190B
 $$$266S       2 00001704 00000001     H   13184 13202B
 $$$27F        2 00000250 00000001     H    4971  4945B
 $$$27S        2 00000238 00000001     H    4932  4968B
 $$$270F       2 00001730 00000001     H   13256 13245B
 $$$271E       2 0000173C 00000001     H   13289 13283
 $$$271F       2 00001840 00000001     H   13714 13285B
 $$$275F       2 0000183A 00000001     H   13698 13393B
 $$$276F       2 0000176E 00000001     H   13397 13385B
 $$$277F       2 000017A6 00000001     H   13438 13412B
 $$$279S       2 000017CA 00000001     H   13510 13529B
 $$$282F       2 00001814 00000001     H   13598 13572B
 $$$284F       2 0000191A 00000001     H   13926 13900B
 $$$285F       2 00001974 00000001     H   14090 14080B
 $$$286F       2 00001998 00000001     H   14137 14127B
 $$$287S       2 000019AC 00000001     H   14187 14205B
 $$$291S       2 00001A0C 00000001     H   14390 14409B
 $$$294F       2 00001A42 00000001     H   14503 14425B
 $$$295S       2 00001A36 00000001     H   14476 14494B
 $$$299S       2 00001A78 00000001     H   14611 14631B
 $$$303S       2 00001AC2 00000001     H   14793 14907B
 $$$304F       2 00001B12 00000001     H   14890 14864B
 $$$306S       2 00001B34 00000001     H   14940 14982B
 $$$309S       2 00001B4A 00000001     H   14996 15038B
 $$$31F        2 000002A6 00000001     H    5074  4984B
 $$$313F       2 00001C48 00000001     H   15877 15851B
 $$$314F       2 00001EF2 00000001     H   17157 16283B 16360B 16870B 16952B
 $$$315B       4 00001CB6 00000001     I   16085 16100
 $$$315F       2 00001CBE 00000001     H   16095 16074B 16085B 16097
 $$$316B       4 00001CB0 00000001     I   16074 16098
 $$$317E       2 00001CC2 00000001     H   16107 16099  16101
 $$$317F       2 00001CD2 00000001     H   16116 16103B
 $$$318F       2 00001CDE 00000001     H   16142 16127B
 $$$319F       2 00001CEA 00000001     H   16168 16153B
 $$$32F        2 000002A6 00000001     H    5070  5044B
 $$$320F       2 00001D1E 00000001     H   16287 16205B
 $$$321F       2 00001D12 00000001     H   16275 16218B
 $$$322B       4 00001D02 00000001     I   16233 16251
 $$$322F       2 00001D0A 00000001     H   16248 16233B 16250
 $$$323E       2 00001D0E 00000001     H   16258 16252
 $$$323F       2 00001D12 00000001     H   16271 16254B
 $$$324F       2 00001D44 00000001     H   16364 16299B
 $$$325B       4 00001D28 00000001     I   16314 16332
 $$$325F       2 00001D30 00000001     H   16329 16314B 16331
 $$$326E       2 00001D34 00000001     H   16339 16333
 $$$326F       2 00001D38 00000001     H   16352 16335B
 $$$327F       2 00001D58 00000001     H   16414 16399B
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  177
 $$$328F       2 00001DC8 00000001     H   16596 16566B 16586B
 $$$328S       2 00001DB0 00000001     H   16551 16595B
 $$$33F        2 000002CE 00000001     H    5113  5098B
 $$$331B       4 00001DCA 00000001     I   16610 16735
 $$$331F       2 00001E20 00000001     H   16729 16610B 16734
 $$$332E       2 00001E24 00000001     H   16742 16736
 $$$332F       2 00001EF2 00000001     H   17123 16738B
 $$$333F       2 00001E7C 00000001     H   16882 16766B 16783B 16810B
 $$$336B       4 00001E80 00000001     I   16896 16970
 $$$336F       2 00001EA6 00000001     H   16964 16896B 16969
 $$$337F       2 00001EA0 00000001     H   16956 16944B
 $$$338E       2 00001EAA 00000001     H   16977 16971
 $$$338F       2 00001EB6 00000001     H   17007 16973B
 $$$339F       2 0000212C 00000001     H   18105 17326B
 $$$34F        2 00000394 00000001     H    5459  5397B
 $$$34S        2 000002E8 00000001     H    5171  5456B
 $$$340B       4 00001F2E 00000001     I   17256 17269
 $$$340F       2 00001F36 00000001     H   17266 17256B 17268
 $$$341E       2 00001F3A 00000001     H   17276 17270
 $$$341F       2 00001F4A 00000001     H   17285 17272B
 $$$342F       2 00001F6A 00000001     H   17330 17318B
 $$$343F       2 00001FA4 00000001     H   17394 17368B
 $$$344F       2 00001FDE 00000001     H   17447 17421B
 $$$345F       2 00002028 00000001     H   17534 17508B
 $$$346F       2 00002066 00000001     H   17587 17561B
 $$$347F       2 0000211E 00000001     H   18048 17714B
 $$$348B       4 000020AA 00000001     I   17749 17935
 $$$348F       2 000020F4 00000001     H   17929 17749B 17934
 $$$348T       2 000020AE 00000001     H   17752 17737B
 $$$35F        2 00000322 00000001     H    5212  5186B
 $$$350F       2 000020E4 00000001     H   17891 17825B 17844B
 $$$352E       2 000020F8 00000001     H   17942 17936
 $$$352F       2 0000211E 00000001     H   18044 17938B
 $$$353F       2 00002118 00000001     H   18017 18002B
 $$$354F       2 0000236E 00000001     H   18995 18269B 18408B 18769B
 $$$355B       4 00002162 00000001     I   18203 18216
 $$$355F       2 0000216A 00000001     H   18213 18203B 18215
 $$$356E       2 0000216E 00000001     H   18223 18217
 $$$356F       2 0000217E 00000001     H   18232 18219B
 $$$357F       2 0000219E 00000001     H   18273 18257B
 $$$358F       2 000021D8 00000001     H   18327 18301B
 $$$359F       2 00002206 00000001     H   18412 18384B 18396B
 $$$359T       2 000021F8 00000001     H   18399 18372B
 $$$36B        4 0000032C 00000001     I    5231  5251
 $$$36F        2 00000334 00000001     H    5246  5231B  5250
 $$$360F       2 000021E8 00000001     H   18375 18358B
 $$$363F       2 00002246 00000001     H   18456 18430B
 $$$364F       2 00002280 00000001     H   18508 18482B
 $$$365F       2 000022BE 00000001     H   18564 18538B
 $$$366B       4 000022CE 00000001     I   18602 18669
 $$$366F       2 000022F4 00000001     H   18663 18602B 18668
 $$$367E       2 000022F8 00000001     H   18676 18670
 $$$367F       2 00002360 00000001     H   18933 18672B
 $$$368B       4 00002304 00000001     I   18709 18739
 $$$368F       2 00002310 00000001     H   18731 18695B 18709B 18736
 $$$369B       4 000022FC 00000001     I   18695 18737
 $$$37B        4 0000033C 00000001     I    5267  5288
 $$$37E        2 00000338 00000001     H    5258  5252
 $$$37F        2 00000344 00000001     H    5283  5254B  5267B  5287
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  178
 $$$370E       2 00002314 00000001     H   18746 18738  18740
 $$$370F       2 00002360 00000001     H   18929 18742B
 $$$371F       2 00002324 00000001     H   18773 18761B
 $$$372B       4 00002334 00000001     I   18836 18859
 $$$372F       2 00002340 00000001     H   18856 18836B 18858
 $$$373E       2 00002344 00000001     H   18866 18860
 $$$373F       2 0000234C 00000001     H   18885 18862B
 $$$374F       2 00002560 00000001     H   19677 19120B 19413B
 $$$375F       2 000023CE 00000001     H   19124 19108B
 $$$376F       2 00002408 00000001     H   19188 19162B
 $$$377F       2 00002442 00000001     H   19241 19215B
 $$$378F       2 0000247C 00000001     H   19296 19270B
 $$$379F       2 000024BA 00000001     H   19349 19323B
 $$$380F       2 000024E8 00000001     H   19417 19387B
 $$$381F       2 0000254C 00000001     H   19613 19545B 19566B
 $$$384F       2 0000261E 00000001     H   19867 19799B
 $$$385F       2 00002618 00000001     H   19859 19824B
 $$$385S       2 000025FA 00000001     H   19816 19858B
 $$$387F       2 000027FC 00000001     H   20657 20028B 20357B 20517B
 $$$388B       4 00002652 00000001     I   19999 20160
 $$$388F       2 000026C8 00000001     H   20154 19999B 20159
 $$$389F       2 00002664 00000001     H   20032 20017B
 $$$39B        4 00000354 00000001     I    5318  5338
 $$$39E        2 00000348 00000001     H    5295  5289
 $$$39F        2 0000035C 00000001     H    5334  5291B  5318B  5337
 $$$39T        2 00000358 00000001     H    5321  5308B
 $$$390F       2 000026B4 00000001     H   20117 20091B
 $$$391E       2 000026CC 00000001     H   20167 20161
 $$$391F       2 00002706 00000001     H   20211 20163B
 $$$392F       2 00002706 00000001     H   20207 20181B
 $$$393B       4 0000270C 00000001     I   20238 20386
 $$$393F       2 0000276A 00000001     H   20380 20238B 20385
 $$$394F       2 0000274A 00000001     H   20281 20255B
 $$$395F       2 0000276A 00000001     H   20376 20324B
 $$$395S       2 0000274E 00000001     H   20287 20342B 20375B
 $$$398E       2 0000276E 00000001     H   20393 20387
 $$$398F       2 0000279E 00000001     H   20475 20389B
 $$$399F       2 0000279E 00000001     H   20471 20421B 20461B
 $$$399S       2 0000277A 00000001     H   20406 20441B 20470B
 $$$403B       4 000027A0 00000001     I   20488 20574
 $$$403F       2 000027DC 00000001     H   20568 20488B 20573
 $$$404F       2 000027B2 00000001     H   20521 20506B
 $$$405F       2 000027D2 00000001     H   20562 20547B
 $$$406E       2 000027E0 00000001     H   20581 20575
 $$$406F       2 000027FA 00000001     H   20632 20577B
 $$$407F       2 000027EE 00000001     H   20605 20596B
 $$$408F       2 000027FA 00000001     H   20628 20619B
 $$$410B       4 00002836 00000001     I   20769 20830
 $$$410F       2 00002852 00000001     H   20823 20769B 20829
 $$$411E       2 00002856 00000001     H   20837 20831
 $$$411F       2 0000286E 00000001     H   20888 20833B
 $$$412F       2 000028AC 00000001     H   21023 20996B
 $$$413F       2 00002978 00000001     H   21449 21193B
 $$$414F       2 00002978 00000001     H   21430 21145B 21415B
 $$$414S       2 000028E2 00000001     H   21136 21429B
 $$$416F       2 000028FE 00000001     H   21196 21179B
 $$$418F       2 00002930 00000001     H   21309 21272B
 $$$419F       2 00002946 00000001     H   21339 21326B
 $$$42E        2 00000360 00000001     H    5345  5339
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  179
 $$$42F        2 00000364 00000001     H    5357  5341B
 $$$422F       2 000029E4 00000001     H   21592 21566B
 $$$423F       2 00002AEE 00000001     H   21880 21870B
 $$$423S       2 000029F8 00000001     H   21636 21879B
 $$$424F       2 00002AE0 00000001     H   21852 21651B
 $$$425F       2 00002A52 00000001     H   21740 21714B
 $$$426F       2 00002AAE 00000001     H   21810 21784B
 $$$427F       2 00002AD6 00000001     H   21843 21828B
 $$$427S       2 00002ABA 00000001     H   21822 21842B
 $$$43F        2 0000037A 00000001     H    5400  5383B
 $$$431F       2 00002B68 00000001     H   22062 22036B
 $$$432F       2 00002B82 00000001     H   22122 22097B
 $$$432S       2 00002B6C 00000001     H   22084 22119B
 $$$436F       2 00002BD8 00000001     H   22227 22137B
 $$$437F       2 00002BD8 00000001     H   22223 22197B
 $$$439F       2 00002C5E 00000001     H   22404 22378B
 $$$440S       2 00002C6C 00000001     H   22428 22446B
 $$$444F       2 00002CE8 00000001     H   22602 22576B
 $$$445F       2 00002D02 00000001     H   22662 22637B
 $$$445S       2 00002CEC 00000001     H   22624 22659B
 $$$449F       2 00002D58 00000001     H   22767 22677B
 $$$45F        2 00000388 00000001     H    5430  5415B
 $$$450F       2 00002D58 00000001     H   22763 22737B
 $$$452F       2 00002DD8 00000001     H   22942 22916B
 $$$453S       2 00002DE6 00000001     H   22966 22984B
 $$$457F       2 00002E62 00000001     H   23140 23114B
 $$$458F       2 00002E7C 00000001     H   23200 23175B
 $$$458S       2 00002E66 00000001     H   23162 23197B
 $$$462F       2 00002ED2 00000001     H   23305 23215B
 $$$463F       2 00002ED2 00000001     H   23301 23275B
 $$$465F       2 00002F4C 00000001     H   23479 23453B
 $$$466S       2 00002F5A 00000001     H   23503 23521B
 $$$469F       2 000033FE 00000001     H   25502 23865B
 $$$470F       2 0000306E 00000001     H   23869 23797B
 $$$471F       2 000033E2 00000001     H   25440 23898B
 $$$471S       2 00003072 00000001     H   23892 25439B
 $$$473F       2 000033DA 00000001     H   25434 23919B
 $$$473S       2 00003080 00000001     H   23913 25433B
 $$$475F       2 000033D0 00000001     H   25426 23937B
 $$$475S       2 0000308A 00000001     H   23930 25425B
 $$$477B       4 000030FE 00000001     I   24162 24529
 $$$477F       2 000031D2 00000001     H   24526 24162B 24528
 $$$478F       2 000031D2 00000001     H   24522 24244B
 $$$478S       2 00003128 00000001     H   24237 24521B
 $$$48F        2 000003E4 00000001     H    5638  5473B
 $$$480E       2 000031D6 00000001     H   24536 24530
 $$$480F       2 0000327A 00000001     H   24803 24532B
 $$$481B       4 000032C0 00000001     I   24930 25002
 $$$481F       2 000032EA 00000001     H   24999 24930B 25001
 $$$482E       2 000032EE 00000001     H   25009 25003
 $$$482F       2 000033CC 00000001     H   25411 25005B
 $$$483F       2 000033CC 00000001     H   25407 25023B
 $$$483S       2 000032EE 00000001     H   25016 25406B
 $$$485B       4 00003378 00000001     I   25268 25334
 $$$485F       2 0000339E 00000001     H   25331 25268B 25333
 $$$486E       2 000033A2 00000001     H   25341 25335
 $$$486F       2 000033C4 00000001     H   25401 25337B
 $$$487F       2 00003598 00000001     H   26294 25787B
 $$$488F       2 00003598 00000001     H   26275 25615B 25634B
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  180
 $$$49B        4 000003C8 00000001     I    5574  5589
 $$$49F        2 000003CE 00000001     H    5586  5574B  5588
 $$$490F       2 0000349A 00000001     H   25791 25719B
 $$$491F       2 00003598 00000001     H   26271 25806B
 $$$491S       2 0000349A 00000001     H   25800 26270B
 $$$493B       4 000034A8 00000001     I   25848 25914
 $$$493F       2 000034CE 00000001     H   25911 25848B 25913
 $$$494E       2 000034D2 00000001     H   25921 25915
 $$$494F       2 000034F4 00000001     H   25981 25917B
 $$$495B       4 000034F8 00000001     I   25992 26058
 $$$495F       2 0000351E 00000001     H   26055 25992B 26057
 $$$496E       2 00003522 00000001     H   26065 26059
 $$$496F       2 00003544 00000001     H   26125 26061B
 $$$50E        2 000003D2 00000001     H    5596  5590
 $$$50F        2 000003E4 00000001     H    5634  5592B
 $$$51S        2 000003D6 00000001     H    5605  5625B
 $$$54B        4 000003E6 00000001     I    5649  5701
 $$$54F        2 00000410 00000001     H    5698  5649B  5700
 $$$55S        2 000003FE 00000001     H    5670  5688B
 $$$58E        2 00000414 00000001     H    5708  5702
 $$$58F        2 00000426 00000001     H    5745  5704B
 $$$59S        2 00000418 00000001     H    5716  5736B
 $$$63B        4 0000045E 00000001     I    5937  6041
 $$$63F        2 000004E0 00000001     H    6038  5937B  6040
 $$$64F        2 000004A0 00000001     H    5983  5957B
 $$$65F        2 000004E0 00000001     H    6034  5996B  6008B
 $$$67E        2 000004E4 00000001     H    6048  6042
 $$$67F        2 000004E8 00000001     H    6055  6044B
 $$$68F        2 00000522 00000001     H    6095  6069B
 $$$69F        2 0000055C 00000001     H    6135  6109B
 $$$70S        2 00000578 00000001     H    6209  6231B
 $$$73S        2 00000598 00000001     H    6254  6272B
 $$$76F        2 00000694 00000001     H    6667  6337B  6362B
 $$$76S        2 000005B6 00000001     H    6294  6314B  6392B
 $$$77F        2 000005C6 00000001     H    6318  6306B
 $$$78F        2 000005D0 00000001     H    6341  6329B
 $$$79F        2 000005E4 00000001     H    6366  6354B
 $$$80F        2 00000602 00000001     H    6396  6384B
 $$$81F        2 00000658 00000001     H    6536  6414B
 $$$82F        2 00000658 00000001     H    6532  6457B  6480B  6492B
 $$$82S        2 0000060C 00000001     H    6424  6439B  6517B  6531B
 $$$88S        2 00000658 00000001     H    6543  6658B
 $$$92B        4 000006CC 00000001     I    6847  6898
 $$$92F        2 0000070E 00000001     H    6895  6847B  6897
 $$$93F        2 0000070E 00000001     H    6891  6865B
 $$$94E        2 00000712 00000001     H    6905  6899
 $$$94F        2 00000716 00000001     H    6912  6901B
 $$$95F        2 0000074E 00000001     H    6950  6924B
 $$$96F        2 00000788 00000001     H    6989  6963B
 $$$97F        2 000007C2 00000001     H    7029  7003B
 $$$98F        2 00000822 00000001     H    7165  7090B  7113B  7125B
 $$$98S        2 000007D6 00000001     H    7057  7072B  7150B  7164B
 #GRCAN       32 00000000 FFFFFFA3     J    7370  7417U  7486
 #GRGET        1 00000000 FFFFFFA5     J    4765  4812U
 #GRGETF       1 00000000 FFFFFFA5     R    4752  4756
 #GRGETW     128 00000000 FFFFFFA5         4756  5369M  5426M  5472
 #GRREL        1 00000000 FFFFFFA4     J    5823  5870U  6286   6780U  7048
 #LQEGET      32 00000000 FFFFFF9B     J   14694 14742U 14788  14923U
 #QUEBP        4 00000004 FFFFFFA9     A    3878  7952   7970   8016   8225   8267   8470   8509   8531   8535
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  181
 #QUEFP        4 00000000 FFFFFFA9     A    3877  7969   8011   8207   8224   8270   8471   8508   8530   8534
 #QUEPLO     144 00000000 FFFFFFAA     J    3856  7921U  7960M  7960   7963M  7966M  7968M  7969M  7970M  7988M  7989M
                                                  7990M  8010M  8011M  8012M  8014M  8015M  8016M  8027M  8067   8176U
                                                  8215M  8215   8218M  8221M  8223M  8224M  8225M  8243M  8244M  8245M
                                                  8265M  8266M  8267M  8269M  8270M  8271M  8282M  8322   8431U  8479M
                                                  8479   8482M  8485M  8487M  8507M  8508M  8509M  8529M  8530M  8531M
                                                  8533M  8534M  8535M  8546M  8586
 #QUESEQ       4 00000008 FFFFFFA9     A    3879  8027M  8282M  8546M
 #QUEW        16 00000000 FFFFFFA9     J    3887  7929U  7937U  7945U  8025   8184U  8192U  8200U  8280   8439U  8447U
                                                  8455U  8463U  8544
 #SLKPSWM      1 00000000 FFFFFF9E     R   11946 11954  11963  11972  12138M
 #SLOCK        1 00000000 FFFFFF9E     J   11981 12028U
 @AWAIT        5 00000000 FFFFFFD0     J    2627  5491U  5499M  5499   9334U  9342M  9342  12880U 12888M 12888  20953U
                                                 20961M 20961
 @AWTECB       4 00000000 FFFFFFD0     A    2611  5516M  9359M 12905M 20978M
 @AWTFLG       1 00000004 FFFFFFD0     R    2614  2618
 @AWTLONG    128 00000004 FFFFFFD0         2618  5522M  9365M
 @DEQCAN     128 00000038 FFFFFF99        15181 17734  17824
 @DEQFL        1 00000038 FFFFFF99     R   15177 15181
 @DEQID        4 00000000 FFFFFF99     A   15172 17246  19847M
 @DEQQNM       8 00000004 FFFFFF99     C   15173 17278
 @DEQRNM      44 0000000C FFFFFF99     C   15174 17280
 @DEQUEUE     57 00000000 FFFFFF99     J   15190 17216U 19838U 19846M 19846
 @DISPSAS      4 00000000 FFFFFFDD     A    2289 12737M 13685M
 @DISPSWP      4 00000000 FFFFFFDD     J    2296 12724U 12732M 12732  13672U 13680M 13680
 @ENQASCN     13 00000000 FFFFFF8C     J   15651 16052U 16060M 16060  17023U 17031M 17031  17237U 17245M 17245  18184U
                                                 18192M 18192  19071U 19079M 19079  19941U
 @ENQCQNM      8 00000000 FFFFFF8B     C   15669 16441M 21748  21867
 @ENQFL        1 00000038 FFFFFF9A     R   15130 15134  15139  15144
 @ENQHALT     52 00000000 FFFFFF97     J   15257 19054U
 @ENQID        4 00000000 FFFFFF9A     A   15123 16061
 @ENQPOST      9 00000000 FFFFFF8D     J   15605 17862U 17870M 17870  17956U 17964M 17964  18634U 18642M 18642  19584U
                                                 19592M 19592  21108U
 @ENQQNM       8 00000004 FFFFFF9A     C   15124 16109  16441
 @ENQRNM      44 0000000C FFFFFF9A     C   15125 16111  16511  16513  16583  16626
 @ENQSHR     128 00000038 FFFFFF9A        15134 16152  16244M 16267M 16325M 16348M 16398
 @ENQSUSP     64 00000038 FFFFFF9A        15139 16895
 @ENQTEST     32 00000038 FFFFFF9A        15144 16073  16126  16204
 @ENQUEUE     57 00000000 FFFFFF9A     J   15154 16031U
 @ENQWAIT      5 00000000 FFFFFF8E     J   15565 16913U 16921M 16921  18901U 18909M 18909  20717U
 @EQHQNM       8 00000000 FFFFFF97     C   15249 19080
 @EQHRNM      44 00000008 FFFFFF97     C   15250 19082
 @EQPCODE      4 00000004 FFFFFF8D     A   15584 17872M 17966M 18644M 19594M 21262  21383
 @EQPFALL     64 00000008 FFFFFF8D        15596 17878M 21411  21411  21412
 @EQPFLG       1 00000008 FFFFFF8D     R   15587 15591  15596
 @EQPFSHR    128 00000008 FFFFFF8D        15591 18013M 18650M 19600M 21178  21411  21411
 @EQPQRB       4 00000000 FFFFFF8D     A   15583 17871M 17965M 18643M 19593M 21113
 @EQSFADD    128 0000000C FFFFFF8C        15632 16138M 20016  20505  20618
 @EQSFDEL     64 0000000C FFFFFF8C        15637 17038M 17291M 20595
 @EQSFLG       1 0000000C FFFFFF8C     R   15628 15632  15637  15642
 @EQSFSHR     32 0000000C FFFFFF8C        15642 16164M 20546
 @EQSID        4 00000008 FFFFFF8C     A   15625 16091M 17032M 17262M 18209M 20215
 @EQSQNM       4 00000000 FFFFFF8C     A   15623 16110M 17279M 18226M 19081M 20400
 @EQSRNM       4 00000004 FFFFFF8C     A   15624 16112M 17281M 18228M 19083M 20401
 @EQWFHD     128 00000004 FFFFFF8E        15556 18916M 20768
 @EQWFLG       1 00000004 FFFFFF8E     R   15552 15556
 @EQWQOE       4 00000000 FFFFFF8E     A   15549 16922M 18910M 20722
 @EXRAFLG      1 00000014 FFFFFFCE     R    2688  2692   2697
 @EXRDCD       1 00000000 FFFFFFCC     R    2747  2756   2766
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  182
 @FINDQCB      8 00000000 FFFFFF8B     J   15676 16432U 16440M 16440  21508U
 @FREEQAO      4 00000000 FFFFFF88     J   15751 17067U 17075M 17075  17463U 17471M 17471  23395U
 @FREEQOE      4 00000000 FFFFFF89     J   15726 17099U 17107M 17107  17679U 17687M 17687  22858U
 @FREEQRB      4 00000000 FFFFFF8A     J   15701 17907U 17915M 17915  22320U
 @FRQAOP       4 00000000 FFFFFF88     A   15744 17076M 17472M 23483
 @FRQOEP       4 00000000 FFFFFF89     A   15719 17108M 17688M 22946
 @FRQRBP       4 00000000 FFFFFF8A     A   15694 17916M 22408
 @GRCANAS     32 00000008 FFFFFFE9         1777  7630
 @GRCID        4 00000000 FFFFFFE9     A    1758  4501
 @GRES         9 00000000 FFFFFFE9     J    1787  4284U  4588U  4805U  4812U  5863U  5870U  6773U  6780U  7410U  7417U
 @GREXCL      64 00000008 FFFFFFE9         1772  5097
 @GRFLAG       1 00000008 FFFFFFE9     R    1763  1767   1772   1777
 @GRID         4 00000004 FFFFFFE9     A    1759  4617   4858   5922   6832   7444
 @GRWAIT     128 00000008 FFFFFFE9         1767  5382
 @HASH        13 00000000 FFFFFF96     J   15294 16502U 16510M 16510
 @HSHBLNK    128 0000000C FFFFFF96        15285 16522M
 @HSHFL        1 0000000C FFFFFF96     R   15281 15285
 @HSHLEN       4 00000004 FFFFFF96     A   15277 16514M
 @HSHSTR       4 00000000 FFFFFF96     A   15276 16512M
 @HSHVAL       4 00000008 FFFFFF96     A   15278 16516M
 @LFSPIN     128 00000010 FFFFFFC3         3126 10834  11012
 @LOCKCRE     17 00000000 FFFFFFC3     J    3135 10782U 15912U 15920M 15920  21761U 21769M 21769
 @LOCKFL       1 00000010 FFFFFFC3     R    3122  3126
 @LOCKID       4 00000000 FFFFFFC2     A    3147 11394  12031  13079  16482M 16716M 16858M 16999M 17607M 18068M 18584M
                                                 18953M 19369M 19401M 19633M 20923M 21609M 21903M
 @LOCKNAM     16 00000000 FFFFFFC3     C    3119 11002  15926M 21770M
 @LOCKS        4 00000000 FFFFFFC2     J    3154 11351U 12021U 12028U 13071U 16476U 16710U 16993U 17601U 18062U 18578U
                                                 18947U 19363U 19627U 20917U 21603U 21897U
 @LQEGET       4 00000000 FFFFFF9C     J   14675 14151U 14159M 14159  14440U 14448M 14448  14735U 14742U
 @LQENUM       4 00000000 FFFFFF9C     A   14668 14169M 14458M 14786
 @PAGE         9 00000000 FFFFFFAE     J    3771  8934U  8942M  8942   9820U  9828M  9828
 @PAGKEY       1 00000008 FFFFFFAE     X    3763  3764
 @PAGLEN       4 00000004 FFFFFFAE     A    3762  8957M  9838M
 @PAGLOC       4 00000000 FFFFFFAE     A    3761  8952M  9833M
 @PDF1         1 00000009 FFFFFFB2     R    3667  3668   3673
 @QUE         16 00000000 FFFFFFEA     J    1651  5127U  5135M  5135   6173U  7505U  7513M  7513   7914U  7921U  8169U
                                                  8176U  8424U  8431U  9210U  9605U
 @QUEITM       4 00000008 FFFFFFEA     A    1643  5148M  6204M  7664M  7950   8205   8468   9241M  9629M  9659
 @QUELHD       4 0000000C FFFFFFEA     A    1644  5165M  6193M  7530M  7951   8206   8469   9230M  9624M
 @QUESEQ       8 00000000 FFFFFFEA     D    1642  5137M  6176M  7538M  7694   7962   8067M  8217   8322M  8481   8586M
                                                  9213M  9607M
 @RA           0 00000000 FFFFFFFC     @    1035 13321  16653  16696M 20438  20535  23924  25427
 @RB           0 00000000 FFFFFFFB     @    1047 20458  20536  22104  22644  23182
 @REQFL        1 00000038 FFFFFF98     R   15213 15217  15222
 @REQID        4 00000000 FFFFFF98     A   15208 18193
 @REQQNM       8 00000004 FFFFFF98     C   15209 18225
 @REQRNM      44 0000000C FFFFFF98     C   15210 18227
 @REQSHR     128 00000038 FFFFFF98        15217 18357  18383  18835
 @REQSUSP     64 00000038 FFFFFF98        15222 18760
 @REQUEUE     57 00000000 FFFFFF98     J   15231 18167U
 @RM           0 00000000 FFFFFFF6     @    1107  9852   9860M
 @RN           0 00000000 FFFFFFF5     @    1119  9570
 @RS           0 00000000 FFFFFFFD     @    1023 10114  13205  21833  21834M 21835M 21836
 @RY           0 00000000 FFFFFFF7     @    1095 10489
 @R0           0 00000000 FFFFFFFE     @     715   991U
 @R1           0 00000000 FFFFFFFD     @     728   987U  4199U  4337U  4641U  4921U  6160U 12579U 13655U 14913U 14964U
                                                 15020U 16694U 18041U 20149U 20818U 20882U 20934U
 @R10          0 00000000 FFFFFFF4     @     845   951U  4216U  4529U  4713U  5783U  6712U  7329U  7846U  8104U  8359U
                                                  8631U  9490U  9942U 10563U 11291U 11874U 12971U 13731U 14294U 14515U
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  183
                                                 14648U 15060U 15971U 17155U 18103U 18993U 19675U 19879U 20655U 21046U
                                                 21447U 21930U 22259U 22473U 22797U 23011U 23334U 23548U 25500U 26292U
 @R11          0 00000000 FFFFFFF3     @     858   947U
 @R12          0 00000000 FFFFFFF2     @     871   943U  4524U  4708U  5778U  6707U  7324U  7841U  8099U  8354U  8626U
                                                  9485U  9937U 10558U 11286U 11869U 12966U 13726U 15055U 17150U 18098U
                                                 18988U 19670U 20650U 21041U 21442U 21925U 22468U 23006U 23543U 25495U
                                                 26287U
 @R13          0 00000000 FFFFFFF1     @     884   939U  4227U  4540U  5124U  5488U  5536U  5794U  6555U  6582U  6723U
                                                  7221U  7340U  7712U  7739U  7857U  9100U  9207U  9331U  9379U  9501U
                                                  9682U  9712U  9817U  9953U 10574U 11175U 11219U 11302U 11696U 11804U
                                                 11885U 12877U 12982U 13669U 13742U 14148U 14230U 14305U 14526U 15071U
                                                 15909U 15982U 16429U 16473U 16499U 16707U 16910U 16990U 17020U 17064U
                                                 17096U 17166U 17460U 17598U 17676U 17859U 17904U 17953U 18059U 18114U
                                                 18575U 18631U 18898U 18944U 19004U 19360U 19483U 19581U 19624U 19686U
                                                 19890U 20666U 20950U 21010U 21057U 21458U 21672U 21758U 21894U 21941U
                                                 22270U 22808U 23345U 24098U 24177U 24259U 24309U 24816U 24866U 25038U
                                                 25088U 25511U 26303U
 @R14          0 00000000 FFFFFFF0     @     897   935U  9468M  9468  10520  10521M 10534M 10545M 16846U 17638U 17777U
                                                 18800U 19444U 21225U 21304U
 @R15          0 00000000 FFFFFFEF     @     910   931U  8767  17662U 17801U 18824U 19468U 21249U 22431  22969  23506
 @R2           0 00000000 FFFFFFFC     @     741   983U  9480U  9932U 10553U 11139U 11260U 12688U 12774U 13552U 13711U
                                                 13980U 15958U 19775U 19874U 22249U 22458U 22787U 22996U 23324U 23533U
                                                 25591U 26282U
 @R3           0 00000000 FFFFFFFB     @     754   979U 12942U 18083U 18968U 19655U 26267U
 @R4           0 00000000 FFFFFFFA     @     767   975U  4514U  4698U  5768U  6697U  7314U  7836U 11755U 17140U 18088U
                                                 18973U 19660U 20372U 21031U 21437U 25417U 26262U
 @R5           0 00000000 FFFFFFF9     @     780   971U 17145U 17357U 18983U 19151U 20303U 20640U 20793U 20857U 21036U
                                                 21426U 25422U
 @R6           0 00000000 FFFFFFF8     @     793   967U  4211U  4519U  4703U  5773U  6702U  7319U  9452U  9780U 11276U
                                                 11859U 12961U 13721U 17135U 17985U 18093U 18978U 19665U 19972U 20645U
                                                 21915U 23087U 23329U 23426U 23538U 25485U
 @R7           0 00000000 FFFFFFF7     @     806   963U  9004U  9457U 10810U 11281U 11379U 11864U 12187U 12449U 12608U
                                                 12947U 13490U 13695U 14289U 14367U 14510U 14588U 14643U 14768U 15050U
                                                 15966U 16669U 17130U 21539U 21920U 22009U 22254U 22351U 22463U 22549U
                                                 22792U 22889U 23001U 23667U 25490U
 @R8           0 00000000 FFFFFFF6     @     819   959U  5763U  6692U  7309U  7831U 12919U 14281U
 @R9           0 00000000 FFFFFFF5     @     832   955U
 @SBFADR       4 00000004 FFFFFFE6     A    2039  9568   9701   9833   9847
 @SBFIX       32 00000008 FFFFFFE8         1986 10166  10306
 @SBFPOO       4 00000000 FFFFFFE6     A    2038  9567
 @SBFREE       8 00000000 FFFFFFE6     J    2046  9549U
 @SBGADR       4 00000004 FFFFFFE7     A    2013  8833M  9405M  9461
 @SBGET       12 00000000 FFFFFFE7     J    2021  8747U
 @SBGLEN       4 00000008 FFFFFFE7     A    2014  8768M
 @SBGLHI      64 00000008 FFFFFFE8         1981 10291
 @SBGPOO       4 00000000 FFFFFFE7     A    2012  8765
 @SBICNT       4 00000004 FFFFFFE8     A    1967 10184
 @SBIFLG       1 00000008 FFFFFFE8     R    1970  1975   1981   1986
 @SBILEN       4 00000000 FFFFFFE8     A    1966 10113
 @SBINIT       9 00000000 FFFFFFE8     J    1995 10002U
 @SBLSYS     128 00000008 FFFFFFE8         1975 10224
 @SDF1         1 00000009 FFFFFFB1     R    3699  3700
 @SEG         13 00000000 FFFFFFBD     J    3310 23693U 23701M 23701  23762M 23762  23814M 23814  23970M 23970  24035M
                                                 24035  24180U 24188M 24188  24312U 24320M 24320  24378M 24378  24432M
                                                 24432  24491M 24491  24549M 24549  24603M 24603  24661M 24661  24715M
                                                 24715  24774M 24774  24869U 24877M 24877  24947M 24947  25091U 25099M
                                                 25099  25157M 25157  25211M 25211  25285M 25285  25355M 25355  25453M
                                                 25453  25651U 25659M 25659  25736M 25736  25865M 25865  25935M 25935
                                                 26009M 26009  26079M 26079  26138M 26138  26203M 26203
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  184
 @SEGB       128 0000000C FFFFFFBD         3270  3285   3285  24018M 26186M
 @SEGCB        4 00000000 FFFFFFBD     A    3261 23739M 23777M 23852M 24012M 24077M 24226M 24362M 24416M 24474M 24506M
                                                 24587M 24645M 24699M 24757M 24789M 24915M 24985M 25141M 25195M 25253M
                                                 25323M 25393M 25468M 25697M 25774M 25903M 25973M 26047M 26117M 26180M
                                                 26245M
 @SEGCCB       4 00000000 FFFFFFBB     A    3344 24133M 24294M 24851M 25073M
 @SEGCNUM      4 00000004 FFFFFFBB     A    3345 24126M 24287M 24844M 25066M
 @SEGCOL       8 00000000 FFFFFFBB     J    3352 24101U 24109M 24109  24262U 24270M 24270  24819U 24827M 24827  25041U
                                                 25049M 25049
 @SEGEOR      16 0000000C FFFFFFBD         3296 23745M 23783M 23858M 24083M 24512M 24795M 24991M 25474M 25703M 25780M
                                                 26251M
 @SEGLEN       4 00000008 FFFFFFBD     A    3263 23732M 23770M 23770  23845M 24005M 24070M 24219M 24355M 24409M 24467M
                                                 24499M 24499  24580M 24638M 24692M 24750M 24782M 24782  24908M 24978M
                                                 25134M 25188M 25246M 25316M 25386M 25461M 25461  25690M 25767M 25896M
                                                 25966M 26040M 26110M 26173M 26238M
 @SEGLOC       4 00000004 FFFFFFBD     A    3262 23715M 23828M 23988M 24053M 24202M 24338M 24392M 24450M 24563M 24621M
                                                 24675M 24733M 24891M 24961M 25117M 25171M 25229M 25299M 25369M 25673M
                                                 25750M 25879M 25949M 26023M 26093M 26156M 26221M
 @SEGT        64 0000000C FFFFFFBD         3275  3285   3285
 @SEGTYPE      1 0000000C FFFFFFBD     R    3266  3270   3275   3286   3291   3296   3301
 @SEGXFLG      1 0000000D FFFFFFBA     R    3370  3374   3379   3384   3389   3394
 @SGASB        4 0000000C FFFFFFCF     A    2649  6625M  7264M  7782M  9760M 19521M 21388M
 @SGCODE       8 00000000 FFFFFFCF     D    2644  6620M  7259M  7777M  9750M 19516M 21383M
 @SGECB        4 00000008 FFFFFFCF     A    2645  6610M  7249M  7767M  9740M 11247M 13634M 19511M 21378M
 @SGSRID       4 00000010 FFFFFFCF     A    2650  6635M  7274M  7792M  9770M 19526M 21393M
 @SIGNAL      20 00000000 FFFFFFCF     J    2658  6585U  6593M  6593   7224U  7232M  7232   7742U  7750M  7750   9715U
                                                  9723M  9723  11222U 11230M 11230  13609U 13617M 13617  19486U 19494M
                                                 19494  21353U 21361M 21361
 @SUSPFLG      1 00000008 FFFFFFDF     R    2225  2229   2234   2239
 @SWFLG        1 00000004 FFFFFFB5     R    3562  3571   3581   3591
 @SYSRDEL      4 00000000 FFFFFFD6     J    2472  5539U  5547M  5547   9382U  9390M  9390  11699U 11707M 11707  21013U
 @SYSRDID      4 00000000 FFFFFFD6     A    2465  5557M  9400M 11712M 21015M
 @SYSRNEW      4 00000000 FFFFFFD7     J    2450  6558U  6566M  6566   7197U  7205M  7205   7715U  7723M  7723   9685U
                                                  9693M  9693  11178U 11186M 11186
 @TCRFLAG      1 00000014 FFFFFFDB     R    2340  2344   2349
 @VMFLEN       4 00000004 FFFFFFE3     A    2127 11566M 11832M 14258M
 @VMFLOC       4 00000000 FFFFFFE3     A    2126 11577M 11843M 14269M
 @VMFPOOL      2 00000008 FFFFFFE3     H    2128 11578M 11844M 14270M
 @VMFREE      10 00000000 FFFFFFE3     J    2135 11541U 11549M 11549  11807U 11815M 11815  14233U 14241M 14241
 @VMGET       11 00000000 FFFFFFE4     J    2114  4102U  4110M  4110   4421U  4429M  4429   5005U  5013M  5013   9103U
                                                  9111M  9111  10036U 10044M 10044  10247M 10247  10329M 10329  10383M
                                                 10383  10856U 10864M 10864  10919M 10919  13861U 13869M 13869  14002M
                                                 14002  14824U 14832M 14832  15812U 15820M 15820  20052U 20060M 20060
                                                 21675U 21683M 21683  22158U 22166M 22166  22698U 22706M 22706  23236U
                                                 23244M 23244
 @VMGFLG       1 0000000A FFFFFFE4     R    2096  2100   2105
 @VMGLEN       4 00000000 FFFFFFE4     A    2091  4127M  4446M  5030M  9128M 10061M 10257M 10339M 10393M 10881M 10936M
                                                 13886M 14019M 14849M 15837M 20077M 21700M 22183M 22723M 23261M
 @VMGPAGE    128 0000000A FFFFFFE4         2100 10264M 10346M 10400M
 @VMGPOOL      2 00000008 FFFFFFE4     H    2093  4128M  4447M  5031M  9129M 10062M 10258M 10340M 10394M 10882M 10937M
                                                 13887M 14020M 14850M 15838M 20078M 21701M 22184M 22724M 23262M
 @WSFLG        1 0000000C FFFFFFB3     R    3636  3640
 @XITMREQ      1 00000004 FFFFFFC7     R    2900  2909   2919   2929
 @XITNFL       1 00000000 FFFFFFCB     R    2793  2797
 ASB          68 00000000 FFFFFFEC     J    1467 12834U 19762U 19959U 20136U 23074U 23413U 25578U
 ASBENQ        4 00000028 FFFFFFEC     A    1452 19768  19965  20142M 23080  23419  25584
 ASBGCFLG      1 00000014 FFFFFFEC     R    1437  1441
 ASLOCK        1 00000000 0000000D     T   15091 15091  19695  23561
 ASULOCK       1 00000000 00000013     T   15100 15100  19696  23563
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  185
 AWAIT         1 00000000 00000003     T    8650  8650  10582  23569
 AWAITAS       1 00000000 0000000F     T   15093 15093
 B                        00000001 A   U    8455  8531
 BADSPIN       2 00001428 00000001     H   11909 11497B 11520B
 BADSUSP       2 000013F8 00000001     H   11890 11621B 11660B 11679B
 BR           10 0000000A FFFFFFFF A   #    1136  4055M  4065U  4258M  4268U  4562M  4572U  4779M  4789U  5837M  5847U
                                                  6747M  6757U  7384M  7394U  7888M  7898U  8143M  8153U  8398M  8408U
                                                  8721M  8731U  9523M  9533U  9976M  9986U 10756M 10766U 11325M 11335U
                                                 11995M 12005U 13045M 13055U 13824M 13834U 14326M 14336U 14547M 14557U
                                                 14709M 14719U 15775M 15785U 16005M 16015U 17190M 17200U 18141M 18151U
                                                 19028M 19038U 19734M 19744U 19915M 19925U 20691M 20701U 21082M 21092U
                                                 21482M 21492U 21965M 21975U 22294M 22304U 22505M 22515U 22832M 22842U
                                                 23043M 23053U 23369M 23379U 23610M 23620U 25534M 25544U
 CLKSCNT       1 00000032 FFFFFFA1 A   U   10633 14073
 CPLOCK        1 00000000 0000000C     T   15090 15090
 CPULOCK       1 00000000 00000010     T   15096 15096
 DEQUEUE       4 00001F08 00000001     I   17189 17184  17200U 23562
 DISPSHLD      1 00000000 0000000E     T   15092 15092
 DISPSREL      1 00000000 00000012     T   15099 15099
 ENQASCN       4 00002634 00000001     I   19914 16176  17046  17299  18244  19095  19925U
 ENQASCN7      2 00002628 00000001     H   19909 19908
 ENQASDMP      4 00003414 00000001     I   25533 25528  25544U
 ENQASTRM      4 000025D2 00000001     I   19733 19728  19744U
 ENQDUMP       4 00002FE0 00000001     I   23609 23604  23620U
 ENQDWORK      4 00000000 FFFFFF95     J   15319 23636U 25560U
 ENQHALT       4 00002384 00000001     I   19027 19022  19038U
 ENQINIT       4 00001BE4 00000001     I   15774 15769  15785U
 ENQPOST       4 000028C6 00000001     I   21081 17886  18025  18658  19608  21092U
 ENQPOST7      2 000028BA 00000001     H   21076 21075
 ENQUEUE       4 00001C88 00000001     I   16004 15999  16015U
 ENQWAIT       4 00002812 00000001     I   20690 16930  18924  20701U
 ENQWAIT7      2 00002806 00000001     H   20685 20684
 EPAR         15 0000000F FFFFFFFF A   #    1196  4055   4131M  4132B  4258   4450M  4451B  4562   4779   5034M  5035B
                                                  5437M  5438B  5525M  5526B  5560M  5561B  5837   6213M  6214B  6569M
                                                  6570B  6638M  6639B  6747   7208M  7209B  7277M  7278B  7384   7670M
                                                  7671B  7726M  7727B  7795M  7796B  7888   8143   8398   8721   8960M
                                                  8961B  9132M  9133B  9250M  9251B  9368M  9369B  9403M  9404B  9523
                                                  9635M  9636B  9696M  9697B  9773M  9774B  9841M  9842B  9976  10065M
                                                 10066B 10267M 10268B 10349M 10350B 10403M 10404B 10756  10885M 10886B
                                                 10940M 10941B 11059M 11060B 11189M 11190B 11250M 11251B 11325  11581M
                                                 11582B 11715M 11716B 11774M 11775B 11847M 11848B 11995  12442M 12443B
                                                 12494M 12495B 12740M 12741B 12908M 12909B 13045  13262M 13263B 13637M
                                                 13638B 13688M 13689B 13704M 13705B 13824  13890M 13891B 14023M 14024B
                                                 14177M 14178B 14273M 14274B 14326  14466M 14467B 14547  14709  14853M
                                                 14854B 15775  15841M 15842B 15929M 15930B 16005  16038M 16039B 16176M
                                                 16177B 16278M 16279B 16355M 16356B 16373M 16374B 16447M 16448B 16485M
                                                 16486B 16525M 16526B 16622M 16623B 16719M 16720B 16723M 16724B 16861M
                                                 16862B 16865M 16866B 16930M 16931B 16959M 16960B 17002M 17003B 17046M
                                                 17047B 17050M 17051B 17082M 17083B 17114M 17115B 17190  17223M 17224B
                                                 17299M 17300B 17304M 17305B 17478M 17479B 17610M 17611B 17696M 17697B
                                                 17886M 17887B 17924M 17925B 18025M 18026B 18071M 18072B 18141  18235M
                                                 18236B 18244M 18245B 18264M 18265B 18403M 18404B 18415M 18416B 18587M
                                                 18588B 18658M 18659B 18924M 18925B 18956M 18957B 19028  19086M 19087B
                                                 19095M 19096B 19115M 19116B 19372M 19373B 19404M 19405B 19408M 19409B
                                                 19529M 19530B 19608M 19609B 19636M 19637B 19643M 19644B 19734  19806M
                                                 19807B 19853M 19854B 19862M 19863B 19915  20081M 20082B 20532M 20533B
                                                 20691  20926M 20927B 20938M 20939B 20981M 20982B 21018M 21019B 21082
                                                 21333M 21334B 21396M 21397B 21482  21612M 21613B 21704M 21705B 21773M
                                                 21774B 21906M 21907B 21965  22187M 22188B 22294  22505  22727M 22728B
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  186
                                                 22832  23043  23265M 23266B 23369  23610  23748M 23749B 23786M 23787B
                                                 23861M 23862B 24021M 24022B 24086M 24087B 24136M 24137B 24229M 24230B
                                                 24297M 24298B 24365M 24366B 24419M 24420B 24477M 24478B 24515M 24516B
                                                 24590M 24591B 24648M 24649B 24702M 24703B 24760M 24761B 24798M 24799B
                                                 24854M 24855B 24918M 24919B 24994M 24995B 25076M 25077B 25144M 25145B
                                                 25198M 25199B 25256M 25257B 25326M 25327B 25396M 25397B 25477M 25478B
                                                 25534  25706M 25707B 25783M 25784B 25906M 25907B 25976M 25977B 26050M
                                                 26051B 26120M 26121B 26189M 26190B 26254M 26255B
 EQDUMPCB      4 00000000 FFFFFF95     A   15312 23739  23777  23852  24012  24077  24133  24226  24294  24362  24416
                                                 24474  24506  24587  24645  24699  24757  24789  24851  24915  24985
                                                 25073  25141  25195  25253  25323  25393  25468  25697  25774  25903
                                                 25973  26047  26117  26180  26245
 F                        00000001 A   U    8200  8225   8270
 F                        00000001 A   U    8463  8534
 FINDQCB       4 0000298E 00000001     I   21481 19698  21492U
 FINDQCB7      2 00002982 00000001     H   21476 21475
 FIRST                    00000001 A   U   16794 16807
 FREEQAO       4 00002EF6 00000001     I   23368 19702  23379U
 FREEQAO7      2 00002EEA 00000001     H   23363 23362
 FREEQOE       4 00002D82 00000001     I   22831 17696  19703  22842U
 FREEQOE7      2 00002D76 00000001     H   22826 22825
 FREEQRB       4 00002C08 00000001     I   22293 17924  22304U
 FREEQRB7      2 00002BFC 00000001     H   22288 22287
 GETQAO        4 00002E0C 00000001     I   23042 20532  23053U
 GETQAO7       2 00002E00 00000001     H   23037 23036
 GETQOE        4 00002C92 00000001     I   22504 19697  22515U
 GETQOE7       2 00002C86 00000001     H   22499 22498
 GETQRB        4 00002B12 00000001     I   21964 16622  21975U
 GETQRB7       2 00002B06 00000001     H   21959 21958
 GRCAH         8 00000018 FFFFFFA8     D    3915  4927   4954M  5664   5674M  6248   6258M
 GRCAHFP       4 00000018 FFFFFFA8     A    3916  5673   5673   6257   6257
 GRCAN         4 0000087C 00000001     I    7383  7378   7394U
 GRCAR         8 00000010 FFFFFFA8     D    3911  4343   4370M  4656   4666M
 GRCARFP       4 00000010 FFFFFFA8     A    3912  4665   4665
 GRCBID        4 00000000 FFFFFFA8     C    3907  4175M
 GRCRE         4 000000B2 00000001     I    4257  4252   4268U
 GRCT         32 00000000 FFFFFFA8     J    3925  4082U  4122   4174M  4174   4300U  4604U  4826U  5883U  6793U
 GRDEL         4 0000017A 00000001     I    4561  4556   4572U
 GRGET         4 000001D8 00000001     I    4778  4773   4789U
 GRHASB        4 00000014 FFFFFFA6     A    4020  5085M  6108   6625   7002   7264   7645   7782
 GRHBID        4 00000008 FFFFFFA6     C    3990  5083M  5661M  6068   6245M  6962   7695M
 GRHBP         4 00000004 FFFFFFA6     A    3988  6545   7187
 GRHFP         4 00000000 FFFFFFA6     A    3987  6430M  7063M  7582M
 GRHGRIT       4 00000010 FFFFFFA6     A    4018  5084M  6051   6908
 GRHITM       32 00000000 FFFFFFA6     J    4028  4844U  4852U  5025   5082M  5082   5660M  5660   5665   5673M  5901U
                                                  5909U  6244M  6244   6249   6257M  6811U  6819U  7363   7439U  7491U
                                                  7581M  7581
 GRHPIDP       8 00000018 FFFFFFA6     D    4021  5511   6605   7244   7762
 GRHRTN        3 0000000D FFFFFFA6     X    4016  5087M
 GRHXBS        1 0000000C FFFFFFA6     R    3994  3998   4003   4008   4013   5816   5917U  6342   6343M  6374   6377M
                                                  6463   6464M  6504   6508M  6827U  7096   7097M  7137   7141M
 GRHXCANC     16 0000000C FFFFFFA6         4013  5573   7701M
 GRHXEXCL     64 0000000C FFFFFFA6         4003  5109M  5305   5317   5995   6413   6477   6923   7037M  7110
 GRHXHOLD    128 0000000C FFFFFFA6         3998  5242M  5266   5279M  5330M  5353M  5394   5414   6353   6373M  6489
                                                  6503M  7122   7136M  7612
 GRHXX2S      32 0000000C FFFFFFA6         4008  6007   7043M
 GRIBID        4 00000000 FFFFFFA7     C    3945  4500M  4870   5185   5936   6846   7456
 GRICID        4 00000004 FFFFFFA7     A    3947  4501M  4652M
 GRIHCNT       4 00000008 FFFFFFA7     A    3949  5711   5722M
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  187
 GRIHL        16 00000010 FFFFFFA7     X    3954  4503   5160   6188   6288   7050   7485   7525
 GRIHLBP       4 00000014 FFFFFFA7     A    3956  4505M  5214
 GRIHLCNT      4 0000001C FFFFFFA7     A    3958  5230   5956   6864
 GRIHLFP       4 00000010 FFFFFFA7     A    3955  4504M  5944   6299M  6852   7181   7543M
 GRIHLSEQ      4 00000018 FFFFFFA7     A    3957  5136   6175   6287   6299M  6377M  6430M  6508M  7049   7063M  7141M
                                                  7537   7543M  7582M
 GRINIT        4 00000022 00000001     I    4054  4049   4065U
 GRITEM       32 00000000 FFFFFFA7     J    3966  4309U  4441   4499M  4499   4507   4613U  4650M  4650   4657   4665M
                                                  4835U  5892U  6802U  7430U
 GRIWCNT       4 0000000C FFFFFFA7     A    3950  5600   5611M
 GRREL         4 0000043E 00000001     I    5836  5831   5847U
 GRX2S         4 000006AC 00000001     I    6746  6741   6757U
 H                        00000001 A   U    4852  5266   5305
 H                        00000001 A   U    7937  7952   7970   8011   8025   8027
 H                        00000001 A   U    8192  8207   8224   8267   8280   8282
 H                        00000001 A   U    8447  8544   8546
 HASHIT        1 00000000 00000016     T   19700 19700
 HIBAL         1 00000000 FFFFFFFF     J     700   716    729    742    755    768    781    794    807    820    833
                                                   846    859    872    885    898    911   1012   1024   1036   1048
                                                  1060   1072   1084   1096   1108   1120   1132   1144   1156   1168
                                                  1180   1192   1204
 I                        00000001 A   U    8439  8470   8471   8508   8509   8530   8535
 L                        00000001 A   U    7945  7969   8016
 LCFOWNED     64 00000030 FFFFFFA0        10691 12527  12930M 13447M
 LCFSPIN     128 00000030 FFFFFFA0        10686 11023M 11460  12077  13105
 LKCRE         4 00001166 00000001     I   10755 10750  10766U
 LKCRE         1 00000000 00000014     T   19694 19694  23576
 LKDEL         4 000012BC 00000001     I   11324 11319  11335U
 LKFINIT     128 0000001C FFFFFFA1        10628 13953M
 LKINIT        4 000018B6 00000001     I   13823 13818  13834U
 LKIPARM      32 00000000 FFFFFF9D     J   13810 14014  14035U 14253
 LKIPWA        4 00000000 FFFFFF9D     X   13801 14045U
 LKOB          4 00001464 00000001     I   11994 11989  12005U
 LKOB          1 00000000 00000015     T   19699 19699  23574
 LKOBKAP       2 00001650 00000001     H   12987 12059B
 LKREL         4 000016BC 00000001     I   13044 13039  13055U
 LKREL         1 00000000 00000017     T   19701 19701  23568
 LKRKAP        2 0000184A 00000001     H   13747 13305B 13324B
 LKRKAP2       2 0000187A 00000001     H   13765 13121B 13358B
 LOCKCB       49 00000000 FFFFFFA0     J   10700 10876  10931  10990U 11000M 11000  11001M 11404U 11419  11447M 11561
                                                 11827  12041U 12056  12406  13089U
 LOCKCFL       1 00000030 FFFFFFA0     R   10682 10686  10691
 LOCKCNT       4 00000020 FFFFFFA0     A   10673 12463  12464M 12563  12564M 12924M 13129  13131M 13373  13375M
 LOCKCT       29 00000000 FFFFFFA1     J   10640 10821U 11390U 12198U 12619U 13501U 13881  13936U 13946M 13946  13947M
                                                 14378U 14599U 14779U
 LOCKCTL       8 00000018 FFFFFFA0     D   10664 10668  11466  11507M 12086  12247M 12308  12352M 12413  13118  13149
                                                 13213M
 LOCKECHN      4 00000010 FFFFFFA1     A   10619 14935  14968M
 LOCKECNT      1 00000028 FFFFFFA1 A   U   10632 14120
 LOCKFCNT      4 00000004 FFFFFFA1     A   10615 14182  14191M 14385  14395M 14471  14480M 14606  14617M
 LOCKFL        1 0000001C FFFFFFA1     R   10624 10628
 LOCKFLQE      4 00000008 FFFFFFA1     A   10617 11074  11143M 11719  11729M 12623  12692M 13505  13515M 14991  15024M
 LOCKNAME     16 00000004 FFFFFFA0     C   10659 11002M
 LOCKOWNR      4 0000001C FFFFFFA0     A   10670 11253M 12501  13301  13440M
 LOCKPLUM      4 00000018 FFFFFFA0     A   10669 11252M 11607  11608M 12745  12782M
 LOCKRCNT      4 0000002C FFFFFFA0     A   10679 12457  12458M 12935  12936M
 LOCKSCNT      4 00000018 FFFFFFA1     A   10621 12216  14091M
 LOCKSRID      4 00000024 FFFFFFA0     A   10674 11191M 11712
 LOCKWCNT      4 00000028 FFFFFFA0     A   10678 12129  12130M 12861  12862M
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  188
 LQE          32 00000000 FFFFFF9F     J   10732 11126U 11204U 11637U 12511U 12675U 12755U 12814U 13339U 13555U 13650U
                                                 14687  14804U 14844  14900M 14900  14901M 14923U 14951U 15007U
 LQEALL        4 000019EC 00000001     I   14325 11059  14320  14336U
 LQECHAIN      4 0000001C FFFFFF9F     A   10725 14891M 14957M
 LQEDALL       4 00001A58 00000001     I   14546 11774  14541  14557U
 LQEECB        8 00000008 FFFFFF9F     D   10720 11242  11665  12850  12900  13411  13629
 LQEGET        4 00001A9C 00000001     I   14708 14177  14466  14719U
 LQEGET7       2 00001A90 00000001     H   14703 14702
 LQEID         4 00000000 FFFFFF9F     C   10718 11653
 LQELOCK       4 00000004 FFFFFF9F     A   10719 11209M 12760M 12819M 13456M 13456  13571
 LQENEXT       4 00000018 FFFFFF9F     A   10724 11132  11726M 12681  12767M 12767  12818M 13439  13512M 14892M 14928
                                                 15013M
 LQEPID        8 00000010 FFFFFF9F     D   10721 12553  12820M 13355  13463M 13463
 MAT         256 00000000 FFFFFFED     J    1409  4186U  4324U  4628U  4908U  6147U  8991U 10797U 11366U 12174U 12595U
                                                 13477U 13967U 14354U 14575U 14755U 15945U 21526U 21996U 22338U 22536U
                                                 22876U 23654U
 MATGRCT       4 00000038 FFFFFFED     A    1374  4192M  4330   4634   4914   6153
 MATLCT        4 00000014 FFFFFFED     A    1365 10803  11372  12180  12601  13483  13973M 14360  14581  14761
 MATPTR        4 00000200 FFFFFFED A   A    1356  4176   4314   4618   4898   6137   8981  10787  11356  12164  12585
                                                 13467  14344  14565  14745
 MATQCT        4 00000018 FFFFFFED     A    1366 15951M 21532  22002  22344  22542  22882  23660
 MATSBWB       4 00000020 FFFFFFED     A    1368  8997
 MITMK1        1 00000000 FFFFFFC6     R    2973  2977   2982   2987   2992   2997   3002   3007   3012
 MITMK2        1 00000001 FFFFFFC6     R    3018  3022   3027   3032
 N                        00000001 A   U    5909  6463   6508
 N                        00000001 A   U    6819  7096   7141
 PAGFIX        1 00000000 00000008     T   10578 10578
 PAGUFIX       1 00000000 0000000A     T   10588 10588
 PARMFINT      4 00000000 FFFFFFB6         3506 14053M 14101M
 PARMIN        4 00000000 FFFFFFB6     J    3537 13801  14045U 14062  14069  14109  14116
 PARMKEYS      4 00000004 FFFFFFB6     A    3530 14054M 14055M 14102M
 PARMTYPE      1 00000000 FFFFFFB6     R    3487  3496   3506   3516   3526
 PSWEX         1 00000000 FFFFFF9E        11972 12153  12153  12154  12154
 PSWIO         2 00000000 FFFFFF9E        11963 12152  12152  12154  12154
 PSWPER       64 00000000 FFFFFF9E        11954 12152  12152  12153  12153  12155
 PZABORT     128 0000021A FFFFFFEE         1309  4156M  4475M  4886M  5059M  5201M  5972M  6023M  6084M  6124M  6880M
                                                  6939M  6978M  7018M  7472M  9157M 10090M 10145M 10434M 10469M 10969M
                                                 11105M 11435M 11898M 11917M 12654M 12995M 13014M 13427M 13587M 13755M
                                                 13773M 13915M 14879M 15866M 17383M 17436M 17523M 17576M 18316M 18445M
                                                 18497M 18553M 19177M 19230M 19285M 19338M 20106M 20196M 20270M 21581M
                                                 21729M 21799M 22051M 22212M 22393M 22591M 22752M 22931M 23129M 23290M
                                                 23468M
 PZABR15       4 0000021C FFFFFFEE     A    1318  4157M  4476M  4887M  5060M  5202M  5973M  6024M  6085M  6125M  6881M
                                                  6940M  6979M  7019M  7473M  9158M 10091M 10146M 10435M 10470M 10970M
                                                 11106M 11436M 11899M 11918M 12655M 12996M 13015M 13428M 13588M 13756M
                                                 13774M 13916M 14880M 15867M 17384M 17437M 17524M 17577M 18317M 18446M
                                                 18498M 18554M 19178M 19231M 19286M 19339M 20107M 20197M 20271M 21582M
                                                 21730M 21800M 22052M 22213M 22394M 22592M 22753M 22932M 23130M 23291M
                                                 23469M
 PZABSM        1 0000021B FFFFFFEE     X    1317  4150M  4469M  4880M  5053M  5195M  5966M  6017M  6078M  6118M  6874M
                                                  6933M  6972M  7012M  7466M  9151M 10084M 10139M 10428M 10463M 10963M
                                                 11099M 11429M 11892M 11911M 12648M 12989M 13008M 13421M 13581M 13749M
                                                 13767M 13909M 14873M 15860M 17377M 17430M 17517M 17570M 18310M 18439M
                                                 18491M 18547M 19171M 19224M 19279M 19332M 20100M 20190M 20264M 21575M
                                                 21723M 21793M 22045M 22206M 22387M 22585M 22746M 22925M 23123M 23284M
                                                 23462M
 PZCPUMSK      4 00000214 FFFFFFEE     A    1297 12083  13118
 PZCURASB      4 00000208 FFFFFFEE     A    1294  5085   6108   7002   7645   9195  12737  12824  13685  19752  19949
                                                 20126  21313  23064  23403  25568
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  189
 PZCURPID      8 00000208 FFFFFFEE     D    1293 12553  12820  13355  22779
 PZERO       640 00000000 FFFFFFEE     J    1328  1338U
 PZLCPUA       4 00000210 FFFFFFEE     A    1296  4158   4477   4888   5061   5203   5974   6025   6086   6126   6882
                                                  6941   6980   7020   7474   9159  10092  10147  10436  10471  10971
                                                 11107  11437  11900  11919  12656  12997  13016  13429  13589  13757
                                                 13775  13917  14881  15868  17385  17438  17525  17578  18318  18447
                                                 18499  18555  19179  19232  19287  19340  20108  20198  20272  21583
                                                 21731  21801  22053  22214  22395  22593  22754  22933  23131  23292
                                                 23470
 PZMATP        4 00000200 FFFFFFEE     A    1291 13957  15935  21516  21986  22328  22526  22866  23644
 PZTERMFL      1 0000021A FFFFFFEE     R    1305  1309   1314
 QAO          65 00000000 FFFFFF8F     J   15531 16187U 17344U 18287U 19138U 20225U 20282  20306U 20367U 20395  20601M
                                                 23154U 23256  23315M 23315  23493U 25820U
 QAOCHN        4 00000004 FFFFFF8F     A   15511 20282  20321  20330  20395  20409  20563M 20601M 20601  23181  23505M
                                                 26256
 QAOFL         1 00000040 FFFFFF8F     R   15518 15522
 QAOID         4 00000000 FFFFFF8F     C   15510 20254  23316M 23497M
 QAOQNAME      8 0000000C FFFFFF8F     C   15513 20438  20535M 26151  26168
 QAOQOE        4 00000008 FFFFFF8F     A   15512 16415M 17350  18291  19144  25824
 QAORNAME     44 00000014 FFFFFF8F     C   15514 20458  20536M 26216  26233
 QAOSHR      128 00000040 FFFFFF8F        15522 16232  16313  18618M 18727M 18846M 18881M 20558M 25991
 QAS          16 00000000 FFFFFF90     J   15492 19786U 19983U 20072  20124M 20124  23098U 23113  23437U 23452  25602U
 QASCHN        4 00000004 FFFFFF90     A   15484 19822  20282  20395  20563  20564M 25717
 QASFQAO       8 00000008 FFFFFF90     D   15485 23144  23183M 23498  23507M
 QASID         4 00000000 FFFFFF90     C   15483 20125M 20180  25631
 QCB        1708 00000000 FFFFFF93     J   15380 16459U 17545U 18522U 19307U 20902U 21628U 21695  21741  21747M 23583
                                                 23883U
 QCBID         4 00000000 FFFFFF93     C   15367 17560  18537  19322
 QCBLOCK       4 0000000C FFFFFF93     A   15369 16482  16716  16858  16999  17607  18068  18584  18953  19369  19401
                                                 19633  20923  21811M
 QCBNAME       8 00000004 FFFFFF93     C   15368 21748M 21770  21770  21867  23983  24000
 QCBNEXT       4 00000010 FFFFFF93     A   15370 21638  21847M 23583  25435
 QCBNQRB       1 000000D3 FFFFFF93 A   U   15372 15373  16515  21815  23906
 QCBQRBS       4 00000014 FFFFFF93     A   15373 16531  21816  23907
 QCT          32 00000000 FFFFFF94     J   15349 15832  15887U 15897M 15897  15898M 21550U 21565  22020U 22035  22362U
                                                 22377  22560U 22575  22900U 22915  23678U
 QCTLOCK       4 00000004 FFFFFF94     A   15339 15931M 21609  21903
 QCTQCBS       4 00000008 FFFFFF94     A   15340 21617  21847  21848M 23873
 QCTQOES       8 00000018 FFFFFF94     D   15342 22606  22645M 22961  22970M
 QCTQRBS       8 00000010 FFFFFF94     D   15341 22066  22105M 22423  22432M
 QOE          37 00000000 FFFFFF91     J   15465 16385U 16794U 16833U 17404U 17625U 17649U 17988U 18036U 18337U 18787U
                                                 18811U 19198U 19431U 19455U 20732U 20796U 20813U 20860U 20877U 21160U
                                                 21212U 21236U 21291U 22616U 22718  22777M 22777  22956U 24148U 25834U
 QOEASB        4 00000010 FFFFFF91     A   15436 19521  21325  21388
 QOEBP         4 00000004 FFFFFF91     A   15432 16632M 16822M 17631M 18793M 19437M 20777M 20840M 20866M 21218M 21280M
 QOEECB        8 00000018 FFFFFF91     D   15437 19506  20973  21024  21373
 QOEFL         1 00000024 FFFFFF91     R   15442 15446  15451  15456
 QOEFP         4 00000000 FFFFFF91     A   15431 16631M 16820M 16839M 17615  17655M 18777  18817M 19421  19461M 20775M
                                                 20802M 20842M 21202  21242M 21278M 21297M 22643  22968M 24517  25402
 QOEID         4 00000008 FFFFFF91     C   15433 22778M 22960M
 QOEPID        8 00000010 FFFFFF91     D   15435 15436  22779M 24333  24445  24616  24728  25112  25224
 QOEQRB        4 0000000C FFFFFF91     A   15434 16635M 16744M 16848M 17411  18420  19205  20736
 QOESHR      128 00000024 FFFFFF91        15446 16410M 16780  16807  18001  18369  18395  18601  18612M 18720M 18852M
                                                 18874M 19544  19563  21190  24161  25267
 QOESYR        4 00000020 FFFFFF91     A   15438 19526  20986  21335M 21393
 QOEWAIT      64 00000024 FFFFFF91        15451 19386  20755M 21257M 25847
 QRB          76 00000000 FFFFFF92     J   15413 16543U 16672U 16689U 17492U 17764U 17788U 18466U 19254U 20746U 21123U
                                                 22076U 22178  22237M 22237  22418U 23951U
 QRBBP         4 00000004 FFFFFF92     A   15399 16652M 16678M 17770M
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  190
 QRBFP         4 00000000 FFFFFF92     A   15398 16553  16654M 17754  17794M 22103  22430M
 QRBID         4 00000008 FFFFFF92     C   15400 17507  18481  19269  22238M 22422M
 QRBNAME      44 00000018 FFFFFF92     C   15404 16583  16626M 24048  24065
 QRBOWNB       4 00000048 FFFFFF92     A   15406 16634M 16821  16823M 18708  21279  21281M
 QRBOWNF       4 00000044 FFFFFF92     A   15405 16630  16633M 16789  16819  17701  17713  18694  19534  21277  24138
                                                 24231
 QRBQCB        4 0000000C FFFFFF92     A   15401 16625M 17535  18512  19297  20892
 QRBWBP        4 00000014 FFFFFF92     A   15403 20776  20778M 22241M
 QRBWFP        4 00000010 FFFFFF92     A   15402 16750  16765  17722  17748  17841  17970  19553  20774  20839  20841
                                                 20884M 21127  21144  21150  22239  22240M 24804  24805
 QUEPUSH       4 00000A58 00000001     I    8142  8137   8153U
 QUEREM        4 00000B10 00000001     I    8397  8392   8408U  8657  10585
 QUEREM        1 00000000 00000005     T    8654  8654
 QUEUE         4 000009A0 00000001     I    7887  7882   7898U  8649
 QUEUE         1 00000000 00000009     T   10581 10581
 RA            2 00000002 FFFFFFFF A   #    1028  5136M  5137   6287M  6299M  6375   6377M  6397M  6430M  6505   6508M
                                                  6524M  7049M  7063M  7138   7141M  7157M  7537M  7538   7543M  7582M
                                                  7694M  7951M  7981   7988   8010   8206M  8236   8243   8265   8469M
                                                  8761U  8765M  9563U  9567M 10016U 10074M 11074M 11089M 11089  11126U
                                                 11143M 11204U 11252  11253  11466M 11479M 11479  11507M 11719M 11726
                                                 11729M 12086M 12101  12118M 12118  12225M 12225  12247M 12270M 12270
                                                 12308M 12317M 12317  12349  12352M 12375M 12375  12413M 12562M 12563M
                                                 12564  12623M 12638M 12638  12675U 12692M 12755U 12782  12818  13149M
                                                 13213M 13301M 13302M 13302  13339U 13515  13957M 13967U 14182M 14189
                                                 14191M 14385M 14392  14395M 14471M 14478  14480M 14606M 14613  14617M
                                                 14935M 14957  14968M 14991M 15013  15024M 15935M 15945U 16533M 16563
                                                 16609  16652  17701M 17713  17722M 17748  17841  19752M 19762U 19768M
                                                 19786U 19798M 19798  20400M 21127M 21144  22066M 22076U 22094M 22094
                                                 22105M 22136M 22136  22196M 22242  22408M 22418U 22432  22606M 22616U
                                                 22634M 22634  22645M 22676M 22676  22736M 22780  22946M 22956U 22970
                                                 23144M 23154U 23172M 23172  23183M 23214M 23214  23274M 23317  23483M
                                                 23493U 23507  23907M 23936  25427M 25568M 25578U 25584M 25602U 25614M
                                                 25614
 RAR          14 0000000E FFFFFFFF A   #    1184  4132M  4221B  4451M  4534B  4718B  5035M  5438M  5526M  5561M  5788B
                                                  6214M  6570M  6639M  6717B  7209M  7278M  7334B  7671M  7727M  7796M
                                                  7851B  8109B  8364B  8636B  8961M  9133M  9251M  9369M  9404M  9495B
                                                  9636M  9697M  9774M  9842M  9947B 10066M 10268M 10350M 10404M 10568B
                                                 10886M 10941M 11060M 11190M 11251M 11296B 11582M 11716M 11775M 11848M
                                                 11879B 12443M 12495M 12741M 12909M 12976B 13263M 13638M 13689M 13705M
                                                 13736B 13891M 14024M 14062M 14069M 14072  14109M 14116M 14119  14178M
                                                 14274M 14299B 14467M 14520B 14653B 14854M 15065B 15842M 15930M 15976B
                                                 16039M 16177M 16279M 16356M 16374M 16448M 16486M 16526M 16623M 16720M
                                                 16724M 16862M 16866M 16931M 16960M 17003M 17047M 17051M 17083M 17115M
                                                 17160B 17224M 17300M 17305M 17479M 17611M 17697M 17887M 17925M 18026M
                                                 18072M 18108B 18236M 18245M 18265M 18404M 18416M 18588M 18659M 18925M
                                                 18957M 18998B 19087M 19096M 19116M 19373M 19405M 19409M 19530M 19609M
                                                 19637M 19644M 19680B 19807M 19854M 19863M 19884B 20082M 20533M 20660B
                                                 20927M 20939M 20982M 21019M 21051B 21334M 21397M 21452B 21613M 21705M
                                                 21774M 21907M 21935B 22188M 22264B 22478B 22728M 22802B 23016B 23266M
                                                 23339B 23553B 23749M 23787M 23862M 24022M 24087M 24137M 24230M 24298M
                                                 24366M 24420M 24478M 24516M 24591M 24649M 24703M 24761M 24799M 24855M
                                                 24919M 24995M 25077M 25145M 25199M 25257M 25327M 25397M 25478M 25505B
                                                 25707M 25784M 25907M 25977M 26051M 26121M 26190M 26255M 26297B
 RB            3 00000003 FFFFFFFF A   #    1040  5136M  5137   6375M  6397   6505M  6524   7138M  7157   7537M  7538
                                                  7694M  7952M  7981   8014   8207M  8236   8269   8470M  8500   8507
                                                  8529  10212M 10500  10545  11074M 11142  11466M 11490M 11490  11719M
                                                 11728  12086M 12245  12308M 12350  12413M 12623M 12691  12745M 12782M
                                                 12814U 13149M 13164  13244M 13244  13513M 13514M 14073M 14086M 14091
                                                 14189M 14190M 14191  14392M 14394M 14395  14424M 14424  14478M 14479M
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  191
                                                 14480  14613M 14616M 14617  14935M 14967  14991M 15023  17535M 17545U
                                                 18512M 18522U 19297M 19307U 19822M 19823M 19823  19847  20401M 22066M
                                                 22431M 22606M 22969M 23144M 23506M 23906M 25429M 25717M 25718M 25718
                                                 25805M 25805  25820U 26256M
 REQUEUE       4 00002142 00000001     I   18140 18135  18151U
 RESMAN        1 00000000 00000001     J    1219  1216   1217   1221   1329   1410   1468   1595   1652   1788   1996
                                                  2022   2047   2073   2115   2136   2157   2186   2205   2249   2274
                                                  2297   2320   2359   2382   2405   2428   2451   2473   2499   2522
                                                  2545   2568   2594   2628   2659   2707   2730   2776   2807   2830
                                                  2856   2882   2939   3052   3075   3101   3136   3155   3183   3204
                                                  3226   3249   3311   3333   3353   3406   3425   3445   3474   3538
                                                  3601   3620   3650   3683   3710   3730   3750   3772   3793   3812
                                                  3832   3857   3888   3926   3967   4029   4766   5824   7371
 RESM00        1 00000000 00000001     R    1228  1226
 RJ            4 00000004 FFFFFFFF A   #    1052  4309U  4491M  4613U  4617M  4835U  4858M  5084   5892U  5923M  6051M
                                                  6669   6802U  6833M  6908M  7430U  7444M  8471M  8500   8533  11132M
                                                 11143  11502M 11507  11607M 11608M 11637U 11729  12244M 12247  12349M
                                                 12352  12681M 12692  13159M 13159  13213  13505M 13512  13515M 14928M
                                                 14968  15024  16375M 16385U 16415  16633  16634  16823  16839  16922
                                                 17108  17411M 17420M 17420  17492U 17871  17916  17965  18420M 18429M
                                                 18429  18466U 18643  19205M 19214M 19214  19254U 19593  20282M 20306U
                                                 20330M 20339M 20339  20408M 20601  20736M 20746U 21113M 21123U 24138M
                                                 24148U 24243  24517M 24804M 24929  25022  25402M 25824M 25834U
 RK            5 00000005 FFFFFFFF A   #    1064  5214M  6286M  7048M  7486M 11141M 11142M 11506M 11506  11606M 11606
                                                 11608  11665M 11666M 11727M 11728M 12245M 12246M 12350M 12351M 12690M
                                                 12691M 13164M 13189M 13189  13198M 13204M 13205M 13505M 13514  14786M
                                                 14787  14966M 14967M 15022M 15023M 16187U 16217M 16280  16298M 16357
                                                 16725  16867  16949  17032  17076  17301M 17317M 17317  17344U 17472
                                                 18256M 18287U 19107M 19138U 20215M 20225U 20237M 20237  20321  20395M
                                                 20408  20409M 20418M 20418  20487M 20487  20534M 20564  20624M 20633
                                                 20722M 20732U 20778  20802  20866  20884  21150M 21160U 21281  21297
                                                 23924M 23936  23951U
 RM            8 00000008 FFFFFFFF A   #    1100  4844U  5075M  5404   5901U  5922M  5923   5944M  6299M  6328   6526M
                                                  6640M  6655   6811U  6832M  6833   6852M  7159M  7181   7279M  7286
                                                  7439U  7543M  7575   7801M  9568M  9575M  9847M  9848  10499M 10499
                                                 10501M 12083M 12084  12101  12244  12351  12824M 12834U 14025M 14035U
 RN            9 00000009 FFFFFFFF A   #    1112  5362M  5362   5404M  5582M  5582   5648M  5648   5747   6430M  6454
                                                  6526   6545M  6640   7063M  7087   7159   7187M  7279   7582M  7801
                                                  9569M  9570M 10500M 10502  10503  12084M 12085M 12246
 RS            1 00000001 FFFFFFFF A   #    1016  4343M  4369   4664M  4927M  4953   5672M  6256M  8771M  8797   9022M
                                                  9048   9424M  9859M 10110M 10111  10112  10113M 10114M 10115  10117M
                                                 10183  10184M 10207M 10212  10213M 10214  10494M 10501  10511  11045M
                                                 11497M 11520M 11621M 11660M 11679M 11760M 12128M 12129M 12130  12456M
                                                 12457M 12458  12462M 12463M 12464  12501M 12511U 12538M 12538  12860M
                                                 12861M 12862  12934M 12935M 12936  13163M 13163  13197M 13252  13373M
                                                 13374M 13375  13384M 13384  13439M 13440  13555U 14788M 14804U 14893M
                                                 14951U 15007U 16061M 16084M 16084  16091  16109M 16110  16111M 16112
                                                 16511M 16512  16513M 16514  16515M 16516  16630M 16631  16632  16653M
                                                 16654  16672U 16750M 16765  16789M 17246M 17255M 17255  17262  17278M
                                                 17279  17280M 17281  17970M 17988U 18193M 18202M 18202  18209  18225M
                                                 18226  18227M 18228  19080M 19081  19082M 19083  20126M 20136U 20774M
                                                 20775  20776M 20777  20796U 20839M 20840  20841M 20842  20860U 20892M
                                                 20902U 21262M 21271M 21271  21313M 21325  21816M 21836M 22239M 22240
                                                 22241  23918M 23918  24231M 24243  24805M 24929  25022
 RVR           0 00000000 FFFFFFFF A   #    1004  4122M  4140   4204M  4204   4343M  4358M  4358   4367   4370M  4399M
                                                  4399   4441M  4459M  4459   4491   4507M  4657M  4666   4691M  4691
                                                  4927M  4942M  4942   4951   4954M  4983M  4983   5025M  5043M  5043
                                                  5075   5160M  5453M  5453   5511M  5665M  5674   5747M  6188M  6228M
                                                  6228   6249M  6258   6571   6605M  6669M  7210   7244M  7286M  7525M
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  192
                                                  7680M  7680   7728   7762M  7815M  7815   8044M  8044   8061M  8299M
                                                  8299   8316M  8563M  8563   8580M  8771M  8786M  8786   8795   8798M
                                                  8827M  8827   8833   9022M  9037M  9037   9046   9049M  9078M  9078
                                                  9123M  9141M  9141   9173   9225M  9265M  9265   9354M  9417M  9426
                                                  9473M  9473   9619M  9645M  9645   9698   9735M  9852M  9861   9925M
                                                  9925  10056M 10074  10453  10546M 10876M 10931M 10953  11191  11242M
                                                 11269M 11561M 11827M 12216M 12296M 12296  12406M 12900M 13129M 13130M
                                                 13131  13143M 13143  13267M 13267  13629M 13881M 13899  14014M 14025
                                                 14072  14086  14119  14133  14253M 14844M 14863M 14863  14891  14892
                                                 14893  15832M 15850  15931  16217  16280M 16298  16357M 16375  16449
                                                 16530M 16532  16624  16725M 16867M 16943M 16943  16949M 17119M 17119
                                                 17301  17323M 18076M 18076  18256  18266M 18405M 18766M 18961M 18961
                                                 19107  19117M 19410M 19506M 19648M 19648  20025M 20025  20072M 20090
                                                 20354M 20354  20514M 20514  20534  20633M 20973M 20986M 20995M 20995
                                                 21015  21024M 21335  21373M 21695M 21713  21783M 21783  21811  21815M
                                                 21827M 21827  21838M 21908M 22178M 22196  22242M 22718M 22736  22780M
                                                 23256M 23274  23317M 23710M 23727M 23823M 23840M 23983M 24000M 24048M
                                                 24065M 24121M 24197M 24214M 24282M 24333M 24350M 24387M 24404M 24445M
                                                 24462M 24558M 24575M 24616M 24633M 24670M 24687M 24728M 24745M 24839M
                                                 24886M 24903M 24956M 24973M 25061M 25112M 25129M 25166M 25183M 25224M
                                                 25241M 25294M 25311M 25364M 25381M 25668M 25685M 25745M 25762M 25874M
                                                 25891M 25944M 25961M 26018M 26035M 26088M 26105M 26151M 26168M 26216M
                                                 26233M
 RX            6 00000006 FFFFFFFF A   #    1076  4082U  4140M  4192   4300U  4330M  4604U  4634M  4826U  4914M  5883U
                                                  6153M  6342M  6343   6377M  6463M  6464   6508M  6793U  7096M  7097
                                                  7141M  7962M  7963   7964M  7964   7966   8217M  8218   8219M  8219
                                                  8221   8481M  8482   8483M  8483   8485   9173M  9183U  9659M  9669U
                                                 10453M 10486  10487  10510  10533M 10534  10953M 10990U 11209  11269
                                                 11394M 11404U 12031M 12041U 12760  12819  13079M 13089U 13571  14120M
                                                 14133M 14190  14430M 14479  14787M 16449M 16459U 16625  17350M 17367M
                                                 17367  17404U 17688  18291M 18300M 18300  18337U 18694  18708  18910
                                                 19144M 19161M 19161  19198U 19534M 19553M 19949M 19959U 19965M 19983U
                                                 19998M 19998  20090M 20142  21617M 21618M 21628U 21638M 21650M 21650
                                                 21713M 21848  21908  23064M 23074U 23080M 23098U 23403M 23413U 23419M
                                                 23437U 23873M 23883U 23897M 23897  25435M
 RY            7 00000007 FFFFFFFF A   #    1088  4857M  5087   6374M  6504M  7137M  7962M  7963   7965M  7965   7966
                                                  8217M  8218   8220M  8220   8221   8481M  8482   8484M  8485   8981M
                                                  8991U  8997M  9015U 10488M 10489M 10495  10520  10787M 10797U 10803M
                                                 10821U 11356M 11366U 11372M 11390U 12164M 12174U 12180M 12198U 12585M
                                                 12595U 12601M 12619U 13467M 13477U 13483M 13501U 13899M 13936U 13973
                                                 14344M 14354U 14360M 14378U 14565M 14575U 14581M 14599U 14745M 14755U
                                                 14761M 14779U 15850M 15887U 15951  16531M 16532M 16533  16543U 16553M
                                                 16563  16609  16624M 16635  16678  16696  16744  16848  21516M 21526U
                                                 21532M 21550U 21986M 21996U 22002M 22020U 22328M 22338U 22344M 22362U
                                                 22526M 22536U 22542M 22560U 22866M 22876U 22882M 22900U 23644M 23654U
                                                 23660M 23678U 23796M 23796
 R0            0 00000000 FFFFFFFF A   #     708  1338U  4054   4257   4561   4778   5836   6298M  6298   6376M  6429M
                                                  6429   6506M  6746   7062M  7062   7139M  7383   7542M  7542   7887
                                                  7992M  8018M  8142   8247M  8273M  8397   8511M  8537M  8720   9522
                                                  9575M  9975  10188M 10188  10189M 10198M 10198  10485M 10493M 10493
                                                 10495M 10511M 10755  11324  11994  13044  13823  14325  14546  14708
                                                 15774  16004  17189  18140  19027  19733  19914  20690  21081  21481
                                                 21746M 21964  22293  22504  22831  23042  23368  23609  25533
 R1            1 00000001 FFFFFFFF A   #     721  4176M  4186U  4219M  4314M  4324U  4503M  4504   4505   4532M  4618M
                                                  4628U  4716M  4898M  4908U  5786M  6137M  6147U  6288M  6328   6454
                                                  6655   6715M  7050M  7087   7332M  7485M  7575   7849M  7950M  7968
                                                  7989   7990   8012   8015   8025M  8107M  8205M  8223   8244   8245
                                                  8266   8271   8280M  8362M  8468M  8487   8544M  8634M  9493M  9574M
                                                  9574   9945M 10566M 11294M 11877M 12974M 13734M 14297M 14518M 14651M
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  193
                                                 15063M 15974M 17158M 18106M 18996M 19678M 19882M 20658M 21049M 21450M
                                                 21741M 21933M 22262M 22476M 22800M 23014M 23337M 23551M 25503M 26295M
 R14          14 0000000E FFFFFFFF A   #     890  4367M  4368M  4368   4370   4656M  4666M  4857   4951M  4952M  4952
                                                  4954   5600M  5607   5611M  5664M  5674M  5711M  5718   5722M  6175M
                                                  6176   6248M  6258M  8795M  8796M  8796   8798   8835M  8842   8845M
                                                  8867M  8883   8892M  9046M  9047M  9047   9049   9212M  9213   9275M
                                                  9292   9301M  9416M  9426M  9461M  9581M  9607   9699M  9851M  9861M
                                                  9883M  9890   9894M 10181M 10181  10183M 10485M 10510M 10512  10519M
                                                 10522  16819M 16820  16821M 16822  16833U 17615M 17625U 17655  17754M
                                                 17764U 17794  18777M 18787U 18817  19421M 19431U 19461  21202M 21212U
                                                 21242  21277M 21278  21279M 21280  21291U 21746M 22103M 22105  22423M
                                                 22430  22432M 22643M 22645  22961M 22968  22970M 23181M 23183  23498M
                                                 23505  23507M
 R15          15 0000000F FFFFFFFF A   #     903  4054   4157   4158M  4159M  4160M  4161M  4162M  4162   4219M  4257
                                                  4369M  4476   4477M  4478M  4479M  4480M  4481M  4481   4532M  4561
                                                  4656M  4664   4716M  4778   4887   4888M  4889M  4890M  4891M  4892M
                                                  4892   4953M  5060   5061M  5062M  5063M  5064M  5065M  5065   5202
                                                  5203M  5204M  5205M  5206M  5207M  5207   5607M  5610M  5611   5664M
                                                  5672   5718M  5721M  5722   5786M  5836   5973   5974M  5975M  5976M
                                                  5977M  5978M  5978   6024   6025M  6026M  6027M  6028M  6029M  6029
                                                  6085   6086M  6087M  6088M  6089M  6090M  6090   6125   6126M  6127M
                                                  6128M  6129M  6130M  6130   6175M  6176   6248M  6256   6571M  6715M
                                                  6746   6881   6882M  6883M  6884M  6885M  6886M  6886   6940   6941M
                                                  6942M  6943M  6944M  6945M  6945   6979   6980M  6981M  6982M  6983M
                                                  6984M  6984   7019   7020M  7021M  7022M  7023M  7024M  7024   7210M
                                                  7332M  7383   7473   7474M  7475M  7476M  7477M  7478M  7478   7728M
                                                  7849M  7887   8107M  8142   8362M  8397   8634M  8720   8766M  8767M
                                                  8768   8797M  8842M  8844M  8845   8865M  8866M  8883   8892   9048M
                                                  9158   9159M  9160M  9161M  9162M  9163M  9163   9212M  9213   9276M
                                                  9292   9301   9416M  9424   9493M  9522   9581M  9590M  9590   9607
                                                  9698M  9851M  9859   9890M  9893M  9894   9945M  9975  10091  10092M
                                                 10093M 10094M 10095M 10096M 10096  10146  10147M 10148M 10149M 10150M
                                                 10151M 10151  10182M 10189  10435  10436M 10437M 10438M 10439M 10440M
                                                 10440  10470  10471M 10472M 10473M 10474M 10475M 10475  10484M 10484
                                                 10512M 10519  10520M 10521  10566M 10755  10970  10971M 10972M 10973M
                                                 10974M 10975M 10975  11106  11107M 11108M 11109M 11110M 11111M 11111
                                                 11294M 11324  11436  11437M 11438M 11439M 11440M 11441M 11441  11877M
                                                 11899  11900M 11901M 11902M 11903M 11904M 11904  11918  11919M 11920M
                                                 11921M 11922M 11923M 11923  11994  12655  12656M 12657M 12658M 12659M
                                                 12660M 12660  12974M 12996  12997M 12998M 12999M 13000M 13001M 13001
                                                 13015  13016M 13017M 13018M 13019M 13020M 13020  13044  13428  13429M
                                                 13430M 13431M 13432M 13433M 13433  13588  13589M 13590M 13591M 13592M
                                                 13593M 13593  13734M 13756  13757M 13758M 13759M 13760M 13761M 13761
                                                 13774  13775M 13776M 13777M 13778M 13779M 13779  13823  13916  13917M
                                                 13918M 13919M 13920M 13921M 13921  14297M 14325  14518M 14546  14651M
                                                 14708  14880  14881M 14882M 14883M 14884M 14885M 14885  15063M 15774
                                                 15867  15868M 15869M 15870M 15871M 15872M 15872  15974M 16004  17158M
                                                 17189  17384  17385M 17386M 17387M 17388M 17389M 17389  17437  17438M
                                                 17439M 17440M 17441M 17442M 17442  17524  17525M 17526M 17527M 17528M
                                                 17529M 17529  17577  17578M 17579M 17580M 17581M 17582M 17582  17615M
                                                 17631  17649U 17754M 17770  17788U 18106M 18140  18317  18318M 18319M
                                                 18320M 18321M 18322M 18322  18446  18447M 18448M 18449M 18450M 18451M
                                                 18451  18498  18499M 18500M 18501M 18502M 18503M 18503  18554  18555M
                                                 18556M 18557M 18558M 18559M 18559  18777M 18793  18811U 18996M 19027
                                                 19178  19179M 19180M 19181M 19182M 19183M 19183  19231  19232M 19233M
                                                 19234M 19235M 19236M 19236  19286  19287M 19288M 19289M 19290M 19291M
                                                 19291  19339  19340M 19341M 19342M 19343M 19344M 19344  19421M 19437
                                                 19455U 19678M 19733  19882M 19914  20107  20108M 20109M 20110M 20111M
                                                 20112M 20112  20197  20198M 20199M 20200M 20201M 20202M 20202  20271
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  194
                                                 20272M 20273M 20274M 20275M 20276M 20276  20658M 20690  21049M 21081
                                                 21202M 21218  21236U 21450M 21481  21582  21583M 21584M 21585M 21586M
                                                 21587M 21587  21730  21731M 21732M 21733M 21734M 21735M 21735  21745M
                                                 21745  21800  21801M 21802M 21803M 21804M 21805M 21805  21833M 21834
                                                 21835  21933M 21964  22052  22053M 22054M 22055M 22056M 22057M 22057
                                                 22104M 22213  22214M 22215M 22216M 22217M 22218M 22218  22262M 22293
                                                 22394  22395M 22396M 22397M 22398M 22399M 22399  22423M 22476M 22504
                                                 22592  22593M 22594M 22595M 22596M 22597M 22597  22644M 22753  22754M
                                                 22755M 22756M 22757M 22758M 22758  22800M 22831  22932  22933M 22934M
                                                 22935M 22936M 22937M 22937  22961M 23014M 23042  23130  23131M 23132M
                                                 23133M 23134M 23135M 23135  23182M 23291  23292M 23293M 23294M 23295M
                                                 23296M 23296  23337M 23368  23469  23470M 23471M 23472M 23473M 23474M
                                                 23474  23498M 23551M 23609  25503M 25533  26295M
 SBCBID        4 00000000 FFFFFFA2     C    8672 10109M
 SBCBLEN       4 00000034 FFFFFFA2     A    8691 10214M
 SBCBSTRT      4 00000030 FFFFFFA2     A    8690 10487M
 SBCF          8 00000020 FFFFFFA2     D    8685  8771   8798M  9851   9861M
 SBCFCNT       4 00000028 FFFFFFA2     A    8688  8835   8845M  8866   9883   9894M 10503M
 SBCFFP        4 00000020 FFFFFFA2     A    8686  9860   9860  10486M
 SBCFIX      128 00000004 FFFFFFA2     U    8674  8919   8919   9802   9802  10173M 10173
 SBCHII        4 00000008 FFFFFFA2     A    8675  8867   8892M
 SBCHIW        4 0000000C FFFFFFA2     A    8676  9275   9301M
 SBCLEN        4 00000004 FFFFFFA2     A    8673  8674   8766   8957   9569   9838  10115M 10116M 10116M 10117  10129
                                                 10488
 SBCNTRL      56 00000000 FFFFFFA2     J    8698  8761U  9563U 10016U 10056  10108M 10108  10546
 SBCTCNT       4 0000002C FFFFFFA2     A    8689  8865  10502M
 SBCW         16 00000010 FFFFFFA2     X    8679  9225   9619  10110
 SBCWBP        4 00000014 FFFFFFA2     A    8681 10112M
 SBCWCNT       4 0000001C FFFFFFA2     A    8683  9276
 SBCWFP        4 00000010 FFFFFFA2     A    8680  9629  10111M
 SBCWSEQ       4 00000018 FFFFFFA2     A    8682  9212   9581
 SBUFGET       4 00000C0E 00000001     I    8720  8715   8731U
 SBUFINIT      4 00000EE0 00000001     I    9975  9970   9986U
 SBUFREE       4 00000DDE 00000001     I    9522  9517   9533U
 SBWADR        4 0000000C FFFFFFE5     A    2061  9405   9701M
 SBWAIT       32 00000000 FFFFFFE5     J    2072  9123   9183U  9193M  9193   9412M  9412   9417   9425M  9669U
 SBWASB        4 0000000C FFFFFFE5     A    2062  9195M  9699
 SBWBID        4 00000008 FFFFFFE5     C    2060  9194M  9413M
 SBWECB        8 00000010 FFFFFFE5     D    2063  9354   9735
 SEG           1 00000000 00000018     T   26308 26308
 SEGCOL        1 00000000 00000019     T   26309 26309
 SEGHEX        1 00000000 0000001A     T   26310 26310
 SIGNAL        1 00000000 00000007     T    8656  8656  10587  15084  19708  23572
 SIGNALAS      1 00000000 00000011     T   15098 15098
 SLDUM         8 00000000 FFFFFFEB     D    1585  9022   9049M  9416   9426M
 SLDUMFP       4 00000000 FFFFFFEB     A    1586  9425   9425
 SLDUMMY       8 00000000 FFFFFFEB     J    1594  9015U
 SLKKAP        2 00001680 00000001     H   13006 12158B
 SPR          13 0000000D FFFFFFFF A   #    1172  4054   4069   4070   4072M  4102U  4257   4272   4273   4288M  4421U
                                                  4561   4576   4577   4592M  4778   4793   4794   4814M  5005U  5127U
                                                  5491U  5539U  5836   5851   5852   5872M  6173U  6558U  6585U  6746
                                                  6761   6762   6782M  7197U  7224U  7383   7398   7399   7419M  7505U
                                                  7715U  7742U  7887   7902   7903   7923M  8142   8157   8158   8178M
                                                  8397   8412   8413   8433M  8720   8735   8736   8751M  8934U  9103U
                                                  9210U  9334U  9382U  9522   9537   9538   9553M  9605U  9685U  9715U
                                                  9820U  9975   9990   9991  10006M 10036U 10755  10770  10771  10786M
                                                 10856U 11178U 11222U 11324  11339  11340  11355M 11541U 11699U 11807U
                                                 11994  12009  12010  12030M 12724U 12880U 13044  13059  13060  13075M
                                                 13609U 13672U 13823  13838  13839  13841M 13861U 14151U 14233U 14325
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  195
                                                 14340  14341  14343M 14440U 14546  14561  14562  14564M 14708  14723
                                                 14724  14744M 14824U 15774  15789  15790  15792M 15812U 15912U 16004
                                                 16019  16020  16035M 16052U 16432U 16476U 16502U 16710U 16913U 16993U
                                                 17023U 17067U 17099U 17189  17204  17205  17220M 17237U 17463U 17601U
                                                 17679U 17862U 17907U 17956U 18062U 18140  18155  18156  18171M 18184U
                                                 18578U 18634U 18901U 18947U 19027  19042  19043  19058M 19071U 19363U
                                                 19486U 19584U 19627U 19733  19748  19749  19751M 19838U 19914  19929
                                                 19930  19945M 20052U 20690  20705  20706  20721M 20917U 20953U 21013U
                                                 21081  21096  21097  21112M 21353U 21481  21496  21497  21512M 21603U
                                                 21675U 21761U 21897U 21964  21979  21980  21982M 22158U 22293  22308
                                                 22309  22324M 22504  22519  22520  22522M 22698U 22831  22846  22847
                                                 22862M 23042  23057  23058  23060M 23236U 23368  23383  23384  23399M
                                                 23609  23624  23625  23640M 23693U 24101U 24180U 24262U 24312U 24819U
                                                 24869U 25041U 25091U 25533  25548  25549  25564M 25651U
 SYSRDEL       1 00000000 00000004     T    8651  8651  10583  15089  23570
 SYSRNEW       1 00000000 00000006     T    8655  8655  10586  15083  23571
 TRYSPIN       2 000014EA 00000001     H   12289 12228B
 TRYTAKE       2 000014D2 00000001     H   12239 12320B 12378B
 VMFREE        1 00000000 0000000B     T   15086 15086
 VMGET         1 00000000 00000002     T    8643  8643  10579  15081  19692  23564
 W                        00000001 A   U    5917  6343   6353   6373   6374   6464   6477   6489   6503   6504
 W                        00000001 A   U    6827  7097   7110   7122   7136   7137
 W                        00000001 A   U    7491  7581   7612   7645
 WAR          12 0000000C FFFFFFFF A   #    1160  4069   4070M  4071   4072   4219   4220   4272   4273M  4274   4284U
                                                  4288   4532   4533   4576   4577M  4578   4588U  4592   4716   4717
                                                  4793   4794M  4795   4805U  4814   5786   5787   5851   5852M  5853
                                                  5863U  5872   6715   6716   6761   6762M  6763   6773U  6782   7332
                                                  7333   7398   7399M  7400   7410U  7419   7849   7850   7902   7903M
                                                  7904   7914U  7923   8107   8108   8157   8158M  8159   8169U  8178
                                                  8362   8363   8412   8413M  8414   8424U  8433   8634   8635   8735
                                                  8736M  8737   8747U  8751   9493   9494   9537   9538M  9539   9549U
                                                  9553   9945   9946   9990   9991M  9992  10002U 10006  10566  10567
                                                 10770  10771M 10772  10782U 10786  11294  11295  11339  11340M 11341
                                                 11351U 11355  11877  11878  12009  12010M 12011  12021U 12030  12974
                                                 12975  13059  13060M 13061  13071U 13075  13734  13735  13838  13839M
                                                 13840  13841  14297  14298  14340  14341M 14342  14343  14518  14519
                                                 14561  14562M 14563  14564  14651  14652  14723  14724M 14725  14735U
                                                 14744  15063  15064  15789  15790M 15791  15792  15974  15975  16019
                                                 16020M 16021  16031U 16035  17158  17159  17204  17205M 17206  17216U
                                                 17220  18106  18107  18155  18156M 18157  18167U 18171  18996  18997
                                                 19042  19043M 19044  19054U 19058  19678  19679  19748  19749M 19750
                                                 19751  19882  19883  19929  19930M 19931  19941U 19945  20658  20659
                                                 20705  20706M 20707  20717U 20721  21049  21050  21096  21097M 21098
                                                 21108U 21112  21450  21451  21496  21497M 21498  21508U 21512  21933
                                                 21934  21979  21980M 21981  21982  22262  22263  22308  22309M 22310
                                                 22320U 22324  22476  22477  22519  22520M 22521  22522  22800  22801
                                                 22846  22847M 22848  22858U 22862  23014  23015  23057  23058M 23059
                                                 23060  23337  23338  23383  23384M 23385  23395U 23399  23551  23552
                                                 23624  23625M 23626  23636U 23640  25503  25504  25548  25549M 25550
                                                 25560U 25564  26295  26296
 =A(DEQUEUE)
               4 00002F7C 00000001     A   23562 19853
 =A(FINDQCB)
               4 00002598 00000001     A   19698 16447
 =A(FREEQAO)
               4 000025A8 00000001     A   19702 17082  17478
 =A(FREEQOE)
               4 000025AC 00000001     A   19703 17114
 =A(GETQOE)
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  196
               4 00002594 00000001     A   19697 16373
 =A(QUEREM)
               4 00000BF8 00000001     A    8657  7670
 =A(QUEREM)
               4 00001134 00000001     A   10585  9635
 =A(QUEUE)
               4 00000BD8 00000001     A    8649  5437
 =A(0)         4 00000BD4 00000001     A    8648  5230   5956   6864
 =A(0)         4 000025BC 00000001     A   19707 17966  18644  19594
 =A(1)         4 00000BE4 00000001     A    8652  5610   5721
 =A(1)         4 00001148 00000001     A   10590  9893  10207
 =A(1)         4 00001BB4 00000001     A   15094 12924  13197  14616
 =A(4)         4 000025B8 00000001     A   19706 17872  19516
 =A(4096)      4 00001150 00000001     A   10592 10129  10182  10494  10533
 =C'       '
               7 00003630 00000001     C   26323 25944
 =C'  *** Not initialized ***'
              25 000035F7 00000001     C   26318 23823  25745
 =C'  WAIT '
               7 00003629 00000001     C   26322 25874
 =C' '         1 00003610 00000001     C   26319 24387  24670  25166
 =C'*** ENQUEUE Service ***'
              23 000035E0 00000001     C   26317 23710
 =C'sBWB'      4 00001130 00000001     C   10584  9413
 =C'BUFF'      4 00001144 00000001     C   10589  9848  10522
 =C'Enqueue Table'
              13 0000361C 00000001     C   26321 25668
 =C'EXC '      4 000035BC 00000001     C   26313 25364  26088
 =C'LOCK'      4 00001B84 00000001     C   15082 11001  11419  12056
 =C'LQE '      4 00001BC0 00000001     C   15097 13321
 =C'None'      4 000035B4 00000001     C   26311 24956
 =C'OWNER PID: '
              11 00003611 00000001     C   26320 24558
 =C'SHARING PIDS: '
              14 000035C4 00000001     C   26315 24197
 =C'SHR '      4 000035B8 00000001     C   26312 25294  26018
 =C'WAITING PIDS: '
              14 000035D2 00000001     C   26316 24886
 =CL16'ENQUEUE'
              16 00002570 00000001     C   19691 15926
 =CL4'gRES'
               4 00000BCC 00000001     C    8646  4652
 =CL4'gRH'
               4 00000BE8 00000001     C    8653  5661   6245
 =CL4'qao'
               4 00002FC8 00000001     C   23581 23497
 =CL4'qoe'
               4 00002FC4 00000001     C   23580 22960
 =CL4'qrb'
               4 00002FBC 00000001     C   23578 22422
 =CL4'GRCT'
               4 00000BC4 00000001     C    8644  4175
 =CL4'GRES'
               4 00000BC8 00000001     C    8645  4500   4870   5185   5936   6846   7456
 =CL4'GRH'
               4 00000BD0 00000001     C    8647  5083   6068   6962
 =CL4'GRXX'
               4 00000BFC 00000001     C    8658  7695
 =CL4'LKCT'
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  197
               4 00001BD0 00000001     C   15101 13947
 =CL4'LQE'
               4 00001B98 00000001     C   15087 11653  14901
 =CL4'QAO'
               4 00002F8C 00000001     C   23566 20254  23316
 =CL4'QAS'
               4 00002F88 00000001     C   23565 20125  20180  23113  23452
 =CL4'QAS'
               4 000035C0 00000001     C   26314 25631
 =CL4'QCB'
               4 000025B4 00000001     C   19705 17560  18537  19322
 =CL4'QCB'
               4 00002FB0 00000001     C   23575 21747
 =CL4'QCT'
               4 00002584 00000001     C   19693 15898
 =CL4'QCT'
               4 00002FA8 00000001     C   23573 21565  22035  22377  22575  22915
 =CL4'QOE'
               4 00002FC0 00000001     C   23579 22778
 =CL4'QRB'
               4 000025B0 00000001     C   19704 17507  18481  19269
 =CL4'QRB'
               4 00002FB8 00000001     C   23577 22238
 =CL4'SBCB'
               4 0000114C 00000001     C   10591 10109
 =CL4'SBUF'
               4 00001120 00000001     C   10580  9194
 =CL8'LQECNT'
               8 00001B78 00000001     C   15080 14102
 =CL8'RESOURCE'
               8 00001B68 00000001     C   15078 14054
 =CL8'SPINCNT'
               8 00001B70 00000001     C   15079 14055
 =V(ASLOCK)
               4 00001BA8 00000001     V   15091 12494
 =V(ASLOCK)
               4 0000258C 00000001     V   19695 16038  16959  17223  18235  19086
 =V(ASLOCK)
               4 00002F78 00000001     V   23561 19806
 =V(ASULOCK)
               4 00001BCC 00000001     V   15100 13704
 =V(ASULOCK)
               4 00002590 00000001     V   19696 16278  16355  16723  16865  17050  17304  18264  18403  18415  19115
                                                 19408  19643
 =V(ASULOCK)
               4 00002F80 00000001     V   23563 19862  20938
 =V(AWAIT)
               4 00000BDC 00000001     V    8650  5525
 =V(AWAIT)
               4 00001128 00000001     V   10582  9368
 =V(AWAIT)
               4 00002F98 00000001     V   23569 20981
 =V(AWAITAS)
               4 00001BB0 00000001     V   15093 12908
 =V(CPLOCK)
               4 00001BA4 00000001     V   15090 12442
 =V(CPULOCK)
               4 00001BBC 00000001     V   15096 13262
 =V(DISPSHLD)
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  198
               4 00001BAC 00000001     V   15092 12740
 =V(DISPSREL)
               4 00001BC8 00000001     V   15099 13688
 =V(HASHIT)
               4 000025A0 00000001     V   19700 16525
 =V(LKCRE)
               4 00002588 00000001     V   19694 15929
 =V(LKCRE)
               4 00002FB4 00000001     V   23576 21773
 =V(LKOB)      4 0000259C 00000001     V   19699 16485  17610  18587  19372
 =V(LKOB)      4 00002FAC 00000001     V   23574 21612
 =V(LKREL)
               4 000025A4 00000001     V   19701 16719  16861  17002  18071  18956  19404  19636
 =V(LKREL)
               4 00002F94 00000001     V   23568 20926  21906
 =V(PAGFIX)
               4 00001118 00000001     V   10578  8960
 =V(PAGUFIX)
               4 00001140 00000001     V   10588  9841
 =V(QUEREM)
               4 00000BEC 00000001     V    8654  6213
 =V(QUEUE)
               4 00001124 00000001     V   10581  9250
 =V(SEG)       4 000035A8 00000001     V   26308 23748  23786  23861  24021  24086  24229  24419  24515  24590  24702
                                                 24798  24918  24994  25198  25326  25396  25477  25706  25783  25906
                                                 25976  26050  26120  26189  26254
 =V(SEGCOL)
               4 000035AC 00000001     V   26309 24136  24297  24854  25076
 =V(SEGHEX)
               4 000035B0 00000001     V   26310 24365  24477  24648  24760  25144  25256
 =V(SIGNAL)
               4 00000BF4 00000001     V    8656  6638   7277   7795
 =V(SIGNAL)
               4 0000113C 00000001     V   10587  9773
 =V(SIGNAL)
               4 00001B8C 00000001     V   15084 11250
 =V(SIGNAL)
               4 000025C0 00000001     V   19708 19529
 =V(SIGNAL)
               4 00002FA4 00000001     V   23572 21396
 =V(SIGNALAS)
               4 00001BC4 00000001     V   15098 13637
 =V(SYSRDEL)
               4 00000BE0 00000001     V    8651  5560
 =V(SYSRDEL)
               4 0000112C 00000001     V   10583  9403
 =V(SYSRDEL)
               4 00001BA0 00000001     V   15089 11715
 =V(SYSRDEL)
               4 00002F9C 00000001     V   23570 21018
 =V(SYSRNEW)
               4 00000BF0 00000001     V    8655  6569   7208   7726
 =V(SYSRNEW)
               4 00001138 00000001     V   10586  9696
 =V(SYSRNEW)
               4 00001B88 00000001     V   15083 11189
 =V(SYSRNEW)
               4 00002FA0 00000001     V   23571 21333
 =V(VMFREE)
1RESMAN   (RESM00) (09:43) (22MAR04) Ordinary Symbol and Literal Cross Reference                                            Page  199
               4 00001B94 00000001     V   15086 11581  11847  14273
 =V(VMGET)
               4 00000BC0 00000001     V    8643  4131   4450   5034
 =V(VMGET)
               4 0000111C 00000001     V   10579  9132  10065  10267  10349  10403
 =V(VMGET)
               4 00001B80 00000001     V   15081 10885  10940  13890  14023  14853
 =V(VMGET)
               4 00002580 00000001     V   19692 15841
 =V(VMGET)
               4 00002F84 00000001     V   23564 20081  21704  22187  22727  23265
 =X'FFFFFFFF'
               4 00001B90 00000001     X   15085 11502  12085
 =X'40000000'
               4 00001B9C 00000001     X   15088 11666
 =X'7FFFFFFF'
               4 00001BB8 00000001     X   15095 13204
 =X'80000000'
               4 00002F90 00000001     X   23567 20624
 =Y(QCBNEXT-QCB)
               2 00002FCE 00000001     Y   23583 21618
 =Y(27*256+0)
               2 00001158 00000001     Y   10595 10258
 =Y(27*256+0)
               2 00002FCC 00000001     Y   23582 20078  23262
 =Y(59*256+0)
               2 00001154 00000001     Y   10593  9129  10394
 =Y(59*256+0)
               2 00001BD6 00000001     Y   15103 10937  11844
 =Y(59*256+0)
               2 000025C4 00000001     Y   19709 15838
 =Y(59*256+0)
               2 00002FD0 00000001     Y   23584 21701
 =Y(59*256+2)
               2 00002FD2 00000001     Y   23585 22184  22724
 =Y(63*256+0)
               2 00000C00 00000001     Y    8659  4128   4447   5031
 =Y(63*256+0)
               2 00001156 00000001     Y   10594 10062  10340
 =Y(63*256+0)
               2 00001BD4 00000001     Y   15102 10882  11578  13887  14020  14270  14850

1RESMAN   (RESM00) (09:43) (22MAR04) Macro and Copy Code Source Summary                                                     Page  200
- Con Source                                        Volume    Members                        HLASM R4.0  2004/03/22 09.43
0     PRIMARY INPUT                                           CSECT    DROP     END      EX       GRCAN    GRCRE
                                                              GRDEL    GRGET    GRREL    GRX2S    LTORG    POP
                                                              PRINT    PUSH     Q_PSH    Q_QUE    Q_REM    QHEAD
                                                              SAVAIL   SHEAD    SPOP     SPUSH    START    USING
   L2 WYL.GG.ORV.MACLIB                             SYSB02    $LKPARM  ABORT    ACALL    ASB      AWAIT    DECRS
                                                              DISPPARM ENQPARM  GETPARM2 GRCOPY   GRPARM   HASHPARM
                                                              HEADER   INCRS    LCALL    LELEM    LHEAD    LISTPARM
                                                              LKCRE    LKOB     LKREL    LOCKPARM MAT      MODULE
                                                              MOVSTR   PAGEPARM PARMPARM PEND     PMOV     PROC     PSET
                                                              PZERO    QCB      QLISTMAC REG      SBPARM   SEG      SEGB
                                                              SEGCOL   SEGEOR   SEGHEX   SEGLD    SEGPARM  SIGNL
                                                              SIGPARM  SLISTMAC SPLEVEL  SYSCTL   VCALL    VMFREE
                                                              VMGET    VMPARM   XITPARM
   L3 WYL.GG.SYS.MACLIB                             SYSB05    $BC      $BFLKUP  $BV      $CCLKUP  $CRS     $CSS     $L
                                                              $LA      $LBLAD   $LEXP    $LOR     $REL     $RGLKUP
                                                              $USLKUP  AUSING   BEGIN    CLEAR    CSECT    DECR
                                                              DEFCC    DIAG     DROP     ELSE     ELSEIF   END      EX
                                                              EXIT     FLAG     GEN      HIBAL    IDENT    IF       INCR
                                                              LABEL    LOOP     LT       LTORG    NEXT     POP
                                                              PRINT    PUSH     RECORD   REGS     SET      START    STF
                                                              ST3      UNTIL    USING    WHILE    WITH

1         (RESM00) (09:43) (22MAR04) General Purpose Register Cross Reference                                               Page  201
- Register  References (M=modified, B=branch, U=USING, D=DROP, N=index)                      HLASM R4.0  2004/03/22 09.43
0    0(0)      991U   992D  1338U  4054   4122M  4127   4140   4204M  4204   4257   4343M  4358M  4358   4367   4370M
              4399M  4399   4441M  4446   4459M  4459   4491   4507M  4561   4657M  4666   4691M  4691   4778   4927M
              4942M  4942   4951   4954M  4983M  4983   5025M  5030   5043M  5043   5075   5160M  5165   5453M  5453
              5511M  5516   5557   5665M  5674   5747M  5836   6188M  6193   6228M  6228   6249M  6258   6298M  6298
              6299   6376M  6377   6429M  6429   6430   6506M  6508   6571   6605M  6610   6669M  6746   7062M  7062
              7063   7139M  7141   7210   7244M  7249   7286M  7383   7525M  7530   7542M  7542   7543   7582   7680M
              7680   7728   7762M  7767   7815M  7815   7887   7992M  8018M  8027   8044M  8044   8061M  8142   8247M
              8273M  8282   8299M  8299   8316M  8397   8511M  8537M  8546   8563M  8563   8580M  8720   8771M  8786M
              8786   8795   8798M  8827M  8827   8833   8952   9022M  9037M  9037   9046   9049M  9078M  9078   9123M
              9128   9141M  9141   9173   9225M  9230   9265M  9265   9354M  9359   9400   9417M  9426   9473M  9473
              9522   9575M  9619M  9624   9645M  9645   9698   9735M  9740   9852M  9861   9925M  9925   9975  10056M
             10061  10074  10188M 10188  10189M 10198M 10198  10453  10485M 10493M 10493  10495M 10511M 10528M 10546M
             10755  10876M 10881  10931M 10936  10953  11191  11242M 11247  11269M 11324  11561M 11566  11827M 11832
             11994  12216M 12296M 12296  12331M 12406M 12900M 12905  13044  13129M 13130M 13131  13143M 13143  13267M
             13267  13629M 13634  13823  13881M 13886  13899  14014M 14019  14025  14086  14133  14253M 14258  14325
             14546  14708  14844M 14849  14863M 14863  14891  14892  14893  15774  15832M 15837  15850  15931  16004
             16217  16280M 16298  16357M 16375  16449  16530M 16532  16624  16725M 16867M 16943M 16943  16949M 17119M
             17119  17189  17301  17323M 18076M 18076  18140  18256  18266M 18405M 18766M 18961M 18961  19027  19107
             19117M 19410M 19506M 19511  19648M 19648  19733  19914  20025M 20025  20072M 20077  20090  20354M 20354
             20514M 20514  20534  20633M 20690  20973M 20978  20986M 20995M 20995  21015  21024M 21081  21335  21373M
             21378  21481  21695M 21700  21713  21746M 21783M 21783  21811  21815M 21827M 21827  21838M 21908M 21964
             22178M 22183  22196  22242M 22293  22504  22718M 22723  22736  22780M 22831  23042  23256M 23261  23274
             23317M 23368  23609  23710M 23715  23727M 23732  23823M 23828  23840M 23845  23983M 23988  24000M 24005
             24048M 24053  24065M 24070  24121M 24126  24197M 24202  24214M 24219  24282M 24287  24333M 24338  24350M
             24355  24387M 24392  24404M 24409  24445M 24450  24462M 24467  24558M 24563  24575M 24580  24616M 24621
             24633M 24638  24670M 24675  24687M 24692  24728M 24733  24745M 24750  24839M 24844  24886M 24891  24903M
             24908  24956M 24961  24973M 24978  25061M 25066  25112M 25117  25129M 25134  25166M 25171  25183M 25188
             25224M 25229  25241M 25246  25294M 25299  25311M 25316  25364M 25369  25381M 25386  25533  25668M 25673
             25685M 25690  25745M 25750  25762M 25767  25874M 25879  25891M 25896  25944M 25949  25961M 25966  26018M
             26023  26035M 26040  26088M 26093  26105M 26110  26151M 26156  26168M 26173  26216M 26221  26233M 26238
     1(1)      987U  4054   4176M  4186U  4199U  4219M  4257   4314M  4324U  4337U  4343M  4369N  4370M  4503M  4504
              4505   4532M  4561   4618M  4628U  4641U  4664M  4666   4716M  4778   4898M  4908U  4921U  4927M  4953N
              4954M  5672M  5674   5786M  5836   6137M  6147U  6160U  6256M  6258   6288M  6299   6328   6377   6430
              6454   6508   6655   6715M  6746   7050M  7063   7087   7141   7332M  7383   7485M  7543   7575   7582
              7849M  7887   7929U  7950M  7968   7989   7990   8012   8015   8025M  8027   8107M  8142   8184U  8205M
              8223   8244   8245   8266   8271   8280M  8282   8362M  8397   8439U  8468M  8487   8544M  8546   8634M
              8720   8771M  8797N  8798M  9022M  9048N  9049M  9424M  9426   9493M  9522   9574M  9574   9575M  9859M
              9861   9945M  9975  10110M 10111  10112  10113M 10114M 10115  10117M 10183  10184M 10189M 10207M 10212
             10213M 10214  10257  10339  10393  10485M 10494M 10495M 10501  10511  10566M 10755  11045M 11066M 11294M
             11324  11497M 11520M 11621M 11660M 11679M 11760M 11781M 11877M 11994  12128M 12129M 12130  12456M 12457M
             12458  12462M 12463M 12464  12501M 12511U 12538M 12538  12579U 12860M 12861M 12862  12934M 12935M 12936
             12974M 13044  13163M 13163  13197M 13373M 13374M 13375  13384M 13384  13439M 13440  13555U 13655U 13734M
             13823  14297M 14325  14518M 14546  14651M 14708  14788M 14804U 14893M 14913U 14951U 14964U 15007U 15020U
             15063M 15774  15974M 16004  16061M 16084M 16084  16091  16109M 16110  16111M 16112  16511M 16512  16513M
             16514  16515M 16516  16630M 16631  16632  16653M 16654  16672U 16694U 16750M 16765  16789M 16794U 17158M
             17189  17246M 17255M 17255  17262  17278M 17279  17280M 17281  17970M 17988U 18041U 18106M 18140  18193M
             18202M 18202  18209  18225M 18226  18227M 18228  18996M 19027  19080M 19081  19082M 19083  19678M 19733
             19882M 19914  20126M 20136U 20149U 20658M 20690  20774M 20775  20776M 20777  20796U 20818U 20839M 20840
             20841M 20842  20860U 20882U 20892M 20902U 20934U 21049M 21081  21262M 21271M 21271  21313M 21325  21450M
             21481  21741M 21746M 21816M 21836M 21933M 21964  22239M 22240  22241  22262M 22293  22476M 22504  22800M
             22831  23014M 23042  23337M 23368  23551M 23609  23918M 23918  24231M 24243  24805M 24929  25022  25503M
             25533  26295M
     2(2)      983U  4054   4219M  4257   4532M  4561   4716M  4778   5136M  5137   5786M  5836   6287M  6299M  6375N
              6377M  6397M  6430M  6505N  6508M  6524M  6715M  6746   7049M  7063M  7138N  7141M  7157M  7332M  7383
              7537M  7538   7543M  7582M  7694M  7849M  7887   7937U  7951M  7981   7988   8010   8107M  8142   8192U
1         (RESM00) (09:43) (22MAR04) General Purpose Register Cross Reference                                               Page  202
              8206M  8236   8243   8265   8362M  8397   8447U  8469M  8634M  8720   8761U  8765M  9480U  9493M  9522
              9563U  9567M  9932U  9945M  9975  10016U 10074M 10553U 10566M 10755  11074M 11089M 11089  11143M 11252
             11253  11294M 11324  11466M 11479M 11479  11507M 11719M 11726  11729M 11877M 11994  12086M 12101  12118M
             12118  12225M 12225  12247M 12270M 12270  12308M 12317M 12317  12349  12352M 12375M 12375  12413M 12562M
             12563M 12564  12623M 12638M 12638  12692M 12782  12818  12974M 13044  13149M 13213M 13301M 13302M 13302
             13515  13552U 13650U 13711U 13734M 13823  13957M 13967U 13980U 14182M 14189  14191M 14297M 14325  14385M
             14392  14395M 14471M 14478  14480M 14518M 14546  14606M 14613  14617M 14651M 14708  14935M 14957  14968M
             14991M 15013  15024M 15063M 15774  15935M 15945U 15958U 15974M 16004  16533M 16563  16609  16652  17158M
             17189  17701M 17713  17722M 17748  17841  18106M 18140  18996M 19027  19678M 19733  19752M 19762U 19768M
             19775U 19786U 19798M 19798  19874U 19882M 19914  20400M 20658M 20690  21049M 21081  21127M 21144  21450M
             21481  21933M 21964  22066M 22094M 22094  22105M 22136M 22136  22196M 22242  22262M 22293  22408M 22418U
             22432  22458U 22476M 22504  22606M 22634M 22634  22645M 22676M 22676  22736M 22780  22800M 22831  22946M
             22956U 22970  22996U 23014M 23042  23144M 23172M 23172  23183M 23214M 23214  23274M 23317  23337M 23368
             23483M 23493U 23507  23533U 23551M 23609  23907M 23936  25427M 25503M 25533  25568M 25578U 25584M 25591U
             25602U 25614M 25614  26282U 26295M
     3(3)      979U  4054   4219M  4257   4532M  4561   4716M  4778   5136M  5137   5786M  5836   6375M  6397   6505M
              6524   6715M  6746   7138M  7157   7332M  7383   7537M  7538   7694M  7849M  7887   7945U  7952M  7981
              8014   8107M  8142   8200U  8207M  8236   8269   8362M  8397   8455U  8470M  8500   8507   8529   8634M
              8720   9493M  9522   9945M  9975  10212M 10500  10540M 10545  10566M 10755  11074M 11142  11143M 11294M
             11324  11466M 11490M 11490  11507M 11719M 11728  11729M 11877M 11994  12086M 12245  12247M 12308M 12350
             12352M 12413M 12623M 12691  12692M 12745M 12782M 12814U 12942U 12974M 13044  13149M 13164  13213M 13244M
             13244  13513M 13514M 13515  13734M 13823  14073M 14086M 14091  14189M 14190M 14191  14297M 14325  14392M
             14394M 14395  14424M 14424  14478M 14479M 14480  14518M 14546  14613M 14616M 14617  14651M 14708  14935M
             14967  14968M 14991M 15023  15024M 15063M 15774  15974M 16004  17158M 17189  17535M 17545U 18083U 18106M
             18140  18512M 18522U 18968U 18996M 19027  19297M 19307U 19655U 19678M 19733  19822M 19823M 19823  19847
             19882M 19914  20401M 20658M 20690  21049M 21081  21450M 21481  21933M 21964  22066M 22105M 22262M 22293
             22431M 22432  22476M 22504  22606M 22645M 22800M 22831  22969M 22970  23014M 23042  23144M 23183M 23337M
             23368  23506M 23507  23551M 23609  23906M 25429M 25503M 25533  25717M 25718M 25718  25805M 25805  25820U
             26256M 26267U 26295M
     4(4)      975U  4054   4219M  4257   4309U  4491M  4514U  4532M  4561   4613U  4617M  4698U  4716M  4778   4835U
              4858M  5084   5768U  5786M  5836   5892U  5923M  6051M  6669   6697U  6715M  6746   6802U  6833M  6908M
              7314U  7332M  7383   7430U  7444M  7836U  7849M  7887   8107M  8142   8362M  8397   8463U  8471M  8500
              8533   8634M  8720   9493M  9522   9945M  9975  10566M 10755  11132M 11143  11294M 11324  11502M 11507
             11607M 11608M 11637U 11729  11755U 11877M 11994  12244M 12247  12349M 12352  12681M 12692  12974M 13044
             13159M 13159  13213  13505M 13512  13515M 13734M 13823  14297M 14325  14518M 14546  14651M 14708  14928M
             14968  15024  15063M 15774  15974M 16004  16375M 16385U 16415  16633  16634  16823  16839  16922  17108
             17140U 17158M 17189  17411M 17420M 17420  17492U 17871  17916  17965  18088U 18106M 18140  18420M 18429M
             18429  18466U 18643  18973U 18996M 19027  19205M 19214M 19214  19254U 19593  19660U 19678M 19733  19882M
             19914  20282M 20306U 20330M 20339M 20339  20372U 20408M 20601  20658M 20690  20736M 20746U 21031U 21049M
             21081  21113M 21123U 21437U 21450M 21481  21933M 21964  22262M 22293  22476M 22504  22800M 22831  23014M
             23042  23337M 23368  23551M 23609  24138M 24148U 24243  24517M 24804M 24929  25022  25402M 25417U 25503M
             25533  25824M 25834U 26262U 26295M
     5(5)      971U  4054   4219M  4257   4532M  4561   4716M  4778   4852U  5214M  5786M  5836   5917U  6286M  6715M
              6746   6827U  7048M  7332M  7383   7486M  7491U  7849M  7887   8107M  8142   8362M  8397   8634M  8720
              9493M  9522   9945M  9975  10566M 10755  11141M 11142M 11143  11294M 11324  11506M 11506  11507  11606M
             11606  11608  11665M 11666M 11727M 11728M 11729  11877M 11994  12245M 12246M 12247  12350M 12351M 12352
             12690M 12691M 12692  12974M 13044  13164M 13189M 13189  13198M 13204M 13205M 13213  13505M 13514  13515M
             13734M 13823  14297M 14325  14518M 14546  14651M 14708  14786M 14787  14907M 14966M 14967M 14968  15022M
             15023M 15024  15063M 15774  15974M 16004  16187U 16217M 16280  16298M 16357  16725  16867  16949  17032
             17076  17145U 17158M 17189  17301M 17317M 17317  17344U 17357U 17472  18106M 18140  18256M 18287U 18983U
             18996M 19027  19107M 19138U 19151U 19678M 19733  19882M 19914  20215M 20225U 20237M 20237  20303U 20321
             20367U 20395M 20408  20409M 20418M 20418  20487M 20487  20534M 20564  20624M 20633  20640U 20658M 20690
             20722M 20732U 20778  20793U 20802  20813U 20857U 20866  20877U 20884  21036U 21049M 21081  21150M 21160U
             21281  21297  21426U 21450M 21481  21933M 21964  22262M 22293  22476M 22504  22800M 22831  23014M 23042
             23337M 23368  23551M 23609  23924M 23936  23951U 25422U 25503M 25533  26295M
     6(6)      967U  4054   4082U  4140M  4192   4211U  4219M  4257   4300U  4330M  4519U  4532M  4561   4604U  4634M
              4703U  4716M  4778   4826U  4914M  5773U  5786M  5836   5883U  6153M  6342M  6343   6377M  6463M  6464
              6508M  6702U  6715M  6746   6793U  7096M  7097   7141M  7319U  7332M  7383   7849M  7887   7962M  7963
              7964M  7964N  7966   8107M  8142   8217M  8218   8219M  8219N  8221   8362M  8397   8481M  8482   8483M
1         (RESM00) (09:43) (22MAR04) General Purpose Register Cross Reference                                               Page  203
              8483N  8485   8634M  8720   9173M  9183U  9241   9452U  9493M  9522   9659M  9669U  9780U  9945M  9975
             10453M 10486  10487  10510  10533M 10534  10566M 10755  10953M 10990U 11209  11269  11276U 11294M 11324
             11394M 11404U 11577  11843  11859U 11877M 11994  12031M 12041U 12760  12819  12961U 12974M 13044  13079M
             13089U 13571  13721U 13734M 13823  14120M 14133M 14169  14190  14297M 14325  14430M 14458  14479  14518M
             14546  14651M 14708  14787M 15063M 15774  15974M 16004  16449M 16459U 16625  17135U 17158M 17189  17350M
             17367M 17367  17404U 17688  17985U 18036U 18093U 18106M 18140  18291M 18300M 18300  18337U 18694  18708
             18910  18978U 18996M 19027  19144M 19161M 19161  19198U 19534M 19553M 19665U 19678M 19733  19882M 19914
             19949M 19959U 19965M 19972U 19983U 19998M 19998  20090M 20142  20645U 20658M 20690  21049M 21081  21450M
             21481  21617M 21618M 21628U 21638M 21650M 21650  21713M 21848  21908  21915U 21933M 21964  22262M 22293
             22476M 22504  22800M 22831  23014M 23042  23064M 23074U 23080M 23087U 23098U 23329U 23337M 23368  23403M
             23413U 23419M 23426U 23437U 23538U 23551M 23609  23873M 23883U 23897M 23897  25435M 25485U 25503M 25533
             26295M
     7(7)      963U  4054   4219M  4257   4532M  4561   4716M  4778   4857M  5087   5786M  5836   6374M  6504M  6715M
              6746   7137M  7332M  7383   7849M  7887   7962M  7963   7965M  7965N  7966   8107M  8142   8217M  8218
              8220M  8220N  8221   8362M  8397   8481M  8482   8484M  8485   8634M  8720   8981M  8991U  8997M  9004U
              9015U  9457U  9493M  9522   9945M  9975  10488M 10489M 10495  10520N 10566M 10755  10787M 10797U 10803M
             10810U 10821U 11281U 11294M 11324  11356M 11366U 11372M 11379U 11390U 11864U 11877M 11994  12164M 12174U
             12180M 12187U 12198U 12449U 12585M 12595U 12601M 12608U 12619U 12947U 12974M 13044  13467M 13477U 13483M
             13490U 13501U 13695U 13734M 13823  13899M 13936U 13973  14289U 14297M 14325  14344M 14354U 14360M 14367U
             14378U 14510U 14518M 14546  14565M 14575U 14581M 14588U 14599U 14643U 14651M 14708  14745M 14755U 14761M
             14768U 14779U 15050U 15063M 15774  15850M 15887U 15951  15966U 15974M 16004  16531M 16532M 16533  16543U
             16553M 16563  16609  16624M 16635  16669U 16678  16689U 16696  16744  16848  17130U 17158M 17189  18106M
             18140  18996M 19027  19678M 19733  19882M 19914  20658M 20690  21049M 21081  21450M 21481  21516M 21526U
             21532M 21539U 21550U 21920U 21933M 21964  21986M 21996U 22002M 22009U 22020U 22254U 22262M 22293  22328M
             22338U 22344M 22351U 22362U 22463U 22476M 22504  22526M 22536U 22542M 22549U 22560U 22792U 22800M 22831
             22866M 22876U 22882M 22889U 22900U 23001U 23014M 23042  23337M 23368  23551M 23609  23644M 23654U 23660M
             23667U 23678U 23796M 23796  25490U 25503M 25533  26295M
     8(8)      959U  4054   4219M  4257   4532M  4561   4716M  4778   4844U  5075M  5148   5404   5763U  5786M  5836
              5901U  5922M  5923   5944M  6204   6299M  6328   6526M  6640M  6655   6692U  6715M  6746   6811U  6832M
              6833   6852M  7159M  7181   7279M  7286   7309U  7332M  7383   7439U  7543M  7575   7664   7801M  7831U
              7849M  7887   8107M  8142   8362M  8397   8634M  8720   9493M  9522   9568M  9575M  9847M  9848   9945M
              9975  10499M 10499  10501M 10566M 10755  11294M 11324  11877M 11994  12083M 12084  12101  12244  12351
             12824M 12834U 12919U 12974M 13044  13734M 13823  14025M 14035U 14269  14281U 14297M 14325  14518M 14546
             14651M 14708  15063M 15774  15974M 16004  17158M 17189  18106M 18140  18996M 19027  19678M 19733  19882M
             19914  20658M 20690  21049M 21081  21450M 21481  21933M 21964  22262M 22293  22476M 22504  22800M 22831
             23014M 23042  23337M 23368  23551M 23609  25503M 25533  26295M
     9(9)      955U  4054   4219M  4257   4532M  4561   4716M  4778   5362M  5362   5404M  5582M  5582   5648M  5648
              5747   5786M  5836   5909U  6430M  6454   6526   6545M  6640   6715M  6746   6819U  7063M  7087   7159
              7187M  7279   7332M  7383   7582M  7801   7849M  7887   8107M  8142   8362M  8397   8634M  8720   9493M
              9522   9569M  9570M  9575M  9945M  9975  10500M 10501M 10502  10503  10566M 10755  11294M 11324  11877M
             11994  12084M 12085M 12246  12974M 13044  13734M 13823  14297M 14325  14518M 14546  14651M 14708  15063M
             15774  15974M 16004  17158M 17189  18106M 18140  18996M 19027  19678M 19733  19882M 19914  20658M 20690
             21049M 21081  21450M 21481  21933M 21964  22262M 22293  22476M 22504  22800M 22831  23014M 23042  23337M
             23368  23551M 23609  25503M 25533  26295M
    10(A)      951U  4054   4055M  4065U  4216U  4219M  4257   4258M  4268U  4529U  4532M  4561   4562M  4572U  4713U
              4716M  4778   4779M  4789U  5783U  5786M  5836   5837M  5847U  6712U  6715M  6746   6747M  6757U  7329U
              7332M  7383   7384M  7394U  7846U  7849M  7887   7888M  7898U  8104U  8107M  8142   8143M  8153U  8359U
              8362M  8397   8398M  8408U  8631U  8634M  8720   8721M  8731U  9490U  9493M  9522   9523M  9533U  9942U
              9945M  9975   9976M  9986U 10563U 10566M 10755  10756M 10766U 11291U 11294M 11324  11325M 11335U 11874U
             11877M 11994  11995M 12005U 12971U 12974M 13044  13045M 13055U 13731U 13734M 13823  13824M 13834U 14294U
             14297M 14325  14326M 14336U 14515U 14518M 14546  14547M 14557U 14648U 14651M 14708  14709M 14719U 15060U
             15063M 15774  15775M 15785U 15971U 15974M 16004  16005M 16015U 17155U 17158M 17189  17190M 17200U 18103U
             18106M 18140  18141M 18151U 18993U 18996M 19027  19028M 19038U 19675U 19678M 19733  19734M 19744U 19879U
             19882M 19914  19915M 19925U 20655U 20658M 20690  20691M 20701U 21046U 21049M 21081  21082M 21092U 21447U
             21450M 21481  21482M 21492U 21930U 21933M 21964  21965M 21975U 22259U 22262M 22293  22294M 22304U 22473U
             22476M 22504  22505M 22515U 22797U 22800M 22831  22832M 22842U 23011U 23014M 23042  23043M 23053U 23334U
             23337M 23368  23369M 23379U 23548U 23551M 23609  23610M 23620U 25500U 25503M 25533  25534M 25544U 26292U
             26295M
    11(B)      947U  4054   4219M  4257   4532M  4561   4716M  4778   5786M  5836   6715M  6746   7332M  7383   7849M
1         (RESM00) (09:43) (22MAR04) General Purpose Register Cross Reference                                               Page  204
              7887   8107M  8142   8362M  8397   8634M  8720   9493M  9522   9945M  9975  10566M 10755  11294M 11324
             11877M 11994  12974M 13044  13734M 13823  14297M 14325  14518M 14546  14651M 14708  15063M 15774  15974M
             16004  17158M 17189  18106M 18140  18996M 19027  19678M 19733  19882M 19914  20658M 20690  21049M 21081
             21450M 21481  21933M 21964  22262M 22293  22476M 22504  22800M 22831  23014M 23042  23337M 23368  23551M
             23609  25503M 25533  26295M
    12(C)      943U  4054   4069   4070M  4071   4072   4219M  4219   4220   4257   4272   4273M  4274   4284U  4288
              4524U  4532M  4532   4533   4561   4576   4577M  4578   4588U  4592   4708U  4716M  4716   4717   4778
              4793   4794M  4795   4805U  4814   5778U  5786M  5786   5787   5836   5851   5852M  5853   5863U  5872
              6707U  6715M  6715   6716   6746   6761   6762M  6763   6773U  6782   7324U  7332M  7332   7333   7383
              7398   7399M  7400   7410U  7419   7841U  7849M  7849   7850   7887   7902   7903M  7904   7914U  7923
              8099U  8107M  8107   8108   8142   8157   8158M  8159   8169U  8178   8354U  8362M  8362   8363   8397
              8412   8413M  8414   8424U  8433   8626U  8634M  8634   8635   8720   8735   8736M  8737   8747U  8751
              9485U  9493M  9493   9494   9522   9537   9538M  9539   9549U  9553   9937U  9945M  9945   9946   9975
              9990   9991M  9992  10002U 10006  10558U 10566M 10566  10567  10755  10770  10771M 10772  10782U 10786
             11286U 11294M 11294  11295  11324  11339  11340M 11341  11351U 11355  11869U 11877M 11877  11878  11994
             12009  12010M 12011  12021U 12030  12966U 12974M 12974  12975  13044  13059  13060M 13061  13071U 13075
             13726U 13734M 13734  13735  13823  13838  13839M 13840  13841  14297M 14297  14298  14325  14340  14341M
             14342  14343  14518M 14518  14519  14546  14561  14562M 14563  14564  14651M 14651  14652  14708  14723
             14724M 14725  14735U 14744  15055U 15063M 15063  15064  15774  15789  15790M 15791  15792  15974M 15974
             15975  16004  16019  16020M 16021  16031U 16035  17150U 17158M 17158  17159  17189  17204  17205M 17206
             17216U 17220  18098U 18106M 18106  18107  18140  18155  18156M 18157  18167U 18171  18988U 18996M 18996
             18997  19027  19042  19043M 19044  19054U 19058  19670U 19678M 19678  19679  19733  19748  19749M 19750
             19751  19882M 19882  19883  19914  19929  19930M 19931  19941U 19945  20650U 20658M 20658  20659  20690
             20705  20706M 20707  20717U 20721  21041U 21049M 21049  21050  21081  21096  21097M 21098  21108U 21112
             21442U 21450M 21450  21451  21481  21496  21497M 21498  21508U 21512  21925U 21933M 21933  21934  21964
             21979  21980M 21981  21982  22262M 22262  22263  22293  22308  22309M 22310  22320U 22324  22468U 22476M
             22476  22477  22504  22519  22520M 22521  22522  22800M 22800  22801  22831  22846  22847M 22848  22858U
             22862  23006U 23014M 23014  23015  23042  23057  23058M 23059  23060  23337M 23337  23338  23368  23383
             23384M 23385  23395U 23399  23543U 23551M 23551  23552  23609  23624  23625M 23626  23636U 23640  25495U
             25503M 25503  25504  25533  25548  25549M 25550  25560U 25564  26287U 26295M 26295  26296
    13(D)      939U  4054   4054   4069   4070   4072M  4102U  4219M  4227U  4257   4257   4272   4273   4288M  4421U
              4532M  4540U  4561   4561   4576   4577   4592M  4716M  4778   4778   4793   4794   4814M  5005U  5124U
              5127U  5488U  5491U  5536U  5539U  5786M  5794U  5836   5836   5851   5852   5872M  6173U  6555U  6558U
              6582U  6585U  6715M  6723U  6746   6746   6761   6762   6782M  7197U  7221U  7224U  7332M  7340U  7383
              7383   7398   7399   7419M  7505U  7712U  7715U  7739U  7742U  7849M  7857U  7887   7887   7902   7903
              7923M  8107M  8142   8142   8157   8158   8178M  8362M  8397   8397   8412   8413   8433M  8634M  8720
              8720   8735   8736   8751M  8934U  9100U  9103U  9207U  9210U  9331U  9334U  9379U  9382U  9493M  9501U
              9522   9522   9537   9538   9553M  9605U  9682U  9685U  9712U  9715U  9817U  9820U  9945M  9953U  9975
              9975   9990   9991  10006M 10036U 10566M 10574U 10755  10755  10770  10771  10786M 10856U 11175U 11178U
             11219U 11222U 11294M 11302U 11324  11324  11339  11340  11355M 11541U 11696U 11699U 11804U 11807U 11877M
             11885U 11994  11994  12009  12010  12030M 12724U 12877U 12880U 12974M 12982U 13044  13044  13059  13060
             13075M 13609U 13669U 13672U 13734M 13742U 13823  13823  13838  13839  13841M 13861U 14148U 14151U 14230U
             14233U 14297M 14305U 14325  14325  14340  14341  14343M 14440U 14518M 14526U 14546  14546  14561  14562
             14564M 14651M 14708  14708  14723  14724  14744M 14824U 15063M 15071U 15774  15774  15789  15790  15792M
             15812U 15909U 15912U 15974M 15982U 16004  16004  16019  16020  16035M 16052U 16429U 16432U 16473U 16476U
             16499U 16502U 16707U 16710U 16910U 16913U 16990U 16993U 17020U 17023U 17064U 17067U 17096U 17099U 17158M
             17166U 17189  17189  17204  17205  17220M 17237U 17460U 17463U 17598U 17601U 17676U 17679U 17859U 17862U
             17904U 17907U 17953U 17956U 18059U 18062U 18106M 18114U 18140  18140  18155  18156  18171M 18184U 18575U
             18578U 18631U 18634U 18898U 18901U 18944U 18947U 18996M 19004U 19027  19027  19042  19043  19058M 19071U
             19360U 19363U 19483U 19486U 19581U 19584U 19624U 19627U 19678M 19686U 19733  19733  19748  19749  19751M
             19838U 19882M 19890U 19914  19914  19929  19930  19945M 20052U 20658M 20666U 20690  20690  20705  20706
             20721M 20917U 20950U 20953U 21010U 21013U 21049M 21057U 21081  21081  21096  21097  21112M 21353U 21450M
             21458U 21481  21481  21496  21497  21512M 21603U 21672U 21675U 21758U 21761U 21894U 21897U 21933M 21941U
             21964  21964  21979  21980  21982M 22158U 22262M 22270U 22293  22293  22308  22309  22324M 22476M 22504
             22504  22519  22520  22522M 22698U 22800M 22808U 22831  22831  22846  22847  22862M 23014M 23042  23042
             23057  23058  23060M 23236U 23337M 23345U 23368  23368  23383  23384  23399M 23551M 23609  23609  23624
             23625  23640M 23693U 24098U 24101U 24177U 24180U 24259U 24262U 24309U 24312U 24816U 24819U 24866U 24869U
             25038U 25041U 25088U 25091U 25503M 25511U 25533  25533  25548  25549  25564M 25651U 26295M 26303U
    14(E)      935U  4054   4132M  4219M  4221B  4257   4367M  4368M  4368N  4370   4451M  4532M  4534B  4561   4656M
1         (RESM00) (09:43) (22MAR04) General Purpose Register Cross Reference                                               Page  205
              4666M  4716M  4718B  4778   4857   4951M  4952M  4952N  4954   5035M  5438M  5526M  5561M  5600M  5607
              5611M  5664M  5674M  5711M  5718   5722M  5786M  5788B  5836   6175M  6176   6214M  6248M  6258M  6570M
              6639M  6715M  6717B  6746   7209M  7278M  7332M  7334B  7383   7671M  7727M  7796M  7849M  7851B  7887
              8107M  8109B  8142   8362M  8364B  8397   8634M  8636B  8720   8795M  8796M  8796N  8798   8835M  8842
              8845M  8867M  8883   8892M  8961M  9046M  9047M  9047N  9049   9133M  9212M  9213   9251M  9275M  9292
              9301M  9369M  9404M  9416M  9426M  9461M  9493M  9495B  9522   9581M  9607   9636M  9697M  9699M  9760
              9774M  9842M  9851M  9861M  9883M  9890   9894M  9945M  9947B  9975  10066M 10181M 10181  10183M 10268M
             10350M 10404M 10485M 10510M 10512  10519M 10522  10566M 10568B 10755  10886M 10941M 11060M 11190M 11251M
             11294M 11296B 11324  11582M 11716M 11775M 11848M 11877M 11879B 11994  12443M 12495M 12741M 12909M 12974M
             12976B 13044  13263M 13638M 13689M 13705M 13734M 13736B 13823  13891M 14024M 14062M 14109M 14178M 14274M
             14297M 14299B 14325  14467M 14518M 14520B 14546  14651M 14653B 14708  14854M 15063M 15065B 15774  15842M
             15930M 15974M 15976B 16004  16039M 16177M 16279M 16356M 16374M 16448M 16486M 16526M 16623M 16720M 16724M
             16819M 16820  16821M 16822  16833U 16846U 16862M 16866M 16931M 16960M 17003M 17047M 17051M 17083M 17115M
             17158M 17160B 17189  17224M 17300M 17305M 17479M 17611M 17615M 17655  17697M 17754M 17794  17887M 17925M
             18026M 18072M 18106M 18108B 18140  18236M 18245M 18265M 18404M 18416M 18588M 18659M 18777M 18817  18925M
             18957M 18996M 18998B 19027  19087M 19096M 19116M 19373M 19405M 19409M 19421M 19461  19530M 19609M 19637M
             19644M 19678M 19680B 19733  19807M 19854M 19863M 19882M 19884B 19914  20082M 20533M 20658M 20660B 20690
             20927M 20939M 20982M 21019M 21049M 21051B 21081  21202M 21242  21277M 21278  21279M 21280  21334M 21397M
             21450M 21452B 21481  21613M 21705M 21746M 21774M 21907M 21933M 21935B 21964  22103M 22105  22188M 22262M
             22264B 22293  22423M 22430  22432M 22476M 22478B 22504  22643M 22645  22728M 22800M 22802B 22831  22961M
             22968  22970M 23014M 23016B 23042  23181M 23183  23266M 23337M 23339B 23368  23498M 23505  23507M 23551M
             23553B 23609  23749M 23787M 23862M 24022M 24087M 24137M 24230M 24298M 24366M 24420M 24478M 24516M 24591M
             24649M 24703M 24761M 24799M 24855M 24919M 24995M 25077M 25145M 25199M 25257M 25327M 25397M 25478M 25503M
             25505B 25533  25707M 25784M 25907M 25977M 26051M 26121M 26190M 26255M 26295M 26297B
    15(F)      931U  4054   4055   4131M  4132B  4157   4158M  4159M  4160M  4161M  4161   4162M  4162   4219M  4257
              4258   4369M  4370   4450M  4451B  4476   4477M  4478M  4479M  4480M  4480   4481M  4481   4532M  4561
              4562   4656M  4664N  4666M  4716M  4778   4779   4887   4888M  4889M  4890M  4891M  4891   4892M  4892
              4953M  4954   5034M  5035B  5060   5061M  5062M  5063M  5064M  5064   5065M  5065   5202   5203M  5204M
              5205M  5206M  5206   5207M  5207   5437M  5438B  5525M  5526B  5560M  5561B  5607M  5610M  5611   5664M
              5672N  5674M  5718M  5721M  5722   5786M  5836   5837   5973   5974M  5975M  5976M  5977M  5977   5978M
              5978   6024   6025M  6026M  6027M  6028M  6028   6029M  6029   6085   6086M  6087M  6088M  6089M  6089
              6090M  6090   6125   6126M  6127M  6128M  6129M  6129   6130M  6130   6175M  6176   6213M  6214B  6248M
              6256N  6258M  6569M  6570B  6571M  6620   6635   6638M  6639B  6715M  6746   6747   6881   6882M  6883M
              6884M  6885M  6885   6886M  6886   6940   6941M  6942M  6943M  6944M  6944   6945M  6945   6979   6980M
              6981M  6982M  6983M  6983   6984M  6984   7019   7020M  7021M  7022M  7023M  7023   7024M  7024   7208M
              7209B  7210M  7259   7274   7277M  7278B  7332M  7383   7384   7473   7474M  7475M  7476M  7477M  7477
              7478M  7478   7670M  7671B  7726M  7727B  7728M  7777   7792   7795M  7796B  7849M  7887   7888   8107M
              8142   8143   8362M  8397   8398   8634M  8720   8721   8766M  8767M  8768   8797M  8798   8842M  8844M
              8845   8865M  8866M  8883   8892   8960M  8961B  9048M  9049   9132M  9133B  9158   9159M  9160M  9161M
              9162M  9162   9163M  9163   9212M  9213   9250M  9251B  9276M  9292   9301   9368M  9369B  9403M  9404B
              9416M  9424N  9426M  9493M  9522   9523   9581M  9590M  9590   9607   9635M  9636B  9696M  9697B  9698M
              9750   9770   9773M  9774B  9841M  9842B  9851M  9859N  9861M  9890M  9893M  9894   9945M  9975   9976
             10065M 10066B 10091  10092M 10093M 10094M 10095M 10095  10096M 10096  10146  10147M 10148M 10149M 10150M
             10150  10151M 10151  10182M 10183M 10189  10267M 10268B 10349M 10350B 10403M 10404B 10435  10436M 10437M
             10438M 10439M 10439  10440M 10440  10470  10471M 10472M 10473M 10474M 10474  10475M 10475  10484M 10484
             10485M 10512M 10519  10520M 10521  10566M 10755  10756  10885M 10886B 10940M 10941B 10970  10971M 10972M
             10973M 10974M 10974  10975M 10975  11059M 11060B 11106  11107M 11108M 11109M 11110M 11110  11111M 11111
             11189M 11190B 11250M 11251B 11294M 11324  11325  11436  11437M 11438M 11439M 11440M 11440  11441M 11441
             11581M 11582B 11715M 11716B 11774M 11775B 11847M 11848B 11877M 11899  11900M 11901M 11902M 11903M 11903
             11904M 11904  11918  11919M 11920M 11921M 11922M 11922  11923M 11923  11994  11995  12442M 12443B 12494M
             12495B 12655  12656M 12657M 12658M 12659M 12659  12660M 12660  12740M 12741B 12908M 12909B 12974M 12996
             12997M 12998M 12999M 13000M 13000  13001M 13001  13015  13016M 13017M 13018M 13019M 13019  13020M 13020
             13044  13045  13262M 13263B 13428  13429M 13430M 13431M 13432M 13432  13433M 13433  13588  13589M 13590M
             13591M 13592M 13592  13593M 13593  13637M 13638B 13688M 13689B 13704M 13705B 13734M 13756  13757M 13758M
             13759M 13760M 13760  13761M 13761  13774  13775M 13776M 13777M 13778M 13778  13779M 13779  13823  13824
             13890M 13891B 13916  13917M 13918M 13919M 13920M 13920  13921M 13921  14023M 14024B 14069M 14116M 14177M
             14178B 14273M 14274B 14297M 14325  14326  14466M 14467B 14518M 14546  14547  14651M 14708  14709  14853M
             14854B 14880  14881M 14882M 14883M 14884M 14884  14885M 14885  15063M 15774  15775  15841M 15842B 15867
             15868M 15869M 15870M 15871M 15871  15872M 15872  15929M 15930B 15974M 16004  16005  16038M 16039B 16176M
1         (RESM00) (09:43) (22MAR04) General Purpose Register Cross Reference                                               Page  206
             16177B 16278M 16279B 16355M 16356B 16373M 16374B 16447M 16448B 16485M 16486B 16525M 16526B 16622M 16623B
             16719M 16720B 16723M 16724B 16861M 16862B 16865M 16866B 16930M 16931B 16959M 16960B 17002M 17003B 17046M
             17047B 17050M 17051B 17082M 17083B 17114M 17115B 17158M 17189  17190  17223M 17224B 17299M 17300B 17304M
             17305B 17384  17385M 17386M 17387M 17388M 17388  17389M 17389  17437  17438M 17439M 17440M 17441M 17441
             17442M 17442  17478M 17479B 17524  17525M 17526M 17527M 17528M 17528  17529M 17529  17577  17578M 17579M
             17580M 17581M 17581  17582M 17582  17610M 17611B 17615M 17631  17649U 17662U 17696M 17697B 17754M 17770
             17788U 17801U 17886M 17887B 17924M 17925B 18025M 18026B 18071M 18072B 18106M 18140  18141  18235M 18236B
             18244M 18245B 18264M 18265B 18317  18318M 18319M 18320M 18321M 18321  18322M 18322  18403M 18404B 18415M
             18416B 18446  18447M 18448M 18449M 18450M 18450  18451M 18451  18498  18499M 18500M 18501M 18502M 18502
             18503M 18503  18554  18555M 18556M 18557M 18558M 18558  18559M 18559  18587M 18588B 18658M 18659B 18777M
             18793  18811U 18824U 18924M 18925B 18956M 18957B 18996M 19027  19028  19086M 19087B 19095M 19096B 19115M
             19116B 19178  19179M 19180M 19181M 19182M 19182  19183M 19183  19231  19232M 19233M 19234M 19235M 19235
             19236M 19236  19286  19287M 19288M 19289M 19290M 19290  19291M 19291  19339  19340M 19341M 19342M 19343M
             19343  19344M 19344  19372M 19373B 19404M 19405B 19408M 19409B 19421M 19437  19455U 19468U 19529M 19530B
             19608M 19609B 19636M 19637B 19643M 19644B 19678M 19733  19734  19806M 19807B 19853M 19854B 19862M 19863B
             19882M 19914  19915  20081M 20082B 20107  20108M 20109M 20110M 20111M 20111  20112M 20112  20197  20198M
             20199M 20200M 20201M 20201  20202M 20202  20271  20272M 20273M 20274M 20275M 20275  20276M 20276  20532M
             20533B 20658M 20690  20691  20926M 20927B 20938M 20939B 20981M 20982B 21018M 21019B 21049M 21081  21082
             21202M 21218  21236U 21249U 21333M 21334B 21396M 21397B 21450M 21481  21482  21582  21583M 21584M 21585M
             21586M 21586  21587M 21587  21612M 21613B 21704M 21705B 21730  21731M 21732M 21733M 21734M 21734  21735M
             21735  21745M 21745  21746M 21773M 21774B 21800  21801M 21802M 21803M 21804M 21804  21805M 21805  21833M
             21834  21835  21906M 21907B 21933M 21964  21965  22052  22053M 22054M 22055M 22056M 22056  22057M 22057
             22104M 22105  22187M 22188B 22213  22214M 22215M 22216M 22217M 22217  22218M 22218  22262M 22293  22294
             22394  22395M 22396M 22397M 22398M 22398  22399M 22399  22423M 22432M 22476M 22504  22505  22592  22593M
             22594M 22595M 22596M 22596  22597M 22597  22644M 22645  22727M 22728B 22753  22754M 22755M 22756M 22757M
             22757  22758M 22758  22800M 22831  22832  22932  22933M 22934M 22935M 22936M 22936  22937M 22937  22961M
             22970M 23014M 23042  23043  23130  23131M 23132M 23133M 23134M 23134  23135M 23135  23182M 23183  23265M
             23266B 23291  23292M 23293M 23294M 23295M 23295  23296M 23296  23337M 23368  23369  23469  23470M 23471M
             23472M 23473M 23473  23474M 23474  23498M 23507M 23551M 23609  23610  23748M 23749B 23786M 23787B 23861M
             23862B 24021M 24022B 24086M 24087B 24136M 24137B 24229M 24230B 24297M 24298B 24365M 24366B 24419M 24420B
             24477M 24478B 24515M 24516B 24590M 24591B 24648M 24649B 24702M 24703B 24760M 24761B 24798M 24799B 24854M
             24855B 24918M 24919B 24994M 24995B 25076M 25077B 25144M 25145B 25198M 25199B 25256M 25257B 25326M 25327B
             25396M 25397B 25477M 25478B 25503M 25533  25534  25706M 25707B 25783M 25784B 25906M 25907B 25976M 25977B
             26050M 26051B 26120M 26121B 26189M 26190B 26254M 26255B 26295M

1RESMAN   (RESM00) (09:43) (22MAR04) Diagnostic Cross Reference and Assembler Summary                                       Page  207
-                                                                                            HLASM R4.0  2004/03/22 09.43
0     No Statements Flagged in this Assembly
 HIGH LEVEL ASSEMBLER, 5696-234, RELEASE 4.0, PTF UQ57391
0SYSTEM: OS/390 02.10.00            JOBNAME: PJG#RES     STEPNAME: ASM        PROCSTEP: (NOPROC)
0Datasets Allocated for this Assembly
  Con DDname   Dataset Name                                 Volume  Member
   P1 SYSIN    SYS04082.T094345.RA000.PJG#RES.INPUT.H01     SCR100
   L1 SYSLIB   SYS3.DUMMYMAC                                SYSB02
   L2          WYL.GG.ORV.MACLIB                            SYSB02
   L3          WYL.GG.SYS.MACLIB                            SYSB05
      SYSLIN   WYL.GG.PJG.OBJ                               SYSB05  RESMAN
      SYSPRINT SYS04082.T094345.RA000.PJG#RES.PRINT.H01     SCR100
      SYSTERM  GG$PJG.PJG#RES.JOB05959.D0000103.?

    7812K allocated to Buffer Pool,         3249K would be required for this to be an In-Storage Assembly
    3229 Primary Input Records Read         5913 Library Records Read                  0 Work File Reads
       0 ASMAOPT Records Read              14987 Primary Print Records Written         0 Work File Writes
     348 Punch Records Written                 0 ADATA Records Written
0Assembly Start Time: 09.43.46 Stop Time: 09.43.56 Processor Time: 00.00.05.2177
 Return Code 000
