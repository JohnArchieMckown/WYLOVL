* %/*  THIS MAKES THE BAL VERSION LOOK LIKE A PL/S MACRO COMMENT        00042002
         MACRO                                                          00050002
.********************************************************************** 00150002
.*                                                                    * 00200002
.*01* MACRO NAME = DOM                                            @L1A* 00250000
.*                                                                    * 00300002
.*01* DESCRIPTIVE NAME = DELETE OPERATOR MESSAGES (DOM)           @L1A* 00350000
.*                                                                    * 00400002
.*01* PROPRIETARY STATEMENT =                                     @L1A* 00401200
.*                                                                @L2C* 00402400
.*         LICENSED MATERIALS - PROPERTY OF IBM                   @L2C* 00403600
.*         THIS MODULE IS "RESTRICTED MATERIALS OF IBM"           @L2C* 00404900
.*         5695-047 (C) COPYRIGHT IBM CORP. (1986, 1990)          @L2C* 00406000
.*         SEE COPYRIGHT INSTRUCTIONS.                                * 00407100
.*                                                                    * 00410800
.*01* STATUS =   HBB4410                                          @L2C* 00413500
.*                                                                    * 00416200
.*01* FUNCTION = THE DOM MACRO IS USED TO DELETE AN OPERATOR      @L1A* 00418900
.*               MESSAGE OR GROUP OF MESSAGES ON A DISPLAY        @L1A* 00421600
.*               CONSOLE. WHEN A PROGRAM NO LONGER REQUIRES       @L1A* 00424300
.*               THAT A MESSAGE BE DISPLAYED, THE DOM MACRO       @L1A* 00427000
.*               INSTRUCTION SHOULD BE ISSUED TO DELETE THE       @L1A* 00429700
.*               MESSAGE.                                         @L1A* 00432400
.*                                                                    * 00435100
.*02*   OPERATION =                                               @L1A* 00437800
.*                                                                    * 00440500
.*               THIS MACRO CHECKS THE SYNTAX OF OPERANDS THAT    @L1A* 00443600
.*               WERE SPECIFIED AND, IF INVALID, AN MNOTE WILL BE @L1A* 00445300
.*               ISSUED. IF THE OPERANDS ARE VALID REGISTER 0 AND @L1A* 00447000
.*               REGISTER 1 WILL BE SET UP AND SVC 87 WILL BE     @L1A* 00448700
.*               ISSUED.                                          @L1A* 00450400
.*                                                                @01A* 00450500
.*               THE FORMAT OF REGISTER 0 AND REGISTER 1          @01A* 00450600
.*               DEPENDS ON THE OPERANDS THAT WERE SPECIFIED:     @01A* 00450700
.*                                                                @01A* 00450800
.*               1."OLD FORMAT" (PRE-JBB2220) IS GENERATED IF     @01A* 00450900
.*                  THE ONLY OPERANDS SPECIFIED ARE THESE:        @01A* 00451000
.*                  MSG                                           @01A* 00451100
.*                  MSGLIST                                       @01A* 00451200
.*                  REPLY=YES                                     @01A* 00451300
.*                                                                @01A* 00451400
.*               IN "OLD FORMAT",                                 @01A* 00451500
.*               REGISTER 0 WILL CONTAIN:                         @01A* 00451600
.*                -ZERO IF MSG WAS SPECIFIED, REPLY WAS NOT       @01A* 00451700
.*                -FOUR IF MSG AND REPLY WERE SPECIFIED           @01A* 00451800
.*                -A NEGATIVE NUMBER IF MSGLIST WAS SPECIFIED,    @01A* 00451900
.*                   REPLY WAS NOT                                @01A* 00452000
.*                -TWELVE IF MSGLIST AND REPLY WERE SPECIFIED     @01A* 00452100
.*               REGISTER 1 WILL CONTAIN ONE OF THE FOLLOWING:    @01A* 00452200
.*                -DOM ID.                                        @01A* 00452300
.*                -ADDRESS OF A LIST OF UP TO 60 DOM IDS.         @01A* 00452400
.*                                                                @01A* 00452500
.*               2."NEW FORMAT" WILL BE GENERATED IF ANY OF THE   @01A* 00452600
.*                  FOLLOWING OPERANDS ARE SPECIFIED:             @01A* 00452700
.*                  SYSID                                         @01A* 00452800
.*                  COUNT                                         @01A* 00452900
.*                  TOKEN                                         @01A* 00453000
.*                  DOMCBLK                                       @01A* 00453100
.*                  SCOPE                                         @01A* 00453200
.*                  LINKAGE                                       @01A* 00453300
.*                                                                @01A* 00453400
.*               IN "NEW FORMAT",                                 @01A* 00453500
.*               REGISTER 0 WILL CONTAIN:                         @L1A* 00453600
.*                -COUNT OF 4-BYTE DOM IDS.                       @L1A* 00453800
.*                -SYSTEM ID FROM WHICH THE MESSAGES ARE TO BE    @L1A* 00455500
.*                  DELETED.                                      @L1A* 00457200
.*                -REQUEST TYPE - DESCRIBES THE DOM REQUEST.      @L1A* 00458900
.*               REGISTER 1 WILL CONTAIN ONE OF THE FOLLOWING:    @L1A* 00460600
.*                -DOM ID.                                        @L1A* 00462300
.*                -ADDRESS OF A LIST OF UP TO 60 DOM IDS.         @L1A* 00464000
.*                -TOKEN.                                         @L1A* 00465700
.*                -0 - (SYSID SPECIFIED ALONE).                   @L1A* 00467400
.*                                                                    * 00470200
.*01* INVOCATION =                                                @L1A* 00472900
.*                                                                    * 00475600
.*    THE FOLLOWING KEYWORDS CAN BE SPECIFIED ON THE DOM MACRO:   @L1A* 00478300
.*                                                                    * 00481000
.*      MSG      =  SINGLE MESSAGE ID IS PASSED                   @L1A* 00483700
.*      MSGLIST  =  A LIST OF UP TO 60 MESSAGE IDS ARE PASSED     @L1A* 00486400
.*      DOMCBLK  =  A POINTER TO A DOM CONTROL BLOCK TO BE USED   @L1A* 00489100
.*                  AS INPUT FOR THE DOM IS PASSED.               @L1A* 00491800
.*      TOKEN    =  A 4 BYTE TOKEN FOR THE MESSAGES THAT ARE      @L1A* 00494500
.*                  TO BE DELETED IS PASSED. THE MESSAGES         @L1A* 00497200
.*                  THAT ARE DELETED BY TOKEN ARE                 @L1A* 00499900
.*                  THE MESSAGES THAT WERE ISSUED WITH            @L1A* 00502600
.*                  THIS TOKEN VIA WTO.                           @L1A* 00505300
.*      SYSID    =  THE ID OF THE SYSTEM FOR THE MESSAGES THAT    @L1A* 00507200
.*                  ARE TO BE DELETED IS PASSED. MESSAGES         @L1A* 00509100
.*                  ORIGINALLY ISSUED WITH THIS SYSTEM ID         @L1A* 00511000
.*                  WILL BE DELETED.                              @L1A* 00512900
.*      COUNT    =  THE COUNT OF 4-BYTE DOM IDS                   @L1A* 00514800
.*                  ASSOCIATED WITH THE DOM REQUEST IS PASSED.    @L1A* 00516700
.*      SCOPE    =  SYSTEMS/SYSTEM - INDICATES IF THE MESSAGE     @D1A* 00517200
.*                  DELETION REQUEST IS TO BE COMMUNICATED TO     @D1A* 00517700
.*                  OTHER SYSTEMS                                 @D1A* 00518200
.*      LINKAGE  =  SPECIFIES HOW CONTROL IS TO PASS TO THE DOM   @L2A* 00518300
.*                  FUNCTION - EITHER SVC OR BRANCH AND LINK      @L2A* 00518400
.*                                                                    * 00518800
.*               NOTE- DOMCBLK, SYSID AND SCOPE ARE KEYWORDS      @D1C* 00518900
.*                     RESERVED FOR CONTROL PROGRAM USE ONLY.     @D1C* 00519000
.*                                                                    * 00519100
.*01* CREATED-BY      = N/A                                       @L1A* 00519200
.*                                                                    * 00519400
.*01* POINTED-TO-BY   = N/A                                       @L1A* 00519700
.*                                                                    * 00520000
.*01* LOCATION        = N/A                                       @L1A* 00520300
.*                                                                    * 00520600
.*01* SERIALIZATION   = N/A                                       @L1A* 00520900
.*                                                                    * 00521200
.*01* CHANGE ACTIVITY =                                               * 00521500
.* $L1=COEXDOM,  JBB2220, 840801, PDFB: JES3/MCS COEXISTENCE          * 00524200
.* $D1=DCR028,   JBB2220, 841128, PDFB: DOWNWARD COMMUNICATION OF     * 00525100
.*                                      MESSAGE DELETION REQUESTS     * 00526000
.* $P1=PA20142,  JBB2220, 850220, PDFB: ISSUE A WARNING MESSAGE       * 00526100
.*                                      INSTEAD OF A SEVERITY 4       * 00526200
.*                                      MNOTE FOR A DOM BY MSG        * 00526300
.*                                      OR MSGLIST WITH THE REPLY     * 00526400
.*                                      KEYWORD                       * 00526500
.* $P2=PA20291,  JBB2220, 850612, PDFB: FOR SYSID AND COUNT KEYWORDS  * 00526600
.*                                      GENERATE AN IC INSTRUCTION    * 00526700
.*                                      INSTEAD OF A LOAD INSTRUCTION * 00526800
.* $P3=PA21031,  JBB2220, 860606, PDFB: CHANGE LOAD TO LOAD ADDRESS   * 00527500
.*                                      FOR MESSAGE LIST              * 00528200
.*             YA02975                                        @YA02975* 00528300
.*             YA06541                                        @YA06541* 00528400
.*             YA24471                                        @YA24471* 00528500
.*             YA23559  (NO CODE CHANGE, N/A TO 4.1.0)        @YA23559* 00528700
.* $L2=CNITGDHE, HBB4410, 890313, PDHE: CONSOLE INTEGRATION           * 00528900
.* $P4=PH25008 , HBB4410, 890320, PDHE: SYNTAX ERRORS                 * 00529100
.* $P5=PEO2712 , HBB4410, 891129, PDHD: CONSOLE INTEGRATION           * 00529200
.* $01=OY47869 , HBB4410, 911021, PDHD: ROLL UP OY23559               * 00529300
.*                                                                    * 00529400
.*01* MESSAGES=                                                   @L1A* 00529600
.*    IF THE REPLY KEYWORD IS SPECIFIED, THE FOLLOWING            @01A* 00529900
.*    WARNING MESSAGES MAY BE ISSUED:                             @01A* 00530200
.*                                                                @01A* 00530500
.*    FOR "NEW FORMAT" EXPANSIONS:                                @01A* 00530800
.*    'REPLY IGNORED. IT IS NOT VALID WITH MSG'                   @L1A* 00531100
.*    'REPLY IGNORED. IT IS NOT VALID WITH MSGLIST'               @L1A* 00531400
.*                                                                    * 00531700
.*    FOR "OLD FORMAT" EXPANSIONS:                                @01A* 00531900
.*    'REPLY OPERAND NOT YES. REPLY KEYWORD IGNORED.'             @01A* 00532100
.*                                                                    * 00532200
.*        THE DOM MACRO WILL ISSUE THE FOLLOWING                  @L1A* 00532300
.*        MNOTES UPON THE DETECTION OF SYNTAX ERRORS:             @L1A* 00535000
.*                                                                    * 00537700
.*02*   WARNINGS = (SEVERITY 4)                                   @L1A* 00540400
.*                                                                    * 00543100
.*    'MSG IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'     @L1A* 00551200
.*    'MSGLIST IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX' @L1A* 00553900
.*    'SYSID IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'   @L1A* 00556600
.*    'TOKEN IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'   @L1A* 00559300
.*    'COUNT IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'   @L1A* 00562000
.*    'LINKAGE IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX' @L2A* 00562900
.*    'DOMCBLK IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX' @L1A* 00564700
.*    'SCOPE=SYSTEMS ASSUMED. SPECIFIED SCOPE VALUE WAS NOT       @D1A* 00565600
.*     SYSTEMS OR SYSTEM'                                         @D1A* 00566500
.*                                                                    * 00567400
.*                                                                    * 00572800
.*                                                                    * 00574100
.*02*   ERRORS = (SEVERITY 12)                                    @L1A* 00575400
.*                                                                    * 00576700
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH SYSID'          @L1A* 00578200
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH TOKEN'          @L1A* 00579500
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH COUNT'          @L1A* 00580900
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH DOMCBLK'        @D1A* 00596000
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH SCOPE'          @D1A* 00611100
.*    'NO TEXT GENERATED.                                         @L1A* 00626200
.*      MSG OR MSGLIST OR DOMCBLK OR SYSID OR TOKEN IS REQUIRED   @L1A* 00626300
.*      BUT NOT SPECIFIED'                                        @L1A* 00626400
.*    'NO TEXT GENERATED.                                         @L1A* 00626500
.*      MSG IS MUTUALLY EXCLUSIVE WITH TOKEN'                     @L1A* 00626800
.*    'NO TEXT GENERATED.                                         @L1A* 00626900
.*      MSG IS MUTUALLY EXCLUSIVE WITH MSGLIST'                   @L1A* 00627000
.*    'NO TEXT GENERATED.                                         @L1A* 00627100
.*      MSGLIST IS MUTUALLY EXCLUSIVE WITH TOKEN'                 @L1A* 00627200
.*    'NO TEXT GENERATED.                                         @L1A* 00627300
.*      TOKEN IS MUTUALLY EXCLUSIVE WITH COUNT'                   @L1A* 00627600
.*    'NO TEXT GENERATED.                                         @L1A* 00629600
.*      SYSID IS MUTUALLY EXCLUSIVE WITH COUNT'                   @L1A* 00631600
.*    'NO TEXT GENERATED.                                         @D1A* 00631700
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH MSG'                   @D1A* 00631800
.*    'NO TEXT GENERATED.                                         @D1A* 00631900
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH MSGLIST'               @D1A* 00632000
.*    'NO TEXT GENERATED.                                         @D1A* 00632100
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH SYSID'                 @D1A* 00632200
.*    'NO TEXT GENERATED.                                         @D1A* 00632300
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH TOKEN'                 @D1A* 00632400
.*    'NO TEXT GENERATED.                                         @D1A* 00632500
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH COUNT'                 @D1A* 00632800
.*    'NO TEXT GENERATED. A FIRST OPERAND IN THE                  @L1A* 00633700
.*      XXXXXXX KEYWORD LIST IS REQUIRED BUT NOT SUPPLIED'        @L1A* 00635200
.*       WHERE XXXXXXX CAN BE MSG, MSGLIST, TOKEN, DOMCBLK,       @L1A* 00636700
.*         COUNT OR SYSID                                         @L1A* 00638200
.*    'NO TEXT GENERATED. SPECIFIED LINKAGE VALUE WAS NOT         @L2A* 00638800
.*      SVC OR BRANCH.'                                           @L2A* 00639100
.*                                                                    * 00640300
.*                                                                    * 00643000
.********************************************************************** 00643600
.*                                                                    * 00644200
.*                                                                    * 00644800
.*   A '^' IS USED AS THE DEFAULT VALUE FOR EACH KEYWORD.         @L1A* 00645400
.*   THIS IS DONE INORDER TO CHECK FOR A KEYWORD THAT WAS         @L1A* 00646000
.*   SPECIFIED WITH NO OPERANDS. FOR EXAMPLE:                     @L1A* 00646600
.*                DOM MSG=                                        @L1A* 00647500
.*                DOM MSG=,SYSID=A                                @L1A* 00648400
.********************************************************************** 00649300
.*                                                                      00655600
&NAME    DOM   &MSG=^,&MSGLIST=^,&REPLY=^,&COUNT=^,&DOMCBLK=^,         X00657700
               &SYSID=^,&TOKEN=^,&SCOPE=^,&LINKAGE=^               @P5C 00659800
.*                                                                      00661900
.*                                                                      00662100
.*   DEFINE INTERNAL VARIABLES                                          00662300
.*                                                                      00662700
         LCLC  &MUTUAL1    USED FOR MUTUALLY EXCLUSIVE KEYWORDS    @L1A 00663000
         LCLC  &MUTUAL2    USED FOR MUTUALLY EXCLUSIVE KEYWORDS    @L1A 00663300
         LCLC  &RPYIND1    USED FOR REPLY INVALID MESSAGE          @L1A 00663600
         LCLC  &MSGWORD    USED FOR NO OPERANDS SPECIFIED MESSAGE  @L1A 00663900
         LCLC  &MSGVAL1    USED FOR MORE THAN ONE OPERAND SPECIFIED    X00664400
                           MESSAGE                                 @L1A 00664900
         LCLC  &MSGVAL2    USED FOR MORE THAN ONE OPERAND SPECIFIED    X00665400
                           MESSAGE                                 @L1A 00665900
         LCLB  &OLDFMT     ON IF OLD FORMAT INPUT TO BE GENERATED      X00666100
                           (NO KYWDS NEW IN JBB2220 OR LATER)      @01A 00666300
         LCLA  &RPYINDC    REPLY OPERAND INDICATOR                 @01A 00666500
.*                                                                      00666700
.*  CHECK IF ONE OF THE REQUIRED OPERANDS IS SPECIFIED (MSG,       @L1A 00668200
.*   MSGLIST, SYSID, TOKEN, DOMCBLK)                               @L1A 00674500
.*                                                                      00680800
         AIF   ('&MSG(1)' NE '^' OR '&MSGLIST(1)' NE '^' OR            X00687100
               '&SYSID(1)' NE '^' OR '&TOKEN(1)' NE '^' OR             X00693400
               '&DOMCBLK(1)' NE '^').DOML00                        @01C 00699700
         MNOTE 12,'***   NO TEXT GENERATED. ''MSG'' OR ''MSGLIST'' OR  X00706000
               ''DOMCBLK'''                                        @L1A 00712300
         MNOTE    '               OR ''SYSID'' OR ''TOKEN'' IS REQUIREDX00718600
                BUT NOT SPECIFIED.'                                @L1A 00724900
         MEXIT                                                     @L1A 00731200
.*                                                                      00731900
.*  CHECK IF ANY KEYWORDS NEW IN JBB2220 OR LATER ARE SPECIFIED.   @01A 00732600
.*   IF NOT, WILL GENERATE OLD-FORMAT INPUT.                       @01A 00733300
.*                                                                      00734000
.DOML00  AIF   ('&SYSID(1)' NE '^' OR '&COUNT(1)' NE '^' OR            X00734700
               '&DOMCBLK(1)' NE '^' OR '&TOKEN(1)' NE '^' OR           X00735400
               '&SCOPE(1)' NE '^' OR '&LINKAGE(1)' NE '^').DOML01  @01A 00736100
&OLDFMT  SETB  1          USE OLD FORMAT INPUT                     @01A 00736800
.*                                                                      00737500
.*  CHECK FOR MUTUALLY EXCLUSIVE KEYWORDS:                         @L1A 00814000
.*           MSG AND MSGLIST                                       @L1A 00814900
.*           MSG AND TOKEN                                         @L1A 00815800
.*           MSGLIST AND TOKEN                                     @L1A 00816700
.*           SYSID AND COUNT                                       @L1A 00817600
.*           TOKEN AND COUNT                                       @L1A 00818500
.*           DOMCBLK AND MSG                                       @D1A 00818600
.*           DOMCBLK AND MSGLIST                                   @D1A 00818700
.*           DOMCBLK AND SYSID                                     @D1A 00818800
.*           DOMCBLK AND TOKEN                                     @D1A 00818900
.*           DOMCBLK AND COUNT                                     @D1A 00819100
.*                                                                      00819400
.*                                                                      00825700
.*  CHECK IF MSG AND MSGLIST KEYWORDS ARE SPECIFIED                @L1A 00832000
.*                                                                      00835100
.DOML01  AIF   ('&MSG(1)' EQ '^').DOML03                           @L1A 00838300
         AIF   ('&MSGLIST(1)' EQ '^').DOML02                       @L1A 00850900
&MUTUAL1 SETC  'MSG'        SET MSG AS THE FIRST KEYWORD FOR MUTUALLY  X00855500
                            EXCLUSIVE MESSAGE                      @L1A 00860100
&MUTUAL2 SETC  'MSGLIST'    SET MSGLIST AS THE SECOND KEYWORD FOR      X00864700
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00869300
         AGO   .DOML069                                            @D1C 00874300
.*                                                                      00882400
.*  CHECK IF MSG AND TOKEN KEYWORDS ARE SPECIFIED                  @L1A 00901300
.*                                                                      00904400
.DOML02  AIF   ('&TOKEN(1)' EQ '^').DOML03                              00907600
&MUTUAL1 SETC  'MSG'        SET MSG AS THE FIRST KEYWORD FOR MUTUALLY  X00907900
                            EXCLUSIVE MESSAGE                      @L1A 00908200
&MUTUAL2 SETC  'TOKEN'      SET TOKEN AS THE SECOND KEYWORD FOR        X00908500
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00908800
         AGO   .DOML069                                            @D1C 00909400
.*                                                                      00910000
.*  CHECK IF MSGLIST AND TOKEN KEYWORDS ARE SPECIFIED              @L1A 00911200
.*                                                                      00911500
.DOML03  AIF   ('&MSGLIST(1)' EQ '^').DOML05                       @L1A 00911800
         AIF   ('&TOKEN(1)' EQ '^').DOML05                         @L1A 00913600
&MUTUAL1 SETC  'MSGLIST'    SET MSGLIST AS THE FIRST KEYWORD FOR       X00913900
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00914200
&MUTUAL2 SETC  'TOKEN'      SET TOKEN AS THE SECOND KEYWORD FOR        X00914500
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00914800
         AGO   .DOML069                                            @D1C 00915400
.*                                                                      00916000
.*  CHECK IF SYSID AND COUNT KEYWORDS ARE SPECIFIED                @L1A 00917200
.*                                                                      00917500
.DOML05  AIF   ('&SYSID(1)' EQ '^').DOML06                         @L1A 00917800
         AIF   ('&COUNT(1)' EQ '^').DOML06                         @L1A 00919000
&MUTUAL1 SETC  'SYSID'      SET SYSID AS THE FIRST KEYWORD FOR         X00919300
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00919600
&MUTUAL2 SETC  'COUNT'      SET COUNT AS THE SECOND KEYWORD FOR        X00919900
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00920200
         AGO   .DOML069                                            @D1C 00920800
.*                                                                      00921400
.*  CHECK IF TOKEN AND COUNT KEYWORDS ARE SPECIFIED                @L1A 00923200
.*                                                                      00923500
.DOML06  AIF   ('&TOKEN(1)' EQ '^').DOML061                        @L1A 00923800
         AIF   ('&COUNT(1)' EQ '^').DOML061                        @L1A 00925000
&MUTUAL1 SETC  'TOKEN'      SET TOKEN AS THE FIRST KEYWORD FOR         X00925300
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00925600
&MUTUAL2 SETC  'COUNT'      SET COUNT AS THE SECOND KEYWORD FOR        X00925900
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 00926200
         AGO   .DOML069                                            @D1A 00926500
.*                                                                      00926800
.*                                                                      00927400
.*  CHECK IF DOMCBLK AND MSG KEYWORDS ARE SPECIFIED                @D1A 00927600
.*                                                                      00927700
.*                                                                      00927800
.DOML061 AIF   ('&DOMCBLK(1)' EQ '^').DOML07                       @D1A 00927900
&MUTUAL1 SETC  'DOMCBLK'    SET DOMCBLK AS THE FIRST KEYWORD FOR       X00928000
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 00928100
         AIF   ('&MSG(1)' EQ '^').DOML062                          @D1A 00928200
&MUTUAL2 SETC  'MSG'        SET MSG AS THE SECOND KEYWORD FOR          X00928300
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 00928400
         AGO   .DOML069                                            @D1A 00928500
.*                                                                      00928600
.*  CHECK IF DOMCBLK AND MSGLIST KEYWORDS ARE SPECIFIED            @D1A 00928800
.*                                                                      00928900
.DOML062 AIF   ('&MSGLIST(1)' EQ '^').DOML063                      @D1A 00929000
&MUTUAL2 SETC  'MSGLIST'    SET MSGLIST AS THE SECOND KEYWORD FOR      X00929200
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 00929300
         AGO   .DOML069                                            @D1A 00929400
.*                                                                      00929500
.*  CHECK IF DOMCBLK AND SYSID KEYWORDS ARE SPECIFIED              @D1A 00929800
.*                                                                      00929900
.DOML063 AIF   ('&SYSID(1)' EQ '^').DOML064                        @D1A 00930000
&MUTUAL2 SETC  'SYSID'      SET SYSID AS THE SECOND KEYWORD FOR        X00930300
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 00930400
         AGO   .DOML069                                            @D1A 00930500
.*                                                                      00930600
.*  CHECK IF DOMCBLK AND TOKEN KEYWORDS ARE SPECIFIED              @D1A 00930900
.*                                                                      00931000
.DOML064 AIF   ('&TOKEN(1)' EQ '^').DOML065                        @D1A 00931100
&MUTUAL2 SETC  'TOKEN'      SET TOKEN AS THE SECOND KEYWORD FOR        X00931400
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 00931500
         AGO   .DOML069                                            @D1A 00931600
.*                                                                      00931700
.*  CHECK IF DOMCBLK AND COUNT KEYWORDS ARE SPECIFIED              @D1A 00932400
.*                                                                      00932600
.DOML065 AIF   ('&COUNT(1)' EQ '^').DOML07                         @D1A 00932900
&MUTUAL2 SETC  'COUNT'      SET COUNT AS THE SECOND KEYWORD FOR        X00933600
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 00933700
.*                                                                      00933800
.*                                                                      00933900
.*  ISSUE MNOTE FOR MUTUALLY EXCLUSIVE KEYWORDS                    @L1A 00934000
.*                                                                      00934100
.*                                                                      00934900
.DOML069 MNOTE 12,'*** NO TEXT GENERATED. ''&MUTUAL1'' IS MUTUALLY EXCLX00935700
               USIVE WITH'                                         @D1C 00936500
         MNOTE  '            ''&MUTUAL2''.'                        @L1A 00937300
         MEXIT                                                     @L1A 00938100
.*                                                                      00939100
.*                                                                      00945400
.*  CHECK IF REPLY KEYWORD SPECIFIED                               @L1A 01153300
.*                                                                      01156400
.DOML07  AIF   ('&REPLY(1)' EQ '^').DOML1                               01159600
.*                                                                      01165900
.*                                                                      01168300
.* IF OLD FORMAT INPUT IS BEING USED, CHECK REPLY=YES              @01A 01168500
         AIF   (NOT(&OLDFMT)).DOML08                               @01A 01168700
         AIF   ('&REPLY' EQ 'YES').DOML71                          @01A 01168900
.* REPLY OPERAND IS IN ERROR                                       @01A 01169100
         MNOTE 4,'*** REPLY OPERAND NOT YES. REPLY KEYWORD IGNORED.'    01169300
         AGO   .DOML1                                              @01A 01169500
.DOML71  ANOP             REPLY OPERAND WAS 'YES' BRANCH PT        @01A 01169700
&RPYINDC SETA  4          SHOW THAT REPLY = YES USED               @01A 01169900
.*                                                                      01170700
.*  CHECK IF REPLY AND SYSID KEYWORDS ARE SPECIFIED                @L1A 01173100
.*                                                                      01174300
.DOML08  AIF   ('&SYSID(1)' EQ '^').DOML081                        @L1A 01175500
&RPYIND1 SETC  'SYSID'                     INDICATE SYSID          @L1A 01177900
         AGO   .DOML085                                            @L1A 01180700
.*                                                                      01181800
.*  CHECK IF REPLY AND TOKEN KEYWORDS ARE SPECIFIED                @L1A 01200200
.*                                                                      01209400
.DOML081 AIF   ('&TOKEN(1)' EQ '^').DOML082                        @L1A 01218600
&RPYIND1 SETC  'TOKEN'                     INDICATE TOKEN          @L1A 01237000
         AGO   .DOML085                                            @L1A 01255400
.*                                                                      01273800
.*  CHECK IF REPLY AND COUNT KEYWORDS ARE SPECIFIED                @L1A 01292200
.*                                                                      01301400
.DOML082 AIF   ('&COUNT(1)' EQ '^').DOML083                        @D1C 01310600
&RPYIND1 SETC  'COUNT'                     INDICATE COUNT          @L1A 01329200
         AGO   .DOML085                                            @D1A 01330000
.*                                                                      01330800
.*  CHECK IF REPLY AND DOMCBLK KEYWORDS ARE SPECIFIED              @D1A 01331100
.*                                                                      01331200
.DOML083 AIF   ('&DOMCBLK(1)' EQ '^').DOML084                      @D1A 01331400
&RPYIND1 SETC  'DOMCBLK'                   INDICATE DOMCBLK        @D1A 01331700
         AGO   .DOML085                                            @D1A 01332000
.*                                                                      01332400
.*  CHECK IF REPLY AND SCOPE KEYWORDS ARE SPECIFIED                @D1A 01333000
.*                                                                      01333300
.DOML084 AIF   ('&SCOPE(1)' EQ '^').DOML086                        @D1A 01333600
&RPYIND1 SETC  'SCOPE'                     INDICATE SCOPE          @D1A 01334200
.*                                                                      01334800
.*                                                                      01334900
.*  ISSUE MNOTE IF REPLY KEYWORD IS SPECIFIED WITH TOKEN OR SYSID  @L1A 01335000
.*  OR COUNT OR DOMCBLK OR SCOPE KEYWORD                           @D1C 01335100
.*                                                                      01335200
.*                                                                      01335400
.DOML085 MNOTE 12,'*** NO TEXT GENERATED. ''REPLY'' IS NOT VALID WITH 'X01335600
               '&RPYIND1''.'                                       @D1C 01337200
         MEXIT                                                     @L1A 01339100
.*                                                                      01342300
.*  CHECK IF REPLY AND MSG KEYWORDS ARE SPECIFIED                  @L1A 01342900
.*                                                                      01343200
.DOML086 AIF   ('&MSG(1)' EQ '^').DOML09                                01343500
&RPYIND1 SETC  'MSG'                       INDICATE MSG            @L1A 01344100
         AGO   .DOML095                                            @L1A 01344700
.*                                                                      01345400
.*  CHECK IF REPLY AND MSGLIST KEYWORDS ARE SPECIFIED              @L1A 01345500
.*                                                                      01345600
.DOML09  AIF   ('&MSGLIST(1)' EQ '^').DOML1                             01345700
&RPYIND1 SETC  'MSGLIST'                   INDICATE MSGLIST        @L1A 01345800
.*                                                                      01345900
.*                                                                      01346000
.*  ISSUE WARNING MESSAGE FOR REPLY AND MSG OR MSGLIST KEYWORDS    @P1C 01346100
.*  SPECIFIED                                                      @P1C 01346200
.*                                                                      01346300
.*                                                                      01346400
.DOML095 AIF    (&OLDFMT).DOML1                                    @01C 01346500
         MNOTE  '** WARNING ** ''REPLY'' IGNORED. IT IS NOT VALID WITH X01346600
               ''&RPYIND1''.'                                      @01C 01346700
.*                                                                      01346800
.*  CHECK TO SEE IF THE KEYWORDS THAT WERE SPECIFIED CONTAIN       @L1A 01346900
.*  VALID OPERANDS                                                 @L1A 01347000
.*                                                                      01347800
.DOML1   ANOP                                                           01348600
.*   MSG KEYWORD SPECIFIED                                         @L1A 01354900
         AIF   ('&MSG(1)' EQ '^').DOMLM                            @L1A 01361200
.*  CHECK TO SEE IF VALID OPERANDS SPECIFIED WITH MSG              @L1A 01370600
         AIF   ('&MSG(1)' EQ '').DOML2     NO OPERANDS SPECIFIED   @L1A 01375300
         AIF   (N'&MSG GT 1 OR N'&MSG(1) GT 1 ).DOML21 MORE THAN ONE   X01379000
                                                OPERAND SPECIFIED  @L1A 01382700
         AGO   .DOMLM                                              @L1A 01405300
.*                                                                 @L1A 01411600
.DOML2   ANOP                                                           01413700
&MSGWORD SETC  'MSG'          SAVE MSG KEYWORD FOR ERROR MESSAGE   @L1A 01415800
         AGO   .DOML175                                            @L1A 01417900
.*                                                                 @L1A 01420000
.DOML21  ANOP                                                      @L1A 01422100
         MNOTE  4,'*** ''MSG=&MSG'' IS TOO LONG. ARGUMENTS ARE IGNORED' 01439600
         MNOTE  '             AFTER ''&MSG(1,1)''.'                @L1A 01457100
.*                                                                      01474600
.*     MSGLIST KEYWORD SPECIFIED                                   @L1A 01480900
.*                                                                      01484000
.DOMLM   AIF   ('&MSGLIST(1)' EQ '^').DOMLT                        @L1A 01487200
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH MSGLIST     @L1A 01496600
         AIF   ('&MSGLIST(1)' EQ '').DOML8   NO OPERANDS SPECIFIED @L1A 01501300
         AIF   (N'&MSGLIST GT 1 OR N'&MSGLIST(1) GT 1).DOML81 MORE THANX01505000
                                             ONE OPERAND SPECIFIED @L1A 01508700
         AGO   .DOMLT                                              @L1A 01531300
.*                                                                      01533900
.DOML8   ANOP                                                           01536500
&MSGWORD SETC  'MSGLIST'        SAVE MSGLIST KEYWORD FOR ERROR MESSAGE X01538200
                                                                   @L1A 01539900
         AGO   .DOML175                                            @L1A 01541700
.*                                                                      01544300
.DOML81  ANOP                                                      @L1A 01546900
         MNOTE  4,'*** ''MSGLIST=&MSGLIST'' IS TOO LONG. ARGUMENTS ARE' 01551200
         MNOTE  '             IGNORED AFTER ''&MSGLIST(1,1)''.'    @L1A 01555500
.*                                                                      01559900
.*     TOKEN KEYWORD SPECIFIED                                     @L1A 01581700
.*                                                                      01584800
.DOMLT   AIF   ('&TOKEN(1)' EQ '^').DOMLS                          @L1A 01588000
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH TOKEN       @L1A 01597400
         AIF   ('&TOKEN(1)' EQ '').DOML10    NO OPERANDS SPECIFIED @L1A 01602100
         AIF   (N'&TOKEN GT 1 OR N'&TOKEN(1) GT 1).DOML101 MORE THAN   X01605800
                                             ONE OPERAND SPECIFIED @L1A 01609500
         AGO   .DOMLS                                              @L1A 01632100
.*                                                                      01635600
.DOML10  ANOP                                                           01639100
&MSGWORD SETC  'TOKEN'        SAVE TOKEN KEYWORD FOR ERROR MESSAGE @L1A 01642600
         AGO   .DOML175                                            @L1A 01646100
.*                                                                      01649600
.DOML101 ANOP                                                      @L1A 01653100
         MNOTE  4,'*** ''TOKEN=&TOKEN'' IS TOO LONG. ARGUMENTS ARE'     01658900
         MNOTE  '             IGNORED AFTER ''&TOKEN(1,1)''.'      @L1A 01664700
.*                                                                      01673800
.*     SYSID KEYWORD SPECIFIED                                     @L1A 01682900
.*                                                                      01692000
.DOMLS   AIF   ('&SYSID(1)' EQ '^').DOMLD                          @L1A 01701400
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH SYSID       @L1A 01710800
         AIF   ('&SYSID(1)' EQ '').DOML12    NO OPERANDS SPECIFIED @L1A 01715500
         AIF   (N'&SYSID GT 1 OR N'&SYSID(1) GT 1).DOML121 MORE THAN   X01719200
                                             ONE OPERAND SPECIFIED @L1A 01722900
         AGO   .DOMLD                                              @L1A 01745500
.*                                                                      01749200
.DOML12  ANOP                                                           01752900
&MSGWORD SETC  'SYSID'       SAVE SYSID KEYWORD FOR ERROR MESSAGE  @L1A 01756600
         AGO   .DOML175                                            @L1A 01760300
.*                                                                      01764000
.DOML121 ANOP                                                      @L1A 01767700
         MNOTE  4,'*** ''SYSID=&SYSID'' IS TOO LONG. ARGUMENTS ARE'     01780000
         MNOTE  '             IGNORED AFTER ''&SYSID(1,1)''.'      @L1A 01792300
.*                                                                      01804700
.*     DOMCBLK KEYWORD SPECIFIED                                   @L1A 01808500
.*                                                                      01811600
.DOMLD   AIF   ('&DOMCBLK(1)' EQ '^').DOMLL                        @L2C 01814800
.*  CHECK TO SEE IF IF VALID OPERANDS WERE SPECIFIED WITH DOMCBLK  @L1A 01824200
         AIF   ('&DOMCBLK(1)' EQ '').DOML14   NO OPERAND SPECIFIED @L1A 01828900
         AIF   (N'&DOMCBLK GT 1 OR N'&DOMCBLK(1) GT 1).DOML141 MORE    X01832600
                                        THAN ONE OPERAND SPECIFIED @L1A 01836300
         AGO   .DOMLL                                              @L2C 01858900
.*                                                                      01859900
.DOML14  ANOP                                                           01860900
&MSGWORD SETC  'DOMCBLK'        SAVE DOMCBLK KEYWORD FOR ERROR MESSAGE X01861500
                                                                   @L1A 01862100
         AGO   .DOML175                                            @L1A 01862900
.*                                                                      01863900
.DOML141 ANOP                                                      @L1A 01864900
         MNOTE  4,'*** ''DOMCBLK=&DOMCBLK'' IS TOO LONG. ARGUMENTS ARE' 01914900
         MNOTE  '             IGNORED AFTER ''&DOMCBLK(1,1)''.'    @L1A 01964900
.*                                                                      02032100
.*                                                                      02032200
.*     LINKAGE KEYWORD SPECIFIED                                   @L2A 02032300
.*                                                                      02032400
.DOMLL   AIF   ('&LINKAGE(1)' EQ '^').DOMLY                        @L2A 02032500
.*  CHECK TO SEE IF IF VALID OPERANDS WERE SPECIFIED WITH LINKAGE  @L2A 02032600
         AIF   ('&LINKAGE(1)' NE 'SVC' AND                             X02032700
                '&LINKAGE(1)' NE 'BRANCH').DOMLL1  ISSUE ERROR MSG @L2A 02032800
         AIF   (N'&LINKAGE GT 1 OR N'&LINKAGE(1) GT 1).DOMLL2  MORE    X02032900
                                        THAN ONE OPERAND SPECIFIED @L2A 02033000
         AGO   .DOMLY                                              @L2A 02033100
.*                                                                      02033200
.DOMLL1  ANOP                                                      @L2A 02033300
         MNOTE  12,'NO TEXT GENERATED. SPECIFIED LINKAGE '         @L2A 02033400
         MNOTE  '       VALUE WAS NOT SVC OR BRANCH.'              @L2A 02033500
         MEXIT                                                     @L2A 02033600
.*                                                                      02033700
.DOMLL2  ANOP                                                      @L2A 02033800
         MNOTE  4,'*** ''LINKAGE=&LINKAGE'' IS TOO LONG. ARGUMENTS ARE' 02033900
         MNOTE  '             IGNORED AFTER ''&LINKAGE(1,1)''.'    @L2A 02034000
.*                                                                      02034100
.*     COUNT   KEYWORD SPECIFIED                                   @L1A 02039100
.*                                                                      02041600
.DOMLY   AIF   ('&COUNT(1)' EQ '^').DOML178                        @P5C 02044100
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH COUNT       @L1A 02049100
         AIF   ('&COUNT(1)' EQ '').DOML16    NO OPERANDS SPECIFIED @L1A 02054100
         AIF   (N'&COUNT GT 1 OR N'&COUNT(1) GT 1).DOML161 MORE THAN   X02059100
                                            ONE OPERAND SPECIFIED  @L1A 02064100
         AGO   .DOML178                                            @D1C 02069100
.*                                                                      02074100
.DOML16  ANOP                                                           02079100
&MSGWORD SETC  'COUNT'       SAVE COUNT KEYWORD FOR ERROR MESSAGE  @L1A 02084100
         AGO   .DOML175                                            @L1A 02089100
.*                                                                      02094100
.DOML161 ANOP                                                      @L1A 02099100
         MNOTE  4,'*** ''COUNT=&COUNT'' IS TOO LONG. ARGUMENTS ARE'     02106600
         MNOTE  '             IGNORED AFTER ''&COUNT(1,1)''.'      @L1A 02114100
         AGO   .DOML178                                            @D1C 02121600
.*                                                                 @L1A 02129100
.*                                                                      02134100
.*    ISSUE THE FOLLOWING MNOTE IF NO OPERANDS WERE SPECIFIED FOR A     02139100
.*    PARTICULAR KEYWORD                                           @L1A 02144100
.*                                                                      02149100
.DOML175 MNOTE 12,'*** NO TEXT GENERATED. A FIRST OPERAND IN THE '      02154100
         MNOTE  '            ''&MSGWORD'' KEYWORD LIST IS REQUIRED BUT X02159100
               NOT SUPPLIED.'                                      @L1A 02164100
         MEXIT                                                     @L1A 02169100
.*                                                                      02174100
.*                                                                      02179100
.*     SCOPE KEYWORD SPECIFIED                                     @D1A 02179900
.*                                                                      02180100
.DOML178 AIF   ('&SCOPE(1)' EQ '^').DOML179                        @D1A 02180300
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH SCOPE       @D1A 02180700
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS' OR                            X02181100
                '&SCOPE(1)' EQ 'SYSTEM').DOML179 SCOPE OPERAND IS      X02181300
                                                 SYSTEMS OR SYSTEM @D1A 02181500
         MNOTE  4,'*** ''SCOPE=SYSTEMS'' ASSUMED. SPECIFIED SCOPE'      02181900
         MNOTE  '             VALUE WAS NOT ''SYSTEMS'' OR ''SYSTEM''.'X02182100
                                                                   @D1A 02182300
.*                                                                      02182700
.*  THE FOLLOWING SECTION GENERATES 'NEW-FORMAT' CODE              @01A 02182800
.*  (KEYWORDS NEW IN JBB2220 OR LATER WERE SPECIFIED)              @01A 02182900
.*                                                                      02183100
.*  GENERATE CODE FOR COUNT AND SYSID KEYWORDS                          02184100
.*                                                                      02189600
.DOML179 ANOP                                                      @L1A 02190200
         AIF (&OLDFMT).DOMLO                                       @01A 02190500
         AIF   (T'&NAME EQ 'O').DOML180  NAME SPECIFIED                 02190900
.* &NAME WAS SPECIFIED, PUT OUT A LABEL                                 02191600
&NAME    DS    0H                                                       02192300
.DOML180 AIF   ('&SYSID(1)' EQ '^').DOML183 SYSID KEYWORD SPECIFIED@L1A 02193000
         AIF   ('&SYSID'(1,1) EQ '(').DOML181 REGISTER SPECIFIED WITH  X02193700
                                              SYSID                @L1A 02194400
         SR    0,0                       SET REGISTER TO ZERO  @YA24471 02196600
         IC    0,&SYSID(1,1)             MOVE SYSID INTO REGISTER      X02198800
                                                               @YA24471 02201000
         AGO   .DOML182                                            @L1A 02201700
.DOML181 LR    0,&SYSID(1,1)             MOVE SYSID INTO REGISTER      X02202800
                                                               @YA24471 02203900
.DOML182 SLL   0,16                      MOVE SYSID TO SYSID FIELD     X02205000
                                         OF REGISTER           @YA24471 02206100
         AGO   .DOML20                                             @L1A 02207300
.DOML183 AIF   ('&COUNT(1)' EQ '^').DOML19  COUNT KEYWORD SPECIFIED@L1A 02208300
         AIF   ('&COUNT'(1,1) EQ '(').DOML185 REGISTER SPECIFIED WITH  X02209400
                                              COUNT                @L1A 02210100
         SR    0,0                       SET REGISTER TO ZERO  @YA24471 02210800
         IC    0,&COUNT(1,1)             MOVE COUNT INTO REGISTER      X02211500
                                                               @YA24471 02212200
         AGO   .DOML186                                            @L1A 02212900
.DOML185 LR    0,&COUNT(1,1)             MOVE COUNT TO REGISTER        X02216400
                                                               @YA24471 02219900
.DOML186 SLL   0,24                      MOVE COUNT TO COUNT FIELD OF  X02223400
                                         REGISTER              @YA24471 02226900
         AGO   .DOML20                                             @L1A 02230800
.DOML19  SR    0,0                       SET REGISTER TO ZERO  @YA24471 02231200
.*                                                                      02231700
.*    GENERATE CODE FOR MSG KEYWORD                                @L1A 02231800
.*                                                                      02232200
.DOML20  AIF   ('&MSG(1)' EQ '^').DOML200    MSG SPECIFIED         @L1A 02237600
         AIF   ('&SYSID(1)' EQ '^').DOML201  SYSID SPECIFIED       @L1A 02283600
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML20A  SCOPE=SYSTEMS       X02292800
                                                   SPECIFIED       @D1A 02302000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML20B  SCOPE=SYSTEM         X02311200
                                                   SPECIFIED       @D1A 02320400
         LA    15,17                     SET MSG, SYSID REQUEST TYPE INX02329600
                                         REGISTER              @YA24471 02375600
         AGO   .DOML202                                            @L1A 02421600
.DOML20A LA    15,81                     SET MSG,SYSID, SCOPE=SYSTEMS  X02429200
                                         REQUEST TYPE IN               X02434200
                                         REGISTER              @YA24471 02439200
         AGO   .DOML202                                            @L1A 02444400
.DOML20B LA    15,145                    SET MSG,SYSID, SCOPE=SYSTEM   X02452000
                                         REQUEST TYPE IN               X02457700
                                         REGISTER              @YA24471 02463400
         AGO   .DOML202                                            @D1A 02469100
.DOML201 AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML20C  SCOPE=SYSTEMS       X02474800
                                                   SPECIFIED       @D1A 02482400
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML20D   SCOPE=SYSTEM        X02490000
                                                   SPECIFIED       @D1A 02497600
         LA    15,1                      SET MSG REQUEST TYPE IN       X02505200
                                         REGISTER              @YA24471 02513600
         AGO   .DOML202                                            @D1A 02515700
.DOML20C LA    15,65                     SET MSG, SCOPE=SYSTEMS REQUESTX02517800
                                         TYPE IN REGISTER      @YA24471 02519900
         AGO   .DOML202                                            @D1A 02522000
.DOML20D LA    15,129                    SET MSG, SCOPE=SYSTEM REQUEST X02524100
                                         TYPE IN REGISTER      @YA24471 02526200
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 02528900
.DOML202 AIF   ('&MSG'(1,1) EQ '(').DOML203                        @L1A 02544200
.*   OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT IS               02559500
.*   AN ADDR NAME.                                                 @L1A 02574800
         L     1,&MSG(1,1)               SET MESSAGE ID IN REGISTER 1  X02590100
                                                                   @L1A 02605400
         AGO   .DOMLE                                              @L1A 02620700
.DOML203 AIF   ('&MSG(1)' EQ '1').DOMLE  IF THE MESSAGE ID WAS         X02626400
                                         SPECIFIED IN REGISTER 1, DO   X02632100
                                         NOT RELOAD REGISTER 1     @L1A 02637800
         LR    1,&MSG(1,1)               SET MESSAGE ID IN             X02643800
                                         REGISTER 1                @L1A 02651600
         AGO   .DOMLE                                              @L1A 02697600
.*                                                                      02743700
.*                                                                      02751200
.*    GENERATE CODE FOR MSGLIST KEYWORD                            @L1A 02761300
.*                                                                      02771400
.DOML200 AIF   ('&MSGLIST(1)' EQ '^').DOML23                       @L1A 02821400
         AIF   ('&SYSID(1)' EQ '^').DOML22  SYSID SPECIFIED        @L1A 02871400
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML22A  SCOPE=SYSTEMS       X02881400
                                                   SPECIFIED       @D1A 02891400
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML22B   SCOPE=SYSTEM        X02901400
                                                   SPECIFIED       @D1A 02911400
         LA    15,24                     SET MSGLIST, SYSID REQUEST    X02921400
                                         TYPE IN REGISTER      @YA24471 02971400
         AGO   .DOML209                                            @L1A 03021400
.DOML22A LA    15,88                     SET MSGLIST, SYSID,           X03028200
                                         SCOPE=SYSTEMS REQUEST TYPE IN X03035000
                                         REGISTER              @YA24471 03041800
         AGO   .DOML209                                            @D1A 03048600
.DOML22B LA    15,152                    SET MSGLIST, SYSID,           X03055400
                                         SCOPE=SYSTEM REQUEST TYPE IN  X03062200
                                         REGISTER              @YA24471 03069000
         AGO   .DOML209                                            @D1A 03075800
.DOML22  AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML22C  SCOPE=SYSTEMS       X03082600
                                                   SPECIFIED       @D1A 03089400
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML22D   SCOPE=SYSTEM        X03096200
                                                   SPECIFIED       @D1A 03103000
         LA    15,8                      SET MSGLIST REQUEST TYPE IN   X03109800
                                         REGISTER              @YA24471 03116600
         AGO   .DOML209                                            @D1A 03123400
.DOML22C LA    15,72                     SET MSGLIST, SCOPE=SYSTEMS    X03130200
                                         REQUEST TYPE IN           @D1AX03134700
                                         REGISTER              @YA24471 03139200
         AGO   .DOML209                                            @D1A 03143800
.DOML22D LA    15,136                    SET MSGLIST, SCOPE=SYSTEM     X03150600
                                         REQUEST TYPE IN               X03157400
                                         REGISTER              @YA24471 03164200
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 03171400
.DOML209 AIF   ('&MSGLIST'(1,1) EQ '(').DOML210                    @L1A 03221400
.*   OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT IS               03271400
.*   AN ADDR NAME.                                                 @L1A 03321400
         LA    1,&MSGLIST(1,1)           SET ADDRESS OF MESSAGE IDS IN X03371400
                                         REGISTER 1                @P3C 03421400
         AGO   .DOMLE                                              @L1A 03471400
.DOML210 AIF   ('&MSGLIST(1)' EQ '1').DOMLE IF THE ADDRESS OF THE      X03491400
                                         MESSAGE IDS WAS SPECIFIED     X03511400
                                         IN REGISTER 1, DO NOT RELOAD  X03531400
                                         REGISTER 1                @L1A 03551400
         LR    1,&MSGLIST(1,1)           SET ADDRESS OF MESSAGE IDS IN X03571400
                                         REGISTER 1                @L1A 03621400
         AGO   .DOMLE                                              @L1A 03671400
.*                                                                      04008000
.*                                                                      04009400
.*   GENERATE CODE FOR DOMCBLK KEYWORD                             @L1A 04012400
.*                                                                      04014700
.DOML23  AIF   ('&DOMCBLK(1)' EQ '^').DOML24                       @L1A 04017000
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML23A  SCOPE=SYSTEMS       X04019600
                                                   SPECIFIED       @D1A 04022200
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML23B   SCOPE=SYSTEM        X04024800
                                                   SPECIFIED       @D1A 04027400
         LA    15,2                      SET DOMCBLK REQUEST TYPE IN   X04030400
                                         REGISTER              @YA24471 04034800
         AGO   .DOML23C                                            @D1A 04039200
.DOML23A LA    15,66                     SET DOMCBLK, SCOPE=SYSTEMS    X04043600
                                         REQUEST TYPE IN               X04048000
                                         REGISTER              @YA24471 04052400
         AGO   .DOML23C                                            @D1A 04056800
.DOML23B LA    15,130                    SET DOMCBLK, SCOPE=SYSTEM     X04061200
                                         REQUEST TYPE IN               X04065600
                                         REGISTER              @YA24471 04070000
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 04074400
.DOML23C AIF   ('&DOMCBLK'(1,1) EQ '(').DOML230                    @D1C 04078800
.*  OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT                   04084000
.*  IS AN ADDR NAME.                                               @L1A 04097400
         LA    1,&DOMCBLK(1,1)           SET ADDRESS OF THE DOMCB IN   X04110800
                                         REGISTER 1                @L1A 04124200
         AGO   .DOMLE                                              @L1A 04174200
.DOML230 ANOP                                                      @L1A 04244800
         AIF   ('&DOMCBLK(1)' EQ '1').DOMLE IF THE ADDRESS OF THE DOMCBX04248100
                                         WAS SPECIFIED IN REGISTER 1   X04251400
                                         DO NOT RELOAD REGISTER 1  @L1A 04254700
         LR    1,&DOMCBLK(1,1)           SET ADDRESS OF THE DOMCB IN   X04258200
                                         REGISTER 1                @L1A 04259600
         AGO   .DOMLE                                              @L1A 04261000
.*                                                                      04262600
.*                                                                      04264000
.*   GENERATE CODE FOR TOKEN AND SYSID KEYWORD                     @L1A 04264700
.*                                                                      04265400
.DOML24  AIF   ('&TOKEN(1)' NE '^' AND '&SYSID(1)' NE '^').DOML26  @L1A 04281400
.*   CHECK TO SEE IF TOKEN SPECIFIED                               @L1A 04297400
         AIF   ('&TOKEN(1)' NE '^' AND '&SYSID(1)' EQ '^').DOML27  @L1A 04313400
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML26A  SCOPE=SYSTEMS       X04315400
                                                   SPECIFIED       @D1A 04317400
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML26B   SCOPE=SYSTEM        X04319400
                                                   SPECIFIED       @D1A 04321400
         LA    15,16                     SET SYSID REQUEST TYPE IN     X04323800
                                         REGISTER              @YA24471 04334200
         AGO   .DOML26C                                            @D1A 04337300
.DOML26A LA    15,80                     SET SYSID, SCOPE=SYSTEMS      X04340400
                                         REQUEST TYPE IN               X04342400
                                         REGISTER              @YA24471 04344400
         AGO   .DOML26C                                            @D1A 04346600
.DOML26B LA    15,144                    SET SYSID, SCOPE=SYSTEM       X04349700
                                         REQUEST TYPE IN               X04352800
                                         REGISTER              @YA24471 04355900
.DOML26C SR    1,1                       SET REGISTER 1 TO ZERO (SYSID X04359000
                                         SPECIFIED ALONE)          @D1C 04362100
         AGO   .DOMLE                                              @L1A 04365400
.DOML26  AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML26D  SCOPE=SYSTEMS       X04366700
                                                   SPECIFIED       @D1A 04368000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML26E  SCOPE=SYSTEM         X04369300
                                                   SPECIFIED       @D1A 04370600
         LA    15,48                     SET TOKEN, SYSID REQUEST      X04371900
                                         TYPE IN REGISTER      @YA24471 04373400
         AGO   .DOML27T                                            @L1A 04377400
.DOML26D LA    15,112                    SET TOKEN,SYSID, SCOPE=SYSTEMSX04380000
                                         REQUEST TYPE IN               X04382600
                                         REGISTER              @YA24471 04385200
         AGO   .DOML27T                                            @L1A 04387900
.DOML26E LA    15,176                    SET TOKEN,SYSID, SCOPE=SYSTEM X04388600
                                         REQUEST TYPE IN               X04389300
                                         REGISTER              @YA24471 04390000
         AGO   .DOML27T                                            @D1A 04390700
.DOML27  AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML27A  SCOPE=SYSTEMS       X04391400
                                                   SPECIFIED       @D1A 04394900
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML27B   SCOPE=SYSTEM        X04398400
                                                   SPECIFIED       @D1A 04401900
         LA    15,32                     SET TOKEN REQUEST TYPE IN     X04405400
                                         REGISTER              @YA24471 04409400
         AGO   .DOML27T                                            @D1A 04420800
.DOML27A LA    15,96                     SET TOKEN, SCOPE=SYSTEMS      X04432200
                                         REQUEST TYPE IN               X04439800
                                         REGISTER              @YA24471 04447400
         AGO   .DOML27T                                            @D1A 04455000
.DOML27B LA    15,160                    SET TOKEN, SCOPE=SYSTEM       X04466400
                                         REQUEST TYPE IN               X04474000
                                         REGISTER              @YA24471 04481600
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 04489400
.DOML27T AIF   ('&TOKEN'(1,1) EQ '(').DOML270                      @L1A 04505400
.*   OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT IS               04521400
.*   AN ADDR NAME.                                                 @L1A 04537400
         L     1,&TOKEN(1,1)             SET TOKEN IN REGISTER 1   @L1A 04553400
         AGO   .DOMLE                                              @L1A 04569400
.DOML270 ANOP                                                      @L1A 04585400
         AIF   ('&TOKEN(1)' EQ '1').DOMLE IF THE TOKEN WAS SPECIFIED   X04589400
                                         IN REGISTER 1, DO NOT RELOAD  X04593400
                                         REGISTER 1                @L1A 04597400
         LR    1,&TOKEN(1,1)             SET TOKEN IN REGISTER 1   @L1A 04601400
.DOMLE   ANOP                                                      @P5C 04612600
         AIF   ('&LINKAGE(1)' EQ 'BRANCH').DOMBALR                 @L2A 04623900
         OR    0,15                      SET REG0 INPUT VALUES @YA24471 04625500
         SVC   87                        ISSUE DOM SVC                  04633700
         MEXIT                                                     @01C 04635100
.DOMBALR ANOP                                                      @L2A 04636500
         LA    15,256(15)                SET LINKAGE=BRANCH BIT    @L2A 04637900
         OR    0,15                      SET REG0 INPUT VALUES @YA24471 04639300
         L     15,16(0,0)                ADDRESS OF CVT            @L2A 04640700
         L     15,200(0,15)              ADDRESS OF SCVT           @L2A 04642100
         L     15,24(0,15)               DOM BRANCH ENTRY POINT    @L2A 04643500
         BALR  14,15                     BRANCH TO B.E. DOM ENTRY POINT+04644900
                                                                   @L2A 04646300
         MEXIT                                                     @01C 04646500
.*                                                                 @01A 04646700
.*  THE FOLLOWING SECTION GENERATES 'OLD-FORMAT' CODE              @01A 04646900
.*  (THE ONLY KEYWORDS USED EXISTED BEFORE JBB2220)                @01A 04647100
.DOMLO   ANOP                                                      @01A 04647300
.*  EITHER MSG OR MSGLIST WAS SPECIFIED. CHECK IF IT WAS MSG.      @01A 04647500
         AIF   ('&MSG(1)' EQ '^').DOMO7                            @01A 04647700
.* CHECK IF REGISTER OR LABEL WAS SPECIFIED.                       @01A 04647900
         AIF   ('&MSG'(1,1) NE '(').DOMO01                         @01A 04648100
.* YES, REGISTER - CHECK IF REGISTER 1                             @01A 04648300
.DOMO0   AIF   ('&MSG(1)' NE '1').DOMO1                            @01A 04648500
.* YES, REGISTER IS 1. CHECK IF &NAME WAS SPECIFIED.               @01A 04648700
         AIF   (T'&NAME EQ 'O').DOMO2                              @01A 04648900
.* &NAME WAS SPECIFIED, PUT OUT A LABEL                            @01A 04649100
&NAME    DS    0H                                                       04649300
         AGO   .DOMO2                                              @01A 04649500
.* NO, REGISTER 1 NOT SPECIFIED. MOVE ADDRESS TO REGISTER 1.       @01A 04649700
.DOMO1   ANOP          REGISTER IS 2 - 12. MOVE IN TO REG 1        @01A 04649900
&NAME    LR    1,&MSG(1)      .MOVE MSG ID TO REGISTER 1                04650100
         AGO   .DOMO2                                              @01A 04650300
.* MSG WAS SPECIFIED AS A LABEL. LOAD ADDRESS IN REGISTER 1.       @01A 04650500
.DOMO01  ANOP                                                      @01A 04650700
.*  CHECK IF &NAME WAS SPECIFIED.                                  @01A 04650900
         AIF   (T'&NAME EQ 'O').DOMO02                             @01A 04651100
.* &NAME WAS SPECIFIED, PUT OUT A LABEL                            @01A 04651300
&NAME    L     1,&MSG(1)        .LOAD MSG ID INTO REGISTER 1            04651500
         AGO   .DOMO2                                              @01A 04651700
.DOMO02  ANOP   NO LABEL WAS SPECIFIED                             @01A 04651900
         L     1,&MSG(1)        .LOAD MSG ID INTO REGISTER 1            04652100
.DOMO2   ANOP                                                      @01A 04652300
         LA    0,&RPYINDC.(0,0) .LOAD MSG/REPLY INDICATOR               04652500
         SVC   87               .ISSUE DOM SVC                          04652700
         MEXIT                                                     @01A 04652900
.*  VALID KEYWORD WAS MSGLIST.                                     @01A 04653100
.DOMO7   ANOP                                                      @01A 04653300
&RPYINDC SETA  &RPYINDC+8   INCR. INDICATOR BY 8 FOR MSGLIST.      @01A 04653500
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @01A 04653700
         AIF   ('&MSGLIST'(1,1) EQ '(').DOMO8                      @01A 04653900
.*  OPERAND IS AN ADDR NAME.                                       @01A 04654100
&NAME    LA    1,&MSGLIST   .ADDRESS OF ID LIST IN REGISTER 1           04654300
         AGO   .DOMO11     LOOP AROUND FALSE PART OF LAST TEST     @01A 04654500
.*  OPERAND IS A REGISTER. CHECK IF IN RANGE 1 TO 12.              @01A 04654700
.DOMO8   AIF   ('&MSGLIST(1)' GE '1' AND '&MSGLIST(1)' LE '12').DOMO9   04654900
.*  NO, INVALID REGISTER SPECIFIED. ISSUE ERROR MESSAGE            @01A 04655100
         MNOTE 12,'*** REGISTER OPERAND REQUIRED-NOT SPECIFIED.'        04655300
         MEXIT                                                     @01A 04655500
.*   A VALID REGISTER WAS SPECIFIED. SEE IF IT IS REGISTER 1       @01A 04655700
.DOMO9   AIF   ('&MSGLIST(1)' NE '1').DOMO10                       @01A 04655900
.*   YES IT IS REGISTER 1. PUT OUT LABEL IF PRESENT                @01A 04656100
         AIF   (T'&NAME EQ 'O').DOMO11                             @01A 04656300
.*   LABEL IS PRESENT                                              @01A 04656500
&NAME    DS    0H                                                       04656700
         AGO   .DOMO11                                             @01A 04656900
.*   NO, NOT REGISTER 1. PUT OUT LR INSTRUCTION.                   @01A 04657100
.DOMO10  ANOP                                                      @01A 04657300
&NAME    LR    1,&MSGLIST(1)  .MOVE LIST ADDRESS TO REGISTER 1          04657500
.DOMO11  ANOP                 PUT OUT REST OF MSGLIST              @01A 04657700
.*  CHECK IF REPLY KEYWORD SPECIFIED                               @01A 04657900
         AIF   (&RPYINDC EQ 8).DOMO12                              @01A 04658100
.*  REPLY WAS SPECIFIED                                            @01A 04658300
         LA    0,&RPYINDC.(0,0) .LOAD MSGLIST/REPLY INDICATOR           04658500
         AGO   .DOMO13                                             @01A 04658700
.DOMO12  ANOP                                                      @01A 04658900
         LNR   0,1            .INDICATE MSGLIST ONLY                    04659100
.DOMO13  ANOP                                                      @01A 04659300
         SVC   87             .ISSUE DOM SVC                            04659500
         MEND                                                           04659700
**/                                                                     04660002
*DOM:  MACRO KEYS( MSG,      /* SINGLE MESSAGE ID                @L1C*/ 04710000
*                  MSGLIST,  /* A LIST OF UP TO 60 MESSAGE IDS   @L1C*/ 04760000
*                  TOKEN,    /* 4-BYTE TOKEN FOR MESSAGES TO BE         04810000
*                               DELETED                          @L1A*/ 04860000
*                  SYSID,    /* A SYSTEM ID FOR MESSAGES TO BE          04910000
*                               DELETED                          @L1A*/ 04960000
*                  COUNT,    /* THE COUNT OF 4 BYTE IDS          @L1A*/ 05010000
*                  DOMCBLK,  /* A DOM CONTROL BLOCK              @L1A*/ 05060000
*                  SCOPE,    /* COMMUNICATE THE DOM REQUEST TO OTHER    05076600
*                               SYSTEMS                          @D1A*/ 05093200
*                  LINKAGE,  /* HOW CONTROL IS PASSED TO DOM     @L2A*/ 05097400
*                  REPLY);   /* DELETE WTORS AS WELL AS WTOS         */ 05110000
*        ANS('?'||MACLABEL||'DOMP '||MACLIST||MACKEYS||';');            07150002
*%END;                                                                  07200002
