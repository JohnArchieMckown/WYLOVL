         MACRO                                                          00038100
&NAME    IHBRDWRA  &RPL=,&IHBRW=,&ACB=,&AREA=,&AREALEN=,&RECLEN=,      *00076200
               &AAREA=,&AAREALN=,&ARECLEN=,&ECB=,&EXIT=,&CODESEL=,     *00114300
               &OPTCD=,&ARG=,&NIB=,&BRANCH=,&OBSQVAL=,&SIGDATA=,       *00152400
               &RESPOND=,&CONTROL=,&CHNGDIR=,&SSENSEO=,&STYPE=,        *00190500
               &SEQNO=,&USENSEO=,&IBSQVAL=,&RTYPE=,&IBSQAC=,&SSENSMO=, *00228600
               &OBSQAC=,&POST=,&CHAIN=,&OPTION=,&SCANOPT=,&BRACKET=,   *00266700
               &CRYPT=,&THRDPTY=,&SONCODE=,&PSTIMER=,&MAXSESS=          00304800
.* /***** START OF SPECIFICATIONS ************************************/ 00342900
.* /*                                                                */ 00381000
.* /*  MACRO NAME: IHBRDWRA                                          */ 00419100
.* /*                                                                */ 00457200
.* /*  DESCRIPTIVE NAME: INNER INTERFACE MACRO FOR API REQUEST       */ 00495300
.* /*                    MACROS                                      */ 00533400
.* /*                                                                */ 00571500
.* /*  COPYRIGHT: LICENSED MATERIALS - PROPERTY OF IBM               */ 00609600
.* /*                                                                */ 00647700
.* /*             THIS PRODUCT CONTAINS "RESTRICTED MATERIALS OF IBM"*/ 00685800
.* /*                                                                */ 00723900
.* /*             5695-117 (C) COPYRIGHT IBM CORP. 1977, 1993.       */ 00762000
.* /*                                                                */ 00800100
.* /*             U.S. GOVERNMENT USERS RESTRICTED RIGHTS -          */ 00838200
.* /*             USE, DUPLICATION OR DISCLOSURE RESTRICTED BY       */ 00876300
.* /*             GSA ADP SCHEDULE CONTRACT WITH IBM CORP.           */ 00914400
.* /*                                                                */ 00952500
.* /*                                                                */ 00990600
.* /*                                                                */ 01028700
.* /*  FUNCTION: GENERATES IN-LINE CODE FOR THE FOLLOWING API        */ 01066800
.* /*            REQUEST MACROS THAT USE AN RPL:  CHANGE, CLSDST,    */ 01104900
.* /*            INQUIRE, INTRPRET, OPNDST, OPNSEC, RECEIVE,         */ 01143000
.* /*            REQSESS, RESETSR, SEND, SESSIONC, SETLOGON,         */ 01181100
.* /*            SIMLOGON, AND TERMSESS.  THE GENERATED              */ 01219200
.* /*            CODE LOADS THE RPL ADDRESS INTO REGISTER 1,         */ 01257300
.* /*            MODIFIES RPL FIELDS AS INDICATED BY THE RPL         */ 01295400
.* /*            MODIFIERS ON THE REQUEST MACRO, LOADS A             */ 01333500
.* /*            REQUEST CODE INTO REGISTER ZERO, AND BRANCHES       */ 01371600
.* /*            TO THE INTERFACE ROUTINE WHOSE ADDRESS IS IN        */ 01409700
.* /*            THE ACB LOCATED VIA THE RPL.  ANY CODE TO           */ 01447800
.* /*            MODIFY THE RPL IS BYPASSED IF THE RPL IS            */ 01485900
.* /*            ALREADY ACTIVE.                                     */ 01524000
.* /*                                                                */ 01562100
.* /*  NOTES: AS FOLLOW                                              */ 01600200
.* /*      1. RPL KEYWORDS LEVENT AND GEVENT ARE VALID               */ 01638300
.* /*             FOR OS/VS2 ONLY                                    */ 01676400
.* /*                                                                */ 01714500
.* /*  PROCESSOR: ASSEMBLER                                          */ 01752600
.* /*                                                                */ 01790700
.* /*  CREATED BY: MACRO DEVELOPMENT TEAM                            */ 01828800
.* /*                                                                */ 01866900
.* /*  INTERNAL MACROS: NONE                                         */ 01905000
.* /*                                                                */ 01943100
.* /*  EXTERNAL REFERENCES: NONE                                     */ 01981200
.* /*                                                                */ 02019300
.* /*  CHANGE ACTIVITY:                                              */ 02057400
.* /*  CHANGE 01 - 01/19/77 - ADDED QUEUED RESPONSE SUPPORT  @D34EKMP*/ 02095500
.* /*  CHANGE 02 - 02/16/77 - ADDED CONTROL SBI/BIS SUPPORT  @D34EKMP*/ 02133600
.* /*  CHANGE 03 - 04/27/77 - CORRECTED CONTROL SDT SUPPORT  @PI10125*/ 02171700
.* /*  CHANGE 04 - 05/25/77 - CORRECTED RPL SIGDATA SUPPORT  @VS45960*/ 02209800
.* /*  CHANGE 05 - 10/26/77 - CORRECTED INQ SESSKEY SUPPORT  @XM30862*/ 02247900
.* /*  CHANGE 06 - 06/15/77 - ADDED ENCR KEYWORD SUPPORT     @ZM35828*/ 02286000
.* /*  CHANGE 07 - 08/09/77 - CHANGE ENCR TO CRYPT           @D440518*/ 02324100
.* /*  CHANGE 08 - 01/20/78 - FIXED SETTING OF CRYPT BIT     @XM31389*/ 02362200
.* /*  CHANGE 09 - 05/09/80 - SYSROUTE OF OX26398            @ZA46611*/ 02400300
.* /*  CHANGE 10 - 12/23/80 - SUPPORT OF DCR4747.00          @D5B4747*/ 02438400
.* /*  CHANGE 11 - 12/08/80 - SUPPORT OF DCR4747.02          @D5B4747*/ 02476500
.* /*  CHANGE 12 - 01/20/81 - SUPPORT OF PTM8628             @P5Z8628*/ 02514600
.* /*  CHANGE 13 - 01/22/81 - SUPPORT OF PTM8733             @P5B8733*/ 02552700
.* /*  CHANGE 14 - 01/29/81 - SUPPORT OF DCR4790             @D5P4790*/ 02590800
.* /*  CHANGE 15 - 02/27/81 - SUPPORT OF PTM8805             @P5Z8805*/ 02628900
.* /*  CHANGE 16 - 03/06/81 - SUPPORT OF PTM8891             @P5P8891*/ 02667000
.* /*  CHANGE 17 - 12/03/82 - PTM P011983 (APAR OZ67334)     @P011983*/ 02705100
.* /*  CHANGE 18 - 03/01/83 - XRF SUPPORT                    @R489301*/ 02743200
.* /*  CHANGE 19 - 09/09/83 - XRF SUPPORT                    @R489306*/ 02781300
.* /*  CHANGE 20 - 11/30/83 - DCR 4911.00                    @R491100*/ 02819400
.* /*  CHANGE 21 - 01/09/84 - DCR 4911.01                    @R491101*/ 02857500
.* /*  CHANGE 22 - 02/13/84 - PTM P014769                    @P014769*/ 02895600
.* /*  CHANGE 23 - 03/27/84 - PTM P015113                    @P015113*/ 02933700
.* /*  CHANGE 24 - 06/11/84 - DCR 4893.20                    @R489320*/ 02971800
.* /*  CHANGE 25 - 11/01/85 - DCR5048 QALL,QSESSLIM,QNOTENAB @R504800*/ 03009900
.* /*  CHANGE 26 - 07/14/87 - APAR OY06517 - OPTSCAN NOT CHECKING FOR*/ 03048000
.* /*                         NULL PARAMETERS PASSED         @OY06517*/ 03086100
.* /*                                                                */ 03124200
.* /* $MAC(IHBRDWRA),COMP(API),PROD(VTAM): Inner interface macro for */ 03162300
.* /*                                      API requests              */ 03200400
.* /*                                                                */ 03238500
.* /* FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS          */ 03276600
.* /* ---- -------- ------- ------ ------  ------------------------- */ 03314700
.* /* $F1= FM8@@CLD HVT3303 890116 109772: RCR0006 MTS API Support   */ 03352800
.* /* $BB= ACC@@AMS HVT3401 891106 615520: PL/AS CONVERSION          */ 03390900
.* /* $B1= AP@@@CLD HVT3401 890418 496698: Persistent LU-LU Sessions */ 03429000
.* /* $V1= P078866  HVT3401 900622 496698: OPTCD4 not contiguous w/5 */ 03467100
.* /* $KF= JN@@@CLD NQNAME1 910521 591683: Enhanced NQN Support      */ 03505200
.* /* $01= OY36649  HVT3431 911014 349122: QUEUED SESSION TERMINATION*/ 03543300
.* /* $02= OY55765  VM341   920723 787924: Declare &PLOPT4 to correct*/ 03581400
.* /*                                      ASSEMBLER XF error        */ 03619500
.* /* $T1= P100451  HATAPPN 920728 879315: PSTIMER setting problems  */ 03657600
.* /* $T2= P104866  HATAPPN 921002 879315: Restrict OPT4 setting     */ 03695700
.* /* $T3= P103312  HATAPPN 921008 879315: OPTCD=NQN policing        */ 03733800
.* /* $KG= P105521  HATAPPN 921103 460208: CHNGDIR=NREQ/REQ REMOVAL  */ 03771900
.* /* $T4= P105823  HATAPPN 921113 879315: CORRECTIONS TO P105521    */ 03810000
.* /* $I1= FG@@@MST GENRES  921113 879315: Generic Resource          */ 03848100
.* /* $03= OY62380  SNAIP   930330 358168: Allow CHNGDIR=NREQ to be  */ 03886200
.* /*                                      specified though it is    */ 03924300
.* /*                                      ignored (still issued by  */ 03962400
.* /*                                      CICS)                     */ 04000500
.* /* $U2= P109955  GENRES  930812 879315: Check new OPTCDs by macro */ 04038600
.* /* $U3= P110087  GENRES  930818 879315: Downward compatibility    */ 04076700
.* /* $U4= P109285  KEEPFRR 931104 879315: Implement FZKDR001, allow */ 04114800
.* /*                                      OPTCD=KEEPSRB/NKEEPSRB    */ 04152900
.* /* $04= OY67066  EMERALD 940202 358168: Add support for INQUIRE   */ 04191000
.* /*                                      OPTCD=STATUS (AE fix for  */ 04229100
.* /*                                      OY63087)                  */ 04267200
.* /* $D1= IT@@@MST TSOGR   941102 062811: Add OPTCD=GNAMESUB & add  */ 04279900
.* /*                                      PARMS=MAXSESS for SETLOGON*/ 04292600
.* /* $W1= P117054  VMVSCS  941202 879315: Conditional CS mode       */ 04305300
.* /*                                                                */ 04343400
.* /***** END OF SPECIFICATIONS **************************************/ 04381500
.*                                                                      04419600
.* A-000000-999999                                           @XL03HMV   04457700
.*                                                                      04495800
* IHBRDWRA - ACF/VTAM                                                   04533900
*                                                            @D34EKMP   04572000
* 5695-114 COPYRIGHT IBM CORP 1977,1993                                 04610100
* LICENSED MATERIAL - PROGRAM PROPERTY OF IBM                @D34EKMP   04648200
* REFER TO COPYRIGHT INSTRUCTIONS FORM NUMBER G120-2083      @D34EKMP   04686300
*                                                            @D34EKMP   04724400
         GBLB  &IHBRPLY(20)                                             04762500
         GBLC  &IHBTBL(20)                                              04800600
         GBLA  &IHBNUM                                                  04838700
         LCLA  &PLARG,&PLNIB,&PLAREA,&PLRLEN,&PLBUFL,&PLACTIV,&PLEXTDS  04876800
         LCLA  &PLOPTC1,&PLDACB,&PLECB,&PLAAREA,&PLAARLN,&PLARCLN       04914900
         LCLA  &ACBRTN,&SYN,&ASY,&POPTCD2,&POPTCD3,&OPTERR,&PLSSMO      04953000
         LCLA  &NUM,&LEN,&CNTINQ,&MSK1CTR,&MSK2CTR,&MSK3CTR,&MSK4CTR    04991100
         LCLA  &CNTSTL,&PLUSFLD                                    @B1A 05029200
         LCLA  &PLOPT4                                             @02A 05067300
.* *************** VTL ADDITIONS ****************                       05105400
         LCLA  &NM,&NUM2,&PLRH3,&PLSRTYP,&PLVTFL2,&PLCHN,&PLCNTRL       05143500
         LCLA  &PLCNTDF,&PLCNTSC,&PLOBSQV,&PLIBSQV,&PLOBSQ,&PLIBSQ      05181600
         LCLA  &PLSEQNO,&PLSSNSO,&PLUSNSO,&PLCNTDC,&PLSSEO,&PLSIGDA     05219700
         LCLA  &SCODE                                          @R491100 05257800
.* ************ END VTL ADDITIONS ***************                       05295900
         LCLB  &CA,&CS,&PASS,&RELEASE,&NERASE,&EAU,&ERASE,&NOTIFY       05334000
         LCLB  &SPEC,&ANY,&LBT,&LBM,&BLK,&COND,&UNCOND             @W1C 05372100
         LCLB  &LOCK,&ACCEPT,&ACQUIRE,&QUIESCE,&START,&STOP             05410200
         LCLB  &CONALL,&CONANY,&Q,&NQ,&LGONMSG,&DEVCHAR,&TERMS,&APPSTAT 05448300
         LCLB  &COUNTS,&RNNAME,&CIDXLAT,&TOPLGON,&BSCID,&DISPLAY        05486400
         LCLB  &RELRQ,&NRELRQ                                           05511800
         LCLB  &UNCONDL,&ACTIVE,&SESSION,&PEND      (RETIRED BITS) @D1C 05537200
         LCLB  &BIT0,&BIT01,&SPARM,&SPARM1,&SKEY                        05562600
         LCLB  &NBUFLST,&BUFFLST,&CONTCHN,&NCNTCHN             @D5B4747 05600700
         LCLB  &NLMPEO,&LMPEO,&USERRH,&NUSERRH                 @D5B4747 05638800
         LCLB  &BACKUP,&USERVAR,&FORCED                        @R489320 05676900
         LCLB  &NBACKUP                                        @R489301 05715000
         LCLB  &SONCD,&NSONCD,&UNBIND,&SENSE,&NSENSE,&HOLD     @R491100 05753100
         LCLB  &RSPQUE,&NRSPQU                                 @R491101 05791200
         LCLB  &MTS,&NMTS                                          @F1A 05829300
         LCLB  &TERMQ                                              @01A 05867400
         LCLB  &STATUS                                             @04A 05905500
         LCLB  &MXSES                                              @D1A 05924500
.* *************** VTL ADDITIONS ****************                       05943600
         LCLB  &KEEP,&TRUNC,&NIBTK                                      05981700
         LCLB  &FMHDR,&NFMHDR                                           06019800
         LCLB  &KEEP1,&TRUNC1,&NIBTK1,&FMHDR1                           06057900
         LCLC  &OPT1,&OPT,&CHAR1,&CHAR2,&CHAR3,&CHAR4                   06096000
         LCLC  &OPT4X                                              @I1A 06134100
.* ************ END VTL ADDITIONS ***************                       06172200
  LCLB  &CS1,&PASS1,&NERASE1,&EAU1,&ERASE1,&NOTIFY1                     06210300
  LCLB  &ANY1,&LBT1,&LBM1,&BLK1,&COND1,&UNCOND1                    @W1C 06248400
  LCLB  &LOCK1,&ACCEPT1,&ACQUIR1,&QUIESC1,&START1,&STOP1                06286500
  LCLB  &CONALL1,&CONANY1,&NQ1,&LGONMS1,&DEVCHR1,&TERMS1,&APSTAT1       06324600
  LCLB  &COUNTS1,&RNNAME1,&CIDXLT1,&TOPLGN1,&BSCID1,&DISPLY1            06362700
  LCLB  &NRELRQ1,&SKEY1                                        @XM30862 06388100
  LCLB  &UNCNDL1,&ACTIVE1,&PEND1                    (RETIRED BITS) @D1C 06413500
  LCLB  &BUFLST1,&CNTCHN1,&LMPEO1,&USERRH1                     @D5B4747 06438900
  LCLB  &BACKUP1,&USRVAR1,&FORCED1                             @R489320 06477000
  LCLB  &SONCD1,&NSONCD1,&UNBIND1,&SENSE1,&NSENSE1,&HOLD1      @R491100 06515100
  LCLB  &RSPQUE1,&NRSPQU1                                      @R491101 06553200
  LCLB  &MTS1                                                      @F1A 06591300
  LCLB  &TERMQ1                                                    @01A 06629400
  LCLB  &QSESS,&QALL,&QNOTE                                    @R504800 06667500
  LCLB  &QSESS1,&QNOTE1,&QALL1                                 @R504800 06705600
  LCLB  &PERSIQ,&PERST,&NPERST,&RESTOR,&PSTIME,&NQN           @B1A @KFC 06743700
  LCLB  &GNADD,&GNDEL,&GNSUB,&SESNM,&ENDAF                    @I1A @D1C 06781800
  LCLB  &KPSRB,&NKPSRB,&KPSRB1,&NKPSRB1                            @U4A 06819900
  LCLB  &CONDCS,&CONDCS1                                           @W1A 06858000
  LCLB  &CSSPEC,&CONDCSS                                           @W1A 06896100
  LCLB  &STATUS1                                                   @04A 06934200
  LCLB  &MXSES1                                                    @D1A 06953200
.* ********** DISPLACEMENT OF RPL FIELDS **********                     06972300
&PLARG   SETA  36    * THIS IS AN OS VTAM DISPLACEMENT *                07010400
&SCODE   SETA  31    * DISPLACEMENT INTO RPL TO SONCODE *               07048500
&PLAREA  SETA  32    * THIS IS AN OS VTAM DISPLACEMENT *                07086600
&PLRLEN  SETA  48    * THIS IS AN OS VTAM DISPLACEMENT *                07124700
&PLBUFL  SETA  52 * JAN 12, 73 CODE ADDED AS A RESULT OF PTM____ *      07162800
&PLACTIV SETA  69     * THIS IS AN OS VTAM DISPLACEMENT *               07200900
&PLEXTDS SETA  68     * THIS IS AN OS VTAM DISPLACEMENT *               07239000
&PLOPTC1 SETA  40     * THIS IS AN OS VTAM DISPLACEMENT *               07277100
&POPTCD2 SETA  56     * THIS IS AN OS VTAM DISPLACEMENT *               07315200
&POPTCD3 SETA  96     * THIS IS AN OS VTAM DISPLACEMENT *               07353300
&PLDACB  SETA  24     * THIS IS AN OS VTAM DISPLACEMENT *               07391400
&PLECB   SETA  08     * THIS IS AN OS VTAM DISPLACEMENT *               07429500
&PLAAREA SETA  76     * THIS IS AN OS VTAM DISPLACEMENT *               07467600
&PLAARLN SETA  80     * THIS IS AN OS VTAM DISPLACEMENT *               07505700
&PLARCLN SETA  84     * THIS IS AN OS VTAM DISPLACEMENT *               07543800
&PLUSFLD SETA  92     * THIS IS AN OS VTAM DISPLACEMENT *          @B1A 07581900
&PLOPT4  SETA  43     * THIS IS AN OS VTAM DISPLACEMENT *          @B1A 07620000
.* *************** VTL ADDITIONS ****************                       07658100
&PLRH3    SETA  16                       THIRD RH BYTE                  07696200
&PLSRTYP  SETA  17                       SEND OR RECEIVE TYPE FIELD     07734300
&PLVTFL2  SETA  20                       VTAM FLAGS FIELD               07772400
&PLCHN    SETA  18                       POSITION IN RU CHAIN FIELD     07810500
&PLCNTRL  SETA  21                       RU CONTROL CODE FIELD          07848600
&PLCNTDF  SETA  21                       DATA FLOW CONTROL CODES FIELD  07886700
&PLCNTDC  SETA  22                       DATA FLOW CONTROL CODES FIELD  07924800
&PLCNTSC  SETA  23                       SESSION CONTROL CODES FIELD    07962900
&PLOBSQV  SETA  60                       STSN OUTBOUND SEQ. NO. FIELD   08001000
&PLIBSQV  SETA  62                       STSN INBOUND SEQ. NO. FIELD    08039100
&PLOBSQ   SETA  64                       STSN OUTBOUND ACTION CODES     08077200
&PLIBSQ   SETA  65                       STSN INBOUND ACTION CODES      08115300
&PLSEQNO  SETA  66                       SEQUENCE NUMBER FIELD          08153400
&PLSSNSO  SETA  100                      SYSTEM SENSE OUTPUT FIELD      08191500
&PLSSEO   SETA  100                      SYSTEM SENSE ERROR CODES       08229600
&PLSSMO   SETA  101                      SYSTEM SENSE ERROR CODES       08267700
&PLUSNSO  SETA  102                      USER SENSE OUTPUT FIELD        08305800
&PLSIGDA  SETA  108                      SIGNAL DATA 4-BYTES  @VS45960  08343900
.* ************ END VTL ADDITIONS ***************                       08382000
&ASY     SETA  00                                                       08420100
&SYN     SETA  00                                                       08458200
&BIT0    SETB  0                                                        08496300
&CNTINQ  SETA  0                                                        08534400
&CNTSTL  SETA  0                                                   @B1A 08572500
&MSK1CTR SETA  0                                                        08610600
&MSK2CTR SETA  0                                                        08648700
&MSK3CTR SETA  0                                                        08686800
&MSK4CTR SETA  0                                                        08724900
&OPTERR  SETA  0                                                        08763000
&CA      SETB  0                                                        08801100
&CS      SETB  0                                                        08839200
&PASS    SETB  0                                                        08877300
&RELEASE SETB  0                                                        08915400
&NERASE  SETB  0                                                        08953500
&EAU     SETB  0                                                        08991600
&ERASE   SETB  0                                                        09029700
&SPEC    SETB  0                                                        09067800
&ANY     SETB  0                                                        09105900
&BLK     SETB  0                                                        09144000
&LBM     SETB  0                                                        09182100
&LBT     SETB  0                                                        09220200
&COND    SETB  0                                                        09258300
&UNCOND  SETB  0                                                        09296400
&LOCK    SETB  0                                                        09334500
&ACCEPT  SETB  0                                                        09372600
&ACQUIRE SETB  0                                                        09410700
&CONALL  SETB  0                                                        09448800
&CONANY  SETB  0                                                        09486900
&QUIESCE SETB  0                                                        09525000
&START   SETB  0                                                        09563100
&STOP    SETB  0                                                        09601200
&LGONMSG SETB  0                                                        09639300
&DEVCHAR SETB  0                                                        09677400
&TERMS   SETB  0                                                        09715500
&APPSTAT SETB  0                                                        09753600
&COUNTS  SETB  0                                                        09791700
&RNNAME  SETB  0                                                        09829800
&CIDXLAT SETB  0                                                        09867900
&TOPLGON SETB  0                                                        09906000
&BSCID   SETB  0                                                        09944100
&DISPLAY SETB  0                                                        09982200
&SPARM   SETB  0                                                        10020300
&SKEY    SETB  0                                                        10058400
&Q       SETB  0                                                        10096500
&NQ      SETB  0                                                        10134600
&RELRQ   SETB  0                                                        10172700
&NRELRQ  SETB  0                                                        10210800
&PEND    SETB  0                                                        10248900
&SESSION SETB  0                                                        10287000
&ACTIVE  SETB  0                                                        10325100
&UNCONDL SETB  0                                                        10363200
&NOTIFY  SETB  0                                                        10401300
&NBUFLST SETB  0                                               @D5B4747 10439400
&BUFFLST SETB  0                                               @D5B4747 10477500
&CONTCHN SETB  0                                               @D5B4747 10515600
&NCNTCHN SETB  0                                               @D5B4747 10553700
&NLMPEO  SETB  0                                               @D5B4747 10591800
&LMPEO   SETB  0                                               @D5B4747 10629900
&USERRH  SETB  0                                               @D5B4747 10668000
&NUSERRH SETB  0                                               @D5B4747 10706100
&NBACKUP SETB  0                                               @R489301 10744200
&BACKUP  SETB  0                                               @R489301 10782300
&USERVAR SETB  0                                               @R489301 10820400
&FORCED  SETB  0                                               @R489301 10858500
&SONCD   SETB  0                                               @R491100 10896600
&NSONCD  SETB  0                                               @R491100 10934700
&UNBIND  SETB  0                                               @R491100 10972800
&SENSE   SETB  0                                               @R491100 11010900
&NSENSE  SETB  0                                               @R491100 11049000
&HOLD    SETB  0                                               @R491100 11087100
&RSPQUE  SETB  0                                               @R491101 11125200
&NRSPQU  SETB  0                                               @R491101 11163300
&QSESS   SETB  0                                               @R504800 11201400
&QNOTE   SETB  0                                               @R504800 11239500
&QALL    SETB  0                                               @R504800 11277600
&MTS     SETB  0                                                   @F1A 11315700
&NMTS    SETB  0                                                   @F1A 11353800
&TERMQ   SETB  0                                                   @01A 11391900
&PERSIQ  SETB  0                                                   @B1A 11430000
&PERST   SETB  0                                                   @B1A 11468100
&NPERST  SETB  0                                                   @B1A 11506200
&RESTOR  SETB  0                                                   @B1A 11544300
&PSTIME  SETB  0                                                   @B1A 11582400
&CONDCS  SETB  0                                                   @W1A 11620500
&CSSPEC  SETB  0                                                   @W1A 11658600
&CONDCSS SETB  0                                                   @W1A 11696700
&NQN     SETB  0                                                   @KFA 11734800
&GNADD   SETB  0                                                   @I1A 11772900
&GNDEL   SETB  0                                                   @I1A 11811000
&GNSUB   SETB  0                                                   @D1A 11830000
&SESNM   SETB  0                                                   @I1A 11849100
&ENDAF   SETB  0                                                   @I1A 11887200
&KPSRB   SETB  0                                                   @U4A 11925300
&NKPSRB  SETB  0                                                   @U4A 11963400
&STATUS  SETB  0                                                   @04A 12001500
&MXSES   SETB  0                                                   @D1A 12020500
.* *************** VTL ADDITIONS ****************                       12039600
&KEEP    SETB  0                                                        12077700
&TRUNC   SETB  0                                                        12115800
&NIBTK   SETB  0                                                        12153900
&FMHDR   SETB  0                                                        12192000
&NFMHDR  SETB  0                                                        12230100
&KEEP1      SETB  1                                                     12268200
&TRUNC1     SETB  1                                                     12306300
&NIBTK1     SETB  1                                                     12344400
&FMHDR1     SETB  1                                                     12382500
.* ************ END VTL ADDITIONS ***************                       12420600
&BIT01      SETB  1                                                     12458700
&CS1        SETB  1                                                     12496800
&PASS1      SETB  1                                                     12534900
&NERASE1    SETB  1                                                     12573000
&EAU1       SETB  1                                                     12611100
&ERASE1     SETB  1                                                     12649200
&ANY1       SETB  1                                                     12687300
&LBT1       SETB  1                                                     12725400
&LBM1       SETB  1                                                     12763500
&BLK1       SETB  1                                                     12801600
&COND1      SETB  1                                                     12839700
&UNCOND1    SETB  1                                                     12877800
&LOCK1      SETB  1                                                     12915900
&ACCEPT1    SETB  1                                                     12954000
&ACQUIR1    SETB  1                                                     12992100
&CONALL1    SETB  1                                                     13030200
&CONANY1    SETB  1                                                     13068300
&QUIESC1    SETB  1                                                     13106400
&START1     SETB  1                                                     13144500
&STOP1      SETB  1                                                     13182600
&LGONMS1    SETB  1                                                     13220700
&DEVCHR1    SETB  1                                                     13258800
&TERMS1     SETB  1                                                     13296900
&APSTAT1    SETB  1                                                     13335000
&COUNTS1    SETB  1                                                     13373100
&RNNAME1    SETB  1                                                     13411200
&CIDXLT1    SETB  1                                                     13449300
&TOPLGN1    SETB  1                                                     13487400
&BSCID1     SETB  1                                                     13525500
&DISPLY1    SETB  1                                                     13563600
&SPARM1     SETB  1                                                     13601700
&SKEY1      SETB  1                                          @XM30862   13639800
&NQ1        SETB  1                                                     13677900
&NRELRQ1    SETB  1                                                     13716000
&PEND1      SETB  1                                                     13754100
&ACTIVE1    SETB  1                                                     13830300
&UNCNDL1    SETB  1                                                     13868400
&NOTIFY1    SETB  1                                                     13906500
&BUFLST1    SETB  1                                            @D5B4747 13944600
&CNTCHN1    SETB  1                                            @D5B4747 13982700
&LMPEO1     SETB  1                                            @D5B4747 14020800
&USERRH1    SETB  1                                            @D5B4747 14058900
&BACKUP1    SETB  1                                            @R489301 14097000
&USRVAR1    SETB  1                                            @R489301 14135100
&FORCED1    SETB  1                                            @R489301 14173200
&SONCD1     SETB  1                                            @R491100 14211300
&NSONCD1    SETB  1                                            @R491100 14249400
&UNBIND1    SETB  1                                            @R491100 14287500
&SENSE1     SETB  1                                            @R491100 14325600
&NSENSE1    SETB  1                                            @R491100 14363700
&HOLD1      SETB  1                                            @R491100 14401800
&RSPQUE1    SETB  1                                            @R491101 14439900
&NRSPQU1    SETB  1                                            @R491101 14478000
&QSESS1     SETB  1                                            @R504800 14516100
&QNOTE1     SETB  1                                            @R504800 14554200
&QALL1      SETB  1                                            @R504800 14592300
&MTS1       SETB  1                                                @F1A 14630400
&TERMQ1     SETB  1                                                @01A 14668500
&KPSRB1     SETB  1                                                @U4A 14706600
&NKPSRB1    SETB  1                                                @U4A 14744700
&STATUS1    SETB  1                                                @04A 14782800
&CONDCS1    SETB  1                                                @W1A 14820900
&MXSES1     SETB  1                                                @D1A 14839900
&ACBRTN  SETA  8   DISPLACEMENT IN ACB OF THE ADDR OF THE INTERFACE RTN 14859000
&OPT4X   SETC 'X''00'''             INITIALIZE OPT4X VALUE         @I1A 14897100
         AIF   ('&SCANOPT' NE '').OPTSCAN  RECURSIVE CALL TO OPTSCAN?   14935200
         AIF   ('&RPL' EQ '').NORPL  THIS IS AN ERROR CONDITION         14973300
.* ******************************************************************** 15011400
.*                        GETRPL SUBROUTINE                             15049500
.* GENERATES CODE TO LOAD THE ADDRESS OF THE RPL INTO REGISTER 1        15087600
.* ******************************************************************** 15125700
.GETRPL  ANOP                                                           15163800
         AIF   ('&RPL'(1,1) NE '(').GEN1  THIS BR FOR NON REG FORM      15201900
         AIF   ('&RPL' EQ '(1)').ENDRPL   NO LR INSTRUCTION NECESSARY   15240000
&NAME    LR    1,&RPL(1)             PUT ADDRESS OF RPL IN REGISTER 1   15278100
         CNOP  0,4                                                      15316200
         AGO   .ENDRPL1                                                 15354300
.GEN1    ANOP                                                           15392400
         CNOP  0,4                                                      15430500
&NAME    LA    1,&RPL                PUT ADDRESS OF RPL IN REGISTER 1   15468600
         AGO   .ENDRPL1                                                 15506700
.ENDRPL  ANOP                                                           15544800
         CNOP  0,4                                                      15582900
         AIF   ('&NAME' EQ '').ENDRPL1                                  15621000
&NAME    EQU   *                                                        15659100
.ENDRPL1 ANOP                                                           15697200
         AIF   ('&ACB' NE '' OR '&AREA' NE '' OR '&AREALEN' NE '').GEN  15735300
         AIF   ('&ECB' NE '' OR '&AAREA' NE '' OR '&RECLEN' NE '').GEN  15773400
         AIF   ('&ARG' NE '' OR '&OPTCD' NE '' OR '&AAREALN' NE '').GEN 15811500
         AIF   ('&NIB' NE '' OR '&EXIT' NE '' OR '&CRYPT' NE '').GEN    15849600
.*                                                           @D440518   15887700
         AIF   ('&ARECLEN' NE '' OR '&BRANCH' NE '').GEN                15925800
         AIF   ('&SIGDATA' NE '' OR '&AREALEN' NE '').GEN               15963900
.* *************** VTL ADDITIONS ****************                       16002000
         AIF   ('&RESPOND' NE '' OR '&CONTROL' NE '').GEN               16040100
         AIF   ('&CHNGDIR' NE '' OR '&SSENSEO' NE '').GEN               16078200
         AIF   ('&STYPE' NE '' OR '&RTYPE' NE '' ).GEN                  16116300
         AIF   ('&IBSQAC' NE '' OR '&OBSQAC' NE '').GEN                 16154400
         AIF   ('&POST' NE '' OR '&CHAIN' NE '').GEN                    16192500
         AIF   ('&SEQNO' NE '' OR '&USENSEO' NE '').GEN                 16230600
         AIF   ('&IBSQVAL' NE '' OR '&OBSQVAL' NE '').GEN               16268700
         AIF   ('&SSENSMO' NE '' OR '&BRACKET' NE '').GEN               16306800
         AIF   ('&THRDPTY' NE '' OR '&SONCODE' NE '').GEN               16344900
.* ************ END VTL ADDITIONS ***************                       16383000
         AIF   ('&PSTIMER' NE '').GEN                              @B1A 16421100
         AGO   .GENREQ                                                  16459200
.* ******************************************************************** 16497300
.*                     MDFYRPL SUBROUTINE                               16535400
.* GENERATES CODE TO MODIFY RPL FIELDS AT EXECUTION TIME.  INVOKES THE  16573500
.* FOLLOWING SUBROUTINES: MDFYOPT, GENMSK, MDFYRECD, AND THROUGH MDFY-  16611600
.* RECD, MDFYRESP, MDFYCHN, MDFYCTRL, MDFYCDIR, MDFYSSNS, MDFYRTYP,     16649700
.*                MDFYIBSQ, MDFYOBSQ, AND OPTSCAN.                      16687800
.* ******************************************************************** 16725900
.GEN     ANOP                                                           16764000
         TM    &PLACTIV.(1),X'FF'     IS THE RPL ACTIVE?                16802100
         BO    IHB&SYSNDX            YES BR AROUND MODIFY CODE          16840200
.CKACB   ANOP                                                           16878300
         AIF   ('&ACB' EQ '').CKAREA IS THERE AN ACB PARAMETER?         16916400
         AIF   ('&ACB'(1,1) NE '(').GEN2  REGISTER NOTATION?            16954500
         ST    &ACB(1),&PLDACB.(1)   PUT ACB ADDRESS IN THE RPL         16992600
         AGO   .CKAREA                                                  17030700
.GEN2    ANOP                                                           17068800
         LA    15,&ACB               GET ADDRESS OF NEW ACB             17106900
         ST 15,&PLDACB.(1)           AND PUT IT IN THE RPL              17145000
.CKAREA  ANOP                                                           17183100
         AIF   ('&AREA' EQ '').CKALEN  IS THERE AN AREA PARAMETER?      17221200
         AIF   ('&AREA'(1,1) NE '(').GEN3  REGISTER NOTATION?           17259300
         ST    &AREA(1),&PLAREA.(1)  PUT ADDRESS OF AREA IN THE RPL     17297400
         AGO   .CKALEN                                                  17335500
.GEN3    ANOP                                                           17373600
         LA    15,&AREA              GET ADDRESS OF NEW AREA            17411700
         ST    15,&PLAREA.(1)         AND PUT IT IN THE RPL             17449800
.CKALEN  ANOP                                                           17487900
         AIF   ('&AREALEN' EQ '').CKRLEN  IS THERE AN AREA LENGTH PARM? 17526000
         AIF   ('&AREALEN'(1,1) NE '(').GEN4  REGISTER NOTATION?        17564100
         ST    &AREALEN(1),&PLBUFL.(1)     PUT AREA LENGTH IN THE RPL   17602200
         AGO   .CKRLEN                                                  17640300
.GEN4    ANOP                                                           17678400
         B     *+8                                                      17716500
         DC    A(&AREALEN)                                              17754600
         L     15,*-4                GET NEW AREA LENGTH                17792700
         ST    15,&PLBUFL.(1)        AND PUT IT IN THE RPL              17830800
.CKRLEN  ANOP                                                           17868900
         AIF   ('&RECLEN' EQ '').CKAAR  IS THERE A RECORD LENGTH PARM?  17907000
         AIF   ('&RECLEN'(1,1) NE '(').GEN5  REGISTER NOTATION?         17945100
         ST    &RECLEN(1),&PLRLEN.(1)  PUT NEW RECORD LENGTH IN THE RPL 17983200
         AGO   .CKAAR                                                   18021300
.GEN5    ANOP                                                           18059400
         B     *+8                                                      18097500
         DC    A(&RECLEN)                                               18135600
         L     15,*-4                GET NEW RECORD LENGTH              18173700
         ST    15,&PLRLEN.(1)        AND PUT IT IN THE RPL              18211800
.CKAAR   ANOP                                                           18249900
         AIF   ('&AAREA' EQ '').CKAALN  IS THERE AN AAREA PARM?         18288000
         AIF   ('&AAREA'(1,1) NE '(').GEN6  REGISTER NOTATION?          18326100
         ST    &AAREA(1),&PLAAREA.(1)  PUT AAREA ADDRESS IN THE RPL     18364200
         AGO   .CKAALN                                                  18402300
.GEN6    ANOP                                                           18440400
         LA    15,&AAREA             GET ADDRESS OF AAREA               18478500
         ST    15,&PLAAREA.(1)       AND PUT IT IN THE RPL              18516600
.CKAALN  ANOP                                                           18554700
         AIF   ('&AAREALN' EQ '').CKARLN  IS THERE AN AAREALN PARM?     18592800
         AIF   ('&AAREALN'(1,1) NE '(').GEN7  REGISTER NOTATION?        18630900
         ST    &AAREALN(1),&PLAARLN.(1)   PUT AAREA LENGTH IN THE RPL   18669000
         AGO   .CKARLN                                                  18707100
.GEN7    ANOP                                                           18745200
         B     *+8                                                      18783300
         DC    A(&AAREALN)                                              18821400
         L     15,*-4                GET NEW AAREA LENGTH               18859500
         ST    15,&PLAARLN.(1)       AND PUT IT IN THE RPL              18897600
.CKARLN  ANOP                                                           18935700
         AIF   ('&ARECLEN' EQ '').CKARG  IS THERE AN ARECORD LNG PARM?  18973800
         AIF   ('&ARECLEN'(1,1) NE '(').GEN8  REGISTER NOTATION?        19011900
         ST    &ARECLEN(1),&PLARCLN.(1)  PUT ARECORD LENGTH IN THE RPL  19050000
         AGO   .CKARG                                                   19088100
.GEN8    ANOP                                                           19126200
         B     *+8                                                      19164300
         DC    A(&ARECLEN)                                              19202400
         L     15,*-4                GET NEW ARECORD LENGTH             19240500
         ST    15,&PLARCLN.(1)       AND PUT IT IN THE RPL              19278600
.CKARG   ANOP                                                           19316700
         AIF   ('&ARG' NE '' AND '&NIB' NE '').CKARGER  IS THERE AN ARG 19354800
         AIF   ('&ARG' EQ '').CKNIB  IS THERE AN ARG PARAMETER?         19392900
         AIF   ('&ARG'(1,1) NE '(').GEN9  REGISTER NOTATION?            19431000
         ST    &ARG(1),&PLARG.(1)    PUT NEW ARGUMENT IN THE RPL        19469100
         NI    &PLEXTDS.(1),X'FB'     SET NIB POINTER OFF               19507200
         AGO   .CKECB                                                   19545300
.CKNIB   ANOP                                                           19583400
         AIF   ('&NIB' EQ '').CKECB  IS THERE AN NIB PARAMETER?         19621500
         AIF   ('&NIB'(1,1) NE '(').CKNIB1  REGISTER NOTATION?          19659600
         ST    &NIB(1),&PLARG.(1)    PUT NIB POINTER IN THE RPL         19697700
         OI    &PLEXTDS.(1),X'04'     SET NIB POINTER ON                19735800
         AGO   .CKECB                                                   19773900
.CKNIB1  ANOP                                                           19812000
         LA    15,&NIB               GET NEW NIB POINTER                19850100
         ST    15,&PLARG.(1)         AND PUT IT IN THE RPL              19888200
         OI    &PLEXTDS.(1),X'04'     SET NIB POINTER ON                19926300
         AGO   .CKECB                                                   19964400
.CKARGER ANOP                                                           20002500
  MNOTE 4,'PARAMETERS ARG AND NIB CONFLICT - BOTH DISREGARDED' @P011983 20040600
         AGO   .CKECB                                                   20078700
.GEN9    ANOP                                                           20116800
  MNOTE 4,'PARAMETER ARG DOES NOT REFLECT REGISTER NOTATION - IGNORED'  20154900
.*                                                             @P011983 20193000
.CKECB   ANOP                                                           20231100
         AIF   ('&ECB' NE '' AND '&EXIT' NE '').GEN10  BOTH SPECIFIED?  20269200
         AIF   ('&ECB' NE '').ECBGEN  NO - IF ECB= WAS SPECIFIED, BR    20307300
         AIF   ('&EXIT' EQ '').CKTHRDP  EXIT= SPECIFIED?  NO - BRANCH   20345400
         AIF   ('&EXIT'(1,1) EQ '(').GEN10A  YES - REGISTER NOTATION?   20383500
         LA    15,&EXIT              GET ADDRESS OF EXIT ROUTINE        20421600
         ST    15,&PLECB.(1)         AND PUT IT IN THE RPL              20459700
         AGO   .FLGSETA                                                 20497800
.GEN10A  ANOP                                                           20535900
         ST    &EXIT(1),&PLECB.(1)  PUT EXIT ROUTINE ADDRESS IN THE RPL 20574000
.FLGSETA ANOP                                                           20612100
         NI    &PLOPTC1.(1),X'FE'        SET ECB FLAG OFF               20650200
         NI    &PLEXTDS.(1),X'BF'      SET NOEXIT BIT OFF               20688300
         OI    &PLEXTDS.(1),X'20'      SET EXIT BIT ON                  20726400
         AGO   .CKTHRDP                                                 20764500
.ECBGEN  ANOP                                                           20802600
         AIF   ('&ECB' EQ 'INTERNAL').FLGSETC    INTERNAL ECB SPECIFIED 20840700
         AIF   ('&ECB'(1,1) EQ '(').GEN10B  REGISTER NOTATION? YES - BR 20878800
         LA    15,&ECB               GET ADDRESS OF ECB                 20916900
         ST    15,&PLECB.(1)         AND PUT IT IN THE RPL              20955000
         AGO   .FLGSETB                                                 20993100
.GEN10B  ANOP                                                           21031200
         ST    &ECB(1),&PLECB.(1)    PUT NEW ECB ADDRESS IN THE RPL     21069300
.FLGSETB ANOP                                                           21107400
         OI    &PLOPTC1.(1),X'01'        SET ECB FLAG ON                21145500
         OI    &PLEXTDS.(1),X'40'      SET NOEXIT BIT ON                21183600
         NI    &PLEXTDS.(1),X'DF'      SET EXIT BIT OFF                 21221700
         AGO   .CKTHRDP                                                 21259800
.GEN10   ANOP                                                           21297900
        MNOTE 4,'ECB AND EXIT MUTUALLY EXCLUSIVE; INTERNAL ECB ASSUMED' 21336000
.FLGSETC ANOP                                                           21374100
         NI    &PLOPTC1.(1),X'FE'        SET ECB FLAG OFF               21412200
         OI    &PLEXTDS.(1),X'40'      SET NOEXIT BIT ON                21450300
         NI    &PLEXTDS.(1),X'DF'      SET EXIT BIT OFF                 21488400
.* ******************************************************************** 21526500
.* CHECK FOR THRDPTY=NOTIFY|NONOTIFY                                    21564600
.* ******************************************************************** 21602700
.CKTHRDP ANOP                                                  @G70AKMC 21640800
         AIF   ('&THRDPTY' EQ '').THRDPND                      @G70AKMC 21678900
         AIF   ('&THRDPTY' EQ 'NOTIFY').THRDP1                 @G70AKMC 21717000
         AIF   ('&THRDPTY' EQ 'NONOTIFY').THRDP2               @G70AKMC 21755100
         MNOTE 4,'THRDPTY=&THRDPTY IS NOT A VALID PARAMETER - IGNORED'  21793200
.*                                                             @P011983 21831300
         AGO   .THRDPND                                        @G70AKMC 21869400
.THRDP1  ANOP                                                  @G70AKMC 21907500
         AIF   ('&OPTCD' NE '').THRDP1A                        @G70AKMC 21945600
         OI    &POPTCD2.(1),X'40'      SET THRDPTY BIT ON      @G70AKMC 21983700
         AGO   .THRDPND                                        @G70AKMC 22021800
.THRDP1A ANOP                                                  @G70AKMC 22059900
&NOTIFY  SETB  1                                               @G70AKMC 22098000
&NOTIFY1 SETB  0                                               @G70AKMC 22136100
&MSK1CTR SETA  &MSK1CTR+1                                      @G70AKMC 22174200
&MSK2CTR SETA  &MSK2CTR+1                                      @G70AKMC 22212300
         AGO   .THRDPND                                        @G70AKMC 22250400
.THRDP2  ANOP                                                  @G70AKMC 22288500
         AIF   ('&OPTCD' NE '').THRDPND                        @G70AKMC 22326600
         NI    &POPTCD2.(1),X'DF'      SET THRDPTY BIT OFF     @G70AKMC 22364700
.THRDPND ANOP                                                  @G70AKMC 22402800
.* ******************************************************************** 22440900
.* CHECK FOR SONCODE=CODE                                               22479000
.* ******************************************************************** 22517100
         AIF   ('&SONCODE' EQ '').SONEND                       @R491100 22555200
         MVI   &SCODE.(1),&SONCODE     SET RPL SONCODE         @R491100 22593300
.SONEND  ANOP                                                  @R491100 22631400
.* ******************************************************************** 22669500
.* CHECK FOR PSTIMER=VALUE WITHOUT OPTCD                                22707600
.* (IF ANY OPTCD IS SPECIFIED, PSTIMER IS CHECKED AGAINST OPTCDS LATER) 22745700
.* ******************************************************************** 22783800
         AIF   (('&OPTCD' NE '') OR ('&PSTIMER' EQ '')).PSTMND     @T1A 22821900
         MNOTE 4,'PARMS=PSTIMER CAN ONLY BE SPECIFIED WITH OPTCD=PERSIS*22860000
               T - PSTIMER IGNORED'                                @T1A 22898100
.PSTMND  ANOP                                                      @T1A 22936200
.* ******************************************************************** 22974300
.* CHECK FOR MAXSESS=VALUE WITHOUT OPTCD                                22978100
.* (IF ANY OPTCD IS SPECIFIED, MAXSESS IS CHECKED AGAINST OPTCDS LATER) 22981900
.*                                                                 @D1A 22985700
.* ******************************************************************** 22989500
         AIF   (('&OPTCD' NE '') OR ('&MAXSESS' EQ '')).MXSSEND    @D1A 22993300
         MNOTE 4,'PARMS=MAXSESS CAN ONLY BE SPECIFIED WITH OPTCD=GNAMEA*22997100
               DD - MAXSESS IGNORED'                               @D1A 23000900
.MXSSEND ANOP                                                      @D1A 23004700
.* ******************************************************************** 23008500
.*                       MDFYOPT SUBROUTINE                             23012400
.* VALIDITY CHECKS OPTCD OPTIONS AND SETS SWITCHES IN A MASK.  INVOKES  23050500
.* GENMASK TO GENERATE CODE IF REQUIRED.  ISSUES MNOTES FOR INVALID     23088600
.*                   OPTIONS THAT ARE SPECIFIED.                        23126700
.* ******************************************************************** 23164800
.CKOPTCD ANOP                                                           23202900
         AIF   ('&OPTCD' EQ '').CKSEQNO                                 23241000
&NUM     SETA N'&OPTCD                                                  23279100
.SETOPT   ANOP                                                          23317200
&LEN     SETA K'&OPTCD(&NUM)                                            23355300
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'N').NOPTS                        23393400
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'C').COPTS                        23431500
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'E').EOPTS                        23469600
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'A').AOPTS                        23507700
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'B').BOPTS               @R489301 23545800
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'U').UOPTS               @R489301 23583900
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'F').FOPTS               @R489301 23622000
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'H').HOPTS               @R491100 23660100
         AIF  ('&OPTCD(&NUM)'(1,1) NE 'S').XOPTS                        23698200
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'SPEC').SOPTS1                  23736300
&SPEC    SETB 1                                                         23774400
&ANY1    SETB 0                                                         23812500
&MSK2CTR SETA  &MSK2CTR+1                                               23850600
         AGO  .GETNEXT                                                  23888700
.SOPTS1  ANOP                                                           23926800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SYN').SOPTS2                  23964900
&SYN     SETA 1                                                         24003000
         AGO  .GETNEXT                                                  24041100
.SOPTS2  ANOP                                                           24079200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSION').SOPTS3              24117300
&SESSION SETB 1                                                         24155400
&PEND1   SETB 0                                                         24193500
&ACTIVE1 SETB 0                                                         24269700
&UNCNDL1 SETB 0                                                         24307800
&MSK1CTR SETA  &MSK1CTR+1                                               24345900
&MSK2CTR SETA  &MSK2CTR+1                                               24384000
         AGO  .GETNEXT                                                  24422100
.SOPTS3  ANOP                                                           24460200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'START').SOPTS4                24498300
&START   SETB 1                                                         24536400
&CNTSTL  SETA &CNTSTL+1                                            @B1A 24574500
         AGO  .GETNEXT                                                  24612600
.SOPTS4  ANOP                                                           24650700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'STOP').SOPTS5                 24688800
&STOP    SETB 1                                                         24726900
&CNTSTL  SETA &CNTSTL+1                                            @B1A 24765000
         AGO  .GETNEXT                                                  24803100
.SOPTS5  ANOP                                                           24841200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSPARM').SOPTS6             24879300
&SPARM   SETB 1                                                         24917400
&CNTINQ  SETA &CNTINQ+1                                                 24955500
         AGO  .GETNEXT                                                  24993600
.SOPTS6  ANOP                                                           25031700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSKEY').SOPTS7              25069800
&SKEY    SETB 1                                                         25107900
&CNTINQ  SETA &CNTINQ+1                                      @XM30862   25146000
         AGO  .GETNEXT                                                  25184100
.SOPTS7  ANOP                                                @R491100   25222200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SONCODE').SOPTS8   @R491100   25260300
&SONCD   SETB 1                                              @R491100   25298400
&SONCD1  SETB 0                                              @R491100   25336500
&NSONCD1 SETB 0                                              @R491100   25374600
&MSK3CTR SETA  &MSK3CTR+1                                    @R491100   25412700
&MSK4CTR SETA  &MSK4CTR+1                                    @R491100   25450800
         AGO  .GETNEXT                                       @R491100   25488900
.SOPTS8  ANOP                                                @R491100   25527000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SENSE').SOPTS9     @R491100   25565100
&SENSE   SETB 1                                              @R491100   25603200
&SENSE1  SETB 0                                              @R491100   25641300
&NSENSE1 SETB 0                                              @R491100   25679400
&MSK3CTR SETA  &MSK3CTR+1                                    @R491100   25717500
&MSK4CTR SETA  &MSK4CTR+1                                    @R491100   25755600
         AGO  .GETNEXT                                       @R491100   25793700
.SOPTS9  ANOP                                                @R491100   25831800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSNAME').SOPTS9A       @I1A 25869900
&SESNM   SETB 1                                                    @I1A 25908000
&OPT4X   SETC 'X''21'''             RPLIQSNM VALUE                 @U3C 25946100
&CNTINQ  SETA &CNTINQ+1                                            @I1A 25984200
         AGO  .GETNEXT                                             @I1A 26022300
.SOPTS9A ANOP                                                      @I1A 26060400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'STATUS').SOPTS10         @04A 26098500
&STATUS  SETB 1                                                    @04A 26136600
&CNTINQ  SETA &CNTINQ+1                                            @04A 26174700
         AGO  .GETNEXT                                             @04A 26212800
.SOPTS10 ANOP                                                      @04A 26250900
         AGO  .INVLDOP                                                  26289000
.XOPTS   ANOP                                                           26327100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNCONDL').XOPTS1A             26365200
&UNCONDL SETB 1                                                         26403300
&PEND1   SETB 0                                                         26441400
&ACTIVE1 SETB 0                                                         26517600
&UNCNDL1 SETB 0                                                         26555700
&MSK1CTR SETA  &MSK1CTR+1                                               26593800
&MSK2CTR SETA  &MSK2CTR+1                                               26631900
         AGO  .GETNEXT                                                  26670000
.XOPTS1A ANOP                                                           26708100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNCOND').XOPTS1B     @D5B4747 26746200
&UNCOND  SETB 1                                                         26784300
&UNCOND1 SETB 0                                                         26822400
&COND1   SETB 0                                                         26860500
&LOCK1   SETB 0                                                         26898600
&UNBIND1 SETB 0                                                @R491100 26936700
&TERMQ1  SETB 0                                                    @01A 26974800
&MSK1CTR SETA  &MSK1CTR+1                                               27012900
&MSK2CTR SETA  &MSK2CTR+1                                               27051000
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 27089100
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 27127200
         AGO  .GETNEXT                                                  27165300
.XOPTS1B ANOP                                                  @D5B4747 27203400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'USERRH').XOPTS1      @D5B4747 27241500
&USERRH  SETB 1                                                @D5B4747 27279600
&USERRH1 SETB 0                                                @D5B4747 27317700
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 27355800
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 27393900
         AGO  .GETNEXT                                         @D5B4747 27432000
.XOPTS1  ANOP                                                           27470100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PEND').XOPTS2                 27508200
&PEND    SETB 1                                                         27546300
&PEND1   SETB 0                                                         27584400
&ACTIVE1 SETB 0                                                         27660600
&UNCNDL1 SETB 0                                                         27698700
&MSK1CTR SETA  &MSK1CTR+1                                               27736800
&MSK2CTR SETA  &MSK2CTR+1                                               27774900
         AGO  .GETNEXT                                                  27813000
.XOPTS2  ANOP                                                           27851100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PASS').XOPTS3                 27889200
&PASS    SETB 1                                                         27927300
&PASS1   SETB 0                                                         27965400
&TERMQ1  SETB 0                                                    @01A 28003500
&MSK1CTR SETA  &MSK1CTR+1                                               28041600
&MSK2CTR SETA  &MSK2CTR+1                                               28079700
&MSK4CTR SETA  &MSK4CTR+1                                          @01A 28117800
         AGO  .GETNEXT                                                  28155900
.XOPTS3  ANOP                                                           28194000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LOCK').XOPTS4                 28232100
&LOCK    SETB 1                                                         28270200
&LOCK1   SETB 0                                                         28308300
&COND1   SETB 0                                                         28346400
&UNCOND1 SETB 0                                                         28384500
&UNBIND1 SETB 0                                                @R491100 28422600
&TERMQ1  SETB 0                                                    @01A 28460700
&MSK1CTR SETA  &MSK1CTR+1                                               28498800
&MSK2CTR SETA  &MSK2CTR+1                                               28536900
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 28575000
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 28613100
         AGO  .GETNEXT                                                  28651200
.XOPTS4  ANOP                                                           28689300
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QUIESCE').XOPTS5              28727400
&QUIESCE SETB 1                                                         28765500
&CNTSTL  SETA &CNTSTL+1                                            @B1A 28803600
         AGO  .GETNEXT                                                  28841700
.XOPTS5  ANOP                                                           28879800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'Q').XOPTS6A          @R504800 28917900
&Q       SETB 1                                                         28956000
&NQ1     SETB 0                                                         28994100
&MSK1CTR SETA  &MSK1CTR+1                                               29032200
&MSK2CTR SETA  &MSK2CTR+1                                               29070300
         AGO  .GETNEXT                                                  29108400
.XOPTS6A ANOP                                                  @R504800 29146500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QALL').XOPTS6B       @R504800 29184600
&QALL    SETB 1                                                @R504800 29222700
&QSESS1  SETB 0                                                @R504800 29260800
&QNOTE1  SETB 0                                                @R504800 29298900
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800 29337000
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800 29375100
         AGO  .GETNEXT                                         @R504800 29413200
.XOPTS6B ANOP                                                  @R504800 29451300
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QSESSLIM').XOPTS6C   @R504800 29489400
&QSESS   SETB 1                                                @R504800 29527500
&QALL1   SETB 0                                                @R504800 29565600
&QNOTE1  SETB 0                                                @R504800 29603700
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800 29641800
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800 29679900
         AGO  .GETNEXT                                         @R504800 29718000
.XOPTS6C ANOP                                                  @R504800 29756100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QNOTENAB').XOPTS6D   @R504800 29794200
&QNOTE   SETB 1                                                @R504800 29832300
&QALL1   SETB 0                                                @R504800 29870400
&QSESS1  SETB 0                                                @R504800 29908500
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800 29946600
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800 29984700
         AGO  .GETNEXT                                         @R504800 30022800
.XOPTS6D ANOP                                                  @R504800 30060900
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RELRQ').XOPTS7                30099000
&RELRQ  SETB 1                                                          30137100
&NRELRQ1 SETB 0                                                         30175200
&MSK1CTR SETA  &MSK1CTR+1                                               30213300
&MSK2CTR SETA  &MSK2CTR+1                                               30251400
         AGO  .GETNEXT                                                  30289500
.XOPTS7  ANOP                                                           30327600
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'RELEASE').XOPTS8               30365700
&RELEASE   SETB 1                                                       30403800
&MSK2CTR SETA  &MSK2CTR+1                                               30441900
&PASS1   SETB 0                                                         30480000
&TERMQ1  SETB 0                                                    @01A 30518100
&MSK4CTR SETA  &MSK4CTR+1                                          @01A 30556200
         AGO  .GETNEXT                                                  30594300
.XOPTS8  ANOP                                                           30632400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BLK').XOPTS9                  30670500
&BLK     SETB 1                                                         30708600
&BLK1    SETB 0                                                         30746700
&LBT1    SETB 0                                                         30784800
&LBM1    SETB 0                                                         30822900
&MSK1CTR SETA  &MSK1CTR+1                                               30861000
&MSK2CTR SETA  &MSK2CTR+1                                               30899100
         AGO  .GETNEXT                                                  30937200
.XOPTS9  ANOP                                                           30975300
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LBM').COPTSA                  31013400
&LBM     SETB 1                                                         31051500
&LBM1    SETB 0                                                         31089600
&LBT1    SETB 0                                                         31127700
&BLK1    SETB 0                                                         31165800
&MSK1CTR SETA  &MSK1CTR+1                                               31203900
&MSK2CTR SETA  &MSK2CTR+1                                               31242000
         AGO  .GETNEXT                                                  31280100
.COPTSA  ANOP                                                           31318200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LBT').XOPTSB                  31356300
&LBT     SETB 1                                                         31394400
&LBT1    SETB 0                                                         31432500
&LBM1    SETB 0                                                         31470600
&BLK1    SETB 0                                                         31508700
&MSK1CTR SETA  &MSK1CTR+1                                               31546800
&MSK2CTR SETA  &MSK2CTR+1                                               31584900
         AGO  .GETNEXT                                                  31623000
.XOPTSB  ANOP                                                           31661100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LOGONMSG').XOPTSD             31699200
&LGONMSG SETB 1                                                         31737300
&CNTINQ  SETA &CNTINQ+1                                                 31775400
         AGO  .GETNEXT                                                  31813500
.XOPTSD  ANOP                                                           31851600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'DEVCHAR').XOPTSE              31889700
&DEVCHAR SETB 1                                                         31927800
&CNTINQ  SETA &CNTINQ+1                                                 31965900
         AGO  .GETNEXT                                                  32004000
.XOPTSE  ANOP                                                           32042100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TERMS').XOPTSF                32080200
&TERMS   SETB 1                                                         32118300
&CNTINQ  SETA &CNTINQ+1                                                 32156400
         AGO  .GETNEXT                                                  32194500
.XOPTSF  ANOP                                                           32232600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RNNAME').XOPTSG               32270700
&RNNAME  SETB 1                                                         32308800
&CNTINQ  SETA &CNTINQ+1                                                 32346900
         AGO  .GETNEXT                                                  32385000
.XOPTSG  ANOP                                                           32423100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TOPLOGON').XOPTSH             32461200
&TOPLGON SETB 1                                                         32499300
&CNTINQ  SETA &CNTINQ+1                                                 32537400
         AGO  .GETNEXT                                                  32575500
.XOPTSH  ANOP                                                           32613600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BSCID').XOPTSI                32651700
&BSCID   SETB 1                                                         32689800
&CNTINQ  SETA &CNTINQ+1                                                 32727900
         AGO  .GETNEXT                                                  32766000
.XOPTSI  ANOP                                                           32804100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'DISPLAY').XOPTSJ              32842200
&DISPLAY SETB 1                                                         32880300
&CNTINQ  SETA &CNTINQ+1                                                 32918400
         AGO  .GETNEXT                                                  32956500
.XOPTSJ  ANOP                                                           32994600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BUFFLST').XOPTSJ1    @D5B4747 33032700
&BUFFLST SETB 1                                                @D5B4747 33070800
&BUFLST1 SETB 0                                                @D5B4747 33108900
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 33147000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 33185100
         AGO  .GETNEXT                                         @D5B4747 33223200
.XOPTSJ1 ANOP                                                  @D5B4747 33261300
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LMPEO').XOPTSJ3      @D5B4747 33299400
&LMPEO   SETB 1                                                @D5B4747 33337500
&LMPEO1  SETB 0                                                @D5B4747 33375600
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 33413700
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 33451800
         AGO  .GETNEXT                                         @D5B4747 33489900
.XOPTSJ3 ANOP                                                  @D5B4747 33528000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'KEEPSRB').XOPTSK         @U4A 33566100
&KPSRB   SETB 1                                                    @U4A 33604200
&KPSRB1  SETB 0                                                    @U4A 33642300
&NKPSRB1 SETB 0                                                    @U4A 33680400
&MSK3CTR SETA  &MSK3CTR+1                                          @U4A 33718500
&MSK4CTR SETA  &MSK4CTR+1                                          @U4A 33756600
         AGO  .GETNEXT                                             @U4A 33794700
.XOPTSK  ANOP                                                      @U4A 33832800
.* *************** VTL ADDITIONS ****************                       33870900
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'KEEP').XOPTSL                 33909000
&KEEP    SETB 1                                                         33947100
&KEEP1   SETB 0                                                         33985200
&TRUNC1  SETB 0                                                         34023300
&NIBTK1  SETB 0                                                         34061400
&MSK3CTR SETA  &MSK3CTR+1                                               34099500
&MSK4CTR SETA  &MSK4CTR+1                                               34137600
         AGO  .GETNEXT                                                  34175700
.XOPTSL  ANOP                                                           34213800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TRUNC').XOPTSM                34251900
&TRUNC   SETB 1                                                         34290000
&TRUNC1  SETB 0                                                         34328100
&NIBTK1  SETB 0                                                         34366200
&KEEP1   SETB 0                                                         34404300
&MSK3CTR SETA  &MSK3CTR+1                                               34442400
&MSK4CTR SETA  &MSK4CTR+1                                               34480500
         AGO  .GETNEXT                                                  34518600
.XOPTSM  ANOP                                                           34556700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'FMHDR').XOPTSN                34594800
&FMHDR   SETB 1                                                         34632900
&FMHDR1  SETB 0                                                         34671000
&NFMHDR  SETB 0                                                         34709100
&MSK3CTR SETA  &MSK3CTR+1                                               34747200
&MSK4CTR SETA  &MSK4CTR+1                                               34785300
         AGO  .GETNEXT                                                  34823400
.XOPTSN  ANOP                                                           34861500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RSPQUED').XOPTSO     @R491101 34899600
&RSPQUE  SETB 1                                                @R491101 34937700
&NRSPQU1 SETB 0                                                @R491101 34975800
&RSPQUE1 SETB 0                                                @R491101 35013900
&MSK3CTR SETA  &MSK3CTR+1                                      @R491101 35052000
&MSK4CTR SETA  &MSK4CTR+1                                      @R491101 35090100
         AGO  .GETNEXT                                         @R491101 35128200
.XOPTSO  ANOP                                                  @R491101 35166300
.* ************ END VTL ADDITIONS ***************                       35204400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'MTS').XOPTSP             @F1A 35242500
&MTS     SETB 1                                                    @F1A 35280600
&MSK3CTR SETA  &MSK3CTR+1                                          @F1A 35318700
         AGO  .GETNEXT                                             @F1A 35356800
.XOPTSP  ANOP                                                      @F1A 35394900
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PERSIST').XOPTSQ         @B1A 35433000
&PERST   SETB 1                                                    @B1A 35471100
&OPT4X   SETC 'X''80'''             RPLPERS  VALUE                 @U3C 35509200
&CNTSTL  SETA &CNTSTL+1                                            @B1A 35547300
         AGO  .GETNEXT                                             @B1A 35585400
.XOPTSQ  ANOP                                                      @B1A 35623500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PERSESS').XOPTSR         @B1A 35661600
&PERSIQ  SETB 1                                                    @B1A 35699700
&OPT4X   SETC 'X''20'''             RPLINQPS VALUE                 @U3C 35737800
&CNTINQ  SETA &CNTINQ+1                                            @B1A 35775900
         AGO  .GETNEXT                                             @B1A 35814000
.XOPTSR  ANOP                                                      @B1A 35852100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RESTORE').XOPTSS         @B1A 35890200
&OPT4X   SETC 'X''10'''             RPLOPRES VALUE                 @U3C 35928300
&RESTOR  SETB 1                                                    @B1A 35966400
&ACCEPT1 SETB 0                                                    @B1A 36004500
&ACQUIR1 SETB 0                                                    @B1A 36042600
&MSK1CTR SETA  &MSK1CTR+1                                          @B1A 36080700
&MSK2CTR SETA  &MSK2CTR+1                                          @B1A 36118800
         AGO  .GETNEXT                                             @B1A 36156900
.XOPTSS  ANOP                                                      @B1A 36195000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TERMQ').XOPTST           @01A 36233100
&TERMQ   SETB 1                                                    @01A 36271200
&TERMQ1  SETB 0                                                    @01A 36309300
&LOCK1   SETB 0                                                    @01A 36347400
&COND1   SETB 0                                                    @01A 36385500
&UNCOND1 SETB 0                                                    @01A 36423600
&UNBIND1 SETB 0                                                    @01A 36461700
&PASS1   SETB 0                                                    @01A 36499800
&MSK2CTR SETA  &MSK2CTR+1                                          @01A 36537900
&MSK3CTR SETA  &MSK3CTR+1                                          @01A 36576000
&MSK4CTR SETA  &MSK4CTR+1                                          @01A 36614100
         AGO  .GETNEXT                                             @01A 36652200
.XOPTST  ANOP                                                      @01A 36690300
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'GNAMEADD').XOPTSU        @I1A 36728400
&GNADD   SETB 1                                                    @I1A 36766500
&OPT4X   SETC 'X''01'''             RPLSTGNA VALUE                 @U3C 36804600
&CNTSTL  SETA &CNTSTL+1                                            @I1A 36842700
         AGO  .GETNEXT                                             @I1A 36880800
.XOPTSU  ANOP                                                      @I1A 36918900
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'GNAMEDEL').XOPTSTS  @I1A @D1C 36957000
&GNDEL   SETB 1                                                    @I1A 36995100
&OPT4X   SETC 'X''03'''             RPLSTGND VALUE                 @U3C 37033200
&CNTSTL  SETA &CNTSTL+1                                            @I1A 37071300
         AGO  .GETNEXT                                             @I1A 37109400
.XOPTSTS ANOP                                                      @D1A 37114800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'GNAMESUB').XOPTSV        @D1A 37120200
&GNSUB   SETB 1                                                    @D1A 37125600
&OPT4X   SETC 'X''05'''             RPLSTGNS VALUE                 @D1A 37131000
&CNTSTL  SETA &CNTSTL+1                                            @D1A 37136400
         AGO  .GETNEXT                                             @D1A 37141800
.XOPTSV  ANOP                                                      @I1A 37147500
.*                                                                      37185600
.INVLDOP ANOP                                                           37223700
     MNOTE 4,'OPTCD=&OPTCD(&NUM) IS NOT A VALID PARAMETER - IGNORED '   37261800
.*                                                             @P011983 37299900
         AGO .GETNEXT                                                   37338000
.NOPTS   ANOP                                                           37376100
.* *************** VTL ADDITIONS ****************                       37414200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NIBTK').NOPTS2                37452300
&NIBTK   SETB 1                                                         37490400
&NIBTK1  SETB 0                                                         37528500
&KEEP1   SETB 0                                                         37566600
&TRUNC1  SETB 0                                                         37604700
&MSK3CTR SETA  &MSK3CTR+1                                               37642800
&MSK4CTR SETA  &MSK4CTR+1                                               37680900
         AGO  .GETNEXT                                                  37719000
.NOPTS2  ANOP                                                           37757100
.* ************ END VTL ADDITIONS ***************                       37795200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NERASE').NOPTS3               37833300
&NERASE  SETB 1                                                         37871400
&NERASE1 SETB 0                                                         37909500
&EAU1    SETB 0                                                         37947600
&ERASE1  SETB 0                                                         37985700
&MSK1CTR SETA  &MSK1CTR+1                                               38023800
&MSK2CTR SETA  &MSK2CTR+1                                               38061900
         AGO  .GETNEXT                                                  38100000
.NOPTS3  ANOP                                                           38138100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NCONV').NOPTS41      @D5B4747 38176200
.* *** NCONV NO LONGER SUPPORTED, IGNORED ***                      @W1C 38214300
         AGO  .GETNEXT                                                  38252400
.NOPTS41 ANOP                                                  @D5B4747 38290500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NBUFFLST').NOPTS43   @D5B4747 38328600
&NBUFLST SETB 1                                                @D5B4747 38366700
&BUFLST1 SETB 0                                                @D5B4747 38404800
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 38442900
         AGO  .GETNEXT                                         @D5B4747 38481000
.NOPTS43 ANOP                                                  @D5B4747 38519100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NKEEPSRB').NOPTS44       @U4A 38557200
&NKPSRB  SETB 1                                                    @U4A 38595300
&NKPSRB1 SETB 0                                                    @U4A 38633400
&KPSRB1  SETB 0                                                    @U4A 38671500
&MSK3CTR SETA  &MSK3CTR+1                                          @U4A 38709600
&MSK4CTR SETA  &MSK4CTR+1                                          @U4A 38747700
         AGO  .GETNEXT                                             @U4A 38785800
.NOPTS44 ANOP                                                      @U4A 38823900
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NCONTCHN').NOPTS45   @D5B4747 38862000
&NCNTCHN SETB 1                                                @D5B4747 38900100
&CNTCHN1 SETB 0                                                @D5B4747 38938200
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 38976300
         AGO  .GETNEXT                                         @D5B4747 39014400
.NOPTS45 ANOP                                                  @D5B4747 39052500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NLMPEO').NOPTS46     @D5B4747 39090600
&NLMPEO  SETB 1                                                @D5B4747 39128700
&LMPEO1  SETB 0                                                @D5B4747 39166800
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 39204900
         AGO  .GETNEXT                                         @D5B4747 39243000
.NOPTS46 ANOP                                                  @P5B8733 39281100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NUSERRH').NOPTS47    @D5B4747 39319200
&NUSERRH SETB 1                                                @D5B4747 39357300
&USERRH1 SETB 0                                                @D5B4747 39395400
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 39433500
         AGO  .GETNEXT                                         @D5B4747 39471600
.NOPTS47 ANOP                                                  @D5B4747 39509700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NBACKUP').NOPTS48    @R489301 39547800
&NBACKUP SETB 1                                                @R489301 39585900
&BACKUP1 SETB 0                                                @R489301 39624000
&MSK1CTR SETA  &MSK1CTR+1                                      @P015113 39662100
&MSK2CTR SETA  &MSK2CTR+1                                      @P015113 39700200
         AGO  .GETNEXT                                         @R489301 39738300
.NOPTS48 ANOP                                                  @R489301 39776400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NSONCODE').NOPTS49   @R491100 39814500
&NSONCD  SETB 1                                                @R491100 39852600
&NSONCD1 SETB 0                                                @R491100 39890700
&SONCD1  SETB 0                                                @R491100 39928800
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 39966900
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 40005000
         AGO  .GETNEXT                                         @R491100 40043100
.NOPTS49 ANOP                                                  @R491100 40081200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NSENSE').NOPTS50     @R491100 40119300
&NSENSE  SETB 1                                                @R491100 40157400
&NSENSE1 SETB 0                                                @R491100 40195500
&SENSE1  SETB 0                                                @R491100 40233600
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 40271700
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 40309800
         AGO  .GETNEXT                                         @R491100 40347900
.NOPTS50 ANOP                                                  @R491100 40386000
.* *************** VTL ADDITIONS ****************                       40424100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NFMHDR').NOPTS5               40462200
&NFMHDR  SETB 1                                                         40500300
&FMHDR1  SETB 0                                                         40538400
&MSK4CTR SETA  &MSK4CTR+1                                               40576500
         AGO  .GETNEXT                                                  40614600
.NOPTS5  ANOP                                                           40652700
.* *********** END VTL ADDITIONS ****************                       40690800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NQ').NOPTS6                   40728900
&NQ      SETB 1                                                         40767000
&NQ1     SETB 0                                                         40805100
&MSK2CTR SETA  &MSK2CTR+1                                               40843200
         AGO  .GETNEXT                                                  40881300
.NOPTS6  ANOP                                                           40919400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NRELRQ').NOPTS8               40957500
&NRELRQ SETB 1                                                          40995600
&NRELRQ1 SETB 0                                                         41033700
&MSK2CTR SETA  &MSK2CTR+1                                               41071800
         AGO  .GETNEXT                                                  41109900
.NOPTS8  ANOP                                                           41148000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NRSPQUED').NOPTS51   @R491101 41186100
&NRSPQU  SETB 1                                                @R491101 41224200
&NRSPQU1 SETB 0                                                @R491101 41262300
&RSPQUE1 SETB 0                                                @R491101 41300400
&MSK3CTR SETA  &MSK3CTR+1                                      @R491101 41338500
&MSK4CTR SETA  &MSK4CTR+1                                      @R491101 41376600
         AGO  .GETNEXT                                         @R491101 41414700
.NOPTS51 ANOP                                                           41452800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NMTS').NOPTS52           @F1A 41490900
&NMTS    SETB 1                                                    @F1A 41529000
&MTS1    SETB 0                                                    @F1A 41567100
&MSK4CTR SETA  &MSK4CTR+1                                          @F1A 41605200
         AGO  .GETNEXT                                             @F1A 41643300
.NOPTS52 ANOP                                                      @F1A 41681400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NPERSIST').NOPTS53       @B1A 41719500
&NPERST  SETB 1                                                    @B1A 41757600
&OPT4X   SETC 'X''40'''             RPLNPERS VALUE                 @U3C 41795700
&CNTSTL  SETA &CNTSTL+1                                            @B1A 41833800
         AGO  .GETNEXT                                             @B1A 41871900
.NOPTS53 ANOP                                                      @B1A 41910000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NQN').NOPTS54            @KFA 41948100
&NQN     SETB 1                                                    @KFA 41986200
&OPT4X   SETC 'X''04'''             RPLNQN   VALUE                 @U3C 42024300
&CNTINQ  SETA &CNTINQ+1                                            @KFA 42062400
         AGO  .GETNEXT                                             @KFA 42100500
.NOPTS54 ANOP                                                      @KFC 42138600
         AGO  .INVLDOP                                                  42176700
.COPTS   ANOP                                                           42214800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CS').COPTS2                   42252900
&CSSPEC  SETB 1                                                    @W1A 42291000
&CS      SETB 1                                                         42329100
&CS1     SETB 0                                                         42367200
&CONDCS1 SETB 0                                                    @W1A 42405300
&MSK1CTR SETA  &MSK1CTR+1                                               42443400
&MSK2CTR SETA  &MSK2CTR+1                                               42481500
         AGO  .GETNEXT                                                  42519600
.COPTS2  ANOP                                                           42557700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'COND').COPTS3                 42595800
&COND    SETB 1                                                         42633900
&COND1   SETB 0                                                         42672000
&LOCK1   SETB 0                                                         42710100
&UNCOND1  SETB 0                                                        42748200
&UNBIND1  SETB 0                                               @R491100 42786300
&TERMQ1  SETB 0                                                    @01A 42824400
&MSK1CTR SETA  &MSK1CTR+1                                               42862500
&MSK2CTR SETA  &MSK2CTR+1                                               42900600
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 42938700
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 42976800
         AGO  .GETNEXT                                                  43014900
.COPTS3  ANOP                                                           43053000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONV').COPTS4                 43091100
.* *** CONV NO LONGER SUPPORTED, IGNORED ***                       @W1C 43129200
         AGO  .GETNEXT                                                  43167300
.COPTS4  ANOP                                                           43205400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONALL').COPTS5               43243500
&CONALL  SETB 1                                                         43281600
&CONALL1 SETB 0                                                         43319700
&CONANY1 SETB 0                                                         43357800
&MSK1CTR SETA  &MSK1CTR+1                                               43395900
&MSK2CTR SETA  &MSK2CTR+1                                               43434000
         AGO  .GETNEXT                                                  43472100
.COPTS5  ANOP                                                           43510200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONANY').COPTS6               43548300
&CONANY  SETB 1                                                         43586400
&CONANY1 SETB 0                                                         43624500
&CONALL1 SETB 0                                                         43662600
&MSK1CTR SETA  &MSK1CTR+1                                               43700700
&MSK2CTR SETA  &MSK2CTR+1                                               43738800
         AGO  .GETNEXT                                                  43776900
.COPTS6  ANOP                                                           43815000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CA').COPTS7                   43853100
&CA      SETB 1                                                         43891200
&CS1     SETB 0                                                         43929300
&CONDCS1 SETB 0                                                    @W1A 43967400
&MSK2CTR SETA  &MSK2CTR+1                                               44005500
         AGO  .GETNEXT                                                  44043600
.COPTS7  ANOP                                                           44081700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'COUNTS').COPTS8               44119800
&COUNTS  SETB 1                                                         44157900
&CNTINQ  SETA &CNTINQ+1                                                 44196000
         AGO  .GETNEXT                                                  44234100
.COPTS8  ANOP                                                           44272200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CIDXLATE').COPTS9             44310300
&CIDXLAT SETB 1                                                         44348400
&CNTINQ  SETA &CNTINQ+1                                                 44386500
         AGO  .GETNEXT                                                  44424600
.COPTS9  ANOP                                                  @R489301 44462700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONTCHN').COPTS10        @W1C 44500800
&CONTCHN SETB 1                                                @D5B4747 44538900
&CNTCHN1 SETB 0                                                @D5B4747 44577000
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 44615100
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 44653200
         AGO  .GETNEXT                                         @D5B4747 44691300
.COPTS10 ANOP                                                      @W1A 44729400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONDCS').XOPTS           @W1A 44767500
&CONDCSS SETB 1                                                    @W1A 44805600
&CONDCS  SETB 1                                                    @W1A 44843700
&CONDCS1 SETB 0                                                    @W1A 44881800
&CS      SETB 1                                                    @W1A 44919900
&CS1     SETB 0                                                    @W1A 44958000
&MSK1CTR SETA &MSK1CTR+1                                           @W1A 44996100
&MSK2CTR SETA &MSK2CTR+1                                           @W1A 45034200
         AGO  .GETNEXT                                             @W1A 45072300
.BOPTS   ANOP                                                  @R489301 45110400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BACKUP').XOPTS       @R489301 45148500
&BACKUP  SETB 1                                                @R489301 45186600
&BACKUP1 SETB 0                                                @R489301 45224700
&MSK1CTR SETA  &MSK1CTR+1                                      @R489301 45262800
&MSK2CTR SETA  &MSK2CTR+1                                      @R489301 45300900
         AGO  .GETNEXT                                         @R489301 45339000
.UOPTS   ANOP                                                  @R489301 45377100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'USERVAR').UOPTS1     @R489301 45415200
&USERVAR SETB 1                                                @R489301 45453300
&CNTINQ  SETA  &CNTINQ+1                                       @R489301 45491400
         AGO  .GETNEXT                                         @R489301 45529500
.UOPTS1  ANOP                                                  @R489301 45567600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNBIND').XOPTS       @R491100 45605700
&UNBIND  SETB 1                                                @R491100 45643800
&UNBIND1 SETB 0                                                @R491100 45681900
&COND1   SETB 0                                                @R491100 45720000
&LOCK1   SETB 0                                                @R491100 45758100
&UNCOND1 SETB 0                                                @R491100 45796200
&TERMQ1  SETB 0                                                    @01A 45834300
&MSK1CTR SETA  &MSK1CTR+1                                      @R491100 45872400
&MSK2CTR SETA  &MSK2CTR+1                                      @R491100 45910500
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 45948600
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 45986700
         AGO  .GETNEXT                                         @R491100 46024800
.FOPTS   ANOP                                                  @R489301 46062900
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'FORCED').XOPTS       @R489301 46101000
&FORCED  SETB 1                                                @R489301 46139100
&FORCED1 SETB 0                                                @R489301 46177200
&MSK3CTR SETA  &MSK3CTR+1                                      @R489301 46215300
&MSK4CTR SETA  &MSK4CTR+1                                      @R489301 46253400
         AGO  .GETNEXT                                         @R489301 46291500
.HOPTS   ANOP                                                  @R489301 46329600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'HOLD').XOPTS         @R491100 46367700
&HOLD    SETB 1                                                @R491100 46405800
&CNTSTL  SETA &CNTSTL+1                                            @B1A 46443900
         AGO  .GETNEXT                                         @R491100 46482000
.EOPTS   ANOP                                                           46520100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ENDAFFIN').EOPTS2        @I1A 46558200
&ENDAF   SETB 1                                                    @I1A 46596300
&MSK1CTR SETA  &MSK1CTR+1                                          @I1A 46634400
&MSK2CTR SETA  &MSK2CTR+1                                          @I1A 46672500
&OPT4X   SETC 'X''41'''             RPLCGEAF VALUE                 @U3C 46710600
         AGO  .GETNEXT                                             @I1A 46748700
.EOPTS2  ANOP                                                      @I1A 46786800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'EAU').EOPTS3                  46824900
&EAU     SETB 1                                                         46863000
&EAU1    SETB 0                                                         46901100
&ERASE1  SETB 0                                                         46939200
&NERASE1 SETB 0                                                         46977300
&MSK1CTR SETA  &MSK1CTR+1                                               47015400
&MSK2CTR SETA  &MSK2CTR+1                                               47053500
         AGO  .GETNEXT                                                  47091600
.EOPTS3  ANOP                                                           47129700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ERASE').EOPTS4                47167800
&ERASE   SETB 1                                                         47205900
&ERASE1  SETB 0                                                         47244000
&EAU1    SETB 0                                                         47282100
&NERASE1 SETB 0                                                         47320200
&MSK1CTR SETA  &MSK1CTR+1                                               47358300
&MSK2CTR SETA  &MSK2CTR+1                                               47396400
         AGO  .GETNEXT                                                  47434500
.EOPTS4  ANOP                                                           47472600
         AGO  .INVLDOP                                                  47510700
.AOPTS   ANOP                                                           47548800
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'ANY').AOPTS1                   47586900
&ANY     SETB 1                                                         47625000
&ANY1    SETB 0                                                         47663100
&MSK1CTR SETA  &MSK1CTR+1                                               47701200
&MSK2CTR SETA  &MSK2CTR+1                                               47739300
         AGO  .GETNEXT                                                  47777400
.AOPTS1  ANOP                                                           47815500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACCEPT').AOPTS2               47853600
&ACCEPT  SETB 1                                                         47891700
&ACCEPT1 SETB 0                                                         47929800
&ACQUIR1 SETB 0                                                         47967900
&MSK1CTR SETA  &MSK1CTR+1                                               48006000
&MSK2CTR SETA  &MSK2CTR+1                                               48044100
         AGO  .GETNEXT                                                  48082200
.AOPTS2  ANOP                                                           48120300
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACQUIRE').AOPTS3              48158400
&ACQUIRE SETB 1                                                         48196500
&ACCEPT1 SETB 0                                                         48234600
&ACQUIR1 SETB 0                                                         48272700
&MSK1CTR SETA  &MSK1CTR+1                                               48310800
&MSK2CTR SETA  &MSK2CTR+1                                               48348900
         AGO  .GETNEXT                                                  48387000
.AOPTS3  ANOP                                                           48425100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ASY').AOPTS4                  48463200
&ASY     SETA 1                                                         48501300
         AGO  .GETNEXT                                                  48539400
.AOPTS4  ANOP                                                           48577500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACTIVE').AOPTS5               48615600
&ACTIVE  SETB 1                                                         48653700
&PEND1   SETB 0                                                         48691800
&ACTIVE1 SETB 0                                                         48768000
&UNCNDL1 SETB 0                                                         48806100
&MSK1CTR SETA  &MSK1CTR+1                                               48844200
&MSK2CTR SETA  &MSK2CTR+1                                               48882300
         AGO  .GETNEXT                                                  48920400
.AOPTS5  ANOP                                                           48958500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'APPSTAT').AOPTS6              48996600
&APPSTAT SETB 1                                                         49034700
&CNTINQ  SETA &CNTINQ+1                                                 49072800
         AGO  .GETNEXT                                                  49110900
.AOPTS6  ANOP                                                           49149000
         AGO  .INVLDOP                                                  49187100
.GETNEXT ANOP                                                           49225200
&NUM     SETA  &NUM-1                                                   49263300
         AIF   ('&NUM' NE '0').SETOPT                                   49301400
.* ******************************************************************** 49339500
.*                      GENMSK SUBROUTINE                               49377600
.* CHECKS FOR MUTUALLY EXCLUSIVE OPTIONS (OF OPTCD) AND GENERATES CODE  49415700
.* TO MODIFY THE OPTION BYTES IN THE RPL.  ISSUES MNOTES FOR MUTUALLY   49453800
.*                       EXCLUSIVE OPTIONS.                             49491900
.* ******************************************************************** 49530000
.GENMSK  ANOP                                                           49568100
.* ******************************************************************** 49606200
.* CHECK FOR PSTIMER=VALUE                                    @B1A @T1M 49644300
.* ******************************************************************** 49682400
         AIF   ('&PSTIMER' EQ '').PSTIMND  PSTIMER SPECIFIED? @B1A @T1M 49720500
         AIF   (NOT(&PERST)).PSTMERR   OPTCD=PERSIST NOT SET?      @T1A 49758600
&PSTIME  SETB  1                                              @B1A @T1M 49796700
&MAXSES1 SETB  0                                                   @D1A 49815700
&OPT4X   SETC 'X''88'''             RPLPERS VALUE + RPLSLTMR       @U3C 49834800
&MSK2CTR SETA  &MSK2CTR+1                                          @D1A 49853800
&MSK3CTR SETA  &MSK3CTR+1                                          @T1A 49872900
&MSK4CTR SETA  &MSK4CTR+1                                          @T1A 49911000
         AIF   ('&PSTIMER'(1,1) NE '(').TVAL  REG NOTATION?   @B1A @T1M 49949100
         ST    &PSTIMER(1),&PLUSFLD.(1)  PUT TIMER VALUE IN RPL         49987200
.*                                                            @B1A @T1M 50025300
         AGO   .PSTIMND                                       @B1A @T1M 50063400
.PSTMERR ANOP                                                      @T1A 50101500
         MNOTE 4,'PARMS=PSTIMER CAN ONLY BE SPECIFIED WITH OPTCD=PERSIS*50139600
               T - PSTIMER IGNORED'                                @T1A 50177700
         AGO   .PSTIMND                                            @T1A 50215800
.TVAL    ANOP                          CONSTANT SPECIFIED     @B1A @T1M 50253900
         B     *+8                                            @B1A @T1M 50292000
         DC    A(&PSTIMER)                                    @B1A @T1M 50330100
         L     15,*-4                                         @B1A @T1M 50368200
         ST    15,&PLUSFLD.(1)         PUT TIMER VALUE IN RPL @B1A @T1M 50406300
.PSTIMND ANOP                                                 @B1A @T1M 50444400
.* ******************************************************************** 50445900
.* CHECK FOR MAXSESS=VALUE                                         @D1A 50447400
.* ******************************************************************** 50448900
         AIF   ('&MAXSESS' EQ '').MAXSEND  MAXSESS SPECIFIED?      @D1A 50450400
         AIF   (NOT(&GNADD)).MAXSERR   OPTCD=GNAMEADD NOT SET?     @D1A 50451900
&MXSES   SETB  1                                                   @D1A 50453400
&MXSES1  SETB  0                                                   @D1A 50454900
&MSK1CTR SETA  &MSK1CTR+1                                          @D1A 50456400
&MSK2CTR SETA  &MSK2CTR+1                                          @D1A 50457900
         AIF   ('&MAXSESS'(1,1) NE '(').MXVAL  REG NOTATION?       @D1A 50459400
         ST    &MAXSESS(1),&PLUSFLD.(1)  PUT MAXSESS VALUE IN RPL       50460900
.*                                                                 @D1A 50462400
         AGO   .MAXSEND                                            @D1A 50463900
.MAXSERR ANOP                                                      @D1A 50465400
         MNOTE 4,'PARMS=MAXSESS CAN ONLY BE SPECIFIED WITH OPTCD=GNAMEA*50466900
               DD - MAXSESS IGNORED'                               @D1A 50468400
         AGO   .MAXSEND                                            @D1A 50469900
.MXVAL   ANOP                          CONSTANT SPECIFIED          @D1A 50471400
         B     *+8                                                 @D1A 50472900
         DC    A(&MAXSESS)                                         @D1A 50474400
         L     15,*-4                                              @D1A 50475900
         ST    15,&PLUSFLD.(1)         PUT MAXSESS VALUE IN RPL    @D1A 50477400
.MAXSEND ANOP                                                      @D1A 50478900
.*                                                                      50480400
         AIF  ('&SYN' EQ '1' AND '&ASY' EQ '1').CNFLCT1                 50482500
         AIF  ('&SYN' NE '1' AND '&ASY' NE '1').MODOPT                  50520600
         AIF  ('&ASY' EQ '1').ASYSW                                     50558700
         NI    &PLOPTC1.(1),X'F7'     TURN OFF THE ASY BIT              50596800
         AGO   .MODOPT                                                  50634900
.ASYSW   ANOP                                                           50673000
         OI    &PLOPTC1.(1),X'08'     TURN ON THE ASY BIT               50711100
         AGO   .MODOPT                                                  50749200
.CNFLCT1 ANOP                                                           50787300
     MNOTE 4,'PARAMETERS SYN AND ASY CONFLICT BOTH DISREGARDED'         50825400
.*                                                             @P011983 50863500
.MODOPT  ANOP                                                           50901600
         AIF  ('&SPEC' EQ '1' AND '&ANY' EQ '1').CNFLCT2                50939700
.MODOPT2 ANOP                                                           50977800
         AIF  ('&CNTSTL' EQ '0' ).MODOPT3                          @B1A 51015900
         AIF  ('&CNTSTL' GT '1' ).CNFLCT3                          @B1A 51054000
         AIF  ('&IHBRW' EQ '21').STLOPT     MACRO IS SETLOGON      @T2A 51092100
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON SETLOGON            @T2A 51130200
         AIF  (NOT(&PERST OR &NPERST OR &GNADD OR &GNDEL               X51155600
               OR &GNSUB)).STLOPT                             @U2C @D1C 51181000
&OPTERR  SETA &OPTERR+1                                            @T2A 51206400
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE SETLOX51244500
               GON MACRO,   DISREGARDED'                           @T2A 51282600
         AGO   .MODOPT3                                            @T2A 51320700
.STLOPT  ANOP                                                      @T2A 51358800
&START1  SETB  0                                                   @B1A 51396900
&STOP1   SETB  0                                                   @B1A 51435000
&QUIESC1 SETB  0                                                   @B1A 51473100
&HOLD1   SETB  0                                                   @B1A 51511200
&MSK3CTR SETA  &MSK3CTR+1                                               51549300
&MSK4CTR SETA  &MSK4CTR+1                                               51587400
.MODOPT3 ANOP                                                           51625500
         AIF  ('&PASS' EQ '1' AND '&RELEASE' EQ '1').CNFLCT5            51663600
.MODOPT5 ANOP                                                           51701700
         AIF  ('&CA' EQ '1' AND '&CSSPEC' EQ '1').CNFLCT6          @W1C 51739800
         AIF  ('&CA' EQ '1' AND '&CONDCSS' EQ '1').CNFLCT6         @W1A 51777900
         AIF  ('&CSSPEC' EQ '1' AND '&CONDCSS' EQ '1').CNFLCT6     @W1A 51816000
.MODOPT6 ANOP                                                           51854100
         AIF  ('&ACCEPT' EQ '1' AND '&ACQUIRE' EQ '1').CNFLCT7          51892200
         AIF  ('&ACCEPT' EQ '1' AND '&RESTOR' EQ '1').CNFLCT7      @B1A 51930300
         AIF  ('&ACQUIRE' EQ '1' AND '&RESTOR' EQ '1').CNFLCT7     @B1A 51968400
         AIF  ('&IHBRW' EQ '23').MODOPT7    MACRO IS OPNDST        @T2A 52006500
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON OPNDST              @T2A 52044600
         AIF  (NOT(&RESTOR)).MODOPT7                               @T2A 52082700
&OPTERR  SETA &OPTERR+1                                            @T2A 52120800
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE OPNDSX52158900
               T MACRO,     DISREGARDED'                           @T2A 52197000
.MODOPT7 ANOP                                                           52235100
         AIF  ('&Q' EQ '1' AND '&NQ' EQ '1').CNFLCT8                    52273200
.MODOPT8 ANOP                                                           52311300
         AIF  ('&RELRQ' EQ '1' AND '&NRELRQ' EQ '1').CNFLCT9            52349400
.MODOPT9 ANOP                                                           52387500
         AIF  ('&ERASE' EQ '1' AND '&EAU' EQ '1').CNFLCTB               52425600
         AIF  ('&ERASE' EQ '1' AND '&NERASE' EQ '1').CNFLCTB            52463700
         AIF  ('&EAU' EQ '1' AND '&NERASE' EQ '1').CNFLCTB              52501800
.MODOPTB ANOP                                                           52539900
         AIF  ('&BLK' EQ '1' AND '&LBM' EQ '1').CNFLCTC                 52578000
         AIF  ('&BLK' EQ '1' AND '&LBT' EQ '1').CNFLCTC                 52616100
         AIF  ('&LBM' EQ '1' AND '&LBT' EQ '1').CNFLCTC                 52654200
.MODOPTC ANOP                                                           52692300
         AIF  ('&LOCK' EQ '1' AND '&COND' EQ '1').CNFLCTD               52730400
         AIF  ('&LOCK' EQ '1' AND '&UNCOND' EQ '1').CNFLCTD             52768500
         AIF  ('&LOCK' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD    @R491100 52806600
         AIF  ('&COND' EQ '1' AND '&UNCOND' EQ '1').CNFLCTD             52844700
         AIF  ('&COND' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD    @R491100 52882800
         AIF  ('&UNCOND' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD  @R491100 52920900
.MODOPTD ANOP                                                           52959000
         AIF  ('&CONALL' EQ '1' AND '&CONANY' EQ '1').CNFLCTE           52997100
.MODOPTE ANOP                                                           53035200
         AIF  ('&PEND' EQ '1' AND '&SESSION' EQ '1').CNFLCTF            53073300
         AIF  ('&PEND' EQ '1' AND '&ACTIVE' EQ '1').CNFLCTF             53111400
         AIF  ('&PEND' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF            53149500
         AIF  ('&ACTIVE' EQ '1' AND '&SESSION' EQ '1').CNFLCTF          53187600
         AIF  ('&ACTIVE' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF          53225700
         AIF  ('&SESSION' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF         53263800
.MDOPTE1 ANOP                                                  @D5B4747 53301900
         AIF  ('&NBUFLST' EQ '1' AND '&BUFFLST' EQ '1').CNFLCF1         53340000
.*                                                             @D5B4747 53378100
.MDOPTE2 ANOP                                                  @D5B4747 53416200
         AIF  ('&CONTCHN' EQ '1' AND '&NCNTCHN' EQ '1').CNFLCF2         53454300
.*                                                             @D5B4747 53492400
.MDOPTE3 ANOP                                                  @D5B4747 53530500
         AIF  ('&NLMPEO' EQ '1' AND '&LMPEO' EQ '1').CNFLCF3            53568600
.*                                                             @D5B4747 53606700
.MDOPTE4 ANOP                                                  @D5B4747 53644800
         AIF  ('&NUSERRH' EQ '1' AND '&USERRH' EQ '1').CNFLCF4          53682900
.*                                                             @D5B4747 53721000
.MDOPTE5 ANOP                                                      @F1A 53759100
         AIF  ('&MTS' EQ '1' AND '&NMTS' EQ '1').CNFLCF5           @F1A 53797200
.*                                                                      53835300
.MDOPTE6 ANOP                                                      @01A 53873400
         AIF  ('&PASS' EQ '1' AND '&TERMQ' EQ '1').CNFLCF6         @01A 53911500
         AIF  ('&RELEASE' EQ '1' AND '&TERMQ' EQ '1').CNFLCF6      @01A 53949600
.*                                                                      53987700
.MDOPTE7 ANOP                                                      @01A 54025800
         AIF  ('&LOCK' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7         @01A 54063900
         AIF  ('&COND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7         @01A 54102000
         AIF  ('&UNCOND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7       @01A 54140100
         AIF  ('&UNBIND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7       @01A 54178200
.*                                                                      54216300
.MODOPTF ANOP                                                           54254400
         AIF  ('&CNTINQ' EQ '0' ).MODOPTG                               54292500
         AIF  ('&CNTINQ' GT '1' ).CNFLCTG                               54330600
         AIF  ('&IHBRW' EQ '26').INQOPT     MACRO IS INQUIRE       @T2A 54368700
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON INQUIRE             @T2A 54406800
         AIF  (NOT(&PERSIQ OR &NQN OR &SESNM)).INQOPT              @U2C 54444900
&OPTERR  SETA &OPTERR+1                                            @T2A 54483000
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE INQUIX54521100
               RE MACRO,    DISREGARDED'                           @T2A 54559200
         AGO   .MODOPTG                                            @T2A 54597300
.INQOPT  ANOP                                                      @T2A 54635400
&LGONMS1 SETB  0                                                        54673500
&DEVCHR1 SETB  0                                                        54711600
&TERMS1  SETB  0                                                        54749700
&APSTAT1 SETB  0                                                        54787800
&COUNTS1 SETB  0                                                        54825900
&RNNAME1 SETB  0                                                        54864000
&CIDXLT1 SETB  0                                                        54902100
&TOPLGN1 SETB  0                                                        54940200
&BSCID1  SETB  0                                                        54978300
&DISPLY1 SETB  0                                                        55016400
&SPARM1  SETB  0                                                        55054500
&SKEY1   SETB  0                                               @XM30862 55092600
&USRVAR1 SETB  0                                               @P014769 55130700
&STATUS1 SETB  0                                                   @04A 55168800
&MSK3CTR SETA  &MSK3CTR+1                                               55206900
&MSK4CTR SETA  &MSK4CTR+1                                               55245000
.MODOPTG ANOP                                                           55283100
.* *************** VTL ADDITIONS ****************                       55321200
         AIF  ('&KEEP' EQ '1' AND '&TRUNC' EQ '1').CNFLCTI              55359300
         AIF  ('&KEEP' EQ '1' AND '&NIBTK' EQ '1').CNFLCTI              55397400
         AIF  ('&TRUNC' EQ '1' AND '&NIBTK' EQ '1').CNFLCTI             55435500
.MODOPTI ANOP                                                           55473600
         AIF  ('&NFMHDR' EQ '1' AND '&FMHDR' EQ '1').CNFLCTK            55511700
.MODOPTK ANOP                                                           55549800
.* ************ END VTL ADDITIONS ***************                       55587900
         AIF  ('&QALL' EQ '1' AND '&QSESS' EQ '1').CNFLCTL     @R504800 55626000
         AIF  ('&QALL' EQ '1' AND '&QNOTE' EQ '1').CNFLCTL     @R504800 55664100
         AIF  ('&QSESS' EQ '1' AND '&QNOTE' EQ '1').CNFLCTL    @R504800 55702200
.MODOPTL ANOP                                                  @R504800 55740300
         AIF  ('&NBACKUP' EQ '1' AND '&BACKUP' EQ '1').CNFLCTM @R489301 55778400
.MODOPTM ANOP                                                  @R489301 55816500
         AIF  ('&NSONCD' EQ '1' AND '&SONCD' EQ '1').CNFLCTN   @R491100 55854600
.MODOPTN ANOP                                                  @R491100 55892700
         AIF  ('&NSENSE' EQ '1' AND '&SENSE' EQ '1').CNFLCTO   @R491100 55930800
.MODOPTO ANOP                                                  @R491100 55968900
         AIF  ('&RSPQUE' EQ '1' AND '&NRSPQU' EQ '1').CNFLCTP  @R491101 56007000
.MODOPTP ANOP                                                  @R491101 56045100
         AIF  ('&IHBRW' EQ '25').MODOPTQ    MACRO IS CHANGE        @I1A 56083200
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON CHANGE              @I1A 56121300
         AIF  (NOT(&ENDAF)).MODOPTQ                                @I1A 56159400
&OPTERR  SETA &OPTERR+1                                            @I1A 56197500
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE CHANGX56235600
               E MACRO,     DISREGARDED'                           @I1A 56273700
.MODOPTQ ANOP                                                      @I1A 56311800
         AIF  ('&KPSRB' EQ '1' AND '&NKPSRB' EQ '1').CNFLCTR       @U4A 56349900
.MODOPTR ANOP                                                      @U4A 56388000
         AGO   .CKDONE                                                  56426100
.CNFLCT2 ANOP                                                           56464200
&OPTERR  SETA  &OPTERR+1                                                56502300
   MNOTE 4,'PARAMETERS SPEC AND ANY CONFLICT BOTH DISREGARDED' @P011983 56540400
         AGO   .MODOPT2                                            @W1C 56578500
.CNFLCT3 ANOP                                                           56616600
&OPTERR  SETA  &OPTERR+1                                                56654700
   MNOTE 4,'TWO OR MORE OF THE FOLLOWING CONFLICTING VALUES WERE SPECIFX56692800
               IED'                                                @I1C 56730900
   MNOTE 4,'     STOP, START, QUIESCE, HOLD, PERSIST, NPERSIST, '  @I1C 56769000
   MNOTE 4,'     GNAMEADD, GNAMEDEL, GNAMESUB -  ALL DISREGARDED'       56794400
.*                                                            @I1C @D1C 56819800
         AGO   .MODOPT3                                                 56845200
.CNFLCT5 ANOP                                                           56883300
&OPTERR  SETA  &OPTERR+1                                                56921400
   MNOTE 4,'PARAMETERS PASS AND RELEASE CONFLICT BOTH DISREGARDED'      56959500
.*                                                             @P011983 56997600
         AGO   .MODOPT5                                                 57035700
.CNFLCT6 ANOP                                                           57073800
&OPTERR  SETA  &OPTERR+1                                                57111900
   MNOTE 4,'PARAMETERS CA, CS, AND CONDCS CONFLICT, ALL DISREGARDED'   X57150000
                                                                   @W1C 57188100
         AGO   .MODOPT6                                                 57226200
.CNFLCT7 ANOP                                                           57264300
&OPTERR  SETA  &OPTERR+1                                                57302400
   MNOTE 4,'PARAMETERS ACCEPT AND-OR ACQUIRE AND-OR RESTORE'       @B1C 57340500
   MNOTE 4,'        CONFLICT, ALL DISREGARDED'                     @B1C 57378600
         AGO   .MODOPT7                                                 57416700
.CNFLCT8 ANOP                                                           57454800
&OPTERR  SETA  &OPTERR+1                                                57492900
   MNOTE 4,'PARAMETERS Q AND NQ CONFLICT BOTH DISREGARDED'     @P011983 57531000
         AGO   .MODOPT8                                                 57569100
.CNFLCT9 ANOP                                                           57607200
&OPTERR  SETA  &OPTERR+1                                                57645300
   MNOTE 4,'PARAMETERS RELRQ AND NRELRQ CONFLICT BOTH DISREGARDED'      57683400
.*                                                             @P011983 57721500
         AGO   .MODOPT9                                                 57759600
.CNFLCTB ANOP                                                           57797700
&OPTERR  SETA  &OPTERR+1                                                57835800
   MNOTE 4,'PARAMETERS ERASE AND-OR EAU AND-OR NERASE'         @P011983 57873900
   MNOTE 4,'        CONFLICT, ALL DISREGARDED     '            @P011983 57912000
         AGO   .MODOPTB                                                 57950100
.CNFLCTC ANOP                                                           57988200
&OPTERR  SETA  &OPTERR+1                                                58026300
   MNOTE 4,'PARAMETERS BLK AND-OR LBM AND-OR LBT'              @P011983 58064400
   MNOTE 4,'        CONFLICT, ALL DISREGARDED     '            @P011983 58102500
         AGO   .MODOPTC                                                 58140600
.CNFLCTD ANOP                                                           58178700
&OPTERR  SETA  &OPTERR+1                                                58216800
   MNOTE 4,'PARAMETERS LOCK AND-OR COND AND-OR UNCOND'         @R491100 58254900
   MNOTE 4,' AND-OR UNBIND  CONFLICT, ALL DISREGARDED'  @R491100        58293000
         AGO   .MODOPTD                                                 58331100
.CNFLCTE ANOP                                                           58369200
&OPTERR  SETA  &OPTERR+1                                                58407300
   MNOTE 4,'PARAMETERS CONALL AND CONANY CONFLICT, BOTH DISREGARDED '   58445400
.*                                                             @P011983 58483500
         AGO   .MODOPTE                                                 58521600
.CNFLCTF ANOP                                                           58559700
&OPTERR  SETA  &OPTERR+1                                                58597800
  MNOTE 4,'PARAMETERS PEND AND-OR SESSION AND-OR ACTIVE AND-OR UNCONDL' 58635900
.*                                                             @P011983 58674000
  MNOTE 4,'        CONFLICT, ALL DISREGARDED     '                      58712100
.*                                                             @P011983 58750200
         AGO   .MDOPTE1                                        @D5B4747 58788300
.CNFLCF1 ANOP                                                  @D5B4747 58826400
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 58864500
   MNOTE 4,'PARAMETERS NBUFFLST AND BUFFLST CONFLICT, BOTH DISREGARDED' 58902600
.*                                                             @P011983 58940700
         AGO   .MDOPTE2                                        @D5B4747 58978800
.CNFLCF2 ANOP                                                  @D5B4747 59016900
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 59055000
   MNOTE 4,'PARAMETERS CONTCHN AND NCONTCHN CONFLICT, BOTH DISREGARDED' 59093100
.*                                                             @P011983 59131200
         AGO   .MDOPTE3                                        @D5B4747 59169300
.CNFLCF3 ANOP                                                  @D5B4747 59207400
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 59245500
   MNOTE 4,'PARAMETERS NLMPEO AND LMPEO CONFLICT, BOTH DISREGARDED'     59283600
.*                                                             @P011983 59321700
         AGO   .MDOPTE4                                        @D5B4747 59359800
.CNFLCF4 ANOP                                                  @D5B4747 59397900
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 59436000
   MNOTE 4,'PARAMETERS USERRH AND NUSERRH CONFLICT, BOTH DISREGARDED'   59474100
.*                                                             @P011983 59512200
         AGO   .MDOPTE5                                            @F1A 59550300
.CNFLCF5 ANOP                                                      @F1A 59588400
&OPTERR  SETA  &OPTERR+1                                           @F1A 59626500
   MNOTE 4,'PARAMETERS MTS AND NMTS CONFLICT, BOTH DISREGARDED'    @F1A 59664600
.*                                                                      59702700
         AGO   .MDOPTE6                                            @01A 59740800
.CNFLCF6 ANOP                                                      @01A 59778900
&OPTERR  SETA  &OPTERR+1                                           @01A 59817000
   MNOTE 4,'PARAMETERS PASS AND-OR RELEASE AND TERMQ CONFLICT'     @01A 59855100
   MNOTE 4,'ALL DISREGARDED'                                       @01A 59893200
.*                                                                      59931300
         AGO   .MDOPTE7                                            @01A 59969400
.CNFLCF7 ANOP                                                      @01A 60007500
&OPTERR  SETA  &OPTERR+1                                           @01A 60045600
   MNOTE 4,'PARAMETERS LOCK AND-OR COND AND-OR UNCOND AND-OR'      @01A 60083700
   MNOTE 4,'UNBIND AND TERMQ CONFLICT ALL DISREGARDED'             @01A 60121800
.*                                                                      60159900
         AGO   .MODOPTF                                        @D5B4747 60198000
.CNFLCTG ANOP                                                           60236100
&OPTERR  SETA  &OPTERR+1                                                60274200
  MNOTE 4,'TWO OR MORE OF THE FOLLOWING CONFLICTING VALUES WERE SPECIFIX60312300
               ED'                                                 @I1C 60350400
  MNOTE 4,'     LOGONMSG, DEVCHAR, TERMS, APPSTAT, COUNTS, RNNAME, '   X60388500
                                                                   @I1C 60426600
  MNOTE 4,'     CIDXLATE, TOPLOGON, BSCID, DISPLAY, SESSPARM, USERVAR,'X60464700
                                                                   @I1C 60502800
  MNOTE 4,'     PERSESS, NQN, SESSNAME, STATUS'                    @04C 60540900
  MNOTE 4,'       -  ALL DISREGARDED'                              @04A 60579000
.*                                                                 @KFC 60617100
        AGO   .MODOPTG                                                  60655200
.* *************** VTL ADDITIONS ****************                       60693300
.CNFLCTI ANOP                                                           60731400
&OPTERR  SETA  &OPTERR+1                                                60769500
   MNOTE 4,'PARAMETERS KEEP AND-OR TRUNC AND-OR NIBTK CONFLICT,'        60807600
.*                                                             @P011983 60845700
   MNOTE 4,'       ALL DISREGARDED      '                      @P011983 60883800
          AGO  .MODOPTI                                                 60921900
.CNFLCTK ANOP                                                           60960000
&OPTERR  SETA  &OPTERR+1                                                60998100
   MNOTE 4,'PARAMETERS NFMHDR AND FMHDR CONFLICT, BOTH DISREGARDED'     61036200
.*                                                             @P011983 61074300
         AGO  .MODOPTK                                                  61112400
.CNFLCTL ANOP                                                  @R504800 61150500
&OPTERR  SETA  &OPTERR+1                                       @R504800 61188600
   MNOTE 4,'PARAMETERS QALL AND-OR QSESSLIM AND-OR QNOTENAB CONFLICT,'  61226700
   MNOTE 4,'       ALL DISREGARDED      '                      @R504800 61264800
         AGO  .MODOPTL                                         @R504800 61302900
.CNFLCTM ANOP                                                  @R489301 61341000
&OPTERR  SETA  &OPTERR+1                                       @R489301 61379100
   MNOTE 4,'PARAMETERS NBACKUP AND BACKUP CONFLICT, BOTH DISREGARDED'   61417200
.*                                                             @R489301 61455300
         AGO  .MODOPTM                                         @R489301 61493400
.CNFLCTN ANOP                                                  @R491100 61531500
&OPTERR  SETA  &OPTERR+1                                       @R491100 61569600
   MNOTE 4,'PARAMETERS NSONCODE AND SONCODE CONFLICT, BOTH DISREGARDED' 61607700
.*                                                             @R491100 61645800
         AGO  .MODOPTN                                         @R491100 61683900
.CNFLCTO ANOP                                                  @R491100 61722000
&OPTERR  SETA  &OPTERR+1                                       @R491100 61760100
   MNOTE 4,'PARAMETERS NSENSE AND SENSE CONFLICT, BOTH DISREGARDED'     61798200
.*                                                             @R491100 61836300
         AGO  .MODOPTO                                         @R491100 61874400
.CNFLCTP ANOP                                                  @R491101 61912500
&OPTERR  SETA  &OPTERR+1                                       @R491101 61950600
   MNOTE 4,'PARAMETERS RSPQUED AND NRSPQUED CONFLICT, BOTH DISREGARDED' 61988700
.*                                                             @R491101 62026800
         AGO  .MODOPTP                                         @R491101 62064900
.CNFLCTR ANOP                                                      @U4A 62103000
&OPTERR  SETA  &OPTERR+1                                           @U4A 62141100
   MNOTE 4,'PARAMETERS KEEPSRB AND NKEEPSRB CONFLICT, BOTH DISREGARDED' 62179200
.*                                                                 @U4A 62217300
         AGO  .MODOPTR                                             @U4A 62255400
.* ************ END VTL ADDITIONS ***************                       62293500
.CKDONE  ANOP                                                           62331600
    AIF  ('&OPTCD' EQ '(SYN)' OR '&OPTCD' EQ '(ASY)').GOSET             62369700
    AIF  ('&OPTCD' EQ 'SYN' OR '&OPTCD' EQ 'ASY').GOSET                 62407800
         AGO  .GOSET1                                                   62445900
.GOSET   ANOP                                                           62484000
&NUM     SETA N'&OPTCD                                                  62522100
         AIF  ('&NUM' EQ '1').CKSEQNO                                   62560200
.GOSET1  ANOP                                                           62598300
    AIF  ('&OPTERR' GT '0').SETERR                                      62636400
    AIF  ('&MSK1CTR' GT '0' AND '&MSK2CTR' GT '0').GOSET2               62674500
    AIF  ('&MSK1CTR' GT '0').GOSET2A                                    62712600
    AIF  ('&MSK2CTR' GT '0').GOSET2B                                    62750700
.GOSET34 ANOP                                                           62788800
    AIF  ('&MSK3CTR' GT '0' AND '&MSK4CTR' GT '0').GOSET3               62826900
    AIF  ('&MSK3CTR' GT '0').GOSET3A                                    62865000
    AIF  ('&MSK4CTR' GT '0').GOSET3B                                    62903100
    AGO  .CKSEQNO                                                       62941200
.GOSET2  ANOP                                                           62979300
         B     *+14                                                @B1C 63017400
.OPTMSK1 ANOP                                                           63055500
*  OPTMSK FOR OR                                                        63093600
         DC    &OPT4X                                              @I1C 63131700
*                                        OPTCD BYTE 4              @B1A 63169800
         DC    B'&CS&NOTIFY&PASS&NERASE&EAU&ERASE&ANY&CONDCS'           63207900
*                                        OPTCD BYTE 5              @W1C 63246000
         DC    B'&BLK&LBM&LBT&COND&UNCOND&LOCK&BUFFLST&CONTCHN'         63284100
*                                        OPTCD BYTE 6          @D5B4747 63322200
         DC    B'&CONALL&CONANY&BACKUP&Q&BIT0&RELRQ&BIT0&LMPEO'         63360300
*                                        OPTCD BYTE 7          @R489306 63398400
         DC    B'&ACQUIRE&ACCEPT&BIT0&PEND&MXSES&ACTIVE&UNCONDL&USERRH' 63448400
*                                        OPTCD BYTE 8     @D5B4747 @D1C 63498400
.OPTMSK2 ANOP                                                           63550800
*  OPTMSK FOR AND                                                       63588900
         DC    X'00'                                               @I1C 63627000
*                                        OPTCD BYTE 4              @B1A 63665100
         DC    B'&CS1&NOTIFY1&PASS1&NERASE1&EAU1&ERASE1&ANY1&CONDCS1'   63703200
*                                        OPTCD BYTE 5              @W1C 63741300
         DC    B'&BLK1&LBM1&LBT1&COND1&UNCOND1&LOCK1&BUFLST1&CNTCHN1'   63779400
*                                        OPTCD BYTE 6          @D5B4747 63817500
         DC    B'&CONALL1&CONANY1&BACKUP1&NQ1&BIT01&NRELRQ1&BIT01&LMPEOX63855600
               1'                                                       63893700
*                                        OPTCD BYTE 7          @R489306 63931800
         DC    B'&ACQUIR1&ACCEPT1&BIT01&PEND1&MXSES1&ACTIVE1&UNCNDL1&USX63969900
               ERRH1'                                                   64008000
*                                        OPTCD BYTE 8     @D5B4747 @D1C 64046100
         NC    &POPTCD2.(4,1),*-4   TURN OFF UNNECESSARY OPTCD SWITCHES 64084200
         OC    &POPTCD2.(4,1),*-15  TURN ON NEW SET OF OPTCD SWITCHES   64122300
*                                                                  @V1C 64160400
         NC    &PLOPT4.(1,1),*-17   TURN OFF UNNECESSARY OPTCD SWITCHES 64198500
*                                                                  @V1C 64236600
         OC    &PLOPT4.(1,1),*-28   TURN ON NEW SET OF OPTCD SWITCHES   64274700
*                                                                  @V1C 64312800
         AGO   .GOSET34                                                 64350900
.GOSET2A ANOP                                                           64389000
         B     *+10                                                @B1C 64427100
.OPT1MSK ANOP                                                           64465200
*  OPTMSK FOR OR                                                        64503300
         DC    &OPT4X                                              @I1C 64541400
*                                        OPTCD BYTE 4              @B1A 64579500
         DC    B'&CS&NOTIFY&PASS&NERASE&EAU&ERASE&ANY&CONDCS'           64617600
*                                        OPTCD BYTE 5              @W1C 64655700
         DC    B'&BLK&LBM&LBT&COND&UNCOND&LOCK&BUFFLST&CONTCHN'         64693800
*                                        OPTCD BYTE 6          @D5B4747 64731900
         DC    B'&CONALL&CONANY&BACKUP&Q&BIT0&RELRQ&BIT0&LMPEO'         64770000
*                                        OPTCD BYTE 7          @R489306 64808100
         DC    B'&ACQUIRE&ACCEPT&BIT0&PEND&MXSES&ACTIVE&UNCONDL&USERRH' 64858100
*                                        OPTCD BYTE 8     @D5B4747 @D1C 64908100
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A 64960500
*                                        FILLER FOR ALIGNMENT      @B1A 64998600
         OC    &PLOPT4.(1,1),*-6   TURN ON NEW SET OF OPTCD SWITCHES    65036700
*                                                                  @V1C 65074800
         OC    &POPTCD2.(4,1),*-11 TURN ON NEW SET OF OPTCD SWITCHES    65112900
*                                                                  @V1C 65151000
         AGO   .GOSET34                                                 65189100
.GOSET2B ANOP                                                           65227200
         B     *+10                                                @B1C 65265300
.OPT2MSK ANOP                                                           65303400
*  OPTMSK FOR AND                                                       65341500
         DC    X'00'                                               @I1C 65379600
*                                        OPTCD BYTE 4              @B1A 65417700
         DC    B'&CS1&NOTIFY1&PASS1&NERASE1&EAU1&ERASE1&ANY1&CONDCS1'   65455800
*                                        OPTCD BYTE 5              @W1C 65493900
         DC    B'&BLK1&LBM1&LBT1&COND1&UNCOND1&LOCK1&BUFLST1&CNTCHN1'   65532000
*                                        OPTCD BYTE 6          @D5B4747 65570100
         DC    B'&CONALL1&CONANY1&BACKUP1&NQ1&BIT01&NRELRQ1&BIT01&LMPEOX65608200
               1'                                                       65646300
*                                        OPTCD BYTE 7          @R489306 65684400
         DC    B'&ACQUIR1&ACCEPT1&BIT01&PEND1&MXSES1&ACTIVE1&UNCNDL1&USX65722500
               ERRH1'                                                   65760600
*                                        OPTCD BYTE 8     @D5B4747 @D1C 65798700
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A 65836800
*                                        FILLER FOR ALIGNMENT      @B1A 65874900
         NC    &PLOPT4.(1,1),*-6    TURN OFF UNNECESSARY OPTCD SWITCHES 65913000
*                                                                  @V1C 65951100
         NC    &POPTCD2.(4,1),*-11  TURN OFF UNNECESSARY OPTCD SWITCHES 65989200
*                                                                  @V1C 66027300
         AGO   .GOSET34                                                 66065400
.GOSET3  ANOP                                                           66103500
         B     *+14                                                @B1C 66141600
.OPTMSK3 ANOP                                                           66179700
*  OPTMSK FOR OR                                                        66217800
         DC    &OPT4X                                              @I1C 66255900
*                                        OPTCD BYTE 4         @B1A @KFC 66294000
         DC    B'&LGONMSG&DEVCHAR&TERMS&COUNTS&APPSTAT&STATUS&CIDXLAT&TX66332100
               OPLGON'                                             @04C 66370200
*                                        OPTCD BYTE 9                   66408300
         DC    B'&BSCID&DISPLAY&SPARM&SKEY&USERVAR&UNBIND&SONCD&SENSE'  66446400
*                                        OPTCD BYTE 10        @R491100  66484500
         DC    B'&QUIESCE&START&STOP&HOLD&BIT0&MTS&TERMQ&KPSRB'         66522600
*                                        OPTCD BYTE 11        @01C @U4C 66560700
.* *************** VTL ADDITIONS ****************                       66598800
         DC    B'&RSPQUE&KEEP&TRUNC&NIBTK&QSESS&QNOTE&QALL&FMHDR'       66636900
*                                        OPTCD BYTE 12         @R504800 66675000
.* ************ END VTL ADDITIONS ***************                       66713100
.OPTMSK4 ANOP                                                           66751200
*  OPTMSK FOR AND                                                       66789300
         DC    X'00'                                               @I1C 66827400
*                                        OPTCD BYTE 4         @B1A @KFC 66865500
         DC    B'&LGONMS1&DEVCHR1&TERMS1&COUNTS1&APSTAT1&STATUS1&CIDXLTX66903600
               1&TOPLGN1'                                          @04C 66941700
*                                        OPTCD BYTE 9                   66979800
         DC    B'&BSCID1&DISPLY1&SPARM1&SKEY1&USRVAR1&UNBIND1&SONCD1&SEX67017900
               NSE1'                                                    67056000
*                                        OPTCD BYTE 10        @R491100  67094100
         DC    B'&QUIESC1&START1&STOP1&HOLD1&BIT01&MTS1&TERMQ1&KPSRB1'  67132200
*                                        OPTCD BYTE 11        @01C @U4C 67170300
.* *************** VTL ADDITIONS ****************                       67208400
         DC    B'&RSPQUE1&KEEP1&TRUNC1&NIBTK1&QSESS1&QNOTE1&QALL1&FMHDRX67246500
               1'                                                       67284600
*                                        OPTCD BYTE 12         @R504800 67322700
.* ************ END VTL ADDITIONS ***************                       67360800
         NC    &POPTCD3.(4,1),*-4   TURN OFF UNNECESSARY OPTCD SWITCHES 67398900
         OC    &POPTCD3.(4,1),*-15  TURN ON NEW SET OF OPTCD SWITCHES   67437000
*                                                                  @B1C 67475100
         NC    &PLOPT4.(1,1),*-17   TURN OFF UNNECESSARY OPTCD SWITCHES 67513200
*                                                                  @B1A 67551300
         OC    &PLOPT4.(1,1),*-28   TURN ON NEW SET OF OPTCD SWITCHES   67589400
*                                                                  @B1A 67627500
         AGO   .CKSEQNO                                                 67665600
.GOSET3A ANOP                                                           67703700
         B     *+10                                                @B1C 67741800
.OPT3MSK ANOP                                                           67779900
*  OPTMSK FOR OR                                                        67818000
         DC    &OPT4X                                              @I1C 67856100
*                                        OPTCD BYTE 4         @B1A @KFC 67894200
         DC    B'&LGONMSG&DEVCHAR&TERMS&COUNTS&APPSTAT&STATUS&CIDXLAT&TX67932300
               OPLGON'                                             @04C 67970400
*                                        OPTCD BYTE 9                   68008500
         DC    B'&BSCID&DISPLAY&SPARM&SKEY&USERVAR&UNBIND&SONCD&SENSE'  68046600
*                                        OPTCD BYTE 10        @R489306  68084700
         DC    B'&QUIESCE&START&STOP&HOLD&BIT0&MTS&TERMQ&KPSRB'         68122800
*                                        OPTCD BYTE 11        @01C @U4C 68160900
.* *************** VTL ADDITIONS ****************                       68199000
         DC    B'&BIT0&KEEP&TRUNC&NIBTK&BIT0&BIT0&BIT0&FMHDR'           68237100
*                                        OPTCD BYTE 12                  68275200
.* ************ END VTL ADDITIONS ***************                       68313300
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A 68351400
*                                        FILLER FOR ALIGNMENT      @B1A 68389500
         OC    &POPTCD3.(4,1),*-5  TURN ON NEW SET OF OPTCD SWITCHES    68427600
*                                                                  @B1C 68465700
         OC    &PLOPT4.(1,1),*-12  TURN ON NEW SET OF OPTCD SWITCHES    68503800
*                                                                  @B1A 68541900
         AGO   .CKSEQNO                                                 68580000
.GOSET3B ANOP                                                           68618100
         B     *+10                                                @B1C 68656200
.OPT4MSK ANOP                                                           68694300
*  OPTMSK FOR AND                                                       68732400
         DC    X'00'                                               @I1C 68770500
*                                        OPTCD BYTE 4         @B1A @KFC 68808600
         DC    B'&LGONMS1&DEVCHR1&TERMS1&COUNTS1&APSTAT1&STATUS1&CIDXLTX68846700
               1&TOPLGN1'                                          @04C 68884800
*                                        OPTCD BYTE 9                   68922900
         DC    B'&BSCID1&DISPLY1&SPARM1&SKEY1&USRVAR1&UNBIND1&SONCD1&SEX68961000
               NSE1'                                                    68999100
*                                        OPTCD BYTE 10        @R489306  69037200
         DC    B'&QUIESC1&START1&STOP1&HOLD1&BIT01&MTS1&TERMQ1&KPSRB1'  69075300
*                                        OPTCD BYTE 11        @01C @U4C 69113400
.* *************** VTL ADDITIONS ****************                       69151500
         DC    B'&BIT01&KEEP1&TRUNC1&NIBTK1&BIT01&BIT01&BIT01&FMHDR1'   69189600
*                                        OPTCD BYTE 12                  69227700
.* ************ END VTL ADDITIONS ***************                       69265800
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A 69303900
*                                        FILLER FOR ALIGNMENT      @B1A 69342000
         NC    &POPTCD3.(4,1),*-5   TURN OFF UNNECESSARY OPTCD SWITCHES 69380100
*                                                                  @B1C 69418200
         NC    &PLOPT4.(1,1),*-12  TURN OFF NECESSARY OPTCD SWITCHES    69456300
*                                                                  @B1A 69494400
         AGO   .CKSEQNO                                                 69532500
.* *************** VTL ADDITIONS ****************                       69570600
.SETERR  ANOP                                                           69608700
   MNOTE 4,'**********************************************************' 69646800
   MNOTE 4,'**           CONFLICTING OPTCD OPTIONS WERE             **' 69684900
   MNOTE 4,'**     SPECIFIED NO RPL OPTCD PARAMETER MANIPULATIVE    **' 69723000
   MNOTE 4,'**           INSTRUCTIONS WILL BE PRODUCED              **' 69761100
   MNOTE 4,'**********************************************************' 69799200
.*                                                             @P011983 69837300
.* ******************************************************************** 69875400
.*                       MDFYRECD SUBROUTINE                            69913500
.* VALIDITY CHECKS AND GENERATES CODE FOR RECORD MODE RPL OPTIONS.      69951600
.* INVOKES THE FOLLOWING SUBROUTINES: MDFYRESP, MDFYCHN, MDFYCTRL,      69989700
.* MDFYRH3, MDFYSSNS, MDFYRTYP, MDFYIBSQ, MDFYOBSQ, AND OPTSCAN.        70027800
.* ******************************************************************** 70065900
.CKSEQNO ANOP                                                           70104000
         AIF   ('&SEQNO' EQ '').CKIBSQV IS THERE A SEQ. NO. PARM?       70142100
         AIF   ('&SEQNO'(1,1) NE '(').CKSEQN1    REGISTER NOTATION?     70180200
         STH   &SEQNO(1),&PLSEQNO.(1)   PUT SEQ. NO. IN THE RPL         70218300
         AGO   .CKIBSQV                                                 70256400
.CKSEQN1 ANOP                                                           70294500
&CHAR1   SETC  '&SEQNO'(1,2)                                            70332600
&LEN     SETA  K'&SEQNO                                                 70370700
&CHAR2   SETC  '&SEQNO'(&LEN,1)                                         70408800
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ2                              70446900
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ2                              70485000
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ2                              70523100
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ2                              70561200
         AIF   ('&CHAR1' EQ 'A(').IHBCKP2                               70599300
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP2                               70637400
         AIF   ('&CHAR1' EQ 'S(').IHBCKP2                               70675500
         AIF   ('&CHAR1' LT '0').IHBERU2                                70713600
         AIF   ('&CHAR1' LE '9').IHBNUM2                                70751700
         AIF   ('&CHAR1' LT '00').IHBERU2                               70789800
.IHBNUM2 ANOP                                                           70827900
         B     *+6                                                      70866000
         DC    AL2(&SEQNO)         SEQUENCE NUMBER SPECIFIED AS NUMERIC 70904100
         AGO   .CKSEQN2                                                 70942200
.IHBERU2 MNOTE 4,'SEQNO=&SEQNO INVALID - IGNORED'              @P011983 70980300
         AGO   .CKIBSQV                                                 71018400
.IHBCKP2 AIF   ('&CHAR2' EQ ')').IHBGOP2                                71056500
         AGO   .IHBERQ2                                                 71094600
.IHBCKQ2 AIF   ('&CHAR2' EQ '''').IHBGOP2                               71132700
.IHBERQ2 MNOTE 4,SEQNO=&SEQNO INVALID - IGNORED'               @P011983 71170800
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      71208900
.*                                                             @P011983 71247000
         AGO   .CKIBSQV                                                 71285100
.IHBGOP2  ANOP                                                          71323200
&CHAR3   SETC  '&SEQNO'(3,&LEN-3)                                       71361300
&CHAR4   SETC  '&CHAR1'(2,1)                                            71399400
&CHAR1   SETC  '&CHAR1'(1,1)                                            71437500
         B     *+6                                                      71475600
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   SEQUENCE NUMBER FIELD      71513700
.CKSEQN2 ANOP                                                           71551800
         LH    15,*-2                   GET SEQUENCE NUMBER             71589900
         STH   15,&PLSEQNO.(1)          PUT SEQUENCE NUMBER IN THE RPL  71628000
.CKIBSQV ANOP                                                           71666100
         AIF   ('&IBSQVAL' EQ '').CKOBSQV  STSN INBOUND SEQ. NO.?       71704200
         AIF   ('&IBSQVAL'(1,1) NE '(').CKIBSV1  REGISTER NOTATION?     71742300
         STH   &IBSQVAL(1),&PLIBSQV.(1) PUT STSN INBOUND SEQ NO IN RPL  71780400
         AGO   .CKOBSQV                                                 71818500
.CKIBSV1 ANOP                                                           71856600
&CHAR1   SETC  '&IBSQVAL'(1,2)                                          71894700
&LEN     SETA  K'&IBSQVAL                                               71932800
&CHAR2   SETC  '&IBSQVAL'(&LEN,1)                                       71970900
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ3                              72009000
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ3                              72047100
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ3                              72085200
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ3                              72123300
         AIF   ('&CHAR1' EQ 'A(').IHBCKP3                               72161400
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP3                               72199500
         AIF   ('&CHAR1' EQ 'S(').IHBCKP3                               72237600
         AIF   ('&CHAR1' LT '0').IHBERU3                                72275700
         AIF   ('&CHAR1' LE '9').IHBNUM3                                72313800
         AIF   ('&CHAR1' LT '00').IHBERU3                               72351900
.IHBNUM3 ANOP                                                           72390000
         B     *+6                                                      72428100
         DC    AL2(&IBSQVAL)       INBOUND SEQ NO SPECIFIED AS NUMERIC  72466200
         AGO   .CKIBSV2                                                 72504300
.IHBERU3 MNOTE 4,'IBSQVAL=&IBSQVAL INVALID - IGNORED'          @P011983 72542400
         AGO   .CKOBSQV                                                 72580500
.IHBCKP3 AIF   ('&CHAR2' EQ ')').IHBGOP3                                72618600
         AGO   .IHBERQ3                                                 72656700
.IHBCKQ3 AIF   ('&CHAR2' EQ '''').IHBGOP3                               72694800
.IHBERQ3 MNOTE 4,IBSQVAL=&IBSQVAL INVALID - IGNORED'           @P011983 72732900
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      72771000
.*                                                             @P011983 72809100
         AGO   .CKOBSQV                                                 72847200
.IHBGOP3  ANOP                                                          72885300
         B     *+6                                                      72923400
&CHAR3   SETC  '&IBSQVAL'(3,&LEN-3)                                     72961500
&CHAR4   SETC  '&CHAR1'(2,1)                                            72999600
&CHAR1   SETC  '&CHAR1'(1,1)                                            73037700
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   INBOUND SEQ NO FIELD       73075800
.CKIBSV2 ANOP                                                           73113900
         LH    15,*-2                   GET STSN INBOUND SEQ NO         73152000
         STH   15,&PLIBSQV.(1)          PUT STSN INBOUND SEQ NO IN RPL  73190100
.CKOBSQV ANOP                                                           73228200
         AIF   ('&OBSQVAL' EQ '').CKRESPO    STSN OUTBOUND SEQ. NO.?    73266300
         AIF   ('&OBSQVAL'(1,1) NE '(').CKOBSV1   REGISTER NOTATION?    73304400
         STH   &OBSQVAL(1),&PLOBSQV.(1) PUT STSN OUTBOUND SEQ NO IN RPL 73342500
         AGO   .CKRESPO                                                 73380600
.CKOBSV1  ANOP                                                          73418700
&CHAR1   SETC  '&OBSQVAL'(1,2)                                          73456800
&LEN     SETA  K'&OBSQVAL                                               73494900
&CHAR2   SETC  '&OBSQVAL'(&LEN,1)                                       73533000
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ4                              73571100
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ4                              73609200
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ4                              73647300
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ4                              73685400
         AIF   ('&CHAR1' EQ 'A(').IHBCKP4                               73723500
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP4                               73761600
         AIF   ('&CHAR1' EQ 'S(').IHBCKP4                               73799700
         AIF   ('&CHAR1' LT '0').IHBERU4                                73837800
         AIF   ('&CHAR1' LE '9').IHBNUM4                                73875900
         AIF   ('&CHAR1' LT '00').IHBERU4                               73914000
.IHBNUM4 ANOP                                                           73952100
         B     *+6                                                      73990200
         DC    AL2(&OBSQVAL)      OUTBOUND SEQ NO SPECIFIED AS NUMERIC  74028300
         AGO   .CKOBSV2                                                 74066400
.IHBERU4 MNOTE 4,'OBSQVAL=&OBSQVAL INVALID - IGNORED'          @P011983 74104500
         AGO   .CKRESPO                                                 74142600
.IHBCKP4 AIF   ('&CHAR2' EQ ')').IHBGOP4                                74180700
         AGO   .IHBERQ4                                                 74218800
.IHBCKQ4 AIF   ('&CHAR2' EQ '''').IHBGOP4                               74256900
.IHBERQ4 MNOTE 4,OBSQVAL=&OBSQVAL INVALID - IGNORED'           @P011983 74295000
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      74333100
.*                                                             @P011983 74371200
         AGO   .CKRESPO                                                 74409300
.IHBGOP4  ANOP                                                          74447400
&CHAR3   SETC  '&OBSQVAL'(3,&LEN-3)                                     74485500
&CHAR4   SETC  '&CHAR1'(2,1)                                            74523600
&CHAR1   SETC  '&CHAR1'(1,1)                                            74561700
         B     *+6                                                      74599800
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   OUTBOUND SEQ NO FIELD      74637900
.CKOBSV2 ANOP                                                           74676000
         LH    15,*-2                   GET STSN OUTBOUND SEQ NO        74714100
         STH   15,&PLOBSQV.(1)         PUT STSN OUTBOUND SEQ NO IN RPL  74752200
.* ******************************************************************** 74790300
.*                      MDFYRESP SUBROUTINE                             74828400
.* INVOKES OPTSCAN TO CHECK FOR INVALID RESPOND OPTIONS.  GENERATES     74866500
.* CODE TO MODIFY THE RESPOND FIELD IN THE RPL AND MNOTES WHEN MUTUALLY 74904600
.*                EXCLUSIVE OPTIONS ARE SPECIFIED                       74942700
.* THIS SECTION REWRITTEN FOR QRESP SUPPORT                    @D434436 74980800
.* ******************************************************************** 75018900
.CKRESPO ANOP                                                           75057000
         AIF ('&RESPOND' EQ '').CKPOST  RESPOND OPTION SPECIFIED?       75095100
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                75133200
&IHBTBL(1)  SETC  'NQRESP'                                              75171300
&IHBTBL(2)  SETC  'QRESP'                                               75209400
&IHBTBL(3)  SETC  'NEX'                                                 75247500
&IHBTBL(4)  SETC  'EX'                                                  75285600
&IHBTBL(5)  SETC  'FME'                                                 75323700
&IHBTBL(6)  SETC  'NFME'                                                75361800
&IHBTBL(7)  SETC  'NRRN'                                                75399900
&IHBTBL(8)  SETC  'RRN'                                                 75438000
&IHBNUM  SETA  8                                                        75476100
         IHBRDWRA SCANOPT=&RESPOND,OPTION=RESPOND     GO TO OPTSCAN     75514200
.CKRESP1 ANOP                           RETURN FROM OPTSCAN             75552300
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKRESP2   NQRESP OR QRESP?  75590400
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKRESP4   NEX OR EX?        75628500
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKRESP6   FME OR NFME?      75666600
         AIF   (&IHBRPLY(7) OR &IHBRPLY(8)).CKRESP8   NRRN OR RRN?      75704700
         AGO   .CKPOST                 NO VALID OPTIONS SPECIFIED       75742800
.CKRESP2 ANOP                                                           75780900
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).RSPERR1  NQRESP AND QRESP? 75819000
         AIF   (&IHBRPLY(1)).CKRESP3        NQRESP SPECIFIED            75857100
         AIF   (&IHBRPLY(2) EQ 0).CKRESP4   QRESP NOT SPECIFIED         75895200
         OI    &PLVTFL2.(1),X'08'       SET RPLQRI ON (RESPOND=QRESP)   75933300
         AGO   .CKRESP4                                                 75971400
.CKRESP3 ANOP                                                           76009500
         NI    &PLVTFL2.(1),X'F7'       SET RPLQRI OFF (RESPOND=NQRESP) 76047600
.CKRESP4 ANOP                                                           76085700
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).RSPERR2  NEX AND EX?       76123800
         AIF   (&IHBRPLY(3)).CKRESP5        NEX SPECIFIED               76161900
         AIF   (&IHBRPLY(4) EQ 0).CKRESP6   NEX NOT SPECIFIED           76200000
         OI    &PLVTFL2.(1),X'04'       SET RPLEX ON (RESPOND=EX)       76238100
         AGO   .CKRESP6                                                 76276200
.CKRESP5 ANOP                                                           76314300
         NI    &PLVTFL2.(1),X'FB'       SET RPLEX OFF (RESPOND=NEX)     76352400
.CKRESP6 ANOP                                                           76390500
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).RSPERR3  FME AND NFME?     76428600
         AIF   (&IHBRPLY(5)).CKRESP7    FME SPECIFIED                   76466700
         AIF   (&IHBRPLY(6) EQ 0).CKRESP8   NFME NOT SPECIFIED          76504800
         OI    &PLVTFL2.(1),X'02'       SET RPLNFME ON (RESPOND=NFME)   76542900
         AGO   .CKRESP8                                                 76581000
.CKRESP7 ANOP                                                           76619100
         NI    &PLVTFL2.(1),X'FD'       SET RPLNFME OFF (RESPOND=FME)   76657200
.CKRESP8 ANOP                                                           76695300
         AIF   (&IHBRPLY(7) AND &IHBRPLY(8)).RSPERR4  RRN AND NRRN?     76733400
         AIF   (&IHBRPLY(7)).CKRESP9    NRRN SPECIFIED                  76771500
         AIF   (&IHBRPLY(8) EQ 0).CKPOST    RRN NOT SPECIFIED           76809600
         OI    &PLVTFL2.(1),X'01'       SET RPLRRN ON (RESPOND=RRN)     76847700
         AGO   .CKPOST                                                  76885800
.CKRESP9 ANOP                                                           76923900
         NI    &PLVTFL2.(1),X'FE'       SET RPLRRN OFF (RESPOND=NRRN)   76962000
         AGO   .CKPOST                                                  77000100
.RSPERR1 MNOTE  4,'QRESP AND NQRESP SPECIFIED FOR RESPOND - BOTH IGNORE*77038200
               D'                                              @P011983 77076300
         AGO   .CKRESP4                                                 77114400
.RSPERR2 MNOTE  4,'EX AND NEX SPECIFIED FOR ''RESPOND'' - BOTH IGNORED' 77152500
.*                                                             @P011983 77190600
         AGO   .CKRESP6                                                 77228700
.RSPERR3 MNOTE  4,'FME AND NFME SPECIFIED FOR RESPOND - BOTH IGNORED'   77266800
.*                                                             @P011983 77304900
         AGO   .CKRESP8                                                 77343000
.RSPERR4 MNOTE  4,'RRN AND NRRN SPECIFIED FOR RESPOND - BOTH IGNORED'   77381100
.*                                                             @P011983 77419200
.********************************************************************** 77457300
.*  END OF LOGIC SECTION REWRITTEN FOR RPL QRESP SUPPORT       @D434436 77495400
.********************************************************************** 77533500
.CKPOST  ANOP                                                           77571600
         AIF   ('&POST' EQ '').CKCHAIN  IS THERE A POST PARM?           77609700
         AIF   ('&POST' EQ 'SCHED').PSTSKED                             77647800
         AIF   ('&POST' EQ 'RESP').PSTRESP                              77685900
         MNOTE 4,'POST=&POST INVALID--IGNORED'                 @P011983 77724000
         AGO   .CKCHAIN                                                 77762100
.PSTSKED ANOP                                                           77800200
         OI    &PLVTFL2.(1),X'80'     SET RPLSCHED FLAG ON (POST=SCHED) 77838300
         AGO   .CKCHAIN                                                 77876400
.PSTRESP ANOP                                                           77914500
         NI    &PLVTFL2.(1),X'7F'     SET RPLSCHED FLAG OFF (POST=RESP) 77952600
.* ******************************************************************** 77990700
.*                        MDFYCHN SUBROUTINE                            78028800
.* GENERATES CODE TO MODIFY THE CHAIN FIELD IN THE RPL.  ISSUES MNOTES  78066900
.* FOR BOTH MUTUALLY EXCLUSIVE AND INVALID OPTIONS.                     78105000
.* ******************************************************************** 78143100
.CKCHAIN ANOP                                                           78181200
         AIF   ('&CHAIN' EQ '').CKCTRL  CHAIN OPTION SPECIFIED?         78219300
         AIF   ('&CHAIN' EQ 'FIRST').CKCHN1                             78257400
         AIF   ('&CHAIN' EQ 'MIDDLE').CKCHN2                            78295500
         AIF   ('&CHAIN' EQ 'LAST').CKCHN3                              78333600
         AIF   ('&CHAIN' EQ 'ONLY').CKCHN4                              78371700
         MNOTE 4,'CHAIN=&CHAIN INVALID - IGNORED'              @P011983 78409800
         AGO   .CKCTRL                                                  78447900
.CKCHN1  ANOP                                                           78486000
         OI    &PLCHN.(1),X'80'         SET RPLFIRST ON (CHAIN=FIRST)   78524100
         NI    &PLCHN.(1),X'8F'         SET OTHER BITS IN FIELD OFF     78562200
         AGO   .CKCTRL                                                  78600300
.CKCHN2  ANOP                                                           78638400
         OI    &PLCHN.(1),X'40'         SET RPLMIDLE ON (CHAIN=MIDDLE)  78676500
         NI    &PLCHN.(1),X'4F'         SET OTHER BITS IN FIELD OFF     78714600
         AGO   .CKCTRL                                                  78752700
.CKCHN3  ANOP                                                           78790800
         OI    &PLCHN.(1),X'20'         SET RPLLAST ON (CHAIN=LAST)     78828900
         NI    &PLCHN.(1),X'2F'         SET OTHER BITS IN FIELD OFF     78867000
         AGO   .CKCTRL                                                  78905100
.CKCHN4  ANOP                                                           78943200
         OI    &PLCHN.(1),X'10'         SET RPLONLY ON (CHAIN=ONLY)     78981300
         NI    &PLCHN.(1),X'1F'         SET OTHER BITS IN FIELD OFF     79019400
.* ******************************************************************** 79057500
.*                       MDFYCTRL SUBROUTINE                            79095600
.* GENERATES CODE TO MODIFY THE CONTROL FIELD (RPLCNTRL) IN THE RPL.    79133700
.* ISSUES MNOTE FOR INVALID OPTION.                                     79171800
.* ******************************************************************** 79209900
.CKCTRL ANOP                                                            79248000
         AIF   ('&CONTROL' EQ '').CKCDIR   CONTROL OPTION SPECIFIED?    79286100
         XC    &PLCNTRL.(3,1),&PLCNTRL.(1) SET CONTROL CODES OFF        79324200
         AIF   ('&CONTROL' NE 'DATA').CKCTRL1                           79362300
         OI    &PLCNTDF.(1),X'80'       SET RPLDATA ON (CONTROL=DATA)   79400400
         AGO   .CKCDIR                                                  79438500
.CKCTRL1 ANOP                                                           79476600
         AIF   ('&CONTROL' NE 'CANCEL').CKCTRL2                         79514700
         OI    &PLCNTDF.(1),X'40'      SET RPLCNCEL ON (CONTROL=CANCEL) 79552800
         AGO   .CKCDIR                                                  79590900
.CKCTRL2 ANOP                                                           79629000
         AIF   ('&CONTROL' NE 'QC').CKCTRL3                             79667100
         OI    &PLCNTDF.(1),X'20'       SET RPLQC ON (CONTROL=QC)       79705200
         AGO   .CKCDIR                                                  79743300
.CKCTRL3 ANOP                                                           79781400
         AIF   ('&CONTROL' NE 'QEC').CKCTRL4                            79819500
         OI    &PLCNTDF.(1),X'10'      SET RPLQEC ON (CONTROL=QEC)      79857600
         AGO   .CKCDIR                                                  79895700
.CKCTRL4 ANOP                                                           79933800
         AIF   ('&CONTROL' NE 'CHASE').CKCTRL5                          79971900
         OI    &PLCNTDF.(1),X'08'      SET RPLCHASE ON (CONTROL=CHASE)  80010000
         AGO   .CKCDIR                                                  80048100
.CKCTRL5 ANOP                                                           80086200
         AIF   ('&CONTROL' NE 'RELQ').CKCTRL6                           80124300
         OI    &PLCNTDF.(1),X'04'      SET RPLRELQ ON (CONTROL=RELQ)    80162400
         AGO   .CKCDIR                                                  80200500
.CKCTRL6 ANOP                                                           80238600
         AIF   ('&CONTROL' NE 'BID').CKCTRL9                            80276700
         OI    &PLCNTDC.(1),X'80'      SET RPLBID ON (CONTROL=BID)      80314800
         AGO   .CKCDIR                                                  80352900
.CKCTRL9 ANOP                                                           80391000
         AIF   ('&CONTROL' NE 'RTR').CKCTRLA                            80429100
         OI    &PLCNTDC.(1),X'40'      SET RPLRTR ON (CONTROL=RTR)      80467200
         AGO   .CKCDIR                                                  80505300
.CKCTRLA ANOP                                                           80543400
         AIF   ('&CONTROL' NE 'LUS').CKCTRLB                            80581500
         OI    &PLCNTDC.(1),X'20'      SET RPLLUS ON (CONTROL=LUS)      80619600
         AGO   .CKCDIR                                                  80657700
.CKCTRLB ANOP                                                           80695800
         AIF   ('&CONTROL' NE 'SIGNAL').CKCTRLC                         80733900
         OI    &PLCNTDC.(1),X'10'      SET RPLSIGNL ON (CONTROL=SIGNAL) 80772000
         AGO   .CKCDIR                                                  80810100
.CKCTRLC ANOP                                                           80848200
         AIF   ('&CONTROL' NE 'BIND').CKCTRLD                           80886300
         OI    &PLCNTDC.(1),X'08'      SET RPLTBIND ON (CONTROL=BIND)   80924400
         AGO   .CKCDIR                                                  80962500
.CKCTRLD ANOP                                                           81000600
         AIF   ('&CONTROL' NE 'SBI').CKCTRLE                            81038700
         OI    &PLCNTDC.(1),X'02'      SET RPLSBI ON (CONTROL=SBI)      81076800
         AGO   .CKCDIR                                                  81114900
.CKCTRLE ANOP                                                           81153000
         AIF   ('&CONTROL' NE 'BIS').CKCTRLF                            81191100
         OI    &PLCNTDC.(1),X'01'      SET RPLBIS ON (CONTROL=BIS)      81229200
         AGO   .CKCDIR                                                  81267300
.CKCTRLF ANOP                                                           81305400
         AIF   ('&CONTROL' NE 'SDT').CKCTRLH                            81343500
         OI    &PLCNTSC.(1),X'80'      SET RPLSDT ON (CONTROL=SDT)      81381600
.*                                                           @PI10125   81419700
         AGO   .CKCDIR                                                  81457800
.CKCTRLH ANOP                                                           81495900
         AIF   ('&CONTROL' NE 'CLEAR').CKCTRLI                          81534000
         OI    &PLCNTSC.(1),X'40'      SET RPLCLEAR ON (CONTROL=CLEAR)  81572100
         AGO   .CKCDIR                                                  81610200
.CKCTRLI ANOP                                                           81648300
         AIF   ('&CONTROL' NE 'STSN').CKCTRLJ                           81686400
         OI    &PLCNTSC.(1),X'20'      SET RPLSTSN ON (CONTROL=STSN)    81724500
         AGO   .CKCDIR                                                  81762600
.CKCTRLJ ANOP                                                           81800700
         AIF   ('&CONTROL' NE 'SHUTD').CKCTRLK                          81838800
         OI    &PLCNTSC.(1),X'10'      SET RPLSHUTD ON (CONTROL=SHUTD)  81876900
         AGO   .CKCDIR                                                  81915000
.CKCTRLK ANOP                                                           81953100
         AIF   ('&CONTROL' NE 'SHUTC').CKCTRLL                          81991200
         OI    &PLCNTSC.(1),X'08'      SET RPLSHUTC ON (CONTROL=SHUTC)  82029300
         AGO   .CKCDIR                                                  82067400
.CKCTRLL ANOP                                                           82105500
         AIF   ('&CONTROL' NE 'RQR').CKCTRLM                            82143600
         OI    &PLCNTSC.(1),X'04'      SET RPLRQR ON (CONTROL=RQR)      82181700
         AGO   .CKCDIR                                                  82219800
.CKCTRLM ANOP                                                           82257900
         AIF   ('&CONTROL' NE 'RSHUTD').CKCTRLN                         82296000
         OI    &PLCNTSC.(1),X'02'      SET RPLRSHUT ON (CONTROL=RSHUTD) 82334100
         AGO   .CKCDIR                                                  82372200
.CKCTRLN ANOP                                                           82410300
         AIF   ('&CONTROL' NE 'SWITCH').CKCTRLO                @R489301 82448400
         OI    &PLCNTSC.(1),X'01'      SET RPLSWTCH ON (CONTROL=SWITCH) 82486500
         AGO   .CKCDIR                                         @R489301 82524600
.CKCTRLO ANOP                                                  @R489301 82562700
         MNOTE 4,'CONTROL=&CONTROL INVALID - DATA ASSUMED'     @P011983 82600800
         OI    &PLCNTDF.(1),X'80'       SET RPLDATA ON (DEFAULT)        82638900
.* ******************************************************************** 82677000
.*                     MDFYRH3 SUBROUTINE                               82715100
.*  INVOKES OPTSCAN SUBROUTINE TO CHECK FOR INVALID CHNGDIR & BRACKET   82753200
.*  OPTIONS.  GENERATES CODE TO MODIFY THE CHNGDIR FIELD AND BRACKET    82791300
.*             FIELD (RPLRH3) IN THE RPL.                               82829400
.* ******************************************************************** 82867500
.CKCDIR  ANOP                                                           82905600
         AIF ('&CHNGDIR' EQ '').CKBRCKT  RESPOND OPTION SPECIFIED?      82943700
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                82981800
&IHBTBL(1)  SETC  'NCMD'                                                83019900
&IHBTBL(2)  SETC  'CMD'                                                 83058000
&IHBTBL(3)  SETC  'NREQ'                                                83096100
&IHBTBL(4)  SETC  'REQ'                                                 83134200
&IHBNUM  SETA  4                                                        83172300
         IHBRDWRA  SCANOPT=&CHNGDIR,OPTION=CHNGDIR   GO TO OPTSCAN      83210400
.CKCDIR1 ANOP                           RETURN FROM OPTSCAN             83248500
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKCDIR2     NCMD OR CMD?    83286600
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKCDIR4     NREQ OR REQ?    83324700
         MNOTE  4,'CHANGDIR=&CHNGDIR - INVALID IGNORED'        @P011983 83362800
         AGO   .CKBRCKT                 NO VALID OPTIONS SPECIFIED      83400900
.CKCDIR2 ANOP                                                           83439000
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).CDIRER1   NCMD AND CMD?    83477100
         AIF   (&IHBRPLY(1)).CKCDIR3    NCMD SPECIFIED                  83515200
         OI    &PLRH3.(1),X'20'          SET RPLCMD ON (CHNGDIR=CMD)    83553300
         AGO   .CKCDIR4                                                 83591400
.CKCDIR3 ANOP                                                           83629500
         NI    &PLRH3.(1),X'DF'          SET RPLCMD OFF (CHNGDIR=NCMD)  83667600
.CKCDIR4 ANOP                                                           83705700
         AIF   (NOT(&IHBRPLY(4))).CKBRCKT                    @T4C  @03C 83743800
         MNOTE 8,'CHNGDIR = REQ/NREQ NO LONGER SUPPORTED, IGNORED' @T4C 83781900
         AGO   .CKBRCKT                                                 83820000
.CDIRER1 MNOTE  4,'CMD AND NCMD SPECIFIED FOR CHNGDIR - BOTH IGNORED'   83858100
.*                                                             @P011983 83896200
.CKBRCKT ANOP                                                           83934300
         AIF   ('&BRACKET' EQ '').CKCDSEL  RESPOND OPTION SPECIFIED?    83972400
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                84010500
&IHBTBL(1) SETC  'NBB'                                                  84048600
&IHBTBL(2) SETC  'BB'                                                   84086700
&IHBTBL(3) SETC  'NEB'                                                  84124800
&IHBTBL(4) SETC  'EB'                                                   84162900
&IHBTBL(5) SETC  'NCEB'                                       @P5P8891  84201000
&IHBTBL(6) SETC  'CEB'                                        @P5P8891  84239100
&IHBNUM  SETA  6                                              @P5P8891  84277200
         IHBRDWRA  SCANOPT=&BRACKET,OPTION=BRACKET   GO TO OPTSCAN      84315300
.CKBRCK1 ANOP                           RETURN FROM OPTSCAN             84353400
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKBRCK2     NBB OR BB?      84391500
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKBRCK4     NEB OR EB?      84429600
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKBRCK6     NCEB OR CEB?    84467700
.*                                                            @P5P8891  84505800
         MNOTE  4,'BRACKET=&BRACKET - INVALID IGNORED'         @P011983 84543900
         AGO   .CKCDSEL                 NO VALID OPTIONS SPECIFIED      84582000
.CKBRCK2 ANOP                                                           84620100
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).CBRKER1   NBB AND BB?      84658200
         AIF   (&IHBRPLY(1)).CKBRCK3     NBB SPECIFIED                  84696300
         OI    &PLRH3.(1),X'80'          SET RPLBB ON (BRACKET=BB)      84734400
         AGO   .CKBRCK4                                                 84772500
.CKBRCK3 ANOP                                                           84810600
         NI    &PLRH3.(1),X'7F'          SET RPLBB OFF (BRACKET=NBB)    84848700
.CKBRCK4 ANOP                                                           84886800
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).CBRKER2   NEB AND EB?      84924900
         AIF   (&IHBRPLY(3)).CKBRCK5       NEB SPECIFIED                84963000
         AIF   (&IHBRPLY(4) EQ 0).CKBRCK6   EB NOT SPECIFIED  @P5P8891  85001100
         OI    &PLRH3.(1),X'40'         SET RPLEB ON (BRACKET=EB)       85039200
         AGO   .CKBRCK6                                       @P5P8891  85077300
.CKBRCK5 ANOP                                                           85115400
         NI    &PLRH3.(1),X'BF'         SET RPLEB OFF (BRACKET=NEB)     85153500
.CKBRCK6 ANOP                                                 @P5P8891  85191600
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).CBRKER3  CNEB AND CEB?     85229700
.*                                                            @P5P8891  85267800
         AIF   (&IHBRPLY(5)).CKBRCK7       NEB SPECIFIED      @P5P8891  85305900
         AIF   (&IHBRPLY(6) EQ 0).CKCDSEL   EB NOT SPECIFIED  @P5P8891  85344000
         OI    &PLRH3.(1),X'01'   SET RPLCEB ON (BRACKET=CEB) @P5P8891  85382100
         AGO   .CKCDSEL                                       @D5P8891  85420200
.CKBRCK7 ANOP                                                 @D5P8891  85458300
         NI    &PLRH3.(1),X'FE'  SET RPLCEB OFF (BRACKET=NCEB)@D5P8891  85496400
         AGO   .CKCDSEL                                       @P5P8891  85534500
.CBRKER1 MNOTE  4,'BB AND NBB SPECIFIED FOR BRACKET - BOTH IGNORED'     85572600
.*                                                             @P011983 85610700
         AGO   .CKBRCK4                                                 85648800
.CBRKER2 MNOTE  4,'EB AND NEB SPECIFIED FOR BRACKET - BOTH IGNORED'     85686900
.*                                                             @P011983 85725000
         AGO   .CKBRCK6                                       @P5P8891  85763100
.CBRKER3 MNOTE  4,'CEB AND NCEB SPECIFIED FOR BRACKET - BOTH IGNORED'   85801200
.*                                                             @P011983 85839300
.CKCDSEL ANOP                                                           85877400
         AIF ('&CODESEL' EQ '').CKSSNS  CODESEL OPTION SPECIFIED?       85915500
         AIF ('&CODESEL' EQ 'ALT').CKCDSL1  CODESEL OPTION (ALT)?       85953600
     AIF ('&CODESEL' EQ 'STANDARD').CKCDSL2  CODESEL OPTION (STANDARD)? 85991700
         MNOTE 4,'CODESEL=&CODESEL INVALID - IGNORED'          @P011983 86029800
         AGO   .CKSSNS                                                  86067900
.CKCDSL1 ANOP                                                           86106000
         OI    &PLRH3.(1),X'08'         SET RPLCSI ON (CODESEL=ALT)     86144100
         AGO   .CKSSNS                                                  86182200
.CKCDSL2 ANOP                                                           86220300
         NI    &PLRH3.(1),X'F7'        SET RPLCSI ON (CODESEL=STANDARD) 86258400
.* ******************************************************************** 86296500
.*                     MDFYSSNS SUBROUTINE                              86334600
.*      GENERATES CODE TO MODIFY THE SSENSEO FIELD (RPLSSNSO)           86372700
.*      FIELD IN THE RPL.  ISSUES MNOTE FOR INVALID OPTIONS.            86410800
.* ******************************************************************** 86448900
.CKSSNS  ANOP                                                           86487000
         AIF ('&SSENSEO' EQ '').CKRTYP  SENSE OUTPUT OPTION SPECIFIED?  86525100
         AIF ('&SSENSEO' EQ 'CPM').CKSSNS1                              86563200
         AIF ('&SSENSEO' EQ 'STATE').CKSSNS2                            86601300
         AIF ('&SSENSEO' EQ 'FI').CKSSNS3                               86639400
         AIF ('&SSENSEO' EQ 'RR').CKSSNS4                               86677500
         AIF ('&SSENSEO' EQ '0').CKSSNS5                       @G70AKMC 86715600
         MNOTE 4,'SSENSEO=&SSENSEO INVALID - IGNORED'          @P011983 86753700
         AGO   .CKRTYP                                                  86791800
.CKSSNS1 ANOP                                                           86829900
         MVI   &PLSSEO.(1),X'40'        SET RPLCPMO ON (SSENSEO=CPM)    86868000
         AGO   .CKRTYP                                                  86906100
.CKSSNS2 ANOP                                                           86944200
         MVI   &PLSSEO.(1),X'20'        SET RPLSTATO ON (SSENSEO=STATE) 86982300
         AGO   .CKRTYP                                                  87020400
.CKSSNS3 ANOP                                                           87058500
         MVI   &PLSSEO.(1),X'10'        SET RPLFIO ON (SSENSEO=FI)      87096600
         AGO   .CKRTYP                                                  87134700
.CKSSNS4 ANOP                                                           87172800
         MVI   &PLSSEO.(1),X'08'        SET RPLRRO ON (SSENSEO=RR)      87210900
         AGO   .CKRTYP                                         @G70AKMC 87249000
.CKSSNS5 ANOP                                                  @G70AKMC 87287100
         MVI   &PLSSEO.(1),X'00'     SET RPLRRO ON (SSENSEO=0) @G70AKMC 87325200
.* ******************************************************************** 87363300
.*                 MDFYRTYP SUBROUTINE                                  87401400
.* INVOKES OPTSCAN SUBROUTINE TO CHECK FOR INVALID RTYPE OPTIONS.       87439500
.* GENERATES CODE TO MODIFY THE RTYPE FIELD (RPLRTYPE) FIELD IN THE     87477600
.* RPL.  ISSUES MNOTES FOR MUTUALLY EXCLUSIVE OPTIONS.                  87515700
.* ******************************************************************** 87553800
.CKRTYP  ANOP                                                           87591900
         AIF ('&RTYPE' EQ '').CKIBSQ       RTYPE OPTION SPECIFIED?      87630000
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                87668100
&IHBTBL(1)  SETC  'NRESP'                                               87706200
&IHBTBL(2)  SETC  'RESP'                                                87744300
&IHBTBL(3)  SETC  'NDFSYN'                                              87782400
&IHBTBL(4)  SETC  'DFSYN'                                               87820500
&IHBTBL(5)  SETC  'NDFASY'                                              87858600
&IHBTBL(6)  SETC  'DFASY'                                               87896700
&IHBNUM  SETA  6                                                        87934800
         IHBRDWRA  OPTION=RTYPE,SCANOPT=&RTYPE   GO TO OPTSCAN          87972900
.CKRTYP1 ANOP                           RETURN FROM OPTSCAN             88011000
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKRTYP2    NRESP OR RESP?   88049100
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKRTYP4    NDFSYN OR DFSYN? 88087200
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKRTYP6    DFASY OR NDFASY? 88125300
         AGO   .CKIBSQ                 NO VALID OPTIONS SPECIFIED       88163400
.CKRTYP2 ANOP                                                           88201500
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).RTYERR1    NRESP AND RESP? 88239600
         AIF   (&IHBRPLY(1)).CKRTYP3    NRESP SPECIFIED                 88277700
         OI    &PLSRTYP.(1),X'08'        SET RPLRRESP ON (RTYPE=RESP)   88315800
         AGO   .CKRTYP4                                                 88353900
.CKRTYP3 ANOP                                                           88392000
         NI    &PLSRTYP.(1),X'F7'       SET RPLRRESP OFF (RTYPE=NRESP)  88430100
.CKRTYP4 ANOP                                                           88468200
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).RTYERR2  NDFSYN AND DFSYN? 88506300
         AIF   (&IHBRPLY(3)).CKRTYP5    NDFSYN SPECIFIED                88544400
         AIF   (&IHBRPLY(4) EQ 0).CKRTYP6   DFSYN NOT SPECIFIED         88582500
         NI    &PLSRTYP.(1),X'FB'      SET RPLNFSYN OFF (RTYPE=DFSYN)   88620600
         AGO   .CKRTYP6                                                 88658700
.CKRTYP5 ANOP                                                           88696800
         OI    &PLSRTYP.(1),X'04'      SET RPLNFSYN ON (RTYPE=NDFSYN)   88734900
.CKRTYP6 ANOP                                                           88773000
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).RTYERR3  NDFASY AND DFASY? 88811100
         AIF   (&IHBRPLY(5)).CKRTYP7    NDFASY SPECIFIED                88849200
         AIF   (&IHBRPLY(6) EQ 0).CKIBSQ   DFASY NOT SPECIFIED          88887300
         OI    &PLSRTYP.(1),X'02'      SET RPLDFASY ON (RTYPE=DFASY)    88925400
         AGO   .CKIBSQ                                                  88963500
.CKRTYP7 ANOP                                                           89001600
         NI    &PLSRTYP.(1),X'FD'      SET RPLDFASY OFF (RTYPE=NDFASY)  89039700
         AGO   .CKIBSQ                                                  89077800
.RTYERR1 MNOTE  4,'NRESP AND RESP SPECIFIED FOR RTYPE - BOTH IGNORED'   89115900
.*                                                             @P011983 89154000
         AGO   .CKRTYP4                                                 89192100
.RTYERR2 MNOTE  4,'NDFSYN AND DFSYN SPECIFIED FOR RTYPE - BOTH IGNORED' 89230200
.*                                                             @P011983 89268300
         AGO   .CKRTYP6                                                 89306400
.RTYERR3 MNOTE  4,'DFASY AND NDFASY SPECIFIED FOR RTYPE - BOTH IGNORED' 89344500
.*                                                             @P011983 89382600
.* *******************************************************************  89420700
.*                   MDFYIBSQ SUBROUTINE                                89458800
.* GENERATES CODE TO MODIFY THE IBSQAC FIELD (RPLIBSQ) IN THE RPL.      89496900
.* ISSUES MNOTES FOR INVALID OPTIONS OR IF MORE THAN ONE OPTION IS      89535000
.*                        SPECIFIED.                                    89573100
.* *******************************************************************  89611200
.CKIBSQ  ANOP                                                           89649300
         AIF   ('&IBSQAC' EQ '').CKOBSQ   IBSQAC OPTION SPECIFIED?      89687400
         AIF   ('&IBSQAC' EQ 'SET').CKIBSQ2                             89725500
         AIF   ('&IBSQAC' EQ 'TESTSET').CKIBSQ3                         89763600
         AIF   ('&IBSQAC' EQ 'RESET').CKIBSQ4                           89801700
         AIF   ('&IBSQAC' EQ 'IGNORE').CKIBSQ5                          89839800
         AIF   ('&IBSQAC' EQ 'TESTPOS').CKIBSQ6                         89877900
         AIF   ('&IBSQAC' EQ 'TESTNEG').CKIBSQ7                         89916000
         AIF   ('&IBSQAC' EQ 'INVALID').CKIBSQ8                         89954100
         MNOTE 4,'IBSQAC=&IBSQAC INVALID - IGNORED'            @P011983 89992200
         AGO   .CKOBSQ                                                  90030300
.CKIBSQ2 ANOP                                                           90068400
         MVI   &PLIBSQ.(1),X'80'        SET RPLISET ON (IBSQAC=SET)     90106500
         AGO   .CKOBSQ                                                  90144600
.CKIBSQ3 ANOP                                                           90182700
         MVI   &PLIBSQ.(1),X'40'        SET RPLITST ON (IBSQAC=TESTSET) 90220800
         AGO   .CKOBSQ                                                  90258900
.CKIBSQ4 ANOP                                                           90297000
         MVI   &PLIBSQ.(1),X'20'        SET RPLIRSET ON (IBSQAC=RESET)  90335100
         AGO   .CKOBSQ                                                  90373200
.CKIBSQ5 ANOP                                                           90411300
         MVI   &PLIBSQ.(1),X'10'        SET RPLIIGN ON (IBSQAC=IGNORE)  90449400
         AGO   .CKOBSQ                                                  90487500
.CKIBSQ6 ANOP                                                           90525600
         MVI   &PLIBSQ.(1),X'08'        SET RPLIPOS ON (IBSQAC=TESTPOS) 90563700
         AGO   .CKOBSQ                                                  90601800
.CKIBSQ7 ANOP                                                           90639900
         MVI   &PLIBSQ.(1),X'04'        SET RPLINEG ON (IBSQAC=TESTNEG) 90678000
         AGO   .CKOBSQ                                                  90716100
.CKIBSQ8 ANOP                                                           90754200
         MVI   &PLIBSQ.(1),X'02'        SET RPLIINV ON (IBSQAC=INVALID) 90792300
.* *******************************************************************  90830400
.*                   MDFYOBSQ SUBROUTINE                                90868500
.* GENERATES CODE TO MODIFY THE 0BSQAC FIELD (RPLOBSG) IN THE RPL.      90906600
.* ISSUES MNOTES FOR INVALID OPTIONS OR IF MORE THAN ONE OPTION IS      90944700
.*                        SPECIFIED.                                    90982800
.* *******************************************************************  91020900
.CKOBSQ  ANOP                                                           91059000
         AIF   ('&OBSQAC' EQ '').CKUSENS  OBSQAC OPTION SPECIFIED?      91097100
         AIF   ('&OBSQAC' EQ 'SET').CKOBSQ2                             91135200
         AIF   ('&OBSQAC' EQ 'TESTSET').CKOBSQ3                         91173300
         AIF   ('&OBSQAC' EQ 'RESET').CKOBSQ4                           91211400
         AIF   ('&OBSQAC' EQ 'IGNORE').CKOBSQ5                          91249500
         AIF   ('&OBSQAC' EQ 'TESTPOS').CKOBSQ6                         91287600
         AIF   ('&OBSQAC' EQ 'TESTNEG').CKOBSQ7                         91325700
         AIF   ('&OBSQAC' EQ 'INVALID').CKOBSQ8                         91363800
         MNOTE 4,'OBSQAC=&OBSQAC INVALID - IGNORED'            @P011983 91401900
         AGO   .CKUSENS                                                 91440000
.CKOBSQ2 ANOP                                                           91478100
         MVI   &PLOBSQ.(1),X'80'        SET RPLOSET ON (OBSQAC=SET)     91516200
         AGO   .CKUSENS                                                 91554300
.CKOBSQ3 ANOP                                                           91592400
         MVI   &PLOBSQ.(1),X'40'        SET RPLOTST ON (OBSQAC=TESTSET) 91630500
         AGO   .CKUSENS                                                 91668600
.CKOBSQ4 ANOP                                                           91706700
         MVI   &PLOBSQ.(1),X'20'        SET RPLORSET ON (OBSQAC=RESET)  91744800
         AGO   .CKUSENS                                                 91782900
.CKOBSQ5 ANOP                                                           91821000
         MVI   &PLOBSQ.(1),X'10'        SET RPLOIGN ON (OBSQAC=IGNORE)  91859100
         AGO   .CKUSENS                                                 91897200
.CKOBSQ6 ANOP                                                           91935300
         MVI   &PLOBSQ.(1),X'08'        SET RPLOPOS ON (OBSQAC=TESTPOS) 91973400
         AGO   .CKUSENS                                                 92011500
.CKOBSQ7 ANOP                                                           92049600
         MVI   &PLOBSQ.(1),X'04'        SET RPLONEG ON (OBSQAC=TESTNEG) 92087700
         AGO   .CKUSENS                                                 92125800
.CKOBSQ8 ANOP                                                           92163900
         MVI   &PLOBSQ.(1),X'02'        SET RPLOINV ON (OBSQAC=INVALID) 92202000
.* ******************************************************************** 92240100
.*               CONTINUATION OF MDFYRECD SUBROUTINE                    92278200
.*              (TO CHECK USENSEO AND STYPE OPERANDS)                   92316300
.* ******************************************************************** 92354400
.CKUSENS ANOP                                                           92392500
         AIF   ('&USENSEO' EQ '').CKSIGDA IS THERE A USER SENSE PARM?   92430600
         AIF   ('&USENSEO'(1,1) NE '(').CKUSEN1    REGISTER NOTATION?   92468700
         STH   &USENSEO(1),&PLUSNSO.(1)   PUT USER SENSE IN THE RPL     92506800
         AGO   .CKSIGDA                                                 92544900
.CKUSEN1 ANOP                                                           92583000
&CHAR1   SETC  '&USENSEO'(1,2)                                          92621100
&LEN     SETA  K'&USENSEO                                               92659200
&CHAR2   SETC  '&USENSEO'(&LEN,1)                                       92697300
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ5                              92735400
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ5                              92773500
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ5                              92811600
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ5                              92849700
         AIF   ('&CHAR1' EQ 'A(').IHBCKP5                               92887800
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP5                               92925900
         AIF   ('&CHAR1' EQ 'S(').IHBCKP5                               92964000
         AIF   ('&CHAR1' LT '0').IHBERU5                                93002100
         AIF   ('&CHAR1' LE '9').IHBNUM5                                93040200
         AIF   ('&CHAR1' LT '00').IHBERU5                               93078300
.IHBNUM5 ANOP                                                           93116400
         B     *+6                                                      93154500
         DC    AL2(&USENSEO)      USER SENSE BYTE SPECIFIED AS NUMERIC  93192600
         AGO   .CKUSEN2                                                 93230700
.IHBERU5 MNOTE 4,'USENSEO=&USENSEO INVALID - IGNORED'          @P011983 93268800
         AGO   .CKSIGDA                                                 93306900
.IHBCKP5 AIF   ('&CHAR2' EQ ')').IHBGOP5                                93345000
         AGO   .IHBERQ5                                                 93383100
.IHBCKQ5 AIF   ('&CHAR2' EQ '''').IHBGOP5                               93421200
.IHBERQ5 MNOTE 4,USENSEO=&USENSEO INVALID - IGNORED'           @P011983 93459300
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      93497400
.*                                                             @P011983 93535500
         AGO   .CKSIGDA                                                 93573600
.IHBGOP5  ANOP                                                          93611700
&CHAR3   SETC  '&USENSEO'(3,&LEN-3)                                     93649800
&CHAR4   SETC  '&CHAR1'(2,1)                                            93687900
&CHAR1   SETC  '&CHAR1'(1,1)                                            93726000
         B     *+6                                                      93764100
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   USER SENSE BYTE FIELD      93802200
.CKUSEN2 ANOP                                                           93840300
         LH    15,*-2                   GET USER SENSE BYTE             93878400
         STH   15,&PLUSNSO.(1)          PUT USER SENSE BYTE IN THE RPL  93916500
.CKSIGDA ANOP                                                           93954600
         AIF   ('&SIGDATA' EQ '').CKSTYPE IS THERE SIGNAL DATA?         93992700
         AIF   ('&SIGDATA'(1,1) NE '(').CKSIGN1    REGISTER NOTATION?   94030800
         ST    &SIGDATA(1),&PLSIGDA.(1)   PUT SIGNAL DATA IN THE RPL    94068900
         AGO   .CKSTYPE                                                 94107000
.CKSIGN1 ANOP                                                           94145100
&CHAR1   SETC  '&SIGDATA'(1,2)                                          94183200
&LEN     SETA  K'&SIGDATA                                               94221300
         CNOP  0,4                                           @ZA46611   94259400
&CHAR2   SETC  '&SIGDATA'(&LEN,1)                                       94297500
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ6                              94335600
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ6                              94373700
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ6                              94411800
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ6                              94449900
         AIF   ('&CHAR1' EQ 'A(').IHBCKP6                               94488000
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP6                               94526100
         AIF   ('&CHAR1' EQ 'S(').IHBCKP6                               94564200
         AIF   ('&CHAR1' LT '0').IHBERU6                                94602300
         AIF   ('&CHAR1' LE '9').IHBNUM6                                94640400
         AIF   ('&CHAR1' LT '00').IHBERU6                               94678500
.IHBNUM6 ANOP                                                           94716600
         CNOP  0,4                                                      94754700
         B     *+8                                                      94792800
         DC    AL4(&SIGDATA)      SIGNAL DATA SPECIFIED AS NUMERIC      94830900
         AGO   .CKSIGN2                                                 94869000
.IHBERU6 MNOTE 4,'SIGDATA=&SIGDATA INVALID - IGNORED'          @P011983 94907100
         AGO   .CKSTYPE                                                 94945200
.IHBCKP6 AIF   ('&CHAR2' EQ ')').IHBGOP6                                94983300
         AGO   .IHBERQ6                                                 95021400
.IHBCKQ6 AIF   ('&CHAR2' EQ '''').IHBGOP6                               95059500
.IHBERQ6 MNOTE 4,'SIGDATA=&SIGDATA INVALID - IGNORED'          @P011983 95097600
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      95135700
.*                                                             @P011983 95173800
         AGO   .CKSTYPE                                                 95211900
.IHBGOP6  ANOP                                                          95250000
&CHAR3   SETC  '&SIGDATA'(3,&LEN-3)                                     95288100
&CHAR4   SETC  '&CHAR1'(2,1)                                            95326200
&CHAR1   SETC  '&CHAR1'(1,1)                                            95364300
         B     *+8                                                      95402400
         DC    &CHAR1.L4&CHAR4&CHAR3&CHAR2   SIGNAL DATA FIELD          95440500
.CKSIGN2 ANOP                                                           95478600
         L     15,*-4                   GET SIGNAL DATA                 95516700
         ST    15,&PLSIGDA.(1)          PUT SIGNAL DATA IN THE RPL      95554800
.CKSTYPE ANOP                                                           95592900
         AIF   ('&STYPE' EQ '').CKSENMO IS THERE AN STYPE PARM?         95631000
         AIF   ('&STYPE' EQ 'REQ').CKSTYP1                              95669100
         AIF   ('&STYPE' EQ 'RESP').CKSTYP2                             95707200
         MNOTE 4,'STYPE=&STYPE INVALID - IGNORED'              @P011983 95745300
         AGO   .CKSENMO                                                 95783400
.CKSTYP1 ANOP                                                           95821500
         NI    &PLSRTYP.(1),X'7F'       SET RPLSRESP OFF (STYPE=REQ)    95859600
         AGO   .CKSENMO                                                 95897700
.CKSTYP2 ANOP                                                           95935800
         OI    &PLSRTYP.(1),X'80'       SET RPLSRESP ON (STYPE=RESP)    95973900
.CKSENMO ANOP                                                           96012000
         AIF   ('&SSENSMO' EQ '').CKCRYPT USER SENSE PARM?   @D440518   96050100
         AIF   ('&SSENSMO'(1,1) NE '(').CKSSEM1    REGISTER NOTATION?   96088200
         STC   &SSENSMO,&PLSSMO.(1)   PUT USER SENSE IN THE RPL         96126300
         AGO   .CKCRYPT                                      @D440518   96164400
.CKSSEM1 ANOP                                                           96202500
         MVI   &PLSSMO.(1),&SSENSMO   PUT USER SENSE IN THE RPL         96240600
.CKCRYPT ANOP                                                @D440518   96278700
         AIF   ('&CRYPT' EQ '').CKBRNCH CRYPT PARAMETER?     @D440518   96316800
         AIF   ('&CRYPT'(1,3) EQ 'YES').CRYES CRYPT REQUEST? @D440518   96354900
         AIF   ('&CRYPT'(1,2) EQ 'NO').CRYNO CRYPT NON-REQ.? @D440518   96393000
         MNOTE  4,'CRYPT=&CRYPT INVALID-IGNORED'             @D440518   96431100
         AGO   .CKBRNCH                                      @ZM35828   96469200
.CRYES   ANOP                                                @ZM35828   96507300
         OI    &PLEXTDS.(1),X'08'  SET CRYPT REQUEST ON      @XM31389   96545400
         AGO   .CKBRNCH                                      @ZM35828   96583500
.CRYNO   ANOP                                                @ZM35828   96621600
         NI    &PLEXTDS.(1),X'F7'  SET CRYPT OFF             @XM31389   96659700
.* *************** END VTL ADDITIONS **********************             96697800
.CKBRNCH ANOP                                                           96735900
         AIF   ('&BRANCH' EQ '').GENLBL1 IS THERE AN BRANCH PARAMETER?  96774000
         AIF   ('&BRANCH'(1,3) EQ 'YES').BRYES  REGISTER NOTATION?      96812100
         AIF   ('&BRANCH'(1,2) EQ 'NO').BRNO  REGISTER NOTATION?        96850200
         MNOTE 4,'BRANCH=&BRANCH IS NOT A VALID PARAMETER - IGNORED'    96888300
.*                                                           @P011983   96926400
         AGO   .GENLBL1                                                 96964500
.BRYES   ANOP                                                           97002600
         OI    &PLEXTDS.(1),X'02'     SET BRANCH ENTRY BIT ON           97040700
         AGO   .GENLBL1                                                 97078800
.BRNO    ANOP                                                           97116900
         NI    &PLEXTDS.(1),X'FD'     SET BRANCH ENTRY BIT OFF          97155000
.GENLBL1 ANOP                                                           97193100
IHB&SYSNDX  EQU   *                                                     97231200
.GENREQ  ANOP                                                           97269300
         AIF   ('&IHBRW' NE '').OKIBRW  IS THERE AN IHBRW PARAMETER?    97307400
         MNOTE 4,'IHBRW= WAS NOT SPECIFIED'                             97345500
         SR    0,0                   IHBRW NOT SPECIFIED OR INVALID     97383600
         AGO   .ENDRTN                                                  97421700
.OKIBRW  ANOP                                                           97459800
         LA    0,&IHBRW                        LOAD REQUEST CODE        97497900
.ENDRTN  ANOP                                                           97536000
         L     15,&PLDACB.(1)        GET ADDRESS OF ACB                 97574100
         L     15,&ACBRTN.(15)       GET ADDRESS OF INTERFACE RTN       97612200
         BALR  14,15                 GO TO THE INTERFACE ROUTINE        97650300
         MEXIT                                                          97688400
.NORPL   ANOP                                                           97726500
         MNOTE 12,'RPL= WAS NOT SPECIFIED'                              97764600
         MEXIT                                                          97802700
.* *************** VTL ADDITIONS ****************                       97840800
.* ******************************************************************** 97878900
.*                          OPTSCAN SUBROUTINE                          97917000
.* SCANS ANY SET OF OPTIONS AGAINST A TABLE OF VALID VALUES AND SETS    97955100
.* BITS IN A REPLY FIELD FOR EACH VALID OPTION FOUND.  GENERATES AN     97993200
.* MNOTE FOR EACH OPTION NOT IN THE TABLE OR SPECIFIED MORE THAN ONCE.  98031300
.* THE CALLING SUBROUTINE MUST CHECK TO SEE IF MUTUALLY EXCLUSIVE       98069400
.* OPTIONS HAVE BEEN SPECIFIED SINCE OPTSCAN CANNOT.  THE CALLING       98107500
.* SUBROUTINE MUST PASS THE VALID VALUES FOR THE OPTION TO BE CHECKED   98145600
.* IN THE ORDER IN WHICH THE REPLY BITS ARE TO BE SET (LEFT-TO RIGHT)   98183700
.* IN A TABLE UNDER THE NAME '&IHBTBL' AND HAVE EACH ENTRY IN THE       98221800
.* TABLE IN AN EIGHT-BYTE FIELD PADDED TO THE RIGHT.  THE NUMBER OF     98259900
.* ENTRIES IN THE TABLE MUST BE IN A FIELD CALLED '&IHBNUM'.  THE       98298000
.* SUBROUTINE IS CALLED BY INVOKING IHBRDWRA RECURSIVELY USING THE      98336100
.* OPERANDS 'SCANOPT' TO PASS THE OPTIONS SPECIFIED BY THE USER AND     98374200
.* 'OPTION' TO INDICATE THE NAME OF THE PARAMETER WHOSE OPERANDS ARE    98412300
.* BEING VALIDATED.  THE OPTSCAN SUBROUTINE WILL SET THE BITS IN A      98450400
.* FIELD CALLED '&IHBRPLY' ON IF AN OPTION IS PRESENT, THE BITS BEING   98488500
.* REPRESENTED IN THE SAME LEFT-TO-RIGHT ORDER AS WERE THE ENTRIES      98526600
.*                    IN THE FIELD '&IHBTBL'.                           98564700
.* ******************************************************************** 98602800
.OPTSCAN ANOP                                                           98640900
&NUM2    SETA  &IHBNUM                                                  98679000
&NUM     SETA  &IHBNUM                                                  98717100
&NM      SETA  N'&SCANOPT                                               98755200
.OPTSCN1 ANOP                                                           98793300
&IHBRPLY(&NUM2)  SETB  0                LOOP TO INITIALIZE              98831400
&NUM2    SETA  &NUM2-1                    REPLY FIELD                   98869500
         AIF   (&NUM2 GT 0).OPTSCN1                                     98907600
.OPTSCN2 ANOP                                                           98945700
&LEN     SETA  K'&SCANOPT(&NM)      NUMBER OF CHARS IN VALUE            98983800
         AIF   (&LEN EQ 0).REINDEX  IGNORE IF NULL PARAMETER   @OY06517 99021900
&OPT     SETC  '&SCANOPT(&NM)'                                          99060000
.OPTSCN3 ANOP                                                           99098100
         AIF ('&OPT' NE '&IHBTBL(&NUM)'(1,&LEN)).RESCAN                 99136200
         AIF   (&IHBRPLY(&NUM) EQ 0).SETBIT                             99174300
         MNOTE 4,'&OPTION=&OPT SPECIFIED MORE THAN ONCE - ACCEPTED'     99212400
.*                                                             @P011983 99250500
         AGO   .REINDEX                                                 99288600
.SETBIT  ANOP                                                           99326700
&IHBRPLY(&NUM)  SETB  1       TURN ON BIT IN REPLY FIELD                99364800
         AGO   .REINDEX                                                 99402900
.RESCAN  ANOP                                                           99441000
&NUM  SETA  &NUM-1    SET POINTER TO PREVIOUS ENTRY IN TABLE            99479100
         AIF   (&NUM GT 0).OPTSCN3                                      99517200
         MNOTE 4,'&OPTION=&OPT INVALID - IGNORED'              @P011983 99555300
.REINDEX ANOP                                                           99593400
&NUM     SETA  &IHBNUM                                                  99631500
         AIF   (&NM EQ 1).OPTSCN4     ALL VALUES CHECKED                99669600
&NM      SETA  &NM-1                  DECREMENT VALUE COUNTER           99707700
         AGO   .OPTSCN2                                                 99745800
.OPTSCN4 ANOP                     RETURN TO CALLING SUBROUTINE:         99783900
.* ************ END VTL ADDITIONS ***************                       99822000
         MEND                                                           99860100
