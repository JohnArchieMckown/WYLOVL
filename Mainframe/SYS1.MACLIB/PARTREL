*%/* START OF PL/X COMMENT ENDING ON %MACRO STATEMENT            @L2A   00025000
         MACRO                                                          00050000
&LABEL   PARTREL &DSN=,                                                X00058300
               &MF=,                                                   X00066600
               &MODE=,                                                 X00074900
               &UCB=,                                                  X00083200
               &TIOT=,                                                 X00091500
               &ERASE=,                                                X00099800
               &VSAMTYPE=,                                             X00108100
               &VSAMFMT=,                                              X00116400
               &VSAMCLLR=,                                             X00124700
               &VSAMSEC=,                                              X00133000
               &VSAMTRKS=                                               00141300
.**** START OF SPECIFICATIONS ****************************************  00150000
.*                                                                      00200000
.*$MAC(PARTREL):     PARTREL INTERFACE TO PARTIAL RELEASE               00250000
.*                                                                      00300000
.*DESCRIPTIVE-NAME = PARTREL INTERFACE TO PARTIAL RELEASE               00350000
.*                                                                      00400000
.*PROPRIETARY V3 STATEMENT                                              00425000
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00450000
.*"RESTRICTED MATERIALS OF IBM"                                         00475000
.*5695-DF1                                                              00500000
.*(C) COPYRIGHT 1985  IBM CORP.                                         00525000
.*END PROPRIETARY V3 STATEMENT                                          00562500
.*                                                                      00600000
.*STATUS = DFSMS/MVS 1.5.0                                              00650000
.*                                                                      00700000
.*FUNCTION = THIS MACRO WILL SET UP THE PARTREL PARAMETER LIST TO       00750000
.*     ALLOW THE CALLER TO RELEASE UNUSED SPACE FROM A SEQUENTIAL OR    00800000
.*     PARTITIONED DATA SET.                                            00850000
.*                                                                      00900000
.*NOTES = THE PARTREL CALL TO DADSM IS USED TO RELEASE UNUSED SPACE     00921400
.*     STARTING WITH THE TRACK FOLLOWING THAT DEFINED IN THE FORMAT 1   00942800
.*     DSCB FIELD KNOWN AS DS1LSTAR.  IF THE FORMAT 1 DSCB INDICATES    00964200
.*     THAT THE ORIGINAL ALLOCATION WAS IN CYLINDER ALLOCATION, THE     00985600
.*     DS1LSTAR VALUE WILL BE INCREMENTED TO THE NEXT CYLINDER          01007000
.*     BOUNDARY.                                                        01028400
.*                                                                      01050000
.*     PARTREL WILL SUPPORT BOTH INDEXED AND NON-INDEXED VTOCS.         01100000
.*                                                                      01200000
.*     THE CALLING PROGRAM:                                             01209000
.*       1. MUST BE APF AUTHORIZED.                                     01218000
.*       2. MUST HAVE ALLOCATED THE VOLUME TO THIS TASK AND ENSURE      01227000
.*          IT WILL STAY MOUNTED DURING THE PARTREL FUNCTION.           01236000
.*       3. MUST ENSURE THAT THE REQUESTED DATA SET IS NOT OPEN.        01245000
.*       4. MUST NOT BE HOLDING ANY LOCKS.                              01254000
.*       5. MUST PROVIDE THE ADDRESS OF AN AVAILABLE STANDARD REGISTER  01263000
.*          SAVE AREA IN GENERAL REGISTER 13.                           01272000
.*       6. MAY BE SET TO ANY STORAGE KEY.                              01281000
.*       7. MAY BE IN EITHER SUPERVISOR OR PROBLEM PROGRAM STATE.       01290000
.*                                                                      01300000
.*     THE USER MAY INCLUDE THE CVAFTBL MAPPING MACRO (ICVAFPRM) IN     01350000
.*     THEIR PROGRAM AND TEST THE CVFDFPFT FIELD.  IF CVFPREL IS ON,    01400000
.*     THE PARTREL FUNCTION IS SUPPORTED.                               01450000
.*                                                                      01500000
.*     THE PARTIAL RELEASE WILL FAIL IF THE DATA SET NAME CAN NOT BE    01502900
.*     ENQUEUED EXCLUSIVELY (TIOT=ENQ) OR IF THE DATA SET NAME IS  @01C 01504800
.*     NOT ALREADY ENQEUED EXCLUSIVELY (TIOT=NOENQ).               @01A 01506700
.*                                                                      01508700
.*     IF 'TTR' OF THE DS1LSTAR FIELD IS ZERO AND THE DATA SET IS       01511600
.*     SEQUENTIAL, ALL SPACE IS RELEASED.                               01514500
.*                                                                      01517400
.*     'ADDR', IN KEYWORD=ADDR | MF=(E,ADDR)                            01520300
.*             MUST BE SPECIFIED AS A LABEL OF AN AREA.                 01523200
.*             THIS LABEL MUST REPRESENT A VALID RX-TYPE ADDRESS        01526100
.*             WHEN USED IN THE MACRO'S EXECUTE-FORM, AND A VALID       01529000
.*             A-TYPE ADDRESS WHEN USED IN THE MACRO'S LIST-FORM.       01531900
.*                                                                      01534800
.*     'REG', IN KEYWORD=(REG) | MF=(E,(REG))                           01537700
.*             MAY BE SPECIFIED AS ANY REGISTER, 2 - 12.                01540600
.*                                                                      01543500
.*                                                                      01546400
.*KEYWORDS APPLICABLE TO THE PARTREL MACRO ARE:                         01550000
.*                                                                      01600000
.*  MF=        THE 'MF' KEYWORD IS REQUIRED.  IT'S SUB-PARAMETERS WILL  01641600
.*             DETERMINE WHETHER THE PARTREL PARAMETER LIST IS EXPANDED 01683200
.*             AND/OR EXECUTABLE INSTRUCTIONS ARE GENERATED TO INVOKE   01724800
.*             DADSM PARTIAL RELEASE.  THE FOLLOWING SUB-PARAMETERS ARE 01766400
.*             VALID FOR THE 'MF' KEYWORD:                              01808000
.*                                                                      01850000
.*  MF=D       THE SPECIFICATION OF MF=D WILL RESULT IN THE EXPANSION   01900000
.*             OF THE PARAMETER LIST IN DSECT FORMAT WITH LABELS FOR    02000000
.*             EACH OF THE FIELDS IN THE PARAMETER LIST.  IN THIS FORM  02016600
.*             OF THE MACRO, NO OTHER MACRO PARAMETERS WILL APPLY (IF   02033200
.*             THEY ARE SPECIFIED, THEY WILL BE IGNORED AND AN MNOTE    02049800
.*             ISSUED).  THIS FORM OF THE MACRO WILL NOT GENERATE THE   02066400
.*             LOAD, BRANCH, DELETE SEQUENCE FOR DADSM PARTIAL RELEASE. 02083000
.*                                                                      02100000
.*  MF=(E,ADDR) | MF=(E,(REG)) | MF=(E,(1))                             02110000
.*             THE SPECIFICATION OF ANY OF THE ABOVE FORMATS FOR THE    02120000
.*             'MF' KEYWORD WILL RESULT IN THE MODIFICATION OF AN       02130000
.*             EXISTING PARAMETER LIST.  THE ADDRESS OF THE PARAMETER   02140000
.*             LIST IS PROVIDED VIA THE SECOND SUB-PARAMETER ('ADDR',   02150000
.*             'REG', OR '1').  THIS SPECIFICATION WILL ALSO RESULT IN  02160000
.*             THE GENERATION OF A LOAD FOR, BRANCH TO, AND DELETE OF   02170000
.*             THE DADSM PARTIAL RELEASE ENTRY POINT MODULE. THIS       02180000
.*             SPECIFICATION IS CALLED THE EXECUTE-FORM OF THE MACRO.   02190000
.*                                                                      02200000
.*  MF=L       THE SPECIFICATION OF MF=L WILL RESULT IN THE EXPANSION   02250000
.*             OF THE PARAMETER LIST AND INITIALIZE IT ACCORDING TO     03100000
.*             THE SPECIFIED KEYWORDS.  HOWEVER, IF A REGISTER IS USED  03150000
.*             INSTEAD OF AN ADDRESS, THE LIST WILL CONTAIN AN ADCON    03200000
.*             SPECIFICATION OF ZERO (AN MNOTE WILL BE ISSUED).  THIS   03225000
.*             FORM OF THE MACRO WILL NOT GENERATE THE LOAD, BRANCH,    03250000
.*             DELETE SEQUENCE FOR DADSM PARTIAL RELEASE.               03275000
.*                                                                      03300000
.*  DSN=ADDR | DSN=(REG)                                                03312500
.*             THE 'DSN' KEYWORD MAY BE USED TO SPECIFY THE ADDRESS     03325000
.*             OF AN AREA WHICH DESCRIBES A DATA SET NAME.              03337500
.*             THIS PARAMETER WILL NOT APPLY TO THE DSECT-FORM OF THIS  03350000
.*             MACRO.  IF THE LIST-FORM IS REQUESTED, THE 'REG' FORMAT  03362500
.*             FOR THIS PARAMETER WILL NOT APPLY.                       03375000
.*             'ADDR', IN DSN=ADDR, MUST BE SPECIFIED AS THE LABEL      03387500
.*                   OF AN AREA WHICH DESCRIBES A DATA SET NAME.        03400000
.*             'REG', IN DSN=(REG), MUST REPRESENT ANY REGISTER,        03412500
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE ADDRESS     03425000
.*                   OF AN AREA WHICH DESCRIBES A DATA SET NAME.        03437500
.*                                                                      03450000
.*  MODE=PGM   THE SPECIFICATION OF MODE=PGM IDENTIFIES THAT THE        03455600
.*             PROGRAM ISSUING THE PARTREL MACRO IS IN PROBLEM PROGRAM  03461200
.*             STATE.  THE PARTREL MACRO WILL DEFAULT TO MODE=PGM       03466800
.*             WHENEVER THE 'MODE' KEYWORD IS NOT CODED AS A PARAMETER. 03472400
.*             DADSM PARTIAL RELEASE WILL RETURN IN PROBLEM PROGRAM     03478000
.*             STATE WHENEVER MODE=PGM IS SPECIFIED OR DEFAULTED.       03483600
.*                                                                      03489200
.*  MODE=SUP   THE SPECIFICATION OF MODE=SUP IDENTIFIES THAT THE        03494800
.*             PROGRAM ISSUING THE PARTREL MACRO IS IN SUPERVISOR       03500400
.*             STATE.  IF PARTREL MODE=SUP IS ISSUED FROM A PROGRAM     03506000
.*             IN PROBLEM PROGRAM STATE, THE REQUESTING PROGRAM IS      03511600
.*             SUBJECT TO ABEND.  OTHERWISE DADSM PARTIAL RELEASE WILL  03517200
.*             RETURN IN SUPERVISOR STATE.                              03522800
.*                                                                      03528400
.*  UCB=(REG)  THE 'UCB' KEYWORD MAY BE USED TO SPECIFY THE ADDRESS     03534000
.*             OF THE UCB WHICH DESCRIBES THE VOLUME UPON WHICH THE     03540000
.*             DATA SET IS TO BE ALLOCATED.                             03570000
.*             THIS PARAMETER WILL ONLY APPLY TO THE EXECUTE-FORM       03600000
.*             OF THIS MACRO.                                           03630000
.*             'REG', IN UCB=(REG), MUST REPRESENT ANY REGISTER,        03660000
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE ADDRESS     03690000
.*                   OF THE UCB.                                        03720000
.*                                                                 @01A 03720800
.*  TIOT=      THE 'TIOT' KEYWORD IS AN OPTIONAL PARAMETER.        @01A 03721600
.*             IT'S SUB-PARAMETERS DETERMINE IF PARTIAL RELEASE    @01A 03722400
.*             SHOULD OBTAIN EXCLUSIVE ENQUES ON SYSZTIOT AND      @01A 03723200
.*             SYSDSN.  THE PARTREL MACRO WILL DEFAULT TO THE      @01A 03724000
.*             SETTING IN THE LIST FORM OF THE PARAMETER LIST IF   @01A 03724800
.*             THE KEYWORD IS OMITTED.                             @01A 03725600
.*                                                                 @01A 03726400
.*  TIOT=ENQ   THE SPECIFICATION OF TIOT=ENQ IDENTIFIES THAT       @01A 03727200
.*             PARTIAL RELEASE WILL OBTAIN EXCLUSIVE ENQUES ON     @01A 03728000
.*             SYSZTIOT AND SYSDSN.  IF EITHER OF THESE EXCLUSIVE  @01A 03728800
.*             ENQUES CANNOT BE OBTAINED, THE REQUEST IS FAILED.   @01A 03729600
.*                                                                 @01A 03730400
.*  TIOT=NOENQ THE SPECIFICATION OF TIOT=NOENQ IDENTIFIES THAT     @01A 03731200
.*             PARTIAL RELEASE WILL NOT OBTAIN THE SYSZTIOT AND    @01A 03732000
.*             SYSDSN ENQUES.  THE CALLER IS REQUIRED TO HOLD AN   @01A 03732800
.*             EXCLUSIVE ENQUE ON SYSDSN.  PARTIAL RELEASE WILL    @01A 03733600
.*             FAIL THE REQUEST IF THIS ENQUE IS NOT ALREADY HELD. @01A 03734400
.*                                                                 @01A 03735200
.*  ERASE=     THE 'ERASE' KEYWORD IS AN OPTIONAL PARAMETER.       @02A 03736000
.*             SUB-PARAMETERS DETERMINE IF PARTIAL RELEASE         @02A 03736800
.*             SHOULD ERASE, NOT ERASE, OR TEST FOR ERASE OF       @02A 03737600
.*             RELEASED SPACE.  THE PARTREL MACRO WILL DEFAULT     @02A 03738400
.*             TO THE SETTINGS IN THE LIST FORM OF THE PARAMETER   @02A 03739200
.*             LIST IF THE KEYWORD IS OMITTED.                     @02A 03740000
.*                                                                 @02A 03740800
.*  ERASE=YES  THE SPECIFICATION OF ERASE=YES IDENTIFIES THAT      @02A 03741600
.*             PARTIAL RELEASE WILL ERASE THE RELEASED SPACE.      @02A 03742400
.*                                                                 @02A 03743200
.*  ERASE=NO   THE SPECIFICATION OF ERASE=NO IDENTIFIES THAT       @02A 03744000
.*             PARTIAL RELEASE WILL NOT ERASE THE RELEASED SPACE.  @02A 03744800
.*                                                                 @02A 03745600
.*  ERASE=TEST THE SPECIFICATION OF ERASE=TEST IDENTIFIED THAT     @02A 03746400
.*             PARTIAL RELEASE WILL ISSUE A RACROUTE TO DETERMINE  @02A 03747200
.*             IF RELEASED SPACE SHOULD BE ERASED.                 @02A 03748000
.*                                                                 @03A 03749000
.*  VSAMTYPE=  THE 'VSAMTYPE' KEYWORD IS AN OPTIONAL PARAMETER     @03A 03750000
.*             SUB-PARAMETERS DETERMINES THE TYPE OF VSAM          @03A 03751000
.*             DATASET.                                            @03A 03752000
.*                                                                 @03A 03753000
.*  VSAMTYPE=YES   DATASET TYPE IS A VSAM DATASET                  @L1C 03753800
.*                 WHICH PARTIAL RELEASE WILL ATTEMPT TO RELESE    @L1C 03754600
.*                 ALLOCATED BUT UNUSED SPACE.                     @L1C 03755400
.*                                                                 @L1C 03756200
.*                                                                 @03A 03757000
.*  VSAMTYPE=ESDS | RRDS | LDS | VRRDS | KSDS                      @L1C 03758000
.*                                                                 @03A 03759000
.*                 DOWNLEVEL COMPATABILITY. SAME AS VSAMTYPE=YES.  @L1C 03759700
.*                 PARTIAL RELEASE WILL ACCEPT THESE FORMS         @L1C 03760400
.*                 OF VSAM DATASETS.                               @L1C 03761100
.*                                                                 @03A 03762000
.*  VSAMFMT=   THE 'VSAMFMT' KEYWORD IS AN OPTIONAL PARAMETER,     @03A 03763000
.*             BUT IS REQUIRED WHEN 'VSAMTYPE' IS ALSO SPECIFIED   @03A 03764000
.*             SUB-PARAMETERS DETERMINE THE FORMAT OF THE          @03A 03765000
.*             REQUESTED VSAM DATASET.                             @03A 03766000
.*                                                                 @03A 03767000
.*  VSAMFMT=EXTD  THIS INDICATES THAT THE REQUESTED VSAM DATASET   @03A 03768000
.*                IS AN EXTENDED FORMAT VSAM DATASET.  PARTIAL     @03A 03769000
.*                RELEASE WILL ATTEMPT TO FREE ALLOCATED BUT       @03A 03770000
.*                UNUSED SPACE.                                    @03A 03771000
.*                                                                 @03A 03772000
.*  VSAMFMT=STD   PARTIAL RELEASE WILL REJECT THIS FORMAT          @03A 03773000
.*                OF VSAM DATASET.                                 @03A 03774000
.*                                                                 @03A 03775000
.*  VSAMCLLR=  THE 'VSAMCALLR' KEYWORD IS AN OPTIONAL PARAMETER,   @03A 03776000
.*             BUT IS REQUIRED WHEN 'VSAMTYPE' IS ALSO SPECIFIED.  @03A 03777000
.*             SUB-PARAMETERS DETERMINE WHO IS THE CALLER OF       @03A 03778000
.*             PARTIAL RELEASE.                                    @03A 03779000
.*                                                                 @03A 03780000
.*  VSAMCLLR=VSAMCLSE                                              @03A 03781000
.*                                                                 @03A 03782000
.*             IF VSAM CLOSE IS SET AND THE CALLER IS              @03A 03783000
.*             AUTHORIZED (KEY < 8) THEN PARTIAL RELEASE WILL      @03A 03784000
.*             CALL CATALOG WITH 'VSAMCLSE' BEING SET.             @03A 03785000
.*                                                                 @03A 03786000
.*             IF VSAM CLOSE IS SET AND THE CALLER IS              @03A 03787000
.*             NOT-AUTORIZDED (KEY=8) THEN PARTIAL RELEASE         @03A 03788000
.*             WILL TURN OFF THE 'VSAMCLSE' BIT AND TURN ON THE    @03A 03789000
.*             NOTVSAM (PRLVCNV) BIT.                              @03A 03790000
.*                                                                 @03A 03791000
.*  VSAMCLLR=NOTVSAM                                               @03A 03792000
.*                                                                 @03A 03793000
.*             WHEN PARTIAL RELEASE CALLS CATALOG SERVICES         @03A 03794000
.*             PARTIAL RELEASE WILL INDICATE THAT THE CALLER OF    @03A 03795000
.*             PARTIAL RELEASE IS NOT VSAM CLOSE.                  @03A 03796000
.*                                                                 @03A 03797000
.*                                                                 @03A 03798000
.*  VSAMSEC=   THE 'VSAMSEC' KEYWORD IS AN OPTIONAL PARAMETER,     @03A 03799000
.*             BUT IS REQUIRED WHEN 'VSAMTYPE' IS ALSO SPECIFIED.  @03A 03800000
.*             SUB-PARAMETERS DETERMINE WHO IS THE CALLER OF       @03A 03801000
.*             PARTIAL RELEASE.                                    @03A 03802000
.*                                                                 @03A 03803000
.*  VSAMSEC=BYPASS                                                 @03A 03804000
.*                                                                 @03A 03805000
.*             IF THE CALLER OF PARTIAL RELEASE IS KEY < 8 THEN    @03A 03806000
.*             PARTIAL RELEASE WILL PASS TO CATALOG, THE           @03A 03807000
.*             BYPASS SECURITY CHECKING BIT INDICATING THAT        @03A 03808000
.*             CATALOG CAN BYPASS SECURITY CHECKING.               @03A 03809000
.*                                                                 @03A 03810000
.*             IF THE CALLER OF PARTIAL RELEASE IS KEY = 8 THEN    @03A 03811000
.*             PARTIAL RELEASE WILL TURN OFF THE BYPASS BIT        @03A 03812000
.*             BEFORE CALLING CATALOG.  THIS WILL FORCE CATALOG    @03A 03813000
.*             TO PERFORM SECURITY CHECKING.                       @03A 03814000
.*                                                                 @03A 03815000
.*  VSAMSEC=NOBYPASS                                               @03A 03816000
.*                                                                 @03A 03817000
.*             PARTIAL RELEASE WILL TURN OFF THE BYPASS BIT        @03A 03818000
.*             BEFORE CALLING CATALOG.  THIS WILL FORCE CATALOG    @03A 03819000
.*             TO PERFORM SECURITY CHECKING.                       @03A 03820000
.*                                                                 @03A 03821000
.*             THE 'VSAMTRKS' KEYWORD IS AN OPTIONAL PARAMETER,    @03A 03822000
.*             BUT IS REQUIRED WHEN 'VSAMTYPE' IS ALSO SPECIFIED.  @03A 03823000
.*             SUB-PARAMETERS DETERMINE WHO IS THE CALLER OF       @03A 03824000
.*             PARTIAL RELEASE.                                    @03A 03825000
.*                                                                 @03A 03826000
.*                                                                 @03A 03827000
.*                                                                 @03A 03828000
.*  VSAMTRKS=ADDR | VSAMTRKS=(REG)                                 @03A 03829000
.*                                                                 @03A 03830000
.*         THE 'VSAMTRKS' KEYWORD MAY BE USED TO SPECIFY THE       @03A 03831000
.*         ADDRESS OF AN AREA WHICH CONTAINS THE NUBER OF TRACKS   @03A 03832000
.*         RELEASED BY THE PARTIAL RELEASE FUNCTION.               @03A 03833000
.*         THIS PARAMETER WILL NOT APPLY TO THE DSECT-FORM OF THIS @03A 03834000
.*         MACRO.  IF THE LIST-FORM IS REQUESTED, THE 'REG' FORMAT @03A 03835000
.*         FOR THIS PARAMETER WILL NOT APPLY.                      @03A 03836000
.*         'ADDR', IN VSAMTRKS=ADDR, MUST BE SPECIFIED AS THE      @03A 03837000
.*         LABEL OF AN AREA WHICH WILL CONTAIN THE NUMBER OF       @03A 03838000
.*         TRACKS RELEASED.  THIS IS A 4 BYTE FIELD.               @03A 03839000
.*         'REG', IN VSAMTRKS=(REG), MUST REPRESENT ANY REGISTER,  @03A 03840000
.*         2 - 12.  THE REGISTER WILL CONTAIN THE ADDRESS          @03A 03841000
.*         OF AN AREA WHICH WILL CONTAIN THE NUMBER OF TRACKS      @03A 03842000
.*         RELEASED.                                               @03A 03843000
.*                                                                      03850000
.*SUMMARY OF PARAMETERS -- KEYWORD=OPTION COMBINATIONS:                 03875000
.*                                                                      03900000
.*        THE 'MF' KEYWORD IS REQUIRED.  THE SPECIFICATION OF KEYWORDS  03950000
.*        'DSN' 'MODE' AND/OR 'UCB' IS DEFINED AS A FUNCTION OF 'MF'    04000000
.*                                                                      04100000
.*                MF   DSN    MODE   UCB    TIOT   ERASE           @01C 04125000
.*                --   ----   ----   ----   ----   -----           @01C 04150000
.*                D    IG     IG     IG     IG     IG              @01C 04175000
.*                E    OPT    KWD    REG    OPT    OPT             @01C 04200000
.*                L    ADDR   KWD    IG     OPT    OPT             @01C 04225000
.*                                                                      04228100
.*                                                                      04231200
.*                MF   VSAMTYPE   VSAMFMT   VSAMSEC   VSAMTRKS     @03A 04234300
.*                --   --------   -------   -------   --------     @03A 04237400
.*                D    IG         IG        IG        IG           @03A 04240500
.*                E    OPT        OPT       OPT       OPT          @03A 04243600
.*                L    OPT        OPT       OPT       ADDR         @03A 04246700
.*                                                                      04250000
.*        ENTRIES IN THE ABOVE TABLE IDENTIFY RESTRICTIONS ON THE       04300000
.*        PARTREL MACRO PARAMETERS AS:                                  04350000
.*                                                                      04450000
.*        ADDR THE PARAMETER IS OPTIONAL.  IF THE PARAMETER IS          04468700
.*             SPECIFIED, IT IS RESTRICTED TO THE KEYWORD=LABEL         04487400
.*             FORMAT.  IF THE PARAMETER IS SPECIFIED IN THE            04506100
.*             KEYWORD=(REG) FORMAT:                                    04524800
.*                1. THE PARAMETER IS IGNORED, AND                      04543500
.*                2. ONE 4 LEVEL MNOTE IS ISSUED FOR THE MACRO CALL     04562200
.*                   (IF NO MAJOR ERROR IS FOUND).                      04580900
.*                                                                      04600000
.*        IG   IF THE PARAMETER IS SPECIFIED:                           04650000
.*                1. THE PARAMETER IS IGNORED, AND                      04700000
.*                2. ONE 4 LEVEL MNOTE IS ISSUED FOR THE MACRO CALL     04750000
.*                   (IF NO MAJOR ERROR IS FOUND).                      04800000
.*                                                                      04850000
.*        KWD  THE PARAMETER IS OPTIONAL.  THE 'MODE' PARAMETER         04854100
.*             MAY BE SPECIFIED AS EITHER MODE=PGM OR MODE=SUP.         04858200
.*             IF THE 'MODE' PARAMETER IS NOT SPECIFIED, MODE=PGM       04862300
.*             WILL BE ASSUMED.                                         04866400
.*                                                                      04870500
.*        OPT  THE PARAMETER IS OPTIONAL.  IF THE PARAMETER IS          04875000
.*             SPECIFIED, EITHER FORMAT:  KEYWORD=LABEL, OR             04900000
.*             KEYWORD=(REG) MAY BE USED.                               04925000
.*                                                                      04950000
.*        REG  THE PARAMETER IS OPTIONAL.  IF THE PARAMETER IS          04975000
.*             SPECIFIED, IT IS RESTRICTED TO THE KEYWORD=(REG)         05000000
.*             FORMAT.                                                  05025000
.*                                                                      05050000
.*        ALL REFERENCES TO THE WORD 'OPTIONAL' IS RELATIVE TO          05057100
.*        PARAMETER SPECIFICATION ON THE MACRO CALL.  WHEN DADSM        05064200
.*        PARTIAL RELEASE IS INVOKED, VALUES FOR BOTH 'DSN' AND 'UCB'   05071300
.*        MUST BE DEFINED OR THE PARTIAL RELEASE WILL FAIL.             05078400
.*                                                                      05085500
.*                                                                      05092600
.*MODULE-TYPE = MACRO                                                   05100000
.*                                                                      05150000
.*PROCESSOR = ASSEMBLER LANGUAGE                                        05200000
.*                                                                      05250000
.*ATTRIBUTES = EXECUTABLE MACRO                                         05300000
.*                                                                      05350000
.*ENTRY-POINT = MACRO STATEMENT.                                        05400000
.*                                                                      05450000
.*INPUT = SEE DESCRIPTION OF KEYWORDS UNDER 'FUNCTION'.                 05500000
.*                                                                      05550000
.*OUTPUT = PARTREL PARAMETER LIST WITH THE FLAGS AND THE ADDRESSES      05600000
.*         SET DEPENDING UPON THE KEYWORDS SPECIFIED AS DEFINED         05650000
.*         UNDER 'KEYWORDS' ABOVE.                                      05700000
.*                                                                      05750000
.*EXIT-NORMAL = MEND STATEMENT.                                         05800000
.*                                                                      05850000
.*EXIT-ERROR  = MNOTE AND MEND STATEMENT.  MNOTES WILL BE GENERATED     05900000
.*              FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED:            05950000
.*                                                                      06000000
.*              FOR ALL FORMS OF THE MACRO:                             06050000
.*                 1. MF IS A REQUIRED KEYWORD.                         06100000
.*                 2. INVALID OPERAND - KEYWORD=OPERAND.                06150000
.*                 3. ONE OR MORE PARAMETERS IGNORED DUE TO             06166600
.*                    MF=OPERAND.                                       06183200
.*                                                                      06200000
.*              FOR THE EXECUTE FORM OF THE MACRO:                      06212500
.*                 1. MF=(E,ADDR) FORM: SUPPLY PARAMETER LIST ADDRESS.  06225000
.*                                                                      06237500
.*EXTERNAL-REFERENCES = NONE                                            06250000
.*                                                                      06300000
.*TABLES = NONE                                                         06350000
.*                                                                      06400000
.*MACROS = DELETE, IHBINNRA, LOAD                                       06450000
.*                                                                      06500000
.*CHANGE-ACTIVITY = NEW MACRO                                           06550000
.*                                                                      06600000
.*$L0=MVS/XA,HDP2210,,STLAM: INTERFACE MACRO TO PARTIAL RELEASE         06650000
.*$01=OZ94340,HDP2210,,STLMC: SUPPORT SYSZTIOT BYPASS FOR HSM      @01A 06666600
.*$02=OZ94337,HDP2210,,STLMC: SUPPORT ERASE, NOERASE ON PARTREL    @02A 06683200
.*$03=OW03622,HDZ11B0,,SJPLMKD: SUPPORT VSAM PARTIAL RELEASE       @03A 06691600
.*$L1=VSAMAF,HDZ11E0,11Feb98,,SJPLGAP: ADVANCED VSAM PARTREL SUP.  @L1A 06695800
.*$P1=K150458,HDZ11E0,23Feb98,,SJPLGAP: DONT USE R0 FOR DIAG CODE  @P1A 06697900
.*$04=OW49940,HDZ11F0,31May01,,SJPLJBC: DONT ENQ TEST FLAG         @04A 06698890
.*                                                                      06700000
.**** END OF SPECIFICATIONS ******************************************  06750000
.*                                                                      06800000
         LCLB  &DSNA      DSN=ADDR WILL BE USED                         06850000
         LCLB  &DSNR      DSN=(REG) WILL BE USED                        06900000
         LCLB  &TRKSA     VSAMTRKS=ADDR WILL BE USED               @03A 06916600
         LCLB  &TRKSR     VSAMTRKS=(REG) WILL BE USED              @03A 06933200
         LCLB  &ERRORSW   A MAJOR ERROR WAS DETECTED                    06950000
         LCLC  &L         LOCAL LABEL VARIABLE                          07000000
         LCLB  &MFD       MF=D WAS SPECIFIED                            07050000
         LCLB  &MFE       MF=(E,..) WAS SPECIFIED                       07100000
         LCLB  &MFL       MF=L WAS SPECIFIED                            07150000
         LCLA  &NO        BRANCH INDEX NUMBER                           07200000
         LCLA  &NMASK1    USED TO RESET PARTREL FLAGS (BYTE1)      @03C 07210000
         LCLA  &OMASK1    USED TO SET PARTREL FLAGS   (BYTE1)      @03C 07220000
         LCLA  &NMASK2    USED TO RESET PARTREL FLAGS (BYTE2)      @03C 07230000
         LCLA  &OMASK2    USED TO SET PARTREL FLAGS   (BYTE2)      @03C 07240000
         LCLB  &UCBR      UCB=(REG) WILL BE USED                        07250000
         LCLB  &WARNSW    A WARNING ERROR WAS DETECTED                  07300000
         LCLB  &NB1(8)    BITS TO RESET PARTREL FLAG BYTE  (BYTE1) @03C 07320000
         LCLB  &OB1(8)    BITS TO SET PARTREL FLAG BYTE    (BYTE1) @03C 07340000
         LCLB  &NB2(8)    BITS TO RESET PARTREL FLAG BYTE  (BYTE2) @03C 07360000
         LCLB  &OB2(8)    BITS TO SET PARTREL FLAG BYTE    (BYTE2) @03C 07380000
         LCLB  &DF1       BIT TO SET DEFAULT CALLER                @L1A 07386600
         LCLB  &DF2       BIT TO SET DEFAULT SECURITY CHECK        @L1A 07393200
&NO      SETA  &SYSNDX                  SET BRANCH INDEX NUMBER         07400000
.*                                                                      07450000
.* ******************************************************************** 07500000
.* *  VERIFICATION 1: MF PARAMETER                                      07550000
.* ******************************************************************** 07600000
.*                                                                      07650000
.V1      AIF   ('&MF' EQ '').V1ER2      IF NO MF GIVEN, BRANCH, ERROR   07700000
         AIF   ('&MF'(1,2) EQ '(E').V1E IF E FORM, BRANCH               07750000
         AIF   ('&MF' EQ 'L').V1L       IF L FORM, BRANCH               07800000
         AIF   ('&MF' NE 'D').V1ER1     IF NOT D FORM, BRANCH, ERROR    07850000
&MFD     SETB  1                        ELSE SET MF=D FOUND             07900000
         AGO   .V1X                       AND CONTINUE                  07950000
.*                                                                      08000000
.V1L     ANOP                                                           08050000
&MFL     SETB  1                        SET MF=L FOUND                  08100000
         AGO   .V1X                     AND CONTINUE                    08150000
.*                                                                      08200000
.V1E     ANOP                                                           08250000
&MFE     SETB  1                        SET MF=E FOUND                  08300000
         AIF   (N'&MF EQ 2).V1X         IF TWO PARMS ON MF, BRANCH      08350000
         AIF   (N'&MF EQ 1).V1ER3       IF ONE PARM, BRANCH, ERROR      08400000
.V1ER1   ANOP                                                           08450000
         SPACE 1                                                        08650000
         MNOTE 8,'***  IHB001 INVALID OPERAND - MF=&MF'                 08700000
         AGO   .V1ERX                   GO SET ERROR FLAG               08750000
.*                                                                      08900000
.V1ER2   ANOP                                                           08950000
         SPACE 1                                                        09300000
         MNOTE 8,'***  IHB002 MF IS A REQUIRED KEYWORD'                 09308300
         AGO   .V1ERX                   GO SET ERROR FLAG               09316600
.*                                                                      09324900
.V1ER3   ANOP                                                           09333200
         SPACE 1                                                        09341500
         MNOTE  8,'***  IHB004 MF=(E,ADDR) FORM: SUPPLY PARAMETER LIST X09350000
               ADDRESS'                                                 09400000
.V1ERX   ANOP                                                           09425000
         SPACE 1                                                        09450000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             09483300
.V1X     ANOP                                                           09516600
.*                                                                      09550000
.* ******************************************************************** 09600000
.* *  V2: DSN= PARAMETER                                                09650000
.* ******************************************************************** 09700000
.*                                                                      09750000
.V2      AIF   ('&DSN' EQ '').V2X       IF DSN NOT GIVEN, BRANCH        09800000
         AIF   (&MFD).V2NOTE            IF D FORM, BRANCH, WARNING      09850000
         AIF   ('&DSN'(1,1) EQ '(').V2R IF DSN=(REG), BRANCH            09900000
&DSNA    SETB  1                        ELSE SET DSN=ADDR               09950000
         AGO   .V2X                       AND CONTINUE                  10000000
.*                                                                      10050000
.V2R     AIF   (&MFL).V2NOTE            IF L FORM, BRANCH, WARNING      10100000
         AIF   (N'&DSN NE 1).V2ER1      IF NE ONE PARM, BRANCH, ERROR   10150000
&DSNR    SETB  1                        SET DSN=(REG)                   10200000
         AGO   .V2X                     AND CONTINUE                    10250000
.*                                                                      10300000
.V2ER1   ANOP                                                           10350000
         SPACE 1                                                        10750000
         MNOTE 8,'***  IHB005 INVALID OPERAND - DSN=&DSN'               10800000
         SPACE 1                                                        10850000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             10870000
.V2NOTE  ANOP                                                           10890000
&WARNSW  SETB  1                        SET WARNING SWITCH ON           10910000
.V2X     ANOP                                                           10930000
.*                                                                      10950000
.* ******************************************************************** 11000000
.* *  V3: MODE=  PARAMETER                                              11050000
.* ******************************************************************** 11100000
.*                                                                      11150000
.V3      AIF   ('&MODE' EQ '').V3X      IF MODE NOT GIVEN, BRANCH       11200000
         AIF   (&MFD).V3NOTE            IF D FORM, BRANCH, WARNING      11250000
         AIF   ('&MODE' EQ 'PGM').V3X   IF MODE=PGM, BRANCH             11300000
         AIF   ('&MODE' NE 'SUP').V3ER1 IF NOT MODE=SUP, BRANCH, ERROR  11350000
&OB1(1)  SETB  1                        ELSE SET MODE=UP          @03C  11400000
         AGO   .V3X                       AND CONTINUE                  11450000
.*                                                                      12350000
.V3ER1   ANOP                                                           12400000
         SPACE 1                                                        13200000
         MNOTE 8,'***  IHB006 INVALID OPERAND - MODE=&MODE'             13228500
         SPACE 1                                                        13257000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             13285500
.V3NOTE  ANOP                                                           13314000
&WARNSW  SETB  1                        SET WARNING SWITCH ON           13342500
.V3X     ANOP                                                           13371000
.*                                                                      13400000
.* ******************************************************************** 13450000
.* *  V4: UCB= PARAMETER                                                13452300
.* ******************************************************************** 13454600
.*                                                                      13456900
.V4      AIF   ('&UCB' EQ '').V4X       IF UCB NOT GIVEN, BRANCH        13459200
         AIF   (&MFD OR &MFL).V4NOTE    IF D OR L FORM, GO SET WARNING  13461500
         AIF   ('&UCB'(1,1) NE '(').V4ER1 IF NOT UCB=(REG), BRANCH, ERR 13463800
         AIF   (N'&UCB NE 1).V4ER1      IF NE ONE PARM, BRANCH, ERROR   13466100
&UCBR    SETB  1                       ELSE SET UCB=(REG)               13468400
         AGO   .V4X                       AND CONTINUE                  13470700
.*                                                                      13473000
.V4ER1   ANOP                                                           13475300
         SPACE 1                                                        13477600
         MNOTE 8,'***  IHB007 INVALID OPERAND - UCB=&UCB'               13479900
         SPACE 1                                                        13482200
&ERRORSW SETB  1                        SET ERROR SWITCH ON             13484500
.V4NOTE  ANOP                                                           13486800
&WARNSW  SETB  1                        SET WARNING SWITCH ON           13489100
.V4X     ANOP                                                           13491400
.*                                                                      13493700
.* ******************************************************************** 13496000
.* *  V5: TIOT= PARAMETER                                          @01A 13497200
.* ******************************************************************** 13498400
.*                                                                      13499600
.V5      ANOP                                                      @01A 13500800
&NB1(2)  SETB  ('&TIOT' EQ '')          SET 'AND' BIT              @03C 13502000
         AIF   ('&TIOT' EQ '').V5X      IF TIOT NOT GIVEN, BRANCH  @01A 13503200
         AIF   (&MFD).V5NOTE            IF D FORM, ISSUE WARNING   @01A 13504400
         AIF   ('&TIOT' EQ 'ENQ').V5X   IF TIOT=ENQ, BRANCH        @01A 13505600
&OB1(2)  SETB  ('&TIOT' EQ 'NOENQ')     SET 'OR' BIT               @03C 13506800
         AIF   ('&TIOT' EQ 'NOENQ').V5X IF TIOT=NOENQ, BRANCH      @01A 13508000
.V5ER1   ANOP                                                      @01A 13509200
         SPACE 1                                                   @01A 13510400
         MNOTE 8,'***  IHB008 INVALID OPERAND - TIOT=&TIOT'        @01A 13511600
         SPACE 1                                                   @01A 13512800
&ERRORSW SETB  1                        SET ERROR SWITCH ON        @01A 13514000
.V5NOTE  ANOP                                                      @01A 13515200
&WARNSW  SETB  1                        SET WARNING SWITCH ON      @01A 13516400
.V5X     ANOP                                                      @01A 13517600
.*                                                                      13518800
.* ******************************************************************** 13520000
.* *  V6: ERASE= PARAMETER                                         @02A 13521200
.* ******************************************************************** 13522400
.*                                                                      13523600
.V6      ANOP                                                      @02A 13524800
&NB1(3)  SETB  ('&ERASE' EQ '')         SET 'AND' BIT              @03C 13526000
&NB1(4)  SETB  (&NB1(3))                SET 'AND' BIT              @03C 13527200
         AIF   ('&ERASE' EQ '').V6X     IF ERASE NOT GIVEN, BRANCH @02A 13528400
         AIF   (&MFD).V6NOTE            IF D FORM, ISSUE WARNING   @02A 13529600
         AIF   ('&ERASE' EQ 'TEST').V6X IF ERASE=TEST, BRANCH      @02A 13530800
&OB1(3)  SETB  ('&ERASE' EQ 'NO')       SET 'OR' BIT               @03C 13532000
&OB1(4)  SETB  ('&ERASE' EQ 'YES')      SET 'OR' BIT               @03C 13533200
         AIF   (&OB1(3) OR &OB1(4)).V6X IF YES OR NO SPECIFIED, BR @02A 13534400
.V6ER1   ANOP                                                      @02A 13535600
         SPACE 1                                                   @02A 13536800
         MNOTE 8,'***  IHB009 INVALID OPERAND - ERASE=&ERASE'      @02A 13538000
         SPACE 1                                                   @02A 13539200
&ERRORSW SETB  1                        SET ERROR SWITCH ON        @02A 13540400
.V6NOTE  ANOP                                                      @02A 13541600
&WARNSW  SETB  1                        SET WARNING SWITCH ON      @02A 13542800
.V6X     ANOP                                                      @02A 13544000
.*                                                                 @03A 13544200
.* *************************************************************** @03A 13544400
.* *  V7: VSAMTYPE= PARAMETER                                      @03A 13544600
.* *************************************************************** @03A 13544800
.*                                                                 @03A 13545000
.V7      ANOP                                                      @03A 13545200
&NB2(1)  SETB  ('&VSAMTYPE' EQ '')    SET TYPE KSDS  = 0           @03A 13545400
&NB2(2)  SETB  (&NB2(1))              SET TYPE ESDS  = 0           @03A 13545600
&NB2(3)  SETB  (&NB2(1))              SET TYPE RRDS  = 0           @03A 13545800
&NB2(4)  SETB  (&NB2(1))              SET TYPE VRRDS = 0           @03A 13546000
&NB2(5)  SETB  (&NB2(1))              SET TYPE LDS   = 0           @03A 13546200
&NB2(8)  SETB  1                      SET TYPE       = 1           @04A 13546290
.*                                                                 @03A 13546400
         AIF   ('&VSAMTYPE' EQ '').V7W  VSAM DATASET NOT SPECIFIED @03A 13546600
         AIF   ('&VSAMFMT'  EQ '').V7ER1                           @03A 13546800
         AIF   ('&VSAMCLLR' EQ '').V7ER2 SET DEFAULT 'NOTVSAM'     @L1C 13547000
         AIF   ('&VSAMSEC'  EQ '').V7ER3 SET DEFAULT 'NOBYPASS'    @L1C 13547200
.*       AIF   ('&VSAMTRKS' EQ '').V7ER4                           @03A 13547400
         AGO   .V7T                                                @03A 13547600
.*                                                                 @03A 13547800
.V7W     ANOP                                                      @03A 13548000
         AIF   ('&VSAMFMT'  NE '').V7ER6                           @03A 13548200
         AIF   ('&VSAMCLLR' NE '').V7ER7                           @03A 13548400
         AIF   ('&VSAMSEC'  NE '').V7ER8                           @03A 13548600
         AIF   ('&VSAMTRKS' NE '').V7ER9                           @03A 13548800
.*                                                                 @03A 13549000
.V7T     ANOP                                                      @03A 13549200
         AIF   ('&VSAMTYPE' EQ '').V7X                             @03A 13549400
         AIF   (&MFD).V7NOTE            IF D FORM, ISSUE WARNING   @03A 13549600
.*                                                                 @03A 13549800
         AIF   ('&VSAMTYPE' EQ 'KSDS').V7TYP                       @L1C 13549900
         AIF   ('&VSAMTYPE' EQ 'ESDS').V7TYP                       @L1C 13550000
         AIF   ('&VSAMTYPE' EQ 'RRDS').V7TYP                       @L1C 13550100
         AIF   ('&VSAMTYPE' EQ 'VRRDS').V7TYP                      @L1C 13550200
         AIF   ('&VSAMTYPE' EQ 'LDS').V7TYP                        @L1C 13550300
         AIF   ('&VSAMTYPE' EQ 'YES').V7TYP                        @L1A 13550400
         AGO   .V7TYE                                                   13550500
.V7TYP   ANOP                                                      @L1A 13550600
&OB2(1)  SETB  1                                                   @L1A 13550700
&OB2(2)  SETB  0                                                   @L1A 13550800
&OB2(3)  SETB  0                                                   @L1A 13550900
&OB2(4)  SETB  0                                                   @L1A 13551000
&OB2(5)  SETB  0                                                   @L1A 13551100
.V7TYE   ANOP                                                      @L1A 13551200
         AIF   (&OB2(1)).V7X                                       @L1C 13551300
.*                                                                 @L1D 13551400
.*                                                                 @03A 13551500
.V7ER5   ANOP                                                      @03A 13551600
         SPACE 1                                                   @03A 13551800
         MNOTE 8,'***IHB010 INVALID OPERAND - VSAMTYPE=&VSAMTYPE'  @03A 13552000
         SPACE 1                                                   @03A 13552200
         AGO   .V7ERROR                                            @03A 13552400
.*                                                                 @03A 13552600
.V7ER1   ANOP                                                      @03A 13552800
         SPACE 1                                                   @03A 13553000
         MNOTE 8,'*** IHB011 PARAMETER VSAMFMT MUST BE SPECIFIED'  @03A 13553200
         MNOTE 8,'***        WHEN PARAMETER VSAMTYPE IS SPECIFIED' @03A 13553400
         SPACE 1                                                   @03A 13553600
         AGO   .V7ERROR                                            @03A 13553800
.*                                                                 @03A 13554000
.V7ER2   ANOP                                                      @03A 13554200
&DF1     SETB  1                                DEFAULT FOR CALLER @L1A 13554400
         AIF   ('&VSAMSEC'  EQ '').V7ER3 SET DEFAULT 'NOBYPASS'    @L1C 13554600
.*                                                                4@L1D 13554800
         AGO   .V7T                                                @L1A 13555000
.*                                                                 @03A 13555400
.V7ER3   ANOP                                                      @03A 13555600
&DF2     SETB  1                             DEFAULT FOR SEC CHECK @L1A 13555900
.*                                                                4@L1D 13556200
         AGO   .V7T                                                @L1A 13556500
.*                                                                 @03A 13556800
.V7ER4   ANOP                                                      @03A 13557000
         SPACE 1                                                   @03A 13557200
         MNOTE 8,'*** IHB014 PARAMETER VSAMTRKS MUST BE SPECIFIED' @03A 13557400
         MNOTE 8,'***        WHEN PARAMETER VSAMTYPE IS SPECIFIED' @03A 13557600
         SPACE 1                                                   @03A 13557800
         AGO   .V7ERROR                                            @03A 13558000
.*                                                                 @03A 13558200
.V7ER6   ANOP                                                      @03A 13558400
         SPACE 1                                                   @03A 13558600
         MNOTE 8,'*** IHB015 PARAMETER VSAMFMT MUST NOT BE'        @03A 13558800
         MNOTE 8,'***    SPECIFIED WHEN VSAMTYPE IS NOT SPECIFIED' @03A 13559000
         SPACE 1                                                   @03A 13559200
         AGO   .V7ERROR                                            @03A 13559400
.*                                                                 @03A 13559600
.V7ER7   ANOP                                                      @03A 13559800
         SPACE 1                                                   @03A 13560000
         MNOTE 8,'*** IHB016 PARAMETER VSAMCLLR MUST NOT BE'       @03A 13560200
         MNOTE 8,'       SPECIFIED WHEN VSAMTYPE IS NOT SPECIFIED' @03A 13560400
         SPACE 1                                                   @03A 13560600
         AGO   .V7ERROR                                            @03A 13560800
.*                                                                 @03A 13561000
.V7ER8   ANOP                                                      @03A 13561200
         SPACE 1                                                   @03A 13561400
         MNOTE 8,'*** IHB017 PARAMETER VSAMSEC MUST NOT BE'        @03A 13561600
         MNOTE 8,'       SPECIFIED WHEN VSAMTYPE IS NOT SPECIFIED' @03A 13561800
         SPACE 1                                                   @03A 13562000
         AGO   .V7ERROR                                            @03A 13562200
.*                                                                 @03A 13562400
.V7ER9   ANOP                                                      @03A 13562600
         SPACE 1                                                   @03A 13562800
         MNOTE 8,'*** IHB018 PARAMETER VSAMTRKS MUST NOT BE'       @03A 13563000
         MNOTE 8,'       SPECIFIED WHEN VSAMTYPE IS NOT SPECIFIED' @03A 13563200
         SPACE 1                                                   @03A 13563400
         AGO   .V7ERROR                                            @03A 13563600
.*                                                                 @03A 13563800
.V7ERROR ANOP                                                      @03A 13564000
&ERRORSW SETB  1                        SET ERROR SWITCH ON        @03A 13564200
.V7NOTE  ANOP                                                      @03A 13564400
&WARNSW  SETB  1                        SET WARNING SWITCH ON      @03A 13564600
.V7X     ANOP                                                      @03A 13564800
.*                                                                 @03A 13565000
.* *************************************************************** @03A 13565200
.* *  V8: VSAMTRKS= PARAMETER                                      @03A 13565400
.* *************************************************************** @03A 13565600
.*                                                                 @03A 13565800
.V8      AIF   ('&VSAMTRKS' EQ '').V8X    IF VSAMTRKS NOT GIVEN,BR @03A 13566000
         AIF   (&MFD).V8NOTE            IF D FORM, BRANCH, WARNING @03A 13566200
         AIF   ('&VSAMTRKS'(1,1) EQ '(').V8R IF DSN=(REG), BRANCH  @03A 13566400
&TRKSA   SETB  1                        ELSE SET DSN=ADDR          @03A 13566600
         AGO   .V8X                       AND CONTINUE             @03A 13566800
.*                                                                 @03A 13567000
.V8R     AIF   (&MFL).V8NOTE            IF L FORM, BRANCH, WARNING @03A 13567200
         AIF   (N'&VSAMTRKS NE 1).V8ER1 IF NE 1 PARM, BRANCH, ERROR@03A 13567400
&TRKSR   SETB  1                        SET DSN=(REG)              @03A 13567600
         AGO   .V8X                     AND CONTINUE               @03A 13567800
.*                                                                 @03A 13568000
.V8ER1   ANOP                                                      @03A 13568200
         SPACE 1                                                   @03A 13568400
         MNOTE 8,'***  IHB019 INVALID OPERAND - VSAMTRKS=&VSAMTRKS'@03A 13568600
         SPACE 1                                                   @03A 13568800
&ERRORSW SETB  1                        SET ERROR SWITCH ON        @03A 13569000
.V8NOTE  ANOP                                                      @03A 13569200
&WARNSW  SETB  1                        SET WARNING SWITCH ON      @03A 13569400
.V8X     ANOP                                                      @03A 13569600
.*                                                                 @03A 13569800
.* *************************************************************** @03A 13570000
.* *  V9: VSAMFMT= PARAMETER                                       @03A 13570200
.* *************************************************************** @03A 13570400
.*                                                                 @03A 13570600
.V9      ANOP                                                      @03A 13570800
&NB2(6)  SETB  ('&VSAMFMT' EQ '')       SET 'AND' BIT              @03A 13571000
&NB2(7)  SETB  (&NB2(6))                SET 'AND' BIT              @03A 13571200
         AIF   ('&VSAMFMT' EQ '').V9X   IF VSAMFMT NOT GIVEN, BR.  @03A 13571400
         AIF   (&MFD).V9NOTE            IF D FORM, ISSUE WARNING   @03A 13571600
&OB2(6)  SETB  ('&VSAMFMT' EQ 'EXTD')   SET 'OR' BIT               @03A 13571800
&OB2(7)  SETB  ('&VSAMFMT' EQ 'STD')    SET 'OR' BIT               @03A 13572000
         AIF   (&OB2(6) OR &OB2(7)).V9X IF YES OR NO SPECIFIED, BR @03A 13572200
.V9ER1   ANOP                                                      @03A 13572400
         SPACE 1                                                   @03A 13572600
         MNOTE 8,'***IHB020 INVALID OPERAND - VSAMFMT=&VSAMFMT'    @03A 13572800
         SPACE 1                                                   @03A 13573000
&ERRORSW SETB  1                        SET ERROR SWITCH ON        @03A 13573200
.V9NOTE  ANOP                                                      @03A 13573400
&WARNSW  SETB  1                        SET WARNING SWITCH ON      @03A 13573600
.V9X     ANOP                                                      @03A 13573800
.*                                                                 @03A 13574000
.*                                                                 @03A 13574200
.* *************************************************************** @03A 13574400
.* *  VA: VSAMCLLR= PARAMETER                                      @03A 13574600
.* *************************************************************** @03A 13574800
.*                                                                 @03A 13575000
.VA      ANOP                                                      @03A 13575200
         AIF   (&DF1).VACK2                                        @L1A 13575300
&NB1(5)  SETB  ('&VSAMCLLR' EQ '')      SET 'AND' BIT              @03A 13575400
&NB1(6)  SETB  (&NB1(5))                SET 'AND' BIT              @03A 13575600
         AIF   ('&VSAMCLLR' EQ '').VAX  IF VSAMCLLR NOT GIVEN, BR. @03A 13575800
         AIF   (&MFD).VANOTE            IF D FORM, ISSUE WARNING   @03A 13576000
&OB1(5)  SETB  ('&VSAMCLLR' EQ 'VSAMCLSE')  SET 'OR' BIT           @03A 13576200
&OB1(6)  SETB  ('&VSAMCLLR' EQ 'NOTVSAM')   SET 'OR' BIT           @03A 13576400
         AIF   (&OB1(5) OR &OB1(6)).VAX IF YES OR NO SPECIFIED, BR @03A 13576600
.VAER1   ANOP                                                      @03A 13576800
         SPACE 1                                                   @03A 13577000
         MNOTE 8,'***IHB021 INVALID OPERAND - VSAMCLLR=&VSAMCLLR'  @03A 13577200
         SPACE 1                                                   @03A 13577400
&ERRORSW SETB  1                        SET ERROR SWITCH ON        @03A 13577600
.VANOTE  ANOP                                                      @03A 13577800
&WARNSW  SETB  1                        SET WARNING SWITCH ON      @03A 13578000
         AGO   .VAX                                                     13578100
.VACK2   ANOP                           SET DEFAULT VALUE          @L1A 13578200
&NB1(5)  SETB  (0)                      SET AND BIT                @L1A 13578300
&NB1(6)  SETB  (0)                      SET AND BIT                @L1A 13578400
&OB1(5)  SETB  (0)                      SET OR BIT                 @L1A 13578500
&OB1(6)  SETB  (1)                      SET OR BIT                 @L1A 13578600
.VAX     ANOP                                                      @03A 13578700
.*                                                                 @03A 13578800
.*                                                                 @03A 13578900
.* *************************************************************** @03A 13579000
.* *  VB: VSAMSEC= PARAMETER                                       @03A 13579100
.* *************************************************************** @03A 13579200
.*                                                                 @03A 13579400
.VB      ANOP                                                      @03A 13579600
         AIF   (&DF2).VBCK2                                        @L1A 13579700
&NB1(7)  SETB  ('&VSAMSEC' EQ '')       SET 'AND' BIT              @03A 13579800
&NB1(8)  SETB  (&NB1(7))                SET 'AND' BIT              @03A 13580000
         AIF   ('&VSAMSEC' EQ '').VBX   IF VSAMSEC NOT GIVEN, BR.  @03A 13580200
         AIF   (&MFD).VBNOTE            IF D FORM, ISSUE WARNING   @03A 13580400
&OB1(7)  SETB  ('&VSAMSEC' EQ 'BYPASS')     SET 'OR' BIT           @03A 13580600
&OB1(8)  SETB  ('&VSAMSEC' EQ 'NOBYPASS')   SET 'OR' BIT           @03A 13580800
         AIF   (&OB1(7) OR &OB1(8)).VBX IF YES OR NO SPECIFIED, BR @03A 13581000
.VBER1   ANOP                                                      @03A 13581200
         SPACE 1                                                   @03A 13581400
         MNOTE 8,'***IHB022 INVBLID OPERAND - VSAMSEC=&VSAMSEC'    @03A 13581600
         SPACE 1                                                   @03A 13581800
&ERRORSW SETB  1                        SET ERROR SWITCH ON        @03A 13582000
.VBNOTE  ANOP                                                      @03A 13582200
&WARNSW  SETB  1                        SET WARNING SWITCH ON      @03A 13582400
         AGO   .VBX                                                     13582500
.VBCK2   ANOP                           SET DEFAULT VALUE          @L1A 13582600
&NB1(7)  SETB  (0)                      SET AND BIT                @L1A 13582700
&NB1(8)  SETB  (0)                      SET AND BIT                @L1A 13582800
&OB1(7)  SETB  (0)                      SET OR BIT                 @L1A 13582900
&OB1(8)  SETB  (1)                      SET OR BIT                 @L1A 13583000
.VBX     ANOP                                                      @03A 13583100
.*                                                                 @03A 13583200
.*                                                                 @03A 13583300
.* ******************************************************************** 13583400
.* *  CHECK ERRORS                                                      13583500
.* ******************************************************************** 13583600
.*                                                                      13600000
         AIF   (&ERRORSW EQ 0).CONT     IF NO MAJOR ERROR, BRANCH       13650000
&LABEL   DS    0F  *** INVALID OPERAND(S) FOUND IN MACRO EXPANSION.***  16200000
         AGO   .FINISH                                                  16250000
.*                                                                      16300000
.CONT    AIF   (&WARNSW EQ 0).BLD       IF NO WARNING ERROR, BRANCH     16320000
         SPACE 1                                                        16340000
     MNOTE 4,'***  IHB023 ONE OR MORE PARAMETERS IGNORED DUE TO MF=&MF' 16360000
         SPACE 1                                                        16380000
.BLD     ANOP                                                      @01A 16388000
&NMASK1  SETA  128*&NB1(1)+64*&NB1(2)+32*&NB1(3)+16*&NB1(4)        @03C 16390100
&NMASK1  SETA  &NMASK1+8*&NB1(5)+4*&NB1(6)+2*&NB1(7)+1*&NB1(8)     @03A 16392200
&OMASK1  SETA  128*&OB1(1)+64*&OB1(2)+32*&OB1(3)+16*&OB1(4)        @03C 16394300
&OMASK1  SETA  &OMASK1+8*&OB1(5)+4*&OB1(6)+2*&OB1(7)+1*&OB1(8)     @03A 16396400
.*                                                                 @03A 16398500
&NMASK2  SETA  128*&NB2(1)+64*&NB2(2)+32*&NB2(3)+16*&NB2(4)        @03A 16400600
&NMASK2  SETA  &NMASK2+8*&NB2(5)+4*&NB2(6)+2*&NB2(7)+1*&NB2(8)     @04A 16402700
&OMASK2  SETA  128*&OB2(1)+64*&OB2(2)+32*&OB2(3)+16*&OB2(4)        @03A 16404800
&OMASK2  SETA  &OMASK2+8*&OB2(5)+4*&OB2(6)+2*&OB2(7)               @03A 16406900
.*                                                                      16409000
         AIF   (&MFE).E1                IF E FORM, BRANCH          @01C 16412000
&L       SETC  '&LABEL'                 ELSE ASSUME A LABEL WAS GIVEN   16420000
         AIF   ('&L' NE '').TSTDL         IF A LABEL WAS GIVEN, BRANCH  16440000
&L       SETC  'PRL&NO.S'                 ELSE CONSTRUCT A LABEL        16460000
.TSTDL   AIF   (&MFL).L1                    IF L FORM, BRANCH           16480000
.*                                                                      16500000
.* ******************************************************************** 16950000
.* *  BEGIN BUILD FOR DSECT FORM OF MACRO                               17000000
.* ******************************************************************** 17050000
.*                                                                      17100000
&L       DSECT                          DSECT FOR PARAMETER LIST        17150000
PRLPLID  DS    CL4                      EBCDIC 'PREL' FOR PARTREL       17200000
PRLNGTH  DS    AL2                      LENGTH OF PARAMETER LIST        17250000
PRERRCDE DS    H                        ERROR CODE RETURNED FROM        17288800
*                                         PARTIAL RELEASE               17327700
PRLFLAG  DS    XL1                      PARAMETER FLAG BYTE             17366600
PRLPGM   EQU   X'00'                    MODE=PGM (PROBLEM PROGRAM)      17383200
PRLSUP   EQU   X'80'                    MODE=SUP (SUPERVISOR STATE)     17399800
PRLTIOT  EQU   X'40'                    TIOT=NOENQ                 @01A 17406400
PRLNERAS EQU   X'20'                    ERASE=NO                   @02A 17413000
PRLERASE EQU   X'10'                    ERASE=YES                  @02A 17419600
PRLVCLOS EQU   X'08'          VSAMCLLR=VSAMCLSE                    @03A 17421600
PRLVCNV  EQU   X'04'          VSAMCLLR=NOTVSAM                     @03A 17423600
PRLBYPS  EQU   X'02'          VSAM: BYPASS SECURITY CHECKING       @03A 17425600
PRLNBYPS EQU   X'01'          VSAM: SECURITY CHECKING TO BE DONE   @03A 17427600
PRLFLAG2 DS    XL1                                                 @03A 17429600
PRLVKSDS EQU   X'80'          VSAMTYPE=YES                         @L1C 17433600
*                                                                 4@L1D 17437600
PRLEXTD  EQU   X'04'          VSAMFMT=Extended format data set     @03A 17441600
PRLSTD   EQU   X'02'          VSAMFMT=Standard format data set     @03A 17443600
PRLTIOTX EQU   X'01'          No ENQ TEST when TIOT=NOENQ is spec  @04C 17445600
PRLRSVD  DS    XL2                      RESERVED                   @03C 17447600
PRLDSN   DS    A                        DATA SET NAME POINTER           17450000
PRLUCB   DS    A                        UCB POINTER                     17500000
PRLTRKS  DS    A              Ptr to area to contain number of     @03A 17505500
*                                 tracks released by partial rel   @03A 17511900
*                              (ONLY VALID FOR VSAM REQUESTS)      @03A 17518300
PRLCTGR  DS    F               CATALOG REASON CODE, ONLY VALID     @03A 17524900
*                              WHEN REQUEST IS FOR A VSAM DATASET  @03A 17533200
*                              (ONLY VALID FOR VSAM REQUESTS)      @03A 17541500
PRLDDIG  DS    F               DADSM DIAGNOSTIC INFORMATION        @L1A 17543600
*                              COPIED HERE FROM REG 0 PRIOR TO     @L1A 17545700
*                              CALL TO DELETE 20P0 ENTRY POINT     @L1A 17547800
PRLEND   EQU   *                        END OF PARAMETER LIST           17550000
PRLENGTH EQU   PRLEND-&L                LENGTH OF PARAMETER LIST        17600000
         AGO   .FINISH                                                  18800000
.*                                                                      18850000
.* ******************************************************************** 18900000
.* *  BEGIN BUILD FOR EXECUTE FORM OF MACRO                             18950000
.* ******************************************************************** 19000000
.*                                                                      19050000
.E1      AIF   ('&LABEL' EQ '').E2      IF NO LABEL GIVEN, BRANCH       19092800
&LABEL   DS    0H                                                       19135600
.E2      AIF   ('&MF(2)' EQ '(1)').E3   IF MF=(E,(1))  BRANCH           19178400
         LOAD  EP=IGG020P0              GET ADDR OF IGG020P0 IN REG 0   19221200
         IHBINNRA &MF(2)                GET PARM LIST ADDR IN REG 1     19264000
         AGO   .E4                      BRANCH AROUND MF=(E,(1)) FORM   19306800
.*                                                                      19350000
.E3      ANOP                                                           19400000
         LR    14,1                     SAVE PARM LIST ADDR AROUND LOAD 19450000
         LOAD  EP=IGG020P0              GET ADDR OF IGG020P0 IN REG 0   19500000
         LR    1,14                     RESTORE PARM LIST ADDR          19550000
.*                                                                      19600000
.E4      ANOP                                                      @01C 19650000
         NI    8(1),&NMASK1             RESET FLAG BITS            @01C 19683300
         NI    9(1),&NMASK2             RESET FLAG BITS            @01C 19716600
.*                                                                 @01D 19750000
.E5      ANOP                                                           19975000
         AIF   (&OMASK1 EQ 0).E5A       IF NO BITS TO SET, BRANCH  @03C 19979300
         OI    8(1),&OMASK1             SET FLAG BITS              @01C 19983600
.*                                                                 @03A 19987900
.E5A     ANOP                                                      @03A 19992200
         AIF   (&OMASK2 EQ 0).E6        IF NO BITS TO SET, BRANCH  @03A 19996500
         OI    9(1),&OMASK2             SET FLAG BITS              @03A 20000800
.*                                                                 @03A 20005100
.E6      AIF   (&DSNR).E7               IF DSN=(REG), BRANCH            20010000
         AIF   (&DSNA EQ 0).E6A         IF NOT DSN=ADDR, BRANCH    @03C 20020000
         LA    15,&DSN                  GET ADDR OF DATA SET NAME       20030000
         ST    15,12(,1)                AND STORE IN PARM LIST          20040000
         AGO   .E6A                     BRANCH AROUND DSN=(REG)    @03C 20050000
.E7      ANOP                                                           20060000
         ST    &DSN(1),12(,1)           STORE ADDR OF DATA SET NAME     20070000
.*                                                                 @03A 20083800
.E6A     AIF   (&TRKSR).E7A             IF VSAMTRKS=(REG),  BRANCH @03A 20097600
         AIF   (&TRKSA EQ 0).E8         IF NOT DSN=ADDR, BRANCH    @03A 20111400
         LA    15,&VSAMTRKS              GET ADDR OF DATA SET NAME @03A 20125200
         ST    15,20(,1)                AND STORE IN PARM LIST     @03A 20139000
         AGO   .E8                      BRANCH AROUND DSN=(REG)    @03A 20152800
.E7A     ANOP                                                      @03A 20166600
         ST    &VSAMTRKS(1),20(,1)      STORE ADDR OF VSAMTRKS RET @03A 20180400
.*                                                                 @03A 20194200
.E8      AIF   (&UCBR EQ 0).E9          IF NOT UCB=(REG), BRANCH   @03A 20208000
         ST    &UCB(1),16(,1)           STORE UCB PTR IN PARM LIST @03A 20221800
.*                                                                 @03A 20235600
.E9      ANOP                                                           20250000
         LR    15,0                     GET ENTRY ADDRESS TO IGG020P0   20300000
         L     14,16                    POINT TO CVT,  TEST FOR MVS/XA  20310000
         TM    116(14),X'80'               TM  CVTDCB,CVTMVSE           20320000
         BO    PRL&NO.B                 IF XA, BRANCH TO BASSM          20330000
         BALR  14,15                    ELSE BALR TO PARTIAL RELEASE    20340000
         B     PRL&NO.D                 BRANCH TO DELETE                20350000
*                                                                       20360000
PRL&NO.B DS    0H                       XA IS EXECUTING, USE BASSM      20370000
         DC    X'0CEF'                  BASSM 14,15  TO PARTIAL RELEASE 20380000
PRL&NO.D DS    0H                       DELETE EP=IGG020P0              20390000
         LR    14,15                    SAVE RETURN CODE AROUND DELETE  20395000
*                                                                 @P1D  20397500
         DELETE EP=IGG020P0             FINISHED WITH IGG020P0          20400000
         LTR   15,14                    RESTORE RETURN CODE             20425000
*                                                                 @P1D  20437500
         AGO   .FINISH                  EXECUTE FROM IS DONE            20450000
.*                                                                      20650000
.* ******************************************************************** 20700000
.* *  BEGIN BUILD FOR LIST FORM OF MACRO                                20750000
.* ******************************************************************** 20800000
.*                                                                      20850000
.L1      ANOP                                                           20900000
&L       DS    0F                                                       20950000
         DC    CL4'PREL'                EBCDIC 'PREL' FOR PARTREL       21000000
         DC    AL2(PRL&NO.E-&L)         LENGTH OF PARAMETER LIST        21050000
         DC    H'0'                     ERROR CODE RETURNED FROM        21100000
.*                                        PARTIAL RELEASE               21150000
.*                                                               3 @01D 21200000
.L2      ANOP                                                           21383200
         DC    AL1(&OMASK1)             PARAMETER FLAG BYTE1       @03C 21386500
         DC    AL1(&OMASK2)             PARAMETER FLAG BYTE2       @03A 21389800
.L3      ANOP                                                           21393100
         DC    XL2'00'                  RESERVED                        21396400
.*                                                                      21399700
         AIF   (&DSNA).L4               IF DSN=ADDR, BRANCH             21403000
         DC    A(0)                     ADDRESS OF DATA SET NAME        21406300
         AGO   .L5                      BRANCH AROUND DSN=ADDR          21409600
.L4      ANOP                                                           21412900
         DC    A(&DSN)                  ADDRESS OF DATA SET NAME        21416500
.*                                                                      21450000
.L5      ANOP                                                           21500000
         DC    A(0)                     UCB ADDRESS                     21550000
.*                                                                 @03A 21575000
         AIF   (&TRKSA).L6              IF VSAMTRKS=ADDR, BRANCH   @03A 21600000
         DC    A(0)                     ADDRESS OF VSAMTRKS        @03A 21625000
         AGO   .L7                      BR AROUND VSAMTRKS=ADDR    @03A 21650000
.L6      ANOP                                                      @03A 21675000
         DC    A(&VSAMTRKS)             ADDRESS OF VSAMTRKS        @03A 21700000
.L7      ANOP                                                      @03A 21725000
         DC    F'0'                     CATALOG REASON CODE, ONLY  @03A 21750000
*                                       VALID WHEN CATALOG FAILED  @03A 21775000
*                                       THE PARTREL REQUEST FOR A  @03A 21800000
*                                       VSAM DATASET.              @03A 21825000
*                                                                  @03A 21850000
         DC    F'0'                     DADSM DIAG INFO.           @L1A 21862500
.*                                                                 @03A 21875000
PRL&NO.E EQU   *                        END OF PARTREL PARM LIST        21900000
.*                                                                      22100000
.FINISH  ANOP                                                           22950000
         MEND                                                           23000000
**/ PARTREL: MACRO KEYS(0:1(DSN_NAME,DSN_ADDR),                         23050000
*                       MODE,                                           23100000
*                       RETCODE,                                        23150000
*                       RSNCODE,                                        23200000
*                       CATALOG_REASON_CODE,                            23250000
*                       DIAGNOSTIC_CODE,                                23275000
*                       0:1(UCB_NAME,UCB_ADDR),                         23300000
*                       TIOT,                                           23350000
*                       ERASE,                                          23400000
*                       VSAM_TYPE,                                      23450000
*                       VSAM_FORMAT,                                    23500000
*                       VSAM_CALLER,                                    23550000
*                       VSAM_SECURITY,                                  23600000
*                       0:1(VSAM_TRACKS_NAME,VSAM_TRACKS_ADDR),         23650000
*                       MF);                                            23700000
*  ANS('?' || MACLABEL || ' PARTRELP ' || MACKEYS || ';') RESCAN SKIP;  23750000
* %END PARTREL;                                                         23800000
