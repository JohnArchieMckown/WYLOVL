*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  MCSOPMSG                              -90/11/29-<1> * 00000400
*                                                                     * 00000500
*01* PROPRIETARY STATEMENT:                                           * 00000600
*                                                                     * 00000700
*     5695-047                                                        * 00000800
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00000900
*     (C) COPYRIGHT IBM CORP. 1991                                    * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*                                                                     * 00001200
* STATUS= HBB4420                                                     * 00001300
*                                                                     * 00001400
*01* DESCRIPTIVE NAME:  MCS Operator Message Service                  * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The MCSOPMSG macro is used to retrieve the address and alet of * 00002000
*      a message when posted by Comm Task.  The message delivered via * 00002100
*      the GETMSG service can be qualified by search criteria such as * 00002200
*      CONSID, CART, and MASK, if so desired.  The RESUME service     * 00002300
*      allows queuing to this operator to be resumed, if the queuing  * 00002400
*      was previously disabled.                                       * 00002500
*                                                                     * 00002600
*01* INVOCATION REQUIREMENTS:                                         * 00002700
*                                                                     * 00002800
*                                                                     * 00002900
*      Execution Mode:   Task mode.                                   * 00003000
*                                                                     * 00003100
*      Authorization:    Supervisor state.  Any PSW key.              * 00003200
*                                                                     * 00003300
*      Addressing Mode:  31 bit addressing mode.                      * 00003400
*                                                                     * 00003500
*      ASC mode:         Access Register ASC mode.                    * 00003600
*                                                                     * 00003700
*      Serialization:    None.                                        * 00003800
*                                                                     * 00003900
*      Restrictions:     None.                                        * 00004000
*                                                                     * 00004100
*                                                                     * 00004200
*01* INVOCATION FORMAT:                                               * 00004300
*                                                                     * 00004400
*[xlabel]  MCSOPMSG    REQUEST=RESUME                                * 00004500
*                     ,REQUEST=GETMSG                                * 00004600
*                        [,CMDRESP=NO]                               * 00004700
*                        [,CMDRESP=YES                               * 00004800
*                             [,CART=xcart|NULL                     * 00004900
*                                 [,MASK=xmask|NULL]]]              * 00005000
*                      ,CONSID=xconsid                                * 00005100
*                     [,RTNCODE=xrtncode]                             * 00005200
*                     [,RSNCODE=xrsncode]                             * 00005300
*                    [,MF=S]                                         * 00005400
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00005500
*                    [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]            * 00005600
*                    [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]            * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*      Where:                                                         * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*      [xlabel]                                                       * 00006300
*          is an optional 1 to 8 alphanumeric character input string, * 00006400
*          starting in column 1, that is the assembler label on the   * 00006500
*          MCSOPMSG macro.                                            * 00006600
*          DEFAULT: Null label.                                       * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*      REQUEST=RESUME|GETMSG                                        * 00007100
*          is a required keyword input that indicates the type of     * 00007200
*          request being made.                                        * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*          REQUEST=RESUME                                             * 00007600
*              Indicates that queuing will resume.                    * 00007700
*                                                                     * 00007800
*          REQUEST=GETMSG                                             * 00007900
*              Indicates that a message is requested.                 * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*              [CMDRESP=NO|YES]                                     * 00008300
*                  is an optional keyword input that indicates the    * 00008400
*                  type of message search being requested.            * 00008500
*                  DEFAULT: NO                                        * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*                  [CMDRESP=NO]                                       * 00008900
*                      Indicates that the first message will be       * 00009000
*                      obtained.                                      * 00009100
*                                                                     * 00009200
*                  [CMDRESP=YES                                       * 00009300
*                      Indicates a search will occur.                 * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*                      [CART=xcart|NULL                             * 00009700
*                          is the name (RX-type), or address in       * 00009800
*                          register (2)-(12), of an optional 8        * 00009900
*                          character input that indicates the CART to * 00010000
*                          use to search for the next message.        * 00010100
*                          DEFAULT: NULL                              * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*                          [MASK=xmask|NULL]]]                      * 00010500
*                              is the name (RX-type), or address in   * 00010600
*                              register (2)-(12), of an optional 8    * 00010700
*                              character input that indicates the     * 00010800
*                              mask to be ANDed with the CART.        * 00010900
*                              DEFAULT: NULL                          * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*      CONSID=xconsid                                                 * 00011900
*          is the name (RX-type), or address in register (2)-(12), of * 00012000
*          a required fullword input that specifies the 4 byte        * 00012100
*          console ID.                                                * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*      [RTNCODE=xrtncode]                                             * 00012600
*          is the name (RX-type) of an optional fullword output       * 00012700
*          variable, or register (2)-(12), into which the return code * 00012800
*          is to be copied from GPR 15.                               * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*      [RSNCODE=xrsncode]                                             * 00013300
*          is the name (RX-type) of an optional fullword output       * 00013400
*          variable, or register (2)-(12), into which the reason code * 00013500
*          is to be copied from GPR 0.                                * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*      [MF=S|L|M|E]                                                 * 00014000
*          is an optional keyword input which specifies the macro     * 00014100
*          form.                                                      * 00014200
*          DEFAULT: S                                                 * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*          [MF=S]                                                     * 00014600
*              specifies the standard form of the macro.  The "S"     * 00014700
*              form generates code to put the parameters into an      * 00014800
*              in-line parameter list and invoke the desired service. * 00014900
*              Full checking for required macro keys is done along    * 00015000
*              with supplying defaults for optional parameters that   * 00015100
*              are not specified.                                     * 00015200
*                                                                     * 00015300
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00015400
*              specifies the list form of the macro.  The "L" form    * 00015500
*              defines an area to be used for the parameter list.     * 00015600
*              Any other macro parameters are flagged as errors.      * 00015700
*                                                                     * 00015800
*            ,xmfctrl                                                 * 00015900
*              is a required input.  It is the name (RX-type) of a    * 00016000
*              storage area for the parameter list.                   * 00016100
*                                                                     * 00016200
*            ,xmfattr|0D                                            * 00016300
*              is an optional 60 character input  string that varies  * 00016400
*              from 1 to 60 characters, that contains any special     * 00016500
*              attributes for the parameter list.                     * 00016600
*              DEFAULT: 0D which indicates the parameter list is to   * 00016700
*              be aligned on a double word boundary.                  * 00016800
*                                                                     * 00016900
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00017000
*              specifies the modify form of the macro.  The "M" form  * 00017100
*              generates code to put the parameters into the          * 00017200
*              parameter list specified by xmfctrl.                   * 00017300
*                                                                     * 00017400
*            ,xmfctrl                                                 * 00017500
*              is a required input.  It is the name (RX-type), or     * 00017600
*              address in register (2)-(12), of a storage area for    * 00017700
*              the parameter list.                                    * 00017800
*                                                                     * 00017900
*            ,COMPLETE|NOCHECK]                                     * 00018000
*              is an optional keyword input which specifies the       * 00018100
*              degree of macro parameter syntax checking.             * 00018200
*              DEFAULT: COMPLETE                                      * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*              COMPLETE   Checking for required macro keys is done    * 00018600
*                        and defaults are supplied for optional       * 00018700
*                        parameters that were not specified (See      * 00018800
*                        Macro Usage Note 2).                         * 00018900
*                                                                     * 00019000
*              NOCHECK   Checking for required macro keys is not done * 00019100
*                        nor are defaults supplied for optional       * 00019200
*                        parameters that were not specified.          * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00019600
*              specifies the execute form of the macro.  The "E" form * 00019700
*              generates code to put the parameters into the          * 00019800
*              parameter list specified by xmfctrl and invoke the     * 00019900
*              desired service.                                       * 00020000
*                                                                     * 00020100
*            ,xmfctrl                                                 * 00020200
*              is a required input.  It is the name (RX-type), or     * 00020300
*              address in register (2)-(12), of a storage area for    * 00020400
*              the parameter list.                                    * 00020500
*                                                                     * 00020600
*            ,COMPLETE|NOCHECK                                      * 00020700
*              is an optional keyword input which specifies the       * 00020800
*              degree of macro parameter syntax checking.             * 00020900
*              DEFAULT: COMPLETE                                      * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*              COMPLETE   Checking for required macro keys is done    * 00021300
*                        and defaults are supplied for optional       * 00021400
*                        parameters that were not specified (See      * 00021500
*                        Macro Usage Note 2).                         * 00021600
*                                                                     * 00021700
*              NOCHECK   Checking for required macro keys is not done * 00021800
*                        nor are defaults supplied for optional       * 00021900
*                        parameters that were not specified.          * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*01* RETURN CODES:                                                    * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*            0    Successful completion.                              * 00022800
*                                                                     * 00022900
*            4    Successful processing, but message queuing is       * 00023000
*                 disabled.  Or successful processing, but message    * 00023100
*                 queuing was already enabled.                        * 00023200
*                                                                     * 00023300
*            8    No messages available for specified search          * 00023400
*                 criteria.                                           * 00023500
*                                                                     * 00023600
*            12   No messages available for specified search          * 00023700
*                 criteria, and message queuing was disabled.         * 00023800
*                                                                     * 00023900
*            16   Invalid console ID.                                 * 00024000
*                                                                     * 00024100
*            20   Improper MCSOPMSG call.                             * 00024200
*                                                                     * 00024300
*            24   Internal Abend.                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*01* REASON CODES:                                                    * 00024700
*                                                                     * 00024800
*       REASON    RETURN                                              * 00024900
*       CODE      CODE      DESCRIPTION                               * 00025000
*                                          * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*              1  8         Queue is being fixed                      * 00025400
*                                                                     * 00025500
*              1  16        Console is not active                     * 00025600
*                                                                     * 00025700
*              2  16        Console was not activated by this address * 00025800
*                           space                                     * 00025900
*                                                                     * 00026000
*              1  20        Invalid parameter list                    * 00026100
*                                                                     * 00026200
*              2  20        Caller not in AR mode                     * 00026300
*                                                                     * 00026400
*              3  20        Another  MCSOPMSG  request is in progress * 00026500
*                           for this console.                         * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00026900
*                                                                     * 00027000
*02*   PROCESSOR:  ASSEM                                              * 00027100
*                                                                     * 00027200
*01* COMPONENT:  SC1CK                                                * 00027300
*                                                                     * 00027400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00027500
*                                                                     * 00027600
*01* MACRO USAGE NOTES:                                               * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00028000
*        global macro variable.  Any value other than 'NO' will       * 00028100
*        result in the macro expansion being printed.  The default is * 00028200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00028300
*        variable should be set.                                      * 00028400
*                                                                     * 00028500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*    2.  When using the NOCHECK option in conjunction with the Modify * 00028900
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00029000
*        Modify   or  Execute  form  invocation  which  specifies  or * 00029100
*        defaults  to  the  COMPLETE  option.   This insures that the * 00029200
*        parameter list is initialized completely.                    * 00029300
*                                                                     * 00029400
****** END OF SPECIFICATIONS *****************************************/ 00029500
*/********************************************************************* 00029600
         MACRO                                                          00029700
&XLABEL  MCSOPMSG &REQUEST=,&CMDRESP=,&CART=,&MASK=,&CONSID=,&RTNCODE=,*00029800
               &RSNCODE=,&MF=                                           00029900
.*                                                                      00030000
*              MACDATE -90/11/29-<1>                                    00030100
.*                                                                      00030200
.*******************************************************************    00030300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00030400
.*******************************************************************    00030500
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00030600
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00030700
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00030800
.*                                                                      00030900
              GBLC  &ZMCSOPMSG  YES=MACRO USED AT LEAST ONCE            00031000
.*******************************************************************    00031100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00031200
.*******************************************************************    00031300
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00031400
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00031500
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00031600
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00031700
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00031800
              LCLA  &ZAWRK      USED AS A WORK AREA                     00031900
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00032000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00032100
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00032200
              LCLA  &ZMACRET    MACRO RETURN CODE                       00032300
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00032400
.*                                                                      00032500
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00032600
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00032700
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00032800
.********************************************************************   00032900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00033000
.********************************************************************   00033100
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00033200
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00033300
.*                                                                      00033400
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00033500
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00033600
              SPLEVEL  TEST                                             00033700
.ZSYS2        ANOP  ,                                                   00033800
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00033900
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00034000
              SYSSTATE TEST                                             00034100
              AGO   .ZSYS4                                              00034200
.ZSYS3        ANOP  ,                                                   00034300
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00034400
.ZSYS4        ANOP  ,                                                   00034500
.*******************************************************************    00034600
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00034700
.*******************************************************************    00034800
              LCLC  &XREQUEST   ++ VALUE                                00034900
              LCLC  &XCMDRESP   ++ VALUE                                00035000
              LCLC  &XCART      ++ NAME                                 00035100
              LCLC  &XMASK      ++ NAME                                 00035200
              LCLC  &XCONSID    ++ NAME                                 00035300
              LCLC  &XRTNCODE   ++ NAME                                 00035400
              LCLC  &XRSNCODE   ++ NAME                                 00035500
              LCLC  &XMF        ++ VALUE                                00035600
              LCLC  &XMFCTRL    ++ NAME                                 00035700
              LCLC  &XMFATTR    ++ VALUE                                00035800
              LCLC  &XMFSCK     ++ VALUE                                00035900
.*******************************************************************    00036000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00036100
.*******************************************************************    00036200
              LCLC  &ZXREQUEST  ++ INPUT VALUE                          00036300
              LCLC  &ZXCMDRESP  ++ INPUT VALUE                          00036400
              LCLC  &ZXCART     ++ INPUT NAME                           00036500
              LCLC  &ZXMASK     ++ INPUT NAME                           00036600
              LCLC  &ZXCONSID   ++ INPUT NAME                           00036700
              LCLC  &ZXRTNCODE  ++ OUTPUT NAME                          00036800
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00036900
              LCLC  &ZXMF       ++ INPUT VALUE                          00037000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00037100
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00037200
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00037300
.********************************************************************   00037400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00037500
.********************************************************************   00037600
              ACTR  10000                                               00037700
.*------------------------------------------------------------------    00037800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00037900
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00038000
.*-------------------------------------------------------------------   00038100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00038200
.ZG28         ANOP  ,                                                   00038300
              AIF   ('&MF(1)' NE 'S').ZG29                              00038400
&XMF          SETC  'S'         SET KEYWORD                             00038500
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00038600
              AIF   (N'&MF LE 1).ZG28A          CK NUM                  00038700
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00038800
&ZMS          SETC  '&ZMS.&MF"'                                         00038900
&ZMS          SETC  '&ZMS "MF"'                                         00039000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00039100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00039200
.ZG28A        ANOP  ,                                                   00039300
.*-------------------------------------------------------------------   00039400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00039500
.ZG29         ANOP  ,                                                   00039600
              AIF   ('&MF(1)' NE 'L').ZG36                              00039700
&XMF          SETC  'L'         SET KEYWORD                             00039800
              AIF   (N'&MF LE 3).ZG29A          CK NUM                  00039900
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00040000
&ZMS          SETC  '&ZMS.&MF"'                                         00040100
&ZMS          SETC  '&ZMS "MF"'                                         00040200
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00040300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00040400
.ZG29A        ANOP  ,                                                   00040500
.*-------------------------------------------------------------------   00040600
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00040700
              AIF   (N'&SYSLIST NE 0).ZG29B     POSITIONALS?            00040800
              AIF   ('&REQUEST' NE '').ZG29B    KEYS?                   00040900
              AIF   ('&CMDRESP' NE '').ZG29B    KEYS?                   00041000
              AIF   ('&CART' NE '').ZG29B       KEYS?                   00041100
              AIF   ('&MASK' NE '').ZG29B       KEYS?                   00041200
              AIF   ('&CONSID' NE '').ZG29B     KEYS?                   00041300
              AIF   ('&RTNCODE' NE '').ZG29B    KEYS?                   00041400
              AIF   ('&RSNCODE' NE '').ZG29B    KEYS?                   00041500
              AGO    .ZG29C     INVOCATION OKAY                         00041600
.ZG29B        ANOP  ,                                                   00041700
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         00041800
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   00041900
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              00042000
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        00042100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00042200
.ZG29C        ANOP  ,                                                   00042300
.*-------------------------------------------------------------------   00042400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00042500
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00042600
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00042700
              AIF   (N'&MF(2) GT 1).ZG31B       MULTI PARMS             00042800
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00042900
.ZG31B        AIF   (K'&MF(2) GT 0).ZG31C                               00043000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00043100
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00043200
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00043300
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00043400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00043500
.ZG31C        ANOP  ,                                                   00043600
.*-------------------------------------------------------------------   00043700
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00043800
              AIF   (K'&ZXMFCTRL LE 0).ZG31P    NOT I/O                 00043900
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG31P                      00044000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00044100
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00044200
&ZMS          SETC  '&ZMS.&MF"'                                         00044300
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00044400
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00044500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00044600
.ZG31P        ANOP  ,                                                   00044700
.*-------------------------------------------------------------------   00044800
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00044900
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00045000
&XMFATTR      SETC  '0D'        SET DEFAULT                             00045100
              AIF   (K'&MF(3) LE 0).ZG34B       PARM                    00045200
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00045300
              AIF   (N'&MF(3) GT 1).ZG34B       MULTI PARMS             00045400
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00045500
.ZG34B        ANOP  ,                                                   00045600
.*-------------------------------------------------------------------   00045700
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00045800
              AIF   (K'&ZXMFATTR LE 0).ZG34P    NOT I/O                 00045900
              AIF   ('&XMFATTR'(1,1) NE '(').ZG34P                      00046000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00046100
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00046200
&ZMS          SETC  '&ZMS.&MF"'                                         00046300
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00046400
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00046500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00046600
.ZG34P        ANOP  ,                                                   00046700
.*-------------------------------------------------------------------   00046800
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00046900
              AIF   (K'&ZXMFATTR LE 0).ZG34S    NOT I/O                 00047000
              AIF   (K'&XMFATTR LE 60).ZG34S    LNG OK                  00047100
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00047200
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00047300
&ZMS          SETC  '&ZMS.&MF"'                                         00047400
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00047500
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00047600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00047700
.ZG34S        ANOP  ,                                                   00047800
.*-------------------------------------------------------------------   00047900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00048000
.ZG36         ANOP  ,                                                   00048100
              AIF   ('&MF(1)' NE 'M').ZG45                              00048200
&XMF          SETC  'M'         SET KEYWORD                             00048300
              AIF   (N'&MF LE 3).ZG36A          CK NUM                  00048400
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00048500
&ZMS          SETC  '&ZMS.&MF"'                                         00048600
&ZMS          SETC  '&ZMS "MF"'                                         00048700
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00048800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00048900
.ZG36A        ANOP  ,                                                   00049000
.*-------------------------------------------------------------------   00049100
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00049200
              AIF   ('&RTNCODE' NE '').ZG36B    OUTPUT SPECIFIED?       00049300
              AGO    .ZG36C     INVOCATION OKAY                         00049400
.ZG36B        ANOP  ,                                                   00049500
&ZMS          SETC  'THE "M" FORM OF "MF" CANNOT'  *MFMOA* MNOTE        00049600
&ZMS          SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'             00049700
&ZMS          SETC  '&ZMS SPECIFIED ON THE INVOCATION:'                 00049800
              MNOTE 8,' &ZMS "RTNCODE".'        INVALID KEY             00049900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00050000
.ZG36C        ANOP  ,                                                   00050100
.*-------------------------------------------------------------------   00050200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00050300
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00050400
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00050500
              AIF   (N'&MF(2) GT 1).ZG38B       MULTI PARMS             00050600
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00050700
.ZG38B        AIF   (K'&MF(2) GT 0).ZG38C                               00050800
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00050900
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 00051000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00051100
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00051200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00051300
.ZG38C        ANOP  ,                                                   00051400
.*-------------------------------------------------------------------   00051500
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00051600
              AIF   (K'&ZXMFCTRL LE 0).ZG38R    NOT I/O                 00051700
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG38R                      00051800
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00051900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                        00052000
              AIF   (K'&ZCGPR GT 2).ZG38Q                               00052100
              AIF   ('&ZCGPR' EQ '0').ZG38Q                             00052200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00052300
              AIF   (T'&ZCGPR NE 'N').ZG38Q     INVALID REG NAME        00052400
.ZG38P        ANOP  ,                                                   00052500
              AIF   (T'&ZCGPR NE 'N').ZG38R     NON NUMERIC             00052600
              AIF   ('&ZCGPR' LT '2').ZG38Q                             00052700
              AIF   ('&ZCGPR' LE '12').ZG38R                            00052800
.ZG38Q        ANOP  ,                                                   00052900
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00053000
&ZMS          SETC  '&ZMS.&MF"'                                         00053100
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00053200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00053300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00053400
.ZG38R        ANOP  ,                                                   00053500
.*-------------------------------------------------------------------   00053600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00053700
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00053800
.ZG42A   AIF   ('&MF(3)' NE 'COMPLETE').ZG43A                           00053900
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00054000
.*-------------------------------------------------------------------   00054100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00054200
.ZG43A   AIF   ('&MF(3)' NE 'NOCHECK').ZG44A                            00054300
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00054400
.*-------------------------------------------------------------------   00054500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00054600
.ZG44A        AIF   (K'&XMFSCK GT 0).ZG44C      KEYWORD                 00054700
              AIF   (K'&MF(3) LE 0).ZG44B                               00054800
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00054900
&ZMS          SETC  '&ZMS.&MF"'                                         00055000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00055100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00055200
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00055300
              MNOTE 8,' &ZMS OR "NOCHECK".'                             00055400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00055500
.ZG44B        ANOP  ,                                                   00055600
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00055700
.ZG44C        ANOP  ,                                                   00055800
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00055900
.*-------------------------------------------------------------------   00056000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00056100
.ZG45         ANOP  ,                                                   00056200
              AIF   ('&MF(1)' NE 'E').ZG54                              00056300
&XMF          SETC  'E'         SET KEYWORD                             00056400
              AIF   (N'&MF LE 3).ZG45A          CK NUM                  00056500
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00056600
&ZMS          SETC  '&ZMS.&MF"'                                         00056700
&ZMS          SETC  '&ZMS "MF"'                                         00056800
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00056900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00057000
.ZG45A        ANOP  ,                                                   00057100
.*-------------------------------------------------------------------   00057200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00057300
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00057400
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00057500
              AIF   (N'&MF(2) GT 1).ZG47B       MULTI PARMS             00057600
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00057700
.ZG47B        AIF   (K'&MF(2) GT 0).ZG47C                               00057800
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00057900
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00058000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00058100
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00058200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00058300
.ZG47C        ANOP  ,                                                   00058400
.*-------------------------------------------------------------------   00058500
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00058600
              AIF   (K'&ZXMFCTRL LE 0).ZG47R    NOT I/O                 00058700
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG47R                      00058800
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00058900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                        00059000
              AIF   (K'&ZCGPR GT 2).ZG47Q                               00059100
              AIF   ('&ZCGPR' EQ '0').ZG47Q                             00059200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00059300
              AIF   (T'&ZCGPR NE 'N').ZG47Q     INVALID REG NAME        00059400
.ZG47P        ANOP  ,                                                   00059500
              AIF   (T'&ZCGPR NE 'N').ZG47R     NON NUMERIC             00059600
              AIF   ('&ZCGPR' LT '2').ZG47Q                             00059700
              AIF   ('&ZCGPR' LE '12').ZG47R                            00059800
.ZG47Q        ANOP  ,                                                   00059900
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00060000
&ZMS          SETC  '&ZMS.&MF"'                                         00060100
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00060200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00060300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00060400
.ZG47R        ANOP  ,                                                   00060500
.*-------------------------------------------------------------------   00060600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00060700
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00060800
.ZG51A   AIF   ('&MF(3)' NE 'COMPLETE').ZG52A                           00060900
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00061000
.*-------------------------------------------------------------------   00061100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00061200
.ZG52A   AIF   ('&MF(3)' NE 'NOCHECK').ZG53A                            00061300
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00061400
.*-------------------------------------------------------------------   00061500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00061600
.ZG53A        AIF   (K'&XMFSCK GT 0).ZG53C      KEYWORD                 00061700
              AIF   (K'&MF(3) LE 0).ZG53B                               00061800
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00061900
&ZMS          SETC  '&ZMS.&MF"'                                         00062000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00062100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00062200
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00062300
              MNOTE 8,' &ZMS OR "NOCHECK".'                             00062400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00062500
.ZG53B        ANOP  ,                                                   00062600
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00062700
.ZG53C        ANOP  ,                                                   00062800
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00062900
.*------------------------------------------------------------------    00063000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00063100
.ZG54         ANOP  ,                                                   00063200
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00063300
              AIF   (K'&XMF GT 0).ZG54E         VALID ARG               00063400
              AIF   (T'&MF EQ 'O').ZG54D        OMITTED                 00063500
&ZASYSLNDX    SETA  0                                                   00063600
.ZG54A        ANOP  ,           POSITIONAL MACRO KEY                    00063700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00063800
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG54C                    00063900
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'MF').ZG54A              00064000
.ZG54B        ANOP  ,                                                   00064100
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00064200
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00064300
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00064400
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00064500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00064600
              AGO   .ZG54E                                              00064700
.ZG54C        ANOP  ,                                                   00064800
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00064900
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00065000
&ZMS          SETC  '&ZMS.&MF"'                                         00065100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00065200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00065300
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00065400
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00065500
&ZMS          SETC  '&ZMS "M",'                 VALID KEYWORD           00065600
              MNOTE 8,' &ZMS OR "E".'                                   00065700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00065800
              AGO   .ZG54E                                              00065900
.ZG54D        ANOP  ,                                                   00066000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00066100
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00066200
.ZG54E        ANOP  ,                                                   00066300
.********************************************************************   00066400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00066500
.********************************************************************   00066600
              ACTR  10000                                               00066700
.*-------------------------------------------------------------------   00066800
.***AG.MF03 MF=(SLME)                                                   00066900
              AIF   ('&XMF' EQ 'L').ZGMFX                               00067000
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00067100
.*------------------------------------------------------------------    00067200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067300
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00067400
.*-------------------------------------------------------------------   00067500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067600
.ZG3          ANOP  ,                                                   00067700
              AIF   (K'&REQUEST(1) LE 0).ZG3A                           00067800
              AIF   ('&REQUEST(1)' NE 'RESUME').ZG4                     00067900
&XREQUEST     SETC  'RESUME'    SET KEYWORD                             00068000
              AIF   (N'&REQUEST LE 1).ZG3A      CK NUM                  00068100
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00068200
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00068300
&ZMS          SETC  '&ZMS "REQUEST"'                                    00068400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00068500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00068600
.ZG3A         ANOP  ,                                                   00068700
.*------------------------------------------------------------------    00068800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068900
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00069000
.ZG3A0        AIF   (K'&CMDRESP LE 0).ZG3A1     OK                      00069100
&ZCVAL        SETC '&ZCVAL CMDRESP'             INCORRECT KEY USED      00069200
.ZG3A1        AIF   (K'&CART LE 0).ZG3A2        OK                      00069300
&ZCVAL        SETC '&ZCVAL CART'                INCORRECT KEY USED      00069400
.ZG3A2        AIF   (K'&MASK LE 0).ZG3A3        OK                      00069500
&ZCVAL        SETC '&ZCVAL MASK'                INCORRECT KEY USED      00069600
.ZG3A3        AIF   (K'&ZCVAL LE 0).ZG3A4       OK                      00069700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00069800
&ZMS          SETC  '"REQUEST'  *KMEIA* MNOTE                           00069900
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00070000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00070100
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00070200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00070300
.ZG3A4        ANOP  ,                                                   00070400
.*-------------------------------------------------------------------   00070500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00070600
.ZG4          ANOP  ,                                                   00070700
              AIF   ('&REQUEST(1)' NE 'GETMSG').ZG16                    00070800
&XREQUEST     SETC  'GETMSG'    SET KEYWORD                             00070900
              AIF   (N'&REQUEST LE 1).ZG4A      CK NUM                  00071000
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00071100
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00071200
&ZMS          SETC  '&ZMS "REQUEST"'                                    00071300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00071400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00071500
.ZG4A         ANOP  ,                                                   00071600
.*------------------------------------------------------------------    00071700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00071800
&XCMDRESP     SETC  ''          INITIALIZE XVARIABLE                    00071900
.*-------------------------------------------------------------------   00072000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00072100
.ZG7          ANOP  ,                                                   00072200
              AIF   (K'&CMDRESP(1) LE 0).ZG7A                           00072300
              AIF   ('&CMDRESP(1)' NE 'NO').ZG8                         00072400
&XCMDRESP     SETC  'NO'        SET KEYWORD                             00072500
              AIF   (N'&CMDRESP LE 1).ZG7A      CK NUM                  00072600
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           00072700
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00072800
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00072900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00073000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00073100
.ZG7A         ANOP  ,                                                   00073200
.*------------------------------------------------------------------    00073300
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00073400
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00073500
.ZG7A0        AIF   (K'&CART LE 0).ZG7A1        OK                      00073600
&ZCVAL        SETC '&ZCVAL CART'                INCORRECT KEY USED      00073700
.ZG7A1        AIF   (K'&MASK LE 0).ZG7A2        OK                      00073800
&ZCVAL        SETC '&ZCVAL MASK'                INCORRECT KEY USED      00073900
.ZG7A2        AIF   (K'&ZCVAL LE 0).ZG7A3       OK                      00074000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00074100
&ZMS          SETC  '"CMDRESP'  *KMEIA* MNOTE                           00074200
&ZMS          SETC  '&ZMS.=&CMDRESP"'                                   00074300
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00074400
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00074500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00074600
.ZG7A3        ANOP  ,                                                   00074700
.*-------------------------------------------------------------------   00074800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00074900
.ZG8          ANOP  ,                                                   00075000
              AIF   ('&CMDRESP(1)' NE 'YES').ZG15                       00075100
&XCMDRESP     SETC  'YES'       SET KEYWORD                             00075200
              AIF   (N'&CMDRESP LE 1).ZG8A      CK NUM                  00075300
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           00075400
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00075500
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00075600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00075700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00075800
.ZG8A         ANOP  ,                                                   00075900
.*----------------------------------------------------------------***   00076000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00076100
              AIF   (N'&CART LE 1).ZG10A        CK NUM                  00076200
&ZMS          SETC  '"CART='    *KPOSA* MNOTE                           00076300
&ZMS          SETC  '&ZMS.&CART"'                                       00076400
&ZMS          SETC  '&ZMS "CART"'                                       00076500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00076600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00076700
.ZG10A        ANOP  ,                                                   00076800
.*-------------------------------------------------------------------   00076900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00077000
&ZXCART       SETC  'INPUT'     SET IN/OUTPUT                           00077100
&XCART        SETC  'NULL'      SET DEFAULT                             00077200
              AIF   (K'&CART(1) LE 0).ZG10B     PARM                    00077300
&XCART        SETC  '&CART(1)'  SET XVARIABLE                           00077400
              AIF   (N'&CART GT 1).ZG10B        MULTI PARMS             00077500
&XCART        SETC  '&CART'     SET XVARIABLE                           00077600
.ZG10B        ANOP  ,                                                   00077700
.*-------------------------------------------------------------------   00077800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00077900
              AIF   (K'&ZXCART LE 0).ZG10R      NOT I/O                 00078000
              AIF   ('&XCART' EQ 'NULL').ZG10R                          00078100
              AIF   ('&XCART'(1,1) NE '(').ZG10R                        00078200
&ZCGPR        SETC  '&XCART'(2,K'&XCART-2)                              00078300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00078400
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00078500
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00078600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00078700
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00078800
.ZG10P        ANOP  ,                                                   00078900
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00079000
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00079100
              AIF   ('&ZCGPR' LE '12').ZG10R                            00079200
.ZG10Q        ANOP  ,                                                   00079300
&ZMS          SETC  '"CART='    *KGPRA* MNOTE                           00079400
&ZMS          SETC  '&ZMS.&CART"'                                       00079500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00079600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00079700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00079800
.ZG10R        ANOP  ,                                                   00079900
.*----------------------------------------------------------------***   00080000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00080100
              AIF   (N'&MASK LE 1).ZG12A        CK NUM                  00080200
&ZMS          SETC  '"MASK='    *KPOSA* MNOTE                           00080300
&ZMS          SETC  '&ZMS.&MASK"'                                       00080400
&ZMS          SETC  '&ZMS "MASK"'                                       00080500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00080600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00080700
.ZG12A        ANOP  ,                                                   00080800
.*-------------------------------------------------------------------   00080900
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00081000
&XMASK        SETC  'NULL'      SET DEFAULT                             00081100
              AIF   (K'&MASK(1) LE 0).ZG12C     PARM                    00081200
&XMASK        SETC  '&MASK(1)'  SET XVARIABLE                           00081300
              AIF   (N'&MASK GT 1).ZG12B        MULTI PARMS             00081400
&XMASK        SETC  '&MASK'     SET XVARIABLE                           00081500
.ZG12B        AIF   (K'&CART(1) GT 0).ZG12C     KEY                     00081600
&ZMS          SETC  '"MASK'     *KDEPA* MNOTE                           00081700
&ZMS          SETC  '&ZMS.=&MASK"'                                      00081800
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     00081900
&ZMS          SETC  '&ZMS '                                             00082000
&ZMS          SETC  '&ZMS "CART"'                                       00082100
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        00082200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00082300
.ZG12C        ANOP  ,                                                   00082400
&ZXMASK       SETC  'INPUT'     SET IN/OUTPUT                           00082500
.*-------------------------------------------------------------------   00082600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00082700
              AIF   (K'&ZXMASK LE 0).ZG12R      NOT I/O                 00082800
              AIF   ('&XMASK' EQ 'NULL').ZG12R                          00082900
              AIF   ('&XMASK'(1,1) NE '(').ZG12R                        00083000
&ZCGPR        SETC  '&XMASK'(2,K'&XMASK-2)                              00083100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                        00083200
              AIF   (K'&ZCGPR GT 2).ZG12Q                               00083300
              AIF   ('&ZCGPR' EQ '0').ZG12Q                             00083400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00083500
              AIF   (T'&ZCGPR NE 'N').ZG12Q     INVALID REG NAME        00083600
.ZG12P        ANOP  ,                                                   00083700
              AIF   (T'&ZCGPR NE 'N').ZG12R     NON NUMERIC             00083800
              AIF   ('&ZCGPR' LT '2').ZG12Q                             00083900
              AIF   ('&ZCGPR' LE '12').ZG12R                            00084000
.ZG12Q        ANOP  ,                                                   00084100
&ZMS          SETC  '"MASK='    *KGPRA* MNOTE                           00084200
&ZMS          SETC  '&ZMS.&MASK"'                                       00084300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00084400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00084500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00084600
.ZG12R        ANOP  ,                                                   00084700
.*------------------------------------------------------------------    00084800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084900
.ZG15         ANOP  ,                                                   00085000
&ZXCMDRESP    SETC  'INPUT'     SET IN/OUTPUT                           00085100
              AIF   (K'&XCMDRESP GT 0).ZG15E    VALID ARG               00085200
              AIF   (T'&CMDRESP EQ 'O').ZG15D   OMITTED                 00085300
&ZASYSLNDX    SETA  0                                                   00085400
.ZG15A        ANOP  ,           POSITIONAL MACRO KEY                    00085500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00085600
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG15C                    00085700
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CMDRESP').ZG15A         00085800
.ZG15B        ANOP  ,                                                   00085900
&ZXCMDRESP    SETC  ''          RESET IN/OUTPUT                         00086000
&ZMS          SETC  'THE "CMDRESP" KEY'         *KOPTA* MNOTE           00086100
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00086200
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00086300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00086400
              AGO   .ZG15E                                              00086500
.ZG15C        ANOP  ,                                                   00086600
&ZXCMDRESP    SETC  ''          RESET IN/OUTPUT                         00086700
&ZMS          SETC  '"CMDRESP='                 *KUKWA* MNOTE           00086800
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00086900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00087000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00087100
&ZMS          SETC  '&ZMS "NO"'                 VALID KEYWORD           00087200
              MNOTE 8,' &ZMS OR "YES".'                                 00087300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00087400
              AGO   .ZG15E                                              00087500
.ZG15D        ANOP  ,                                                   00087600
&XCMDRESP     SETC  'NO'        SET DEFAULT KEYWORD                     00087700
.ZG15E        ANOP  ,                                                   00087800
.*------------------------------------------------------------------    00087900
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00088000
.ZG16         ANOP  ,                                                   00088100
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00088200
              AIF   (K'&XREQUEST GT 0).ZG16E    VALID ARG               00088300
              AIF   (T'&REQUEST EQ 'O').ZG16D   OMITTED                 00088400
&ZASYSLNDX    SETA  0                                                   00088500
.ZG16A        ANOP  ,           POSITIONAL MACRO KEY                    00088600
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00088700
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C                    00088800
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'REQUEST').ZG16A         00088900
.ZG16B        ANOP  ,                                                   00089000
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00089100
&ZMS          SETC  'THE "REQUEST" KEY'         *KOPTA* MNOTE           00089200
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00089300
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00089400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00089500
              AGO   .ZG16E                                              00089600
.ZG16C        ANOP  ,                                                   00089700
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00089800
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           00089900
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00090000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00090100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00090200
&ZMS          SETC  '&ZMS "RESUME"'             VALID KEYWORD           00090300
              MNOTE 8,' &ZMS OR "GETMSG".'                              00090400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090500
              AGO   .ZG16E                                              00090600
.ZG16D        ANOP  ,                                                   00090700
&XREQUEST     SETC  'RESUME'    SET DEFAULT KEYWORD                     00090800
.ZG16E        ANOP  ,                                                   00090900
.*------------------------------------------------------------------    00091000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091100
              AIF   (K'&REQUEST(1) GT 0).ZG16F  PARM                    00091200
&XREQUEST     SETC  ''          ENSURE NULL KEYWORD                     00091300
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00091400
&ZMS          SETC  'THE'       *KRKWA* MNOTE                           00091500
&ZMS          SETC  '&ZMS "REQUEST" KEY AND ITS ARGUMENT ARE'           00091600
&ZMS          SETC  '&ZMS REQUIRED.'                                    00091700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00091800
&ZMS          SETC  '&ZMS "RESUME"'             VALID KEYWORD           00091900
              MNOTE 8,' &ZMS OR "GETMSG".'                              00092000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00092100
.ZG16F        ANOP  ,                                                   00092200
.*----------------------------------------------------------------***   00092300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00092400
              AIF   (N'&CONSID LE 1).ZG18A      CK NUM                  00092500
&ZMS          SETC  '"CONSID='  *KPOSA* MNOTE                           00092600
&ZMS          SETC  '&ZMS.&CONSID"'                                     00092700
&ZMS          SETC  '&ZMS "CONSID"'                                     00092800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00092900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093000
.ZG18A        ANOP  ,                                                   00093100
.*-------------------------------------------------------------------   00093200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00093300
&ZXCONSID     SETC  'INPUT'     SET IN/OUTPUT                           00093400
&XCONSID      SETC  '&CONSID(1)'                SET XVARIABLE           00093500
              AIF   (N'&CONSID GT 1).ZG18B      MULTI PARMS             00093600
&XCONSID      SETC  '&CONSID'   SET XVARIABLE                           00093700
.ZG18B        AIF   (K'&CONSID(1) GT 0).ZG18C                           00093800
&ZXCONSID     SETC  ''          RESET IN/OUTPUT                         00093900
&ZMS          SETC  ' '         *KRQDA*                                 00094000
&ZMS          SETC  '&ZMS "CONSID" KEY AND ITS ARGUMENT'                00094100
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00094200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094300
.ZG18C        ANOP  ,                                                   00094400
.*-------------------------------------------------------------------   00094500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00094600
              AIF   (K'&ZXCONSID LE 0).ZG18R    NOT I/O                 00094700
              AIF   ('&XCONSID'(1,1) NE '(').ZG18R                      00094800
&ZCGPR        SETC  '&XCONSID'(2,K'&XCONSID-2)                          00094900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                        00095000
              AIF   (K'&ZCGPR GT 2).ZG18Q                               00095100
              AIF   ('&ZCGPR' EQ '0').ZG18Q                             00095200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00095300
              AIF   (T'&ZCGPR NE 'N').ZG18Q     INVALID REG NAME        00095400
.ZG18P        ANOP  ,                                                   00095500
              AIF   (T'&ZCGPR NE 'N').ZG18R     NON NUMERIC             00095600
              AIF   ('&ZCGPR' LT '2').ZG18Q                             00095700
              AIF   ('&ZCGPR' LE '12').ZG18R                            00095800
.ZG18Q        ANOP  ,                                                   00095900
&ZMS          SETC  '"CONSID='  *KGPRA* MNOTE                           00096000
&ZMS          SETC  '&ZMS.&CONSID"'                                     00096100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00096200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00096300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00096400
.ZG18R        ANOP  ,                                                   00096500
.*-------------------------------------------------------------------   00096600
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00096700
              AIF   ('&XMF' EQ 'M').ZG22        BYPASS IF MF=M          00096800
.*----------------------------------------------------------------***   00096900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00097000
              AIF   (N'&RTNCODE LE 1).ZG21A     CK NUM                  00097100
&ZMS          SETC  '"RTNCODE='                 *KPOSA* MNOTE           00097200
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00097300
&ZMS          SETC  '&ZMS "RTNCODE"'                                    00097400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00097500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00097600
.ZG21A        ANOP  ,                                                   00097700
.*-------------------------------------------------------------------   00097800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00097900
              AIF   (K'&RTNCODE(1) LE 0).ZG21C  NO PARM                 00098000
&ZXRTNCODE    SETC  'OUTPUT'    SET OUTPUT                              00098100
&XRTNCODE     SETC  '&RTNCODE(1)'               SET XVARIABLE           00098200
              AIF   (N'&RTNCODE GT 1).ZG21C     MULTIPLE PARMS          00098300
&XRTNCODE     SETC  '&RTNCODE'  SET XVARIABLE                           00098400
.ZG21C        ANOP  ,                                                   00098500
.*-------------------------------------------------------------------   00098600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00098700
              AIF   (K'&ZXRTNCODE LE 0).ZG21R   NOT I/O                 00098800
              AIF   ('&XRTNCODE'(1,1) NE '(').ZG21R                     00098900
&ZCGPR        SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                        00099000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                        00099100
              AIF   (K'&ZCGPR GT 2).ZG21Q                               00099200
              AIF   ('&ZCGPR' EQ '0').ZG21Q                             00099300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00099400
              AIF   (T'&ZCGPR NE 'N').ZG21Q     INVALID REG NAME        00099500
.ZG21P        ANOP  ,                                                   00099600
              AIF   (T'&ZCGPR NE 'N').ZG21R     NON NUMERIC             00099700
              AIF   ('&ZCGPR' LT '2').ZG21Q                             00099800
              AIF   ('&ZCGPR' LE '12').ZG21R                            00099900
.ZG21Q        ANOP  ,                                                   00100000
&ZMS          SETC  '"RTNCODE='                 *KGPRA* MNOTE           00100100
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00100200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00100300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00100400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00100500
.ZG21R        ANOP  ,                                                   00100600
.*-------------------------------------------------------------------   00100700
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00100800
.ZG22         ANOP  ,           END OF BYPASS CHECK                     00100900
.*----------------------------------------------------------------***   00101000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00101100
              AIF   (N'&RSNCODE LE 1).ZG24A     CK NUM                  00101200
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00101300
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00101400
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00101500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00101600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101700
.ZG24A        ANOP  ,                                                   00101800
.*-------------------------------------------------------------------   00101900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00102000
              AIF   (K'&RSNCODE(1) LE 0).ZG24C  NO PARM                 00102100
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00102200
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00102300
              AIF   (N'&RSNCODE GT 1).ZG24C     MULTIPLE PARMS          00102400
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00102500
.ZG24C        ANOP  ,                                                   00102600
.*-------------------------------------------------------------------   00102700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00102800
              AIF   (K'&ZXRSNCODE LE 0).ZG24R   NOT I/O                 00102900
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG24R                     00103000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00103100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                        00103200
              AIF   (K'&ZCGPR GT 2).ZG24Q                               00103300
              AIF   ('&ZCGPR' EQ '0').ZG24Q                             00103400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00103500
              AIF   (T'&ZCGPR NE 'N').ZG24Q     INVALID REG NAME        00103600
.ZG24P        ANOP  ,                                                   00103700
              AIF   (T'&ZCGPR NE 'N').ZG24R     NON NUMERIC             00103800
              AIF   ('&ZCGPR' LT '2').ZG24Q                             00103900
              AIF   ('&ZCGPR' LE '12').ZG24R                            00104000
.ZG24Q        ANOP  ,                                                   00104100
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00104200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00104300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00104400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00104500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104600
.ZG24R        ANOP  ,                                                   00104700
.******************************************************************     00104800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00104900
.******************************************************************     00105000
              ACTR  10000                                               00105100
.*----------------------------------------------------------------***   00105200
.***AH.P02 EXTRA POSITIONALS                                            00105300
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00105400
&ZCVAL        SETC  ''          ERROR FIELD                             00105500
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00105600
.ZGLIST2      ANOP  ,                                                   00105700
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00105800
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00105900
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00106000
              AGO   .ZGLIST2                                            00106100
.*                                                                      00106200
.ZGLIST3      ANOP  ,                                                   00106300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00106400
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00106500
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00106600
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00106700
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00106800
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00106900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107000
.ZGLISTX      ANOP  ,                                                   00107100
&ZASYSLNDX    SETA  0                                                   00107200
.*-------------------------------------------------------------------   00107300
.***AG.MF04 MF=(SLME)                                                   00107400
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00107500
.********************************************************************   00107600
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00107700
.********************************************************************   00107800
              ACTR  10000                                               00107900
.*-------------------------------------------------------------------   00108000
.***AE.MF01 MF=(SLME)                                                   00108100
              AIF   ('&XMF' EQ 'L').ZEMFX                               00108200
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00108300
.********************************************************************   00108400
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00108500
.********************************************************************   00108600
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00108700
&XCMDRESP     SETC  ''          INITIALIZE XVARIABLE                    00108800
.*-------------------------------------------------------------------   00108900
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109000
              AIF   ('&REQUEST(1)' NE 'RESUME').ZE3A                    00109100
&XREQUEST     SETC  'RESUME'    SET KEYWORD                             00109200
              AIF   (N'&REQUEST LE 1).ZE3A      CK NUM                  00109300
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00109400
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00109500
&ZMS          SETC  '&ZMS "REQUEST"'                                    00109600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00109700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00109800
.ZE3A         ANOP  ,                                                   00109900
.*-------------------------------------------------------------------   00110000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110100
              AIF   ('&REQUEST(1)' NE 'GETMSG').ZE4A                    00110200
&XREQUEST     SETC  'GETMSG'    SET KEYWORD                             00110300
              AIF   (N'&REQUEST LE 1).ZE4A      CK NUM                  00110400
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00110500
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00110600
&ZMS          SETC  '&ZMS "REQUEST"'                                    00110700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00110800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110900
.ZE4A         ANOP  ,                                                   00111000
.*-------------------------------------------------------------------   00111100
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00111200
              AIF   ('&CMDRESP(1)' NE 'NO').ZE7A                        00111300
&XCMDRESP     SETC  'NO'        SET KEYWORD                             00111400
              AIF   (N'&CMDRESP LE 1).ZE7A      CK NUM                  00111500
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           00111600
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00111700
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00111800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00111900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00112000
.ZE7A         ANOP  ,                                                   00112100
.*-------------------------------------------------------------------   00112200
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112300
              AIF   ('&CMDRESP(1)' NE 'YES').ZE8A                       00112400
&XCMDRESP     SETC  'YES'       SET KEYWORD                             00112500
              AIF   (N'&CMDRESP LE 1).ZE8A      CK NUM                  00112600
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           00112700
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00112800
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00112900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00113000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00113100
.ZE8A         ANOP  ,                                                   00113200
.*----------------------------------------------------------------***   00113300
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00113400
              AIF   (N'&CART LE 1).ZE10A        CK NUM                  00113500
&ZMS          SETC  '"CART='    *KPOSA* MNOTE                           00113600
&ZMS          SETC  '&ZMS.&CART"'                                       00113700
&ZMS          SETC  '&ZMS "CART"'                                       00113800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00113900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114000
.ZE10A        ANOP  ,                                                   00114100
.*-------------------------------------------------------------------   00114200
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00114300
              AIF   (K'&CART(1) LE 0).ZE10B     NO PRM                  00114400
&ZXCART       SETC  'INPUT'     SET IN/OUTPUT                           00114500
&XCART        SETC  '&CART(1)'  SET XVARIABLE                           00114600
              AIF   (N'&CART GT 1).ZE10B        MULTIPLE PARMS          00114700
&XCART        SETC  '&CART'     SET XVARIABLE                           00114800
.ZE10B        ANOP  ,                                                   00114900
.*-------------------------------------------------------------------   00115000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00115100
              AIF   (K'&ZXCART LE 0).ZE10R      NOT I/O                 00115200
              AIF   ('&XCART'(1,1) NE '(').ZE10R                        00115300
&ZCGPR        SETC  '&XCART'(2,K'&XCART-2)                              00115400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        00115500
              AIF   (K'&ZCGPR GT 2).ZE10Q                               00115600
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             00115700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00115800
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        00115900
.ZE10P        ANOP  ,                                                   00116000
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             00116100
              AIF   ('&ZCGPR' LT '2').ZE10Q                             00116200
              AIF   ('&ZCGPR' LE '12').ZE10R                            00116300
.ZE10Q        ANOP  ,                                                   00116400
&ZMS          SETC  '"CART='    *KGPRA* MNOTE                           00116500
&ZMS          SETC  '&ZMS.&CART"'                                       00116600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00116700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00116800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116900
.ZE10R        ANOP  ,                                                   00117000
.*----------------------------------------------------------------***   00117100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00117200
              AIF   (N'&MASK LE 1).ZE12A        CK NUM                  00117300
&ZMS          SETC  '"MASK='    *KPOSA* MNOTE                           00117400
&ZMS          SETC  '&ZMS.&MASK"'                                       00117500
&ZMS          SETC  '&ZMS "MASK"'                                       00117600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00117700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00117800
.ZE12A        ANOP  ,                                                   00117900
.*-------------------------------------------------------------------   00118000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00118100
              AIF   (K'&MASK(1) LE 0).ZE12B     NO PRM                  00118200
&ZXMASK       SETC  'INPUT'     SET IN/OUTPUT                           00118300
&XMASK        SETC  '&MASK(1)'  SET XVARIABLE                           00118400
              AIF   (N'&MASK GT 1).ZE12B        MULTIPLE PARMS          00118500
&XMASK        SETC  '&MASK'     SET XVARIABLE                           00118600
.ZE12B        ANOP  ,                                                   00118700
.*-------------------------------------------------------------------   00118800
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00118900
              AIF   (K'&ZXMASK LE 0).ZE12R      NOT I/O                 00119000
              AIF   ('&XMASK'(1,1) NE '(').ZE12R                        00119100
&ZCGPR        SETC  '&XMASK'(2,K'&XMASK-2)                              00119200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE12P                        00119300
              AIF   (K'&ZCGPR GT 2).ZE12Q                               00119400
              AIF   ('&ZCGPR' EQ '0').ZE12Q                             00119500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00119600
              AIF   (T'&ZCGPR NE 'N').ZE12Q     INVALID REG NAME        00119700
.ZE12P        ANOP  ,                                                   00119800
              AIF   (T'&ZCGPR NE 'N').ZE12R     NON NUMERIC             00119900
              AIF   ('&ZCGPR' LT '2').ZE12Q                             00120000
              AIF   ('&ZCGPR' LE '12').ZE12R                            00120100
.ZE12Q        ANOP  ,                                                   00120200
&ZMS          SETC  '"MASK='    *KGPRA* MNOTE                           00120300
&ZMS          SETC  '&ZMS.&MASK"'                                       00120400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00120500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00120600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00120700
.ZE12R        ANOP  ,                                                   00120800
.*------------------------------------------------------------------    00120900
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121000
.ZE15         AIF   (K'&XCMDRESP GT 0).ZE15A    VALID                   00121100
              AIF   (K'&CMDRESP(1) LE 0).ZE15B                          00121200
&ZMS          SETC  '"CMDRESP='                 *KUKWA* MNOTE           00121300
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00121400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00121500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00121600
&ZMS          SETC  '&ZMS "NO"'                 VALID KEYWORD           00121700
              MNOTE 8,' &ZMS OR "YES".'                                 00121800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00121900
              AGO   .ZE15B                                              00122000
.*                                                                      00122100
.ZE15A        ANOP  ,                                                   00122200
&ZXCMDRESP    SETC  'INPUT'     SET IN/OUTPUT                           00122300
.ZE15B        ANOP  ,                                                   00122400
.*------------------------------------------------------------------    00122500
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00122600
.ZE16         AIF   (K'&XREQUEST GT 0).ZE16A    VALID                   00122700
              AIF   (K'&REQUEST(1) LE 0).ZE16B                          00122800
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           00122900
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00123000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00123100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00123200
&ZMS          SETC  '&ZMS "RESUME"'             VALID KEYWORD           00123300
              MNOTE 8,' &ZMS OR "GETMSG".'                              00123400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123500
              AGO   .ZE16B                                              00123600
.*                                                                      00123700
.ZE16A        ANOP  ,                                                   00123800
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00123900
.ZE16B        ANOP  ,                                                   00124000
.*----------------------------------------------------------------***   00124100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00124200
              AIF   (N'&CONSID LE 1).ZE18A      CK NUM                  00124300
&ZMS          SETC  '"CONSID='  *KPOSA* MNOTE                           00124400
&ZMS          SETC  '&ZMS.&CONSID"'                                     00124500
&ZMS          SETC  '&ZMS "CONSID"'                                     00124600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00124700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124800
.ZE18A        ANOP  ,                                                   00124900
.*-------------------------------------------------------------------   00125000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00125100
              AIF   (K'&CONSID(1) LE 0).ZE18B   NO PRM                  00125200
&ZXCONSID     SETC  'INPUT'     SET IN/OUTPUT                           00125300
&XCONSID      SETC  '&CONSID(1)'                SET XVARIABLE           00125400
              AIF   (N'&CONSID GT 1).ZE18B      MULTIPLE PARMS          00125500
&XCONSID      SETC  '&CONSID'   SET XVARIABLE                           00125600
.ZE18B        ANOP  ,                                                   00125700
.*-------------------------------------------------------------------   00125800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00125900
              AIF   (K'&ZXCONSID LE 0).ZE18R    NOT I/O                 00126000
              AIF   ('&XCONSID'(1,1) NE '(').ZE18R                      00126100
&ZCGPR        SETC  '&XCONSID'(2,K'&XCONSID-2)                          00126200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE18P                        00126300
              AIF   (K'&ZCGPR GT 2).ZE18Q                               00126400
              AIF   ('&ZCGPR' EQ '0').ZE18Q                             00126500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00126600
              AIF   (T'&ZCGPR NE 'N').ZE18Q     INVALID REG NAME        00126700
.ZE18P        ANOP  ,                                                   00126800
              AIF   (T'&ZCGPR NE 'N').ZE18R     NON NUMERIC             00126900
              AIF   ('&ZCGPR' LT '2').ZE18Q                             00127000
              AIF   ('&ZCGPR' LE '12').ZE18R                            00127100
.ZE18Q        ANOP  ,                                                   00127200
&ZMS          SETC  '"CONSID='  *KGPRA* MNOTE                           00127300
&ZMS          SETC  '&ZMS.&CONSID"'                                     00127400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00127500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00127600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00127700
.ZE18R        ANOP  ,                                                   00127800
.*----------------------------------------------------------------***   00127900
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00128000
              AIF   (N'&RTNCODE LE 1).ZE21A     CK NUM                  00128100
&ZMS          SETC  '"RTNCODE='                 *KPOSA* MNOTE           00128200
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00128300
&ZMS          SETC  '&ZMS "RTNCODE"'                                    00128400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00128500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128600
.ZE21A        ANOP  ,                                                   00128700
.*-------------------------------------------------------------------   00128800
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00128900
              AIF   (K'&RTNCODE(1) LE 0).ZE21B  NO PRM                  00129000
&ZXRTNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00129100
&XRTNCODE     SETC  '&RTNCODE(1)'               SET XVARIABLE           00129200
              AIF   (N'&RTNCODE GT 1).ZE21B     MULTIPLE PARMS          00129300
&XRTNCODE     SETC  '&RTNCODE'  SET XVARIABLE                           00129400
.ZE21B        ANOP  ,                                                   00129500
.*-------------------------------------------------------------------   00129600
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00129700
              AIF   (K'&ZXRTNCODE LE 0).ZE21R   NOT I/O                 00129800
              AIF   ('&XRTNCODE'(1,1) NE '(').ZE21R                     00129900
&ZCGPR        SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                        00130000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE21P                        00130100
              AIF   (K'&ZCGPR GT 2).ZE21Q                               00130200
              AIF   ('&ZCGPR' EQ '0').ZE21Q                             00130300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00130400
              AIF   (T'&ZCGPR NE 'N').ZE21Q     INVALID REG NAME        00130500
.ZE21P        ANOP  ,                                                   00130600
              AIF   (T'&ZCGPR NE 'N').ZE21R     NON NUMERIC             00130700
              AIF   ('&ZCGPR' LT '2').ZE21Q                             00130800
              AIF   ('&ZCGPR' LE '12').ZE21R                            00130900
.ZE21Q        ANOP  ,                                                   00131000
&ZMS          SETC  '"RTNCODE='                 *KGPRA* MNOTE           00131100
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00131200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00131300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00131400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131500
.ZE21R        ANOP  ,                                                   00131600
.*----------------------------------------------------------------***   00131700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00131800
              AIF   (N'&RSNCODE LE 1).ZE24A     CK NUM                  00131900
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00132000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00132100
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00132200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00132300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00132400
.ZE24A        ANOP  ,                                                   00132500
.*-------------------------------------------------------------------   00132600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00132700
              AIF   (K'&RSNCODE(1) LE 0).ZE24B  NO PRM                  00132800
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00132900
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00133000
              AIF   (N'&RSNCODE GT 1).ZE24B     MULTIPLE PARMS          00133100
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00133200
.ZE24B        ANOP  ,                                                   00133300
.*-------------------------------------------------------------------   00133400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00133500
              AIF   (K'&ZXRSNCODE LE 0).ZE24R   NOT I/O                 00133600
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE24R                     00133700
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00133800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE24P                        00133900
              AIF   (K'&ZCGPR GT 2).ZE24Q                               00134000
              AIF   ('&ZCGPR' EQ '0').ZE24Q                             00134100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00134200
              AIF   (T'&ZCGPR NE 'N').ZE24Q     INVALID REG NAME        00134300
.ZE24P        ANOP  ,                                                   00134400
              AIF   (T'&ZCGPR NE 'N').ZE24R     NON NUMERIC             00134500
              AIF   ('&ZCGPR' LT '2').ZE24Q                             00134600
              AIF   ('&ZCGPR' LE '12').ZE24R                            00134700
.ZE24Q        ANOP  ,                                                   00134800
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00134900
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00135000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00135100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00135200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00135300
.ZE24R        ANOP  ,                                                   00135400
.******************************************************************     00135500
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00135600
.******************************************************************     00135700
              ACTR  10000                                               00135800
.*----------------------------------------------------------------***   00135900
.***AF.P02 EXTRA POSITIONALS                                            00136000
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00136100
&ZCVAL        SETC  ''          ERROR FIELD                             00136200
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00136300
.ZELIST2      ANOP  ,                                                   00136400
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00136500
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00136600
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00136700
              AGO   .ZELIST2                                            00136800
.*                                                                      00136900
.ZELIST3      ANOP  ,                                                   00137000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00137100
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00137200
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00137300
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00137400
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00137500
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00137600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00137700
.ZELISTX      ANOP  ,                                                   00137800
&ZASYSLNDX    SETA  0                                                   00137900
.*-------------------------------------------------------------------   00138000
.***AE.MF02 MF=(SLME)                                                   00138100
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00138200
.*******************************************************************    00138300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00138400
.*******************************************************************    00138500
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00138600
.*******************************************************************    00138700
.***AE.01  START OF MCSOPMSG MACRO CODE                                 00138800
.*******************************************************************    00138900
              LCLC  &M0M0001                 LABEL NAME                 00139000
&M0M0001      SETC  '&XLABEL'                SET LABEL                  00139100
              AIF   (K'&XLABEL NE 0).XLAB2                              00139200
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT LABEL              00139300
.*                                                                      00139400
.XLAB2        ANOP  ,                                                   00139500
&M0M0001 DS    0H                             MCSOPMSG-1                00139600
.*******************************************************************    00139700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00139800
.*******************************************************************    00139900
              PUSH  PRINT                                               00140000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00140100
              PRINT OFF         ++ PR01                                 00140200
              AGO   .ZPRNTXX                                            00140300
.ZPRINTX      PRINT ON                                                  00140400
.ZPRNTXX      ANOP  ,                                                   00140500
.********************************************************************   00140600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00140700
.********************************************************************   00140800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00140900
                      LCLA  &ZOPN1         INVOCATION INDEX             00141000
                      LCLC  &ZOPL(4095)    LABEL                        00141100
                      LCLC  &ZOPO(4095)    OPERATION                    00141200
                      LCLC  &ZOPV(4095)    VALUE                        00141300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00141400
.*                                                                      00141500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00141600
.******************************************************************     00141700
.***AL.L10 MCSOPMSG FMT=LIST MF=S|L PARAMETERS                          00141800
.******************************************************************     00141900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00142000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00142100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(2,3).'A'                     00142200
&XMFATTR              SETC  '0D'                                        00142300
.*                                                                      00142400
&ZOPN                 SETA  &ZOPN+1                                     00142500
&ZOPL(&ZOPN)          SETC  ' '                                         00142600
&ZOPO(&ZOPN)          SETC  'B'                                         00142700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00142800
&ZOPD(&ZOPN)          SETC  '++ MCSOPMSG ARG PARMS'                     00142900
.*                                                                      00143000
&ZOPN                 SETA  &ZOPN+1                                     00143100
&ZOPL(&ZOPN)          SETC  ' '                                         00143200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00143300
&ZOPV(&ZOPN)          SETC  '1'                                         00143400
&ZOPD(&ZOPN)          SETC  ' '                                         00143500
.*                                                                      00143600
.ZLMFSL2              ANOP  ,                                           00143700
.*-------------------------------------------------------------------   00143800
.***AM.L01  MCSOPMSG FMT=LIST PARAMETERS                                00143900
&ZOPN                 SETA &ZOPN+1                                      00144000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00144100
&ZOPO(&ZOPN)          SETC 'DS'                                         00144200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00144300
&ZOPD(&ZOPN)          SETC '++ MCSOPMSG PARM LIST'                      00144400
.*-------------------------------------------------------------------   00144500
.***AM.L09  XACRO CL4                                                   00144600
&ZOPN                 SETA &ZOPN+1                                      00144700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRO'                            00144800
&ZOPO(&ZOPN)          SETC 'DS'                                         00144900
&ZOPV(&ZOPN)          SETC 'CL4'                                        00145000
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XACRO'                         00145100
.*-------------------------------------------------------------------   00145200
.***AM.L02 XVERSION XL1                                                 00145300
&ZOPN                 SETA &ZOPN+1                                      00145400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00145500
&ZOPO(&ZOPN)          SETC 'DS'                                         00145600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00145700
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00145800
.*-------------------------------------------------------------------   00145900
.***AM.L05 XREQUEST XL1                                                 00146000
&ZOPN                 SETA &ZOPN+1                                      00146100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00146200
&ZOPO(&ZOPN)          SETC 'DS'                                         00146300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00146400
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00146500
.*                                                                      00146600
&ZOPN                 SETA  &ZOPN+1                                     00146700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._GETMSG'                          00146800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00146900
&ZOPV(&ZOPN)          SETC  '1'                                         00147000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00147100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GETMSG'                       00147200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00147300
.*                                                                      00147400
&ZOPN                 SETA  &ZOPN+1                                     00147500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._RESUME'                          00147600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00147700
&ZOPV(&ZOPN)          SETC  '2'                                         00147800
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00147900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RESUME'                       00148000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00148100
.*-------------------------------------------------------------------   00148200
.***AM.L03 XCMDRESP BL.8                                                00148300
&ZOPN                 SETA &ZOPN+1                                      00148400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCMDRESP'                         00148500
&ZOPO(&ZOPN)          SETC 'DS'                                         00148600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00148700
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00148800
.*                                                                      00148900
&ZOPN                 SETA  &ZOPN+1                                     00149000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCMDRESP_YES'                    00149100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00149200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00149300
&ZOPD(&ZOPN)          SETC  '++ XCMDRESP.'                              00149400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00149500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00149600
.*                                                                      00149700
&ZOPN                 SETA  &ZOPN+1                                     00149800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCMDRESP_NO'                     00149900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00150000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00150100
&ZOPD(&ZOPN)          SETC  '++ XCMDRESP.'                              00150200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00150300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00150400
.*                                                                      00150500
&ZOPN                 SETA  &ZOPN+1                                     00150600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CMDRESP'                 00150700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00150800
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00150900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00151000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CMDRESP'                      00151100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00151200
.*                                                                      00151300
&ZOPN                 SETA  &ZOPN+1                                     00151400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CART'                    00151500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00151600
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00151700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00151800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CART'                         00151900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00152000
.*                                                                      00152100
&ZOPN                 SETA  &ZOPN+1                                     00152200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MASK'                    00152300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00152400
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00152500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00152600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MASK'                         00152700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00152800
.*-------------------------------------------------------------------   00152900
.***AM.L09  XRSV0001 CL01                                               00153000
&ZOPN                 SETA &ZOPN+1                                      00153100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00153200
&ZOPO(&ZOPN)          SETC 'DS'                                         00153300
&ZOPV(&ZOPN)          SETC 'CL01'                                       00153400
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00153500
.*-------------------------------------------------------------------   00153600
.***AM.L09  XCART CL8                                                   00153700
&ZOPN                 SETA &ZOPN+1                                      00153800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCART'                            00153900
&ZOPO(&ZOPN)          SETC 'DS'                                         00154000
&ZOPV(&ZOPN)          SETC 'CL8'                                        00154100
&ZOPD(&ZOPN)          SETC '++ &ZXCART  XCART'                          00154200
.*-------------------------------------------------------------------   00154300
.***AM.L09  XMASK CL8                                                   00154400
&ZOPN                 SETA &ZOPN+1                                      00154500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMASK'                            00154600
&ZOPO(&ZOPN)          SETC 'DS'                                         00154700
&ZOPV(&ZOPN)          SETC 'CL8'                                        00154800
&ZOPD(&ZOPN)          SETC '++ &ZXMASK  XMASK'                          00154900
.*-------------------------------------------------------------------   00155000
.***AM.L09  XCONSID F                                                   00155100
&ZOPN                 SETA &ZOPN+1                                      00155200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONSID'                          00155300
&ZOPO(&ZOPN)          SETC 'DS'                                         00155400
&ZOPV(&ZOPN)          SETC 'F'                                          00155500
&ZOPD(&ZOPN)          SETC '++ &ZXCONSID  XCONSID'                      00155600
.*-------------------------------------------------------------------   00155700
.***AM.L09  XRSV0002 CL04                                               00155800
&ZOPN                 SETA &ZOPN+1                                      00155900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00156000
&ZOPO(&ZOPN)          SETC 'DS'                                         00156100
&ZOPV(&ZOPN)          SETC 'CL04'                                       00156200
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00156300
.*-------------------------------------------------------------------   00156400
.***AM.L10 END OF MCSOPMSG LIST PARAMETERS                              00156500
&ZOPN                 SETA &ZOPN+1                                      00156600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00156700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00156800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00156900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00157000
.*                                                                      00157100
&ZOPN                 SETA &ZOPN+1                                      00157200
&ZOPL(&ZOPN)          SETC ' '                                          00157300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00157400
&ZOPV(&ZOPN)          SETC '1'                                          00157500
&ZOPD(&ZOPN)          SETC ' '                                          00157600
.*-------------------------------------------------------------------   00157700
.***AL.L12 MCSOPMSG FMT=LIST MF=S|L PARAMETERS                          00157800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00157900
.*                                                                      00158000
&ZOPN                 SETA  &ZOPN+1                                     00158100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00158200
&ZOPO(&ZOPN)          SETC  'DC'                                        00158300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00158400
&ZOPD(&ZOPN)          SETC  '++ MCSOPMSG ARG PARMS'                     00158500
.*                                                                      00158600
.ZLMFSLX              ANOP  ,                                           00158700
.*-------------------------------------------------------------------   00158800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00158900
&ZPLLEN               SETA 32                                           00159000
.*                                                                      00159100
.******************************************************************     00159200
.***AI.L01 MCSOPMSG FMT=LIST FILL IN PARAMETER AREA                     00159300
.******************************************************************     00159400
                      ACTR  10000                                       00159500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00159600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSTATE PRI     00159700
&ZCVAL                SETC  'LAE'          XAX MODE                     00159800
.ZIMFXA               ANOP ,                                            00159900
.*                                                                      00160000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00160100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00160200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00160300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00160400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00160500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00160600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00160700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00160800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00160900
&ZOPN                 SETA  &ZOPN+1                                     00161000
&ZOPL(&ZOPN)          SETC  ' '                                         00161100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00161200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00161300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00161400
                      AGO   .ZIMFNX                                     00161500
.*                                                                      00161600
.ZIMFN2               ANOP ,                                            00161700
&ZOPN                 SETA  &ZOPN+1                                     00161800
&ZOPL(&ZOPN)          SETC  ' '                                         00161900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00162000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00162100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00162200
.ZIMFNX               ANOP ,                                            00162300
.********************************************************************   00162400
.***AI.L02 MCSOPMSG FMT=LIST INITIALIZE PARAMETER AREA                  00162500
.********************************************************************   00162600
.***AI.L03 MF=(SLME)                                                    00162700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00162800
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00162900
.*                                                                      00163000
&ZOPN                 SETA  &ZOPN+1                                     00163100
&ZOPL(&ZOPN)          SETC  ' '                                         00163200
&ZOPO(&ZOPN)          SETC  'XC'                                        00163300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00163400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00163500
.ZIMFLX               ANOP  ,                                           00163600
.*-------------------------------------------------------------------   00163700
.***AI.L60 XACRO CL4                                                    00163800
&ZOPN                 SETA  &ZOPN+1                                     00163900
&ZOPL(&ZOPN)          SETC  ' '                                         00164000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00164100
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''MDR '''                       00164200
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           00164300
.*-------------------------------------------------------------------   00164400
.***AI.L04B XVERSION XL1                                                00164500
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFVX            00164600
&ZOPN                 SETA  &ZOPN+1                                     00164700
&ZOPL(&ZOPN)          SETC  ' '                                         00164800
&ZOPO(&ZOPN)          SETC  'MVI'                                       00164900
&ZOPV(&ZOPN)          SETC  '4(1),1'                                    00165000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00165100
.ZIMFVX               ANOP  ,                                           00165200
.*-------------------------------------------------------------------   00165300
.***AI.L07 XREQUEST AL1                                                 00165400
&ZW                   SETC  ''                                          00165500
.*-------------------------------------------------------------------   00165600
.***AI.L15 XREQUEST "GETMSG" AL1                                        00165700
         AIF   ('&XREQUEST' NE 'GETMSG').ZI4A                           00165800
&ZW                   SETC  '1'                                         00165900
.ZI4A                 ANOP  ,                                           00166000
.*-------------------------------------------------------------------   00166100
.***AI.L15 XREQUEST "RESUME" AL1                                        00166200
         AIF   ('&XREQUEST' NE 'RESUME').ZI5A                           00166300
&ZW                   SETC  '2'                                         00166400
.ZI5A                 ANOP  ,                                           00166500
.*-------------------------------------------------------------------   00166600
.***AI.L17 XREQUEST AL1                                                 00166700
                      AIF   ('&ZW' NE '0').ZI5C                         00166800
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI5B              00166900
.ZI5C                 ANOP  ,                                           00167000
                      AIF   ('&ZW' EQ '').ZI5B                          00167100
.*                                                                      00167200
&ZOPN                 SETA  &ZOPN+1                                     00167300
&ZOPL(&ZOPN)          SETC  ' '                                         00167400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00167500
&ZOPV(&ZOPN)          SETC  '5(1),&ZW'                                  00167600
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST AL1'                00167700
.ZI5B                 ANOP  ,                                           00167800
.*-------------------------------------------------------------------   00167900
.***AI.L05 XCMDRESP BL1                                                 00168000
&ZW                   SETC  ''                                          00168100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00168200
&ZMS                  SETC  ''                                          00168300
&ZC                   SETC  ''                                          00168400
.*-------------------------------------------------------------------   00168500
.***AI.L08 XCMDRESP "YES"                                               00168600
.***      BL1'1XXXXXXX'                                                 00168700
         AIF   ('&XCMDRESP' NE 'YES').ZI7A                              00168800
&ZW                   SETC  '&ZW.1'                                     00168900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00169000
&ZMS                  SETC  '&ZMS.1'                                    00169100
                      AGO   .ZI7C                                       00169200
.*                                                                      00169300
.ZI7A                 ANOP  ,                                           00169400
&ZW                   SETC  '&ZW.0'                                     00169500
         AIF   ('&ZXCMDRESP' EQ '').ZI7B                                00169600
&ZMS                  SETC  '&ZMS.0'                                    00169700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00169800
                      AGO   .ZI7C                                       00169900
.*                                                                      00170000
.ZI7B                 ANOP  ,                                           00170100
&ZMS                  SETC  '&ZMS.1'                                    00170200
.ZI7C                 ANOP  ,                                           00170300
.*-------------------------------------------------------------------   00170400
.***AI.L08 XCMDRESP "NO"                                                00170500
.***      BL1'X1XXXXXX'                                                 00170600
         AIF   ('&XCMDRESP' NE 'NO').ZI8A                               00170700
&ZW                   SETC  '&ZW.1'                                     00170800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00170900
&ZMS                  SETC  '&ZMS.1'                                    00171000
                      AGO   .ZI8C                                       00171100
.*                                                                      00171200
.ZI8A                 ANOP  ,                                           00171300
&ZW                   SETC  '&ZW.0'                                     00171400
         AIF   ('&ZXCMDRESP' EQ '').ZI8B                                00171500
&ZMS                  SETC  '&ZMS.0'                                    00171600
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00171700
                      AGO   .ZI8C                                       00171800
.*                                                                      00171900
.ZI8B                 ANOP  ,                                           00172000
&ZMS                  SETC  '&ZMS.1'                                    00172100
.ZI8C                 ANOP  ,                                           00172200
.*-------------------------------------------------------------------   00172300
.***AI.L08 XCMDRESP "CMDRESP"                                           00172400
.***      BL1'XX1XXXXX'                                                 00172500
         AIF   ('&CMDRESP' EQ '').ZI9A                                  00172600
&ZW                   SETC  '&ZW.1'                                     00172700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00172800
&ZMS                  SETC  '&ZMS.0'                                    00172900
                      AGO   .ZI9C                                       00173000
.*                                                                      00173100
.ZI9A                 ANOP  ,                                           00173200
&ZW                   SETC  '&ZW.0'                                     00173300
&ZMS                  SETC  '&ZMS.1'                                    00173400
.ZI9C                 ANOP  ,                                           00173500
.*-------------------------------------------------------------------   00173600
.***AI.L08 XCMDRESP "CART"                                              00173700
.***      BL1'XXX1XXXX'                                                 00173800
         AIF   ('&CART' EQ '').ZI10A                                    00173900
         AIF   ('&CART' EQ 'NULL').ZI10A                                00174000
&ZW                   SETC  '&ZW.1'                                     00174100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00174200
&ZMS                  SETC  '&ZMS.0'                                    00174300
                      AGO   .ZI10C                                      00174400
.*                                                                      00174500
.ZI10A                ANOP  ,                                           00174600
&ZW                   SETC  '&ZW.0'                                     00174700
&ZMS                  SETC  '&ZMS.1'                                    00174800
.ZI10C                ANOP  ,                                           00174900
.*-------------------------------------------------------------------   00175000
.***AI.L08 XCMDRESP "MASK"                                              00175100
.***      BL1'XXXX1XXX'                                                 00175200
         AIF   ('&MASK' EQ '').ZI11A                                    00175300
         AIF   ('&MASK' EQ 'NULL').ZI11A                                00175400
&ZW                   SETC  '&ZW.1000'                                  00175500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00175600
&ZMS                  SETC  '&ZMS.0111'                                 00175700
                      AGO   .ZI11C                                      00175800
.*                                                                      00175900
.ZI11A                ANOP  ,                                           00176000
&ZW                   SETC  '&ZW.0000'                                  00176100
&ZMS                  SETC  '&ZMS.1111'                                 00176200
.ZI11C                ANOP  ,                                           00176300
.*-------------------------------------------------------------------   00176400
.***AI.L11 XCMDRESP BL1                                                 00176500
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI11D              00176600
                      AIF   ('&ZC' NE 'YES').ZI11D                      00176700
&ZOPN                 SETA  &ZOPN+1                                     00176800
&ZOPL(&ZOPN)          SETC  ' '                                         00176900
&ZOPO(&ZOPN)          SETC  'NI'                                        00177000
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZMS'''                            00177100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00177200
.ZI11D                ANOP  ,                                           00177300
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    00177400
&ZOPN                 SETA  &ZOPN+1                                     00177500
&ZOPL(&ZOPN)          SETC  ' '                                         00177600
&ZOPO(&ZOPN)          SETC  'OI'                                        00177700
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZW'''                             00177800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00177900
.ZI11E                ANOP  ,                                           00178000
.*-------------------------------------------------------------------   00178100
.***AI.L18  XCART CL8                                                   00178200
                      AIF   ('&XCART' NE 'NULL').ZI13  CK *             00178300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI13  CK *        00178400
&ZXCART               SETC  ''             RESET INPUT/OUTPUT           00178500
.ZI13                 ANOP  ,                                           00178600
.*-------------------------------------------------------------------   00178700
.***AI.L25  XCART CL8                                                   00178800
                      AIF   ('&ZXCART' EQ '').ZI13E  NOT USED           00178900
                      AIF   ('&ZXCART' EQ 'OUTPUT').ZI13E               00179000
&ZCGPR                SETC  '&XCART'                                    00179100
                      AIF   ('&XCART' NE 'NULL').ZI13A                  00179200
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI13E             00179300
.*                                                                      00179400
&ZCGPR                SETC  '=XL8''00'''                                00179500
.ZI13A                ANOP  ,                                           00179600
.*                                                                      00179700
                      AIF   ('&XCART'(1,1) NE '(').ZI13B  NOT GPR       00179800
&ZCGPR   SETC  '0('.'&XCART'(2,K'&XCART-2).')'                          00179900
.ZI13B                ANOP  ,                                           00180000
.*                                                                      00180100
&ZOPN                 SETA  &ZOPN+1                                     00180200
&ZOPL(&ZOPN)          SETC  ' '                                         00180300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00180400
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00180500
&ZOPD(&ZOPN)          SETC  '++ &ZXCART XCART CL8'                      00180600
.*                                                                      00180700
.ZI13E                ANOP  ,                                           00180800
.*-------------------------------------------------------------------   00180900
.***AI.L18  XMASK CL8                                                   00181000
                      AIF   ('&XMASK' NE 'NULL').ZI14  CK *             00181100
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI14  CK *        00181200
&ZXMASK               SETC  ''             RESET INPUT/OUTPUT           00181300
.ZI14                 ANOP  ,                                           00181400
.*-------------------------------------------------------------------   00181500
.***AI.L25  XMASK CL8                                                   00181600
                      AIF   ('&ZXMASK' EQ '').ZI14E  NOT USED           00181700
                      AIF   ('&ZXMASK' EQ 'OUTPUT').ZI14E               00181800
&ZCGPR                SETC  '&XMASK'                                    00181900
                      AIF   ('&XMASK' NE 'NULL').ZI14A                  00182000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI14E             00182100
.*                                                                      00182200
&ZCGPR                SETC  '=XL8''00'''                                00182300
.ZI14A                ANOP  ,                                           00182400
.*                                                                      00182500
                      AIF   ('&XMASK'(1,1) NE '(').ZI14B  NOT GPR       00182600
&ZCGPR   SETC  '0('.'&XMASK'(2,K'&XMASK-2).')'                          00182700
.ZI14B                ANOP  ,                                           00182800
.*                                                                      00182900
&ZOPN                 SETA  &ZOPN+1                                     00183000
&ZOPL(&ZOPN)          SETC  ' '                                         00183100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00183200
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00183300
&ZOPD(&ZOPN)          SETC  '++ &ZXMASK XMASK CL8'                      00183400
.*                                                                      00183500
.ZI14E                ANOP  ,                                           00183600
.*-------------------------------------------------------------------   00183700
.***AI.L25  XCONSID F                                                   00183800
                      AIF   ('&ZXCONSID' EQ '').ZI15E  NOT USED         00183900
                      AIF   ('&ZXCONSID' EQ 'OUTPUT').ZI15E             00184000
&ZCGPR                SETC  '&XCONSID'                                  00184100
.*                                                                      00184200
                      AIF   ('&XCONSID'(1,1) NE '(').ZI15B  NOT GPR     00184300
&ZCGPR   SETC  '0('.'&XCONSID'(2,K'&XCONSID-2).')'                      00184400
                      AGO   .ZI15D                                      00184500
.ZI15B                ANOP  ,                                           00184600
.*                                                                      00184700
&ZC                   SETC  '&XCONSID'(1,1)                             00184800
                      AIF   (T'&ZC NE 'N').ZI15D                        00184900
&ZCGPR                SETC  '=FL4''&XCONSID'''                          00185000
.*                                                                      00185100
.ZI15D                ANOP  ,                                           00185200
.*                                                                      00185300
&ZOPN                 SETA  &ZOPN+1                                     00185400
&ZOPL(&ZOPN)          SETC  ' '                                         00185500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00185600
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00185700
&ZOPD(&ZOPN)          SETC  '++ &ZXCONSID XCONSID F'                    00185800
.*                                                                      00185900
.ZI15E                ANOP  ,                                           00186000
.*-------------------------------------------------------------------   00186100
&ZOPN1                SETA &ZOPN                                        00186200
.*-------------------------------------------------------------------   00186300
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00186400
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00186500
.*******************************************************************    00186600
.***  PROCESS MCSOPMSG OUTPUT PARAMETERS                                00186700
.*******************************************************************    00186800
                      ACTR  10000                                       00186900
.*******************************************************************    00187000
.***AO.X02  RETURN CODE PROCESSING                                      00187100
.*******************************************************************    00187200
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00187300
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00187400
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00187500
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00187600
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00187700
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00187800
&ZOPN                 SETA  &ZOPN+1                                     00187900
&ZOPL(&ZOPN)          SETC  ' '                                         00188000
&ZOPO(&ZOPN)          SETC  'ST'                                        00188100
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00188200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00188300
                      AGO   .ZMRETX                                     00188400
.*                                                                      00188500
.ZMRET2               ANOP  ,                                           00188600
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00188700
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00188800
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00188900
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00189000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00189100
&ZOPN                 SETA  &ZOPN+1                                     00189200
&ZOPL(&ZOPN)          SETC  ' '                                         00189300
&ZOPO(&ZOPN)          SETC  'LR'                                        00189400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00189500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00189600
.ZMRETX               ANOP  ,                                           00189700
.*******************************************************************    00189800
.***AO.X03  REASON CODE PROCESSING                                      00189900
.*******************************************************************    00190000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00190100
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00190200
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00190300
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00190400
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00190500
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00190600
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00190700
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00190800
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00190900
&ZOPN                 SETA  &ZOPN+1                                     00191000
&ZOPL(&ZOPN)          SETC  ' '                                         00191100
&ZOPO(&ZOPN)          SETC  'ST'                                        00191200
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00191300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00191400
                      AGO   .ZMRSNX                                     00191500
.*                                                                      00191600
.ZMRSN2               ANOP  ,                                           00191700
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00191800
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00191900
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00192000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00192100
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00192200
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00192300
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00192400
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00192500
&ZOPN                 SETA  &ZOPN+1                                     00192600
&ZOPL(&ZOPN)          SETC  ' '                                         00192700
&ZOPO(&ZOPN)          SETC  'LR'                                        00192800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00192900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00193000
.ZMRSNX               ANOP  ,                                           00193100
.*******************************************************************    00193200
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00193300
.*******************************************************************    00193400
.ZMFLX                ANOP  ,              MF=L PROCESSING              00193500
.*******************************************************************    00193600
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00193700
.*******************************************************************    00193800
                      ACTR  10000                                       00193900
.*                                                                      00194000
                      LCLA  &ZLC           COLUMN POSITION              00194100
                      LCLA  &ZOPX          LIST TABLE INDEX             00194200
                      LCLC  &ZLL           LABEL                        00194300
                      LCLC  &ZLOP          OPERATION                    00194400
                      LCLC  &ZLV           VALUE                        00194500
                      LCLC  &ZLD           DESCRIPTION                  00194600
.*                                                                      00194700
&ZOPX                 SETA  1                                           00194800
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00194900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00195000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00195100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00195200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00195300
                      AIF   (K'&ZLD LE 0).ZL5                           00195400
&ZLC                  SETA  35             COMMENT COLUMN               00195500
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00195600
&ZLC                  SETA  33             COMMMENT COLUMN              00195700
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00195800
&ZLV                  SETC  '&ZLV'.' '                                  00195900
                      AGO   .ZL3                                        00196000
.*                                                                      00196100
.ZL4                  ANOP  ,                                           00196200
&ZLV                  SETC  '&ZLV'.' '                                  00196300
.ZL5                  ANOP  ,                                           00196400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00196500
.*                                                                      00196600
&ZLL     &ZLOP &ZLV                                                     00196700
.*                                                                      00196800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00196900
                      AGO   .ZL2           CONTINUE LOOPING             00197000
.*                                                                      00197100
.ZLX                  ANOP  ,                                           00197200
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00197300
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00197400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00197500
         L     15,16              GET ADDRESS OF CVT FROM PSA           00197600
         L     15,772(15)         GET ADDRESS OF SFT FROM CVT           00197700
         LA    14,6               GET MCSOPMSG INDEX INTO LINKAGE TABLE 00197800
         AL    14,100(15)         POINT REG14 TO MCSOPMSG ETD ENTRY     00197900
         PC    0(14)              PC TO MCSOPMSG SERVICE                00198000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00198100
.ZLINKX               ANOP  ,                                           00198200
.*******************************************************************    00198300
.***AP.X01  FORMAT GENERATED CODE                                       00198400
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00198500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00198600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00198700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00198800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00198900
                      AIF   (K'&ZLD LE 0).ZL51                          00199000
&ZLC                  SETA  35             COMMENT COLUMN               00199100
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00199200
&ZLC                  SETA  33             COMMENT COLUMN               00199300
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00199400
&ZLV                  SETC  '&ZLV'.' '                                  00199500
                      AGO   .ZL31                                       00199600
.*                                                                      00199700
.ZL41                 ANOP  ,                                           00199800
&ZLV                  SETC  '&ZLV'.' '                                  00199900
.ZL51                 ANOP  ,                                           00200000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00200100
.*                                                                      00200200
&ZLL     &ZLOP &ZLV                                                     00200300
.*                                                                      00200400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00200500
                      AGO   .ZL21          CONTINUE LOOPING             00200600
.*                                                                      00200700
.ZLX1                 ANOP  ,                                           00200800
.*******************************************************************    00200900
.***AP.X02  END OF MCSOPMSG MACRO                                       00201000
&ZMCSOPMSG            SETC  'YES'          SET MCSOPMSG USED            00201100
         POP   PRINT                                                    00201200
*                                            MCSOPMSG-1                 00201300
         SPACE 1                                                        00201400
.ZLX2                 ANOP  ,                                           00201500
         MEND                                                           00201600
**********************************************************************/ 00201700
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00201800
*%MCSOPMSG: MACRO KEYS(REQUEST,CMDRESP,CART,MASK,CONSID,RTNCODE,        00201900
*                 RSNCODE,MF);                                          00202000
*  ANS('?'||MACLABEL||' '||'MCSOPMSP '||MACLIST||                       00202100
*         ' '||MACKEYS||';') COL(MACLMAR);                              00202200
*%END MCSOPMSG;                                                         00202300
