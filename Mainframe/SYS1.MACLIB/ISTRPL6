         MACRO                                                          00050000
&NAME    ISTRPL6 &CD=,                                                 X00100000
               &CONMODE=,                                              X00150000
               &CONXMOD=,                                              X00200000
               &FILL=,                                                 X00250000
               &LOCKS=,                                                X00300000
               &LOGMODE=,                                              X00350000
               &LUNAME=,                                               X00400000
               &NAMEUSE=,                                              X00450000
               &NETID=,                                                X00500000
               &QUALIFY=,                                              X00550000
               &RTSRTRN=,                                              X00600000
               &SENSE=,                                                X00650000
               &TYPE=,                                                 X00700000
               &USERFLD=,                                              X00750000
               &VTRINA=,                                               X00800000
               &VTRINL=,                                               X00825000
               &VTROUTA=,                                              X00850000
               &VTROUTL=                                          @S1C  00875000
.* /***** START OF SPECIFICATIONS ************************************/ 00900000
.* /*                                                                */ 00950000
.* /*  MACRO NAME: ISTRPL6                                           */ 01000000
.* /*                                                                */ 01050000
.* /*  DESCRIPTIVE NAME:                                             */ 01100000
.* /*     CREATE A RPL APPC/VTAM EXTENSION                           */ 01150000
.* /*                                                                */ 01200000
.* /*  COPYRIGHT: LICENSED MATERIALS - PROPERTY OF IBM               */ 01250000
.* /*                                                                */ 01300000
.* /*             THIS PRODUCT CONTAINS "RESTRICTED MATERIALS OF IBM"*/ 01350000
.* /*                                                                */ 01400000
.* /*             5695-117 (C) COPYRIGHT IBM CORP. 1987, 1994.       */ 01450000
.* /*             ALL RIGHTS RESERVED.                               */ 01500000
.* /*                                                                */ 01550000
.* /*             U.S. GOVERNMENT USERS RESTRICTED RIGHTS -          */ 01600000
.* /*             USE, DUPLICATION OR DISCLOSURE RESTRICTED BY       */ 01650000
.* /*             GSA ADP SCHEDULE CONTRACT WITH IBM CORP.           */ 01700000
.* /*                                                                */ 01750000
.* /*             SEE COPYRIGHT INSTRUCTIONS.                        */ 01800000
.* /*                                                                */ 01850000
.* /*                                                                */ 01900000
.* /*  FUNCTION:                                                     */ 01950000
.* /*    THE FUNCTION OF THIS MACRO IS TO BUILD, AT ASSEMBLY         */ 02000000
.* /*    TIME, AN RPL6(RPL APPC/VTAM EXTENSION) FOR APPC USERS.      */ 02050000
.* /*    THE RPL6 IS USED TO STORE THE INFORMATION THAT WILL BE      */ 02100000
.* /*    USED BY THE ACF/VTAM APPC CODE TO PERFORM ITS FUNCTION.     */ 02150000
.* /*                                                                */ 02200000
.* /*                                                                */ 02250000
.* /*  NOTES:                                                        */ 02300000
.* /*                                                                */ 02350000
.* /*                                                                */ 02400000
.* /*  PROCESSOR: ASSEMBLER                                          */ 02450000
.* /*                                                                */ 02500000
.* /*  CREATED BY:                                                   */ 02550000
.* /*                                                                */ 02600000
.* /*  INTERNAL MACROS:                                              */ 02650000
.* /*                                                                */ 02700000
.* /*  EXTERNAL REFERENCES: NONE                                     */ 02750000
.* /*                                                                */ 02800000
.* /*  CHANGE ACTIVITY:                                              */ 02850000
.* /*    12/08/86 - ADD RPL6STBF & RPL6STDS FOR STG SHORTAGE @P043961*/ 02900000
.* /*    07/11/88 - ADD CD= KEYWORD FOR RECEIVE              @P058398*/ 02950000
.* /*    08/17/88 - ADD THE CHECK FOR QUALIFY=CONWIN         @P059623*/ 03000000
.* /*                                                                */ 03050000
.* /* $MAC(ISTRPL6),COMP(API),PROD(VTAM): CREATE A RPL APPC/VTAM     */ 03100000
.* /*                                     EXTENSION                  */ 03150000
.* /*                                                                */ 03200000
.* /* FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS          */ 03250000
.* /* ---- -------- ------- ------ ------  ------------------------- */ 03300000
.* /* $F1= FS1@@CLD HVT3302 880504 255471: SYNCPOINT SUPPORT         */ 03350000
.* /* $Q1= P060480  HVT3302 880906 255471: ADD .* FOR CONTINUATION   */ 03400000
.* /* $Q2= P059623  HVT3302 880817 255471: ADD THE CHECK FOR         */ 03450000
.* /*                                      QUALIFY=CONWIN            */ 03500000
.* /* $F2= RCR0004  HVT3302 880907 255471: SYNCPOINT RCR SUPPORT     */ 03550000
.* /* $B1= AP@@@CLD HVT3401 890516 496698: PERSISTENT LU-LU SESSIONS */ 03600000
.* /* $BB= ACC@@AMS HVT3401 891025 615520: PL/AS CONVERSION          */ 03650000
.* /* $V1= P082013  HVT3401 900828 474203: Syncpoint processing for  */ 03700000
.* /*                                      persistent applications   */ 03750000
.* /* $KF= S4N@@CLD HATAPPN 910326 692313: CP-CP SESSIONS            */ 03800000
.* /* $KG= NQNSTG2  NQNAME2 910628 457572: ENHANCED NQN SUPPORT (2)  */ 03850000
.* /* $KH= SZADR001 ALWFREE 910814 584390: APPC ALLOCATE Enhancement */ 03900000
.* /* $I1= BR@@@MST APPCE01 911108 510689: APPC Receive Immediate    */ 03950000
.* /* $I2= FF@@@MST APPCFDX 911231 879315: APPC Full-Duplex support  */ 04000000
.* /* $I3= FT@@@MST APPCTST 920218 510689: APPC TestStat             */ 04050000
.* /* $L1= KA@@@PLD APPCRR  930810 446638: DCE Security Services     */ 04100000
.* /* $U2= P110887  GENRES  931024 879315: Generic Resource support  */ 04150000
.* /* $L2= KA@DR006 APPCRR  940713 576146: Vector Format             */ 04200000
.* /* $D1= IA@@@MST V51APPC 941121 941213: APPCCMD enhancements      */ 04225000
.* /* $S1= P119717  FPAPI   950914 879315: Fastpath API for APPC     */ 04237500
.* /***** END OF SPECIFICATIONS **************************************/ 04250000
.*                                                                      04300000
.* A-000000-999999                                             @R495810 04350000
.*                                                                      04400000
*                                                                       04450000
* COPYRIGHT: LICENSED MATERIALS - PROPERTY OF IBM                       04500000
*                                                                       04550000
*            THIS PRODUCT CONTAINS "RESTRICTED MATERIALS OF IBM"        04600000
*                                                                       04650000
*            5695-117 (C) COPYRIGHT IBM CORP. 1987, 1994.               04700000
*            ALL RIGHTS RESERVED.                                       04750000
*                                                                       04800000
*            U.S. GOVERNMENT USERS RESTRICTED RIGHTS -                  04850000
*            USE, DUPLICATION OR DISCLOSURE RESTRICTED BY               04900000
*            GSA ADP SCHEDULE CONTRACT WITH IBM CORP.                   04950000
*                                                                       05000000
*            SEE COPYRIGHT INSTRUCTIONS.                                05050000
*                                                                       05100000
*                                                                       05150000
         LCLA  &NUM                                                     05200000
         LCLA  &LEN                                                     05250000
         LCLB  &CDBIT              CD INDICATOR                @P058398 05300000
         LCLB  &FILLBIT            FILL INDICATOR                       05350000
         LCLB  &LOCKBIT            LOCKS INDICATOR                      05400000
         LCLB  &TYPEB1             TYPE INDICATOR - FIRST BIT           05450000
         LCLB  &TYPEB2             TYPE INDICATOR - SECOND BIT          05500000
         LCLB  &CMODB1             CONMODE INDICATOR - FIRST BIT        05550000
         LCLB  &CMODB2             CONMODE INDICATOR - SECOND BIT       05600000
         LCLB  &CXMDB1             CONXMOD INDICATOR - FIRST BIT   @I2A 05650000
         LCLB  &CXMDB2             CONXMOD INDICATOR - SECOND BIT  @I2A 05700000
         LCLB  &NAMUB1             NAMEUSE INDICATOR - FIRST BIT   @U2A 05750000
         LCLB  &NAMUB2             NAMEUSE INDICATOR - SECOND BIT  @U2A 05800000
         LCLB  &RTSRBIT            RTSRTRN INDICATOR               @I2A 05850000
         LCLC  &CHAR,&CHAR1,&CHAR2,&CHAR3,&CHAR4                        05900000
.*                                                                      05950000
&LEN     SETA  4                                                        06000000
&CDBIT   SETB  0                                               @P058398 06050000
&FILLBIT SETB  0                                                        06100000
&LOCKBIT SETB  0                                                        06150000
&TYPEB1  SETB  0                                                        06200000
&TYPEB2  SETB  0                                                        06250000
&CMODB1  SETB  0                                                        06300000
&CMODB2  SETB  0                                                        06350000
&CXMDB1  SETB  0                                                   @I2A 06400000
&CXMDB2  SETB  0                                                   @I2A 06450000
&NAMUB1  SETB  0                                                   @U2A 06500000
&NAMUB2  SETB  0                                                   @U2A 06550000
&RTSRBIT SETB  0                                                   @I2A 06600000
.*                                                                      06650000
&NAME    DS    0F                  START OF LU 6.2 EXTENSION TO THE RPL 06700000
         DC    C'APPC'             ACRONYM IN EBCDIC                    06750000
.*                                                                      06800000
         DC    X'00'               TYPE OF APPCCMD                      06850000
.*                                                                      06900000
         AIF   ('&QUALIFY' NE '').QUALN    IS "QUALIFY=" SPECIFIED @L1C 06950000
         DC    X'00'               SUBTYPE OF APPCCMD                   07000000
         AGO   .ENDQUAL                                                 07050000
.QUALN   ANOP                                                      @L1A 07100000
         AIF   ('&QUALIFY' NE 'NULL').QUAL1  IS "QUALIFY=NULL"?    @L1A 07150000
         DC    X'00'               QUALIFY=NULL                    @L1A 07200000
         AGO   .ENDQUAL                                            @L1A 07250000
.QUAL1   ANOP                                                           07300000
         AIF   ('&QUALIFY' NE 'ABNDPROG').QUAL2  IS "QUALIFY=ABNDPROG"? 07350000
         DC    X'01'               QUALIFY=ABNDPROG                     07400000
         AGO   .ENDQUAL                                                 07450000
.QUAL2   ANOP                                                           07500000
         AIF   ('&QUALIFY' NE 'ABNDSERV').QUAL3  IS "QUALIFY=ABNDSERV"? 07550000
         DC    X'02'               QUALIFY=ABNDSERV                     07600000
         AGO   .ENDQUAL                                                 07650000
.QUAL3   ANOP                                                           07700000
         AIF   ('&QUALIFY' NE 'ABNDTIME').QUAL4  IS "QUALIFY=ABNDTIME"? 07750000
         DC    X'03'               QUALIFY=ABNDTIME                     07800000
         AGO   .ENDQUAL                                                 07850000
.QUAL4   ANOP                                                           07900000
         AIF   ('&QUALIFY' NE 'ABNDUSER').QUAL5  IS "QUALIFY=ABNDUSER"? 07950000
         DC    X'04'               QUALIFY=ABNDUSER                     08000000
         AGO   .ENDQUAL                                                 08050000
.QUAL5   ANOP                                                           08100000
         AIF   ('&QUALIFY' NE 'ANY').QUAL6      IS "QUALIFY=ANY"?       08150000
         DC    X'05'               QUALIFY=ANY                          08200000
         AGO   .ENDQUAL                                                 08250000
.QUAL6   ANOP                                                           08300000
         AIF   ('&QUALIFY' NE 'CNOS').QUAL7     IS "QUALIFY=CNOS"?      08350000
         DC    X'06'               QUALIFY=CNOS                         08400000
         AGO   .ENDQUAL                                                 08450000
.QUAL7   ANOP                                                           08500000
         AIF   ('&QUALIFY' NE 'CONFIRM').QUAL8  IS "QUALIFY=CONFIRM"?   08550000
         DC    X'07'               QUALIFY=CONFIRM                      08600000
         AGO   .ENDQUAL                                                 08650000
.QUAL8   ANOP                                                           08700000
         AIF   ('&QUALIFY' NE 'CONFRMD').QUAL9  IS "QUALIFY=CONFRMD"?   08750000
         DC    X'08'               QUALIFY=CONFRMD                      08800000
         AGO   .ENDQUAL                                                 08850000
.QUAL9   ANOP                                                           08900000
         AIF   ('&QUALIFY' NE 'DATA').QUAL10    IS "QUALIFY=DATA"?      08950000
         DC    X'09'               QUALIFY=DATA                         09000000
         AGO   .ENDQUAL                                                 09050000
.QUAL10  ANOP                                                           09100000
         AIF   ('&QUALIFY' NE 'DATACON').QUAL11 IS "QUALIFY=DATACON"?   09150000
         DC    X'0A'               QUALIFY=DATACON                      09200000
         AGO   .ENDQUAL                                                 09250000
.QUAL11  ANOP                                                           09300000
         AIF   ('&QUALIFY' NE 'DATAFLU').QUAL12 IS "QUALIFY=DATAFLU"?   09350000
         DC    X'0B'               QUALIFY=DATAFLU                      09400000
         AGO   .ENDQUAL                                                 09450000
.QUAL12  ANOP                                                           09500000
         AIF   ('&QUALIFY' NE 'DEFINE').QUAL13  IS "QUALIFY=DEFINE"?    09550000
         DC    X'0C'               QUALIFY=DEFINE                       09600000
         AGO   .ENDQUAL                                                 09650000
.QUAL13  ANOP                                                           09700000
         AIF   ('&QUALIFY' NE 'DISPLAY').QUAL14 IS "QUALIFY=DISPLAY"?   09750000
         DC    X'0D'               QUALIFY=DISPLAY                      09800000
         AGO   .ENDQUAL                                                 09850000
.QUAL14  ANOP                                                           09900000
         AIF   ('&QUALIFY' NE 'ERROR').QUAL15   IS "QUALIFY=ERROR"?     09950000
         DC    X'0E'               QUALIFY=ERROR                        10000000
         AGO   .ENDQUAL                                                 10050000
.QUAL15  ANOP                                                           10100000
         AIF   ('&QUALIFY' NE 'FLUSH').QUAL16   IS "QUALIFY=FLUSH"?     10150000
         DC    X'0F'               QUALIFY=FLUSH                        10200000
         AGO   .ENDQUAL                                                 10250000
.QUAL16  ANOP                                                           10300000
         AIF   ('&QUALIFY' NE 'RQSEND').QUAL17  IS "QUALIFY=RQSEND"?    10350000
         DC    X'10'               QUALIFY=RQSEND                       10400000
         AGO   .ENDQUAL                                                 10450000
.QUAL17  ANOP                                                           10500000
         AIF   ('&QUALIFY' NE 'SPEC').QUAL18    IS "QUALIFY=SPEC"?      10550000
         DC    X'11'               QUALIFY=SPEC                         10600000
         AGO   .ENDQUAL                                                 10650000
.QUAL18  ANOP                                                           10700000
         AIF   ('&QUALIFY' NE 'ACTSESS').QUAL19 IS "QUALIFY=ACTSESS"?   10750000
         DC    X'12'               QUALIFY=ACTSESS                      10800000
         AGO   .ENDQUAL                                                 10850000
.QUAL19  ANOP                                                           10900000
         AIF   ('&QUALIFY' NE 'DACTSESS').QUAL20 IS "QUALIFY=DACTSESS"? 10950000
         DC    X'13'               QUALIFY=DACTSESS                     11000000
         AGO   .ENDQUAL                                                 11050000
.QUAL20  ANOP                                                           11100000
         AIF   ('&QUALIFY' NE 'ALLOCD').QUAL21 IS "QUALIFY=ALLOCD"?     11150000
         DC    X'14'               QUALIFY=ALLOCD                       11200000
         AGO   .ENDQUAL                                                 11250000
.QUAL21  ANOP                                                           11300000
         AIF   ('&QUALIFY' NE 'IMMED').QUAL22 IS "QUALIFY=IMMED"?       11350000
         DC    X'15'               QUALIFY=IMMED                        11400000
         AGO   .ENDQUAL                                                 11450000
.QUAL22  ANOP                                                      @Q2A 11500000
         AIF   ('&QUALIFY' NE 'CONWIN').QUAL23 IS "QUALIFY=CONWIN"?     11550000
         DC    X'16'               QUALIFY=CONWIN                       11600000
         AGO   .ENDQUAL                                                 11650000
.QUAL23  ANOP                                                      @F1A 11700000
         AIF   ('&QUALIFY' NE 'SESSION').QUAL24 IS "QUALIFY=SESSION"?   11750000
         DC    X'17'               QUALIFY=SESSION                      11800000
         AGO   .ENDQUAL                                                 11850000
.QUAL24  ANOP                                                           11900000
         AIF   ('&QUALIFY' NE 'CONV').QUAL25 IS "QUALIFY=CONV"?    @F1A 11950000
         DC    X'18'               QUALIFY=CONV                         12000000
         AGO   .ENDQUAL                                                 12050000
.QUAL25  ANOP                                                      @F2A 12100000
         AIF   ('&QUALIFY' NE 'SUSPEND').QUAL26 IS "QUALIFY=SUSPEND"?   12150000
         DC    X'19'               QUALIFY=SUSPEND                      12200000
         AGO   .ENDQUAL                                                 12250000
.QUAL26  ANOP                                                      @F2A 12300000
         AIF   ('&QUALIFY' NE 'RESUME').QUAL27 IS "QUALIFY=RESUME"?     12350000
         DC    X'1A'               QUALIFY=RESUME                       12400000
         AGO   .ENDQUAL                                                 12450000
.QUAL27  ANOP                                                      @B1A 12500000
         AIF   ('&QUALIFY' NE 'RESTORE').QUAL28 IS "QUALIFY=RESTORE"?   12550000
         DC    X'1B'               QUALIFY=RESTORE                      12600000
         AGO   .ENDQUAL                                                 12650000
.QUAL28  ANOP                                                      @V1A 12700000
         AIF   ('&QUALIFY' NE 'SYNCBEG').QUAL29 IS "QUALIFY=SYNCBEG"?   12750000
         DC    X'1C'               QUALIFY=SYNCBEG                      12800000
         AGO   .ENDQUAL                                                 12850000
.QUAL29  ANOP                                                      @V1A 12900000
         AIF   ('&QUALIFY' NE 'SYNCEND').QUAL30 IS "QUALIFY=SYNCEND"?   12950000
         DC    X'1D'               QUALIFY=SYNCEND                      13000000
         AGO   .ENDQUAL                                                 13050000
.QUAL30  ANOP                                                      @KFA 13100000
         AIF   ('&QUALIFY' NE 'CONVGRP').QUAL31 IS "QUALIFY=CONVGRP"?   13150000
         DC    X'1E'               QUALIFY=CONVGRP                      13200000
         AGO   .ENDQUAL                                                 13250000
.QUAL31  ANOP                                                      @KHA 13300000
         AIF   ('&QUALIFY' NE 'WHENFREE').QUAL32 IS "QUALIFY=WHENFREE"? 13350000
         DC    X'1F'               QUALIFY=WHENFREE                @KHA 13400000
         AGO   .ENDQUAL                                            @KHA 13450000
.QUAL32  ANOP                                                      @V1C 13500000
         AIF   ('&QUALIFY' NE 'IANY').QUAL33 IS "QUALIFY=IANY"?    @I1A 13550000
         DC    X'20'               QUALIFY=IANY                    @I1A 13600000
         AGO   .ENDQUAL                                            @I1A 13650000
.QUAL33  ANOP                                                      @I1A 13700000
         AIF   ('&QUALIFY' NE 'ISPEC').QUAL34 IS "QUALIFY=ISPEC"?  @I1A 13750000
         DC    X'21'               QUALIFY=ISPEC                   @I1A 13800000
         AGO   .ENDQUAL                                            @I1A 13850000
.QUAL34  ANOP                                                      @I1A 13900000
         AIF   ('&QUALIFY' NE 'ALL').QUAL35 IS "QUALIFY=ALL"?      @I3A 13950000
         DC    X'22'               QUALIFY=ALL                     @I3A 14000000
         AGO   .ENDQUAL                                            @I3A 14050000
.QUAL35  ANOP                                                      @I3A 14100000
         AIF   ('&QUALIFY' NE 'IALL').QUAL36 IS "QUALIFY=IALL"?    @I3A 14150000
         DC    X'23'               QUALIFY=IALL                    @I3A 14200000
         AGO   .ENDQUAL                                            @I3A 14250000
.QUAL36  ANOP                                                      @I3A 14300000
         AIF   ('&QUALIFY' NE 'QUEUE').QUAL37 IS "QUALIFY=QUEUE"?  @D1A 14305500
         DC    X'24'               QUALIFY=QUEUE                   @D1A 14311000
         AGO   .ENDQUAL                                            @D1A 14316500
.QUAL37  ANOP                                                      @D1A 14322000
         AIF   ('&QUALIFY' NE 'DATAQUE').QUAL38 IS "QUALIFY=DATAQUE"?   14327500
         DC    X'25'               QUALIFY=DATAQUE                 @D1A 14333000
         AGO   .ENDQUAL                                            @D1A 14338500
.QUAL38  ANOP                                                      @D1A 14344000
         IST6MCER 5,QUALIFY,&QUALIFY            INVALID "QUALIFY="VALUE 14350000
         DC    X'00'               SUBTYPE OF APPCCMD                   14400000
.ENDQUAL ANOP                                                           14450000
         DC    XL2'0'              RESERVED                             14500000
         DC    XL4'0'              CONVERSATION ID                      14550000
.*                                                                      14600000
         AIF   ('&USERFLD' NE '').USF1          IS "USERFLD=" SPECIFIED 14650000
.*                                              NO - SET TO ZEROS       14700000
         DC    XL4'0'              USER FIELD                           14750000
         AGO   .USF5                                                    14800000
.USF1    ANOP                                                           14850000
&CHAR1   SETC  '&USERFLD'(1,2)                                          14900000
&NUM     SETA  K'&USERFLD                                               14950000
&CHAR2   SETC  '&USERFLD'(&NUM,1)                                       15000000
         AIF   ('&CHAR1' EQ 'C''').CKQ                                  15050000
         AIF   ('&CHAR1' NE 'X''').USF11                                15100000
&LEN     SETA  8                                                        15150000
         AGO   .CKQ                                                     15200000
.USF11   AIF   ('&CHAR1' EQ 'F''').CKQ                                  15250000
         AIF   ('&CHAR1' EQ 'A(').CKP                                   15300000
         AIF   ('&CHAR1' EQ 'V(').CKP                                   15350000
         IST6MCER 11,USERFLD                                            15400000
         DC    XL4'0'              USER FIELD                           15450000
         AGO   .USF5                                                    15500000
.CKP     AIF   ('&CHAR2' EQ ')').USF3                                   15550000
         AGO   .USF2                                                    15600000
.CKQ     AIF   ('&CHAR2' EQ '''').USF3                                  15650000
.USF2    IST6MCER 12,USERFLD                                            15700000
         DC    XL4'0'              USER FIELD                           15750000
         AGO   .USF5                                                    15800000
.USF3    ANOP                                                           15850000
&NUM     SETA  &NUM-3                                                   15900000
         AIF   (&NUM GT &LEN).USF4                                      15950000
&CHAR3   SETC  '&USERFLD'(3,&NUM)                                       16000000
&CHAR4   SETC  '&CHAR1'(2,1)                                            16050000
&CHAR1   SETC  '&CHAR1'(1,1)                                            16100000
&CHAR    SETC  '&CHAR1.L4&CHAR4&CHAR3&CHAR2'                            16150000
         DC    &CHAR               USER FIELD                           16200000
         AGO   .USF5                                                    16250000
.USF4    ANOP                                                           16300000
         IST6MCER 10,USERFLD,4                                          16350000
         DC    XL4'0'              USER FIELD                           16400000
.USF5    ANOP                                                           16450000
.*                                                                      16500000
         AIF   ('&SENSE' NE '').SENS1           IS "SENSE=" SPECIFIED   16550000
.*                                              NO - SET TO ZEROS       16600000
         DC    XL4'0'              OUTBOUND SENSE DATA                  16650000
         AGO   .SENS5                                                   16700000
.SENS1   ANOP                                                           16750000
&NUM     SETA  K'&SENSE                                                 16800000
&CHAR1   SETC  '&SENSE'(1,2)                                            16850000
&CHAR2   SETC  '&SENSE'(&NUM,1)                                         16900000
         AIF   ('&CHAR1' NE 'X''').SENS2                                16950000
         AIF   ('&CHAR2' NE '''').SENS3                                 17000000
&NUM     SETA   &NUM-3                                                  17050000
         AIF   (&NUM GT 8).SENS4                                        17100000
&CHAR3   SETC  '&SENSE'(3,&NUM)                                         17150000
         DC    XL4'&CHAR3'         OUTBOUND SENSE DATA                  17200000
         AGO   .SENS5                                                   17250000
.SENS2   ANOP                                                           17300000
         IST6MCER 11,SENSE                                              17350000
         DC    XL4'0'              OUTBOUND SENSE DATA                  17400000
         AGO   .SENS5                                                   17450000
.SENS3   ANOP                                                           17500000
         IST6MCER 12,SENSE                                              17550000
         DC    XL4'0'              OUTBOUND SENSE DATA                  17600000
         AGO   .SENS5                                                   17650000
.SENS4   ANOP                                                           17700000
         IST6MCER 10,SENSE,4                                            17750000
         DC    XL4'0'              OUTBOUND SENSE DATA                  17800000
.SENS5   ANOP                                                           17850000
.*                                                                      17900000
         DC    XL4'0'              SENSE DATA RETURNED BY APPCCMD       17950000
         DC    XL4'0'              SIGNAL DATA RETURNED                 18000000
         DC    X'00'               LENGTH OF SESSION IDENTIFICATION     18050000
         DC    XL3'0'              RESERVED                             18100000
         DC    XL8'0'              SESSION IDENTIFICATION               18150000
         DC    XL2'0'              PRIMARY RETURN CODE                  18200000
         DC    XL2'0'              SECONDARY RETURN CODE                18250000
.*                                                                      18300000
         DS    0F                  RPL6FLGS                             18350000
         AIF   ('&FILL' EQ '').FIL1             IS FILL SPECIFIED?      18400000
         AIF   ('&FILL' NE 'LL').FIL2           IS "FILL=LL"?           18450000
.*                                              YES - CONTINUE          18500000
.FIL1    ANOP                                                           18550000
&FILLBIT SETB  1                                YES - SET LL ON         18600000
         AGO   .FIL4                                                    18650000
.*                                              NO - CONTINUE           18700000
.FIL2    ANOP                                                           18750000
         AIF   ('&FILL' NE 'BUFF').FIL3         IS "FILL=BUFF"?         18800000
         AGO   .FIL4                                                    18850000
.*                                              NO - CONTINUE           18900000
.FIL3    ANOP                                                           18950000
         IST6MCER 5,FILL,&FILL                                          19000000
.FIL4    ANOP                                                           19050000
         AIF   ('&CD' EQ '').CD4                CD= SPECIFIED?          19100000
         AIF   ('&CD' NE 'DEFER').CD2           IS "CD=DEFER"?          19150000
.*                                              YES - CONTINUE          19200000
.CD1     ANOP                                                           19250000
&CDBIT   SETB  1                                YES - SET CD ON         19300000
         AGO   .CD4                                                     19350000
.*                                              NO - CONTINUE           19400000
.CD2     ANOP                                                           19450000
         AIF   ('&CD' NE 'IMMED').CD3           IS "CD=IMMED"?          19500000
         AGO   .CD4                                                     19550000
.*                                              NO - CONTINUE           19600000
.CD3     ANOP                                                           19650000
         IST6MCER 5,CD,&CD                                              19700000
.CD4     ANOP                                                           19750000
         DC    B'&FILLBIT.&CDBIT.000000'                                19800000
         AIF   ('&RTSRTRN' EQ '').RTSR4    RTSRTRN= SPECIFIED?     @I2A 19850000
         AIF   ('&RTSRTRN' NE 'BOTH').RTSR2  IS "RTSRTRN=BOTH"?    @I2A 19900000
.RTSR1   ANOP                                                      @I2A 19950000
.*                                         BIT IS INITIALIZED TO   @I2A 20000000
.*                                         RTSRTRN=BOTH (DEFAULT)  @I2A 20050000
         AGO   .RTSR4                                              @I2A 20100000
.RTSR2   ANOP                                                      @I2A 20150000
         AIF   ('&RTSRTRN' NE 'EXPD').RTSR3  IS "RTSRTRN=EXPD"?    @I2A 20200000
&RTSRBIT SETB  1                           YES - SET BIT ON        @I2A 20250000
         AGO   .RTSR4                                              @I2A 20300000
.RTSR3   ANOP                                                      @I2A 20350000
         IST6MCER 5,RTSRTRN,&RTSRTRN                               @I2A 20400000
.RTSR4   ANOP                                                      @I2A 20450000
         AIF   ('&CONXMOD' EQ '').CXMD5    IS "CONXMOD=" SPECIFIED @I2A 20500000
         AIF   ('&CONXMOD' NE 'CS').CXMD2  IS "CONXMOD=CS"?        @I2A 20550000
.CXMD1   ANOP                                                      @I2A 20600000
.*                                         BITS ARE INITIALIZED TO @I2A 20650000
.*                                         CONXMOD=CS (DEFAULT)    @I2A 20700000
         AGO   .CXMD5                                              @I2A 20750000
.CXMD2   ANOP                                                      @I2A 20800000
         AIF   ('&CONXMOD' NE 'CA').CXMD3  IS "CONXMOD=CA"?        @I2A 20850000
&CXMDB2  SETB  1                           SET BIT ON TO INDICATE  @I2A 20900000
.*                                         CONXMOD=CA              @I2A 20950000
         AGO   .CXMD5                                              @I2A 21000000
.CXMD3   ANOP                                                      @I2A 21050000
         AIF   ('&CONXMOD' NE 'SAME').CXMD4  IS CONXMOD=SAME ?     @I2A 21100000
&CXMDB1  SETB  1                           SET BIT ON TO INDICATE  @I2A 21150000
&CXMDB2  SETB  1                           CONXMOD=SAME(2 BITS)    @I2A 21200000
         AGO   .CXMD5                                              @I2A 21250000
.CXMD4   ANOP                                                      @I2A 21300000
         IST6MCER 5,CONXMOD,&CONXMOD                               @I2A 21350000
.CXMD5   ANOP                                                      @I2A 21400000
         AIF   ('&TYPE' EQ '').TYP5     IS TYPE SPECIFIED?              21450000
.*                                      YES - CONTINUE                  21500000
.TYP1    ANOP                                                           21550000
         AIF   ('&TYPE' NE 'PROGRAM').TYP2      IS "TYPE=PROGRAM"?      21600000
&TYPEB2  SETB  1                                YES - SET PROG ON       21650000
         AGO   .TYP5                                                    21700000
.*                                              NO - CONTINUE           21750000
.TYP2    ANOP                                                           21800000
         AIF   ('&TYPE' NE 'SERVICE').TYP3      IS "TYPE=SERVICE"?      21850000
&TYPEB1  SETB  1                                      SET SVC ON        21900000
         AGO   .TYP5                                                    21950000
.*                                              NO - CONTINUE           22000000
.TYP3    ANOP                                                           22050000
         AIF   ('&TYPE' NE 'USER').TYP4         IS "TYPE=USER"?         22100000
&TYPEB1  SETB  1                                                        22150000
&TYPEB2  SETB  1                                                        22200000
         AGO   .TYP5                                                    22250000
.TYP4    ANOP                                                           22300000
         IST6MCER 5,TYPE,&TYPE                                          22350000
.TYP5    ANOP                                                           22400000
         AIF   ('&NAMEUSE' NE '').NAMU2    IS "NAMEUSE=" OMITTED   @U2A 22450000
.NAMU1   ANOP                                                      @U2A 22500000
.*                                  BITS ARE INITIALIZED TO ZERO   @U2A 22550000
.*                                  FOR UNSPECIFIED NAMEUSE        @U2A 22600000
         AGO   .NAMU5                                              @U2A 22650000
.NAMU2   ANOP                                                      @U2A 22700000
         AIF   ('&NAMEUSE' NE 'APNAME').NAMU3  IS "NAMEUSE=APNAME" @U2A 22750000
&NAMUB1  SETB  1                    SET BIT ON FOR NAMEUSE=APNAME  @U2A 22800000
         AGO   .NAMU5                                              @U2A 22850000
.NAMU3   ANOP                                                      @U2A 22900000
         AIF   ('&NAMEUSE' NE 'GNAME').NAMU4  IS "NAMEUSE=GNAME"   @U2A 22950000
&NAMUB2  SETB  1                    SET BIT ON FOR NAMEUSE=GNAME   @U2A 23000000
         AGO   .NAMU5                                              @U2A 23050000
.NAMU4   ANOP                                                      @U2A 23100000
         IST6MCER 5,NAMEUSE,&NAMEUSE                               @U2A 23150000
.NAMU5   ANOP                                                      @U2A 23200000
         DC    B'0&RTSRBIT.&CXMDB1.&CXMDB2.&TYPEB1.&TYPEB2.&NAMUB1.&NAMX23250000
               UB2.'                                               @U2C 23300000
.*                                                                      23350000
         AIF   ('&LOCKS' EQ '').LOK1            IS LOCKS SPECIFIED?     23400000
         AIF   ('&LOCKS' NE 'SHORT').LOK2       IS "LOCKS=SHORT"?       23450000
.*                                              YES - CONTINUE          23500000
.LOK1    ANOP                                                           23550000
&LOCKBIT SETB  1                                YES - SET SHORT ON      23600000
         AGO   .LOK4                                                    23650000
.*                                              NO - CONTINUE           23700000
.LOK2    ANOP                                                           23750000
         AIF   ('&LOCKS' NE 'LONG').LOK3        IS "LOCKS=LONG"?        23800000
         AGO   .LOK4                                                    23850000
.*                                              NO - CONTINUE           23900000
.LOK3    ANOP                                                           23950000
         IST6MCER 5,LOCKS,&LOCKS                                        24000000
.LOK4    ANOP                                                           24050000
         AIF   ('&CONMODE' EQ '').CMOD1         IS "CONMODE=" SPECIFIED 24100000
         AIF   ('&CONMODE' NE 'CS').CMOD2       IS "CONMODE=CS"?        24150000
.CMOD1   ANOP                                                           24200000
&CMODB1  SETB  1                                SET BIT ON TO INDICATE  24250000
.*                                              CONMODE=CS              24300000
         AGO   .CMOD6                                                   24350000
.CMOD2   ANOP                                                           24400000
         AIF   ('&CONMODE' NE 'LLCA').CMOD3     IS "CONMODE=LLCA"?      24450000
         AGO   .CMOD6                                                   24500000
.CMOD3   ANOP                                                           24550000
         AIF   ('&CONMODE' NE 'BUFFCA').CMOD4   IS "CONMODE=BUFFCA"?    24600000
&CMODB2  SETB  1                                SET BIT ON TO INDICATE  24650000
.*                                              CONMODE=BUFFCA          24700000
         AGO   .CMOD6                                                   24750000
.CMOD4   ANOP                                                           24800000
         AIF   ('&CONMODE' NE 'SAME').CMOD5     IS CONMODE = SAME ?     24850000
&CMODB1  SETB  1                                SET BIT ON TO INDICATE  24900000
&CMODB2  SETB  1                                CONMODE=SAME(2 BITS)    24950000
         AGO   .CMOD6                                                   25000000
.CMOD5   ANOP                                                           25050000
         IST6MCER 5,CONMODE,&CONMODE                                    25100000
.CMOD6   ANOP                                                           25150000
         DC    B'&LOCKBIT.000&CMODB1&CMODB2.00'                         25200000
.*                                                                      25250000
         DC    X'00'               FOURTH INDICATORS BYTE               25300000
         AIF   ('&LUNAME' NE '').LUNAM1         IS "LUNAME=" SPECIFIED  25350000
.*                                              NO - SET TO ZEROS       25400000
         DC    XL8'0'              LU NAME                              25450000
         AGO   .LUNAM3                                                  25500000
.LUNAM1  ANOP                                                           25550000
         AIF   (K'&LUNAME GT 8).LUNAM2          IS LUNAME TOO LARGE     25600000
.*                                              NO - INSERT VALUE       25650000
         DC    CL8'&LUNAME'        LU NAME                              25700000
         AGO   .LUNAM3                                                  25750000
.LUNAM2  ANOP                                                           25800000
         IST6MCER 10,LUNAME,8                   YES - ISSUE MNOTE       25850000
.*                                              AND SET TO ZEROS        25900000
         DC    XL8'0'              LU NAME                              25950000
.LUNAM3  ANOP                                                           26000000
*                                                                       26050000
         AIF   ('&LOGMODE' NE '').LMOD1         IS "LOGMODE=" SPECIFIED 26100000
.*                                              NO - SET TO ZEROS       26150000
         DC    XL8'0'              LOGMODE NAME                         26200000
         AGO   .LMOD4                                                   26250000
.LMOD1   ANOP                                                           26300000
         AIF   ('&LOGMODE' NE 'C''''').LMOD2                            26350000
         DC    CL8' '              LOGMODE NAME                         26400000
         AGO   .LMOD4                                                   26450000
.LMOD2   ANOP                                                           26500000
         AIF   (K'&LOGMODE GT 8).LMOD3          IS LOGMODE TOO LARGE    26550000
.*                                              NO - INSERT VALUE       26600000
         DC    CL8'&LOGMODE'       LOGMODE NAME                         26650000
         AGO   .LMOD4                                                   26700000
.LMOD3   ANOP                                                           26750000
         IST6MCER 10,LOGMODE,8                  YES - ISSUE MNOTE       26800000
.*                                              AND SET TO ZEROS        26850000
         DC    XL8'0'              LOGMODE NAME                         26900000
.LMOD4   ANOP                                                           26950000
         DC    XL2'0'              WHAT RECEIVED INDICATOR              27000000
*                                  FIELD                                27050000
         DC    X'00'               RETURNED INDICATORS AS               27100000
*                                  A RESULT OF APPCCMD                  27150000
         DC    X'00'               LENGTH OF THE FMH5 RECEIVED          27200000
         DC    X'00'               RESERVED                             27250000
         DC    X'00'               RPL6 ACTIVE INDICATOR                27300000
         DC    XL2'0'              RESERVED                             27350000
         DC    A(0)                TASK ID                              27400000
         DC    A(0)                ADDRESS OF RPL                       27450000
         DC    A(0)                CURRENT BUFFER ADDRESS   @P043961    27500000
*                                  AT STORAGE SHORTAGE      @P043961    27550000
         DC    A(0)                DISPLACEMENT IN CURRENT  @P043961    27600000
*                                  BUFFER AT STORAGE        @P043961    27650000
*                                  SHORTAGE                 @P043961    27700000
.VOUTL   ANOP                      OUTPUT VECTOR LENGTH PARM CHECK @S1A 27708300
.*                                     ENSURE BOTH PARMS ARE CODED      27716600
.*                                     OR BOTH PARMS ARE NOT CODED @S1A 27724900
         AIF   (('&VTROUTA' EQ '') AND ('&VTROUTL' EQ '')).NOVOLP  @S1A 27733200
         AIF   (('&VTROUTA' EQ '') OR  ('&VTROUTL' EQ '')).VOLERR  @S1A 27741500
         DC    AL2(&VTROUTL)       VECTOR OUTPUT AREA LENGTH       @S1A 27749800
         AGO   .VINL                                               @S1A 27758100
.VOLERR  ANOP                                                      @S1A 27766400
         IST6MCER 13,VTROUTA,VTROUTL   ONLY ONE PARM CODED         @S1A 27774700
.NOVOLP  DC    AL2(0)              VECTOR OUTPUT AREA LENGTH       @S1C 27783000
.VINL    ANOP                      INPUT VECTOR LENGTH PARM CHECK  @S1A 27791300
.*                                     ENSURE BOTH PARMS ARE CODED      27800000
.*                                     OR BOTH PARMS ARE NOT CODED @L1A 27850000
         AIF   (('&VTRINA' EQ '') AND ('&VTRINL' EQ '')).NOVILP    @L1A 27900000
         AIF   (('&VTRINA' EQ '') OR  ('&VTRINL' EQ '')).VILERR    @S1C 27950000
         DC    AL2(&VTRINL)        VECTOR INPUT AREA LENGTH        @L2C 28000000
         AGO   .NETID                                              @L1A 28150000
.VILERR  ANOP                                                      @S1C 28200000
         IST6MCER 13,VTRINA,VTRINL     ONLY ONE PARM CODED         @S1C 28250000
.NOVILP  DC    AL2(0)              VECTOR INPUT AREA LENGTH        @L2C 28300000
.NETID   ANOP                                                           28350000
         AIF   ('&NETID' NE '').NETID1        IS "NETID=" SPECIFIED     28400000
.*                                            NO - SET TO ZEROS @KGA    28450000
         DC    XL8'0'              NETID                        @KGA    28500000
         AGO   .NETID3                                                  28550000
.NETID1  ANOP                                                           28600000
         AIF   (K'&NETID GT 8).NETID2         IS NETID TOO LARGE        28650000
.*                                            NO - INSERT VALUE @KGA    28700000
         DC    CL8'&NETID'         NETID                        @KGA    28750000
         AGO   .NETID3                                                  28800000
.NETID2  ANOP                                                           28850000
         IST6MCER 10,NETID,8                  YES - ISSUE MNOTE @KGA    28900000
.*                                            AND SET TO ZEROS          28950000
         DC    XL8'0'              NETID                        @KGA    29000000
.NETID3  ANOP                                                           29050000
*                                                                       29100000
         DC    XL4'0'              Conversation Group ID        @KFA    29150000
.VOUTA   ANOP                     OUTPUT VECTOR ADDRESS PARM CHECK @S1A 29158300
.*                                     ENSURE BOTH PARMS ARE CODED      29166600
.*                                     OR BOTH PARMS ARE NOT CODED @S1A 29174900
         AIF   (('&VTROUTA' EQ '') AND ('&VTROUTL' EQ '')).NOVOAP  @S1A 29183200
         AIF   (('&VTROUTA' EQ '') OR  ('&VTROUTL' EQ '')).VOAERR  @S1A 29191500
         DC    A(&VTROUTA)         VECTOR OUTPUT AREA ADDRESS      @S1A 29199800
         AGO   .VINA                                               @S1A 29208100
.VOAERR  ANOP                                                      @S1A 29216400
.* *** ERROR MESSAGE ALREADY ISSUED IN VTROUTL VALIDATION ABOVE    @S1A 29224700
.NOVOAP  DC    A(0)                VECTOR OUTPUT AREA ADDRESS      @S1C 29233000
.VINA    ANOP                      INPUT VECTOR ADDRESS PARM CHECK @S1A 29241300
.*                                     ENSURE BOTH PARMS ARE CODED      29250000
.*                                     OR BOTH PARMS ARE NOT CODED @L1A 29300000
         AIF   (('&VTRINA' EQ '') AND ('&VTRINL' EQ '')).NOVIAP    @S1C 29350000
         AIF   (('&VTRINA' EQ '') OR  ('&VTRINL' EQ '')).VIAERR    @S1C 29400000
         DC    A(&VTRINA)          VECTOR INPUT AREA ADDRESS       @L2C 29450000
         AGO   .REXIT                                              @L1A 29600000
.VIAERR  ANOP                                                      @S1C 29650000
.* *** ERROR MESSAGE ALREADY ISSUED IN VTRINL CHECKING ABOVE       @S1C 29700000
.NOVIAP  DC    A(0)                VECTOR INPUT AREA ADDRESS       @L2C 29750000
.*                                                                 @L1A 29800000
.REXIT   MEND                                                      @L1C 29850000
