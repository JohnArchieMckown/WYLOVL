*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IOSUPFA                               -09/07/93-<1> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  Obtain UCB prefix address                     * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00600000
*     5655-068 (C) COPYRIGHT IBM CORP. 1993                           * 00650000
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00700000
*                                                                     * 00750000
* STATUS= HBB5510                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*                                                                     * 00950000
*01* FUNCTION:                                                        * 01000000
*                                                                     * 01050000
*                                                                     * 01100000
*      The IOSUPFA macro obtains the UCB prefix address.              * 01150000
*                                                                     * 01200000
*01* EXTERNAL CLASSIFICATION:  PSPI                                   * 01250000
*                                                                     * 01300000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01350000
*                                                                     * 01400000
*01* ENVIRONMENT:                                                     * 01450000
*                                                                     * 01500000
*                                                                     * 01550000
*      Dispatchable unit mode: Task or SRB mode.                      * 01600000
*                                                                     * 01650000
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 01683300
*                        key.                                         * 01716600
*                                                                     * 01750000
*      AMODE:            31-bit.                                      * 01800000
*                                                                     * 01850000
*      ASC mode:         Primary.                                     * 01900000
*                                                                     * 01950000
*      Serialization:    Enabled or Disabled.                         * 02000000
*                                                                     * 02050000
*                                                                     * 02100000
*                                                                     * 02125000
*01* PROGRAMMING REQUIREMENTS:                                        * 02150000
*                                                                     * 02200000
*    Users of this macro must make sure that the UCB will not be      * 02250000
*    deleted.  The application must PIN the UCB, or make sure the     * 02300000
*    environment it is executing in will not allow the UCB to be      * 02350000
*    deleted.                                                         * 02400000
*                                                                     * 02450000
*    This service will not have any recovery. The USER must supply    * 02500000
*    recovery to handle any unexpected errors (ie. ABEND).            * 02550000
*                                                                     * 02555500
*    The preferred method of accessing the UCB PREFIX is to use the   * 02561000
*    UCB services UCBINFO, UCBLOOK, or UCBSCAN to get a copy of the   * 02566500
*    UCB PREFIX. These services will provide recovery and             * 02574800
*    serialization, and should be used if performance is not a        * 02583100
*    concern.                                                         * 02591400
*                                                                     * 02600000
*01* INPUT REGISTER INFORMATION:                                      * 02650000
*                                                                     * 02700000
*                                                                     * 02750000
*    REGISTER  CONTENTS                                               * 02800000
*                                                                     * 02850000
*    0 - 1     Used by the service                                    * 02900000
*                                                                     * 02950000
*    2 - 13    caller's registers                                     * 03000000
*                                                                     * 03050000
*    14        The return address                                     * 03100000
*                                                                     * 03150000
*    15        Entry point to the service.                            * 03200000
*                                                                     * 03250000
*                                                                     * 03300000
*                                                                     * 03325000
*    Before issuing the IOSUPFA the caller does not have to place any * 03350000
*    information into any AR.                                         * 03400000
*                                                                     * 03450000
*01* OUTPUT REGISTER INFORMATION:                                     * 03500000
*                                                                     * 03550000
*                                                                     * 03600000
*    REGISTER  CONTENTS                                               * 03650000
*                                                                     * 03700000
*    0 - 1     Unpredictable                                          * 03750000
*                                                                     * 03800000
*    2 - 13    caller's registers                                     * 03850000
*                                                                     * 03900000
*    14        The return address                                     * 03950000
*                                                                     * 04000000
*    15        Unpredictable                                          * 04050000
*                                                                     * 04100000
*                                                                     * 04150000
*                                                                     * 04175000
*    When control returns to the caller, the ARs will contain what    * 04200000
*    they had at entry.                                               * 04250000
*                                                                     * 04300000
*01* SYNTAX:                                                          * 04350000
*                                                                     * 04400000
*[xlabel]  IOSUPFA     UCBPTR=xucbptr                                 * 04450000
*                     ,UCBPADDR=xucbpaddr                             * 04500000
*                   [,MF=S]                                          * 04550000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 04600000
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 04650000
*                                                                     * 04700000
*                                                                     * 04750000
*      Where:                                                         * 04800000
*                                                                     * 04850000
*                                                                     * 04900000
*      [xlabel]                                                       * 04950000
*          is an optional symbol, starting in column 1, that is the   * 05000000
*          name on the IOSUPFA macro invocation.  The name must       * 05050000
*          conform to the rules for an ordinary assembler language    * 05100000
*          symbol.                                                    * 05150000
*          DEFAULT: No name.                                          * 05200000
*                                                                     * 05250000
*                                                                     * 05300000
*                                                                     * 05350000
*                                                                     * 05375000
*      UCBPTR=xucbptr                                                 * 05400000
*          is the name (RS-type), or address in register (2)-(12), of * 05450000
*          a required 4 byte input that contains the address of the   * 05500000
*          UCB whose prefix is to be obtained.  NOTE. The address     * 05550000
*          passed to the service must not be associated with a COPY   * 05600000
*          UCB.                                                       * 05650000
*                                                                     * 05700000
*                                                                     * 05750000
*                                                                     * 05800000
*                                                                     * 05825000
*      UCBPADDR=xucbpaddr                                             * 05850000
*          is the name (RS-type), or address in register (2)-(12), of * 05900000
*          a required 4 byte output that will contain the address of  * 05950000
*          the UCB prefix.  NOTE. This storage must be in FIXED       * 06000000
*          storage or DREF storage if the caller is disabled.         * 06050000
*                                                                     * 06100000
*                                                                     * 06150000
*                                                                     * 06200000
*                                                                     * 06225000
*      [MF=S|L|E]                                                   * 06250000
*          is an optional keyword input which specifies the macro     * 06300000
*          form.                                                      * 06350000
*          DEFAULT: S                                                 * 06400000
*                                                                     * 06450000
*                                                                     * 06500000
*          [MF=S]                                                     * 06550000
*              specifies the standard form of the macro.  The "S"     * 06600000
*              form generates code to put the parameters into an      * 06650000
*              in-line parameter list and invoke the desired service. * 06700000
*              Full checking for required macro keys is done along    * 06750000
*              with supplying defaults for omitted optional           * 06800000
*              parameters.                                            * 06850000
*                                                                     * 06900000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 06950000
*              specifies the list form of the macro.  The "L" form    * 07000000
*              defines an area to be used for the parameter list.     * 07050000
*              Any other macro parameters are flagged as errors.      * 07100000
*                                                                     * 07150000
*            ,xmfctrl                                                 * 07200000
*              is a required input.  It is the name of a storage area * 07250000
*              for the parameter list.                                * 07300000
*                                                                     * 07350000
*            ,xmfattr|0D                                            * 07400000
*              is an optional 60 character input string that varies   * 07450000
*              from 1 to 60 characters. It can contain any value that * 07500000
*              is valid on an assembler DS pseudo-op. You can use     * 07550000
*              this parameter to force boundary alignment of the      * 07600000
*              parameter list.                                        * 07650000
*              DEFAULT: 0D which forces the parameter list to a       * 07700000
*              doubleword boundary.                                   * 07750000
*                                                                     * 07800000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 07850000
*              specifies the execute form of the macro.  The "E" form * 07900000
*              generates code to put the parameters into the          * 07950000
*              parameter list specified by xmfctrl and provides full  * 08000000
*              syntax checking with default setting.                  * 08050000
*                                                                     * 08100000
*            ,xmfctrl                                                 * 08150000
*              is a required input.  It is the name (RS-type), or     * 08200000
*              address in register (1)-(12), of a storage area for    * 08250000
*              the parameter list.                                    * 08300000
*                                                                     * 08350000
*            ,COMPLETE                                              * 08400000
*              is an optional keyword input which specifies the       * 08450000
*              degree of macro parameter syntax checking.             * 08500000
*              DEFAULT: COMPLETE                                      * 08550000
*                                                                     * 08600000
*                                                                     * 08650000
*              COMPLETE   Checking for required macro keys is done    * 08700000
*                        and defaults are supplied for omitted        * 08750000
*                        optional parameters.                         * 08800000
*                                                                     * 08850000
*                                                                     * 08900000
*                                                                     * 08950000
*                                                                     * 09000000
*                                                                     * 09012500
*                                                                     * 09025000
*                                                                     * 09037500
*01* RETURN CODES:  None.                                             * 09050000
*                                                                     * 09100000
*01* REASON CODES:  None.                                             * 09150000
*                                                                     * 09200000
*01* MODULE TYPE:  ASSEM MACRO                                        * 09250000
*                                                                     * 09300000
*02*   PROCESSOR:  ASSEM                                              * 09350000
*                                                                     * 09400000
*01* COMPONENT:  SC1C3                                                * 09450000
*                                                                     * 09500000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 09550000
*                                                                     * 09600000
*01* MACRO USAGE NOTES:                                               * 09650000
*                                                                     * 09700000
*                                                                     * 09750000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 09800000
*        global macro variable.  Any value other than 'NO' will       * 09850000
*        result in the macro expansion being printed.  The default is * 09900000
*        'YES'.  The following examples illustrate how the ZPRINT     * 09950000
*        variable should be set.                                      * 10000000
*                                                                     * 10050000
*                    GBLC &ZPRINT                                     * 10100000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 10150000
*                                                                     * 10200000
*                                                                     * 10250000
*                                                                     * 10275000
*01* CHANGE ACTIVITY:                                                 * 10300000
*                                                                     * 10350000
*   Flag LineItem  FMID    Date   ID    Comment                       * 10400000
*                                                                     * 10450000
*    $L0=4DGIT    HBB5510 930128 PDKB:  Four Digit Support            * 10500000
*    $P0=PIG4145  HBB5510 930415 PDKB:  AMODE is incorrect should be  * 10516600
*                                         31 bit only.                * 10533200
*    $P1=PIG2165  HBB5510 930715 PDKB:  Remove a note from the        * 10534100
*                                         program requirements.       * 10535000
*    $P2=PIG2883  HBB5510 930907 PDKB:  Remove supervisor state       * 10535700
*                                         restriction.                * 10536400
*    $D0=DCR149   HBB5510 930715 PDKB:  Add comment that the          * 10537100
*                                         preferred method of         * 10539200
*                                         accessing the UCB PREFIX is * 10541300
*                                         to use the UCB services     * 10543400
*                                         UCBINFO, UCBLOOK, or        * 10545500
*                                         UCBSCAN.                    * 10547600
****** END OF SPECIFICATIONS *****************************************/ 10550000
*/********************************************************************* 10600000
         MACRO                                                          10650000
&XLABEL  IOSUPFA &UCBPTR=,&UCBPADDR=,&MF=                               10700000
.*                                                                      10750000
*              MACDATE -09/07/93-<1>                                    10800000
.*                                                                      10850000
.*******************************************************************    10900000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        10950000
.*******************************************************************    11000000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   11050000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     11100000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             11150000
.*                                                                      11200000
              GBLC  &ZIOSUPFA   YES=MACRO USED AT LEAST ONCE            11250000
.*******************************************************************    11300000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          11350000
.*******************************************************************    11400000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 11450000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            11500000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              11550000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             11600000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             11650000
              LCLA  &ZAWRK      USED AS A WORK AREA                     11700000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  11750000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   11800000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 11850000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             11900000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 11950000
              LCLA  &ZMACRET    MACRO RETURN CODE                       12000000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        12050000
.*                                                                      12100000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      12150000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              12200000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   12250000
.********************************************************************   12300000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 12350000
.********************************************************************   12400000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 12450000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          12500000
.*                                                                      12550000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       12600000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        12650000
              SPLEVEL  TEST                                             12700000
.ZSYS2        ANOP  ,                                                   12750000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              12800000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              12850000
              SYSSTATE TEST                                             12900000
              AGO   .ZSYS4                                              12950000
.ZSYS3        ANOP  ,                                                   13000000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 13050000
.ZSYS4        ANOP  ,                                                   13100000
.*******************************************************************    13150000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   13200000
.*******************************************************************    13250000
              LCLC  &XUCBPTR    ++ NAME                                 13300000
              LCLC  &XUCBPADDR  ++ NAME                                 13350000
              LCLC  &XMF        ++ VALUE                                13400000
              LCLC  &XMFCTRL    ++ NAME                                 13450000
              LCLC  &XMFATTR    ++ VALUE                                13500000
              LCLC  &XMFSCK     ++ VALUE                                13550000
.*******************************************************************    13600000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           13650000
.*******************************************************************    13700000
              LCLC  &ZXUCBPTR   ++ INPUT NAME                           13750000
              LCLC  &ZXUCBPADDR                 ++ OUTPUT NAME          13800000
              LCLC  &ZXMF       ++ INPUT VALUE                          13850000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           13900000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          13950000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          14000000
.********************************************************************   14050000
.***AG.MF01 PROCESS MF MACRO FORMS                                      14100000
.********************************************************************   14150000
              ACTR  10000                                               14200000
.*------------------------------------------------------------------    14250000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           14300000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    14350000
.*-------------------------------------------------------------------   14400000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           14450000
.ZG9          ANOP  ,                                                   14500000
&ZTLC         SETC 'S'                                                  14550000
              AIF   ('&MF(1)' NE '&ZTLC').ZG10                          14600000
&XMF          SETC  'S'         SET KEYWORD                             14650000
              AIF   (N'&MF LE 1).ZG9A           CK NUM                  14700000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           14750000
&ZMS          SETC  '&ZMS.&MF"'                                         14800000
&ZMS          SETC  '&ZMS "MF"'                                         14850000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 14900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             14950000
.ZG9A         ANOP  ,                                                   15000000
.*-------------------------------------------------------------------   15050000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           15100000
.ZG10         ANOP  ,                                                   15150000
&ZTLC         SETC 'L'                                                  15200000
              AIF   ('&MF(1)' NE '&ZTLC').ZG17                          15250000
&XMF          SETC  'L'         SET KEYWORD                             15300000
              AIF   (N'&MF LE 3).ZG10A          CK NUM                  15350000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           15400000
&ZMS          SETC  '&ZMS.&MF"'                                         15450000
&ZMS          SETC  '&ZMS "MF"'                                         15500000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                15550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             15600000
.ZG10A        ANOP  ,                                                   15650000
.*-------------------------------------------------------------------   15700000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     15750000
              AIF   (N'&SYSLIST NE 0).ZG10B     POSITIONALS?            15800000
              AIF   ('&UCBPTR' NE '').ZG10B     KEYS?                   15850000
              AIF   ('&UCBPADDR' NE '').ZG10B   KEYS?                   15900000
              AGO    .ZG10C     INVOCATION OKAY                         15950000
.ZG10B        ANOP  ,                                                   16000000
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         16050000
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   16100000
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              16150000
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        16200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             16250000
.ZG10C        ANOP  ,                                                   16300000
.*-------------------------------------------------------------------   16350000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   16400000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           16450000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           16500000
              AIF   (N'&MF(2) GT 1).ZG12B       MULTI PARMS             16550000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           16600000
.ZG12B        AIF   (K'&MF(2) GT 0).ZG12C                               16650000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         16700000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 16750000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 16800000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        16850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             16900000
.ZG12C        ANOP  ,                                                   16950000
.*-------------------------------------------------------------------   17000000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               17050000
              AIF   (K'&ZXMFCTRL LE 0).ZG12P    NOT I/O                 17100000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG12P                      17150000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         17200000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           17250000
&ZMS          SETC  '&ZMS.&MF"'                                         17300000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           17350000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   17400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             17450000
.ZG12P        ANOP  ,                                                   17500000
.*-------------------------------------------------------------------   17550000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      17600000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           17650000
&XMFATTR      SETC  '0D'                                                17700000
              AIF   (K'&MF(3) LE 0).ZG15B       PARM                    17750000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           17800000
              AIF   (N'&MF(3) GT 1).ZG15B       MULTI PARMS             17850000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           17900000
.ZG15B        ANOP  ,                                                   17950000
.*-------------------------------------------------------------------   18000000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  18050000
              AIF   (K'&ZXMFATTR LE 0).ZG15P    NOT I/O                 18100000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG15P                      18150000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         18200000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           18250000
&ZMS          SETC  '&ZMS.&MF"'                                         18300000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           18350000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   18400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18450000
.ZG15P        ANOP  ,                                                   18500000
.*-------------------------------------------------------------------   18550000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 18600000
              AIF   (K'&ZXMFATTR LE 0).ZG15S    NOT I/O                 18650000
              AIF   (K'&XMFATTR LE 60).ZG15S    LNG OK                  18700000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         18750000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           18800000
&ZMS          SETC  '&ZMS.&MF"'                                         18850000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               18900000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  18950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19000000
.ZG15S        ANOP  ,                                                   19050000
.*-------------------------------------------------------------------   19100000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           19150000
.ZG17         ANOP  ,                                                   19200000
&ZTLC         SETC 'E'                                                  19250000
              AIF   ('&MF(1)' NE '&ZTLC').ZG25                          19300000
&XMF          SETC  'E'         SET KEYWORD                             19350000
              AIF   (N'&MF LE 3).ZG17A          CK NUM                  19400000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           19450000
&ZMS          SETC  '&ZMS.&MF"'                                         19500000
&ZMS          SETC  '&ZMS "MF"'                                         19550000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                19600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19650000
.ZG17A        ANOP  ,                                                   19700000
.*-------------------------------------------------------------------   19750000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   19800000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           19850000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           19900000
              AIF   (N'&MF(2) GT 1).ZG19B       MULTI PARMS             19950000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           20000000
.ZG19B        AIF   (K'&MF(2) GT 0).ZG19C                               20050000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         20100000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 20150000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 20200000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        20250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             20300000
.ZG19C        ANOP  ,                                                   20350000
.*-------------------------------------------------------------------   20400000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              20450000
              AIF   (K'&ZXMFCTRL LE 0).ZG19R    NOT I/O                 20500000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG19R                      20550000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          20600000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        20650000
              AIF   (K'&ZCGPR GT 2).ZG19Q                               20700000
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             20750000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       20800000
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        20850000
.ZG19P        ANOP  ,                                                   20900000
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             20950000
              AIF   ('&ZCGPR' LT '1').ZG19Q                             21000000
              AIF   ('&ZCGPR' LE '12').ZG19R                            21050000
.ZG19Q        ANOP  ,                                                   21100000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           21150000
&ZMS          SETC  '&ZMS.&MF"'                                         21200000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           21250000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    21300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             21350000
.ZG19R        ANOP  ,                                                   21400000
.*-------------------------------------------------------------------   21450000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             21500000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    21550000
.ZG23A   AIF   ('&MF(3)' NE 'COMPLETE').ZG24A                           21600000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             21650000
.*-------------------------------------------------------------------   21700000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             21750000
.ZG24A        AIF   (K'&XMFSCK GT 0).ZG24C      KEYWORD                 21800000
              AIF   (K'&MF(3) LE 0).ZG24B                               21850000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           21900000
&ZMS          SETC  '&ZMS.&MF"'                                         21950000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           22000000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 22050000
&ZMS          SETC  '&ZMS "COMPLETE".'          VALID KEYWORD           22100000
              MNOTE 8,' &ZMS '                                          22150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22200000
.ZG24B        ANOP  ,                                                   22250000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     22300000
.ZG24C        ANOP  ,                                                   22350000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           22400000
.*------------------------------------------------------------------    22450000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           22500000
.ZG25         ANOP  ,                                                   22550000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           22600000
              AIF   (K'&XMF GT 0).ZG25E         VALID ARG               22650000
              AIF   (T'&MF EQ 'O').ZG25D        OMITTED                 22700000
&ZASYSLNDX    SETA  0                                                   22750000
.ZG25A        ANOP  ,           POSITIONAL MACRO KEY                    22800000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        22850000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C                    22900000
&ZTLC         SETC 'MF'                                                 22950000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG25A           23000000
.ZG25B        ANOP  ,                                                   23050000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         23100000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           23150000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             23200000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    23250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23300000
              AGO   .ZG25E                                              23350000
.ZG25C        ANOP  ,                                                   23400000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         23450000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           23500000
&ZMS          SETC  '&ZMS.&MF"'                                         23550000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           23600000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 23650000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           23700000
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           23750000
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           23800000
              MNOTE 8,' &ZMS '                                          23850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23900000
              AGO   .ZG25E                                              23950000
.ZG25D        ANOP  ,                                                   24000000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     24050000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       24100000
.ZG25E        ANOP  ,                                                   24150000
.********************************************************************   24200000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 24250000
.********************************************************************   24300000
              ACTR  10000                                               24350000
.*-------------------------------------------------------------------   24400000
.***AG.MF03 MF=(SLE)                                                    24450000
              AIF   ('&XMF' EQ 'L').ZGMFX                               24500000
.*----------------------------------------------------------------***   24550000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     24600000
              AIF   (N'&UCBPTR LE 1).ZG2A       CK NUM                  24650000
&ZMS          SETC  '"UCBPTR='  *KPOSA* MNOTE                           24700000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     24750000
&ZMS          SETC  '&ZMS "UCBPTR"'                                     24800000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 24850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24900000
.ZG2A         ANOP  ,                                                   24950000
.*-------------------------------------------------------------------   25000000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         25050000
&ZXUCBPTR     SETC  'INPUT'     SET IN/OUTPUT                           25100000
&XUCBPTR      SETC  '&UCBPTR(1)'                SET XVARIABLE           25150000
              AIF   (N'&UCBPTR GT 1).ZG2B       MULTI PARMS             25200000
&XUCBPTR      SETC  '&UCBPTR'   SET XVARIABLE                           25250000
.ZG2B         AIF   (K'&UCBPTR(1) GT 0).ZG2C                            25300000
&ZXUCBPTR     SETC  ''          RESET IN/OUTPUT                         25350000
&ZMS          SETC  ' '         *KRQDA*                                 25400000
&ZMS          SETC  '&ZMS "UCBPTR" KEY AND ITS ARGUMENT'                25450000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             25500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25550000
.ZG2C         ANOP  ,                                                   25600000
.*-------------------------------------------------------------------   25650000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    25700000
              AIF   (K'&ZXUCBPTR LE 0).ZG2R     NOT I/O                 25750000
              AIF   ('&XUCBPTR'(1,1) NE '(').ZG2R                       25800000
&ZCGPR        SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                          25850000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         25900000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                25950000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              26000000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       26050000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        26100000
.ZG2P         ANOP  ,                                                   26150000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             26200000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              26250000
              AIF   ('&ZCGPR' LE '12').ZG2R                             26300000
.ZG2Q         ANOP  ,                                                   26350000
&ZMS          SETC  '"UCBPTR='  *KGPRA* MNOTE                           26400000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     26450000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           26500000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    26550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26600000
.ZG2R         ANOP  ,                                                   26650000
.*----------------------------------------------------------------***   26700000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    26750000
              AIF   (N'&UCBPADDR LE 1).ZG5A     CK NUM                  26800000
&ZMS          SETC  '"UCBPADDR='                *KPOSA* MNOTE           26850000
&ZMS          SETC  '&ZMS.&UCBPADDR"'                                   26900000
&ZMS          SETC  '&ZMS "UCBPADDR"'                                   26950000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 27000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27050000
.ZG5A         ANOP  ,                                                   27100000
.*-------------------------------------------------------------------   27150000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        27200000
&ZXUCBPADDR   SETC  'OUTPUT'    SET IN/OUTPUT                           27250000
&XUCBPADDR    SETC  '&UCBPADDR(1)'              SET XVARIABLE           27300000
              AIF   (N'&UCBPADDR GT 1).ZG5B     MULTI PARMS             27350000
&XUCBPADDR    SETC  '&UCBPADDR'                 SET XVARIABLE           27400000
.ZG5B         AIF   (K'&UCBPADDR(1) GT 0).ZG5C                          27450000
&ZXUCBPADDR   SETC  ''          RESET IN/OUTPUT                         27500000
&ZMS          SETC  ' '         *KRQDA*                                 27550000
&ZMS          SETC  '&ZMS "UCBPADDR" KEY AND ITS ARGUMENT'              27600000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             27650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27700000
.ZG5C         ANOP  ,                                                   27750000
.*-------------------------------------------------------------------   27800000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   27850000
              AIF   (K'&ZXUCBPADDR LE 0).ZG5R   NOT I/O                 27900000
              AIF   ('&XUCBPADDR'(1,1) NE '(').ZG5R                     27950000
&ZCGPR        SETC  '&XUCBPADDR'(2,K'&XUCBPADDR-2)                      28000000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         28050000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                28100000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              28150000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       28200000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        28250000
.ZG5P         ANOP  ,                                                   28300000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             28350000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              28400000
              AIF   ('&ZCGPR' LE '12').ZG5R                             28450000
.ZG5Q         ANOP  ,                                                   28500000
&ZMS          SETC  '"UCBPADDR='                *KGPRA* MNOTE           28550000
&ZMS          SETC  '&ZMS.&UCBPADDR"'                                   28600000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           28650000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    28700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28750000
.ZG5R         ANOP  ,                                                   28800000
.******************************************************************     28850000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        28900000
.******************************************************************     28950000
              ACTR  10000                                               29000000
.*----------------------------------------------------------------***   29050000
.***AH.P02 EXTRA POSITIONALS                                            29100000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               29150000
&ZCVAL        SETC  ''          ERROR FIELD                             29200000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       29250000
.ZGLIST2      ANOP  ,                                                   29300000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         29350000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                29400000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   29450000
              AGO   .ZGLIST2                                            29500000
.*                                                                      29550000
.ZGLIST3      ANOP  ,                                                   29600000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             29650000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           29700000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     29750000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              29800000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      29850000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              29900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             29950000
.ZGLISTX      ANOP  ,                                                   30000000
&ZASYSLNDX    SETA  0                                                   30050000
.*-------------------------------------------------------------------   30100000
.***AG.MF04 MF=(SLE)                                                    30150000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                30200000
.*******************************************************************    30250000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       30300000
.*******************************************************************    30350000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          30400000
.*******************************************************************    30450000
.***AE.01  START OF IOSUPFA MACRO CODE                                  30500000
.*******************************************************************    30550000
              LCLC  &M0M0001                 NAME                       30600000
&M0M0001      SETC  '&XLABEL'                SET NAME                   30650000
              AIF   (K'&XLABEL NE 0).XLAB2                              30700000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               30750000
.*                                                                      30800000
.XLAB2        ANOP  ,                                                   30850000
&M0M0001 DS    0H                             IOSUPFA-1                 30900000
.*******************************************************************    30950000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              31000000
.*******************************************************************    31050000
              PUSH  PRINT                                               31100000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          31150000
              PRINT OFF         ++ PR01                                 31200000
              AGO   .ZPRNTXX                                            31250000
.ZPRINTX      PRINT ON                                                  31300000
.ZPRNTXX      ANOP  ,                                                   31350000
.********************************************************************   31400000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     31450000
.********************************************************************   31500000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       31550000
                      LCLA  &ZOPN1         INVOCATION INDEX             31600000
                      LCLC  &ZOPL(4095)    LABEL                        31650000
                      LCLC  &ZOPO(4095)    OPERATION                    31700000
                      LCLC  &ZOPV(4095)    VALUE                        31750000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  31800000
.*                                                                      31850000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     31900000
.******************************************************************     31950000
.***AL.L10 IOSUPFA FMT=LIST MF=S|L PARAMETERS                           32000000
.******************************************************************     32050000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     32100000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     32150000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     32200000
&XMFATTR              SETC  '0D'                                        32250000
.*                                                                      32300000
&ZOPN                 SETA  &ZOPN+1                                     32350000
&ZOPL(&ZOPN)          SETC  ' '                                         32400000
&ZOPO(&ZOPN)          SETC  'B'                                         32450000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                32500000
&ZOPD(&ZOPN)          SETC  '++ IOSUPFA ARG PARMS'                      32550000
.*                                                                      32600000
&ZOPN                 SETA  &ZOPN+1                                     32650000
&ZOPL(&ZOPN)          SETC  ' '                                         32700000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     32750000
&ZOPV(&ZOPN)          SETC  '1'                                         32800000
&ZOPD(&ZOPN)          SETC  ' '                                         32850000
.*                                                                      32900000
.ZLMFSL2              ANOP  ,                                           32950000
.*-------------------------------------------------------------------   33000000
.***AM.L01  IOSUPFA FMT=LIST PARAMETERS                                 33050000
&ZOPN                 SETA &ZOPN+1                                      33100000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   33150000
&ZOPO(&ZOPN)          SETC 'DS'                                         33200000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   33250000
&ZOPD(&ZOPN)          SETC '++ IOSUPFA PARM LIST'                       33300000
.*-------------------------------------------------------------------   33350000
.***AM.L02 XVERSION XL1                                                 33400000
&ZOPN                 SETA &ZOPN+1                                      33450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         33500000
&ZOPO(&ZOPN)          SETC 'DS'                                         33550000
&ZOPV(&ZOPN)          SETC 'XL1'                                        33600000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          33650000
.*-------------------------------------------------------------------   33700000
.***AM.L03 XFLAGS BL.8                                                  33750000
&ZOPN                 SETA &ZOPN+1                                      33800000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           33850000
&ZOPO(&ZOPN)          SETC 'DS'                                         33900000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       33950000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             34000000
.*                                                                      34050000
&ZOPN                 SETA  &ZOPN+1                                     34100000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBPTR'                  34150000
&ZOPO(&ZOPN)          SETC  'EQU'                                       34200000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             34250000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               34300000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBPTR'                       34350000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      34400000
.*                                                                      34450000
&ZOPN                 SETA  &ZOPN+1                                     34500000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBPADDR'                34550000
&ZOPO(&ZOPN)          SETC  'EQU'                                       34600000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             34650000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               34700000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBPADDR'                     34750000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      34800000
.*-------------------------------------------------------------------   34850000
.***AM.L09  XRSV001 CL2                                                 34900000
&ZOPN                 SETA &ZOPN+1                                      34950000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001'                          35000000
&ZOPO(&ZOPN)          SETC 'DS'                                         35050000
&ZOPV(&ZOPN)          SETC 'CL2'                                        35100000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV001'                       35150000
.*-------------------------------------------------------------------   35200000
.***AM.L09  XUCBPTR A                                                   35250000
&ZOPN                 SETA &ZOPN+1                                      35300000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPTR'                          35350000
&ZOPO(&ZOPN)          SETC 'DS'                                         35400000
&ZOPV(&ZOPN)          SETC 'A'                                          35450000
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPTR  XUCBPTR'                      35500000
.*-------------------------------------------------------------------   35550000
.***AM.L09  XUCBPADDR A                                                 35600000
&ZOPN                 SETA &ZOPN+1                                      35650000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPADDR'                        35700000
&ZOPO(&ZOPN)          SETC 'DS'                                         35750000
&ZOPV(&ZOPN)          SETC 'A'                                          35800000
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPADDR  XUCBPADDR'                  35850000
.*-------------------------------------------------------------------   35900000
.***AM.L10 END OF IOSUPFA LIST PARAMETERS                               35950000
&ZOPN                 SETA &ZOPN+1                                      36000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 36050000
&ZOPO(&ZOPN)          SETC 'EQU'                                        36100000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 36150000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         36200000
.*                                                                      36250000
&ZOPN                 SETA &ZOPN+1                                      36300000
&ZOPL(&ZOPN)          SETC ' '                                          36350000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      36400000
&ZOPV(&ZOPN)          SETC '1'                                          36450000
&ZOPD(&ZOPN)          SETC ' '                                          36500000
.*-------------------------------------------------------------------   36550000
.***AL.L12 IOSUPFA FMT=LIST MF=S|L PARAMETERS                           36600000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         36650000
.*                                                                      36700000
&ZOPN                 SETA  &ZOPN+1                                     36750000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                36800000
&ZOPO(&ZOPN)          SETC  'DC'                                        36850000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   36900000
&ZOPD(&ZOPN)          SETC  '++ IOSUPFA ARG PARMS'                      36950000
.*                                                                      37000000
.ZLMFSLX              ANOP  ,                                           37050000
.*-------------------------------------------------------------------   37100000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          37150000
&ZPLLEN               SETA 12                                           37200000
.*                                                                      37250000
.******************************************************************     37300000
.***AI.L01 IOSUPFA FMT=LIST FILL IN PARAMETER AREA                      37350000
.******************************************************************     37400000
                      ACTR  10000                                       37450000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               37500000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    37550000
&ZCVAL                SETC  'LAE'          XAX MODE                     37600000
.ZIMFXA               ANOP ,                                            37650000
.*                                                                      37700000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    37750000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         37800000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 37850000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                37900000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 37950000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                38000000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   38050000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    38100000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   38150000
&ZOPN                 SETA  &ZOPN+1                                     38200000
&ZOPL(&ZOPN)          SETC  ' '                                         38250000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    38300000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              38350000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       38400000
                      AGO   .ZIMFNX                                     38450000
.*                                                                      38500000
.ZIMFN2               ANOP ,                                            38550000
&ZOPN                 SETA  &ZOPN+1                                     38600000
&ZOPL(&ZOPN)          SETC  ' '                                         38650000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    38700000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                38750000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       38800000
.ZIMFNX               ANOP ,                                            38850000
.********************************************************************   38900000
.***AI.L02 IOSUPFA FMT=LIST INITIALIZE PARAMETER AREA                   38950000
.********************************************************************   39000000
.***AI.L03 MF=(SLE)                                                     39050000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      39100000
.*                                                                      39150000
&ZOPN                 SETA  &ZOPN+1                                     39200000
&ZOPL(&ZOPN)          SETC  ' '                                         39250000
&ZOPO(&ZOPN)          SETC  'XC'                                        39300000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         39350000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             39400000
.ZIMFLX               ANOP  ,                                           39450000
.*-------------------------------------------------------------------   39500000
.***AI.L04A XVERSION XL1                                                39506200
&ZOPN                 SETA  &ZOPN+1                                     39512400
&ZOPL(&ZOPN)          SETC  ' '                                         39518600
&ZOPO(&ZOPN)          SETC  'MVI'                                       39524800
&ZOPV(&ZOPN)          SETC  '0(1),1'                                    39531000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     39537200
.*-------------------------------------------------------------------   39543400
.***AI.L05 XFLAGS BL1                                                   39550000
&ZW                   SETC  ''                                          39600000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            39650000
.*-------------------------------------------------------------------   39700000
.***AI.L08 XFLAGS "UCBPTR"                                              39750000
.***      BL1'1XXXXXXX'                                                 39800000
         AIF   ('&UCBPTR' EQ '').ZI3A                                   39850000
&ZW                   SETC  '&ZW.1'                                     39900000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              39950000
                      AGO   .ZI3C                                       40000000
.*                                                                      40050000
.ZI3A                 ANOP  ,                                           40100000
&ZW                   SETC  '&ZW.0'                                     40150000
.ZI3C                 ANOP  ,                                           40200000
.*-------------------------------------------------------------------   40250000
.***AI.L08 XFLAGS "UCBPADDR"                                            40300000
.***      BL1'X1XXXXXX'                                                 40350000
         AIF   ('&UCBPADDR' EQ '').ZI4A                                 40400000
&ZW                   SETC  '&ZW.1000000'                               40450000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              40500000
                      AGO   .ZI4C                                       40550000
.*                                                                      40600000
.ZI4A                 ANOP  ,                                           40650000
&ZW                   SETC  '&ZW.0000000'                               40700000
.ZI4C                 ANOP  ,                                           40750000
.*-------------------------------------------------------------------   40800000
.***AI.L11 XFLAGS BL1                                                   40850000
                      AIF   ('&ZCLNG' NE 'YES').ZI4E  ALL ZERO BITS     40900000
&ZOPN                 SETA  &ZOPN+1                                     40950000
&ZOPL(&ZOPN)          SETC  ' '                                         41000000
&ZOPO(&ZOPN)          SETC  'OI'                                        41050000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             41100000
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             41150000
.ZI4E                 ANOP  ,                                           41200000
.*-------------------------------------------------------------------   41250000
.***AI.L25  XUCBPTR AL4                                                 41300000
                      AIF   ('&ZXUCBPTR' EQ '').ZI6E  NOT USED          41350000
                      AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZI6E              41400000
&ZCGPR                SETC  '&XUCBPTR'                                  41450000
.*                                                                      41500000
                      AIF   ('&XUCBPTR'(1,1) NE '(').ZI6B               41550000
&ZCGPR   SETC  '0('.'&XUCBPTR'(2,K'&XUCBPTR-2).')'                      41600000
                      AGO   .ZI6D                                       41650000
.ZI6B                 ANOP  ,                                           41700000
.*                                                                      41750000
&ZC                   SETC  '&XUCBPTR'(1,1)                             41800000
                      AIF   (T'&ZC NE 'N').ZI6D                         41850000
&ZC                   SETC  '&XUCBPTR'                                  41900000
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI6D            41950000
&ZCGPR                SETC  '=AL4(&XUCBPTR)'                            42000000
.*                                                                      42050000
.ZI6D                 ANOP  ,                                           42100000
.*                                                                      42150000
&ZOPN                 SETA  &ZOPN+1                                     42200000
&ZOPL(&ZOPN)          SETC  ' '                                         42250000
&ZOPO(&ZOPN)          SETC  'MVC'                                       42300000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             42350000
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPTR XUCBPTR AL4'                  42400000
.*                                                                      42450000
.ZI6E                 ANOP  ,                                           42500000
.*-------------------------------------------------------------------   42550000
&ZOPN1                SETA &ZOPN                                        42600000
.*******************************************************************    42650000
.***  PROCESS IOSUPFA OUTPUT PARAMETERS                                 42700000
.*******************************************************************    42750000
                      ACTR  10000                                       42800000
.*------------------------------------------------------------------    42850000
.***AO.L02 XUCBPADDR A                                                  42900000
         AIF   ('&ZXUCBPADDR' EQ 'OUTPUT').ZO7A  OUTPUT                 42950000
         AIF   ('&ZXUCBPADDR' NE 'INOUT').ZO7C  INOUT                   43000000
.ZO7A    AIF   ('&XUCBPADDR'(1,1) NE '(').ZO7B  ADDR IN GPR             43050000
&ZCGPR   SETC  '&XUCBPADDR'(2,K'&XUCBPADDR-2)                           43100000
&ZOPN                 SETA  &ZOPN+1                                     43150000
&ZOPL(&ZOPN)          SETC  ' '                                         43200000
&ZOPO(&ZOPN)          SETC  'MVC'                                       43250000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),8(1)'                          43300000
&ZOPD(&ZOPN)          SETC  '++ XUCBPADDR A'                            43350000
                      AGO   .ZO7C                                       43400000
.*                                                                      43450000
.ZO7B                 ANOP  ,                                           43500000
&ZAWRK   SETA  K'&XUCBPADDR                                             43550000
         AIF   ('&XUCBPADDR'(&ZAWRK,1) NE ')').ZO7G                     43600000
&ZN      SETA  2                                                        43650000
.ZO7H    ANOP                                                           43700000
         AIF   (&ZN GE &ZAWRK).ZO7G                                     43750000
         AIF   ('&XUCBPADDR'(&ZN,1) NE '(').ZO7I                        43800000
&ZC      SETC  '&XUCBPADDR'(1,&ZN).'4'.','                              43850000
&ZC      SETC  '&ZC'.'&XUCBPADDR'(&ZN+1,&ZAWRK-&ZN).',8(1)'             43900000
         AGO   .ZO7J                                                    43950000
.ZO7I    ANOP                                                           44000000
&ZN      SETA  &ZN+1                                                    44050000
         AGO   .ZO7H                                                    44100000
.ZO7G    ANOP                                                           44150000
&ZC      SETC  '&XUCBPADDR.(4),8(1)'                                    44200000
.ZO7J    ANOP                                                           44250000
&ZOPN                 SETA  &ZOPN+1                                     44300000
&ZOPL(&ZOPN)          SETC  ' '                                         44350000
&ZOPO(&ZOPN)          SETC  'MVC'                                       44400000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       44450000
&ZOPD(&ZOPN)          SETC  '++ XUCBPADDR A'                            44500000
.ZO7C                 ANOP  ,                                           44550000
.*******************************************************************    44600000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   44650000
.*******************************************************************    44700000
.ZMFLX                ANOP  ,              MF=L PROCESSING              44750000
.*******************************************************************    44800000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               44850000
.*******************************************************************    44900000
                      ACTR  10000                                       44950000
.*                                                                      45000000
                      LCLA  &ZLC           COLUMN POSITION              45050000
                      LCLA  &ZOPX          LIST TABLE INDEX             45100000
                      LCLC  &ZLL           LABEL                        45150000
                      LCLC  &ZLOP          OPERATION                    45200000
                      LCLC  &ZLV           VALUE                        45250000
                      LCLC  &ZLD           DESCRIPTION                  45300000
.*                                                                      45350000
&ZOPX                 SETA  1                                           45400000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            45450000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              45500000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              45550000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              45600000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              45650000
                      AIF   (K'&ZLD LE 0).ZL5                           45700000
&ZLC                  SETA  35             COMMENT COLUMN               45750000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    45800000
&ZLC                  SETA  33             COMMMENT COLUMN              45850000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   45900000
&ZLV                  SETC  '&ZLV'.' '                                  45950000
                      AGO   .ZL3                                        46000000
.*                                                                      46050000
.ZL4                  ANOP  ,                                           46100000
&ZLV                  SETC  '&ZLV'.' '                                  46150000
.ZL5                  ANOP  ,                                           46200000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               46250000
.*                                                                      46300000
&ZLL     &ZLOP &ZLV                                                     46350000
.*                                                                      46400000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               46450000
                      AGO   .ZL2           CONTINUE LOOPING             46500000
.*                                                                      46550000
.ZLX                  ANOP  ,                                           46600000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                46650000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  46700000
.*-----------BAL invocation code-------------                           46750000
.*********************************************************************  46800000
.*                                                                   *  46850000
.*  Get addressability to CVT                                        *  46900000
.*                                                                   *  46950000
.*********************************************************************  47000000
         L     15,16(0,0)                                               47050000
.*********************************************************************  47100000
.*                                                                   *  47150000
.*  Get addressability to IOCOM                                      *  47200000
.*                                                                   *  47250000
.*********************************************************************  47300000
         L     15,124(15,0)                                             47350000
.*********************************************************************  47400000
.*                                                                   *  47450000
.*  Get addressability to IOVT                                       *  47500000
.*                                                                   *  47550000
.*********************************************************************  47600000
         L     15,208(15,0)                                             47650000
.*********************************************************************  47700000
.*                                                                   *  47750000
.*  Get address to IOSVUPLC                                          *  47800000
.*                                                                   *  47850000
.*********************************************************************  47900000
         L     15,112(15,0)                                             47950000
         BASSM 14,15              ++ BRANCH TO UCB SERVICES             48000000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  48050000
.ZLINKX               ANOP  ,                                           48100000
.*******************************************************************    48150000
.***AP.X01  FORMAT GENERATED CODE                                       48200000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            48250000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              48300000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              48350000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              48400000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              48450000
                      AIF   (K'&ZLD LE 0).ZL51                          48500000
&ZLC                  SETA  35             COMMENT COLUMN               48550000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   48600000
&ZLC                  SETA  33             COMMENT COLUMN               48650000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  48700000
&ZLV                  SETC  '&ZLV'.' '                                  48750000
                      AGO   .ZL31                                       48800000
.*                                                                      48850000
.ZL41                 ANOP  ,                                           48900000
&ZLV                  SETC  '&ZLV'.' '                                  48950000
.ZL51                 ANOP  ,                                           49000000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               49050000
.*                                                                      49100000
&ZLL     &ZLOP &ZLV                                                     49150000
.*                                                                      49200000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               49250000
                      AGO   .ZL21          CONTINUE LOOPING             49300000
.*                                                                      49350000
.ZLX1                 ANOP  ,                                           49400000
.*******************************************************************    49450000
.***AP.X02  END OF IOSUPFA MACRO                                        49500000
&ZIOSUPFA             SETC  'YES'          SET IOSUPFA USED             49550000
         POP   PRINT                                                    49600000
*                                            IOSUPFA-1                  49650000
         SPACE 1                                                        49700000
.ZLX2                 ANOP  ,                                           49750000
         MEND                                                           49800000
**********************************************************************/ 49850000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  49900000
*%IOSUPFA: MACRO KEYS(UCBPTR,UCBPADDR,MF);                              49950000
*  ANS('?'||MACLABEL||' '||'IOSUPFAP '||MACLIST||                       50000000
*         ' '||MACKEYS||';') COL(MACLMAR);                              50050000
*%END IOSUPFA;                                                          50100000
