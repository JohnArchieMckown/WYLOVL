*/********************************************************************* 00050000
******************** START SPECIFICATIONS ***************************** 00100000
*********************************************************************** 00150000
*                                                                     * 00200000
*01* MACRO NAME - CPF                                                 * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME - COMMAND PREFIX FACILITY SUPPORT MACRO         * 00350000
*                                                                     * 00400000
*01* COPYRIGHT  - 5695-047                                            * 00450000
*               THIS MODULE IS "RESTRICTED MATERIALS OF IBM"          * 00500000
*               (C) COPYRIGHT IBM CORPORATION 1990.                   * 00550000
*               LICENSED MATERIALS - PROPERTY OF IBM                  * 00600000
*                                                                     * 00650000
*01* STATUS     - HBB4410                                             * 00700000
*                                                                     * 00750000
*  FUNCTION   - VALIDATES A CPF DEFINE, DELETE, OR REDEFINE REQUEST   * 00800000
*               AND THEN INVOKES THE CPF SERVICE ROUTINE IEAVG710     * 00850000
*               TO PROCESS THE REQUEST.                               * 00900000
*                                                                     * 00950000
*                                                                     * 01000000
*01* MODULE TYPE = ASSEM MACRO                                        * 01050000
*                                                                     * 01100000
*02*   PROCESSOR = ASSEM                                              * 01150000
*                                                                     * 01200000
*01* COMPONENT = SC1CK                                                * 01250000
*                                                                     * 01300000
*01* DISTRIBUTION LIBRARY = AMACLIB                                   * 01350000
*                                                                     * 01400000
*01* CHANGE ACTIVITY =                                                * 01450000
*      $L0=OPSSI,    HBB4410, 870901 PDDH: Command Prefix Facility    * 01464200
*      $P1=PEO1052,  HBB4410, 880711 PDDH: Command Prefix Facility    * 01478400
*      $P2=PEO1100,  HBB4410, 880823 PDDH: Command Prefix Facility    * 01492600
*      $P3=PEO1215,  HBB4410, 881024, PDEC: New return code           * 01506800
*      $P4=PEO1216,  HBB4410, 881024, PDEC: New return code           * 01521000
*      $01=OW47091,  HBB6606, 010115, PDAT: Replace &LNAM.LN with 52  * 01531000
*                                                                     * 01550000
*01* INVOCATION =                                                     * 01600000
*                                                                     * 01650000
*      Execution Mode: Task mode                                      * 01700000
*                                                                     * 01750000
*      Authorization:                                                 * 01800000
*      Supervisor state, or APF authorized, or PKM allowing keys 0-7  * 01850000
*                                                                     * 01900000
*      Addressing mode: 24 or 31 bit addressing mode                  * 01950000
*                                                                     * 02000000
*      ASC mode: Primary                                              * 02050000
*                                                                     * 02100000
*      Serialization:                                                 * 02150000
*      Enabled for I/O and external interrupts                        * 02200000
*      No locks held                                                  * 02250000
*                                                                     * 02300000
*                                                                     * 02350000
*      Input registers:                                               * 02400000
*                                                                     * 02450000
*                   GR0-GR1    reserved                               * 02500000
*                   GR2-GR13   undefined                              * 02550000
*                   GR14-GR15  reserved                               * 02600000
*                                                                     * 02650000
*                                                                     * 02700000
*      Output registers:                                              * 02750000
*                                                                     * 02800000
*                                                                     * 02850000
*                   GR0        reason code                            * 02900000
*                   GR1        undefined                              * 02950000
*                   GR2-GR13   unchanged                              * 03000000
*                   GR14       undefined                              * 03050000
*                   GR15       return code                            * 03100000
*                                                                     * 03150000
*   Macro Syntax:                                                     * 03200000
*                                                                     * 03250000
*   (One r more blanks must precede CPF)                              * 03300000
*                                                                     * 03350000
*   CPF REQUEST=DEFINE                                                * 03400000
*      ,PREFIX= prefix-address       RX-type addr or regs (2) - (12)  * 03450000
*      ,OWNER=prefix-owner-address   RX-type addr or regs (2) - (12)  * 03500000
*     <,SCOPE= SYSPLEX | SYSTEM>                                      * 03550000
*     <,FAILDISP= PURGE | RETAIN | SYSPURGE>                          * 03600000
*     <,REMOVE= NO | YES>                                             * 03650000
*     <,RESOURCE= NOTHELD | HELD>                                     * 03700000
*      ,MF=(L|E, listname)                                            * 03750000
*                                                                     * 03800000
*                                                                     * 03850000
*   CPF REQUEST=REDEFINE                                              * 03900000
*      ,PREFIX= prefix-address       RX-type addr or regs (2) - (12)  * 03950000
*     <,OWNER= prefix-owner-address> RX-type addr or regs (2) - (12)  * 04000000
*     <,CURSYS= system-name-address> RX-type addr or regs (2) - (12)  * 04050000
*     <,NEWSYS= system-name-address> RX-type addr or regs (2) - (12)  * 04100000
*     <,RESOURCE= NOTHELD | HELD>                                     * 04150000
*      ,MF=(L|E, listname)                                            * 04200000
*                                                                     * 04250000
*                                                                     * 04300000
*   CPF REQUEST=DELETE                                                * 04350000
*     <,PREFIX= prefix-address>      RX-type addr or regs (2) - (12)  * 04400000
*     <,CURSYS= system-name-address> RX-type addr or regs (2) - (12)  * 04450000
*     <,RESOURCE=NOTHELD | HELD>                                      * 04500000
*      ,MF=(L|E, listname)                                            * 04550000
*                                                                     * 04600000
*---------------------------------------------------------------------* 04650000
*-----------    Specification of a DEFINE request    -----------------* 04700000
*---------------------------------------------------------------------* 04750000
*                                                                     * 04800000
*   REQUEST = DEFINE                                                  * 04850000
*       The value of this required keyword specifies the desired      * 04900000
*       CPF function to be performed.  One and only one function      * 04950000
*       may be specified on a single invocation of the CPF mancro.    * 05000000
*       A unique group of subordinate keywords may be specified       * 05050000
*       with each of the three CPF functions.  The three CPF          * 05100000
*       functions and their respective subordinate keywords follow.   * 05150000
*                                                                     * 05200000
*   DEFINE -                                                          * 05250000
*       This CPF function is used to establish the definition of      * 05300000
*       a new command prefix. The following subordinate keywords      * 05350000
*       may be specified with the DEFINE function.                    * 05400000
*                                                                     * 05450000
*                                                                     * 05500000
*       PREFIX -                                                      * 05550000
*          This keyword specifies the address (RX-type)               * 05600000
*          (or address in register (2) - (12) ASM only)               * 05650000
*          of a 8-byte field containing the command prefix.           * 05700000
*          If the prefix is less than 8 characters it must            * 05750000
*          be left justified and padded with blanks.                  * 05800000
*          The prefix may be comprised of any character in            * 05850000
*          the range X'41' - X'FE', inclusive. This is a              * 05900000
*          required keyword.                                          * 05950000
*                                                                     * 06000000
*       OWNER -                                                       * 06050000
*          This keyword specifies the address (RX-type)               * 06100000
*          (or address in register (2) - (12) ASM only)               * 06150000
*          of an 8-byte field containing a name that                  * 06200000
*          identifies the subsystem owning the command prefix         * 06250000
*          command prefix (e.g. JES2, JES3, IMS etc.).                * 06300000
*          If the name is less than 8 characters it must be           * 06350000
*          left justified and padded with blanks. The name            * 06400000
*          may be comprised of any character in the range             * 06450000
*          X'41'-X'FE', inclusive. This is a required keyword.        * 06500000
*                                                                     * 06550000
*                                                                     * 06600000
*       SCOPE -                                                       * 06650000
*         The value of this keyword specifies the scope of the        * 06700000
*         prefix.  Either SYSTEM or SYSPLEX may be specified.         * 06750000
*         This is an optional keyword. The default is SYSPLEX.        * 06800000
*                                                                     * 06850000
*                                                                     * 06900000
*       FAILDISP-                                                     * 06950000
*         The value of this keyword specifies the failure             * 07000000
*         disposition of the prefix. Either PURGE, RETAIN, or         * 07050000
*         SYSPURGE may be specified.  This is an optional keyword.    * 07100000
*         The default is PURGE.                                       * 07150000
*                                                                     * 07200000
*         A command prefix defined witha FAILDISP of PURGE will       * 07250000
*         be automatically deleted by Comm Task when the receiving    * 07300000
*         system is partitioned from the sysplex or the defining      * 07350000
*         address space terminates.                                   * 07400000
*                                                                     * 07450000
*         A command prefix defined with a FAILDISP of RETAIN will     * 07500000
*         persist despite sysplex partitioning or address space       * 07550000
*         termination. In this case it is the responsibility of       * 07600000
*         the owning subsystem to either delete the command prefix,   * 07650000
*         or redefine it for another system.                          * 07700000
*                                                                     * 07750000
*         A command prefixdefined with a FAILDISP of SYSPURGE will    * 07800000
*         be automatically deleted by Comm Task when the receiving    * 07850000
*         system is partitioned from the sysplex, but NOT when the    * 07900000
*         defining address space terminates.                          * 07950000
*                                                                     * 08000000
*         NOTE: Command prefixes defined with a FAILDISP of PURGE     * 08050000
*               cannot be redefined.                                  * 08100000
*                                                                     * 08150000
*                                                                     * 08200000
*       REMOVE -                                                      * 08250000
*         The value of this keyword specifies whether or not          * 08300000
*         the command prefix being defined is to be removed from      * 08350000
*         the command text prior to being presented to command        * 08400000
*         exits and the subsystem interface. Either YES or NO         * 08450000
*         may be specified. This is an optional keyword for the       * 08500000
*         CPF DEFINE function only. The default is NO.                * 08550000
*                                                                     * 08600000
*                                                                     * 08650000
*       MF -                                                          * 08700000
*         The value of this keyword specifies the form                * 08750000
*         of the macro invocation. Either "L", for list form,         * 08800000
*         or "E", for execute form may be specified. "list name"      * 08850000
*         is a required input that specifies the address (RX-type)    * 08900000
*         (or address in a register (2) - (12) ASM only) of a         * 08950000
*         storage area for the CPF parameter list.                    * 09000000
*                                                                     * 09050000
*                                                                     * 09100000
*      RESOURCE -                                                     * 09150000
*          The value of this keyword specifies whether or             * 09200000
*          not the caller of the CPF service holds the resource       * 09250000
*          necessary to make a CPF update. Either HELD or NOTHELD     * 09300000
*          can be specified.  This is an optional keyword.            * 09350000
*          The default is NOTHELD. If held is specified for           * 09400000
*          the RESOURCE keyword and the necessary resource is not     * 09450000
*          held, return code 12 with no reason code will be           * 09500000
*          passed back to the CPF caller.                             * 09550000
*                                                                     * 09600000
* ** THE RESOURCE KEYWORD IS INTENDED FOR CONTROL PROGRAM USE ONLY ** * 09650000
*                                                                     * 09700000
*                                                                     * 09750000
*---------------------------------------------------------------------* 09800000
*------------   Specification of a REDEFINE request  -----------------* 09850000
*---------------------------------------------------------------------* 09900000
*                                                                     * 09950000
*                                                                     * 10000000
*   REDEFINE -                                                        * 10050000
*      This CPF function is used to alter the existing                * 10100000
*      definition of a command prefix. The following                  * 10150000
*      subordinate keywords may be specified with the                 * 10200000
*      REDEFINE function.                                             * 10250000
*                                                                     * 10300000
*                                                                     * 10350000
*      PREFIX -                                                       * 10400000
*          This keyword specifies the address (RX-type)               * 10450000
*          (or address in register (2) - (12) ASM only)               * 10500000
*          of a 8-byte field containing the command prefix.           * 10550000
*          If the prefix is less than 8 characters it must            * 10600000
*          be left justified and padded with blanks.                  * 10650000
*          The prefix may be comprised of any character in            * 10700000
*          the range X'41' - X'FE', inclusive. This is a              * 10750000
*          required keyword.                                          * 10800000
*                                                                     * 10850000
*                                                                     * 10900000
*      OWNER -                                                        * 10950000
*          This keyword specifies the address (RX-type)               * 11000000
*          (or address in register (2) - (12) ASM only)               * 11050000
*          of an 8-byte field containing a name that                  * 11100000
*          identifies the subsystem owning the command prefix         * 11150000
*          command prefix (e.g. JES2, JES3, IMS etc.).                * 11200000
*          If the name is less than 8 characters it must be           * 11250000
*          left justified and padded with blanks. The name            * 11300000
*          may be comprised of any character in the range             * 11350000
*          X'41'-X'FE', inclusive. This is an optional keyword.       * 11400000
*                                                                     * 11450000
*                                                                     * 11500000
*      CURSYS -                                                       * 11550000
*          This keyword specifies the address of an 8-byte            * 11600000
*          field containing the name of the system (from the          * 11650000
*          CVTSNAME field of the CVT) for which the prefix            * 11700000
*          was defined. This is an optional keyword. The              * 11750000
*          default is the system name in the CVTSNAME field           * 11800000
*          of the CVT                                                 * 11850000
*                                                                     * 11900000
*                                                                     * 11950000
*      NEWSYS -                                                       * 12000000
*          This keyword specifies the address of an 8-byte field      * 12050000
*          containing the name of a new system to which commands      * 12100000
*          with this prefix should be routed.  This is an optional    * 12150000
*          keyword.  The default is the system name in the CVTSNAME   * 12200000
*          of the CVT.                                                * 12250000
*                                                                     * 12300000
*                                                                     * 12350000
*                                                                     * 12400000
*      MF -                                                           * 12450000
*         The value of this keyword specifies the form                * 12500000
*         of the macro invocation. Either "L", for list form,        *  12550000
*         or "E", for execute form may be specified. "list name"      * 12600000
*         is a required input that specifies the address (RX-type)    * 12650000
*         (or address in a register (2) - (12) ASM only) of a         * 12700000
*         storage area for the CPF parameter list.                    * 12750000
*                                                                     * 12800000
*                                                                     * 12850000
*      RESOURCE -                                                     * 12900000
*          The value of this keyword specifies whether or             * 12950000
*          not the caller of the CPF service holds the resource       * 13000000
*          necessary to make a CPF update. Either HELD or NOTHELD     * 13050000
*          can be specified.  This is an optional keyword.            * 13100000
*          The default is NOTHELD. If held is specified for           * 13150000
*          the RESOURCE keyword and the necessary resource is not     * 13200000
*          held, return code 12 with no reason code will be           * 13250000
*          passed back to the CPF caller.                             * 13300000
*                                                                     * 13350000
* ** THE RESOURCE KEYWORD IS INTENDED FOR CONTROL PROGRAM USE ONLY ** * 13400000
*                                                                     * 13450000
*                                                                     * 13500000
*---------------------------------------------------------------------* 13550000
*-------------   Specifications for a DELETE request  ----------------* 13600000
*---------------------------------------------------------------------* 13650000
*                                                                     * 13700000
*                                                                     * 13750000
*   DELETE -                                                          * 13800000
*      This CPF function is used to delete the definition of          * 13850000
*      a command prefix. The following subordinate keywords           * 13900000
*      may be specified with the DELETE function.                     * 13950000
*                                                                     * 14000000
*                                                                     * 14050000
*                                                                     * 14100000
*      PREFIX -                                                       * 14150000
*          This keyword specifies the address (RX-type)               * 14200000
*          (or address in register (2) - (12) ASM only)               * 14250000
*          of a 8-byte field containing the command prefix.           * 14300000
*          If the prefix is less than 8 characters it must            * 14350000
*          be left justified and padded with blanks.                  * 14400000
*          The prefix may be comprised of any character in            * 14450000
*          the range X'41' - X'FE', inclusive. This is a              * 14500000
*          required keyword.                                          * 14550000
*                                                                     * 14600000
*                                                                     * 14650000
*                                                                     * 14700000
*      CURSYS -                                                       * 14750000
*          This keyword specifies the address of an 8-byte            * 14800000
*          field containing the name of the system (from the          * 14850000
*          CVTSNAME field of the CVT) for which the prefix            * 14900000
*          was defined. This is an optional keyword. The default      * 14950000
*          is the system name in the CVTSNAME field of the CVT.       * 15000000
*                                                                     * 15050000
*                                                                     * 15100000
*      MF -                                                           * 15150000
*         The value of this keyword specifies the form                * 15200000
*         of the macro invocation. Either "L", for list form,         * 15250000
*         or "E", for execute form may be specified. "list name"      * 15300000
*         is a required input that specifies the address (RX-type)    * 15350000
*         (or address in a register (2) - (12) ASM only) of a         * 15400000
*         storage area for the CPF parameter list.                    * 15450000
*                                                                     * 15500000
*                                                                     * 15550000
*      RESOURCE -                                                     * 15600000
*          The value of this keyword specifies whether or             * 15650000
*          not the caller of the CPF service holds the resource       * 15700000
*          necessary to make a CPF update. Either HELD or NOTHELD     * 15750000
*          can be specified.  This is an optional keyword.            * 15800000
*          The default is NOTHELD. If held is specified for           * 15850000
*          the RESOURCE keyword and the necessary resource is not     * 15900000
*          held, return code 12 with no reason code will be           * 15950000
*          passed back to the CPF caller.                             * 16000000
*                                                                     * 16050000
* ** THE RESOURCE KEYWORD IS INTENDED FOR CONTROL PROGRAM USE ONLY ** * 16100000
*                                                                     * 16150000
*                                                                     * 16200000
*                                                                     * 16250000
*---------------------------------------------------------------------* 16300000
*------------------   RETURN AND REASON CODES  -----------------------* 16350000
*---------------------------------------------------------------------* 16400000
*                                                                     * 16450000
*                                                                     * 16600000
*                                                                     * 16700000
*01*  CONDITIONS =                                                    * 16716600
*       The requested function was completed sucessfully.             * 16733200
*                                                                     * 16750000
*02*  RETURN-CODES =                                                  * 16766600
*       RETURN-CODE = 0    REASON-CODE = 0                            * 16783200
*                                                                     * 16800000
*                                                                     * 17000000
*01*  CONDITIONS =                                                    * 17025000
*       A DEFINE request was made with SCOPE = SYSPLEX, but           * 17050000
*       the system was in XCF-LOCAL mode.                             * 17075000
*                                                                     * 17100000
*02*  RETURN-CODE = 0    REASON-CODE = 4                              * 17125000
*                                                                     * 17150000
*                                                                     * 17200000
*01*  CONDITIONS =                                                    * 17250000
*       PREFIX contained characters not in the range                  * 17300000
*       X'41' - X'FE'.                                                * 17350000
*                                                                     * 17400000
*02*  RETURN-CODE = 4    REASON-CODE = 4                              * 17450000
*                                                                     * 17500000
*                                                                     * 17550000
*01*  CONDITIONS =                                                    * 17560000
*       A DEFINE/REDEFINE request was made with the OWNER             * 17570000
*       parameter containing characters not in the range              * 17580000
*       X'41' - X'FE'.                                                * 17590000
*                                                                     * 17600000
*02*  RETURN-CODE = 4    REASON-CODE = 8                              * 17650000
*                                                                     * 17850000
*                                                                     * 17950000
*01*  CONDITIONS =                                                    * 17960000
*       A REDEFINE request was made for a PREFIX which            @P4C* 17973300
*       was defined with FAILDISP = PURGE.                        @P4C* 17986600
*                                                                     * 18000000
*02*  RETURN-CODE = 4    REASON-CODE = 12                         @P4C* 18050000
*                                                                     * 18200000
*                                                                     * 18300000
*01*  CONDITIONS =                                                    * 18312500
*       A DELETE/REDEFINE request was made but the PREFIX was         * 18550000
*       not found in the CPF table.                                   * 18600000
*                                                                     * 18650000
*02*  RETURN-CODE = 8    REASON-CODE = 4                              * 18700000
*                                                                     * 18750000
*                                                                     * 18800000
*01*  CONDITIONS =                                                    * 18812500
*       A DEFINE request was made for a PREFIX which already          * 18825000
*       exists.                                                       * 18837500
*                                                                     * 18850000
*02*  RETURN-CODE = 8    REASON-CODE = 8                              * 18875000
*                                                                     * 18900000
*                                                                     * 19100000
*01*  CONDITIONS =                                                @P4C* 19125000
*       A DEFINE request was made with a PREFIX which was a       @P4C* 19150000
*       subset of an existing PREFIX .                            @P4C* 19175000
*                                                                     * 19200000
*02*  RETURN-CODE = 8    REASON-CODE = 12                         @P4C* 19225000
*                                                                     * 19250000
*                                                                     * 19300000
*01*  CONDITIONS =                                                    * 19312500
*       A DEFINE request was made with a PREFIX which was a       @P4C* 19325000
*       superset of an existing PREFIX.                           @P4C* 19337500
*                                                                     * 19350000
*02*  RETURN-CODE = 8    REASON-CODE = 16                         @P4C* 19400000
*                                                                     * 19550000
*                                                                     * 19650000
*                                                                     * 19700000
*01*  CONDITIONS =                                                    * 19712500
*       A REDEFINE request was made with a NEWSYS specifying          * 19725000
*       a system not in the sysplex.                                  * 19737500
*                                                                     * 19750000
*02*  RETURN-CODE = 8    REASON-CODE = 20                             * 19775000
*                                                                     * 19800000
*                                                                     * 20000000
*01*  CONDITIONS =                                                @P3A* 20025000
*       A REDEFINE request was made to indicate that the          @P3A* 20050000
*       PREFIX/SYSTEM combo already exist.                        @P3A* 20075000
*                                                                     * 20100000
*02*  RETURN-CODE = 8    REASON-CODE = 24                         @P3A* 20125000
*                                                                     * 20150000
*                                                                     * 20200000
*01*  CONDITIONS =                                                    * 20212500
*       A DELETE or REDEFINE request was made, but no CPF         @P3C* 20225000
*       table exists                                              @P3C* 20237500
*                                                                     * 20250000
*02*  RETURN-CODE = 8    REASON-CODE = 28                         @P3C* 20300000
*                                                                     * 20450000
*                                                                     * 20550000
*01*  CONDITIONS =                                                    * 20562500
*       A broadcast of an updated CPF table failed or                 * 20575000
*       an abend occurred.                                            * 20587500
*                                                                     * 20600000
*       No reason code will be associated with a return code          * 20610000
*       of 12. If an abend occurred during CPF processing,            * 20620000
*       upon returning back to the caller, register 0 will            * 20630000
*       contain the abend code.                                       * 20640000
*                                                                     * 20650000
*02*  RETURN-CODE = 12                                                * 20675000
*                                                                     * 20700000
*                                                                     * 20900000
*                                                                     * 21000000
*---------------------------------------------------------------------* 21750000
*---------------------------------------------------------------------* 21800000
*01* MESSAGES =                                                       * 21850000
*                                                                     * 21900000
*       The CPF macro will issue the following messages upon          * 21950000
*       detection of syntax errors:                                   * 22000000
*                                                                     * 22050000
*02* WARNING = (SEVERITY 4)                                           * 22100000
*                                                                     * 22150000
*       MF= X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.          * 22200000
*                                                                     * 22250000
*       PREFIX KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST     * 22300000
*       FORM OF CPF.                                                  * 22350000
*                                                                     * 22400000
*       OWNER KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST      * 22450000
*       FORM OF CPF.                                                  * 22500000
*                                                                     * 22550000
*       SCOPE KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST      * 22600000
*       FORM OF CPF.                                                  * 22650000
*                                                                     * 22700000
*       FAILDISP KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST   * 22750000
*       FORM OF CPF.                                                  * 22800000
*                                                                     * 22850000
*       REMOVE KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST     * 22900000
*       FORM OF CPF.                                                  * 22950000
*                                                                     * 23000000
*       CURSYS KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST     * 23050000
*       FORM OF CPF.                                                  * 23100000
*                                                                     * 23150000
*       NEWSYS KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST     * 23200000
*       FORM OF CPF.                                                  * 23250000
*                                                                     * 23300000
*       RESOURCE KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LIST   * 23350000
*       FORM OF CPF.                                                  * 23400000
*                                                                     * 23450000
*       REQUEST = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.    * 23500000
*                                                                     * 23550000
*       PREFIX = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.     * 23600000
*                                                                     * 23650000
*       OWNER = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.      * 23700000
*                                                                     * 23750000
*       OWNER KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN            * 23800000
*       REQUEST IS DELETE.                                            * 23850000
*                                                                     * 23900000
*       SCOPE = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.      * 23950000
*                                                                     * 24000000
*       SCOPE KEYWORD IGNORED. SCOPE VALUE NOT SPECIFIED.             * 24050000
*                                                                     * 24100000
*       SCOPE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN            * 24150000
*       REQUEST IS DELETE.                                            * 24200000
*                                                                     * 24250000
*       SCOPE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN            * 24300000
*       REQUEST IS REDEFINE.                                          * 24350000
*                                                                     * 24400000
*       SCOPE KEYWORD IGNORED. VALUE X UNKNOWN.                       * 24450000
*                                                                     * 24500000
*       FAILDISP = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.   * 24550000
*                                                                     * 24600000
*       FAILDISP KEYWORD IGNORED. FAILDISP VALUE NOT SPECIFIED.       * 24650000
*                                                                     * 24700000
*       FAILDISP KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN         * 24750000
*       REQUEST IS DELETE.                                            * 24800000
*                                                                     * 24850000
*       FAILDISP KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN         * 24900000
*       REQUEST IS REDEFINE.                                          * 24950000
*                                                                     * 25000000
*       FAILDISP KEYWORD IGNORED. VALUE X UNKNOWN.                    * 25050000
*                                                                     * 25100000
*       REMOVE = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.     * 25150000
*                                                                     * 25200000
*       REMOVE KEYWORD IGNORED. REMOVE VALUE NOT SPECIFIED.           * 25250000
*                                                                     * 25300000
*       REMOVE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN           * 25350000
*       REQUEST IS DELETE.                                            * 25400000
*                                                                     * 25450000
*       REMOVE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN           * 25500000
*       REQUEST IS REDEFINE.                                          * 25550000
*                                                                     * 25600000
*       CURSYS = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.     * 25650000
*                                                                     * 25700000
*       CURSYS KEYWORD IGNORED. CURSYS VALUE NOT SPECIFIED.           * 25750000
*                                                                     * 25800000
*       CURSYS KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN           * 25850000
*       REQUEST IS DEFINE.                                            * 25900000
*                                                                     * 25950000
*       NEWSYS = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.     * 26000000
*                                                                     * 26050000
*       NEWSYS KEYWORD IGNORED. NEWSYS VALUE NOT SPECIFIED.           * 26100000
*                                                                     * 26150000
*       NEWSYS KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN           * 26200000
*       REQUEST IS DEFINE.                                            * 26250000
*                                                                     * 26300000
*       NEWSYS KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN           * 26350000
*       REQUEST IS DELETE.                                            * 26400000
*                                                                     * 26450000
*       RESOURCE = X,Y HAS TOO MANY VALUES. VALUES IGNORED AFTER X.   * 26500000
*                                                                     * 26550000
*       RESOURCE KEYWORD IGNORED. RESOURCE VALUE NOT SPECIFIED.       * 26600000
*                                                                     * 26650000
*       RESOURCE KEYWORD IGNORED. VALUE X UNKNOWN.                    * 26700000
*                                                                     * 26750000
*                                                                     * 26800000
*02* ERROR = (SEVERITY 12)                                            * 26850000
*                                                                     * 26900000
*       NO TEXT GENERATED. MF VALUE NOT SPECIFIED.                    * 26950000
*                                                                     * 27000000
*       NO TEXT GENERATED. MF VALUE NOT VALID.                        * 27050000
*                                                                     * 27100000
*       NO TEXT GENERATED. MF LIST NAME NOT SPECIFIED.                * 27150000
*                                                                     * 27200000
*       NO TEXT GENERATED. REQUEST VALUE NOT SPECIFIED.               * 27250000
*                                                                     * 27300000
*       NO TEXT GENERATED. REQUEST VALUE NOT VALID.                   * 27350000
*                                                                     * 27400000
*       NO TEXT GENERATED. PREFIX VALUE NOT SPECIFIED.                * 27450000
*                                                                     * 27500000
*       NO TEXT GENERATED. OWNER VALUE NOT SPECIFIED.                 * 27550000
*                                                                     * 27600000
*********************************************************************** 27650000
********************** END OF SPECIFICATION *************************** 27700000
*********************************************************************** 27750000
* Change Activity:                                                    * 27752000
* ----------------                                                    * 27754000
*                                                                     * 27756000
* (a) new return code of 8 and reason code of 24 for prefix/      @P3A* 27758000
*     system combo already exist.                                 @P3A* 27760000
*                                                                     * 27762000
* (c) the following return codes and reason codes have been       @P4A* 27765200
*     changed:                                                    @P4A* 27768400
*     return code of 8 and reason code of 12 is returned for      @P4A* 27771600
*     a define request that a prefix is a subset of an            @P4A* 27774800
*     already defined prefix.                                     @P4A* 27778000
*     return code of 8 and reason code of 16 is returned for      @P4A* 27781200
*     a define request that a prefix is a superset of an          @P4A* 27784400
*     already defined prefix.                                     @P4A* 27787600
*     return code of 8 and reason code of 28 is returned for      @P4A* 27790800
*     a delete or redefine request that no CPF table exists.      @P4A* 27794000
* (c) Deleted the &LNAM.LN variable and replaced its only         @01A* 27795000
*     appearance in this macro with a static value of 52.         @01A* 27796000
*********************************************************************** 27798000
         MACRO -- CPF -- COMMAND PREFIX FACILITY                        27800000
&LABEL   CPF   &REQUEST=^,&PREFIX=^,&OWNER=^,&SCOPE=^,&FAILDISP=^,     C27850000
               &REMOVE=^,&CURSYS=^,&NEWSYS=^,&RESOURCE=^,&MF=^          27900000
.********************************************************************** 27950000
         LCLC  &LNAM                                                    28000000
         LCLC  &REGVAL             Register value                  @P1A 28006200
         LCLA  &REGOFF             Offset to register value        @P1A 28012400
         LCLA  &REGLEN             Length of register value        @P1A 28018600
         LCLA  &MPRFX              Multiple PREFIX value indicator @P1A 28024800
         LCLA  &MOWNR              Multiple OWNER value indicator  @P1A 28031000
         LCLA  &MCSYS              Multiple CURSYS value indicator @P1A 28037200
         LCLA  &MNSYS              Multiple NEWSYS value indicator @P1A 28043400
.********************************************************************** 28050000
.*                                                                    * 28100000
.*  IF A LABEL WAS NOT SPECIFIED ON THE MACRO INVOCATION THEN         * 28150000
.*  generate a DS for the label.                                      * 28200000
.*                                                                    * 28250000
.********************************************************************** 28300000
         AIF   ('&LABEL' EQ '').SKIPLBL                                 28350000
&LABEL   DS    0H                                                       28400000
.SKIPLBL ANOP                                                           28450000
.********************************************************************** 28500000
.*                                                                    * 28550000
.*   Verify macro parameters, generate code                           * 28600000
.*                                                                    * 28650000
.********************************************************************** 28700000
.*                                                                      28750000
&SEVLEV  SETA  0                                                        28800000
         AIF   (N'&MF LT 3).SKIP10                                      28850000
         MNOTE 4,'MF= &MF HAS TOO MANY VALUES. VALUES IGNORED AFTER &MFC28900000
               (2).'                                                    28950000
.SKIP10  AIF   ('&MF(1)' NE '' AND '&MF(1)' NE '^').SKIP20              29000000
         MNOTE 12,'NO TEXT GENERATED. MF VALUE NOT SPECIFIED.'          29050000
&SEVLEV  SETA  12                                                       29100000
         AGO   .EXIT                                                    29150000
.SKIP20  AIF   ('&MF(1)' EQ 'L' OR '&MF(1)' EQ 'E').SKIP30              29200000
         MNOTE 12,'NO TEXT GENERATED. MF VALUE NOT VALID.'              29250000
&SEVLEV  SETA  12                                                       29300000
         AGO   .EXIT                                                    29350000
.SKIP30  AIF   ('&MF(2)' NE '').SKIP40                                  29400000
         MNOTE 12,'NO TEXT GENERATED. MF LIST NAME NOT SPECIFIED.'      29450000
&SEVLEV  SETA  12                                                       29500000
         AGO   .EXIT                                                    29550000
.SKIP40  ANOP                                                           29600000
&LNAM    SETC  '&MF(2)'                                                 29650000
         AIF   ('&MF(1)' EQ 'E').EXECUTE                                29700000
         AIF   ('&PREFIX' EQ '^').SKIP50                                29750000
         MNOTE 4,'PREFIX KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE C29800000
               LIST FORM OF CPF.'                                       29850000
.SKIP50  AIF   ('&OWNER' EQ '^').SKIP60                                 29900000
         MNOTE 4,'OWNER KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LC29950000
               IST FORM OF CPF.'                                        30000000
.SKIP60  AIF   ('&SCOPE' EQ '^').SKIP70                                 30050000
         MNOTE 4,'SCOPE KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE LC30100000
               IST FORM OF CPF.'                                        30150000
.SKIP70  AIF   ('&FAILDISP' EQ '^').SKIP80                              30200000
         MNOTE 4,'FAILDISP KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THC30250000
               E LIST FORM OF CPF.'                                     30300000
.SKIP80  AIF   ('&REMOVE' EQ '^').SKIP90                                30350000
         MNOTE 4,'REMOVE KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE C30400000
               LIST FORM OF CPF.'                                       30450000
.SKIP90  AIF   ('&CURSYS' EQ '^').SKIP100                               30500000
         MNOTE 4,'CURSYS KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE C30550000
               LIST FORM OF CPF.'                                       30600000
.SKIP100 AIF   ('&NEWSYS' EQ '^').SKIP110                               30650000
         MNOTE 4,'NEWSYS KEYWORD IGNORED. NO KEYWORDS PERMITTED ON THE C30700000
               LIST FORM OF CPF.'                                       30750000
.SKIP110 AIF   ('&RESOURCE' EQ '^').SKIP120                             30800000
         MNOTE 4,'RESOURCE KEYWORD IGNORED. NO KEYSWORDS PERMITTED ON TC30850000
               HE LIST FORM OF CPF.'                                    30900000
.SKIP120 ANOP                                                           30950000
.********************************************************************** 31000000
.*                                                                    * 31050000
.*  BUILD CPF PARAMETER LIST                                          * 31100000
.*                                                                    * 31150000
.********************************************************************** 31200000
&LNAM    DS    0F                                                       31250000
&LNAM.01 DS    CL4                                                      31300000
&LNAM.02 DS    XL1                                                      31350000
&LNAM.03 DS    XL1                                                      31400000
&LNAM.04 DS    XL1                                                      31450000
         DS    XL1                                                      31500000
&LNAM.05 DS    CL8                                                      31550000
&LNAM.06 DS    CL8                                                      31600000
&LNAM.07 DS    CL8                                                      31650000
&LNAM.08 DS    CL8                                                      31700000
&LNAM.09 DS    CL4                                                 @P1C 31733300
&LNAM.10 DS    CL8                                                 @P1A 31766600
.*                                                                1@01D 31809990
&LNAM.AC DC    CL4'CPFP'                                           @P2A 31825000
         AGO   .EXIT                                                    31850000
.********************************************************************** 31900000
.*                                                                    * 31950000
.*    EXECUTE SECTION                                                 * 32000000
.*                                                                    * 32050000
.********************************************************************** 32100000
.*                                                                      32150000
.*                                                                      32200000
.********************************************************************** 32250000
.*                                                                    * 32300000
.*    REQUEST Keyword Processing                                      * 32350000
.*                                                                    * 32400000
.********************************************************************** 32450000
.EXECUTE AIF   ('&REQUEST(1)' NE '' AND '&REQUEST(1)' NE '^').SKIP130   32500000
         MNOTE 12,'NO TEXT GENERATED. REQUEST VALUE NOT SPECIFIED.'     32550000
&SEVLEV  SETA  12                                                       32600000
         AGO   .EXIT                                                    32650000
.SKIP130 AIF   (N'&REQUEST EQ 1).SKIP140                                32700000
         MNOTE 4,'REQUEST = &REQUEST HAS TOO MANY VALUES. VALUES IGNOREC32750000
               D AFTER &REQUEST(1).'                                    32800000
.SKIP140 AIF   ('&REQUEST(1)' EQ 'DEFINE' OR '&REQUEST(1)' EQ 'DELETE' C32850000
                                OR '&REQUEST(1)' EQ 'REDEFINE').SKIP150 32900000
         MNOTE 12,'NO TEXT GENERATED. REQUEST VALUE NOT VALID.'         32950000
&SEVLEV  SETA  12                                                       33000000
         AGO   .EXIT                                                    33050000
.********************************************************************** 33100000
.*                                                                    * 33150000
.*       PREFIX Keyword Processing                                    * 33200000
.*                                                                    * 33250000
.********************************************************************** 33300000
.SKIP150 AIF   ('&PREFIX(1)' NE '' AND '&PREFIX(1)' NE '^').SKIP160     33350000
         MNOTE 12,'NO TEXT GENERATED. PREFIX VALUE NOT SPECIFIED.'      33400000
&SEVLEV  SETA  12                                                       33450000
         AGO   .EXIT                                                    33500000
.SKIP160 ANOP                                                      @P1A 33520000
&MPRFX   SETA  0                                                   @P1A 33540000
         AIF   (N'&PREFIX EQ 1).SKIP170                            @P1C 33560000
&MPRFX   SETA  1                                                   @P1A 33580000
         MNOTE 4,'PREFIX= &PREFIX HAS TOO MANY VALUES. VALUES IGNORED AC33600000
               FTER &PREFIX(1).'                                        33650000
.********************************************************************** 33700000
.*                                                                    * 33750000
.*       OWNER Keyword Processing                                     * 33800000
.*                                                                    * 33850000
.********************************************************************** 33900000
.SKIP170 AIF   ('&REQUEST(1)' NE 'DEFINE').SKIP180                      33950000
         AIF   ('&OWNER(1)' NE '' AND '&OWNER(1)' NE '^').SKIP200       34000000
         MNOTE 12,'NO TEXT GENERATED. OWNER VALUE NOT SPECIFIED.'       34050000
&SEVLEV  SETA  12                                                       34100000
         AGO   .EXIT                                                    34150000
.SKIP180 AIF   ('&REQUEST(1)' NE 'REDEFINE').SKIP190                    34200000
         AIF   ('&OWNER(1)' NE '').SKIP200                              34250000
         MNOTE 4, 'OWNER KEYWORD IGNORED. OWNER VALUE NOT SPECIFIED.'   34300000
         AGO   .SKIP210                                                 34350000
.SKIP190 AIF   ('&OWNER(1)' EQ '^').SKIP210                             34400000
         MNOTE 4,'OWNER KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN REC34450000
               QUEST IS DELETE.'                                        34500000
         AGO   .SKIP210                                                 34550000
.SKIP200 ANOP                                                      @P1A 34570000
&MOWNR   SETA  0                                                   @P1A 34590000
         AIF   (N'&OWNER EQ 1).SKIP210                             @P1C 34610000
&MOWNR   SETA  1                                                   @P1A 34630000
         MNOTE 4,'OWNER= &OWNER HAS TOO MANY VALUES. VALUES IGNORED AFTC34650000
               ER &OWNER(1).'                                           34700000
.********************************************************************** 34750000
.*                                                                    * 34800000
.*       SCOPE Keyword Processing                                     * 34850000
.*                                                                    * 34900000
.********************************************************************** 34950000
.SKIP210 AIF   ('&REQUEST(1)' NE 'DEFINE').SKIP220                      35000000
         AIF   ('&SCOPE(1)' NE '').SKIP240                              35050000
         MNOTE 4,'SCOPE KEYWORD IGNORED. SCOPE VALUE NOT SPECIFIED.'    35100000
         AGO   .SKIP260                                                 35150000
.SKIP220 AIF   ('&REQUEST(1)' NE 'DELETE').SKIP230                      35200000
         AIF   ('&SCOPE(1)' EQ '^').SKIP260                             35250000
         MNOTE 4,'SCOPE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN REC35300000
               QUEST IS DELETE.'                                        35350000
         AGO   .SKIP260                                                 35400000
.SKIP230 AIF   ('&SCOPE(1)' EQ '^').SKIP260                             35450000
         MNOTE 4,'SCOPE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN REC35500000
               QUEST IS REDEFINE.'                                      35550000
         AGO   .SKIP260                                                 35600000
.SKIP240 AIF   (N'&SCOPE EQ 1).SKIP250                                  35650000
         MNOTE 4,'SCOPE= &SCOPE HAS TOO MANY VALUES. VALUES IGNORED AFTC35700000
               ER &SCOPE(1).'                                           35750000
.SKIP250 AIF   ('&SCOPE(1)' EQ '^' OR '&SCOPE(1)' EQ 'SYSTEM' OR       C35800000
                                     '&SCOPE(1)' EQ 'SYSPLEX').SKIP260  35850000
         MNOTE 4,'SCOPE KEYWORD IGNORE. VALUE &SCOPE UNKNOWN.'          35900000
.********************************************************************** 35950000
.*                                                                    * 36000000
.*       FAILDISP Keyword Processing                                  * 36050000
.*                                                                    * 36100000
.********************************************************************** 36150000
.SKIP260 AIF   ('&REQUEST(1)' NE 'DEFINE').SKIP270                      36200000
         AIF   ('&FAILDISP(1)' NE '').SKIP290                           36250000
         MNOTE 4,'FAILDISP KEYWORD IGNORED. FAILDISP VALUE NOT SPECIFIEC36300000
               D.'                                                      36350000
         AGO .SKIP310                                                   36400000
.SKIP270 AIF   ('&REQUEST(1)' NE 'DELETE').SKIP280                      36450000
         AIF   ('&FAILDISP(1)' EQ '^').SKIP310                          36500000
         MNOTE 4,'FAILDISP KEYWORD IGNORED. THIS KEYWORD NOT VALID WHENC36550000
                REQUEST IS DELETE.'                                     36600000
         AGO   .SKIP310                                                 36650000
.SKIP280 AIF   ('&FAILDISP(1)' EQ '^').SKIP310                          36700000
         MNOTE 4,'FAILDISP KEYWORD IGNORED. THIS KEYWORD NOT VALID WHENC36750000
                REQUEST IS REDEFINE.'                                   36800000
         AGO   .SKIP310                                                 36850000
.SKIP290 AIF   (N'&FAILDISP EQ 1).SKIP300                               36900000
         MNOTE 4,'FAILDISP= &FAILDISP HAS TOO MANY VALUES. VALUES IGNORC36950000
               ED AFTER &FAILDISP(1).'                                  37000000
.SKIP300 AIF   ('&FAILDISP(1)' EQ '^' OR '&FAILDISP(1)' EQ 'PURGE' OR  C37050000
                           '&FAILDISP(1)' EQ 'RETAIN' OR               C37100000
                                  '&FAILDISP(1)' EQ 'SYSPURGE').SKIP310 37150000
         MNOTE 4,'FAILDISP KEYWORD IGNORE. VALUE &FAILDISP UNKNOWN.'    37200000
.********************************************************************** 37250000
.*                                                                    * 37300000
.*       REMOVE Keyword Processing                                    * 37350000
.*                                                                    * 37400000
.********************************************************************** 37450000
.SKIP310 AIF   ('&REQUEST(1)' NE 'DEFINE').SKIP320                      37500000
         AIF   ('&REMOVE(1)' NE '').SKIP340                             37550000
         MNOTE 4,'REMOVE KEYWORD IGNORED. REMOVE VALUE NOT SPECIFIED.'  37600000
         AGO   .SKIP360                                                 37650000
.SKIP320 AIF   ('&REQUEST(1)' NE 'DELETE').SKIP330                      37700000
         AIF   ('&REMOVE(1)' EQ '^').SKIP360                            37750000
         MNOTE 4,'REMOVE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN RC37800000
               EQUEST IS DELETE.'                                       37850000
         AGO   .SKIP360                                                 37900000
.SKIP330 AIF   ('&REMOVE(1)' EQ '^').SKIP360                            37950000
         MNOTE 4,'REMOVE KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN RC38000000
               EQUEST IS REDEFINE.'                                     38050000
         AGO   .SKIP360                                                 38100000
.SKIP340 AIF   (N'&REMOVE EQ 1).SKIP350                                 38150000
         MNOTE 4,'REMOVE= &REMOVE HAS TOO MANY VALUES. VALUES IGNORED AC38200000
               FTER &REMOVE(1).'                                        38250000
.SKIP350 AIF   ('&REMOVE(1)' EQ '^' OR '&REMOVE(1)' EQ 'YES'           C38300000
                                      OR '&REMOVE(1)' EQ 'NO').SKIP360  38350000
         MNOTE 4,'REMOVE KEYWORD IGNORE. VALUE &REMOVE UNKNOWN.'        38400000
.********************************************************************** 38450000
.*                                                                    * 38500000
.*       CURSYS Keyword Processing                                    * 38550000
.*                                                                    * 38600000
.********************************************************************** 38650000
.SKIP360 AIF   ('&REQUEST(1)' EQ 'DEFINE').SKIP370                      38700000
         AIF   ('&CURSYS(1)' NE '').SKIP380                             38750000
         MNOTE 4,'CURSYS KEYWORD IGNORED. CURSYS VALUE NOT SPECIFIED.'  38800000
         AGO   .SKIP390                                                 38850000
.SKIP370 AIF   ('&CURSYS(1)' EQ '^').SKIP390                            38900000
         MNOTE 4,'CURSYS KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN RC38950000
               EQUEST IS DEFINE.'                                       39000000
         AGO   .SKIP390                                                 39050000
.SKIP380 ANOP                                                      @P1A 39070000
&MCSYS   SETA  0                                                   @P1A 39090000
         AIF   (N'&CURSYS EQ 1).SKIP390                            @P1A 39110000
&MCSYS   SETA  1                                                   @P1A 39130000
         MNOTE 4,'CURSYS= &CURSYS HAS TOO MANY VALUES. VALUES IGNORED AC39150000
               FTER &CURSYS(1).'                                        39200000
.********************************************************************** 39250000
.*                                                                    * 39300000
.*       NEWSYS Keyword Processing                                    * 39350000
.*                                                                    * 39400000
.********************************************************************** 39450000
.SKIP390 AIF   ('&REQUEST(1)' NE 'REDEFINE').SKIP400                    39500000
         AIF   ('&NEWSYS(1)' NE '').SKIP420                             39550000
         MNOTE 4,'NEWSYS KEYWORD IGNORED. NEWSYS VALUE NOT SPECIFIED.'  39600000
         AGO   .SKIP430                                                 39650000
.SKIP400 AIF   ('&REQUEST(1)' NE 'DEFINE').SKIP410                      39700000
         AIF   ('&NEWSYS(1)' EQ '^').SKIP430                            39750000
         MNOTE 4,'NEWSYS KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN RC39800000
               EQUEST IS DEFINE.'                                       39850000
         AGO   .SKIP430                                                 39900000
.SKIP410 AIF   ('&NEWSYS' EQ '^').SKIP430                               39950000
         MNOTE 4,'NEWSYS KEYWORD IGNORED. THIS KEYWORD NOT VALID WHEN RC40000000
               EQUEST IS DELETE.'                                       40050000
         AGO   .SKIP430                                                 40100000
.SKIP420 ANOP                                                      @P1A 40120000
&MNSYS   SETA  0                                                   @P1A 40140000
         AIF   (N'&NEWSYS EQ 1).SKIP430                            @P1C 40160000
&MNSYS   SETA  1                                                   @P1A 40180000
         MNOTE 4,'NEWSYS= &NEWSYS HAS TOO MANY VALUES. VALUES IGNORED AC40200000
               FTER &NEWSYS(1).'                                        40250000
.********************************************************************** 40300000
.*                                                                    * 40350000
.*       RESOURCE Keyword Processing                                  * 40400000
.*                                                                    * 40450000
.********************************************************************** 40500000
.SKIP430 AIF ('&RESOURCE(1)' NE '').SKIP440                             40550000
         MNOTE 4,'RESOURCE KEYWORD IGNORED. RESOURCE VALUE NOT SPECIFIEC40600000
               D.'                                                      40650000
         AGO   .SKIP460                                                 40700000
.SKIP440 AIF   (N'&RESOURCE EQ 1).SKIP450                               40750000
         MNOTE 4,'RESOURCE= &RESOURCE HAS TOO MANY VALUES. VALUES IGNORC40800000
               ED AFTER &RESOURCE(1).'                                  40850000
.SKIP450 AIF   ('&RESOURCE(1)' EQ '^' OR '&RESOURCE(1)' EQ 'NOTHELD'   C40900000
                                 OR '&RESOURCE(1)' EQ 'HELD').SKIP460   40950000
         MNOTE 4,'RESOURCE KEYWORD IGNORED. VALUE &RESOURCE UNKNOWN.'   41000000
.********************************************************************** 41050000
.*                                                                    * 41100000
.*       Fill in Parameter List and LINK CPF Routine                  * 41150000
.*                                                                    * 41200000
.********************************************************************** 41250000
.SKIP460 AIF (&SEVLEV EQ 12).EXIT          IF SEVERE ERROR OCCURRED    C41300000
                                            THEN BR TO EXIT             41350000
         XC    &LNAM.(52),&LNAM            LENGTH IS ALWAYS 52     @01C 41419990
         MVC   &LNAM.01,&LNAM.AC                                        41450000
         OI    &LNAM.02,X'01'                                           41500000
         AIF   ('&REQUEST(1)' NE 'DEFINE').SKIP500                      41550000
         OI    &LNAM.03,X'80'                                           41600000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').SKIP470                        41650000
         OI    &LNAM.04,X'80'                                           41700000
.SKIP470 AIF   ('&FAILDISP(1)' NE 'RETAIN').SKIP480                     41750000
         OI    &LNAM.04,X'60'                                           41800000
         AGO   .SKIP490                                                 41850000
.SKIP480 AIF   ('&FAILDISP(1)' NE 'SYSPURGE').SKIP490                   41900000
         OI    &LNAM.04,X'20'                                           41950000
.SKIP490 AIF   ('&REMOVE(1)' NE 'YES').SKIP520                          42000000
         OI    &LNAM.04,X'10'                                           42050000
         AGO   .SKIP520                                                 42100000
.SKIP500 AIF   ('&REQUEST(1)' NE 'REDEFINE').SKIP510                    42150000
         OI    &LNAM.03,X'40'                                           42200000
         AGO   .SKIP520                                                 42250000
.SKIP510 OI    &LNAM.03,X'20'                                           42300000
.SKIP520 AIF   ('&PREFIX'(&MPRFX+1,1) EQ '(').SKIP523              @P1C 42311100
         MVC   &LNAM.05,&PREFIX(1)                                 @P1A 42322200
         AGO   .SKIP526                                            @P1A 42333300
.SKIP523 ANOP                                                      @P1A 42344400
&REGOFF  SETA  &MPRFX+2                                            @P1A 42355500
&REGLEN  SETA  K'&PREFIX(1)-(2*&MPRFX)                             @P1A 42366600
&REGVAL  SETC  '&PREFIX'(&REGOFF,&REGLEN)                          @P1A 42377700
         MVC   &LNAM.05,0(&REGVAL)                                 @P1A 42388800
.SKIP526 AIF   ('&OWNER' EQ '^' OR '&OWNER' EQ '').SKIP535         @P1A 42399900
         AIF   ('&OWNER'(&MOWNR+1,1) EQ '(').SKIP530               @P1A 42411000
         MVC   &LNAM.06,&OWNER(1)                                  @P1A 42422100
         AGO   .SKIP535                                            @P1A 42433200
.SKIP530 ANOP                                                      @P1A 42444300
&REGOFF  SETA  &MOWNR+2                                            @P1A 42455400
&REGLEN  SETA  K'&OWNER(1)-(2*&MOWNR)                              @P1A 42466500
&REGVAL  SETC  '&OWNER'(&REGOFF,&REGLEN)                           @P1A 42477600
         MVC   &LNAM.06,0(&REGVAL)                                 @P1A 42488700
.SKIP535 AIF   ('&CURSYS' EQ '^' OR '&CURSYS' EQ '').SKIP543       @P1A 42499800
         AIF   ('&CURSYS'(&MCSYS+1,1) EQ '(').SKIP540              &P1A 42510900
         MVC   &LNAM.07,&CURSYS(1)                                 @P1A 42522000
         AGO   .SKIP543                                            @P1A 42533100
.SKIP540 ANOP                                                      @P1A 42544200
&REGOFF  SETA  &MCSYS+2                                            @P1A 42555300
&REGLEN  SETA  K'&CURSYS(1)-(2*&MCSYS)                             @P1A 42566400
&REGVAL  SETC  '&CURSYS'(&REGOFF,&REGLEN)                          @P1A 42577500
         MVC   &LNAM.07,0(&REGVAL)                                 @P1A 42588600
.SKIP543 AIF   ('&NEWSYS' EQ '^' OR '&NEWSYS' EQ '').SKIP550       @P1A 42599700
         AIF   ('&NEWSYS'(&MNSYS+1,1) EQ '(').SKIP546              @P1A 42610800
         MVC   &LNAM.08,&NEWSYS(1)                                 @P1A 42621900
         AGO   .SKIP550                                            @P1A 42633000
.SKIP546 ANOP                                                      @P1A 42644100
&REGOFF  SETA  &MNSYS+2                                            @P1A 42655200
&REGLEN  SETA  K'&NEWSYS(1)-(2*&MNSYS)                             @P1A 42666300
&REGVAL  SETC  '&NEWSYS'(&REGOFF,&REGLEN)                          @P1A 42677400
         MVC   &LNAM.08,0(&REGVAL)                                 @P1A 42688500
.SKIP550 AIF   ('&RESOURCE' NE 'HELD').SKIP560                          42700000
         OI    &LNAM.04,X'08'                                           42750000
.SKIP560 AIF   (&SEVLEV EQ 12).EXIT                                     42800000
         LA    15,&LNAM                                            @P1A 42825000
         ST    15,&LNAM.09                                         @P1A 42850000
         LINK  EP=IEAVG710,MF=(E,&LNAM.09)                         @P1A 42875000
.EXIT    ANOP                                                           42900000
         MEND                                                           42950000
.********************************************************************** 43000000
.*                   PLAS/PLS SECTION                                 * 43050000
.*                                                                    * 43100000
.*         INVOKE PLAS VERSION OF XSYSMCS MACRO                       * 43150000
.********************************************************************** 43200000
**/                                                                     43250000
*%CPF: MACRO KEYS(REQUEST,                                              43300000
*                 PREFIX,                                               43350000
*                 OWNER,                                                43400000
*                 SCOPE,                                                43450000
*                 FAILDISP,                                             43500000
*                 REMOVE,                                               43550000
*                 CURSYS,                                               43600000
*                 NEWSYS,                                               43650000
*                 RESOURCE,                                             43700000
*                 MF);                                                  43750000
*        ANS('?'||'CPFP '||MACKEYS||';');        /* INVOKE MACRO     */ 43800000
*                                                                       43850000
*      %END;                                                            43900000
