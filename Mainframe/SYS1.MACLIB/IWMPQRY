*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IWMPQRY                               -02/26/97-<0> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  WLM Query Active Service Policy               * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00600000
*     5645-001 (C) COPYRIGHT IBM CORP. 1993, 1997                     * 00650000
*                                                                     * 00750000
* STATUS= JBB6604                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*                                                                     * 00950000
*01* FUNCTION:                                                        * 01000000
*                                                                     * 01050000
*                                                                     * 01100000
*      The Query Active Service Policy routine is given control from  * 01150000
*      the IWMPQRY macro.  The Query Active Service Policy macro will * 01200000
*      complete the parameter list with caller provided data and      * 01250000
*      generate a stacking, space switching, program call to the      * 01300000
*      query service.                                                 * 01350000
*                                                                     * 01400000
*      The purpose of this routine is to return a representation of   * 01450000
*      the active policy which could be used to explain how the       * 01500000
*      system/sysplex is being managed and could be used in           * 01550000
*      conjunction with current measurements to evaluate the          * 01600000
*      condition of the system/sysplex.  The information returned is  * 01650000
*      not serialized upon return to the caller, and so may be        * 01700000
*      out-of-date due to a change in policy.                         * 01750000
*                                                                     * 01800000
*      The Query Active Service Policy macro is provided in list,     * 01850000
*      execute, and standard form.  The list form accepts no variable * 01900000
*      parameters and is used only to reserve space for the query     * 01950000
*      parameter list.  The standard form is provided for use with    * 02000000
*      routines which do not require reentrant code.  The execute     * 02050000
*      form is provided for use with the list format for reentrant    * 02100000
*      routines.  The query macro is provided in PL/AS and assembler  * 02150000
*      formats.                                                       * 02200000
*                                                                     * 02250000
*      The parameter list must be in the caller's primary address     * 02300000
*      space or be addressable by the dispatchable unit access list.  * 02350000
*                                                                     * 02360000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 02370000
*                                                                     * 02380000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 02390000
*                                                                     * 02400000
*01* ENVIRONMENT:                                                     * 02450000
*                                                                     * 02500000
*                                                                     * 02550000
*      Dispatchable unit mode: Task mode.                             * 02600000
*                                                                     * 02650000
*      Minimum authorization: Supervisor state or program key mask    * 02700000
*                        (PKM) allowing keys 0-7.                     * 02750000
*                                                                     * 02800000
*      AMODE:            31-bit.                                      * 02850000
*                                                                     * 02900000
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 02950000
*                                                                     * 03000000
*      ASC mode:         Primary or Access Register.  If in Access    * 03050000
*                        Register ASC mode, specify SYSSTATE          * 03100000
*                        ASCENV=AR before invoking this macro.        * 03150000
*                                                                     * 03200000
*      Interrupt status: Enabled for I/O and external interrupts.     * 03250000
*                                                                     * 03350000
*      Locks:            No locks held.                               * 03400000
*                                                                     * 03450000
*      Control parameters:     All parameter areas must reside in     * 03500000
*                        current primary or be addressable by the     * 03550000
*                        dispatchable unit access list.               * 03600000
*                                                                     * 03900000
*                                                                     * 03950000
*                                                                     * 04000000
*01* PROGRAMMING REQUIREMENTS:                                        * 04025000
*                                                                     * 04050000
*                                                                     * 04100000
*    1.  The macro CVT must be included to use this macro.            * 04150000
*                                                                     * 04450000
*    2.  This macro may only be used on MVS/ESA SP5.1.0 or higher.    * 04459200
*                                                                     * 04468400
*    3.  The macro IWMYCON must be included to use this macro.        * 04477600
*                                                                     * 04486800
*    4.  The macro IWMPB must be in the library concatenation, since  * 04496000
*        it is included by IWMYCON.                                   * 04505200
*                                                                     * 04514400
*    5.  Note that the high order halfword of register 0, and the     * 04523600
*        reason code variable when specified, may be non-zero and     * 04532800
*        represents diagnostic data which is NOT part of the external * 04542000
*        interface.  The high order halfword should thus be excluded  * 04551200
*        from comparison with the reason code values described above. * 04560400
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 04569600
*        be used for this purpose.                                    * 04578800
*                                                                     * 04588000
*                                                                     * 04597200
*                                                                     * 04606400
*01* RESTRICTIONS:                                                    * 04615600
*                                                                     * 04624800
*                                                                     * 04634000
*    1.  This macro may not be used prior to the completion of WLM    * 04643200
*        address space initialization                                 * 04652400
*                                                                     * 04661600
*    2.  The caller cannot have an EUT FRR established.               * 04670800
*                                                                     * 04680000
*                                                                     * 04689200
*                                                                     * 04698400
*01* INPUT REGISTER INFORMATION:                                      * 04707600
*                                                                     * 04716800
*    Before issuing the IWMPQRY macro, the caller does not have to    * 04726000
*    place any information into any register unless using it in       * 04735200
*    register notation for a particular parameter, or using it as a   * 04744400
*    base register.                                                   * 04753600
*                                                                     * 04762800
*01* OUTPUT REGISTER INFORMATION:                                     * 04772000
*                                                                     * 04781200
*    When control returns to the caller, the GPRs contain:            * 04790400
*                                                                     * 04799600
*                                                                     * 04808800
*    REGISTER  CONTENTS                                               * 04818000
*                                                                     * 04827200
*    0         Reason code if GR15 return code is non-zero            * 04836400
*                                                                     * 04845600
*    1         Used as work registers by the system                   * 04854800
*                                                                     * 04864000
*    2-13      Unchanged                                              * 04873200
*                                                                     * 04882400
*    14        Used as a work register by the system                  * 04891600
*                                                                     * 04900800
*    15        Return code                                            * 04910000
*                                                                     * 04919200
*                                                                     * 04928400
*                                                                     * 04937600
*    When control returns to the caller, the ARs contain:             * 04946800
*                                                                     * 04956000
*                                                                     * 04965200
*    REGISTER  CONTENTS                                               * 04974400
*                                                                     * 04983600
*    0-1       Used as work registers by the system                   * 04992800
*                                                                     * 05002000
*    2-13      Unchanged                                              * 05011200
*                                                                     * 05020400
*    14-15     Used as work registers by the system                   * 05029600
*                                                                     * 05038800
*                                                                     * 05048000
*                                                                     * 05057200
*    Some callers depend on register contents remaining the same      * 05066400
*    before and after issuing a service.  If the system changes the   * 05075600
*    contents of registers on which the caller depends, the caller    * 05084800
*    must save them before issuing the service, and restore them      * 05094000
*    after the system returns control.                                * 05103200
*                                                                     * 05112400
*01* PERFORMANCE IMPLICATIONS:                                        * 05121600
*                                                                     * 05130800
*    None                                                             * 05140000
*                                                                     * 05150000
*01* SYNTAX:                                                          * 05200000
*                                                                     * 05250000
*[xlabel]  IWMPQRY     ANSAREA=xansarea                               * 05300000
*                     ,ANSLEN=xanslen                                 * 05350000
*                     ,QUERYLEN=xquerylen                             * 05400000
*                    [,RETCODE=xretcode]                              * 05450000
*                    [,RSNCODE=xrsncode]                              * 05500000
*                    [,PLISTVER=xplistver|IMPLIED_VERSION]          * 05525000
*                   [,MF=S]                                          * 05550000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 05600000
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 05650000
*                                                                     * 05700000
*                                                                     * 05750000
*      Where:                                                         * 05800000
*                                                                     * 05850000
*                                                                     * 05900000
*      [xlabel]                                                       * 05950000
*          is an optional symbol, starting in column 1, that is the   * 06000000
*          name on the IWMPQRY macro invocation.  The name must       * 06050000
*          conform to the rules for an ordinary assembler language    * 06100000
*          symbol.                                                    * 06150000
*          DEFAULT: No name.                                          * 06200000
*                                                                     * 06250000
*                                                                     * 06300000
*                                                                     * 06350000
*                                                                     * 06400000
*      ANSAREA=xansarea                                               * 06450000
*          is the name (RS-type), or address in register (2)-(12), of * 06500000
*          a required character output variable specifying an area to * 06550000
*          contain the data being returned by IWMPQRY.  The answer    * 06600000
*          area is defined by the IWMSVPOL macro.                     * 06650000
*                                                                     * 06700000
*                                                                     * 06750000
*                                                                     * 06800000
*                                                                     * 06850000
*      ANSLEN=xanslen                                                 * 06900000
*          is the name (RS-type), or address in register (2)-(12), of * 06950000
*          a required fullword input variable which contains the      * 07000000
*          length of the area provided to contain the data being      * 07050000
*          returned by IWMPQRY.                                       * 07100000
*                                                                     * 07150000
*                                                                     * 07200000
*                                                                     * 07250000
*                                                                     * 07300000
*      QUERYLEN=xquerylen                                             * 07350000
*          is the name (RS-type), or address in register (2)-(12), of * 07400000
*          a required fullword output variable which contains the     * 07450000
*          number of bytes needed to contain the policy information.  * 07500000
*                                                                     * 07550000
*                                                                     * 07600000
*                                                                     * 07650000
*                                                                     * 07700000
*      [RETCODE=xretcode]                                             * 07750000
*          is the name (RS-type) of an optional fullword output       * 07800000
*          variable, or register (2)-(12), into which the return code * 07850000
*          is to be copied from GPR 15.                               * 07900000
*                                                                     * 07950000
*                                                                     * 08000000
*                                                                     * 08050000
*                                                                     * 08100000
*      [RSNCODE=xrsncode]                                             * 08150000
*          is the name (RS-type) of an optional fullword output       * 08200000
*          variable, or register (2)-(12), into which the reason code * 08250000
*          is to be copied from GPR 0.                                * 08300000
*                                                                     * 08350000
*                                                                     * 08400000
*                                                                     * 08450000
*                                                                     * 08500000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 08502200
*          is an optional byte input decimal value in the "0-0" range * 08504400
*          that specifies the macro version.  PLISTVER is the only    * 08506600
*          key allowed on the list form of MF and determines which    * 08508800
*          parameter list is generated.  Note that MAX may be         * 08511000
*          specified instead of a number, and the parameter list will * 08513200
*          be of the largest size currently supported. This size may  * 08515400
*          grow from release to release (thus possibly affecting the  * 08517600
*          amount of storage needed by your program).  If your        * 08519800
*          program can tolerate this, IBM recommends that you always  * 08522000
*          specify MAX when creating the list form parameter list as  * 08524200
*          that will ensure that the list form parameter list is      * 08526400
*          always long enough to hold whatever parameters might be    * 08528600
*          specified on the execute form.                             * 08530800
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 08533000
*          default is the lowest version which allows all of the      * 08535200
*          parameters specified on the invocation to be processed.    * 08537400
*                                                                     * 08539600
*                                                                     * 08541800
*                                                                     * 08544000
*                                                                     * 08546200
*      [MF=S|L|E]                                                   * 08550000
*          is an optional keyword input which specifies the macro     * 08600000
*          form.                                                      * 08650000
*          DEFAULT: S                                                 * 08700000
*                                                                     * 08750000
*                                                                     * 08800000
*          [MF=S]                                                     * 08850000
*              specifies the standard form of the macro.  The "S"     * 08900000
*              form generates code to put the parameters into an      * 08950000
*              in-line parameter list and invoke the desired service. * 09000000
*              Full checking for required macro keys is done along    * 09050000
*              with supplying defaults for omitted optional           * 09100000
*              parameters.                                            * 09150000
*                                                                     * 09200000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 09250000
*              specifies the list form of the macro.  The "L" form    * 09300000
*              defines an area to be used for the parameter list.     * 09350000
*              Only the PLISTVER key may be specified on the          * 09370000
*              invocation.  All other macro parameters are flagged as * 09390000
*              errors.  If PLISTVER is not specified, the original    * 09410000
*              parameter list definition is used.                     * 09430000
*                                                                     * 09450000
*            ,xmfctrl                                                 * 09500000
*              is a required input.  It is the name of a storage area * 09550000
*              for the parameter list.                                * 09600000
*                                                                     * 09650000
*            ,xmfattr|0D                                            * 09700000
*              is an optional 60 character input string that varies   * 09750000
*              from 1 to 60 characters. Use it to force boundary      * 09800000
*              alignment of the parameter list. Use any value that    * 09850000
*              represents a boundary and is valid on an assembler DS  * 09900000
*              pseudo op.                                             * 09950000
*              DEFAULT: 0D which forces the parameter list to a       * 10000000
*              doubleword boundary.                                   * 10050000
*                                                                     * 10100000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 10150000
*              specifies the execute form of the macro.  The "E" form * 10200000
*              generates code to put the parameters into the          * 10250000
*              parameter list specified by xmfctrl and provides full  * 10300000
*              syntax checking with default setting.                  * 10350000
*                                                                     * 10400000
*            ,xmfctrl                                                 * 10450000
*              is a required input.  It is the name (RS-type), or     * 10500000
*              address in register (1)-(12), of a storage area for    * 10550000
*              the parameter list.                                    * 10600000
*                                                                     * 10650000
*            ,COMPLETE                                              * 10700000
*              is an optional keyword input which specifies the       * 10750000
*              degree of macro parameter syntax checking.             * 10800000
*              DEFAULT: COMPLETE                                      * 10850000
*                                                                     * 10900000
*                                                                     * 10950000
*              COMPLETE                                               * 10990000
*                  Checking for required macro keys is done and       * 11030000
*                  defaults are supplied for omitted optional         * 11070000
*                  parameters.                                        * 11110000
*                                                                     * 11150000
*                                                                     * 11200000
*                                                                     * 11250000
*                                                                     * 11300000
*                                                                     * 11350000
*                                                                     * 11400000
*                                                                     * 11450000
*01* RETURN CODES:                                                    * 11500000
*                                                                     * 11550000
*                                                                     * 11600000
*            0    Name: IwmRetCodeOk                                  * 11650000
*                                                                     * 11750000
*                 Meaning: Successful completion.                     * 11800000
*                                                                     * 11900000
*                 Action: None required.                              * 11910000
*                                                                     * 11920000
*            4    Name: IwmRetCodeWarning                             * 11930000
*                                                                     * 11940000
*                 Meaning: Successful completion, unusual conditions  * 11950000
*                 noted.                                              * 11960000
*                                                                     * 11970000
*                                                                     * 11980000
*                 HEX REASON  MEANING/ACTION                          * 11990000
*                 CODE                                                * 12000000
*                                                                     * 12050000
*                 xxxx0401    Name: IwmRsnCodeNoWLM                   * 12075000
*                                                                     * 12100000
*                             Meaning:  System does not support       * 12150000
*                             policy management services.  This       * 12200000
*                             return code is only set when the MVS    * 12250000
*                             release is prior to MVS/ESA SP5.1.0.    * 12300000
*                                                                     * 12400000
*                             Action: None required.                  * 12450000
*                                                                     * 12562500
*                 xxxx040A    Name: IwmRsnCodeOutputAreaTooSmall      * 12564500
*                                                                     * 12566500
*                             Meaning:  The output area supplied is   * 12568500
*                             too small to receive all the available  * 12570500
*                             information.                            * 12572500
*                                                                     * 12574500
*                             Action: None required.  If necessary,   * 12576500
*                             reinvoke the service with an output     * 12578500
*                             area of sufficient size to receive all  * 12580500
*                             information.                            * 12582500
*                                                                     * 12584500
*                 xxxx0423    Name: IwmRsnCodeDefaultPolicy           * 12586500
*                                                                     * 12588500
*                             Meaning:  The default policy was        * 12590500
*                             returned.                               * 12592500
*                                                                     * 12594500
*                             Action: None required.                  * 12596500
*                                                                     * 12600000
*                                                                     * 12650000
*                                                                     * 12700000
*            8    Name: IwmRetCodeInvocError                          * 12725000
*                                                                     * 12750000
*                 Meaning: Invalid invocation environment or          * 12800000
*                 parameters.                                         * 12850000
*                                                                     * 12900000
*                                                                     * 12933300
*                 HEX REASON  MEANING/ACTION                          * 12966600
*                 CODE                                                * 13000000
*                                                                     * 13050000
*                 xxxx0801    Name: IwmRsnCodeSrbMode                 * 13075000
*                                                                     * 13100000
*                             Meaning:  Caller is in SRB mode.        * 13150000
*                                                                     * 13250000
*                             Action: Avoid requesting this function  * 13300000
*                             while in SRB mode.                      * 13350000
*                                                                     * 13400000
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 13450000
*                                                                     * 13500000
*                             Meaning: Caller is disabled.            * 13506200
*                                                                     * 13512400
*                             Action: Avoid requesting this function  * 13518600
*                             while disabled.                         * 13524800
*                                                                     * 13531000
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 13537200
*                                                                     * 13543400
*                             Meaning: Caller is locked.              * 13549600
*                                                                     * 13555800
*                             Action: Avoid requesting this function  * 13562000
*                             while locked.                           * 13568200
*                                                                     * 13574400
*                 xxxx0810    Name: IwmRsnCodeEutFrr                  * 13580600
*                                                                     * 13586800
*                             Meaning:  Caller has EUT FRR            * 13593000
*                             established.                            * 13600000
*                                                                     * 13650000
*                             Action: Avoid requesting this function  * 13700000
*                             with an EUT FRR set.                    * 13750000
*                                                                     * 13800000
*                 xxxx0830    Name: IwmRsnCodeBadAlet                 * 13805500
*                                                                     * 13811000
*                             Meaning:  Caller has passed an invalid  * 13816500
*                             ALET.                                   * 13822000
*                                                                     * 13827500
*                             Action: Check for possible storage      * 13833000
*                             overlay of the parameter list or        * 13838500
*                             variable.                               * 13844000
*                                                                     * 13850000
*                                                                     * 13900000
*                                                                     * 13950000
*                                                                     * 14000000
*                                                                     * 14050000
*                                                                     * 14100000
*                                                                     * 14150000
*01* REASON CODES:                                                    * 14200000
*                                                                     * 14250000
*       A unique reason code will be returned whenever the return     * 14300000
*       code is non-zero.  Reason codes, as appropriate, are defined  * 14350000
*       under their corresponding return code.  Reason code and       * 14400000
*       return code constants are defined within IWMYCON.  Note that  * 14450000
*       the high order halfword of register 0, and the reason code    * 14500000
*       variable when specified, may be non-zero and represents       * 14550000
*       diagnostic data which is NOT part of the external interface.  * 14600000
*       The high order halfword should thus be excluded from          * 14650000
*       comparison with the reason code values described above.  The  * 14700000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 14750000
*       used for this purpose.                                        * 14800000
*                                                                     * 14850000
*01* ABEND CODES:                                                     * 14852500
*                                                                     * 14855000
*                                                                     * 14857500
*       1C7       WLM Abend                                           * 14860000
*                                                                     * 14862500
*                                                                     * 14865000
*                                                                     * 14867500
*01* ABEND REASON CODES:                                              * 14870000
*                                                                     * 14872500
*       REASON    ABEND                                               * 14875000
*       CODE      CODE      DESCRIPTION                               * 14877500
*                                          * 14880000
*                                                                     * 14882500
*                                                                     * 14885000
*       0Axx0005  1C7       An    attempt   to   reference   caller's * 14887500
*                           parameters caused an OC4 abend.           * 14890000
*                                                                     * 14892500
*                                                                     * 14895000
*                                                                     * 14897500
*01* MODULE TYPE:  ASSEM MACRO                                        * 14900000
*                                                                     * 14950000
*02*   PROCESSOR:  ASSEM                                              * 15000000
*                                                                     * 15050000
*01* COMPONENT:  SCWLM                                                * 15100000
*                                                                     * 15150000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 15200000
*                                                                     * 15250000
*01* MACRO USAGE NOTES:                                               * 15300000
*                                                                     * 15350000
*                                                                     * 15400000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 15450000
*        global macro variable.  Any value other than 'NO' will       * 15500000
*        result in the macro expansion being printed.  The default is * 15550000
*        'YES'.  The following examples illustrate how the ZPRINT     * 15600000
*        variable should be set.                                      * 15650000
*                                                                     * 15700000
*                    GBLC &ZPRINT                                     * 15750000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 15800000
*                                                                     * 15850000
*                                                                     * 15950000
*    2.  All keys currently contained in the IWMPQRY macro correspond * 15987500
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 16025000
*        MAX.                                                         * 16062500
*                                                                     * 16100000
*                                                                     * 16900000
*                                                                     * 16950000
*                                                                     * 17000000
*01* CHANGE ACTIVITY:                                                 * 17050000
*                                                                     * 17100000
*   Flag LineItem  FMID    Date   ID    Comment                       * 17150000
*                                                                     * 17200000
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 17250000
*    $P1=PSY0092  JBB6604 970226 PDB9RK:  Document abend code - 1C7   * 17275000
****** END OF SPECIFICATIONS *****************************************/ 17300000
*/* TLINE 1 *********************************************************** 17350000
         MACRO                                                          17400000
&XLABEL  IWMPQRY &ANSAREA=,&ANSLEN=,&QUERYLEN=,&RETCODE=,&RSNCODE=,    *17450000
               &PLISTVER=,&MF=                                          17500000
.*                                                                      17550000
*              MACDATE -02/26/97-<0>                                    17600000
.*                                                                      17650000
.*******************************************************************    17700000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        17750000
.*******************************************************************    17800000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   17850000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     17900000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             17950000
.*                                                                      18000000
              GBLC  &ZIWMPQRY   YES=MACRO USED AT LEAST ONCE            18050000
.*******************************************************************    18100000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          18150000
.*******************************************************************    18200000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 18250000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            18300000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              18350000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             18400000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             18450000
              LCLA  &ZAWRK      USED AS A WORK AREA                     18500000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  18550000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   18600000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 18650000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             18700000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 18750000
              LCLA  &ZMACRET    MACRO RETURN CODE                       18800000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        18850000
.*                                                                      18900000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      18950000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              19000000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   19050000
              LCLC  &ZENDBASEPL                 End of base PL          19075000
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   19077200
.*******************************************************************    19079400
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             19081600
.*******************************************************************    19083800
              LCLA  &ZI         INDEX FOR ARRAY                         19086000
              LCLA  &ZJ         INDEX FOR PARMS                         19088200
              LCLA  &ZK         INDEX FOR PARSE                         19090400
              LCLA  &ZLO        LOW RANGE VALUE                         19092600
              LCLA  &ZHI        HIGH RANGE VALUE                        19094800
              LCLC  &ZW         WORK AREA FOR PARM                      19097000
.********************************************************************   19100000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 19150000
.********************************************************************   19200000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 19250000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          19300000
.*                                                                      19350000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       19400000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        19450000
              SPLEVEL  TEST                                             19500000
.ZSYS2        ANOP  ,                                                   19550000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              19600000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              19650000
              SYSSTATE TEST                                             19700000
              AGO   .ZSYS4                                              19750000
.ZSYS3        ANOP  ,                                                   19800000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 19850000
.ZSYS4        ANOP  ,                                                   19900000
.*******************************************************************    19950000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   20000000
.*******************************************************************    20050000
              LCLC  &XANSAREA   ++ NAME                                 20100000
              LCLC  &XANSLEN    ++ NAME                                 20150000
              LCLC  &XQUERYLEN  ++ NAME                                 20200000
              LCLC  &XRETCODE   ++ NAME                                 20250000
              LCLC  &XRSNCODE   ++ NAME                                 20300000
              LCLA  &XPLISTVER  ++ VALUE                                20325000
              LCLC  &XMF        ++ VALUE                                20350000
              LCLC  &XMFCTRL    ++ NAME                                 20400000
              LCLC  &XMFATTR    ++ VALUE                                20450000
              LCLC  &XMFSCK     ++ VALUE                                20500000
.*******************************************************************    20550000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           20600000
.*******************************************************************    20650000
              LCLC  &ZXANSAREA  ++ OUTPUT NAME                          20700000
              LCLC  &ZXANSLEN   ++ INPUT NAME                           20750000
              LCLC  &ZXQUERYLEN                 ++ OUTPUT NAME          20800000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          20850000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          20900000
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          20925000
              LCLC  &ZXMF       ++ INPUT VALUE                          20950000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           21000000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          21050000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          21100000
.********************************************************************   21150000
.***AC.PLV01  PROCESS PLISTVER                                      *   21150800
.********************************************************************   21151600
&XPLISTVER      SETA  0                                                 21152400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       21153200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   21154000
&XPLISTVER      SETA  0                                                 21154800
.ZPLV0          ANOP  ,                                                 21155600
.*                                                                      21156400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      21157200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      21158000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  21158800
.*-------------------------------------------------------------------   21159600
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 21160400
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                21161200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 21162000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 21162800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               21163600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21164400
                AGO   .ZPVCK2                                           21165200
.ZPVCK3         ANOP  ,                                                 21166000
.*-------------------------------------------------------------------   21166800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  21167600
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                21168400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 21169200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         21170000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 21170800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21171600
                AGO   .ZPVCKE                                           21172400
.ZPVCK2         ANOP  ,                                                 21173200
.*-------------------------------------------------------------------   21174000
&ZCVAL          SETC  '&PLISTVER(1)'                                    21174800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             21175600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             21176400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        21177200
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      21178000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     21178800
.ZPVCK6         ANOP  ,                                                 21179600
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                21180400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 21181200
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         21182000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         21182800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21183600
&XPLISTVER      SETA  0                                                 21184400
                AGO   .ZPVCKE                                           21185200
.*-------------------------------------------------------------------   21186000
.ZPVCK4A        ANOP  ,                                                 21186800
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        21187600
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                21188400
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               21189200
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          21190000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 21190800
                MNOTE 8,' &ZMS IS REQUIRED.'                            21191600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21192400
                AGO   .ZPVCK5                                           21193200
.ZPVCK4         ANOP  ,                                                 21194000
&XPLISTVER      SETA  &PLISTVER(1)                                      21194800
.ZPVCK5         ANOP  ,                                                 21195600
.ZPVCKE         ANOP  ,                                                 21196400
.********************************************************************   21197200
.***AG.MF01 PROCESS MF MACRO FORMS                                      21200000
.********************************************************************   21250000
              ACTR  10000                                               21300000
.*------------------------------------------------------------------    21350000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           21400000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    21450000
.*-------------------------------------------------------------------   21500000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           21550000
.ZG21         ANOP  ,                                                   21600000
&ZTLC         SETC 'S'                                                  21650000
              AIF   ('&MF(1)' NE '&ZTLC').ZG22                          21700000
&XMF          SETC  'S'         SET KEYWORD                             21750000
              AIF   (N'&MF LE 1).ZG21A          CK NUM                  21800000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           21850000
&ZMS          SETC  '&ZMS.&MF"'                                         21900000
&ZMS          SETC  '&ZMS "MF"'                                         21950000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 22000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22050000
.ZG21A        ANOP  ,                                                   22100000
.*-------------------------------------------------------------------   22150000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           22200000
.ZG22         ANOP  ,                                                   22250000
&ZTLC         SETC 'L'                                                  22300000
              AIF   ('&MF(1)' NE '&ZTLC').ZG29                          22350000
&XMF          SETC  'L'         SET KEYWORD                             22400000
              AIF   (N'&MF LE 3).ZG22A          CK NUM                  22450000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           22500000
&ZMS          SETC  '&ZMS.&MF"'                                         22550000
&ZMS          SETC  '&ZMS "MF"'                                         22600000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                22650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22700000
.ZG22A        ANOP  ,                                                   22750000
.*-------------------------------------------------------------------   22800000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     22850000
              AIF   (N'&SYSLIST NE 0).ZG22B     POSITIONALS?            22900000
              AIF   ('&ANSAREA' NE '').ZG22B    KEYS?                   22950000
              AIF   ('&ANSLEN' NE '').ZG22B     KEYS?                   23000000
              AIF   ('&QUERYLEN' NE '').ZG22B   KEYS?                   23050000
              AIF   ('&RETCODE' NE '').ZG22B    KEYS?                   23100000
              AIF   ('&RSNCODE' NE '').ZG22B    KEYS?                   23150000
              AGO    .ZG22C     INVOCATION OKAY                         23200000
.ZG22B        ANOP  ,                                                   23250000
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            23300000
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                23350000
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           23400000
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              23450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23500000
.ZG22C        ANOP  ,                                                   23550000
.*-------------------------------------------------------------------   23600000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   23650000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           23700000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           23750000
              AIF   (N'&MF(2) GT 1).ZG24B       MULTI PARMS             23800000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           23850000
.ZG24B        AIF   (K'&MF(2) GT 0).ZG24C                               23900000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         23950000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 24000000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 24050000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        24100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24150000
.ZG24C        ANOP  ,                                                   24200000
.*-------------------------------------------------------------------   24250000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               24300000
              AIF   (K'&ZXMFCTRL LE 0).ZG24P    NOT I/O                 24350000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG24P                      24400000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         24450000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           24500000
&ZMS          SETC  '&ZMS.&MF"'                                         24550000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           24600000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   24650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24700000
.ZG24P        ANOP  ,                                                   24750000
.*-------------------------------------------------------------------   24800000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      24850000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           24900000
&XMFATTR      SETC  '0D'                                                24950000
              AIF   (K'&MF(3) LE 0).ZG27B       PARM                    25000000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           25050000
              AIF   (N'&MF(3) GT 1).ZG27B       MULTI PARMS             25100000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           25150000
.ZG27B        ANOP  ,                                                   25200000
.*-------------------------------------------------------------------   25250000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  25300000
              AIF   (K'&ZXMFATTR LE 0).ZG27P    NOT I/O                 25350000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG27P                      25400000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         25450000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           25500000
&ZMS          SETC  '&ZMS.&MF"'                                         25550000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           25600000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   25650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25700000
.ZG27P        ANOP  ,                                                   25750000
.*-------------------------------------------------------------------   25800000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 25850000
              AIF   (K'&ZXMFATTR LE 0).ZG27S    NOT I/O                 25900000
              AIF   (K'&XMFATTR LE 60).ZG27S    LNG OK                  25950000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         26000000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           26050000
&ZMS          SETC  '&ZMS.&MF"'                                         26100000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               26150000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  26200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26250000
.ZG27S        ANOP  ,                                                   26300000
.*-------------------------------------------------------------------   26350000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           26400000
.ZG29         ANOP  ,                                                   26450000
&ZTLC         SETC 'E'                                                  26500000
              AIF   ('&MF(1)' NE '&ZTLC').ZG37                          26550000
&XMF          SETC  'E'         SET KEYWORD                             26600000
              AIF   (N'&MF LE 3).ZG29A          CK NUM                  26650000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           26700000
&ZMS          SETC  '&ZMS.&MF"'                                         26750000
&ZMS          SETC  '&ZMS "MF"'                                         26800000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                26850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26900000
.ZG29A        ANOP  ,                                                   26950000
.*-------------------------------------------------------------------   27000000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   27050000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           27100000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           27150000
              AIF   (N'&MF(2) GT 1).ZG31B       MULTI PARMS             27200000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           27250000
.ZG31B        AIF   (K'&MF(2) GT 0).ZG31C                               27300000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         27350000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 27400000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 27450000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        27500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27550000
.ZG31C        ANOP  ,                                                   27600000
.*-------------------------------------------------------------------   27650000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              27700000
              AIF   (K'&ZXMFCTRL LE 0).ZG31R    NOT I/O                 27750000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG31R                      27800000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          27850000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                        27900000
              AIF   (K'&ZCGPR GT 2).ZG31Q                               27950000
              AIF   ('&ZCGPR' EQ '0').ZG31Q                             28000000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       28050000
              AIF   (T'&ZCGPR NE 'N').ZG31Q     INVALID REG NAME        28100000
.ZG31P        ANOP  ,                                                   28150000
              AIF   (T'&ZCGPR NE 'N').ZG31R     NON NUMERIC             28200000
              AIF   ('&ZCGPR' LT '1').ZG31Q                             28250000
              AIF   ('&ZCGPR' LE '12').ZG31R                            28300000
.ZG31Q        ANOP  ,                                                   28350000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           28400000
&ZMS          SETC  '&ZMS.&MF"'                                         28450000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           28500000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    28550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28600000
.ZG31R        ANOP  ,                                                   28650000
.*-------------------------------------------------------------------   28700000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             28750000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    28800000
.ZG35A   AIF   ('&MF(3)' NE 'COMPLETE').ZG36A                           28850000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             28900000
.*-------------------------------------------------------------------   28950000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             29000000
.ZG36A        AIF   (K'&XMFSCK GT 0).ZG36C      KEYWORD                 29050000
              AIF   (K'&MF(3) LE 0).ZG36B                               29100000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           29150000
&ZMS          SETC  '&ZMS.&MF"'                                         29200000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           29250000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 29300000
&ZMS          SETC  '&ZMS "COMPLETE".'          VALID KEYWORD           29350000
              MNOTE 8,' &ZMS '                                          29400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             29450000
.ZG36B        ANOP  ,                                                   29500000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     29550000
.ZG36C        ANOP  ,                                                   29600000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           29650000
.*------------------------------------------------------------------    29700000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           29750000
.ZG37         ANOP  ,                                                   29800000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           29850000
              AIF   (K'&XMF GT 0).ZG37E         VALID ARG               29900000
              AIF   (T'&MF EQ 'O').ZG37D        OMITTED                 29950000
&ZASYSLNDX    SETA  0                                                   30000000
.ZG37A        ANOP  ,           POSITIONAL MACRO KEY                    30050000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        30100000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG37C                    30150000
&ZTLC         SETC 'MF'                                                 30200000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG37A           30250000
.ZG37B        ANOP  ,                                                   30300000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         30350000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           30400000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             30450000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    30500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30550000
              AGO   .ZG37E                                              30600000
.ZG37C        ANOP  ,                                                   30650000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         30700000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           30750000
&ZMS          SETC  '&ZMS.&MF"'                                         30800000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           30850000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 30900000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           30950000
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           31000000
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           31050000
              MNOTE 8,' &ZMS '                                          31100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             31150000
              AGO   .ZG37E                                              31200000
.ZG37D        ANOP  ,                                                   31250000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     31300000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       31350000
.ZG37E        ANOP  ,                                                   31400000
.********************************************************************   31450000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 31500000
.********************************************************************   31550000
              ACTR  10000                                               31600000
.*-------------------------------------------------------------------   31650000
.***AG.MF03 MF=(SLE)                                                    31700000
              AIF   ('&XMF' EQ 'L').ZGMFX                               31750000
.*----------------------------------------------------------------***   31800000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    31850000
              AIF   (N'&ANSAREA LE 1).ZG2A      CK NUM                  31900000
&ZMS          SETC  '"ANSAREA='                 *KPOSA* MNOTE           31950000
&ZMS          SETC  '&ZMS.&ANSAREA"'                                    32000000
&ZMS          SETC  '&ZMS "ANSAREA"'                                    32050000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 32100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             32150000
.ZG2A         ANOP  ,                                                   32200000
.*-------------------------------------------------------------------   32250000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        32300000
&ZXANSAREA    SETC  'OUTPUT'    SET IN/OUTPUT                           32350000
&XANSAREA     SETC  '&ANSAREA(1)'               SET XVARIABLE           32400000
              AIF   (N'&ANSAREA GT 1).ZG2B      MULTI PARMS             32450000
&XANSAREA     SETC  '&ANSAREA'  SET XVARIABLE                           32500000
.ZG2B         AIF   (K'&ANSAREA(1) GT 0).ZG2C                           32550000
&ZXANSAREA    SETC  ''          RESET IN/OUTPUT                         32600000
&ZMS          SETC  ' '         *KRQDA*                                 32650000
&ZMS          SETC  '&ZMS "ANSAREA" KEY AND ITS ARGUMENT'               32700000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             32750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             32800000
.ZG2C         ANOP  ,                                                   32850000
.*-------------------------------------------------------------------   32900000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   32950000
              AIF   (K'&ZXANSAREA LE 0).ZG2R    NOT I/O                 33000000
              AIF   ('&XANSAREA'(1,1) NE '(').ZG2R                      33050000
&ZCGPR        SETC  '&XANSAREA'(2,K'&XANSAREA-2)                        33100000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         33150000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                33200000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              33250000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       33300000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        33350000
.ZG2P         ANOP  ,                                                   33400000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             33450000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              33500000
              AIF   ('&ZCGPR' LE '12').ZG2R                             33550000
.ZG2Q         ANOP  ,                                                   33600000
&ZMS          SETC  '"ANSAREA='                 *KGPRA* MNOTE           33650000
&ZMS          SETC  '&ZMS.&ANSAREA"'                                    33700000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           33750000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    33800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33850000
.ZG2R         ANOP  ,                                                   33900000
.*----------------------------------------------------------------***   33950000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     34000000
              AIF   (N'&ANSLEN LE 1).ZG5A       CK NUM                  34050000
&ZMS          SETC  '"ANSLEN='  *KPOSA* MNOTE                           34100000
&ZMS          SETC  '&ZMS.&ANSLEN"'                                     34150000
&ZMS          SETC  '&ZMS "ANSLEN"'                                     34200000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 34250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34300000
.ZG5A         ANOP  ,                                                   34350000
.*-------------------------------------------------------------------   34400000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         34450000
&ZXANSLEN     SETC  'INPUT'     SET IN/OUTPUT                           34500000
&XANSLEN      SETC  '&ANSLEN(1)'                SET XVARIABLE           34550000
              AIF   (N'&ANSLEN GT 1).ZG5B       MULTI PARMS             34600000
&XANSLEN      SETC  '&ANSLEN'   SET XVARIABLE                           34650000
.ZG5B         AIF   (K'&ANSLEN(1) GT 0).ZG5C                            34700000
&ZXANSLEN     SETC  ''          RESET IN/OUTPUT                         34750000
&ZMS          SETC  ' '         *KRQDA*                                 34800000
&ZMS          SETC  '&ZMS "ANSLEN" KEY AND ITS ARGUMENT'                34850000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             34900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34950000
.ZG5C         ANOP  ,                                                   35000000
.*-------------------------------------------------------------------   35050000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    35100000
              AIF   (K'&ZXANSLEN LE 0).ZG5R     NOT I/O                 35150000
              AIF   ('&XANSLEN'(1,1) NE '(').ZG5R                       35200000
&ZCGPR        SETC  '&XANSLEN'(2,K'&XANSLEN-2)                          35250000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         35300000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                35350000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              35400000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       35450000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        35500000
.ZG5P         ANOP  ,                                                   35550000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             35600000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              35650000
              AIF   ('&ZCGPR' LE '12').ZG5R                             35700000
.ZG5Q         ANOP  ,                                                   35750000
&ZMS          SETC  '"ANSLEN='  *KGPRA* MNOTE                           35800000
&ZMS          SETC  '&ZMS.&ANSLEN"'                                     35850000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           35900000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    35950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36000000
.ZG5R         ANOP  ,                                                   36050000
.*----------------------------------------------------------------***   36100000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    36150000
              AIF   (N'&QUERYLEN LE 1).ZG8A     CK NUM                  36200000
&ZMS          SETC  '"QUERYLEN='                *KPOSA* MNOTE           36250000
&ZMS          SETC  '&ZMS.&QUERYLEN"'                                   36300000
&ZMS          SETC  '&ZMS "QUERYLEN"'                                   36350000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 36400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36450000
.ZG8A         ANOP  ,                                                   36500000
.*-------------------------------------------------------------------   36550000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        36600000
&ZXQUERYLEN   SETC  'OUTPUT'    SET IN/OUTPUT                           36650000
&XQUERYLEN    SETC  '&QUERYLEN(1)'              SET XVARIABLE           36700000
              AIF   (N'&QUERYLEN GT 1).ZG8B     MULTI PARMS             36750000
&XQUERYLEN    SETC  '&QUERYLEN'                 SET XVARIABLE           36800000
.ZG8B         AIF   (K'&QUERYLEN(1) GT 0).ZG8C                          36850000
&ZXQUERYLEN   SETC  ''          RESET IN/OUTPUT                         36900000
&ZMS          SETC  ' '         *KRQDA*                                 36950000
&ZMS          SETC  '&ZMS "QUERYLEN" KEY AND ITS ARGUMENT'              37000000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             37050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37100000
.ZG8C         ANOP  ,                                                   37150000
.*-------------------------------------------------------------------   37200000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   37250000
              AIF   (K'&ZXQUERYLEN LE 0).ZG8R   NOT I/O                 37300000
              AIF   ('&XQUERYLEN'(1,1) NE '(').ZG8R                     37350000
&ZCGPR        SETC  '&XQUERYLEN'(2,K'&XQUERYLEN-2)                      37400000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         37450000
              AIF   (K'&ZCGPR GT 2).ZG8Q                                37500000
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              37550000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       37600000
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        37650000
.ZG8P         ANOP  ,                                                   37700000
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             37750000
              AIF   ('&ZCGPR' LT '2').ZG8Q                              37800000
              AIF   ('&ZCGPR' LE '12').ZG8R                             37850000
.ZG8Q         ANOP  ,                                                   37900000
&ZMS          SETC  '"QUERYLEN='                *KGPRA* MNOTE           37950000
&ZMS          SETC  '&ZMS.&QUERYLEN"'                                   38000000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           38050000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    38100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             38150000
.ZG8R         ANOP  ,                                                   38200000
.*----------------------------------------------------------------***   38250000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    38300000
              AIF   (N'&RETCODE LE 1).ZG11A     CK NUM                  38350000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           38400000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    38450000
&ZMS          SETC  '&ZMS "RETCODE"'                                    38500000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 38550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             38600000
.ZG11A        ANOP  ,                                                   38650000
.*-------------------------------------------------------------------   38700000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        38750000
              AIF   (K'&RETCODE(1) LE 0).ZG11C  NO PARM                 38800000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              38850000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           38900000
              AIF   (N'&RETCODE GT 1).ZG11C                             38950000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           39000000
.ZG11C        ANOP  ,                                                   39050000
.*-------------------------------------------------------------------   39100000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   39150000
              AIF   (K'&ZXRETCODE LE 0).ZG11R   NOT I/O                 39200000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG11R                     39250000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        39300000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                        39350000
              AIF   (K'&ZCGPR GT 2).ZG11Q                               39400000
              AIF   ('&ZCGPR' EQ '0').ZG11Q                             39450000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       39500000
              AIF   (T'&ZCGPR NE 'N').ZG11Q     INVALID REG NAME        39550000
.ZG11P        ANOP  ,                                                   39600000
              AIF   (T'&ZCGPR NE 'N').ZG11R     NON NUMERIC             39650000
              AIF   ('&ZCGPR' LT '2').ZG11Q                             39700000
              AIF   ('&ZCGPR' LE '12').ZG11R                            39750000
.ZG11Q        ANOP  ,                                                   39800000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           39850000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    39900000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           39950000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    40000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40050000
.ZG11R        ANOP  ,                                                   40100000
.*----------------------------------------------------------------***   40150000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    40200000
              AIF   (N'&RSNCODE LE 1).ZG14A     CK NUM                  40250000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           40300000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    40350000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    40400000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 40450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40500000
.ZG14A        ANOP  ,                                                   40550000
.*-------------------------------------------------------------------   40600000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        40650000
              AIF   (K'&RSNCODE(1) LE 0).ZG14C  NO PARM                 40700000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              40750000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           40800000
              AIF   (N'&RSNCODE GT 1).ZG14C                             40850000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           40900000
.ZG14C        ANOP  ,                                                   40950000
.*-------------------------------------------------------------------   41000000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   41050000
              AIF   (K'&ZXRSNCODE LE 0).ZG14R   NOT I/O                 41100000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG14R                     41150000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        41200000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                        41250000
              AIF   (K'&ZCGPR GT 2).ZG14Q                               41300000
              AIF   ('&ZCGPR' EQ '0').ZG14Q                             41350000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       41400000
              AIF   (T'&ZCGPR NE 'N').ZG14Q     INVALID REG NAME        41450000
.ZG14P        ANOP  ,                                                   41500000
              AIF   (T'&ZCGPR NE 'N').ZG14R     NON NUMERIC             41550000
              AIF   ('&ZCGPR' LT '2').ZG14Q                             41600000
              AIF   ('&ZCGPR' LE '12').ZG14R                            41650000
.ZG14Q        ANOP  ,                                                   41700000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           41750000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    41800000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           41850000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    41900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41950000
.ZG14R        ANOP  ,                                                   42000000
.******************************************************************     42050000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        42100000
.******************************************************************     42150000
              ACTR  10000                                               42200000
.*----------------------------------------------------------------***   42250000
.***AH.P02 EXTRA POSITIONALS                                            42300000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               42350000
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                42360000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            42370000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             42380000
.ZGLISTX1     ANOP  ,                                                   42390000
&ZCVAL        SETC  ''          ERROR FIELD                             42400000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       42450000
.ZGLIST2      ANOP  ,                                                   42500000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         42550000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                42600000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   42650000
              AGO   .ZGLIST2                                            42700000
.*                                                                      42750000
.ZGLIST3      ANOP  ,                                                   42800000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             42850000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           42900000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     42950000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              43000000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      43050000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              43100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             43150000
.ZGLISTX      ANOP  ,                                                   43200000
&ZASYSLNDX    SETA  0                                                   43250000
.*-------------------------------------------------------------------   43300000
.***AG.MF04 MF=(SLE)                                                    43350000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                43400000
.*******************************************************************    43450000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       43500000
.*******************************************************************    43550000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          43600000
.*******************************************************************    43650000
.***AE.01  START OF IWMPQRY MACRO CODE                                  43700000
.*******************************************************************    43750000
              LCLC  &M0M0001                 NAME                       43800000
&M0M0001      SETC  '&XLABEL'                SET NAME                   43850000
              AIF   (K'&XLABEL NE 0).XLAB2                              43900000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               43950000
.*                                                                      44000000
.XLAB2        ANOP  ,                                                   44050000
              AIF   ('&XMF' EQ 'L').XLAB3                               44075000
&M0M0001 DS    0H                             IWMPQRY-0                 44100000
.XLAB3        ANOP  ,                                                   44125000
.*******************************************************************    44150000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              44200000
.*******************************************************************    44250000
              PUSH  PRINT                                               44300000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          44350000
              PRINT OFF         ++ PR01                                 44400000
              AGO   .ZPRNTXX                                            44450000
.ZPRINTX      PRINT ON                                                  44500000
.ZPRNTXX      ANOP  ,                                                   44550000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  44600000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  44650000
.********************************************************************   44700000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     44750000
.********************************************************************   44800000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       44850000
                      LCLA  &ZOPN1         INVOCATION INDEX             44900000
                      LCLC  &ZOPL(4095)    LABEL                        44950000
                      LCLC  &ZOPO(4095)    OPERATION                    45000000
                      LCLC  &ZOPV(4095)    VALUE                        45050000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  45100000
.*                                                                      45150000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     45200000
.******************************************************************     45250000
.***AL.L10 IWMPQRY FMT=LIST MF=S|L PARAMETERS                           45300000
.******************************************************************     45350000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     45400000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     45450000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     45500000
&XMFATTR              SETC  '0D'                                        45550000
.*                                                                      45600000
&ZOPN                 SETA  &ZOPN+1                                     45650000
&ZOPL(&ZOPN)          SETC  ' '                                         45700000
&ZOPO(&ZOPN)          SETC  'B'                                         45750000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                45800000
&ZOPD(&ZOPN)          SETC  '++ IWMPQRY ARG PARMS'                      45850000
.*                                                                      45900000
&ZOPN                 SETA  &ZOPN+1                                     45950000
&ZOPL(&ZOPN)          SETC  ' '                                         46000000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     46050000
&ZOPV(&ZOPN)          SETC  '1'                                         46100000
&ZOPD(&ZOPN)          SETC  ' '                                         46150000
.*                                                                      46200000
.ZLMFSL2              ANOP  ,                                           46250000
.*-------------------------------------------------------------------   46255000
.***AM.L00  IWMPQRY FMT=LIST name                                       46260000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    46265000
&ZOPN                 SETA &ZOPN+1                                      46270000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   46275000
&ZOPO(&ZOPN)          SETC 'EQU'                                        46280000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   46285000
&ZOPD(&ZOPN)          SETC '++ IWMPQRY NAME'                            46290000
.ZLMFSL2M             ANOP  ,                                           46295000
.*-------------------------------------------------------------------   46300000
.***AM.L01  IWMPQRY FMT=LIST PARAMETERS                                 46350000
&ZOPN                 SETA &ZOPN+1                                      46400000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   46450000
&ZOPO(&ZOPN)          SETC 'DS'                                         46500000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   46550000
&ZOPD(&ZOPN)          SETC '++ IWMPQRY PARM LIST'                       46600000
.*-------------------------------------------------------------------   46650000
.***AM.L02 XVERSION XL1                                                 46700000
&ZOPN                 SETA &ZOPN+1                                      46750000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         46800000
&ZOPO(&ZOPN)          SETC 'DS'                                         46850000
&ZOPV(&ZOPN)          SETC 'XL1'                                        46900000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          46950000
.*-------------------------------------------------------------------   47000000
.***AM.L09  XRSV0001 CL3                                                47050000
&ZOPN                 SETA &ZOPN+1                                      47100000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         47150000
&ZOPO(&ZOPN)          SETC 'DS'                                         47200000
&ZOPV(&ZOPN)          SETC 'CL3'                                        47250000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      47300000
.*-------------------------------------------------------------------   47350000
.***AM.L09 ADDR XANSAREA A                                              47400000
&ZOPN                 SETA &ZOPN+1                                      47450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ADDR'                    47500000
&ZOPO(&ZOPN)          SETC 'DS'                                         47550000
&ZOPV(&ZOPN)          SETC 'A'                                          47600000
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ADDR XANSAREA'                47650000
.*-------------------------------------------------------------------   47700000
.***AM.L09 ALET XANSAREA F                                              47750000
&ZOPN                 SETA &ZOPN+1                                      47800000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ALET'                    47850000
&ZOPO(&ZOPN)          SETC 'DS'                                         47900000
&ZOPV(&ZOPN)          SETC 'F'                                          47950000
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ALET XANSAREA'                48000000
.*-------------------------------------------------------------------   48050000
.***AM.L09  XANSLEN F                                                   48100000
&ZOPN                 SETA &ZOPN+1                                      48150000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          48200000
&ZOPO(&ZOPN)          SETC 'DS'                                         48250000
&ZOPV(&ZOPN)          SETC 'F'                                          48300000
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN  XANSLEN'                      48350000
.*-------------------------------------------------------------------   48400000
.***AM.L09  XQUERYLEN F                                                 48450000
&ZOPN                 SETA &ZOPN+1                                      48500000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQUERYLEN'                        48550000
&ZOPO(&ZOPN)          SETC 'DS'                                         48600000
&ZOPV(&ZOPN)          SETC 'F'                                          48650000
&ZOPD(&ZOPN)          SETC '++ &ZXQUERYLEN  XQUERYLEN'                  48700000
.*-------------------------------------------------------------------   48750000
.***AM.L09  XRSV0014 CL4                                                48800000
&ZOPN                 SETA &ZOPN+1                                      48850000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0014'                         48900000
&ZOPO(&ZOPN)          SETC 'DS'                                         48950000
&ZOPV(&ZOPN)          SETC 'CL4'                                        49000000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0014'                      49050000
.*-------------------------------------------------------------------   49100000
.***AM.L10 END OF IWMPQRY LIST PARAMETERS                               49150000
&ZOPN                 SETA &ZOPN+1                                      49200000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 49250000
&ZOPO(&ZOPN)          SETC 'EQU'                                        49300000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 49350000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         49400000
.*                                                                      49450000
&ZOPN                 SETA &ZOPN+1                                      49500000
&ZOPL(&ZOPN)          SETC ' '                                          49550000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      49600000
&ZOPV(&ZOPN)          SETC '1'                                          49650000
&ZOPD(&ZOPN)          SETC ' '                                          49700000
.*-------------------------------------------------------------------   49750000
.***AL.L12 IWMPQRY FMT=LIST MF=S|L PARAMETERS                           49800000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         49850000
.*                                                                      49900000
&ZOPN                 SETA  &ZOPN+1                                     49950000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                50000000
&ZOPO(&ZOPN)          SETC  'DC'                                        50050000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   50100000
&ZOPD(&ZOPN)          SETC  '++ IWMPQRY ARG PARMS'                      50150000
.*                                                                      50200000
.ZLMFSLX              ANOP  ,                                           50250000
.*-------------------------------------------------------------------   50300000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          50350000
&ZPLLEN               SETA 24                                           50400000
.*                                                                      50450000
.******************************************************************     50500000
.***AI.L01 IWMPQRY FMT=LIST FILL IN PARAMETER AREA                      50550000
.******************************************************************     50600000
                      ACTR  10000                                       50650000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               50700000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    50750000
&ZCVAL                SETC  'LAE'          XAX MODE                     50800000
.ZIMFXA               ANOP ,                                            50850000
.*                                                                      50900000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    50950000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         51000000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 51050000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                51100000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 51150000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                51200000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   51250000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    51300000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   51350000
&ZOPN                 SETA  &ZOPN+1                                     51400000
&ZOPL(&ZOPN)          SETC  ' '                                         51450000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    51500000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              51550000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       51600000
                      AGO   .ZIMFNX                                     51650000
.*                                                                      51700000
.ZIMFN2               ANOP ,                                            51750000
&ZOPN                 SETA  &ZOPN+1                                     51800000
&ZOPL(&ZOPN)          SETC  ' '                                         51850000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    51900000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                51950000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       52000000
.ZIMFNX               ANOP ,                                            52050000
.********************************************************************   52100000
.***AI.L02 IWMPQRY FMT=LIST INITIALIZE PARAMETER AREA                   52150000
.********************************************************************   52200000
.***AI.L03 MF=(SLE)                                                     52250000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      52300000
.*                                                                      52350000
&ZOPN                 SETA  &ZOPN+1                                     52400000
&ZOPL(&ZOPN)          SETC  ' '                                         52450000
&ZOPO(&ZOPN)          SETC  'XC'                                        52500000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         52550000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             52600000
.ZIMFLX               ANOP  ,                                           52650000
.*-------------------------------------------------------------------   52700000
.***AI.L19 ADDR XANSAREA A                                              52750000
                      AIF   ('&ZXANSAREA' EQ '').ZI3H                   52800000
&ZCLNG                SETC  '&XANSAREA'                                 52850000
&ZCGPR                SETC  '14'                                        52900000
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI3F  IN GPR                   52950000
.*                                                                      53000000
&ZOPN                 SETA  &ZOPN+1                                     53050000
&ZOPL(&ZOPN)          SETC  ' '                                         53100000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    53150000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             53200000
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    53250000
.*                                                                      53300000
                      AGO   .ZI3G                                       53350000
.*                                                                      53400000
.ZI3F                 ANOP  ,                                           53450000
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             53500000
.*                                                                      53550000
.ZI3G                 ANOP  ,                                           53600000
.*                                                                      53650000
&ZOPN                 SETA  &ZOPN+1                                     53700000
&ZOPL(&ZOPN)          SETC  ' '                                         53750000
&ZOPO(&ZOPN)          SETC  'ST'                                        53800000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              53850000
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    53900000
.*                                                                      53950000
.ZI3H                 ANOP  ,                                           54000000
.*-------------------------------------------------------------------   54050000
.***AI.L23 ALET XANSAREA F                                              54100000
         AIF   ('&ZXANSAREA' EQ '').ZI4G                                54150000
         AIF   ('&SYSASCE' EQ 'P').ZI4G    SYSSTATE PRIMARY             54200000
&ZCLNG                SETC  '&XANSAREA'                                 54250000
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI4E  IN AR                    54300000
.*                                                                      54350000
&ZCGPR                SETC  '14'                                        54400000
                      AGO   .ZI4F                                       54450000
.*                                                                      54500000
.ZI4E                 ANOP  ,                                           54550000
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             54600000
.*                                                                      54650000
.ZI4F                 ANOP  ,                                           54700000
.*                                                                      54750000
&ZOPN                 SETA  &ZOPN+1                                     54800000
&ZOPL(&ZOPN)          SETC  ' '                                         54850000
&ZOPO(&ZOPN)          SETC  'STAM'                                      54900000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,8(1)'                        54950000
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    55000000
.*                                                                      55050000
.ZI4G                 ANOP  ,                                           55100000
.*-------------------------------------------------------------------   55150000
.***AI.L25  XANSLEN F                                                   55200000
                      AIF   ('&ZXANSLEN' EQ '').ZI5E                    55250000
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI5E              55300000
&ZCGPR                SETC  '&XANSLEN'                                  55350000
.*                                                                      55400000
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI5B               55450000
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      55500000
                      AGO   .ZI5D                                       55550000
.ZI5B                 ANOP  ,                                           55600000
.*                                                                      55650000
&ZC                   SETC  '&XANSLEN'(1,1)                             55700000
                      AIF   (T'&ZC NE 'N').ZI5D                         55750000
&ZC                   SETC  '&XANSLEN'                                  55800000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                55850000
&ZCGPR                SETC  '=FL4''&XANSLEN'''                          55900000
.*                                                                      55950000
.ZI5D                 ANOP  ,                                           56000000
.*                                                                      56050000
&ZOPN                 SETA  &ZOPN+1                                     56100000
&ZOPL(&ZOPN)          SETC  ' '                                         56150000
&ZOPO(&ZOPN)          SETC  'MVC'                                       56200000
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            56250000
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      56300000
.*                                                                      56350000
.ZI5E                 ANOP  ,                                           56400000
.*-------------------------------------------------------------------   56450000
&ZOPN1                SETA &ZOPN                                        56500000
.*******************************************************************    56550000
.***  PROCESS IWMPQRY OUTPUT PARAMETERS                                 56600000
.*******************************************************************    56650000
                      ACTR  10000                                       56700000
.*------------------------------------------------------------------    56750000
.***AO.L02 XQUERYLEN F                                                  56800000
         AIF   ('&ZXQUERYLEN' EQ 'OUTPUT').ZO6A  OUTPUT                 56850000
         AIF   ('&ZXQUERYLEN' NE 'INOUT').ZO6C  INOUT                   56900000
.ZO6A    AIF   ('&XQUERYLEN'(1,1) NE '(').ZO6B  ADDR IN GPR             56950000
&ZCGPR   SETC  '&XQUERYLEN'(2,K'&XQUERYLEN-2)                           57000000
&ZOPN                 SETA  &ZOPN+1                                     57050000
&ZOPL(&ZOPN)          SETC  ' '                                         57100000
&ZOPO(&ZOPN)          SETC  'MVC'                                       57150000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),16(1)'                         57200000
&ZOPD(&ZOPN)          SETC  '++ XQUERYLEN F'                            57250000
                      AGO   .ZO6C                                       57300000
.*                                                                      57350000
.ZO6B                 ANOP  ,                                           57400000
&ZAWRK   SETA  K'&XQUERYLEN                                             57450000
         AIF   ('&XQUERYLEN'(&ZAWRK,1) NE ')').ZO6G                     57500000
&ZN      SETA  2                                                        57550000
.ZO6H    ANOP                                                           57600000
         AIF   (&ZN GE &ZAWRK).ZO6G                                     57650000
         AIF   ('&XQUERYLEN'(&ZN,1) NE '(').ZO6I                        57700000
&ZC      SETC  '&XQUERYLEN'(1,&ZN).'4'.','                              57750000
&ZC      SETC  '&ZC'.'&XQUERYLEN'(&ZN+1,&ZAWRK-&ZN).',16(1)'            57800000
         AGO   .ZO6J                                                    57850000
.ZO6I    ANOP                                                           57900000
&ZN      SETA  &ZN+1                                                    57950000
         AGO   .ZO6H                                                    58000000
.ZO6G    ANOP                                                           58050000
&ZC      SETC  '&XQUERYLEN.(4),16(1)'                                   58100000
.ZO6J    ANOP                                                           58150000
&ZOPN                 SETA  &ZOPN+1                                     58200000
&ZOPL(&ZOPN)          SETC  ' '                                         58250000
&ZOPO(&ZOPN)          SETC  'MVC'                                       58300000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       58350000
&ZOPD(&ZOPN)          SETC  '++ XQUERYLEN F'                            58400000
.ZO6C                 ANOP  ,                                           58450000
.*******************************************************************    58500000
.***AO.X02  RETURN CODE PROCESSING                                      58550000
.*******************************************************************    58600000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    58650000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            58700000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             58750000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             58800000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               58850000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                58900000
&ZOPN                 SETA  &ZOPN+1                                     58950000
&ZOPL(&ZOPN)          SETC  ' '                                         59000000
&ZOPO(&ZOPN)          SETC  'ST'                                        59050000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              59100000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        59150000
                      AGO   .ZMRETX                                     59200000
.*                                                                      59250000
.ZMRET2               ANOP  ,                                           59300000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                59350000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                59400000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                59450000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  59500000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   59550000
&ZOPN                 SETA  &ZOPN+1                                     59600000
&ZOPL(&ZOPN)          SETC  ' '                                         59650000
&ZOPO(&ZOPN)          SETC  'LR'                                        59700000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 59750000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        59800000
.ZMRETX               ANOP  ,                                           59850000
.*******************************************************************    59900000
.***AO.X03  REASON CODE PROCESSING                                      59950000
.*******************************************************************    60000000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    60050000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            60100000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              60150000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             60200000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              60250000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             60300000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                60350000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 60400000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                60450000
&ZOPN                 SETA  &ZOPN+1                                     60500000
&ZOPL(&ZOPN)          SETC  ' '                                         60550000
&ZOPO(&ZOPN)          SETC  'ST'                                        60600000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               60650000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        60700000
                      AGO   .ZMRSNX                                     60750000
.*                                                                      60800000
.ZMRSN2               ANOP  ,                                           60850000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                60900000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 60950000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                61000000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 61050000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                61100000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   61150000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    61200000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   61250000
&ZOPN                 SETA  &ZOPN+1                                     61300000
&ZOPL(&ZOPN)          SETC  ' '                                         61350000
&ZOPO(&ZOPN)          SETC  'LR'                                        61400000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  61450000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        61500000
.ZMRSNX               ANOP  ,                                           61550000
.*******************************************************************    61600000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   61650000
.*******************************************************************    61700000
.ZMFLX                ANOP  ,              MF=L PROCESSING              61750000
.*******************************************************************    61800000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               61850000
.*******************************************************************    61900000
                      ACTR  10000                                       61950000
.*                                                                      62000000
                      LCLA  &ZLC           COLUMN POSITION              62050000
                      LCLA  &ZOPX          LIST TABLE INDEX             62100000
                      LCLC  &ZLL           LABEL                        62150000
                      LCLC  &ZLOP          OPERATION                    62200000
                      LCLC  &ZLV           VALUE                        62250000
                      LCLC  &ZLD           DESCRIPTION                  62300000
.*                                                                      62350000
&ZOPX                 SETA  1                                           62400000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            62450000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              62500000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              62550000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              62600000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              62650000
                      AIF   (K'&ZLD LE 0).ZL5                           62700000
&ZLC                  SETA  35             COMMENT COLUMN               62750000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    62800000
&ZLC                  SETA  33             COMMMENT COLUMN              62850000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   62900000
&ZLV                  SETC  '&ZLV'.' '                                  62950000
                      AGO   .ZL3                                        63000000
.*                                                                      63050000
.ZL4                  ANOP  ,                                           63100000
&ZLV                  SETC  '&ZLV'.' '                                  63150000
.ZL5                  ANOP  ,                                           63200000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               63250000
.*                                                                      63300000
&ZLL     &ZLOP &ZLV                                                     63350000
.*                                                                      63400000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               63450000
                      AGO   .ZL2           CONTINUE LOOPING             63500000
.*                                                                      63550000
.ZLX                  ANOP  ,                                           63600000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                63650000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  63700000
         L     14,16(0,0)              GET CVT ADDRESS                  63750000
         AIF   ('&SYSASCE' EQ 'P').NOAR    CHECK FOR AR MODE CALLERS    63762500
         LAE   14,0(14,0)              CLEAR AR 14                      63775000
.NOAR    ANOP                                                           63787500
         TM    CVTOSLV1-CVT(14),X'40'      TEST FOR WLM PRESENCE        63800000
         BO    WLM&SYSNDX              BRANCH WHEN WLM IS PRESENT       63850000
         LA    0,IWMRSNCODENOWLM       SET REASON CODE = NO WLM         63900000
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          63950000
         B     END&SYSNDX              BRANCH TO END LABEL              64000000
WLM&SYSNDX DS    0H                    BRANCH LABEL FOR WLM PRESENT     64050000
         L     14,772(14,0)            GET SFT ADDRESS                  64100000
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       64150000
         LA    15,9                    GET EX FOR SERVICE ROUTINE       64200000
         OR    14,15                   GET PC NUMBER                    64250000
         PC    0(14)                                                    64300000
END&SYSNDX DS    0H                    END LABEL                        64350000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  64400000
.ZLINKX               ANOP  ,                                           64450000
.*******************************************************************    64500000
.***AP.X01  FORMAT GENERATED CODE                                       64550000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            64600000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              64650000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              64700000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              64750000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              64800000
                      AIF   (K'&ZLD LE 0).ZL51                          64850000
&ZLC                  SETA  35             COMMENT COLUMN               64900000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   64950000
&ZLC                  SETA  33             COMMENT COLUMN               65000000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  65050000
&ZLV                  SETC  '&ZLV'.' '                                  65100000
                      AGO   .ZL31                                       65150000
.*                                                                      65200000
.ZL41                 ANOP  ,                                           65250000
&ZLV                  SETC  '&ZLV'.' '                                  65300000
.ZL51                 ANOP  ,                                           65350000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               65400000
.*                                                                      65450000
&ZLL     &ZLOP &ZLV                                                     65500000
.*                                                                      65550000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               65600000
                      AGO   .ZL21          CONTINUE LOOPING             65650000
.*                                                                      65700000
.ZLX1                 ANOP  ,                                           65750000
.*******************************************************************    65800000
.***AP.X02  END OF IWMPQRY MACRO                                        65850000
&ZIWMPQRY             SETC  'YES'          SET IWMPQRY USED             65900000
         POP   PRINT                                                    65950000
*                                            IWMPQRY-0                  66000000
         SPACE 1                                                        66050000
.ZLX2                 ANOP  ,                                           66100000
         MEND                                                           66150000
**********************************************************************/ 66200000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  66250000
*%IWMPQRY: MACRO KEYS(ANSAREA,ANSLEN,QUERYLEN,RETCODE,RSNCODE,          66283300
*                 PLISTVER,MF);                                         66316600
*  ANS('?'||MACLABEL||' '||'IWMPQRYP '||MACLIST||                       66350000
*         ' '||MACKEYS||';') COL(MACLMAR);                              66400000
*%END IWMPQRY;                                                          66450000
