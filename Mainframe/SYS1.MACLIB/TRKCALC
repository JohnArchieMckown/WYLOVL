         MACRO                                                          00050000
&NAME    TRKCALC &FUNCTN=,&DEVTAB=,&TYPE=,&UCB=,&BALANCE=,&REMOVE=,    C00100000
               &MAXSIZE=,&REGSAVE=,&RKDD=,&R=,&K=,&DD=,&LAST=,     @L1CC00133300
               &LOC=BELOW,&MF=I                                    @L1A 00166600
.***** START OF SPECIFICATIONS **************************************** 00200000
.*                                                                      00250000
.* MODULE NAME - TRKCALC                                                00300000
.*                                                                      00350000
.* DESCRIPTIVE NAME -                                                   00400000
.*      SYSTEM TRACK ALGORITHM ROUTINE (STAR) SERVICE MACRO             00450000
.*                                                                      00500000
.*                                                                      00510000
.*PROPRIETARY V3 STATEMENT                                              00520000
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00530000
.*"RESTRICTED MATERIALS OF IBM"                                         00540000
.*5695-DF1                                                              00550000
.*(C) COPYRIGHT 1992  IBM CORP.                                         00560000
.*END PROPRIETARY V3 STATEMENT                                          00575000
.*                                                                      00590000
.*                                                                      00600000
.* STATUS - NEW                                                         00650000
.*                                                                      00700000
.* FUNCTION -                                                           00750000
.*    THIS MACRO, DEPENDING ON THE VALUE OF THE "MF" PARAMETER,         00800000
.*    PERFORMS ONE OF FOUR BASIC FUNCTIONS RELATED TO ESTABLISHING      00850000
.*    OR MAPPING THE INPUT PARAMETER LIST FOR THE SYSTEM TRACK          00900000
.*    ALGORITHM ROUTINE (STAR). THE FOUR FUNCTIONS ARE DESCRIBED        00950000
.*    BELOW:                                                            01000000
.*                                                                      01050000
.*    MF=I - DEFAULT - WITH A SPECIFICATION OF MF=I, THIS MACRO         01100000
.*       WILL ALLOCATE STORAGE FOR THE STAR PARAMETER LIST AND          01150000
.*       INITIALIZE IT ACCORDING TO THE OPTIONS SELECTED VIA THE        01200000
.*       ALLOWABLE KEYWORDS (SEE BELOW FOR KEYWORD DESCRIPTIONS).       01250000
.*       THIS IS CALLED THE STANDARD-FORM (INSTRUCTION FORMAT) OF       01300000
.*       THE MACRO.                                                     01350000
.*    MF=E - THIS SPECIFICATION WILL RESULT IN THE INITIALIZATION       01400000
.*       OF AN ALREADY EXISTING STAR PARAMETER LIST. THE ADDRESS        01450000
.*       OF THE EXISTING PARAMETER LISTS IS PROVIDED VIA A SECOND       01500000
.*       SUBPARAMETER OF THE "MF" KEYWORD. (SEE THE SECTION BELOW       01550000
.*       ON KEYWORDS FOR THE SOURCE OF THE INITIALIZATION DATA).        01600000
.*       THIS IS CALLED THE EXECUTE-FORM OF THE MACRO.                  01650000
.*                                                                      01700000
.*    NOTE - NO KEYWORDS ARE PROCESSED FOR THE FOLLOWING MACRO FORMS.   01750000
.*                                                                      01800000
.*    MF=L - THIS SPECIFICATION WILL RESULT IN THE ALLOCATION           01850000
.*       OF THE STAR PARAMETER LIST WITHOUT INITIALIZATION. THIS IS     01900000
.*       CALLED THE LIST-FORM OF THE MACRO.                             01950000
.*    MF=D - THIS SPECIFICATION WILL RESULT IN THE GENERATION OF A      02000000
.*       MAPPING OF THE SYMBOLS USED TO ADDRESS THE FIELDS AND          02050000
.*       FLAGS OF THE STAR PARAMETER LIST. THE CALLER MUST PROVIDE      02100000
.*       A "DSECT" STATEMENT IN ORDER TO OBTAIN SYMBOLIC ADDRESSING     02150000
.*       WITHOUT STORAGE ALLOCATION. THIS IS CALLED THE DSECT-FORM      02200000
.*       OF THE MACRO.                                                  02250000
.*                                                                      02300000
.*    KEYWORDS- (APPLICABLE ONLY FOR MF=I AND MF=E FORMS)               02350000
.*       FUNCTN - USED TO REQUEST TRACK BALANCE (TRKBAL) OR TRACK       02400000
.*          CAPACITY (TRKCAP) FUNCTIONS.                                02450000
.*       NOTE 1 - A SPECIAL OPTION IS PROVIDED TO ALLOW A TRKCALC CALL  02500000
.*                WITH THE 'FUNCTN' KEYWORD OMITTED. THIS OPTION IS     02550000
.*                ALLOWED ONLY IF THE KEYWORD MF=E IS CODED. IF THE     02600000
.*                'FUNCTN' KEYWORD IS OMITTED, NO INSTRUCTION WILL BE   02650000
.*                GENERATED TO SET THE PARAMETER LIST FLAGS. THUS,      02700000
.*                THE MUTUALLY EXCLUSIVE TEST FOR FUNCTN=TRKCAP AND     02750000
.*                REMOVE=YES, MAXSIZE=YES, AND LAST=YES IS BYPASSED.    02800000
.*                ALSO, THE FOLLOWING NOTE (2) DOES NOT APPLY.          02850000
.*       NOTE 2 - ONE OF THE FOLLOWING THREE KEYWORDS (DEVTAB,          02900000
.*                TYPE, OR UCB) MUST BE PROVIDED WHEN THE 'FUNCTN'      02950000
.*                KEYWORD IS CODED. THIS IS TO ENSURE A SOURCE FOR THE  03000000
.*                DEVICE CHARACTERISTICS TABLE. IF THE PARAMETER LIST   03050000
.*                HAS BEEN PREVIOUSLY SET WITH A SOURCE, THEN AN '*'    03100000
.*                SHOULD BE CODED AS THE INPUT VALUE FOR THE PROPER     03150000
.*                SOURCE KEYWORD. THIS WILL RESULT IN THE PROPER SOURCE 03200000
.*                FLAG SETTING WITHOUT ACTUALLY GENERATING THE CODE TO  03250000
.*                STORE THE DVCT.                                       03300000
.*       DEVTAB - USED TO SUPPLY THE ADDRESS OF THE DEVICE CHARACTER-   03350000
.*          ISTICS TABLE ENTRY.  SEE THE LOC= PARAMETER.           @L1C 03400000
.*       TYPE - USED TO SUPPLY THE UCB DEVICE TYPE VIA THE LOW ORDER    03450000
.*          BYTE OF A REGISTER OR AN ADDRESS. UCB TYPE IS USED BY STAR  03500000
.*          TO FIND THE DEVICE CHARACTERISTICS TABLE ENTRY.             03550000
.*       UCB - USED TO PROVIDE THE ADDRESS OF THE UCB. STAR WILL        03600000
.*          EXTRACT THE DEVICE TYPE TO FIND THE PROPER DEVICE CHAR-     03650000
.*          ACTERISTICS TABLE ENTRY.  SEE THE LOC= PARAMETER.      @L1C 03666600
.*       LOC - SPECIFIES WHETHER THE DEVTAB OR UCB ADDRESS         @L1A 03683200
.*          IS ABOVE OR BELOW THE LINE.  THE VALUES ARE BELOW OR   @L1A 03699800
.*          ANY, DEFAULT IS BELOW.  IF THE CALLER IS IN 24 BIT     @L1A 03716400
.*          MODE, THIS PARAMETER IS IGNORED AND DEFAULT TO BELOW.  @L1A 03733000
.*       BALANCE - USED TO PROVIDE THE ADDRESS OF A TRACK BALANCE TO BE 03750000
.*          USED BY STAR IN THE CAPACITY AND BALANCE ALGORITHMS.        03800000
.*       RKDD - USED TO SUPPLY THE ADDRESS OF A FULL WORD CONTAINING    03850000
.*          A RECORD NUMBER, KEY LENGTH, AND DATA LENGTH OR TO DESIG-   03900000
.*          NATE A REGISTER CONTAINING SAME. THE FOLLOWING THREE KEY-   03950000
.*          WORDS SUPPLY THE SAME DATA, BUT FROM SEPARATE SOURCES.      04000000
.*                                                                      04050000
.*       NOTE - THE FOLLOWING THREE KEYWORDS PROVIDE THE CAPABILITY     04100000
.*              FOR THE CALLER TO CODE THE RECORD NUMBER, KEY LENGTH,   04150000
.*              AND DATA LENGTH AS SELF-DEFINING DECIMAL VALUES         04200000
.*              (REFERRED TO HERE AS IMMEDITATE DATA).                  04250000
.*                                                                      04300000
.*       R - USED TO PROVIDE THE SUBJECT RECORD NUMBER VIA THE LOW-     04350000
.*           ORDER BYTE OF A REGISTER, A STORAGE ADDRESS, OR IMMEDIATE  04400000
.*           DATA.                                                      04450000
.*       K - USED TO PROVIDE THE SUBJECT KEY LENGTH VIA THE LOW-ORDER   04500000
.*           BYTE OF A REGISTER, A STORAGE ADDRESS, OR IMMEDIATE        04550000
.*           DATA.                                                      04600000
.*       DD - USED TO PROVIDE THE SUBJECT DATA LENGTH VIA THE LOW-ORDER 04650000
.*           BYTE OF A REGISTER, A STORAGE ADDRESS, OR IMMEDIATE        04700000
.*           DATA.                                                      04750000
.*                                                                      04800000
.*       NOTE - THE FOLLOWING THREE KEYWORDS (REMOVE, MAXSIZE, AND      04850000
.*              LAST) ARE VALID ONLY WHEN 'FUNCTN=TRKBAL' IS CODED.     04900000
.*              THEY ARE IGNORED IF 'FUNCTN' IS OMITTED.                04950000
.*                                                                      05000000
.*       REMOVE - USED TO OPTIONALLY REQUEST THE DELETION OF A RECORD   05050000
.*          DURING A TRACK BALANCE REQUEST.                             05100000
.*       MAXSIZE - USED TO OPTIONALLY REQUEST A COUNT OF THE RESIDUAL   05150000
.*          DATA BYTES ON A TRACK AFTER IT IS FOUND THAT ANOTHER WHOLE  05200000
.*          RECORD WILL NOT FIT DURING A TRACK BALANCE REQUEST.         05250000
.*       LAST - A SPECIAL OPTION MADE AVAILABLE FOR ISAM. IF SPECIFIED, 05300000
.*          THE OVERHEAD FOR THE LAST RECORD IS USED IN CALCULATING     05350000
.*          A NEW TRACK BALANCE.                                        05400000
.*       REGSAVE - USED TO OPTIONALLY REQUEST SAVING AND RESTORING      05450000
.*          REGISTERS 1 - 14 ACROSS THE INVOCATION OF STAR.             05500000
.*       MF - USED TO SPECIFY WHICH FORM OF THE TRKCALC MACRO IS        05550000
.*          DESIRED. SEE OPENING PARAGRAPH ABOVE.                       05600000
.*                                                                      05650000
.*    INTERNAL PROCESSING FOR THE I AND E FORMS OF THE MACRO IS         05700000
.*    CONTROLLED BY A NUMBER OF LOCAL BINARY AND CHARACTER              05750000
.*    VARIABLES. THE L AND D FORMS OF THE MACRO ARE HANDLED BY          05800000
.*    DIRECT PATHS THROUGH THE MACRO AND AS SUCH DO NOT INVOLVE THE     05850000
.*    USE OF LOCAL VARIABLES. FOLLOWING ARE THE DESCRIPTIONS OF THE     05900000
.*    THE LOCAL VARIABLES USED FOR THE I AND E FORMS:                   05950000
.*                                                                      06000000
.*    LCLC'S -                                                          06050000
.*       &FUNFLG - 'B' = TRKBAL FUNCTION REQUESTED                      06100000
.*               - 'C' = TRKCAP FUNCTION REQUESTED                      06150000
.*               - (OMITTED) = USE FUNCTION FLAGS FROM LAST CALL        06200000
.*       &SAVAREA - 'NO' = DON'T SAVE AND RESTORE REGISTERS             06250000
.*                  'YES' = SAVE AND RESTORE REGISTERS                  06300000
.*       &SET(1) - DVCT SOURCE WITH POSSIBLE PARENTHESES REMOVED: DVCT  06350000
.*                 ADDRESS, UCB ADDRESS, OR DEVICE TYPE (ADDRESS        06400000
.*                 OR IMMEDIATE DATA)                                   06450000
.*       &SET(2) - RKDD PARAMETER VALUE WITH POSSIBLE PARENTHESES       06500000
.*                 REMOVED                                              06550000
.*       &SET(3) - R PARAMETER VALUE WITH POSSIBLE PARENTHESES REMOVED  06600000
.*       &SET(4) - K PARAMETER VALUE WITH POSSIBLE PARENTHESES REMOVED  06650000
.*       &SET(5) - DD PARAMETER VALUE WITH POSSIBLE PARENTHESES REMOVED 06700000
.*       &SET(6) - BALANCE PARAMETER VALUE WITH POSSIBLE PARENTHESES    06750000
.*                 REMOVED                                              06800000
.*       &SKIP - 'P3' = RKDD PARAMETER NOT SPECIFIED                    06850000
.*       &FLGA(1) - 'R' = &SET(1) (DVCT SOURCE PARAMETER) IS IN         06900000
.*                        REGISTER FORMAT                               06950000
.*                - 'A' = &SET(1) (DVCT SOURCE PARAMETER) IS IN ADDRESS 07000000
.*                        FORMAT                                        07050000
.*       &FLGA(2) - 'R' = RKDD PARAMETER IS IN REGISTER FORMAT          07100000
.*                - 'A' = RKDD PARAMETER IS IN ADDRESS FORMAT           07150000
.*       &FLGA(3) - 'R' = BALANCE PARAMETER IS IN REGISTER OR IMMED-    07200000
.*                        IATE DATA FORMAT                              07250000
.*                - 'A' = BALANCE PARAMETER IS IN ADDRESS FORMAT        07300000
.*       &FLGA(4) - 'R' = R PARAMETER IS IN REGISTER FORMAT             07350000
.*       &FLGA(5) - 'R' = K PARAMETER IS IN REGISTER FORMAT             07400000
.*       &FLGA(6) - 'R' = DD PARAMETER IS IN REGISTER FORMAT            07450000
.*       &LABEL - AID TO VARIABLE LABEL ASSIGNMENT                      07500000
.*       &BITS - USED TO COLLECT BIT SWITCHES FOR STAR PARM FLAGS       07550000
.*                                                                      07600000
.*    LCLB'S                                                            07650000
.*       &BIT(1) - 0 = TRKBAL REQUESTED OR FUNCTN WAS OMITTED           07700000
.*               - 1 = TRKCAP REQUESTED                                 07750000
.*       &BIT(2) - 0 = REMOVE OPTION NOT REQUESTED                      07800000
.*               - 1 = REMOVE OPTION REQUESTED                          07850000
.*       &BIT(3) - 0 = MAXSIZE OPTION NOT REQUESTED                     07900000
.*               - 1 = MAXSIZE OPTION REQUESTED                         07950000
.*       &BIT(4) - 0 = BALANCE NOT PROVIDED CALLER                      08000000
.*               - 1 = BALANCE PROVIDED BY CALLER                       08050000
.*       &BIT(5) - 0 = LAST OPTION NOT REQUESTED                        08100000
.*               - 1 = LAST OPTION REQUESTED                            08150000
.*       &BIT(6&7) - 00 = DVCT ENTRY ADDRESS PROVIDED                   08200000
.*                   01 = NOT USED                                      08250000
.*                   10 = UCB ADDRESS PROVIDED                          08300000
.*                   11 = DEVICE TYPE (ADDRESS OR IMMEDIATE) PROVIDED   08350000
.*       &BIT(8) - 0 = LOC=BELOW OR OMITTED                        @L1A 08366600
.*                 1 = LOC=ANY SPECIFIED                           @L1A 08383200
.*       &QUIT - 0 = SUCCESSFUL PARAMETER LIST CONSTRUCTION             08400000
.*             - 1 = ERRORS DETECTED. DO NOT GENERATE ANY CODE          08450000
.*       &MSG - 0 = NO INFORMATION/WARNING MESSAGES ISSUED              08500000
.*              1 = INFORMATION/WARNING MESSAGES ISSUED                 08550000
.*                                                                      08600000
.* NOTES - N/A                                                          08650000
.*                                                                      08700000
.* MODULE TYPE - MACRO                                                  08750000
.*                                                                      08800000
.* ENTRY POINT - N/A                                                    08850000
.*                                                                      08900000
.* INPUT - SEE DESCRIPTION OF KEYWORDS UNDER "FUNCTION".                08950000
.*                                                                      09000000
.* OUTPUT - SEE OPENING PARAGRAPH UNDER "FUNCTION".                     09050000
.*                                                                      09100000
.* EXIT, NORMAL - RETURN TO CALLER WITH A SEVERITY CODE OF 0            09150000
.*                                                                      09200000
.* EXIT, ERROR - RETURN TO CALLER WITH A SEVERITY CODE OF:              09250000
.*                  4 - IF ASSUMPTIONS HAD TO BE MADE REGARDING         09300000
.*                      KEYWORD VALUES.                                 09350000
.*                  8 - IF UNRECOVERABLE ERRORS ARE DETECTED.           09400000
.*                                                                      09450000
.* EXTERNAL REFERENCES - N/A                                            09500000
.*                                                                      09550000
.* TABLES - N/A                                                         09600000
.*                                                                      09650000
.* MACROS - IHBINNRA                                                    09700000
.*                                                                      09750000
.* CHANGE ACTIVITY -                                                    09800000
.* $L1=UCBVSCR,HDZ11C0,94262,SJPLSYW: ADD LOC= PARAMETER           @L1A 09850000
.***** END OF SPECIFICATIONS ****************************************** 09900000
         LCLC  &FUNFLG,&SAVAREA,&SET(6),&SKIP,&FLGA(6),&LABEL,&BITS     09950000
         LCLB  &BIT(8),&QUIT,&MSG                                  @L1C 10000000
&LABEL   SETC  '&NAME'                                                  10050000
         AIF   ('&MF' EQ 'L').LIST      BR IF LIST OPTION               10100000
         AIF   ('&MF' EQ 'D').DSECT     BR IF DSECT OPTION              10150000
*                                                                       10200000
*   STAR USES REGISTERS; 0(OUTPUT),1,9,10,11,14, AND 15(RETURN CODE)    10250000
*                                                                       10300000
.********************************************************************** 10350000
.*    KEYWORD SYNTAX CHECKING FOLLOWS                                   10400000
.********************************************************************** 10450000
.*                                                                      10500000
.********************************************************************** 10550000
.*    CHECK SYNTAX OF REGSAVE KEYWORD                                   10600000
.********************************************************************** 10650000
         AIF   (T'&REGSAVE EQ 'O').NOSAVE                               10700000
         AIF   ('&REGSAVE' EQ 'NO').NOSAVE                              10750000
         AIF   ('&REGSAVE' EQ 'YES').SAVE                               10800000
         SPACE 1                                                        10850000
         MNOTE 4,'REGSAVE= OPERAND NOT RECOGNIZED; ''NO'' IS ASSUMED'   10900000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         10950000
.NOSAVE  ANOP                                                           11000000
&SAVAREA SETC  'NO'                     INDICATE REG SAVING NOT REQ'D   11050000
         AGO   .SYNTAX                                                  11100000
.SAVE    ANOP                                                           11150000
*   REGSAVE OPTION SPECIFIED; ALL REGISTERS BUT 0 AND 15 WILL BE        11200000
*   SAVED AND RESTORED.                                                 11250000
*                                                                       11300000
&SAVAREA SETC  'YES'                    INDICATE REG SAVING REQ'D       11350000
.********************************************************************** 11400000
.*    SYNTAX CHECK OF FUNCTN KEYWORD                                    11450000
.********************************************************************** 11500000
.SYNTAX  ANOP                                                           11550000
         AIF   (T'&FUNCTN EQ 'O').NOFUNC                                11600000
         AIF   ('&FUNCTN' EQ 'TRKBAL').BALFUN                           11650000
         AIF   ('&FUNCTN' EQ 'TRKCAP').CAPFUN                           11700000
         SPACE 1                                                        11750000
         MNOTE 8,'FUNCTN= OPERAND INVALID; PROCESSING TERMINATED'       11800000
         SPACE 1                                                        11850000
         MEXIT                          ABORT - CAN'T VALIDATE          11900000
.*                                      REMAINING KEYWORD CONFLICTS     11950000
.NOFUNC  ANOP                                                           12000000
         AIF   ('&MF' NE 'I').NOPROBM   FUNCTN OMITTED AND MF=E IS OK   12050000
         SPACE 1                                                        12100000
         MNOTE 8,'FUNCTN= CAN NOT BE OMITTED WITH MF=I; PROCESSING TERMI12150000
               INATED'                                                  12200000
         SPACE 1                                                        12250000
         MEXIT                                                          12300000
.BALFUN  ANOP                                                           12350000
&FUNFLG  SETC  'B'                      INDICATE TRKBAL REQ'D           12400000
.NOPROBM ANOP                                                           12450000
&BIT(1)  SETB  0                        SET TRKBAL/OMITTED FLG FOR      12500000
.*                                      STAR PARMS                      12550000
         AGO   .TRKC010                                                 12600000
.CAPFUN  ANOP                                                           12650000
&FUNFLG  SETC  'C'                      INDICATE TRKCAP REQ'D           12700000
&BIT(1)  SETB  1                        SET TRKCAP FLG FOR STAR PARMS   12750000
.********************************************************************** 12800000
.*   CHECK SYNTAX OF DEVTAB KEYWORD                                     12850000
.********************************************************************** 12900000
.TRKC010 ANOP                                                           12950000
&BIT(6)  SETB  0                        INIT SOURCE FLAGS               13000000
&BIT(7)  SETB  0                        FOR DVCT ADDR                   13050000
         AIF   (T'&DEVTAB EQ 'O').TRKC020                               13100000
         AIF   ('&DEVTAB'(1,1) NE '(').DEVADDR                          13150000
         AIF   (N'&DEVTAB GT 1).DEVBAD                                  13200000
&SET(1)  SETC  '&DEVTAB(1)'             SAVE KEYW VALUE W/O PARENS      13250000
&FLGA(1) SETC  'R'                      INDICATE REG-FORM               13300000
         AGO   .TRKC020                 ON TO NEXT KEYW                 13350000
.DEVADDR ANOP                                                           13400000
&SET(1)  SETC  '&DEVTAB'                SAVE KEYW VALUE                 13450000
&FLGA(1) SETC  'A'                      INDICATE ADDR-FORM              13500000
         AGO   .TRKC020                 ON TO NEXT KEYW                 13550000
.DEVBAD  ANOP                                                           13600000
         SPACE 1                                                        13650000
         MNOTE 8,'DEVTAB= OPERAND INVALID; NO CODE PRODUCED'            13700000
&QUIT    SETB  1                        DEFER TERMINATION               13750000
.********************************************************************** 13800000
.*  CHECK SYNTAX OF TYPE KEYWORD                                        13850000
.********************************************************************** 13900000
.TRKC020 ANOP                                                           13950000
         AIF   (T'&TYPE EQ 'O').TRKC030                                 14000000
         AIF   ('&FLGA(1)' NE '').DEVBAD2  HAVE DVCT SOURCE ALREADY?    14050000
         AIF   ('&TYPE'(1,1) NE '(').TYPADDR                            14100000
         AIF   (N'&TYPE GT 1).TYPEBAD                                   14150000
&SET(1)  SETC  '&TYPE(1)'               SAVE KEYW VALUE W/O PARENS      14200000
&FLGA(1) SETC  'R'                      INDICATE REG-FORM               14250000
         AGO   .SETTYPE                 ON TO SETTING OF TYPE FLG       14300000
.TYPADDR ANOP                                                           14350000
&SET(1)  SETC  '&TYPE'                  SAVE KEYW VALUE                 14400000
&FLGA(1) SETC  'A'                      INDICATE ADDR-FORM              14450000
.SETTYPE ANOP                                                           14500000
&BIT(6)  SETB  1                        SET TYPE FLGS FOR               14550000
&BIT(7)  SETB  1                        STAR PARMS                      14600000
         AGO   .TRKC030                 ON TO NEXT KEYW                 14650000
.TYPEBAD ANOP                                                           14700000
         SPACE 1                                                        14750000
         MNOTE 8,'TYPE= OPERAND INVALID; NO CODE PRODUCED'              14800000
&QUIT    SETB  1                        DEFER TERMINATION               14850000
.********************************************************************** 14900000
.*  CHECK SYNTAX OF UCB KEYWORD                                         14950000
.********************************************************************** 15000000
.TRKC030 ANOP                                                           15050000
         AIF   (T'&UCB EQ 'O').TRKC040                                  15100000
         AIF   ('&FLGA(1)' NE '').DEVBAD2  HAVE DVCT SOURCE ALREADY?    15150000
         AIF   ('&UCB'(1,1) NE '(').UCBADDR                             15200000
         AIF   (N'&UCB GT 1).UCBBAD                                     15250000
&SET(1)  SETC  '&UCB(1)'                SAVE KEYW VALUE W/O PARENS      15300000
&FLGA(1) SETC  'R'                      INDICATE REG-FORM               15350000
         AGO   .SETUCB                  ON TO SETTING UCB FLG           15400000
.UCBADDR ANOP                                                           15450000
&SET(1)  SETC  '&UCB'                   SAVE KEYW VALUE                 15500000
&FLGA(1) SETC  'A'                      INDICATE ADDR-FORM              15550000
.SETUCB  ANOP                                                           15600000
&BIT(6)  SETB  1                        SET UCB FLG FOR STAR PARMS      15650000
         AGO   .TRKC040                 ON TO NEXT KEYW                 15700000
.DEVBAD2 ANOP                                                           15750000
         SPACE 1                                                        15800000
         MNOTE 8,'DEVTAB=, TYPE=, AND UCB= OPERANDS ARE MUTUALLY EXCLUSI15850000
               IVE;              NO CODE PRODUCED'                      15900000
&QUIT    SETB  1                        DEFER TERMINATION               15950000
         AGO   .TRKC040                 ON TO NEXT KEYW                 16000000
.UCBBAD  ANOP                                                           16050000
         SPACE 1                                                        16100000
         MNOTE 8,'UCB= OPERAND INVALID; NO CODE PRODUCED'               16150000
&QUIT    SETB  1                        DEFER TERMINATION               16200000
.********************************************************************** 16250000
.*  ENSURE THAT A SOURCE (DEVTAB, UCB, OR TYPE) FOR THE DEVICE CHAR-    16300000
.*  ACTERISTICS TABLE WAS PROVIDED. IF NOT, DEFAULT TO A RESIDUAL       16350000
.*  DEVTAB ADDRESS AS THE DVCT SOURCE.                                  16400000
.********************************************************************** 16450000
.TRKC040 ANOP                                                           16500000
         AIF   (T'&FUNCTN EQ 'O').TRKC042 BR,IF FUNCTN NOT CODED,  @L1C 16550000
.*                                      SOURCE ASSUMED, FLGS NOT SET    16600000
         AIF   ('&FLGA(1)' NE '').TRKC042 BR, IF DVCT SOURCE GIVEN @L1C 16650000
.*  AT THIS POINT IF &QUIT=1, THE CALLER PROVIDED A SOURCE FOR THE      16700000
.*  DVCT BUT IT WAS IN ERROR.                                           16750000
         AIF   (&QUIT).TRKC042          BR, IF &QUIT=1             @L1C 16800000
         SPACE 1                                                        16850000
         MNOTE 4,'DVCT SOURCE (DEVTAB=, UCB=, OR TYPE=) IS MISSING;    X16900000
                                 DEVTAB=* IS ASSUMED'                   16950000
&SET(1)  SETC  '*'                      INDICATE A RESIDUAL DEVTAB      17000000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         17050000
.********************************************************************** 17054100
.*  CHECK SYNTAX OF LOC KEYWORD                                    @L1A 17058200
.********************************************************************** 17062300
.TRKC042 ANOP                                                      @L1A 17066400
         AIF   (T'&LOC EQ 'O').TRKC045  BR,IF LOC= NOT CODED       @L1A 17070500
         AIF   ('&LOC' EQ 'BELOW').TRKC045                         @L1A 17074600
         AIF   ('&LOC' NE 'ANY').LOCERR                            @L1A 17078700
&BIT(8)  SETB  1                        SET LOC FLG FOR STAR PARMS @L1A 17082800
         AGO   .TRKC045                                            @L1A 17086900
.LOCERR  MNOTE 8,'LOC= VALUE MUST BE BELOW OR ANY'                 @L1A 17091000
&QUIT    SETB  1                        DEFER TERMINATION          @L1A 17095100
.********************************************************************** 17100000
.*  CHECK SYNTAX OF RKDD KEYWORD                                        17150000
.********************************************************************** 17200000
.TRKC045 ANOP                                                           17250000
         AIF   (T'&RKDD EQ 'O').TRKC050                                 17300000
         AIF   ('&RKDD'(1,1) NE '(').DORKDD                             17350000
         AIF   (N'&RKDD GT 1).RKDDBAD                                   17400000
&SET(2)  SETC  '&RKDD(1)'               SAVE KEYW VALUE W/O PARENS      17450000
&FLGA(2) SETC  'R'                      INDICATE REG-FORM               17500000
         AGO   .TSTDUP                                                  17550000
.DORKDD  ANOP                                                           17600000
         AIF   (T'&RKDD EQ 'N').RKDDBAD  BR IF IMMEDIATE-FORM; ERROR    17650000
&SET(2)  SETC  '&RKDD'                  SAVE KEYW VALUE                 17700000
&FLGA(2) SETC  'A'                      INDICATE ADDR-FORM              17750000
         AGO   .TSTDUP                                                  17800000
.RKDDBAD ANOP                                                           17850000
         SPACE 1                                                        17900000
         MNOTE 8,'RKDD= OPERAND INVALID; NO CODE PRODUCED'              17950000
&QUIT    SETB  1                        DEFER TERMINATION               18000000
.********************************************************************** 18050000
.*  SYNTAX CHECK FOR R, K, AND DD KEYWORDS                              18100000
.********************************************************************** 18150000
.TSTDUP  AIF   (T'&R NE 'O' OR T'&K NE 'O').MLTXERR  RKDD AND R, K, OR  18200000
         AIF   (T'&DD EQ 'O').TRKC060   DD ARE MUTUALLY EXCLUSIVE       18250000
.MLTXERR ANOP                                                           18300000
         SPACE 1                                                        18350000
         MNOTE 4,'R=, K=, OR DD= CAN NOT BE CODED WITH RKDD=; R=, K=, AN18400000
               ND DD=            ARE IGNORED'                           18450000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         18500000
         AGO   .TRKC060                 ON TO NEXT KEYW                 18550000
.TRKC050 ANOP                                                           18600000
&SKIP    SETC  'P3'                     INDICATE R/K/DD PROVIDED        18650000
         AIF   (T'&R EQ 'O').NORXX                                      18700000
         AIF   ('&R'(1,1) NE '(').NORXX                                 18750000
         AIF   (N'&R GT 1).BADPARM                                      18800000
&FLGA(4) SETC  'R'                      INDICATE REG-FORM               18850000
.NORXX   AIF   (T'&K EQ 'O').NOKXX                                      18900000
         AIF   ('&K'(1,1) NE '(').NOKXX                                 18950000
         AIF   (N'&K GT 1).BADPARM                                      19000000
&FLGA(5) SETC  'R'                      INDICATE REG-FORM               19050000
.NOKXX   AIF   (T'&DD EQ 'O').NODDXX                                    19100000
         AIF   ('&DD'(1,1) NE '(').NODDXX                               19150000
         AIF   (N'&DD GT 1).BADPARM                                     19200000
&FLGA(6) SETC  'R'                      INDICATE REG-FORM               19250000
.NODDXX  ANOP                                                           19300000
&SET(3)  SETC  '&R(1)'                  SAVE KEYW VALUES AND            19350000
&SET(4)  SETC  '&K(1)'                  STRIP AWAY                      19400000
&SET(5)  SETC  '&DD(1)'                 POSSIBLE PARENS                 19450000
         AGO   .TRKC060                 ON TO NEXT KEYW                 19500000
.BADPARM ANOP                                                           19550000
         SPACE 1                                                        19600000
         MNOTE 8,'R=, K=, OR DD= OPERAND INVALID; NO CODE PRODUCED'     19650000
&QUIT    SETB  1                        DEFER TERMINATION               19700000
.********************************************************************** 19750000
.*  SYNTAX CHECKING OF REMOVE KEYWORD                                   19800000
.********************************************************************** 19850000
.TRKC060 ANOP                                                           19900000
         AIF   (T'&REMOVE EQ 'O').NOREMV                                19950000
         AIF   ('&REMOVE' EQ 'NO').NOREMV                               20000000
         AIF   ('&REMOVE' NE 'YES').GARMSG1                             20050000
         AIF   ('&FUNFLG' EQ 'C').WARN1                                 20100000
&BIT(2)  SETB  1                        SET REMOVE FLG FOR STAR PARMS   20150000
         AGO   .TRKC070                 ON TO NEXT KEYW                 20200000
.GARMSG1 ANOP                                                           20250000
         SPACE 1                                                        20300000
         MNOTE 4,'REMOVE= OPERAND NOT RECOGNIZED; ''NO'' IS ASSUMED'    20350000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         20400000
         AGO   .NOREMV                                                  20450000
.WARN1   ANOP                                                           20500000
         SPACE 1                                                        20550000
         MNOTE 4,'REMOVE=YES AND FUNCTN=TRKCAP ARE MUTUALLY EXCLUSIVE; X20600000
                                 REMOVE=YES IS IGNORED'                 20650000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         20700000
.NOREMV  ANOP                                                           20750000
&BIT(2)  SETB  0                        RESET REMOVE FLG FOR STAR PARMS 20800000
.********************************************************************** 20850000
.*  SYNTAX CHECKING OF MAXSIZE KEYWORD                                  20900000
.********************************************************************** 20950000
.TRKC070 ANOP                                                           21000000
         AIF   ('&MAXSIZE' EQ 'NO').NOMAX                               21050000
         AIF   (T'&MAXSIZE EQ 'O').NOMAX                                21100000
         AIF   ('&MAXSIZE' NE 'YES').GARMSG2                            21150000
         AIF   ('&FUNFLG' EQ 'C').WARN2                                 21200000
&BIT(3)  SETB  1                        SET MAXSIZE FLG FOR STAR PARMS  21250000
         AGO   .TRKC080                 ON TO NEXT KEYW                 21300000
.GARMSG2 ANOP                                                           21350000
         SPACE 1                                                        21400000
         MNOTE 4,'MAXSIZE= OPERAND NOT RECOGNIZED; ''NO'' IS ASSUMED'   21450000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         21500000
         AGO   .NOMAX                                                   21550000
.WARN2   ANOP                                                           21600000
         SPACE 1                                                        21650000
         MNOTE 4,'MAXSIZE=YES AND FUNCTN=TRKCAP ARE MUTUALLY EXCLUSIVE;X21700000
                                 MAXSIZE=YES IS IGNORED'                21750000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         21800000
.NOMAX   ANOP                                                           21850000
&BIT(3)  SETB  0                        RESET MAXSIZE FLG FOR           21900000
.*                                      STAR PARMS                      21950000
.********************************************************************** 22000000
.*  SYNTAX CHECKING OF LAST KEYWORD                                     22050000
.********************************************************************** 22100000
.TRKC080 ANOP                                                           22150000
         AIF   ('&LAST' EQ 'NO').NOLAST                                 22200000
         AIF   (T'&LAST EQ 'O').NOLAST                                  22250000
         AIF   ('&LAST' NE 'YES').GARMSG3                               22300000
         AIF   ('&FUNFLG' EQ 'C').WARN3                                 22350000
&BIT(5)  SETB  1                        SET LAST FLG FOR STAR PARMS     22400000
         AGO   .TRKC090                 ON TO NEXT KEYW                 22450000
.GARMSG3 ANOP                                                           22500000
         SPACE 1                                                        22550000
         MNOTE 4,'LAST= OPERAND NOT RECOGNIZED; ''NO'' IS ASSUME'       22600000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         22650000
         AGO   .NOLAST                                                  22700000
.WARN3   ANOP                                                           22750000
         SPACE 1                                                        22800000
         MNOTE 4,'LAST=YES AND FUNCTN=TRKCAP ARE MUTUALLY EXCLUSIVE;   X22850000
                                 LAST=YES IS IGNORED'                   22900000
&MSG     SETB  1                        INDICATE MESSAGE ISSUED         22950000
.NOLAST  ANOP                                                           23000000
&BIT(5)  SETB  0                        RESET LAST FLG FOR STAR PARMS   23050000
.********************************************************************** 23100000
.*  SYNTAX CHECKING OF BALANCE KEYWORD                                  23150000
.********************************************************************** 23200000
.TRKC090 ANOP                                                           23250000
         AIF   (T'&BALANCE EQ 'O').BALOFF                               23300000
         AIF   ('&BALANCE'(1,1) EQ '(').BALREG                          23350000
&SET(6)  SETC  '&BALANCE'               SAVE KEYW VALUE                 23400000
&FLGA(3) SETC  'A'                      INDICATE ADDR-FORM              23450000
         AGO   .BALON                   ON TO SETTING BALANCE FLG       23500000
.BALREG  ANOP                                                           23550000
         AIF   (N'&BALANCE GT 1).BADBAL                                 23600000
&SET(6)  SETC  '&BALANCE(1)'            SAVE KEYW VALUE W/O PARENS      23650000
&FLGA(3) SETC  'R'                      INDICATE REG-FORM               23700000
         AGO   .BALON                   ON TO SETTING BALANCE FLG       23750000
.BADBAL  ANOP                                                           23800000
         SPACE 1                                                        23850000
         MNOTE 8,'BALANCE= OPERAND INVALID; NO CODE PRODUCED'           23900000
&QUIT    SETB  1                        DEFER TERMINATION               23950000
.BALOFF  ANOP                                                           24000000
&BIT(4)  SETB  0                        RESET BALANCE FLG FOR           24050000
.*                                      STAR PARMS                      24100000
         AGO   .TSTERR                                                  24150000
.BALON   ANOP                                                           24200000
&BIT(4)  SETB  1                        SET BALANCE FLG FOR STAR PARMS  24250000
.********************************************************************** 24300000
.*  TEST TO SEE IF ANY SERIOUS (TERMINATING) ERRORS WERE FOUND          24350000
.********************************************************************** 24400000
.TSTERR  AIF   (&MSG EQ 0 AND &QUIT EQ 0).SETBITS  DON'T SPACE IF CLEAN 24450000
         SPACE 1                                                        24500000
         AIF   (&QUIT EQ 0).SETBITS     CONTINUE IF NO TERMINAL ERRORS  24550000
         MEXIT                          OTHERWISE, GIVE IT UP           24600000
.********************************************************************** 24650000
.*  SET STAR PARM FLAGS FOR CODE GENERATION                             24700000
.********************************************************************** 24750000
.SETBITS ANOP                                                           24800000
&BITS    SETC  '&BIT(1).&BIT(3).&BIT(2).&BIT(4).&BIT(5).&BIT(6).&BIT(7)-24850000
               .&BIT(8)'                                           @L1C 24900000
.********************************************************************** 24950000
.*  CHECK SYNTAX OF MF KEYWORD                                          25000000
.********************************************************************** 25050000
.MFCHECK AIF   ('&MF' EQ 'I').DOCNOP                                    25100000
         AIF   (N'&MF NE 2).MFBAD                                       25150000
         AIF   ('&MF(1)' NE 'E').MFBAD                                  25200000
         AGO   .TSTSA                   GO TEST FOR REG SAVE REQ        25250000
.DOCNOP  ANOP                                                           25300000
         CNOP  0,4                      BOUNDARY ALIGNMENT              25350000
.TSTSA   AIF   ('&SAVAREA' NE 'YES').NOSA                               25400000
&LABEL   STM   14,12,12(13)             SAVE REGISTERS                  25450000
&LABEL   SETC  ''                       CAN USE A LABEL ONLY ONCE       25500000
.NOSA    AIF   ('&MF' EQ 'I').STNDARD                                   25550000
&LABEL   IHBINNRA &MF(2)                GO LOAD PARM REG                25600000
         AGO   .XECUTE                  GO GEN CODE TO INIT PARM LIST   25650000
.MFBAD   ANOP                                                           25700000
         MNOTE 8,'MF= OPERAND INVALID; PROCESSING TERMINATED'           25750000
         SPACE 1                                                        25800000
         MEXIT                          A BAD MF KEYW IS FATAL          25850000
.STNDARD ANOP                                                           25900000
&LABEL   BAL   1,*+16                   BRANCH AROUND LIST              25950000
&LABEL   SETC  ''                       CAN USE A LABEL ONLY ONCE       26000000
.LIST    ANOP                                                           26050000
&LABEL   DC    A(0)                     DVCT OR UCB ADDR, OR DEVTYPE    26100000
         AIF   ('&MF' EQ 'L').SKIPFLG   IF LIST, GEN ONLY ZERO'S        26150000
         DC    B'&BITS'                 FLAG BYTE                       26200000
         AGO   .TRKC100                 GO AROUND LIST CODE             26250000
.SKIPFLG ANOP                                                           26300000
         DC    X'00'                    FLAG BYTE                       26350000
.TRKC100 ANOP                                                           26400000
         DC    X'00'                    RESERVED                        26450000
         DC    AL2(0)                   TRACK BALANCE                   26500000
         AIF   ('&MF' EQ 'L').SKIPR     GEN ZERO FOR                    26550000
         AIF   ('&FLGA(4)' EQ 'R').SKIPR  RECORD NUMBER UNLESS          26600000
         AIF   (T'&R NE 'N').SKIPR      IT'S THE IMMEDIATE-FORM         26650000
         DC    AL1(&R)                  RECORD NUMBER                   26700000
         AGO   .TRKC110                                                 26750000
.SKIPR   ANOP                                                           26800000
         DC    AL1(0)                   RECORD NUMBER                   26850000
.TRKC110 ANOP                                                           26900000
         AIF   ('&MF' EQ 'L').SKIPK     GEN ZERO FOR                    26950000
         AIF   ('&FLGA(5)' EQ 'R').SKIPK  KEY LENGTH UNLESS             27000000
         AIF   (T'&K NE 'N').SKIPK      IT'S THE IMMEDIATE-FORM         27050000
         DC    AL1(&K)                  KEY LENGTH                      27100000
         AGO   .TRKC120                                                 27150000
.SKIPK   ANOP                                                           27200000
         DC    AL1(0)                   KEY LENGTH                      27250000
.TRKC120 ANOP                                                           27300000
         AIF   ('&MF' EQ 'L').SKIPDD    GEN ZERO FOR                    27350000
         AIF   ('&FLGA(6)' EQ 'R').SKIPDD  DATA LENGTH UNLESS           27400000
         AIF   (T'&DD NE 'N').SKIPDD    IT'S THE IMMEDIATE-FORM         27450000
         DC    AL2(&DD)                 DATA LENGTH                     27500000
         AGO   .TRKC130                                                 27550000
.SKIPDD  ANOP                                                           27600000
         DC    AL2(0)                   DATA LENGTH                     27650000
.TRKC130 ANOP                                                           27700000
         AIF   ('&MF' EQ 'L').FINISH    GEN NO INSTRUCTION IF LIST REQ  27750000
.XECUTE  ANOP                                                           27800000
         AIF   ('&SET(1)' EQ '*').TRKC140  IF *, THEN DVCT SOURCE IS    27850000
.*                                      ALREADY IN THE STAR LIST        27900000
         AIF   (&BIT(7)).GOTTYPE        BR IF TYPE PROVIDED             27950000
         AIF   ('&FLGA(1)' EQ 'R').BR1  BR IF REG-FORM                  28000000
         AIF   ('&FLGA(1)' NE 'A').TRKC140  BR IF NOT ADDR-FORM         28050000
         L     15,&SET(1)               MOVE ADDR OF DEVTAB OR          28100000
         ST    15,0(0,1)                UCB TO LIST                     28150000
         AGO   .TRKC140                                                 28200000
.BR1     ANOP                                                           28250000
         ST    &SET(1),0(0,1)           ST @ OF DEVTAB OR UCB IN LIST   28300000
         AGO   .TRKC140                                                 28350000
.GOTTYPE AIF   ('&FLGA(1)' EQ 'R').TYPER  BR IF REG-FORM                28400000
.*                                      OTHERWISE, IT'S ADDR-FORM       28450000
         IC    15,&SET(1)               MOVE DEVICE TYPE                28500000
         STC   15,3(0,1)                TO LIST                         28550000
         AGO   .TRKC140                                                 28600000
.TYPER   ANOP                                                           28650000
         STC   &SET(1),3(0,1)           ST DEVICE TYPE IN LIST          28700000
.TRKC140 ANOP                                                           28750000
         AIF   ('&MF' EQ 'I').NOFLAG    FLGS ARE DC'D FOR I-FORM        28800000
         AIF   (T'&FUNCTN EQ 'O').NOFLAG  USE RESIDUAL FLGS IF NO FUNCT 28850000
         MVI   4(1),B'&BITS'            FLAGS TO LIST                   28900000
.NOFLAG  ANOP                                                           28950000
         AIF   (&BIT(4) NE 1).TRKC150   BR IF NO BALANCE PROVIDED       29000000
         AIF   ('&SET(6)' EQ '*').TRKC150  IF '*', BAL IS IN STAR       29050000
.*                                      PARM LIST ALREADY               29100000
         AIF   ('&FLGA(3)' EQ 'R').BR2  BR IF REG-FORM                  29150000
         LH    15,&SET(6)               TRK BALANCE                     29200000
         STH   15,6(0,1)                TO LIST                         29250000
         AGO   .TRKC150                                                 29300000
.BR2     ANOP                                                           29350000
         STH   &SET(6),6(0,1)           ST TRK BALANCE IN LIST          29400000
.TRKC150 ANOP                                                           29450000
         AIF   ('&SKIP' EQ 'P3').RKDD3  BR IF RKDD WAS NOT PROVIDED     29500000
         AIF   ('&FLGA(2)' EQ 'R').BR3  BR IF REG-FORM                  29550000
         L     15,&SET(2)               MOVE RKDD                       29600000
         ST    15,8(0,1)                TO LIST                         29650000
         AGO   .EXITBR                                                  29700000
.BR3     ANOP                                                           29750000
         ST    &SET(2),8(0,1)           ST RKDD IN LIST                 29800000
         AGO   .EXITBR                                                  29850000
.RKDD3   ANOP                                                           29900000
         AIF   (T'&R EQ 'O').AKY        BR IF R NOT PROVIDED            29950000
         AIF   ('&FLGA(4)' NE 'R').RADDR  BR IF NOT REG-FORM            30000000
         STC   &SET(3),8(0,1)           ST REC NO. IN LIST              30050000
         AGO   .AKY                                                     30100000
.RADDR   ANOP                                                           30150000
         AIF   (T'&R EQ 'N').NRX        BR IF IMMEDIATE-FORM            30200000
         IC    15,&SET(3)               MOVE REC NO.                    30250000
         STC   15,8(0,1)                TO LIST                         30300000
         AGO   .AKY                                                     30350000
.NRX     ANOP                                                           30400000
         AIF   ('&MF' EQ 'I').AKY       IF I-FORM, R IS DC'D            30450000
         MVI   8(1),&R                  ST REC NO. IN LIST              30500000
.AKY     ANOP                                                           30550000
         AIF   (T'&K EQ 'O').ADDY       BR IF K NOT PROVIDED            30600000
         AIF   ('&FLGA(5)' NE 'R').KADDR  BR IF NOT REG-FORM            30650000
         STC   &SET(4),9(0,1)           ST KEY LENGTH IN LIST           30700000
         AGO   .ADDY                                                    30750000
.KADDR   ANOP                                                           30800000
         AIF   (T'&K EQ 'N').NKX        BR IF IMMEDIATE-FORM            30850000
         IC    15,&SET(4)               MOVE KEY LENGTH                 30900000
         STC   15,9(0,1)                TO LIST                         30950000
         AGO   .ADDY                                                    31000000
.NKX     ANOP                                                           31050000
         AIF   ('&MF' EQ 'I').ADDY      IF I-FORM, K IS DC'D            31100000
         MVI   9(1),&K                  ST KEY LENGTH IN LIST           31150000
.ADDY    ANOP                                                           31200000
         AIF   (T'&DD EQ 'O').EXITBR    BR IF DD NOT PROVIDED           31250000
         AIF   ('&FLGA(6)' NE 'R').DDADDR  BR IF NOT REG-FORM           31300000
         STH   &SET(5),10(0,1)          ST DATA LENGTH IN LIST          31350000
         AGO   .EXITBR                                                  31400000
.DDADDR  ANOP                                                           31450000
         AIF   (T'&DD EQ 'N').NDDX      BR IF IMMEDIATE-FORM            31500000
         LH    15,&SET(5)               MOVE DATA LENGTH                31550000
         STH   15,10(0,1)               TO LIST                         31600000
         AGO   .EXITBR                                                  31650000
.NDDX    ANOP                                                           31700000
         AIF   ('&MF' EQ 'I').EXITBR    IF I-FORM, DD IS DC'D           31750000
         MVI   10(1),&DD/256            ST DATA LENGTH(1) IN LIST       31800000
         MVI   11(1),&DD-((&DD/256)*256) ST DATA LENGTH(2) IN LIST      31850000
.EXITBR  ANOP                                                           31900000
         L     15,16                    ADDRESS OF CVT                  31950000
         L     15,232(0,15)             ADDRESS OF SECTOR CONV. RTN     32000000
         BAL   14,12(0,15)              USE STAR ENTRY ON CALL          32050000
         AIF   ('&SAVAREA' EQ 'NO').FINISH  BR IF REGSAVE NOT REQ'D     32100000
         LM    1,12,24(13)              RESTORE REGS 1-12               32150000
         L     14,12(0,13)              RESTORE REG 14                  32200000
.FINISH  MEXIT                                                          32250000
.DSECT   ANOP                                                           32300000
         DS    0F                       ALIGN TO FULL WORD BOUNDARY     32350000
&NAME    DS    0CL12                    STAR PARM LIST MAP              32400000
STARUCBA DS    0F                       UCB ADDRESS                     32450000
STARDCTA DS    0F                       DEVICE TABLE ADDRESS            32500000
         DS    XL3                                                      32550000
STARTYPE DS    XL1                      DEVICE TYPE                     32600000
STARFLGS DS    XL1                      FUNCTION AND OPTIONS            32650000
STARFUNC EQU   B'10000000'              FUNCTION: 0=TRKBAL, 1=TRKCAP    32700000
STARMAXS EQU   B'01000000'              1=MAXSIZE REQUESTED             32750000
STARREMV EQU   B'00100000'              1=REMOVE REQUESTED              32800000
STARUBAL EQU   B'00010000'              1=CALLER PROVIDED BALANCE       32850000
STARLAST EQU   B'00001000'              1=SPECIAL LAST RCD REQUEST      32900000
STARDTU  EQU   B'00000110'              DVCT ENTRY SOURCE FLAGS:        32950000
*                                       00=DVCT ENTRY ADDRESS PROVIDED  33000000
*                                       01=RESERVED                     33050000
*                                       10=UCB ADDRESS PROVIDED         33100000
*                                       11=DEVICE TYPE PROVIDED         33150000
STARLOC  EQU   B'00000001'              LOC=ANY. DEVTAB OR UCB     @L1C 33183300
*                                       ABOVE THE LINE             @L1A 33216600
         DS    XL1                      RESERVED                        33250000
STARBAL  DS    H                        TRACK BALANCE                   33300000
STARRKDD DS    0F                       RECORD INFO AS DEFINED BELOW    33350000
STARR    DS    XL1                      RECORD NUMBER                   33400000
STARKL   DS    XL1                      KEY LENGTH                      33450000
STARDL   DS    H                        DATA LENGTH                     33500000
         MEND                                                           33550000
