*        %GOTO IPCPPRO ;        /* Bilingual header                     00050000
         MACRO                                                          00100000
         BPXYIPCP  &DSECT=YES,&LIST=YES                                 00150000
         GBLB  &IPCP411                                                 00200000
         AIF   (&IPCP411 EQ 1).E411                                     00250000
&IPCP411 SETB  1                                                        00300000
         AIF   ('&LIST' EQ 'YES').A411                                  00350000
         PUSH  PRINT  BPXYIPCP: IPC Access Structure                    00400000
         PRINT OFF                                                      00450000
         AGO   .A411                                                    00500000
*                               */                                      00550000
*%IPCPPRO : ;                                                           00600000
*/****START OF SPECIFICATIONS****************************************** 00650000
*    $MAC (BPXYIPCP) COMP(SCPX1) PROD(BPX):                             00700000
*01* MACRO NAME: BPXYIPCP                                               00750000
*01* DSECT NAME: N/A                                                    00800000
*01* DESCRIPTIVE NAME: OpenMVS Interprocess Communication Access        00850000
*                      Structure                                        00900000
*                                                                       00950000
*02*   ACRONYM: IPCP                                                    01000000
**/                                                                     01050000
*/*01* PROPRIETARY STATEMENT=                                        */ 01100000
*/***PROPRIETARY_STATEMENT********************************************/ 01150000
*/*                                                                  */ 01200000
*/*                                                                  */ 01250000
*/* LICENSED MATERIALS - PROPERTY OF IBM                             */ 01350000
*/* THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      */ 01400000
*/* 5647-A01 (C) COPYRIGHT IBM CORP. 1995,2000                       */ 01450000
*/*                                                                  */ 01500000
*/* STATUS= HBB7703                                                  */ 01550000
*/*                                                                  */ 01600000
*/***END_OF_PROPRIETARY_STATEMENT*************************************/ 01650000
*/*                                                                     01700000
*                                                                       01725000
*01* EXTERNAL CLASSIFICATION:  GUPI                                     01750000
*01* END OF EXTERNAL CLASSIFICATION:                                    01800000
*                                                                       01850000
*01* FUNCTION:                                                          01900000
*                                                                       01950000
*    This file contains the mapping of the OpenMVS                      02000000
*    Interprocess Communication access structure.                       02050000
*                                                                       02100000
*01* METHOD OF ACCESS:                                                  02150000
*02*   PL/X:                                                            02200000
*        %INCLUDE SYSLIB(BPXYIPCP) or                                   02250000
*02*   ASM:                                                             02300000
*        BPXIPCP DSECT=YES/NO,LIST=YES/NO                               02350000
*01* SIZE: IPC#LENGTH                                                   02400000
*                                                                       02450000
*01* POINTED TO BY: IpccIpcp@                                           02500000
*                                                                       02550000
*01* CREATED BY: BPXGXMGT BPXGXSGT BPXGXQGT using class BPXGXIPC        02600000
*                                                                       02650000
*01* DELETED BY: BPXGXMCT BPXGXSCT BPXGXQCT                             02700000
*                                                                       02750000
*01* STORAGE ATTRIBUTES:  User copy:  Under user control.               02800000
*01* STORAGE ATTRIBUTES:  Kernel:  A substructure of BPXZIPCC.          02850000
*02*   SUBPOOL: A substructure of BPXZIPCC or provided by caller        02900000
*02*   KEY:     N/A                                                     02950000
*02*   RESIDENCY: N/A                                                   03000000
*                                                                       03050000
*01* FREQUENCY: 1 IPCP per IPCC.                                        03100000
*01* SERIALIZATION:                                                     03150000
*01* DEPENDENCIES: None                                                 03200000
*01* NOTES: None                                                        03250000
*01* COMPONENT:  OpenMVS (SCPX1)                                        03300000
*01* DISTRIBUTION LIBRARY:  AMACLIB                                     03350000
*01* EYE-CATCHER: Offset from BPXZIPCC eye-eyecatcher                   03400000
*02*   OFFSET:  N/A                                                     03450000
*02*   LENGTH:  N/A                                                     03500000
*01* CHANGE-ACTIVITY:                                                   03550000
*    $D0=DPFA051  HOM1130 940131 PDJD: A051.02 Initial XPG4 IPC         03600000
*    $P1=PPF0482  HOM1130 950275 PDJD: Allow Execute Flag Bit           03650000
*    $D1=DVT0240  HBB6606 971001 PDPY: A240.00 Shmem 1 Meg              03700000
*    $D2=DVTA245  HBB6606 970926 PDJC: Perform locked operation         03750000
* $D3=DWA0303 JBB6607 980325 PDJM: A303.00 Ipc_RcvTypePID & Snd         03800000
* $D4=DWKA301 HBB6608 980914 PDJM: A301.01 Ipc_PLO1 & Ipc_PLO2          03850000
* $01=OW44184 HBB7703 000614 PDQR: Binary semaphore UNDO rollback       03870000
* $02=OW46626 HBB7703 001031 PDSZ: INUSE in caps                        03880000
****END OF SPECIFICATIONS*********************************************/ 03900000
*        %GOTO IPCPPLS ;        /* Bilingual header                     03950000
.A411    ANOP  ,                                                        04000000
** BPXYIPCP: Interprocess Communications Permission                     04050000
**  Used By: MCT, MGT, SCT, SGT, QCT, QGT                               04100000
         AIF   ('&DSECT' EQ 'NO').B411                                  04150000
IPC_PERM             DSECT ,      Interprocess Communications           04200000
         AGO   .C411                                                    04250000
.B411    ANOP  ,                                                        04300000
IPC_PERM             DS    0F     Interprocess Communications           04350000
.C411    ANOP  ,                                                        04400000
IPC_UID              DS    F      Owner's effective user ID             04450000
IPC_GID              DS    F      Owner's effective group ID            04500000
IPC_CUID             DS    F      Creator's effective user ID           04550000
IPC_CGID             DS    F      Creator's effective group ID          04600000
IPC_MODE             DS    XL4    Mode, mapped by BPXYMODE              04650000
IPC#LENGTH   EQU   *-IPC_PERM  Length of Interprocess Control block     04700000
                     SPACE ,                                            04750000
* Key:                                                                  04800000
IPC_PRIVATE          EQU   0      Private key.                          04850000
                     SPACE ,                                            04900000
* Mode bits:                      Map over S_TYPE in BPXYMODE           04950000
IPC_CREAT            EQU   1      Create entry if key does not exist.   05000000
IPC_EXCL             EQU   2      Fail if key exists.                   05050000
IPC_MEGA             EQU   4      Allocation in meg                     05100000
IPC_BINSEM           EQU   4      Binary semaphore                      05150000
IPC_RCVTYPEPID       EQU   4      Msgrcv TYPE=PID                       05200000
IPC_SNDTYPEPID       EQU   8      Msgsnd TYPE=PID                       05250000
IPC_PLO1             EQU  16      Use PLO for serialization             05300000
IPC_SHORTHOLD        EQU  16      Binary semaphore short        @01A*/  05320000
IPC_PLO2             EQU  32      Use PLO if practical                  05350000
IPC_PLOINUSE         EQU   1      PLO is in use (_getipc only)          05419990
                     SPACE ,                                            05450000
* Flag bits - semop, msgrcv, msgsnd:                                    05500000
IPC_NOWAIT           EQU   1      Error if request must wait.           05550000
                     SPACE ,                                            05600000
* Control Command:                                                      05650000
IPC_RMID             EQU   1      Remove identifier.                    05700000
IPC_SET              EQU   2      Set options.                          05750000
IPC_STAT             EQU   3      Access status.                        05800000
                     SPACE ,                                            05850000
* CONSTANTS WHICH MAP OVER BYTE S_TYPE, SEE BPXYMODE                    05900000
** BPXYIPCP End                                                         05950000
         SPACE 3                                                        06000000
         AIF   ('&LIST' EQ 'YES').E411                                  06050000
         POP   PRINT                                                    06100000
.E411    ANOP  ,                                                        06150000
               MEND                                                     06200000
     Terminating PL/X comment                                       */  06250000
 %IPCPPLS : ;                                                           06300000
 %IF IPCPBASE='' %THEN                                                  06350000
   %DO;                                                                 06400000
     %IPCPBASE='Based(Addr(IpccIpcpArea))';                             06450000
   %END;                                                                06500000
 Declare 1 IPCP          Bdy(Word)   IPCPBASE,                          06550000
     3   IpcpUID         Fixed(32), /* Owner's effective user ID    */  06600000
     3   IpcpGID         Fixed(32), /* Owner's effective group ID   */  06650000
     3   IpcpCUID        Fixed(32), /* Creator's effective user ID  */  06700000
     3   IpcpCGID        Fixed(32), /* Creator's effective group ID */  06750000
     3   IpcpMODE        Bit(32);   /* read/write permissions mapped    06800000
                                       by IpcpFlags                 */  06850000
                                                                        06900000
 Declare 1 IpcpFlags  Based(Addr(IpcpMODE)), /* S_ bits mapped in       06950000
                                       BPXYMODE                     */  07000000
    3    *             Bit(08),     /*   S_Type                     */  07050000
     5   *             Bit(02),     /*                              */  07100000
     5 IpcpPLO2        Bit(01),     /* IPC_PLO2                 @D4A*/  07150000
     5 IpcpPLO1        Bit(01),     /* IPC_PLO1                 @D4A*/  07200000
      6 IpcpBinSemShort Bit(01),    /* IPC_SHORTHOLD            @01A*/  07220000
     5 IpcpSndTypePID  Bit(01),     /* IPC_SNDTYPEPID           @D3A*/  07250000
     5 IpcpMega        Bit(01),     /* IPC_MEGA    alloc in Meg @D1A*/  07300000
      6 IpcpBinSem     Bit(01),     /* IPC_BINSEM  binary sema4 @D2A*/  07350000
      7 IpcpRcvTypePID Bit(01),     /* IPC_RCVTYPEPID           @D3A*/  07400000
     5 IpcpEXCL        Bit(01),     /* IPC_EXCL    Requires create  */  07450000
     5 IpcpCREAT       Bit(01),     /* IPC_CREATE  Create if needed */  07500000
      6 IpcpPLOinUse   Bit(01),     /* PLO asked for and got    @D4A*/  07550000
    3  IpcpMode3B  Like(S_Mode3B);  /* Mode Bits                    */  07600000
 Declare                                                                07650000
    /* move this  to xxxget/ctl and tailor to each SCAFFOLD*/           07700000
    IPC_ValidFlags Bit(32)       /* Valid IpcpFlag bits, for        */  07750000
          Constant('1F0001FF'X), /* xxxget and xxxctl IPC syscalls      07819990
                                                                @D1C*/  07850000
  IPC_ValidMode  Bit(32)         /* Valid IpcpMode bits             */  07900000
          Constant('000001B6'X), /*                                 */  07950000
  IPC_PRIVATE Fixed Constant(0), /* Private key.                    */  08000000
  IPC_NOWAIT  Fixed Constant(1), /* Error if request must wait.     */  08050000
  IPC_SNDTYPEPID  Fixed Constant(8), /* msgget, TYPE=pid on snd @D3A*/  08100000
  IPC_RCVTYPEPID  Fixed Constant(4), /* msgget, TYPE=pid on rcv @D3A*/  08150000
  IPC_PLO1       Fixed Constant(16), /* msgget serialize        @D4A*/  08200000
  IPC_PLO2       Fixed Constant(32), /* msgget serialize        @D4A*/  08250000
  IPC_PLOinUse   Fixed Constant(01), /* getipc return S_MODE    @D4A*/  08300000
  IPC_EXCL    Fixed Constant(2), /* On ...get, error if defined     */  08350000
  IPC_CREAT   Fixed Constant(1), /* On ...get, creat if not defined */  08400000
  IPC_RMID    Fixed Constant(1), /* Remove identifier.              */  08450000
  IPC_SET     Fixed Constant(2), /* Set options.                    */  08500000
  IPC_STAT    Fixed Constant(3), /* Access status.                  */  08550000
  IPC_MEGA    Fixed Constant(4), /* Allocation in meg           @D1A*/  08600000
  IPC_BINSEM  Fixed Constant(4), /* Binary semaphore            @D2A*/  08650990
  IPC_SHORTHOLD  Fixed Constant(16); /* Binary semaphore short  @01A*/  08651980
