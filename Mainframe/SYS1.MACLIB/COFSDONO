*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  COFSDONO                              -01/10/92-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  DLF Delete Retained Object                    * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5685-001 (C) COPYRIGHT IBM CORP. 1989                           * 00001300
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00001400
*                                                                     * 00001500
* STATUS= JBB3313                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*                                                                     * 00001900
*01* FUNCTION:                                                        * 00002000
*                                                                     * 00002100
*      This macro provides the interface to the DLF Delete Object     * 00002200
*      function to cause deletion of a DLF Object which has no        * 00002300
*      connections.                                                   * 00002400
*                                                                     * 00002500
*01* INVOCATION REQUIREMENTS:                                         * 00002600
*                                                                     * 00002700
*                                                                     * 00002800
*      Execution Mode:   Task mode.                                   * 00002900
*                                                                     * 00003000
*      Authorization:    Supervisor State or PSW Key Mask (PKM) 0-7   * 00003100
*                                                                     * 00003200
*      Addressing Mode:  31 bit addressing mode.                      * 00003300
*                                                                     * 00003400
*      ASC mode:         Primary ASC mode.                            * 00003500
*                                                                     * 00003600
*      Serialization:    Enabled.                                     * 00003700
*                                                                     * 00003800
*      Restrictions:                                                  * 00003900
*                                                                     * 00004000
*                                                                     * 00004100
*01* INVOCATION FORMAT:                                               * 00004200
*                                                                     * 00004300
*[xlabel]  COFSDONO     OBJNAME=xobjname                              * 00004400
*                     [,RETCODE=xretcode]                             * 00004500
*                     [,RSNCODE=xrsncode]                             * 00004600
*                    [,MF=S]                                         * 00004700
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00004800
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00004900
*                                                                     * 00005000
*                                                                     * 00005100
*      Where:                                                         * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*      [xlabel]                                                       * 00005500
*          is an optional symbol, starting in column 1, that is the   * 00005600
*          name on the COFSDONO macro invocation.  The name must      * 00005700
*          conform to the rules for an ordinary assembler language    * 00005800
*          symbol.                                                    * 00005900
*          DEFAULT: No name.                                          * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*      OBJNAME=xobjname                                               * 00006400
*          is the name (RS-type), or address in register (2)-(12), of * 00006500
*          a required 64 character input variable containing the name * 00006600
*          of the DLF object to delete.  The name is a 6-character    * 00006700
*          volume serial number followed by the one to 44-character   * 00006800
*          data set name, left-justified.  Pad the 64-character field * 00006900
*          on the right with blanks (X'40').                          * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*      [RETCODE=xretcode]                                             * 00007400
*          is the name (RS-type) of an optional fullword output       * 00007500
*          variable, or register (2)-(12), into which the return code * 00007600
*          is to be copied from GPR 15.                               * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*      [RSNCODE=xrsncode]                                             * 00008100
*          is the name (RS-type) of an optional fullword output       * 00008200
*          variable, or register (2)-(12), into which the reason code * 00008300
*          is to be copied from GPR 0.                                * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*      [MF=S|L|E]                                                   * 00008800
*          is an optional keyword input which specifies the macro     * 00008900
*          form.                                                      * 00009000
*          DEFAULT: S                                                 * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*          [MF=S]                                                     * 00009400
*              specifies the standard form of the macro.  The "S"     * 00009500
*              form generates code to put the parameters into an      * 00009600
*              in-line parameter list and invoke the desired service. * 00009700
*              Full checking for required macro keys is done along    * 00009800
*              with supplying defaults for optional parameters that   * 00009900
*              are not specified.                                     * 00010000
*                                                                     * 00010100
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00010200
*              specifies the list form of the macro.  The "L" form    * 00010300
*              defines an area to be used for the parameter list.     * 00010400
*              Any other macro parameters are flagged as errors.      * 00010500
*                                                                     * 00010600
*            ,xmfctrl                                                 * 00010700
*              is a required input.  It is the name of a storage area * 00010800
*              for the parameter list.                                * 00010900
*                                                                     * 00011000
*            ,xmfattr|0D                                            * 00011100
*              is an optional 60 character input string that varies   * 00011200
*              from 1 to 60 characters. It can contain any value that * 00011300
*              is valid on an assembler DS pseudo-op. You can use     * 00011400
*              this parameter to force boundary alignment of the      * 00011500
*              parameter list.                                        * 00011600
*              DEFAULT: 0D which forces the parameter list to a       * 00011700
*              doubleword boundary.                                   * 00011800
*                                                                     * 00011900
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00012000
*              specifies the execute form of the macro.  The "E" form * 00012100
*              generates code to put the parameters into the          * 00012200
*              parameter list specified by xmfctrl and provides full  * 00012300
*              syntax checking with default setting.                  * 00012400
*                                                                     * 00012500
*            ,xmfctrl                                                 * 00012600
*              is a required input.  It is the name (RS-type), or     * 00012700
*              address in register (2)-(12), of a storage area for    * 00012800
*              the parameter list.                                    * 00012900
*                                                                     * 00013000
*            ,COMPLETE                                              * 00013100
*              is an optional keyword input which specifies the       * 00013200
*              degree of macro parameter syntax checking.             * 00013300
*              DEFAULT: COMPLETE                                      * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*              COMPLETE   Checking for required macro keys is done    * 00013700
*                        and defaults are supplied for optional       * 00013800
*                        parameters that were not specified.          * 00013900
*                                                                     * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*01* RETURN CODES:                                                    * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*       0         Success.  The object has been deleted.              * 00014700
*                                                                     * 00014800
*       2         The object did not exist in DLF.                    * 00014900
*                                                                     * 00015000
*       40(28)    DLF is not active.                                  * 00015100
*                                                                     * 00015200
*       44(2C)    Unexpected error in DLF.                            * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*01* REASON CODES:                                                    * 00015600
*                                                                     * 00015700
*       REASON    RETURN                                              * 00015800
*       CODE      CODE      DESCRIPTION                               * 00015900
*                                          * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*              0  0         Success.                                  * 00016300
*                                                                     * 00016400
*              0  2         The  specified  object  did  not exist in * 00016500
*                           DLF.                                      * 00016600
*                                                                     * 00016700
*              2  2         The  specified  object has been logically * 00016800
*                           deleted  by another routine, or is in the * 00016900
*                           process of being connected/deleted.       * 00017000
*                                                                     * 00017100
*              0  40(28)    DLF is not active.                        * 00017200
*                                                                     * 00017300
*         (nnnn)  44(2C)    The  reason  code  associated with return * 00017400
*                           code   44   (X'2C')   is   for   internal * 00017500
*                           diagnostic  purposes only.   It should be * 00017600
*                           recorded  and supplied to the appropriate * 00017700
*                           IBM Support personnel.                    * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00018100
*                                                                     * 00018200
*02*   PROCESSOR:  ASSEM                                              * 00018300
*                                                                     * 00018400
*01* COMPONENT:  SC164                                                * 00018500
*                                                                     * 00018600
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00018700
*                                                                     * 00018800
*01* MACRO USAGE NOTES:                                               * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00019200
*        global macro variable.  Any value other than 'NO' will       * 00019300
*        result in the macro expansion being printed.  The default is * 00019400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00019500
*        variable should be set.                                      * 00019600
*                                                                     * 00019700
*                    GBLC &ZPRINT                                     * 00019800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*01* CHANGE ACTIVITY:                                                 * 00020200
*                                                                     * 00020300
*   Flag LineItem  FMID    Date   ID    Comment                       * 00020400
*                                                                     * 00020500
*    $L0=DLF      JBB3313 890519 PDAM:  VLF Shared Data Object Mgr    * 00020600
*    $01=OY50417  JBB3313 920110 PD00IC:  New Return Code/Reason Code * 00020700
*                                         (2/2) added                 * 00020800
****** END OF SPECIFICATIONS *****************************************/ 00020900
*/********************************************************************* 00021000
         MACRO                                                          00021100
&XLABEL  COFSDONO &OBJNAME=,&RETCODE=,&RSNCODE=,&MF=                    00021200
.*                                                                      00021300
*              MACDATE -01/10/92-<1>                                    00021400
.*                                                                      00021500
.*******************************************************************    00021600
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00021700
.*******************************************************************    00021800
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00021900
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00022000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00022100
.*                                                                      00022200
              GBLC  &ZCOFSDONO  YES=MACRO USED AT LEAST ONCE            00022300
.*******************************************************************    00022400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00022500
.*******************************************************************    00022600
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00022700
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00022800
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00022900
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00023000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00023100
              LCLA  &ZAWRK      USED AS A WORK AREA                     00023200
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00023300
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00023400
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00023500
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00023600
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00023700
              LCLA  &ZMACRET    MACRO RETURN CODE                       00023800
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00023900
.*                                                                      00024000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00024100
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00024200
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00024300
.********************************************************************   00024400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00024500
.********************************************************************   00024600
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00024700
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00024800
.*                                                                      00024900
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00025000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00025100
              SPLEVEL  TEST                                             00025200
.ZSYS2        ANOP  ,                                                   00025300
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00025400
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00025500
              SYSSTATE TEST                                             00025600
              AGO   .ZSYS4                                              00025700
.ZSYS3        ANOP  ,                                                   00025800
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00025900
.ZSYS4        ANOP  ,                                                   00026000
.*******************************************************************    00026100
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00026200
.*******************************************************************    00026300
              LCLC  &XOBJNAME   ++ NAME                                 00026400
              LCLC  &XRETCODE   ++ NAME                                 00026500
              LCLC  &XRSNCODE   ++ NAME                                 00026600
              LCLC  &XMF        ++ VALUE                                00026700
              LCLC  &XMFCTRL    ++ NAME                                 00026800
              LCLC  &XMFATTR    ++ VALUE                                00026900
              LCLC  &XMFSCK     ++ VALUE                                00027000
.*******************************************************************    00027100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00027200
.*******************************************************************    00027300
              LCLC  &ZXOBJNAME  ++ INPUT NAME                           00027400
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00027500
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00027600
              LCLC  &ZXMF       ++ INPUT VALUE                          00027700
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00027800
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00027900
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00028000
.********************************************************************   00028100
.***AG.MF01 PROCESS MF MACRO FORMS                                      00028200
.********************************************************************   00028300
              ACTR  10000                                               00028400
.*------------------------------------------------------------------    00028500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00028600
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00028700
.*-------------------------------------------------------------------   00028800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00028900
.ZG12         ANOP  ,                                                   00029000
&ZTLC         SETC 'S'                                                  00029100
              AIF   ('&MF(1)' NE '&ZTLC').ZG13                          00029200
&XMF          SETC  'S'         SET KEYWORD                             00029300
              AIF   (N'&MF LE 1).ZG12A          CK NUM                  00029400
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00029500
&ZMS          SETC  '&ZMS.&MF"'                                         00029600
&ZMS          SETC  '&ZMS "MF"'                                         00029700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00029800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00029900
.ZG12A        ANOP  ,                                                   00030000
.*-------------------------------------------------------------------   00030100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00030200
.ZG13         ANOP  ,                                                   00030300
&ZTLC         SETC 'L'                                                  00030400
              AIF   ('&MF(1)' NE '&ZTLC').ZG20                          00030500
&XMF          SETC  'L'         SET KEYWORD                             00030600
              AIF   (N'&MF LE 3).ZG13A          CK NUM                  00030700
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00030800
&ZMS          SETC  '&ZMS.&MF"'                                         00030900
&ZMS          SETC  '&ZMS "MF"'                                         00031000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00031100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00031200
.ZG13A        ANOP  ,                                                   00031300
.*-------------------------------------------------------------------   00031400
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00031500
              AIF   (N'&SYSLIST NE 0).ZG13B     POSITIONALS?            00031600
              AIF   ('&OBJNAME' NE '').ZG13B    KEYS?                   00031700
              AIF   ('&RETCODE' NE '').ZG13B    KEYS?                   00031800
              AIF   ('&RSNCODE' NE '').ZG13B    KEYS?                   00031900
              AGO    .ZG13C     INVOCATION OKAY                         00032000
.ZG13B        ANOP  ,                                                   00032100
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         00032200
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   00032300
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              00032400
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        00032500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00032600
.ZG13C        ANOP  ,                                                   00032700
.*-------------------------------------------------------------------   00032800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00032900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00033000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00033100
              AIF   (N'&MF(2) GT 1).ZG15B       MULTI PARMS             00033200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00033300
.ZG15B        AIF   (K'&MF(2) GT 0).ZG15C                               00033400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00033500
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00033600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00033700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00033800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00033900
.ZG15C        ANOP  ,                                                   00034000
.*-------------------------------------------------------------------   00034100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00034200
              AIF   (K'&ZXMFCTRL LE 0).ZG15P    NOT I/O                 00034300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG15P                      00034400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00034500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00034600
&ZMS          SETC  '&ZMS.&MF"'                                         00034700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00034800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00034900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00035000
.ZG15P        ANOP  ,                                                   00035100
.*-------------------------------------------------------------------   00035200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00035300
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00035400
&XMFATTR      SETC  '0D'                                                00035500
              AIF   (K'&MF(3) LE 0).ZG18B       PARM                    00035600
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00035700
              AIF   (N'&MF(3) GT 1).ZG18B       MULTI PARMS             00035800
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00035900
.ZG18B        ANOP  ,                                                   00036000
.*-------------------------------------------------------------------   00036100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00036200
              AIF   (K'&ZXMFATTR LE 0).ZG18P    NOT I/O                 00036300
              AIF   ('&XMFATTR'(1,1) NE '(').ZG18P                      00036400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00036500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00036600
&ZMS          SETC  '&ZMS.&MF"'                                         00036700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00036800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00036900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00037000
.ZG18P        ANOP  ,                                                   00037100
.*-------------------------------------------------------------------   00037200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00037300
              AIF   (K'&ZXMFATTR LE 0).ZG18S    NOT I/O                 00037400
              AIF   (K'&XMFATTR LE 60).ZG18S    LNG OK                  00037500
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00037600
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00037700
&ZMS          SETC  '&ZMS.&MF"'                                         00037800
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00037900
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00038000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00038100
.ZG18S        ANOP  ,                                                   00038200
.*-------------------------------------------------------------------   00038300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00038400
.ZG20         ANOP  ,                                                   00038500
&ZTLC         SETC 'E'                                                  00038600
              AIF   ('&MF(1)' NE '&ZTLC').ZG28                          00038700
&XMF          SETC  'E'         SET KEYWORD                             00038800
              AIF   (N'&MF LE 3).ZG20A          CK NUM                  00038900
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00039000
&ZMS          SETC  '&ZMS.&MF"'                                         00039100
&ZMS          SETC  '&ZMS "MF"'                                         00039200
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00039300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00039400
.ZG20A        ANOP  ,                                                   00039500
.*-------------------------------------------------------------------   00039600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00039700
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00039800
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00039900
              AIF   (N'&MF(2) GT 1).ZG22B       MULTI PARMS             00040000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00040100
.ZG22B        AIF   (K'&MF(2) GT 0).ZG22C                               00040200
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00040300
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00040400
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00040500
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00040600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00040700
.ZG22C        ANOP  ,                                                   00040800
.*-------------------------------------------------------------------   00040900
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00041000
              AIF   (K'&ZXMFCTRL LE 0).ZG22R    NOT I/O                 00041100
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG22R                      00041200
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00041300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                        00041400
              AIF   (K'&ZCGPR GT 2).ZG22Q                               00041500
              AIF   ('&ZCGPR' EQ '0').ZG22Q                             00041600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00041700
              AIF   (T'&ZCGPR NE 'N').ZG22Q     INVALID REG NAME        00041800
.ZG22P        ANOP  ,                                                   00041900
              AIF   (T'&ZCGPR NE 'N').ZG22R     NON NUMERIC             00042000
              AIF   ('&ZCGPR' LT '2').ZG22Q                             00042100
              AIF   ('&ZCGPR' LE '12').ZG22R                            00042200
.ZG22Q        ANOP  ,                                                   00042300
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00042400
&ZMS          SETC  '&ZMS.&MF"'                                         00042500
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00042600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00042700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00042800
.ZG22R        ANOP  ,                                                   00042900
.*-------------------------------------------------------------------   00043000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00043100
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00043200
.ZG26A   AIF   ('&MF(3)' NE 'COMPLETE').ZG27A                           00043300
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00043400
.*-------------------------------------------------------------------   00043500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00043600
.ZG27A        AIF   (K'&XMFSCK GT 0).ZG27C      KEYWORD                 00043700
              AIF   (K'&MF(3) LE 0).ZG27B                               00043800
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00043900
&ZMS          SETC  '&ZMS.&MF"'                                         00044000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00044100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00044200
              MNOTE 8,' &ZMS "COMPLETE".'                               00044300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00044400
.ZG27B        ANOP  ,                                                   00044500
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00044600
.ZG27C        ANOP  ,                                                   00044700
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00044800
.*------------------------------------------------------------------    00044900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00045000
.ZG28         ANOP  ,                                                   00045100
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00045200
              AIF   (K'&XMF GT 0).ZG28E         VALID ARG               00045300
              AIF   (T'&MF EQ 'O').ZG28D        OMITTED                 00045400
&ZASYSLNDX    SETA  0                                                   00045500
.ZG28A        ANOP  ,           POSITIONAL MACRO KEY                    00045600
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00045700
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG28C                    00045800
&ZTLC         SETC 'MF'                                                 00045900
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG28A           00046000
.ZG28B        ANOP  ,                                                   00046100
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00046200
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00046300
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00046400
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00046500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00046600
              AGO   .ZG28E                                              00046700
.ZG28C        ANOP  ,                                                   00046800
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00046900
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00047000
&ZMS          SETC  '&ZMS.&MF"'                                         00047100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00047200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00047300
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00047400
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00047500
              MNOTE 8,' &ZMS OR "E".'                                   00047600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00047700
              AGO   .ZG28E                                              00047800
.ZG28D        ANOP  ,                                                   00047900
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00048000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00048100
.ZG28E        ANOP  ,                                                   00048200
.********************************************************************   00048300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00048400
.********************************************************************   00048500
              ACTR  10000                                               00048600
.*-------------------------------------------------------------------   00048700
.***AG.MF03 MF=(SLE)                                                    00048800
              AIF   ('&XMF' EQ 'L').ZGMFX                               00048900
.*----------------------------------------------------------------***   00049000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00049100
              AIF   (N'&OBJNAME LE 1).ZG2A      CK NUM                  00049200
&ZMS          SETC  '"OBJNAME='                 *KPOSA* MNOTE           00049300
&ZMS          SETC  '&ZMS.&OBJNAME"'                                    00049400
&ZMS          SETC  '&ZMS "OBJNAME"'                                    00049500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00049600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00049700
.ZG2A         ANOP  ,                                                   00049800
.*-------------------------------------------------------------------   00049900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00050000
&ZXOBJNAME    SETC  'INPUT'     SET IN/OUTPUT                           00050100
&XOBJNAME     SETC  '&OBJNAME(1)'               SET XVARIABLE           00050200
              AIF   (N'&OBJNAME GT 1).ZG2B      MULTI PARMS             00050300
&XOBJNAME     SETC  '&OBJNAME'  SET XVARIABLE                           00050400
.ZG2B         AIF   (K'&OBJNAME(1) GT 0).ZG2C                           00050500
&ZXOBJNAME    SETC  ''          RESET IN/OUTPUT                         00050600
&ZMS          SETC  ' '         *KRQDA*                                 00050700
&ZMS          SETC  '&ZMS "OBJNAME" KEY AND ITS ARGUMENT'               00050800
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00050900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00051000
.ZG2C         ANOP  ,                                                   00051100
.*-------------------------------------------------------------------   00051200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00051300
              AIF   (K'&ZXOBJNAME LE 0).ZG2R    NOT I/O                 00051400
              AIF   ('&XOBJNAME'(1,1) NE '(').ZG2R                      00051500
&ZCGPR        SETC  '&XOBJNAME'(2,K'&XOBJNAME-2)                        00051600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         00051700
              AIF   (K'&ZCGPR GT 2).ZG2Q                                00051800
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              00051900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00052000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        00052100
.ZG2P         ANOP  ,                                                   00052200
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             00052300
              AIF   ('&ZCGPR' LT '2').ZG2Q                              00052400
              AIF   ('&ZCGPR' LE '12').ZG2R                             00052500
.ZG2Q         ANOP  ,                                                   00052600
&ZMS          SETC  '"OBJNAME='                 *KGPRA* MNOTE           00052700
&ZMS          SETC  '&ZMS.&OBJNAME"'                                    00052800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00052900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00053000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00053100
.ZG2R         ANOP  ,                                                   00053200
.*----------------------------------------------------------------***   00053300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00053400
              AIF   (N'&RETCODE LE 1).ZG5A      CK NUM                  00053500
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00053600
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00053700
&ZMS          SETC  '&ZMS "RETCODE"'                                    00053800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00053900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00054000
.ZG5A         ANOP  ,                                                   00054100
.*-------------------------------------------------------------------   00054200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00054300
              AIF   (K'&RETCODE(1) LE 0).ZG5C   NO PARM                 00054400
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00054500
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00054600
              AIF   (N'&RETCODE GT 1).ZG5C                              00054700
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00054800
.ZG5C         ANOP  ,                                                   00054900
.*-------------------------------------------------------------------   00055000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00055100
              AIF   (K'&ZXRETCODE LE 0).ZG5R    NOT I/O                 00055200
              AIF   ('&XRETCODE'(1,1) NE '(').ZG5R                      00055300
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00055400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00055500
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00055600
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00055700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00055800
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00055900
.ZG5P         ANOP  ,                                                   00056000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00056100
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00056200
              AIF   ('&ZCGPR' LE '12').ZG5R                             00056300
.ZG5Q         ANOP  ,                                                   00056400
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00056500
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00056600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00056700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00056800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00056900
.ZG5R         ANOP  ,                                                   00057000
.*----------------------------------------------------------------***   00057100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00057200
              AIF   (N'&RSNCODE LE 1).ZG8A      CK NUM                  00057300
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00057400
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00057500
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00057600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00057700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00057800
.ZG8A         ANOP  ,                                                   00057900
.*-------------------------------------------------------------------   00058000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00058100
              AIF   (K'&RSNCODE(1) LE 0).ZG8C   NO PARM                 00058200
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00058300
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00058400
              AIF   (N'&RSNCODE GT 1).ZG8C                              00058500
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00058600
.ZG8C         ANOP  ,                                                   00058700
.*-------------------------------------------------------------------   00058800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00058900
              AIF   (K'&ZXRSNCODE LE 0).ZG8R    NOT I/O                 00059000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG8R                      00059100
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00059200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         00059300
              AIF   (K'&ZCGPR GT 2).ZG8Q                                00059400
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              00059500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00059600
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        00059700
.ZG8P         ANOP  ,                                                   00059800
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             00059900
              AIF   ('&ZCGPR' LT '2').ZG8Q                              00060000
              AIF   ('&ZCGPR' LE '12').ZG8R                             00060100
.ZG8Q         ANOP  ,                                                   00060200
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00060300
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00060400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00060500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00060600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00060700
.ZG8R         ANOP  ,                                                   00060800
.******************************************************************     00060900
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00061000
.******************************************************************     00061100
              ACTR  10000                                               00061200
.*----------------------------------------------------------------***   00061300
.***AH.P02 EXTRA POSITIONALS                                            00061400
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00061500
&ZCVAL        SETC  ''          ERROR FIELD                             00061600
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00061700
.ZGLIST2      ANOP  ,                                                   00061800
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00061900
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00062000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00062100
              AGO   .ZGLIST2                                            00062200
.*                                                                      00062300
.ZGLIST3      ANOP  ,                                                   00062400
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00062500
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00062600
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00062700
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00062800
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00062900
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00063000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00063100
.ZGLISTX      ANOP  ,                                                   00063200
&ZASYSLNDX    SETA  0                                                   00063300
.*-------------------------------------------------------------------   00063400
.***AG.MF04 MF=(SLE)                                                    00063500
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00063600
.*******************************************************************    00063700
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00063800
.*******************************************************************    00063900
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00064000
.*******************************************************************    00064100
.***AE.01  START OF COFSDONO MACRO CODE                                 00064200
.*******************************************************************    00064300
              LCLC  &M0M0001                 NAME                       00064400
&M0M0001      SETC  '&XLABEL'                SET NAME                   00064500
              AIF   (K'&XLABEL NE 0).XLAB2                              00064600
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00064700
.*                                                                      00064800
.XLAB2        ANOP  ,                                                   00064900
&M0M0001 DS    0H                             COFSDONO-1                00065000
.*******************************************************************    00065100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00065200
.*******************************************************************    00065300
              PUSH  PRINT                                               00065400
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00065500
              PRINT OFF         ++ PR01                                 00065600
              AGO   .ZPRNTXX                                            00065700
.ZPRINTX      PRINT ON                                                  00065800
.ZPRNTXX      ANOP  ,                                                   00065900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00066000
.*-----------BAL macro code-------------                                00066100
         AIF    ('&XMF' EQ 'L').LFORM1                                  00066200
         LA     15,40               .Set DLF not active return code     00066300
         SLR    0,0                 .Clear DLF reason code              00066400
         AIF    ('&SYSASCE' EQ 'P').NOTAR1  Systate Primary             00066500
         SAR    14,0                .Clear the AR                       00066600
.NOTAR1  ANOP                                                           00066700
         L      14,16               .Get CVT addressability             00066800
         L      14,200(14)          .Get SCVT addressability            00066900
         ICM    14,15,52(14)                                            00067000
         BZ     AMGE&SYSNDX         .Bypass if DLF is not active        00067100
         ICM    14,15,8(14)                                             00067200
         BZ     AMGE&SYSNDX         .Bypass if DLF is not active        00067300
         ICM    14,15,12(14)                                            00067400
         BZ     AMGE&SYSNDX         .Bypass if DLF is not active        00067500
         LR     15,14               .Save value around parm list build  00067600
.LFORM1  ANOP                                                           00067700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00067800
.********************************************************************   00067900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00068000
.********************************************************************   00068100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00068200
                      LCLA  &ZOPN1         INVOCATION INDEX             00068300
                      LCLC  &ZOPL(4095)    LABEL                        00068400
                      LCLC  &ZOPO(4095)    OPERATION                    00068500
                      LCLC  &ZOPV(4095)    VALUE                        00068600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00068700
.*                                                                      00068800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00068900
.******************************************************************     00069000
.***AL.L10 COFSDONO FMT=LIST MF=S|L PARAMETERS                          00069100
.******************************************************************     00069200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00069300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00069400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(2,3).'A'                     00069500
&XMFATTR              SETC  '0D'                                        00069600
.*                                                                      00069700
&ZOPN                 SETA  &ZOPN+1                                     00069800
&ZOPL(&ZOPN)          SETC  ' '                                         00069900
&ZOPO(&ZOPN)          SETC  'B'                                         00070000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00070100
&ZOPD(&ZOPN)          SETC  '++ COFSDONO ARG PARMS'                     00070200
.*                                                                      00070300
&ZOPN                 SETA  &ZOPN+1                                     00070400
&ZOPL(&ZOPN)          SETC  ' '                                         00070500
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00070600
&ZOPV(&ZOPN)          SETC  '1'                                         00070700
&ZOPD(&ZOPN)          SETC  ' '                                         00070800
.*                                                                      00070900
.ZLMFSL2              ANOP  ,                                           00071000
.*-------------------------------------------------------------------   00071100
.***AM.L01  COFSDONO FMT=LIST PARAMETERS                                00071200
&ZOPN                 SETA &ZOPN+1                                      00071300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00071400
&ZOPO(&ZOPN)          SETC 'DS'                                         00071500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00071600
&ZOPD(&ZOPN)          SETC '++ COFSDONO PARM LIST'                      00071700
.*-------------------------------------------------------------------   00071800
.***AM.L02 XVERSION XL1                                                 00071900
&ZOPN                 SETA &ZOPN+1                                      00072000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00072100
&ZOPO(&ZOPN)          SETC 'DS'                                         00072200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00072300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00072400
.*-------------------------------------------------------------------   00072500
.***AM.L09  XOBJNAME CL64                                               00072600
&ZOPN                 SETA &ZOPN+1                                      00072700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOBJNAME'                         00072800
&ZOPO(&ZOPN)          SETC 'DS'                                         00072900
&ZOPV(&ZOPN)          SETC 'CL64'                                       00073000
&ZOPD(&ZOPN)          SETC '++ &ZXOBJNAME  XOBJNAME'                    00073100
.*-------------------------------------------------------------------   00073200
.***AM.L09  XRSV01 CL7                                                  00073300
&ZOPN                 SETA &ZOPN+1                                      00073400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV01'                           00073500
&ZOPO(&ZOPN)          SETC 'DS'                                         00073600
&ZOPV(&ZOPN)          SETC 'CL7'                                        00073700
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV01'                        00073800
.*-------------------------------------------------------------------   00073900
.***AM.L10 END OF COFSDONO LIST PARAMETERS                              00074000
&ZOPN                 SETA &ZOPN+1                                      00074100
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00074200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00074300
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00074400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00074500
.*                                                                      00074600
&ZOPN                 SETA &ZOPN+1                                      00074700
&ZOPL(&ZOPN)          SETC ' '                                          00074800
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00074900
&ZOPV(&ZOPN)          SETC '1'                                          00075000
&ZOPD(&ZOPN)          SETC ' '                                          00075100
.*-------------------------------------------------------------------   00075200
.***AL.L12 COFSDONO FMT=LIST MF=S|L PARAMETERS                          00075300
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00075400
.*                                                                      00075500
&ZOPN                 SETA  &ZOPN+1                                     00075600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00075700
&ZOPO(&ZOPN)          SETC  'DC'                                        00075800
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00075900
&ZOPD(&ZOPN)          SETC  '++ COFSDONO ARG PARMS'                     00076000
.*                                                                      00076100
.ZLMFSLX              ANOP  ,                                           00076200
.*-------------------------------------------------------------------   00076300
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00076400
&ZPLLEN               SETA 72                                           00076500
.*                                                                      00076600
.******************************************************************     00076700
.***AI.L01 COFSDONO FMT=LIST FILL IN PARAMETER AREA                     00076800
.******************************************************************     00076900
                      ACTR  10000                                       00077000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00077100
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00077200
&ZCVAL                SETC  'LAE'          XAX MODE                     00077300
.ZIMFXA               ANOP ,                                            00077400
.*                                                                      00077500
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00077600
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00077700
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00077800
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00077900
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00078000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00078100
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00078200
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00078300
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00078400
&ZOPN                 SETA  &ZOPN+1                                     00078500
&ZOPL(&ZOPN)          SETC  ' '                                         00078600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00078700
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00078800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00078900
                      AGO   .ZIMFNX                                     00079000
.*                                                                      00079100
.ZIMFN2               ANOP ,                                            00079200
&ZOPN                 SETA  &ZOPN+1                                     00079300
&ZOPL(&ZOPN)          SETC  ' '                                         00079400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00079500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00079600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00079700
.ZIMFNX               ANOP ,                                            00079800
.********************************************************************   00079900
.***AI.L02 COFSDONO FMT=LIST INITIALIZE PARAMETER AREA                  00080000
.********************************************************************   00080100
.***AI.L03 MF=(SLE)                                                     00080200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00080300
.*                                                                      00080400
&ZOPN                 SETA  &ZOPN+1                                     00080500
&ZOPL(&ZOPN)          SETC  ' '                                         00080600
&ZOPO(&ZOPN)          SETC  'XC'                                        00080700
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00080800
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00080900
.ZIMFLX               ANOP  ,                                           00081000
.*-------------------------------------------------------------------   00081100
.***AI.L04A XVERSION XL1                                                00081200
&ZOPN                 SETA  &ZOPN+1                                     00081300
&ZOPL(&ZOPN)          SETC  ' '                                         00081400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00081500
&ZOPV(&ZOPN)          SETC  '0(1),1'                                    00081600
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00081700
.*-------------------------------------------------------------------   00081800
.***AI.L25  XOBJNAME CL64                                               00081900
                      AIF   ('&ZXOBJNAME' EQ '').ZI2E  NOT USED         00082000
                      AIF   ('&ZXOBJNAME' EQ 'OUTPUT').ZI2E             00082100
&ZCGPR                SETC  '&XOBJNAME'                                 00082200
.*                                                                      00082300
                      AIF   ('&XOBJNAME'(1,1) NE '(').ZI2B              00082400
&ZCGPR   SETC  '0('.'&XOBJNAME'(2,K'&XOBJNAME-2).')'                    00082500
.ZI2B                 ANOP  ,                                           00082600
.*                                                                      00082700
&ZOPN                 SETA  &ZOPN+1                                     00082800
&ZOPL(&ZOPN)          SETC  ' '                                         00082900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00083000
&ZOPV(&ZOPN)          SETC  '1(64,1),&ZCGPR'                            00083100
&ZOPD(&ZOPN)          SETC  '++ &ZXOBJNAME XOBJNAME CL64'               00083200
.*                                                                      00083300
.ZI2E                 ANOP  ,                                           00083400
.*-------------------------------------------------------------------   00083500
&ZOPN1                SETA &ZOPN                                        00083600
.*******************************************************************    00083700
.***  PROCESS COFSDONO OUTPUT PARAMETERS                                00083800
.*******************************************************************    00083900
                      ACTR  10000                                       00084000
.*******************************************************************    00084100
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00084200
.*******************************************************************    00084300
&ZOPN                 SETA  &ZOPN+1                                     00084400
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               00084500
&ZOPO(&ZOPN)          SETC  'DS'                                        00084600
&ZOPV(&ZOPN)          SETC  '0H'                                        00084700
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      00084800
.*******************************************************************    00084900
.***AO.X02  RETURN CODE PROCESSING                                      00085000
.*******************************************************************    00085100
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00085200
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00085300
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00085400
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00085500
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00085600
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00085700
&ZOPN                 SETA  &ZOPN+1                                     00085800
&ZOPL(&ZOPN)          SETC  ' '                                         00085900
&ZOPO(&ZOPN)          SETC  'ST'                                        00086000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00086100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00086200
                      AGO   .ZMRETX                                     00086300
.*                                                                      00086400
.ZMRET2               ANOP  ,                                           00086500
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00086600
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00086700
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00086800
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00086900
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00087000
&ZOPN                 SETA  &ZOPN+1                                     00087100
&ZOPL(&ZOPN)          SETC  ' '                                         00087200
&ZOPO(&ZOPN)          SETC  'LR'                                        00087300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00087400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00087500
.ZMRETX               ANOP  ,                                           00087600
.*******************************************************************    00087700
.***AO.X03  REASON CODE PROCESSING                                      00087800
.*******************************************************************    00087900
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00088000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00088100
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00088200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00088300
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00088400
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00088500
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00088600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00088700
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00088800
&ZOPN                 SETA  &ZOPN+1                                     00088900
&ZOPL(&ZOPN)          SETC  ' '                                         00089000
&ZOPO(&ZOPN)          SETC  'ST'                                        00089100
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00089200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00089300
                      AGO   .ZMRSNX                                     00089400
.*                                                                      00089500
.ZMRSN2               ANOP  ,                                           00089600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00089700
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00089800
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00089900
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00090000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00090100
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00090200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00090300
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00090400
&ZOPN                 SETA  &ZOPN+1                                     00090500
&ZOPL(&ZOPN)          SETC  ' '                                         00090600
&ZOPO(&ZOPN)          SETC  'LR'                                        00090700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00090800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00090900
.ZMRSNX               ANOP  ,                                           00091000
.*******************************************************************    00091100
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00091200
.*******************************************************************    00091300
.ZMFLX                ANOP  ,              MF=L PROCESSING              00091400
.*******************************************************************    00091500
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00091600
.*******************************************************************    00091700
                      ACTR  10000                                       00091800
.*                                                                      00091900
                      LCLA  &ZLC           COLUMN POSITION              00092000
                      LCLA  &ZOPX          LIST TABLE INDEX             00092100
                      LCLC  &ZLL           LABEL                        00092200
                      LCLC  &ZLOP          OPERATION                    00092300
                      LCLC  &ZLV           VALUE                        00092400
                      LCLC  &ZLD           DESCRIPTION                  00092500
.*                                                                      00092600
&ZOPX                 SETA  1                                           00092700
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00092800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00092900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00093000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00093100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00093200
                      AIF   (K'&ZLD LE 0).ZL5                           00093300
&ZLC                  SETA  35             COMMENT COLUMN               00093400
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00093500
&ZLC                  SETA  33             COMMMENT COLUMN              00093600
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00093700
&ZLV                  SETC  '&ZLV'.' '                                  00093800
                      AGO   .ZL3                                        00093900
.*                                                                      00094000
.ZL4                  ANOP  ,                                           00094100
&ZLV                  SETC  '&ZLV'.' '                                  00094200
.ZL5                  ANOP  ,                                           00094300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00094400
.*                                                                      00094500
&ZLL     &ZLOP &ZLV                                                     00094600
.*                                                                      00094700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00094800
                      AGO   .ZL2           CONTINUE LOOPING             00094900
.*                                                                      00095000
.ZLX                  ANOP  ,                                           00095100
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00095200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00095300
         AIF    ('&XMF' EQ 'L').LFORM2                                  00095400
         PC     0(15)               .PC to COFMSONO                     00095500
.LFORM2  ANOP                                                           00095600
.*-----------BAL macro code-------------                                00095700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00095800
.ZLINKX               ANOP  ,                                           00095900
.*******************************************************************    00096000
.***AP.X01  FORMAT GENERATED CODE                                       00096100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00096200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00096300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00096400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00096500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00096600
                      AIF   (K'&ZLD LE 0).ZL51                          00096700
&ZLC                  SETA  35             COMMENT COLUMN               00096800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00096900
&ZLC                  SETA  33             COMMENT COLUMN               00097000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00097100
&ZLV                  SETC  '&ZLV'.' '                                  00097200
                      AGO   .ZL31                                       00097300
.*                                                                      00097400
.ZL41                 ANOP  ,                                           00097500
&ZLV                  SETC  '&ZLV'.' '                                  00097600
.ZL51                 ANOP  ,                                           00097700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00097800
.*                                                                      00097900
&ZLL     &ZLOP &ZLV                                                     00098000
.*                                                                      00098100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00098200
                      AGO   .ZL21          CONTINUE LOOPING             00098300
.*                                                                      00098400
.ZLX1                 ANOP  ,                                           00098500
.*******************************************************************    00098600
.***AP.X02  END OF COFSDONO MACRO                                       00098700
&ZCOFSDONO            SETC  'YES'          SET COFSDONO USED            00098800
         POP   PRINT                                                    00098900
*                                            COFSDONO-1                 00099000
         SPACE 1                                                        00099100
.ZLX2                 ANOP  ,                                           00099200
         MEND                                                           00099300
**********************************************************************/ 00099400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00099500
*%COFSDONO: MACRO KEYS(OBJNAME,RETCODE,RSNCODE,MF);                     00099600
*  ANS('?'||MACLABEL||' '||'COFSDONP '||MACLIST||                       00099700
*         ' '||MACKEYS||';') COL(MACLMAR);                              00099800
*%END COFSDONO;                                                         00099900
