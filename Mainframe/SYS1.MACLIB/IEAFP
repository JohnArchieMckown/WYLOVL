*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IEAFP                                  -09/30/97-<> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  Floating Point Services                       * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00600000
*     5647-A01 (C) COPYRIGHT IBM CORP. 1998                           * 00650000
*                                                                     * 00700000
* STATUS= HBB6606                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      IEAFP allows you to request that the system stop its status    * 01100000
*      saving of the additional floating point status provided with   * 01150000
*      the binary floating point architecture. This status consists   * 01200000
*      of the additional floating point (AFP) registers - FPRs        * 01250000
*      1,3,5,7-15 and the floating point control (FPC) register.      * 01300000
*                                                                     * 01350000
*      You would typically use this service only when you are a       * 01400000
*      server task which "subdispatches" unrelated units of work      * 01450000
*      (e.g., CICS transactions).  To avoid subsequent units of work  * 01500000
*      being penalized by the floating point actions of previous      * 01550000
*      units of work, the additional FP status saving function of the * 01600000
*      operating system can be turned off.  When a unit of work       * 01650000
*      actually begins to use FP, all appropriate status saving will  * 01700000
*      be resumed.                                                    * 01750000
*                                                                     * 01800000
*01* EXTERNAL CLASSIFICATION:                                         * 01850000
*                                                                     * 01900000
*02* GUPI: BASE                                                       * 01950000
*                                                                     * 02000000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 02050000
*                                                                     * 02100000
*01* ENVIRONMENT:                                                     * 02150000
*                                                                     * 02200000
*                                                                     * 02250000
*      Minimum authorization:                                         * 02300000
*                                                                     * 02350000
*                        The minimum authority for IEAFP is problem   * 02400000
*                        state and PSW key 8-15.                      * 02450000
*                                                                     * 02500000
*      Dispatchable unit mode: Task or SRB mode.                      * 02550000
*                                                                     * 02600000
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 02650000
*                                                                     * 02700000
*      AMODE:            31-bit.                                      * 02750000
*                                                                     * 02800000
*      ASC mode:         Primary or Access Register.                  * 02850000
*                                                                     * 02900000
*      Interrupt status: Enabled or disabled for I/O and external     * 02950000
*                        interrupts.                                  * 03000000
*                                                                     * 03050000
*      Locks:            The caller is not required to hold any locks * 03100000
*                        on entry.  The caller may hold the local,    * 03150000
*                        CMS, or CPU lock.                            * 03200000
*                                                                     * 03250000
*      Control parameters: None.                                      * 03300000
*                                                                     * 03350000
*                                                                     * 03400000
*                                                                     * 03450000
*01* PROGRAMMING REQUIREMENTS:                                        * 03500000
*                                                                     * 03550000
*    The caller can include the IHAFPRET mapping macro to get equate  * 03600000
*    symbols for the return and reason codes provided by the IEAFP    * 03650000
*    macro.                                                           * 03700000
*                                                                     * 03750000
*01* RESTRICTIONS:                                                    * 03800000
*                                                                     * 03850000
*    IEAFP must not be issued from an asynchronous exit routine.      * 03900000
*                                                                     * 03950000
*01* INPUT REGISTER INFORMATION:                                      * 04000000
*                                                                     * 04050000
*    Before issuing the IEAFP macro, the caller does not have to      * 04100000
*    place any information into any general purpose register (GPR) or * 04150000
*    access register (AR) unless using it in register notation for a  * 04200000
*    particular parameter, or using it as a base register.            * 04250000
*                                                                     * 04300000
*01* OUTPUT REGISTER INFORMATION:                                     * 04350000
*                                                                     * 04400000
*    When control returns to the caller, the GPRs contain:            * 04450000
*                                                                     * 04500000
*                                                                     * 04550000
*    REGISTER    CONTENTS                                             * 04600000
*                                                                     * 04650000
*    0           Reason code, when GPR 15 is non-zero                 * 04700000
*                                                                     * 04750000
*    1           Used as a work register by the system                * 04800000
*                                                                     * 04850000
*    2-13        Unchanged                                            * 04900000
*                                                                     * 04950000
*    14-15       Used as a work register by the system                * 05000000
*                                                                     * 05050000
*    15          Return code                                          * 05100000
*                                                                     * 05150000
*                                                                     * 05200000
*                                                                     * 05250000
*    When control returns to the caller, the ARs contain:             * 05300000
*                                                                     * 05350000
*                                                                     * 05400000
*    REGISTER    CONTENTS                                             * 05450000
*                                                                     * 05500000
*    0-1         Used as work registers by the system                 * 05550000
*                                                                     * 05600000
*    2-13        Unchanged                                            * 05650000
*                                                                     * 05700000
*    14-15       Used as work registers by the system                 * 05750000
*                                                                     * 05800000
*                                                                     * 05850000
*                                                                     * 05900000
*    Some callers depend on register contents remaining the same      * 05950000
*    before and after issuing a service.  If the system changes the   * 06000000
*    contents of registers on which the caller depends, the caller    * 06050000
*    must save them before issuing the service, and restore them      * 06100000
*    after the system returns control.                                * 06150000
*                                                                     * 06200000
*01* PERFORMANCE IMPLICATIONS:                                        * 06250000
*    None.                                                            * 06300000
*                                                                     * 06350000
*01* SYNTAX:                                                          * 06400000
*                                                                     * 06450000
*[xlabel]  IEAFP     STOP                                             * 06500000
*                  [,RETCODE=xretcode]                                * 06550000
*                  [,RSNCODE=xrsncode]                                * 06600000
*                                                                     * 06650000
*                                                                     * 06700000
*      Where:                                                         * 06750000
*                                                                     * 06800000
*                                                                     * 06850000
*      [xlabel]                                                       * 06900000
*          is an optional symbol, starting in column 1, that is the   * 06950000
*          name on the IEAFP macro invocation.  The name must conform * 07000000
*          to the rules for an ordinary assembler language symbol.    * 07050000
*          DEFAULT: No name.                                          * 07100000
*                                                                     * 07150000
*                                                                     * 07200000
*                                                                     * 07250000
*                                                                     * 07300000
*      STOP                                                           * 07350000
*          keyword that indicates to stop saving additional floating  * 07400000
*          point status until such time as a new floating point       * 07450000
*          operation requires it.                                     * 07500000
*                                                                     * 07550000
*                                                                     * 07600000
*                                                                     * 07650000
*                                                                     * 07700000
*      [RETCODE=xretcode]                                             * 07750000
*          is the name (RS-type) of an optional fullword output       * 07800000
*          variable, or register (2)-(12), into which the return code * 07850000
*          is to be copied from GPR 15.                               * 07900000
*                                                                     * 07950000
*                                                                     * 08000000
*                                                                     * 08050000
*                                                                     * 08100000
*      [RSNCODE=xrsncode]                                             * 08150000
*          is the name (RS-type) of an optional fullword output       * 08200000
*          variable, or register (2)-(12), into which the reason code * 08250000
*          is to be copied from GPR 0.                                * 08300000
*                                                                     * 08350000
*                                                                     * 08400000
*                                                                     * 08450000
*01* ABEND CODES:  None.                                              * 08500000
*                                                                     * 08550000
*01* RETURN CODES:                                                    * 08600000
*                                                                     * 08650000
*                                                                     * 08700000
*                 Macro IHAFPRET provides equate symbols for the      * 08750000
*                 return and reason codes.                            * 08800000
*                                                                     * 08850000
*       0         Name: IeafpRc_OK                                    * 08900000
*                                                                     * 08950000
*                 Meaning:  IEAFP request successful.                 * 09000000
*                                                                     * 09050000
*                 Action:  None required.                             * 09100000
*                                                                     * 09150000
*       8         Name: IeafpRc_InvParm                               * 09200000
*                                                                     * 09250000
*                 Meaning:  IEAFP request specifies parmeters that    * 09300000
*                 are not valid.                                      * 09350000
*                                                                     * 09400000
*                 Action:  Refer to the action provided with the      * 09450000
*                 specific reason code.                               * 09500000
*                                                                     * 09550000
*                                                                     * 09600000
*                 HEX REASON  MEANING/ACTION                          * 09650000
*                 CODE                                                * 09700000
*                                                                     * 09750000
*                 xxxx0801    Name: IeafpRsnBadFunction               * 09800000
*                                                                     * 09850000
*                             Meaning: Incorrect value passed to      * 09900000
*                             target routine.                         * 09950000
*                                                                     * 10000000
*                             Action: Check for possible storage      * 10050000
*                             overlay.                                * 10100000
*                                                                     * 10150000
*                                                                     * 10200000
*                                                                     * 10250000
*                                                                     * 10300000
*       C         Name: IeafpRc_Env                                   * 10350000
*                                                                     * 10400000
*                 Meaning: Environmental error                        * 10450000
*                                                                     * 10500000
*                 Action:  Refer to the action provided with the      * 10550000
*                 specific reason code.                               * 10600000
*                                                                     * 10650000
*                                                                     * 10700000
*                 HEX REASON  MEANING/ACTION                          * 10750000
*                 CODE                                                * 10800000
*                                                                     * 10850000
*                 xxxx0C01    Name: IeafpRsnFromAsynchExit            * 10900000
*                                                                     * 10950000
*                             Meaning: IEAFP was issued from an       * 11000000
*                             asynchronous exit routine.              * 11050000
*                                                                     * 11100000
*                             Action: Avoid issuing IEAFP from an     * 11150000
*                             asynchronous exit routine.              * 11200000
*                                                                     * 11250000
*                                                                     * 11300000
*                                                                     * 11350000
*                                                                     * 11400000
*                                                                     * 11450000
*01* REASON CODES:                                                    * 11500000
*                                                                     * 11550000
*       Reason codes, as appropriate, are defined under their         * 11600000
*       corresponding return code.                                    * 11650000
*                                                                     * 11700000
*01* MODULE TYPE:  ASSEM MACRO                                        * 11750000
*                                                                     * 11800000
*02*   PROCESSOR:  ASSEM                                              * 11850000
*                                                                     * 11900000
*01* COMPONENT:  SC1C5                                                * 11950000
*                                                                     * 12000000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 12050000
*                                                                     * 12100000
*01* EXAMPLES:                                                        * 12150000
*                                                                     * 12200000
*    Example 1                                                        * 12250000
*                                                                     * 12300000
*    Operation:                                                       * 12350000
*                                                                     * 12400000
*                                                                     * 12450000
*    1.  Stop additional status saving                                * 12500000
*                                                                     * 12550000
*                                                                     * 12600000
*                                                                     * 12650000
*    The code is as follows.                                          * 12700000
*                                                                     * 12750000
*               IEAFP STOP                                            * 12800000
*                                                                     * 12850000
*                                                                     * 12900000
*01* MACRO USAGE NOTES:                                               * 12950000
*                                                                     * 13000000
*                                                                     * 13050000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 13100000
*        global macro variable.  Any value other than 'NO' will       * 13150000
*        result in the macro expansion being printed.  The default is * 13200000
*        'YES'.  The following examples illustrate how the ZPRINT     * 13250000
*        variable should be set.                                      * 13300000
*                                                                     * 13350000
*                    GBLC &ZPRINT                                     * 13400000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 13450000
*                                                                     * 13500000
*                                                                     * 13550000
*                                                                     * 13600000
*01* CHANGE ACTIVITY:                                                 * 13650000
*                                                                     * 13700000
*   Flag LineItem  FMID    Date   ID    Comment                       * 13750000
*                                                                     * 13800000
*    $L0=IEEEAMG  HBB6606 980825 PD00XB:  IEEE FP                     * 13850000
*    $L1=IEEESUP  HBB6606 980825 PD00XB:  IEEE FP                     * 13900000
****** END OF SPECIFICATIONS *****************************************/ 13950000
*/* TLINE 1 *********************************************************** 14000000
         MACRO                                                          14050000
&XLABEL  IEAFP &RETCODE=,&RSNCODE=                                      14100000
.*                                                                      14150000
*              MACDATE -09/30/97-<0>                                    14200000
.*                                                                      14250000
.*******************************************************************    14300000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        14350000
.*******************************************************************    14400000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   14450000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     14500000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             14550000
.*                                                                      14600000
              GBLC  &ZIEAFP     YES=MACRO USED AT LEAST ONCE            14650000
.*******************************************************************    14700000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          14750000
.*******************************************************************    14800000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 14850000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            14900000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              14950000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             15000000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             15050000
              LCLA  &ZAWRK      USED AS A WORK AREA                     15100000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  15150000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   15200000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 15250000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             15300000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 15350000
              LCLA  &ZMACRET    MACRO RETURN CODE                       15400000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        15450000
.*                                                                      15500000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      15550000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              15600000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   15650000
              LCLC  &ZENDBASEPL                 End of base PL          15700000
.********************************************************************   15750000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 15800000
.********************************************************************   15850000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 15900000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          15950000
.*                                                                      16000000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       16050000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        16100000
              SPLEVEL  TEST                                             16150000
.ZSYS2        ANOP  ,                                                   16200000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              16250000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              16300000
              SYSSTATE TEST                                             16350000
              AGO   .ZSYS4                                              16400000
.ZSYS3        ANOP  ,                                                   16450000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 16500000
.ZSYS4        ANOP  ,                                                   16550000
.*******************************************************************    16600000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   16650000
.*******************************************************************    16700000
              LCLC  &XSTOP      ++ VALUE                                16750000
              LCLC  &XRETCODE   ++ NAME                                 16800000
              LCLC  &XRSNCODE   ++ NAME                                 16850000
.*******************************************************************    16900000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           16950000
.*******************************************************************    17000000
              LCLC  &ZXSTOP     ++ INPUT VALUE                          17050000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          17100000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          17150000
.********************************************************************   17200000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 17250000
.********************************************************************   17300000
              ACTR  10000                                               17350000
.*----------------------------------------------------------------***   17400000
.***AG.KXVAR01 VALUE, RQD INPUT, KEYS -NO ARGUMENTS                     17450000
&XSTOP        SETC  ''          RESET XVARIABLE                         17500000
&ZXSTOP       SETC  ''          RESET IN/OUTPUT                         17550000
&ZASYSLNDX    SETA  0                                                   17600000
.ZG2A         ANOP  ,           POSITIONAL MACRO KEY                    17650000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        17700000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B                          17750000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             17800000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'STOP').ZG2A                  17850000
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 17900000
&XSTOP        SETC  'STOP'      MACRO KEY FOUND                         17950000
&ZXSTOP       SETC  'INPUT'     SET IN/OUTPUT                           18000000
.ZG2B         ANOP  ,                                                   18050000
.*-------------------------------------------------------------------   18100000
.***AG.KXVAR02 VALUE, RQD INPUT, KEYS -NO ARGUMENTS                     18150000
              AIF   (K'&XSTOP GT 0).ZG2C        KEY ENTERED             18200000
&ZMS          SETC  ' '         *KRQDA*                                 18250000
&ZMS          SETC  '&ZMS "STOP" KEY AND ITS ARGUMENT'                  18300000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             18350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18400000
.ZG2C         ANOP  ,                                                   18450000
.*----------------------------------------------------------------***   18500000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    18550000
              AIF   (N'&RETCODE LE 1).ZG5A      CK NUM                  18600000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           18650000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    18700000
&ZMS          SETC  '&ZMS "RETCODE"'                                    18750000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 18800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18850000
.ZG5A         ANOP  ,                                                   18900000
.*-------------------------------------------------------------------   18950000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        19000000
              AIF   (K'&RETCODE(1) LE 0).ZG5C   NO PARM                 19050000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              19100000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           19150000
              AIF   (N'&RETCODE GT 1).ZG5C                              19200000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           19250000
.ZG5C         ANOP  ,                                                   19300000
.*-------------------------------------------------------------------   19350000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   19400000
              AIF   (K'&ZXRETCODE LE 0).ZG5R    NOT I/O                 19450000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG5R                      19500000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        19550000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         19600000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                19650000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              19700000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       19750000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        19800000
.ZG5P         ANOP  ,                                                   19850000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             19900000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              19950000
              AIF   ('&ZCGPR' LE '12').ZG5R                             20000000
.ZG5Q         ANOP  ,                                                   20050000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           20100000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    20150000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           20200000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    20250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             20300000
.ZG5R         ANOP  ,                                                   20350000
.*----------------------------------------------------------------***   20400000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    20450000
              AIF   (N'&RSNCODE LE 1).ZG8A      CK NUM                  20500000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           20550000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    20600000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    20650000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 20700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             20750000
.ZG8A         ANOP  ,                                                   20800000
.*-------------------------------------------------------------------   20850000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        20900000
              AIF   (K'&RSNCODE(1) LE 0).ZG8C   NO PARM                 20950000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              21000000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           21050000
              AIF   (N'&RSNCODE GT 1).ZG8C                              21100000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           21150000
.ZG8C         ANOP  ,                                                   21200000
.*-------------------------------------------------------------------   21250000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   21300000
              AIF   (K'&ZXRSNCODE LE 0).ZG8R    NOT I/O                 21350000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG8R                      21400000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        21450000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         21500000
              AIF   (K'&ZCGPR GT 2).ZG8Q                                21550000
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              21600000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       21650000
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        21700000
.ZG8P         ANOP  ,                                                   21750000
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             21800000
              AIF   ('&ZCGPR' LT '2').ZG8Q                              21850000
              AIF   ('&ZCGPR' LE '12').ZG8R                             21900000
.ZG8Q         ANOP  ,                                                   21950000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           22000000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    22050000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           22100000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    22150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22200000
.ZG8R         ANOP  ,                                                   22250000
.******************************************************************     22300000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        22350000
.******************************************************************     22400000
              ACTR  10000                                               22450000
.*-------------------------------------------------------------------   22500000
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           22550000
&ZCVAL        SETC  ''          ERROR FIELD                             22600000
&ZAWRK        SETA  0           POSITIONAL COUNTER                      22650000
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       22700000
.ZGLIST2      ANOP  ,                                                   22750000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          22800000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 22850000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          22900000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         22950000
              AIF   (&ZAWRK LE 0).ZGLIST2                               23000000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 23050000
              AGO   .ZGLIST2                                            23100000
.*                                                                      23150000
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  23200000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             23250000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           23300000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     23350000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              23400000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      23450000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              23500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23550000
.ZGLISTX      ANOP  ,                                                   23600000
&ZASYSLNDX    SETA  0                                                   23650000
.*******************************************************************    23700000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       23750000
.*******************************************************************    23800000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          23850000
.*******************************************************************    23900000
.***AE.01  START OF IEAFP MACRO CODE                                    23950000
.*******************************************************************    24000000
              LCLC  &M0M0001                 NAME                       24050000
&M0M0001      SETC  '&XLABEL'                SET NAME                   24100000
              AIF   (K'&XLABEL NE 0).XLAB2                              24150000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               24200000
.*                                                                      24250000
.XLAB2        ANOP  ,                                                   24300000
&M0M0001 DS    0H                             IEAFP-0                   24350000
.*******************************************************************    24400000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              24450000
.*******************************************************************    24500000
              PUSH  PRINT                                               24550000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          24600000
              PRINT OFF         ++ PR01                                 24650000
              AGO   .ZPRNTXX                                            24700000
.ZPRINTX      PRINT ON                                                  24750000
.ZPRNTXX      ANOP  ,                                                   24800000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  24850000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  24900000
.********************************************************************   24950000
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    25000000
.********************************************************************   25050000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       25100000
                      LCLA  &ZOPN1         INVOCATION INDEX             25150000
                      LCLC  &ZOPL(4095)    LABEL                        25200000
                      LCLC  &ZOPO(4095)    OPERATION                    25250000
                      LCLC  &ZOPV(4095)    VALUE                        25300000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  25350000
.*                                                                      25400000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     25450000
.*-------------------------------------------------------------------   25500000
&ZOPN1                SETA &ZOPN                                        25550000
.*******************************************************************    25600000
.***AO.X02  RETURN CODE PROCESSING                                      25650000
.*******************************************************************    25700000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    25750000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            25800000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             25850000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             25900000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               25950000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                26000000
&ZOPN                 SETA  &ZOPN+1                                     26050000
&ZOPL(&ZOPN)          SETC  ' '                                         26100000
&ZOPO(&ZOPN)          SETC  'ST'                                        26150000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              26200000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        26250000
                      AGO   .ZMRETX                                     26300000
.*                                                                      26350000
.ZMRET2               ANOP  ,                                           26400000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                26450000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                26500000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                26550000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  26600000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   26650000
&ZOPN                 SETA  &ZOPN+1                                     26700000
&ZOPL(&ZOPN)          SETC  ' '                                         26750000
&ZOPO(&ZOPN)          SETC  'LR'                                        26800000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 26850000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        26900000
.ZMRETX               ANOP  ,                                           26950000
.*******************************************************************    27000000
.***AO.X03  REASON CODE PROCESSING                                      27050000
.*******************************************************************    27100000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    27150000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            27200000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              27250000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             27300000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              27350000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             27400000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                27450000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 27500000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                27550000
&ZOPN                 SETA  &ZOPN+1                                     27600000
&ZOPL(&ZOPN)          SETC  ' '                                         27650000
&ZOPO(&ZOPN)          SETC  'ST'                                        27700000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               27750000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        27800000
                      AGO   .ZMRSNX                                     27850000
.*                                                                      27900000
.ZMRSN2               ANOP  ,                                           27950000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                28000000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 28050000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                28100000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 28150000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                28200000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   28250000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    28300000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   28350000
&ZOPN                 SETA  &ZOPN+1                                     28400000
&ZOPL(&ZOPN)          SETC  ' '                                         28450000
&ZOPO(&ZOPN)          SETC  'LR'                                        28500000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  28550000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        28600000
.ZMRSNX               ANOP  ,                                           28650000
.*******************************************************************    28700000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               28750000
.*******************************************************************    28800000
                      ACTR  10000                                       28850000
.*                                                                      28900000
                      LCLA  &ZLC           COLUMN POSITION              28950000
                      LCLA  &ZOPX          LIST TABLE INDEX             29000000
                      LCLC  &ZLL           LABEL                        29050000
                      LCLC  &ZLOP          OPERATION                    29100000
                      LCLC  &ZLV           VALUE                        29150000
                      LCLC  &ZLD           DESCRIPTION                  29200000
.*                                                                      29250000
&ZOPX                 SETA  1                                           29300000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            29350000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              29400000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              29450000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              29500000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              29550000
                      AIF   (K'&ZLD LE 0).ZL5                           29600000
&ZLC                  SETA  35             COMMENT COLUMN               29650000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    29700000
&ZLC                  SETA  33             COMMMENT COLUMN              29750000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   29800000
&ZLV                  SETC  '&ZLV'.' '                                  29850000
                      AGO   .ZL3                                        29900000
.*                                                                      29950000
.ZL4                  ANOP  ,                                           30000000
&ZLV                  SETC  '&ZLV'.' '                                  30050000
.ZL5                  ANOP  ,                                           30100000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               30150000
.*                                                                      30200000
&ZLL     &ZLOP &ZLV                                                     30250000
.*                                                                      30300000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               30350000
                      AGO   .ZL2           CONTINUE LOOPING             30400000
.*                                                                      30450000
.ZLX                  ANOP  ,                                           30500000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  30550000
         LA    0,0                     Indicate "STOP" function    @L1A 30600000
         L     14,16(0,0)              GET CVT ADDRESS             @L1A 30650000
         L     14,772(14,0)            GET SFT ADDRESS             @L1A 30700000
         L     14,496(14,0)            GET LX/EX FOR SERVICE RTN   @L1A 30750000
         PC    0(14)                                               @L1A 30800000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  30850000
.*******************************************************************    30900000
.***AP.X01  FORMAT GENERATED CODE                                       30950000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            31000000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              31050000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              31100000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              31150000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              31200000
                      AIF   (K'&ZLD LE 0).ZL51                          31250000
&ZLC                  SETA  35             COMMENT COLUMN               31300000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   31350000
&ZLC                  SETA  33             COMMENT COLUMN               31400000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  31450000
&ZLV                  SETC  '&ZLV'.' '                                  31500000
                      AGO   .ZL31                                       31550000
.*                                                                      31600000
.ZL41                 ANOP  ,                                           31650000
&ZLV                  SETC  '&ZLV'.' '                                  31700000
.ZL51                 ANOP  ,                                           31750000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               31800000
.*                                                                      31850000
&ZLL     &ZLOP &ZLV                                                     31900000
.*                                                                      31950000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               32000000
                      AGO   .ZL21          CONTINUE LOOPING             32050000
.*                                                                      32100000
.ZLX1                 ANOP  ,                                           32150000
.*******************************************************************    32200000
.***AP.X02  END OF IEAFP MACRO                                          32250000
&ZIEAFP               SETC  'YES'          SET IEAFP USED               32300000
         POP   PRINT                                                    32350000
*                                            IEAFP-0                    32400000
         SPACE 1                                                        32450000
.ZLX2                 ANOP  ,                                           32500000
         MEND                                                           32550000
**********************************************************************/ 32600000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  32650000
*%IEAFP: MACRO KEYS(STOP,RETCODE,RSNCODE);                              32700000
*  ANS('?'||MACLABEL||' '||'IEAFPP '||MACLIST||                         32750000
*         ' '||MACKEYS||';') COL(MACLMAR);                              32800000
*%END IEAFP;                                                            32850000
