*%/* START OF SPECIFICATIONS *****************************************  00008300
*01* PROPRIETARY STATEMENT:                                             00016600
*01**PROPRIETARY_STATEMENT********************************************  00024900
*                                                                       00033200
*   LICENSED MATERIALS - PROPERTY OF IBM                                00041500
*   THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                         00049800
*   5647-A01 (C) COPYRIGHT IBM CORP. 1988, 2000                         00058100
*                                                                       00066400
*   STATUS= HBB7703                                              @L3C   00074700
*                                                                       00083000
*01**END_OF_PROPRIETARY_STATEMENT*************************************  00091300
*                                                                       00100000
*01*  MACRO NAME: ATTACHX                                               00120000
*                                                                       00140000
*01*  DESCRIPTIVE NAME: Attach a new task                               00160000
*                                                                       00180000
*                                                                       00200000
*01*  FUNCTION:                                                         00800000
*        Provide the interface to the ATTACH subtask service routine    00850000
*        (IEAVEAT0) via SVC 42                                          00900000
*                                                                       00950000
*01* EXTERNAL CLASSIFICATION:                                           01025000
*                                                                       01050000
*02* PI: BASE                                                           01075000
*                                                                       01100000
*02* BASE: FIELDS                                                       01125000
*          GIVEJPQ JSCB MF SF VL                                        01150000
*          FPREGSA TSLOGON LSQA ROLL HIARCHY TQE                        01175000
*                                                                       01183300
*01* END OF EXTERNAL CLASSIFICATION:                                    01191600
*                                                                       01193200
*01*  COMPONENT: SC1CL (Task Management)                                01194800
*                                                                       01196400
*01*  MACLIB: AMACLIB                                                   01198000
*                                                                       01200000
*01*  CHANGE ACTIVITY:                                                  01250000
*   $D0=DCR0049  HBB3310  860416  PD16H4: ATTACHX support               01300000
*   $P1=PC40708  HBB3310  860216  PD16H4: Set high bit of ECB address   01325000
*   $L2=DBFMC    HBB4430  910807  PD16FH: STATUS REWRITE                01337500
*   $P2=PKB0146  HBB4430  911106  PD16FH: ATFORMNM for DISP=RESET       01343700
*   $P3=PKB0754  HBB4430  920629  PD16CU: Set ATNFORM correctly for     01345800
*                                         DISP=RESET                    01347900
*   $L3=BCOTE    HBB6606  971208  B7HGH5: CICS OTE support              01348900
*   $L4=PR607    JBB6607  980710  B7HGH5: Delete blank line             01349400
*   $L5=CICSOSUP JBB6609  980928  PD00XB: KEY=NINE,PKM=REPLACE          01349600
*   $L6=64BITSUP HBB7703  981204  PD00XB: ESAME                         01349800
*   $P4=PXD0139  HBB7703  990603  PD00XB: Fix typos                     01349900
*   $01=OW45366  JBB6609  000808  U2IAXZ: Clear correct bit for KEY0    01349920
*                                         when SF=(E,x) and KEY=NINE    01349940
*                                         are specified.                01349960
*                                                                       01350000
*01* COMPONENT: TASK MANAGEMENT (SC1CL)                                 01366600
*                                                                       01383200
**** END OF SPECIFICATIONS *****************************************    01400000
*                                                                       01450000
         MACRO                                                          01500000
&NAME    ATTACHX &EP=,&EPLOC=,&DE=,&DCB=,&PARAM=,&VL=,&ECB=,           X01550000
               &GSPV=,&KEY=PROP,&GSPL=,&SHSPL=,&ETXR=,&LPMOD=,         X01600000
               &DPMOD=,&MF=I,&SF=I,&SHSPV=,&SM=PROB,&SZERO=YES,        X01650000
               &JSTCB=NO,&SVAREA=YES,&ROLL=(YES,NO),&HIARCHY=,         X01700000
               &JSCB=,&GIVEJPQ=NO,&TASKLIB=,&TSLOGON=NO,               X01750000
               &STAI=,&PURGE=,&ASYNCH=,                                X01800000
               &ESTAI=,&TERM=NO,&NSHSPL=,&NSHSPV=,&RSAPF=NO,           X01850000
               &RELATED=,                                              X01900000
               &LSQA=0,&DISP=YES,&TID=0,&TQE=,&FPREGSA=,               X01950000
               &ALCOPY=,                                           @L2CX01983300
               &TCB=,&PLIST8=,&PLIST4=,&PKM=,                      @P4CX01999900
               &ADDRENV=                                           @L3A 02016500
         GBLB  &IHBSWA,&IHBSWB                                          02050000
         GBLC  &IHBNO                                                   02100000
         GBLC  &SYSASCE              ASC ENVIRONMENT                    02150000
         GBLC  &SYSAM64              AMODE 64                      @L6A 02151500
         SYSSTATE TEST                                             @L6A 02153000
         GBLC  &SYSPLIST8            8-byte parameter list         @L6A 02154500
         LCLC  &SAVEPLIST8           Saved value                   @L6A 02156000
&SAVEPLIST8 SETC '&SYSPLIST8'                                      @L6A 02157500
&SYSPLIST8 SETC ''                                                 @L6A 02159000
.********************************************************************** 02160500
.*   VALIDATE PLIST4, PLIST8                                          * 02162000
.********************************************************************** 02163500
         AIF   ('&PLIST8' EQ '').PLIST8END                         @L6A 02170400
         AIF   ('&PLIST8' EQ 'YES' OR '&PLIST8' EQ 'NO').PLIST8END @L6A 02177300
         IHBERMAC 1001,PLIST8,&PLIST8                              @L6A 02184200
         AGO   .EXIT                                               @L6A 02191100
.PLIST8END ANOP                                                    @L6A 02198000
         AIF   ('&PLIST4' EQ '').PLIST4END                         @L6A 02204900
         AIF   ('&PLIST4' EQ 'YES' OR '&PLIST4' EQ 'NO').PLIST4END @L6A 02211800
         IHBERMAC 1001,PLIST4,&PLIST4                              @L6A 02218700
         AGO   .EXIT                                               @L6A 02225600
.PLIST4END ANOP                                                    @L6A 02232500
         AIF   ('&PLIST8' EQ '' OR '&PLIST4' EQ '').PLIST84END     @L6A 02239400
         IHBERMAC 1304,PLIST4,PLIST8                               @L6A 02246300
.PLIST84END ANOP                                                   @L6A 02253200
         AIF   ('&PLIST8' EQ 'YES').YESPL8                         @L6A 02260100
         AIF   ('&PLIST4' EQ 'NO').YESPL8                          @L6A 02267000
         AIF   ('&SYSAM64' EQ 'YES').YESPL8                        @L6A 02273900
         AIF   ('&PLIST8' NE 'YES').NOPL8                          @L6A 02280800
.YESPL8  ANOP                                                      @L6A 02287700
&SYSPLIST8 SETC 'YES'                                              @L6A 02294600
.NOPL8   ANOP                                                      @L6A 02301500
         AIF   ('&PLIST4' EQ 'NO').NOPL4                           @L6A 02308400
&SYSPLIST8 SETC ''                                                 @L6A 02315300
.NOPL4   ANOP                                                      @L6A 02322200
         LCLA  &A,&NUMB                                            @L4A 02325600
         LCLA  &NUMB1,&NUMB3,&NUMF3,&NUMF3S                        @L5A 02329100
         LCLA  &NI27,&NI52,&NI60,&NI62                             @L5A 02336000
         LCLB  &F27(8),&F52(8),&F60(8),&F62(8)                     @L5C 02342900
         LCLB  &NUMB3B                                                  02400000
         LCLB  &SWSTAI,&SWESTAI                                         02450000
         LCLC  &STAITYP,&STXADDR,&STPADDR                               02500000
         LCLC  &H,&GNAME,&NSHSP                                         02550000
         LCLC  &FORM#                FORMAT NUMBER                      02600000
         LCLC  &NICOPY               MASK TO TURN OFF ALCOPY BIT        02650000
&F27(4)  SETB  1                     Initialize KEY0 bit           @L5A 02675000
&F52(1)  SETB  1                     INITIALIZE NSHSPL BIT              02700000
&F60(1)  SETB  1                     INITIALIZE DE BIT                  02750000
&F60(2)  SETB  1                     INITIALIZE GSPL BIT                02800000
&F60(3)  SETB  1                     INITIALIZE SHSPL BIT               02850000
&F62(1)  SETB  1                     Initialize KEYNINE bit        @L5A 02866600
&F62(2)  SETB  1                     Initialize PKM bit            @L5A 02883200
&NICOPY  SETC  '1'                   INITIALIZE TO LEAVE ON BIT         02900000
&FORM#   SETC  '2'                   INITIAL FORMAT NUMBER              02950000
* /* MACDATE   08/09/00                                              */ 03019990
* /*                                                                    03050000
.********************************************************************** 03060000
.*   TEST FOR REQUEST TO RESET A SUBTASK VIA DISP=RESET WITH TCB      * 03070000
.********************************************************************** 03080000
         AIF (T'&TCB NE 'O').ATTCHD                                @L2A 03090000
         AIF ('&DISP' EQ 'RESET').ATTCHD                           @L2A 03095000
&SWSTAI  SETB  ('&STAI(1)' NE '' )   SWITCH VALUE 1 IF STAI             03100000
&SWESTAI SETB  ('&ESTAI(1)' NE '' )  SWITCH VALUE 1 IF ESTAI            03150000
         AIF   (&SWSTAI AND &SWESTAI).ERSTAI                            03200000
         AIF   (NOT &SWESTAI).STTYP1                                    03250000
         AIF   (N'&ESTAI GT 2).ERROR                                    03300000
&STXADDR SETC  '&ESTAI(1)'        EXIT RTN ADDR                         03350000
&STPADDR SETC  '&ESTAI(2)'        PARM LIST FOR EXIT RTN                03400000
&STAITYP SETC  'ESTAI'                                                  03450000
         AGO   .STTYP2                                                  03500000
.STTYP1  AIF   (NOT &SWSTAI).STTYP2                                     03550000
         AIF   (N'&STAI GT 2).ERROR                                     03600000
&STXADDR SETC  '&STAI(1)'         EXIT RTN ADDR                         03650000
&STPADDR SETC  '&STAI(2)'         PARM LIST FOR EXIT RTN                03700000
&STAITYP SETC  'STAI'                                                   03750000
.STTYP2  ANOP                                                           03800000
&IHBNO   SETC  '306'                                                    03850000
 AIF ('&HIARCHY' NE '' AND '&HIARCHY' NE '0'                           *03900000
               AND '&HIARCHY' NE '1').ERRHID                            03950000
         AIF   ('&MF' EQ 'L' OR('&SF' EQ 'L' AND '&MF(1)' EQ 'E')).E1   04000000
         AIF   ('&SF' EQ 'L' AND '&PARAM' NE '').ERROR2                 04050000
         AIF   ('&EP' NE '' AND '&EPLOC' NE '').ERROR4                  04100000
         AIF   ('&EP' NE '' AND '&DE' NE '').ERROR4                     04150000
         AIF   ('&DE' NE '' AND '&EPLOC' NE '').ERROR4                  04200000
         AIF   ('&LPMOD' EQ '').CONTAAA                                 04250000
         AIF   ('&LPMOD'(1,1) EQ '-').ERROR7                            04300000
.CONTAAA ANOP                                                           04350000
         AIF   ('&DISP' NE 'YES' AND '&DISP' NE 'NO').ERDISP            04400000
         AIF   ('&LSQA' NE '0' AND (&SWSTAI OR &SWESTAI)).E2            04450000
         AIF   ('&LSQA' NE '0' AND '&PURGE' NE '' ).E3                  04500000
         AIF   ('&LSQA' NE '0' AND '&ASYNCH' NE '' ).E4                 04550000
         AIF   ('&LSQA' NE '0' AND ('&SZERO' NE 'NO')).E5               04600000
         AIF   ('&GIVEJPQ' NE 'NO' AND '&LSQA' NE '0').E6               04650000
         AIF   ('&LSQA' NE '0' AND '&GSPV' NE '').E7                    04700000
         AIF   ('&LSQA' NE '0' AND '&GSPL' NE '').E8                    04750000
         AIF   ('&LSQA' NE '0' AND '&SHSPV' NE '').E9                   04800000
         AIF   ('&LSQA' NE '0' AND '&SHSPL' NE '').E10                  04850000
         AIF   ('&TQE' NE 'YES' AND '&TQE' NE 'NO' AND '&TQE' NE '').ERX04900000
               TQE                                                      04950000
         AIF   ('&FPREGSA' NE 'YES' AND '&FPREGSA' NE 'NO' AND '&FPREGSX05000000
               A' NE '').ERFP                                           05050000
         AIF   ('&NSHSPL' NE '' AND '&NSHSPV' NE '').ERNSHSP            05100000
         AIF   ('&TERM' NE 'YES' AND '&TERM' NE 'NO').ERTERM            05150000
         AIF   ('&ALCOPY' NE 'YES' AND '&ALCOPY' NE 'NO' AND '&ALCOPY' X05200000
               NE '').ERALCPY                                           05250000
         AIF   ('&ADDRENV' NE 'SAME' AND '&ADDRENV' NE 'SUBSP' AND     X05266600
               '&ADDRENV' NE '').ERADDRE                           @L3A 05283200
         SYSSTATE TEST                  CHECK ASC ENVIRONMENT           05300000
.* HERE INITIALIZE VARIABLES &NUMB,&NUMB1,&NUMB3                        05350000
.* THESE MUST NOT BE ALTERED ONCE SET.                                  05400000
.* BYTE AT OFFSET DECIMAL 27 IS DEFINED BY &NUMB                        05450000
         AIF   ('&DISP' EQ 'YES').NUMBX1                                05500000
&NUMB    SETA  (&NUMB+128)        DISP=NO FLAG SET TO 1                 05550000
.NUMBX1  ANOP                                                           05600000
         AIF   ('&JSCB' EQ '').NUMBX2                                   05650000
&NUMB    SETA  (&NUMB+64)         JSCB ADDRESS SPECIFIED FLAG           05700000
.NUMBX2  ANOP                                                           05750000
         AIF   ('&GIVEJPQ' EQ 'NO').NUMBX3                              05800000
&NUMB    SETA  (&NUMB+32)         GIVEJPQ=YES FLAG SET TO 1             05850000
.NUMBX3  ANOP                                                           05900000
         AIF   ('&KEY' EQ 'NINE').NUMBX4A                          @L5A 05908000
         AIF   ('&KEY' EQ 'PROP').NUMBX4                         Y02752 05916000
&NUMB    SETA  (&NUMB+16)         KEY=ZERO FLAG ON               Y02752 05924000
&F62(1)  SETB  0                  Need to reset KEY=NINE           @L5A 05932000
         AGO   .NUMBX4                                             @L5A 05940000
.NUMBX4A ANOP                                                      @L5A 05948000
&NUMF3S  SETA  1                  FLAG3 specified                  @L5A 05956000
&NUMF3   SETA  (&NUMF3+128)       KEY=NINE FLAG ON                 @L5A 05964000
&F27(4)  SETB  0                  Need to reset KEY=ZERO           @L5A 05972000
         AIF   ('&GSPL' NE '' OR '&GSPV' NE '' OR '&SHSPL' NE '' OR    *05980000
               '&SHSPV' NE '' OR '&SZERO' EQ 'YES').ERRKEYNINE     @L5A 05988000
.NUMBX4  ANOP                                                      @L5A 05996000
         AIF   ('&PKM' EQ '').NUMBX4B                              @L5A 06004000
&NUMF3S  SETA  1                  FLAG3 specified                  @L5A 06012000
         AIF   ('&PKM' EQ 'SYSTEM_RULES').NUMBX4B                  @L5A 06020000
         AIF   ('&PKM' NE 'REPLACE').ERROR8                        @L5A 06028000
&NUMF3   SETA  (&NUMF3+64)        PKM=REPLACE                      @L5A 06036000
         AGO   .NUMBX4B                                            @L5A 06044000
.NUMBX4B ANOP                                                      @L5A 06052000
&F62(2)  SETB  0                  Need to reset PKM                @L5A 06060000
.NUMBX4C ANOP                                                      @L5A 06068000
         AIF   (&NUMF3S EQ 0).KEEPF2                               @L5A 06076000
&FORM#   SETC  '5'                   INITIAL FORMAT NUMBER         @L5A 06084000
.KEEPF2  ANOP                                                      @L5A 06092000
         AIF   ('&SZERO' EQ 'YES').NUMBX5                               06100000
&NUMB    SETA  (&NUMB+8)          SZERO=NO FLAG SET TO 1                06150000
.NUMBX5  ANOP                                                           06200000
         AIF   ('&SVAREA' EQ 'YES').NUMBX6                              06250000
&NUMB    SETA  (&NUMB+4)          SVAREA=NO FLAG SET TO 1               06300000
.NUMBX6  ANOP                                                           06350000
         AIF   ('&JSTCB' NE 'YES').NUMBX7                               06400000
&NUMB    SETA  (&NUMB+2)          JSTCB=YES FLAG SET TO 1               06450000
.NUMBX7  ANOP                                                           06500000
         AIF   ('&SM' NE 'SUPV').NUMBX8                                 06550000
&NUMB    SETA  (&NUMB+1)          SM=SUPV FLAG ON                       06600000
.NUMBX8  ANOP                     BYTE IS COMPLETE                      06650000
.* BYTE AT OFFSET DECIMAL 60 IS DEFINED BY &NUMB1                       06700000
&NUMB1   SETA  0                                                        06750000
         AIF   ('&TASKLIB' EQ '').NUMB1X2                               06800000
&NUMB1   SETA  (&NUMB1+2)         TASKLIB ADDRESS SPECIFIED FLAG        06850000
.NUMB1X2 ANOP                                                           06900000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).NUMB1X3                     06950000
&NUMB1   SETA  (&NUMB1+1)         FLAG FOR STAI OR ESTAI                07000000
.NUMB1X3 ANOP                                                      @L3C 07016600
         AIF   ('&ADDRENV' EQ 'SAME').DEW1                         @L3A 07033200
         AIF   ('&ADDRENV' NE 'SUBSP').DEW1                        @L3A 07049800
&NUMB1   SETA  (&NUMB1+8)         BIT4=1 FOR ADDRENV=SUBSP         @L3A 07066400
.DEW1    ANOP                                                      @L3A 07083000
.* BYTE AT OFFSET DECIMAL 52 IS DEFINED BY &NUMB3                       07100000
         AIF   (NOT (&SWSTAI OR &SWESTAI)  ).NUMB3X1                    07150000
.* PURGE BITS (BITS 6 AND 7) ARE 00, CORRECT FOR PURGE=QUIESCE          07200000
         AIF   ('&PURGE' EQ '').NOPRGE                                  07250000
         AIF   ('&PURGE' EQ 'QUIESCE').PRGEOK                           07300000
&NUMB3   SETA  1                  SET TO PURGE=HALT FLAGS               07350000
         AIF   ('&PURGE' EQ 'HALT').PRGEOK                              07400000
&NUMB3   SETA  2                  SET TO PURGE=NONE FLAGS               07450000
         AIF   ('&PURGE' EQ 'NONE').PRGEOK                              07500000
         AGO   .ERROZ             INVALED PURGE OPERAND                 07550000
.NOPRGE  ANOP                     &NUMB3 IS SET TO QUIESCE              07600000
         AIF   (&SWSTAI).PRGEOK   CORRECT DEFAULT FOR STAI              07650000
&NUMB3   SETA  2                  SET TO NONE, DEFAULT FOR ESTAI        07700000
.PRGEOK  ANOP                     PURGE BITS ARE SET CORRECTLY          07750000
         AIF   ('&ASYNCH' EQ '').NOASYNC                                07800000
         AIF   ('&ASYNCH' EQ 'NO').ASYNCOK                              07850000
&NUMB3   SETA  (&NUMB3+4)         SET ASYNCH=YES FLAG                   07900000
         AIF   ('&ASYNCH' EQ 'YES').ASYNCOK                             07950000
         AGO   .ERROZ             INVALID ASYNCH OPERAND                08000000
.NOASYNC ANOP                     CHECK DEFAULTS                        08050000
         AIF   (&SWSTAI).ASYNCOK  ASYNCH=NO IS STAI DEFAULT             08100000
&NUMB3   SETA  (&NUMB3+4)         ASYNCH=YES IS ESTAI DEFAULT           08150000
.ASYNCOK ANOP                     ASYNCH BIT IS SET CORRECTLY           08200000
         AIF   (&SWSTAI).NUMB3X1  TERM AND ESTAI FLAGS NOT SET          08250000
&NUMB3   SETA  (&NUMB3+8)         BIT4=1 FOR ESTAI                      08300000
         AIF   ('&TERM' EQ 'NO').NUMB3X1                                08350000
&NUMB3   SETA  (&NUMB3+16)        BIT3=1 FOR TERM=YES                   08400000
.NUMB3X1 ANOP                                                           08450000
         AIF   ('&ALCOPY' EQ 'NO').COPYNO                               08500000
         AIF   ('&ALCOPY' NE 'YES').NUMB3X2                             08550000
&NUMB3   SETA  (&NUMB3+32)        BIT2=1 FOR ALCOPY=YES                 08600000
         AGO   .NUMB3X2                                                 08650000
.COPYNO  ANOP                                                           08700000
&NICOPY  SETC  '0'                TURN OFF ALCOPY BIT IF ALCOPY=NO      08750000
.NUMB3X2 ANOP                     BYTE IS COMPLETE                      08800000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          08850000
&IHBSWA  SETB  ('&VL' EQ '1')                                           08900000
&IHBSWB  SETB  ('&SF' EQ '(E,(15))')                                    08950000
         AIF   ('&NAME' EQ '' OR '&SF' EQ 'L').CONTAA                   09000000
&NAME    DS    0H                                                       09050000
.CONTAA  AIF   ('&PARAM' EQ '' AND '&MF(1)' NE 'E').CONTA               09100000
         IHBOPLTX ,&PARAM,MF=&MF                                        09150000
.CONTA   AIF   ('&SF' EQ 'I').IROUT                                     09200000
         AIF   ('&SF' EQ 'L').LROUT                                     09250000
         AIF   (N'&SF NE 2).ERROR3                                      09300000
         AIF   ('&SF(1)' NE 'E').ERROR3                                 09350000
         AIF   ('&SF'(4,1) EQ '(').ISAREG                               09400000
         LAE   15,&SF(2)          LOAD LIST ADDRESS                     09450000
         AGO   .CONTB                                                   09500000
.E1      IHBERMAC 35,&IHBNO,&MF,,,0                                     09550000
         AGO   .EXIT                                                    09600000
.ERROR2  IHBERMAC 71,&IHBNO,&PARAM                                      09650000
         AGO   .EXIT                                                    09700000
.ERROR3  IHBERMAC 41,&IHBNO,&SF,,,0                                     09750000
         AGO   .EXIT                                                    09800000
.ERROR4  IHBERMAC 88,&IHBNO                                             09850000
         AGO   .EXIT                                                    09900000
.ERROR5  IHBERMAC 72,&IHBNO                                             09950000
         AGO   .EXIT                                                    10000000
.ERROR6  IHBERMAC 31,&IHBNO                                             10050000
         AGO   .EXIT                                                    10100000
.ERROR7  IHBERMAC 240,,LPMOD                                            10150000
         AGO   .EXIT                                                    10200000
.ERROR8  IHBERMAC 1001,PKM,&PKM                                    @L5A 10216600
         MEXIT                                                     @L5A 10233200
.ERRHID IHBERMAC 195                                                    10250000
         AGO   .EXIT                                                    10300000
.ISAREG  AIF   ('&SF(2)' EQ '(15)').JAF1                                10350000
&A       SETA  K'&SF-6                                                  10400000
&H       SETC  '&SF'(5,&A)                                              10450000
         LR    15,&H              LOAD LIST ADDRESS                     10500000
         AIF   ('&SYSASCE' EQ 'P').JAF2                                 10550000
         CPYA  15,&H              LOAD LIST AR                          10600000
         AGO   .CONTB                                                   10650000
.JAF1    ANOP                                                           10700000
         AIF   ('&SYSASCE' NE 'P').CONTB                                10750000
.JAF2    ANOP                                                           10800000
         SLR   14,14              ZERO WORK REGISTER                    10850000
         SAR   15,14              SET LIST AR TO ZERO                   10900000
.CONTB   ANOP                                                           10950000
.* E FORM MUST ALLOW SETTING OF ALL FIELDS, SO THAT A LIST FORM         11000000
.* OF ALL ZEROS IS ACCEPTABLE. EXTENDED PARM LIST BITS AND              11050000
.* LENGTH FIELD MUST BE SET.                                            11100000
         AIF   ('&EP' EQ '').CONTC                                      11150000
&F60(1)  SETB  0                  RESET DE INDICATION                   11200000
         LAE   14,28(,15)         PICK UP EP ADDRESS                    11250000
         ST    14,0(,15)          INSERT EP ADDRESS INTO LIST           11300000
         STAM  14,14,64(15)       INSERT EP AR INTO LIST                11350000
         MVC   28(8,15),*+10      MOVE EP SYMB INTO LIST                11400000
         B     *+12               BRANCH AROUND EP SYMBOL               11450000
         DC    CL8'&EP'           EP SYMBOL                             11500000
         AGO   .CONTE                                                   11550000
.CONTC   AIF   ('&EPLOC' EQ '').CONTD                                   11600000
&F60(1)  SETB  0                  RESET DE INDICATION                   11650000
         AIF   ('&EPLOC'(1,1) EQ '(').ISAREGA                           11700000
         LAE   14,&EPLOC          PICK UP EPLOC ADDRESS                 11750000
         ST    14,0(,15)          INSERT EPLOC INTO LIST                11800000
         STAM  14,14,64(15)       INSERT EPLOC AR INTO LIST             11850000
         AGO   .CONTE                                                   11900000
.ISAREGA ST    &EPLOC(1),0(,15)   INSERT EPLOC INTO LIST                11950000
         AIF   ('&SYSASCE' EQ 'P').JAF3                                 12000000
         STAM  &EPLOC(1),&EPLOC(1),64(15) STORE EPLOC AR INTO LIST      12050000
         AGO   .CONTE                                                   12100000
.JAF3    ANOP                                                           12150000
         SLR   14,14              ZERO WORK REGISTER                    12200000
         ST    14,64(,15)         ZERO EPLOC AR                         12250000
         AGO   .CONTE                                                   12300000
.CONTD   AIF   ('&DE' EQ '').CONTE                                      12350000
&NUMB1   SETA  &NUMB1+128         DE BIT                                12400000
         AIF   ('&DE'(1,1) EQ '(').ISAREGB                              12450000
         LAE   14,&DE             PICK UP DE ADDRESS                    12500000
         ST    14,0(,15)          INSERT DE INTO LIST                   12550000
         STAM  14,14,64(15)       INSERT DE AR INTO LIST                12600000
         AGO   .CONTE                                                   12650000
.ISAREGB ST    &DE(1),0(,15)      INSERT DE INTO LIST                   12700000
         AIF   ('&SYSASCE' EQ 'P').JAF4                                 12750000
         STAM  &DE(1),&DE(1),64(15) STORE DE AR INTO LIST               12800000
         AGO   .CONTE                                                   12850000
.JAF4    ANOP                                                           12900000
         SLR   14,14              ZERO WORK REGISTER                    12950000
         ST    14,64(,15)         ZERO DE AR                            13000000
.CONTE   AIF   ('&DCB' EQ '').CONHID                                    13050000
         AIF   ('&DCB'(1,1) EQ '(').ISAREGC                             13100000
         LAE   14,&DCB            PICK UP DCB ADDRESS                   13150000
         ST    14,4(,15)          STORE DCB INTO LIST                   13200000
         STAM  14,14,68(15)       STORE DCB AR INTO LIST                13250000
         AGO   .CONHID                                                  13300000
.ISAREGC ST    &DCB(1),4(,15)     STORE DCB ADDR INTO LIST              13350000
         AIF   ('&SYSASCE' EQ 'P').JAF5                                 13400000
         STAM  &DCB(1),&DCB(1),68(15) STORE DCB AR INTO LIST            13450000
         AGO   .CONHID                                                  13500000
.JAF5    ANOP                                                           13550000
         SLR   14,14              ZERO WORK REGISTER                    13600000
         ST    14,68(,15)         ZERO DCB AR                           13650000
.CONHID  ANOP                                                           13700000
.CONTF   AIF   ('&ECB' EQ '').CONTG                                     13750000
         AIF   ('&ECB'(1,1) EQ '(').ISAREGD                             13800000
         LAE   14,&ECB            PICK UP ECB ADDRESS                   13850000
         ST    14,8(,15)          ECB ADDRESS INTO LIST                 13900000
         STAM  14,14,72(15)       ECB AR INTO LIST                      13950000
         AGO   .CONTG                                                   14000000
.ISAREGD ST    &ECB(1),8(,15)     ECB INTO LIST                         14050000
         AIF   ('&SYSASCE' EQ 'P').JAF6                                 14100000
         STAM  &ECB(1),&ECB(1),72(15) STORE ECB AR INTO LIST            14150000
         AGO   .CONTG                                                   14200000
.JAF6    ANOP                                                           14250000
         SLR   14,14              ZERO WORK REGISTER                    14300000
         ST    14,72(,15)         ZERO ECB AR                           14350000
.CONTG   ANOP                                                           14400000
         AIF   ('&GSPV' EQ '').CONTH                                    14450000
&F60(2)  SETB  0                  RESET GSPL INDICATION                 14500000
         AIF   ('&GSPV'(1,1) EQ '(').ISAREGE                            14550000
         LA    14,&GSPV.(0,0)     PICK UP GSPV VALUE                    14600000
         ST    14,12(,15)         GSPV INTO LIST                        14650000
         AGO   .CONTI                                                   14700000
.ISAREGE ST    &GSPV(1),12(,15)   GSPV INTO LIST                        14750000
         AGO   .CONTI                                                   14800000
.CONTH   AIF   ('&GSPL' EQ '').CONTI                                    14850000
&NUMB1   SETA  &NUMB1+64          INDICATE GSPL                         14900000
         AIF   ('&GSPL'(1,1) EQ '(').ISAREGF                            14950000
         LAE   14,&GSPL           PICK UP GSPL ADDRESS                  15000000
         ST    14,12(,15)         GSPL INTO LIST                        15050000
         STAM  14,14,76(15)       GSPL AR INTO LIST                     15100000
         AGO   .CONTI                                                   15150000
.ISAREGF ST    &GSPL(1),12(,15)   GSPL INTO LIST                        15200000
         AIF   ('&SYSASCE' EQ 'P').JAF7                                 15250000
         STAM  &GSPL(1),&GSPL(1),76(15) STORE GSPL AR INTO LIST         15300000
         AGO   .CONTI                                                   15350000
.JAF7    ANOP                                                           15400000
         SLR   14,14              ZERO WORK REGISTER                    15450000
         ST    14,76(,15)         ZERO GSPL AR                          15500000
.CONTI   AIF   ('&SHSPV' EQ '').CONTK                                   15550000
&F60(3)  SETB  0                  RESET SHSPL INDICATION                15600000
         AIF   ('&SHSPV'(1,1) EQ '(').ISAREGG                           15650000
         LA    14,&SHSPV.(0,0)    PICK UP SHSPV VALUE                   15700000
         ST    14,16(,15)         SHSPV INTO LIST                       15750000
         AGO   .CONTL                                                   15800000
.ISAREGG ST    &SHSPV(1),16(,15)  SHSPV INTO LIST                       15850000
         AGO   .CONTL                                                   15900000
.CONTK   AIF   ('&SHSPL' EQ '').CONTL                                   15950000
&NUMB1   SETA  &NUMB1+32          SHSPL PRESENT                         16000000
         AIF   ('&SHSPL'(1,1) EQ '(').ISAREGH                           16050000
         LAE   14,&SHSPL          PICK UP SHSPL ADDRESS                 16100000
         ST    14,16(,15)         SHSPL INTO LIST                       16150000
         STAM  14,14,80(15)       SHSPL AR INTO LIST                    16200000
         AGO   .CONTL                                                   16250000
.ISAREGH ST    &SHSPL(1),16(,15)  SHSPL INTO LIST                       16300000
         AIF   ('&SYSASCE' EQ 'P').JAF8                                 16350000
         STAM  &SHSPL(1),&SHSPL(1),80(15) STORE SHSPL AR INTO LIST      16400000
         AGO   .CONTL                                                   16450000
.JAF8    ANOP                                                           16500000
         SLR   14,14              ZERO WORK REGISTER                    16550000
         ST    14,80(,15)         ZERO SHSPL AR                         16600000
.CONTL   AIF   ('&ETXR' EQ '').CONTN                                    16650000
         AIF   ('&ETXR'(1,1) EQ '(').ISAREGI                            16700000
         LA    14,&ETXR           PICK UP ETXR ADDRESS                  16750000
         ST    14,20(,15)         INSERT ETXR INTO LIST                 16800000
         AGO   .CONTN                                                   16850000
.ISAREGI ST    &ETXR(1),20(,15)   INSERT ETXR INTO LIST                 16900000
.CONTN   ANOP                                                           16950000
.CONTN0  AIF   ('&DPMOD' EQ '').CONTO                                   17000000
         AIF   ('&DPMOD'(1,1) EQ '(').ISAREGJ                           17050000
         B     *+6                BRANCH AROUND DPMOD                   17100000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNA     17150000
         DC    AL2(&DPMOD)        DPMOD VALUE                           17200000
         MVC   24(2,15),*-2       INSERT DPMOD IN LIST                  17250000
         AGO   .CONTO                                                   17300000
.SIGNA   DC    AL2(0&DPMOD)       DPMOD VALUE                           17350000
         MVC   24(2,15),*-2       INSERT DPMOD IN LIST                  17400000
         AGO   .CONTO                                                   17450000
.ISAREGJ STH   &DPMOD(1),24(,15)  DPMOD IN LIST                         17500000
.CONTO   AIF   ('&LPMOD' EQ '').CONTP                                   17550000
         AIF   ('&LPMOD'(1,1) EQ '(').ISAREGK                           17600000
         MVI   26(15),&LPMOD      INSERT LPMOD IN LIST                  17650000
         AGO   .CONTP                                                   17700000
.ISAREGK STC   &LPMOD(1),26(,15)  LPMOD IN LIST                         17750000
.CONTP   ANOP                                                           17800000
&NI27    SETA  16*&F27(4)+(255-16) Mask to possibly clear key0 bit @01C 17814990
         AIF   (&NI27 EQ 255).NONI27 Nothing to reset              @L5A 17820000
         NI    27(15),&NI27       Clear unwanted bits              @L5A 17830000
.NONI27  ANOP                                                      @L5A 17840000
         AIF   (&NUMB EQ 0).JSCB1                                       17850000
         OI    27(15),&NUMB       SET STATUS BYTE                       17900000
.JSCB1   AIF   ('&JSCB' EQ '').CONTQ5                                   17950000
         AIF   ('&JSCB'(1,1) EQ '(').ISAREG1                            18000000
         LAE   14,&JSCB           PICK UP JSCB ADDRESS                  18050000
         ST    14,36(,15)         INSERT JSCB INTO LIST                 18100000
         STAM  14,14,84(15)       INSERT JSCB AR INTO LIST              18150000
         AGO   .CONTQ5                                                  18200000
.ISAREG1 ST    &JSCB(1),36(,15)   INSERT JSCB INTO LIST                 18250000
         AIF   ('&SYSASCE' EQ 'P').JAF10                                18300000
         STAM  &JSCB(1),&JSCB(1),84(15) STORE JSCB AR INTO LIST         18350000
         AGO   .CONTQ5                                                  18400000
.JAF10   ANOP                                                           18450000
         SLR   14,14              ZERO WORK REGISTER                    18500000
         ST    14,84(,15)         ZERO JSCB AR                          18550000
.CONTQ5  ANOP                                                           18600000
         AIF   ( NOT (&SWSTAI OR &SWESTAI) ).TTID  NEITHER GIVEN        18650000
.* IF EITHER STAI OR ESTAI GIVEN, OVERRIDE BYTES DEC 41 - 47            18700000
.STAIRB  AIF   ('&STXADDR'(1,1) EQ '(' ).REG1                           18750000
         LA    14,&STXADDR        GET (E)STAI EXIT ADDRESS              18800000
         ST    14,44(,15)         (E)STAI EXIT ADDR INTO LIST           18850000
         AGO   .STAI2                                                   18900000
.REG1    ST    &STXADDR,44(,15)   (E)STAI EXIT ADDR INTO LIST           18950000
.STAI2   ANOP                                                           19000000
         AIF   ('&STPADDR' NE '').STY                                   19050000
         SLR   14,14                                                    19100000
         ST    14,40(,15)         NO STAI/ESTAI PARM LIST ADDR          19150000
         ST    14,88(,15)         NO STAI/ESTAI PARM LIST AR            19200000
         AGO   .TTID                                                    19250000
.STY     ANOP                                                           19300000
         AIF   ('&STPADDR'(1,1) EQ '(').REG2                            19350000
         LAE   14,&STPADDR        GET STAI/ESTAI PARM LIST ADDR         19400000
         ST    14,40(,15)         STAI/ESTAI PARM LIST ADDR             19450000
         STAM  14,14,88(15)       STAI/ESTAI PARM LIST AR               19500000
         AGO   .TTID                                                    19550000
.REG2    ST    &STPADDR,40(,15)   STAI/ESTAI PARM LIST ADDR             19600000
         AIF   ('&SYSASCE' EQ 'P').JAF12                                19650000
         STAM  &STPADDR,&STPADDR,88(15) (E)STAI AR INTO LIST            19700000
         AGO   .TTID                                                    19750000
.JAF12   ANOP                                                           19800000
         SLR   14,14              ZERO WORK REGISTER                    19850000
         ST    14,88(,15)         ZERO (E)STAI AR                       19900000
.TTID    AIF   ('&TID' EQ '0').TLIBE                                    19950000
         AIF   ('&TID'(1,1) EQ '(').REGTID                              20000000
         MVI   53(15),&TID        INSERT TID INTO LIST                  20050000
         AGO   .TLIBE                                                   20100000
.REGTID  STC   &TID(1),53(,15)    INSERT TID INTO LIST                  20150000
.TLIBE   AIF   ('&TASKLIB' EQ '').NSHSP1                                20200000
.TLIBEA  AIF   ('&TASKLIB'(1,1) EQ '(').TREGE                           20250000
         LAE   14,&TASKLIB(1)     GET TASKLIB DCB ADDRESS               20300000
         ST    14,48(,15)         TASKLIB DCB ADDRESS IN LIST           20350000
         STAM  14,14,92(15)       TASKLIB DCB AR INTO LIST              20400000
         AGO   .NSHSP1                                                  20450000
.TREGE   ST    &TASKLIB(1),48(,15) TASKLIB DCB ADDR. IN LIST.           20500000
         AIF   ('&SYSASCE' EQ 'P').JAF13                                20550000
         STAM  &TASKLIB(1),&TASKLIB(1),92(15) TASKLIB AR INTO LIST      20600000
         AGO   .NSHSP1                                                  20650000
.JAF13   ANOP                                                           20700000
         SLR   14,14              ZERO WORK REGISTER                    20750000
         ST    14,92(,15)         ZERO TASKLIB AR                       20800000
.NSHSP1  ANOP                                                           20850000
         MVI   55(15),100         SET LENGTH OF THIS PARM LIST          20900000
&NUMB3B  SETB  (&NUMB3 NE 0)      STAI BITS PRESENT?                    20950000
         AIF   ('&NSHSPL' EQ '').NSHSP2                                 21000000
         AIF   ('&RSAPF' EQ 'YES').NSHSP6   RSAPF ALSO ON               21050000
&NUMB3   SETA  &NUMB3+X'80'       INDICATE SP LIST                      21100000
.NSHSP7  ANOP                                                           21150000
         AIF   ('&NSHSPL'(1,1) EQ '(' ).NSHSP3                          21200000
         LAE   14,&NSHSPL         GET SP LIST ADDR                      21250000
         ST    14,56(,15)         NSHSPL ADDR INTO PARM LIST            21300000
         STAM  14,14,96(15)       NSHSPL AR INTO PARM LIST              21350000
         AGO   .PRESVC                                                  21400000
.NSHSP3  ANOP                                                           21450000
         ST    &NSHSPL(1),56(,15) NSHSPL ADDR INTO PARM LIST            21500000
         AIF   ('&SYSASCE' EQ 'P').JAF14                                21550000
         STAM  &NSHSPL(1),&NSHSPL(1),96(15) NSHSPL AR INTO LIST         21600000
         AGO   .PRESVC                                                  21650000
.JAF14   ANOP                                                           21700000
         SLR   14,14              ZERO WORK REGISTER                    21750000
         ST    14,96(,15)         ZERO NSHSPL AR                        21800000
         AGO   .PRESVC                                                  21850000
.NSHSP2  ANOP                                                           21900000
         AIF   ('&NSHSPV' EQ '').NSHSP8                                 21950000
&F52(1)  SETB  0                  RESET NSHSPL INDICATION               22000000
         AIF   ('&RSAPF' NE 'YES').NSHSP5                               22050000
&NUMB3   SETA  &NUMB3+X'40'       SET APF FLAG ON                       22100000
.NSHSP5  ANOP                                                           22150000
         AIF   ('&NSHSPV'(1,1) EQ '(' ).NSHSP4                          22200000
         LA    14,&NSHSPV.(0,0)   SP VALUE FOR NSHSPV                   22250000
         ST    14,56(,15)         PARM INTO LIST                        22300000
         AGO   .PRESVC                                                  22350000
.NSHSP4  ANOP                                                           22400000
         ST    &NSHSPV(1),56(,15) SET SP VALUE FOR NSHSPV               22450000
         AGO   .PRESVC                                                  22500000
.NSHSP6  ANOP                                                           22550000
&NUMB3   SETA  &NUMB3+X'C0'       SET NSHSPL,RSAPF                      22600000
         AGO   .NSHSP7                                                  22650000
.NSHSP8  ANOP                                                           22700000
         AIF   ('&RSAPF' NE 'YES').PRESVC NO FLAGS ON                   22750000
&NUMB3   SETA  &NUMB3+X'40'       SET APF FLAG ON                       22800000
.PRESVC  ANOP                                                           22850000
.* SET MASKS USED FOR CLEARING UNWANTED BITS IN FLAG BYTES              22900000
&NI52    SETA  128*&F52(1)+64+32*&NICOPY+16+8+7                         22950000
&NI60    SETA  128*&F60(1)+64*&F60(2)+32*&F60(3)+16+8+7            @P2C 23000000
&NI62    SETA  128*&F62(1)+64*&F62(2)+63                           @L5A 23025000
         OI    8(15),X'80'        SET NEW FORMAT BIT                    23050000
         NI    60(15),&NI60       CLEAR UNWANTED BITS                   23150000
.NONI60  AIF   (&NUMB1 EQ 0).NO60 SKIP IF 0                             23200000
         OI    60(15),&NUMB1      SET FLAG BYTE                         23250000
.NO60    AIF   (&NI52 EQ 255).NONI52  ANY BITS TO BE RESET?             23300000
         NI    52(15),&NI52       CLEAR UNWANTED BITS                   23350000
.NONI52  AIF   (NOT &NUMB3B).NO60B CHECK FOR STAI BITS                  23400000
         OI    52(15),&NUMB3      TURN ON SPECIFIED BITS                23450000
         AGO   .NO52                                                    23500000
.NO60B   AIF   (&NUMB3 EQ 0).NO52 SKIP IF 0                             23550000
         OI    52(15),&NUMB3      TURN ON SPECIFIED BITS                23600000
.NO52    MVI   61(15),&FORM#      SET FORMAT NUMBER                     23650000
         AIF   (&NI62 EQ 255).NONI62 Nothing to reset              @L5A 23657100
         NI    62(15),&NI62       Clear unwanted bits              @L5A 23664200
.NONI62  ANOP                                                      @L5A 23671300
         AIF   (&NUMF3S EQ 0).NO62 No flags to set                 @L5A 23678400
         OI    62(15),&NUMF3      FLAGS                            @L5A 23685500
.NO62    ANOP                                                      @L5A 23692600
         AGO   .SVC                                                     23700000
.LROUT   ANOP                                                           23750000
.* L FORM MUST ACCEPT ALL PARAMETERS POSSIBLE. A LIST OF ALL            23800000
.* ZEROS MUST BE ACCEPTABLE AS AN L FORM.                               23850000
&NAME    DS    0F                                                       23900000
         AIF   ('&EP' EQ '').CONTLA                                     23950000
         AIF   ('&EP'(1,1) EQ '(').ERROR5                               24000000
         DC    A(*+28)            POINTER TO SYMBOL NAME                24050000
         AGO   .COHID                                                   24100000
.CONTLA  AIF   ('&EPLOC' EQ '').CONTLB                                  24150000
         AIF   ('&EPLOC'(1,1) EQ '(').ERROR5                            24200000
         DC    A(&EPLOC)          POINTER TO SYMBOL NAME                24250000
         AGO   .COHID                                                   24300000
.CONTLB  AIF   ('&DE' EQ '').CONTLLA                                    24350000
         AIF   ('&DE'(1,1) EQ '(').ERROR5                               24400000
         DC    A(&DE)             SET DE POINTER                        24450000
&NUMB1   SETA  &NUMB1+X'80'                                             24500000
         AGO   .COHID                                                   24550000
.CONTLLA DC    A(0)               DE OR EPLOC ADDRESS                   24600000
.COHID   ANOP                                                           24650000
.CHID    ANOP                                                           24700000
.CONTLC  AIF   ('&DCB' EQ '').CONTLD                                    24750000
         AIF   ('&DCB'(1,1) EQ '(').ERROR5                              24800000
         DC    A(&DCB)            DCB ADDRESS                           24850000
         AGO   .CONTLSE                                                 24900000
.CONTLD  DC    A(0)               DCB ADDRESS                           24950000
.CONTLSE ANOP                                                           25000000
.CONTLE  AIF   ('&ECB' EQ '').CONTLF                                    25050000
         AIF   ('&ECB'(1,1) EQ '(').ERROR5                              25100000
         DC    A(X'80000000'+&ECB) NEW FORMAT + ECB ADDR                25150000
         AGO   .CONTLG                                                  25200000
.CONTLF  DC    A(X'80000000')     NEW FORMAT + ECB ADDR                 25250000
.CONTLG  AIF   ('&GSPV' EQ '').CONTLH                                   25300000
         AIF   ('&GSPV'(1,1) EQ '(').ERROR5                             25350000
         DC    A(&GSPV)           GSPV VALUE                            25400000
         AGO   .CONTLI                                                  25450000
.CONTLH  AIF   ('&GSPL' EQ '').CONTLJ                                   25500000
         AIF   ('&GSPL'(1,1) EQ '(').ERROR5                             25550000
&NUMB1   SETA  &NUMB1+X'40'       INDICATE GSPL                         25600000
         DC    A(&GSPL)           SET GSPL ADDRESS                      25650000
         AGO   .CONTLI                                                  25700000
.CONTLJ  DC    A(0)               GSPL OR GSPV                          25750000
.CONTLI  AIF   ('&SHSPV' EQ '').CONTLK                                  25800000
         AIF   ('&SHSPV'(1,1) EQ '(').ERROR5                            25850000
         DC    A(&SHSPV)          SHSPV VALUE                           25900000
         AGO   .CONTLL                                                  25950000
.CONTLK  AIF   ('&SHSPL' EQ '').CONTLM                                  26000000
         AIF   ('&SHSPL'(1,1) EQ '(').ERROR5                            26050000
         DC    A(&SHSPL)          SET SHSPL ADDRESS                     26100000
&NUMB1   SETA  &NUMB1+X'20'       SHSPL PRESENT                         26150000
         AGO   .CONTLL                                                  26200000
.CONTLM  DC    A(0)               SHSPV OR SHSPL                        26250000
.CONTLL  ANOP                                                           26300000
         AIF   ('&ETXR' EQ '').CONTLN                                   26350000
         AIF   ('&ETXR'(1,1) EQ '(').ERROR5                             26400000
         DC    A(&ETXR)           EXIT ROUTINE ADDRESS                  26450000
         AGO   .CONTLO                                                  26500000
.CONTLN  DC    A(0)               EXIT ROUTINE ADDRESS                  26550000
.CONTLO  AIF   ('&DPMOD' EQ '').CONTLP                                  26600000
         AIF   ('&DPMOD'(1,1) EQ '(').ERROR5                            26650000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNB     26700000
         DC    AL2(&DPMOD)        DPMOD VALUE                           26750000
         AGO   .CONTLQ                                                  26800000
.SIGNB   DC    AL2(0&DPMOD)       DPMOD VALUE                           26850000
         AGO   .CONTLQ                                                  26900000
.CONTLP  DC    AL2(0)             DPMOD VALUE                           26950000
.CONTLQ  AIF   ('&LPMOD' EQ '').CONTLR                                  27000000
         AIF   ('&LPMOD'(1,1) EQ '(').ERROR5                            27050000
         DC    AL1(&LPMOD)        LPMOD VALUE                           27100000
         AGO   .CONTLS6                                                 27150000
.CONTLR  DC    AL1(0)             LPMOD VALUE                           27200000
.CONTLS6 ANOP                                                           27250000
.CONTLU  DC    AL1(&NUMB)         STATUS BYTE                           27300000
         AIF   ('&EP' EQ '').CONTLV                                     27350000
         DC    CL8'&EP'           EP SYMBOL                             27400000
         AGO   .CONTLV1                                                 27450000
.* SET EP NAME SPACE TO ZEROS TO ALLOW ALL ZERO LIST FORM               27500000
.CONTLV  DC    2A(0)              EP NAME SPACE                         27550000
.CONTLV1 ANOP                                                           27600000
         AIF   ('&JSCB' EQ '').NOJSCB                                   27650000
         AIF   ('&JSCB'(1,1) EQ '(').ERROR5                             27700000
         DC    A(&JSCB)           ADDRESS OF JSCB                       27750000
         AGO   .LTID                                                    27800000
.NOJSCB  ANOP                                                           27850000
         DC    A(0)               ADDRESS OF JSCB                       27900000
.LTID    ANOP                                                           27950000
.CONTLW  AIF   (&SWSTAI OR &SWESTAI).CONTLX                             28000000
         DC    A(0)               (E)STAI PARM LIST                     28050000
         DC    A(0)               EXIT ADDRESS                          28100000
         AGO   .TLCONT                                                  28150000
.CONTLX  ANOP                                                           28200000
         AIF   ('&STXADDR'(1,1) EQ '(' ).ERROR5                         28250000
         AIF   ('&STPADDR' EQ '').CONTLY                                28300000
         AIF   ('&STPADDR'(1,1) EQ '(' ).ERROR5                         28350000
         DC    A(&STPADDR)        STAI/ESTAI PARM LIST ADDR             28400000
         AGO   .TLCX                                                    28450000
.CONTLY  DC    A(0)               STAI/ESTAI PARAMETER LIST             28500000
.TLCX    ANOP                                                           28550000
.TLCZ    DC    A(&STXADDR)        STAI/ESTAI EXIT ROUTINE ADDR          28600000
.TLCONT  AIF   ('&TASKLIB' NE '').TLCONTA                               28650000
         DC    A(0)               TASKLIB                               28700000
         AGO   .LNSHSP1                                                 28750000
.TLCONTA ANOP                                                           28800000
         AIF   ('&TASKLIB'(1,1) EQ '(' ).ERROR5                         28850000
         DC    A(&TASKLIB)        TASKLIB DCB ADDRESS                   28900000
.* ATTACHX PARM LIST LENGTH MUST BE SET IN EXECUTE FORM.                28950000
.LNSHSP1 ANOP                                                           29000000
&NSHSP   SETC  '0'                ASSUME NO NSHSPL,NSHSPV               29050000
         AIF   ('&NSHSPL' EQ '').LNSHSP4   NSHSPL SPECIFIED:            29100000
&NUMB3   SETA  &NUMB3+128         SET BIT TO INDICATE LIST              29150000
&NSHSP   SETC  '&NSHSPL'          INDICATE NSHSPL                       29200000
         AGO   .LNSHSP2                                                 29250000
.LNSHSP4 AIF   ('&NSHSPV' EQ '').LNSHSP2    NSHSPV SPECIFIED:           29300000
&NSHSP   SETC  '&NSHSPV'          INDICATE NSHSPV                       29350000
.LNSHSP2 AIF   ('&RSAPF' NE 'YES').LNSHSP3 RSAPF SPECIFIED:             29400000
&NUMB3   SETA  &NUMB3+64          SET BIT TO INDICATE IT                29450000
.LNSHSP3 DC    AL1(&NUMB3)        FLAG BYTE                             29500000
         AIF   ('&TID'(1,1) EQ '(').ERROR5                              29550000
         AIF   ('&NSHSP'(1,1) EQ '(').ERROR5                            29600000
         DC    AL1(&TID)          TASK ID                               29650000
         DC    AL2(100)           PARM LIST LENGTH                      29700000
         DC    A(&NSHSP)          SUBPOOL LIST ADDRESS/VALUE            29750000
.LBYTE60 DC    AL1(&NUMB1)        SET FLAGS                             29800000
         DC    AL1(&FORM#)        SET UP FORMAT NUMBER                  29850000
         DC    AL1(&NUMF3)        SET FLAGS                             29883300
         DC    AL1(0)             RESERVED BYTE                         29916600
         DC    A(0)               EPLOC/DE/EP ALET                      29950000
         DC    A(0)               DCB ALET                              30000000
         DC    A(0)               ECB ALET                              30050000
         DC    A(0)               GSPL ALET                             30100000
         DC    A(0)               SHSPL ALET                            30150000
         DC    A(0)               JSCB ALET                             30200000
         DC    A(0)               (E)STAI PARAMETER ALET                30250000
         DC    A(0)               TASKLIB ALET                          30300000
         DC    A(0)               NSHSPL ALET                           30350000
         AGO   .END                                                     30400000
.IROUT   ANOP                                                           30450000
.* NORMAL FORM. IN-LINE LIST.                                           30500000
         LAE   15,&GNAME          SET UP LIST ADDRESS                   30550000
         AIF   ('&EPLOC' EQ '').ICONTA                                  30600000
         AIF   ('&EPLOC'(1,1) NE '(').ICONTB                            30650000
         ST    &EPLOC(1),0(,15)   PUT EPLOC INTO LIST                   30700000
         AIF   ('&SYSASCE' EQ 'P').ICONTB                               30750000
         STAM  &EPLOC(1),&EPLOC(1),64(15) EPLOC AR INTO LIST            30800000
         AGO   .ICONTB                                                  30850000
.ICONTA  AIF   ('&DE' EQ '').ICONTB                                     30900000
&NUMB1   SETA  &NUMB1+X'80'       INDICATE DE PRESENT                   30950000
         AIF   ('&DE'(1,1) NE '(').ICONTB                               31000000
         ST    &DE(1),0(,15)      PUT DE INTO LIST                      31050000
         AIF   ('&SYSASCE' EQ 'P').ICONTB                               31100000
         STAM  &DE(1),&DE(1),64(15) DE AR INTO LIST                     31150000
.ICONTB  AIF   ('&DCB' EQ '').ICOHID                                    31200000
         AIF   ('&DCB'(1,1) NE '(').ICOHID                              31250000
         ST    &DCB(1),4(,15)     STORE DCB INTO LIST                   31300000
         AIF   ('&SYSASCE' EQ 'P').ICOHID                               31350000
         STAM  &DCB(1),&DCB(1),68(15) DCB AR INTO LIST                  31400000
.* BITS 6 AND 7 OF BYTE 4 PREVIOUSLY DEFINED FOR HIARCHY                31450000
.ICOHID  ANOP                                                           31500000
.ICONTC  AIF   ('&ECB' EQ '').ICONTD                                    31550000
         AIF   ('&ECB'(1,1) NE '(').ICONTD                              31600000
         ST    &ECB(1),8(,15)     STORE ECB INTO LIST                   31650000
         OI    8(15),X'80'        INDICATE NEW FORMAT              @P1M 31675000
         AIF   ('&SYSASCE' EQ 'P').ICONTD                               31700000
         STAM  &ECB(1),&ECB(1),72(15) ECB AR INTO LIST                  31750000
.ICONTD  AIF   ('&GSPV' EQ '').ICONTE                                   31850000
         AIF   ('&GSPV'(1,1) NE '(').ICONTF                             31900000
         ST    &GSPV(1),12(,15)   STORE GSPV INTO LIST                  31950000
         AGO   .ICONTF                                                  32000000
.ICONTE  AIF   ('&GSPL' EQ '').ICONTF                                   32050000
&NUMB1   SETA  &NUMB1+X'40'       INDICATE GSPL                         32100000
         AIF   ('&GSPL'(1,1) NE '(').ICONTF                             32150000
         ST    &GSPL(1),12(,15)   STORE GSPL INTO LIST                  32200000
         AIF   ('&SYSASCE' EQ 'P').ICONTF                               32250000
         STAM  &GSPL(1),&GSPL(1),76(15) GSPL AR INTO LIST               32300000
.ICONTF  AIF   ('&SHSPV' EQ '').ICONTG                                  32350000
         AIF   ('&SHSPV'(1,1) NE '(').ICONTH                            32400000
         ST    &SHSPV(1),16(,15)  STORE SHSPV INTO LIST                 32450000
         AGO   .ICONTH                                                  32500000
.ICONTG  AIF   ('&SHSPL' EQ '').ICONTH                                  32550000
&NUMB1   SETA  &NUMB1+X'20'       INDICATE SHSPL PRESENT                32600000
         AIF   ('&SHSPL'(1,1) NE '(').ICONTH                            32650000
         ST    &SHSPL(1),16(,15)  STORE SHSPL INTO LIST                 32700000
         AIF   ('&SYSASCE' EQ 'P').ICONTH                               32750000
         STAM  &SHSPL(1),&SHSPL(1),80(15) SHSPL AR INTO LIST            32800000
.ICONTH  AIF   ('&ETXR' EQ '').ICONTI                                   32850000
         AIF   ('&ETXR'(1,1) NE '(').ICONTI                             32900000
         ST    &ETXR(1),20(,15)   STORE ETXR INTO LIST                  32950000
.ICONTI  AIF   ('&DPMOD' EQ '').ICONTJ                                  33000000
         AIF   ('&DPMOD'(1,1) NE '(').ICONTJ                            33050000
         STH   &DPMOD(1),24(,15)  STORE DPMOD INTO LIST                 33100000
.ICONTJ  AIF   ('&LPMOD' EQ '').ICONTJ0                                 33150000
         AIF   ('&LPMOD'(1,1) NE '(').ICONTJ0                           33200000
         STC   &LPMOD(1),26(,15)  STORE LPMOD INTO LIST                 33250000
.ICONTJ0 ANOP                                                           33300000
.ICONTK  AIF   ('&JSCB' EQ '').ICONTL0                                  33350000
         AIF   ('&JSCB'(1,1) NE '(').ICONTL0                            33400000
         ST    &JSCB(1),36(,15)   INSERT JSCB INTO LIST                 33450000
         AIF   ('&SYSASCE' EQ 'P').ICONTL0                              33500000
         STAM  &JSCB(1),&JSCB(1),84(15) JSCB AR INTO LIST               33550000
.ICONTL0 ANOP                                                           33600000
         AIF   ('&TID' EQ '0').ICONTL1                                  33650000
         AIF   ('&TID'(1,1) NE '(').ICONTL1                             33700000
         STC   &TID(1),53(,15)    INSERT TID INTO LIST                  33750000
.ICONTL1 ANOP                                                           33800000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).ICONTO                      33850000
         AIF   ('&STXADDR'(1,1) NE '(' ).ICZ                            33900000
         ST    &STXADDR,44(,15)   SET STAI/ESTAI EXIT ADDR              33950000
.ICZ     AIF   ('&STPADDR' EQ '').ICONTO                                34000000
         AIF   ('&STPADDR'(1,1) NE '(' ).ICONTO                         34050000
         ST    &STPADDR,40(,15)   STAI/ESTAI PARM LIST ADDR             34100000
         AIF   ('&SYSASCE' EQ 'P').ICONTO                               34150000
         STAM  &STPADDR,&STPADDR,88(15) (E)STAI PARM AR                 34200000
.ICONTO  AIF   ('&TASKLIB' EQ '').ICONTP                                34250000
.ICONTQ  AIF   ('&TASKLIB'(1,1) NE '(').ICONTP                          34300000
         ST    &TASKLIB(1),48(,15) TASKLIB DCB ADDRESS                  34350000
         AIF   ('&SYSASCE' EQ 'P').ICONTP                               34400000
         STAM  &TASKLIB(1),&TASKLIB(1),92(15) TASKLIB AR                34450000
.ICONTP  ANOP                                                           34500000
         AIF   ('&NSHSPL' EQ '').ICONTP0                                34550000
         AIF   ('&NSHSPL'(1,1) NE '(' ).ICONTP1                         34600000
         ST    &NSHSPL(1),56(,15) NSHSPL ADDR INTO LIST                 34650000
         AIF   ('&SYSASCE' EQ 'P').ICONTP1                              34700000
         STAM  &NSHSPL(1),&NSHSPL(1),96(15) NSHSPL AR                   34750000
         AGO   .ICONTP1                                                 34800000
.ICONTP0 ANOP                                                           34850000
         AIF   ('&NSHSPV' EQ '').ICONTP1                                34900000
         AIF   ('&NSHSPV'(1,1) NE '(' ).ICONTP1                         34950000
         STC   &NSHSPV(1),59(,15) NSHSPV VALUE INTO LIST                35000000
.ICONTP1 ANOP                                                           35050000
         B     100(,15)           BRANCH AROUND LIST                    35100000
&GNAME   DS    0F                 SUP. PARAM. LIST                      35150000
         AIF   ('&EP' EQ '').CNTA                                       35200000
         DC    A(*+28)            ADDRESS OF SYMB NAME                  35250000
         AGO   .CCHID                                                   35300000
.CNTA    AIF   ('&EPLOC' EQ '').CNTC                                    35350000
         AIF   ('&EPLOC'(1,1) EQ '(').CNTD                              35400000
         DC    A(&EPLOC)          ADDRESS OF SYMB NAME                  35450000
         AGO   .CCHID                                                   35500000
.CNTC    AIF   ('&DE' EQ '').ERROR6                                     35550000
         AIF   ('&DE'(1,1) EQ '(').CNTD                                 35600000
         DC    A(&DE)             SET DE ADDR                           35650000
         AGO   .CCHID                                                   35700000
.CNTD    DC    A(0)               DE OR EPLOC ADDRESS                   35750000
.CCHID   ANOP                                                           35800000
.CCCHID  ANOP                                                           35850000
.CNTB    AIF   ('&DCB' EQ '').CNTE                                      35900000
         AIF   ('&DCB'(1,1) EQ '(').CNTE                                35950000
         DC    A(&DCB)            DCB ADDRESS                           36000000
         AGO   .CNTF                                                    36050000
.CNTE    DC    A(0)               DCB ADDRESS                           36100000
.CNTF    ANOP                                                           36150000
         AIF   ('&ECB' EQ '').CNTG                                      36200000
         AIF   ('&ECB'(1,1) EQ '(').CNTG                                36250000
         DC    A(X'80000000'+&ECB)  ECB ADDRESS, NEW FORMAT             36300000
         AGO   .CNTH                                                    36350000
.CNTG    DC    A(X'80000000')     ECB ADDRESS, NEW FORMAT               36400000
.CNTH    AIF   ('&GSPV' EQ '').CNTI                                     36450000
         AIF   ('&GSPV'(1,1) EQ '(').CNTJ                               36500000
         DC    A(&GSPV)           GSPV VALUE                            36550000
         AGO   .CNTK                                                    36600000
.CNTI    AIF   ('&GSPL' EQ '').CNTJ                                     36650000
         AIF   ('&GSPL'(1,1) EQ '(').CNTJ                               36700000
         DC    A(&GSPL)           SET GSPL ADDR                         36750000
         AGO   .CNTK                                                    36800000
.CNTJ    DC    A(0)               GSPV VALUE OR GSPL ADDRESS            36850000
.CNTK    AIF   ('&SHSPV' EQ '').CNTL                                    36900000
         AIF   ('&SHSPV'(1,1) EQ '(').CNTM                              36950000
         DC    A(&SHSPV)          SHSPV VALUE                           37000000
         AGO   .CNTN                                                    37050000
.CNTL   AIF   ('&SHSPL' EQ '').CNTM                                     37100000
         AIF   ('&SHSPL'(1,1) EQ '(').CNTM                              37150000
         DC    A(&SHSPL)          SET SHSPL ADDRESS                     37200000
         AGO   .CNTN                                                    37250000
.CNTM    DC    A(0)               SHSPL OR SHSPV                        37300000
.CNTN    ANOP                                                           37350000
         AIF   ('&ETXR' EQ '').CNTO                                     37400000
         AIF   ('&ETXR'(1,1) EQ '(').CNTO                               37450000
         DC    A(&ETXR)           EXIT ROUTINE ADDRESS                  37500000
         AGO   .CNTP                                                    37550000
.CNTO    DC    A(0)               EXIT ROUTINE ADDRESS                  37600000
.CNTP    AIF   ('&DPMOD' EQ '').CNTQ                                    37650000
         AIF   ('&DPMOD'(1,1) EQ '(').CNTQ                              37700000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNC     37750000
         DC    AL2(&DPMOD)        DPMOD VALUE                           37800000
         AGO   .CNTR                                                    37850000
.SIGNC   DC    AL2(0&DPMOD)       DPMOD VALUE                           37900000
         AGO   .CNTR                                                    37950000
.CNTQ    DC    AL2(0)             DPMOD VALUE                           38000000
.CNTR    AIF   ('&LPMOD' EQ '').CNTS                                    38050000
         AIF   ('&LPMOD'(1,1) EQ '(').CNTS                              38100000
         DC    AL1(&LPMOD)        LPMOD VALUE                           38150000
         AGO   .CNTT0C                                                  38200000
.CNTS    DC    AL1(0)             LPMOD VALUE                           38250000
.CNTT0C  ANOP                                                           38300000
.CNTV    DC    AL1(&NUMB)         STATUS BYTE                           38350000
         AIF   ('&EP' EQ '').CNTW                                       38400000
         DC    CL8'&EP'           EP SYMBOL                             38450000
         AGO   .CNTXX                                                   38500000
.CNTW    DC    CL8' '             EP SYMBOL                             38550000
.CNTXX   ANOP                                                           38600000
         AIF   ('&JSCB' EQ '').CONTQ6                                   38650000
         AIF   ('&JSCB'(1,1) EQ '(').CONTQ6                             38700000
         DC    A(&JSCB)           ADDRESS OF JSCB                       38750000
         AGO   .CNTYY                                                   38800000
.CONTQ6  DC    A(0)               ADDRESS OF JSCB                       38850000
.CNTYY   ANOP                                                           38900000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).TLICN                       38950000
         AIF   ('&STPADDR' EQ '').CREG2                                 39000000
         AIF   ('&STPADDR'(1,1) EQ '(' ).CREG2                          39050000
         DC    A(&STPADDR)        STAI/ESTAI PARM LIST ADDR             39100000
         AGO   .CKREG1                                                  39150000
.CREG2   DC    A(0)               STAI/ESTAI PARM LIST ADDR             39200000
.CKREG1  ANOP                                                           39250000
         AIF   ('&STXADDR'(1,1) EQ '(' ).CREG1                          39300000
         DC    A(&STXADDR)        STAI/ESTAI EXIT RTN ADDRESS           39350000
         AGO   .TLICNA                                                  39400000
.CREG1   DC    A(0)               STAI/ESTAI EXIT RTN ADDRESS           39450000
         AGO   .TLICNA                                                  39500000
.TLICN   DC    A(0)               NO STAI/ESTAI PARM LIST ADDR          39550000
         DC    A(0)               NO EXIT ADDRESS                       39600000
.TLICNA  ANOP                                                           39650000
         AIF   ('&TASKLIB' EQ '').TLICNC                                39700000
         AIF   ('&TASKLIB'(1,1) EQ '(' ).TLICNC                         39750000
         DC    A(&TASKLIB)        TASKLIB DCB ADDRESS                   39800000
         AGO   .INSHSP1                                                 39850000
.TLICNC  DC    A(0)               TASKLIB DCB ADDRESS                   39900000
.INSHSP1 ANOP                                                           39950000
&NSHSP   SETC  '0'                ASSUME NO NSHSPL,NSHSPV               40000000
         AIF   ('&NSHSPL' EQ '').INSHSP4   NSHSPL SPECIFIED:            40050000
&NUMB3   SETA  &NUMB3+128         SET BIT TO INDICATE LIST              40100000
&NSHSP   SETC  '&NSHSPL'          INDICATE NSHSPL                       40150000
         AGO   .INSHSP2                                                 40200000
.INSHSP4 AIF   ('&NSHSPV' EQ '').INSHSP2    NSHSPV SPECIFIED:           40250000
&NSHSP   SETC  '&NSHSPV'          INDICATE NSHSPV                       40300000
.INSHSP2 AIF   ('&RSAPF' NE 'YES').INSHSP3 RSAPF SPECIFIED:             40350000
&NUMB3   SETA  &NUMB3+64          SET BIT TO INDICATE IT                40400000
.INSHSP3 DC    AL1(&NUMB3)        FLAG BYTE                             40450000
         AIF   ('&TID'(1,1) EQ '(').BYT53A                              40500000
         DC    AL1(&TID)          TASK ID                               40550000
         AGO   .BYT53B                                                  40600000
.BYT53A  DC    AL1(0)             TID = 0                               40650000
.BYT53B  ANOP                                                           40700000
         DC    AL2(100)           PARM LIST LENGTH                      40750000
         AIF   ('&NSHSP'(1,1) EQ '(').INSHSP5                           40800000
         DC    A(&NSHSP)          NSHSPV VALUE OR NSHSPL ADDR           40850000
         AGO   .BYTE60                                                  40900000
.INSHSP5 ANOP                                                           40950000
         DC    A(0)               NSHSPV VALUE OR NSHSPL ADDR           41000000
.BYTE60  ANOP                                                           41050000
         DC    AL1(&NUMB1)        FLAG BYTE                             41100000
         DC    AL1(&FORM#)        SET UP FORMAT NUMBER                  41150000
         DC    AL1(&NUMF3)        SET FLAGS                             41183300
         DC    AL1(0)             RESERVED BYTE                         41216600
         DC    A(0)               EPLOC/DE/EP ALET                      41250000
         DC    A(0)               DCB ALET                              41300000
         DC    A(0)               ECB ALET                              41350000
         DC    A(0)               GSPL ALET                             41400000
         DC    A(0)               SHSPL ALET                            41450000
         DC    A(0)               JSCB ALET                             41500000
         DC    A(0)               (E)STAI PARAMETER ALET                41550000
         DC    A(0)               TASKLIB ALET                          41600000
         DC    A(0)               NSHSP ALET                            41650000
.SVC     SVC   42                 ISSUE ATTACH SVC                      41700000
         AGO   .EXIT                                                    41750000
.ERROZ   IHBERMAC 1003,PURGE,ASYNCH                                     41800000
         AGO   .EXIT                                                    41850000
.ERROR   IHBERMAC 1004,&STAITYP                                         41900000
         AGO   .EXIT                                                    41950000
.E2      IHBERMAC 1005,&STAITYP                                         42000000
         AGO   .EXIT                                                    42050000
.E3      IHBERMAC 1005,PURGE                                            42100000
         AGO   .EXIT                                                    42150000
.E4      IHBERMAC 1005,ASYNCH                                           42200000
         AGO   .EXIT                                                    42250000
.E5      IHBERMAC 1005,SZERO,YES                                        42300000
         AGO   .EXIT                                                    42350000
.E6      IHBERMAC 1005,GIVEJPQ                                          42400000
         AGO   .EXIT                                                    42450000
.E7      IHBERMAC 1005,GSPV                                             42500000
         AGO   .EXIT                                                    42550000
.E8      IHBERMAC 1005,GSPL                                             42600000
         AGO   .EXIT                                                    42650000
.E9      IHBERMAC 1005,SHSPV                                            42700000
         AGO   .EXIT                                                    42750000
.E10     IHBERMAC 1005,SHSPL                                            42800000
         AGO   .EXIT                                                    42850000
.ERDISP  IHBERMAC 1001,DISP,&DISP                                       42900000
         AGO   .EXIT                                                    42950000
.ERTQE   IHBERMAC 1001,TQE,&TQE                                         43000000
         AGO   .EXIT                                                    43050000
.ERFP    IHBERMAC 1001,FPREGSA,&FPREGSA                                 43100000
         AGO   .EXIT                                                    43150000
.ERTERM  IHBERMAC 1001,TERM,&TERM                                       43200000
         AGO   .EXIT                                                    43250000
.ERALCPY IHBERMAC 1001,ALCOPY,&ALCOPY                                   43300000
         AGO   .EXIT                                                    43333300
.ERADDRE IHBERMAC 1001,ADDRENV,&ADDRENV                            @L3A 43366600
         AGO   .EXIT                                               @L3A 43383300
.ERNSHSP IHBERMAC 1020,NSHSPV,NSHSPL                                    43400000
         AGO   .EXIT                                                    43450000
.ERSTAI  IHBERMAC 1020,STAI,ESTAI                                       43500000
         MEXIT                                                          43507100
.ERRKEYNINE ANOP                                                        43514200
&ZMS     SETC  'KEY=NINE MAY NOT BE SPECIFIED WITH GSPL, GSPV, '   @L5A 43521300
&ZMS     SETC  '&ZMS.SHSPL, SHSPV, OR SZERO=YES'                   @L5A 43528400
         MNOTE 8,' &ZMS '                                          @L5A 43535500
         MEXIT                                                     @L5A 43542600
.END     ANOP                                                           43550000
         AGO   .EXIT                                                    43576300
.********************************************************************** 43602700
.*   HANDLE DISP=RESET WITH TCB REQUEST                               * 43605400
.********************************************************************** 43608100
.ATTCHD  ANOP                                                      @L2A 43610800
.********************************************************************** 43610900
.*                                                                    * 43611000
.* PROCESSING OF ATTACH WITH DISP=YES AND TCB ADDRESS                 * 43611100
.*                                                                    * 43611200
.********************************************************************** 43611300
.RESET00 ANOP                                                      @L2A 43611400
         LCLC  &PLENGTH    PARAMETER LIST LENGTH                        43611500
         LCLC  &ZJUMP      WORK STRING FOR PARAMETER LIST LENGTH        43611600
         LCLC  &ZMS        MNOTE ERROR STRING                           43611700
         LCLC  &FLEN       TOTAL LENGTH OF PARAMETER LIST               43611800
         LCLC  &FLAE       XA OR ESA LOAD ADDRESS                       43611900
&FLEN    SETC  '100'                                                    43612000
&FLAE    SETC  'LAE'                                                    43612100
&FORM#   SETC  '3'         PARAMETER LIST FOR DISP=RESET WITH TCB  @P2A 43612200
.********************************************************************** 43612300
.*       PERFORM CHECK FOR UNRECOGNIZED DISP KEYWORD                  * 43612400
.********************************************************************** 43612500
&ZMACRET SETA  0           INIT RETURN CODE                        @L2A 43612600
         AIF   ('&DISP' EQ 'RESET').RESET0B                        @L2A 43612700
         AIF   ('&DISP' EQ 'YES').RESET0B                          @L2A 43612800
         AIF   ('&DISP' EQ 'NO').RESET0B                           @L2A 43612900
         IHBERMAC 1001,DISP,&DISP                                       43613000
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 43613100
.********************************************************************** 43613200
.*       PERFORM CHECK FOR CORRECT COMBINATION OF DISP=RESET WITH TCB * 43613300
.********************************************************************** 43613400
.RESET0B ANOP                                                      @L2A 43613500
         AIF   ('&DISP' EQ 'RESET' AND T'&TCB NE 'O').RESET01      @L2A 43613600
&ZMS     SETC  'DISP=RESET MUST BE SPECIFIED WITH TCB KEYWORD. '   @L2A 43613700
         MNOTE 8,' &ZMS '                                          @L2A 43613800
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 43613900
.********************************************************************** 43614000
.*       PERFORM CHECK FOR LIST FORM INVOCATION                       * 43614100
.********************************************************************** 43614200
.RESET01 ANOP                                                      @L2A 43614300
         AIF   ('&SF' NE 'L'  ).RESET02                            @L2A 43614400
&ZMS     SETC  'LIST FORM IS INCOMPATIBLE WITH DISP=RESET WITH TCB. '   43614500
         MNOTE 8,' &ZMS '                                               43614600
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 43614700
         AGO   .RESET02                                                 43614800
.********************************************************************** 43614900
.*       PERFORM CHECK FOR INCOMPATIBLE PARAMETERS                    * 43615000
.********************************************************************** 43615100
.RESET02 ANOP                                                      @L2A 43615200
         AIF   (T'&EP NE 'O').RESET03                              @L2A 43615400
         AIF   (T'&EPLOC NE 'O').RESET03                           @L2A 43615600
         AIF   (T'&DE NE 'O').RESET03                              @L2A 43615800
         AIF   (T'&DCB NE 'O').RESET03                             @L2A 43616000
         AIF   (T'&PARAM NE 'O').RESET03                           @L2A 43616200
         AIF   (T'&VL NE 'O').RESET03                              @L2A 43616400
         AIF   (T'&ECB NE 'O').RESET03                             @L2A 43616600
         AIF   (T'&GSPV NE 'O').RESET03                            @L2A 43616800
         AIF   (T'&GSPL NE 'O').RESET03                            @L2A 43617000
         AIF   (T'&SHSPL NE 'O').RESET03                           @L2A 43617200
         AIF   (T'&ETXR NE 'O').RESET03                            @L2A 43617400
         AIF   (T'&LPMOD NE 'O').RESET03                           @L2A 43617600
         AIF   (T'&DPMOD NE 'O').RESET03                           @L2A 43617800
         AIF   (T'&SHSPV NE 'O').RESET03                           @L2A 43618000
         AIF   (T'&HIARCHY NE 'O').RESET03                         @L2A 43618200
         AIF   (T'&JSCB NE 'O').RESET03                            @L2A 43618400
         AIF   (T'&TASKLIB NE 'O').RESET03                         @L2A 43618600
         AIF   (T'&STAI NE 'O').RESET03                            @L2A 43618800
         AIF   (T'&PURGE NE 'O').RESET03                           @L2A 43619000
         AIF   (T'&ASYNCH NE 'O').RESET03                          @L2A 43619200
         AIF   (T'&ESTAI NE 'O').RESET03                           @L2A 43619400
         AIF   (T'&NSHSPL NE 'O').RESET03                          @L2A 43619600
         AIF   (T'&NSHSPV NE 'O').RESET03                          @L2A 43619800
         AIF   (T'&TQE NE 'O').RESET03                             @L2A 43620000
         AIF   (T'&FPREGSA NE 'O').RESET03                         @L2A 43620200
         AIF   (T'&ALCOPY NE 'O').RESET03                          @L2A 43620400
         AIF   (T'&ADDRENV NE 'O').RESET03                         @L3A 43620500
         AIF   (T'&PKM NE 'O').RESET03                             @L5A 43620600
         AIF   ('&KEY' EQ 'NINE').RESET03                          @L5A 43620700
         AGO .RESET04                                                   43620800
.********************************************************************** 43620900
.*       INCOMPATIBLE PARAMETER DETECTED                              * 43621000
.********************************************************************** 43621200
.RESET03 ANOP                                                      @L2A 43621400
&ZMS     SETC  'KEYWORD(S) SPECIFIED IS INCOMPATIBLE'                   43621600
&ZMS     SETC  '&ZMS. WITH DISP=RESET AND TCB KEYWORD. '                43621800
         MNOTE 8,' &ZMS '                                               43622000
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 43622200
.********************************************************************** 43622400
.*       VERIFY THAT TCB PARAMETER IS O.K.                            * 43622600
.********************************************************************** 43622800
.RESET04 ANOP                                                      @L2A 43623000
         AIF   ('&TCB' NE '(15)').RESET05                          @L2A 43623200
&ZMS     SETC  'TCB ADDRESS CANNOT BE PASSED IN REGISTER 15.'      @L2A 43623400
         MNOTE 8,' &ZMS '                                               43623600
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 43623800
.RESET05 ANOP                                                      @L2A 43624000
         AIF   ('&SF'    EQ 'I'  ).RESET09                         @L2A 43624200
         AIF   ('&SF(1)' EQ 'E'  ).RESET06                         @L2A 43624400
         AGO   .RESET09                                            @L2A 43624600
.*                                                                      43624800
.*       VERIFY EXECUTE TCB SPECIFICATION                               43625000
.*                                                                      43625200
.RESET06 ANOP                                                      @L2A 43625400
         AIF   ('&SF(2)' NE ''  ).RESET09                          @L2A 43625600
&ZMS     SETC  'LIST ADDRESS MUST BE SUPPLIED WITH EXECUTE FORM. '      43625800
         MNOTE 8,' &ZMS '                                               43626000
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 43626200
.********************************************************************** 43626400
.*        END CHECKING OF TCB SPECIFICATION                           * 43626600
.********************************************************************** 43626800
.RESET09 ANOP                                                           43627000
.********************************************************************** 43627200
.*        ERROR-CHECKING COMPLETE                                     * 43627400
.********************************************************************** 43627600
.RESET26 ANOP                                                      @L2A 43627800
         AIF   (&ZMACRET NE 0).RESET99  IF ERRORS DETECTED THEN QUIT    43628000
.********************************************************************** 43628200
.*                                      ELSE, GENERATE CODE           * 43628400
.*--------------------------------------------------------------------* 43628600
.*        SEPARATE IN-LINE AND EXECUTE FORMS                          * 43628800
.********************************************************************** 43629000
         AIF   ('&SF'    EQ 'I').RESETIN     IN-LINE MACRO FORM    @L2A 43629200
         AIF   ('&SF(1)' EQ 'E').RESETEX     EXECUTE MACRO FORM    @L2A 43629400
.********************************************************************** 43629600
.*        HANDLE IN-LINE FORM                                         * 43629800
.********************************************************************** 43630000
.RESETIN ANOP                                                      @L2A 43630200
&GNAME   SETC  'IHB'.'&SYSNDX'    GENERATE LIST NAME               @L2A 43630400
&ZJUMP   SETC  '&FLEN'.'(,15)'    GENERATE BRANCH AROUND LIST      @L2A 43630600
&NAME    DS    0H                                                       43630800
         CNOP  0,4                                                      43631000
         &FLAE 15,&GNAME          SET UP LIST ADDRESS                   43631200
         B     &ZJUMP             BRANCH AROUND LIST                    43631400
&GNAME   DS    0F                 SUP. PARM LIST                        43631600
         DC    XL8'00'                                             @P3A 43631700
         DC    XL4'80000000'                                       @P3A 43631800
         DC    XL42'00'                                            @P3C 43631900
         DC    AL2(&FLEN)         PARM LIST LENGTH                      43632000
         DC    A(0)               NSHSPV VALUE OR NSHSPL ADDR           43632200
         DC    X'00'              FLAG BYTE WITH TCB FLAG               43632400
         DC    AL1(&FORM#)        SET UP FORMAT NUMBER                  43632600
         DC    XL(&FLEN-62)'00'   RESERVED BYTES AT END                 43632800
         AGO   .RESETCB           GENERATE CODE TO GET TCB ADDRESS      43633000
.********************************************************************** 43633200
.*        HANDLE EXECUTE FORM                                         * 43633400
.********************************************************************** 43633600
.RESETEX ANOP                                                      @L2A 43633800
&NAME    DS    0H                                                       43634000
         AIF   ('&SF(2)' EQ '(15)').RESETE3  LIST ADDRESS IN REG 15     43634200
         AIF   ('&SF'(4,1) EQ '(' ).RESETE2  LIST ADDRESS IN OTHER REG  43634400
         AGO   .RESETE1                      LIST ADDRESS TO BE LOADED  43634600
.RESETE1 ANOP                 LIST ADDRESS TO BE LOADED            @L2A 43634800
         &FLAE 15,&SF(2)          SET UP LIST ADDRESS                   43635000
         AGO   .RESETE4           GENERATE CODE TO SET BITS        @L2A 43635200
.RESETE2 ANOP                 LIST ADDRESS IN OTHER REG            @L2A 43635400
         LR    15,&H              COPY LIST ADDRESS                     43635600
         AGO   .RESETE4           GENERATE CODE TO SET BITS        @L2A 43635800
.RESETE3 ANOP                 LIST ADDRESS IN REG 15               @L2A 43636000
         AGO   .RESETE4           GENERATE CODE TO SET BITS        @L2A 43636200
.********************************************************************** 43636400
.*        GENERATE BAL CODE TO SET OPTION BIT IN ATTACH PARAMETER LIST  43636600
.********************************************************************** 43636800
.RESETE4 ANOP                                                      @L2A 43637000
         MVI   55(15),72          SET LENGTH OF THIS PARM LIST          43637200
         OI    8(15),X'80'        SET NEW FORMAT BIT                    43637400
         MVI   61(15),&FORM#      SET FORMAT NUMBER                     43637600
         AGO   .RESETCB       GENERATE CODE TO GET TCB ADDRESS     @L2A 43638200
.********************************************************************** 43638400
.*        GENERATE BAL CODE TO GET TCB ADDRESS                        * 43638600
.********************************************************************** 43638800
.RESETCB ANOP                                                      @L2A 43639000
         AIF  ('&TCB' EQ '(1)').RESETB3                            @L2A 43639200
         AIF  ('&TCB'(1,1) EQ '(').RESETB2                         @L2A 43639400
.*                                                                      43639600
.*       TCB ADDRESS IS IN STORAGE                                      43639800
.*                                                                      43640000
         L     1,&TCB             LOAD TCB ADDRESS                      43640200
         AGO   .RESETB3         GO ISSUE SVC                       @L2A 43640400
.*                                                                      43640600
.*       TCB ADDRESS IS IN A REGISTER OTHER THAN REG 1                  43640800
.*                                                                      43641000
.RESETB2 ANOP                                                      @L2A 43641200
         LR    1,&TCB(1)          COPY TCB ADDRESS                      43641400
.********************************************************************   43641600
.***       ISSUE ATTACH SVC                                             43641800
.********************************************************************   43642000
.RESETB3 ANOP                   TCB ADDRESS IS IN REGISTER 1            43642200
         SVC   42                 ISSUE ATTACH SVC                      43642400
.********************************************************************   43642600
.***       EXIT MACRO                                                   43642800
.********************************************************************   43643000
.RESET99 ANOP                                                           43643200
         SPACE 1                                                        43643400
         AGO   .EXIT                                                    43645000
.EXIT    ANOP                                                           43646600
&SYSPLIST8 SETC '&SAVEPLIST8'                                      @L6A 43648300
         MEND                                                           43650000
**/                                                                     43700000
*  ATTACHX :       /**************************************************/ 43750000
*/********************************************************************/ 43800000
*/**************** PL/S VERSION OF THE ATTACHX MACRO *****************/ 43850000
*/********************************************************************/ 43900000
* MACRO                                                                 43950000
*   KEYS( ALCOPY, ASYNCH, DCB, DE, DPMOD, ECB, EP, ESTAI, ETXR,         44000000
*         GIVEJPQ, GSPL, GSPV, JSCB, JSTCB,                             44033300
*         KEYNINE, KEYZERO, LPMOD, MF,                                  44066600
*         NOASYNCH, NODISP, NOSVAREA, NOSZERO, NSHSPL, NSHSPV, PARAM,   44100000
*         PKM,                                                          44125000
*         PURGE, RTCD, SF, SHSPL, SHSPV, SM, STAI, TASKLIB, TCB, TERM,  44150000
*         TID, VL, RELATED, RSAPF, DISP, ADDRENV, PLIST8,               44183300
*         PLIST4);                                            /* @L3C*/ 44216600
*          ANS('?'||MACLABEL||'ATTACHXP '||MACLIST||MACKEYS||';'); /*   44250000
*                                    INVOKE HIGHEST LEVEL            */ 44300000
*%END;                                                                  44350000
