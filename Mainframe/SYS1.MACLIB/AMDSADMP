        MACRO                                                           00050000
&SADMP  AMDSADMP &IPL=DSYSDA,&OUTPUT=,&CONSOLE=,                       X00100000
               &SYSUT=SYSDA,&VOLSER=SADUMP,&ULABEL=,                   X00150000
               &TYPE=,&ADDR=,&DUMP=,&LOADPT=,&REUSEDS=CHOICE,          X00200000
               &MSG=ALL,&MINASID=,&PROMPT,&COMPACT=YES,                X00233300
               &ALIB=,&NUCLIB=,&LNKLIB=,&MODLIB=,&DDSPROMPT=NO     @06C 00266600
          AGO   .NOPROA                 SKIP PROLOGUE CODE              00300000
         SPACE                                                          00550000
** START OF SPECIFICATIONS ******************************************   00594500
*                                                                       00639000
*01* MACRO NAME: AMDSADMP                                               00683500
*                                                                       00728000
*01* DESCRIPTIVE NAME: STAND-ALONE DUMP TWO-STAGE GENERATION            00772500
*                                                                       00817000
*01* COMPONENT: STAND-ALONE DUMP (SC115)                                00861500
*                                                                       00906000
*01* PROPRIETARY STATEMENT:                                             00950500
*                                                                       00995000
*      LICENSED MATERIALS - PROPERTY OF IBM                             01039500
*      THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      01089500
*      5647-A01 (C) COPYRIGHT IBM CORP. 1981, 2000                      01139500
*                                                                       01217500
*01* STATUS: HBB7703                                              @L6C  01262000
*                                                                       01306500
*01* FUNCTION:  THE AMDSADMP MACRO GENERATES THE JCL INPUT TO           01351000
*               STAGE 2 OF STAND-ALONE DUMP GENERATION (WHICH,          01395500
*               IN TURN, COMPLETES THE INITIALIZATION OF THE            01440000
*               IPL-ABLE DUMP PROGRAM RESIDENCE VOLUME).                01484500
*               THIS MACRO PASSES PARAMETERS VIA THE STAGE 2 JCL        01529000
*               AS INPUT TO AMDSADM2 AND AMDSABLD.  (ALSO TO            01573500
*               ICKDSF IF IPL=D SPECIFIED).                             01618000
*                                                                       01662500
*01* METHOD OF ACCESS:                                                  01707000
*                                                                       01751500
*      THE KEYWORD SPECIFICATIONS ARE DESCRIBED IN                      01796000
*        OS/390 MVS Diagnosis: Tools and Service Aids              @L6C 01840500
*                                                                       01885000
*01* PUBLICATIONS:                                                      01929500
*                                                                       01974000
*      OS/390 MVS Diagnosis: Tools and Service Aids                @L6C 02024000
*                                                                       02074100
*01* EXTERNAL CLASSIFICATION: OTHER                               @P7C  02085200
*01* END OF EXTERNAL CLASSIFICATION:                              @P6A  02096300
*                                                                       02107500
*01* CHANGE ACTIVITY:                                                   02152000
* A000000-999999                                               @G860P1W 02200000
* $MAC(AMDSADMP),COMP(SC115),PROD(HBB4420): TWO-STAGE GENERATION        02233300
*                                                                       02266600
* APAR      DATE       REASON                                           02300000
* OZ66866   12/17/82   VARIABLE &ULABEL2 NOT DECLARED                   02350000
* OZ76321   02/29/84   AMDSADMP DOES NOT SUBSTITUTE IPL=DSYSDA          02400000
*                      IF IPL= PARAMETER IS CODED INCORRECTLY @ZA76321  02450000
* OZ89464   07/03/85   MSGAMD064I RC4 RECEIVED DURING         @ZA89464  02500000
*                      ASSEMBLE WHEN OBJECT PARM DEFAULT IS   @ZA89464  02550000
*                      TAKEN.                                 @ZA89464  02600000
* OZ93271   12/09/85   CONSOLE= NOT RECOGNIZED WHEN IT IS     @ZA93271  02650000
*                      ON A CONTINUATION CARD STARTED IN      @ZA93271  02700000
*                      A COLUMN BEYOND COLUMN 16. NO MESSAGE  @ZA93271  02750000
*                      ISSUED INDICATING DEFAULT TAKEN.       @ZA93271  02800000
* OZ94080   01/06/86   MSGAMD064I RC4 RECEIVED DURING         @ZA94080  02850000
*                      ASSEMBLE WHEN RENT PARM DEFAULT IS     @ZA94080  02900000
*                      TAKEN.                                 @ZA94080  02950000
*                                                                       03000000
* FLAG   REASON   RELEASE   DATE   ORIGIN   DESCRIPTION                 03050000
* $H1=   3480     JBB2125  830608  PD1X:    3480 TAPES                  03100000
*                                                                       03150000
* $D1=   DCRR0257 HBB3310  870525  PDBX:    28K BLOCKING           @D1A 03200000
* $D2=   DCRR0174 HBB5510  930909  PDMC:    > CORRECTION ON ADDING '/'  03216600
*                                           FOR MIGRATION PURPOSES      03233200
*                                           > ADDITION OF NUCLIB,       03245600
*                                           MODLIB, LNKLIB, AND ALIB    03254700
*                                           KEYWORDS FOR MIGRATION      03263800
*                                           SUPPORT                     03272900
*                                           > IPL PARAMETER SHOULD      03282200
*                                           ACCEPT UP TO 8 DIGITS       03288100
*                                           FOR UNIT TYPE          @D2A 03294000
* $D3=   DCRR0003 JBB6604  970116  B7VBGD   Workspace double       @D3A 03297000
* $L1=   MACLIB   JBB3313  881104  PD1X:    MACRO LIBRARY SUPPORT:      03300000
*                                           ACCESS SYS1.MACLIB AND      03350000
*                                           SYS1.MODGEN            @L1A 03400000
* $L2=   JUP03    HBB4410  880715  PDCV:    RESIDENCE LIBRARY CHANGE    03410700
*                                           FROM LINKLIB TO NUCLEUS     03421400
*                                                                  @L2A 03432100
* $L3=   CIHWE    HBB4420  891211  PD1X:    DUMP RESTRUCTURE       @L3A 03442800
* $L4=   SDMPD    HBB4430  910601  PD1X:    DUMP TO DASD SUPPORT   @L4A 03450000
* $L5=   4DGIT    HBB5510  930304  PDCU:    4-DIGIT DEVICE SUPPORT @L5A 03450100
* $L6=   64BIT    HBB7703  981012  B7BVGD:  64 bit real support    @L6A 03450200
* $L7=   64BIT    HBB7703  990304  B7BVGD:  64 bit real support    @L7A 03450300
* $L8=   64BIT    HBB7703  990607  B7BVGD:  64 bit real support    @L8A 03450400
*                                                                       03450500
* $P1=   PAJ0375  JBB2125  831104  PD1V:    DASD DATASET SIZE           03450600
* $P2=   PKB0202  HBB4430  911209  PDIM:    GENERATION PARAMETERS  @P2A 03450700
* $P3=   PKB2434  HBB4430  920430  PDIM:    CHANGE DEFAULT VALUE OF     03451200
*                                           REUSEDS TO CHOICE      @P3A 03451800
* $P4=   PKB2544  HBB4430  920430  PDIM:    INDICATE DEFAULT VALUE OF   03452400
*                                           REUSEDS IN MNOTE       @P4A 03453000
* $P5=   PIG4240  HBB5510  930629  PDMC:    CORRECT IPL= SYNTAX         03453100
*                                           CHECKING.              @P5A 03453200
* $P6=   PN71731  HBB5520  941020  PDNO:    Add External Classification 03453300
*                                           in prolog              @P6A 03453400
*                                                                       03453700
* $P7=   PQC2167  HBB6603  960904  PDNO:    Change External Class from  03453800
*                                           GUPI to OTHER          @P7A 03453900
* $P8=   PSY0334  JBB6604  970225  MXN:     Corrected errors in         03454000
*                                           change activity flags  @P8A 03454100
* $P9=   PVT0555  HBB6606  980306  MXN:     Make ASMA90 the default     03454200
*                                           assembler for SADMP         03454300
*                                           generation.            @P9A 03454400
*                                                                       03454700
* $T1=   OY11024  HBB3310  880120  PDBW:    REDUCED MINIMAL DUMP   @T1A 03454800
*                                                                       03454900
* $01=   OY40870  HBB4420  900813  PDF7:    IDRC SUPPORT           @01A 03455000
* $02=   OY47897  HBB3310  910923           ADD THE DCB FOR SYSPUNCH    03455100
*                                                              @YA47897 03455400
* $03=   OY57723  HBB4420  930301  PDLO:    ADD KEYWORD TO MSG=         03455800
*                                           PARAMETER TO DISPLAY ASIDS  03456200
*                                                                  @03A 03456600
* $04=   OY65489  HBB4420  930828  PDNO:    FOR TWO-STEP GENERATION     03457000
*                                  PROCESS, PUNCH OUT JCL THAT CALLS    03457400
*                                  AMDSATDS TO DETERMINE WHICH          03457800
*                                  ASSEMBLER TO USE AND PUNCH           03458200
*                                  CONDITIONAL LOGIC TO USE EITHER      03458600
*                                  THE IEV90 OR THE ASMA90 ASSEMBLER    03459000
*                                                                  @04A 03459400
* $05=   OW00370  HBB4420  931209  PDNO:    Invalid OUTPUT= parameter   03459500
*                                  specification should generate a      03459600
*                                  return code of 4.               @05A 03459700
* $06=   OW20377  HBB5510  960531  PDNO: Allow multiple dump data       03459800
*                                        names                     @06A 03459900
* $07=   OW39188  HBB6606  990630  MXN:  Message AMD064I RC04 from      03460000
*                                        AMDSABLD when HLASM 1.3        03460100
*                                        installed with XOBJECT         03460200
*                                        option.  Invoke HLASM          03460300
*                                        with NOXOBJECT option to       03460400
*                                        guarantee OBJ format.     @07A 03460500
*                                                                       03460600
*01* MESSAGES:                                                          03460700
*                                                                       03461100
*      THIS MACRO PRODUCES THE FOLLOWING MNOTES:                        03464800
*      (ALL MNOTES START WITH: "IEV254  *** MNOTE ***")                 03468500
*                                                                       03472200
* 0,AMDSADMP: COMPACT=&COMPACT IS NOT ALLOWED. IT MUST BE YES OR NO.    03473400
*            COMPACT=YES HAS BEEN USED.                                 03474600
* 0,AMDSADMP: CONSOLE ADDRESS &CONAD IS INVALID. IT MUST BE A DEVICE    03475900
*           NUMBER. 001F IS SUBSTITUTED.                                03479600
* 0,AMDSADMP: CONSOLE PARM NOT DETECTED. DEFAULT (001F,3278) WILL BE    03483300
*           USED.                                                       03487000
* 0,AMDSADMP: CONSOLE TYPE &CONTP IS INVALID. IT MUST BE A 4            03490700
*           DIGIT NUMBER. 3278 HAS BEEN USED.                           03494400
* 0,AMDSADMP: CONSOLE TYPE &CONTP IS INVALID.  NO VALUE MAY BE          03495100
*           SPECIFIED FOR SYSC.  IT WILL BE IGNORED.               @L8A 03495800
* 0,AMDSADMP: CONSOLE ADDRESS SYSC MAY ONLY BE SPECIFIED FOR THE        03496500
*           FIRST CONSOLE.  IT WILL BE IGNORED.                    @L8A 03497200
* 0,'AMDSADMP: ONLY SYSTEM CONSOLE DEFINED. DEFAULT (001F,3278)         03497500
*           WILL BE USED ALSO BE USED.                             @L8A 03497800
* 0,AMDSADMP: DEFAULT OUTPUT DEVICE T0282 WILL BE USED.                 03498100
* 0,AMDSADMP: IPLUNIT WAS NOT SPECIFIED. UNIT WILL BE DEFAULTED         03509200
*           TO SYSDA.                                                   03512900
* 0,AMDSADMP: IPLUNIT WAS NOT SPECIFIED. UNIT WILL BE DEFAULTED         03516600
*           TO 3400.                                                    03520300
* 0,AMDSADMP: LOADPT IS AN OBSOLETE KEYWORD. IT IS IGNORED.             03524000
*           SADMP GENERATION CONTINUES.                                 03527700
* 0,AMDSADMP: MINASID=ALL OR MINASID=PHYSIN NOT SPECIFIED               03531400
*           THE DEFAULT MINASID=ALL WILL BE USED.                       03535100
* 0,AMDSADMP: MSG=&MSG IS INVALID. IT MUST BE ALL, ACTION OR       @03C 03538800
*           ALLASIDS.   MSG=ALL HAS BEEN USED.                     @03C 03542500
* 0,AMDSADMP: TYPE IS AN OBSOLETE KEYWORD. IT IS IGNORED.               03553600
*           SADMP GENERATION CONTINUES.                                 03557300
* 0,AMDSADMP: WARNING MINASID=&MINASID WAS SPECIFIED. REFER TO          03561000
*           MESSAGE AMD082I.                                            03564700
* 0,AMDSADMP: REUSEDS =&REUSEDS IS NOT ALLOWED. VALID SPECIFICATIONS    03565900
*           FOR REUSEDS ARE NEVER, CHOICE, OR ALWAYS.              @L4A 03567100
* 0,AMDSADMP: DDSPROMPT=&DDSPROMPT IS NOT ALLOWED. IT MUST BE YES       03567200
*           OR NO. DDSPROMPT=YES HAS BEEN USED.                    @06A 03567300
* 4,AMDSADMP: OUTPUT DUMP DATA SET NAME IS INCORRECT. THE DATASET NAME  03567400
*           NAME IS GREATER THAN 44 CHARACTERS.                    @06A 03567500
* 4,AMDSADMP: OUTPUT DUMP DATA SET NAME IS INCORRECT.  IT MUST CONTAIN  03567600
*           THE TEXT 'SADMP'.                                      @06A 03567700
* 4,AMDSADMP: OUTPUT=&OUTPUT IS INCORRECT. IT MUST BE EITHER {T|D}UNIT  03567800
*           OR (DUNIT,DATASET NAME).                               @06C 03568100
* 4,AMDSADMP: IPL=&IPL IS INVALID. FIRST CHARACTER MUST BE              03568400
*           D OR T, AND HAS BEEN REPLACED WITH A D.                     03572100
* 4,AMDSADMP: IPLUNIT=&IPLUNIT IS TOO LONG.                             03575800
*           THE UNIT NAME WILL BE TRUNCATED.                            03577600
* 8,AMDSADMP: ULABEL=NOPURGE IS NOT POSSIBLE FOR A TAPE                 03579500
*           RESIDENCE VOLUME.                                           03583200
* 8,AMDSADMP: ALIB=&ALIB IS NOT VALID.  THE REQUIRED SYNTAX IS          03583800
*           ALIB=(VOLSER,UNIT).                                    @D2A 03584400
* 8,AMDSADMP: NUCLIB=&NUCLIB IS NOT VALID.  THE REQUIRED SYNTAX IS      03585000
*           NUCLIB=(VOLSER,UNIT).                                  @D2A 03585600
* 8,AMDSADMP: MODLIB=&MODLIB IS NOT VALID.  THE REQUIRED SYNTAX IS      03587400
*           MODLIB=(VOLSER,UNIT).                                  @D2A 03588000
* 8,AMDSADMP: LNKLIB=&LNKLIB IS NOT VALID.  THE REQUIRED SYNTAX IS      03588600
*           LNKLIB=(VOLSER,UNIT).                                  @D2A 03589600
*                                                                       03590600
** END OF SPECIFICATIONS ********************************************   03594300
.NOPROA   ANOP                                                          03600000
.*                                                                      03650000
.********************************************************************   03700000
.*                                                                      03750000
.* VARIABLES AND CONSTANTS                                              03800000
.*                                                                      03850000
.********************************************************************   03900000
         GBLB     &OSG            THIS IS 1 FOR ONE STEP GENERATION     03950000
         LCLC     &CON2                                                 04000000
         LCLC     &MSGK,&PMTK,&COMPK,&DDSPMTK                      @06C 04050000
         LCLC     &CONAD,&CONTP                                         04100000
         LCLC     &KEYWORD,&SUBSTR,&Q,&QQ,&LIST,&COMMA,&CL              04150000
         LCLC     &OUTPUT2,&JOBNAME,&ULABEL2,&OUTDDS,&OUTDEV       @06C 04187500
         LCLC     &REUSDS1                                         @L4A 04225000
         LCLC     &CONLIST,&DLM,&SL,&MINTYPE                       @T1C 04250000
         LCLA     &SLI,&SLB,&SLE,&SLL                                   04300000
         LCLA     &UNITBEG,&UNITLEN                                     04350000
         LCLA     &BEG,&LEN,&INDEX,&REP,&LOOPEND,&I                @L5C 04400000
         LCLA     &DM2CNT                USED AS A LOOP CONTROL        X04412500
                                         VARIABLE TO BUILD THE         X04425000
                                         AMDSADM2 MACRO TWICE      @04A 04437500
         LCLC     &IPLUNIT,&IPLVAR,&HEXN                           @L3C 04450000
         LCLC     &SLASH                                           @D2A 04475000
         LCLC     &AVOL,&NUCVOL,&LNKVOL,&MODVOL                    @D2A 04483300
         LCLC     &AUNIT,&NUCUNIT,&LNKUNIT,&MODUNIT                @D2A 04491600
&Q       SETC     ''''             SINGLE QUOTE                         04500000
&QQ      SETC     ''''''           DOUBLE QUOTE                         04550000
.*                                                                      04900000
.********************************************************************   04925000
.*                                                                      04950000
.*       ISSUE WARNING MNOTE FOR OBSOLETE TYPE= PARAMETER.        @L3A  04958300
.*                                                                      04966600
.********************************************************************   04974900
.*                                                                      04983200
.*                                                                      04991500
         AIF   ('&TYPE' EQ '').MSGPARM  NO TYPE, SO CONTINUE       @L3A 05000000
         MNOTE 0,'AMDSADMP: TYPE IS AN OBSOLETE KEYWORD. IT IS IGNORED.X05050000
                          SADMP GENERATION CONTINUES.'             @L3A 05100000
.*                                                                      05150000
.********************************************************************   05200000
.*                                                                      05450000
.*                      MSG= PARAMETER                                  05460000
.*                                                                      05470000
.********************************************************************   05480000
.*                                                                      05490000
.MSGPARM ANOP                                                      @L3A 05500000
         AIF   ('&MSG' EQ 'ALLASIDS').MSG3                         @03A 05525000
         AIF   ('&MSG' EQ 'ALL').MSG1                                   05550000
         AIF   ('&MSG' NE 'ACTION').MSG2                                05600000
&MSGK    SETC  'ACTION'                                                 05650000
         AGO   .MSG4                                               @03C 05700000
.MSG2    ANOP                                                           05750000
         MNOTE 0,'AMDSADMP: MSG=&MSG IS INVALID. IT MUST BE ALL, ACTIONX05771400
               , OR        ALLASIDS.   MSG=ALL HAS BEEN USED.'     @03C 05792800
         AGO    .MSG1                                                   05814200
.MSG3    ANOP                                                      @03A 05835600
&MSGK    SETC   'ALLASIDS'                                         @03A 05857000
         AGO    .MSG4                                              @03A 05878400
.MSG1    ANOP                                                           05900000
&MSGK    SETC   'ALL'                                                   05950000
.MSG4    ANOP                                                      @03C 06000000
.*                                                                      06050000
.********************************************************************   06100000
.*                                                                      06350000
.*                   PROMPT  PARAMETER                                  06360000
.*                                                                      06370000
.********************************************************************   06380000
.*                                                                      06390000
         AIF   ('&PROMPT' EQ '').PMT1                                   06400000
&PMTK    SETC  'PROMPT,'               ADD A COMMA TO ALLOW THIS TO BE X06450000
                                       INSERTED IN A LINE OF KWDS       06500000
.PMT1    ANOP                                                           06550000
.*                                                                      06550100
.********************************************************************   06550200
.*                                                                      06550300
.*               DUMP DATA SET PROMPT PARAMETER                         06550400
.*                                                                      06550500
.* Note:  If DDSPROMPT is not specified, then DDSPROMPT=NO is used.     06550600
.*        If DDSPROMPT is specified, however, the user indicated        06550700
.*        a value other than YES or NO, then DDSPROMPT=YES is used.     06550800
.*        This is done since at SADMP run time, SADMP would be          06550900
.*        forced to try and use a default dump dataset name of          06551000
.*        SYS1.SADMP.                                              @06A 06551100
.********************************************************************   06551200
.*                                                                      06551300
         AIF   ('&DDSPROMPT' EQ 'YES').DDSPYES  Does user want dump    X06551400
                                       dataset prompting?              X06551500
                                       Yes. Set up to use it.      @06A 06551600
         AIF   ('&DDSPROMPT' NE 'NO').DDSPERR  No. Did user specify    X06551700
                                       invalid dump dataset prompt     X06551800
                                       parameter?                      X06551900
                                       Yes. Issue mnote            @06A 06552000
.DDSPNO  ANOP                          No. User does not want dump     X06552100
                                       dataset prompting           @06A 06552200
&DDSPMTK SETC  'NO'                    Indicate not to prompt for a    X06552300
                                       dump dataset name           @06A 06552400
               AGO .DDSPEND            End DDSPROMPT processing    @06A 06552500
.DDSPERR ANOP                          Mnote for DDSPROMPT         @06A 06552600
         MNOTE 0,'AMDSADMP: DDSPROMPT=&DDSPROMPT IS NOT ALLOWED. IT MUSX06552700
               T BE YES OR NO. DDSPROMPT=YES HAS BEEN USED.'       @06A 06552800
.DDSPYES ANOP                          User wants dataset prompting@06A 06552900
&DDSPMTK SETC  'YES'                   Indicate to prompt for dump a   X06553000
                                       dump dataset name.          @06A 06553100
.DDSPEND ANOP                          Exit dump dataset prompting @06A 06553200
.*                                                                      06553300
.********************************************************************   06555400
.*                                                                      06558100
.*                   COMPACT PARAMETER                             @01A 06560800
.*                                                                      06563500
.********************************************************************   06566200
.*                                                                      06568900
         AIF   ('&COMPACT' EQ 'YES').COMP020                       @01A 06571600
         AIF   ('&COMPACT' NE 'NO').COMP010                        @01A 06574300
&COMPK   SETC  'NO'               COMPACTION NOT ALLOWED           @06C 06577000
         AGO   .COMP030                                            @01A 06579700
.COMP010 ANOP                                                      @01A 06582400
         MNOTE 0,'AMDSADMP: COMPACT=&COMPACT IS NOT ALLOWED. IT MUST BEX06585100
                YES OR NO.       COMPACT=YES HAS BEEN USED.'       @01A 06587800
.COMP020 ANOP                                                      @01A 06590500
&COMPK   SETC   'YES'             (DEFAULT) COMPACTION ALLOWED     @06C 06593200
.COMP030 ANOP                                                      @01A 06595900
.*                                                                      06600000
.********************************************************************   06650000
.*                                                                      06700000
.COMMON  ANOP                     OPTIONS COMMON TO BOTH HI AND LO      06750000
.*                                                                      06800000
.********************************************************************   06850000
.*                                                                      07150000
.* CONSOLE= PARAMETER.                                                  07158300
.* NOTE: AMDSADM2 MUST BE UPDATED TO INCLUDE ANY NEW CONSOLE TYPES.     07166600
.*                                                                      07174900
.********************************************************************   07183200
.*                                                                      07191500
&CONLIST SETC  '('                  OPEN LIST OF SUBLISTS               07200000
&DLM     SETC  ''                   DELIMITER BETWEEN SUBLIST ENTRIES  X07250000
                                    OF CONLIST BECOMES COMMA AFTER     X07300000
                                    FIRST ENTRY.                        07350000
&INDEX   SETA  1                                                        07400000
         AIF   (N'&CONSOLE LT &INDEX).NOCON  IS CONSOLE TYPE AND       X07450000
                                             ADDRESS SPECIFIED @ZA93271 07500000
.CONLOOP AIF   (N'&CONSOLE LT &INDEX).CLEXIT                            07550000
         AIF   ('&CONSOLE'(1,2) EQ '((').CLIST   IS THIS A LIST OF     X07600000
                                               SUBLISTS?                07650000
         AIF   (&INDEX GT 1).CLEXIT  FOR NONSUBLISTS ONLY GO THROUGH   X07700000
                                     THE LOOP ONCE.                     07750000
&SL      SETC  '&CONSOLE'                  SCAN WHOLE LIST AS A SUBLIST 07800000
         AGO   .SL0                                                     07850000
.*                                                                      07950000
.CLIST   ANOP                              EXTRACT ONE SUBLIST          08000000
&SL      SETC  '&CONSOLE(&INDEX)'                                       08050000
.*                                                                      08100000
.SL0     AIF   (K'&SL EQ 0).CLINDEX        SKIP NULL SUBLISTS           08150000
&SLB     SETA  1                           BEGIN SUBLIST SUBSTRING      08200000
&SLE     SETA  K'&SL                       END SUBLIST SUBSTRING        08250000
         AIF   ('&SL'(1,1) NE '(').SL1     IS SUBLIST IN PARENTHESIS?   08300000
&SLB     SETA  2                           SKIP OPENNING PAREN          08350000
&SLE     SETA  K'&SL-1                     SKIP CLOSING PAREN           08400000
.SL1     ANOP                                                           08450000
&SLI     SETA  &SLB                        START SCAN AT BEGINNING      08500000
.SLSCAN  AIF   (&SLI GT &SLE).SL2          AT END OF SUBLIST?           08550000
         AIF   ('&SL'(&SLI,1) EQ ',').SL2  AT DELIMITER?                08600000
&SLI     SETA  &SLI+1                                                   08650000
         AGO   .SLSCAN                                                  08700000
.SL2     ANOP                              END OF CONAD FOUND           08750000
&SLL     SETA  &SLI-&SLB                                                08800000
&CONAD   SETC  '&SL'(&SLB,&SLL)            EXTRACT CON ADDR             08850000
.*                                                                      08900000
&CONTP   SETC  ''                          INIT IN CASE THERE IS NONE   08950000
         AIF   (&SLI GT &SLE).SL5          AT END OF SUBLIST?           09000000
&SLB     SETA  &SLI+1                      POINT AFTER DELIMITER        09050000
&SLL     SETA  &SLE-&SLI                   CALCULATE LENGTH             09100000
&CONTP   SETC  '&SL'(&SLB,&SLL)            EXTRACT CON TYPE             09150000
.SL5     ANOP                                                           09200000
.*                                                                      09250000
         AIF (K'&CONAD EQ 0).CABAD     ERROR IF NO CONSOLE ADDRESS     X09259000
                                       IS PROVIDED                 @L5A 09268000
         AIF ('&CONAD' NE 'SYSC').CACHECK  If the sytem console was    X09268300
                                       not specified, do normal        X09268600
                                       validation on the specified     X09268900
                                       device                      @L8A 09269200
         AIF   (K'&CONTP EQ 0).SYSCTOK If no device type was           X09269500
                                       specified, the SYSC type is     X09269800
                                       acceptable                  @L8A 09270100
         MNOTE 0,'AMDSADMP: CONSOLE TYPE &CONTP IS INVALID.  NO VALUE MX09270400
               AY BE SPECIFIED FOR SYSC.  IT WILL BE IGNORED.'     @L8A 09270700
.SYSCTOK ANOP  ,                                                   @L8A 09271000
         AIF   (&INDEX NE 1).SYSCFCN   If the system console is not    X09271300
                                       the first console in the list,  X09271600
                                       it is unacceptable          @L8A 09271900
&CONLIST SETC  '((FFFF,SYSC)'                                      @L8A 09272200
&DLM     SETC  ','                   CAUSE DELIMITER TO BE PUT BEFORE  X09272500
                                     ANY ADDITIONAL SUBLIST ENTRIES.   X09272800
                                                                   @L8A 09273100
         AIF   (N'&CONSOLE GT 1).CLINDEX If another console has been   X09273400
                                       specified, go process it    @L8A 09273700
         MNOTE 0,'AMDSADMP: ONLY SYSTEM CONSOLE DEFINED. DEFAULT (001F,X09274000
               3278) WILL BE USED ALSO BE USED.'                   @L8A 09274300
         AGO   .NOCON2                 Generate a default console  @L8A 09274600
.SYSCFCN ANOP  ,                                                   @L8A 09274900
         MNOTE 0,'AMDSADMP: CONSOLE ADDRESS SYSC MAY ONLY BE SPECIFIED X09275200
               FOR THE FIRST CONSOLE.  IT WILL BE IGNORED.'        @L8A 09275500
         AGO   .CLINDEX                Continue with the next one  @L8A 09275800
.CACHECK ANOP  ,                                                   @L8A 09276100
         AIF ('&CONAD'(1,1) NE '/').SKPSLH1    CHECK FOR '/'       @L5A 09277000
         AIF (K'&CONAD LT 4 OR K'&CONAD GT 5).CABAD                    X09286000
                                       VALIDITY CHECK LENGTH       @L5A 09295000
&I       SETA  2                                                   @L5A 09304000
         AGO     .ADDRCHK                                               09313000
.SKPSLH1 ANOP                                                           09322000
         AIF  (K'&CONAD LT 3 OR K'&CONAD GT 4).CABAD                   X09331000
                                       VALIDITY CHECK LENGTH       @L5A 09340000
&I       SETA  1                                                   @L5A 09350000
.ADDRCHK AIF (K'&CONAD LT &I).CAOK  ALL DIGITS CHECKED?            @L5A 09400000
         AIF (NOT(('&CONAD'(&I,1) GE 'A' AND '&CONAD'(&I,1) LE 'F') OR X09450000
               ('&CONAD'(&I,1) GE '0' AND                              X09500000
                '&CONAD'(&I,1) LE '9'))).CABAD                     @L5C 09550000
&I       SETA  &I+1                                                @L5A 09600000
         AGO   .ADDRCHK             LOOP                           @L5A 09650000
.CABAD   MNOTE 0,'AMDSADMP: CONSOLE ADDRESS &CONAD IS INVALID. IT MUST X09750000
               BE A DEVICE      NUMBER. 001F IS SUBSTITUTED.'      @L5C 09800000
&CONAD   SETC  '001F'                                              @L5C 09850000
.CAOK    ANOP                       CONSOLE ADDR OK                     09900000
         AIF   (K'&CONTP NE 4).TPBAD                                    09950000
         AIF (NOT('&CONTP'(1,1) GE '0' AND '&CONTP'(1,1) LE '9')).TPBAD 10000000
         AIF (NOT('&CONTP'(2,1) GE '0' AND '&CONTP'(2,1) LE '9')).TPBAD 10050000
         AIF (NOT('&CONTP'(3,1) GE '0' AND '&CONTP'(3,1) LE '9')).TPBAD 10100000
         AIF (NOT('&CONTP'(4,1) GE '0' AND '&CONTP'(3,1) LE '9')).TPBAD 10150000
         AGO   .TPOK                PASSED THE TEST                     10200000
.TPBAD   MNOTE 0,'AMDSADMP: CONSOLE TYPE &CONTP IS INVALID. IT MUST BE X10250000
               A 4              DIGIT NUMBER. 3278 HAS BEEN USED.' @L3C 10300000
&CONTP   SETC  '3278'                                                   10350000
.TPOK    ANOP                       CONSOLE TYPE OK                     10400000
.*                                                                      10450000
&CONLIST SETC  '&CONLIST'.'&DLM'.'('.'&CONAD'.','.'&CONTP'.')'          10500000
&DLM     SETC  ','                   CAUSE DELIMITER TO BE PUT BEFORE  X10550000
                                     ANY ADDITIONAL SUBLIST ENTRIES.    10600000
.CLINDEX ANOP                                                           10650000
&INDEX   SETA  &INDEX+1                                                 10700000
         AGO   .CONLOOP                                                 10750000
.NOCON   MNOTE 0,'AMDSADMP: CONSOLE PARM NOT DETECTED. DEFAULT (001F,32X10800000
               78) WILL BE USED.'                                  @L5C 10850000
.NOCON2  ANOP  ,                                                   @L8A 10875000
&CONAD   SETC  '001F'             SET DEFAULT CONSOLE ADDRESS      @L5C 10900000
&CONTP   SETC  '3278'             SET DEFAULT CONSOLE TYPE     @ZA93271 10950000
&CONLIST SETC  '&CONLIST'.'&DLM'.'('.'&CONAD'.','.'&CONTP'.')' @ZA93271 11000000
.CLEXIT  ANOP                                                           11050000
&CONLIST SETC  '&CONLIST'.')'        CLOSE LIST OF SUBLISTS             11100000
.*                                                                      11150000
.********************************************************************   11200000
.*                                                                      11450000
.*  ISSUE WARNING MNOTE FOR OBSOLETE LOADPT= KEYWORD.             @L3A  11460000
.*                                                                      11470000
.********************************************************************   11480000
.*                                                                      11490000
         AIF   ('&LOADPT' EQ '').IPLPARM                           @L3A 11500000
         MNOTE 0,'AMDSADMP: LOADPT IS AN OBSOLETE KEYWORD. IT IS IGNOREX11550000
               D.         SADMP GENERATION CONTINUES.'             @L3A 11600000
.*                                                                      11650000
.********************************************************************   11700000
.*                                                                      12150000
.*  IPL= PARAMETER.  IF IPL= IS NOT SPECIFIED DSYSDA WILL DEFAULT ON    12155500
.*  THE PROTOTYPE STATEMENT.  TWO DEVICE TYPE PREFIXES D (DISK) AND T   12161000
.*  (TAPE) ARE ALLOWED, AND MAY BE FOLLOWED BY A UNIT NAME.  THIS IS    12166500
.*  EXPECTED TO BE IN THE FORM OF A VALID JCL UNIT= VALUE, AND IF       12172000
.*  OMITTED WILL DEFAULT TO SYSDA FOR PREFIX D AND 3400 FOR T.          12177500
.*                                                                      12183000
.********************************************************************   12188500
.*                                                                      12194000
.IPLPARM ANOP                                                      @L3A 12200000
&SLASH   SETC  ''                      INITIALIZE TO NO SLASH      @D2A 12225000
&UNITLEN SETA  K'&IPL-1                ASSUME A PREFIX CHAR             12250000
&UNITBEG SETA  2                                                        12300000
         AIF   (K'&IPL EQ 0).IPL01     NO CHARACTERS               @P5A 12325000
&IPLVAR  SETC  '&IPL'(1,1)             AMDSABLD EXEC PARM               12350000
         AIF   ('&IPLVAR' NE 'D').IPL06  VALID PREFIX CHAR?             12375000
         AIF   (&UNITLEN EQ 0).IPL08      NO OTHER CHARACTERS?     @P5A 12387500
         AIF   ('&IPL'(2,1) NE '/').IPL08 SLASH?                   @L5A 12400000
&UNITLEN SETA  &UNITLEN-1                                          @L5A 12425000
&UNITBEG SETA  3                                                   @L5A 12450000
&SLASH   SETC  '/'                     PREFIX IPLUNIT WITH SLASH   @D2A 12462500
.IPL08   ANOP                                                      @L5A 12475000
         AIF   (&UNITLEN GT 0).IPL05   WAS UNIT SPECIFIED?              12500000
         MNOTE 0,'AMDSADMP: IPLUNIT WAS NOT SPECIFIED. UNIT WILL BE DEFX12550000
               AULTED     TO SYSDA.'                               @L3C 12600000
&IPLUNIT SETC  'SYSDA'                 NO, USE DEFAULT                  12650000
         AGO   .IPLEND                                                  12700000
.IPL06   AIF   ('&IPLVAR' NE 'T').IPL01                                 12750000
         AIF   (&UNITLEN EQ 0).IPL09      NO OTHER CHARACTERS?     @P5A 12755000
         AIF   ('&IPL'(2,1) NE '/').IPL09 SLASH?                   @L5A 12760000
&UNITLEN SETA  &UNITLEN-1                                          @L5A 12770000
&UNITBEG SETA  3                                                   @L5A 12780000
&SLASH   SETC  '/'                     PREFIX IPLUNIT WITH SLASH   @D2A 12785000
.IPL09   ANOP                                                      @L5A 12790000
         AIF   (&UNITLEN GT 0).IPL05   WAS UNIT SPECIFIED?              12800000
         MNOTE 0,'AMDSADMP: IPLUNIT WAS NOT SPECIFIED. UNIT WILL BE DEFX12850000
               AULTED     TO 3400.'                                @L3A 12900000
&IPLUNIT SETC  '3400'                  NO, USE DEFAULT                  12950000
         AGO   .IPLEND                                                  13000000
.IPL01   ANOP                                                           13050000
         MNOTE 4,'AMDSADMP: IPL=&IPL IS INVALID. FIRST CHARACTER MUST BX13100000
               E          D OR T, AND HAS BEEN REPLACED WITH A D.' @L3C 13150000
&IPLVAR  SETC  'D'                                             @ZA76321 13200000
&UNITLEN SETA  K'&IPL                                              @L5A 13216600
&UNITBEG SETA  1                                                   @L5A 13233200
         AIF   (&UNITLEN LT 1).IPL08   WAS UNIT SPECIFIED?     @ZA76321 13250000
         AIF   ('&IPL'(1,1) NE '/').IPL05    SLASH?                @P5A 13264200
&UNITLEN SETA  &UNITLEN-1                                          @P5A 13278400
&UNITBEG SETA  2                                                   @P5A 13292600
&SLASH   SETC  '/'                     PREFIX IPLUNIT WITH SLASH   @D2A 13299700
         AIF   (&UNITLEN LT 1).IPL08   WAS UNIT SPECIFIED?         @P5A 13306800
.IPL05   ANOP                          UNIT SPECIFIED                   13321000
         AIF   (&UNITLEN LE 8).IPL02   CHECK FOR EXCESSIVE LGTH    @D2C 13335500
&IPLUNIT SETC  '&IPL'(&UNITBEG,&UNITLEN) RESIDENC VOL UNIT VALU@ZA76321 13350000
         MNOTE 4,'AMDSADMP: IPLUNIT=&IPLUNIT IS TOO LONG.              X13400000
                          THE UNIT NAME WILL BE TRUNCATED.'        @L3C 13450000
&UNITLEN SETA  8                       TRUNCATE                    @D2C 13500000
.IPL02   ANOP                                                           14200000
&IPLUNIT SETC  '&IPL'(&UNITBEG,&UNITLEN) RESIDENCE VOLUME UNIT VALUE    14250000
         AIF   (&UNITLEN GT 2).IPL10   NO PADDING IF THREE OR FOUR      14257300
.*                                     DIGITS HAVE BEEN SPECIFIED  @D2C 14264600
&IPLUNIT SETC  '0'.'&IPLUNIT'          PAD A ZERO TO DEVICE NO.    @P5A 14272000
         AIF   (&UNITLEN EQ 2).IPL10   TWO DIGITS SPECIFIED        @P5A 14277500
&IPLUNIT SETC  '0'.'&IPLUNIT'          PAD A ZERO TO DEVICE NO.    @P5A 14283000
.IPL10   ANOP                                                      @P5A 14288500
&IPLUNIT SETC  '&SLASH'.'&IPLUNIT'     PAD WITH A SLASH IF ONE WAS      14292300
.*                                     PASSED IN                   @D2C 14296100
.IPLEND  ANOP                                                           14300000
.*                                                                      14350000
.********************************************************************   14400000
.*                                                                      14650000
.* ULABEL=  CANNOT BE NOPURGE IF TAPE IPL                               14660000
.*                                                                      14670000
.********************************************************************   14680000
.*                                                                      14690000
&ULABEL2 SETC  '&ULABEL'           ASSUME DEFAULT NOT NEEDED   @PCC1460 14700000
         AIF   ('&ULABEL' NE '').UL01 IS DEFAULT NEEDED?       @PCC1460 14750000
&ULABEL2 SETC  'NOPURGE'             ASSUME IPLVAR = D         @PCC1460 14800000
         AIF   ('&IPLVAR' EQ 'D').UL01 IS IPLVAR D?            @PCC1460 14850000
&ULABEL2 SETC  'PURGE'             CHANGE IF IPLVAR = T        @PCC1460 14900000
.UL01    ANOP                                                  @PCC1460 14950000
        AIF ('&IPLVAR' NE 'T' OR '&ULABEL' NE 'NOPURGE').UL02  @PCC1460 15000000
         MNOTE 8,'AMDSADMP: ULABEL=NOPURGE IS NOT POSSIBLE FOR A TAPE  X15050000
                          RESIDENCE VOLUME.'                       @L3C 15100000
.UL02    ANOP                                                  @PCC1460 15150000
.*                                                                      15200000
.********************************************************************   15250000
.*                                                                      15600000
.* REUSEDS = ALLOWABLE VALUES ARE NEVER, CHOICE, ALWAYS            @L4A 15600600
.*                                                                      15601200
.********************************************************************   15601800
.*                                                                      15602400
&REUSDS1 SETC  '&REUSEDS'          ASSUME VALUE IS ALRIGHT         @L4A 15603000
         AIF   ('&REUSEDS' NE '').RDS1 WAS REUSEDS SPECIFIED?      @L4A 15603600
&REUSDS1 SETC  'CHOICE'            USE DEFAULT                     @P3C 15604200
.RDS1    ANOP                                                      @L4A 15604800
         AIF   ('&REUSEDS' NE 'NEVER' AND '&REUSEDS' NE 'ALWAYS'       X15605400
               AND '&REUSEDS' NE 'CHOICE').BADRDS                  @L4A 15606000
         AGO   .OUTPUT1                                            @L4A 15606600
.BADRDS  ANOP                                                      @L4A 15607200
         MNOTE 0,'AMDSADMP: REUSEDS=&REUSEDS IS NOT ALLOWED. VALID SPECX15607800
               IFICATIONS ARE NEVER, CHOICE, OR ALWAYS.                X15608200
               REUSEDS=CHOICE HAS BEEN USED.'                      @P4C 15608600
&REUSDS1 SETC  'CHOICE'            USE DEFAULT                     @P3C 15609000
.OUTPUT1 ANOP                                                      @L4A 15609600
.*                                                                      15610200
.********************************************************************   15610800
.*                                                                      15611400
.* OUTPUT= {Tunit|Dunit} or OUTPUT=(Dunit,dataset name)                 15628400
.*                                                                 @06A 15645400
.********************************************************************   15662500
.*                                                                      15675000
&OUTDDS  SETC ''                      Initialize Dataset name      @06A 15685300
&OUTDEV  SETC '&OUTPUT'               Assume only output device    @06A 15695600
         AIF   (N'&OUTPUT EQ 0).OUTDFLT Is OUTPUT= specified?          X15705900
                                      No. Set up default               X15716200
                                      Yes.  Check which OUTPUT= form   X15726500
                                      was used.                    @06A 15736800
         AIF  ('&OUTPUT'(1,1) NE '(').CHKDEV  Is dataset name syntax   X15747100
                                      being used?                      X15757400
                                      No.  Check for device number     X15767700
                                           only syntax                 X15778000
                                      Yes. Check for legal dataset     X15788300
                                           name syntax             @06A 15798600
         AIF  (N'&OUTPUT NE 2).OUTBAD Did the user correctly provide   X15808900
                                      both a device and dataset name   X15819200
                                      on the OUTPUT= parameter?        X15829500
                                      No.  Syntax is invalid, issue    X15839800
                                           MNOTE                       X15850100
                                      Yes. Continue checking both the  X15860400
                                           device and dataset name @06A 15870700
&OUTDEV  SETC '&OUTPUT(1)'            Set the output device        @06A 15881000
&OUTDDS  SETC '&OUTPUT(2)'            Set the dataset name         @06A 15891300
.********************************************************************** 15901600
.* Process the output device                                       @06A 15911900
.********************************************************************** 15922200
.CHKDEV  ANOP                                                           15932500
         AIF  ('&OUTDEV'(1,1) NE 'T' AND '&OUTDEV'(1,1) NE 'D').OUTBAD X15942800
                                                                   @06C 15953100
         AIF  (K'&OUTDEV-1 EQ 0).OUTBAD NO ADDRESS, ERROR          @06C 15963400
         AIF  ('&OUTDEV'(2,1) NE '/').SKPSLH2  CHECK FOR '/'       @06C 15973700
         AIF  (K'&OUTDEV LT 5 OR K'&OUTDEV GT 6).OUTBAD                X15984000
                                       VALIDITY CHECK LENGTH       @06C 15994300
&I      SETA  3                        SET START ADDRESS           @L5A 16007100
         AGO    .OUTCHK                                            @L5A 16025200
.SKPSLH2 ANOP                                                      @L5A 16043300
         AIF  (K'&OUTDEV LT 4 OR K'&OUTDEV GT 5).OUTBAD                X16061400
                                       VALIDITY CHECK LENGTH       @06C 16079500
&I      SETA  2                        SET START ADDRESS           @L5A 16097600
.OUTCHK AIF  (K'&OUTDEV LT &I).SETOUT2                             @06C 16142400
        AIF (NOT(('&OUTDEV'(&I,1) GE 'A' AND                           X16187200
                  '&OUTDEV'(&I,1) LE 'F') OR                           X16232000
                 ('&OUTDEV'(&I,1) GE '0' AND                           X16276800
                  '&OUTDEV'(&I,1) LE '9'))).OUTBAD                 @06C 16321600
&I      SETA  &I+1                                                 @L5A 16366600
        AGO   .OUTCHK                                              @L5A 16416600
.*                                                                      16550000
.SETOUT2 ANOP                          Output device is set        @06C 16554300
.********************************************************************** 16558600
.* Process the output dump dataset name                            @06A 16562900
.********************************************************************** 16567200
         AIF ('&OUTDDS' EQ '').NODDSN  Was a dataset name specified?   X16571500
                                        No.  Exit dataset processing   X16575800
                                        Yes. Continue checks       @06A 16580100
         AIF  ('&OUTDEV'(1,1) NE 'D').OUTBAD  Does the output device   X16584400
                                      indicate DASD?                   X16588700
                                      No.  Issue error messages        X16593000
                                      Yes. Check dataset name      @06A 16597300
         AIF (K'&OUTDDS GT 44).DDSERR1  Yes.  Is the name greater than X16601600
                                44 Characters?                         X16605900
                                Yes. Issue MNOTE                       X16610200
                                No.  Check to insure dataset           X16614500
                                     name contains 'SADMP' somewhere   X16618800
                                     in the name                   @06A 16623100
&INDEX   SETA 1                 Index to loop through dataset name @06A 16627400
&LEN     SETA 5                 Length of text 'SADMP'             @06A 16631700
.DDSLOOP ANOP                   Loop label                         @06A 16636000
         AIF (&INDEX+&LEN GT K'&OUTDDS+1).DDSERR2  Have we searched    X16640300
                                the entire dataset name without findingX16644600
                                the text 'SADMP'?                      X16648900
                                Yes.  Issue MNOTE                  @06A 16653200
         AIF ('&OUTDDS'(&INDEX,&LEN) EQ 'SADMP').DDSEXIT  No.  Does    X16657500
                                the current 5 characters in the datasetX16661800
                                name contain the text 'SADMP'          X16666100
                                Yes. A valid dataset name has been     X16670400
                                     found                             X16674700
                                No.  Continue dataset name search  @06A 16679000
&INDEX   SETA &INDEX+1          Increment index                    @06A 16683300
         AGO .DDSLOOP           Check next 5 characters            @06A 16687600
.********************************************************************** 16691900
.* Invalid dataset name.  The dataset name is greater than 44           16696200
.* charcters.                                                      @06A 16700500
.********************************************************************** 16704800
.DDSERR1 ANOP                   Error Label                        @06A 16709100
         MNOTE 4,'AMDSADMP: OUTPUT DUMP DATA SET NAME IS INCORRECT. THEX16713400
                DATASET     NAME IS GREATER THAN 44 CHARACTERS.'   @06A 16717700
         AGO .NODDSN            Exit dataset name processing       @06A 16722000
.********************************************************************** 16726300
.* Invalid dataset name.  The dataset name does not contain the         16730600
.* text 'SADMP'.                                                   @06A 16734900
.********************************************************************** 16739200
.DDSERR2 ANOP                   Error Label                        @06A 16743500
         MNOTE 4,'AMDSADMP: OUTPUT DUMP DATA SET NAME IS INCORRECT. IT X16747800
               MUST         CONTAIN THE TEXT ''SADMP''.'           @06A 16752100
         AGO .NODDSN            Exit dataset name processing       @06A 16756400
.********************************************************************** 16760700
.* Invalid OUTPUT= parameter.  The OUTPUT= parameter was not in the     16765000
.* form OUTPUT={T|D}unit OR (Dunit,Dataset name)                   @06A 16769300
.********************************************************************** 16773600
.OUTBAD  ANOP                   Output parameter is incorrect      @06M 16777900
         MNOTE 4,'AMDSADMP: OUTPUT=&OUTPUT IS INCORRECT. IT MUST BE EITX16782200
               HER {T|D}UNIT OR (DUNIT,DATASET NAME).'             @06C 16786500
         AIF   (&OSG).SYSUT01   Bypass default message for one step    X16790800
                                generation since assembly will fail@06M 16795100
.OUTDFLT MNOTE 0,'AMDSADMP: DEFAULT OUTPUT DEVICE T0282 WILL BE USED.' X16800000
                                                                   @06M 16833300
.SYSUT01 ANOP                          Still set up default to avoid   X16866600
                                       extra assembler messages    @06M 16872400
&OUTDEV  SETC  'T0282'                 SET TAPE DEFAULT ADDRESS    @06M 16878200
.********************************************************************** 16884000
.* Dataset name is not to be used.  Reinitialize the dataset name       16889800
.* to blanks and exit.                                             @06A 16895600
.********************************************************************** 16901400
.NODDSN  ANOP                   Dataset name will not be used      @06A 16907200
&OUTDDS  SETC ''                Reinitialize dataset name to blank @06A 16913000
.********************************************************************** 16918800
.* Set up the AMDSADM2 OUTPUT= specification.                      @06A 16924600
.********************************************************************** 16930400
.DDSEXIT ANOP                                                           16936200
&OUTPUT2 SETC '&OUTDEV'         Assume that only a device is specified X16942000
                                                                   @06A 16947800
         AIF   ('&OUTDDS' EQ '').OUTEXIT  Is a dataset name also being X16953600
                                used?                                  X16959400
                                No.  Continue with only a device       X16965200
                                Yes. Construct the output parameter    X16971000
                                     with both device and dataset      X16976800
                                     name                          @06A 16982600
&OUTPUT2 SETC '('.'&OUTDEV'.','.'&OUTDDS'.')'                      @06A 16988400
.OUTEXIT ANOP                   Continue                           @06A 16994200
.*                                                                      17000000
.********************************************************************   17050000
.*                                                                      17300000
.*                      MINASID= PARAMETER                              17310000
.*                                                                @L3M  17320000
.********************************************************************   17330000
.*                                                                      17340000
         AIF   ('&MINASID' EQ 'ALL').MIN2                          @L3M 17350000
         AIF   ('&MINASID' EQ 'PHYSIN').MIN3                       @L3M 17400000
.MIN1    ANOP                                                      @L3M 17450000
         MNOTE 0,'AMDSADMP: MINASID=ALL OR MINASID=PHYSIN NOT SPECIFIEDX17500000
               ,          THE DEFAULT MINASID=ALL WILL BE USED.'   @L3C 17550000
.MIN2    ANOP                                                      @L3M 17600000
&MINTYPE SETC  'ALL'                                               @L3M 17650000
         AGO   .MIN5                                               @L3M 17700000
.MIN3    ANOP                                                      @L3M 17750000
&MINTYPE SETC  'PHYSIN'                                            @L3M 17800000
         MNOTE 0,'AMDSADMP: WARNING MINASID=&MINASID WAS SPECIFIED. REFX17850000
               ER TO        MESSAGE AMD082I.'                      @L3C 17900000
.MIN5    ANOP                                                      @L3M 17950000
.*                                                                      18000000
.********************************************************************   18050000
.*                                                                      18300000
.*  THE LABEL NAME OF THE MACRO IS USED FOR THE JOBNAME                 18310000
.*                                                                      18320000
.********************************************************************   18330000
.*                                                                      18340000
         AIF   ('&SADMP' EQ '').LBL2  IS LABEL BLANKS?                  18350000
&JOBNAME SETC  '&SADMP'                SET JOBNAME TO SADMP LABEL       18400000
         AGO   .LBL1                                                    18450000
.LBL2    ANOP                          SET DEFAULT JOBNAME              18500000
&JOBNAME SETC  'AMDSADMP'              DEFAULT JOBNAME                  18550000
.LBL1    ANOP                                                           18600000
.*                                                                      18650000
.********************************************************************   18700000
.* IF ONE STEP GENERATION, IGNORE THE MIGRATION LIBRARY SUPPORT   @D2A  18750000
.********************************************************************   18800000
.*                                                                      19100000
         AIF   (&OSG).OSG01                                       @D2M  19100100
.*                                                                      19100200
.********************************************************************   19100300
.*                                                                      19100400
.* ALIB= PARAMETER                                                      19100500
.*                                                                      19100600
.* SPECIFIES A GLOBAL VOLSER AND UNIT TYPE FOR THE SYS1.NUCLEUS,        19100700
.* SYS1.MODGEN, AND SYS1.LINKLIB SYSTEM DATA SETS WHICH ARE PUNCHED     19100800
.* OUT AS PART OF THE STAGE-TWO JCL IN THE TWO-STAGE GENERATION         19100900
.* PROCESS.                                                             19101000
.*                                                                @D2A  19101100
.********************************************************************   19101200
.*                                                                      19101300
&AVOL    SETC  ''                   INITIALIZE GLOBAL VOLSER      @D2A  19101400
&AUNIT   SETC  ''                   INITIALIZE GLOBAL UNIT TYPE   @D2A  19101500
         AIF   (K'&ALIB EQ 0).NOALIB   WAS ALIB SPECIFIED         @D2A  19101600
         AIF   (N'&ALIB NE 2).ERRALIB  ARE 2 PARMS SPECIFIED      @D2A  19101700
&AVOL    SETC  ',VOL=SER='.'&ALIB(1)'  USE VOLSER PROVIDED        @D2A  19101800
&AUNIT   SETC  ',UNIT='.'&ALIB(2)'     USE UNIT PROVIDED          @D2A  19102000
         AGO .NOALIB                NO ERROR, CONTINUE            @D2A  19102200
.ERRALIB ANOP                                                     @D2A  19102400
         MNOTE 8,'AMDSADMP: ALIB=&ALIB IS NOT VALID.  THE REQUIRED SYNTX19102600
               AX IS ALIB=(VOLSER,UNIT).'                         @D2A  19102800
&AVOL    SETC  ''                   RESET VOLSER TO NULL          @D2A  19103100
&AUNIT   SETC  ''                   RESET UNIT TYPE TO NULL       @D2A  19103400
.NOALIB  ANOP                       CONTINUE                      @D2A  19103700
.*                                                                      19104300
.********************************************************************   19104400
.*                                                                      19104500
.* NUCLIB= PARAMETER.                                                   19104600
.*                                                                      19104700
.* SPECIFIES A VOLSER AND UNIT TYPE FOR THE SYS1.NUCLEUS SYSTEM         19104800
.* DATA SET WHICH IS PUNCHED OUT AS PART OF THE STAGE-TWO JCL IN        19104900
.* THE TWO-STAGE GENERATION PROCESS.                                    19105000
.*                                                                @D2A  19105100
.********************************************************************   19105200
.*                                                                      19105300
&NUCVOL  SETC  '&AVOL'              SET SYS1.NUCLEUS VOLSER       @D2A  19105400
&NUCUNIT SETC  '&AUNIT'             SET SYS1.NUCLEUS UNIT TYPE    @D2A  19105500
         AIF   (K'&NUCLIB EQ 0).NONUC   WAS NUCLIB SPECIFIED      @D2A  19105600
         AIF   (N'&NUCLIB NE 2).ERRNUC  ARE 2 PARMS SPECIFIED     @D2A  19105700
&NUCVOL  SETC  ',VOL=SER='.'&NUCLIB(1)' USE VOLSER PROVIDED       @D2A  19105800
&NUCUNIT SETC  ',UNIT='.'&NUCLIB(2)'    USE UNIT PROVIDED         @D2A  19105900
         AGO .NONUC                 NO ERROR, CONTINUE            @D2A  19106000
.ERRNUC  ANOP                                                     @D2A  19106100
         MNOTE 8,'AMDSADMP: NUCLIB=&NUCLIB IS NOT VALID.  THE REQUIRED X19106200
               SYNTAX IS NUCLIB=(VOLSER,UNIT).'                   @D2A  19106300
&NUCVOL  SETC  ''                   RESET VOLSER TO NULL          @D2A  19106400
&NUCUNIT SETC  ''                   RESET UNIT TYPE TO NULL       @D2A  19106500
.NONUC   ANOP                       CONTINUE                      @D2A  19106600
.*                                                                      19106700
.********************************************************************   19106800
.*                                                                      19106900
.* LNKLIB= PARAMETER.                                                   19107000
.*                                                                      19107100
.* SPECIFIES A VOLSER AND UNIT TYPE FOR THE SYS1.LINKLIB SYSTEM         19107200
.* DATA SET WHICH IS PUNCHED OUT AS PART OF THE STAGE-TWO JCL IN        19107300
.* THE TWO-STAGE GENERATION PROCESS.                                    19107400
.*                                                                @D2A  19107500
.********************************************************************   19107600
.*                                                                      19107700
&LNKVOL  SETC  '&AVOL'              SET SYS1.LINKLIB VOLSER       @D2A  19107800
&LNKUNIT SETC  '&AUNIT'             SET SYS1.LINKLIB UNIT TYPE    @D2A  19107900
         AIF   (K'&LNKLIB EQ 0).NOLNK   WAS LNKLIB SPECIFIED      @D2A  19108000
         AIF   (N'&LNKLIB NE 2).ERRLNK  ARE 2 PARMS SPECIFIED     @D2A  19108100
&LNKVOL  SETC  ',VOL=SER='.'&LNKLIB(1)' USE VOLSER PROVIDED       @D2A  19108200
&LNKUNIT SETC  ',UNIT='.'&LNKLIB(2)'    USE UNIT PROVIDED         @D2A  19108300
         AGO .NOLNK                 NO ERROR, CONTINUE            @D2A  19108400
.ERRLNK  ANOP                                                     @D2A  19108500
         MNOTE 8,'AMDSADMP: LNKLIB=&LNKLIB IS NOT VALID.  THE REQUIRED X19108600
               SYNTAX IS LNKLIB=(VOLSER,UNIT).'                   @D2A  19108700
&LNKVOL  SETC  ''                   RESET VOLSER TO NULL          @D2A  19108800
&LNKUNIT SETC  ''                   RESET UNIT TYPE TO NULL       @D2A  19108900
.NOLNK   ANOP                       CONTINUE                      @D2A  19109000
.*                                                                      19109100
.********************************************************************   19109200
.*                                                                      19109300
.* MODLIB= PARAMETER.                                                   19109400
.*                                                                      19109500
.* SPECIFIES A VOLSER AND UNIT TYPE FOR THE SYS1.MODGEN SYSTEM          19109600
.* DATA SET WHICH IS PUNCHED OUT AS PART OF THE STAGE-TWO JCL IN        19109700
.* THE TWO-STAGE GENERATION PROCESS.                                    19109800
.*                                                                @D2A  19109900
.********************************************************************   19110000
.*                                                                      19110100
&MODVOL  SETC  '&AVOL'              SET SYS1.MODGEN VOLSER        @D2A  19110200
&MODUNIT SETC  '&AUNIT'             SET SYS1.MODGEN UNIT TYPE     @D2A  19110300
         AIF   (K'&MODLIB EQ 0).NOMOD   WAS MODLIB SPECIFIED      @D2A  19110400
         AIF   (N'&MODLIB NE 2).ERRMOD  ARE 2 PARMS SPECIFIED     @D2A  19110500
&MODVOL  SETC  ',VOL=SER='.'&MODLIB(1)' USE VOLSER PROVIDED       @D2A  19110600
&MODUNIT SETC  ',UNIT='.'&MODLIB(2)'    USE UNIT PROVIDED         @D2A  19110700
         AGO .NOMOD                 NO ERROR, CONTINUE            @D2A  19110800
.ERRMOD  ANOP                                                     @D2A  19110900
         MNOTE 8,'AMDSADMP: MODLIB=&MODLIB IS NOT VALID.  THE REQUIRED X19111000
               SYNTAX IS MODLIB=(VOLSER,UNIT).'                   @D2A  19111100
&MODVOL  SETC  ''                   RESET VOLSER TO NULL          @D2A  19111200
&MODUNIT SETC  ''                   RESET UNIT TYPE TO NULL       @D2A  19111300
.NOMOD   ANOP                       CONTINUE                      @D2A  19111400
.*                                                                      19111500
.********************************************************************   19111600
.*                                                                      19111700
.*  JCL TO ASSEMBLE AMDSADM2 WHICH WILL CREATE CSECTS AMDSACCT AND      19114200
.*  AMDSARDM, OR FOR ONE STEP GENERATION, THE ACTUAL EXPANSION OF       19114300
.*  THE AMDSADM2 MACRO TO CREATE THE OBJ AS OUTPUT PLUS CONTROL         19118600
.*  CARDS FOR AMDSABLD AND ICKDSF.                                      19124800
.*                                                                      19131000
.********************************************************************   19137200
.*                                                                      19143400
         SPACE                                                          19200000
         PUNCH '//&JOBNAME JOB MSGLEVEL=(1,1)'                     @L6C 19231800
.*                                                                3@L6D 19263600
         PUNCH '//ASMA EXEC PGM=ASMA90,REGION=1024K,'              @P9C 19295600
         PUNCH '//     PARM=''ASA,DECK,NORENT,NOOBJECT,NOXOBJECT'''    X19318800
                                                                   @07C 19342000
.*                                                                 @L6D 19365200
         PUNCH '//SYSLIB DD DSN=SYS1.MODGEN,DISP=SHR&MODVOL&MODUNIT'   X19400000
                                                                   @D2A 19470000
         PUNCH '//SYSUT1 DD UNIT=&SYSUT,SPACE=(1700,(400,50))'          19500000
         PUNCH '//SYSPRINT DD SYSOUT=A'                                 19550000
         PUNCH '//SYSPUNCH DD DSN=&&OBJ,UNIT=&SYSUT,'                   19600000
         PUNCH '// DCB=BLKSIZE=3360,'                          @YA47897 19625000
         PUNCH '// SPACE=(80,(250,50)),DISP=(,PASS)'                    19650000
         PUNCH '//SYSIN DD *'                                           19655800
.*                                                                      19661600
.********************************************************************** 19667400
.*                                                                      19673200
.* BUILDS THE AMDSADM2 MACRO.                                           19679000
.*                                                                6@L6D 19699300
.********************************************************************** 19719600
.*                                                                      19725400
.*                                                                3@L6D 19737700
&LIST    SETC  'IPL='.'&IPLVAR'.','                                @L3A 19750000
&REP     SETA  53-K'&LIST                                          @L3A 19800000
&LIST    SETC  '&LIST'.(&REP)' '.'X'                               @L3A 19850000
         PUNCH '         AMDSADM2 &LIST'                           @L3A 19900000
.OSG01   ANOP                                                  @PCC1027 19950000
.*                                                                      20000000
.********************************************************************   20050000
.*                                                                      20100000
.* BUILD CONSOLE= KEYWORD WHICH MAY REQUIRE CONTINUATION LINES.         20150000
.*                                                                      20200000
.********************************************************************   20250000
.*                                                                      20300000
         AIF   (&OSG).OSG02                                             20350000
&KEYWORD SETC  'CONSOLE='       KEYWORD FOR AMDSADM2 MACRO              20400000
.OSG02   ANOP                                                           20450000
&BEG     SETA  1                SUBSTRING INDEX INIT VALUE              20500000
.CLOOP   ANOP                   VALUE OF KEYWORD MAY REQUIRE SEVERAL   X20550000
                                CARDS PUNCHED.                          20600000
&LEN     SETA  56-K'&KEYWORD      TAKE MAX SUBSTRING FOR NEXT CARD      20650000
         AIF   (K'&CONLIST-&BEG+1 GE &LEN).C1 COMPARE TO REMAINING      20700000
&LEN     SETA  K'&CONLIST-&BEG+1 REDUCE TO THE REMAINING LENGTH         20750000
.C1      ANOP                                                           20800000
&SUBSTR  SETC  '&CONLIST'(&BEG,&LEN) OBTAIN PORTION FOR THIS CARD       20850000
.*                                                                      20900000
&LIST    SETC  '&KEYWORD'.'&SUBSTR'                                     20950000
&COMMA   SETC  ','              ASSUME COMMA NEEDED TO END KEYWORD      21000000
         AIF   (&OSG).OSG03                                             21050000
&REP     SETA  55-K'&LIST       CALC NUM OF BLANKS NEEDED               21100000
         AIF   (&REP GE 0).C5   55 OR LESS CHAR IN STRING               21150000
&LIST    SETC  '&LIST'.'X'      56,SO ADD CONTINUATION CHARACTER        21200000
         AGO   .C7                                                      21250000
.C5      AIF   (&REP GT 0).C6   54 OR LESS CHAR IN STRING               21300000
&LIST    SETC  '&LIST'.',X'     55 SO, ADD COMMA & CONT CHAR            21350000
&COMMA   SETC  ''               COMMA NO LONGER NEEDED TO END KWD       21400000
         AGO   .C7                                                      21450000
.C6      ANOP                   54 OR LESS                              21500000
&LIST    SETC  '&LIST'.','.(&REP)' '.'X' COMMA BLANKS & CONT CHAR       21550000
&COMMA   SETC  ''               COMMA NO LONGER NEEDED TO END KWD       21600000
.C7      ANOP                                                           21650000
         PUNCH '               &LIST'                                   21700000
         AGO   .OSG04                                                   21750000
.OSG03   ANOP                                                           21800000
&CON2    SETC   '&CON2'.'&LIST'                                         21850000
.OSG04   ANOP                                                           21900000
&BEG     SETA  &BEG+&LEN        MOVE TO THE NEXT PIECE                  21950000
         AIF   (&BEG GT K'&CONLIST).CONDONE IS ALL OF STRING DONE?      22000000
&KEYWORD SETC  ''               INIT FOR NEXT ITERATION                 22050000
         AGO   .CLOOP                                                   22100000
.CONDONE ANOP                                                           22150000
.*                                                                      22200000
.********************************************************************   22250000
.*                                                                      22550000
.*  PUNCH PROMPT, MSG=, COMPACT=, and DDSPROMPT= KEYWORDS          @06C 22558300
.*      --NOTE POSSIBLE PRECEEDING COMMA FROM CONSOLE=                  22566600
.*                                                                      22574900
.********************************************************************   22583200
.*                                                                      22591500
&LIST    SETC  '&COMMA'.'&PMTK'.'MSG='.'&MSGK'.','                      22600000
&LIST    SETC  '&LIST'.'COMPACT='.'&COMPK'.','                     @06C 22616600
&LIST    SETC  '&LIST'.'DDSPROMPT='.'&DDSPMTK'.','                 @06A 22633200
         AIF   (&OSG).OSG05                                             22650000
&REP     SETA  56-K'&LIST                                               22700000
&LIST    SETC  '&LIST'.(&REP)' '.'X'                                    22750000
         PUNCH '               &LIST'                                   22800000
         AGO   .OSG06                                                   22850000
.OSG05   ANOP                                                           22900000
&DM2LN3  SETC   '&LIST'                                                 22950000
.OSG06   ANOP                                                           23000000
.*                                                                      23050000
.********************************************************************   23100000
.*                                                                      23450000
.* BUILD DUMP= KEYWORD WHICH MAY REQUIRE CONTINUATION LINES.            23457100
.* NOTE: THE VALUE OF THIS IS PASSED UNCHECKED AND UNCHANGED TO         23464200
.* AMDSADM2 AND FROM THERE TO AMDSAPMT FOR PARSING.                     23471300
.*                                                                      23478400
.********************************************************************   23485500
.*                                                                      23492600
         AIF   (&OSG).OSG07                                             23500000
         AIF (K'&DUMP EQ 0).NODUMP  CHECK FOR OPTIONAL DUMP= VALUE      23550000
&KEYWORD SETC  'DUMP='          KEYWORD FOR AMDSADM2 MACRO              23600000
&BEG     SETA  1                SUBSTRING INDEX INIT VALUE              23650000
.DLOOP   ANOP                   VALUE OF KEYWORD MAY REQUIRE SEVERAL    23700000
.*                              CARDS PUNCHED.                          23750000
&LEN     SETA  56-K'&KEYWORD      TAKE MAX SUBSTRING FOR NEXT CARD      23800000
         AIF   (K'&DUMP-&BEG+1 GE &LEN).D1 COMPARE WITH REMAINING       23850000
&LEN     SETA  K'&DUMP-&BEG+1   REDUCE TO THE REMAINING LENGTH          23900000
.D1      ANOP                                                           23950000
&SUBSTR  SETC  '&DUMP'(&BEG,&LEN) OBTAIN PORTION FOR THIS CARD          24000000
.*                                                                      24050000
&INDEX   SETA  0                 INIT                                   24100000
&LIST    SETC  '&KEYWORD'        INIT                                   24150000
.SUBLOOP ANOP                    LOOP TO DOUBLE UP THE QUOTES           24200000
         AIF   (&INDEX EQ K'&SUBSTR).D4 HAS END BEEN REACHED            24250000
&INDEX   SETA  &INDEX+1          MOVE TO NEXT CHAR                      24300000
         AIF   ('&SUBSTR'(&INDEX,1) EQ '&Q').D3  IS THIS A QUOTE        24350000
&LIST    SETC  '&LIST'.'&SUBSTR'(&INDEX,1) ADD CHAR AS IS               24400000
         AGO   .SUBLOOP                                                 24450000
.D3      ANOP                                                           24500000
&LIST    SETC  '&LIST'.'&QQ'       REPLACE WITH DOUBLE QUOTE            24550000
         AGO   .SUBLOOP                                                 24600000
.D4      ANOP                                                           24650000
.*                                                                      24700000
&COMMA   SETC  ','              ASSUME NEEDED TO END KEYWORD            24750000
&REP     SETA  55-K'&SUBSTR-K'&KEYWORD CALC NUM OF BLANKS NEEDED        24800000
         AIF   (&REP GE 0).D5   55 OR LESS CHAR IN STRING               24850000
&LIST    SETC  '&LIST'.'X'      56,SO ADD CONTINUATION CHARACTER        24900000
         AGO   .D7                                                      24950000
.D5      AIF   (&REP GT 0).D6   54 OR LESS CHAR IN STRING               25000000
&LIST    SETC  '&LIST'.',X'     55 SO, ADD COMMA & CONT CHAR            25050000
&COMMA   SETC  ''               COMMA NO LONGER NEEDED TO END KWD       25100000
         AGO   .D7                                                      25150000
.D6      ANOP                   54 OR LESS                              25200000
&LIST    SETC  '&LIST'.','.(&REP)' '.'X' COMMA BLANKS & CONT CHAR       25250000
&COMMA   SETC  ''               COMMA NO LONGER NEEDED TO END KWD       25300000
.D7      ANOP                                                           25350000
         PUNCH '               &LIST'                                   25400000
&BEG     SETA  &BEG+&LEN        MOVE TO THE NEXT PIECE                  25450000
         AIF   (&BEG GT K'&DUMP).NODUMP IS ALL OF STRING DONE?          25500000
&KEYWORD SETC  ''               NULL AFTER FIRST CARD                   25550000
         AGO   .DLOOP                                                   25600000
.NODUMP  ANOP                                                           25650000
.OSG07   ANOP                                                           25700000
.*                                                                      25750000
.********************************************************************   25800000
.*                                                                      26050000
.*  PUNCH KEYWORD MINASID AND REUSEDS                              @L4C 26060000
.*                                                                      26070000
.********************************************************************   26080000
.*                                                                      26090000
&LIST    SETC  '&COMMA'.'MINASID='.'&MINTYPE'.','                  @L3C 26100000
&LIST    SETC  '&LIST'.'REUSEDS='.'&REUSDS1'.','                   @L4A 26125000
         AIF   (&OSG).MIN6                                         @L3M 26150000
&REP     SETA  56-K'&LIST                                          @L3M 26200000
&LIST    SETC  '&LIST'.(&REP)' '.'X'                               @L3M 26250000
         PUNCH '               &LIST'                              @L3M 26300000
.MIN6    ANOP                                                      @L3M 26350000
.*                                                                      26400000
.********************************************************************** 26450000
.*  Logic: Punch the OUTPUT= keyword.                                   26500000
.*                                                                      26750000
.*  If the OUTPUT= keyword has a length that exceeds one line in        26754900
.*  length, then the OUTPUT= specification must be split into two       26759800
.*  lines with the first one containing a continuation character   @06A 26764700
.********************************************************************** 26769600
.*                                                                      26774900
&KEYWORD SETC  ''                      Initialize keyword          @06A 26809900
         AIF   (&OSG).OSG08            Is this 1-step generation?      X26844900
                                       Yes. Skip OUTPUT keyword    @06A 26879900
&KEYWORD SETC  'OUTPUT='               No.  Set OUTPUT keyword     @06A 26914900
.OSG08   ANOP                                                      @L3A 26950000
&BEG     SETA  1                                                        26956000
&LEN     SETA  56-K'&KEYWORD           Maximum string length       @06A 26962000
         AIF   (K'&OUTPUT2 LE &LEN).OUT1  Is the length of the OUTPUT= X26968000
                                       parameter too large for one     X26974000
                                       line?                           X26980000
                                       No.  Punch 1 line only          X26986000
                                       Yes. Create first line with a   X26992000
                                            continuation character @06A 26998000
&LIST    SETC  '&KEYWORD'.'&OUTPUT2'(&BEG,&LEN).'X'                @06A 27004000
.*                                     Punch first line            @06A 27010000
         PUNCH '               &LIST'                                   27016000
&BEG     SETA  &LEN+1                                                   27022000
&LEN     SETA  K'&OUTPUT2-&LEN                                          27028000
&LIST    SETC  '&OUTPUT2'(&BEG,&LEN)   Set up second line              X27034000
                                       with remaining output       @06A 27040000
.*                                     Punch second line           @06A 27046000
         PUNCH '               &LIST'                                   27052000
         AGO   .OUT2                   Branch to continue          @06A 27058000
.OUT1    ANOP                          Entire output specification     X27064000
                                       will fit on one line        @06A 27070000
&LIST    SETC '&KEYWORD'.'&OUTPUT2'    Set up output specification @06A 27076000
.*                                     Punch output specification  @06A 27082000
         PUNCH '               &LIST'                                   27088000
.OUT2    ANOP                          Continue                    @06A 27094000
         AIF   (&OSG).OSG13                                             27100000
         PUNCH '         END'                                           27150000
.*                                                               18@L6D 27197500
.*                                                                      27245000
.********************************************************************   27250000
.*                                                                      27300000
.*  JCL FOR THE AMDSABLD STEP                                           27350000
.*                                                                      27400000
.********************************************************************   27450000
.*                                                                      27466600
.BLDSTEP ANOP                          AMDSABLD STEP               @04A 27483200
         SPACE                                                          27500000
         PUNCH '/*'                                                     27525000
         PUNCH '//BUILD  EXEC PGM=AMDSABLD,'                       @04C 27550000
         PUNCH '// COND=((0,LT,ASMA)),'                            @L6C 27575000
         PUNCH '// REGION=1024K,'                                       27600000
         PUNCH '// PARM=''IPL=&IPLVAR'''                           @L3C 27650000
         AIF   ('&LNKVOL' EQ '').OSG14   IF LNKLIB ESTABLISHED     @D2A 27662500
         PUNCH '//STEPLIB DD DSN=SYS1.LINKLIB,DISP=SHR&LNKVOL&LNKUNIT' X27675000
                                                                   @D2A 27687500
         AGO   .OSG14                                                   27700000
.OSG13   ANOP                                                           27750000
         PUNCH 'BLDPARMSIPL=&IPLVAR'                               @L3C 27800000
         PUNCH 'IPLUNIT &IPLUNIT'                                       27850000
         PUNCH 'IPLSER  &VOLSER'                                        27900000
         AGO   .OSG15                                                   27950000
.*                                                                      28000000
.OSG14   ANOP                                                           28050000
         PUNCH '//IPLDEV DD DSN=SYS1.PAGEDUMP.V&VOLSER,'           @L7C 28100000
         PUNCH '//  VOL=(PRIVATE,RETAIN,SER=&VOLSER),'                  28150000
         AIF   ('&IPLVAR' EQ 'T').TLDR                                  28200000
         PUNCH '// DCB=(LRECL=4096,BLKSIZE=4096,RECFM=F,DSORG=PS),'     28250000
         PUNCH '// UNIT=&IPLUNIT,DISP=(,KEEP),'                         28300000
         PUNCH '// SPACE=(4096,(584),,CONTIG),LABEL=EXPDT=99366'   @L6C 28350000
         AGO   .ULBL1                                                   28400000
.TLDR    ANOP                          TAPE IPL                         28450000
         PUNCH '// DCB=(BLKSIZE=12288,RECFM=U,DSORG=PS),'          @H1C 28500000
         PUNCH '// UNIT=&IPLUNIT,DISP=OLD,LABEL=(,NL)'                  28550000
         AGO   .JCLLDR3                                        @PCC1611 28600000
.*                                                                      28650000
.ULBL1   ANOP                                                           28700000
         PUNCH '//TRK0TEXT DD DSN=&&REALDUMP,DISP=(,PASS),'             28750000
         PUNCH '// SPACE=(4096,(2,1)),DCB=RECFM=U,'                     28800000
         AIF   ('&SYSUT' NE 'SYSDA').JCLLDR2 NOT SYSDA?                 28850000
         PUNCH '//* SPECIFIC VOLUME ASSIGNMENT IS USED TO AVOID VIO'    28900000
         PUNCH '// UNIT=&IPLUNIT,VOL=SER=&VOLSER'                       28950000
         AGO   .JCLLDR3                                                 29000000
.JCLLDR2 ANOP                       SYSUT IS NOT SYSDA                  29050000
         PUNCH '// UNIT=&SYSUT'                                         29100000
.JCLLDR3 ANOP                                                           29150000
.*                                                                      29200000
         PUNCH '//SYSPRINT DD SYSOUT=A'                                 29250000
         PUNCH '//SYSPUNCH DD DSN=&&OBJ,DISP=(OLD,DELETE)'              29300000
         AIF   ('&IPLVAR' NE 'D').IPLTAPE  DASD IPL NEEDS AMDSAIPD @L3A 29350000
         PUNCH '//IPLTEXT DD DSN=SYS1.NUCLEUS(AMDSAIPD),'          @D2C 29383300
         PUNCH '//           DISP=SHR&NUCVOL&NUCUNIT'              @D2A 29416600
         AGO   .PUNDPL                                             @L3A 29450000
.IPLTAPE ANOP                       TAPE IPL NEEDS MODULE AMDSAIPT @L3A 29500000
         PUNCH '//IPLTEXT DD DSN=SYS1.NUCLEUS(AMDSAIPT),'          @D2C 29533300
         PUNCH '//           DISP=SHR&NUCVOL&NUCUNIT'              @D2A 29566600
.PUNDPL  ANOP                                                      @L3A 29600000
         PUNCH '//IPITEXT DD DSN=SYS1.NUCLEUS(AMDSAIPI),'          @L6A 29606000
         PUNCH '//           DISP=SHR&NUCVOL&NUCUNIT'              @L6A 29612000
         PUNCH '//DVITEXT DD DSN=SYS1.NUCLEUS(AMDSADVI),'          @L6A 29618000
         PUNCH '//           DISP=SHR&NUCVOL&NUCUNIT'              @L6A 29624000
         PUNCH '//DPLTEXT DD DSN=SYS1.NUCLEUS(AMDSADPL),'          @D2C 29630000
         PUNCH '//           DISP=SHR&NUCVOL&NUCUNIT'              @D2A 29660000
         PUNCH '//PGETEXT DD DSN=SYS1.NUCLEUS(AMDSAPGE),'          @D2C 29690000
         PUNCH '//           DISP=SHR&NUCVOL&NUCUNIT'              @D2A 29720000
.********************************************************************   29750000
.*                                                                      30050000
.*  THIS CODE PRODUCES UTILITY JCL AND CONTROL STATEMENTS TO PLACE      30058300
.*  THE IPL TEXT ON A DASD RESIDENCE VOLUME                             30066600
.*                                                                      30074900
.********************************************************************   30083200
.*                                                                      30091500
         SPACE                                                          30100000
         AIF   ('&IPLVAR' NE 'D').ENDUP1                                30150000
         PUNCH '//PUTIPL EXEC PGM=ICKDSF,REGION=1024K,'                 30200000
         PUNCH '//   COND=((0,LT,ASMA),(0,LT,BUILD))'              @L6C 30250000
         PUNCH '//SYSPRINT DD SYSOUT=A'                                 30300000
         PUNCH '//IPLDEV DD DISP=OLD,UNIT=&IPLUNIT,'                    30350000
         PUNCH '//  VOL=(PRIVATE,RETAIN,SER=&VOLSER)'                   30400000
         PUNCH '//TRK0TEXT DD DSN=&&REALDUMP,DISP=(OLD,DELETE)'         30450000
         PUNCH '//SYSIN DD *'                                           30500000
         PUNCH ' REFORMAT DDNAME(IPLDEV) &ULABEL2 IPL(TRK0TEXT,ABS) NOVX30550000
               ERIFY BOOTSTRAP'                                         30600000
         PUNCH '/*'                                                     30650000
         AGO   .OSG16                                                   30700000
.OSG15   ANOP                                                           30750000
         PUNCH 'DSFPARMS REFORMAT DNAME(IPLDEV) &ULABEL2 IPL(TRK0TEXT,AX30800000
               BS) NOVFY BOOT'                                          30850000
         AMDSADM2 IPL=&IPLVAR,                                         X30900000
               OUTPUT=&OUTPUT2,CONSOLE=&CON2,DUMP=&DUMP,               X30950000
               &PROMPT,MSG=&MSGK,MINASID=&MINTYPE,COMPACT=&COMPK,      X30983300
               REUSEDS=&REUSDS1,DDSPROMPT=&DDSPMTK                 @06C 31016600
.OSG16   ANOP                                                           31050000
.ENDUP1  ANOP                          END OF PROCESSING                31100000
*********************************************************************   31150000
*                                                                       31200000
*    ASSEMBLY OF THIS MACRO HAS SUCCESSFULLY COMPLETED.                 31250000
*    THE DECK IS A JOB STREAM WHICH WHEN RUN WILL INITIALIZE            31300000
*    THE AMDSADMP RESIDENCE VOLUME.                                     31350000
*                                                                       31400000
*********************************************************************   31450000
         MEND                                                           31500000
