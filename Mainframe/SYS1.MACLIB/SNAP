*/* MACCOMP Y-1 SCDMP/PZD10                                          */ 00050000
*/* MACSTAT Y-1 81044/Y02705 HBB3310                                 */ 00100000
*/* APAR OZ51152 - A-TYPE ADDR NOT GENERATED FOR STRHDR WHEN LIST    */ 00150000
*/*                IS REG FORMAT                             @ZA51152*/ 00200000
*/*                                                                  */ 00225000
*/* COPYRIGHT =                                                      */ 00250000
*/*            5645-001                                              */ 00275000
*/*            THIS MODULE IS "RESTRICTED MATERIALS OF IBM"          */ 00300000
*/*            (C) COPYRIGHT IBM CORP. 1980,1997                     */ 00350000
*/*            LICENSED MATERIALS - PROPERTY OF IBM                  */ 00400000
*/*                                                                  */ 00437500
*/*  EXTERNAL CLASSIFICATION: GUPI                                   */ 00475000
*/*  END OF EXTERNAL CLASSIFICATION:                                 */ 00512500
*/*                                                                  */ 00550000
*/* STATUS  = HBB6603                                                */ 00600000
*/*                                                                  */ 00650000
*/* CHANGE ACTIVITY =                                                */ 00700000
*/*   $L1 =    AR    HBB3310 850901 PDXB: AR SUPPORT                 */ 00750000
*/*   $P1 =  PC40312 HBB3310 861227 PDXB: CORRECT TYPE FOR DCB ADDR  */ 00775000
*/*   $D1 =  DR20001 HBB6601 950907 PD00KV: SPLIT FROM SC1CM     @D1A*/ 00787500
*/*   $P2 =  PQC0594 HBB6603 951211 PDKV: DO NOT UPDATE THE REGISTER */ 00790000
*/*                          USED TO PASS THE DCB ADDR (OW16863) @P2A*/ 00792500
*/*   $P3 =  PQC0604 HBB6603 951211 PDKV: PREVENT ASMA094I BY        */ 00795000
*/*                          CHECKING MF= CHAR COUNT             @P3A*/ 00797500
         MACRO                                                          00800000
&NAME    SNAP  &DCB=,&TCB=,&SDATA=,&PDATA=,&STORAGE=,&LIST=,&ID=,&MF=,&X00850000
               STRHDR=,&SUBPLST=                               @G860P1Y 00900000
* /* MACDATE Y-1 860219 LAST UPDATED 11/01/85 HBB3310                */ 00950000
.*A016000,020000,022000,034000,060000,094000,104000,284000       Y02705 01000000
.*A380000,490000,678000                                          Y02705 01050000
.*D330000-378000,384000-386000,484000-488000,638000              Y02705 01100000
.*C034000,276000-278000,320000,326000,392000,432000,438000       Y02705 01150000
.*C574000,588000,594000,616000,620000,018000,420000,634000       Y02705 01200000
         LCLC  &C1,&C2,&GNAME                                           01250000
         LCLB  &B0,&B1,&B2,&B3,&B4,&B5,&B6,&B7,&B8,&B9,&B10,&B11,&B12,&X01300000
               B13,&B14,&B15,&B16                               G33SPHW 01350000
         LCLB  &B17,&B18,&B19          SQA,LSQA,SWA              Y02705 01400000
         LCLB  &B20,&B21,&B22,&B23,&B24,&B25                            01450000
         LCLB  &B26,&B27,&B28      SUM, ALLVNUC, SUBPLST       @G860P1Y 01500000
         LCLB  &B30                           G382P12                   01550000
         LCLB  &VS2SE3            MVS SYSTEM EXTENSION 1.3.0    G382P12 01600000
         LCLB  &OSVS2R2           OSVS2R2 LEVEL OF PARAM LIST    Y02705 01650000
         LCLB  &OSENVS2           OSVS2R2 ENHANCED SNAP         G33SPHW 01700000
         LCLB  &MVSE               HBB2102 INDICATOR           @G860P1Y 01750000
         LCLA  &FLAGS4,&CTR3,&CTR4,&CTR5,&CTR7,&CTR8,&CTRA,&CTRB        01800000
         LCLC  &C3,&C4                                                  01850000
         LCLA  &FLAGS3                 FLAG FIELD                Y02705 01900000
         LCLA  &FLAGS5                 OPTIONS REQUESTED       @G860P1Y 01950000
         LCLA   &FLAGS1,&FLAGS2,&CTR1,&CTR2,&DISP              @G382P12 02000000
         ACTR   9000                                                    02050000
&B0      SETB  1                  INDICATES SNAP REQUEST         Y02705 02100000
&OSVS2R2 SETB  1                  INDICATES AN OSVS2R2 LEVEL     Y02705 02150000
&OSENVS2 SETB  1                  INDICATES A SNAP ENHANCED     G33SPHW 02200000
&VS2SE3  SETB  1                  INDICATES SNAP ENHANCED 3    @G382P12 02250000
         GBLC  &SYSASCE           ASC ENVIRONMENT                  @L1A 02300000
         SYSSTATE TEST            WHAT IS ASC ENVIRONMENT          @L1A 02350000
         AIF ('&SYSASCE' EQ 'P').INVKSNP PRIMARY, PROCESS NORMALLY @L1A 02400000
         MNOTE 0,'*** SNAPX MACRO SUBSTITUTED FOR SNAP MACRO BECAUSE ASX02450000
               CENV=AR/ANY SPECIFIED ON PREVIOUSLY ISSUED SYSSTATE MACRX02500000
               O'                                                  @L1A 02550000
&NAME    SNAPX DCB=&DCB,TCB=&TCB,SDATA=&SDATA,PDATA=&PDATA,            X02600000
               STORAGE=&STORAGE,LIST=&LIST,ID=&ID,MF=&MF,              X02650000
               STRHDR=&STRHDR,SUBPLST=&SUBPLST                     @L1A 02700000
         MEXIT                                                     @L1A 02750000
.INVKSNP ANOP                                                      @L1A 02800000
         AIF   (T'&MF EQ 'O').STAND    STANDARD FORM             Y02705 02850000
         AIF   (K'&MF LT 3).STAND      LESS THAN THREE MF= CHARS   @P3A 02875000
         AIF   ('&MF'(1,3) EQ '(E,' AND '&TCB' EQ '''S''').EXCUR Y02705 02900000
.STAND   ANOP                                                    Y02705 02950000
&B1      SETB  ('&TCB' NE '')                                           03000000
.********************************************************************** 03050000
.*                                                                    * 03100000
.*      PARSE THE SDATA PARAMETERS, AND SET INDICATORS                * 03150000
.*                                                            @G860P33* 03200000
.********************************************************************** 03250000
.EXCUR   ANOP                                                    Y02705 03300000
         AIF   ('&SDATA' EQ '').CHKSTR                                  03350000
         AIF    ('&SDATA'(1,1) EQ '(').ABC2                             03400000
&B2      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'CB')                  03450000
&B3      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'TRT')                 03500000
&B4      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'NUC')                 03550000
&B7      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'Q')                   03600000
&B17     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SQA')          Y02705 03650000
&B18     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'LSQA')         Y02705 03700000
&B19     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SWA')          Y02705 03750000
&B20   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'DM')            G33SPHW 03800000
&B21   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'IO')            G33SPHW 03850000
&B22   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'ERR')           G33SPHW 03900000
&B30   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'PCDATA')       @G382P12 03950000
&B26   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SUM')          @G860P1Y 04000000
&B27   SETB  ('&SDATA' EQ 'ALLVNUC')                           @G860P1Y 04050000
&CTR1    SETA  &B2+&B3+&B4+&B17+&B18+&B19+&B7+&B20+&B21+&B22+&B30+&B26+X04100000
               &B27                                            @G860P1Y 04150000
         AIF   ('&CTR1' EQ '0').MSG2                                    04200000
         AGO   .CHKSTR                                                  04250000
.ABC2    ANOP                                                           04300000
&CTR1    SETA  N'&SDATA                                                 04350000
&CTR2    SETA  0                                                        04400000
.LOOPA   ANOP                                                           04450000
&CTR2    SETA  &CTR2+1                                                  04500000
&C1      SETC  '&SDATA(&CTR2)'                                          04550000
         AIF   ('&C1' EQ 'TRT').SETTRT                                  04600000
         AIF   ('&C1' EQ 'NUC').SETNUC                                  04650000
         AIF   ('&C1' EQ 'CB').SETCB                                    04700000
         AIF   ('&C1' EQ 'Q').SETQ                                      04750000
         AIF   ('&C1' EQ 'SQA').SETSQA      IS SQA SPECIFIED     Y02705 04800000
         AIF   ('&C1' EQ 'LSQA').SETLSQA    IS LSQA SPECIFIED    Y02705 04850000
         AIF   ('&C1' EQ 'SWA').SETSWA      IS SWA SPECIFIED     Y02705 04900000
         AIF   ('&C1' EQ 'DM').SETDM        IS DM SPECIFIED     G33SPHW 04950000
         AIF   ('&C1' EQ 'IO').SETIO        IS IO SPECIFIED     G33SPHW 05000000
         AIF   ('&C1' EQ 'ERR').SETERR      IS ERR SPECIFIED    G33SPHW 05050000
         AIF   ('&C1' EQ 'PCDATA').SETPC    IS PCDATA SPEC     @G382P12 05100000
         AIF   ('&C1' EQ 'SUM').SETSUM  IS SUMMARY SPECIFIED   @G860P1Y 05150000
         AIF   ('&C1' EQ 'ALLVNUC').SETANUC  IS ALLVNUC REQSTD @G860P1Y 05200000
         AIF   ('&C1' EQ 'ALL').SETALL                                  05250000
         AGO   .MSG2                                                    05300000
.CHKOPT  ANOP                                                           05350000
         AIF   ('&CTR2' NE '&CTR1').LOOPA                               05400000
         AGO   .CHKSTR                                                  05450000
.SETTRT  ANOP                                                           05500000
&B3      SETB  1                                                        05550000
         AGO   .CHKOPT                                                  05600000
.SETNUC  ANOP                                                           05650000
&B4      SETB  1                                                        05700000
         AGO   .CHKOPT                                                  05750000
.SETCB   ANOP                                                           05800000
&B2      SETB  1                                                        05850000
         AGO   .CHKOPT                                                  05900000
.SETQ    ANOP                                                           05950000
&B7      SETB  1                                                        06000000
         AGO   .CHKOPT                                                  06050000
.SETSQA  ANOP                          SQA SPECIFIED             Y02705 06100000
&B17     SETB  1                       SET SQA INDICATOR         Y02705 06150000
         AGO   .CHKOPT                 RETURN                    Y02705 06200000
.SETLSQA ANOP                          LSQA SPECIFIED            Y02705 06250000
&B18     SETB  1                       SET LSQA INDICATOR        Y02705 06300000
         AGO   .CHKOPT                 RETURN                    Y02705 06350000
.SETSWA  ANOP                          SWA SPECIFIED             Y02705 06400000
&B19     SETB  1                       SET SWA INDICATOR         Y02705 06450000
         AGO   .CHKOPT                 RETURN                    Y02705 06500000
.SETDM   ANOP                                                   G33SPHW 06550000
&B20     SETB  1                       DM SPECIFIED             G33SPHW 06600000
         AGO .CHKOPT                   RETURN                   G33SPHW 06650000
.SETIO   ANOP                          IO SPECIFIED             G33SPHW 06700000
&B21     SETB  1                       SET IO INDICATOR         G33SPHW 06750000
         AGO .CHKOPT                   RETURN                   G33SPHW 06800000
.SETERR  ANOP                          ERR SPECIFIED            G33SPHW 06850000
&B22     SETB  1                       SET ERR INDICATOR        G33SPHW 06900000
         AGO .CHKOPT                   RETURN                   G33SPHW 06950000
.SETPC   ANOP                          PCDATA SPECIFIED        @G382P12 07000000
&B30     SETB  1                       SET PCDATA INDICATOR    @G382P12 07050000
         AGO .CHKOPT                   RETURN                  @G382P12 07100000
.SETSUM  ANOP                      SUMMARY DUMP REQUESTED      @G860P1Y 07150000
&B26     SETB  1                   SET SUMMARY INDICATOR       @G860P1Y 07200000
         AGO   .CHKOPT             RETURN                      @G860P1Y 07250000
.SETANUC ANOP                      VIRTUAL NUCLEUS REQUESTED   @G860P1Y 07300000
&B27     SETB  1                   SET ALLVNUC INDICATOR       @G860P1Y 07350000
         AGO   .CHKOPT             RETURN                      @G860P1Y 07400000
.SETALL  ANOP                                                           07450000
&B2      SETB  1                                                        07500000
&B3      SETB  1                                                        07550000
&B4      SETB  1                                                        07600000
&B7      SETB  1                                                        07650000
&B17     SETB  1                       SQA INDICATOR             Y02705 07700000
&B18     SETB  1                       LSQA INDICATOR            Y02705 07750000
&B19     SETB  1                       SWA  INDICATOR            Y02705 07800000
&B20     SETB  1                       DM  INDICATOR            G33SPHW 07850000
&B21     SETB  1                       IO  INDICATOR            G33SPHW 07900000
&B22     SETB  1                       ERR INDICATOR            G33SPHW 07950000
&B30     SETB  1                       PCDATA INDICATOR        @G382P12 08000000
&B26     SETB  1                       SUMMARY INDICATOR       @G860P1Y 08050000
         AGO   .CHKOPT                 RETURN                  @G860P1Y 08100000
.********************************************************************** 08150000
.*                                                                    * 08200000
.*      PARSE THE STORAGE, STRHDR, SUBPLST PARAMETERS                 * 08250000
.*                                                            @G860P33* 08300000
.********************************************************************** 08350000
.CHKSTR  ANOP                                                           08400000
&B5      SETB  ('&STORAGE' NE '')                                       08450000
&B16     SETB  ('&LIST' NE '')                                          08500000
&B23    SETB   ('&STRHDR' NE '')       WAS STRHDR SPECIFIED     G33SPHW 08550000
&B28     SETB  ('&SUBPLST' NE '')  WAS SUBPLST SPECIFIED       @G860P1Y 08600000
         AIF   ('&B28' EQ '0').NOMVSE SUBPLST OPTION SPECIFIED @G860P1Y 08650000
&MVSE    SETB  1                 INDICATE HBB2102 LEVEL        @G860P1Y 08700000
.NOMVSE  ANOP                  USE PRE-HBB2102 PARMLIST        @G860P1Y 08750000
         AIF   ('&B5' EQ '1' AND '&B16' EQ '1').MSG4                    08800000
&B25     SETB  ('&B5' EQ '1' OR '&B16' EQ '1')                  G33SPHW 08850000
         AIF   ('&B23' EQ '1' AND '&B25' EQ '0').MSG9           G33SPHW 08900000
         AIF   ('&B23' NE '1').SKIPT                            G33SPHW 08950000
&CTR4    SETA  N'&STRHDR                                        G33SPHW 09000000
         AIF  (&CTR4 LT 1).MSG7                                 G33SPHW 09050000
.SKIPT   ANOP                                                   G33SPHW 09100000
         AIF   ('&B5' EQ '0').CHKSTRB                                   09150000
&CTR1    SETA  N'&STORAGE                                               09200000
         AIF   (&CTR1 LT 2).MSG4                               AS100400 09250000
         AIF   ('&B23' EQ '0').NOSHA   STRHDR SPECIFIED         G33SPHW 09300000
&CTR3    SETA  N'&STRHDR*2             GET NUMBER OF HEADER*2   G33SPHW 09350000
         AIF  ( &CTR3 GT &CTR1).MSG8 TOO MANY HEADERS           G33SPHW 09400000
.NOSHA   ANOP                                                   G33SPHW 09450000
.CHKSTRA ANOP                                                           09500000
&CTR1    SETA  &CTR1-2                                                  09550000
         AIF   (&CTR1 EQ 0).CHKSTRC                            AS100400 09600000
         AIF   (&CTR1 LT 1).MSG4                          0880 AS100400 09650000
         AGO   .CHKSTRA                                                 09700000
.CHKSTRB ANOP                                                           09750000
         AIF   ('&B16' EQ '0').CHKSTRC                                  09800000
         AIF   (N'&LIST NE 1).MSG4      LIST PARSM^=1                   09850000
         AIF   ('&B23' EQ '0').CHKSTRC  STRHDR SPECIFIED        G33SPHW 09900000
         AIF   (N'&STRHDR NE 1).MSGA     LIST FORMAT            G33SPHW 09950000
.CHKSTRC ANOP                                                           10000000
&B6      SETB  ('&ID' NE '')                                            10050000
.********************************************************************** 10100000
.*                                                                    * 10150000
.*      PARSE THE PDATA PARAMETERS AND SET INDICATORS                 * 10200000
.*                                                            @G860P33* 10250000
.********************************************************************** 10300000
         AIF   ('&PDATA' EQ '').SETFLAG                                 10350000
         AIF   ('&PDATA'(1,1) EQ '(').ABC8                              10400000
&B8 SETB ('&PDATA' EQ 'SAH' OR '&PDATA' EQ 'SA' OR '&PDATA' EQ 'ALL')   10450000
&B9      SETB  ('&PDATA' EQ 'SAH')                                      10500000
&B10      SETB  ('&PDATA' EQ 'REGS' OR '&PDATA' EQ 'ALL')               10550000
&B11 SETB ('&PDATA' EQ 'LPA' OR '&PDATA' EQ 'ALLPA' OR '&PDATA' EQ 'ALLX10600000
               ')                                                       10650000
&B12 SETB ('&PDATA' EQ 'JPA' OR '&PDATA' EQ 'ALLPA' OR '&PDATA' EQ 'ALLX10700000
               ')                                                       10750000
.PDATA1  ANOP                                                           10800000
&B13     SETB  ('&PDATA' EQ 'PSW' OR '&PDATA' EQ 'ALL')                 10850000
&B14     SETB  ('&PDATA' EQ 'SPLS' OR '&PDATA' EQ 'ALL')                10900000
&B15     SETB  ('&PDATA' EQ 'SUBTASKS' OR '&PDATA' EQ 'ALL')   @G860P33 10950000
&CTR1    SETA  &B8+&B9+&B10+&B11+&B12+&B13+&B14+&B15           @G860P33 11000000
         AIF   ('&CTR1' EQ '0').MSG3                                    11050000
         AGO   .SETFLAG                                                 11100000
.ABC8    ANOP                                                           11150000
&CTR1    SETA  N'&PDATA                                                 11200000
&CTR2    SETA  0                                                        11250000
.LOOPB   ANOP                                                           11300000
&CTR2    SETA  &CTR2+1                                                  11350000
&C1      SETC  '&PDATA(&CTR2)'                                          11400000
         AIF   ('&C1' EQ 'SA').SETSA                                    11450000
         AIF   ('&C1' EQ 'SAH').SETSAH                                  11500000
         AIF   ('&C1' EQ 'REGS').SETREGS                                11550000
         AIF   ('&C1' EQ 'LPA').SETLPA                      ZMXXXXX     11600000
         AIF   ('&C1' EQ 'JPA').SETJPA                                  11650000
         AIF   ('&C1' EQ 'ALLPA').SETALPA                               11700000
         AIF   ('&C1' EQ 'PSW').SETPSW                                  11750000
         AIF   ('&C1' EQ 'SPLS').SETSPLS                                11800000
         AIF   ('&C1' EQ 'SUBTASKS').SETASK SUBTASKS SPECIFIED @G860P33 11850000
         AIF   ('&C1' EQ 'ALL').SETPALL                                 11900000
         AGO   .MSG3                                                    11950000
.CHKPMOR ANOP                                                           12000000
         AIF   ('&CTR2' NE '&CTR1').LOOPB                               12050000
         AGO   .SETFLAG                                                 12100000
.SETSA    ANOP                                                          12150000
&B8      SETB  1                                                        12200000
         AGO   .CHKPMOR                                                 12250000
.SETSAH  ANOP                                                           12300000
&B8      SETB    1                                                      12350000
&B9      SETB  1                                                        12400000
         AGO    .CHKPMOR                                                12450000
.SETREGS ANOP                                                           12500000
&B10     SETB  1                                                        12550000
         AGO   .CHKPMOR                                                 12600000
.SETLPA ANOP                                                            12650000
&B11     SETB  1                                                        12700000
         AGO   .CHKPMOR                                                 12750000
.SETJPA  ANOP                                                           12800000
&B12     SETB   1                                                       12850000
         AGO   .CHKPMOR                                                 12900000
.SETALPA  ANOP                                                          12950000
&B11     SETB  1                                                        13000000
&B12     SETB  1                                                        13050000
         AGO   .CHKPMOR                                                 13100000
.SETPSW   ANOP                                                          13150000
&B13     SETB  1                                                        13200000
         AGO   .CHKPMOR                                                 13250000
.SETSPLS  ANOP                                                          13300000
&B14     SETB   1                                                       13350000
         AGO   .CHKPMOR                                                 13400000
.SETASK   ANOP                                                 @G860P33 13450000
&B15     SETB   1                  INDICATE SUBTASKS SPECIFIED @G860P33 13500000
         AGO   .CHKPMOR                                        @G860P33 13550000
.SETPALL  ANOP                                                          13600000
&B8      SETB  1                                                        13650000
&B10     SETB  1                                                        13700000
&B11     SETB  1                                                        13750000
&B12     SETB  1                                                        13800000
&B13     SETB  1                                                        13850000
&B14     SETB  1                                                        13900000
&B15     SETB  1                   INDICATE SUBTASKS SPECIFIED @G860P33 13950000
.SETFLAG  ANOP                                                          14000000
         AIF   ('&B28' EQ '1' AND '&B14' EQ '1').MSGSUBP       @G860P1Y 14050000
         AIF   ('&B28' EQ '0').NOTSUBP  WAS SUBPLST SPECIFIED  @G860P1Y 14100000
         AIF   (N'&SUBPLST NE 1).MSGNOTL  YES, MUST BE 1 ENTRY @G860P1Y 14150000
.NOTSUBP ANOP                      SUBPLST WASN'T SPECIFIED    @G860P1Y 14200000
&FLAGS1  SETA  128*&B4+64*&B17+32*&B18+16*&B19+8*&B3+4*&B2+2*&B7+1*&B20 14250000
&FLAGS2  SETA  128*&B8+64*&B9+32*&B10+16*&B11+8*&B12+4*&B13+2*&B14+1*&BX14300000
               15                                                       14350000
&FLAGS3  SETA  64*&OSVS2R2+32*&OSENVS2+16*&B0+8*&B6+4*&B1+2*&B5+2*&B16+X14400000
               1*&B23                                           G33SPHW 14450000
&FLAGS4  SETA  128*&B21+64*&B22+32*&B30+16*&B26+8*&B27 OPTIONS @G860P1Y 14500000
&FLAGS5  SETA  128*&VS2SE3+4*&MVSE+2*&B28    OPTIONS REQUESTED @G860P1Y 14550000
         AIF   ('&DCB' EQ '' AND ('&MF' EQ '')).MSG1                    14600000
         AIF   ('&MF' EQ '').STYPE                                      14650000
         AIF   ('&MF' EQ 'L').LTYPE                                     14700000
         AIF   ('&MF'(1,3) NE '(E,').MSG5                               14750000
.********************************************************************** 14800000
.*                                                                    * 14850000
.*      PROCESS THE EXECUTE FORM                                      * 14900000
.*                                                            @G860P33* 14950000
.********************************************************************** 15000000
         AIF ('&NAME' EQ '').NONM                                       15050000
&NAME    DS    0H                                                  0918 15100000
.NONM    ANOP                                                           15150000
&C1      SETC  '&MF(2)'                                                 15200000
         AIF   ('&C1'(1,1) EQ '(').REG                                  15250000
         LA    1,&MF(2)                                            0918 15300000
         AGO   .CONT0                                                   15350000
.REG     ANOP                                                           15400000
         AIF   ('&C1' EQ '(1)').CONT0                                   15450000
         LR    1,&C1         GET ADDR OF PARM LIST                      15500000
.CONT0   ANOP                                                           15550000
         AIF   ('&DCB' EQ '').NODCB                                     15600000
         AIF   ('&DCB'(1,1) EQ '(').REGDCB                              15650000
         LA    0,&DCB               GET DCB ADDRESS                     15700000
         ST    0,8(0,1)             STORE INTO PARAMETER LIST    Y02705 15750000
         AGO    .NODCB                                                  15800000
.REGDCB  ANOP                                                           15850000
.*                                                                 @P2D 15900000
         ST    &DCB,8(0,1)   STORE DCB ADDR INTO PARAM LIST      Y02705 15950000
         MVI   8(1),0        CLEAR HIGH ORDER BYTE OF DCB ADR      @P2A 15975000
.NODCB   ANOP                                                           16000000
         OI    1(1),&FLAGS3        SET OPTION FLAGS              Y02705 16050000
         OI    2(1),&FLAGS5        SET OPTION FLAG 2           @G860P1Y 16100000
.CKSDATA AIF   (T'&SDATA EQ 'O').CKPDATA    IS SDATA SPECIFIED   Y02705 16150000
         MVI   4(1),&FLAGS1        SET OPTION FLAGS              Y02705 16200000
         MVI   5(1),&FLAGS4        SET OPTIONS FLAGS            G33SPHW 16250000
.CKPDATA AIF   (T'&PDATA EQ 'O').GO1        IS PDATA SPECIFIED   Y02705 16300000
         MVI   6(1),&FLAGS2        SET OPTION FLAGS              Y02705 16350000
.GO1     ANOP                                                    Y02705 16400000
         AIF   ('&B1' EQ '0').NOTCB         IS TCB SPECIFIED     Y02705 16450000
         AIF   ('&TCB'(1,1) EQ '(').REGTCB  IS TCB ADDR IN A REG Y02705 16500000
         L     0,&TCB                       ADDRESS OF TCB       Y02705 16550000
         ST    0,12(0,1)                    INTO PARAMETER LIST  YM1995 16600000
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 16650000
.NOTCB   AIF   ('&TCB' EQ '''S''').CURRTCB  CURRENT TCB REQUEST  YO2705 16700000
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 16750000
.CURRTCB NI    1(1),X'FB'                   CURRENT TCB REQUEST  Y02705 16800000
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 16850000
.REGTCB  ANOP                                                    Y02705 16900000
         ST    &TCB,12(0,1)                 TCB ADDR INTO PARAM  YM1995 16950000
.GO2     ANOP                                                    Y02705 17000000
         AIF   ('&B5' EQ '0').NOSHOT                                    17050000
&CTR1    SETA  N'&STORAGE                                               17100000
         AIF   ('&MVSE' EQ '0').NOMVSE1  HBB2102 PLIST         @G860P1Y 17150000
         LA    0,28(0,1)          SET UP SNAPSHOT LIST ADDRESS @G860P1Y 17200000
         AGO   .STPARM            CONTINUE PROCESSING PARMLIST @G860P1Y 17250000
.NOMVSE1 ANOP                      NOT HBB2102 PARMLIST        @G860P1Y 17300000
         LA    0,24(0,1)           USE PRE-HBB2102 LNTH        @G860P1Y 17350000
.STPARM  ANOP                     CONTINUE PROCESSING PARMLIST @G860P1Y 17400000
         ST    0,16(0,1)           STORE INTO PARAMETER LIST     Y02705 17450000
         AIF   ('&B23' EQ '0').NOHEAD   STRHDR SPECIFIED        G33SPHW 17500000
&CTR4    SETA  N'&STRHDR                NUMBER OF HEADERS       G33SPHW 17550000
&CTR8    SETA  &CTR1*4                  DISPLACEMENT            G33SPHW 17600000
         AIF   ('&MVSE' EQ '0').NOMVSE2  HBB2102 PLIST         @G860P1Y 17650000
&CTR8    SETA  &CTR8+28                 SKIP LIST              @G860P1Y 17700000
         AGO   .STHEAD             SET UP HEADER ADDRESS       @G860P1Y 17750000
.NOMVSE2 ANOP                      NOT HBB2102 PARMLIST        @G860P1Y 17800000
&CTR8    SETA  &CTR8+24     SKIP LIST PASS HBB2102 LIST        @G860P1Y 17850000
.STHEAD  ANOP                      SET UP HEADER ADDRESS       @G860P1Y 17900000
         LA    0,&CTR8.(0,1)       SET UP HEADER ADDRESS        G33SPHW 17950000
         ST    0,20(0,1)           STORE INTO PARMLIST          G33SPHW 18000000
.NOHEAD  ANOP                      NOHEADERS SPECIFIED          G33SPHW 18050000
.STRLOOP ANOP                                                           18100000
&CTR2    SETA   0                                                       18150000
         AIF   ('&MVSE' EQ '0').NOMVSE3  HBB2102 PLIST         @G860P1Y 18200000
&DISP    SETA  24                  DISP INTO STORAGE ADDR LIST @G860P1Y 18250000
         AGO   .LOOP1              OBTAIN STORAGE ADDRESSES    @G860P1Y 18300000
.NOMVSE3 ANOP                      NOT HBB2102 PARMLIST        @G860P1Y 18350000
&DISP    SETA  20          USE PRE-HBB2102 DISPLACEMENT        @G860P1Y 18400000
.LOOP1   ANOP                                                           18450000
&CTR2    SETA  &CTR2+1                                                  18500000
&DISP    SETA  &DISP+4                                                  18550000
&C1      SETC  '&STORAGE(&CTR2)'                                        18600000
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').STOR1                    18650000
         AIF   ('&MF' EQ '').AIF1                                       18700000
         LA    0,&STORAGE(&CTR2)   GET STARTING/ENDING ADDRESS     5139 18750000
         ST    0,&DISP.(0,1)                                            18800000
         AGO   .AIF1                                                    18850000
.STOR1   ANOP                                                           18900000
         ST    &C1,&DISP.(0,1)     GET STARTING/ENDING ADDRESS          18950000
.AIF1    ANOP                                                           19000000
         AIF   ('&CTR2' NE '&CTR1').LOOP1                               19050000
         OI    &DISP.(1),X'80'     SET END OF LIST INDICATOR     Y02705 19100000
         AGO   .HDRLOOP              CHECK HEADER               G33SPHW 19150000
.HDRLOOP ANOP                        STRHDR PROCESS             G33SPHW 19200000
         AIF   ('&B23' EQ '0').AIF3  NO STRHDR                  G33SPHW 19250000
&CTR4    SETA  N'&STRHDR             NUMBER OF HEADERS          G33SPHW 19300000
&CTR3    SETA  0                     COUNTER INITIALIZED        G33SPHW 19350000
.LOOP6   ANOP                        LOOP THRU HEADERS          G33SPHW 19400000
&CTR3    SETA  &CTR3+1               BUMP COUNTER               G33SPHW 19450000
&DISP    SETA  &DISP+4               BUMP DISPLACEMENT          G33SPHW 19500000
&C3      SETC  '&STRHDR(&CTR3)'      GET HEADER ADDRESS         G33SPHW 19550000
         AIF   ('&STRHDR(&CTR3)' EQ '').COMA                    G33SPHW 19600000
         AIF   ('&STRHDR(&CTR3)'(1,1) EQ '(').STOR3             G33SPHW 19650000
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 19700000
         LA    0,&STRHDR(&CTR3)    GET HEADER ADDRESS           G33SPHW 19750000
         ST    0,&DISP.(0,1)       STORE IN PARMLIST            G33SPHW 19800000
         AGO   .CHKIF                END OF HEADERS             G33SPHW 19850000
.STOR3   ANOP                        STORE REG IN PARMLIST      G33SPHW 19900000
         ST    &C3,&DISP.(0,1)     STORE HEADER ADDRESS         G33SPHW 19950000
.CHKIF   ANOP                        CHECK END OF HEADERS       G33SPHW 20000000
         AIF   ('&CTR3' NE '&CTR4').LOOP6 NOT END               G33SPHW 20050000
         OI    &DISP.(1),X'80'     SET END OF HEADER INDICATOR  G33SPHW 20100000
         AGO   .AIF3               HEADERS COMPLETE             G33SPHW 20150000
.COMA    ANOP                                                   G33SPHW 20200000
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 20250000
         LA    0,&STRHDR(&CTR3)    GET HEADER ADDRESS           G33SPHW 20300000
         ST    0,&DISP.(0,1)       STORE IN PARMLIST            G33SPHW 20350000
         AGO  .CHKIF                                            G33SPHW 20400000
.AIF3    ANOP                                                   G33SPHW 20450000
         AIF   ('&MF' EQ '').NOSTR                                      20500000
.NOSHOT  ANOP                                                           20550000
         AIF   ('&B16' EQ '0').SUBPOPT     IS LIST SPECIFIED   @G860P1Y 20600000
         AIF   ('&LIST'(1,1) EQ '(').LL1                                20650000
         LA    0,&LIST             GET LIST ADDRESS             G33SPHW 20700000
         ST    0,16(0,1)           STORE LIST ADDRESS IN PARM   G33SPHW 20750000
         AGO   .CHKH               CHECK HEADER SPECIFIED       G33SPHW 20800000
         OI    &DISP.(1),X'80'     SET END OF LIST INDICATOR    G33SPHW 20850000
         AGO   .AIF3               HEADERS COMPLETE             G33SPHW 20900000
         ST    0,16(0,1)     STORAGE IN PARAMETER LIST           Y02705 20950000
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 21000000
         LA    0,0                 ZERO ENTRY                   G33SPHW 21050000
         ST    0,&DISP.(0,1)       STORE ZERO HEADER LIST       G33SPHW 21100000
.LL1     ANOP                                                           21150000
         ST    &LIST,16(0,1) SNAPSHOT LIST ADDR INTO PARAM LIST  Y02705 21200000
         AGO   .CHKH                                            G33SPHW 21250000
.CHKH    ANOP                                                   G33SPHW 21300000
         AIF   ('&B23' EQ '0').NOHD   NO STRHDR SPECIFIED       G33SPHW 21350000
         AIF   ('&STRHDR'(1,1) EQ '(').STRHED                   G33SPHW 21400000
         LA    0,&STRHDR     GET HEADER ADDRESS                 G33SPHW 21450000
         ST    0,20(0,1)     STORE HEADER ADDRESS               G33SPHW 21500000
.NOHD    ANOP                                                   G33SPHW 21550000
         AGO   .SUBPOPT      CHECK SUBPLST OPTION              @G860P1Y 21600000
.STRHED  ANOP                HEADER IN REGISTER                 G33SPHW 21650000
         ST    &STRHDR,20(0,1) STORE HEADER ADDRESS             G33SPHW 21700000
.SUBPOPT ANOP                SET UP SUBPLST OPTION             @G860P1Y 21750000
         AIF   ('&B28' EQ '0').IDPREP  WAS SUBPLST= SPECIFIED  @G860P1Y 21800000
         AIF   ('&SUBPLST'(1,1) EQ '(').SUBREG  REG FORM USED  @G860P1Y 21850000
         LA    0,&SUBPLST          GET SUBPOOL LIST ADDRESS    @G860P1Y 21900000
         ST    0,24(0,1)           STORE SUBPOOL LIST ADDRESS  @G860P1Y 21950000
         AGO   .IDPREP             PREPARE FOR ID              @G860P1Y 22000000
.SUBREG  ANOP                                                  @G860P1Y 22050000
         ST    &SUBPLST,24(0,1)    STORE SUBPOOL LIST ADDRESS  @G860P1Y 22100000
         AGO   .IDPREP       PREPARE FOR ID                     G33SPHW 22150000
.IDPREP  ANOP                                                           22200000
         AIF   ('&B6' EQ '0').NOID                                      22250000
         AIF   ('&ID'(1,1) EQ '(').IDPREP1                              22300000
         MVI   0(1),&ID            GET ID NUMBER                        22350000
         AGO    .NOID                                                   22400000
.IDPREP1  ANOP                                                          22450000
         STC   &ID,0(0,1)         GET ID NUMBER                  YM1995 22500000
.NOID    ANOP                                                           22550000
         SVC   51                                                       22600000
         MEXIT                                                          22650000
.********************************************************************** 22700000
.*                                                                    * 22750000
.*      PROCESS THE STANDARD FORM                                     * 22800000
.*                                                            @G860P33* 22850000
.********************************************************************** 22900000
.STYPE   ANOP                                                           22950000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          23000000
         CNOP  0,4                                                      23050000
&NAME    BAL   1,&GNAME            BRANCH AROUND PARAM LIST             23100000
.LSTYPE  ANOP                                                           23150000
         AIF   ('&B6' EQ '0').NOIDS                                     23200000
         AIF   ('&ID'(1,1) EQ '(').NOIDS                                23250000
         DC    AL1(&ID)            ID NUMBER                            23300000
         AGO   .CONT2                                                   23350000
.NOIDS   ANOP                                                           23400000
         DC    AL1(0)              ID NUMBER                            23450000
.CONT2   ANOP                                                           23500000
         DC    AL1(&FLAGS3)        OPTION FLAGS                  Y02705 23550000
         DC    AL1(&FLAGS5)        OPTIONS FLAG 2              @G860P1Y 23600000
         DC    AL1(0)              RESERVED                    @G382P12 23650000
         DC    AL1(&FLAGS1)        SDATA FLAGS ONE               Y02705 23700000
         DC    AL1(&FLAGS4)        SDATA FLAGS TWO              G33SPHW 23750000
         DC    AL1(&FLAGS2)        PDATA FLAGS                   Y02705 23800000
         DC    AL1(0)              RESERVED                      Y02705 23850000
         AIF   ('&DCB' EQ '').DCBA0                                     23900000
         AIF   ('&DCB'(1,1) EQ '(').DCBA0                          9943 23950000
         DC    A(&DCB)             DCB ADDRESS                          24000000
         AGO   .DCBA1                                                   24050000
.DCBA0   ANOP                                                           24100000
         DC    A(0)                DCB ADDRESS                          24150000
.DCBA1    ANOP                                                          24200000
         DC    A(0)                TCB ADDRESS                          24250000
         AIF   ('&B5' EQ '0' AND '&B16' EQ '0').LISTREG                 24300000
         AIF   ('&B5' EQ '1').STORON                                    24350000
         AIF   ('&LIST'(1,1) EQ '(').LISTRG                    @ZA51152 24400000
         DC    A(&LIST)            ADDRESS OF SNAPSHOT LIST             24450000
         AGO   .CHHDR                                          @ZA51152 24500000
.LISTRG  ANOP                                                  @ZA51152 24550000
         DC    A(0)                ADDRESS OF SNAPSHOT LIST    @ZA51152 24600000
.CHHDR   ANOP                                                  @ZA51152 24650000
         AIF   ('&B23' EQ '1').SHSPEC  STRHDR SPECIFIED         G33SPHW 24700000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 24750000
         AGO   .PROCSUB                                         G33SPHW 24800000
.SHSPEC  ANOP                                                   G33SPHW 24850000
         AIF   ('&STRHDR'(1,1) EQ '(').HDRLIST                  G33SPHW 24900000
         DC    A(&STRHDR)          ADDRESS OF HEADER LIST       G33SPHW 24950000
         AGO   .PROCSUB                                         G33SPHW 25000000
.HDRLIST ANOP                                                   G33SPHW 25050000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 25100000
         AGO   .PROCSUB                                                 25150000
.STORON  ANOP                                                           25200000
&CTR1    SETA  N'&STORAGE                                               25250000
         AGO   .PROSTOR                                                 25300000
.LISTREG ANOP                                                           25350000
         DC    A(0)                ADDRESS OF SNAP-SHOT LIST            25400000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 25450000
         AGO   .PROCSUB                                                 25500000
.PROCSUB ANOP                      PROCESS SUBPLST OPTION      @G860P1Y 25550000
         AIF   ('&B28' EQ '0').CONT8     WAS SUBPLST SPECIFIED @G860P1Y 25600000
         AIF   ('&SUBPLST'(1,1) EQ '(').SUBDC    LIST SUPPLIED @G860P1Y 25650000
         DC    A(&SUBPLST)         ADDRESS OF SUBPOOL LIST     @G860P1Y 25700000
         AGO   .CONT8              CHECK MACRO FORM            @G860P1Y 25750000
.SUBDC   ANOP                      SUBPLST NOT SPECIFIED       @G860P1Y 25800000
         DC    A(0)                ADDRESS OF SUBPOOL LIST     @G860P1Y 25850000
         AGO   .CONT8              CHECK MACRO FORM            @G860P1Y 25900000
.PROSTOR ANOP                                                           25950000
         AIF   ('&MVSE' EQ '0').NOMVSE4  HBB2102 PLIST         @G860P1Y 26000000
         DC    A(*+12)             ADDRESS OF SNAP-SHOT LIST   @G860P1Y 26050000
         AGO   .STHDR              CHECK FOR STORAGE HEADERS   @G860P1Y 26100000
.NOMVSE4 ANOP                      NOT HBB2102 PARMLIST        @G860P1Y 26150000
         DC    A(*+8)              ADDR OF SNAP-SHOT LIST      @G860P1Y 26200000
.STHDR   ANOP                      CHECK FOR STORAGE HEADERS   @G860P1Y 26250000
         AIF   ('&B23' EQ '0').NOSTRHD    STRHDR SPECIFIED      G33SPHW 26300000
         AIF   ('&MVSE' EQ '0').NOMVSE5  HBB2102 PLIST         @G860P1Y 26350000
&CTR3    SETA  N'&STORAGE+2        NUMBER OF STORAGE ADDRESSES @G860P1Y 26400000
         AGO   .SETCTR5             SET HEADER DISPLACEMENT    @G860P1Y 26450000
.NOMVSE5 ANOP                       NOT HBB2102 PLIST          @G860P1Y 26500000
&CTR3    SETA  N'&STORAGE+1        NUMBER OF STORAGE ADDRESSES @G860P1Y 26550000
.SETCTR5 ANOP                       SET HEADER DISPLACEMENT    @G860P1Y 26600000
&CTR5    SETA  &CTR3*4                  DISP. FOR HEADER        G33SPHW 26650000
         DC    A(*+&CTR5.)         ADDRESS OF HEADER LIST       G33SPHW 26700000
         AGO   .ARNDC                     AROUND DC             G33SPHW 26750000
.NOSTRHD ANOP                                                   G33SPHW 26800000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 26850000
.ARNDC   ANOP                                                           26900000
         AIF   ('&B28' EQ '0').SETCTR2   WAS SUBPLST SPECIFIED @G860P1Y 26950000
         AIF   ('&SUBPLST'(1,1) EQ '(').SUBPDC   LIST SUPPLIED @G860P1Y 27000000
         DC    A(&SUBPLST)         ADDRESS OF SUBPOOL LIST     @G860P1Y 27050000
         AGO   .SETCTR2            PROCESS STORAGE RANGES      @G860P1Y 27100000
.SUBPDC  ANOP                      SUBPLST NOT SPECIFIED       @G860P1Y 27150000
         DC    A(0)                ADDRESS OF SUBPOOL LIST     @G860P1Y 27200000
.SETCTR2 ANOP                      PROCESS STORAGE RANGES      @G860P1Y 27250000
&CTR2    SETA  0                                                        27300000
.LOOP3   ANOP                                                           27350000
&CTR2    SETA  &CTR2+1                                                  27400000
         AIF   ('&STORAGE(&CTR2)' EQ '').STYPE3                         27450000
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').STYPE2                   27500000
         AIF   ('&CTR2' EQ '&CTR1' AND '&MF' EQ 'L').LSTEND    @G860P33 27550000
         DC    A(&STORAGE(&CTR2))  STORAGE ADDRESS                      27600000
.STLIST  ANOP                                                  @G860P33 27650000
         AIF   ('&CTR2' NE '&CTR1').LOOP3                               27700000
         AIF   ('&B23' EQ '1').CKLFORM                          G33SPHW 27750000
         AGO   .CONT8                CHECK MACRO FORM          @G860P1Y 27800000
.LSTEND  ANOP                                                  @G860P33 27850000
         DC    A(&STORAGE(&CTR2)+X'80000000') END ADDRESS      @G860P33 27900000
         AGO   .STLIST                                         @G860P33 27950000
.CKLFORM ANOP                                                   G33SPHW 28000000
         AIF   ('&MF' NE 'L').ARND                              G33SPHW 28050000
         AIF   ('&STORAGE' EQ '').ARND                          G33SPHW 28100000
.ARND    ANOP                                                   G33SPHW 28150000
&CTR3    SETA  N'&STRHDR                                        G33SPHW 28200000
&CTRB    SETA  0                                                G33SPHW 28250000
.CKHDRLP ANOP                                                   G33SPHW 28300000
&CTRB    SETA  &CTRB+1                                          G33SPHW 28350000
         AIF   ('&STRHDR(&CTRB)' EQ '').HDADCON                 G33SPHW 28400000
         AIF   ('&STRHDR(&CTRB)'(1,1) EQ '(').NOTREG            G33SPHW 28450000
         AIF   ('&CTRB' EQ '&CTR3' AND '&MF' EQ 'L').HDREND    @G860P33 28500000
         DC    A(&STRHDR(&CTRB))   ADDRESS OF HEADER            G33SPHW 28550000
.MOREHDR ANOP                                                   G33SPHW 28600000
         AIF   ('&CTR3' NE '&CTRB').CKHDRLP                     G33SPHW 28650000
         AGO   .CONT8                CHECK MACRO FORM          @G860P1Y 28700000
.HDREND  ANOP                                                  @G860P33 28750000
         DC    A(&STRHDR(&CTRB)+X'80000000')  END ADDRESS      @G860P33 28800000
         AGO   .MOREHDR                                        @G860P33 28850000
.HDADCON ANOP                                                   G33SPHW 28900000
         DC   A(0)                ADDRESS OF HEADER             G33SPHW 28950000
         AGO  .MOREHDR                                          G33SPHW 29000000
.NOTREG  ANOP                                                   G33SPHW 29050000
         AIF   ('&MF' EQ 'L').MSGB REG FORMAT WITH MF=L         G33SPHW 29100000
         DC    A(0)               ADDRESS OF HEADER             G33SPHW 29150000
         AGO   .MOREHDR                                         G33SPHW 29200000
.STYPE1  ANOP                                                           29250000
         AIF   ('&CTR2' NE '&CTR1').LOOP3                               29300000
         AIF   ('&B23' EQ '1').CKLFORM                                  29350000
.CONT8   ANOP                      CONTINUE PROCESSING MACRO   @G860P1Y 29400000
         AIF   ('&MF' EQ 'L').EXIT                                      29450000
&GNAME   DS    0H                                                       29500000
         AIF   ('&B6' EQ '0').NOSTR0                                    29550000
         AIF   ('&ID'(1,1) NE '(').NOSTR0                               29600000
         STC   &ID,0(0,1)       GET ID NUMBER                    YM1995 29650000
.NOSTR0  ANOP                                                           29700000
         AIF   ('&B5' EQ '0').NOSTR1                                    29750000
         AGO   .STRLOOP                                                 29800000
.LHDRS   ANOP                                                   G33SPHW 29850000
         AIF  ('&B23' EQ '0').STRLOOP                           G33SPHW 29900000
&CTRB    SETA   0                                               G33SPHW 29950000
&CTR5    SETA   N'&STRHDR                                       G33SPHW 30000000
.LOOPHDR ANOP                                                   G33SPHW 30050000
&CTRB    SETA  &CTRB+1                                          G33SPHW 30100000
         AIF   ('&STRHDR(&CTRB)' EQ '').SKIPHD                  G33SPHW 30150000
         AIF   ('&STRHDR(&CTRB)'(1,1) EQ '(').CHKL              G33SPHW 30200000
         DC    A(&STRHDR(&CTRB))   ADDRESS OF HEADER            G33SPHW 30250000
.CHKEND  ANOP                                                   G33SPHW 30300000
         AIF   ('&CTRB' NE '&CTR5').LOOPHDR                     G33SPHW 30350000
         AIF   ('&MF' EQ 'L').EXIT                              G33SPHW 30400000
         DS   0H       ALLIGN ON WORD BDY                               30450000
         AGO  .STRLOOP                                          G33SPHW 30500000
.SKIPHD  ANOP                                                   G33SPHW 30550000
         DC   A(0)                 ADDRESS OF HEADER            G33SPHW 30600000
         AGO   .CHKEND                                          G33SPHW 30650000
.CHKL    ANOP                                                   G33SPHW 30700000
         AIF   ('&MF' EQ 'L').MSGB                              G33SPHW 30750000
         DC    A(0)                ADDRESS OF HEADER            G33SPHW 30800000
         AGO     .CHKEND                                        G33SPHW 30850000
.NOSTR   ANOP                                                           30900000
         AIF   ('&B28' EQ '0').CKTCB  SUBPLST= NOT SPECIFIED   @G860P1Y 30950000
         AIF   ('&SUBPLST'(1,1) EQ '(').REGSUB  REG FORM ADDR  @G860P1Y 31000000
         AIF   ('&MF' EQ '').CKTCB   STANDARD FORM OF MACRO    @G860P1Y 31050000
         LA    0,&SUBPLST          OBTAIN SUBPLST ADDRESS      @G860P1Y 31100000
         ST    0,24(0,1)           STORE ADDRESS IN PARMLIST   @G860P1Y 31150000
         AGO   .CKTCB              CHECK IF TCB ADDR SUPPLIED  @G860P1Y 31200000
.REGSUB  ANOP                      REGISTER SPECIFIED, USE IT  @G860P1Y 31250000
         ST    &SUBPLST,24(0,1)    STORE SUBPOOL LIST ADDRESS  @G860P1Y 31300000
.CKTCB   ANOP                      CHECK TCB ADDRESS           @G860P1Y 31350000
         AIF   ('&B1' EQ '0').CKDCB                                9943 31400000
         AIF   ('&TCB'(1,1) EQ '(').STRTCB                              31450000
         L     0,&TCB        GET TCB ADDRESS                            31500000
         ST    0,12(0,1)     STORE IN PARAMETER LIST             Y02705 31550000
         AGO   .CKDCB                                              9943 31600000
.NOSTR1  ANOP                                                           31650000
         AIF   ('&B16' EQ '0').NOSTR                                    31700000
         AIF   ('&LIST'(1,1) EQ '(').REGLIST                            31750000
         AIF   ('&MF' EQ '').CKLIST                                     31800000
         LA    0,&LIST       GET ADDRESS OF SNAPSHOT LIST               31850000
         ST    0,16(0,1)       STORE INTO PARAMETER LIST         Y02705 31900000
.CKLIST  ANOP                                                   G33SPHW 31950000
         AIF   ('&B23' EQ '0').NOSTR                            G33SPHW 32000000
         AIF   ('&STRHDR'(1,1) EQ '(').CHKHDR REG FORM ADDRESS  G33SPHW 32050000
         AIF   ('&MF' EQ '').NOSTR           STANDARD FORM      G33SPHW 32100000
         LA    0,&STRHDR       GET ADDRESS OF HEADER LIST       G33SPHW 32150000
         ST    0,20(0,1)       STORE HEADER ADDRESS             G33SPHW 32200000
         AGO   .NOSTR          RETURN                           G33SPHW 32250000
.CHKHDR  ANOP                                                   G33SPHW 32300000
         ST    &STRHDR,20(0,1) STORE INTO PARMLIST              G33SPHW 32350000
         AGO  .NOSTR                                                    32400000
.REGLIST ANOP                                                           32450000
         ST    &LIST,16(0,1)       STORE SNAPSHOT ADDR INTO PARM LIST   32500000
         AGO   .CKLIST                                                  32550000
.STYPE2  ANOP                                                           32600000
         AIF   ('&MF' EQ 'L').MSG4                                      32650000
         DC    A(0)                STARTING/ENDING ADDRESS              32700000
         AGO   .STYPE1                                                  32750000
.STYPE3  ANOP                                                           32800000
         AIF   ('&MF' EQ '').MSG4                                       32850000
         DC    A(0)                STARTING/ENDING ADDRESS              32900000
         AGO   .STYPE1                                                  32950000
.STRTCB  ANOP                                                           33000000
         ST    &TCB,12(0,1)        STORE ADDRESS OF TCB INTO PARM LIST  33050000
.CKDCB   AIF   ('&DCB'(1,1) NE '(').SVC51                          9943 33100000
.*                                                                 @P2D 33150000
         ST    &DCB,8(0,1)   STORE DCB ADDRESS INTO PARM LIST   G33SPHW 33200000
         MVI   8(1),0        CLEAR HIGH ORDER BYTE OF DCB ADR      @P2A 33225000
.SVC51   ANOP                                                           33250000
         SVC   51                                                       33300000
.EXIT    ANOP                                                           33350000
.EXIT1   ANOP                                                           33400000
         MEXIT                                                          33450000
.********************************************************************** 33500000
.*                                                                    * 33550000
.*      PROCESS THE LIST FORM                                         * 33600000
.*                                                            @G860P33* 33650000
.********************************************************************** 33700000
.LTYPE   ANOP                                                           33750000
         AIF   ('&TCB' NE '').MSG6                                 2607 33800000
         AIF   ('&SUBPLST' EQ '').CKSTOR  SUBPLST= NOT REQSTD  @G860P1Y 33850000
         AIF   ('&SUBPLST'(1,1) EQ '(').MSGB  REG FORMAT USED  @ZMC0817 33900000
.CKSTOR  ANOP                      CHECK IF STORAGE SPECIFIED  @G860P1Y 33950000
         AIF   ('&STORAGE' EQ '').LTYPE1                                34000000
         AIF   ('&STORAGE'(2,1) EQ '(').MSG4 NO STRHDR                  34050000
         AIF   ('&STRHDR' EQ '').SKIPL  ONE HEADER              G33SPHW 34100000
         AIF   (N'&STRHDR EQ 1).REGMFL  REG FORMAT W/MF=L       G33SPHW 34150000
         AIF   ('&STRHDR'(2,1) EQ '(').MSGB                     G33SPHW 34200000
.REGMFL  ANOP                                                   G33SPHW 34250000
.SKIPL   ANOP                                                   G33SPHW 34300000
         AGO   .LTYPE2                                                  34350000
.LTYPE1  ANOP                                                           34400000
         AIF   ('&LIST' EQ '').LTYPE2                                   34450000
         AIF   ('&LIST'(1,1) EQ '(').MSG4                               34500000
         AIF   ('&STRHDR' EQ '').SKIPM   NO STRHDR              G33SPHW 34550000
         AIF   ('&STRHDR'(1,1) EQ '(').MSGB REG FORMAT W/MF=L   G33SPHW 34600000
.SKIPM  ANOP                                                            34650000
.LTYPE2  ANOP                                                           34700000
&NAME    DS    0F                                                       34750000
         AGO   .LSTYPE                                                  34800000
.MSG1    IHBERMAC  6                                                    34850000
         MEXIT                                                          34900000
.MSG2    ANOP                                                           34950000
&B2      SETB  1                                                        35000000
&B3      SETB  0                                                        35050000
&B4      SETB  0                                                        35100000
&B7      SETB  0                                                        35150000
&B17     SETB  0                  NO SQA                         Y02705 35200000
&B18     SETB  0                  NO LSQA                        YO2705 35250000
&B19     SETB  0                  NO SWA                         Y02705 35300000
&B20     SETB  0                                                        35350000
&B21     SETB  0                                                        35400000
&B22     SETB  0                                                        35450000
         IHBERMAC  183,&SDATA,CB                                        35500000
         AGO   .CHKSTR                                                  35550000
.MSG4    IHBERMAC  189                                                  35600000
         MEXIT                                                          35650000
.MSG7   MNOTE 7,'STRHDR FORMAT INCORRECT'                       G33SPHW 35700000
        MEXIT                                                           35750000
.MSG8   MNOTE 7,'NUMBER OF STRHDR ADDRESSES EXCEED STORAGE RANGES'      35800000
        MEXIT                                                           35850000
.MSG9   MNOTE 7,'INVALID USE OF STRHDR NO STORAGE OR LIST SPECIFIED'    35900000
        MEXIT                                                           35950000
.MSGA   MNOTE 8,'LIST FORMAT NOT SPECIFIED ON STRHDR REQ. ON LIST'      36000000
        MEXIT                                                           36050000
.MSGB   MNOTE 8,'REGISTER FORMAT USED WITH MF=L'                G33SPHW 36100000
        MEXIT                                                           36150000
.MSGSUBP MNOTE 8,'SPLS AND SUBPLST SPECIFIED, MUTUALLY EXCLUSIVE'       36200000
.*                                                             @G860P1Y 36250000
         MEXIT                                                          36300000
.MSGNOTL MNOTE 8,'INVALID LIST ADDRESS FOR SUBPLST OPTION'     @G860P1Y 36350000
         MEXIT                                                          36400000
.MSG3    ANOP                                                           36450000
&B8      SETB  1                                                        36500000
&B9      SETB    0                                                      36550000
&B10     SETB  1                                                        36600000
&B11     SETB  1                                                        36650000
&B12     SETB  1                                                        36700000
&B13     SETB  1                                                        36750000
&B14     SETB  1                                                        36800000
&B15     SETB  1                         SUBTASKS OPTION       @G860P33 36850000
         IHBERMAC  183,&PDATA,ALL                                       36900000
         AGO   .SETFLAG                                                 36950000
.MSG5    IHBERMAC  35,,&MF                                              37000000
         MEXIT                                                          37050000
.MSG6    IHBERMAC   197                                            2607 37100000
         MEND                                                           37150000
