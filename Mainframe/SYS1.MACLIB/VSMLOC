*/********************************************************************/ 00050000
*/*                                                                  */ 00100000
*/* MACRO: VSMLOC                                                    */ 00150000
*/*01* PROPRIETARY STATEMENT=                                        */ 00166600
*/***PROPRIETARY_STATEMENT********************************************/ 00183200
*/*                                                                  */ 00200000
*/*                                                                  */ 00400000
*/* LICENSED MATERIALS - PROPERTY OF IBM                             */ 00420000
*/* THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      */ 00440000
*/* 5647-A01 (C) COPYRIGHT IBM CORP. 1981, 2000                      */ 00470000
*/*                                                                  */ 00500000
*/* STATUS= HBB7703                                                  */ 00512500
*/*                                                                  */ 00525000
*/***END_OF_PROPRIETARY_STATEMENT*************************************/ 00537500
*/* FUNCTION: INTERFACE TO VSMLOC ROUTINE (IGVSLOC)                  */ 00550000
*/*                                                                  */ 00560000
*/*01* EXTERNAL CLASSIFICATION: PI                                   */ 00575000
*/*01* END OF EXTERNAL CLASSIFICATION:                               */ 00590000
*/*                                                                  */ 00600000
*/* SYNTAX: VSMLOC SQA|CSA|LSQA|PVT|CPOOLFIX|CPOOLPAG|CPOOLLCL,      */ 00633300
*/*                AREA=(SYMBOL1,SYMBOL2)                            */ 00666600
*/*                <,LINKAGE=SYSTEM|BRANCH>                          */ 00700000
*/*                <,TCB=SYMBOL3>                                    */ 00725000
*/*                                                                  */ 00750000
*/*           SYMBOL1 = AREA ADDRESS (REGISTER 1-12: LR              */ 00800000
*/*                                   RX ADDRESS: LA)                */ 00850000
*/*                                                                  */ 00900000
*/*           SYMBOL2 = AREA LENGTH (REGISTER 0 2-12: LR             */ 00950000
*/*                                  SYMBOL: L                       */ 01000000
*/*                                  DECIMAL DIGIT: L OR LA)         */ 01050000
*/*                     ONLY REQUIRED WHEN SQA|CSA|LSQA|PVT          */ 01066600
*/*                     IS SPECIFIED                                 */ 01083200
*/*                                                                  */ 01100000
*/*           SYMBOL3 = CONTAINS TCB ADDRESS                         */ 01120000
*/*                     ONLY VALID WHEN SPECIFIED WITH PVT           */ 01140000
*/*                                                                  */ 01160000
*/*         VSMLOC (SQA|CSA|LSQA|PVT|CPOOLFIX|CPOOLPAG|CPOOLLCL)     */ 01180000
*/*                 AREA(VARIABLE1|(VARIABLE1),VARIABLE2)            */ 01200000
*/*                 <RTNCODE(VARIABLE3)> <OUTPUT(VARIABLE4)>         */ 01250000
*/*                 <LINKAGE(SYSTEM|BRANCH)>                         */ 01300000
*/*                 <TCB(VARIABLE5)>                                 */ 01325000
*/*                                                                  */ 01350000
*/*            VARIABLE1 = AREA | (AREA ADDRESS)                     */ 01400000
*/*                                                                  */ 01450000
*/*            VARIABLE2 = AREA LENGTH                               */ 01500000
*/*                        ONLY REQUIRED WHEN SQA|CSA|LSQA|PVT       */ 01516600
*/*                        IS SPECIFIED                              */ 01533200
*/*                                                                  */ 01550000
*/*            VARIABLE3 = CONTAINS THE RETURN CODE                  */ 01600000
*/*                                                                  */ 01650000
*/*            VARIABLE4 = CONTAINS THE OUTPUT                       */ 01700000
*/*                                                                  */ 01750000
*/*            VARIABLE5 = CONTAINS THE TCB ADDRESS                  */ 01762500
*/*                        ONLY VALID WHEN SPECIFIED WITH PVT        */ 01775000
*/*                                                                  */ 01787500
*/* NOTE: THE DEFAULT FOR THE LINKAGE OPERAND IS 'SYSTEM'            */ 01800000
*/*                                                                  */ 01850000
*/* MACROS: NONE                                                     */ 01900000
*/*                                                                  */ 01950000
*/* EXTERNAL MACRO VARIABLES : EHAREGS, EHAMAPS (PLS ONLY)           */ 02000000
*/*                                                                  */ 02050000
*/* CHANGE ACTIVITY: PCC0796 - WRONG CVT OFFSET FOR BRANCH ENTRY     */ 02100000
*/*                                                                  */ 02150000
*/*                  $L1=DCR0002, JBB2220, 840618, PDFT:             */ 02159300
*/*                      NEW PARAMETERS 'CPOOLFIX', 'CPOOLPAG',      */ 02168600
*/*                      'CPOOLLCL' ADDED INTO VSMLOC SERVICE.   @L1A*/ 02177900
*/*                                                                  */ 02187500
*/*                  $L2=DIV, JBB2220, 840618, PDFT:                 */ 02190000
*/*                      OBTAIN TCB ADDRESS BY SPECIFYING NEW        */ 02192500
*/*                      'TCB' KEYWORD WITH 'PVT'                @L2A*/ 02195000
*/*                                                                  */ 02197500
*/*                  $P1=PA20294, JBB2220, 850605, PDFT:             */ 02198100
*/*                      WRONG OFFSET FOR BRANCHING AROUND DATA  @P1A*/ 02198700
*/*                  $P2=PKB0212, HBB4430, 920617, PDXB: Flows       */ 02198900
*/*                      for STM...LM                                */ 02199100
*/* $P3=xxxxxxxx HBB6606 980115 PDXB: Make VSMLOC work for PLS       */ 02199200
*/* $L3=64BITVSM HBB7703 981204 PD00XB: ESAME                        */ 02199400
*/*                                                                  */ 02199600
*/********************************************************************/ 02200000
*/* A - 000000-999999                                        @G860P9T*/ 02250000
*  @EJECT;                                                              02300000
* %/*                                                                   02350000
         MACRO                                                          02400000
&LABEL   VSMLOC &TYPE,&TCB=,&AREA=,&LINKAGE=SYSTEM                 @L2C 02450000
         LCLC  &LINK,&ITYPE                                             02500000
         LCLC  &IBTCB,&ITCB                                        @L2A 02516600
         LCLC  &GNAME                                              @L1A 02533200
         LCLA  &ERROR                                                   02550000
.*                                                                      02600000
.*       CHECK VALIDITY OF MACRO OPERANDS                               02650000
.*                                                                      02700000
&GNAME   SETC 'IHB'.'&SYSNDX'                                      @L1A 02725000
&ERROR   SETA 0                                                         02750000
&IBTCB   SETC  '0'                      ASSUME TCB NOT SPECIFIED   @L2A 02775000
         AIF ('&TYPE(1)' NE '').TYPE  IF NO TYPE SPECIFIED              02800000
         MNOTE  12,'IHB313 STORAGE TYPE IS REQUIRED BUT IS NOT SUPPLIED+02850000
               . NO TEXT IS GENERATED.'                                 02900000
         AGO  .AREACK                                                   02950000
&ERROR   SETA 1                                                         03000000
.TYPE    ANOP                                                           03050000
         AIF (N'&TYPE LT 2).TYPE1   IF TOO MANY TYPE SUBFIELDS          03100000
         MNOTE 4,'IHB331 MACLIST &TYPE IS TOO LONG. ARGUMENTS ARE IGNOR+03150000
               ED AFTER &TYPE(1)..'                                     03200000
.TYPE1   ANOP                                                           03250000
         AIF (N'&SYSLIST LT 2).TYPE4   IF TOO MANY POSITIONAL OPERANDS  03300000
         MNOTE 4,'IHB331 MACLIST IS TOO LONG. ARGUMENTS ARE IGNORED AFT+03350000
               ER &SYSLIST(1)..'                                        03400000
.TYPE4   ANOP                                                           03450000
         AIF ('&TYPE(1)' NE 'SQA').NOTSQA IF SQA SPECIFIED              03500000
&ITYPE   SETC '0'                                                       03550000
         AGO  .AREACK                                                   03600000
.NOTSQA  ANOP                                                           03650000
         AIF ('&TYPE(1)' NE 'CSA').NOTCSA IF CSA SPECIFIED              03700000
&ITYPE   SETC '1'                                                       03750000
         AGO  .AREACK                                                   03800000
.NOTCSA  ANOP                                                           03850000
         AIF ('&TYPE(1)' NE 'LSQA').NOTLSQA IF LSQA SPECIFIED           03900000
&ITYPE   SETC '2'                                                       03950000
         AGO  .AREACK                                                   04000000
.NOTLSQA ANOP                                                           04050000
         AIF ('&TYPE(1)' NE 'PVT').NOTPVT IF PVT SPECIFIED              04100000
&ITYPE   SETC '3'                                                       04150000
         AGO  .AREACK                                                   04200000
.NOTPVT  ANOP                                                           04250000
         AIF ('&TYPE(1)' NE 'CPOOLFIX').NOTCPFIX                   @L1A 04259300
&ITYPE   SETC '4'                                                  @L1A 04268600
         AGO  .AREACP                                              @L1A 04277900
.NOTCPFIX ANOP                                                     @L1A 04287200
          AIF ('&TYPE(1)' NE 'CPOOLPAG').NOTCPPAG                  @L1A 04296500
&ITYPE   SETC '5'                                                  @L1A 04305800
         AGO  .AREACP                                              @L1A 04315100
.NOTCPPAG ANOP                                                     @L1A 04324400
          AIF ('&TYPE(1)' NE 'CPOOLLCL').NOTCPLCL                  @L1A 04333700
&ITYPE   SETC '6'                                                  @L1A 04343000
         AGO  .AREACP                                              @L1A 04352300
.NOTCPLCL ANOP                                                     @L1A 04361600
         MNOTE 12,'IHB343 STORAGE TYPE MUST BE SQA, CSA, LSQA, PVT, CPO+04370900
               OLFIX, CPOOLPAG, OR CPOOLLCL. NO TEXT IS GENERATED.'    +04380200
                                                                   @L1C 04389500
&ERROR   SETA 1                                                         04400000
.AREACK  ANOP                                                           04450000
         AIF ('&AREA(1)' NE '' AND '&AREA(2)' NE '').AREA               04500000
.*                                  IF AREA OR SUBFIELDS ARE MISSING    04550000
         MNOTE 12,'IHB313 AREA ADDRESS AND LENGTH IS REQUIRED BUT IS NO+04600000
               T SUPPLIED. NO TEXT IS GENERATED.'                       04650000
&ERROR   SETA 1                                                         04700000
         AGO  .AREAOK                                              @L1A 04725000
.AREA    ANOP                                                           04750000
         AIF (N'&AREA LT 3).AREA1   IF TOO MANY AREA SUBFIELDS     @L1C 04800000
         MNOTE 4,'IHB331 AREA=&AREA IS TOO LONG. ARGUMENTS ARE IGNORED +04850000
               AFTER &AREA(2)..'                                        04900000
.AREA1   ANOP                                                      @L1A 04903100
&IAREA   SETC  '&AREA(1)'                                          @L1A 04906200
         AGO  .AREAOK                                              @L1A 04909300
.AREACP  ANOP                                                      @L1A 04912400
         AIF ('&AREA(1)' NE '').AREACP1  IF AREA IS MISSING.       @L1A 04915500
         MNOTE 12,'IHB313 AREA ADDRESS IS REQUIRED BUT IS NOT SUPPLIED.+04918600
                NO TEXT IS GENERATED.'                             @L1A 04921700
&ERROR   SETA 1                                                    @L1A 04924800
         AGO  .AREAOK                                              @L1A 04927900
.AREACP1 ANOP                                                      @L1A 04931000
         AIF (N'&AREA LT 2).AREACP2 IF TOO MANY SUBFIELDS          @L1A 04934100
         MNOTE 12,'IHB313 AREA=&AREA IS TOO LONG. NO TEXT IS GENERATED.+04938000
                '                                                  @L1A 04940000
&ERROR   SETA 1                                                    @L1A 04942000
         AGO   .AREAOK                                             @L1A 04944000
.AREACP2 ANOP                                                      @L1A 04946000
&IAREA   SETC  '&AREA'            SAVE AREA SPECIFICATION          @L1A 04948000
.AREAOK  ANOP                                                           04950000
         AIF (N'&LINKAGE LT 2).LINKCK  IF TOO MANY LINKAGE SUBFIELDS    05000000
         MNOTE 4,'IHB331 LINKAGE=&LINKAGE IS TOO LONG. ARGUMENTS ARE IG+05050000
               NORED AFTER &LINKAGE(1)..'                               05100000
.LINKCK  ANOP                                                           05150000
&LINK    SETC  '&LINKAGE(1)'                                            05200000
         AIF ('&LINKAGE' EQ '').TCBCK   IF LINKAGE SPECIFIED       @L2C 05250000
         AIF ('&LINKAGE(1)' EQ 'SYSTEM' OR '&LINKAGE(1)' EQ            +05300000
               'BRANCH').TCBCK      IF INCORRECT LINKAGE SPECIFIED @L2C 05350000
         MNOTE 12,'IHB343 LINKAGE=&LINKAGE MUST BE SYSTEM OR BRANCH. NO+05400000
                TEXT IS GENERATED.'                                     05450000
&ERROR   SETA  1                                                        05458600
.TCBCK   ANOP                                                      @L2A 05467200
         AIF ('&TCB' EQ '').SEMEND  IF TCB NOT SPECIFIED           @L2A 05475800
         AIF (N'&TCB LT 2).TCB1   IF TOO MANY TCB SUBFIELDS        @L2A 05484400
         MNOTE 4,'IHB331 TCB=&TCB IS TOO LONG.  ARGUMENTS ARE IGNORED A+05493000
               FTER &TCB(1)..'                                     @L2A 05501600
&ITCB    SETC  '&TCB(1)'          SAVE TCB SPECIFICATION           @L2A 05510200
&IBTCB   SETC  '1'                TCB SPECIFIED                    @L2A 05518800
         AGO   .SEMAN                                              @L2A 05527400
.TCB1    ANOP                                                      @L2A 05536000
&ITCB    SETC  '&TCB'             SAVE TCB SPECIFICATION           @L2A 05544600
&IBTCB   SETC  '1'                TCB SPECIFIED                    @L2A 05553200
.******************************************************************@L2A 05561800
.*    SEMANTIC CHECK                                               @L2A 05570400
.*    . TCB CAN ONLY BE SPECIFIED WITH PVT                         @L2A 05579000
.******************************************************************@L2A 05587600
.SEMAN   ANOP                                                      @L2A 05596200
         AIF ('&TYPE(1)' EQ 'PVT').SEMEND                          @L2A 05604800
         MNOTE 12,'IHB343 TCB IS INVALID WITH SQA, CSA, LSQA, CPOOLFIX,+05613400
                CPOOLPAG, OR CPOOLLCL. NO TEXT IS GENERATED.'      @L2A 05622000
&ERROR   SETA 1                                                    @L2A 05630600
.******************************************************************     05639200
.*       GENERATE TEXT                                                  05650000
.******************************************************************     05683300
.SEMEND  ANOP                                                      @L1A 05716600
         AIF (&ERROR EQ 0).GENOK    IF ERROR OCCURRED                   05750000
         MEXIT                                                          05800000
.GENOK   ANOP                                                           05850000
         AIF ('&LABEL' EQ '').NOLABEL IF A LABEL SPECIFIED              05900000
&LABEL   DS  0H                                                         05950000
.NOLABEL ANOP                                                           06000000
         AIF ('&IAREA'(1,1) NE '(').NOTREGA IF AREA ADDRESS IS A        06025000
.*                                  REGISTER                       @L1C 06050000
&IAREA   SETC '&IAREA'(2,K'&IAREA-2) STRIP PARENTHESES             @L1A 06100000
         AIF ('&IAREA' EQ '1').GENLEN     IF AREA ADDRESS IS NOT       +06150000
                                    REGISTER 1                     @L1C 06200000
         LR  1,&IAREA               ADDRESS OF AREA                @L1C 06250000
         AGO .GENLEN                                                    06300000
.NOTREGA ANOP                                                           06350000
         LA  1,&IAREA               ADDRESS OF AREA                     06400000
.GENLEN  ANOP                                                           06450000
         AIF (&ITYPE GE 4).GENLINK                                 @L1A 06475000
         AIF ('&AREA(2)'(1,1) NE '(').NOTREGB IF AREA LENGTH IS A       06500000
.*                                  REGISTER                            06550000
         AIF ('&AREA(2,1)' EQ '0').GENLINK IF AREA LENGTH IS NOT        06600000
.*                                  REGISTER 0                          06650000
         LR  0,&AREA(2,1)           LENGTH OF AREA                      06700000
         AGO .GENLINK                                                   06750000
.NOTREGB ANOP                                                           06800000
         AIF (T'&AREA(2) NE 'N').ADCON IF LENGTH IS A SYMBOL OR         06850000
         AIF (&AREA(2) LE 4095).USELA  GREATER THAN 4095                06900000
.ADCON   ANOP                                                           06950000
         L   0,=A(&AREA(2))         LENGTH OF AREA                      07000000
         AGO .GENLINK                                                   07050000
.USELA   ANOP                                                           07100000
         LA  0,&AREA(2).(0,0)       LENGTH OF AREA                      07150000
.GENLINK ANOP                                                           07200000
         AIF ('&LINK' NE 'BRANCH').SYSLINK IF BRANCH SPECIFIED          07250000
         AIF ('&ITCB' EQ '').GENRG2      IF TCB NOT SPECIFIED      @L2A 07255000
         CNOP 0,4                   ALIGN DATA IN FULL WORD BNDY   @L1A 07260000
         B    *+8                   BRANCH PAST DATA               @P1A 07265000
&GNAME.F DC   AL1(&ITYPE)           POSITION STORAGE TYPE          @L1A 07270000
         DC   BL1'&IBTCB.0000000'   POSITION STORAGE FLAGS         @L2A 07275000
         DC   AL2(0)                RESERVED                       @L1A 07280000
         L    2,&GNAME.F            STORAGE TYPE                   @L1A 07285000
         AGO .TYPE2                                                @L1A 07290000
.GENRG2 ANOP                                                       @L1A 07295000
         LA  2,&ITYPE.(0,0)         STORAGE TYPE                        07300000
         AIF ('&ITYPE' EQ '0').TYPE2 IF TYPE IS NOT SQA                 07350000
         SLL 2,24                   POSITION STORAGE TYPE               07400000
.TYPE2   ANOP                                                           07450000
         L   15,16(,0)              OBTAIN CVT ADDRESS                  07500000
         L   15,1148(,15)           VSMLOC ENTRY ADDRESS   @ZMC0796     07550000
         BASSM 14,15                BRANCH TO VSMLOC ROUTINE            07600000
         AIF ('&ITCB' NE '').SAVETCB  IF TCB  SPECIFIED            @L2A 07625000
         MEXIT                                                          07650000
.SYSLINK ANOP                                                           07700000
         ESAR 15                    GET SECONDARY ASN                   07716600
         STM  15,12,16(13)          SAVE REGISTERS                      07733200
         AIF ('&ITCB' EQ '').GENRG15    IF TCB NOT SPECIFIED       @L2A 07734800
         CNOP 0,4                   ALIGN DATA IN FULL WORD BNDY   @L1A 07736400
         B    *+8                   BRANCH AROUND DATA             @P1A 07738000
&GNAME.F DC   AL1(&ITYPE)           POSITION STORAGE TYPE          @L1A 07739600
         DC   BL1'&IBTCB.0000000'   POSITION STORAGE FLAGS         @L2A 07741200
         DC   AL2(0)                RESERVED                       @L1A 07742800
         L    15,&GNAME.F           STORAGE TYPE                   @L1A 07744400
         AGO .TYPE3                                                @L1A 07746000
.GENRG15 ANOP                                                      @L1A 07747600
         LA  15,&ITYPE.(0,0)        STORAGE TYPE                        07750000
         AIF ('&ITYPE' EQ '0').TYPE3 IF TYPE IS NOT SQA                 07800000
         SLL 15,24                  POSITION STORAGE TYPE               07850000
.TYPE3   ANOP                                                           07900000
         L    2,16(0,0)             OBTAIN CVT ADDRESS                  08000000
         L    2,772(,2)             ADDRESS OF SYSTEM LINKAGE TABLE     08050000
         L    2,92(,2)              OBTAIN PC NUMBER                    08100000
         PC   0(2)                  PC TO VSMLOC ROUTINE                08150000
         L    2,16(13)              RESTORE SECONDARY ASN               08166600
         SSAR 2                     RESTORE SECONDARY ASN               08183200
         LM   2,12,28(13)           RESTORE REGISTERS                   08200000
         AIF ('&ITCB' EQ '').MMEND      IF TCB NOT SPECIFIED       @L2A 08209000
.SAVETCB ANOP                                                      @L2A 08218000
         AIF ('&ITCB'(1,1) NE '(').NOTREG     NOT REGISTER         @L2A 08227000
&ITCB    SETC '&ITCB'(2,K'&ITCB-2)    STRIP PARENTHESES            @L2A 08236000
         AIF ('&ITCB' EQ '1').ISREG1     NOT REGISTER              @L2A 08245000
         LR  &ITCB,1                SAVE TCB ADDRESS               @L2A 08254000
.ISREG1  ANOP                                                      @L1A 08263000
         MEXIT                                                     @L1A 08272000
.NOTREG  ST   1,&ITCB               OBTAIN TCB ADDRESS             @L2A 08281000
.MMEND   MEND                                                      @L1C 08290000
* */                                                                    08300000
*  @EJECT;                                                              08350000
* VSMLOC:                                                               08400000
*  MACRO KEYS(TCB,AREA,RTNCODE,LINKAGE,OUTPUT,PLX);  /*        931119*/ 08450000
*                                                                       08500000
*  DCL                                                                  08550000
*                                                                       08600000
*    EHAMAPS CHAR EXTERNAL,         /* INTERFACE TO EPILOG MACRO     */ 08650000
*    EHAREGS CHAR EXTERNAL,         /* INTERFACE TO EPILOG MACRO     */ 08700000
*    ERROR FIXED,                   /* MACRO ISSUED ERROR MESSAGES   */ 08750000
*    IREGS CHAR,                    /* RESTRICTS REGISTER 15         */ 08800000
*    IRTNCODE CHAR,                 /* INTERNAL RTNCODE VALUE        */ 08850000
*    ITYPE CHAR,                    /* INTERNAL STORAGE TYPE         */ 08900000
*    IADDR CHAR,                    /* INTERNAL AREA ADDRESS         */ 08950000
*    IBTCB CHAR,                    /* INTERNAL TCB BIT          @L2A*/ 08960000
*    IFLAG FIXED,                   /* INTERNAL FLAG             @L1A*/ 08970000
*    IFLAGSTR CHAR,                 /* INT FLAG OUTPUT STRING    @L1A*/ 08980000
*    ITYPESTR CHAR,                 /* INT TYPE OUTPUT STRING    @L1A*/ 08990000
*    ILEN  CHAR,                    /* INTERNAL AREA ADDRESS         */ 09000000
*    ILINK CHAR,                    /* INTERNAL LINKAGE              */ 09050000
*    ITCB  CHAR,                    /* INTERNAL TCB              @L2A*/ 09075000
*    WARN  FIXED;                   /* MACRO ISSUED WARNING MESSAGES */ 09100000
*                                                                       09150000
*  /******************************************************************/ 09200000
*  /*                                                                */ 09250000
*  /* INITIALIZE VARIABLES                                           */ 09300000
*  /*                                                                */ 09350000
*  /******************************************************************/ 09400000
*                                                                       09450000
*  ERROR=0;                         /* ASSUME NO ERRORS              */ 09500000
*  WARN=0;                          /* ASSUME NO WARNINGS            */ 09550000
*  IREGS='';                        /* DON'T RESTRICT ANY REGISTERS  */ 09600000
*  IFLAG=0;                         /* ASSUME NO FLAGS           @L1A*/ 09616600
*  IBTCB='0';                       /* INDICATE TCB NOT SPECIFIED @L2A*/09633200
*                                                                       09650000
*  @EJECT;                                                              09700000
*                                                                       09750000
*  /******************************************************************/ 09800000
*  /*                                                                */ 09850000
*  /* CHECK VALIDITY OF MACRO OPERANDS AND OBTAIN VALUES             */ 09900000
*  /*                                                                */ 09950000
*  /******************************************************************/ 10000000
*                                                                       10050000
*  IF MACLIST(1) = '' THEN          /* IF STORAGE TYPE NOT SPECIFIED */ 10100000
*    DO;                                                                10150000
*      ERROR=1;                     /* INDICATE ERROR MESSAGE        */ 10200000
*      ANS MSG('AHA0013 STORAGE TYPE IS REQUIRED BUT IS NOT SUPPLIED.'  10250000
*              || ' NO TEXT IS GENERATED.') NORESCAN;                   10300000
*    END;                                                               10350000
*  ELSE                             /* STORAGE TYPE SPECIFIED        */ 10400000
*    DO;                                                                10450000
*      IF NUMBER(MACLIST) > 1 THEN  /* IF TOO MANY POSITIONALS       */ 10500000
*        DO;                                                            10550000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 10600000
*          ANS MSG('AHA0031 '||MACLIST||' IS TOO LONG. ARGUMENTS ' ||   10650000
*                  'ARE IGNORED AFTER '||MACLIST(1)||'.') NORESCAN;     10700000
*        END;                                                           10750000
*      IF MACLIST(1) = 'SQA' THEN   /* IF SQA SPECIFIED              */ 10800000
*        ITYPE='0';                 /* INDICATE SQA STORAGE          */ 10850000
*      ELSE                                                             10900000
*        IF MACLIST(1) = 'CSA' THEN /* IF CSA SPECIFIED              */ 10950000
*          ITYPE='1';               /* INDICATE CSA STORAGE          */ 11000000
*        ELSE                                                           11050000
*          IF MACLIST(1) = 'LSQA' THEN /* IF LSQA SPECIFIED          */ 11100000
*            ITYPE='2';             /* INDICATE LSQA STORAGE         */ 11150000
*          ELSE                                                         11200000
*            IF MACLIST(1) = 'PVT' THEN /* IF PVT SPECIFIED          */ 11250000
*              ITYPE='3';           /* INDICATE PVT STORAGE          */ 11300000
*            ELSE                   /* IF CPOOL-FIX|PAG|LCL      @L1A*/ 11316600
*              IF MACLIST(1) = 'CPOOLFIX' THEN /* IF CPOOLFIX SPECIFIED 11333200
*                                                                @L1A*/ 11349800
*                ITYPE='4';         /* INDICATE CPOOL GLB FIX    @L1A*/ 11366400
*              ELSE                 /* NOT CPOOLFIX              @L1A*/ 11383000
*                IF MACLIST(1) = 'CPOOLPAG' THEN /* IF CPOOLPAG         11399600
*                                      SPECIFIED                 @L1A*/ 11416200
*                  ITYPE='5';       /* INDICATE CPOOL GLB PAGEABLE      11432800
*                                                                @L1A*/ 11449400
*                ELSE               /* NOT CPOOLPAG              @L1A*/ 11466000
*                  IF MACLIST(1) = 'CPOOLLCL' THEN /* IF CPOOLLCL       11482600
*                                      SPECIFIED                 @L1A*/ 11499200
*                    ITYPE='6';     /* INDICATE CPOOL LOCAL      @L1A*/ 11515800
*                  ELSE             /* INCORRECT STORAGE TYPE        */ 11532400
*                    DO;                                                11549000
*                      ERROR=1;     /* INDICATE ERROR MESSAGE        */ 11565600
*                      ANS MSG('AHA0043 STORAGE TYPE MUST BE SQA, CSA,' 11582200
*                      || ' LSQA, PVT, CPOOLFIX, CPOOLPAG OR CPOOLLCL.' 11598800
*                      || ' NO TEXT IS GENERATED.') NORESCAN;/*  @L1C*/ 11615400
*                    END;                                               11632000
*    END;                                                               11650000
*                                                                       11700000
*  IF TCB ^= '' THEN                /* IF TCB SPECIFIED          @L2A*/ 11702100
*    DO;                            /* PROCESS TCB KEYWORD       @L2A*/ 11704200
*      IF NUMBER(TCB) > 1 THEN      /* IF MORE THAN ONE SUBFIELD @L2A*/ 11706300
*        DO;                        /* PROCESS TCB SUBFIELD      @L2A*/ 11708400
*          WARN=1;                  /* INDICATE WARNING MESSAGE  @L2A*/ 11710500
*          ANS MSG('AHA0031 TCB'||TCB||' IS TOO LONG. ' ||              11712600
*                  'ARGUMENTS ARE IGNORED AFTER '||TCB(1)||'.')         11714700
*                  NORESCAN;        /* WARNING MESSAGE           @L2A*/ 11716800
*        END;                       /* PROCESS TCB SUBFIELD      @L2A*/ 11718900
*      IF TCB = 'TCB'       THEN    /* MISSING TCB SUBFIELD      @L2A*/ 11721000
*        DO;                        /* PROCESS TCB SUBFIELD      @L2A*/ 11723100
*          WARN=1;                  /* INDICATE WARNING MESSAGE  @L2A*/ 11725200
*          ANS MSG('AHA0061 TCB SUBFIELD IS NOT SPECIFIED BUT MAY ' ||  11727300
*              'BE REQUIRED.') NORESCAN;/*                       @L2A*/ 11729400
*        END;                       /* PROCESS TCB SUBFIELD      @L2A*/ 11731500
*      IBTCB = '1' ;                /* SET BIT INDICATES TCB WAS        11733600
*                                      SPECIFIED                 @L2A*/ 11735700
*      ITCB=TCB(1);                 /* OBTAIN TCB SUBFIELD       @L2A*/ 11737800
*    END;                           /* PROCESS TCB KEYWORD       @L2A*/ 11739900
*                                                                       11742000
*  IF ITYPE < '4' THEN              /* IF NOT CPOOL TYPE         @L1A*/ 11744100
*    DO;                            /* PROCESS TYPE < 4          @L1A */11746200
*  IF AREA(1) = '' | AREA(2) = '' THEN  /* IF AREA AND TWO SUBFIELDS    11750000
*                                      ARE NOT SPECIFIED             */ 11800000
*    DO;                                                                11850000
*      ERROR=1;                     /* INDICATE ERROR MESSAGE        */ 11900000
*      ANS MSG('AHA0013 AREA ADDRESS AND LENGTH IS REQUIRED BUT IS ' || 11950000
*              'NOT SUPPLIED. NO TEXT IS GENERATED.') NORESCAN;         12000000
*    END;                                                               12050000
*  ELSE                             /* AREA AND TWO SUBFIELDS           12100000
*                                      SPECIFIED                     */ 12150000
*    DO;                                                                12200000
*      IF NUMBER(AREA) > 2 THEN     /* IF TOO MANY SUBFIELDS            12250000
*                                      SPECIFIED                     */ 12300000
*        DO;                                                            12350000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 12400000
*          ANS MSG('AHA0031 AREA'||AREA||' IS TOO LONG. ARGUMENTS '||   12450000
*                  'ARE IGNORED AFTER '||AREA(2)||'.') NORESCAN;        12500000
*        END;                                                           12550000
*      IF AREA(1,1:1) = '(' &                                           12600000
*         AREA(1,LENGTH(AREA(1)):LENGTH(AREA(1))) = ')' THEN /*         12650000
*                                      IF AREA ADDRESS               */ 12700000
*        IADDR=AREA(1,1);           /* OBTAIN AREA ADDRESS           */ 12750000
*      ELSE                                                             12800000
*        IADDR='ADDR('||AREA(1)||')'; /* OBTAIN AREA VALUE           */ 12850000
*      ILEN=AREA(2);                /* OBTAIN AREA LENGTH            */ 12900000
*    END;                                                               12903300
*  END;                             /* PROCESS TYPE < 4          @L1A*/ 12906600
*    ELSE                           /* CPOOL TYPE                @L1A*/ 12909900
*      DO;                          /* PROCESS CPOOL ADDR        @L1A*/ 12913200
*        IF AREA(1) = ''  THEN      /* IF ADDR NOT SPECIFIED     @L1A*/ 12916500
*          DO;                      /* PROCESS ERROR             @L1A*/ 12919800
*            ERROR = 1;             /* INDICATE ERROR MESSAGE    @L1A*/ 12923100
*            ANS MSG('AHA0013 AREA ADDRESS IS REQUIRED BUT IS NOT ' ||  12926400
*                  'SUPPLIED. NO TEXT IS GENERATED.') NORESCAN;/*       12929700
*                                                                @L1A*/ 12933000
*          END;                     /* PROCESS ERROR             @L1A*/ 12936300
*        ELSE;                      /* ADDR IS SPECIFIED         @L1A*/ 12939600
*          DO;                      /* PROCESS ADDR              @L1A*/ 12942900
*            IF NUMBER(AREA) > 1 THEN /* TOO MANY SUBFIELDS             12946200
*                                        SPECIFIED               @L1A*/ 12949500
*              DO;                  /* PROCESS ERROR             @L1A*/ 12952800
*                ERROR=1;           /* INDICATE ERROR MESSAGE    @L1A*/ 12956100
*                ANS MSG('AHA0013 AREA'||AREA||' IS TOO LONG.' ||       12959400
*                'NO TEXT IS GENERATED.') NORESCAN;/*            @L1A*/ 12962700
*              END;                 /* PROCESS ERROR             @L1A*/ 12966000
*            ELSE                   /* PROCESS AREA ADDR         @L1A*/ 12969300
*               IF AREA(1:1) = '(' &                                    12972600
*                  AREA(LENGTH(AREA):LENGTH(AREA)) = ')' THEN /*        12975900
*                                               IF AREA ADDRESS  @L1A*/ 12978600
*                 IADDR=AREA(1,1);  /* OBTAIN AREA ADDRESS       @L1A*/ 12981300
*               ELSE                /*                           @L1A*/ 12984000
*                 IADDR='ADDR('||AREA||')';    /* OBTAIN AREA VALUE     12986700
*                                                                @L1A*/ 12989400
*          END;                     /* PROCESS ADDR              @L1A*/ 12992400
*      END;                         /* PROCESS CPOOL ADDR        @L1A*/ 12995700
*                                                                       13000000
*  IF LINKAGE = '' THEN             /* IF LINKAGE NOT SPECIFIED      */ 13050000
*    ILINK='PC';                    /* INDICATE PC LINKAGE           */ 13100000
*  ELSE                             /* LINKAGE SPECIFIED             */ 13150000
*    DO;                                                                13200000
*      IF NUMBER(LINKAGE) > 1 THEN  /* IF TOO MANY SUBFIELDS            13250000
*                                      SPECIFIED                     */ 13300000
*        DO;                                                            13350000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 13400000
*          ANS MSG('AHA0031 LINKAGE'||LINKAGE||' IS TOO LONG. ' ||      13450000
*                  'ARGUMENTS ARE IGNORED AFTER '||LINKAGE(1)||         13500000
*                  '.') NORESCAN;                                       13550000
*        END;                                                           13600000
*      IF LINKAGE(1) = 'SYSTEM' THEN /* IF SYSTEM SPECIFIED          */ 13650000
*        ILINK='PC';                /* INDICATE PC LINKAGE           */ 13700000
*      ELSE                                                             13750000
*        IF LINKAGE(1) = 'BRANCH' THEN /* IF BRANCH SPECIFIED        */ 13800000
*          ILINK='BASSM';           /* INDICATE BASSM LINKAGE        */ 13850000
*        ELSE                       /* INCORRECT LINKAGE SPECIFIED   */ 13900000
*          DO;                                                          13950000
*            ILINK='PC';            /* INDICATE PC LINKAGE           */ 14000000
*            IF LINKAGE(1) = '' THEN /* IF NO SUBFIELDS              */ 14050000
*              DO;                                                      14100000
*                WARN=1;            /* INDICATE WARNING MESSAGE      */ 14150000
*               ANS MSG('AHA0061 LINKAGE TYPE IS NOT SPECIFIED BUT ' || 14200000
*                    'MAY BE REQUIRED.') NORESCAN;                      14250000
*              END;                                                     14300000
*            ELSE                   /* A SUBFIELD WAS SPECIFIED      */ 14350000
*              DO;                                                      14400000
*                ERROR=1;           /* INDICATE ERROR MESSAGE        */ 14450000
*                ANS MSG('AHA0043 LINKAGE'||LINKAGE||' MUST BE SYSTEM ' 14500000
*                    ||'OR BRANCH. NO TEXT IS GENERATED.') NORESCAN;    14550000
*              END;                                                     14600000
*          END;                                                         14650000
*    END;                                                               14700000
*                                                                       14750000
*  IF RTNCODE(1) ^= '' THEN         /* IF RTNCODE OPERAND AND SUBFIELD  14800000
*                                       SPECIFIED                    */ 14850000
*    DO;                                                                14900000
*      IRTNCODE=RTNCODE(1);         /* OBTAIN RTNCODE VALUE          */ 14950000
*      IREGS=IREGS||',GPR15F';      /* NEED TO RESTRICT REGISTER 15  */ 15000000
*      IF NUMBER(RTNCODE) > 1 THEN  /* IF MORE THAN ONE SUBFIELD     */ 15050000
*        DO;                                                            15100000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 15150000
*          ANS MSG('AHA0031 RTNCODE'||RTNCODE||' IS TOO LONG. ' ||      15200000
*                  'ARGUMENTS ARE IGNORED AFTER '||RTNCODE(1)||'.')     15250000
*                  NORESCAN;                                            15300000
*        END;                                                           15350000
*    END;                                                               15400000
*  ELSE                             /* RTNCODE SUBFIELD NOT             15450000
*                                      SPECIFIED                     */ 15500000
*    IF RTNCODE ^= '' THEN          /* IF RTNCODE OPERAND SPECIFIED  */ 15550000
*      DO;                                                              15600000
*        WARN=1;                    /* INDICATE WARNING MESSAGE      */ 15650000
*        ANS MSG('AHA0061 RTNCODE VARIABLE IS NOT SPECIFIED BUT MAY' || 15700000
*                'BE REQUIRED.') NORESCAN;                              15750000
*      END;                                                             15800000
*                                                                       15850000
*  IF OUTPUT(1) ^= '' THEN          /* IF OUTPUT OPERAND AND SUBFIELD   15900000
*                                       SPECIFIED                    */ 15950000
*    DO;                                                                16000000
*      IOUT=OUTPUT(1);              /* OBTAIN OUTPUT VALUE           */ 16050000
*      IF NUMBER(OUTPUT) > 1 THEN   /* IF MORE THAN ONE SUBFIELD     */ 16100000
*        DO;                                                            16150000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 16200000
*          ANS MSG('AHA0031 OUTPUT'||OUTPUT||' IS TOO LONG. ' ||        16250000
*                  'ARGUMENTS ARE IGNORED AFTER '||OUTPUT(1)||'.')      16300000
*                  NORESCAN;                                            16350000
*        END;                                                           16400000
*    END;                                                               16450000
*  ELSE                             /* OUTPUT SUBFIELD NOT              16500000
*                                      SPECIFIED                     */ 16550000
*    IF OUTPUT ^= '' THEN           /* IF OUTPUT OPERAND SPECIFIED   */ 16600000
*      DO;                                                              16650000
*        WARN=1;                    /* INDICATE WARNING MESSAGE      */ 16700000
*        ANS MSG('AHA0061 OUTPUT VARIABLE IS NOT SPECIFIED BUT MAY ' || 16750000
*                'BE REQUIRED.') NORESCAN;                              16800000
*      END;                                                             16850000
*                                                                       16900000
*  IF ILINK='BASSM' THEN            /* IF BRANCH LINKAGE             */ 16950000
*    IREGS=IREGS||',GPR02F';        /* RESTRICT REGISTERS 2 AND 15   */ 17000000
*  ELSE                             /* PC LINKAGE                    */ 17050000
*    DO;                                                                17100000
*      IREGS=IREGS||',GPR02P';      /* RESTRICT REGISTER 2           */ 17150000
*      IF IRTNCODE='' THEN          /* IF REGISTER 15 NOT ALREADY       17200000
*                                      RESTRICTED                    */ 17250000
*        IREGS=IREGS||',GPR15F';    /* RESTRICT IT                   */ 17300000
*    END;                                                               17350000
*                                                                       17400000
*  /******************************************************************/ 17401700
*  /*                                                                */ 17403400
*  /* CONSISTENCY CHECK SUPPLIED PARAMETERS. SEARCH FOR DISALLOWED   */ 17405100
*  /* COMBINATIONS.                                                  */ 17406800
*  /*                                                                */ 17408500
*  /*************************************************************@L1A*/ 17410200
*                                                                       17411900
*  IF (IBTCB = '1')                 /* IF TCB WAS SPECIFIED      @L2A*/ 17413600
*    &(ITYPE ^= '3') THEN           /* AND STOR TYPE IS NOT PVT  @L2A*/ 17415300
*    DO;                            /* PROCESS ERROR             @L2A*/ 17417000
*      ERROR=1;                     /* INDICATE ERROR MESSAGE    @L2A*/ 17418700
*      ANS MSG('AHA0051 TCB ONLY VALID WITH PVT. '                      17420400
*                 ||'NO TEXT IS GENERATED.') NORESCAN;/*         @L2A*/ 17422100
*    END;                           /* PROCESS ERROR             @L2A*/ 17423800
*                                                                       17425500
*  /******************************************************************/ 17427200
*  /*                                                                */ 17428900
*  /* GENERATE STORAGE FORM REQUEST TYPE, AND TCB FLAGS.             */ 17430600
*  /*                                                                */ 17432300
*  /*************************************************************@L1A*/ 17434000
*                                                                       17435700
*  IF IBTCB = '1' THEN              /* IF TCB WAS SPECIFIED      @L2A*/ 17437400
*    IFLAG=IFLAG+128;               /* SET FLAG FIELD            @L2A*/ 17439100
*  IFLAGSTR= '+((' || CHAR(IFLAG) || ')*65536)'; /* SET FLAG OUTPUT     17440800
*                                      STRING                    @L1A*/ 17442500
*  ITYPESTR= '((' || ITYPE || ')*16777216)'; /* SET TYPE OUTPUT         17444200
*                                      STRING                    @L1A*/ 17445900
*                                                                       17447600
*  @EJECT;                                                              17450000
*                                                                       17500000
*  /******************************************************************/ 17550000
*  /*                                                                */ 17600000
*  /* GENERATE TEXT                                                  */ 17650000
*  /*                                                                */ 17700000
*  /******************************************************************/ 17750000
*                                                                       17800000
*  ANS (MACLABEL) COL(MACLMAR) NORESCAN;                                17850000
*  ANS ('DO; /* '||MACNAME||' '||MACLIST||' '||MACKEYS||' */')          17900000
*      COL(MACCOL) NORESCAN;                                            17950000
*  IF ERROR = 0 THEN                /* IF NO ERROR MESSAGES          */ 18000000
*    DO;                                                                18050000
*      IF INDEX(EHAMAPS,'XM@') = 0 THEN                                 18100000
*        EHAMAPS=EHAMAPS||'XM@';                                        18150000
*      IF INDEX(EHAREGS,'00F') = 0 THEN                                 18200000
*        EHAREGS=EHAREGS||'00F';                                        18250000
*      IF INDEX(EHAREGS,'01P') = 0 THEN                                 18300000
*        EHAREGS=EHAREGS||'01P';                                        18350000
*      ANS('RFY (GPR00F,GPR01P'||IREGS||') RSTD;')                      18400000
*         COL(MACCOL+2) NORESCAN;                                       18450000
*      ANS('GPR01P='||IADDR||'; /* ADDRESS OF AREA */')                 18500000
*         COL(MACCOL+2) NORESCAN;                                       18550000
*      IF ITYPE < '4' THEN          /* IF CPOOL WAS SPECIFIED    @L1A*/ 18575000
*      ANS('GPR00F='||ILEN||'; /* LENGTH OF AREA */')                   18600000
*         COL(MACCOL+2) NORESCAN;                                       18650000
*      IF ILINK='BASSM' THEN        /* IF BRANCH ENTRY LINKAGE       */ 18700000
*        DO;                                                            18750000
*          IF INDEX(EHAREGS,'02F') = 0 THEN                             18800000
*            EHAREGS=EHAREGS||'02F';                                    18850000
*          IF IBTCB='1' THEN        /* IF TCB WAS SPECIFIED      @L2A*/ 18871400
*           ANS('GPR02F='||ITYPESTR||IFLAGSTR || '; /* STORAGE TYPE */')18892800
*             COL(MACCOL+2) NORESCAN; /*                         @L2A*/ 18914200
*          ELSE                     /* TCB NOT SPECIFIED         @L1A*/ 18935600
*            ANS('GPR02F=' || ITYPESTR || '; /* STORAGE TYPE */')       18957000
*             COL(MACCOL+2) NORESCAN; /*                         @L1C*/ 18978400
*          ANS('CALL ((XM@CVT+1148)->I031P)->IPDEF; '||                 19000000
*             '/* INVOKE VSMLOC ROUTINE */')                            19050000
*             COL(MACCOL+2) NORESCAN;  /*                    @ZMC0796*/ 19100000
*        END;                                                           19150000
*      ELSE                         /* IF PC LINKAGE                 */ 19200000
*        DO;                                                            19250000
*          IF INDEX(EHAREGS,'02P') = 0 THEN                             19300000
*            EHAREGS=EHAREGS||'02P';                                    19350000
*          IF INDEX(EHAREGS,'13P') = 0 THEN                             19400000
*            EHAREGS=EHAREGS||'13P';                                    19450000
*          IF INDEX(EHAREGS,'15F') = 0 THEN                             19500000
*            EHAREGS=EHAREGS||'15F';                                    19550000
*          ANS('GEN CODE(ESAR  15);  /* SECONDARY ASN */')              19558300
*             COL(MACCOL+2) NORESCAN;                                   19566600
*          IF PLX = '' | PLX(1) = 'NO' THEN       /*           931119*/ 19567500
*          DO;                                    /*           931119*/ 19568400
*          /* The GEN FLOWS will enable the compiler to understand      19569300
*             that when it gets to the target, it has the same          19572000
*             register contents as at the time of this STM       @P2A*/ 19574700
*          ANS('GEN FLOWS(VL' || MACINDEX || 'A)' ||                    19577400
*                 ' CODE(STM   15,12,16(GPR13P)); '||                   19580100
*             '/* SAVE REGISTERS */')                                   19583200
*             COL(MACCOL+2) NORESCAN;       /*                   @P2C*/ 19591500
*          IF IBTCB='1' THEN        /* IF TCB WAS SPECIFIED      @L2A*/ 19628400
*           ANS('GPR15F='||ITYPESTR||IFLAGSTR || '; /* STORAGE TYPE */')19665300
*             COL(MACCOL+2) NORESCAN; /*                         @L2A*/ 19702200
*          ELSE                     /* TCB NOT SPECIFIED         @L1A*/ 19739100
*            ANS('GPR15F=' || ITYPESTR || '; /* STORAGE TYPE */')       19776000
*             COL(MACCOL+2) NORESCAN; /*                         @L1C*/ 19812900
*          ANS('GPR02P=XM@(24); '||                                     19850000
*             '/* OBTAIN PC NUMBER */')                                 19900000
*             COL(MACCOL+2) NORESCAN;                                   19950000
*          ANS('PC(GPR02P); '||                                         20000000
*             '/* PC TO VSMLOC ROUTINE */')                             20050000
*             COL(MACCOL+2) NORESCAN;                                   20100000
*          ANS('GEN CODE(L    2,16(GPR13P));' ||                        20107100
*             '/* RESTORE SECONDARY ASN */')                            20114200
*             COL(MACCOL+2) NORESCAN;                                   20121300
*          ANS('GEN CODE(SSAR 2);' ||                                   20128400
*             '/* RESTORE SECONDARY ASN */')                            20135500
*             COL(MACCOL+2) NORESCAN;                                   20142600
*          ANS('GEN CODE(LM   2,12,28(GPR13P)); '||                     20150000
*             '/* RESTORE REGISTERS */')                                20200000
*             COL(MACCOL+2) NORESCAN;                                   20250000
*          ANS('VL' || MACINDEX || 'A:;'||                              20262500
*             '/* FLOWS LABEL FOR OPTIMIZATION */')                     20275000
*             COL(MACCOL+2) NORESCAN;        /*                  @P2A*/ 20287500
*          END;                                   /*           931119*/ 20287700
*          ELSE DO;                               /* PL/X      931119*/ 20287900
*            IF INDEX(EHAREGS,'14F') = 0 THEN                           20288100
*              EHAREGS=EHAREGS||'14F';                                  20288300
*            VSMLOCSTRING = 'VSMLOC_' || MACINDEX;  /*         931119*/ 20288500
*          STORTYPESTRING = 'STORAGETYPE_' || MACINDEX;   /*     @P3C*/ 20288700
*          ANS('DCL ' || STORTYPESTRING || ' REG(*);')                  20288900
*             COL(MACCOL+2) NORESCAN; /*                         @P3C*/ 20289100
*          IF IBTCB='1' THEN        /* IF TCB WAS SPECIFIED      @L2A*/ 20289300
*           ANS(STORTYPESTRING || '='                                   20289500
*                        ||ITYPESTR||IFLAGSTR || '; /* STORAGE TYPE */')20289700
*             COL(MACCOL+2) NORESCAN; /*                         @P3C*/ 20289900
*          ELSE                     /* TCB NOT SPECIFIED         @L1A*/ 20290100
*            ANS(STORTYPESTRING || '='                                  20290300
*                          || ITYPESTR || '; /* STORAGE TYPE */')       20290500
*             COL(MACCOL+2) NORESCAN; /*                         @P3C*/ 20290700
*          ANS('RFY GPR14F RSTD; ')                                     20290900
*             COL(MACCOL+2) NORESCAN;                                   20291100
*          ANS('GPR14F=XM@(24); '||                                     20291300
*             '/* OBTAIN PC NUMBER */')                                 20291500
*             COL(MACCOL+2) NORESCAN;                                   20291700
*          /* Note that the entire linkage is GEN'd in this path        20291900
*             so that the routine can be INLINEd. If the non-PLX        20292100
*             path is taken, the GEN FLOWs preclude inlining.           20292300
*                                                              931119*/ 20292500
*          ANS('GEN REFS(GPR13P,' || STORTYPESTRING || ')' ||           20292700
*                              ' SETS(GPR14F,GPR15F) ' ||               20292900
*             '/* PC TO VSMLOC ROUTINE */' || ';')                      20293100
*             COL(MACCOL+2) NORESCAN;             /*             @P3C*/ 20293300
*          ANS('STM   15,12,16(GPR13P)')                                20293500
*             SKIP NORESCAN COL(10);              /*           931119*/ 20293700
*          ANS('LR    15,' || STORTYPESTRING)                           20293900
*             SKIP NORESCAN COL(10);              /*           931119*/ 20294100
*          ANS('PC    0(GPR14F)')                                       20294300
*             SKIP NORESCAN COL(10);              /*           931119*/ 20294500
*          ANS('L     2,16(GPR13P)')                                    20294700
*             SKIP NORESCAN COL(10);              /*           931119*/ 20294900
*          ANS('SSAR  2')                                               20295100
*             SKIP NORESCAN COL(10);              /*           931119*/ 20295300
*          ANS('LM    2,12,28(GPR13P)')                                 20295500
*             SKIP NORESCAN COL(10);              /*           931119*/ 20295700
*          ANS('@ENDGEN;  */') SKIP NORESCAN;     /*           931119*/ 20295900
*          ANS('RFY GPR14F UNRSTD; ')                                   20296100
*             COL(MACCOL+2) NORESCAN;                                   20296300
*          END;                                   /*           931119*/ 20296500
*        END;                                                           20300000
*      IF IOUT ^= '' THEN           /* IF OUT OPERAND SPECIFIED      */ 20350000
*        ANS(IOUT||'=GPR00F; /* SAVE OUTPUT */')                        20400000
*           COL(MACCOL+2) NORESCAN;                                     20450000
*      IF IRTNCODE ^= '' THEN       /* IF RTNCODE OPERAND SPECIFIED  */ 20500000
*        DO;                                                            20550000
*          IF INDEX(EHAREGS,'15F') = 0 THEN                             20600000
*            EHAREGS=EHAREGS||'15F';                                    20650000
*          ANS(IRTNCODE||'=GPR15F; /* SAVE RETURN CODE */')             20700000
*             COL(MACCOL+2) NORESCAN;                                   20750000
*        END;                                                           20800000
*      IF ITCB ^= '' THEN           /* IF TCB KEYWORD SPECIFIED  @L2A*/ 20812500
*          ANS(ITCB||'=GPR01P; /* SAVE TCB ADDRESS */')                 20825000
*             COL(MACCOL+2) NORESCAN;/*                          @L2A*/ 20837500
*      ANS('RFY (GPR00F,GPR01P'||IREGS||') UNRSTD;')                    20850000
*         COL(MACCOL+2) NORESCAN;                                       20900000
*    END;                                                               20950000
*  ANS('END; /* '||MACNAME||' '||MACLIST||' '||MACKEYS||' */')          21000000
*     COL(MACCOL) NORESCAN;                                             21050000
*  IF ERROR = 1 THEN                /* IF ERROR MESSAGES ISSUED      */ 21100000
*    RETURN CODE(12);                                                   21150000
*  ELSE                                                                 21200000
*    IF WARN = 1 THEN               /* IF WARNING MESSAGES ISSUED    */ 21250000
*      RETURN CODE(4);                                                  21300000
*    ELSE                           /* NO MESSAGES ISSUED            */ 21350000
*      RETURN CODE(0);                                                  21400000
*%END VSMLOC;                                                           21450000
