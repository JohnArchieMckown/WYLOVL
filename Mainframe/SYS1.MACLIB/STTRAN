         MACRO                                                          00050000
&MACNAM  STTRAN &FLG,&TAB=,&NAME=,&TCHAR=,&SCHAR=,&LIST=,&MF=I          00100000
.********************************************************************** 00150000
.*                                                                    * 00200000
.* STATUS - CHANGE LEVEL 000                                          * 00250000
.*                                                                    * 00300000
.* NAME - STTRAN                                                      * 00350000
.*                                                                    * 00355000
.*      COPYRIGHT = LICENSED MATERIALS - PROPERTY OF IBM              * 00360000
.*                                                                    * 00365000
.*                  "RESTRICTED MATERIALS OF IBM"                     * 00370000
.*                                                                    * 00375000
.*                  5695-117                                          * 00380000
.*                                                                    * 00385000
.*                  (C) COPYRIGHT IBM CORP. 1979                      * 00390000
.*                                                                    * 00395000
.*                                                                    * 00400000
.* FUNCTION - THE STTRAN MACRO IS USED TO:                            * 00450000
.*            1-SET UP THE USE OF A USER DEFINED TRANSLATE TABLE      * 00500000
.*            2-DISCONTINUE THE USE OF A USER DEFINED TRANSLATE TABLE * 00550000
.*            3-ESTABLISH SPECIFIC TRANSLATIONS IN A USER TABLE OR    * 00600000
.*              A DEFAULT TABLE, CHARACTER BY CHARACTER               * 00650000
.*            4-DISCONTINUE PREVIOUS SPECIFIC CHARACTER TRANSLATIONS  * 00700000
.*                                                                    * 00750000
.*       THE MACRO PROTOTYPE IS LISTED ABOVE                          * 00800000
.*                                                                    * 00850000
.*       THE STANDARD FORM OF EXPANSION FOR MF=I:                     * 00900000
.*                                                                    * 00950000
.*         STTRAN TAB=MYTAB,NAME=TABNAME                              * 01000000
.*         CNOP  0,4                                                  * 01050000
.*         BAL   1,*+16                  BRANCH AROUND PARAMETERS     * 01100000
.*         DC    A(MYTAB)                ADDRESS OF TABLE             * 01150000
.*         DC    A(TABNAME)              ADDRESS OF NAME              * 01200000
.*         DC    A(0)                    ADDRESS OF LIST PARAMETERS   * 01250000
.*         LA    0,3840+32               SET ENTRY CODE AND FLAGS     * 01300000
.*         SLL   0,16                    SHIFT TO HIGH ORDER BYTES    * 01350000
.*         SVC   94                      TERMINAL CONTROL MACROS SVC  * 01400000
.*                                                                    * 01450000
.*       THE STANDARD FORM OF EXPANSION FOR MF=L:                     * 01500000
.*                                                                    * 01550000
.*         STTRAN LIST=LISTPARM,MF=L                                  * 01600000
.*         DS    0F                                                   * 01650000
.*         DC    A(0)                    ADDRESS OF TABLE             * 01700000
.*         DC    A(0)                    ADDRESS OF NAME              * 01750000
.*         DC    A(LISTPARM)             ADDRESS OF LIST PARAMETERS   * 01800000
.*                                                                    * 01850000
.*       THE STANDARD FORM OF EXPANSION FOR MF=E:                     * 01900000
.*                                                                    * 01950000
.*         STTRAN NOCHAR,NAME=TABNAME,MF=(E,MYLIST)                   * 02000000
.*         LA    1,MYLIST                LOAD PARAMETER REG1          * 02050000
.*         SR    0,0                     ZERO REG 0               @01A* 02066600
.*         ST    0,0(,1)                 CLEAR TABLE ADDRESS      @01A* 02083200
.*         LA    0,TABNAME               LOAD ADDRESS OF NAME         * 02100000
.*         ST    0,4(,1)                 STORE NAME ADDR IN PARM LIST * 02150000
.*         SR    0,0                     ZERO REG 0               @01A* 02162500
.*         ST    0,8(,1)                 STORE LIST ADDR IN PARM LIST * 02175000
.*                                                                @01A* 02187500
.*         LA    0,3840+64               SET ENTRY CODE AND FLAGS     * 02200000
.*         SLL   0,16                    SHIFT TO HIGH ORDER BYTES    * 02250000
.*         SVC   94                      TERMINAL CONTROL MACROS SVC  * 02300000
.*                                                                    * 02350000
.*  $MAC(STTRAN),COMP(TSO/VTAM),PROD(VTAM): USER DEFINED TRANSLATION  * 02355500
.*                                                                    * 02361000
.*  FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS             * 02366500
.*  ---- -------- ------- ------ ------  ---------------------------- * 02372000
.*  $01= OY29862  VM330   900323 706351: ABEND0C4 IN IKT0940F DUE TO  * 02377500
.*                                       THIRD WORD IN PARAMETER AREA * 02383000
.*                                       WAS NOT INITIALIZED          * 02388500
.*                                                                    * 02394000
.********************************************************************** 02400000
         LCLA  &SYSFLG                                                  02450000
         LCLA  &SYSEC                                                   02500000
&SYSEC   SETA  3840                                                     02550000
         AIF   ('&MF' EQ 'I' AND '&FLG' EQ '' AND '&TAB' EQ '' AND '&TC*02600000
               HAR' EQ '' AND '&LIST' EQ '' AND '&NAME' EQ '' AND '&SCH*02650000
               AR' EQ '').ERROR1                                        02700000
         AIF   ('&FLG' EQ 'NOTRAN' AND ('&TAB' NE '' OR '&NAME' NE '' O*02750000
               R '&TCHAR' NE '' OR '&SCHAR' NE '')).ERROR1              02800000
         AIF   ('&FLG' EQ 'NOTRAN').TOPMAC                              02850000
         AIF   ('&FLG' EQ 'NOCHAR' AND ('&TAB' NE '' OR '&TCHAR' NE '' *02900000
               OR '&SCHAR' NE '')).ERROR1                               02950000
         AIF   ('&FLG' EQ 'NOCHAR' AND '&NAME' EQ '' AND '&MF' EQ 'I').*03000000
               ERROR2                                                   03050000
         AIF   ('&FLG' EQ 'NOCHAR').TOPMAC                              03100000
         AIF   ('&FLG' NE '').ERROR3                                    03150000
         AIF   ('&TAB' NE '' AND '&NAME' EQ '' AND '&MF' EQ 'I').ERROR2 03200000
         AIF   ('&TCHAR' EQ '' AND '&SCHAR' NE '' AND '&MF' NE 'L').ERR*03250000
               OR4                                                      03300000
         AIF   ('&TCHAR' NE '' AND '&SCHAR' EQ '' AND '&MF' NE 'L').ERR*03350000
               OR5                                                      03400000
         AIF   ('&NAME' NE '' AND ('&TAB' EQ '' OR '&FLG' EQ 'NOCHAR') *03450000
               AND '&MF' EQ 'I').ERROR6                                 03500000
.TOPMAC  ANOP                                                           03550000
         AIF   ('&FLG' EQ 'NOTRAN' AND '&LIST' EQ '' AND '&MF' NE 'L').*03600000
               NOTRN                                                    03650000
         AIF   ('&MF' EQ 'L').LNAME                                     03700000
         AIF   ('&MF(1)' EQ 'E').ENAME                                  03750000
         AIF   ('&MF' NE 'I').ERROR1                                    03800000
&MACNAM  CNOP  0,4                                                      03850000
         BAL   1,*+16                   BRANCH AROUND PARAMETERS        03900000
         AGO   .DCONST                                                  03950000
.ENAME   ANOP                                                           04000000
         IHBOPLST ,,&MACNAM,MF=&MF                                      04050000
         AGO   .STADDS                                                  04100000
.LNAME   ANOP                                                           04150000
&MACNAM  DS    0F                                                       04200000
.DCONST  AIF   ('&TAB' EQ '').TREG                                      04250000
         AIF   ('&TAB'(1,1) EQ '(').TREG                                04300000
         DC    A(&TAB)                  ADDRESS OF TABLE                04350000
         AGO   .DNAME                                                   04400000
.TREG    ANOP                                                           04450000
         DC    A(0)                     ADDRESS OF TABLE                04500000
.DNAME   AIF   ('&NAME' EQ '').NREG                                     04550000
         AIF   ('&NAME'(1,1) EQ '(').NREG                               04600000
         DC    A(&NAME)                 ADDRESS OF NAME                 04650000
         AGO   .DLIST                                                   04700000
.NREG    ANOP                                                           04750000
         DC    A(0)                     ADDRESS OF NAME                 04800000
.DLIST   AIF   ('&LIST' EQ '').LREG                                     04850000
         AIF   ('&LIST'(1,1) EQ '(').LREG                               04900000
         DC    A(&LIST)                 ADDRESS OF LIST PARAMETERS      04950000
         AGO   .CKMF                                                    05000000
.LREG    ANOP                                                           05050000
         DC    A(0)                     ADDRESS OF LIST PARAMETERS      05100000
.CKMF    AIF   ('&MF' EQ 'L').LEND                                      05150000
.STADDS  ANOP                                                           05200000
         AIF   ('&TAB' EQ '').STADD0                               @01C 05250000
         AIF   ('&TAB'(1,1) NE '(' AND '&MF' EQ 'I').STNAM              05300000
         AIF   ('&TAB'(1,1) NE '(').STTABA                              05350000
         ST    &TAB(1),0(,1)            STORE TABLE ADDR IN PARM LIST   05400000
         AGO   .STNAM                                                   05450000
.STADD0  SR    0,0                      ZERO REG 0                 @01A 05462500
         ST    0,0(,1)                  ZERO OUT TABLE ADDRESS     @01A 05475000
         AGO   .STNAM                                              @01A 05487500
.STTABA  ANOP                                                           05500000
         LA    0,&TAB                   LOAD ADDRESS OF TABLE           05550000
         ST    0,0(,1)                  STORE TABLE ADDR IN PARM LIST   05600000
.STNAM   ANOP                                                           05650000
         AIF   ('&NAME' EQ '').STNAM0                              @01C 05700000
         AIF   ('&NAME'(1,1) NE '(' AND '&MF' EQ 'I').STLIST            05750000
         AIF   ('&NAME'(1,1) NE '(').STNAMA                             05800000
         ST    &NAME(1),4(,1)           STORE NAME ADDR IN PARM LIST    05850000
         AGO   .STLIST                                                  05900000
.STNAM0  SR    0,0                      ZERO REG 0                 @01A 05910000
         ST    0,4(,1)                  CLEAR NAME ADDR IN PARM LIST    05920000
.*                                                                 @01A 05930000
         AGO   .STLIST                                                  05940000
.STNAMA  ANOP                                                           05950000
         LA    0,&NAME                  LOAD ADDRESS OF NAME            06000000
         ST    0,4(,1)                  STORE NAME ADDR IN PARM LIST    06050000
.STLIST  ANOP                                                           06100000
         AIF   ('&LIST' EQ '').STLST0                              @01C 06150000
         AIF   ('&LIST'(1,1) NE '(' AND '&MF' EQ 'I').LOAD0             06200000
         AIF   ('&LIST'(1,1) NE '(').STLSTA                             06250000
         ST    &LIST(1),8(,1)           STORE LIST ADDR IN PARM LIST    06300000
         AGO   .LOAD0                                                   06350000
.STLST0  SR    0,0                      ZERO REG 0                 @01A 06360000
         ST    0,8(,1)                  STORE LIST ADDR IN PARM LIST    06370000
.*                                                                 @01A 06380000
         AGO   .LOAD0                                              @01A 06390000
.STLSTA  ANOP                                                           06400000
         LA    0,&LIST                  LOAD ADDRESS OF LIST PARMS      06450000
         ST    0,8(,1)                  STORE LIST ADDR IN PARM LIST    06500000
.NOTRN   ANOP                                                           06550000
         SR    1,1                      ZERO REGISTER 1                 06600000
.LOAD0   ANOP                                                           06650000
         AIF   ('&FLG' EQ '').CKCHARS                                   06700000
         AIF   ('&FLG' EQ 'NOCHAR').STNOCH                              06750000
&SYSFLG  SETA  128                                                      06800000
         AGO   .STREG0                                                  06850000
.STNOCH  ANOP                                                           06900000
&SYSFLG  SETA  64                                                       06950000
         AGO   .STREG0                                                  07000000
.CKCHARS AIF   ('&TCHAR' EQ '').NOFLG                                   07050000
&SYSFLG  SETA  32                                                       07100000
         AGO   .STREG0                                                  07150000
.NOFLG   ANOP                                                           07200000
&SYSFLG  SETA  0                                                        07250000
.STREG0  ANOP                                                           07300000
         LA    0,&SYSEC+&SYSFLG         SET ENTRY CODE AND FLAGS        07350000
         SLL   0,16                     SHIFT TO HIGH ORDER BYTES       07400000
         AIF   ('&TCHAR' EQ '').STSVC                                   07450000
         AIF   ('&TCHAR'(1,1) EQ '(').TCREG                             07500000
         ICM   0,2,&TCHAR               SET TERMINAL CHARACTER          07550000
         AGO   .STSCHAR                                                 07600000
.TCREG   ANOP                                                           07650000
         ICM   0,2,0(&TCHAR(1))         SET TERMINAL CHARACTER          07700000
.STSCHAR AIF   ('&SCHAR'(1,1) EQ '(').SCREG                             07750000
         ICM   0,1,&SCHAR               SET SYSTEM CHARACTER            07800000
         AGO   .STSVC                                                   07850000
.SCREG   ANOP                                                           07900000
         ICM   0,1,0(&SCHAR(1))         SET SYSTEM CHARACTER            07950000
.STSVC   ANOP                                                           08000000
         SVC   94                       TERMINAL CONTROL MACROS SVC     08050000
         MEXIT                                                          08100000
.LEND    AIF   ('&TCHAR' EQ '' AND '&SCHAR' EQ '').END                  08150000
         IHBERMAC 1016,TCHAR/SCHAR,MF-L                                 08200000
.END     MEXIT                                                          08250000
.ERROR1  ANOP                                                           08300000
         IHBERMAC 54,,,                                                 08350000
         MEXIT                                                          08400000
.ERROR2  ANOP                                                           08450000
         IHBERMAC 1006,NAME                                             08500000
         MEXIT                                                          08550000
.ERROR3  ANOP                                                           08600000
         IHBERMAC 1008,&FLG,1                                           08650000
         MEXIT                                                          08700000
.ERROR4  ANOP                                                           08750000
         IHBERMAC 1010,SCHAR,TCHAR                                      08800000
         MEXIT                                                          08850000
.ERROR5  ANOP                                                           08900000
         IHBERMAC 1010,TCHAR,SCHAR                                      08950000
         MEXIT                                                          09000000
.ERROR6  ANOP                                                           09050000
         IHBERMAC 1010,NAME,TAB/NOCHAR                                  09100000
         MEXIT                                                          09150000
         MEND                                                           09200000
