*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  BPXESMF                               -04/21/99-<0> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  OpenMVS Process Accounting data collector     * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT=                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00600000
*     5647-A01 (C) COPYRIGHT IBM CORP. 1993,2000                      * 00650000
*                                                                     * 00700000
*   STATUS= HBB7703                                                   * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00900000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00950000
*                                                                     * 01000000
*01* FUNCTION:                                                        * 01050000
*                                                                     * 01100000
*      BPXESMF returns OpenMVS process accounting information for the * 01150000
*      address space of the caller.  It checks if the current address * 01200000
*      space is an OpenMVS process and if so, it calls an OpenMVS     * 01250000
*      routine to obtain process accounting data.                     * 01300000
*                                                                     * 01350000
*01* INVOCATION REQUIREMENTS:                                         * 01400000
*                                                                     * 01450000
*                                                                     * 01500000
*      Execution Mode:   Task or SRB mode.                            * 01550000
*                                                                     * 01600000
*      Authorization:    Supervisor state.  Zero PSW key.             * 01650000
*                                                                     * 01700000
*      Addressing Mode:  31 bit addressing mode.                      * 01750000
*                                                                     * 01800000
*      ASC mode:         Primary ASC mode.                            * 01850000
*                                                                     * 01900000
*      Serialization:    Enabled.                                     * 01950000
*                                                                     * 02000000
*                                                                     * 02050000
*01* INPUT REGISTERS:  GR0-GR12    Undefined                          * 02100000
*                      GR13        Points to 72-byte register         * 02150000
*                                  savearea                           * 02200000
*                      GR14-GR15   Undefined                          * 02250000
*                                                                     * 02300000
*01* OUTPUT REGISTERS: GR0-GR1     Unpredictable                      * 02350000
*                      GR2-GR13    Unchanged                          * 02400000
*                      GR14        Next Instruction Address           * 02450000
*                      GR15        Return Code                        * 02500000
*                                                                     * 02550000
*01* INVOCATION FORMAT:                                               * 02600000
*                                                                     * 02650000
*[xlabel]  BPXESMF     ACCTDAT=xacctdat                               * 02700000
*                    [,ASCBPTR=xascbptr|0]                          * 02725000
*                    [,RETCODE=xretcode]                              * 02750000
*                    [,VERSN=xversion]                                * 02800000
*                   [,MF=S]                                          * 02850000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 02900000
*                   [,MF=(E,xmfctrl)]                                * 02950000
*                                                                     * 03000000
*                                                                     * 03050000
*      Where:                                                         * 03100000
*                                                                     * 03150000
*                                                                     * 03200000
*      [xlabel]                                                       * 03250000
*          is an optional symbol, starting in column 1, that is the   * 03300000
*          name on the BPXESMF macro invocation.  The name must       * 03350000
*          conform to the rules for an ordinary assembler language    * 03400000
*          symbol.                                                    * 03450000
*          DEFAULT: No name.                                          * 03500000
*                                                                     * 03550000
*      ACCTDAT=xacctdat                                               * 03700000
*          is the name (RS-type), or address in register (2)-(12), of * 03750000
*          a required character output area to contain the output     * 03800000
*          process accounting data returned by BPXESMF.  Upon         * 03850000
*          successful completion, this area will be defined by the    * 03900000
*          mapping macro BPXYOSMF.  If BPXESMF is unsucessful, this   * 03950000
*          area will contain invalid data.                            * 04000000
*                                                                     * 04002600
*      [ASCBPTR=xascbptr|0]                                         * 04005200
*          is the name (RS-type), or address in register (2)-(12), of * 04007800
*          an optional 4 byte input that contains the address which   * 04010400
*          identifies the target ASCB.  Code the label on a pointer   * 04013000
*          to an ASCB or omit the keyword to use the ASCB of the      * 04015600
*          invoker (PSAAOLD).  It is expected the caller will be      * 04018200
*          using IHAASVT to cycle throught all valid ASCB addresses   * 04020800
*          (AsvtAval(i)=Off).  Caution - if there is no serialization * 04023400
*          while using this ASCB, the address space backed by this    * 04026000
*          ASCB (if not that of the invoker) could vanish at any      * 04028600
*          time.  The caller should have recovery and retry from      * 04031200
*          program checks during the execution of this service.       * 04033800
*                                                                     * 04036400
*          DEFAULT: 0                                                 * 04039000
*                                                                     * 04041600
*          If ASCBPTR is not specified, the default value PSAAOLD is  * 04044200
*          used.                                                      * 04046800
*                                                                     * 04050000
*                                                                     * 04100000
*                                                                     * 04150000
*      [RETCODE=xretcode]                                             * 04200000
*          is the name (RS-type) of an optional fullword output       * 04250000
*          variable, or register (2)-(12), into which the return code * 04300000
*          is to be copied from GPR 15.                               * 04350000
*                                                                     * 04400000
*                                                                     * 04450000
*      VERSN= 0 | 1 | 2 | 3 | Osmf#Version                        @P3C* 04500000
*          0 buffer is 64 bytes long (Through OSMFGNPPFS)         @P3C* 04550000
*          1 buffer is 64 bytes long (Through OSMFGNPPFS)         @P3C* 04600000
*          2 buffer is 84 bytes long (Through OSMFEXECPNAME)      @P3C* 04650000
*          3 buffer is 90 bytes long (Through OSMFSYNCCOUNT)      @P3C* 04700000
*          DEFAULT: Osmf#Version                                  @P3C* 04750000
*                                                                     * 04800000
*                                                                     * 04850000
*      [MF=S|L|E]                                                   * 04900000
*          is an optional keyword input which specifies the macro     * 04950000
*          form.                                                      * 05000000
*          DEFAULT: S                                                 * 05050000
*                                                                     * 05100000
*                                                                     * 05150000
*          [MF=S]                                                     * 05200000
*              specifies the standard form of the macro.  The "S"     * 05250000
*              form generates code to put the parameters into an      * 05300000
*              in-line parameter list and invoke the desired service. * 05350000
*              Full checking for required macro keys is done along    * 05400000
*              with supplying defaults for optional parameters that   * 05450000
*              are not specified.                                     * 05500000
*                                                                     * 05550000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 05600000
*              specifies the list form of the macro.  The "L" form    * 05650000
*              defines an area to be used for the parameter list.     * 05700000
*              Any other macro parameters are flagged as errors.      * 05750000
*                                                                     * 05800000
*            ,xmfctrl                                                 * 05850000
*              is a required input.  It is the name of a storage area * 05900000
*              for the parameter list.                                * 05950000
*                                                                     * 06000000
*            ,xmfattr|0D                                            * 06050000
*              is an optional 60 character input string that varies   * 06100000
*              from 1 to 60 characters. It can contain any value that * 06150000
*              is valid on an assembler DS pseudo-op. You can use     * 06200000
*              this parameter to force boundary alignment of the      * 06250000
*              parameter list.                                        * 06300000
*              DEFAULT: 0D which forces the parameter list to a       * 06350000
*              doubleword boundary.                                   * 06400000
*                                                                     * 06450000
*          [MF=(E,xmfctrl)]                                           * 06500000
*              specifies the execute form of the macro.  The "E" form * 06550000
*              generates code to put the parameters into the          * 06600000
*              parameter list specified by xmfctrl and provides full  * 06650000
*              syntax checking with default setting.                  * 06700000
*                                                                     * 06750000
*            ,xmfctrl                                                 * 06800000
*              is a required input.  It is the name (RS-type), or     * 06850000
*              address in register (2)-(12), of a storage area for    * 06900000
*              the parameter list.                                    * 06950000
*                                                                     * 07000000
*                                                                     * 07050000
*                                                                     * 07100000
*01* RETURN CODES:                                                    * 07150000
*                                                                     * 07200000
*                                                                     * 07250000
*       00        The macro completed successfully.                   * 07300000
*                                                                     * 07350000
*       08        The macro was unable to obtain process accounting   * 07400000
*                 data.  Normally, this means that the calling        * 07450000
*                 address space is not an OpenMVS process.            * 07500000
*                                                                     * 07550000
*       0C        The routine invoking this macro was compiled with a * 07600000
*                 version of the macro which does not match the       * 07650000
*                 version required for the current level of OpenMVS.  * 07700000
*                 No valid data is returned.  Please recompile with   * 07750000
*                 the correct macro version.                          * 07800000
*                                                                     * 07850000
*                                                                     * 07900000
*01* REASON CODES:  None.                                             * 07950000
*                                                                     * 08000000
*01* MODULE TYPE:  ASSEM MACRO                                        * 08050000
*                                                                     * 08100000
*02*   PROCESSOR:  ASSEM                                              * 08150000
*                                                                     * 08200000
*01* COMPONENT:  SCPX1                                                * 08250000
*                                                                     * 08300000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 08350000
*                                                                     * 08400000
*01* MACRO USAGE NOTES:                                               * 08450000
*                                                                     * 08500000
*                                                                     * 08550000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 08600000
*        global macro variable.  Any value other than 'NO' will       * 08650000
*        result in the macro expansion being printed.  The default is * 08700000
*        'YES'.  The following examples illustrate how the ZPRINT     * 08750000
*        variable should be set.                                      * 08800000
*                                                                     * 08850000
*                    GBLC &ZPRINT                                     * 08900000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 08950000
*                                                                     * 09000000
*                                                                     * 09050000
*    2.  The  BPXESMF macro supports multiple versions. The macro key * 09054500
*        list  below  contains the version level in which the key was * 09059000
*        first  introduced.                                           * 09063500
*                                                                     * 09068000
*        VERSION   KEY                                                * 09072500
*                                                                     * 09077000
*              0      ACCTDAT                                         * 09081500
*              3+     ASCBPTR    Version left at 3 since BPXYOSMF     * 09086000
*                                not changed                          * 09090500
*                                                                     * 09095000
*01* CHANGE ACTIVITY:                                                 * 09100000
*                                                                     * 09150000
*   Flag LineItem  FMID    Date   ID    Comment                       * 09200000
*                                                                     * 09250000
*    $L0=POSIXXA  HOM1110 920130 PDP1:  OpenMVS Initial Release       * 09300000
*    $D1=DOAA037  HOM1120 930805 PDEA:  Socket support and exec'd     * 09350000
*                                       Program Name                  * 09400000
*    $P1=POA0293  HOM1120 940201 PDEA:  Remove COMPLETE keyword from  * 09450000
*                                       the executable form           * 09500000
*    $D2=DOAA051  HOM1130 940801 PDJD:  (dcr A051.11) SMF Support     * 09550000
*                                       for InterProcess Communication* 09600000
*    $P2=PSP0011  HOM1150 950504 PDKF:  Fix for clearing right        * 09650000
*                                       version of OSMF.              * 09700000
* $D3=DA37700 JBB6609 990428 PDJM: Add ASCBPtr parameter              * 09716600
*                                  (Note AMG form of macro missing)   * 09733200
* $P3=PXD0... HBB7703 991102 PDJM: Doc change - VERSN is 1 byte       * 09741600
****** END OF SPECIFICATIONS *****************************************/ 09750000
*/********************************************************************* 09800000
         MACRO                                                          09850000
&XLABEL  BPXESMF &ACCTDAT=,&RETCODE=,&MF=,&VERSN=,&ASCBPTR=             09900000
.*                                                                      09950000
*              MACDATE -04/21/99-<3>                                    10000000
.*                                                                      10050000
.*******************************************************************    10100000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        10150000
.*******************************************************************    10200000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   10250000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     10300000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             10350000
.*                                                                      10400000
              GBLC  &ZBPXESMF   YES=MACRO USED AT LEAST ONCE            10450000
.*******************************************************************    10500000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          10550000
.*******************************************************************    10600000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 10650000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            10700000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              10750000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             10800000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             10850000
              LCLA  &ZAWRK      USED AS A WORK AREA                     10900000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  10950000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   11000000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 11050000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             11100000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 11150000
              LCLA  &ZMACRET    MACRO RETURN CODE                       11200000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        11250000
.*                                                                      11300000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      11350000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              11400000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   11450000
.********************************************************************   11500000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 11550000
.********************************************************************   11600000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 11650000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          11700000
.*                                                                      11750000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       11800000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        11850000
              SPLEVEL  TEST                                             11900000
.ZSYS2        ANOP  ,                                                   11950000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              12000000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              12050000
              SYSSTATE TEST                                             12100000
              AGO   .ZSYS4                                              12150000
.ZSYS3        ANOP  ,                                                   12200000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 12250000
.ZSYS4        ANOP  ,                                                   12300000
.*******************************************************************    12350000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   12400000
.*******************************************************************    12450000
              LCLC  &XACCTDAT   ++ NAME                                 12500000
              LCLC  &XASCBPTR   ++ NAME                          @D3A   12525000
              LCLC  &XRETCODE   ++ NAME                                 12550000
              LCLC  &XMF        ++ VALUE                                12600000
              LCLC  &XMFCTRL    ++ NAME                                 12650000
              LCLC  &XMFATTR    ++ VALUE                                12700000
              LCLC  &XMFSCK     ++ VALUE                                12750000
              LCLC  &XVERSION   ++ VALUE                         @P2A   12800000
.*******************************************************************    12850000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           12900000
.*******************************************************************    12950000
              LCLC  &ZXACCTDAT  ++ OUTPUT NAME                          13000000
              LCLC  &ZXASCBPTR  ++ INPUT  NAME                   @D3A   13025000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          13050000
              LCLC  &ZXMF       ++ INPUT VALUE                          13100000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           13150000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          13200000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          13250000
              LCLC  &ZXVERSION  ++ INPUT VALUE                   @P2A   13300000
.********************************************************************   13350000
.***AG.MF01 PROCESS MF MACRO FORMS                                      13400000
.********************************************************************   13450000
              ACTR  10000                                               13500000
.*------------------------------------------------------------------    13550000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           13600000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    13650000
.*-------------------------------------------------------------------   13700000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           13750000
.ZG9          ANOP  ,                                                   13800000
&ZTLC         SETC 'S'                                                  13850000
              AIF   ('&MF(1)' NE '&ZTLC').ZG10                          13900000
&XMF          SETC  'S'         SET KEYWORD                             13950000
              AIF   (N'&MF LE 1).ZG9A           CK NUM                  14000000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           14050000
&ZMS          SETC  '&ZMS.&MF"'                                         14100000
&ZMS          SETC  '&ZMS "MF"'                                         14150000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 14200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             14250000
.ZG9A         ANOP  ,                                                   14300000
.*-------------------------------------------------------------------   14350000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           14400000
.ZG10         ANOP  ,                                                   14450000
&ZTLC         SETC 'L'                                                  14500000
              AIF   ('&MF(1)' NE '&ZTLC').ZG17                          14550000
&XMF          SETC  'L'         SET KEYWORD                             14600000
              AIF   (N'&MF LE 3).ZG10A          CK NUM                  14650000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           14700000
&ZMS          SETC  '&ZMS.&MF"'                                         14750000
&ZMS          SETC  '&ZMS "MF"'                                         14800000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                14850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             14900000
.ZG10A        ANOP  ,                                                   14950000
.*-------------------------------------------------------------------   15000000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     15050000
              AIF   (N'&SYSLIST NE 0).ZG10B     POSITIONALS?            15100000
              AIF   ('&ACCTDAT' NE '').ZG10B    KEYS?                   15150000
              AIF   ('&ASCBPTR' NE '').ZG10B    KEYS?                   15175000
              AIF   ('&RETCODE' NE '').ZG10B    KEYS?                   15200000
              AGO    .ZG10C     INVOCATION OKAY                         15250000
.ZG10B        ANOP  ,                                                   15300000
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         15350000
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   15400000
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              15450000
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        15500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             15550000
.ZG10C        ANOP  ,                                                   15600000
.*-------------------------------------------------------------------   15650000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   15700000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           15750000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           15800000
              AIF   (N'&MF(2) GT 1).ZG12B       MULTI PARMS             15850000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           15900000
.ZG12B        AIF   (K'&MF(2) GT 0).ZG12C                               15950000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         16000000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 16050000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 16100000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        16150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             16200000
.ZG12C        ANOP  ,                                                   16250000
.*-------------------------------------------------------------------   16300000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               16350000
              AIF   (K'&ZXMFCTRL LE 0).ZG12P    NOT I/O                 16400000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG12P                      16450000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         16500000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           16550000
&ZMS          SETC  '&ZMS.&MF"'                                         16600000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           16650000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   16700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             16750000
.ZG12P        ANOP  ,                                                   16800000
.*-------------------------------------------------------------------   16850000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      16900000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           16950000
&XMFATTR      SETC  '0D'                                                17000000
              AIF   (K'&MF(3) LE 0).ZG15B       PARM                    17050000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           17100000
              AIF   (N'&MF(3) GT 1).ZG15B       MULTI PARMS             17150000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           17200000
.ZG15B        ANOP  ,                                                   17250000
.*-------------------------------------------------------------------   17300000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  17350000
              AIF   (K'&ZXMFATTR LE 0).ZG15P    NOT I/O                 17400000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG15P                      17450000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         17500000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           17550000
&ZMS          SETC  '&ZMS.&MF"'                                         17600000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           17650000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   17700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             17750000
.ZG15P        ANOP  ,                                                   17800000
.*-------------------------------------------------------------------   17850000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 17900000
              AIF   (K'&ZXMFATTR LE 0).ZG15S    NOT I/O                 17950000
              AIF   (K'&XMFATTR LE 60).ZG15S    LNG OK                  18000000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         18050000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           18100000
&ZMS          SETC  '&ZMS.&MF"'                                         18150000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               18200000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  18250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18300000
.ZG15S        ANOP  ,                                                   18350000
.*-------------------------------------------------------------------   18400000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           18450000
.ZG17         ANOP  ,                                                   18500000
&ZTLC         SETC 'E'                                                  18550000
              AIF   ('&MF(1)' NE '&ZTLC').ZG25                          18600000
&XMF          SETC  'E'         SET KEYWORD                             18650000
              AIF   (N'&MF LE 2).ZG17A          CK NUM           @P1C   18700000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           18750000
&ZMS          SETC  '&ZMS.&MF"'                                         18800000
&ZMS          SETC  '&ZMS "MF"'                                         18850000
              MNOTE 8,' &ZMS CAN HAVE ONLY 2 ARGUMENTS.'         @P1C   18900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18950000
.ZG17A        ANOP  ,                                                   19000000
.*-------------------------------------------------------------------   19050000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   19100000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           19150000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           19200000
              AIF   (N'&MF(2) GT 1).ZG19B       MULTI PARMS             19250000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           19300000
.ZG19B        AIF   (K'&MF(2) GT 0).ZG19C                               19350000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         19400000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 19450000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 19500000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        19550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19600000
.ZG19C        ANOP  ,                                                   19650000
.*-------------------------------------------------------------------   19700000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              19750000
              AIF   (K'&ZXMFCTRL LE 0).ZG19R    NOT I/O                 19800000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG19R                      19850000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          19900000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        19950000
              AIF   (K'&ZCGPR GT 2).ZG19Q                               20000000
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             20050000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       20100000
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        20150000
.ZG19P        ANOP  ,                                                   20200000
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             20250000
              AIF   ('&ZCGPR' LT '2').ZG19Q                             20300000
              AIF   ('&ZCGPR' LE '12').ZG19R                            20350000
.ZG19Q        ANOP  ,                                                   20400000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           20450000
&ZMS          SETC  '&ZMS.&MF"'                                         20500000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           20550000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    20600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             20650000
.ZG19R        ANOP  ,                                                   20700000
.*-------------------------------------------------------------------   20750000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             20800000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             20850000
.*-------------------------------------------------------------------   20900000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             20950000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           21000000
.*------------------------------------------------------------------    21050000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           21100000
.ZG25         ANOP  ,                                                   21150000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           21200000
              AIF   (K'&XMF GT 0).ZG25E         VALID ARG               21250000
              AIF   (T'&MF EQ 'O').ZG25D        OMITTED                 21300000
&ZASYSLNDX    SETA  0                                                   21350000
.ZG25A        ANOP  ,           POSITIONAL MACRO KEY                    21400000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        21450000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C                    21500000
&ZTLC         SETC 'MF'                                                 21550000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG25A           21600000
.ZG25B        ANOP  ,                                                   21650000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         21700000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           21750000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             21800000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    21850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             21900000
              AGO   .ZG25E                                              21950000
.ZG25C        ANOP  ,                                                   22000000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         22050000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           22100000
&ZMS          SETC  '&ZMS.&MF"'                                         22150000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           22200000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 22250000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           22300000
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           22350000
              MNOTE 8,' &ZMS OR "E".'                                   22400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22450000
              AGO   .ZG25E                                              22500000
.ZG25D        ANOP  ,                                                   22550000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     22600000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       22650000
.ZG25E        ANOP  ,                                                   22700000
.********************************************************************   22750000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 22800000
.********************************************************************   22850000
              ACTR  10000                                               22900000
.*-------------------------------------------------------------------   22950000
.***AG.MF03 MF=(SLE)                                                    23000000
              AIF   ('&XMF' EQ 'L').ZGMFX                               23050000
.*----------------------------------------------------------------***   23100000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    23150000
              AIF   (N'&ACCTDAT LE 1).ZG2A      CK NUM                  23200000
&ZMS          SETC  '"ACCTDAT='                 *KPOSA* MNOTE           23250000
&ZMS          SETC  '&ZMS.&ACCTDAT"'                                    23300000
&ZMS          SETC  '&ZMS "ACCTDAT"'                                    23350000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 23400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23450000
.ZG2A         ANOP  ,                                                   23500000
.*------------------------------------------------------------------    23550000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        23600000
&ZXACCTDAT    SETC  'OUTPUT'    SET IN/OUTPUT                           23650000
&XACCTDAT     SETC  '&ACCTDAT(1)'               SET XVARIABLE           23700000
              AIF   (N'&ACCTDAT GT 1).ZG2B      MULTI PARMS             23750000
&XACCTDAT     SETC  '&ACCTDAT'  SET XVARIABLE                           23800000
.ZG2B         AIF   (K'&ACCTDAT(1) GT 0).ZG2C                           23850000
&ZXACCTDAT    SETC  ''          RESET IN/OUTPUT                         23900000
&ZMS          SETC  ' '         *KRQDA*                                 23950000
&ZMS          SETC  '&ZMS "ACCTDAT" KEY AND ITS ARGUMENT'               24000000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             24050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24100000
.ZG2C         ANOP  ,                                                   24150000
.*-------------------------------------------------------------------   24200000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   24250000
              AIF   (K'&ZXACCTDAT LE 0).ZG2R    NOT I/O                 24300000
              AIF   ('&XACCTDAT'(1,1) NE '(').ZG2R                      24350000
&ZCGPR        SETC  '&XACCTDAT'(2,K'&XACCTDAT-2)                        24400000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         24450000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                24500000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              24550000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       24600000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        24650000
.ZG2P         ANOP  ,                                                   24700000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             24750000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              24800000
              AIF   ('&ZCGPR' LE '12').ZG2R                             24850000
.ZG2Q         ANOP  ,                                                   24900000
&ZMS          SETC  '"ACCTDAT='                 *KGPRA* MNOTE           24950000
&ZMS          SETC  '&ZMS.&ACCTDAT"'                                    25000000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           25050000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    25100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25150000
.ZG2R         ANOP  ,                                                   25200000
.*----------------------------------------------------------------***   25250000
.*** * * * * * NAME, OPT INPUT, KEYS -XVARIABLE KEY               @D3A  25251200
              AIF   (N'&ASCBPTR LE 1).DC00A     CK NUM            @D3A  25252400
&ZMS          SETC  '"ASCBPTR='                 *KPOSA* MNOTE     @D3A  25253600
&ZMS          SETC  '&ZMS.&ASCBPTR"'                              @D3A  25254800
&ZMS          SETC  '&ZMS "ASCBPTR"'                              @D3A  25256000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           @D3A  25257200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE       @D3A  25258400
.DC00A        ANOP  ,                                             @D3A  25259600
.*----------------------------------------------------------------@D3A  25260800
.*** * * * * * NAME, OPT INPUT, KEYS -XVARIABLE                   @D3A  25262000
&ZXASCBPTR    SETC  'INPUT'     SET IN/OUTPUT                     @D3A  25263200
&XASCBPTR     SETC  '0'                                           @D3A  25264400
              AIF   (K'&ASCBPTR(1) LE 0).DC01B  PARM              @D3A  25265600
&XASCBPTR     SETC  '&ASCBPTR(1)'               SET XVARIABLE     @D3A  25266800
              AIF   (N'&ASCBPTR GT 1).DC01B     MULTI PARMS       @D3A  25268000
&XASCBPTR     SETC  '&ASCBPTR'  SET XVARIABLE                     @D3A  25269200
.DC01B        ANOP  ,                                             @D3A  25270400
.*----------------------------------------------------------------@D3A  25271600
.*** * * * * NAME, OPT INPUT, KEYS -GPR OUT OF RANGE              @D3A  25272800
              AIF   (K'&ZXASCBPTR LE 0).DC02R   NOT I/O           @D3A  25274000
              AIF   ('&XASCBPTR' EQ '0').DC02R                    @D3A  25275200
              AIF   ('&XASCBPTR'(1,1) NE '(').DC02R               @D3A  25276400
&ZCGPR        SETC  '&XASCBPTR'(2,K'&XASCBPTR-2)                  @D3A  25277600
              AIF   ('&ZCGPR'(1,1) NE '0').DC02P                  @D3A  25278800
              AIF   (K'&ZCGPR GT 2).DC02Q                         @D3A  25280000
              AIF   ('&ZCGPR' EQ '0').DC02Q                       @D3A  25281200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                 @D3A  25282400
              AIF   (T'&ZCGPR NE 'N').DC02Q     INVALID REG NAME  @D3A  25283600
.DC02P        ANOP  ,                                             @D3A  25284800
              AIF   (T'&ZCGPR NE 'N').DC02R     NON NUMERIC       @D3A  25286000
              AIF   ('&ZCGPR' LT '2').DC02Q                       @D3A  25287200
              AIF   ('&ZCGPR' LE '12').DC02R                      @D3A  25288400
.DC02Q        ANOP  ,                                             @D3A  25289600
&ZMS          SETC  '"ASCBPTR='                 *KGPRA* MNOTE     @D3A  25290800
&ZMS          SETC  '&ZMS.&ASCBPTR"'                              @D3A  25292000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     @D3A  25293200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              @D3A  25294400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE       @D3A  25295600
.DC02R        ANOP  ,                                             @D3A  25296800
.*------------------------------------------------------------------    25298000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    25300000
              AIF   (N'&RETCODE LE 1).ZG5A      CK NUM                  25350000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           25400000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    25450000
&ZMS          SETC  '&ZMS "RETCODE"'                                    25500000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 25550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25600000
.ZG5A         ANOP  ,                                                   25650000
.*-------------------------------------------------------------------   25700000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        25750000
              AIF   (K'&RETCODE(1) LE 0).ZG5C   NO PARM                 25800000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              25850000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           25900000
              AIF   (N'&RETCODE GT 1).ZG5C                              25950000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           26000000
.ZG5C         ANOP  ,                                                   26050000
.*-------------------------------------------------------------------   26100000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   26150000
              AIF   (K'&ZXRETCODE LE 0).ZG5R    NOT I/O                 26200000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG5R                      26250000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        26300000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         26350000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                26400000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              26450000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       26500000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        26550000
.ZG5P         ANOP  ,                                                   26600000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             26650000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              26700000
              AIF   ('&ZCGPR' LE '12').ZG5R                             26750000
.ZG5Q         ANOP  ,                                                   26800000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           26850000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    26900000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           26950000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    27000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27050000
.ZG5R         ANOP  ,                                                   27100000
.*-------------------------------------------------------------38@P2A   27150000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    27200000
              AIF   (N'&VERSN LE 1).ZG6A        CK NUM                  27250000
&ZMS          SETC  '"VERSN='                   *KPOSA* MNOTE           27300000
&ZMS          SETC  '&ZMS.&VERSN"'                                      27350000
&ZMS          SETC  '&ZMS "VERSN"'                                      27400000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 27450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27500000
.ZG6A         ANOP  ,                                                   27550000
.*-------------------------------------------------------------------   27600000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        27650000
              AIF   (K'&VERSN(1) LE 0).ZG6C     NO PARM                 27700000
&ZXVERSION    SETC  'OUTPUT'    SET OUTPUT                              27750000
&XVERSION     SETC  '&VERSN(1)'                 SET XVARIABLE           27800000
              AIF   (N'&VERSN GT 1).ZG6C                                27850000
&XVERSION     SETC  '&VERSN'    SET XVARIABLE                           27900000
.ZG6C         ANOP  ,                                                   27950000
.*-------------------------------------------------------------------   28000000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   28050000
              AIF   (K'&ZXVERSION LE 0).ZG6R    NOT I/O                 28100000
              AIF   ('&XVERSION'(1,1) NE '(').ZG6R                      28150000
&ZCGPR        SETC  '&XVERSION'(2,K'&XVERSION-2)                        28200000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                         28250000
              AIF   (K'&ZCGPR GT 2).ZG6Q                                28300000
              AIF   ('&ZCGPR' EQ '0').ZG6Q                              28350000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       28400000
              AIF   (T'&ZCGPR NE 'N').ZG6Q      INVALID REG NAME        28450000
.ZG6P         ANOP  ,                                                   28500000
              AIF   (T'&ZCGPR NE 'N').ZG6R      NON NUMERIC             28550000
              AIF   ('&ZCGPR' LT '2').ZG6Q                              28600000
              AIF   ('&ZCGPR' LE '12').ZG6R                             28650000
.ZG6Q         ANOP  ,                                                   28700000
&ZMS          SETC  '"VERSN='                   *KGPRA* MNOTE           28750000
&ZMS          SETC  '&ZMS.&VERSN"'                                      28800000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           28850000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    28900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28950000
.ZG6R         ANOP  ,                                                   29000000
.******************************************************************     29050000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        29100000
.******************************************************************     29150000
              ACTR  10000                                               29200000
.*----------------------------------------------------------------***   29250000
.***AH.P02 EXTRA POSITIONALS                                            29300000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               29350000
&ZCVAL        SETC  ''          ERROR FIELD                             29400000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       29450000
.ZGLIST2      ANOP  ,                                                   29500000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         29550000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                29600000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   29650000
              AGO   .ZGLIST2                                            29700000
.*                                                                      29750000
.ZGLIST3      ANOP  ,                                                   29800000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             29850000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           29900000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     29950000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              30000000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      30050000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              30100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30150000
.ZGLISTX      ANOP  ,                                                   30200000
&ZASYSLNDX    SETA  0                                                   30250000
.*-------------------------------------------------------------------   30300000
.***AG.MF04 MF=(SLE)                                                    30350000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                30400000
.*******************************************************************    30450000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       30500000
.*******************************************************************    30550000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          30600000
.*******************************************************************    30650000
.***AE.01  START OF BPXESMF MACRO CODE                                  30700000
.*******************************************************************    30750000
              LCLC  &M0M0001                 NAME                       30800000
&M0M0001      SETC  '&XLABEL'                SET NAME                   30850000
              AIF   (K'&XLABEL NE 0).XLAB2                              30900000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               30950000
.*                                                                      31000000
.XLAB2        ANOP  ,                                                   31050000
&M0M0001 DS    0H                             BPXESMF-0                 31100000
.*******************************************************************    31150000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              31200000
.*******************************************************************    31250000
              PUSH  PRINT                                               31300000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          31350000
              PRINT OFF         ++ PR01                                 31400000
              AGO   .ZPRNTXX                                            31450000
.ZPRINTX      PRINT ON                                                  31500000
.ZPRNTXX      ANOP  ,                                                   31550000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  31600000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  31650000
.********************************************************************   31700000
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    31750000
.********************************************************************   31800000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       31850000
                      LCLA  &ZOPN1         INVOCATION INDEX             31900000
                      LCLC  &ZOPL(4095)    LABEL                        31950000
                      LCLC  &ZOPO(4095)    OPERATION                    32000000
                      LCLC  &ZOPV(4095)    VALUE                        32050000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  32100000
.*                                                                      32150000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     32200000
.*-------------------------------------------------------------------   32250000
.***AL.A10 SET ZPLLEN                                                   32300000
&ZPLLEN               SETA 8                                            32350000
.******************************************************************     32400000
.***AL.A05 BPXESMF FMT=ARG MF=S PARAMETER AREA                          32450000
.******************************************************************     32500000
                      AIF   ('&XMF' NE 'S').ZLMFSX  NOT STANDARD MF     32550000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(2,3).'A'                     32600000
.*                                                                      32650000
&ZOPN                 SETA  &ZOPN+1                                     32700000
&ZOPL(&ZOPN)          SETC  ' '                                         32750000
&ZOPO(&ZOPN)          SETC  'B'                                         32800000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                32850000
&ZOPD(&ZOPN)          SETC  '++ BPXESMF ARG PARMS'                      32900000
.*                                                                      32950000
&ZOPN                 SETA  &ZOPN+1                                     33000000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL'                                  33050000
&ZOPO(&ZOPN)          SETC  'DS'                                        33100000
&ZOPV(&ZOPN)          SETC  '3A'                                  @D3A  33150000
&ZOPD(&ZOPN)          SETC  '++ BPXESMF ARG PARMS'                      33200000
.*-------------------------------------------------------------------   33250000
.***AL.A07 BPXESMF FMT=ARG MF=S PARAMETERS                              33300000
&ZOPN                 SETA  &ZOPN+1                                     33350000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                33400000
&ZOPO(&ZOPN)          SETC  'DC'                                        33450000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   33500000
&ZOPD(&ZOPN)          SETC  '++ BPXESMF ARG PARMS'                      33550000
.*                                                                      33600000
.ZLMFSX               ANOP  ,                                           33650000
.******************************************************************     33700000
.***AL.AL01 BPXESMF FMT=ARG MF=L PARAMETER AREA                         33750000
.******************************************************************     33800000
                      AIF   ('&XMF' NE 'L').ZLMFLX  NOT MF=L            33850000
&ZOPN                 SETA  &ZOPN+1                                     33900000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL'                                  33950000
&ZOPO(&ZOPN)          SETC  'DS'                                        34000000
&ZOPV(&ZOPN)          SETC  '&XMFATTR'                                  34050000
&ZOPD(&ZOPN)          SETC  '++ BPXESMF ARG PARMS'                      34100000
.*                                                                      34150000
&ZOPN                 SETA  &ZOPN+1                                     34200000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XVERSION@'                       34250000
&ZOPO(&ZOPN)          SETC  'DS'                                        34300000
&ZOPV(&ZOPN)          SETC  'A'                                         34350000
&ZOPD(&ZOPN)          SETC  '++ INPUT XL1'                              34400000
.*                                                                      34450000
&ZOPN                 SETA  &ZOPN+1                                     34500000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XACCTDAT@'                       34550000
&ZOPO(&ZOPN)          SETC  'DS'                                        34600000
&ZOPV(&ZOPN)          SETC  'A'                                         34650000
&ZOPD(&ZOPN)          SETC  '++ OUTPUT CL256'                           34700000
.*                                                             @D3A     34707100
&ZOPN                 SETA  &ZOPN+1                            @D3A     34714200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XASCBPTR@'              @D3A     34721300
&ZOPO(&ZOPN)          SETC  'DS'                               @D3A     34728400
&ZOPV(&ZOPN)          SETC  'A'                                @D3A     34735500
&ZOPD(&ZOPN)          SETC  '++ INPUT A'                       @D3A     34742600
.*-------------------------------------------------------------------   34750000
.***AL.AL08 BPXESMF FMT=ARG MF=L PARAMETER AREA DEFINED                 34800000
                      AGO   .ZMFLX         EXIT, MF=L DONE              34850000
.*                                                                      34900000
.ZLMFLX               ANOP  ,                                           34950000
.********************************************************************   35000000
.***AI.A01 BPXESMF FMT=ARG FILL IN PARAMETER AREA                       35050000
.********************************************************************   35100000
                      ACTR  10000                                       35150000
&ZOPN                 SETA  &ZOPN+1                                     35200000
&ZOPL(&ZOPN)          SETC  ' '                                         35250000
&ZOPO(&ZOPN)          SETC  'XR'                                        35300000
&ZOPV(&ZOPN)          SETC  '0,0'                                       35350000
&ZOPD(&ZOPN)          SETC  '++ SET GPR TO ZERO'                        35400000
.*                                                                      35450000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               35500000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSTATE PRI     35550000
&ZCVAL                SETC  'LAE'          XAX MODE                     35600000
.ZIMFXA               ANOP ,                                            35650000
.*                                                                      35700000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    35750000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         35800000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 35850000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                35900000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 35950000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                36000000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   36050000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    36100000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   36150000
&ZOPN                 SETA  &ZOPN+1                                     36200000
&ZOPL(&ZOPN)          SETC  ' '                                         36250000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    36300000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              36350000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       36400000
                      AGO   .ZIMFNX                                     36450000
.*                                                                      36500000
.ZIMFN2               ANOP ,                                            36550000
&ZOPN                 SETA  &ZOPN+1                                     36600000
&ZOPL(&ZOPN)          SETC  ' '                                         36650000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    36700000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                36750000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       36800000
.ZIMFNX               ANOP ,                                            36850000
.********************************************************************   36900000
.***AI.A02 BPXESMF FMT=ARG INITIALIZE PARAMETER AREA                    36950000
.********************************************************************   37000000
.***AI.L03 MF=(SLE)                                                     37050000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      37100000
.*                                                                      37150000
&ZOPN                 SETA  &ZOPN+1                                     37200000
&ZOPL(&ZOPN)          SETC  ' '                                         37250000
&ZOPO(&ZOPN)          SETC  'XC'                                        37300000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         37350000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             37400000
.ZIMFLX               ANOP  ,                                           37450000
.*-------------------------------------------------------------------   37500000
.***AI.A11 BIND=VALUE XVERSION XL1 INPUT                         @D2C   37550000
.* SET VERSION TO CURRENT VERSION IF NOT PASSED IN.  OTHERWISE,  @P2A   37600000
.* USE THE VALUE PASSED.                                         @P2A   37650000
                      AIF   ('&XVERSION' NE '').ZIXL1X           @P2A   37700000
&XVERSION             SETC  '3'                                         37750000
.ZIXL1X               ANOP  ,                                    @P2A   37800000
&ZOPN                 SETA  &ZOPN+1                                     37850000
&ZOPL(&ZOPN)          SETC  ' '                                         37900000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    37950000
&ZOPV(&ZOPN)          SETC  '14,=AL1(&XVERSION)'                        38000000
&ZOPD(&ZOPN)          SETC  '++ XL1'                                    38050000
.*                                                                      38100000
&ZOPN                 SETA  &ZOPN+1                                     38150000
&ZOPL(&ZOPN)          SETC  ' '                                         38200000
&ZOPO(&ZOPN)          SETC  'ST'                                        38250000
&ZOPV(&ZOPN)          SETC  '14,0(,1)'                                  38300000
&ZOPD(&ZOPN)          SETC  '++ XVERSION'                               38350000
.*-------------------------------------------------------------------   38400000
.***AI.A06 BIND=NAME ADDR XACCTDAT CL256 OUTPUT                         38450000
         AIF   ('&ZXACCTDAT' EQ '').ZI2G   NOT USED                     38500000
&ZCGPR   SETC  '14'                                                     38550000
&ZCLNG                SETC  '&XACCTDAT'                                 38600000
         AIF   ('&XACCTDAT'(1,1) NE '(').ZI2A  NOT IN GPR               38650000
&ZCGPR   SETC  '&XACCTDAT'(2,K'&XACCTDAT-2)                             38700000
         AGO   .ZI2F                                                    38750000
.*                                                                      38800000
.ZI2A                 ANOP  ,                                           38850000
&ZOPN                 SETA  &ZOPN+1                                     38900000
&ZOPL(&ZOPN)          SETC  ' '                                         38950000
&ZOPO(&ZOPN)          SETC  'LA'                                        39000000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             39050000
&ZOPD(&ZOPN)          SETC  '++ BIND=NAME CL256'                        39100000
.*                                                                      39150000
.ZI2F                 ANOP  ,                                           39200000
&ZOPN                 SETA  &ZOPN+1                                     39250000
&ZOPL(&ZOPN)          SETC  ' '                                         39300000
&ZOPO(&ZOPN)          SETC  'ST'                                        39350000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              39400000
&ZOPD(&ZOPN)          SETC  '++ &ZXACCTDAT XACCTDAT ADDR'               39450000
.ZI2G                 ANOP  ,                                           39500000
.*---------------------------------------------------------------@D3A   39501900
.*** * * * BIND=NAME ADDR XASCBPTR A INPUT                       @D3A   39503800
         AIF   ('&ZXASCBPTR' EQ '').DC05G  NOT USED              @D3A   39505700
&ZCGPR   SETC  '14'                                              @D3A   39507600
&ZCLNG                SETC  '&XASCBPTR'                          @D3A   39509500
         AIF   ('&XASCBPTR'(1,1) NE '(').DC05A NOT IN GPR        @D3A   39511400
&ZCGPR   SETC  '&XASCBPTR'(2,K'&XASCBPTR-2)                      @D3A   39513300
         AGO   .DC05F                                            @D3A   39515200
.*                                                               @D3A   39517100
.DC05A                ANOP  ,                                    @D3A   39519000
        AIF   ('&XASCBPTR' EQ '0').DC05G                         @D3A   39520900
&ZOPN                 SETA  &ZOPN+1                              @D3A   39522800
&ZOPL(&ZOPN)          SETC  ' '                                  @D3A   39524700
&ZOPO(&ZOPN)          SETC  'LA'                                 @D3A   39526600
&ZOPO(&ZOPN)          SETC  'L'                                  @D3A   39528500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                      @D3A   39530400
&ZOPD(&ZOPN)          SETC  '++ BIND=NAME A'                     @D3A   39532300
.*                                                               @D3A   39534200
.DC05F                ANOP  ,                                    @D3A   39536100
&ZOPN                 SETA  &ZOPN+1                              @D3A   39538000
&ZOPL(&ZOPN)          SETC  ' '                                  @D3A   39539900
&ZOPO(&ZOPN)          SETC  'ST'                                 @D3A   39541800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                       @D3A   39543700
&ZOPD(&ZOPN)          SETC  '++ &ZXASCBPTR XASCBPTR ADDR'        @D3A   39545600
.DC05G                ANOP  ,                                    @D3A   39547500
.*-------------------------------------------------------------------   39550000
&ZOPN1                SETA &ZOPN                                        39600000
.*******************************************************************    39650000
.***AO.X02  RETURN CODE PROCESSING                                      39700000
.*******************************************************************    39750000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    39800000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            39850000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             39900000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             39950000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               40000000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                40050000
&ZOPN                 SETA  &ZOPN+1                                     40100000
&ZOPL(&ZOPN)          SETC  ' '                                         40150000
&ZOPO(&ZOPN)          SETC  'ST'                                        40200000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              40250000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        40300000
                      AGO   .ZMRETX                                     40350000
.*                                                                      40400000
.ZMRET2               ANOP  ,                                           40450000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                40500000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                40550000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                40600000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  40650000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   40700000
&ZOPN                 SETA  &ZOPN+1                                     40750000
&ZOPL(&ZOPN)          SETC  ' '                                         40800000
&ZOPO(&ZOPN)          SETC  'LR'                                        40850000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 40900000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        40950000
.ZMRETX               ANOP  ,                                           41000000
.*******************************************************************    41050000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   41100000
.*******************************************************************    41150000
.ZMFLX                ANOP  ,              MF=L PROCESSING              41200000
.*******************************************************************    41250000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               41300000
.*******************************************************************    41350000
                      ACTR  10000                                       41400000
.*                                                                      41450000
                      LCLA  &ZLC           COLUMN POSITION              41500000
                      LCLA  &ZOPX          LIST TABLE INDEX             41550000
                      LCLC  &ZLL           LABEL                        41600000
                      LCLC  &ZLOP          OPERATION                    41650000
                      LCLC  &ZLV           VALUE                        41700000
                      LCLC  &ZLD           DESCRIPTION                  41750000
.*                                                                      41800000
&ZOPX                 SETA  1                                           41850000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            41900000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              41950000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              42000000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              42050000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              42100000
                      AIF   (K'&ZLD LE 0).ZL5                           42150000
&ZLC                  SETA  35             COMMENT COLUMN               42200000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    42250000
&ZLC                  SETA  33             COMMMENT COLUMN              42300000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   42350000
&ZLV                  SETC  '&ZLV'.' '                                  42400000
                      AGO   .ZL3                                        42450000
.*                                                                      42500000
.ZL4                  ANOP  ,                                           42550000
&ZLV                  SETC  '&ZLV'.' '                                  42600000
.ZL5                  ANOP  ,                                           42650000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               42700000
.*                                                                      42750000
&ZLL     &ZLOP &ZLV                                                     42800000
.*                                                                      42850000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               42900000
                      AGO   .ZL2           CONTINUE LOOPING             42950000
.*                                                                      43000000
.ZLX                  ANOP  ,                                           43050000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                43100000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  43150000
         AIF   ('&ASCBPTR' NE '').DC07A                                 43200000
         L     14,548(0,0)     R14 = PSAAOLD                            43250000
         AGO   .DC07B                                                   43300000
.DC07A   ANOP                                                           43350000
* IF ASCBPTR IS NOT TO A VALID PROCESS, BPXAMSMF WILL RETURN R15^=0.    43400000
         L     14,8(0,1)       R14 = ASCBPTR                            43450000
.DC07B   ANOP                                                           43500000
         L     0,336(0,14)     R0 = ASCBASSB FROM TARGET ASCB           43550000
         L     14,16(0,0)      GET CVT ADDRESS                          43600000
         L     15,140(0,14)    GET ECVT ADDRESS                         43650000
         L     14,244(0,15)    GET OEXT ADDRESS                         43700000
         L     15,20(0,14)     COLLECTOR ROUTINE ADDR                   43750000
         BALR  14,15           BRANCH TO ROUTINE                        43800000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  43850000
.ZLINKX               ANOP  ,                                           43900000
.*******************************************************************    43950000
.***AP.X01  FORMAT GENERATED CODE                                       44000000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            44050000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              44100000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              44150000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              44200000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              44250000
                      AIF   (K'&ZLD LE 0).ZL51                          44300000
&ZLC                  SETA  35             COMMENT COLUMN               44350000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   44400000
&ZLC                  SETA  33             COMMENT COLUMN               44450000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  44500000
&ZLV                  SETC  '&ZLV'.' '                                  44550000
                      AGO   .ZL31                                       44600000
.*                                                                      44650000
.ZL41                 ANOP  ,                                           44700000
&ZLV                  SETC  '&ZLV'.' '                                  44750000
.ZL51                 ANOP  ,                                           44800000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               44850000
.*                                                                      44900000
&ZLL     &ZLOP &ZLV                                                     44950000
.*                                                                      45000000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               45050000
                      AGO   .ZL21          CONTINUE LOOPING             45100000
.*                                                                      45150000
.ZLX1                 ANOP  ,                                           45200000
.*******************************************************************    45250000
.***AP.X02  END OF BPXESMF MACRO                                        45300000
&ZBPXESMF             SETC  'YES'          SET BPXESMF USED             45350000
         POP   PRINT                                                    45400000
*                                            BPXESMF-0                  45450000
         SPACE 1                                                        45500000
.ZLX2                 ANOP  ,                                           45550000
         MEND                                                           45600000
**********************************************************************/ 45650000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  45700000
*%BPXESMF: MACRO KEYS(ACCTDAT,RETCODE,MF,VERSN,ASCBPTR);                45750000
*  ANS('?'||MACLABEL||' '||'BPXESMFP '||MACLIST||                       45800000
*         ' '||MACKEYS||';') COL(MACLMAR);                              45850000
*%END BPXESMF;                                                          45900000
