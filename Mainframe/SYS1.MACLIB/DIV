* %GOTO STARTPLS;                                                       00050000
*/********************************************************************/ 00100000
*/*                                                                  */ 00150000
*/* MACRO-NAME= DIV                              02/08/91            */ 00200000
*/*                                                                  */ 00250000
*/*                                                                  */ 00600000
*/* PROPRIETARY STATEMENT =                                          */ 00610000
*/*     LICENSED MATERIALS - PROPERTY OF IBM                         */ 00620000
*/*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                  */ 00630000
*/*     5695-047 (C) COPYRIGHT IBM CORP. 1986, 1990                  */ 00640000
*/*     SEE COPYRIGHT INSTRUCTIONS                                   */ 00650000
*/*                                                                  */ 00660000
*/* STATUS = JBB4422                                                 */ 00670000
*/*                                                                  */ 00680000
*/*                                                                  */ 00690000
*/* FUNCTION=  The DIV macro provides the user interface to the      */ 00700000
*/*            Data In Virtual (DIV) facility.                       */ 00750000
*/*                                                                  */ 00800000
*/* NOTE=   1. The first assembler statement generated by this macro */ 00850000
*/*            is a comment containing the macro date.  If there     */ 00900000
*/*            is a change to the macro, then this date should be    */ 00950000
*/*            updated to indicate a new version.                    */ 01000000
*/*                                                                  */ 01050000
*/*         2. The DIV parameter list has a level number associated  */ 01100000
*/*            with it for each service.  The level number indicates */ 01150000
*/*            the format of the parameter list for that service.    */ 01200000
*/*            The level number is part of the parameter list and is */ 01400000
*/*            used by the appropriate service routine to            */ 01450000
*/*            distinguish different levels of parameter lists.      */ 01500000
*/*                                                                  */ 01550000
*/*            (a) For the I form, any new parameter list and new    */ 01554100
*/*            level number is used only if new keyword(s) requiring */ 01558200
*/*            the uplevel parameter list are specified.             */ 01562300
*/*            (b) For the L form, the largest parameter list is     */ 01566400
*/*            always generated, but is initialized with the lowest  */ 01570500
*/*            level number consistent with the keywords specified.  */ 01574600
*/*            (c) For the E and M forms, the level number is only   */ 01578700
*/*            set if the keywords specified require a level number  */ 01582800
*/*            higher than that which is already initialized in the  */ 01586900
*/*            parameter list.                                       */ 01591000
*/*                                                                  */ 01595100
*/*         3. The code generated by the standard and execute forms  */ 01600000
*/*            of this macro require that the DIV service routine    */ 01650000
*/*            preserve register 13.                                 */ 01700000
*/*                                                                  */ 01750000
*/*                                                                  */ 01950000
*/* SYNTAX=     label DIV service                                    */ 02000000
*/*                       ,DDNAME=op1                                */ 02050000
*/*                       ,TYPE=DA|HS                                */ 02100000
*/*                       ,ID=op1                                    */ 02150000
*/*                       ,CHECKING=YES|NO                           */ 02166600
*/*                       ,TTOKEN=*|op1                              */ 02183200
*/*                       ,SIZE=*|op1                                */ 02200000
*/*                       ,MODE=READ|UPDATE                          */ 02250000
*/*                       ,LOCVIEW=MAP|NONE                          */ 02300000
*/*                       ,AREA=op1                                  */ 02350000
*/*                       ,OFFSET=*|op1                              */ 02400000
*/*                       ,SPAN=*|op1                                */ 02450000
*/*                       ,STOKEN=*|op1                              */ 02475000
*/*                       ,RETAIN=YES|NO                             */ 02500000
*/*                       ,PFCOUNT=nn                                */ 02533300
*/*                       ,RELEASE=YES|NO                            */ 02566600
*/*                       ,LISTADDR=*|opt1                           */ 02577700
*/*                       ,LISTSIZE=*|opt1                           */ 02588800
*/*                       ,MF=I|L|(E,op1)|(M,op1)                    */ 02600000
*/*                                                                  */ 02650000
*/*              op1 (standard/execute/modify macro forms)=          */ 02700000
*/*                       RX-type address or                         */ 02750000
*/*                       register (2) - (12)                        */ 02800000
*/*                                                                  */ 02850000
*/*              op1 (list macro form)=                              */ 02900000
*/*                       A-type address                             */ 02950000
*/*                                                                  */ 03000000
*/*              nn is an unsigned decimal number                    */ 03025000
*/*                                                                  */ 03050000
*/*                                                                  */ 03075000
*/*      ---------------------------------------------------         */ 03115100
*/*      |              | I | U | A | U | M | U | R | S | S |        */ 03155200
*/*      |Service ----> | D | N | C | N | A | N | E | A | A |        */ 03195300
*/*      |              | E | I | C | A | P | M | S | V | V |        */ 03235400
*/*      |              | N | D | E | C |   | A | E | E | E |        */ 03275500
*/*      |Keyword       | T | E | S | C |   | P | T |   | L |        */ 03315600
*/*      |  |           | I | N | S | E |   |   |   |   | I |        */ 03355700
*/*      |  |           | F | T |   | S |   |   |   |   | S |        */ 03395800
*/*      |  |           | Y | I |   | S |   |   |   |   | T |        */ 03435900
*/*      |  |           |   | F |   |   |   |   |   |   |   |        */ 03476000
*/*      |  V           |   | Y |   |   |   |   |   |   |   |        */ 03516100
*/*      |--------------------------------------------------|        */ 03556200
*/*      |  service.....| A | A | A | A | A | A | A | A | A |        */ 03596300
*/*      |  DDNAME......| C1|   |   |   |   |   |   |   |   |        */ 03636400
*/*      |  TYPE........| R |   |   |   |   |   |   |   |   |        */ 03676500
*/*      |  ID..........| R | R | R | R | R | R | R | R | R |        */ 03716600
*/*      |  CHECKING....| D |   |   |   |   |   |   |   |   |        */ 03756700
*/*      |  TTOKEN......| D |   |   |   |   |   |   |   |   |        */ 03796800
*/*      |  SIZE........|   |   | O |   |   |   |   | O |   |        */ 03836900
*/*      |  MODE........|   |   | R |   |   |   |   |   |   |        */ 03877000
*/*      |  LOCVIEW.....|   |   | D |   |   |   |   |   |   |        */ 03917100
*/*      |  AREA........|   |   |   |   | R | R |   |   |   |        */ 03957200
*/*      |  SPAN........|   |   |   |   | D |   | D | D2| D |        */ 03997300
*/*      |  OFFSET......|   |   |   |   | D |   | D | D2| D |        */ 04037400
*/*      |  STOKEN......| C2|   |   |   | D | D | O |   |   |        */ 04077500
*/*      |  RETAIN......|   |   |   |   | D | D |   |   |   |        */ 04117600
*/*      |  PFCOUNT.....|   |   |   |   | O |   |   |   |   |        */ 04157700
*/*      |  RELEASE.....|   |   |   |   |   |   | D |   |   |        */ 04197800
*/*      |  LISTADDR....|   |   |   |   |   |   |   | O | R |        */ 04237900
*/*      |  LISTSIZE....|   |   |   |   |   |   |   | O | R |        */ 04278000
*/*      |  MF..........| D | D | D | D | D | D | D | D | D |        */ 04318100
*/*      ----------------------------------------------------        */ 04358200
*/*                                                                  */ 04400000
*/*       A = Must always be specified                               */ 04450000
*/*       R = Required keyword on standard form                      */ 04500000
*/*       Cn= Conditionally required keyword on standard form        */ 04512500
*/*             n=1:   required if TYPE=DA                           */ 04525000
*/*             n=2:   required if TYPE=HS                           */ 04537500
*/*       O = Optional keyword                                       */ 04550000
*/*   blank = Ignored if specified                                   */ 04600000
*/*       D = Default value supplied if not specified on standard    */ 04650000
*/*           form - (see below).                                    */ 04700000
*/*       D2= Cannot specify these parameters if LISTADDR and        */ 04716600
*/*           Listsize are also specified                            */ 04733200
*/*                                                                  */ 04750000
*/*             Default CHECKING is YES                              */ 04766600
*/*             Default TTOKEN is *                                  */ 04783200
*/*             Default OFFSET is zero                               */ 04800000
*/*             Default SPAN is *                                    */ 04850000
*/*             Default RETAIN is NO                                 */ 04900000
*/*             Default LOCVIEW is NONE                              */ 04950000
*/*             Default MF is standard form                          */ 05000000
*/*             Default STOKEN is *                                  */ 05016600
*/*             Default RELEASE is NO                                */ 05033200
*/*                                                                  */ 05050000
*/* AUTHORIZATION =                                                  */ 05075000
*/*                                                                  */ 05100000
*/*    An authorized user is defined as one executing in supervisor  */ 05108300
*/*    state and/or in system key (0-7).                             */ 05116600
*/*                                                                  */ 05124900
*/*    All DIV macro options are available to non-authorized and     */ 05133200
*/*    authorized users except for the following which are           */ 05141500
*/*    available to authorized users only:                           */ 05149800
*/*                                                                  */ 05158100
*/*         CHECKING=NO                                              */ 05166400
*/*         TTOKEN                                                   */ 05174700
*/*                                                                  */ 05183000
*/*                                                                  */ 05191300
*/* CHANGE-ACTIVITY=                                                 */ 05200000
*/*    $L0=DIV,JBB2220,831018,PDYB:DIV                               */ 05250000
*/*    $L1=SMSSTG2,JBB2223,860702,PDG5:STOR MGMT SUBSYS STGII SUPT - */ 05300000
*/*                                    DIV/E SUPPORT                 */ 05350000
*/*    $L2=DATASPAC,HBB3310,870424,PDG5:DIV IN DATA SPACES           */ 05375000
*/*    $01=OY14214,HBB3310,880427,PDYB:Fix expansion code to run in  */ 05378100
*/*                                    the Advanced Address Space    */ 05381200
*/*                                    Facility (AASF) environment   */ 05384300
*/*    $L3=WINDW,JBB3311,880309,PDYB:  DATA WINDOW SERVICES          */ 05387500
*/*    $L4=JUP03,HBB4410,881024,PDYB:  SMS3                          */ 05393700
*/*    $02=OY21569,HBB4410,890129,PDIC: Size is not a valid parameter*/ 05395200
*/*                                     on a MAP or UNMAP in E-form  */ 05396700
*/*                                     and M-form                   */ 05398200
*/*    $03=OY34190,HBB4410,900629,PDIC: Add comment indicator        */ 05398800
*/*    $L5=RSMDVD04,JBB4422,900824,PD00IC : New DIV SAVELIST service */ 05399400
*/*    $P1=PKI0091, JBB4422,910125,PD00IC : Add STOKEN to SAVE,      */ 05424500
*/*                                     move parameters LISTSIZE and */ 05449600
*/*                                     LISTADDR in parameter list.  */ 05474700
*/*                                                                  */ 05500000
*/*                                                                  */ 05550000
*/********************************************************************/ 05900000
*/*                                                                     05950000
         MACRO                                                          06000000
&LABL    DIV   &SV,&DDNAME=,&TYPE=,&ID=,&CHECKING=,&TTOKEN=,&SIZE=,&MODC06050000
               E=,&LOCVIEW=,&AREA=,&OFFSET=,&SPAN=,&STOKEN=,&RETAIN=,&PC06087500
               FCOUNT=,&RELEASE=,&LISTADDR=,&LISTSIZE=,&MF=             06125000
.*                                                                 @L5A 06162500
.*                                                                      06200000
.********************************************************************** 06250000
.*                                                                    * 06300000
.*                      DECLARE MACRO VARIABLES                       * 06350000
.*                                                                    * 06400000
.********************************************************************** 06450000
.*                                                                      06500000
         GBLC  &SYSASCE      System state via SYSSTATE macro       @01A 06516600
.*                                                                      06533200
         LCLC  &VLEVID       Parameter list level for IDENTIFY          06550000
         LCLC  &VLEVUI       Parameter list level for UNIDENTIFY        06600000
         LCLC  &VLEVAC       Parameter list level for ACCESS            06650000
         LCLC  &VLEVUA       Parameter list level for UNACCESS          06700000
         LCLC  &VLEVMA       Parameter list level for MAP               06750000
         LCLC  &VLEVSL       Parameter list level for SAVELIST     @L5A 06775000
         LCLC  &VLEVUM       Parameter list level for UNMAP             06800000
         LCLC  &VLEVRE       Parameter list level for RESET             06850000
         LCLC  &VLEVSA       Parameter list level for SAVE              06900000
         LCLC  &VLEV         Parameter list level for current request   06950000
         LCLC  &LISTAD       Local copy of LISTADDR parameter      @L5A 06966600
         LCLC  &LISTSZ       Local copy of LISTSIZE parameter      @L5A 06983200
         LCLC  &VTYDA        code for TYPE=DA                           07000000
         LCLC  &VTYHS        code for TYPE=HS                      @L3A 07025000
         LCLC  &VSERV        Selected service (IDENTIFY,UNIDENTIFY,...) 07050000
         LCLC  &VCODE        Service code (3=IDENTIFY,4=UNIDENTIFY,...) 07100000
         LCLC  &VFORM        Macro Format (I,L,E or M)                  07150000
         LCLC  &VFLGA0       Bit 0 of flag byte A (0 or 1)              07200000
         LCLC  &VFLGA1       Bit 1 of flag byte A (0 or 1)         @L1A 07250000
         LCLC  &SWXSTOP      Stop processing switch (YES or NO)         07300000
         LCLC  &SWXSVOK      A service is specified switch (YES or NO)  07350000
         LCLC  &VLAB1        Label for generated code                   07400000
         LCLC  &VLABB        Label for word 1 of the parameter list     07450000
         LCLC  &VLABC        Label for word 2 of the parameter list     07500000
         LCLC  &VLABD        Label for word 3 of the parameter list     07550000
         LCLC  &VLABE        Label for word 4 of the parameter list     07600000
         LCLC  &VLABF        Label for word 5 of the parameter list     07610000
         LCLC  &VLABG        Label for word 6 of the parameter list     07620000
         LCLC  &VLABH        Label for word 7 of the parameter list     07630000
.*                                                                 @L2A 07640000
         LCLC  &VTEMP        Temporary variable                         07650000
         LCLC  &PIGN         MNOTE phrase                               07700000
         LCLC  &PXIGN        MNOTE phrase                               07750000
         LCLC  &PXIIGN       MNOTE phrase                               07800000
         LCLC  &PNOTXT       MNOTE phrase                               07850000
.*                                                                      07900000
.********************************************************************** 07950000
.*                                                                    * 08000000
.*                   INITIALIZE LOCAL MACRO VARIABLES                 * 08050000
.*                                                                    * 08100000
.********************************************************************** 08150000
.*                                                                      08200000
.*                                                                      08250000
.*       ************************************************************** 08300000
.*       *                     PARAMETER LIST LEVEL NUMBERS (in hex)  * 08350000
.*       ************************************************************** 08400000
.*                                                                      08450000
&VLEVID  SETC  '1'            Initial parameter list level- IDENTIFY    08500000
&VLEVUI  SETC  '1'            Initial parameter list level- UNIDENTIFY  08550000
&VLEVAC  SETC  '1'            Initial parameter list level- ACCESS      08600000
&VLEVUA  SETC  '1'            Initial parameter list level- UNACCESS    08650000
&VLEVMA  SETC  '1'            Initial parameter list level- MAP         08700000
&VLEVSL  SETC  '1'            Initial parameter list level- SVLST  @L5A 08725000
&VLEVUM  SETC  '1'            Initial parameter list level- UNMAP       08750000
&VLEVRE  SETC  '1'            Initial parameter list level- RESET       08800000
&VLEVSA  SETC  '1'            Initial parameter list level- SAVE        08850000
.*                                                                      08900000
.*       ************************************************************** 08950000
.*       *                     TYPE CODES  (in hex)                   * 09000000
.*       ************************************************************** 09050000
.*                                                                      09100000
&VTYDA   SETC  '1'            code for TYPE=DA                          09150000
&VTYHS   SETC  '2'            code for TYPE=HS                    @L3A  09175000
.*                                                                      09200000
.*       ************************************************************** 09250000
.*       *                     MISCELLANEOUS VARIABLES AND SWITCHES   * 09300000
.*       ************************************************************** 09350000
.*                                                                      09400000
&VLEV    SETC  ''             Parm list level for the specified service 09450000
&VSERV   SETC  ''             The specified service                     09500000
&VCODE   SETC  '0'            The code for the specified service        09550000
&VFORM   SETC  'I'            Standard form of macro (default)          09600000
&VFLGA0  SETC  '0'            Initialize bit 0 of flag byte A           09650000
&VFLGA1  SETC  '0'            Initialize bit 1 of flag byte A     @L1A  09700000
&SWXSTOP SETC  'NO'           Do not stop processing                    09750000
&SWXSVOK SETC  'YES'          Assume the service operand is present     09800000
&VLAB1   SETC  'IHB'.'&SYSNDX'.'1'         Form label 1                 09850000
&VLABB   SETC  'IHB'.'&SYSNDX'.'B'         Form label B                 09900000
&VLABC   SETC  'IHB'.'&SYSNDX'.'C'         Form label C                 09950000
&VLABD   SETC  'IHB'.'&SYSNDX'.'D'         Form label D                 10000000
&VLABE   SETC  'IHB'.'&SYSNDX'.'E'         Form label E                 10050000
&VLABF   SETC  'IHB'.'&SYSNDX'.'F'         Form label F           @L2A  10062500
&VLABG   SETC  'IHB'.'&SYSNDX'.'G'         Form label G           @L2A  10075000
&VLABH   SETC  'IHB'.'&SYSNDX'.'H'         Form label H           @L2A  10087500
&PIGN    SETC  'IT IS IGNORED'                                          10100000
&PXIGN   SETC  'EXTRA PARAMETERS ARE IGNORED'                           10150000
&PXIIGN  SETC  'EXTRA ITEMS ARE IGNORED'                                10200000
&PNOTXT  SETC  'NO TEXT IS GENERATED'                                   10250000
&LISTAD  SETC  '&LISTADDR'                                        @L5A  10266600
&LISTSZ  SETC  '&LISTSIZE'                                        @L5A  10283200
.*                                                                      10300000
.********************************************************************** 10350000
.*                                                                    * 10400000
.*           ISSUE MESSAGE TO INDICATE MACRO DATE                     * 10450000
.*                                                                    * 10500000
.********************************************************************** 10550000
.*                                                                      10600000
*              -----------  MACDATE=01/25/91 -----------                10650000
.*                                                                      10700000
.********************************************************************** 10750000
.*                                                                    * 10800000
.*               CHECK THE VALIDITY OF THE MACRO INVOCATION           * 10850000
.*                                                                    * 10900000
.********************************************************************** 10950000
.*                                                                      11000000
         AIF   (N'&SYSLIST GT 1).ERR1         Too many positional parms 11050000
.BAKER1  AIF   (N'&SYSLIST EQ 0).ERR2         No service specified      11100000
.*                                                                      11150000
.*       ************************************************************** 11200000
.*       *        CHECK FOR CORRECT MACRO FORM.  SET VARIABLE &VFORM  * 11250000
.*       ************************************************************** 11300000
.*                                                                      11350000
.BAKER2  AIF   (T'&MF EQ 'O' OR '&MF(1)' EQ 'I').CKSERV  Standard form  11400000
         AIF   ('&MF(1)' NE 'L' AND '&MF(1)' NE 'E' AND                C11450000
               '&MF(1)' NE 'M').ERR3         Bad form                   11500000
         AIF   ('&MF(1)' EQ 'L').LFORM                                  11550000
         AIF   ('&MF(1)' EQ 'E').EFORM                                  11600000
&VFORM   SETC  'M'                           M Form of the macro        11650000
         AGO   .EMFORM                                                  11700000
.EFORM   ANOP                                                           11750000
&VFORM   SETC  'E'                           E Form of the macro        11800000
.EMFORM  AIF   (N'&MF GT 2).ERR4             Too many MF operands       11850000
         AIF   (N'&MF LT 2).ERR5             Too few MF operands        11900000
         AGO   .CKSERV                                                  11950000
.LFORM   ANOP                                                           12000000
&VFORM   SETC  'L'                           L Form of the macro        12050000
         AIF   (N'&MF NE 1).ERR6             Too many MF operands       12100000
.*                                                                      12150000
.*       ************************************************************** 12200000
.*       *CHECK FOR REQUESTED SERVICE. SET &VSERV, &VCODE, AND &VLEV  * 12250000
.*       ************************************************************** 12300000
.*                                                                      12350000
.CKSERV  AIF   ('&SWXSVOK' EQ 'NO').CKIGNOR                             12400000
         AIF   ('&SV(1)' NE 'IDENTIFY').NOTID                           12450000
&VSERV   SETC  'IDENTIFY'                                               12500000
&VCODE   SETC  '3'                                                      12550000
         AIF   (T'&CHECKING EQ 'O' AND T'&TTOKEN EQ 'O').IDLVOK    @L4A 12562500
&VLEVID  SETC  '2'                                                 @L4A 12575000
.IDLVOK  ANOP                                                      @L4A 12587500
&VLEV    SETC  '&VLEVID'                                                12600000
         AGO   .CKIGNOR                                                 12650000
.NOTID   AIF   ('&SV(1)' NE 'UNIDENTIFY').NOTUNID                       12700000
&VSERV   SETC  'UNIDENTIFY'                                             12750000
&VCODE   SETC  '4'                                                      12800000
&VLEV    SETC  '&VLEVUI'                                                12850000
         AGO   .CKIGNOR                                                 12900000
.NOTUNID AIF   ('&SV(1)' NE 'ACCESS').NOTACC                            12950000
&VSERV   SETC  'ACCESS'                                                 13000000
&VCODE   SETC  '5'                                                      13050000
&VLEV    SETC  '&VLEVAC'                                                13100000
         AGO   .CKIGNOR                                                 13150000
.NOTACC  AIF   ('&SV(1)' NE 'UNACCESS').NOTUNAC                         13200000
&VSERV   SETC  'UNACCESS'                                               13250000
&VCODE   SETC  '6'                                                      13300000
&VLEV    SETC  '&VLEVUA'                                                13350000
         AGO   .CKIGNOR                                                 13400000
.NOTUNAC AIF   ('&SV(1)' NE 'MAP').NOTMAP                               13450000
&VSERV   SETC  'MAP'                                                    13500000
&VCODE   SETC  '7'                                                      13550000
         AIF   (T'&STOKEN EQ 'O' AND T'&PFCOUNT EQ 'O').MALVOK     @L3C 13562500
&VLEVMA  SETC  '2'                                                 @L2A 13575000
.MALVOK  ANOP                                                      @L2A 13587500
&VLEV    SETC  '&VLEVMA'                                                13600000
         AGO   .CKIGNOR                                                 13650000
.NOTMAP  AIF   ('&SV(1)' NE 'UNMAP').NOTUNMA                            13700000
&VSERV   SETC  'UNMAP'                                                  13750000
&VCODE   SETC  '8'                                                      13800000
         AIF   (T'&STOKEN EQ 'O').UMLVOK                           @L3A 13812500
&VLEVUM  SETC  '2'                                                 @L3A 13825000
.UMLVOK  ANOP                                                      @L3A 13837500
&VLEV    SETC  '&VLEVUM'                                                13850000
         AGO   .CKIGNOR                                                 13900000
.NOTUNMA AIF   ('&SV(1)' NE 'RESET').NOTRES                             13950000
&VSERV   SETC  'RESET'                                                  14000000
&VCODE   SETC  '9'                                                      14050000
&VLEV    SETC  '&VLEVRE'                                                14100000
         AGO   .CKIGNOR                                                 14150000
.NOTRES  AIF   ('&SV(1)' NE 'SAVE').NOTSAVE                             14200000
&VSERV   SETC  'SAVE'                                                   14250000
&VCODE   SETC  'A'                                                      14300000
         AIF   (T'&LISTADDR NE 'O' AND '&LISTADDR' NE '*').SVLV2   @L5A 14307100
         AIF   (T'&LISTSIZE NE 'O' AND '&LISTSIZE' NE '*').SVLV2   @L5A 14314200
         AIF   (T'&STOKEN NE 'O' AND '&STOKEN' NE '*').SVLV2       @P1A 14317700
         AGO   .SVLVOK                                             @L5A 14321300
.SVLV2   ANOP                                                      @L5A 14328400
&VLEVSA  SETC  '2'                                                 @L5A 14335500
.SVLVOK  ANOP                                                      @L5A 14342600
&VLEV    SETC  '&VLEVSA'                                                14350000
         AGO   .CKIGNOR                                                 14400000
.NOTSAVE AIF   ('&SV(1)' NE 'SAVELIST').NOTSVLS                    @L5A 14414200
&VSERV   SETC  'SAVELIST'                                          @L5A 14428400
&VCODE   SETC  'D'                                                 @L5A 14442600
&VLEV    SETC  '&VLEVSL'                                           @L5A 14456800
         AGO   .CKIGNOR                                            @L5A 14471000
.NOTSVLS AGO   .ERR7                  Incorrect service specified  @L5A 14485200
.BAKER7  ANOP                                                           14500000
.*                                                                      14550000
.*       ************************************************************** 14600000
.*       *        CHECK FOR KEYWORDS WHICH SHOULD NOT BE PRESENT      * 14650000
.*       ************************************************************** 14700000
.*                                                                      14750000
.CKIGNOR AIF   ('&SWXSVOK' EQ 'NO').CKREQ                               14800000
         AIF   ('&VSERV' EQ 'IDENTIFY').NAMECK                          14850000
         AIF   (T'&DDNAME NE 'O').ERR8   DDNAME should not be specified 14900000
.NAMECK  AIF   (T'&DDNAME NE 'O' AND '&TYPE' EQ 'HS').ERR8A             14907100
.*                                       DDNAME should not be specified 14914200
.*                                       with TYPE=HS             @L3A  14921300
         AIF   (T'&STOKEN NE 'O' AND '&TYPE' EQ 'DA').ERR8B  DDNAME     14928400
.*                                       STOKEN should not be specified 14935500
.*                                       with TYPE=DA             @L3A  14942600
.NAMEOK  AIF   ('&VSERV' EQ 'IDENTIFY').TYPEOK                          14950000
         AIF   (T'&TYPE NE 'O').ERR9     TYPE should not be specified   15000000
.TYPEOK  AIF   ('&VSERV' EQ 'IDENTIFY').CHEKOK                    @L4A  15008300
         AIF   (T'&CHECKING NE 'O').ERR9A  CHECKING should not be       15016600
.*                                         specified              @L4A  15024900
.CHEKOK  AIF   ('&VSERV' EQ 'IDENTIFY').TTOKOK                    @L4A  15033200
         AIF   (T'&TTOKEN NE 'O').ERR9B    TTOKEN should not be         15041500
.*                                         specified              @L4A  15049800
.TTOKOK  ANOP                                                     @L4A  15058100
         AIF   ('&VSERV' EQ 'ACCESS' OR '&VSERV' EQ 'SAVE').SIZEOK      15066600
         AIF   (T'&SIZE NE 'O').ERR10    SIZE should not be specified   15100000
.SIZEOK  AIF   ('&VSERV' EQ 'ACCESS').MODEOK                            15150000
         AIF   (T'&MODE NE 'O').ERR11    MODE should not be specified   15200000
.MODEOK  AIF   ('&VSERV' EQ 'ACCESS').LOCVOK                      @L1C  15250000
         AIF   (T'&LOCVIEW NE 'O').ERR11B  LOCVIEW should not be        15300000
.*                                         specified              @L1A  15350000
.LOCVOK  AIF   ('&VSERV' EQ 'MAP' OR '&VSERV' EQ 'UNMAP').AREAOK  @L1A  15400000
         AIF   (T'&AREA NE 'O').ERR12    AREA should not be specified   15450000
.AREAOK  AIF   ('&VSERV' EQ 'MAP' OR '&VSERV' EQ 'SAVE' OR             C15500000
               '&VSERV' EQ 'RESET' OR                                  C15533300
               '&VSERV' EQ 'SAVELIST').OFFSOK                      @L5A 15566600
         AIF   (T'&OFFSET NE 'O').ERR13  OFFSET should not be spec.     15600000
.OFFSOK  AIF   ('&VSERV' EQ 'MAP' OR '&VSERV' EQ 'SAVE' OR             C15650000
               '&VSERV' EQ 'RESET' OR                                  C15683300
               '&VSERV' EQ 'SAVELIST').SPANOK                      @L5A 15716600
         AIF   (T'&SPAN NE 'O').ERR14    SPAN should not be specified   15750000
.SPANOK  AIF   ('&VSERV' EQ 'MAP' OR '&VSERV' EQ 'UNMAP').RETOK         15800000
         AIF   (T'&RETAIN NE 'O').ERR15  RETAIN should not be spec.     15850000
.RETOK   AIF   ('&VSERV' EQ 'MAP' OR '&VSERV' EQ 'IDENTIFY' OR         C15863300
               '&VSERV' EQ 'UNMAP' OR '&VSERV' EQ 'SAVE').STKNOK   @P1C 15876600
         AIF   (T'&STOKEN NE 'O').ERR15B STOKEN should not be           15890000
.*                                       specified                 @L2A 15910000
.STKNOK  AIF   ('&VSERV' EQ 'MAP').PFCOK                           @L3C 15927500
         AIF   (T'&PFCOUNT NE 'O').ERR16 PFCOUNT should not be          15945000
.*                                       specified                 @L3A 15962500
.PFCOK   AIF   ('&VSERV' EQ 'RESET').RELOK                         @L3A 15980000
         AIF   (T'&RELEASE NE 'O').ERR16A RELEASE should not be         15997500
.*                                       specified                 @L3A 16015000
.RELOK   AIF   ('&VSERV' EQ 'SAVELIST' OR '&VSERV' EQ                  C16019300
               'SAVE').CKREQ                                       @L5A 16023600
         AIF   (T'&LISTADDR NE 'O').ERR16B  LISTADDR should not be      16027900
.*                                       specified                 @L5A 16032200
.LSTADOK AIF   (T'&LISTSIZE NE 'O').ERR16C  LISTSIZE should not be      16036500
.*                                       specified                 @L5A 16040800
.LSTSZOK ANOP                                                      @L5A 16045100
.*                                                                      16050000
.*       ************************************************************** 16100000
.*       *        CHECK FOR KEYWORDS WHICH ARE REQUIRED               * 16150000
.*       ************************************************************** 16200000
.*                                                                      16250000
.CKREQ   AIF   ('&SWXSVOK' EQ 'NO').CKINVK                              16300000
         AIF   ('&VFORM' EQ 'E' OR '&VFORM' EQ 'L' OR                  C16350000
               '&VFORM' EQ 'M').CKINVK                                  16400000
         AIF   ('&VSERV' NE 'SAVE').LSDONE                         @L5A 16405500
         AIF   (T'&LISTADDR EQ 'O' OR '&LISTADDR' EQ '*').LSTAOM   @L5A 16411000
         AIF   (T'&LISTSIZE EQ 'O' OR '&LISTSIZE' EQ '*').LSTNG    @L5A 16416500
         AGO   .CKOFFSP                                            @L5A 16422000
.LSTAOM  AIF   (T'&LISTSIZE EQ 'O' OR '&LISTSIZE' EQ '*').LSDONE   @L5A 16427500
.LSTNG   ANOP                                                      @L5A 16433000
&LISTAD   SETC ''                                                  @L5A 16438500
&LISTSZ   SETC ''                                                  @L5A 16444000
         AGO   .ERR16D                                             @L5A 16455000
.CKOFFSP AIF   ('&VLEVSA' EQ '1').LSDONE                           @L5A 16460500
         AIF   (T'&OFFSET NE 'O' AND '&OFFSET' NE '*').ERR16E      @L5A 16466000
         AIF   (T'&SPAN NE 'O' AND '&SPAN' NE '*').ERR16E          @L5A 16471500
.LSDONE  AIF   ('&VSERV' NE 'IDENTIFY').TYDONE                          16477000
         AIF   ('&DDNAME' EQ '' AND '&TYPE' EQ 'DA').ERR17 DDNAME missg 16483300
         AIF   (('&STOKEN' EQ '' OR '&STOKEN' EQ '*') AND              C16505500
               '&TYPE' EQ 'HS').ERR17A STOKEN missing  @L3A             16527700
.NID1    AIF   ('&TYPE' EQ '').ERR18                    TYPE missing    16550000
.TYDONE  ANOP                                                           16600000
         AIF   ('&VSERV' NE 'ACCESS').MODONE                            16650000
         AIF   ('&MODE' EQ '').ERR19                    MODE missing    16700000
.MODONE  ANOP                                                           16750000
         AIF   ('&VSERV' NE 'MAP' AND '&VSERV' NE 'UNMAP').ARDONE       16800000
         AIF   ('&AREA' EQ '').ERR20                    AREA missing    16850000
.ARDONE  ANOP                                                           16900000
         AIF   ('&VSERV' NE 'SAVELIST').SLDONE                    @L5A  16906200
         AIF   ('&LISTAD' EQ '' OR '&LISTAD' EQ '*').ERR20A             16912400
.*                                              LISTADDR missing  @L5A  16918600
.LADONE  ANOP                                                           16924800
         AIF   ('&LISTSZ' EQ '' OR '&LISTSZ' EQ '*').ERR20B             16931000
.*                                              LISTSIZE missing  @L5A  16937200
.SLDONE  ANOP                                                     @L5A  16943400
.*                                                                      16950000
.*       ************************************************************** 17000000
.*       *        CHECK FOR INVALID VALUES ON KEYWORDS                * 17050000
.*       ************************************************************** 17100000
.*                                                                      17150000
.CKINVK  AIF   ('&SWXSVOK' EQ 'NO').CKMISC                              17200000
         AIF   ('&VSERV' NE 'IDENTIFY').INVK1                           17250000
         AIF   (T'&TYPE NE 'O' AND '&TYPE' NE 'DA' AND                 C17283300
               '&TYPE' NE 'HS').ERR21                             @L3C  17316600
.BAKER21 ANOP                                                           17350000
         AIF   (T'&CHECKING NE 'O' AND '&CHECKING' NE 'YES' AND        C17362500
               '&CHECKING' NE 'NO').ERR21A                        @L4A  17375000
.BAKE21A ANOP                                                     @L4A  17387500
.INVK1   AIF   ('&VSERV' NE 'ACCESS').INVK2                             17400000
         AIF   (T'&MODE NE 'O' AND '&MODE' NE 'READ' AND               C17450000
               '&MODE' NE 'UPDATE').ERR22                               17500000
.BAKER22 AIF   (T'&LOCVIEW NE 'O' AND '&LOCVIEW' NE 'MAP' AND          C17550000
               '&LOCVIEW' NE 'NONE').ERR22B                       @L1A  17600000
.BAKE22B ANOP                                                     @L1C  17650000
.INVK2   AIF   ('&VSERV' NE 'MAP').INVK3                                17700000
         AIF   (T'&RETAIN NE 'O' AND '&RETAIN' NE 'YES' AND            C17750000
               '&RETAIN' NE 'NO').ERR23                                 17800000
.BAKER23 ANOP                                                           17850000
.INVK3   AIF   ('&VSERV' NE 'UNMAP').INVK4                              18000000
         AIF   (T'&RETAIN NE 'O' AND '&RETAIN' NE 'YES' AND            C18050000
               '&RETAIN' NE 'NO').ERR25                                 18100000
.BAKER25 ANOP                                                           18150000
.INVK4   AIF   ('&VSERV' NE 'RESET').INVK5                              18166600
         AIF   (T'&RELEASE NE 'O' AND '&RELEASE' NE 'YES' AND          C18183200
               '&RELEASE' NE 'NO').ERR25A                               18199800
.BAKE25A ANOP                                                           18216400
.INVK5   ANOP                                                           18233000
.*                                                                      18250000
.*       ************************************************************** 18300000
.*       *        CHECK FOR MISCELLANEOUS ERRORS                      * 18350000
.*       ************************************************************** 18400000
.*                                                                      18450000
.CKMISC  AIF   (T'&ID EQ 'O' AND '&VFORM' EQ 'I').ERR26                 18500000
.BAKER26 ANOP                                                           18550000
         AIF   ('&SWXSTOP' EQ 'NO').CONT                                18600000
         MEXIT                           Severe error - stop processing 18650000
.*                                                                      18700000
.********************************************************************** 18750000
.*                                                                    * 18800000
.* VALIDITY CHECKING COMPLETE.  NOW GENERATE CODE AS PER MACRO FORM   * 18850000
.*                                                                    * 18900000
.********************************************************************** 18950000
.*                                                                      19000000
.CONT    AIF   ('&VFORM' NE 'L').NOTL                                   19050000
.*                                                                      19100000
.*       ************************************************************** 19150000
.*       *                        L-FORM  (LIST FORM)                 * 19200000
.*       *                                                            * 19205000
.*       * Note: For the L-form, the maximum size parameter list is   * 19210000
.*       *       always generated since the it must be of sufficient  * 19215000
.*       *       size to satisfy any E-form or M-form keyword usage.  * 19220000
.*       *       Regardless of size, the level number is initialized  * 19225000
.*       *       with the lowest value consistent with the specified  * 19230000
.*       *       keywords.  The E-form or M-form expansions will      * 19235000
.*       *       adjust the level number upwards if necessary.        * 19240000
.*       *                                                        @L3A* 19245000
.*       ************************************************************** 19250000
.*                                                                      19300000
&LABL    DC    0F'0'             DIV PARAMETER LIST                     19350000
         DC    XL1'&VCODE'       SERVICE CODE                           19400000
         DC    XL1'&VLEV'        PARAMETER LIST LEVEL                   19450000
         AIF   ('&VSERV' NE 'IDENTIFY').LNOTID                          19500000
.*                                                                      19550000
.*                     ************************************************ 19600000
.*                     *       IDENTIFY L-FORM EXPANSION              * 19650000
.*                     ************************************************ 19700000
.*                                                                      19750000
         AIF   (T'&TYPE EQ 'O').LIDNOTY                                 19800000
         AIF   ('&TYPE' NE 'DA').LIDNTDA                                19850000
         DC    XL1'&VTYDA'       TYPE CODE (TYPE=DA)                    19900000
         AGO   .LID1                                                    19950000
.LIDNTDA ANOP                                                           20000000
         AIF   ('&TYPE' NE 'HS').LIDNTHS                          @L3A  20010000
         DC    XL1'&VTYHS'       TYPE CODE (TYPE=HS)              @L3A  20020000
         AGO   .LID1                                              @L3A  20030000
.LIDNTHS ANOP                                                     @L3A  20040000
.LIDNOTY DC    XL1'0'            TYPE CODE                              20050000
.LID1    AIF   ('&CHECKING' NE 'NO').LID1A                        @L4A  20071400
&VFLGA0  SETC  '1'                                                @L4A  20092800
.LID1A   ANOP                                                     @L4A  20114200
&VTEMP   SETC  '&VFLGA0'.'0000000'                                @L4A  20135600
         DC    BL1'&VTEMP'       FLAGS A                          @L4A  20157000
         AIF   (T'&ID EQ 'O').LIDNOID                             @L4A  20178400
         DC    AL4(&ID)          ADDRESS OF ID STORE AREA               20200000
         AGO   .LID2                                                    20250000
.LIDNOID DC    AL4(0)            ADDRESS OF ID STORE AREA               20300000
.LID2    AIF   (T'&DDNAME EQ 'O').LIDNONA                               20350000
         DC    AL4(&DDNAME)      ADDRESS OF DD NAME                     20400000
         AGO   .LID3                                                    20450000
.LIDNONA DC    AL4(0)            ADDRESS OF DD NAME                     20500000
.LID3    AIF   (T'&TTOKEN EQ 'O' OR '&TTOKEN' EQ '*').LIDNOTT      @L4A 20510000
         DC    AL4(&TTOKEN)      ADDRESS OF TTOKEN                 @L4A 20520000
         AGO   .LID4                                               @L4A 20530000
.LIDNOTT DC    AL4(0)            ADDRESS OF TTOKEN                 @L4A 20540000
.LID4    ANOP                                                      @L4A 20550000
         DC    AL4(0)            RESERVED - MUST BE ZERO           @L4A 20560000
         AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').LIDNOST      @L3A 20570000
         DC    AL4(&STOKEN)      ADDRESS OF STOKEN                 @L3A 20575000
         AGO   .LID5                                               @L3A 20580000
.LIDNOST DC    AL4(0)            ADDRESS OF STOKEN                 @L3A 20585000
.LID5    DC    AL4(0)            RESERVED - MUST BE ZERO           @L3A 20590000
         DC    AL4(0)            RESERVED - MUST BE ZERO           @L3A 20595000
         MEXIT                                                          20600000
.LNOTID  AIF   ('&VSERV' NE 'UNIDENTIFY').LNOTUI                        20650000
.*                                                                      20700000
.*                     ************************************************ 20750000
.*                     *       UNIDENTIFY L-FORM EXPANSION            * 20800000
.*                     ************************************************ 20850000
.*                                                                      20900000
         DC    XL2'00'           RESERVED - MUST BE ZERO                20950000
         AIF   (T'&ID EQ 'O').LUINOID                                   21000000
         DC    AL4(&ID)          ADDRESS OF ID                          21050000
         AGO   .LUI1                                                    21100000
.LUINOID DC    AL4(0)            ADDRESS OF ID                          21150000
.LUI1    ANOP                                                           21200000
         MEXIT                                                          21250000
.LNOTUI  AIF   ('&VSERV' NE 'ACCESS').LNOTAC                            21300000
.*                                                                      21350000
.*                     ************************************************ 21400000
.*                     *          ACCESS  L-FORM EXPANSION            * 21450000
.*                     ************************************************ 21500000
.*                                                                      21550000
         AIF   ('&MODE' EQ 'READ').LACREAD                              21600000
         AIF   ('&MODE' EQ 'UPDATE').LACUPDA                            21650000
         DC    XL1'0'            ACCESS MODE                            21700000
         AGO   .LAC1                                                    21750000
.LACREAD ANOP                                                           21800000
         DC    XL1'1'            ACCESS MODE (READ)                     21850000
         AGO   .LAC1                                                    21900000
.LACUPDA ANOP                                                           21950000
         DC    XL1'2'            ACCESS MODE (UPDATE)                   22000000
.LAC1    AIF   (T'&LOCVIEW EQ 'O' OR '&LOCVIEW' NE 'MAP').LACNOLV @L1C  22050000
&VFLGA1  SETC  '1'                                                      22100000
.LACNOLV ANOP                                                           22150000
&VTEMP   SETC  '&VFLGA0'.'&VFLGA1'.'000000'                             22200000
         DC    BL1'&VTEMP'       FLAGS A                                22250000
         AIF   (T'&ID EQ 'O').LACNOID                                   22300000
         DC    AL4(&ID)          ADDRESS OF ID                          22350000
         AGO   .LAC2                                                    22400000
.LACNOID DC    AL4(0)            ADDRESS OF ID                          22450000
.LAC2    AIF   (T'&SIZE EQ 'O' OR '&SIZE' EQ '*').LACNOSZ               22500000
         DC    AL4(&SIZE)        ADDRESS OF SIZE STORE AREA             22550000
         AGO   .LAC3                                                    22600000
.LACNOSZ DC    AL4(0)            ADDRESS OF SIZE STORE AREA             22650000
.LAC3    ANOP                                                           22700000
         MEXIT                                                          22750000
.LNOTAC  AIF   ('&VSERV' NE 'UNACCESS').LNOTUA                          22800000
.*                                                                      22850000
.*                     ************************************************ 22900000
.*                     *       UNACCESS L-FORM EXPANSION              * 22950000
.*                     ************************************************ 23000000
.*                                                                      23050000
         DC    XL2'00'           RESERVED - MUST BE ZERO                23100000
         AIF   (T'&ID EQ 'O').LUANOID                                   23150000
         DC    AL4(&ID)          ADDRESS OF ID                          23200000
         AGO   .LUA1                                                    23250000
.LUANOID DC    AL4(0)            ADDRESS OF ID                          23300000
.LUA1    ANOP                                                           23350000
         MEXIT                                                          23400000
.LNOTUA  AIF   ('&VSERV' NE 'MAP').LNOTMA                               23450000
.*                                                                      23500000
.*                     ************************************************ 23550000
.*                     *            MAP L-FORM EXPANSION              * 23600000
.*                     ************************************************ 23650000
.*                                                                      23700000
         AIF   (T'&PFCOUNT NE 'O').LMAPFC                          @L3A 23750000
         DC    XL1'0'            PFCOUNT VALUE                     @L3A 23800000
         AGO   .LMA1                                               @L3A 23850000
.LMAPFC  ANOP                                                      @L3A 23900000
         DC    AL1(&PFCOUNT)     PFCOUNT VALUE                     @L3A 23950000
.LMA1    AIF   (T'&RETAIN EQ 'O' OR '&RETAIN' EQ 'NO').LMANORT          24200000
&VFLGA0  SETC  '1'                                                      24250000
.LMANORT ANOP                                                           24300000
&VTEMP   SETC  '&VFLGA0'.'0000000'                                      24350000
         DC    BL1'&VTEMP'       FLAGS A                                24400000
         AIF   (T'&ID EQ 'O').LMANOID                                   24450000
         DC    AL4(&ID)          ADDRESS OF ID                          24500000
         AGO   .LMA2                                                    24550000
.LMANOID DC    AL4(0)            ADDRESS OF ID                          24600000
.LMA2    AIF   (T'&AREA EQ 'O').LMANOAR                                 24650000
         DC    AL4(&AREA)        ADDRESS OF VIRTUAL AREA POINTER        24700000
         AGO   .LMA3                                                    24750000
.LMANOAR DC    AL4(0)            ADDRESS OF VIRTUAL AREA POINTER        24800000
.LMA3    AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').LMANOSP               24850000
         DC    AL4(&SPAN)        ADDRESS OF THE NUMBER OF UNITS TO MAP  24900000
         AGO   .LMA4                                                    24950000
.LMANOSP DC    AL4(0)            ADDRESS OF THE NUMBER OF UNITS TO MAP  25000000
.LMA4    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').LMANOOF           25050000
         DC    AL4(&OFFSET)      ADDRESS OF OFFSET VALUE                25100000
         AGO   .LMA5                                                    25150000
.LMANOOF DC    AL4(0)            ADDRESS OF OFFSET VALUE                25200000
.LMA5    AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').LMANOST     @L2A  25212500
         DC    AL4(&STOKEN)      ADDRESS OF STOKEN                @L2A  25225000
         AGO   .LMA6                                              @L2A  25237500
.LMANOST DC    AL4(0)            ADDRESS OF STOKEN                @L2A  25250000
.LMA6    ANOP                                                           25262500
         DC    AL4(0)            WORD 6 RESERVED - MUST BE 0      @L2A  25275000
         DC    AL4(0)            WORD 7 RESERVED - MUST BE 0      @L2A  25287500
         MEXIT                                                          25300000
.LNOTMA  AIF   ('&VSERV' NE 'UNMAP').LNOTUM                             25350000
.*                                                                      25400000
.*                     ************************************************ 25450000
.*                     *          UNMAP L-FORM EXPANSION              * 25500000
.*                     ************************************************ 25550000
.*                                                                      25600000
         DC    XL1'00'           RESERVED - MUST BE ZERO                25650000
         AIF   (T'&RETAIN EQ 'O' OR '&RETAIN' EQ 'NO').LUMNORT          25700000
&VFLGA0  SETC  '1'                                                      25750000
.LUMNORT ANOP                                                           25800000
&VTEMP   SETC  '&VFLGA0'.'0000000'                                      25850000
         DC    BL1'&VTEMP'       FLAGS A                                25900000
         AIF   (T'&ID EQ 'O').LUMNOID                                   25950000
         DC    AL4(&ID)          ADDRESS OF ID                          26000000
         AGO   .LUM1                                                    26050000
.LUMNOID DC    AL4(0)            ADDRESS OF ID                          26100000
.LUM1    AIF   (T'&AREA EQ 'O').LUMNOAR                                 26150000
         DC    AL4(&AREA)        ADDRESS OF VIRTUAL AREA POINTER        26200000
         AGO   .LUM2                                                    26250000
.LUMNOAR DC    AL4(0)            ADDRESS OF VIRTUAL AREA POINTER        26300000
.LUM2    ANOP                                                           26350000
         DC    AL4(0)            WORD 3 RESERVED - MUST BE 0      @L3A  26355000
         DC    AL4(0)            WORD 4 RESERVED - MUST BE 0      @L3A  26360000
         AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').LUMNOST     @L3A  26365000
         DC    AL4(&STOKEN)      ADDRESS OF STOKEN                @L3A  26370000
         AGO   .LUM3                                              @L3A  26375000
.LUMNOST DC    AL4(0)            ADDRESS OF STOKEN                @L3A  26380000
.LUM3    ANOP                                                     @L3A  26385000
         DC    AL4(0)            WORD 6 RESERVED - MUST BE 0      @L3A  26390000
         DC    AL4(0)            WORD 7 RESERVED - MUST BE 0      @L3A  26395000
         MEXIT                                                          26400000
.LNOTUM  AIF   ('&VSERV' NE 'RESET').LNOTRE                             26450000
.*                                                                      26500000
.*                     ************************************************ 26550000
.*                     *          RESET L-FORM EXPANSION              * 26600000
.*                     ************************************************ 26650000
.*                                                                      26700000
         DC    XL1'00'           RESERVED - MUST BE ZERO          @L3C  26714200
         AIF   (T'&RELEASE EQ 'O' OR '&RELEASE' EQ 'NO').LRENORL  @L3A  26728400
&VFLGA0  SETC  '1'                                                @L3A  26742600
.LRENORL ANOP                                                     @L3A  26756800
&VTEMP   SETC  '&VFLGA0'.'0000000'                                @L3A  26771000
         DC    BL1'&VTEMP'       FLAGS A                          @L3A  26785200
         AIF   (T'&ID EQ 'O').LRENOID                                   26800000
         DC    AL4(&ID)          ADDRESS OF ID                          26850000
         AGO   .LRE1                                                    26900000
.LRENOID DC    AL4(0)            ADDRESS OF ID                          26950000
.LRE1    DC    F'0'              RESERVED - MUST BE ZERO                27000000
         AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').LRENOSP               27050000
         DC    AL4(&SPAN)        ADDRESS OF THE NO. OF UNITS TO RESET   27100000
         AGO   .LRE2                                                    27150000
.LRENOSP DC    AL4(0)            ADDRESS OF THE NO. OF UNITS TO RESET   27200000
.LRE2    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').LRENOOF           27250000
         DC    AL4(&OFFSET)      ADDRESS OF OFFSET VALUE                27300000
         AGO   .LRE3                                                    27350000
.LRENOOF DC    AL4(0)            ADDRESS OF OFFSET VALUE                27400000
.LRE3    ANOP                                                           27450000
         MEXIT                                                          27500000
.LNOTRE  AIF   ('&VSERV' NE 'SAVE').LNOTSA                              27550000
.*                                                                      27600000
.*                     ************************************************ 27650000
.*                     *           SAVE L-FORM EXPANSION              * 27700000
.*                     ************************************************ 27750000
.*                                                                      27800000
         DC    XL2'00'           RESERVED - MUST BE ZERO                27850000
         AIF   (T'&ID EQ 'O').LSANOID                                   27900000
         DC    AL4(&ID)          ADDRESS OF ID                          27950000
         AGO   .LSA1                                                    28000000
.LSANOID DC    AL4(0)            ADDRESS OF ID                          28050000
.LSA1    AIF   (T'&SIZE EQ 'O' OR '&SIZE' EQ '*').LSANOSZ               28100000
         DC    AL4(&SIZE)        ADDRESS OF SIZE STORE AREA             28150000
         AGO   .LSA2                                                    28200000
.LSANOSZ DC    AL4(0)            ADDRESS OF SIZE STORE AREA             28250000
.LSA2    AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').LSANOSP               28300000
         DC    AL4(&SPAN)        ADDRESS OF THE NO. OF UNITS TO SAVE    28350000
         AGO   .LSA3                                                    28400000
.LSANOSP DC    AL4(0)            ADDRESS OF THE NO. OF UNITS TO SAVE    28450000
.LSA3    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').LSANOOF           28500000
         DC    AL4(&OFFSET)      ADDRESS OF OFFSET VALUE                28550000
         AGO   .LSA4                                                    28600000
.LSANOOF DC    AL4(0)            ADDRESS OF OFFSET VALUE                28650000
.LSA4    AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').LSANOST      @P1A 28653000
         DC    AL4(&STOKEN)      ADDRESS OF STOKEN                 @P1A 28656000
         AGO   .LSA5                                               @P1A 28659000
.LSANOST DC    AL4(0)            ADDRESS OF STOKEN                 @P1A 28662000
.LSA5    AIF   ('&LISTAD' EQ '' OR '&LISTAD' EQ '*').LSANOLA       @P1C 28665000
         DC    AL4(&LISTAD)      ADDRESS OF LISTADDR               @L5A 28668000
         AGO   .LSA6                                               @P1C 28677000
.LSANOLA DC    AL4(0)            ADDRESS OF LISTADDR               @L5A 28686000
.LSA6    AIF   ('&LISTSZ' EQ '' OR '&LISTSZ' EQ '*').LSANOLS       @P1C 28695000
         DC    AL4(&LISTSZ)      ADDRESS OF LISTSIZE VALUE         @L5A 28704000
         AGO   .LSA7                                               @P1C 28713000
.LSANOLS DC    AL4(0)            ADDRESS OF LISTSIZE VALUE         @L5A 28722000
.LSA7    ANOP                                                      @P1C 28736000
         MEXIT                                                          28750000
.LNOTSA  AIF   ('&VSERV' NE 'SAVELIST').LNOTSL                     @L5A 28753100
.*                                                                      28756200
.*               ************************************************  @L5A 28759300
.*               *           SAVELIST L-FORM EXPANSION          *  @L5A 28762400
.*               ************************************************  @L5A 28765500
.*                                                                      28768600
         DC    XL2'00'           RESERVED - MUST BE ZERO           @L5A 28771700
         AIF   (T'&ID EQ 'O').LSLNOID                              @L5A 28774800
         DC    AL4(&ID)          ADDRESS OF ID                     @L5A 28777900
         AGO   .LSL1                                               @L5A 28781000
.LSLNOID DC    AL4(0)            ADDRESS OF ID                     @L5A 28784100
.LSL1    DC    F'0'              RESERVED - MUST BE ZERO           @L5A 28787200
         AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').LSLNOSP          @L5A 28790300
         DC    AL4(&SPAN)    ADDRESS OF THE NO. OF UNITS TO SAVE   @L5A 28793400
         AGO   .LSL2                                               @L5A 28796500
.LSLNOSP DC    AL4(0)        ADDRESS OF THE NO. OF UNITS TO SAVE   @L5A 28799600
.LSL2    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').LSLNOOF      @L5A 28802700
         DC    AL4(&OFFSET)      ADDRESS OF OFFSET VALUE           @L5A 28805800
         AGO   .LSL3                                               @L5A 28808900
.LSLNOOF DC    AL4(0)            ADDRESS OF OFFSET VALUE           @L5A 28812000
.LSL3    ANOP                                                      @P1A 28813500
         DC    AL4(0)            WORD 5 RESERVED - MUST BE 0       @P1C 28815000
         AIF   ('&LISTAD' EQ '' OR '&LISTAD' EQ '*').LSLNOLA       @P1C 28816500
         DC    AL4(&LISTAD)      ADDRESS OF LISTADDR               @L5A 28818200
         AGO   .LSL4                                               @L5A 28821300
.LSLNOLA DC    AL4(0)            ADDRESS OF LISTADDR               @L5A 28824400
.LSL4    AIF   ('&LISTSZ' EQ '' OR '&LISTSZ' EQ '*').LSLNOLS       @L5A 28827500
         DC    AL4(&LISTSZ)      ADDRESS OF LISTSIZE VALUE         @L5A 28830600
         AGO   .LSL6                                               @L5A 28833700
.LSLNOLS DC    AL4(0)            ADDRESS OF LISTSIZE VALUE         @L5A 28836800
.LSL6    ANOP                                                      @L5A 28839900
.LNOTSL  MEXIT                                                     @L5A 28846100
.*                                                                      28850000
.*       ************************************************************** 28900000
.*       *                        I-FORM  (STANDARD FORM)             * 28950000
.*       ************************************************************** 29000000
.*                                                                      29050000
.NOTL    AIF   ('&VFORM' NE 'I').NOTI                                   29100000
         CNOP  0,4                                                      29150000
         AIF   ('&SYSASCE' NE 'AR').NOTARI1                        @01A 29158300
&LABL    SAC   0                 GO INTO PRIMARY ASC MODE          @01A 29166600
         STM   14,12,12(13)      SAVE CALLER'S REGISTERS           @01A 29174900
         AGO   .NOTARI2                                            @01A 29183200
.NOTARI1 ANOP                                                      @01A 29191500
&LABL    STM   14,12,12(13)      SAVE CALLER'S REGISTERS                29200000
.NOTARI2 BAS   1,&VLAB1          BRANCH AROUND THE PARAMETER LIST  @01C 29250000
         DC    XL1'&VCODE'       SERVICE CODE                           29300000
         DC    XL1'&VLEV'        PARAMETER LIST LEVEL                   29350000
         AIF   ('&VSERV' NE 'IDENTIFY').INOTID                          29400000
.*                                                                      29450000
.*                     ************************************************ 29500000
.*                     *       IDENTIFY I-FORM EXPANSION              * 29550000
.*                     ************************************************ 29600000
.*                                                                      29650000
         AIF   ('&TYPE' NE 'DA').IIDNTDA                                29700000
         DC    XL1'&VTYDA'       TYPE CODE (TYPE=DA)                    29750000
         AGO   .IID1                                                    29800000
.IIDNTDA ANOP                                                           29850000
         AIF   ('&TYPE' NE 'HS').IIDNTHS                           @L3A 29860000
         DC    XL1'&VTYHS'       TYPE CODE (TYPE=HS)               @L3A 29870000
         AGO   .IID1                                               @L3A 29880000
.IIDNTHS ANOP                                                      @L3A 29890000
.IID1    AIF   ('&CHECKING' NE 'NO').IID1A                         @L4A 29900000
&VFLGA0  SETC  '1'                                                 @L4A 29910000
.IID1A   ANOP                                                      @L4A 29920000
&VTEMP   SETC  '&VFLGA0'.'0000000'                                 @L4A 29930000
         DC    BL1'&VTEMP'       FLAGS A                           @L4A 29940000
&VLABB   DC    AL4(0)            ADDRESS OF ID STORE AREA               29950000
&VLABC   DC    AL4(0)            ADDRESS OF DD NAME OR ZERO             29961100
         AIF   ('&TYPE' EQ 'DA' AND '&VLEV' EQ '1').IIDSHT              29969400
.*                               Finished with short parm list     @L4C 29977700
&VLABD   DC    AL4(0)            ADDRESS OF TTOKEN                 @L4A 29986000
&VLABE   DC    AL4(0)            RESERVED - MUST BE ZERO           @L3A 29994400
&VLABF   DC    AL4(0)            ADDRESS OF STOKEN OR ZERO         @L3A 30005500
&VLABG   DC    AL4(0)            RESERVED - MUST BE ZERO           @L3A 30016600
&VLABH   DC    AL4(0)            RESERVED - MUST BE ZERO           @L3A 30027700
.IIDSHT  ANOP                                                      @L3A 30038800
         AIF   ('&ID'(1,1) EQ '(').IID2                                 30050000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID STORE AREA           30100000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         30150000
         AGO   .IID3                                                    30200000
.IID2    ANOP                                                           30250000
&VLAB1   ST    &ID(1),&VLABB     PUT ID STORE AREA ADDR INTO PARM LIST  30300000
.IID3    AIF   ('&TYPE' EQ 'HS').IID5                                   30333300
         AIF   ('&DDNAME'(1,1) EQ '(').IID4                             30366600
         LA    15,&DDNAME        GET ADDRESS OF DD NAME                 30400000
         ST    15,&VLABC         PUT IT INTO THE PARAMETER LIST         30450000
         AGO   .IID4A                                             @L3C  30500000
.IID4    ST    &DDNAME(1),&VLABC PUT ADDRESS OF DDNAME INTO PARM LIST   30550000
.IID4A   AIF   ('&TYPE' EQ 'DA' AND '&VLEV' EQ '1').XCOMMON             30552200
.*                               Finished with short parm list    @L4C  30554400
.IID5    AIF   (T'&TTOKEN EQ 'O' OR '&TTOKEN' EQ '*').IID7        @L4A  30556600
         AIF   ('&TTOKEN'(1,1) EQ '(').IID6                       @L4A  30558800
         LA    15,&TTOKEN        GET ADDRESS OF TTOKEN            @L4A  30561000
         ST    15,&VLABD         PUT IT INTO THE PARAMETER LIST   @L4A  30563200
         AGO   .IID7                                              @L4A  30565400
.IID6    ST    &TTOKEN(1),&VLABD PUT TTOKEN ADDRESS INTO PARM LIST      30567600
.IID7    AIF   ('&TYPE' EQ 'DA').XCOMMON                          @L3A  30569800
         AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').XCOMMON     @L3A  30572200
         AIF   ('&STOKEN'(1,1) EQ '(').IID8                       @L3A  30583300
         LA    15,&STOKEN        GET ADDRESS OF STOKEN VALUE      @L3A  30594400
         ST    15,&VLABF         PUT IT INTO THE PARAMETER LIST   @L3A  30605500
         AGO   .XCOMMON                                           @L3A  30616600
.IID8    ST    &STOKEN(1),&VLABF PUT STOKEN ADDR INTO PARAMETER LIST    30627700
         AGO   .XCOMMON                                           @L3A  30638800
.INOTID  AIF   ('&VSERV' NE 'UNIDENTIFY').INOTUI                        30650000
.*                                                                      30700000
.*                     ************************************************ 30750000
.*                     *       UNIDENTIFY I-FORM EXPANSION            * 30800000
.*                     ************************************************ 30850000
.*                                                                      30900000
         DC    XL2'00'           RESERVED - MUST BE ZERO                30950000
&VLABB   DC    AL4(0)            ADDRESS OF ID                          31000000
         AIF   ('&ID'(1,1) EQ '(').IUI1                                 31050000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                      31100000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         31150000
         AGO   .XCOMMON                                                 31200000
.IUI1    ANOP                                                           31250000
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARM LIST          31300000
         AGO   .XCOMMON                                                 31350000
.INOTUI  AIF   ('&VSERV' NE 'ACCESS').INOTAC                            31400000
.*                                                                      31450000
.*                     ************************************************ 31500000
.*                     *           ACCESS I-FORM EXPANSION            * 31550000
.*                     ************************************************ 31600000
.*                                                                      31650000
         AIF   ('&MODE' EQ 'READ').IACREAD                              31700000
         AIF   ('&MODE' EQ 'UPDATE').IACUPDA                            31750000
         AGO   .IAC1                                                    31800000
.IACREAD DC    XL1'1'            ACCESS MODE (READ)                     31850000
         AGO   .IAC1                                                    31900000
.IACUPDA DC    XL1'2'            ACCESS MODE (UPDATE)                   31950000
.IAC1    AIF   (T'&LOCVIEW EQ 'O' OR '&LOCVIEW' NE 'MAP').IACNOLV @L1C  32000000
&VFLGA1  SETC  '1'                                                @L1A  32050000
.IACNOLV ANOP                                                     @L1A  32100000
&VTEMP   SETC  '&VFLGA0'.'&VFLGA1'.'000000'                       @L1A  32150000
         DC    BL1'&VTEMP'       FLAGS A                          @L1A  32200000
&VLABB   DC    AL4(0)            ADDRESS OF ID                          32250000
&VLABC   DC    AL4(0)            ADDRESS OF SIZE STORE AREA             32300000
         AIF   ('&ID'(1,1) EQ '(').IAC2                                 32350000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                      32400000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         32450000
         AGO   .IAC3                                                    32500000
.IAC2    ANOP                                                           32550000
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARAMETER LIST     32600000
.IAC3    AIF   (T'&SIZE EQ 'O' OR '&SIZE' EQ '*').IAC5                  32650000
         AIF   ('&SIZE'(1,1) EQ '(').IAC4                               32700000
         LA    15,&SIZE          GET ADDRESS OF SIZE STORE AREA         32750000
         ST    15,&VLABC         PUT IT INTO THE PARAMETER LIST         32800000
         AGO   .IAC5                                                    32850000
.IAC4    ST    &SIZE(1),&VLABC   PUT SIZE STORE AREA ADDRESS INTO LIST  32900000
.IAC5    ANOP                                                           32950000
         AGO   .XCOMMON                                                 33000000
.INOTAC  AIF   ('&VSERV' NE 'UNACCESS').INOTUA                          33050000
.*                                                                      33100000
.*                     ************************************************ 33150000
.*                     *           UNACCESS I-FORM EXPANSION          * 33200000
.*                     ************************************************ 33250000
.*                                                                      33300000
         DC    XL2'00'           RESERVED - MUST BE ZERO                33350000
&VLABB   DC    AL4(0)            ADDRESS OF ID                          33400000
         AIF   ('&ID'(1,1) EQ '(').IUA1                                 33450000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                      33500000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         33550000
         AGO   .XCOMMON                                                 33600000
.IUA1    ANOP                                                           33650000
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARAMETER LIST     33700000
         AGO   .XCOMMON                                                 33750000
.INOTUA  AIF   ('&VSERV' NE 'MAP').INOTMA                               33800000
.*                                                                      33850000
.*                     ************************************************ 33900000
.*                     *                MAP I-FORM EXPANSION          * 33950000
.*                     ************************************************ 34000000
.*                                                                      34050000
         AIF   (T'&PFCOUNT NE 'O').IMAPFC                          @L3C 34100000
         DC    XL1'00'           PFCOUNT                           @L3C 34150000
         AGO   .IMA1                                               @L3C 34200000
.IMAPFC  ANOP                                                      @L3C 34250000
         DC    AL1(&PFCOUNT)     PFCOUNT                           @L3C 34300000
.IMA1    AIF   (T'&RETAIN EQ 'O' OR '&RETAIN' EQ 'NO').IMANORT          34550000
&VFLGA0  SETC  '1'                                                      34600000
.IMANORT ANOP                                                           34650000
&VTEMP   SETC  '&VFLGA0'.'0000000'                                      34700000
         DC    BL1'&VTEMP'       FLAGS A                                34750000
&VLABB   DC    AL4(0)            ADDRESS OF ID                          34800000
&VLABC   DC    AL4(0)            ADDRESS OF VIRTUAL AREA POINTER        34850000
&VLABD   DC    AL4(0)            ADDRESS OF SPAN VALUE                  34900000
&VLABE   DC    AL4(0)            ADDRESS OF OFFSET VALUE                34950000
         AIF   ('&VLEV' EQ '1' ).IMANL2 Finished if level 1 parms  @L2A 34958300
&VLABF   DC    AL4(0)            ADDRESS OF STOKEN VALUE           @L2A 34966600
&VLABG   DC    AL4(0)            RESERVED - MUST BE ZERO           @L2A 34974900
&VLABH   DC    AL4(0)            RESERVED - MUST BE ZERO           @L2A 34983200
.IMANL2  ANOP                                                           34991500
         AIF   ('&ID'(1,1) EQ '(').IMA2                                 35000000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                      35050000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         35100000
         AGO   .IMA3                                                    35150000
.IMA2    ANOP                                                           35200000
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARAMETER LIST     35250000
.IMA3    AIF   ('&AREA'(1,1) EQ '(').IMA5                               35300000
         AIF   ('&AREA' NE '*').IMA4                                    35350000
         AGO   .IMA6                                                    35400000
.IMA4    LA    15,&AREA          GET ADDRESS OF VIRTUAL AREA POINTER    35450000
         ST    15,&VLABC         PUT IT INTO THE PARAMETER LIST         35500000
         AGO   .IMA6                                                    35550000
.IMA5    ST    &AREA(1),&VLABC   PUT ADDRESS OF AREA POINTER INTO LIST  35600000
.IMA6    AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').IMA8                  35650000
         AIF   ('&SPAN'(1,1) EQ '(').IMA7                               35700000
         LA    15,&SPAN          GET ADDRESS OF SPAN VALUE              35750000
         ST    15,&VLABD         PUT IT INTO THE PARAMETER LIST         35800000
         AGO   .IMA8                                                    35850000
.IMA7    ST    &SPAN(1),&VLABD   PUT SPAN VALUE ADDRESS INTO PARM LIST  35900000
.IMA8    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').IMA10       @L2C  35950000
         AIF   ('&OFFSET'(1,1) EQ '(').IMA9                             36000000
         LA    15,&OFFSET        GET ADDRESS OF OFFSET VALUE            36050000
         ST    15,&VLABE         PUT IT INTO THE PARAMETER LIST         36100000
         AGO   .IMA10                                             @L2C  36150000
.IMA9    ST    &OFFSET(1),&VLABE PUT OFFSET ADDR INTO PARAMETER LIST    36200000
.IMA10   AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').XCOMMON     @L2A  36211100
         AIF   ('&STOKEN'(1,1) EQ '(').IMA11                      @L2A  36222200
         LA    15,&STOKEN        GET ADDRESS OF STOKEN VALUE      @L2A  36233300
         ST    15,&VLABF         PUT IT INTO THE PARAMETER LIST   @L2A  36244400
         AGO   .XCOMMON                                           @L2A  36255500
.IMA11   ST    &STOKEN(1),&VLABF PUT STOKEN ADDR INTO PARAMETER LIST    36266600
.*                                                                @L2A  36277700
         AGO   .XCOMMON                                           @L2M  36288800
.INOTMA  AIF   ('&VSERV' NE 'UNMAP').INOTUM                             36300000
.*                                                                      36350000
.*                     ************************************************ 36400000
.*                     *              UMMAP I-FORM EXPANSION          * 36450000
.*                     ************************************************ 36500000
.*                                                                      36550000
         DC    XL1'00'           RESERVED - MUST BE ZERO                36600000
         AIF   (T'&RETAIN EQ 'O' OR '&RETAIN' EQ 'NO').IUMNORT          36650000
&VFLGA0  SETC  '1'                                                      36700000
.IUMNORT ANOP                                                           36750000
&VTEMP   SETC  '&VFLGA0'.'0000000'                                      36800000
         DC    BL1'&VTEMP'       FLAGS A                                36850000
&VLABB   DC    AL4(0)            ADDRESS OF ID                          36900000
&VLABC   DC    AL4(0)            ADDRESS OF VIRTUAL AREA POINTER        36950000
         AIF   ('&VLEV' EQ '1' ).IUMNL2 Finished if level 1 parms  @L2A 36956200
&VLABD   DC    AL4(0)            RESERVED - MUST BE ZERO           @L2A 36962400
&VLABE   DC    AL4(0)            RESERVED - MUST BE ZERO           @L2A 36968600
&VLABF   DC    AL4(0)            ADDRESS OF STOKEN VALUE           @L2A 36974800
&VLABG   DC    AL4(0)            RESERVED - MUST BE ZERO           @L2A 36981000
&VLABH   DC    AL4(0)            RESERVED - MUST BE ZERO           @L2A 36987200
.IUMNL2  ANOP                                                      @L2A 36993400
         AIF   ('&ID'(1,1) EQ '(').IUM1                                 37000000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                      37050000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         37100000
         AGO   .IUM2                                                    37150000
.IUM1    ANOP                                                           37200000
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARAMETER LIST     37250000
.IUM2    AIF   ('&AREA'(1,1) EQ '(').IUM4                               37300000
         AIF   ('&AREA' NE '*').IUM3                                    37350000
         AGO   .IUM5                                                    37400000
.IUM3    LA    15,&AREA          GET ADDRESS OF VIRTUAL AREA POINTER    37450000
         ST    15,&VLABC         PUT IT INTO THE PARAMETER LIST         37500000
         AGO   .IUM5                                                    37550000
.IUM4    ST    &AREA(1),&VLABC   PUT ADDRESS OF AREA POINTER INTO LIST  37600000
.IUM5    AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').XCOMMON     @L3A  37606200
         AIF   ('&STOKEN'(1,1) EQ '(').IUM6                       @L3A  37612400
         LA    15,&STOKEN        GET ADDRESS OF STOKEN VALUE      @L3A  37618600
         ST    15,&VLABF         PUT IT INTO THE PARAMETER LIST   @L3A  37624800
         AGO   .XCOMMON                                           @L3A  37631000
.IUM6    ST    &STOKEN(1),&VLABF PUT STOKEN ADDR INTO PARAMETER LIST    37637200
.*                                                                @L3A  37643400
         AGO   .XCOMMON                                                 37650000
.INOTUM  AIF   ('&VSERV' NE 'RESET').INOTRE                             37700000
.*                                                                      37750000
.*                     ************************************************ 37800000
.*                     *              RESET I-FORM EXPANSION          * 37850000
.*                     ************************************************ 37900000
.*                                                                      37950000
         DC    XL1'00'           RESERVED - MUST BE ZERO          @L3C  37964200
         AIF   (T'&RELEASE EQ 'O' OR '&RELEASE' EQ 'NO').IRENORL  @L3A  37978400
&VFLGA0  SETC  '1'                                                @L3A  37992600
.IRENORL ANOP                                                     @L3A  38006800
&VTEMP   SETC  '&VFLGA0'.'0000000'                                @L3A  38021000
         DC    BL1'&VTEMP'       FLAGS A                          @L3A  38035200
&VLABB   DC    AL4(0)            ADDRESS OF ID                          38050000
         DC    AL4(0)            RESERVED - MUST BE ZERO                38100000
&VLABD   DC    AL4(0)            ADDRESS OF SPAN VALUE                  38150000
&VLABE   DC    AL4(0)            ADDRESS OF OFFSET VALUE                38200000
         AIF   ('&ID'(1,1) EQ '(').IRE1                                 38250000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                      38300000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         38350000
         AGO   .IRE2                                                    38400000
.IRE1    ANOP                                                           38450000
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARAMETER LIST     38500000
.IRE2    AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').IRE4                  38550000
         AIF   ('&SPAN'(1,1) EQ '(').IRE3                               38600000
         LA    15,&SPAN          GET ADDRESS OF SPAN VALUE              38650000
         ST    15,&VLABD         PUT IT INTO THE PARAMETER LIST         38700000
         AGO   .IRE4                                                    38750000
.IRE3    ST    &SPAN(1),&VLABD   PUT ADDRESS OF SPAN VALUE INTO LIST    38800000
.IRE4    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').XCOMMON           38850000
         AIF   ('&OFFSET'(1,1) EQ '(').IRE5                             38900000
         LA    15,&OFFSET        GET ADDRESS OF OFFSET VALUE            38950000
         ST    15,&VLABE         PUT IT INTO THE PARAMETER LIST         39000000
         AGO   .XCOMMON                                                 39050000
.IRE5    ST    &OFFSET(1),&VLABE PUT OFFSET ADDR INTO PARAMETER LIST    39100000
         AGO   .XCOMMON                                                 39150000
.INOTRE  AIF   ('&VSERV' NE 'SAVE').INOTSA                              39200000
.*                                                                      39250000
.*                     ************************************************ 39300000
.*                     *               SAVE I-FORM EXPANSION          * 39350000
.*                     ************************************************ 39400000
.*                                                                      39450000
         DC    XL2'00'           RESERVED - MUST BE ZERO                39500000
&VLABB   DC    AL4(0)            ADDRESS OF ID                          39550000
&VLABC   DC    AL4(0)            ADDRESS OF SIZE STORE AREA             39600000
&VLABD   DC    AL4(0)            ADDRESS OF SPAN VALUE                  39650000
&VLABE   DC    AL4(0)            ADDRESS OF OFFSET VALUE                39700000
         AIF   ('&VLEV' EQ '1').ISA0   Finished if level 1 parms   @L5A 39708300
&VLABF   DC    AL4(0)            ADDRESS OF STOKEN VALUE           @P1C 39716600
&VLABG   DC    AL4(0)            ADDRESS OF LISTADDR               @P1C 39724900
&VLABH   DC    AL4(0)            ADDRESS OF LISTSIZE VALUE         @P1C 39733200
.ISA0    ANOP                                                      @L5A 39741500
         AIF   ('&ID'(1,1) EQ '(').ISA1                                 39750000
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                      39800000
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST         39850000
         AGO   .ISA2                                                    39900000
.ISA1    ANOP                                                           39950000
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARAMETER LIST     40000000
.ISA2    AIF   (T'&SIZE EQ 'O' OR '&SIZE' EQ '*').ISA4                  40050000
         AIF   ('&SIZE'(1,1) EQ '(').ISA3                               40100000
         LA    15,&SIZE          GET ADDRESS OF SIZE STORE AREA         40150000
         ST    15,&VLABC         PUT IT INTO THE PARAMETER LIST         40200000
         AGO   .ISA4                                                    40250000
.ISA3    ST    &SIZE(1),&VLABC   PUT SIZE STORE AREA ADDRESS INTO LIST  40300000
.ISA4    AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').ISA6                  40350000
         AIF   ('&SPAN'(1,1) EQ '(').ISA5                               40400000
         LA    15,&SPAN          GET ADDRESS OF SPAN VALUE              40450000
         ST    15,&VLABD         PUT IT INTO THE PARAMETER LIST         40500000
         AGO   .ISA6                                                    40550000
.ISA5    ST    &SPAN(1),&VLABD   PUT ADDRESS OF SPAN VALUE INTO LIST    40600000
.ISA6    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').ISA8         @L5A 40650000
         AIF   ('&OFFSET'(1,1) EQ '(').ISA7                             40700000
         LA    15,&OFFSET        GET ADDRESS OF OFFSET VALUE            40750000
         ST    15,&VLABE         PUT IT INTO THE PARAMETER LIST         40800000
         AGO   .ISA8                                               @L5A 40850000
.ISA7    ST    &OFFSET(1),&VLABE PUT OFFSET ADDR INTO PARAMETER LIST    40900000
.ISA8    AIF   (T'&STOKEN EQ 'O' OR '&STOKEN' EQ '*').ISAA         @P1A 40901200
         AIF   ('&STOKEN'(1,1) EQ '(').ISA9                        @P1A 40902400
         LA    15,&STOKEN        GET ADDRESS OF STOKEN VALUE       @P1A 40903600
         ST    15,&VLABF         PUT IT INTO THE PARAMETER LIST    @P1A 40904800
         AGO   .ISAA                                               @P1A 40906000
.ISA9    ST    &STOKEN(1),&VLABF PUT STOKEN ADDR INTO PARAMETER LIST    40907200
.ISAA    AIF   ('&LISTAD' EQ '' OR '&LISTAD' EQ '*').ISAC          @P1C 40908400
         AIF   ('&LISTAD'(1,1) EQ '(').ISAB                        @P1C 40909600
         LA    15,&LISTAD        GET ADDRESS OF LISTADDR           @L5A 40911400
         ST    15,&VLABG         PUT IT INTO THE PARAMETER LIST    @P1C 40915200
         AGO   .ISAC                                               @P1C 40919000
.ISAB    ST    &LISTAD,&VLABG PUT LISTADDR ADDR INTO PARM LIST     @P1C 40922800
.ISAC    AIF   ('&LISTSZ' EQ '' OR '&LISTSZ' EQ '*').XCOMMON       @L5A 40926600
         AIF   ('&LISTSZ'(1,1) EQ '(').ISAD                        @P1C 40930400
         LA    15,&LISTSZ        GET ADDRESS OF LISTSIZE VALUE     @L5A 40934200
         ST    15,&VLABH         PUT IT INTO THE PARAMETER LIST    @P1C 40938000
         AGO   .XCOMMON                                            @L5A 40941800
.ISAD    ST    &LISTSZ,&VLABH PUT LISTSIZE ADDR INTO PARM LIST     @P1C 40945600
         AGO   .XCOMMON                                                 40950000
.INOTSA  AIF   ('&VSERV' NE 'SAVELIST').INOTSL                     @L5A 40952100
.*                                                                      40954200
.*           ****************************************************  @L5A 40956300
.*           *               SAVELIST I-FORM EXPANSION          *  @L5A 40958400
.*           ****************************************************  @L5A 40960500
.*                                                                 @L5A 40962600
         DC    XL2'00'           RESERVED - MUST BE ZERO           @L5A 40964700
&VLABB   DC    AL4(0)            ADDRESS OF ID                     @L5A 40966800
         DC    AL4(0)            RESERVED - MUST BE ZERO           @L5A 40968900
&VLABD   DC    AL4(0)            ADDRESS OF SPAN VALUE             @L5A 40971000
&VLABE   DC    AL4(0)            ADDRESS OF OFFSET VALUE           @L5A 40973100
         DC    AL4(0)            RESERVED - MUST BE ZERO           @P1C 40975200
&VLABG   DC    AL4(0)            ADDRESS OF LISTADDR               @P1C 40977300
&VLABH   DC    AL4(0)            ADDRESS OF LISTSIZE VALUE         @P1C 40979400
         AIF   ('&ID'(1,1) EQ '(').ISL1                            @L5A 40981500
&VLAB1   LA    15,&ID            GET ADDRESS OF ID                 @L5A 40983600
         ST    15,&VLABB         PUT IT INTO THE PARAMETER LIST    @L5A 40985700
         AGO   .ISL2                                               @L5A 40987800
.ISL1    ANOP                                                      @L5A 40989900
&VLAB1   ST    &ID(1),&VLABB     PUT ID ADDRESS INTO PARAMETER LST @L5A 40992000
.ISL2    AIF   (T'&SPAN EQ 'O' OR '&SPAN' EQ '*').ISL4             @L5A 40994100
         AIF   ('&SPAN'(1,1) EQ '(').ISL3                          @L5A 40996200
         LA    15,&SPAN          GET ADDRESS OF SPAN VALUE         @L5A 40998300
         ST    15,&VLABD         PUT IT INTO THE PARAMETER LIST    @L5A 41000400
         AGO   .ISL4                                               @L5A 41002500
.ISL3    ST    &SPAN(1),&VLABD  PUT ADDRESS OF SPAN VALUE INTO LST @L5A 41004600
.ISL4    AIF   (T'&OFFSET EQ 'O' OR '&OFFSET' EQ '*').ISL6         @L5A 41006700
         AIF   ('&OFFSET'(1,1) EQ '(').ISL5                        @L5A 41008800
         LA    15,&OFFSET        GET ADDRESS OF OFFSET VALUE       @L5A 41010900
         ST    15,&VLABE         PUT IT INTO THE PARAMETER LIST    @L5A 41013000
         AGO   .ISL6                                               @L5A 41015100
.ISL5    ST    &OFFSET(1),&VLABE PUT OFFSET ADDR INTO PARM LIST    @L5A 41017200
.ISL6    AIF   ('&LISTAD' EQ '' OR '&LISTAD' EQ '*').ISL8          @L5A 41019300
         AIF   ('&LISTAD'(1,1) EQ '(').ISL7                        @L5A 41021400
         LA    15,&LISTAD        GET ADDRESS OF LISTADDR           @L5A 41023500
         ST    15,&VLABG         PUT IT INTO THE PARAMETER LIST    @P1C 41025600
         AGO   .ISL8                                               @L5A 41027700
.ISL7    ST    &LISTAD,&VLABG PUT LISTADDR ADDR INTO PARM LIST     @P1C 41029800
.ISL8    AIF   ('&LISTSZ' EQ '' OR '&LISTSZ' EQ '*').XCOMMON       @L5A 41031900
         AIF   ('&LISTSZ'(1,1) EQ '(').ISL9                        @L5A 41034000
         LA    15,&LISTSZ        GET ADDRESS OF LISTSIZE VALUE     @L5A 41036100
         ST    15,&VLABH         PUT IT INTO THE PARAMETER LIST    @P1C 41038200
         AGO   .XCOMMON                                            @L5A 41040300
.ISL9    ST    &LISTSZ,&VLABH PUT LISTSIZE ADDR INTO PARM LIST     @P1C 41042400
         AGO   .XCOMMON                                            @L5A 41044500
.INOTSL  MEXIT                                                     @L5A 41046600
.*                                                                      41050000
.*       ************************************************************** 41100000
.*       *                        E-FORM  (EXECUTE FORM)              * 41150000
.*       ************************************************************** 41200000
.*                                                                      41250000
.NOTI    AIF   ('&VFORM' NE 'E').NOTE                                   41300000
         AIF   ('&SYSASCE' NE 'AR').NOTARE1                        @01A 41308300
&LABL    SAC   0                 GO INTO PRIMARY ASC MODE          @01A 41316600
         STM   14,12,12(13)      SAVE CALLER'S REGISTERS           @01A 41324900
         AGO   .EMEXP1                                             @01A 41333200
.NOTARE1 ANOP                                                      @01A 41341500
&LABL    STM   14,12,12(13)      SAVE CALLER'S REGISTERS                41350000
         AGO   .EMEXP1                                                  41400000
.*                                                                      41450000
.*       ************************************************************** 41500000
.*       *                        M-FORM  (MODIFY FORM)               * 41550000
.*       ************************************************************** 41600000
.*                                                                      41650000
.NOTE    AIF   ('&VFORM' NE 'M').NOTM                                   41700000
         AIF   (T'&LABL EQ 'O').MNOLAB                             @01C 41750000
&LABL    EQU   *                                                        41800000
.MNOLAB  AIF   ('&SYSASCE' NE 'AR').EMEXP1                         @01A 41816600
         SAC   0                 GO INTO PRIMARY ASC MODE          @01A 41833200
         AGO   .EMEXP1                                                  41850000
.NOTM    MEXIT                                                          41900000
.*                                                                      41950000
.*       ************************************************************** 42000000
.*       *        COMMON PORTION FOR E-FORM AND M-FORM EXPANSIONS     * 42050000
.*       ************************************************************** 42100000
.*                                                                      42150000
.EMEXP1  AIF   ('&MF(2)'(1,1) EQ '(').EMEXP2                            42200000
         LA    1,&MF(2)          GET ADDRESS OF THE PARAMETER LIST      42250000
         AGO   .EMW0B0                                                  42300000
.EMEXP2  ANOP                                                           42350000
&VTEMP   SETC  '&MF(2)'(2,K'&MF(2)-2)                                   42400000
         LR    1,&VTEMP          GET ADDRESS OF THE PARAMETER LIST      42450000
.*                                                                      42500000
.*                     ************************************************ 42550000
.*                     *         UPDATE PARM LIST - WORD 0:BYTES 0 & 1* 42600000
.*                     ************************************************ 42650000
.*                                                                      42700000
.EMW0B0  MVI   0(1),X'&VCODE'    SET SERVICE CODE                       42725000
         CLI   1(1),X'&VLEV'     CHECK PARAM LIST LEVEL IN LIST    @L2A 42750000
         BNL   *+8               SKIP IF LEVEL IS CORRECT          @L2A 42775000
         MVI   1(1),X'&VLEV'     SET PARM LIST LEVEL IN LIST            42800000
         ANOP                                                      @L2A 42825000
.*                                                                      42850000
.*                     ************************************************ 42900000
.*                     *         UPDATE PARM LIST - WORD 0:BYTE 2     * 42950000
.*                     ************************************************ 43000000
.*                                                                      43050000
.EMW0B2  AIF   ('&TYPE' NE 'DA').EMNTDA                                 43100000
         MVI   2(1),&VTYDA       SET TYPE=DA                            43150000
         AGO   .EMW0B2A                                                 43200000
.EMNTDA  ANOP                                                           43214200
         AIF   ('&TYPE' NE 'HS').EMNTHS                            @L3A 43228400
         MVI   2(1),&VTYHS       SET TYPE=HS                       @L3A 43242600
         AGO   .EMW0B2A                                            @L3A 43256800
.EMNTHS  ANOP                                                      @L3A 43271000
         AIF   ('&MODE' NE 'READ').EMNTRD                               43285200
         MVI   2(1),1            SET MODE=READ                          43300000
         AGO   .EMW0B2A                                                 43350000
.EMNTRD  ANOP                                                           43383300
         AIF   ('&MODE' NE 'UPDATE').EMNTUP                             43416600
         MVI   2(1),2            SET MODE=UPDATE                        43450000
         AGO   .EMW0B2A                                                 43500000
.EMNTUP  ANOP                                                           43550000
         AIF   (T'&PFCOUNT EQ 'O').EMW0B2A                         @L3C 43600000
         MVI   2(1),&PFCOUNT     SET PFCOUNT                       @L3C 43650000
         AGO   .EMW0B2A                                            @L3C 43700000
.EMW0B2A ANOP                                                           43900000
.*                                                                      43950000
.*                     ************************************************ 44000000
.*                     *         UPDATE PARM LIST - WORD 0:BYTE 3     * 44050000
.*                     ************************************************ 44100000
.*                                                                      44150000
         AIF   (T'&CHECKING EQ 'O').EMNTCK                         @L4A 44156200
         AIF   ('&CHECKING' NE 'NO').EMCKNO                        @L4A 44162400
         OI    3(1),X'80'        SET CHECKING=NO                   @L4A 44168600
         AGO   .EMNTCK                                             @L4A 44174800
.EMCKNO  AIF   ('&CHECKING' NE 'YES').EMNTCK                       @L4A 44181000
         NI    3(1),X'7F'        SET CHECKING=YES                  @L4A 44187200
.EMNTCK  ANOP                                                           44193400
         AIF   ('&RETAIN' NE 'YES').EMNTRY                              44200000
         OI    3(1),X'80'        SET RETAIN=YES                         44250000
         AGO   .EMNTRT                                                  44300000
.EMNTRY  AIF   ('&RETAIN' NE 'NO').EMNTRT                               44350000
         NI    3(1),X'7F'        SET RETAIN=NO                          44400000
.EMNTRT  ANOP                                                           44450000
         AIF   ('&LOCVIEW' NE 'MAP').EMLVMA                        @L1A 44500000
         OI    3(1),X'40'        SET LOCVIEW=MAP                   @L1A 44550000
         AGO   .EMNTLV                                             @L1A 44600000
.EMLVMA  AIF   ('&LOCVIEW' NE 'NONE').EMNTLV                       @L1A 44650000
         NI    3(1),X'BF'        SET LOCVIEW=NONE                  @L1A 44700000
.EMNTLV  ANOP                                                           44750000
         AIF   ('&RELEASE' NE 'YES').EMNTRZ                        @L3A 44757100
         OI    3(1),X'80'        SET RELEASE=YES                   @L3A 44764200
         AGO   .EMNTRL                                             @L3A 44771300
.EMNTRZ  AIF   ('&RELEASE' NE 'NO').EMNTRL                         @L3A 44778400
         NI    3(1),X'7F'        SET RELEASE=NO                    @L3A 44785500
.EMNTRL  ANOP                                                      @L3A 44792600
.EMW0B3  ANOP                                                           44800000
.*                                                                      44850000
.*                     ************************************************ 44900000
.*                     *         UPDATE PARM LIST - WORD 1            * 44950000
.*                     ************************************************ 45000000
.*                                                                      45050000
         AIF   (T'&ID EQ 'O').EMNTID                                    45100000
         AIF   ('&ID'(1,1) EQ '(').EMRGID                               45150000
         LA    15,&ID            GET ADDRESS OF THE ID                  45200000
         ST    15,4(,1)          STORE ADDRESS OF THE ID IN PARM LIST   45250000
         AGO   .EMW1                                                    45300000
.EMRGID  ST    &ID(1),4(,1)      STORE ADDRESS OF THE ID IN PARM LIST   45350000
.EMNTID  ANOP                                                           45400000
.EMW1    ANOP                                                           45450000
.*                                                                      45500000
.*                     ************************************************ 45550000
.*                     *         UPDATE PARM LIST - WORD 2            * 45600000
.*                     ************************************************ 45650000
.*                                                                      45700000
         AIF   (T'&DDNAME EQ 'O').EMNTNA                                45750000
         AIF   ('&DDNAME'(1,1) EQ '(').EMRGNA                           45800000
         LA    15,&DDNAME        GET ADDRESS OF THE DD NAME             45850000
         ST    15,8(,1)          STORE ADDRESS OF DD NAME IN PARM LIST  45900000
         AGO   .EMW2A                                                   45950000
.EMRGNA  ST    &DDNAME(1),8(,1)  STORE ADDRESS OF DD NAME IN PARM LIST  46000000
         AGO   .EMW2A                                                   46050000
.EMNTNA  AIF   (T'&SIZE EQ 'O').EMNTSI                                  46100000
         AIF   ('&VSERV' EQ 'MAP' OR '&VSERV' EQ 'UNMAP').EMNTSI SIZE   46116600
.*                            IS NOT VALID ON MAP OR UNMAP        @03A  46133200
         AIF   ('&SIZE'(1,1) EQ '(').EMRGSI                             46150000
         AIF   ('&SIZE' EQ '*').EMSTSI                                  46200000
         LA    15,&SIZE          GET ADDRESS OF THE SIZE STORE AREA     46250000
         AGO   .EMW2                                                    46300000
.EMSTSI  SR    15,15             CLEAR ADDRESS OF SIZE STORE AREA       46350000
.EMW2    ST    15,8(,1)          STORE ADDRESS OF SIZE STORE AREA       46400000
         AGO   .EMW2A                                                   46450000
.EMRGSI  ST    &SIZE(1),8(,1)    STORE ADDRESS OF SIZE STORE AREA       46500000
         AGO   .EMW2A                                                   46550000
.EMNTSI  AIF   (T'&AREA EQ 'O').EMNTAR                                  46600000
         AIF   ('&AREA'(1,1) EQ '(').EMRGAR                             46650000
         LA    15,&AREA          GET ADDR OF THE VIRTUAL AREA POINTER   46700000
         ST    15,8(,1)          STORE ADDRESS OF VIRTUAL AREA POINTER  46750000
         AGO   .EMW2A                                                   46800000
.EMRGAR  ST    &AREA(1),8(,1)    STORE ADDRESS OF VIRTUAL AREA POINTER  46850000
         AGO   .EMW2A                                                   46900000
.EMNTAR  ANOP                                                           46950000
.EMW2A   ANOP                                                           47000000
.*                                                                      47050000
.*                     ************************************************ 47100000
.*                     *         UPDATE PARM LIST - WORD 3            * 47150000
.*                     ************************************************ 47200000
.*                                                                      47250000
         AIF   (T'&TTOKEN EQ 'O').EMNTTT                                47258300
         AIF   ('&TTOKEN'(1,1) EQ '(').EMRGTT                           47266600
         AIF   ('&TTOKEN' EQ '*').EMSTTT                                47274900
         LA    15,&TTOKEN        GET ADDRESS OF THE TTOKEN              47283200
         AGO   .EMW3A                                                   47291500
.EMSTTT  SR    15,15             CLEAR ADDRESS OF THE TTOKEN            47299800
.EMW3A   ST    15,12(,1)         STORE ADDRESS OF THE TTOKEN            47308100
         AGO   .EMW3X                                                   47316400
.EMRGTT  ST    &TTOKEN(1),12(,1) STORE ADDRESS OF THE TTOKEN            47324700
         AGO   .EMW3X                                                   47333000
.EMNTTT  AIF   (T'&SPAN EQ 'O').EMNTSP                                  47341300
         AIF   ('&SPAN'(1,1) EQ '(').EMRGSP                             47350000
         AIF   ('&SPAN' EQ '*').EMSTSP                                  47400000
         LA    15,&SPAN          GET ADDRESS OF THE SPAN                47450000
         AGO   .EMW3B                                                   47650000
.EMSTSP  SR    15,15             CLEAR ADDRESS OF THE SPAN              47662500
.EMW3B   ST    15,12(,1)         STORE ADDRESS OF THE SPAN              47675000
         AGO   .EMW3X                                                   47687500
.EMRGSP  ST    &SPAN(1),12(,1)   STORE ADDRESS OF THE SPAN              47700000
         AGO   .EMW3X                                                   47750000
.EMNTSP  ANOP                                                           47800000
.EMW3X   ANOP                                                           47850000
.*                                                                      47900000
.*                     ************************************************ 47950000
.*                     *         UPDATE PARM LIST - WORD 4            * 48000000
.*                     ************************************************ 48050000
.*                                                                      48100000
         AIF   (T'&OFFSET EQ 'O').EMNTOF                                48150000
         AIF   ('&OFFSET'(1,1) EQ '(').EMRGOF                           48200000
         AIF   ('&OFFSET' EQ '*').EMSTOF                                48250000
         LA    15,&OFFSET        GET ADDRESS OF THE OFFSET              48300000
         AGO   .EMW4A                                                   48350000
.EMSTOF  SR    15,15             CLEAR ADDRESS OF THE OFFSET            48400000
.EMW4A   ST    15,16(,1)         STORE ADDRESS OF THE OFFSET            48450000
         AGO   .EMW4                                                    48500000
.EMRGOF  ST    &OFFSET(1),16(,1) STORE ADDRESS OF THE OFFSET            48550000
         AGO   .EMW4                                                    48600000
.EMNTOF  ANOP                                                           48650000
.EMW4    ANOP                                                           48700000
.*                                                                      48702600
.*                     ************************************************ 48705200
.*                     *         UPDATE PARM LIST - WORD 5            * 48707800
.*                     ************************************************ 48710400
.*                                                                      48713000
         AIF   (T'&STOKEN EQ 'O').EMNTST                          @L2A  48715600
         AIF   ('&STOKEN'(1,1) EQ '(').EMRGST                     @L2A  48718200
         AIF   ('&STOKEN' EQ '*').EMSTST                          @L2A  48720800
         LA    15,&STOKEN        GET ADDRESS OF THE STOKEN        @L2A  48723400
         AGO   .EMW5A                                             @L2A  48726000
.EMSTST  SR    15,15             CLEAR ADDRESS OF THE STOKEN      @L2A  48728600
.EMW5A   ST    15,20(,1)         STORE ADDRESS OF THE STOKEN      @L2A  48731200
         AGO   .EMW5X                                             @L5A  48731600
.EMRGST  ST    &STOKEN(1),20(,1) STORE ADDRESS OF THE STOKEN      @L2A  48732000
         AGO   .EMW5X                                             @L5A  48732400
.EMNTST  ANOP                                                     @P1A  48734200
.EMW5X   ANOP                                                     @P1A  48736000
.*                                                                      48738000
.*                     ************************************************ 48738100
.*                     *         UPDATE PARM LIST - WORD 6            * 48738200
.*                     ************************************************ 48738300
.*                                                                      48738400
         AIF   ('&LISTAD' EQ '').EMNTLA                           @P1C  48738500
         AIF   ('&LISTAD'(1,1) EQ '(').EMRGLA                     @L5A  48738600
         AIF   ('&LISTAD' EQ '*').EMSTLA                          @L5A  48738700
         LA    15,&LISTAD        GET ADDRESS OF THE LISTADDR      @L5A  48738800
         AGO   .EMW6A                                             @L5A  48738900
.EMSTLA  SR    15,15             CLEAR ADDRESS OF THE LISTADDR    @L5A  48739000
.EMW6A   ST    15,24(,1)         STORE ADDRESS OF THE LISTADDR    @P1C  48739100
         AGO   .EMW6X                                             @L5A  48739200
.EMRGLA  ST    &LISTAD,24(,1) STORE ADDRESS OF THE LISTADDR       @P1C  48739300
         AGO   .EMW6X                                             @L5A  48739400
.EMNTLA  ANOP                                                     @L5A  48739500
.EMW6X   ANOP                                                     @P1A  48739600
.*                                                                      48739700
.*                                                                      48739800
.*             ************************************************         48739900
.*             *         UPDATE PARM LIST - WORD 7            *         48740000
.*             ************************************************         48740100
.*                                                                      48740200
         AIF   ('&LISTSZ' EQ '').EMNTLS                           @L5A  48740300
         AIF   ('&LISTSZ'(1,1) EQ '(').EMRGLS                     @L5A  48740400
         AIF   ('&LISTSZ' EQ '*').EMSTLS                          @L5A  48740800
         LA    15,&LISTSZ        GET ADDRESS OF THE LISTSIZE      @L5A  48741200
         AGO   .EMW7                                              @P1C  48741600
.EMSTLS  SR    15,15             CLEAR ADDRESS OF THE LISTSIZE    @L5A  48742000
.EMW7    ST    15,28(,1)         STORE ADDRESS OF THE LISTSIZE    @P1C  48742400
         AGO   .EMW7A                                             @P1C  48742800
.EMRGLS  ST    &LISTSZ,28(,1) STORE ADDRESS OF THE LISTSIZE       @P1C  48743200
         AGO   .EMW7A                                             @P1C  48743600
.EMNTLS  ANOP                                                     @L5A  48744000
.EMW7A   ANOP                                                     @P1C  48744400
.*                                                                      48744800
.*                                                                      48746800
         AIF   ('&VFORM' EQ 'E').XCOMMON                                48750000
         AIF   ('&SYSASCE' NE 'AR').NOTARM                        @01A  48762500
         SAC   512               RETURN TO AR ASC MODE            @01A  48775000
.NOTARM  ANOP                                                     @01A  48787500
         MEXIT                                                          48800000
.*                                                                      48850000
.*       ************************************************************** 48900000
.*       *        COMMON PORTION FOR I-FORM AND E-FORM EXPANSIONS     * 48950000
.*       ************************************************************** 49000000
.*                                                                      49050000
.XCOMMON ESAR  15                EXTRACT SECONDARY ASN (SASID)          49100000
         ST    15,16(,13)        SAVE SASID IN REGISTER 15 SLOT         49150000
         L     15,16(0,0)        GET CVT ADDRESS                        49200000
         L     15,772(,15)       GET SYSTEM FUNCTION TABLE ADDRESS      49250000
         L     15,144(,15)       OBTAIN LX/EX FOR DIV                   49300000
         PC    0(15)             PC TO DIV                              49350000
         L     2,16(,13)         EXTRACT SAVED SASID                    49400000
         SSAR  2                 RESTORE ORIGINAL SASID                 49450000
         LM    2,12,28(13)       RESTORE REGISTERS 2-12                 49500000
         AIF   ('&SYSASCE' NE 'AR').NOTARX                         @01A 49512500
         SAC   512               RETURN TO AR ASC MODE             @01A 49525000
.NOTARX  ANOP                                                      @01A 49537500
         MEXIT                                                          49550000
.*                                                                      49600000
.********************************************************************** 49650000
.*                                                                    * 49700000
.*                          MNOTES                                    * 49750000
.*                                                                    * 49800000
.********************************************************************** 49850000
.*                                                                      49900000
.ERR1    MNOTE 4,'MORE THAN ONE POSITIONAL PARAMETER.  &SV(1) WILL BE UC49950000
               SED'                                                     50000000
         AGO   .BAKER1                                                  50050000
.*                                                                      50100000
.ERR2    MNOTE 12,'THE REQUIRED DIV SERVICE IS NOT SPECIFIED. &PNOTXT'  50150000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  50200000
&SWXSVOK SETC  'NO'            A service is not specified               50250000
         AGO   .BAKER2                                                  50300000
.*                                                                      50350000
.ERR3    MNOTE 4,'INCORRECT MACRO FORM. THE STANDARD FORM IS ASSUMED'   50400000
         AGO   .CKSERV                                                  50450000
.*                                                                      50500000
.ERR4    MNOTE 4,'TOO MANY LIST ITEMS ON THE &VFORM-FORM OF THE MF KEYWC50550000
               ORD.  &PXIIGN'                                           50600000
         AGO   .CKSERV                                                  50650000
.*                                                                      50700000
.ERR5    MNOTE 12,'REQUIRED PARAMETER LIST ON THE &VFORM-FORM OF THE MFC50750000
                KEYWORD IS NOT SPECIFIED.  &PNOTXT'                     50800000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  50850000
         AGO   .CKSERV                                                  50900000
.*                                                                      50950000
.ERR6    MNOTE 4,'TOO MANY LIST ITEMS ON THE MF KEYWORD FOR THE L-FORM C51000000
               . &PXIIGN'                                               51050000
         AGO   .CKSERV                                                  51100000
.*                                                                      51150000
.ERR7    MNOTE 12,'INCORRECT SERVICE SPECIFIED.  YOU MUST SPECIFY IDENTC51200000
               IFY,UNIDENTIFY,ACCESS,UNACCESS,MAP,UNMAP,SAVE,SAVELIST  C51250000
               OR RESET.   &PNOTXT'                                @L5A 51300000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  51350000
&SWXSVOK SETC  'NO'            A service is not specified               51400000
         AGO   .BAKER7                                                  51450000
.*                                                                      51500000
.ERR8    MNOTE 4,'THE DDNAME KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGC51550000
               N'                                                       51600000
         AGO   .NAMEOK                                                  51650000
.*                                                                      51700000
.ERR8A   MNOTE 4,'THE DDNAME KEYWORD IS NOT APPLICABLE WHEN TYPE=HS IS C51705500
               SPECIFIED.  &PIGN'                                       51711000
         AGO   .NAMEOK                                                  51716500
.*                                                                      51722000
.ERR8B   MNOTE 4,'THE STOKEN KEYWORD IS NOT APPLICABLE WHEN TYPE=DA IS C51727500
               SPECIFIED.  &PIGN'                                       51733000
         AGO   .NAMEOK                                                  51738500
.*                                                                      51744000
.ERR9    MNOTE 4,'THE TYPE KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGN' 51750000
         AGO   .TYPEOK                                                  51800000
.*                                                                      51850000
.ERR9A   MNOTE 4,'THE CHECKING KEYWORD IS NOT APPLICABLE ON &VSERV.  &PC51855500
               IGN'                                                @L4A 51861000
         AGO   .CHEKOK                                             @L4A 51866500
.*                                                                      51872000
.ERR9B   MNOTE 4,'THE TTOKEN KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGC51877500
               N'                                                  @L4A 51883000
         AGO   .TTOKOK                                             @L4A 51888500
.*                                                                      51894000
.ERR10   MNOTE 4,'THE SIZE KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGN' 51900000
         AGO   .SIZEOK                                                  51950000
.*                                                                      52000000
.ERR11   MNOTE 4,'THE MODE KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGN' 52050000
         AGO   .MODEOK                                                  52100000
.*                                                                      52150000
.ERR11B  MNOTE 4,'THE LOCVIEW KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIC52200000
               GN'                                                      52250000
.*                                                                 @L1A 52300000
         AGO   .LOCVOK                                             @L1A 52350000
.*                                                                      52400000
.ERR12   MNOTE 4,'THE AREA KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGN' 52450000
         AGO   .AREAOK                                                  52500000
.*                                                                      52550000
.ERR13   MNOTE 4,'THE OFFSET KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGC52600000
               N'                                                       52650000
         AGO   .OFFSOK                                                  52700000
.*                                                                      52750000
.ERR14   MNOTE 4,'THE SPAN KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGN' 52800000
         AGO   .SPANOK                                                  52850000
.*                                                                      52900000
.ERR15   MNOTE 4,'THE RETAIN KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGC52950000
               N'                                                       53000000
         AGO   .RETOK                                                   53050000
.*                                                                      53100000
.ERR15B  MNOTE 4,'THE STOKEN KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIGC53108300
               N'                                                       53116600
.*                                                                 @L2A 53124900
         AGO   .STKNOK                                                  53133200
.*                                                                 @L2A 53141500
.ERR16   MNOTE 4,'THE PFCOUNT KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIC53150000
               GN'                                                 @L3C 53200000
         AGO   .PFCOK                                              @L3C 53250000
.*                                                                      53300000
.ERR16A  MNOTE 4,'THE RELEASE KEYWORD IS NOT APPLICABLE ON &VSERV.  &PIC53321400
               GN'                                                 @L3A 53342800
         AGO   .RELOK                                              @L3A 53364200
.*                                                                      53385600
.ERR16B  MNOTE 4,'THE LISTADDR KEYWORD IS NOT APPLICABLE ON &VSERV. &PIC53386700
               GN'                                                 @L5A 53387800
         AGO   .LSTADOK                                            @L5A 53388900
.*                                                                      53390000
.ERR16C  MNOTE 4,'THE LISTSIZE KEYWORD IS NOT APPLICABLE ON &VSERV. &PIC53391100
               GN'                                                 @L5A 53392200
         AGO   .LSTSZOK                                            @L5A 53393300
.*                                                                      53394400
.ERR16D  MNOTE 4,'LISTSIZE and LISTADDR KEYWORDS MUST BE SPECIFIED IN PC53395500
               AIRS ON SERVICE  &VSERV.  &PIGN'                    @L5A 53396600
         AGO   .LSDONE                                             @L5A 53397700
.*                                                                      53398800
.ERR16E  MNOTE 12,'Cannot specify LISTADDR, LISTSIZE, or STOKEN with OFC53399900
               FSET and SPAN.  &PNOTXT'                            @P1C 53401000
&SWXSTOP SETC  'YES'     Stop processing after validity checking   @L5A 53402100
         AGO   .LSDONE                                             @L5A 53403200
.*                                                                      53404300
.ERR17   MNOTE 12,'THE DDNAME KEYWORD MUST BE SPECIFIED WHEN TYPE=DA ISC53407000
                    SPECIFIED.   &PNOTXT'                               53428400
&SWXSTOP SETC  'YES'           Stop processing after validity checking  53450000
         AGO   .NID1                                                    53500000
.*                                                                      53550000
.ERR17A  MNOTE 12,'THE STOKEN KEYWORD MUST BE SPECIFIED WHEN TYPE=HS ISC53558300
                    SPECIFIED.   &PNOTXT'                               53566600
&SWXSTOP SETC  'YES'           Stop processing after validity checking  53574900
         AGO   .NID1                                                    53583200
.*                                                                      53591500
.ERR18   MNOTE 12,'THE TYPE KEYWORD MUST BE SPECIFIED ON &VSERV.  &PNOTC53600000
               XT'                                                      53650000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  53700000
         AGO   .TYDONE                                                  53750000
.*                                                                      53800000
.ERR19   MNOTE 12,'THE MODE KEYWORD MUST BE SPECIFIED ON &VSERV.  &PNOTC53850000
               XT'                                                      53900000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  53950000
         AGO   .MODONE                                                  54000000
.*                                                                      54050000
.ERR20   MNOTE 12,'THE AREA KEYWORD MUST BE SPECIFIED ON &VSERV.  &PNOTC54100000
               XT'                                                      54150000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  54200000
         AGO   .ARDONE                                                  54250000
.*                                                                      54254500
.ERR20A  MNOTE 12,'THE LISTADDR KEYWORD MUST BE SPECIFIED ON &VSERV.   C54259000
               &PNOTXT'                                            @L5A 54263500
&SWXSTOP SETC  'YES'       Stop processing after validity checking @L5A 54268000
         AGO   .LADONE                                             @L5A 54272500
.*                                                                      54277000
.ERR20B  MNOTE 12,'THE LISTSIZE KEYWORD MUST BE SPECIFIED ON &VSERV.   C54281500
               &PNOTXT'                                            @L5A 54286000
&SWXSTOP SETC  'YES'       Stop processing after validity checking @L5A 54290500
         AGO   .SLDONE                                             @L5A 54295000
.*                                                                      54300000
.ERR21   MNOTE 12,'UNKNOWN TYPE SPECIFIED FOR IDENTIFY.  &PNOTXT'       54350000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  54400000
         AGO   .BAKER21                                                 54450000
.*                                                                      54500000
.ERR21A  MNOTE 12,'UNKNOWN CHECKING SPECIFIED FOR IDENTIFY.  &PNOTXT'   54510000
&SWXSTOP SETC  'YES'           Stop proc. after validity checking @L4A  54520000
         AGO   .BAKE21A                                           @L4A  54530000
.*                                                                      54540000
.ERR22   MNOTE 12,'UNKNOWN MODE SPECIFIED FOR ACCESS.  &PNOTXT'         54550000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  54600000
         AGO   .BAKER22                                                 54650000
.*                                                                      54700000
.ERR22B  MNOTE 12,'UNKNOWN LOCVIEW SPECIFICATION FOR ACCESS.  &PNOTXT'  54750000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  54850000
         AGO   .BAKE22B                                           @L1A  54950000
.*                                                                      55000000
.ERR23   MNOTE 12,'UNKNOWN RETAIN SPECIFICATION FOR MAP.  &PNOTXT'      55050000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  55100000
         AGO   .BAKER23                                                 55150000
.*                                                                      55200000
.ERR25   MNOTE 12,'UNKNOWN RETAIN SPECIFICATION FOR UNMAP.  &PNOTXT'    55400000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  55450000
         AGO   .BAKER25                                                 55500000
.*                                                                      55550000
.ERR25A  MNOTE 12,'UNKNOWN RELEASE SPECIFICATION FOR RESET.  &PNOTXT'   55560000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  55570000
         AGO   .BAKE25A                                           @L3A  55580000
.*                                                                      55590000
.ERR26   MNOTE 12,'THE ID KEYWORD MUST BE SPECIFIED ON &VSERV. &PNOTXT' 55600000
&SWXSTOP SETC  'YES'           Stop processing after validity checking  55650000
         AGO   .BAKER26                                                 55700000
.*                                                                      55750000
         MEND                                                           55800000
*--------------------------------------------------------------------*/ 55850000
* %STARTPLS:;                                                           55900000
* %DIV:  MACRO KEYS(DDNAME,TYPE,ID,CHECKING,TTOKEN,SIZE,MODE,LOCVIEW,   55950000
*                   AREA,OFFSET,SPAN,STOKEN,RETAIN,PFCOUNT,RELEASE,     55987500
*                   LISTADDR,LISTSIZE,MF);                              56025000
*/*                                                              @L5A*/ 56062500
*   ANS('?'||MACLABEL||' DIVP '||MACLIST||MACKEYS||';');                56100000
* %END DIV;                                                             56150000
