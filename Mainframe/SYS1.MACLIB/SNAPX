*/* COPYRIGHT =                                                      */ 00033300
*/*            5645-001                                              */ 00066600
*/*            THIS MODULE IS "RESTRICTED MATERIALS OF IBM"          */ 00100000
*/*            (C) COPYRIGHT IBM CORP. 1980, 1997                @D1C*/ 00150000
*/*            LICENSED MATERIALS - PROPERTY OF IBM                  */ 00200000
*/*                                                                  */ 00237500
*/*  EXTERNAL CLASSIFICATION: GUPI                                   */ 00275000
*/*  END OF EXTERNAL CLASSIFICATION:                                 */ 00312500
*/*                                                                  */ 00350000
*/* STATUS  = HBB6603                                                */ 00400000
*/*                                                                  */ 00450000
*/* CHANGE ACTIVITY =                                                */ 00500000
*/*   $L1 =    AR    HBB3310 850901 PDXB: AR SUPPORT                 */ 00550000
*/*   $L2 =  DATASPAC HBB3310 861029 PDT8: DATA SPACES SUPPORT       */ 00575000
*/*   $P1 =  PC41356  HBB3310 870831 PDT8: CORRECT SETTING OF LOCAL  */ 00581200
*/*                                        VARIABLE FOR DSPSTOR      */ 00587400
*/*                                        KEYWORD                   */ 00593600
*/*   $01 =  OY38523 HBB3310 901212 PDXB: FIX OFFSETS                */ 00596800
*/*   $D1 =  DR20001 HBB6601 950907 PD00KV: SPLIT FROM SC1CM     @D1A*/ 00614500
*/*   $P2 =  PQC0594 HBB6603 951211 PDKV: DO NOT UPDATE THE REGISTER */ 00618000
*/*                          USED TO PASS THE DCB ADDR (OW16863) @P2A*/ 00621500
*/*   $P3 =  PQC0604 HBB6603 951211 PDKV: PREVENT ASMA094I BY        */ 00625000
*/*                          CHECKING MF= CHAR COUNT             @P3A*/ 00628500
* /* MACCOMP Y-1 SCDMP/PZD10                                     @D1C*/ 00632200
* /* MACSTAT Y-1 85300/Y02705 OS/VS2 HBB3310                         */ 00650000
* /* APAR OZ51152 - A-TYPE ADDR NOT GENERATED FOR STRHDR WHEN LIST   */ 00700000
* /*                IS REG FORMAT                            @ZA51152*/ 00750000
         MACRO                                                          00800000
&NAME    SNAPX &DCB=,&TCB=,&SDATA=,&PDATA=,&STORAGE=,&LIST=,&ID=,&MF=,&X00850000
               STRHDR=,&SUBPLST=,&DSPSTOR=                         @L2C 00900000
         LCLC  &C1,&C2,&GNAME                                           00950000
         LCLB  &B0,&B1,&B2,&B3,&B4,&B5,&B6,&B7,&B8,&B9,&B10,&B11,&B12,&X01000000
               B13,&B14,&B15,&B16                               G33SPHW 01050000
         LCLB  &B17,&B18,&B19          SQA,LSQA,SWA              Y02705 01100000
         LCLB  &B20,&B21,&B22,&B23,&B24,&B25                            01150000
         LCLB  &B26,&B27,&B28,&B29   SUM, ALLVNUC, SUBPLST,DSPSTOR @L2C 01200000
         LCLB  &B30                           G382P12                   01250000
         LCLB  &VS2SE3            MVS SYSTEM EXTENSION 1.3.0    G382P12 01300000
         LCLB  &OSVS2R2           OSVS2R2 LEVEL OF PARAM LIST    Y02705 01350000
         LCLB  &OSENVS2           OSVS2R2 ENHANCED SNAP         G33SPHW 01400000
         LCLB  &MVSE               OS/VS2 HBB2102 INDICATOR    @G860P1Y 01450000
         LCLB  &AR                 OS/VS2 HBB3310 INDICATOR        @L1A 01500000
         LCLA  &FLAGS4,&CTR3,&CTR4,&CTR5,&CTR7,&CTR8,&CTRA,&CTRB        01550000
         LCLC  &C3,&C4                                                  01600000
         LCLA  &FLAGS3                 FLAG FIELD                Y02705 01650000
         LCLA  &FLAGS5                 OPTIONS REQUESTED       @G860P1Y 01700000
         LCLA   &FLAGS1,&FLAGS2,&CTR1,&CTR2,&DISP              @G382P12 01750000
         ACTR   9000                                                    01800000
         LCLC  &LA                      "LA" OR "LAE" VIA SYSSTATE @L1A 01850000
         GBLC  &SYSASCE                                            @L1A 02200000
         SYSSTATE TEST                  TEST ASC ENVIRONMENT       @L1A 02250000
&LA      SETC  'LA'                     MUST USE LA INSTRUCTION    @L1A 02260000
         AIF   ('&SYSASCE' EQ 'P').NOLAE                           @L1A 02270000
&LA      SETC  'LAE'                    MUST USE LAE               @L1A 02280000
.NOLAE   ANOP                                                      @L1A 02290000
&B0      SETB  1                  INDICATES SNAP REQUEST         Y02705 02300000
&OSVS2R2 SETB  1                  INDICATES AN OSVS2R2 LEVEL     Y02705 02350000
&OSENVS2 SETB  1                  INDICATES A SNAP ENHANCED     G33SPHW 02400000
&VS2SE3  SETB  1                  INDICATES SNAP ENHANCED 3    @G382P12 02450000
         AIF   (T'&MF EQ 'O').STAND    STANDARD FORM             Y02705 02500000
         AIF   (K'&MF LT 3).STAND      LESS THAN THREE MF= CHARS   @P3A 02525000
         AIF   ('&MF'(1,3) EQ '(E,' AND '&TCB' EQ '''S''').EXCUR Y02705 02550000
.STAND   ANOP                                                    Y02705 02600000
&B1      SETB  ('&TCB' NE '')                                           02650000
.********************************************************************** 02700000
.*                                                                    * 02750000
.*      PARSE THE SDATA PARAMETERS, AND SET INDICATORS                * 02800000
.*                                                            @G860P33* 02850000
.********************************************************************** 02900000
.EXCUR   ANOP                                                    Y02705 02950000
         AIF   ('&SDATA' EQ '').CHKSTR                                  03000000
         AIF    ('&SDATA'(1,1) EQ '(').ABC2                             03050000
&B2      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'CB')                  03100000
&B3      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'TRT')                 03150000
&B4      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'NUC')                 03200000
&B7      SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'Q')                   03250000
&B17     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SQA')          Y02705 03300000
&B18     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'LSQA')         Y02705 03350000
&B19     SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SWA')          Y02705 03400000
&B20   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'DM')            G33SPHW 03450000
&B21   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'IO')            G33SPHW 03500000
&B22   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'ERR')           G33SPHW 03550000
&B30   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'PCDATA')       @G382P12 03600000
&B26   SETB  ('&SDATA' EQ 'ALL' OR '&SDATA' EQ 'SUM')          @G860P1Y 03650000
&B27   SETB  ('&SDATA' EQ 'ALLVNUC')                           @G860P1Y 03700000
&CTR1    SETA  &B2+&B3+&B4+&B17+&B18+&B19+&B7+&B20+&B21+&B22+&B30+&B26+X03750000
               &B27                                            @G860P1Y 03800000
         AIF   ('&CTR1' EQ '0').MSG2                                    03850000
         AGO   .CHKSTR                                                  03900000
.ABC2    ANOP                                                           03950000
&CTR1    SETA  N'&SDATA                                                 04000000
&CTR2    SETA  0                                                        04050000
.LOOPA   ANOP                                                           04100000
&CTR2    SETA  &CTR2+1                                                  04150000
&C1      SETC  '&SDATA(&CTR2)'                                          04200000
         AIF   ('&C1' EQ 'TRT').SETTRT                                  04250000
         AIF   ('&C1' EQ 'NUC').SETNUC                                  04300000
         AIF   ('&C1' EQ 'CB').SETCB                                    04350000
         AIF   ('&C1' EQ 'Q').SETQ                                      04400000
         AIF   ('&C1' EQ 'SQA').SETSQA      IS SQA SPECIFIED     Y02705 04450000
         AIF   ('&C1' EQ 'LSQA').SETLSQA    IS LSQA SPECIFIED    Y02705 04500000
         AIF   ('&C1' EQ 'SWA').SETSWA      IS SWA SPECIFIED     Y02705 04550000
         AIF   ('&C1' EQ 'DM').SETDM        IS DM SPECIFIED     G33SPHW 04600000
         AIF   ('&C1' EQ 'IO').SETIO        IS IO SPECIFIED     G33SPHW 04650000
         AIF   ('&C1' EQ 'ERR').SETERR      IS ERR SPECIFIED    G33SPHW 04700000
         AIF   ('&C1' EQ 'PCDATA').SETPC    IS PCDATA SPEC     @G382P12 04750000
         AIF   ('&C1' EQ 'SUM').SETSUM  IS SUMMARY SPECIFIED   @G860P1Y 04800000
         AIF   ('&C1' EQ 'ALLVNUC').SETANUC  IS ALLVNUC REQSTD @G860P1Y 04850000
         AIF   ('&C1' EQ 'ALL').SETALL                                  04900000
         AGO   .MSG2                                                    04950000
.CHKOPT  ANOP                                                           05000000
         AIF   ('&CTR2' NE '&CTR1').LOOPA                               05050000
         AGO   .CHKSTR                                                  05100000
.SETTRT  ANOP                                                           05150000
&B3      SETB  1                                                        05200000
         AGO   .CHKOPT                                                  05250000
.SETNUC  ANOP                                                           05300000
&B4      SETB  1                                                        05350000
         AGO   .CHKOPT                                                  05400000
.SETCB   ANOP                                                           05450000
&B2      SETB  1                                                        05500000
         AGO   .CHKOPT                                                  05550000
.SETQ    ANOP                                                           05600000
&B7      SETB  1                                                        05650000
         AGO   .CHKOPT                                                  05700000
.SETSQA  ANOP                          SQA SPECIFIED             Y02705 05750000
&B17     SETB  1                       SET SQA INDICATOR         Y02705 05800000
         AGO   .CHKOPT                 RETURN                    Y02705 05850000
.SETLSQA ANOP                          LSQA SPECIFIED            Y02705 05900000
&B18     SETB  1                       SET LSQA INDICATOR        Y02705 05950000
         AGO   .CHKOPT                 RETURN                    Y02705 06000000
.SETSWA  ANOP                          SWA SPECIFIED             Y02705 06050000
&B19     SETB  1                       SET SWA INDICATOR         Y02705 06100000
         AGO   .CHKOPT                 RETURN                    Y02705 06150000
.SETDM   ANOP                                                   G33SPHW 06200000
&B20     SETB  1                       DM SPECIFIED             G33SPHW 06250000
         AGO .CHKOPT                   RETURN                   G33SPHW 06300000
.SETIO   ANOP                          IO SPECIFIED             G33SPHW 06350000
&B21     SETB  1                       SET IO INDICATOR         G33SPHW 06400000
         AGO .CHKOPT                   RETURN                   G33SPHW 06450000
.SETERR  ANOP                          ERR SPECIFIED            G33SPHW 06500000
&B22     SETB  1                       SET ERR INDICATOR        G33SPHW 06550000
         AGO .CHKOPT                   RETURN                   G33SPHW 06600000
.SETPC   ANOP                          PCDATA SPECIFIED        @G382P12 06650000
&B30     SETB  1                       SET PCDATA INDICATOR    @G382P12 06700000
         AGO .CHKOPT                   RETURN                  @G382P12 06750000
.SETSUM  ANOP                      SUMMARY DUMP REQUESTED      @G860P1Y 06800000
&B26     SETB  1                   SET SUMMARY INDICATOR       @G860P1Y 06850000
         AGO   .CHKOPT             RETURN                      @G860P1Y 06900000
.SETANUC ANOP                      VIRTUAL NUCLEUS REQUESTED   @G860P1Y 06950000
&B27     SETB  1                   SET ALLVNUC INDICATOR       @G860P1Y 07000000
         AGO   .CHKOPT             RETURN                      @G860P1Y 07050000
.SETALL  ANOP                                                           07100000
&B2      SETB  1                                                        07150000
&B3      SETB  1                                                        07200000
&B4      SETB  1                                                        07250000
&B7      SETB  1                                                        07300000
&B17     SETB  1                       SQA INDICATOR             Y02705 07350000
&B18     SETB  1                       LSQA INDICATOR            Y02705 07400000
&B19     SETB  1                       SWA  INDICATOR            Y02705 07450000
&B20     SETB  1                       DM  INDICATOR            G33SPHW 07500000
&B21     SETB  1                       IO  INDICATOR            G33SPHW 07550000
&B22     SETB  1                       ERR INDICATOR            G33SPHW 07600000
&B30     SETB  1                       PCDATA INDICATOR        @G382P12 07650000
&B26     SETB  1                       SUMMARY INDICATOR       @G860P1Y 07700000
         AGO   .CHKOPT                 RETURN                  @G860P1Y 07750000
.********************************************************************** 07800000
.*                                                                    * 07850000
.*      PARSE THE STORAGE, STRHDR, SUBPLST, DSPSTOR PARAMETERS        * 07900000
.*                                                                @L2C* 07950000
.********************************************************************** 08000000
.CHKSTR  ANOP                                                           08050000
&B5      SETB  ('&STORAGE' NE '')                                       08100000
&B16     SETB  ('&LIST' NE '')                                          08150000
&B23    SETB   ('&STRHDR' NE '')       WAS STRHDR SPECIFIED     G33SPHW 08200000
&B28     SETB  ('&SUBPLST' NE '')  WAS SUBPLST SPECIFIED       @G860P1Y 08250000
&B29     SETB  ('&DSPSTOR' NE '')  WAS DSPSTOR SPECIFIED           @L2A 08275000
&MVSE    SETB  1                 INDICATE OS/VS2 HBB2102 LEVEL @G860P1Y 08300000
&AR      SETB  1                 INDICATE OS/VS2 HBB3310 LEVEL     @L1A 08350000
         AIF   ('&B5' EQ '1' AND '&B16' EQ '1').MSG4                    08400000
&B25     SETB  ('&B5' EQ '1' OR '&B16' EQ '1')                  G33SPHW 08450000
         AIF   ('&B23' EQ '1' AND '&B25' EQ '0').MSG9           G33SPHW 08500000
         AIF   ('&B23' NE '1').SKIPT                            G33SPHW 08550000
&CTR4    SETA  N'&STRHDR                                        G33SPHW 08600000
         AIF  (&CTR4 LT 1).MSG7                                 G33SPHW 08650000
.SKIPT   ANOP                                                   G33SPHW 08700000
         AIF   ('&B5' EQ '0').CHKSTRB                                   08750000
&CTR1    SETA  N'&STORAGE                                               08800000
         AIF   (&CTR1 LT 2).MSG4                               AS100400 08850000
         AIF   ('&B23' EQ '0').NOSHA   STRHDR SPECIFIED         G33SPHW 08900000
&CTR3    SETA  N'&STRHDR*2             GET NUMBER OF HEADER*2   G33SPHW 08950000
         AIF  ( &CTR3 GT &CTR1).MSG8 TOO MANY HEADERS           G33SPHW 09000000
.NOSHA   ANOP                                                   G33SPHW 09050000
.CHKSTRA ANOP                                                           09100000
&CTR1    SETA  &CTR1-2                                                  09150000
         AIF   (&CTR1 EQ 0).CHKSTRC                            AS100400 09200000
         AIF   (&CTR1 LT 1).MSG4                          0880 AS100400 09250000
         AGO   .CHKSTRA                                                 09300000
.CHKSTRB ANOP                                                           09350000
         AIF   ('&B16' EQ '0').CHKSTRC                                  09400000
         AIF   (N'&LIST NE 1).MSG4      LIST PARSM^=1                   09450000
         AIF   ('&B23' EQ '0').CHKSTRC  STRHDR SPECIFIED        G33SPHW 09500000
         AIF   (N'&STRHDR NE 1).MSGA     LIST FORMAT            G33SPHW 09550000
.CHKSTRC ANOP                                                           09600000
         AIF   ('&B29' EQ '0').CHKSTRD    DSPSTOR SPECIFIED        @L2A 09612500
         AIF   (N'&DSPSTOR NE 1).MSGDSPL   INVALID LIST FORM       @L2A 09625000
.CHKSTRD ANOP                                                      @L2A 09637500
&B6      SETB  ('&ID' NE '')                                            09650000
.********************************************************************** 09700000
.*                                                                    * 09750000
.*      PARSE THE PDATA PARAMETERS AND SET INDICATORS                 * 09800000
.*                                                            @G860P33* 09850000
.********************************************************************** 09900000
         AIF   ('&PDATA' EQ '').SETFLAG                                 09950000
         AIF   ('&PDATA'(1,1) EQ '(').ABC8                              10000000
&B8 SETB ('&PDATA' EQ 'SAH' OR '&PDATA' EQ 'SA' OR '&PDATA' EQ 'ALL')   10050000
&B9      SETB  ('&PDATA' EQ 'SAH')                                      10100000
&B10      SETB  ('&PDATA' EQ 'REGS' OR '&PDATA' EQ 'ALL')               10150000
&B11 SETB ('&PDATA' EQ 'LPA' OR '&PDATA' EQ 'ALLPA' OR '&PDATA' EQ 'ALLX10200000
               ')                                                       10250000
&B12 SETB ('&PDATA' EQ 'JPA' OR '&PDATA' EQ 'ALLPA' OR '&PDATA' EQ 'ALLX10300000
               ')                                                       10350000
.PDATA1  ANOP                                                           10400000
&B13     SETB  ('&PDATA' EQ 'PSW' OR '&PDATA' EQ 'ALL')                 10450000
&B14     SETB  ('&PDATA' EQ 'SPLS' OR '&PDATA' EQ 'ALL')                10500000
&B15     SETB  ('&PDATA' EQ 'SUBTASKS' OR '&PDATA' EQ 'ALL')   @G860P33 10550000
&CTR1    SETA  &B8+&B9+&B10+&B11+&B12+&B13+&B14+&B15           @G860P33 10600000
         AIF   ('&CTR1' EQ '0').MSG3                                    10650000
         AGO   .SETFLAG                                                 10700000
.ABC8    ANOP                                                           10750000
&CTR1    SETA  N'&PDATA                                                 10800000
&CTR2    SETA  0                                                        10850000
.LOOPB   ANOP                                                           10900000
&CTR2    SETA  &CTR2+1                                                  10950000
&C1      SETC  '&PDATA(&CTR2)'                                          11000000
         AIF   ('&C1' EQ 'SA').SETSA                                    11050000
         AIF   ('&C1' EQ 'SAH').SETSAH                                  11100000
         AIF   ('&C1' EQ 'REGS').SETREGS                                11150000
         AIF   ('&C1' EQ 'LPA').SETLPA                      ZMXXXXX     11200000
         AIF   ('&C1' EQ 'JPA').SETJPA                                  11250000
         AIF   ('&C1' EQ 'ALLPA').SETALPA                               11300000
         AIF   ('&C1' EQ 'PSW').SETPSW                                  11350000
         AIF   ('&C1' EQ 'SPLS').SETSPLS                                11400000
         AIF   ('&C1' EQ 'SUBTASKS').SETASK SUBTASKS SPECIFIED @G860P33 11450000
         AIF   ('&C1' EQ 'ALL').SETPALL                                 11500000
         AGO   .MSG3                                                    11550000
.CHKPMOR ANOP                                                           11600000
         AIF   ('&CTR2' NE '&CTR1').LOOPB                               11650000
         AGO   .SETFLAG                                                 11700000
.SETSA    ANOP                                                          11750000
&B8      SETB  1                                                        11800000
         AGO   .CHKPMOR                                                 11850000
.SETSAH  ANOP                                                           11900000
&B8      SETB    1                                                      11950000
&B9      SETB  1                                                        12000000
         AGO    .CHKPMOR                                                12050000
.SETREGS ANOP                                                           12100000
&B10     SETB  1                                                        12150000
         AGO   .CHKPMOR                                                 12200000
.SETLPA ANOP                                                            12250000
&B11     SETB  1                                                        12300000
         AGO   .CHKPMOR                                                 12350000
.SETJPA  ANOP                                                           12400000
&B12     SETB   1                                                       12450000
         AGO   .CHKPMOR                                                 12500000
.SETALPA  ANOP                                                          12550000
&B11     SETB  1                                                        12600000
&B12     SETB  1                                                        12650000
         AGO   .CHKPMOR                                                 12700000
.SETPSW   ANOP                                                          12750000
&B13     SETB  1                                                        12800000
         AGO   .CHKPMOR                                                 12850000
.SETSPLS  ANOP                                                          12900000
&B14     SETB   1                                                       12950000
         AGO   .CHKPMOR                                                 13000000
.SETASK   ANOP                                                 @G860P33 13050000
&B15     SETB   1                  INDICATE SUBTASKS SPECIFIED @G860P33 13100000
         AGO   .CHKPMOR                                        @G860P33 13150000
.SETPALL  ANOP                                                          13200000
&B8      SETB  1                                                        13250000
&B10     SETB  1                                                        13300000
&B11     SETB  1                                                        13350000
&B12     SETB  1                                                        13400000
&B13     SETB  1                                                        13450000
&B14     SETB  1                                                        13500000
&B15     SETB  1                   INDICATE SUBTASKS SPECIFIED @G860P33 13550000
.SETFLAG  ANOP                                                          13600000
         AIF   ('&B28' EQ '1' AND '&B14' EQ '1').MSGSUBP       @G860P1Y 13650000
         AIF   ('&B28' EQ '0').NOTSUBP  WAS SUBPLST SPECIFIED  @G860P1Y 13700000
         AIF   (N'&SUBPLST NE 1).MSGNOTL  YES, MUST BE 1 ENTRY @G860P1Y 13750000
.NOTSUBP ANOP                      SUBPLST WASN'T SPECIFIED    @G860P1Y 13800000
&FLAGS1  SETA  128*&B4+64*&B17+32*&B18+16*&B19+8*&B3+4*&B2+2*&B7+1*&B20 13850000
&FLAGS2  SETA  128*&B8+64*&B9+32*&B10+16*&B11+8*&B12+4*&B13+2*&B14+1*&BX13900000
               15                                                       13950000
&FLAGS3  SETA  64*&OSVS2R2+32*&OSENVS2+16*&B0+8*&B6+4*&B1+2*&B5+2*&B16+X14000000
               1*&B23                                           G33SPHW 14050000
&FLAGS4  SETA  128*&B21+64*&B22+32*&B30+16*&B26+8*&B27 OPTIONS @G860P1Y 14100000
&FLAGS5  SETA  128*&VS2SE3+8*&B29+4*&MVSE+2*&B28+&AR OPTIONS       @L2C 14150000
         AIF   ('&DCB' EQ '' AND ('&MF' EQ '')).MSG1                    14200000
         AIF   ('&MF' EQ '').STYPE                                      14250000
         AIF   ('&MF' EQ 'L').LTYPE                                     14300000
         AIF   ('&MF'(1,3) NE '(E,').MSG5                               14350000
.********************************************************************** 14400000
.*                                                                    * 14450000
.*      PROCESS THE EXECUTE FORM                                      * 14500000
.*                                                            @G860P33* 14550000
.********************************************************************** 14600000
         AIF ('&NAME' EQ '').NONM                                       14650000
&NAME    DS    0H                                                  0918 14700000
.NONM    ANOP                                                           14750000
&C1      SETC  '&MF(2)'                                                 14800000
         AIF   ('&C1'(1,1) EQ '(').REG                                  14850000
         &LA   1,&MF(2)                                            @L1C 14900000
         AGO   .CONT0                                                   14950000
.REG     ANOP                                                           15000000
         AIF   ('&C1' EQ '(1)').CONT0                                   15050000
         LR    1,&C1             GET ADDR OF PARM LIST                  15100000
         AIF   ('&SYSASCE' EQ 'P').CONT0                           @L1A 15150000
         CPYA  1,&C1             GET ALET                          @L1A 15200000
.CONT0   ANOP                                                           15250000
         AIF   ('&DCB' EQ '' AND '&TCB' EQ '' AND                      *15300000
                '&SDATA' EQ '' AND '&PDATA' EQ '' AND                  *15350000
                '&STORAGE' EQ '' AND '&LIST' EQ '' AND                 *15400000
                '&ID' EQ '' AND '&STRHDR' EQ '' AND                    *15450000
                '&SUBPLST' EQ '' AND '&DSPSTOR' EQ '').NOVERSN     @L2C 15500000
         MVI   3(1),1               SET VERSION NUMBER             @L1A 15550000
         AIF   ('&DCB' EQ '').NODCB                                     15600000
         AIF   ('&DCB'(1,1) EQ '(').REGDCB                              15650000
         &LA   0,&DCB               GET DCB ADDRESS @L1C                15700000
         ST    0,8(0,1)             STORE INTO PARAMETER LIST    Y02705 15750000
         AIF   ('&SYSASCE' EQ 'P').NODCB                           @L1A 15800000
         STAM  0,0,28(1)            SAVE DCB ALET                  @L1A 15850000
         AGO    .NODCB                                                  15900000
.REGDCB  ANOP                                                           15950000
.*                                                                 @P2D 15987500
         ST    &DCB,8(0,1)   STORE DCB ADDRESS INTO PARM LIST   G33SPHW 16025000
         MVI   8(1),0        CLEAR HIGH ORDER BYTE OF DCB ADR      @P2A 16062500
         AIF   ('&SYSASCE' EQ 'P').NODCB                           @L1A 16100000
         STAM  &DCB(1),&DCB(1),28(1) SAVE DCB ALET                 @L1A 16150000
.NODCB   ANOP                                                           16200000
         OI    1(1),&FLAGS3        SET OPTION FLAGS              Y02705 16250000
         OI    2(1),&FLAGS5        SET OPTION FLAG 2           @G860P1Y 16300000
.CKSDATA AIF   (T'&SDATA EQ 'O').CKPDATA    IS SDATA SPECIFIED   Y02705 16350000
         MVI   4(1),&FLAGS1        SET OPTION FLAGS              Y02705 16400000
         MVI   5(1),&FLAGS4        SET OPTIONS FLAGS            G33SPHW 16450000
.CKPDATA AIF   (T'&PDATA EQ 'O').GO1        IS PDATA SPECIFIED   Y02705 16500000
         MVI   6(1),&FLAGS2        SET OPTION FLAGS              Y02705 16550000
.GO1     ANOP                                                    Y02705 16600000
         AIF   ('&B1' EQ '0').NOTCB         IS TCB SPECIFIED     Y02705 16650000
         AIF   ('&TCB'(1,1) EQ '(').REGTCB  IS TCB ADDR IN A REG Y02705 16700000
         L     0,&TCB                       ADDRESS OF TCB       Y02705 16750000
         ST    0,12(0,1)                    INTO PARAMETER LIST  YM1995 16800000
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 16850000
.NOTCB   AIF   ('&TCB' EQ '''S''').CURRTCB  CURRENT TCB REQUEST  YO2705 16900000
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 16950000
.CURRTCB NI    1(1),X'FB'                   CURRENT TCB REQUEST  Y02705 17000000
         AGO   .GO2                         GO CHECK FOR STORAGE Y02705 17050000
.REGTCB  ANOP                                                    Y02705 17100000
         ST    &TCB,12(0,1)                 TCB ADDR INTO PARAM  YM1995 17150000
.GO2     ANOP                                                    Y02705 17200000
         AIF   ('&B5' EQ '0').NOSHOT                                    17250000
&CTR1    SETA  N'&STORAGE                                               17300000
         &LA   0,52(0,1)          SET UP SNAPSHOT LIST ADDRESS     @L1C 17350000
         ST    0,16(0,1)           STORE INTO PARAMETER LIST     Y02705 17400000
         AIF   ('&SYSASCE' EQ 'P').NOAR1                           @L1A 17450000
         STAM  0,0,32(1)            SAVE SNAPSHOT ALET             @L1A 17500000
.NOAR1   AIF   ('&B23' EQ '0').NOHEAD   STRHDR SPECIFIED           @L1C 17550000
&CTR4    SETA  N'&STRHDR                NUMBER OF HEADERS       G33SPHW 17600000
&CTR8    SETA  &CTR1*4+52               DISPLACEMENT               @L1C 17650000
         &LA   0,&CTR8.(0,1)       SET UP HEADER ADDRESS        G33SPHW 17700000
         ST    0,20(0,1)           STORE INTO PARMLIST          G33SPHW 17750000
         AIF   ('&SYSASCE' EQ 'P').NOHEAD                          @L1A 17800000
         STAM  0,0,36(1)            SAVE HEADER ALET               @L1A 17850000
.NOHEAD  ANOP                      NOHEADERS SPECIFIED          G33SPHW 17900000
.STRLOOP ANOP                                                           17950000
&CTR2    SETA   0                                                       18000000
&DISP    SETA  48                  DISP INTO STORAGE ADDR LIST     @L1C 18050000
.LOOP1   ANOP                                                           18100000
&CTR2    SETA  &CTR2+1                                                  18150000
&DISP    SETA  &DISP+4                                                  18200000
&C1      SETC  '&STORAGE(&CTR2)'                                        18250000
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').STOR1                    18300000
         AIF   ('&MF' EQ '').AIF1                                       18350000
         LA    0,&STORAGE(&CTR2)   GET STARTING/ENDING ADDRESS     5139 18400000
         ST    0,&DISP.(0,1)                                            18450000
         AGO   .AIF1                                                    18500000
.STOR1   ANOP                                                           18550000
         ST    &C1,&DISP.(0,1)     GET STARTING/ENDING ADDRESS          18600000
.AIF1    ANOP                                                           18650000
         AIF   ('&CTR2' NE '&CTR1').LOOP1                               18700000
         OI    &DISP.(1),X'80'     SET END OF LIST INDICATOR     Y02705 18750000
         AGO   .HDRLOOP              CHECK HEADER               G33SPHW 18800000
.HDRLOOP ANOP                        STRHDR PROCESS             G33SPHW 18850000
         AIF   ('&B23' EQ '0').AIF3  NO STRHDR                  G33SPHW 18900000
&CTR4    SETA  N'&STRHDR             NUMBER OF HEADERS          G33SPHW 18950000
&CTR3    SETA  0                     COUNTER INITIALIZED        G33SPHW 19000000
.LOOP6   ANOP                        LOOP THRU HEADERS          G33SPHW 19050000
&CTR3    SETA  &CTR3+1               BUMP COUNTER               G33SPHW 19100000
&DISP    SETA  &DISP+4               BUMP DISPLACEMENT          G33SPHW 19150000
&C3      SETC  '&STRHDR(&CTR3)'      GET HEADER ADDRESS         G33SPHW 19200000
         AIF   ('&STRHDR(&CTR3)' EQ '').COMA                    G33SPHW 19250000
         AIF   ('&STRHDR(&CTR3)'(1,1) EQ '(').STOR3             G33SPHW 19300000
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 19350000
         LA    0,&STRHDR(&CTR3)    GET HEADER ADDRESS           G33SPHW 19400000
         ST    0,&DISP.(0,1)       STORE IN PARMLIST            G33SPHW 19450000
         AGO   .CHKIF                END OF HEADERS             G33SPHW 19500000
.STOR3   ANOP                        STORE REG IN PARMLIST      G33SPHW 19550000
         ST    &C3,&DISP.(0,1)     STORE HEADER ADDRESS         G33SPHW 19600000
.CHKIF   ANOP                        CHECK END OF HEADERS       G33SPHW 19650000
         AIF   ('&CTR3' NE '&CTR4').LOOP6 NOT END               G33SPHW 19700000
         OI    &DISP.(1),X'80'     SET END OF HEADER INDICATOR  G33SPHW 19750000
         AGO   .AIF3               HEADERS COMPLETE             G33SPHW 19800000
.COMA    ANOP                                                   G33SPHW 19850000
         AIF   ('&MF' EQ '').CHKIF                              G33SPHW 19900000
         LA    0,&STRHDR(&CTR3)    GET HEADER ADDRESS           G33SPHW 19950000
         ST    0,&DISP.(0,1)       STORE IN PARMLIST            G33SPHW 20000000
         AGO  .CHKIF                                            G33SPHW 20050000
.AIF3    ANOP                                                   G33SPHW 20100000
         AIF   ('&MF' EQ '').NOSTR                                      20150000
.NOSHOT  ANOP                                                           20200000
         AIF   ('&B16' EQ '0').SUBPOPT     IS LIST SPECIFIED   @G860P1Y 20250000
         AIF   ('&LIST'(1,1) EQ '(').LL1                                20300000
         &LA   0,&LIST             GET LIST ADDRESS             G33SPHW 20350000
         ST    0,16(0,1)           STORE LIST ADDRESS IN PARM   G33SPHW 20400000
         AIF   ('&SYSASCE' EQ 'P').CHKH                            @L1A 20450000
         STAM  0,0,32(1)            SAVE SNAPSHOT ALET             @L1A 20500000
         AGO   .CHKH               CHECK HEADER SPECIFIED       G33SPHW 20550000
.LL1     ANOP                                                           20600000
         ST    &LIST,16(0,1) SNAPSHOT LIST ADDR INTO PARAM LIST  Y02705 20650000
         AIF   ('&SYSASCE' EQ 'P').CHKH                            @L1A 20700000
         STAM  &LIST(1),&LIST(1),32(1)  SAVE SNAPSHOT ALET         @L1A 20750000
         AGO   .CHKH                                            G33SPHW 20800000
.CHKH    ANOP                                                   G33SPHW 20850000
         AIF   ('&B23' EQ '0').NOHD   NO STRHDR SPECIFIED       G33SPHW 20900000
         AIF   ('&STRHDR'(1,1) EQ '(').STRHED                   G33SPHW 20950000
         &LA   0,&STRHDR     GET HEADER ADDRESS                 G33SPHW 21000000
         ST    0,20(0,1)     STORE HEADER ADDRESS               G33SPHW 21050000
         AIF   ('&SYSASCE' EQ 'P').NOHD                            @L1A 21100000
         STAM  0,0,36(1)     SAVE HEADER ALET                      @L1A 21150000
.NOHD    ANOP                                                   G33SPHW 21200000
         AGO   .SUBPOPT      CHECK SUBPLST OPTION              @G860P1Y 21250000
.STRHED  ANOP                HEADER IN REGISTER                 G33SPHW 21300000
         ST    &STRHDR,20(0,1) STORE HEADER ADDRESS             G33SPHW 21350000
         AIF   ('&SYSASCE' EQ 'P').SUBPOPT                         @L1A 21400000
         STAM  &STRHDR(1),&STRHDR(1),36(1) SAVE HEADER ALET        @L1A 21450000
.SUBPOPT ANOP                SET UP SUBPLST OPTION             @G860P1Y 21500000
         AIF   ('&B28' EQ '0').DSPSOP  WAS SUBPLST= SPECIFIED      @L2C 21550000
         AIF   ('&SUBPLST'(1,1) EQ '(').SUBREG  REG FORM USED  @G860P1Y 21600000
         &LA   0,&SUBPLST          GET SUBPOOL LIST ADDRESS    @G860P1Y 21650000
         ST    0,24(0,1)           STORE SUBPOOL LIST ADDRESS  @G860P1Y 21700000
         AIF   ('&SYSASCE' EQ 'P').DSPSOP                          @L2C 21750000
         STAM  0,0,40(1)           SAVE SUBPOOL LIST ALET          @L1A 21800000
         AGO   .DSPSOP             CHECK DSPSTOR OPTION            @L2C 21850000
.SUBREG  ANOP                                                  @G860P1Y 21900000
         ST    &SUBPLST,24(0,1)    STORE SUBPOOL LIST ADDRESS  @G860P1Y 21950000
         AIF   ('&SYSASCE' EQ 'P').DSPSOP                          @L2C 22000000
         STAM  &SUBPLST(1),&SUBPLST(1),40(1) SAVE SUBPLST ALET     @L1A 22050000
         AGO   .DSPSOP       CHECK DSPSTOR OPTION                  @L2C 22056600
.DSPSOP  ANOP                      SET UP DSPSTOR OPTION           @L2A 22063200
         AIF   ('&B29' EQ '0').IDPREP  WAS DSPSTOR= SPECIFIED      @L2A 22069800
         AIF   ('&DSPSTOR'(1,1) EQ '(').DSPREG  REG FORM USED      @L2A 22076400
         &LA   0,&DSPSTOR          GET DATA SPACE LIST ADDRESS     @L2A 22083000
         ST    0,44(0,1)           STORE DSPSTOR LIST ADDRESS      @L2A 22089600
         AIF   ('&SYSASCE' EQ 'P').IDPREP                          @L2A 22096200
         STAM  0,0,48(1)           SAVE DSPSTOR LIST ALET          @L2A 22102800
         AGO   .IDPREP             PREPARE FOR ID                  @L2A 22109400
.DSPREG  ANOP                                                      @L2A 22116000
         ST    &DSPSTOR(1),44(0,1)   STORE DATA SPACE LIST ADDRESS @L2A 22122600
         AIF   ('&SYSASCE' EQ 'P').IDPREP                          @L2A 22129200
         STAM  &DSPSTOR(1),&DSPSTOR(1),48(1)   SAVE DSPSTOR ALET   @L2A 22135800
         AGO   .IDPREP             PREPARE FOR ID                  @L2A 22142400
.IDPREP  ANOP                                                           22150000
         AIF   ('&B6' EQ '0').NOID                                      22200000
         AIF   ('&ID'(1,1) EQ '(').IDPREP1                              22250000
         MVI   0(1),&ID            GET ID NUMBER                        22300000
         AGO    .NOID                                                   22350000
.IDPREP1  ANOP                                                          22400000
         STC   &ID,0(0,1)         GET ID NUMBER                  YM1995 22450000
.NOID    ANOP                                                           22500000
.NOVERSN ANOP                                                      @L1A 22550000
         SVC   51                                                       22600000
         MEXIT                                                          22650000
.********************************************************************** 22700000
.*                                                                    * 22750000
.*      PROCESS THE STANDARD FORM                                     * 22800000
.*                                                            @G860P33* 22850000
.********************************************************************** 22900000
.STYPE   ANOP                                                           22950000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          23000000
         CNOP  0,4                                                      23050000
&NAME    BAL   1,&GNAME            BRANCH AROUND PARAM LIST             23100000
.LSTYPE  ANOP                                                           23150000
         AIF   ('&B6' EQ '0').NOIDS                                     23200000
         AIF   ('&ID'(1,1) EQ '(').NOIDS                                23250000
         DC    AL1(&ID)            ID NUMBER                            23300000
         AGO   .CONT2                                                   23350000
.NOIDS   ANOP                                                           23400000
         DC    AL1(0)              ID NUMBER                            23450000
.CONT2   ANOP                                                           23500000
         DC    AL1(&FLAGS3)        OPTION FLAGS                  Y02705 23550000
         DC    AL1(&FLAGS5)        OPTIONS FLAG 2              @G860P1Y 23600000
         DC    AL1(1)              VERSION NUMBER                  @L1C 23650000
         DC    AL1(&FLAGS1)        SDATA FLAGS ONE               Y02705 23700000
         DC    AL1(&FLAGS4)        SDATA FLAGS TWO              G33SPHW 23750000
         DC    AL1(&FLAGS2)        PDATA FLAGS                   Y02705 23800000
         DC    AL1(0)              RESERVED                      Y02705 23850000
         AIF   ('&DCB' EQ '').DCBA0                                     23900000
         AIF   ('&DCB'(1,1) EQ '(').DCBA0                          9943 23950000
         DC    A(&DCB)             DCB ADDRESS                          24000000
         AGO   .DCBA1                                                   24050000
.DCBA0   ANOP                                                           24100000
         DC    A(0)                DCB ADDRESS                          24150000
.DCBA1    ANOP                                                          24200000
         DC    A(0)                TCB ADDRESS                          24250000
         AIF   ('&B5' EQ '0' AND '&B16' EQ '0').LISTREG                 24300000
         AIF   ('&B5' EQ '1').STORON                                    24350000
         AIF   ('&LIST'(1,1) EQ '(').LISTRG                    @ZA51152 24400000
         DC    A(&LIST)            ADDRESS OF SNAPSHOT LIST             24450000
         AGO   .CHHDR                                          @ZA51152 24500000
.LISTRG  ANOP                                                  @ZA51152 24550000
         DC    A(0)                ADDRESS OF SNAPSHOT LIST    @ZA51152 24600000
.CHHDR   ANOP                                                  @ZA51152 24650000
         AIF   ('&B23' EQ '1').SHSPEC  STRHDR SPECIFIED         G33SPHW 24700000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 24750000
         AGO   .PROCSUB                                         G33SPHW 24800000
.SHSPEC  ANOP                                                   G33SPHW 24850000
         AIF   ('&STRHDR'(1,1) EQ '(').HDRLIST                  G33SPHW 24900000
         DC    A(&STRHDR)          ADDRESS OF HEADER LIST       G33SPHW 24950000
         AGO   .PROCSUB                                         G33SPHW 25000000
.HDRLIST ANOP                                                   G33SPHW 25050000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 25100000
         AGO   .PROCSUB                                                 25150000
.STORON  ANOP                                                           25200000
&CTR1    SETA  N'&STORAGE                                               25250000
         AGO   .PROSTOR                                                 25300000
.LISTREG ANOP                                                           25350000
         DC    A(0)                ADDRESS OF SNAP-SHOT LIST            25400000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 25450000
         AGO   .PROCSUB                                                 25500000
.PROCSUB ANOP                      PROCESS SUBPLST OPTION      @G860P1Y 25550000
         AIF   ('&B28' EQ '0').SUBDC     WAS SUBPLST SPECIFIED     @L1C 25600000
         AIF   ('&SUBPLST'(1,1) EQ '(').SUBDC    LIST SUPPLIED @G860P1Y 25650000
         DC    A(&SUBPLST)         ADDRESS OF SUBPOOL LIST     @G860P1Y 25700000
         AGO   .ALETDC             GENERATE ALET AREAS             @L1C 25750000
.SUBDC   ANOP                      SUBPLST NOT SPECIFIED       @G860P1Y 25800000
         DC    A(0)                ADDRESS OF SUBPOOL LIST     @G860P1Y 25850000
.ALETDC  DC    A(0)                ALET FOR DCB                    @L1A 25900000
         DC    A(0)                ALET FOR SNAPSHOT/LIST          @L1A 25950000
         DC    A(0)                ALET FOR HDR                    @L1A 26000000
         DC    A(0)                ALET FOR SUBPLST                @L1A 26050000
         AIF   ('&B29' EQ '0').DSPDC    WAS DSPSTOR SPECIFIED      @L2A 26068700
         AIF   ('&DSPSTOR'(1,1) EQ '(').DSPDC STOKEN LIST SUPPLIED @L2A 26087400
         DC    A(&DSPSTOR)         ADDRESS OF STOKEN LIST          @L2A 26106100
         DC    A(0)                ALET OF STOKEN LIST             @L2A 26124800
         AGO   .CONT8              CHECK MACRO FORM                @L2A 26143500
.DSPDC   DC    A(0)                ADDRESS OF STOKEN LIST          @L2C 26162200
         DC    A(0)                ALET OF STOKEN LIST             @L2C 26180900
         AGO   .CONT8              CHECK MACRO FORM            @G860P1Y 26200000
.PROSTOR ANOP                                                           26250000
         DC    A(*+36)             ADDRESS OF SNAP-SHOT LIST       @O1C 26300000
         AIF   ('&B23' EQ '0').NOSTRHD    STRHDR SPECIFIED      G33SPHW 26350000
&CTR3    SETA  N'&STORAGE+2        NUMBER OF STORAGE ADDRESSES @G860P1Y 26400000
&CTR5    SETA  &CTR3*4+24                DISP. FOR HEADER          @01C 26450000
         DC    A(*+&CTR5.)         ADDRESS OF HEADER LIST       G33SPHW 26500000
         AGO   .ARNDC                     AROUND DC             G33SPHW 26550000
.NOSTRHD ANOP                                                   G33SPHW 26600000
         DC    A(0)                ADDRESS OF HEADER LIST       G33SPHW 26650000
.ARNDC   ANOP                                                           26700000
         AIF   ('&B28' EQ '0').SUBPDC    WAS SUBPLST SPECIFIED     @L1C 26750000
         AIF   ('&SUBPLST'(1,1) EQ '(').SUBPDC   LIST SUPPLIED @G860P1Y 26800000
         DC    A(&SUBPLST)         ADDRESS OF SUBPOOL LIST     @G860P1Y 26850000
         AGO   .SETALET            PROCESS STORAGE RANGES          @L2C 26900000
.SUBPDC  ANOP                      SUBPLST NOT SPECIFIED       @G860P1Y 26950000
         DC    A(0)                ADDRESS OF SUBPOOL LIST     @G860P1Y 27000000
.SETALET ANOP                      SET ALETS                       @L2A 27050000
         DC    A(0)                ALET FOR DCB                    @L1A 27100000
         DC    A(0)                ALET FOR SNAPSHOT/LIST          @L1A 27150000
         DC    A(0)                ALET FOR HDR                    @L1A 27200000
         DC    A(0)                ALET FOR SUBPLST                @L1A 27250000
         AIF   ('&B29' EQ '0').STKNDC   WAS DSPSTOR SPECIFIED      @L2A 27266600
         AIF   ('&DSPSTOR'(1,1) EQ '(').STKNDC STOKEN LIST IN REG  @L2A 27283200
         DC    A(&DSPSTOR)         ADDRESS OF STOKEN LIST          @L2A 27299800
         DC    A(0)                ALET OF STOKEN LIST             @L2A 27316400
         AGO   .SETCTR2            PROCESS STORAGE RANGES          @L2A 27333000
.STKNDC  DC    A(0)                ADDRESS OF STOKEN LIST          @L2C 27349600
         DC    A(0)                ALET OF STOKEN LIST             @L2C 27366200
.SETCTR2 ANOP                      PROCESS STORAGE RANGES          @L2M 27382800
&CTR2    SETA  0                                                        27400000
.LOOP3   ANOP                                                           27450000
&CTR2    SETA  &CTR2+1                                                  27500000
         AIF   ('&STORAGE(&CTR2)' EQ '').STYPE3                         27550000
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').STYPE2                   27600000
         AIF   ('&CTR2' EQ '&CTR1' AND '&MF' EQ 'L').LSTEND    @G860P33 27650000
         DC    A(&STORAGE(&CTR2))  STORAGE ADDRESS                      27700000
.STLIST  ANOP                                                  @G860P33 27750000
         AIF   ('&CTR2' NE '&CTR1').LOOP3                               27800000
         AIF   ('&B23' EQ '1').CKLFORM                          G33SPHW 27850000
         AGO   .CONT8                CHECK MACRO FORM          @G860P1Y 27900000
.LSTEND  ANOP                                                  @G860P33 27950000
         DC    A(&STORAGE(&CTR2)+X'80000000') END ADDRESS      @G860P33 28000000
         AGO   .STLIST                                         @G860P33 28050000
.CKLFORM ANOP                                                   G33SPHW 28100000
         AIF   ('&MF' NE 'L').ARND                              G33SPHW 28150000
         AIF   ('&STORAGE' EQ '').ARND                          G33SPHW 28200000
.ARND    ANOP                                                   G33SPHW 28250000
&CTR3    SETA  N'&STRHDR                                        G33SPHW 28300000
&CTRB    SETA  0                                                G33SPHW 28350000
.CKHDRLP ANOP                                                   G33SPHW 28400000
&CTRB    SETA  &CTRB+1                                          G33SPHW 28450000
         AIF   ('&STRHDR(&CTRB)' EQ '').HDADCON                 G33SPHW 28500000
         AIF   ('&STRHDR(&CTRB)'(1,1) EQ '(').NOTREG            G33SPHW 28550000
         AIF   ('&CTRB' EQ '&CTR3' AND '&MF' EQ 'L').HDREND    @G860P33 28600000
         DC    A(&STRHDR(&CTRB))   ADDRESS OF HEADER            G33SPHW 28650000
.MOREHDR ANOP                                                   G33SPHW 28700000
         AIF   ('&CTR3' NE '&CTRB').CKHDRLP                     G33SPHW 28750000
         AGO   .CONT8                CHECK MACRO FORM          @G860P1Y 28800000
.HDREND  ANOP                                                  @G860P33 28850000
         DC    A(&STRHDR(&CTRB)+X'80000000')  END ADDRESS      @G860P33 28900000
         AGO   .MOREHDR                                        @G860P33 28950000
.HDADCON ANOP                                                   G33SPHW 29000000
         DC   A(0)                ADDRESS OF HEADER             G33SPHW 29050000
         AGO  .MOREHDR                                          G33SPHW 29100000
.NOTREG  ANOP                                                   G33SPHW 29150000
         AIF   ('&MF' EQ 'L').MSGB REG FORMAT WITH MF=L         G33SPHW 29200000
         DC    A(0)               ADDRESS OF HEADER             G33SPHW 29250000
         AGO   .MOREHDR                                         G33SPHW 29300000
.STYPE1  ANOP                                                           29350000
         AIF   ('&CTR2' NE '&CTR1').LOOP3                               29400000
         AIF   ('&B23' EQ '1').CKLFORM                                  29450000
.CONT8   ANOP                      CONTINUE PROCESSING MACRO   @G860P1Y 29500000
         AIF   ('&MF' EQ 'L').EXIT                                      29550000
&GNAME   DS    0H                                                       29600000
         AIF   ('&B6' EQ '0').NOSTR0                                    29650000
         AIF   ('&ID'(1,1) NE '(').NOSTR0                               29700000
         STC   &ID,0(0,1)       GET ID NUMBER                    YM1995 29750000
.NOSTR0  ANOP                                                           29800000
         AIF   ('&B5' EQ '0').NOSTR1                                    29850000
         AGO   .STRLOOP                                                 29900000
.LHDRS   ANOP                                                   G33SPHW 29950000
         AIF  ('&B23' EQ '0').STRLOOP                           G33SPHW 30000000
&CTRB    SETA   0                                               G33SPHW 30050000
&CTR5    SETA   N'&STRHDR                                       G33SPHW 30100000
.LOOPHDR ANOP                                                   G33SPHW 30150000
&CTRB    SETA  &CTRB+1                                          G33SPHW 30200000
         AIF   ('&STRHDR(&CTRB)' EQ '').SKIPHD                  G33SPHW 30250000
         AIF   ('&STRHDR(&CTRB)'(1,1) EQ '(').CHKL              G33SPHW 30300000
         DC    A(&STRHDR(&CTRB))   ADDRESS OF HEADER            G33SPHW 30350000
.CHKEND  ANOP                                                   G33SPHW 30400000
         AIF   ('&CTRB' NE '&CTR5').LOOPHDR                     G33SPHW 30450000
         AIF   ('&MF' EQ 'L').EXIT                              G33SPHW 30500000
         DS   0H       ALIGN ON WORD BDY                                30550000
         AGO  .STRLOOP                                          G33SPHW 30600000
.SKIPHD  ANOP                                                   G33SPHW 30650000
         DC   A(0)                 ADDRESS OF HEADER            G33SPHW 30700000
         AGO   .CHKEND                                          G33SPHW 30750000
.CHKL    ANOP                                                   G33SPHW 30800000
         AIF   ('&MF' EQ 'L').MSGB                              G33SPHW 30850000
         DC    A(0)                ADDRESS OF HEADER            G33SPHW 30900000
         AGO     .CHKEND                                        G33SPHW 30950000
.NOSTR   ANOP                                                           31000000
         AIF   ('&B28' EQ '0').CKDSP  SUBPLST= NOT SPECIFIED       @L2C 31050000
         AIF   ('&SUBPLST'(1,1) EQ '(').REGSUB  REG FORM ADDR  @G860P1Y 31100000
         AIF   ('&MF' EQ '').CKDSP   STANDARD FORM OF MACRO        @L2C 31150000
         &LA   0,&SUBPLST          OBTAIN SUBPLST ADDRESS      @G860P1Y 31200000
         ST    0,24(0,1)           STORE ADDRESS IN PARMLIST   @G860P1Y 31250000
         AIF   ('&SYSASCE' EQ 'P').CKDSP                           @L2C 31300000
         STAM  0,0,40(1)           SAVE SUBPLST ALET               @L1A 31350000
         AGO   .CKDSP              CHECK IF DSPSTOR SUPPLIED       @L2C 31400000
.REGSUB  ANOP                      REGISTER SPECIFIED, USE IT  @G860P1Y 31450000
         ST    &SUBPLST,24(0,1)    STORE SUBPOOL LIST ADDRESS  @G860P1Y 31500000
         AIF   ('&SYSASCE' EQ 'P').CKDSP                           @L2C 31550000
         STAM  &SUBPLST(1),&SUBPLST(1),40(1) SAVE SUBPLST ALET     @L1A 31600000
.CKDSP   ANOP                                                      @L2A 31603500
         AIF   ('&B29' EQ '0').CKTCB  DSPSTOR= NOT SPECIFIED       @P1C 31607000
         AIF   ('&DSPSTOR'(1,1) EQ '(').REGDSP  DSPSTOR IN REG     @L2A 31610500
         AIF   ('&MF' EQ '').CKTCB   STANDARD FORM OF MACRO        @L2A 31614000
         &LA   0,&DSPSTOR            OBTAIN DSPSTOR ADDRESS        @L2A 31617500
         ST    0,44(0,1)             STORE ADDRESS IN PARMLIST     @L2A 31621000
         AIF   ('&SYSASCE' EQ 'P').CKTCB                           @L2A 31624500
         STAM  0,0,48(1)              SAVE DSPSTOR ALET            @L2A 31628000
         AGO   .CKTCB                 CHECK TCB ADDRESS            @L2A 31631500
.REGDSP  ANOP                                                      @L2A 31635000
         ST    &DSPSTOR(1),44(0,1)    STORE DATA SPACES LIST ADDR  @L2A 31638500
         AIF   ('&SYSASCE' EQ 'P').CKTCB                           @L2A 31642000
         STAM  &DSPSTOR(1),&DSPSTOR(1),48(1) SAVE DSPSTOR ALET     @L2A 31645500
.CKTCB   ANOP                      CHECK TCB ADDRESS           @G860P1Y 31650000
         AIF   ('&B1' EQ '0').CKDCB                                9943 31700000
         AIF   ('&TCB'(1,1) EQ '(').STRTCB                              31750000
         L     0,&TCB        GET TCB ADDRESS                            31800000
         ST    0,12(0,1)     STORE IN PARAMETER LIST             Y02705 31850000
         AGO   .CKDCB                                              9943 31900000
.NOSTR1  ANOP                                                           31950000
         AIF   ('&B16' EQ '0').NOSTR                                    32000000
         AIF   ('&LIST'(1,1) EQ '(').REGLIST                            32050000
         AIF   ('&MF' EQ '').CKLIST                                     32100000
         &LA   0,&LIST       GET ADDRESS OF SNAPSHOT LIST               32150000
         ST    0,16(0,1)       STORE INTO PARAMETER LIST         Y02705 32200000
         AIF   ('&SYSASCE' EQ 'P').CKLIST                          @L1A 32250000
         STAM  0,0,32(1)       SAVE SNAPSHOT LIST ALET             @L1A 32300000
.CKLIST  ANOP                                                   G33SPHW 32350000
         AIF   ('&B23' EQ '0').NOSTR                            G33SPHW 32400000
         AIF   ('&STRHDR'(1,1) EQ '(').CHKHDR REG FORM ADDRESS  G33SPHW 32450000
         AIF   ('&MF' EQ '').NOSTR           STANDARD FORM      G33SPHW 32500000
         &LA   0,&STRHDR       GET ADDRESS OF HEADER LIST       G33SPHW 32550000
         ST    0,20(0,1)       STORE HEADER ADDRESS             G33SPHW 32600000
         AIF   ('&SYSASCE' EQ 'P').NOSTR                           @L1A 32650000
         STAM  0,0,36(1)       SAVE HEADER ALET                    @L1A 32700000
         AGO   .NOSTR          RETURN                           G33SPHW 32750000
.CHKHDR  ANOP                                                   G33SPHW 32800000
         ST    &STRHDR,20(0,1) STORE INTO PARMLIST              G33SPHW 32850000
         AIF   ('&SYSASCE' EQ 'P').NOSTR                           @L1A 32900000
         STAM  &STRHDR(1),&STRHDR(1),36(1) SAVE HEADER ALET        @L1A 32950000
         AGO  .NOSTR                                                    33000000
.REGLIST ANOP                                                           33050000
         ST    &LIST,16(0,1)       STORE SNAPSHOT ADDR INTO PARM LIST   33100000
         AIF   ('&SYSASCE' EQ 'P').CKLIST                          @L1A 33150000
         STAM  &LIST(1),&LIST(1),32(1) SAVE SNAPSHOT LIST ALET     @L1A 33200000
         AGO   .CKLIST                                                  33250000
.STYPE2  ANOP                                                           33300000
         AIF   ('&MF' EQ 'L').MSG4                                      33350000
         DC    A(0)                STARTING/ENDING ADDRESS              33400000
         AGO   .STYPE1                                                  33450000
.STYPE3  ANOP                                                           33500000
         AIF   ('&MF' EQ '').MSG4                                       33550000
         DC    A(0)                STARTING/ENDING ADDRESS              33600000
         AGO   .STYPE1                                                  33650000
.STRTCB  ANOP                                                           33700000
         ST    &TCB,12(0,1)        STORE ADDRESS OF TCB INTO PARM LIST  33750000
.CKDCB   AIF   ('&DCB'(1,1) NE '(').SVC51                          9943 33800000
.*                                                                 @P2D 33850000
         ST    &DCB,8(0,1)   STORE DCB ADDRESS INTO PARM LIST   G33SPHW 33900000
         MVI   8(1),0        CLEAR HIGH ORDER BYTE OF DCB ADR      @P2A 33925000
         AIF   ('&SYSASCE' EQ 'P').SVC51                           @L1A 33950000
         STAM  &DCB(1),&DCB(1),28(1)  SAVE DCB ALET                @L1A 34000000
.SVC51   ANOP                                                           34050000
         SVC   51                                                       34100000
.EXIT    ANOP                                                           34150000
.EXIT1   ANOP                                                           34200000
         MEXIT                                                          34250000
.********************************************************************** 34300000
.*                                                                    * 34350000
.*      PROCESS THE LIST FORM                                         * 34400000
.*                                                            @G860P33* 34450000
.********************************************************************** 34500000
.LTYPE   ANOP                                                           34550000
         AIF   ('&TCB' NE '').MSG6                                 2607 34600000
         AIF   ('&SUBPLST' EQ '').CKSTOR  SUBPLST= NOT REQSTD  @G860P1Y 34650000
         AIF   ('&SUBPLST'(1,1) EQ '(').MSGB  REG FORMAT USED  @ZMC0817 34700000
.CKSTOR  ANOP                      CHECK IF STORAGE SPECIFIED  @G860P1Y 34750000
         AIF   ('&STORAGE' EQ '').LTYPE1                                34800000
         AIF   ('&STORAGE'(2,1) EQ '(').MSG4 NO STRHDR                  34850000
         AIF   ('&STRHDR' EQ '').SKIPL  ONE HEADER              G33SPHW 34900000
         AIF   (N'&STRHDR EQ 1).REGMFL  REG FORMAT W/MF=L       G33SPHW 34950000
         AIF   ('&STRHDR'(2,1) EQ '(').MSGB                     G33SPHW 35000000
.REGMFL  ANOP                                                   G33SPHW 35050000
.SKIPL   ANOP                                                   G33SPHW 35100000
         AGO   .LTYPE2                                                  35150000
.LTYPE1  ANOP                                                           35200000
         AIF   ('&LIST' EQ '').LTYPE2                                   35250000
         AIF   ('&LIST'(1,1) EQ '(').MSG4                               35300000
         AIF   ('&STRHDR' EQ '').SKIPM   NO STRHDR              G33SPHW 35350000
         AIF   ('&STRHDR'(1,1) EQ '(').MSGB REG FORMAT W/MF=L   G33SPHW 35400000
.SKIPM  ANOP                                                            35450000
.LTYPE2  ANOP                                                           35500000
         AIF   ('&DSPSTOR' EQ '').LTYPE3                           @L2A 35512500
         AIF   ('&DSPSTOR'(1,1) EQ '(').MSGB                       @L2A 35525000
.LTYPE3  ANOP                                                      @L2A 35537500
&NAME    DS    0F                                                       35550000
         AGO   .LSTYPE                                                  35600000
.MSG1    IHBERMAC  6                                                    35650000
         MEXIT                                                          35700000
.MSG2    ANOP                                                           35750000
&B2      SETB  1                                                        35800000
&B3      SETB  0                                                        35850000
&B4      SETB  0                                                        35900000
&B7      SETB  0                                                        35950000
&B17     SETB  0                  NO SQA                         Y02705 36000000
&B18     SETB  0                  NO LSQA                        YO2705 36050000
&B19     SETB  0                  NO SWA                         Y02705 36100000
&B20     SETB  0                                                        36150000
&B21     SETB  0                                                        36200000
&B22     SETB  0                                                        36250000
         IHBERMAC  183,&SDATA,CB                                        36300000
         AGO   .CHKSTR                                                  36350000
.MSG4    IHBERMAC  189                                                  36400000
         MEXIT                                                          36450000
.MSG7   MNOTE 7,'STRHDR FORMAT INCORRECT'                       G33SPHW 36500000
        MEXIT                                                           36550000
.MSG8   MNOTE 7,'NUMBER OF STRHDR ADDRESSES EXCEED STORAGE RANGES'      36600000
        MEXIT                                                           36650000
.MSG9   MNOTE 7,'INVALID USE OF STRHDR NO STORAGE OR LIST SPECIFIED'    36700000
        MEXIT                                                           36750000
.MSGA   MNOTE 8,'LIST FORMAT NOT SPECIFIED ON STRHDR REQ. ON LIST'      36800000
        MEXIT                                                           36850000
.MSGB   MNOTE 8,'REGISTER FORMAT USED WITH MF=L'                G33SPHW 36900000
        MEXIT                                                           36950000
.MSGSUBP MNOTE 8,'SPLS AND SUBPLST SPECIFIED, MUTUALLY EXCLUSIVE'       37000000
.*                                                             @G860P1Y 37050000
         MEXIT                                                          37100000
.MSGNOTL MNOTE 8,'INVALID LIST ADDRESS FOR SUBPLST OPTION'     @G860P1Y 37150000
         MEXIT                                                          37200000
.MSGDSPL MNOTE 8,'INVALID LIST ADDRESS FOR DSPSTOR OPTION'         @L2A 37216600
         MEXIT                                                     @L2A 37233200
.MSG3    ANOP                                                           37250000
&B8      SETB  1                                                        37300000
&B9      SETB    0                                                      37350000
&B10     SETB  1                                                        37400000
&B11     SETB  1                                                        37450000
&B12     SETB  1                                                        37500000
&B13     SETB  1                                                        37550000
&B14     SETB  1                                                        37600000
&B15     SETB  1                         SUBTASKS OPTION       @G860P33 37650000
         IHBERMAC  183,&PDATA,ALL                                       37700000
         AGO   .SETFLAG                                                 37750000
.MSG5    IHBERMAC  35,,&MF                                              37800000
         MEXIT                                                          37850000
.MSG6    IHBERMAC   197                                            2607 37900000
         MEND                                                           37950000
