*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IEARBUP                                -11/10/99-<> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  RB update service                             * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00600000
*                                                                     * 00700000
* STATUS= HBB7703                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      IEARBUP allows you to request that the system update the PSW   * 01100000
*      address in the RB.                                             * 01150000
*                                                                     * 01200000
*01* EXTERNAL CLASSIFICATION:                                         * 01250000
*                                                                     * 01300000
*02* GUPI: BASE                                                       * 01350000
*                                                                     * 01400000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01450000
*                                                                     * 01500000
*01* ENVIRONMENT:                                                     * 01550000
*                                                                     * 01600000
*                                                                     * 01650000
*      Minimum authorization:                                         * 01700000
*                                                                     * 01750000
*                        The minimum authority for IEARBUP is         * 01800000
*                        supervisor state and PSW key 0.              * 01850000
*                                                                     * 01900000
*      Dispatchable unit mode: Task mode.                             * 01950000
*                                                                     * 02000000
*      Cross Memory Mode: PASN=HASN, any SASN.                        * 02050000
*                                                                     * 02100000
*      AMODE:            31-bit.                                      * 02150000
*                                                                     * 02200000
*      ASC mode:         Primary.                                     * 02250000
*                                                                     * 02300000
*      Interrupt status: Enabled or disabled for I/O and external     * 02350000
*                        interrupts.                                  * 02400000
*                                                                     * 02450000
*      Locks:            No locks are required.  The caller may hold  * 02500000
*                        a local lock, the CMS lock or the CPU lock.  * 02550000
*                                                                     * 02600000
*      Control parameters: Control parameters must be in the primary  * 02650000
*                        address space.                               * 02700000
*                                                                     * 02750000
*                                                                     * 02800000
*                                                                     * 02850000
*01* PROGRAMMING REQUIREMENTS:                                        * 02900000
*                                                                     * 02950000
*    The caller must include the CVT and IHAECVT mapping macros.      * 03000000
*                                                                     * 03050000
*01* RESTRICTIONS:                                                    * 03100000
*                                                                     * 03150000
*    If the caller holds the CPU lock, the parameter list must be in  * 03200000
*    fixed or DREF storage.                                           * 03250000
*                                                                     * 03300000
*01* INPUT REGISTER INFORMATION:                                      * 03350000
*                                                                     * 03400000
*    Before issuing the IEARBUP macro, the caller does not have to    * 03450000
*    place any information into any general purpose register (GPR) or * 03500000
*    access register (AR) unless using it in register notation for a  * 03550000
*    particular parameter, or using it as a base register.            * 03600000
*                                                                     * 03650000
*01* OUTPUT REGISTER INFORMATION:                                     * 03700000
*                                                                     * 03750000
*    When control returns to the caller, the GPRs contain:            * 03800000
*                                                                     * 03850000
*                                                                     * 03900000
*    REGISTER    CONTENTS                                             * 03950000
*                                                                     * 04000000
*    0-1         Used as work registers by the system                 * 04050000
*                                                                     * 04100000
*    2-13        Unchanged                                            * 04150000
*                                                                     * 04200000
*    14          Used as a work register by the system                * 04250000
*                                                                     * 04300000
*    15          Return code                                          * 04350000
*                                                                     * 04400000
*                                                                     * 04450000
*                                                                     * 04500000
*    When control returns to the caller, the ARs contain:             * 04550000
*                                                                     * 04600000
*                                                                     * 04650000
*    REGISTER    CONTENTS                                             * 04700000
*                                                                     * 04750000
*    0-1         Used as work registers by the system.                * 04800000
*                                                                     * 04850000
*    2-13        Unchanged                                            * 04900000
*                                                                     * 04950000
*    14-15       Used as work registers by the system                 * 05000000
*                                                                     * 05050000
*                                                                     * 05100000
*                                                                     * 05150000
*    Some callers depend on register contents remaining the same      * 05200000
*    before and after issuing a service.  If the system changes the   * 05250000
*    contents of registers on which the caller depends, the caller    * 05300000
*    must save them before issuing the service, and restore them      * 05350000
*    after the system returns control.                                * 05400000
*                                                                     * 05450000
*01* PERFORMANCE IMPLICATIONS:                                        * 05500000
*    None.                                                            * 05550000
*                                                                     * 05600000
*01* SYNTAX:                                                          * 05650000
*                                                                     * 05700000
*[xlabel]  IEARBUP    WHICHRB=CURRENT                                * 05750000
*                    ,WHICHRB=PREV                                   * 05800000
*                    ,PSWBYTE03=NO                                   * 05850000
*                    ,PSWBYTE03=YES                                  * 05900000
*                   [,ADDRTYPE=NO_CHANGE]                            * 05950000
*                   [,ADDRTYPE=INRBOPSWA]                            * 06000000
*                   [,ADDRTYPE=ACTUAL                                * 06050000
*                   |     ,PSWADDR=xpswaddr                           * 06100000
*                   |    ,AMODE=UNCHANGED                            * 06150000
*                   |    ,AMODE=24                                   * 06200000
*                   |    ,AMODE=31                                   * 06250000
*                   |    ,AMODE=64]                                  * 06300000
*                   [,ADDRTYPE=DELTA                                 * 06350000
*                         ,PSWDELTA=xpswdelta]                        * 06400000
*                    [,RETCODE=xretcode]                              * 06450000
*                    [,RSNCODE=xrsncode]                              * 06475000
*                   [,MF=S]                                          * 06500000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 06550000
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 06600000
*                                                                     * 06650000
*                                                                     * 06700000
*      Where:                                                         * 06750000
*                                                                     * 06800000
*                                                                     * 06850000
*      [xlabel]                                                       * 06900000
*          is an optional symbol, starting in column 1, that is the   * 06950000
*          name on the IEARBUP macro invocation.  The name must       * 07000000
*          conform to the rules for an ordinary assembler language    * 07050000
*          symbol.                                                    * 07100000
*          DEFAULT: No name.                                          * 07150000
*                                                                     * 07200000
*                                                                     * 07250000
*                                                                     * 07300000
*                                                                     * 07350000
*      WHICHRB=CURRENT|PREV                                         * 07400000
*          is a required keyword input that identifies the RB to be   * 07450000
*          updated                                                    * 07500000
*                                                                     * 07550000
*                                                                     * 07600000
*          WHICHRB=CURRENT                                            * 07650000
*              indicates to update the current RB.                    * 07700000
*                                                                     * 07750000
*          WHICHRB=PREV                                               * 07800000
*              indicates to update the previous (older) RB.           * 07850000
*                                                                     * 07900000
*                                                                     * 07950000
*                                                                     * 08000000
*                                                                     * 08050000
*                                                                     * 08100000
*                                                                     * 08150000
*      PSWBYTE03=NO|YES                                             * 08200000
*          is a required keyword input that indicates whether the     * 08250000
*          user has updated the first 4 bytes (bytes 0 to 3) of       * 08300000
*          RBOPSW. If so, the system should use those updated values. * 08350000
*                                                                     * 08400000
*                                                                     * 08450000
*          PSWBYTE03=NO                                               * 08500000
*              indicates that bytes 0 to 3 were not modified.         * 08550000
*                                                                     * 08600000
*          PSWBYTE03=YES                                              * 08650000
*              indicates that bytes 0 to 3 were modified.             * 08700000
*                                                                     * 08750000
*                                                                     * 08800000
*                                                                     * 08850000
*                                                                     * 08900000
*                                                                     * 08950000
*                                                                     * 09000000
*      [ADDRTYPE=NO_CHANGE|INRBOPSWA|ACTUAL|DELTA]                  * 09050000
*          is an optional keyword input that identifies the method by * 09100000
*          which the PSW address is provided                          * 09150000
*          DEFAULT: NO_CHANGE                                         * 09200000
*                                                                     * 09250000
*                                                                     * 09300000
*          [ADDRTYPE=NO_CHANGE]                                       * 09350000
*              indicates that the PSW address has not been changed.   * 09400000
*                                                                     * 09450000
*          [ADDRTYPE=INRBOPSWA]                                       * 09500000
*              indicates that the PSW address has been updated in     * 09550000
*              RBOPSWA, along with the AMODE indicator(s).            * 09600000
*                                                                     * 09650000
*          [ADDRTYPE=ACTUAL                                           * 09700000
*              indicates that the PSW address is to be used as is.    * 09750000
*                                                                     * 09800000
*                                                                     * 09850000
*              PSWADDR=xpswaddr                                       * 09900000
*                  is the name (RS-type), or address in register      * 09950000
*                  (2)-(12), of a required 8 character input that     * 10000000
*                  contains the address to be placed into the PSW     * 10050000
*                  stored in the RB. The high 33 bits must be zero.   * 10100000
*                                                                     * 10150000
*                                                                     * 10200000
*                                                                     * 10250000
*                                                                     * 10300000
*              AMODE=UNCHANGED|24|31|64                             * 10350000
*                  is a required keyword input that identifies the    * 10400000
*                  resulting AMODE for the PSW                        * 10450000
*                                                                     * 10500000
*                                                                     * 10550000
*                  AMODE=UNCHANGED                                    * 10600000
*                      indicates not to change the AMODE.             * 10650000
*                                                                     * 10700000
*                  AMODE=24                                           * 10750000
*                      indicates to set the AMODE to 24.              * 10800000
*                                                                     * 10850000
*                  AMODE=31                                           * 10900000
*                      indicates to set the AMODE to 31.              * 10950000
*                                                                     * 11000000
*                  AMODE=64]                                          * 11050000
*                      indicates to set the AMODE to 64.              * 11100000
*                                                                     * 11150000
*                                                                     * 11200000
*                                                                     * 11250000
*                                                                     * 11300000
*                                                                     * 11350000
*          [ADDRTYPE=DELTA                                            * 11400000
*              indicates that the value provided is a delta to the    * 11450000
*              existing address.                                      * 11500000
*                                                                     * 11550000
*                                                                     * 11600000
*              PSWDELTA=xpswdelta]                                    * 11650000
*                  is the name (RS-type), or address in register      * 11700000
*                  (2)-(12), of a required fullword input that        * 11750000
*                  contains the delta to be added to the PSW address  * 11800000
*                  stored in the RB. The value is treated as a signed * 11850000
*                  quantity, so a value of X'FFFFFFFE' would be       * 11900000
*                  treated as negative two, resulting in subtracting  * 11950000
*                  two from the PSW address.  The AMODE will remain   * 12000000
*                  unchanged.                                         * 12050000
*                                                                     * 12100000
*                                                                     * 12150000
*                                                                     * 12200000
*                                                                     * 12250000
*                                                                     * 12300000
*                                                                     * 12350000
*                                                                     * 12400000
*                                                                     * 12450000
*      [RETCODE=xretcode]                                             * 12500000
*          is the name (RS-type) of an optional fullword output       * 12550000
*          variable, or register (2)-(12), into which the return code * 12600000
*          is to be copied from GPR 15.                               * 12650000
*                                                                     * 12700000
*                                                                     * 12750000
*                                                                     * 12800000
*                                                                     * 12850000
*      [RSNCODE=xrsncode]                                             * 12855500
*          is the name (RS-type) of an optional fullword output       * 12861000
*          variable, or register (2)-(12), into which the reason code * 12866500
*          is to be copied from GPR 0.                                * 12872000
*                                                                     * 12877500
*                                                                     * 12883000
*                                                                     * 12888500
*                                                                     * 12894000
*      [MF=S|L|E]                                                   * 12900000
*          is an optional keyword input which specifies the macro     * 12950000
*          form.                                                      * 13000000
*          DEFAULT: S                                                 * 13050000
*                                                                     * 13100000
*                                                                     * 13150000
*          [MF=S]                                                     * 13200000
*              specifies the standard form of the macro.  The "S"     * 13250000
*              form generates code to put the parameters into an      * 13300000
*              in-line parameter list and invoke the desired service. * 13350000
*              Full checking for required macro keys is done along    * 13400000
*              with supplying defaults for omitted optional           * 13450000
*              parameters.                                            * 13500000
*                                                                     * 13550000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 13600000
*              specifies the list form of the macro.  The "L" form    * 13650000
*              defines an area to be used for the parameter list.     * 13700000
*              Any other macro parameters are flagged as errors.      * 13750000
*                                                                     * 13800000
*            ,xmfctrl                                                 * 13850000
*              is a required input.  It is the name of a storage area * 13900000
*              for the parameter list.                                * 13950000
*                                                                     * 14000000
*            ,xmfattr|0D                                            * 14050000
*              is an optional 60 character input string that varies   * 14100000
*              from 1 to 60 characters. Use it to force boundary      * 14150000
*              alignment of the parameter list. Use only 0F or 0D.    * 14200000
*              DEFAULT: 0D which forces the parameter list to a       * 14250000
*              doubleword boundary.                                   * 14300000
*                                                                     * 14350000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 14400000
*              specifies the execute form of the macro.  The "E" form * 14450000
*              generates code to put the parameters into the          * 14500000
*              parameter list specified by xmfctrl and provides full  * 14550000
*              syntax checking with default setting.                  * 14600000
*                                                                     * 14650000
*            ,xmfctrl                                                 * 14700000
*              is a required input.  It is the name (RS-type), or     * 14750000
*              address in register (1)-(12), of a storage area for    * 14800000
*              the parameter list.                                    * 14850000
*                                                                     * 14900000
*            ,COMPLETE                                              * 14950000
*              is an optional keyword input which specifies the       * 15000000
*              degree of macro parameter syntax checking.             * 15050000
*              DEFAULT: COMPLETE                                      * 15100000
*                                                                     * 15150000
*                                                                     * 15200000
*              COMPLETE                                               * 15250000
*                  Checking for required macro keys is done and       * 15300000
*                  defaults are supplied for omitted optional         * 15350000
*                  parameters.                                        * 15400000
*                                                                     * 15450000
*                                                                     * 15500000
*                                                                     * 15550000
*                                                                     * 15600000
*                                                                     * 15650000
*                                                                     * 15700000
*                                                                     * 15750000
*01* ABEND CODES:  None.                                              * 15800000
*                                                                     * 15850000
*       The caller may get the following abend code:                  * 15900000
*                                                                     * 15950000
*                                                                     * 16000000
*       0C2-02          The caller was not in supervisor state.       * 16050000
*                                                                     * 16100000
*       0C4-04          The caller was not in key 0.                  * 16150000
*                                                                     * 16200000
*                                                                     * 16250000
*                                                                     * 16300000
*01* RETURN CODES:                                                    * 16350000
*                                                                     * 16400000
*                                                                     * 16450000
*                 Macro IEARBUPM provides equate symbols for the      * 16500000
*                 return and reason codes.                            * 16550000
*                                                                     * 16600000
*       0         Name: IearbupRc_OK                                  * 16650000
*                                                                     * 16700000
*                 Meaning:  Iearbup request successful.               * 16750000
*                                                                     * 16800000
*                                                                     * 16850000
*       8         Name: IearbupRc_InvParm                             * 16900000
*                                                                     * 16950000
*                 Meaning:  Iearbup request specifies invalid         * 17000000
*                 parameters.                                         * 17050000
*                                                                     * 17100000
*                 Action:  Refer to the action provided with the      * 17150000
*                 specific reason code.                               * 17200000
*                                                                     * 17250000
*                                                                     * 17300000
*                 HEX REASON  MEANING/ACTION                          * 17350000
*                 CODE                                                * 17400000
*                                                                     * 17450000
*                 xxxx0801    Name: IearbupRsnBadVersion              * 17500000
*                                                                     * 17550000
*                             Meaning: The version field in the       * 17600000
*                             parameter list is not valid.            * 17650000
*                                                                     * 17700000
*                             Action: Check for possible storage      * 17750000
*                             overlay.                                * 17800000
*                                                                     * 17850000
*                 xxxx0802    Name: IearbupRsnBadAMODEField           * 17900000
*                                                                     * 17950000
*                             Meaning: The amode field in the         * 18000000
*                             parameter list is not valid.            * 18050000
*                                                                     * 18100000
*                             Action: Check for possible storage      * 18150000
*                             overlay.                                * 18200000
*                                                                     * 18250000
*                 xxxx0803    Name: IearbupRsnBadAddress              * 18300000
*                                                                     * 18350000
*                             Meaning: The address provided is not    * 18400000
*                             valid.                                  * 18450000
*                                                                     * 18500000
*                             Action: Only provide an instruction     * 18550000
*                             address that is less than X'80000000'.  * 18600000
*                                                                     * 18650000
*                                                                     * 18700000
*                                                                     * 18750000
*                                                                     * 18800000
*       C         Name: IearbupRc_Env                                 * 18850000
*                                                                     * 18900000
*                 Meaning: Environmental error                        * 18950000
*                                                                     * 19000000
*                 Action:  Refer to the action provided with the      * 19050000
*                 specific reason code.                               * 19100000
*                                                                     * 19150000
*                                                                     * 19200000
*                 HEX REASON  MEANING/ACTION                          * 19250000
*                 CODE                                                * 19300000
*                                                                     * 19350000
*                 xxxx0C01    Name: IearbupRsnPrevRBNotFound          * 19400000
*                                                                     * 19450000
*                             Meaning: RB=PREV was requested, but     * 19500000
*                             there is only one RB for the current    * 19550000
*                             task.                                   * 19600000
*                                                                     * 19650000
*                             Action: Use RB=CURRENT when there is    * 19700000
*                             only one RB.                            * 19750000
*                                                                     * 19800000
*                 xxxx0C02    Name: IearbupRsnBadAMODE                * 19806200
*                                                                     * 19812400
*                             Meaning: AMODE=64 was specified but the * 19818600
*                             architecture level is not ESAME.        * 19824800
*                                                                     * 19831000
*                             Action: Only request AMODE=64 when the  * 19837200
*                             architecture level is ESAME.            * 19843400
*                                                                     * 19850000
*                                                                     * 19900000
*                                                                     * 19950000
*                                                                     * 20000000
*                                                                     * 20016600
*01* REASON CODES:                                                    * 20033200
*                                                                     * 20049800
*       Reason codes, as appropriate, are defined under their         * 20066400
*       corresponding return code.                                    * 20083000
*                                                                     * 20100000
*01* MODULE TYPE:  ASSEM MACRO                                        * 20150000
*                                                                     * 20200000
*02*   PROCESSOR:  ASSEM                                              * 20250000
*                                                                     * 20300000
*01* COMPONENT:  SC1C5                                                * 20350000
*                                                                     * 20400000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 20450000
*                                                                     * 20500000
*01* EXAMPLES:                                                        * 20550000
*                                                                     * 20600000
*    Example 1                                                        * 20650000
*                                                                     * 20700000
*    Operation:                                                       * 20750000
*                                                                     * 20800000
*                                                                     * 20850000
*    1.  Update the PSW address to the address provided in field P.   * 20900000
*                                                                     * 20950000
*                                                                     * 21000000
*                                                                     * 21050000
*    The code is as follows.                                          * 21100000
*                                                                     * 21150000
*          IEARBUP ADDRTYPE=ACTUAL,PSWADDR=P,RETCODE=RC,MF=(E,MFL)    * 21200000
*             ...                                                     * 21250000
*          IEARBUP MF=(L,MFL)                                         * 21300000
*    P     DS    XL8                                                  * 21350000
*    RC    DS    F                                                    * 21400000
*                                                                     * 21450000
*                                                                     * 21500000
*    Example 2                                                        * 21550000
*                                                                     * 21600000
*    Operation:                                                       * 21650000
*                                                                     * 21700000
*                                                                     * 21750000
*    1.  Decrement the PSW address in the RB by 4                     * 21800000
*                                                                     * 21850000
*                                                                     * 21900000
*                                                                     * 21950000
*    The code is as follows.                                          * 22000000
*                                                                     * 22050000
*          IEARBUP ADDRTYPE=DELTA,PSWDELTA=PD,RETCODE=RC,MF=(E,MFL)   * 22100000
*             ...                                                     * 22150000
*          IEARBUP MF=(L,MFL)                                         * 22200000
*    PD    DC    F'-4'                                                * 22250000
*    RC    DS    F                                                    * 22300000
*                                                                     * 22350000
*                                                                     * 22400000
*01* MACRO USAGE NOTES:                                               * 22450000
*                                                                     * 22500000
*                                                                     * 22550000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 22600000
*        global macro variable.  Any value other than 'NO' will       * 22650000
*        result in the macro expansion being printed.  The default is * 22700000
*        'YES'.  The following examples illustrate how the ZPRINT     * 22750000
*        variable should be set.                                      * 22800000
*                                                                     * 22850000
*                    GBLC &ZPRINT                                     * 22900000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 22950000
*                                                                     * 23000000
*                                                                     * 23050000
*                                                                     * 23100000
*01* CHANGE ACTIVITY:                                                 * 23150000
*                                                                     * 23200000
*   Flag LineItem  FMID    Date   ID    Comment                       * 23250000
*                                                                     * 23300000
*    $L0=64BITAMG HBB7703 990721 PD00XB:  New                         * 23350000
*    $L1=64BITSUP HBB7703 990721 PD00XB:  New                         * 23400000
****** END OF SPECIFICATIONS *****************************************/ 23450000
*/* TLINE 1 *********************************************************** 23500000
         MACRO                                                          23550000
&XLABEL  IEARBUP &WHICHRB=,&PSWBYTE03=,&ADDRTYPE=,&PSWADDR=,&AMODE=,   *23600000
               &PSWDELTA=,&RETCODE=,&RSNCODE=,&MF=                      23650000
.*                                                                      23700000
*               MACDATE -11/10/99-<0>                                   23750000
.*                                                                      23800000
.*******************************************************************    23850000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        23900000
.*******************************************************************    23950000
               GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                  24000000
               GBLC  &ZTEST      YES=TEST NO=NO TEST                    24050000
               GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX            24100000
.*                                                                      24150000
               GBLC  &ZIEARBUP   YES=MACRO USED AT LEAST ONCE           24200000
.*******************************************************************    24250000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          24300000
.*******************************************************************    24350000
               LCLC  &ZMS        ERROR MESSAGE WORK AREA                24400000
               LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS           24450000
               LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED             24500000
               LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR            24550000
               LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE            24600000
               LCLA  &ZAWRK      USED AS A WORK AREA                    24650000
               LCLA  &ZASIZ      USED FOR SIZE OF VALUE                 24700000
               LCLA  &ZN         NUMERIC WORK VARIABLE                  24750000
               LCLC  &ZC         CHARACTER WORK VARIABLE                24800000
               LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE            24850000
               LCLA  &ZTLA       VALUE TOO LONG VARIABLE                24900000
               LCLA  &ZMACRET    MACRO RETURN CODE                      24950000
&ZMACRET       SETA  0           ASSUME NO ERRORS                       25000000
.*                                                                      25050000
               LCLC  &ZCSYSLIST(255)            NONXKEY, POS ARRAY      25100000
               LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()             25150000
               LCLA  &ZPLLEN     PARAMETER LIST LENGTH                  25200000
               LCLC  &ZENDBASEPL                End of base PL          25250000
.********************************************************************   25300000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 25350000
.********************************************************************   25400000
               GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                25450000
               GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE         25500000
               GBLA  &SYSALVL    SYSSTATE ARCHLVL                       25550000
.*                                                                      25600000
               AIF   (K'&SYSASCE GT 0).ZSYS4    SYS STATE DEFINED       25650000
               AIF   (K'&SYSSPLV GT 0).ZSYS2    SP LEVEL DEFINED        25700000
               SPLEVEL  TEST                                            25750000
.ZSYS2         ANOP  ,                                                  25800000
               AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1              25850000
               AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1              25900000
               SYSSTATE TEST                                            25950000
               AGO   .ZSYS4                                             26000000
.ZSYS3         ANOP  ,                                                  26050000
&SYSASCE       SETC  'P'         ASSUME SYSSTATE PRIMARY                26100000
.ZSYS4         ANOP  ,                                                  26150000
.*******************************************************************    26200000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   26250000
.*******************************************************************    26300000
               LCLC  &XWHICHRB   ++ VALUE                               26350000
               LCLC  &XPSWBYTE03                ++ VALUE                26400000
               LCLC  &XADDRTYPE  ++ VALUE                               26450000
               LCLC  &XPSWADDR   ++ NAME                                26500000
               LCLC  &XAMODE     ++ VALUE                               26550000
               LCLC  &XPSWDELTA  ++ NAME                                26600000
               LCLC  &XRETCODE   ++ NAME                                26650000
               LCLC  &XRSNCODE   ++ NAME                                26675000
               LCLC  &XMF        ++ VALUE                               26700000
               LCLC  &XMFCTRL    ++ NAME                                26750000
               LCLC  &XMFATTR    ++ VALUE                               26800000
               LCLC  &XMFSCK     ++ VALUE                               26850000
.*******************************************************************    26900000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           26950000
.*******************************************************************    27000000
               LCLC  &ZXWHICHRB  ++ INPUT VALUE                         27050000
               LCLC  &ZXPSWBYTE03               ++ INPUT VALUE          27100000
               LCLC  &ZXADDRTYPE                ++ INPUT VALUE          27150000
               LCLC  &ZXPSWADDR  ++ INPUT NAME                          27200000
               LCLC  &ZXAMODE    ++ INPUT VALUE                         27250000
               LCLC  &ZXPSWDELTA                ++ INPUT NAME           27300000
               LCLC  &ZXRETCODE  ++ OUTPUT NAME                         27350000
               LCLC  &ZXRSNCODE  ++ OUTPUT NAME                         27375000
               LCLC  &ZXMF       ++ INPUT VALUE                         27400000
               LCLC  &ZXMFCTRL   ++ INPUT NAME                          27450000
               LCLC  &ZXMFATTR   ++ INPUT VALUE                         27500000
               LCLC  &ZXMFSCK    ++ INPUT VALUE                         27550000
.********************************************************************   27600000
.***AG.MF01 PROCESS MF MACRO FORMS                                      27650000
.********************************************************************   27700000
               ACTR  10000                                              27750000
.*------------------------------------------------------------------    27800000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           27850000
&XMF           SETC  ''          INITIALIZE XVARIABLE                   27900000
.*-------------------------------------------------------------------   27950000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           28000000
.ZG39          ANOP  ,                                                  28050000
&ZTLC          SETC 'S'                                                 28100000
               AIF   ('&MF(1)' NE '&ZTLC').ZG40                         28150000
&XMF           SETC  'S'         SET KEYWORD                            28200000
               AIF   (N'&MF LE 1).ZG39A         CK NUM                  28250000
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          28300000
&ZMS           SETC  '&ZMS.&MF"'                                        28350000
&ZMS           SETC  '&ZMS "MF"'                                        28400000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                28450000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            28500000
.ZG39A         ANOP  ,                                                  28550000
.*-------------------------------------------------------------------   28600000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           28650000
.ZG40          ANOP  ,                                                  28700000
&ZTLC          SETC 'L'                                                 28750000
               AIF   ('&MF(1)' NE '&ZTLC').ZG47                         28800000
&XMF           SETC  'L'         SET KEYWORD                            28850000
               AIF   (N'&MF LE 3).ZG40A         CK NUM                  28900000
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          28950000
&ZMS           SETC  '&ZMS.&MF"'                                        29000000
&ZMS           SETC  '&ZMS "MF"'                                        29050000
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               29100000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            29150000
.ZG40A         ANOP  ,                                                  29200000
.*-------------------------------------------------------------------   29250000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     29300000
               AIF   (N'&SYSLIST NE 0).ZG40B    POSITIONALS?            29345800
               AIF   ('&WHICHRB' NE '').ZG40B   KEYS?                   29391600
               AIF   ('&PSWBYTE03' NE '').ZG40B  KEYS?                  29437400
               AIF   ('&ADDRTYPE' NE '').ZG40B  KEYS?                   29483200
               AIF   ('&PSWADDR' NE '').ZG40B   KEYS?                   29529000
               AIF   ('&AMODE' NE '').ZG40B     KEYS?                   29574800
               AIF   ('&PSWDELTA' NE '').ZG40B  KEYS?                   29620600
               AIF   ('&RETCODE' NE '').ZG40B   KEYS?                   29666400
               AIF   ('&RSNCODE' NE '').ZG40B   KEYS?                   29712200
               AGO    .ZG40C     INVOCATION OKAY                        29758000
.ZG40B         ANOP  ,                                                  29803800
&ZMS           SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE        29850000
&ZMS           SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                  29900000
&ZMS           SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'             29950000
               MNOTE 8,' &ZMS ON THE INVOCATION.'                       30000000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            30050000
.ZG40C         ANOP  ,                                                  30100000
.*-------------------------------------------------------------------   30150000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   30200000
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          30250000
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          30300000
               AIF   (N'&MF(2) GT 1).ZG42B      MULTI PARMS             30350000
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          30400000
.ZG42B         AIF   (K'&MF(2) GT 0).ZG42C                              30450000
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        30500000
&ZMS           SETC  'WHEN "L" IS SPECIFIED'    *KRQDA*                 30550000
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                30600000
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       30650000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            30700000
.ZG42C         ANOP  ,                                                  30750000
.*-------------------------------------------------------------------   30800000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               30850000
               AIF   (K'&ZXMFCTRL LE 0).ZG42P   NOT I/O                 30900000
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG42P                     30950000
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        31000000
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          31050000
&ZMS           SETC  '&ZMS.&MF"'                                        31100000
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          31150000
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                  31200000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            31250000
.ZG42P         ANOP  ,                                                  31300000
.*-------------------------------------------------------------------   31350000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      31400000
&ZXMFATTR      SETC  'INPUT'     SET IN/OUTPUT                          31450000
&XMFATTR       SETC  '0D'                                               31500000
               AIF   (K'&MF(3) LE 0).ZG45B      PARM                    31550000
&XMFATTR       SETC  '&MF(3,1)'  SET XVARIABLE                          31600000
               AIF   (N'&MF(3) GT 1).ZG45B      MULTI PARMS             31650000
&XMFATTR       SETC  '&MF(3)'    SET XVARIABLE                          31700000
.ZG45B         ANOP  ,                                                  31750000
.*-------------------------------------------------------------------   31800000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  31850000
               AIF   (K'&ZXMFATTR LE 0).ZG45P   NOT I/O                 31900000
               AIF   ('&XMFATTR'(1,1) NE '(').ZG45P                     31950000
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        32000000
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          32050000
&ZMS           SETC  '&ZMS.&MF"'                                        32100000
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          32150000
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                  32200000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            32250000
.ZG45P         ANOP  ,                                                  32300000
.*-------------------------------------------------------------------   32350000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 32400000
               AIF   (K'&ZXMFATTR LE 0).ZG45S   NOT I/O                 32450000
               AIF   (K'&XMFATTR LE 60).ZG45S   LNG OK                  32500000
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        32550000
&ZMS           SETC  '"MF='      *KLNGA* MNOTE                          32600000
&ZMS           SETC  '&ZMS.&MF"'                                        32650000
&ZMS           SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'              32700000
               MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                 32750000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            32800000
.ZG45S         ANOP  ,                                                  32850000
.*-------------------------------------------------------------------   32900000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           32950000
.ZG47          ANOP  ,                                                  33000000
&ZTLC          SETC 'E'                                                 33050000
               AIF   ('&MF(1)' NE '&ZTLC').ZG55                         33100000
&XMF           SETC  'E'         SET KEYWORD                            33150000
               AIF   (N'&MF LE 3).ZG47A         CK NUM                  33200000
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          33250000
&ZMS           SETC  '&ZMS.&MF"'                                        33300000
&ZMS           SETC  '&ZMS "MF"'                                        33350000
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               33400000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            33450000
.ZG47A         ANOP  ,                                                  33500000
.*-------------------------------------------------------------------   33550000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   33600000
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          33650000
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          33700000
               AIF   (N'&MF(2) GT 1).ZG49B      MULTI PARMS             33750000
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          33800000
.ZG49B         AIF   (K'&MF(2) GT 0).ZG49C                              33850000
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        33900000
&ZMS           SETC  'WHEN "E" IS SPECIFIED'    *KRQDA*                 33950000
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                34000000
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       34050000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            34100000
.ZG49C         ANOP  ,                                                  34150000
.*-------------------------------------------------------------------   34200000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              34250000
               AIF   (K'&ZXMFCTRL LE 0).ZG49R   NOT I/O                 34300000
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG49R                     34350000
&ZCGPR         SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                         34400000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                       34450000
               AIF   (K'&ZCGPR GT 2).ZG49Q                              34500000
               AIF   ('&ZCGPR' EQ '0').ZG49Q                            34550000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      34600000
               AIF   (T'&ZCGPR NE 'N').ZG49Q    INVALID REG NAME        34650000
.ZG49P         ANOP  ,                                                  34700000
               AIF   (T'&ZCGPR NE 'N').ZG49R    NON NUMERIC             34750000
               AIF   ('&ZCGPR' LT '1').ZG49Q                            34800000
               AIF   ('&ZCGPR' LE '12').ZG49R                           34850000
.ZG49Q         ANOP  ,                                                  34900000
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          34950000
&ZMS           SETC  '&ZMS.&MF"'                                        35000000
&ZMS           SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'          35050000
               MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                   35100000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            35150000
.ZG49R         ANOP  ,                                                  35200000
.*-------------------------------------------------------------------   35250000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             35300000
&XMFSCK        SETC  ''          INITIALIZE XVARIABLE                   35350000
.ZG53A   AIF   ('&MF(3)' NE 'COMPLETE').ZG54A                           35400000
&XMFSCK        SETC  'COMPLETE'  SET KEYWORD                            35450000
.*-------------------------------------------------------------------   35500000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             35550000
.ZG54A         AIF   (K'&XMFSCK GT 0).ZG54C     KEYWORD                 35600000
               AIF   (K'&MF(3) LE 0).ZG54B                              35650000
&ZMS           SETC  '"MF='      *KUKWA* MNOTE                          35700000
&ZMS           SETC  '&ZMS.&MF"'                                        35750000
&ZMS           SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '          35800000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                35850000
&ZMS           SETC  '&ZMS "COMPLETE".'                                 35900000
               MNOTE 8,' &ZMS '                                         35950000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            36000000
.ZG54B         ANOP  ,                                                  36050000
&XMFSCK        SETC  'COMPLETE'  SET DEFAULT KEYWORD                    36100000
.ZG54C         ANOP  ,                                                  36150000
&ZXMFSCK       SETC  'INPUT'     SET IN/OUTPUT                          36200000
.*------------------------------------------------------------------    36250000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36300000
.ZG55          ANOP  ,                                                  36350000
&ZXMF          SETC  'INPUT'     SET IN/OUTPUT                          36400000
               AIF   (K'&XMF GT 0).ZG55E        VALID ARG               36450000
               AIF   (T'&MF EQ 'O').ZG55D       OMITTED                 36500000
&ZASYSLNDX     SETA  0                                                  36550000
.ZG55A         ANOP  ,           POSITIONAL MACRO KEY                   36600000
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       36650000
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG55C                   36700000
&ZTLC          SETC 'MF'                                                36750000
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG55A          36800000
.ZG55B         ANOP  ,                                                  36850000
&ZXMF          SETC  ''          RESET IN/OUTPUT                        36900000
&ZMS           SETC  'THE "MF" KEY'             *KOPTA* MNOTE           36950000
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            37000000
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   37050000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            37100000
               AGO   .ZG55E                                             37150000
.ZG55C         ANOP  ,                                                  37200000
&ZXMF          SETC  ''          RESET IN/OUTPUT                        37250000
&ZMS           SETC  '"MF='      *KUKWA* MNOTE                          37300000
&ZMS           SETC  '&ZMS.&MF"'                                        37350000
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          37400000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                37450000
&ZMS           SETC  '&ZMS "S",'                                        37500000
&ZMS           SETC  '&ZMS "L",'                                        37550000
&ZMS           SETC  '&ZMS OR "E".'                                     37600000
               MNOTE 8,' &ZMS '                                         37650000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            37700000
               AGO   .ZG55E                                             37750000
.ZG55D         ANOP  ,                                                  37800000
&XMF           SETC  'S'         SET DEFAULT KEYWORD                    37850000
&XMFSCK        SETC  'COMPLETE'  COMPLETE CHECKING                      37900000
.ZG55E         ANOP  ,                                                  37950000
.********************************************************************   38000000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 38050000
.********************************************************************   38100000
               ACTR  10000                                              38150000
.*-------------------------------------------------------------------   38200000
.***AG.MF03 MF=(SLE)                                                    38250000
               AIF   ('&XMF' EQ 'L').ZGMFX                              38300000
.*------------------------------------------------------------------    38350000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           38400000
&XWHICHRB      SETC  ''          INITIALIZE XVARIABLE                   38450000
.*-------------------------------------------------------------------   38500000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           38550000
.ZG3           ANOP  ,                                                  38600000
               AIF   (K'&WHICHRB(1) LE 0).ZG3A                          38650000
&ZTLC          SETC 'CURRENT'                                           38700000
               AIF   ('&WHICHRB(1)' NE '&ZTLC').ZG4                     38750000
&XWHICHRB      SETC  'CURRENT'   SET KEYWORD                            38800000
               AIF   (N'&WHICHRB LE 1).ZG3A     CK NUM                  38850000
&ZMS           SETC  '"WHICHRB='                *KPOSA* MNOTE           38900000
&ZMS           SETC  '&ZMS.&WHICHRB"'                                   38950000
&ZMS           SETC  '&ZMS "WHICHRB"'                                   39000000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                39050000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            39100000
.ZG3A          ANOP  ,                                                  39150000
.*-------------------------------------------------------------------   39200000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           39250000
.ZG4           ANOP  ,                                                  39300000
&ZTLC          SETC 'PREV'                                              39350000
               AIF   ('&WHICHRB(1)' NE '&ZTLC').ZG5                     39400000
&XWHICHRB      SETC  'PREV'      SET KEYWORD                            39450000
               AIF   (N'&WHICHRB LE 1).ZG4A     CK NUM                  39500000
&ZMS           SETC  '"WHICHRB='                *KPOSA* MNOTE           39550000
&ZMS           SETC  '&ZMS.&WHICHRB"'                                   39600000
&ZMS           SETC  '&ZMS "WHICHRB"'                                   39650000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                39700000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            39750000
.ZG4A          ANOP  ,                                                  39800000
.*------------------------------------------------------------------    39850000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           39900000
.ZG5           ANOP  ,                                                  39950000
&ZXWHICHRB     SETC  'INPUT'     SET IN/OUTPUT                          40000000
               AIF   (K'&XWHICHRB GT 0).ZG5E    VALID ARG               40050000
               AIF   (T'&WHICHRB EQ 'O').ZG5D   OMITTED                 40100000
&ZASYSLNDX     SETA  0                                                  40150000
.ZG5A          ANOP  ,           POSITIONAL MACRO KEY                   40200000
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       40250000
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG5C                    40300000
&ZTLC          SETC 'WHICHRB'                                           40350000
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG5A           40400000
.ZG5B          ANOP  ,                                                  40450000
&ZXWHICHRB     SETC  ''          RESET IN/OUTPUT                        40500000
&ZMS           SETC  'THE "WHICHRB" KEY'        *KOPTA* MNOTE           40550000
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            40600000
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   40650000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            40700000
               AGO   .ZG5E                                              40750000
.ZG5C          ANOP  ,                                                  40800000
&ZXWHICHRB     SETC  ''          RESET IN/OUTPUT                        40850000
&ZMS           SETC  '"WHICHRB='                *KUKWA* MNOTE           40900000
&ZMS           SETC  '&ZMS.&WHICHRB"'                                   40950000
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          41000000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                41050000
&ZMS           SETC  '&ZMS "CURRENT"'                                   41100000
&ZMS           SETC  '&ZMS OR "PREV".'                                  41150000
               MNOTE 8,' &ZMS '                                         41200000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            41250000
               AGO   .ZG5E                                              41300000
.ZG5D          ANOP  ,                                                  41350000
&XWHICHRB      SETC  'CURRENT'   SET DEFAULT KEYWORD                    41400000
.ZG5E          ANOP  ,                                                  41450000
.*------------------------------------------------------------------    41500000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           41550000
               AIF   (K'&WHICHRB(1) GT 0).ZG5F  PARM                    41600000
&XWHICHRB      SETC  ''          ENSURE NULL KEYWORD                    41650000
&ZXWHICHRB     SETC  ''          RESET IN/OUTPUT                        41700000
&ZMS           SETC  'THE'                                              41750000
&ZMS           SETC  '&ZMS "WHICHRB" KEY AND ITS'                       41800000
&ZMS           SETC  '&ZMS ARGUMENT ARE REQUIRED.'                      41850000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                41900000
&ZMS           SETC  '&ZMS "CURRENT"'                                   41950000
&ZMS           SETC  '&ZMS OR "PREV".'                                  42000000
               MNOTE 8,' &ZMS '                                         42050000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            42100000
.ZG5F          ANOP  ,                                                  42150000
.*------------------------------------------------------------------    42200000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           42250000
&XPSWBYTE03    SETC  ''          INITIALIZE XVARIABLE                   42300000
.*-------------------------------------------------------------------   42350000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           42400000
.ZG8           ANOP  ,                                                  42450000
               AIF   (K'&PSWBYTE03(1) LE 0).ZG8A                        42500000
&ZTLC          SETC 'NO'                                                42550000
               AIF   ('&PSWBYTE03(1)' NE '&ZTLC').ZG9                   42600000
&XPSWBYTE03    SETC  'NO'        SET KEYWORD                            42650000
               AIF   (N'&PSWBYTE03 LE 1).ZG8A   CK NUM                  42700000
&ZMS           SETC  '"PSWBYTE03='              *KPOSA* MNOTE           42750000
&ZMS           SETC  '&ZMS.&PSWBYTE03"'                                 42800000
&ZMS           SETC  '&ZMS "PSWBYTE03"'                                 42850000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                42900000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            42950000
.ZG8A          ANOP  ,                                                  43000000
.*-------------------------------------------------------------------   43050000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           43100000
.ZG9           ANOP  ,                                                  43150000
&ZTLC          SETC 'YES'                                               43200000
               AIF   ('&PSWBYTE03(1)' NE '&ZTLC').ZG10                  43250000
&XPSWBYTE03    SETC  'YES'       SET KEYWORD                            43300000
               AIF   (N'&PSWBYTE03 LE 1).ZG9A   CK NUM                  43350000
&ZMS           SETC  '"PSWBYTE03='              *KPOSA* MNOTE           43400000
&ZMS           SETC  '&ZMS.&PSWBYTE03"'                                 43450000
&ZMS           SETC  '&ZMS "PSWBYTE03"'                                 43500000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                43550000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            43600000
.ZG9A          ANOP  ,                                                  43650000
.*------------------------------------------------------------------    43700000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           43750000
.ZG10          ANOP  ,                                                  43800000
&ZXPSWBYTE03   SETC  'INPUT'     SET IN/OUTPUT                          43850000
               AIF   (K'&XPSWBYTE03 GT 0).ZG10E  VALID ARG              43900000
               AIF   (T'&PSWBYTE03 EQ 'O').ZG10D  OMITTED               43950000
&ZASYSLNDX     SETA  0                                                  44000000
.ZG10A         ANOP  ,           POSITIONAL MACRO KEY                   44050000
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       44100000
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG10C                   44150000
&ZTLC          SETC 'PSWBYTE03'                                         44200000
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG10A          44250000
.ZG10B         ANOP  ,                                                  44300000
&ZXPSWBYTE03   SETC  ''          RESET IN/OUTPUT                        44350000
&ZMS           SETC  'THE "PSWBYTE03" KEY'      *KOPTA* MNOTE           44400000
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            44450000
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   44500000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            44550000
               AGO   .ZG10E                                             44600000
.ZG10C         ANOP  ,                                                  44650000
&ZXPSWBYTE03   SETC  ''          RESET IN/OUTPUT                        44700000
&ZMS           SETC  '"PSWBYTE03='              *KUKWA* MNOTE           44750000
&ZMS           SETC  '&ZMS.&PSWBYTE03"'                                 44800000
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          44850000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                44900000
&ZMS           SETC  '&ZMS "NO"'                                        44950000
&ZMS           SETC  '&ZMS OR "YES".'                                   45000000
               MNOTE 8,' &ZMS '                                         45050000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            45100000
               AGO   .ZG10E                                             45150000
.ZG10D         ANOP  ,                                                  45200000
&XPSWBYTE03    SETC  'NO'        SET DEFAULT KEYWORD                    45250000
.ZG10E         ANOP  ,                                                  45300000
.*------------------------------------------------------------------    45350000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           45400000
               AIF   (K'&PSWBYTE03(1) GT 0).ZG10F  PARM                 45450000
&XPSWBYTE03    SETC  ''          ENSURE NULL KEYWORD                    45500000
&ZXPSWBYTE03   SETC  ''          RESET IN/OUTPUT                        45550000
&ZMS           SETC  'THE'                                              45600000
&ZMS           SETC  '&ZMS "PSWBYTE03" KEY AND ITS'                     45650000
&ZMS           SETC  '&ZMS ARGUMENT ARE REQUIRED.'                      45700000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                45750000
&ZMS           SETC  '&ZMS "NO"'                                        45800000
&ZMS           SETC  '&ZMS OR "YES".'                                   45850000
               MNOTE 8,' &ZMS '                                         45900000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            45950000
.ZG10F         ANOP  ,                                                  46000000
.*------------------------------------------------------------------    46050000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           46100000
&XADDRTYPE     SETC  ''          INITIALIZE XVARIABLE                   46150000
.*-------------------------------------------------------------------   46200000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           46250000
.ZG13          ANOP  ,                                                  46300000
               AIF   (K'&ADDRTYPE(1) LE 0).ZG13A                        46350000
&ZTLC          SETC 'NO_CHANGE'                                         46400000
               AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG14                   46450000
&XADDRTYPE     SETC  'NO_CHANGE'                SET KEYWORD             46500000
               AIF   (N'&ADDRTYPE LE 1).ZG13A   CK NUM                  46550000
&ZMS           SETC  '"ADDRTYPE='               *KPOSA* MNOTE           46600000
&ZMS           SETC  '&ZMS.&ADDRTYPE"'                                  46650000
&ZMS           SETC  '&ZMS "ADDRTYPE"'                                  46700000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                46750000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            46800000
.ZG13A         ANOP  ,                                                  46850000
.*------------------------------------------------------------------    46900000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           46950000
&ZCVAL         SETC ''           CLEAR ERROR KEY ACCUMULATOR            47000000
.ZG13A0        AIF   (K'&PSWADDR LE 0).ZG13A1   OK                      47050000
&ZCVAL         SETC '&ZCVAL PSWADDR'            INCORRECT KEY USED      47100000
.ZG13A1        AIF   (K'&AMODE LE 0).ZG13A2     OK                      47150000
&ZCVAL         SETC '&ZCVAL AMODE'              INCORRECT KEY USED      47200000
.ZG13A2        AIF   (K'&PSWDELTA LE 0).ZG13A3  OK                      47250000
&ZCVAL         SETC '&ZCVAL PSWDELTA'           INCORRECT KEY USED      47300000
.ZG13A3        AIF   (K'&ZCVAL LE 0).ZG13A4     OK                      47350000
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              47400000
&ZMS           SETC  '"ADDRTYPE'                *KMEIA* MNOTE           47450000
&ZMS           SETC  '&ZMS.=&ADDRTYPE"'                                 47500000
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               47550000
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               47600000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            47650000
.ZG13A4        ANOP  ,                                                  47700000
.*-------------------------------------------------------------------   47750000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           47800000
.ZG14          ANOP  ,                                                  47850000
&ZTLC          SETC 'INRBOPSWA'                                         47900000
               AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG15                   47950000
&XADDRTYPE     SETC  'INRBOPSWA'                SET KEYWORD             48000000
               AIF   (N'&ADDRTYPE LE 1).ZG14A   CK NUM                  48050000
&ZMS           SETC  '"ADDRTYPE='               *KPOSA* MNOTE           48100000
&ZMS           SETC  '&ZMS.&ADDRTYPE"'                                  48150000
&ZMS           SETC  '&ZMS "ADDRTYPE"'                                  48200000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                48250000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            48300000
.ZG14A         ANOP  ,                                                  48350000
.*------------------------------------------------------------------    48400000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           48450000
&ZCVAL         SETC ''           CLEAR ERROR KEY ACCUMULATOR            48500000
.ZG14A0        AIF   (K'&PSWADDR LE 0).ZG14A1   OK                      48550000
&ZCVAL         SETC '&ZCVAL PSWADDR'            INCORRECT KEY USED      48600000
.ZG14A1        AIF   (K'&AMODE LE 0).ZG14A2     OK                      48650000
&ZCVAL         SETC '&ZCVAL AMODE'              INCORRECT KEY USED      48700000
.ZG14A2        AIF   (K'&PSWDELTA LE 0).ZG14A3  OK                      48750000
&ZCVAL         SETC '&ZCVAL PSWDELTA'           INCORRECT KEY USED      48800000
.ZG14A3        AIF   (K'&ZCVAL LE 0).ZG14A4     OK                      48850000
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              48900000
&ZMS           SETC  '"ADDRTYPE'                *KMEIA* MNOTE           48950000
&ZMS           SETC  '&ZMS.=&ADDRTYPE"'                                 49000000
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               49050000
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               49100000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            49150000
.ZG14A4        ANOP  ,                                                  49200000
.*-------------------------------------------------------------------   49250000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           49300000
.ZG15          ANOP  ,                                                  49350000
&ZTLC          SETC 'ACTUAL'                                            49400000
               AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG26                   49450000
&XADDRTYPE     SETC  'ACTUAL'    SET KEYWORD                            49500000
               AIF   (N'&ADDRTYPE LE 1).ZG15A   CK NUM                  49550000
&ZMS           SETC  '"ADDRTYPE='               *KPOSA* MNOTE           49600000
&ZMS           SETC  '&ZMS.&ADDRTYPE"'                                  49650000
&ZMS           SETC  '&ZMS "ADDRTYPE"'                                  49700000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                49750000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            49800000
.ZG15A         ANOP  ,                                                  49850000
.*------------------------------------------------------------------    49900000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           49950000
&ZCVAL         SETC ''           CLEAR ERROR KEY ACCUMULATOR            50000000
.ZG15A0        AIF   (K'&PSWDELTA LE 0).ZG15A1  OK                      50050000
&ZCVAL         SETC '&ZCVAL PSWDELTA'           INCORRECT KEY USED      50100000
.ZG15A1        AIF   (K'&ZCVAL LE 0).ZG15A2     OK                      50150000
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              50200000
&ZMS           SETC  '"ADDRTYPE'                *KMEIA* MNOTE           50250000
&ZMS           SETC  '&ZMS.=&ADDRTYPE"'                                 50300000
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               50350000
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               50400000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            50450000
.ZG15A2        ANOP  ,                                                  50500000
.*----------------------------------------------------------------***   50550000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 50600000
               AIF   (N'&PSWADDR LE 1).ZG17A    CK NUM                  50650000
&ZMS           SETC  '"PSWADDR='                *KPOSA* MNOTE           50700000
&ZMS           SETC  '&ZMS.&PSWADDR"'                                   50750000
&ZMS           SETC  '&ZMS "PSWADDR"'                                   50800000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                50850000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            50900000
.ZG17A         ANOP  ,                                                  50950000
.*-------------------------------------------------------------------   51000000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     51050000
&ZXPSWADDR     SETC  'INPUT'     SET IN/OUTPUT                          51100000
&XPSWADDR      SETC  '&PSWADDR(1)'              SET XVARIABLE           51150000
               AIF   (N'&PSWADDR GT 1).ZG17B    MULTI PARMS             51200000
&XPSWADDR      SETC  '&PSWADDR'  SET XVARIABLE                          51250000
.ZG17B         AIF   (K'&PSWADDR(1) GT 0).ZG17C                         51300000
&ZXPSWADDR     SETC  ''          RESET IN/OUTPUT                        51350000
&ZMS           SETC  'WHEN "ACTUAL" IS SPECIFIED'  *KRQDA*              51400000
&ZMS           SETC  '&ZMS , "PSWADDR" KEY AND ITS'                     51450000
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   51500000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            51550000
.ZG17C         ANOP  ,                                                  51600000
.*-------------------------------------------------------------------   51650000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                51700000
               AIF   (K'&ZXPSWADDR LE 0).ZG17R  NOT I/O                 51750000
               AIF   ('&XPSWADDR'(1,1) NE '(').ZG17R                    51800000
&ZCGPR         SETC  '&XPSWADDR'(2,K'&XPSWADDR-2)                       51850000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                       51900000
               AIF   (K'&ZCGPR GT 2).ZG17Q                              51950000
               AIF   ('&ZCGPR' EQ '0').ZG17Q                            52000000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      52050000
               AIF   (T'&ZCGPR NE 'N').ZG17Q    INVALID REG NAME        52100000
.ZG17P         ANOP  ,                                                  52150000
               AIF   (T'&ZCGPR NE 'N').ZG17R    NON NUMERIC             52200000
               AIF   ('&ZCGPR' LT '2').ZG17Q                            52250000
               AIF   ('&ZCGPR' LE '12').ZG17R                           52300000
.ZG17Q         ANOP  ,                                                  52350000
&ZMS           SETC  '"PSWADDR='                *KGPRA* MNOTE           52400000
&ZMS           SETC  '&ZMS.&PSWADDR"'                                   52450000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          52500000
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   52550000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            52600000
.ZG17R         ANOP  ,                                                  52650000
.*------------------------------------------------------------------    52700000
.***AG.KKCTL01 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       52750000
&XAMODE        SETC  ''          INITIALIZE XVARIABLE                   52800000
.*-------------------------------------------------------------------   52850000
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       52900000
.ZG21          ANOP  ,                                                  52950000
               AIF   (K'&AMODE(1) LE 0).ZG21A                           53000000
&ZTLC          SETC 'UNCHANGED'                                         53050000
               AIF   ('&AMODE(1)' NE '&ZTLC').ZG22                      53100000
&XAMODE        SETC  'UNCHANGED'                SET KEYWORD             53150000
               AIF   (N'&AMODE LE 1).ZG21A      CK NUM                  53200000
&ZMS           SETC  '"AMODE='   *KPOSA* MNOTE                          53250000
&ZMS           SETC  '&ZMS.&AMODE"'                                     53300000
&ZMS           SETC  '&ZMS "AMODE"'                                     53350000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                53400000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            53450000
.ZG21A         ANOP  ,                                                  53500000
.*-------------------------------------------------------------------   53550000
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       53600000
.ZG22          ANOP  ,                                                  53650000
&ZTLC          SETC '24'                                                53700000
               AIF   ('&AMODE(1)' NE '&ZTLC').ZG23                      53750000
&XAMODE        SETC  '24'        SET KEYWORD                            53800000
               AIF   (N'&AMODE LE 1).ZG22A      CK NUM                  53850000
&ZMS           SETC  '"AMODE='   *KPOSA* MNOTE                          53900000
&ZMS           SETC  '&ZMS.&AMODE"'                                     53950000
&ZMS           SETC  '&ZMS "AMODE"'                                     54000000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                54050000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            54100000
.ZG22A         ANOP  ,                                                  54150000
.*-------------------------------------------------------------------   54200000
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       54250000
.ZG23          ANOP  ,                                                  54300000
&ZTLC          SETC '31'                                                54350000
               AIF   ('&AMODE(1)' NE '&ZTLC').ZG24                      54400000
&XAMODE        SETC  '31'        SET KEYWORD                            54450000
               AIF   (N'&AMODE LE 1).ZG23A      CK NUM                  54500000
&ZMS           SETC  '"AMODE='   *KPOSA* MNOTE                          54550000
&ZMS           SETC  '&ZMS.&AMODE"'                                     54600000
&ZMS           SETC  '&ZMS "AMODE"'                                     54650000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                54700000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            54750000
.ZG23A         ANOP  ,                                                  54800000
.*-------------------------------------------------------------------   54850000
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       54900000
.ZG24          ANOP  ,                                                  54950000
&ZTLC          SETC '64'                                                55000000
               AIF   ('&AMODE(1)' NE '&ZTLC').ZG25                      55050000
&XAMODE        SETC  '64'        SET KEYWORD                            55100000
               AIF   (N'&AMODE LE 1).ZG24A      CK NUM                  55150000
&ZMS           SETC  '"AMODE='   *KPOSA* MNOTE                          55200000
&ZMS           SETC  '&ZMS.&AMODE"'                                     55250000
&ZMS           SETC  '&ZMS "AMODE"'                                     55300000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                55350000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            55400000
.ZG24A         ANOP  ,                                                  55450000
.*------------------------------------------------------------------    55500000
.***AG.KKCTL04 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       55550000
.ZG25          ANOP  ,                                                  55600000
&ZXAMODE       SETC  'INPUT'     SET IN/OUTPUT                          55650000
               AIF   (K'&XAMODE GT 0).ZG25E     VALID ARG               55700000
               AIF   (T'&AMODE EQ 'O').ZG25D    OMITTED                 55750000
&ZASYSLNDX     SETA  0                                                  55800000
.ZG25A         ANOP  ,           POSITIONAL MACRO KEY                   55850000
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       55900000
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C                   55950000
&ZTLC          SETC 'AMODE'                                             56000000
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG25A          56050000
.ZG25B         ANOP  ,                                                  56100000
&ZXAMODE       SETC  ''          RESET IN/OUTPUT                        56150000
&ZMS           SETC  'THE "AMODE" KEY'          *KOPTA* MNOTE           56200000
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            56250000
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   56300000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            56350000
               AGO   .ZG25E                                             56400000
.ZG25C         ANOP  ,                                                  56450000
&ZXAMODE       SETC  ''          RESET IN/OUTPUT                        56500000
&ZMS           SETC  '"AMODE='   *KUKWA* MNOTE                          56550000
&ZMS           SETC  '&ZMS.&AMODE"'                                     56600000
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          56650000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                56700000
&ZMS           SETC  '&ZMS "UNCHANGED",'                                56750000
&ZMS           SETC  '&ZMS "24",'                                       56800000
&ZMS           SETC  '&ZMS "31",'                                       56850000
&ZMS           SETC  '&ZMS OR "64".'                                    56900000
               MNOTE 8,' &ZMS '                                         56950000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            57000000
               AGO   .ZG25E                                             57050000
.ZG25D         ANOP  ,                                                  57100000
&XAMODE        SETC  'UNCHANGED'                SET DEFAULT KEYWORD     57150000
.ZG25E         ANOP  ,                                                  57200000
.*------------------------------------------------------------------    57250000
.***AG.KKCTL05 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       57300000
               AIF   (K'&AMODE(1) GT 0).ZG25F   PARM                    57350000
&XAMODE        SETC  ''          ENSURE NULL KEYWORD                    57400000
&ZXAMODE       SETC  ''          RESET IN/OUTPUT                        57450000
&ZMS           SETC  'WHEN "ACTUAL" IS SPECIFIED, THE'                  57500000
&ZMS           SETC  '&ZMS "AMODE" KEY AND ITS'                         57550000
&ZMS           SETC  '&ZMS ARGUMENT ARE REQUIRED.'                      57600000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                57650000
&ZMS           SETC  '&ZMS "UNCHANGED",'                                57700000
&ZMS           SETC  '&ZMS "24",'                                       57750000
&ZMS           SETC  '&ZMS "31",'                                       57800000
&ZMS           SETC  '&ZMS OR "64".'                                    57850000
               MNOTE 8,' &ZMS '                                         57900000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            57950000
.ZG25F         ANOP  ,                                                  58000000
.*-------------------------------------------------------------------   58050000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           58100000
.ZG26          ANOP  ,                                                  58150000
&ZTLC          SETC 'DELTA'                                             58200000
               AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG30                   58250000
&XADDRTYPE     SETC  'DELTA'     SET KEYWORD                            58300000
               AIF   (N'&ADDRTYPE LE 1).ZG26A   CK NUM                  58350000
&ZMS           SETC  '"ADDRTYPE='               *KPOSA* MNOTE           58400000
&ZMS           SETC  '&ZMS.&ADDRTYPE"'                                  58450000
&ZMS           SETC  '&ZMS "ADDRTYPE"'                                  58500000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                58550000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            58600000
.ZG26A         ANOP  ,                                                  58650000
.*------------------------------------------------------------------    58700000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           58750000
&ZCVAL         SETC ''           CLEAR ERROR KEY ACCUMULATOR            58800000
.ZG26A0        AIF   (K'&PSWADDR LE 0).ZG26A1   OK                      58850000
&ZCVAL         SETC '&ZCVAL PSWADDR'            INCORRECT KEY USED      58900000
.ZG26A1        AIF   (K'&AMODE LE 0).ZG26A2     OK                      58950000
&ZCVAL         SETC '&ZCVAL AMODE'              INCORRECT KEY USED      59000000
.ZG26A2        AIF   (K'&ZCVAL LE 0).ZG26A3     OK                      59050000
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              59100000
&ZMS           SETC  '"ADDRTYPE'                *KMEIA* MNOTE           59150000
&ZMS           SETC  '&ZMS.=&ADDRTYPE"'                                 59200000
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               59250000
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               59300000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            59350000
.ZG26A3        ANOP  ,                                                  59400000
.*----------------------------------------------------------------***   59450000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 59500000
               AIF   (N'&PSWDELTA LE 1).ZG28A   CK NUM                  59550000
&ZMS           SETC  '"PSWDELTA='               *KPOSA* MNOTE           59600000
&ZMS           SETC  '&ZMS.&PSWDELTA"'                                  59650000
&ZMS           SETC  '&ZMS "PSWDELTA"'                                  59700000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                59750000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            59800000
.ZG28A         ANOP  ,                                                  59850000
.*-------------------------------------------------------------------   59900000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     59950000
&ZXPSWDELTA    SETC  'INPUT'     SET IN/OUTPUT                          60000000
&XPSWDELTA     SETC  '&PSWDELTA(1)'             SET XVARIABLE           60050000
               AIF   (N'&PSWDELTA GT 1).ZG28B   MULTI PARMS             60100000
&XPSWDELTA     SETC  '&PSWDELTA'                SET XVARIABLE           60150000
.ZG28B         AIF   (K'&PSWDELTA(1) GT 0).ZG28C                        60200000
&ZXPSWDELTA    SETC  ''          RESET IN/OUTPUT                        60250000
&ZMS           SETC  'WHEN "DELTA" IS SPECIFIED'  *KRQDA*               60300000
&ZMS           SETC  '&ZMS , "PSWDELTA" KEY AND ITS'                    60350000
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   60400000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            60450000
.ZG28C         ANOP  ,                                                  60500000
.*-------------------------------------------------------------------   60550000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                60600000
               AIF   (K'&ZXPSWDELTA LE 0).ZG28R  NOT I/O                60650000
               AIF   ('&XPSWDELTA'(1,1) NE '(').ZG28R                   60700000
&ZCGPR         SETC  '&XPSWDELTA'(2,K'&XPSWDELTA-2)                     60750000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                       60800000
               AIF   (K'&ZCGPR GT 2).ZG28Q                              60850000
               AIF   ('&ZCGPR' EQ '0').ZG28Q                            60900000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      60950000
               AIF   (T'&ZCGPR NE 'N').ZG28Q    INVALID REG NAME        61000000
.ZG28P         ANOP  ,                                                  61050000
               AIF   (T'&ZCGPR NE 'N').ZG28R    NON NUMERIC             61100000
               AIF   ('&ZCGPR' LT '2').ZG28Q                            61150000
               AIF   ('&ZCGPR' LE '12').ZG28R                           61200000
.ZG28Q         ANOP  ,                                                  61250000
&ZMS           SETC  '"PSWDELTA='               *KGPRA* MNOTE           61300000
&ZMS           SETC  '&ZMS.&PSWDELTA"'                                  61350000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          61400000
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   61450000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            61500000
.ZG28R         ANOP  ,                                                  61550000
.*------------------------------------------------------------------    61600000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           61650000
.ZG30          ANOP  ,                                                  61700000
&ZXADDRTYPE    SETC  'INPUT'     SET IN/OUTPUT                          61750000
               AIF   (K'&XADDRTYPE GT 0).ZG30E  VALID ARG               61800000
               AIF   (T'&ADDRTYPE EQ 'O').ZG30D  OMITTED                61850000
&ZASYSLNDX     SETA  0                                                  61900000
.ZG30A         ANOP  ,           POSITIONAL MACRO KEY                   61950000
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       62000000
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C                   62050000
&ZTLC          SETC 'ADDRTYPE'                                          62100000
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG30A          62150000
.ZG30B         ANOP  ,                                                  62200000
&ZXADDRTYPE    SETC  ''          RESET IN/OUTPUT                        62250000
&ZMS           SETC  'THE "ADDRTYPE" KEY'       *KOPTA* MNOTE           62300000
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            62350000
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   62400000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            62450000
               AGO   .ZG30E                                             62500000
.ZG30C         ANOP  ,                                                  62550000
&ZXADDRTYPE    SETC  ''          RESET IN/OUTPUT                        62600000
&ZMS           SETC  '"ADDRTYPE='               *KUKWA* MNOTE           62650000
&ZMS           SETC  '&ZMS.&ADDRTYPE"'                                  62700000
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          62750000
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                62800000
&ZMS           SETC  '&ZMS "NO_CHANGE",'                                62850000
&ZMS           SETC  '&ZMS "INRBOPSWA",'                                62900000
&ZMS           SETC  '&ZMS "ACTUAL",'                                   62950000
&ZMS           SETC  '&ZMS OR "DELTA".'                                 63000000
               MNOTE 8,' &ZMS '                                         63050000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            63100000
               AGO   .ZG30E                                             63150000
.ZG30D         ANOP  ,                                                  63200000
&XADDRTYPE     SETC  'NO_CHANGE'                SET DEFAULT KEYWORD     63250000
.ZG30E         ANOP  ,                                                  63300000
.*----------------------------------------------------------------***   63350000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    63400000
               AIF   (N'&RETCODE LE 1).ZG32A    CK NUM                  63450000
&ZMS           SETC  '"RETCODE='                *KPOSA* MNOTE           63500000
&ZMS           SETC  '&ZMS.&RETCODE"'                                   63550000
&ZMS           SETC  '&ZMS "RETCODE"'                                   63600000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                63650000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            63700000
.ZG32A         ANOP  ,                                                  63750000
.*-------------------------------------------------------------------   63800000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        63850000
               AIF   (K'&RETCODE(1) LE 0).ZG32C  NO PARM                63900000
&ZXRETCODE     SETC  'OUTPUT'    SET OUTPUT                             63950000
&XRETCODE      SETC  '&RETCODE(1)'              SET XVARIABLE           64000000
               AIF   (N'&RETCODE GT 1).ZG32C                            64050000
&XRETCODE      SETC  '&RETCODE'  SET XVARIABLE                          64100000
.ZG32C         ANOP  ,                                                  64150000
.*-------------------------------------------------------------------   64200000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   64250000
               AIF   (K'&ZXRETCODE LE 0).ZG32R  NOT I/O                 64300000
               AIF   ('&XRETCODE'(1,1) NE '(').ZG32R                    64350000
&ZCGPR         SETC  '&XRETCODE'(2,K'&XRETCODE-2)                       64400000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                       64450000
               AIF   (K'&ZCGPR GT 2).ZG32Q                              64500000
               AIF   ('&ZCGPR' EQ '0').ZG32Q                            64550000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      64600000
               AIF   (T'&ZCGPR NE 'N').ZG32Q    INVALID REG NAME        64650000
.ZG32P         ANOP  ,                                                  64700000
               AIF   (T'&ZCGPR NE 'N').ZG32R    NON NUMERIC             64750000
               AIF   ('&ZCGPR' LT '2').ZG32Q                            64800000
               AIF   ('&ZCGPR' LE '12').ZG32R                           64850000
.ZG32Q         ANOP  ,                                                  64900000
&ZMS           SETC  '"RETCODE='                *KGPRA* MNOTE           64950000
&ZMS           SETC  '&ZMS.&RETCODE"'                                   65000000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          65050000
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   65100000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            65150000
.ZG32R         ANOP  ,                                                  65200000
.*----------------------------------------------------------------***   65201200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    65202400
               AIF   (N'&RSNCODE LE 1).ZG35A    CK NUM                  65203600
&ZMS           SETC  '"RSNCODE='                *KPOSA* MNOTE           65204800
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   65206000
&ZMS           SETC  '&ZMS "RSNCODE"'                                   65207200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                65208400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            65209600
.ZG35A         ANOP  ,                                                  65210800
.*-------------------------------------------------------------------   65212000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        65213200
               AIF   (K'&RSNCODE(1) LE 0).ZG35C  NO PARM                65214400
&ZXRSNCODE     SETC  'OUTPUT'    SET OUTPUT                             65215600
&XRSNCODE      SETC  '&RSNCODE(1)'              SET XVARIABLE           65216800
               AIF   (N'&RSNCODE GT 1).ZG35C                            65218000
&XRSNCODE      SETC  '&RSNCODE'  SET XVARIABLE                          65219200
.ZG35C         ANOP  ,                                                  65220400
.*-------------------------------------------------------------------   65221600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   65222800
               AIF   (K'&ZXRSNCODE LE 0).ZG35R  NOT I/O                 65224000
               AIF   ('&XRSNCODE'(1,1) NE '(').ZG35R                    65225200
&ZCGPR         SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                       65226400
               AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                       65227600
               AIF   (K'&ZCGPR GT 2).ZG35Q                              65228800
               AIF   ('&ZCGPR' EQ '0').ZG35Q                            65230000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      65231200
               AIF   (T'&ZCGPR NE 'N').ZG35Q    INVALID REG NAME        65232400
.ZG35P         ANOP  ,                                                  65233600
               AIF   (T'&ZCGPR NE 'N').ZG35R    NON NUMERIC             65234800
               AIF   ('&ZCGPR' LT '2').ZG35Q                            65236000
               AIF   ('&ZCGPR' LE '12').ZG35R                           65237200
.ZG35Q         ANOP  ,                                                  65238400
&ZMS           SETC  '"RSNCODE='                *KGPRA* MNOTE           65239600
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   65240800
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          65242000
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   65243200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            65244400
.ZG35R         ANOP  ,                                                  65245600
.******************************************************************     65250000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        65300000
.******************************************************************     65350000
               ACTR  10000                                              65400000
.*----------------------------------------------------------------***   65450000
.***AH.P02 EXTRA POSITIONALS                                            65500000
               AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS               65550000
               AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL               65600000
               AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL           65650000
               AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL            65700000
.ZGLISTX1      ANOP  ,                                                  65750000
&ZCVAL         SETC  ''          ERROR FIELD                            65800000
&ZAWRK         SETA  0           POSITIONAL NUMBER                      65850000
.ZGLIST2       ANOP  ,                                                  65900000
&ZAWRK         SETA  &ZAWRK+1    NEXT POSITIONAL                        65950000
               AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE               66000000
&ZCVAL         SETC '&ZCVAL,&SYSLIST(&ZAWRK)'   EXTRA                   66050000
               AGO   .ZGLIST2                                           66100000
.*                                                                      66150000
.ZGLIST3       ANOP  ,                                                  66200000
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)      STRIP COMMA             66250000
&ZMS           SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE           66300000
&ZMS           SETC  '&ZMS "&ZCVAL"'                                    66350000
&ZMS           SETC  '&ZMS CANNOT BE USED.'                             66400000
&ZMS           SETC  '&ZMS NO POSITIONAL ARGUMENTS'                     66450000
               MNOTE 8,' &ZMS ARE ALLOWED.'                             66500000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            66550000
.ZGLISTX       ANOP  ,                                                  66600000
&ZASYSLNDX     SETA  0                                                  66650000
.*-------------------------------------------------------------------   66700000
.***AG.MF04 MF=(SLE)                                                    66750000
.ZGMFX         ANOP  ,           END OF FULL SYNTAX CHECK               66800000
.*******************************************************************    66850000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       66900000
.*******************************************************************    66950000
               AIF   (&ZMACRET NE 0).ZLX2       ERROR DETECTED          67000000
.*******************************************************************    67050000
.***AE.01  START OF IEARBUP MACRO CODE                                  67100000
.*******************************************************************    67150000
               LCLC  &M0M0001                 NAME                      67200000
&M0M0001       SETC  '&XLABEL'                SET NAME                  67250000
               AIF   (K'&XLABEL NE 0).XLAB2                             67300000
&M0M0001       SETC  'M00M&SYSNDX'            DEFAULT NAME              67350000
.*                                                                      67400000
.XLAB2         ANOP  ,                                                  67450000
               AIF   ('&XMF' EQ 'L').XLAB3                              67500000
&M0M0001 DS    0H                             IEARBUP-0                 67550000
.XLAB3         ANOP  ,                                                  67600000
.*******************************************************************    67650000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              67700000
.*******************************************************************    67750000
              PUSH  PRINT                                               67800000
               AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON         67850000
               PRINT OFF         ++ PR01                                67900000
               AGO   .ZPRNTXX                                           67950000
.ZPRINTX       PRINT ON                                                 68000000
.ZPRNTXX       ANOP  ,                                                  68050000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  68100000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  68150000
.********************************************************************   68200000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     68250000
.********************************************************************   68300000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       68350000
                      LCLA  &ZOPN1         INVOCATION INDEX             68400000
                      LCLC  &ZOPL(4095)    LABEL                        68450000
                      LCLC  &ZOPO(4095)    OPERATION                    68500000
                      LCLC  &ZOPV(4095)    VALUE                        68550000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  68600000
.*                                                                      68650000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     68700000
.******************************************************************     68750000
.***AL.L10 IEARBUP FMT=LIST MF=S|L PARAMETERS                           68800000
.******************************************************************     68850000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     68900000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     68950000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     69000000
&XMFATTR              SETC  '0D'                                        69050000
.*                                                                      69100000
&ZOPN                 SETA  &ZOPN+1                                     69150000
&ZOPL(&ZOPN)          SETC  ' '                                         69200000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     69208300
&ZOPO(&ZOPN)          SETC  'B'                                         69216600
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                69224900
                      AGO   .ZALVL6B                                    69233200
.ZALVL6A              ANOP                                              69241500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      69250000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              69300000
.ZALVL6B              ANOP                                              69325000
&ZOPD(&ZOPN)          SETC  '++ IEARBUP ARG PARMS'                      69350000
.*                                                                      69400000
&ZOPN                 SETA  &ZOPN+1                                     69450000
&ZOPL(&ZOPN)          SETC  ' '                                         69500000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     69550000
&ZOPV(&ZOPN)          SETC  '1'                                         69600000
&ZOPD(&ZOPN)          SETC  ' '                                         69650000
.*                                                                      69700000
.ZLMFSL2              ANOP  ,                                           69750000
.*-------------------------------------------------------------------   69800000
.***AM.L00  IEARBUP FMT=LIST name                                       69850000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    69900000
&ZOPN                 SETA &ZOPN+1                                      69950000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   70000000
&ZOPO(&ZOPN)          SETC 'EQU'                                        70050000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   70100000
&ZOPD(&ZOPN)          SETC '++ IEARBUP NAME'                            70150000
.ZLMFSL2M             ANOP  ,                                           70200000
.*-------------------------------------------------------------------   70250000
.***AM.L01  IEARBUP FMT=LIST PARAMETERS                                 70300000
&ZOPN                 SETA &ZOPN+1                                      70350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   70400000
&ZOPO(&ZOPN)          SETC 'DS'                                         70450000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   70500000
&ZOPD(&ZOPN)          SETC '++ IEARBUP PARM LIST'                       70550000
.*-------------------------------------------------------------------   70600000
.***AM.L02 XVERSION XL1                                                 70650000
&ZOPN                 SETA &ZOPN+1                                      70700000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         70750000
&ZOPO(&ZOPN)          SETC 'DS'                                         70800000
&ZOPV(&ZOPN)          SETC 'XL1'                                        70850000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          70900000
.*-------------------------------------------------------------------   70950000
.***AM.L03 XFLAGS BL.8                                                  71000000
&ZOPN                 SETA &ZOPN+1                                      71050000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           71100000
&ZOPO(&ZOPN)          SETC 'DS'                                         71150000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       71200000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             71250000
.*                                                                      71300000
&ZOPN                 SETA  &ZOPN+1                                     71350000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ADDRTYPE'                71400000
&ZOPO(&ZOPN)          SETC  'EQU'                                       71450000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             71500000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               71550000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ADDRTYPE'                     71600000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      71650000
.*                                                                      71700000
&ZOPN                 SETA  &ZOPN+1                                     71750000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRTYPE_INRBOPSWA'             71800000
&ZOPO(&ZOPN)          SETC  'EQU'                                       71850000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             71900000
&ZOPD(&ZOPN)          SETC  '++ XADDRTYPE.'                             71950000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INRBOPSWA'                    72000000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      72050000
.*                                                                      72100000
&ZOPN                 SETA  &ZOPN+1                                     72150000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRTYPE_ACTUAL'                72200000
&ZOPO(&ZOPN)          SETC  'EQU'                                       72250000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             72300000
&ZOPD(&ZOPN)          SETC  '++ XADDRTYPE.'                             72350000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ACTUAL'                       72400000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      72450000
.*                                                                      72500000
&ZOPN                 SETA  &ZOPN+1                                     72550000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRTYPE_DELTA'                 72600000
&ZOPO(&ZOPN)          SETC  'EQU'                                       72650000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             72700000
&ZOPD(&ZOPN)          SETC  '++ XADDRTYPE.'                             72750000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DELTA'                        72800000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      72850000
.*                                                                      72900000
&ZOPN                 SETA  &ZOPN+1                                     72950000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XWHICHRB_CURRENT'                73000000
&ZOPO(&ZOPN)          SETC  'EQU'                                       73050000
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             73100000
&ZOPD(&ZOPN)          SETC  '++ XWHICHRB.'                              73150000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CURRENT'                      73200000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      73250000
.*                                                                      73300000
&ZOPN                 SETA  &ZOPN+1                                     73350000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPSWBYTE03_YES'                  73400000
&ZOPO(&ZOPN)          SETC  'EQU'                                       73450000
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             73500000
&ZOPD(&ZOPN)          SETC  '++ XPSWBYTE03.'                            73550000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          73600000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      73650000
.*-------------------------------------------------------------------   73700000
.***AM.L05 XAMODE XL1                                                   73750000
&ZOPN                 SETA &ZOPN+1                                      73800000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAMODE'                           73850000
&ZOPO(&ZOPN)          SETC 'DS'                                         73900000
&ZOPV(&ZOPN)          SETC 'XL1'                                        73950000
&ZOPD(&ZOPN)          SETC '++ &ZXAMODE XAMODE'                         74000000
.*                                                                      74050000
&ZOPN                 SETA  &ZOPN+1                                     74100000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_UNCHANGED'                74150000
&ZOPO(&ZOPN)          SETC  'EQU'                                       74200000
&ZOPV(&ZOPN)          SETC  '0'                                         74250000
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                74300000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UNCHANGED'                    74350000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      74400000
.*                                                                      74450000
&ZOPN                 SETA  &ZOPN+1                                     74500000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_24'                       74550000
&ZOPO(&ZOPN)          SETC  'EQU'                                       74600000
&ZOPV(&ZOPN)          SETC  '1'                                         74650000
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                74700000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).24'                           74750000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      74800000
.*                                                                      74850000
&ZOPN                 SETA  &ZOPN+1                                     74900000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_31'                       74950000
&ZOPO(&ZOPN)          SETC  'EQU'                                       75000000
&ZOPV(&ZOPN)          SETC  '2'                                         75050000
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                75100000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).31'                           75150000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      75200000
.*                                                                      75250000
&ZOPN                 SETA  &ZOPN+1                                     75300000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_64'                       75350000
&ZOPO(&ZOPN)          SETC  'EQU'                                       75400000
&ZOPV(&ZOPN)          SETC  '3'                                         75450000
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                75500000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).64'                           75550000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      75600000
.*-------------------------------------------------------------------   75650000
.***AM.L09  XRSV0003 CL1                                                75700000
&ZOPN                 SETA &ZOPN+1                                      75750000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         75800000
&ZOPO(&ZOPN)          SETC 'DS'                                         75850000
&ZOPV(&ZOPN)          SETC 'CL1'                                        75900000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0003'                      75950000
.*-------------------------------------------------------------------   76000000
.***AM.L09  XPSWDELTA F                                                 76050000
&ZOPN                 SETA &ZOPN+1                                      76100000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPSWDELTA'                        76150000
&ZOPO(&ZOPN)          SETC 'DS'                                         76200000
&ZOPV(&ZOPN)          SETC 'F'                                          76250000
&ZOPD(&ZOPN)          SETC '++ &ZXPSWDELTA  XPSWDELTA'                  76300000
.*-------------------------------------------------------------------   76350000
.***AM.L09  XRSV0008 CL4                                                76400000
&ZOPN                 SETA &ZOPN+1                                      76450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0008'                         76500000
&ZOPO(&ZOPN)          SETC 'DS'                                         76550000
&ZOPV(&ZOPN)          SETC 'CL4'                                        76600000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0008'                      76650000
.*-------------------------------------------------------------------   76700000
.***AM.L09  XRSV000C CL8                                                76750000
&ZOPN                 SETA &ZOPN+1                                      76800000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV000C'                         76850000
&ZOPO(&ZOPN)          SETC 'DS'                                         76900000
&ZOPV(&ZOPN)          SETC 'CL8'                                        76950000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV000C'                      77000000
.*-------------------------------------------------------------------   77050000
.***AM.MLM1 SAVED LOCATION COUNTER                                      77100000
                      AIF  ('&ZENDBASEPL' NE '').ZL17LB                 77150000
&ZENDBASEPL           SETC 'YES'                                        77200000
&ZOPN                 SETA &ZOPN+1                                      77250000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           77300000
&ZOPO(&ZOPN)          SETC 'EQU'                                        77350000
&ZOPV(&ZOPN)          SETC '*'                                          77400000
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       77450000
.ZL17LB               ANOP  ,                                           77500000
.*-------------------------------------------------------------------   77550000
.***AM.PJR1 DEFINED ON XPSWDELTA                                        77600000
&ZOPN                 SETA &ZOPN+1                                      77650000
&ZOPL(&ZOPN)          SETC ' '                                          77700000
&ZOPO(&ZOPN)          SETC 'ORG'                                        77750000
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+4'                                77800000
&ZOPD(&ZOPN)          SETC ' '                                          77850000
.*-------------------------------------------------------------------   77900000
.***AM.L09  XPSWADDR CL8                                                77950000
&ZOPN                 SETA &ZOPN+1                                      78000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPSWADDR'                         78050000
&ZOPO(&ZOPN)          SETC 'DS'                                         78100000
&ZOPV(&ZOPN)          SETC 'CL8'                                        78150000
&ZOPD(&ZOPN)          SETC '++ &ZXPSWADDR  XPSWADDR'                    78200000
&ZOPN                 SETA &ZOPN+1                                      78250000
&ZOPL(&ZOPN)          SETC ' '                                          78300000
&ZOPO(&ZOPN)          SETC 'ORG'                                        78350000
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           78400000
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     78450000
.*-------------------------------------------------------------------   78500000
.***AM.L10 END OF IEARBUP LIST PARAMETERS                               78550000
&ZOPN                 SETA &ZOPN+1                                      78600000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 78650000
&ZOPO(&ZOPN)          SETC 'EQU'                                        78700000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 78750000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         78800000
.*                                                                      78850000
&ZOPN                 SETA &ZOPN+1                                      78900000
&ZOPL(&ZOPN)          SETC ' '                                          78950000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      79000000
&ZOPV(&ZOPN)          SETC '1'                                          79050000
&ZOPD(&ZOPN)          SETC ' '                                          79100000
.*-------------------------------------------------------------------   79150000
.***AL.L12 IEARBUP FMT=LIST MF=S|L PARAMETERS                           79200000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         79250000
.*                                                                      79300000
&ZOPN                 SETA  &ZOPN+1                                     79350000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                79400000
&ZOPO(&ZOPN)          SETC  'DC'                                        79450000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   79500000
&ZOPD(&ZOPN)          SETC  '++ IEARBUP ARG PARMS'                      79550000
.*                                                                      79600000
.ZLMFSLX              ANOP  ,                                           79650000
.*-------------------------------------------------------------------   79700000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          79750000
&ZPLLEN               SETA 20                                           79800000
.*                                                                      79850000
.******************************************************************     79900000
.***AI.L01 IEARBUP FMT=LIST FILL IN PARAMETER AREA                      79950000
.******************************************************************     80000000
                      ACTR  10000                                       80050000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               80100000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    80150000
&ZCVAL                SETC  'LAE'          XAX MODE                     80200000
.ZIMFXA               ANOP ,                                            80250000
.*                                                                      80300000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    80350000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         80400000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 80450000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                80500000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 80550000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                80600000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   80650000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    80700000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   80750000
&ZOPN                 SETA  &ZOPN+1                                     80800000
&ZOPL(&ZOPN)          SETC  ' '                                         80850000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    80900000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              80950000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       81000000
                      AGO   .ZIMFNX                                     81050000
.*                                                                      81100000
.ZIMFN2               ANOP ,                                            81150000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     81175000
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     81200000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  81250000
&ZOPN                 SETA  &ZOPN+1                                     81300000
&ZOPL(&ZOPN)          SETC  ' '                                         81350000
&ZOPO(&ZOPN)          SETC  'LAE'                                       81400000
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  81450000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       81500000
                      AGO   .ZIMFNX                                     81550000
.ZIMFNX1              ANOP ,                                            81600000
&ZOPN                 SETA  &ZOPN+1                                     81650000
&ZOPL(&ZOPN)          SETC  ' '                                         81700000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    81750000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                81800000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       81850000
.ZIMFNX               ANOP ,                                            81900000
.********************************************************************   81950000
.***AI.L02 IEARBUP FMT=LIST INITIALIZE PARAMETER AREA                   82000000
.********************************************************************   82050000
.***AI.L03 MF=(SLE)                                                     82100000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      82150000
.*                                                                      82200000
&ZOPN                 SETA  &ZOPN+1                                     82250000
&ZOPL(&ZOPN)          SETC  ' '                                         82300000
&ZOPO(&ZOPN)          SETC  'XC'                                        82350000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         82400000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             82450000
.ZIMFLX               ANOP  ,                                           82500000
.*-------------------------------------------------------------------   82550000
.***AI.L05 XFLAGS BL1                                                   82600000
&ZW                   SETC  ''                                          82650000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            82700000
.*-------------------------------------------------------------------   82750000
.***AI.L08 XFLAGS "ADDRTYPE"                                            82800000
.***      BL1'1XXXXXXX'                                                 82850000
         AIF   ('&ADDRTYPE' EQ '').ZI3A                                 82900000
         AIF   ('&ADDRTYPE' EQ 'NO_CHANGE').ZI3A                        82950000
&ZW                   SETC  '&ZW.1'                                     83000000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              83050000
                      AGO   .ZI3C                                       83100000
.*                                                                      83150000
.ZI3A                 ANOP  ,                                           83200000
&ZW                   SETC  '&ZW.0'                                     83250000
.ZI3C                 ANOP  ,                                           83300000
.*-------------------------------------------------------------------   83350000
.***AI.L08 XFLAGS "INRBOPSWA"                                           83400000
.***      BL1'X1XXXXXX'                                                 83450000
         AIF   ('&XADDRTYPE' NE 'INRBOPSWA').ZI4A                       83500000
&ZW                   SETC  '&ZW.1'                                     83550000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              83600000
                      AGO   .ZI4C                                       83650000
.*                                                                      83700000
.ZI4A                 ANOP  ,                                           83750000
&ZW                   SETC  '&ZW.0'                                     83800000
.ZI4C                 ANOP  ,                                           83850000
.*-------------------------------------------------------------------   83900000
.***AI.L08 XFLAGS "ACTUAL"                                              83950000
.***      BL1'XX1XXXXX'                                                 84000000
         AIF   ('&XADDRTYPE' NE 'ACTUAL').ZI5A                          84050000
&ZW                   SETC  '&ZW.1'                                     84100000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              84150000
                      AGO   .ZI5C                                       84200000
.*                                                                      84250000
.ZI5A                 ANOP  ,                                           84300000
&ZW                   SETC  '&ZW.0'                                     84350000
.ZI5C                 ANOP  ,                                           84400000
.*-------------------------------------------------------------------   84450000
.***AI.L08 XFLAGS "DELTA"                                               84500000
.***      BL1'XXX1XXXX'                                                 84550000
         AIF   ('&XADDRTYPE' NE 'DELTA').ZI6A                           84600000
&ZW                   SETC  '&ZW.1'                                     84650000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              84700000
                      AGO   .ZI6C                                       84750000
.*                                                                      84800000
.ZI6A                 ANOP  ,                                           84850000
&ZW                   SETC  '&ZW.0'                                     84900000
.ZI6C                 ANOP  ,                                           84950000
.*-------------------------------------------------------------------   85000000
.***AI.L08 XFLAGS "CURRENT"                                             85050000
.***      BL1'XXXX1XXX'                                                 85100000
         AIF   ('&XWHICHRB' NE 'CURRENT').ZI7A                          85150000
&ZW                   SETC  '&ZW.1'                                     85200000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              85250000
                      AGO   .ZI7C                                       85300000
.*                                                                      85350000
.ZI7A                 ANOP  ,                                           85400000
&ZW                   SETC  '&ZW.0'                                     85450000
.ZI7C                 ANOP  ,                                           85500000
.*-------------------------------------------------------------------   85550000
.***AI.L08 XFLAGS "YES"                                                 85600000
.***      BL1'XXXXXXX1'                                                 85650000
         AIF   ('&XPSWBYTE03' NE 'YES').ZI8A                            85700000
&ZW                   SETC  '&ZW.001'                                   85750000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              85800000
                      AGO   .ZI8C                                       85850000
.*                                                                      85900000
.ZI8A                 ANOP  ,                                           85950000
&ZW                   SETC  '&ZW.000'                                   86000000
.ZI8C                 ANOP  ,                                           86050000
.*-------------------------------------------------------------------   86100000
.***AI.L11 XFLAGS BL1                                                   86150000
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     86200000
&ZOPN                 SETA  &ZOPN+1                                     86250000
&ZOPL(&ZOPN)          SETC  ' '                                         86300000
&ZOPO(&ZOPN)          SETC  'OI'                                        86350000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             86400000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              86450000
.ZI8E                 ANOP  ,                                           86500000
.*-------------------------------------------------------------------   86550000
.***AI.L07 XAMODE AL1                                                   86600000
&ZW                   SETC  ''                                          86650000
.*-------------------------------------------------------------------   86700000
.***AI.L15 XAMODE "UNCHANGED" AL1                                       86750000
         AIF   ('&XAMODE' NE 'UNCHANGED').ZI10A                         86800000
&ZW                   SETC  '0'                                         86850000
.ZI10A                ANOP  ,                                           86900000
.*-------------------------------------------------------------------   86950000
.***AI.L15 XAMODE "24" AL1                                              87000000
         AIF   ('&XAMODE' NE '24').ZI11A                                87050000
&ZW                   SETC  '1'                                         87100000
.ZI11A                ANOP  ,                                           87150000
.*-------------------------------------------------------------------   87200000
.***AI.L15 XAMODE "31" AL1                                              87250000
         AIF   ('&XAMODE' NE '31').ZI12A                                87300000
&ZW                   SETC  '2'                                         87350000
.ZI12A                ANOP  ,                                           87400000
.*-------------------------------------------------------------------   87450000
.***AI.L15 XAMODE "64" AL1                                              87500000
         AIF   ('&XAMODE' NE '64').ZI13A                                87550000
&ZW                   SETC  '3'                                         87600000
.ZI13A                ANOP  ,                                           87650000
.*-------------------------------------------------------------------   87700000
.***AI.L17 XAMODE AL1                                                   87750000
                      AIF   ('&ZW' EQ '0').ZI13B                        87800000
                      AIF   ('&ZW' EQ '').ZI13B                         87850000
.*                                                                      87900000
&ZOPN                 SETA  &ZOPN+1                                     87950000
&ZOPL(&ZOPN)          SETC  ' '                                         88000000
&ZOPO(&ZOPN)          SETC  'MVI'                                       88050000
&ZOPV(&ZOPN)          SETC  '2(1),&ZW'                                  88100000
&ZOPD(&ZOPN)          SETC  '++ &ZXAMODE XAMODE'                        88150000
.ZI13B                ANOP  ,                                           88200000
.*-------------------------------------------------------------------   88250000
.***AI.L25  XPSWDELTA F                                                 88300000
                      AIF   ('&ZXPSWDELTA' EQ '').ZI15E                 88350000
                      AIF   ('&ZXPSWDELTA' EQ 'OUTPUT').ZI15E           88400000
&ZCGPR                SETC  '&XPSWDELTA'                                88450000
.*                                                                      88500000
                      AIF   ('&XPSWDELTA'(1,1) NE '(').ZI15B            88550000
&ZCGPR   SETC  '0('.'&XPSWDELTA'(2,K'&XPSWDELTA-2).')'                  88600000
                      AGO   .ZI15D                                      88650000
.ZI15B                ANOP  ,                                           88700000
.*                                                                      88750000
&ZC                   SETC  '&XPSWDELTA'(1,1)                           88800000
                      AIF   (T'&ZC NE 'N').ZI15D                        88850000
&ZC                   SETC  '&XPSWDELTA'                                88900000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               88950000
&ZCGPR                SETC  '=FL4''&XPSWDELTA'''                        89000000
.*                                                                      89050000
.ZI15D                ANOP  ,                                           89100000
.*                                                                      89150000
&ZOPN                 SETA  &ZOPN+1                                     89200000
&ZOPL(&ZOPN)          SETC  ' '                                         89250000
&ZOPO(&ZOPN)          SETC  'MVC'                                       89300000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             89350000
&ZOPD(&ZOPN)          SETC  '++ &ZXPSWDELTA XPSWDELTA'                  89400000
.*                                                                      89450000
.ZI15E                ANOP  ,                                           89500000
.*-------------------------------------------------------------------   89550000
.***AI.L25  XPSWADDR CL8                                                89600000
                      AIF   ('&ZXPSWADDR' EQ '').ZI19E                  89650000
                      AIF   ('&ZXPSWADDR' EQ 'OUTPUT').ZI19E            89700000
&ZCGPR                SETC  '&XPSWADDR'                                 89750000
.*                                                                      89800000
                      AIF   ('&XPSWADDR'(1,1) NE '(').ZI19B             89850000
&ZCGPR   SETC  '0('.'&XPSWADDR'(2,K'&XPSWADDR-2).')'                    89900000
.ZI19B                ANOP  ,                                           89950000
.*                                                                      90000000
&ZOPN                 SETA  &ZOPN+1                                     90050000
&ZOPL(&ZOPN)          SETC  ' '                                         90100000
&ZOPO(&ZOPN)          SETC  'MVC'                                       90150000
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             90200000
&ZOPD(&ZOPN)          SETC  '++ &ZXPSWADDR XPSWADDR'                    90250000
.*                                                                      90300000
.ZI19E                ANOP  ,                                           90350000
.*-------------------------------------------------------------------   90400000
&ZOPN1                SETA &ZOPN                                        90450000
.*******************************************************************    90500000
.***  PROCESS IEARBUP OUTPUT PARAMETERS                                 90550000
.*******************************************************************    90600000
                      ACTR  10000                                       90650000
.*******************************************************************    90700000
.***AO.X02  RETURN CODE PROCESSING                                      90750000
.*******************************************************************    90800000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    90850000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            90900000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             90950000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             91000000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               91050000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                91100000
&ZOPN                 SETA  &ZOPN+1                                     91150000
&ZOPL(&ZOPN)          SETC  ' '                                         91200000
&ZOPO(&ZOPN)          SETC  'ST'                                        91250000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              91300000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        91350000
                      AGO   .ZMRETX                                     91400000
.*                                                                      91450000
.ZMRET2               ANOP  ,                                           91500000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                91550000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                91600000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                91650000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  91700000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   91750000
&ZOPN                 SETA  &ZOPN+1                                     91800000
&ZOPL(&ZOPN)          SETC  ' '                                         91850000
&ZOPO(&ZOPN)          SETC  'LR'                                        91900000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 91950000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        92000000
.ZMRETX               ANOP  ,                                           92050000
.*******************************************************************    92100000
.***AO.X03  REASON CODE PROCESSING                                      92101400
.*******************************************************************    92102800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    92104200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            92105600
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              92107000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             92108400
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              92109800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             92111200
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                92112600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 92114000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                92115400
&ZOPN                 SETA  &ZOPN+1                                     92116800
&ZOPL(&ZOPN)          SETC  ' '                                         92118200
&ZOPO(&ZOPN)          SETC  'ST'                                        92119600
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               92121000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        92122400
                      AGO   .ZMRSNX                                     92123800
.*                                                                      92125200
.ZMRSN2               ANOP  ,                                           92126600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                92128000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 92129400
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                92130800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 92132200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                92133600
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   92135000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    92136400
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   92137800
&ZOPN                 SETA  &ZOPN+1                                     92139200
&ZOPL(&ZOPN)          SETC  ' '                                         92140600
&ZOPO(&ZOPN)          SETC  'LR'                                        92142000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  92143400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        92144800
.ZMRSNX               ANOP  ,                                           92146200
.*******************************************************************    92147600
.***AO.X04  LABEL FOR MF=L PROCESSING                                   92150000
.*******************************************************************    92200000
.ZMFLX                ANOP  ,              MF=L PROCESSING              92250000
.*******************************************************************    92300000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               92350000
.*******************************************************************    92400000
                      ACTR  10000                                       92450000
.*                                                                      92500000
                      LCLA  &ZLC           COLUMN POSITION              92550000
                      LCLA  &ZOPX          LIST TABLE INDEX             92600000
                      LCLC  &ZLL           LABEL                        92650000
                      LCLC  &ZLOP          OPERATION                    92700000
                      LCLC  &ZLV           VALUE                        92750000
                      LCLC  &ZLD           DESCRIPTION                  92800000
.*                                                                      92850000
&ZOPX                 SETA  1                                           92900000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            92950000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              93000000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              93050000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              93100000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              93150000
                      AIF   (K'&ZLD LE 0).ZL5                           93200000
&ZLC                  SETA  35             COMMENT COLUMN               93250000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    93300000
&ZLC                  SETA  33             COMMMENT COLUMN              93350000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   93400000
&ZLV                  SETC  '&ZLV'.' '                                  93450000
                      AGO   .ZL3                                        93500000
.*                                                                      93550000
.ZL4                  ANOP  ,                                           93600000
&ZLV                  SETC  '&ZLV'.' '                                  93650000
.ZL5                  ANOP  ,                                           93700000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               93750000
.*                                                                      93800000
&ZLL     &ZLOP &ZLV                                                     93850000
.*                                                                      93900000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               93950000
                      AGO   .ZL2           CONTINUE LOOPING             94000000
.*                                                                      94050000
.ZLX                  ANOP  ,                                           94100000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                94150000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  94200000
         L     15,16(0,0)              GET CVT ADDRESS             @L1A 94250000
         L     15,CVTECVT-CVT(15,0)    GET ECVT address            @L1A 94300000
         L     15,ECVTRBUP-ECVT(15,0)  GET RB update address       @L1A 94350000
         BASR  14,15                   CALL RB update service      @L1A 94400000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  94450000
.ZLINKX               ANOP  ,                                           94500000
.*******************************************************************    94550000
.***AP.X01  FORMAT GENERATED CODE                                       94600000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            94650000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              94700000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              94750000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              94800000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              94850000
                      AIF   (K'&ZLD LE 0).ZL51                          94900000
&ZLC                  SETA  35             COMMENT COLUMN               94950000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   95000000
&ZLC                  SETA  33             COMMENT COLUMN               95050000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  95100000
&ZLV                  SETC  '&ZLV'.' '                                  95150000
                      AGO   .ZL31                                       95200000
.*                                                                      95250000
.ZL41                 ANOP  ,                                           95300000
&ZLV                  SETC  '&ZLV'.' '                                  95350000
.ZL51                 ANOP  ,                                           95400000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               95450000
.*                                                                      95500000
&ZLL     &ZLOP &ZLV                                                     95550000
.*                                                                      95600000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               95650000
                      AGO   .ZL21          CONTINUE LOOPING             95700000
.*                                                                      95750000
.ZLX1                 ANOP  ,                                           95800000
.*******************************************************************    95850000
.***AP.X02  END OF IEARBUP MACRO                                        95900000
&ZIEARBUP             SETC  'YES'          SET IEARBUP USED             95950000
         POP   PRINT                                                    96000000
*                                            IEARBUP-0                  96050000
         SPACE 1                                                        96100000
.ZLX2                 ANOP  ,                                           96150000
         MEND                                                           96200000
**********************************************************************/ 96250000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  96300000
*%IEARBUP: MACRO KEYS(WHICHRB,PSWBYTE03,ADDRTYPE,PSWADDR,AMODE,         96350000
*                 PSWDELTA,RETCODE,RSNCODE,MF);                         96400000
*  ANS('?'||MACLABEL||' '||'IEARBUPP '||MACLIST||                       96450000
*         ' '||MACKEYS||';') COL(MACLMAR);                              96500000
*%END IEARBUP;                                                          96550000
