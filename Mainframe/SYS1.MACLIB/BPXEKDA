*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  BPXEKDA                               -08/17/99-<0> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME: UNIX System Services Enhanced Reporter Support * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT=                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00600000
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00650000
*                                                                     * 00700000
*   STATUS= HBB7703                                                   * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00900000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00950000
*                                                                     * 01000000
*01* FUNCTION:                                                        * 01050000
*                                                                     * 01100000
*      BPXEKDA macro provides an interface for an authorized reporter * 01150000
*      application to retrieve kernel data.                           * 01200000
*                                                                     * 01250000
*01* INVOCATION REQUIREMENTS:                                         * 01300000
*                                                                     * 01350000
*                                                                     * 01400000
*      Authorization:          Supervisor state.                      * 01450000
*                                                                     * 01500000
*      Dispatchable unit mode: Task                                   * 01550000
*                                                                     * 01600000
*      Cross memory mode:      PASN=HASN                              * 01650000
*                                                                     * 01700000
*      Addressing Mode:        31 bit addressing mode.                * 01750000
*                                                                     * 01800000
*      ASC mode:               Primary mode.                          * 01850000
*                                                                     * 01900000
*      Interrupt status:       Enabled for interrupts                 * 01950000
*                                                                     * 02000000
*      Locks:                  Unlocked                               * 02050000
*                                                                     * 02100000
*      Control parameters:     All parameters must be addressable by  * 02150000
*                              the caller and in the primary address  * 02200000
*                              space.                                 * 02250000
*                                                                     * 02300000
*                                                                     * 02350000
*01* INPUT REGISTERS:  GR0-GR12    Undefined                          * 02400000
*                      GR13        Points to 72-byte register         * 02450000
*                                  savearea                           * 02500000
*                      GR14-GR15   Undefined                          * 02550000
*                                                                     * 02600000
*01* OUTPUT REGISTERS: GR0-GR1     Unpredictable                      * 02650000
*                      GR2-GR13    Unchanged                          * 02700000
*                      GR14        Next Instruction Address           * 02750000
*                      GR15        Return Code                        * 02800000
*                                                                     * 02850000
*01* INVOCATION FORMAT:                                               * 02900000
*                                                                     * 02950000
* [xlabel] BPXEKDA     KBUFPTR=xkbufptr                               * 03000000
*                     ,KBUFLEN=xkbuflen                               * 03050000
*                     ,KBUFALET=xkbufalet                             * 03100000
*                     ,RETCODE=xretcode                               * 03150000
*                   [,MF=S]                                          * 03200000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 03250000
*                   [,MF=(E,xmfctrl)]                                * 03300000
*                                                                     * 03350000
*                                                                     * 03400000
*      Where:                                                         * 03450000
*                                                                     * 03500000
*                                                                     * 03550000
*      [xlabel]                                                       * 03600000
*          is an optional symbol, starting in column 1, that is the   * 03650000
*          name of the BPXEKDA macro invocation.  The name must       * 03700000
*          conform to the rules for an ordinary assembler language    * 03750000
*          symbol.                                                    * 03800000
*          DEFAULT: No name.                                          * 03850000
*                                                                     * 03900000
*                                                                     * 03950000
*      KBUFPTR=xkbufptr                                               * 04000000
*          is the name (RS-type), or address in register (2)-(12), of * 04050000
*          a required 4 byte area that contains the address of a      * 04100000
*          required input/output area that is to contain the input    * 04150000
*          request data and the output data to be returned by BPXEKDA.* 04200000
*          The mapping macro BPXZODMV maps all of this input and      * 04250000
*          output data. The input request data is mapped by the       * 04300000
*          OdmvInputParms field. The remainder of the BPXZODMV mapping* 04350000
*          macro describes data that is returned by BPXEKDA when it   * 04400000
*          completes successfully.                                    * 04450000
*                                                                     * 04500000
*                                                                     * 04550000
*       KBUFLEN=xkbuflen                                              * 04600000
*          is the name (RS-type), or length in register (2)-(12), of  * 04650000
*          a required fullword field that contains the length of the  * 04700000
*          supplied buffer.  It is recommended that this buffer be    * 04750000
*          at least 1 Megabyte in length to contain all of the data   * 04800000
*          that could be returned for the input request data. Upon    * 04850000
*          successful completion, this area will be defined by the    * 04900000
*          mapping macro BPXZODMV.  If BPXEKDA is unsuccessful,       * 04950000
*          this area will contain invalid data.                       * 05000000
*                                                                     * 05050000
*                                                                     * 05100000
*       KBUFALET=xkbufalet                                            * 05150000
*          is the name (RS-type), or length in register (2)-(12), of  * 05200000
*          a required fullword field that contains the ALET of the    * 05250000
*          supplied buffer.                                           * 05300000
*                                                                     * 05350000
*                                                                     * 05400000
*      [RETCODE=xretcode]                                             * 05450000
*          is the name (RS-type) of an optional fullword output       * 05500000
*          variable, or register (2)-(12), into which the return code * 05550000
*          is to be copied from GPR 15.                               * 05600000
*                                                                     * 05650000
*                                                                     * 05700000
*      [MF=S|L|E]                                                   * 05750000
*          is an optional keyword input which specifies the macro     * 05800000
*          form.                                                      * 05850000
*          DEFAULT: S                                                 * 05900000
*                                                                     * 05950000
*          [MF=S]                                                     * 06000000
*              specifies the standard form of the macro.  The "S"     * 06050000
*              form generates code to put the parameters into an      * 06100000
*              in-line parameter list and invoke the desired service. * 06150000
*              Full checking for required macro keys is done along    * 06200000
*              with supplying defaults for optional parameters that   * 06250000
*              are not specified.                                     * 06300000
*                                                                     * 06350000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 06400000
*              specifies the list form of the macro.  The "L" form    * 06450000
*              defines an area to be used for the parameter list.     * 06500000
*              Any other macro parameters are flagged as errors.      * 06550000
*                                                                     * 06600000
*            ,xmfctrl                                                 * 06650000
*              is a required input.  It is the name of a storage area * 06700000
*              for the parameter list.                                * 06750000
*                                                                     * 06800000
*            ,xmfattr|0D                                            * 06850000
*              is an optional 60 character input string that varies   * 06900000
*              from 1 to 60 characters. It can contain any value that * 06950000
*              is valid on an assembler DS pseudo-op. You can use     * 07000000
*              this parameter to force boundary alignment of the      * 07050000
*              parameter list.                                        * 07100000
*              DEFAULT: 0D which forces the parameter list to a       * 07150000
*              doubleword boundary.                                   * 07200000
*                                                                     * 07250000
*          [MF=(E,xmfctrl)]                                           * 07300000
*              specifies the execute form of the macro.  The "E" form * 07350000
*              generates code to put the parameters into the          * 07400000
*              parameter list specified by xmfctrl and provides full  * 07450000
*              syntax checking with default setting.                  * 07500000
*                                                                     * 07550000
*            ,xmfctrl                                                 * 07600000
*              is a required input.  It is the name (RS-type), or     * 07650000
*              address in register (2)-(12), of a storage area for    * 07700000
*              the parameter list.                                    * 07750000
*                                                                     * 07800000
*                                                                     * 07850000
*                                                                     * 07900000
*01* RETURN CODES:                                                    * 07950000
*                                                                     * 08000000
*                                                                     * 08050000
*       00        The macro completed successfully.                   * 08100000
*                                                                     * 08150000
*       04        The macro was unsuccessful.  The supplied user      * 08200000
*                 user name or ASID was not found.                    * 08250000
*                                                                     * 08300000
*       08        The macro was unsuccessful.  An internal            * 08350000
*                 error occurred attempting to obtain file system     * 08400000
*                 mount data.                                         * 08450000
*                                                                     * 08500000
*       12        The macro was unsuccessful.  The supplied           * 08550000
*                 buffer was not large enough to hold all of the      * 08600000
*                 data that the macro attempted to return.            * 08650000
*                                                                     * 08700000
*       16        The macro was unsuccessful.  The input flags        * 08750000
*                 specified mutually exclusive values.                * 08800000
*                                                                     * 08850000
*       20        The macro was unsuccessful.  The caller does not    * 08900000
*                 have the correct authorization to use this service. * 08950000
*                                                                     * 09000000
*                                                                     * 09050000
*01* REASON CODES:  None.                                             * 09100000
*                                                                     * 09150000
*01* MODULE TYPE:  ASSEM MACRO                                        * 09200000
*                                                                     * 09250000
*02*   PROCESSOR:  ASSEM                                              * 09300000
*                                                                     * 09350000
*01* COMPONENT:  SCPX1                                                * 09400000
*                                                                     * 09450000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 09500000
*                                                                     * 09550000
*01* MACRO USAGE NOTES:                                               * 09600000
*                                                                     * 09650000
*                                                                     * 09700000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 09750000
*        global macro variable.  Any value other than 'NO' will       * 09800000
*        result in the macro expansion being printed.  The default is * 09850000
*        'YES'.  The following examples illustrate how the ZPRINT     * 09900000
*        variable should be set.                                      * 09950000
*                                                                     * 10000000
*                    GBLC &ZPRINT                                     * 10050000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 10100000
*                                                                     * 10150000
*                                                                     * 10200000
*01* CHANGE-ACTIVITY:                                                 * 10250000
*                                                                     * 10300000
*   Flag LineItem  FMID    Date   ID    Comment                       * 10350000
*                                                                     * 10400000
*    $D0=DXDA382  HBB7703 990817 PDQR: Initial release                * 10450000
*    $P0=PXD0662  HBB7703 991104 PDQR: Changed descriptive name       * 10475000
*    $P1=PXD0724  HBB7703 991116 PDQR: Made the macro re-entrant      * 10487500
*                                                                     * 10500000
****** END OF SPECIFICATIONS *****************************************/ 10550000
*/********************************************************************* 10600000
         MACRO                                                          10650000
&XLABEL  BPXEKDA &KBUFPTR=,&KBUFLEN=,&RETCODE=,&KBUFALET=,&MF=          10700000
.*                                                                      10750000
*              MACDATE -08/17/99-<3>                                    10800000
.*                                                                      10850000
.*******************************************************************    10900000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        10950000
.*******************************************************************    11000000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   11050000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     11100000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             11150000
.*                                                                      11200000
              GBLC  &ZBPXEKDA   YES=MACRO USED AT LEAST ONCE            11250000
.*******************************************************************    11300000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          11350000
.*******************************************************************    11400000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 11450000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            11500000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              11550000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             11600000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             11650000
              LCLA  &ZAWRK      USED AS A WORK AREA                     11700000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  11750000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   11800000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 11850000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             11900000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 11950000
              LCLA  &ZMACRET    MACRO RETURN CODE                       12000000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        12050000
.*                                                                      12100000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      12150000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              12200000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   12250000
.********************************************************************   12300000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 12350000
.********************************************************************   12400000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 12450000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          12500000
.*                                                                      12550000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       12600000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        12650000
              SPLEVEL  TEST                                             12700000
.ZSYS2        ANOP  ,                                                   12750000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              12800000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              12850000
              SYSSTATE TEST                                             12900000
              AGO   .ZSYS4                                              12950000
.ZSYS3        ANOP  ,                                                   13000000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 13050000
.ZSYS4        ANOP  ,                                                   13100000
.*******************************************************************    13150000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   13200000
.*******************************************************************    13250000
              LCLC  &XKBUFPTR   ++ NAME                                 13300000
              LCLC  &XKBUFLEN   ++ VALUE                                13350000
              LCLC  &XKBUFALET  ++ VALUE                                13400000
              LCLC  &XRETCODE   ++ NAME                                 13450000
              LCLC  &XMF        ++ VALUE                                13500000
              LCLC  &XMFCTRL    ++ NAME                                 13550000
              LCLC  &XMFATTR    ++ VALUE                                13600000
              LCLC  &XMFSCK     ++ VALUE                                13650000
.*******************************************************************    13700000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           13750000
.*******************************************************************    13800000
              LCLC  &ZXKBUFPTR  ++ OUTPUT NAME                          13850000
              LCLC  &ZXKBUFLEN  ++ INPUT VALUE                          13900000
              LCLC  &ZXKBUFALET ++ INPUT VALUE                          13950000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          14000000
              LCLC  &ZXMF       ++ INPUT VALUE                          14050000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           14100000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          14150000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          14200000
.********************************************************************   14250000
.***AG.MF01 PROCESS MF MACRO FORMS                                      14300000
.********************************************************************   14350000
              ACTR  10000                                               14400000
.*------------------------------------------------------------------    14450000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           14500000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    14550000
.*-------------------------------------------------------------------   14600000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           14650000
.ZG9          ANOP  ,                                                   14700000
&ZTLC         SETC 'S'                                                  14750000
              AIF   ('&MF(1)' NE '&ZTLC').ZG10                          14800000
&XMF          SETC  'S'         SET KEYWORD                             14850000
              AIF   (N'&MF LE 1).ZG9A           CK NUM                  14900000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           14950000
&ZMS          SETC  '&ZMS.&MF"'                                         15000000
&ZMS          SETC  '&ZMS "MF"'                                         15050000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 15100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             15150000
.ZG9A         ANOP  ,                                                   15200000
.*-------------------------------------------------------------------   15250000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           15300000
.ZG10         ANOP  ,                                                   15350000
&ZTLC         SETC 'L'                                                  15400000
              AIF   ('&MF(1)' NE '&ZTLC').ZG17                          15450000
&XMF          SETC  'L'         SET KEYWORD                             15500000
              AIF   (N'&MF LE 3).ZG10A          CK NUM                  15550000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           15600000
&ZMS          SETC  '&ZMS.&MF"'                                         15650000
&ZMS          SETC  '&ZMS "MF"'                                         15700000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                15750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             15800000
.ZG10A        ANOP  ,                                                   15850000
.*-------------------------------------------------------------------   15900000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     15950000
              AIF   (N'&SYSLIST NE 0).ZG10B     POSITIONALS?            16000000
              AIF   ('&KBUFPTR' NE '').ZG10B    KEYS?                   16050000
              AIF   ('&KBUFLEN' NE '').ZG10B    KEYS?                   16100000
              AIF   ('&RETCODE' NE '').ZG10B    KEYS?                   16150000
              AIF   ('&KBUFALET' NE '').ZG10B   KEYS?                   16200000
              AGO    .ZG10C     INVOCATION OKAY                         16250000
.ZG10B        ANOP  ,                                                   16300000
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         16350000
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   16400000
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              16450000
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        16500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             16550000
.ZG10C        ANOP  ,                                                   16600000
.*-------------------------------------------------------------------   16650000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   16700000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           16750000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           16800000
              AIF   (N'&MF(2) GT 1).ZG12B       MULTI PARMS             16850000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           16900000
.ZG12B        AIF   (K'&MF(2) GT 0).ZG12C                               16950000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         17000000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 17050000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 17100000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        17150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             17200000
.ZG12C        ANOP  ,                                                   17250000
.*-------------------------------------------------------------------   17300000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               17350000
              AIF   (K'&ZXMFCTRL LE 0).ZG12P    NOT I/O                 17400000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG12P                      17450000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         17500000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           17550000
&ZMS          SETC  '&ZMS.&MF"'                                         17600000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           17650000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   17700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             17750000
.ZG12P        ANOP  ,                                                   17800000
.*-------------------------------------------------------------------   17850000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      17900000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           17950000
&XMFATTR      SETC  '0D'                                                18000000
              AIF   (K'&MF(3) LE 0).ZG15B       PARM                    18050000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           18100000
              AIF   (N'&MF(3) GT 1).ZG15B       MULTI PARMS             18150000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           18200000
.ZG15B        ANOP  ,                                                   18250000
.*-------------------------------------------------------------------   18300000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  18350000
              AIF   (K'&ZXMFATTR LE 0).ZG15P    NOT I/O                 18400000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG15P                      18450000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         18500000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           18550000
&ZMS          SETC  '&ZMS.&MF"'                                         18600000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           18650000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   18700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18750000
.ZG15P        ANOP  ,                                                   18800000
.*-------------------------------------------------------------------   18850000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 18900000
              AIF   (K'&ZXMFATTR LE 0).ZG15S    NOT I/O                 18950000
              AIF   (K'&XMFATTR LE 60).ZG15S    LNG OK                  19000000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         19050000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           19100000
&ZMS          SETC  '&ZMS.&MF"'                                         19150000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               19200000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  19250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19300000
.ZG15S        ANOP  ,                                                   19350000
.*-------------------------------------------------------------------   19400000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           19450000
.ZG17         ANOP  ,                                                   19500000
&ZTLC         SETC 'E'                                                  19550000
              AIF   ('&MF(1)' NE '&ZTLC').ZG25                          19600000
&XMF          SETC  'E'         SET KEYWORD                             19650000
              AIF   (N'&MF LE 2).ZG17A          CK NUM                  19700000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           19750000
&ZMS          SETC  '&ZMS.&MF"'                                         19800000
&ZMS          SETC  '&ZMS "MF"'                                         19850000
              MNOTE 8,' &ZMS CAN HAVE ONLY 2 ARGUMENTS.'                19900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19950000
.ZG17A        ANOP  ,                                                   20000000
.*-------------------------------------------------------------------   20050000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   20100000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           20150000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           20200000
              AIF   (N'&MF(2) GT 1).ZG19B       MULTI PARMS             20250000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           20300000
.ZG19B        AIF   (K'&MF(2) GT 0).ZG19C                               20350000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         20400000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 20450000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 20500000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        20550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             20600000
.ZG19C        ANOP  ,                                                   20650000
.*-------------------------------------------------------------------   20700000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              20750000
              AIF   (K'&ZXMFCTRL LE 0).ZG19R    NOT I/O                 20800000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG19R                      20850000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          20900000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        20950000
              AIF   (K'&ZCGPR GT 2).ZG19Q                               21000000
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             21050000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       21100000
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        21150000
.ZG19P        ANOP  ,                                                   21200000
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             21250000
              AIF   ('&ZCGPR' LT '2').ZG19Q                             21300000
              AIF   ('&ZCGPR' LE '12').ZG19R                            21350000
.ZG19Q        ANOP  ,                                                   21400000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           21450000
&ZMS          SETC  '&ZMS.&MF"'                                         21500000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           21550000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    21600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             21650000
.ZG19R        ANOP  ,                                                   21700000
.*-------------------------------------------------------------------   21750000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             21800000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             21850000
.*-------------------------------------------------------------------   21900000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             21950000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           22000000
.*------------------------------------------------------------------    22050000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           22100000
.ZG25         ANOP  ,                                                   22150000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           22200000
              AIF   (K'&XMF GT 0).ZG25E         VALID ARG               22250000
              AIF   (T'&MF EQ 'O').ZG25D        OMITTED                 22300000
&ZASYSLNDX    SETA  0                                                   22350000
.ZG25A        ANOP  ,           POSITIONAL MACRO KEY                    22400000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        22450000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C                    22500000
&ZTLC         SETC 'MF'                                                 22550000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG25A           22600000
.ZG25B        ANOP  ,                                                   22650000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         22700000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           22750000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             22800000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    22850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22900000
              AGO   .ZG25E                                              22950000
.ZG25C        ANOP  ,                                                   23000000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         23050000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           23100000
&ZMS          SETC  '&ZMS.&MF"'                                         23150000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           23200000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 23250000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           23300000
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           23350000
              MNOTE 8,' &ZMS OR "E".'                                   23400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23450000
              AGO   .ZG25E                                              23500000
.ZG25D        ANOP  ,                                                   23550000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     23600000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       23650000
.ZG25E        ANOP  ,                                                   23700000
.********************************************************************   23750000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 23800000
.********************************************************************   23850000
              ACTR  10000                                               23900000
.*-------------------------------------------------------------------   23950000
.***AG.MF03 MF=(SLE)                                                    24000000
              AIF   ('&XMF' EQ 'L').ZGMFX                               24050000
.*-------------------------------------------------------------------   24100000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    24150000
              AIF   (N'&KBUFPTR LE 1).ZG2A      CK NUM                  24200000
&ZMS          SETC  '"KBUFPTR='                 *KPOSA* MNOTE           24250000
&ZMS          SETC  '&ZMS.&KBUFPTR"'                                    24300000
&ZMS          SETC  '&ZMS "KBUFPTR"'                                    24350000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 24400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24450000
.ZG2A         ANOP  ,                                                   24500000
.*------------------------------------------------------------------    24550000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        24600000
&ZXKBUFPTR    SETC  'OUTPUT'    SET IN/OUTPUT                           24650000
&XKBUFPTR     SETC  '&KBUFPTR(1)'               SET XVARIABLE           24700000
              AIF   (N'&KBUFPTR GT 1).ZG2B      MULTI PARMS             24750000
&XKBUFPTR     SETC  '&KBUFPTR'  SET XVARIABLE                           24800000
.ZG2B         AIF   (K'&KBUFPTR(1) GT 0).ZG2C                           24850000
&ZXKBUFPTR    SETC  ''          RESET IN/OUTPUT                         24900000
&ZMS          SETC  ' '         *KRQDA*                                 24950000
&ZMS          SETC  '&ZMS "KBUFPTR" KEY AND ITS ARGUMENT'               25000000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             25050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25100000
.ZG2C         ANOP  ,                                                   25150000
.*-------------------------------------------------------------------   25200000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   25250000
              AIF   (K'&ZXKBUFPTR LE 0).ZG2R    NOT I/O                 25300000
              AIF   ('&XKBUFPTR'(1,1) NE '(').ZG2R                      25350000
&ZCGPR        SETC  '&XKBUFPTR'(2,K'&XKBUFPTR-2)                        25400000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         25450000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                25500000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              25550000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       25600000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        25650000
.ZG2P         ANOP  ,                                                   25700000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             25750000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              25800000
              AIF   ('&ZCGPR' LE '12').ZG2R                             25850000
.ZG2Q         ANOP  ,                                                   25900000
&ZMS          SETC  '"KBUFPTR='                 *KGPRA* MNOTE           25950000
&ZMS          SETC  '&ZMS.&KBUFPTR"'                                    26000000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           26050000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    26100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26150000
.ZG2R         ANOP  ,                                                   26200000
.*-------------------------------------------------------------------   26250000
.*** * * * * * NAME, RQD INPUT, KEYS -XVARIABLE KEY                     26300000
              AIF   (N'&KBUFLEN LE 1).DC00A     CK NUM                  26350000
&ZMS          SETC  '"KBUFLEN='                 *KPOSA* MNOTE           26400000
&ZMS          SETC  '&ZMS.&KBUFLEN"'                                    26450000
&ZMS          SETC  '&ZMS "KBUFLEN"'                                    26500000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 26550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26600000
.DC00A        ANOP  ,                                                   26650000
.*--------------------------------------------------------------------  26700000
.*** * * * * * NAME, RQD INPUT, KEYS -XVARIABLE                         26750000
&ZXKBUFLEN    SETC  'INPUT'                     SET IN/OUTPUT           26800000
&XKBUFLEN     SETC  '&KBUFLEN(1)'               SET XVARIABLE           26850000
              AIF   (N'&KBUFLEN GT 1).DC01B     MULTI PARMS             26900000
&XKBUFLEN     SETC  '&KBUFLEN'                  SET XVARIABLE           26950000
.DC01B        AIF   (K'&KBUFLEN(1) GT 0).DC01C                          27000000
&ZXKBUFLEN    SETC  ''                          RESET IN/OUTPUT         27050000
&ZMS          SETC  ' '                                                 27100000
&ZMS          SETC  '&ZMS "KBUFLEN" KEY AND ITS ARGUMENT'               27150000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             27200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27250000
.DC01C        ANOP  ,                                                   27300000
.*--------------------------------------------------------------------  27350000
.*** * * * * NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    27400000
              AIF   (K'&ZXKBUFLEN LE 0).DC02R   NOT I/O                 27450000
              AIF   ('&XKBUFLEN' EQ '0').DC02R                          27500000
              AIF   ('&XKBUFLEN'(1,1) NE '(').DC02R                     27550000
&ZCGPR        SETC  '&XKBUFLEN'(2,K'&XKBUFLEN-2)                        27600000
              AIF   ('&ZCGPR'(1,1) NE '0').DC02P                        27650000
              AIF   (K'&ZCGPR GT 2).DC02Q                               27700000
              AIF   ('&ZCGPR' EQ '0').DC02Q                             27750000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       27800000
              AIF   (T'&ZCGPR NE 'N').DC02Q     INVALID REG NAME        27850000
.DC02P        ANOP  ,                                                   27900000
              AIF   (T'&ZCGPR NE 'N').DC02R     NON NUMERIC             27950000
              AIF   ('&ZCGPR' LT '2').DC02Q                             28000000
              AIF   ('&ZCGPR' LE '12').DC02R                            28050000
.DC02Q        ANOP  ,                                                   28100000
&ZMS          SETC  '"KBUFLEN='                 *KGPRA* MNOTE           28150000
&ZMS          SETC  '&ZMS.&KBUFLEN"'                                    28200000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           28250000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    28300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28350000
.DC02R        ANOP  ,                                                   28400000
.*-------------------------------------------------------------------   28450000
.*** * * * * * NAME, RQD INPUT, KEYS -XVARIABLE KEY                     28500000
              AIF   (N'&KBUFALET LE 1).DC10A    CK NUM                  28550000
&ZMS          SETC  '"KBUFALET='                *KPOSA* MNOTE           28600000
&ZMS          SETC  '&ZMS.&KBUFALET"'                                   28650000
&ZMS          SETC  '&ZMS "KBUFALET"'                                   28700000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 28750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28800000
.DC10A        ANOP  ,                                                   28850000
.*--------------------------------------------------------------------  28900000
.*** * * * * * NAME, RQD INPUT, KEYS -XVARIABLE                         28950000
&ZXKBUFALET   SETC  'INPUT'                     SET IN/OUTPUT           29000000
&XKBUFALET    SETC  '&KBUFALET(1)'              SET XVARIABLE           29050000
              AIF   (N'&KBUFALET GT 1).DC11B    MULTI PARMS             29100000
&XKBUFALET    SETC  '&KBUFALET'                 SET XVARIABLE           29150000
.DC11B        AIF   (K'&KBUFALET(1) GT 0).DC11C                         29200000
&ZXKBUFALET   SETC  ''                          RESET IN/OUTPUT         29250000
&ZMS          SETC  ' '                                                 29300000
&ZMS          SETC  '&ZMS "KBUFALET" KEY AND ITS ARGUMENT'              29350000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             29400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             29450000
.DC11C        ANOP  ,                                                   29500000
.*--------------------------------------------------------------------  29550000
.*** * * * * NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    29600000
              AIF   (K'&ZXKBUFALET LE 0).DC12R  NOT I/O                 29650000
              AIF   ('&XKBUFALET' EQ '0').DC12R                         29700000
              AIF   ('&XKBUFALET'(1,1) NE '(').DC12R                    29750000
&ZCGPR        SETC  '&XKBUFALET'(2,K'&XKBUFALET-2)                      29800000
              AIF   ('&ZCGPR'(1,1) NE '0').DC12P                        29850000
              AIF   (K'&ZCGPR GT 2).DC12Q                               29900000
              AIF   ('&ZCGPR' EQ '0').DC12Q                             29950000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       30000000
              AIF   (T'&ZCGPR NE 'N').DC12Q     INVALID REG NAME        30050000
.DC12P        ANOP  ,                                                   30100000
              AIF   (T'&ZCGPR NE 'N').DC12R     NON NUMERIC             30150000
              AIF   ('&ZCGPR' LT '2').DC12Q                             30200000
              AIF   ('&ZCGPR' LE '12').DC12R                            30250000
.DC12Q        ANOP  ,                                                   30300000
&ZMS          SETC  '"KBUFALET='                *KGPRA* MNOTE           30350000
&ZMS          SETC  '&ZMS.&KBUFALET"'                                   30400000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           30450000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    30500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30550000
.DC12R        ANOP  ,                                                   30600000
.*-------------------------------------------------------------------   30650000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    30700000
              AIF   (N'&RETCODE LE 1).ZG5A      CK NUM                  30750000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           30800000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    30850000
&ZMS          SETC  '&ZMS "RETCODE"'                                    30900000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 30950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             31000000
.ZG5A         ANOP  ,                                                   31050000
.*-------------------------------------------------------------------   31100000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        31150000
              AIF   (K'&RETCODE(1) LE 0).ZG5C   NO PARM                 31200000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              31250000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           31300000
              AIF   (N'&RETCODE GT 1).ZG5C                              31350000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           31400000
.ZG5C         ANOP  ,                                                   31450000
.*-------------------------------------------------------------------   31500000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   31550000
              AIF   (K'&ZXRETCODE LE 0).ZG5R    NOT I/O                 31600000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG5R                      31650000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        31700000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         31750000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                31800000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              31850000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       31900000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        31950000
.ZG5P         ANOP  ,                                                   32000000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             32050000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              32100000
              AIF   ('&ZCGPR' LE '12').ZG5R                             32150000
.ZG5Q         ANOP  ,                                                   32200000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           32250000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    32300000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           32350000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    32400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             32450000
.ZG5R         ANOP  ,                                                   32500000
.******************************************************************     32550000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        32600000
.******************************************************************     32650000
              ACTR  10000                                               32700000
.*-------------------------------------------------------------------   32750000
.***AH.P02 EXTRA POSITIONALS                                            32800000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               32850000
&ZCVAL        SETC  ''          ERROR FIELD                             32900000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       32950000
.ZGLIST2      ANOP  ,                                                   33000000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         33050000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                33100000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   33150000
              AGO   .ZGLIST2                                            33200000
.*                                                                      33250000
.ZGLIST3      ANOP  ,                                                   33300000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             33350000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           33400000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     33450000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              33500000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      33550000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              33600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33650000
.ZGLISTX      ANOP  ,                                                   33700000
&ZASYSLNDX    SETA  0                                                   33750000
.*-------------------------------------------------------------------   33800000
.***AG.MF04 MF=(SLE)                                                    33850000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                33900000
.*******************************************************************    33950000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       34000000
.*******************************************************************    34050000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          34100000
.*******************************************************************    34150000
.***AE.01  START OF BPXEKDA MACRO CODE                                  34200000
.*******************************************************************    34250000
              LCLC  &M0M0001                 NAME                       34300000
&M0M0001      SETC  '&XLABEL'                SET NAME                   34350000
              AIF   (K'&XLABEL NE 0).XLAB2                              34400000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               34450000
.*                                                                      34500000
.XLAB2        ANOP  ,                                                   34550000
              AIF   ('&XMF' NE 'L').XLAB3     NOT MF=L       /* @P1A*/  34575000
&M0M0001      DS    &XMFATTR                  BPXEKDA-0      /* @P1A*/  34600000
.XLAB3        ANOP  ,                                        /* @P1A*/  34625000
.*******************************************************************    34650000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              34700000
.*******************************************************************    34750000
              PUSH  PRINT                                               34800000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          34850000
              PRINT OFF         ++ PR01                                 34900000
              AGO   .ZPRNTXX                                            34950000
.ZPRINTX      PRINT ON                                                  35000000
.ZPRNTXX      ANOP  ,                                                   35050000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  35100000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  35150000
.********************************************************************   35200000
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    35250000
.********************************************************************   35300000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       35350000
                      LCLA  &ZOPN1         INVOCATION INDEX             35400000
                      LCLC  &ZOPL(4095)    LABEL                        35450000
                      LCLC  &ZOPO(4095)    OPERATION                    35500000
                      LCLC  &ZOPV(4095)    VALUE                        35550000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  35600000
.*                                                                      35650000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     35700000
.*-------------------------------------------------------------------   35750000
.***AL.A10 SET ZPLLEN                                                   35800000
&ZPLLEN               SETA 8                                            35850000
.******************************************************************     35900000
.***AL.A05 BPXEKDA FMT=ARG MF=S PARAMETER AREA                          35950000
.******************************************************************     36000000
                      AIF   ('&XMF' NE 'S').ZLMFSX  NOT STANDARD MF     36050000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(2,3).'A'                     36100000
.*                                                                      36150000
&ZOPN                 SETA  &ZOPN+1                                     36200000
&ZOPL(&ZOPN)          SETC  ' '                                         36250000
&ZOPO(&ZOPN)          SETC  'B'                                         36300000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                36350000
&ZOPD(&ZOPN)          SETC  '++ BPXEKDA ARG PARMS'                      36400000
.*                                                                      36450000
&ZOPN                 SETA  &ZOPN+1                                     36900000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL'                                  36950000
&ZOPO(&ZOPN)          SETC  'DS'                                        37000000
&ZOPV(&ZOPN)          SETC  'A'                                         37050000
&ZOPD(&ZOPN)          SETC  '++ START OF BPXEKDA ARG PARMS'  /* @P1C*/  37100000
.*                                                                      37200000
&ZOPN                 SETA  &ZOPN+1                                     37650000
&ZOPL(&ZOPN)          SETC  ' '                                         37700000
&ZOPO(&ZOPN)          SETC  'DS'                                        37750000
&ZOPV(&ZOPN)          SETC  'A'                                         37800000
&ZOPD(&ZOPN)          SETC  ' '                                         37850000
.*                                                                      37950000
&ZOPN                 SETA  &ZOPN+1                                     38400000
&ZOPL(&ZOPN)          SETC  ' '                                         38450000
&ZOPO(&ZOPN)          SETC  'DS'                                        38500000
&ZOPV(&ZOPN)          SETC  'A'                                         38550000
&ZOPD(&ZOPN)          SETC  ' '                                         38600000
.*                                                                      38700000
.*-------------------------------------------------------------------   39900000
.***AL.A07 BPXEKDA FMT=ARG MF=S PARAMETERS                              39950000
&ZOPN                 SETA  &ZOPN+1                                     40000000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                40050000
&ZOPO(&ZOPN)          SETC  'DC'                                        40100000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   40150000
&ZOPD(&ZOPN)          SETC  '++ END OF BPXEKDA ARG PARMS'    /* @P1C*/  40200000
.*                                                                      40250000
.ZLMFSX               ANOP  ,                                           40300000
.******************************************************************     40350000
.***AL.AL01 BPXEKDA FMT=ARG MF=L PARAMETER AREA                         40400000
.******************************************************************     40450000
                      AIF   ('&XMF' NE 'L').ZLMFLX  NOT MF=L            40500000
&ZOPN                 SETA  &ZOPN+1                                     40550000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL'                                  40600000
&ZOPO(&ZOPN)          SETC  'DS'                                        40650000
&ZOPV(&ZOPN)          SETC  '&XMFATTR'                                  40700000
&ZOPD(&ZOPN)          SETC  '++ BPXEKDA ARG PARMS'                      40750000
.*                                                                      40800000
&ZOPN                 SETA  &ZOPN+1                                     40850000
&ZOPL(&ZOPN)          SETC  ' '                              /* @P1C*/  40900000
&ZOPO(&ZOPN)          SETC  'DS'                                        40950000
&ZOPV(&ZOPN)          SETC  'A'                                         41000000
&ZOPD(&ZOPN)          SETC  '++ BUFFER'                      /* @P1C*/  41050000
.*                                                                      41100000
&ZOPN                 SETA  &ZOPN+1                                     41150000
&ZOPL(&ZOPN)          SETC  ' '                              /* @P1C*/  41200000
&ZOPO(&ZOPN)          SETC  'DS'                                        41250000
&ZOPV(&ZOPN)          SETC  'A'                                         41300000
&ZOPD(&ZOPN)          SETC  '++ LENGTH'                      /* @P1C*/  41350000
.*                                                                      41400000
&ZOPN                 SETA  &ZOPN+1                                     41450000
&ZOPL(&ZOPN)          SETC  ' '                              /* @P1C*/  41500000
&ZOPO(&ZOPN)          SETC  'DS'                                        41550000
&ZOPV(&ZOPN)          SETC  'A'                                         41600000
&ZOPD(&ZOPN)          SETC  '++ ALET'                        /* @P1C*/  41650000
.*-------------------------------------------------------------------   41700000
.***AL.AL08 BPXEKDA FMT=ARG MF=L PARAMETER AREA DEFINED                 41750000
                      AGO   .ZMFLX         EXIT, MF=L DONE              41800000
.*                                                                      41850000
.ZLMFLX               ANOP  ,                                           41900000
.********************************************************************   44050000
.***AI.A01 BPXEKDA FMT=ARG FILL IN PARAMETER AREA                       44100000
.********************************************************************   44150000
                      ACTR  10000                                       44200000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               44550000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSTATE PRI     44600000
&ZCVAL                SETC  'LAE'          XAX MODE                     44650000
.ZIMFXA               ANOP ,                                            44700000
.*                                                                      44750000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    44800000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         44850000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 44900000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                44950000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 45000000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                45050000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   45100000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    45150000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   45200000
&ZOPN                 SETA  &ZOPN+1                                     45250000
&ZOPL(&ZOPN)          SETC  ' '                                         45300000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    45350000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              45400000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       45450000
                      AGO   .ZIMFNX                                     45500000
.*                                                                      45550000
.ZIMFN2               ANOP ,                                            45600000
&ZOPN                 SETA  &ZOPN+1                                     45650000
&ZOPL(&ZOPN)          SETC  ' '                                         45700000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    45750000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                45800000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       45850000
.ZIMFNX               ANOP ,                                            45900000
.*-------------------------------------------------------------------   45950000
.***AI.A06 BIND=NAME ADDR XKBUFPTR OUTPUT                               46000000
         AIF   ('&ZXKBUFPTR' EQ '').ZI2G   NOT USED                     46050000
&ZCGPR   SETC  '14'                                                     46100000
         AIF   ('&XKBUFPTR'(1,1) NE '(').ZI2A  NOT IN GPR               46200000
&ZCGPR                SETC  '&XKBUFPTR'(2,K'&XKBUFPTR-2)                46250000
.*                                                                      46500000
&ZOPN                 SETA  &ZOPN+1                                     46600000
&ZOPL(&ZOPN)          SETC  ' '                                         46650000
&ZOPO(&ZOPN)          SETC  'ST'                                        46700000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0(,1)'                   /* @P1C*/  46750000
&ZOPD(&ZOPN)          SETC  '++ STORE Address of Buffer Pointer' @P1C   46800000
.*                                                                      47250000
         AGO   .ZI2G                                                    47300000
.ZI2A                 ANOP  ,                                           47400000
.*                                                                      47450000
&ZOPN                 SETA  &ZOPN+1                                     47500000
&ZOPL(&ZOPN)          SETC  ' '                                         47550000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    47600000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&XKBUFPTR'               /* @P1C*/  47650000
&ZOPD(&ZOPN)          SETC  '++ LOAD BUFFER POINTER address'            47700000
.*                                                                      47750000
&ZOPN                 SETA  &ZOPN+1                                     47800000
&ZOPL(&ZOPN)          SETC  ' '                                         47850000
&ZOPO(&ZOPN)          SETC  'ST'                                        47900000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0(,1)'                              47950000
&ZOPD(&ZOPN)          SETC  '++ STORE Address of Buffer Pointer' @P1C   48000000
.ZI2G                 ANOP  ,                                           48050000
.*-------------------------------------------------------------------   48100000
.*** * * * BIND=NAME ADDR XKBUFLEN A INPUT                              48150000
         AIF   ('&ZXKBUFLEN' EQ '').DC05G  NOT USED                     48200000
&ZCGPR   SETC  '14'                                                     48250000
         AIF   ('&XKBUFLEN'(1,1) NE '(').DC05A NOT IN GPR               48350000
&ZCGPR                SETC  '&XKBUFLEN'(2,K'&XKBUFLEN-2)                48400000
.*                                                                      49900000
&ZOPN                 SETA  &ZOPN+1                                     49950000
&ZOPL(&ZOPN)          SETC  ' '                                         50000000
&ZOPO(&ZOPN)          SETC  'ST'                                        50050000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              50100000
&ZOPD(&ZOPN)          SETC  '++ STORE Address of Buflen pointer'  @P1C  50105800
.*                                                                      50111600
         AGO   .DC05G                                        /* @P1A*/  50117400
.DC05A                ANOP  ,                                /* @P1A*/  50123200
.*                                                                      50129000
&ZOPN                 SETA  &ZOPN+1                          /* @P1A*/  50134800
&ZOPL(&ZOPN)          SETC  ' '                              /* @P1A*/  50140600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                         /* @P1A*/  50146400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&XKBUFLEN'               /* @P1A*/  50152200
&ZOPD(&ZOPN)          SETC  '++ LOAD Buflen pointer address' /* @P1A*/  50158000
.*                                                           /* @P1A*/  50163800
&ZOPN                 SETA  &ZOPN+1                          /* @P1A*/  50169600
&ZOPL(&ZOPN)          SETC  ' '                              /* @P1A*/  50175400
&ZOPO(&ZOPN)          SETC  'ST'                             /* @P1A*/  50181200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                   /* @P1A*/  50187000
&ZOPD(&ZOPN)          SETC  '++ STORE Address of Buflen pointer' @P1A   50192800
.DC05G                ANOP  ,                                           50200000
.*-------------------------------------------------------------------   50250000
.***AI.A06 BIND=NAME ADDR XKBUFALET A INPUT                             50300000
                     AIF   ('&ZXKBUFALET' EQ '').ZI2J                   50350000
&ZCGPR               SETC  '14'                                         50400000
                     AIF   ('&XKBUFALET'(1,1) NE '(').ZI2H  NOT IN GPR  50500000
&ZCGPR               SETC  '&XKBUFALET'(2,K'&XKBUFALET-2)               50550000
.*                                                                      50800000
&ZOPN                 SETA  &ZOPN+1                                     50850000
&ZOPL(&ZOPN)          SETC  ' '                                         50900000
&ZOPO(&ZOPN)          SETC  'ST'                                        50950000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              51000000
&ZOPD(&ZOPN)          SETC  '++ STORE Address of BufAlet pointer' @P1C  51050000
.*                                                                      51100000
                     AGO   .ZI2J                             /* @P1A*/  51150000
.ZI2H                ANOP  ,                                 /* @P1A*/  51200000
.*                                                                      51250000
&ZOPN                SETA  &ZOPN+1                           /* @P1A*/  51300000
&ZOPL(&ZOPN)         SETC  ' '                               /* @P1A*/  51350000
&ZOPO(&ZOPN)         SETC  '&ZCVAL'                          /* @P1A*/  51400000
&ZOPV(&ZOPN)         SETC  '&ZCGPR,&XKBUFALET'               /* @P1A*/  51450000
&ZOPD(&ZOPN)         SETC  '++ LOAD BufAlet Pointer address' /* @P1A*/  51500000
.*                                                                      51550000
&ZOPN                SETA  &ZOPN+1                           /* @P1A*/  51600000
&ZOPL(&ZOPN)         SETC  ' '                               /* @P1A*/  51650000
&ZOPO(&ZOPN)         SETC  'ST'                              /* @P1A*/  51700000
&ZOPV(&ZOPN)         SETC  '&ZCGPR,8(,1)'                    /* @P1A*/  51750000
&ZOPD(&ZOPN)         SETC  '++ STORE Address of BufAlet pointer' @P1A   51800000
.ZI2J                ANOP  ,                                            52350000
.*-------------------------------------------------------------------   52400000
&ZOPN1               SETA &ZOPN                                         52450000
.*******************************************************************    52500000
.***AO.X02  RETURN CODE PROCESSING                                      52550000
.*******************************************************************    52600000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    52650000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            52700000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             52750000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             52800000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               52850000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                52900000
&ZOPN                 SETA  &ZOPN+1                                     52950000
&ZOPL(&ZOPN)          SETC  ' '                                         53000000
&ZOPO(&ZOPN)          SETC  'ST'                                        53050000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              53100000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        53150000
                      AGO   .ZMRETX                                     53200000
.*                                                                      53250000
.ZMRET2               ANOP  ,                                           53300000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                53350000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                53400000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                53450000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  53500000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   53550000
&ZOPN                 SETA  &ZOPN+1                                     53600000
&ZOPL(&ZOPN)          SETC  ' '                                         53650000
&ZOPO(&ZOPN)          SETC  'LR'                                        53700000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 53750000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        53800000
.ZMRETX               ANOP  ,                                           53850000
.*******************************************************************    53900000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   53950000
.*******************************************************************    54000000
.ZMFLX                ANOP  ,              MF=L PROCESSING              54050000
.*******************************************************************    54100000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               54150000
.*******************************************************************    54200000
                      ACTR  10000                                       54250000
.*                                                                      54300000
                      LCLA  &ZLC           COLUMN POSITION              54350000
                      LCLA  &ZOPX          LIST TABLE INDEX             54400000
                      LCLC  &ZLL           LABEL                        54450000
                      LCLC  &ZLOP          OPERATION                    54500000
                      LCLC  &ZLV           VALUE                        54550000
                      LCLC  &ZLD           DESCRIPTION                  54600000
.*                                                                      54650000
&ZOPX                 SETA  1                                           54700000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            54750000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              54800000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              54850000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              54900000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              54950000
                      AIF   (K'&ZLD LE 0).ZL5                           55000000
&ZLC                  SETA  35             COMMENT COLUMN               55050000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    55100000
&ZLC                  SETA  33             COMMMENT COLUMN              55150000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   55200000
&ZLV                  SETC  '&ZLV'.' '                                  55250000
                      AGO   .ZL3                                        55300000
.*                                                                      55350000
.ZL4                  ANOP  ,                                           55400000
&ZLV                  SETC  '&ZLV'.' '                                  55450000
.ZL5                  ANOP  ,                                           55500000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               55550000
.*                                                                      55600000
&ZLL     &ZLOP &ZLV                                                     55650000
.*                                                                      55700000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               55750000
                      AGO   .ZL2           CONTINUE LOOPING             55800000
.*                                                                      55850000
.ZLX                  ANOP  ,                                           55900000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                55950000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  56000000
         L     15,16(0,0)      GET CVT ADDRESS                          56050000
         L     14,140(0,15)    GET ECVT ADDRESS                         56100000
         L     15,240(0,14)    GET OCVT ADDRESS                         56150000
         L     14,8(0,15)      Get OCVE Address                         56200000
         L     15,240(0,14)    Get BPXAMRMF routine address             56250000
         BALR  14,15           BRANCH TO ROUTINE                        56300000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  56350000
.ZLINKX               ANOP  ,                                           56400000
.*******************************************************************    56450000
.***AP.X01  FORMAT GENERATED CODE                                       56500000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            56550000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              56600000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              56650000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              56700000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              56750000
                      AIF   (K'&ZLD LE 0).ZL51                          56800000
&ZLC                  SETA  35             COMMENT COLUMN               56850000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   56900000
&ZLC                  SETA  33             COMMENT COLUMN               56950000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  57000000
&ZLV                  SETC  '&ZLV'.' '                                  57050000
                      AGO   .ZL31                                       57100000
.*                                                                      57150000
.ZL41                 ANOP  ,                                           57200000
&ZLV                  SETC  '&ZLV'.' '                                  57250000
.ZL51                 ANOP  ,                                           57300000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               57350000
.*                                                                      57400000
&ZLL     &ZLOP &ZLV                                                     57450000
.*                                                                      57500000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               57550000
                      AGO   .ZL21          CONTINUE LOOPING             57600000
.*                                                                      57650000
.ZLX1                 ANOP  ,                                           57700000
.*******************************************************************    57750000
.***AP.X02  END OF BPXEKDA MACRO                                        57800000
&ZBPXEKDA             SETC  'YES'          SET BPXEKDA USED             57850000
         POP   PRINT                                                    57900000
*                                            BPXEKDA-0                  57950000
         SPACE 1                                                        58000000
.ZLX2                 ANOP  ,                                           58050000
         MEND                                                           58100000
**********************************************************************/ 58150000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  58200000
*%BPXEKDA: MACRO KEYS(KBUFPTR,KBUFLEN,KBUFALET,RETCODE,MF);             58250000
*  ANS('?'||MACLABEL||' '||'BPXEKDA '||MACLIST||                        58300000
*         ' '||MACKEYS||';') COL(MACLMAR);                              58350000
*%END BPXEKDA;                                                          58400000
