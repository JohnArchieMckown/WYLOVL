*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMMNTFY                              -07/30/96-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Notify of work execution completion           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1993, 1997                     * 00001300
*                                                                     * 00001400
* STATUS= HBB6603                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      The primary purpose of this service is to notify MVS that the  * 00002200
*      execution phase for a work request associated with a           * 00002300
*      monitoring environment has just completed.  This may represent * 00002400
*      the entire work request OR merely a subset of it. An           * 00002500
*      indication is also given as to whether the monitoring          * 00002600
*      environment should be disassociated from the work request or   * 00002700
*      not.  When DISASSOCIATE(YES) is specified, this service will   * 00002800
*      render the information associated with the monitoring          * 00002900
*      environment unpredictable.  To associate a work request with   * 00003000
*      the monitoring environment following use of DISASSOCIATE(YES), * 00003100
*      first use Initialize Mode(Reset) or Relate/Transfer.           * 00003200
*                                                                     * 00003300
*      MVS will use the current time for the completion time, unless  * 00003400
*      the system is in compatibility mode and the caller requested a * 00003500
*      SYSEVENT TRAXRPT for that eventuality, in which case the       * 00003600
*      caller supplies the elapsed time in the SYSEVENT parameter     * 00003700
*      list.                                                          * 00003800
*                                                                     * 00003900
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004000
*                                                                     * 00004100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004200
*                                                                     * 00004300
*01* ENVIRONMENT:                                                     * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*      Dispatchable unit mode: Task or SRB mode.                      * 00004700
*                                                                     * 00004800
*      Minimum authorization: Supervisor state.  PSW key must either  * 00004900
*                        be 0 or match the value supplied on IWMCONN  * 00005000
*                        when a connect token is passed.  PSW key     * 00005100
*                        must either be 0 or match the value supplied * 00005200
*                        on IWMMCREA.  PSW key must be 0-7. See       * 00005300
*                        restrictions below.                          * 00005400
*                                                                     * 00005500
*      AMODE:            31-bit.                                      * 00005600
*                                                                     * 00005700
*      ASC mode:         Primary.                                     * 00005800
*                                                                     * 00005900
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00006000
*                                                                     * 00006100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006200
*                                                                     * 00006300
*      Locks:            LOCAL lock held.                             * 00006400
*                                                                     * 00006500
*      Control parameters: Control parameters must be in the primary  * 00006600
*                        address space.                               * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*01* PROGRAMMING REQUIREMENTS:                                        * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*    1.  The macro CVT must be included to use this macro.            * 00007400
*                                                                     * 00007500
*    2.  The macro IWMYCON must be included to use this macro.        * 00007600
*                                                                     * 00007700
*    3.  The macro IWMPB must be in the library concatenation, since  * 00007800
*        it is included by IWMYCON.                                   * 00007900
*                                                                     * 00008000
*    4.  Note that the high order halfword of register 0, and the     * 00008100
*        reason code variable when specified, may be non-zero and     * 00008200
*        represents diagnostic data which is NOT part of the external * 00008300
*        interface.  The high order halfword should thus be excluded  * 00008400
*        from comparison with the reason code values described above. * 00008500
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00008600
*        be used for this purpose.                                    * 00008700
*                                                                     * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*01* RESTRICTIONS:                                                    * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*    1.  This macro may not be used prior to the completion of WLM    * 00009400
*        address space initialization                                 * 00009500
*                                                                     * 00009600
*    2.  This macro may only be used on MVS/ESA (version 3 or         * 00009700
*        higher), NOT versions 1 or 2 of MVS.                         * 00009800
*                                                                     * 00009900
*    3.  Caller is responsible for error recovery                     * 00010000
*                                                                     * 00010100
*    4.  Though the caller is required to be enabled, this is not     * 00010200
*        checked.  Violation of this restriction may cause disabled   * 00010300
*        program checks which would be the responsibility of the      * 00010400
*        caller's recovery to handle.                                 * 00010500
*                                                                     * 00010600
*    5.  When the invocation requests use of SYSEVENT TRAXFRPT, the   * 00010700
*        restrictions for that service must be satisfied. These are:  * 00010800
*                                                                     * 00010900
*                                                                     * 00011000
*        o   Local lock must be held.                                 * 00011100
*                                                                     * 00011200
*        o   Supervisor state.                                        * 00011300
*                                                                     * 00011400
*        o   PSW key must be 0.                                       * 00011500
*                                                                     * 00011600
*        o   Parameter list must be fully initialized (information    * 00011700
*            will not be copied from the other parameters supplied to * 00011800
*            complete initialization of the SYSEVENT parameter list). * 00011900
*                                                                     * 00012000
*        o   SYSEVENT TRAXFRPT supports disabled callers, in which    * 00012100
*            case the parameter list and save area must be fixed, but * 00012200
*            IWMMNTFY does not support disablement.                   * 00012300
*                                                                     * 00012400
*        o   Provide error recovery.                                  * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*    6.  The monitoring environment must contain the information      * 00012900
*        saved by IWMMINIT, not IWMMRELA                              * 00013000
*                                                                     * 00013100
*    7.  The current PSW key must be 0 or match the key specified on  * 00013200
*        IWMMCREA provided the latter is a system key (0-7).          * 00013300
*                                                                     * 00013400
*    8.  If the key specified on IWMMCREA was a user key (8-F), then  * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*        o   PSW key must be 0                                        * 00013800
*                                                                     * 00013900
*        o   current primary must match the primary at the time that  * 00014000
*            IWMMCREA was invoked.  Calling from a subspace is not    * 00014100
*            supported.                                               * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*    9.  If a connect token is passed to IWMMNTFY, then               * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*        o   The connect token must be enabled for using the WLM Work * 00014900
*            Management services (specifying WORK_MANAGER=YES on      * 00015000
*            IWMCONN).                                                * 00015100
*                                                                     * 00015200
*        o   If the key specified on IWMCONN was a user key (8-F),    * 00015300
*            then                                                     * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*            -   PSW key must be 0                                    * 00015700
*                                                                     * 00015800
*            -   current primary must match the primary at the time   * 00015900
*                that IWMCONN was invoked.  Calling from a subspace   * 00016000
*                is not supported.                                    * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*    10. The caller must serialize to prevent any delay monitoring    * 00016700
*        services from being invoked concurrently for the environment * 00016800
*        represented by the monitoring token                          * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*01* INPUT REGISTER INFORMATION:                                      * 00017300
*                                                                     * 00017400
*    Before issuing the IWMMNTFY macro, the caller must ensure that   * 00017500
*    the following general purpose registers (GPRs) contain the       * 00017600
*    specified information:                                           * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*    REGISTER  CONTENTS                                               * 00018000
*                                                                     * 00018100
*    13        The address of a 72-byte standard save area in the     * 00018200
*              primary address space                                  * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*    Before issuing the IWMMNTFY macro, the caller does not have to   * 00018700
*    place any information into any AR unless using it in register    * 00018800
*    notation for a particular parameter, or using it as a base       * 00018900
*    register.                                                        * 00019000
*                                                                     * 00019100
*01* OUTPUT REGISTER INFORMATION:                                     * 00019200
*                                                                     * 00019300
*    When control returns to the caller, the GPRs contain:            * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*    REGISTER  CONTENTS                                               * 00019700
*                                                                     * 00019800
*    0-1       Used as work registers by the system                   * 00019900
*                                                                     * 00020000
*    2-13      Unchanged                                              * 00020100
*                                                                     * 00020200
*    14-15     Used as work registers by the system.                  * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*    When control returns to the caller, the ARs contain:             * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*    REGISTER  CONTENTS                                               * 00021000
*                                                                     * 00021100
*    0-1       Used as work registers by the system                   * 00021200
*                                                                     * 00021300
*    2-13      Unchanged                                              * 00021400
*                                                                     * 00021500
*    14-15     Used as work registers by the system.                  * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*    Some callers depend on register contents remaining the same      * 00022000
*    before and after issuing a service.  If the system changes the   * 00022100
*    contents of registers on which the caller depends, the caller    * 00022200
*    must save them before issuing the service, and restore them      * 00022300
*    after the system returns control.                                * 00022400
*                                                                     * 00022500
*01* PERFORMANCE IMPLICATIONS:                                        * 00022600
*                                                                     * 00022700
*    None                                                             * 00022800
*                                                                     * 00022900
*01* SYNTAX:                                                          * 00023000
*                                                                     * 00023100
*[xlabel]  IWMMNTFY    TRAXFRPT=YES                                  * 00023200
*                    |     ,SYSEVPL=xsysevpl                          * 00023300
*                     ,TRAXFRPT=NO                                   * 00023400
*                      ,MONTKN=xmontkn                                * 00023500
*                     ,COMPLETION=YES                                * 00023600
*                     ,COMPLETION=NO                                 * 00023700
*                     ,DISASSOCIATE=YES                              * 00023800
*                     ,DISASSOCIATE=NO                               * 00023900
*                     [,CONNTKN=xconntkn|NO_CONNTKN]                * 00024000
*                     [,ENDTIME=xendtime|CURRENT]                   * 00024100
*                     [,RETCODE=xretcode]                             * 00024200
*                     [,RSNCODE=xrsncode]                             * 00024300
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00024400
*                    [,MF=S]                                         * 00024500
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00024600
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*      Where:                                                         * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*      [xlabel]                                                       * 00025300
*          is an optional symbol, starting in column 1, that is the   * 00025400
*          name on the IWMMNTFY macro invocation.  The name must      * 00025500
*          conform to the rules for an ordinary assembler language    * 00025600
*          symbol.                                                    * 00025700
*          DEFAULT: No name.                                          * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*      TRAXFRPT=YES|NO                                              * 00026300
*          is a required keyword input which indicates whether a      * 00026400
*          SYSEVENT TRAXFRPT should be issued when the system is in   * 00026500
*          compatibility mode.                                        * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*          TRAXFRPT=YES                                               * 00026900
*              indicates that a SYSEVENT TRAXFRPT should be issued    * 00027000
*              when the system is in compatibility mode.              * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*              SYSEVPL=xsysevpl                                       * 00027400
*                  is the name (RS-type), or address in register      * 00027500
*                  (2)-(12), of a required 40 character input which   * 00027600
*                  is the fully initialized SYSEVENT parameter list,  * 00027700
*                  as mapped by IHATRBPL.                             * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*          TRAXFRPT=NO                                                * 00028200
*                                                                     * 00028300
*              indicates that no SYSEVENT TRAXFRPT should be issued   * 00028400
*              when the system is in compatibility mode.              * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*      MONTKN=xmontkn                                                 * 00029200
*          is the name (RS-type), or address in register (2)-(12), of * 00029300
*          a required 32 bit input which contains the delay           * 00029400
*          monitoring token                                           * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*      COMPLETION=YES|NO                                            * 00030000
*          is a required keyword input which indicates whether the    * 00030100
*          (or possibly one of several) major execution phase(s)      * 00030200
*          is(are) now complete.                                      * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*          COMPLETION=YES                                             * 00030600
*              indicates that execution for an entire phase of        * 00030700
*              processing has now completed.  Typically Iwmmntfy      * 00030800
*              Completion(Yes) would be issued as a result of the     * 00030900
*              completion of the transaction program for the work     * 00031000
*              request. When a work request is comprised of several   * 00031100
*              (typically cascaded) transaction programs, each would  * 00031200
*              correspond to an invocation of Iwmmntfy                * 00031300
*              Completion(Yes).                                       * 00031400
*                                                                     * 00031500
*              The execution time, as given by the difference between * 00031600
*              the Iwmmntfy ENDTIME value and the Execution start     * 00031700
*              time (established via Iwmminit), will be added to the  * 00031800
*              running total execution time for the service class.    * 00031900
*              There may still be "output" processing left to perform * 00032000
*              for the work request, which time would be accounted    * 00032100
*              for via Iwmrpt.  There may also be operations          * 00032200
*              corresponding to hardening of the database data        * 00032300
*              outside the scope of Notify.                           * 00032400
*                                                                     * 00032500
*          COMPLETION=NO                                              * 00032600
*              indicates that this invocation of Notify does not      * 00032700
*              correspond to the completion of an entire execution    * 00032800
*              segment. Instead this invocation of Notify corresponds * 00032900
*              to the portion of the work request represented by the  * 00033000
*              monitoring environment.  For example, use              * 00033100
*              Completion(No) when this portion of processing behaves * 00033200
*              like a subroutine in the execution phase, which is     * 00033300
*              therefore a subset of the execution time passed in     * 00033400
*              another Notify.                                        * 00033500
*                                                                     * 00033600
*              The execution time, as given by the difference between * 00033700
*              the Iwmmntfy ENDTIME value and the Execution start     * 00033800
*              time (established via Iwmminit), will be treated       * 00033900
*              separately from that passed for Completion(Yes), since * 00034000
*              otherwise there would be double-counting.              * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*      DISASSOCIATE=YES|NO                                          * 00034800
*          is a required keyword input which indicates whether the    * 00034900
*          work request should be disassociated from the monitoring   * 00035000
*          environment or not.                                        * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*          DISASSOCIATE=YES                                           * 00035400
*              indicates that the work request should be              * 00035500
*              disassociated from the monitoring environment.         * 00035600
*                                                                     * 00035700
*          DISASSOCIATE=NO                                            * 00035800
*              indicates that the work request should not be          * 00035900
*              disassociated from the monitoring environment.         * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*      [CONNTKN=xconntkn|NO_CONNTKN]                                * 00036700
*          is the name (RS-type), or address in register (2)-(12), of * 00036800
*          an optional 32 bit input which is returned by IWMCONN.     * 00036900
*          DEFAULT: NO_CONNTKN indicates that no connect token is     * 00037000
*          passed.                                                    * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*      [ENDTIME=xendtime|CURRENT]                                   * 00037600
*          is the name (RS-type), or address in register (2)-(12), of * 00037700
*          an optional 64 bit input which specifies the ending        * 00037800
*          execution time for the transaction in STCK format.         * 00037900
*          DEFAULT: CURRENT indicates that the current time should be * 00038000
*          used.                                                      * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*      [RETCODE=xretcode]                                             * 00038600
*          is the name (RS-type) of an optional fullword output       * 00038700
*          variable, or register (2)-(12), into which the return code * 00038800
*          is to be copied from GPR 15.                               * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*      [RSNCODE=xrsncode]                                             * 00039400
*          is the name (RS-type) of an optional fullword output       * 00039500
*          variable, or register (2)-(12), into which the reason code * 00039600
*          is to be copied from GPR 0.                                * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00040200
*          is an optional byte input decimal value in the "0-0" range * 00040300
*          that specifies the macro version.  PLISTVER is the only    * 00040400
*          key allowed on the list form of MF and determines which    * 00040500
*          parameter list is generated.  Note that MAX may be         * 00040600
*          specified instead of a number, and the parameter list will * 00040700
*          be of the largest size currently supported. This size may  * 00040800
*          grow from release to release (thus possibly affecting the  * 00040900
*          amount of storage needed by your program).  If your        * 00041000
*          program can tolerate this, IBM recommends that you always  * 00041100
*          specify MAX when creating the list form parameter list as  * 00041200
*          that will ensure that the list form parameter list is      * 00041300
*          always long enough to hold whatever parameters might be    * 00041400
*          specified on the execute form.                             * 00041500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00041600
*          default is the lowest version which allows all of the      * 00041700
*          parameters specified on the invocation to be processed.    * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*      [MF=S|L|E]                                                   * 00042300
*          is an optional keyword input which specifies the macro     * 00042400
*          form.                                                      * 00042500
*          DEFAULT: S                                                 * 00042600
*                                                                     * 00042700
*                                                                     * 00042800
*          [MF=S]                                                     * 00042900
*              specifies the standard form of the macro.  The "S"     * 00043000
*              form generates code to put the parameters into an      * 00043100
*              in-line parameter list and invoke the desired service. * 00043200
*              Full checking for required macro keys is done along    * 00043300
*              with supplying defaults for omitted optional           * 00043400
*              parameters.                                            * 00043500
*                                                                     * 00043600
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00043700
*              specifies the list form of the macro.  The "L" form    * 00043800
*              defines an area to be used for the parameter list.     * 00043900
*              Only the PLISTVER key may be specified on the          * 00044000
*              invocation.  All other macro parameters are flagged as * 00044100
*              errors.  If PLISTVER is not specified, the original    * 00044200
*              parameter list definition is used.                     * 00044300
*                                                                     * 00044400
*            ,xmfctrl                                                 * 00044500
*              is a required input.  It is the name of a storage area * 00044600
*              for the parameter list.                                * 00044700
*                                                                     * 00044800
*            ,xmfattr|0D                                            * 00044900
*              is an optional 60 character input string that varies   * 00045000
*              from 1 to 60 characters. Use it to force boundary      * 00045100
*              alignment of the parameter list. Use any value that    * 00045200
*              represents a boundary and is valid on an assembler DS  * 00045300
*              pseudo op.                                             * 00045400
*              DEFAULT: 0D which forces the parameter list to a       * 00045500
*              doubleword boundary.                                   * 00045600
*                                                                     * 00045700
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00045800
*              specifies the execute form of the macro.  The "E" form * 00045900
*              generates code to put the parameters into the          * 00046000
*              parameter list specified by xmfctrl and provides full  * 00046100
*              syntax checking with default setting.                  * 00046200
*                                                                     * 00046300
*            ,xmfctrl                                                 * 00046400
*              is a required input.  It is the name (RS-type), or     * 00046500
*              address in register (1)-(12), of a storage area for    * 00046600
*              the parameter list.                                    * 00046700
*                                                                     * 00046800
*            ,COMPLETE                                              * 00046900
*              is an optional keyword input which specifies the       * 00047000
*              degree of macro parameter syntax checking.             * 00047100
*              DEFAULT: COMPLETE                                      * 00047200
*                                                                     * 00047300
*                                                                     * 00047400
*              COMPLETE                                               * 00047500
*                  Checking for required macro keys is done and       * 00047600
*                  defaults are supplied for omitted optional         * 00047700
*                  parameters.                                        * 00047800
*                                                                     * 00047900
*                                                                     * 00048000
*                                                                     * 00048100
*                                                                     * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*01* ABEND CODES:  None.                                              * 00048600
*                                                                     * 00048700
*01* RETURN CODES:                                                    * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*            0    Name: IwmRetCodeOk                                  * 00049100
*                                                                     * 00049200
*                 Meaning: Successful completion.                     * 00049300
*                                                                     * 00049400
*                 Action: None required.                              * 00049500
*                                                                     * 00049600
*            4    Name: IwmRetCodeWarning                             * 00049700
*                                                                     * 00049800
*                 Meaning: Successful completion, unusual conditions  * 00049900
*                 noted.                                              * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*                 HEX REASON  MEANING/ACTION                          * 00050300
*                 CODE                                                * 00050400
*                                                                     * 00050500
*                 xxxx0401    Name: IwmRsnCodeNoWLM                   * 00050600
*                                                                     * 00050700
*                             Meaning:  System does not support delay * 00050800
*                             monitoring services.  This return code  * 00050900
*                             is only set when the MVS release is     * 00051000
*                             prior to MVS/ESA SP5.1.0.               * 00051100
*                                                                     * 00051200
*                             Action: None required.                  * 00051300
*                                                                     * 00051400
*                 xxxx0404    Name: IwmRsnCodeCompatNoSyseventRqd     * 00051500
*                                                                     * 00051600
*                             Meaning:  System is in compatibility    * 00051700
*                             mode and NO SYSEVENT TRAXFRPT was       * 00051800
*                             requested, hence MVS did not receive    * 00051900
*                             the information.                        * 00052000
*                                                                     * 00052100
*                             Action: None required.                  * 00052200
*                                                                     * 00052300
*                 xxxx0405    Name: IwmRsnCodeGoalNoMonEnv            * 00052400
*                                                                     * 00052500
*                             Meaning:  System is in goal mode but    * 00052600
*                             the input monitoring token indicates no * 00052700
*                             monitoring environment was established, * 00052800
*                             hence MVS did not receive the           * 00052900
*                             information.                            * 00053000
*                                                                     * 00053100
*                             Action: None required.                  * 00053200
*                                                                     * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*            8    Name: IwmRetCodeInvocError                          * 00053600
*                                                                     * 00053700
*                 Meaning: Invalid invocation environment or          * 00053800
*                 parameters.                                         * 00053900
*                                                                     * 00054000
*                                                                     * 00054100
*                 HEX REASON  MEANING/ACTION                          * 00054200
*                 CODE                                                * 00054300
*                                                                     * 00054400
*                 xxxx080C    Name: IwmRsnCodeMonEnvLacksData         * 00054500
*                                                                     * 00054600
*                             Meaning:  Input monitoring environment  * 00054700
*                             does not contain the necessary          * 00054800
*                             information.                            * 00054900
*                                                                     * 00055000
*                             Action: Ensure that the monitoring      * 00055100
*                             environment was established with the    * 00055200
*                             necessary information.                  * 00055300
*                                                                     * 00055400
*                 xxxx080F    Name: IwmRsnCodeNoUserKeyNtfy           * 00055500
*                                                                     * 00055600
*                             Meaning:  User key routine not allowed  * 00055700
*                             to issue Notify.                        * 00055800
*                                                                     * 00055900
*                             Action: Avoid requesting this function  * 00056000
*                             in user key.                            * 00056100
*                                                                     * 00056200
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00056300
*                                                                     * 00056400
*                             Meaning:  Input monitoring environment  * 00056500
*                             does not pass short form validity       * 00056600
*                             checking.                               * 00056700
*                                                                     * 00056800
*                             Action: Check for possible storage      * 00056900
*                             overlay.                                * 00057000
*                                                                     * 00057100
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 00057200
*                                                                     * 00057300
*                             Meaning:  Input connect token does not  * 00057400
*                             pass validity checking.                 * 00057500
*                                                                     * 00057600
*                             Action: Check for possible storage      * 00057700
*                             overlay.                                * 00057800
*                                                                     * 00057900
*                 xxxx082D    Name: IwmRsnCodeExStTimeGTEndTime       * 00058000
*                                                                     * 00058100
*                             Meaning:  Input execution start time    * 00058200
*                             later than end time.                    * 00058300
*                                                                     * 00058400
*                             Action: Check for possible storage      * 00058500
*                             overlay of the parameter list or        * 00058600
*                             variable.                               * 00058700
*                                                                     * 00058800
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 00058900
*                                                                     * 00059000
*                             Meaning:  Caller's space connection is  * 00059100
*                             not enabled for this service.           * 00059200
*                                                                     * 00059300
*                             Action: Avoid requesting this function  * 00059400
*                             under the input connection.  IWMCONN    * 00059500
*                             options must be specified previously to * 00059600
*                             enable this service.                    * 00059700
*                                                                     * 00059800
*                                                                     * 00059900
*                                                                     * 00060000
*            C    Name: IwmRetCodeEnvError                            * 00060100
*                                                                     * 00060200
*                 Meaning: Environmental error.                       * 00060300
*                                                                     * 00060400
*                                                                     * 00060500
*                 HEX REASON  MEANING/ACTION                          * 00060600
*                 CODE                                                * 00060700
*                                                                     * 00060800
*                 xxxx0C02    Name: IwmRsnCodeReportingSusp           * 00060900
*                                                                     * 00061000
*                             Meaning:  SYSEVENT TRAXFRPT invoked,    * 00061100
*                             but reporting is temporarily suspended  * 00061200
*                             for one of the following reasons:       * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*                             o   RMF workload activity reporting is  * 00061600
*                                 not active                          * 00061700
*                                                                     * 00061800
*                             o   There is no installation control    * 00061900
*                                 specification (IEAICSxx parmlib     * 00062000
*                                 member with RPGN specified for some * 00062100
*                                 subsystem other than TSO) in        * 00062200
*                                 effect.  No data reported but a     * 00062300
*                                 later reissue could be successful.  * 00062400
*                                                                     * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*                             Action: Invoke the function when the    * 00062800
*                             conditions are alleviated.              * 00062900
*                                                                     * 00063000
*                 xxxx0C03    Name: IwmRsnCodeSyseventNoWorkElt       * 00063100
*                                                                     * 00063200
*                             Meaning:  SYSEVENT TRAXFRPT invoked,    * 00063300
*                             but no work element was available to    * 00063400
*                             save the input information.             * 00063500
*                                                                     * 00063600
*                             Action: Invoke the function when the    * 00063700
*                             conditions are alleviated.  This        * 00063800
*                             condition may be due to a common        * 00063900
*                             storage shortage condition.             * 00064000
*                                                                     * 00064100
*                 xxxx0C04    Name: IwmRsnCodeNtfyNoWorkElt           * 00064200
*                                                                     * 00064300
*                             Meaning:  Notify routine invoked, but   * 00064400
*                             no work element was available to save   * 00064500
*                             the input information.                  * 00064600
*                                                                     * 00064700
*                             Action: Invoke the function when the    * 00064800
*                             conditions are alleviated.  This        * 00064900
*                             condition may be due to a common        * 00065000
*                             storage shortage condition.             * 00065100
*                                                                     * 00065200
*                 xxxx0C06    Name: IwmRsnCodeNoEndTime               * 00065300
*                                                                     * 00065400
*                             Meaning:  No end time was supplied to   * 00065500
*                             the service and STCK gave a non-zero    * 00065600
*                             condition code.                         * 00065700
*                                                                     * 00065800
*                             Action: No action required.             * 00065900
*                                                                     * 00066000
*                                                                     * 00066100
*                                                                     * 00066200
*                                                                     * 00066300
*                                                                     * 00066400
*                                                                     * 00066500
*01* REASON CODES:                                                    * 00066600
*                                                                     * 00066700
*       A unique reason code will be returned whenever the return     * 00066800
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00066900
*       under their corresponding return code.  Reason code and       * 00067000
*       return code constants are defined within IWMYCON.  Note that  * 00067100
*       the high order halfword of register 0, and the reason code    * 00067200
*       variable when specified, may be non-zero and represents       * 00067300
*       diagnostic data which is NOT part of the external interface.  * 00067400
*       The high order halfword should thus be excluded from          * 00067500
*       comparison with the reason code values described above.  The  * 00067600
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00067700
*       used for this purpose.                                        * 00067800
*                                                                     * 00067900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00068000
*                                                                     * 00068100
*02*   PROCESSOR:  ASSEM                                              * 00068200
*                                                                     * 00068300
*01* COMPONENT:  SCWLM                                                * 00068400
*                                                                     * 00068500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00068600
*                                                                     * 00068700
*01* EXAMPLES:                                                        * 00068800
*                                                                     * 00068900
*01* MACRO USAGE NOTES:                                               * 00069000
*                                                                     * 00069100
*                                                                     * 00069200
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00069300
*        global macro variable.  Any value other than 'NO' will       * 00069400
*        result in the macro expansion being printed.  The default is * 00069500
*        'YES'.  The following examples illustrate how the ZPRINT     * 00069600
*        variable should be set.                                      * 00069700
*                                                                     * 00069800
*                    GBLC &ZPRINT                                     * 00069900
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00070000
*                                                                     * 00070100
*                                                                     * 00070200
*    2.  All   keys   currently   contained  in  the  IWMMNTFY  macro * 00070300
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00070400
*        value of 0 or MAX.                                           * 00070500
*                                                                     * 00070600
*                                                                     * 00070700
*                                                                     * 00070800
*                                                                     * 00070900
*01* CHANGE ACTIVITY:                                                 * 00071000
*                                                                     * 00071100
*   Flag LineItem  FMID    Date   ID    Comment                       * 00071200
*                                                                     * 00071300
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 00071400
*    $L1=WLMP     HBB6603 950313 PDRK:  Added new reason code -       * 00071500
*                                         IwmRsnCodeServiceNotEnabled * 00071600
****** END OF SPECIFICATIONS *****************************************/ 00071700
*/********************************************************************* 00071800
         MACRO                                                          00071900
&XLABEL  IWMMNTFY &TRAXFRPT=,&SYSEVPL=,&MONTKN=,&COMPLETION=,          *00072000
               &DISASSOCIATE=,&CONNTKN=,&ENDTIME=,&RETCODE=,&RSNCODE=, *00072100
               &PLISTVER=,&MF=                                          00072200
.*                                                                      00072300
*                  MACDATE -07/30/96-<0>                                00072400
.*                                                                      00072500
.*******************************************************************    00072600
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00072700
.*******************************************************************    00072800
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00072900
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00073000
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00073100
.*                                                                      00073200
                  GBLC  &ZIWMMNTFY  YES=MACRO USED AT LEAST ONCE        00073300
.*******************************************************************    00073400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00073500
.*******************************************************************    00073600
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00073700
                  LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS        00073800
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00073900
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00074000
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00074100
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00074200
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00074300
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00074400
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00074500
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00074600
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00074700
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00074800
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00074900
.*                                                                      00075000
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00075100
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00075200
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00075300
                  LCLC  &ZENDBASEPL             End of base PL          00075400
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00075500
.*******************************************************************    00075600
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00075700
.*******************************************************************    00075800
                  LCLA  &ZI         INDEX FOR ARRAY                     00075900
                  LCLA  &ZJ         INDEX FOR PARMS                     00076000
                  LCLA  &ZK         INDEX FOR PARSE                     00076100
                  LCLA  &ZLO        LOW RANGE VALUE                     00076200
                  LCLA  &ZHI        HIGH RANGE VALUE                    00076300
                  LCLC  &ZW         WORK AREA FOR PARM                  00076400
.********************************************************************   00076500
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00076600
.********************************************************************   00076700
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00076800
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00076900
.*                                                                      00077000
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00077100
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00077200
                  SPLEVEL  TEST                                         00077300
.ZSYS2            ANOP  ,                                               00077400
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00077500
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00077600
                  SYSSTATE TEST                                         00077700
                  AGO   .ZSYS4                                          00077800
.ZSYS3            ANOP  ,                                               00077900
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00078000
.ZSYS4            ANOP  ,                                               00078100
.*******************************************************************    00078200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00078300
.*******************************************************************    00078400
                  LCLC  &XTRAXFRPT  ++ VALUE                            00078500
                  LCLC  &XSYSEVPL   ++ NAME                             00078600
                  LCLC  &XMONTKN    ++ NAME                             00078700
                  LCLC  &XCOMPLETION            ++ VALUE                00078800
                  LCLC  &XDISASSOCIATE          ++ VALUE                00078900
                  LCLC  &XCONNTKN   ++ NAME                             00079000
                  LCLC  &XENDTIME   ++ NAME                             00079100
                  LCLC  &XRETCODE   ++ NAME                             00079200
                  LCLC  &XRSNCODE   ++ NAME                             00079300
                  LCLA  &XPLISTVER  ++ VALUE                            00079400
                  LCLC  &XMF        ++ VALUE                            00079500
                  LCLC  &XMFCTRL    ++ NAME                             00079600
                  LCLC  &XMFATTR    ++ VALUE                            00079700
                  LCLC  &XMFSCK     ++ VALUE                            00079800
.*******************************************************************    00079900
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00080000
.*******************************************************************    00080100
                  LCLC  &ZXTRAXFRPT             ++ INPUT VALUE          00080200
                  LCLC  &ZXSYSEVPL  ++ INPUT NAME                       00080300
                  LCLC  &ZXMONTKN   ++ INPUT NAME                       00080400
                  LCLC  &ZXCOMPLETION           ++ INPUT VALUE          00080500
                  LCLC  &ZXDISASSOCIATE         ++ INPUT VALUE          00080600
                  LCLC  &ZXCONNTKN  ++ INPUT NAME                       00080700
                  LCLC  &ZXENDTIME  ++ INPUT NAME                       00080800
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00080900
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00081000
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00081100
                  LCLC  &ZXMF       ++ INPUT VALUE                      00081200
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00081300
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00081400
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00081500
.********************************************************************   00081600
.***AC.PLV01  PROCESS PLISTVER                                      *   00081700
.********************************************************************   00081800
&XPLISTVER      SETA  0                                                 00081900
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00082000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00082100
&XPLISTVER      SETA  0                                                 00082200
.ZPLV0          ANOP  ,                                                 00082300
.*                                                                      00082400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00082500
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00082600
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00082700
.*-------------------------------------------------------------------   00082800
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00082900
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00083000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00083100
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00083200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00083300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00083400
                AGO   .ZPVCK2                                           00083500
.ZPVCK3         ANOP  ,                                                 00083600
.*-------------------------------------------------------------------   00083700
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00083800
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00083900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00084000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00084100
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00084200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084300
                AGO   .ZPVCKE                                           00084400
.ZPVCK2         ANOP  ,                                                 00084500
.*-------------------------------------------------------------------   00084600
&ZCVAL          SETC  '&PLISTVER(1)'                                    00084700
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00084800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00084900
                AIF   (&XPLISTVER LT 0).ZPVCK6  TOO LOW                 00085000
                AIF   (&XPLISTVER LE 0).ZPVCKE  NOT HIGH                00085100
.ZPVCK6         ANOP  ,                                                 00085200
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00085300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00085400
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00085500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00085600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00085700
&XPLISTVER      SETA  0                                                 00085800
                AGO   .ZPVCKE                                           00085900
.*-------------------------------------------------------------------   00086000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00086100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00086200
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00086300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00086400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00086500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00086600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00086700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00086800
                AGO   .ZPVCK5                                           00086900
.ZPVCK4         ANOP  ,                                                 00087000
&XPLISTVER      SETA  &PLISTVER(1)                                      00087100
.ZPVCK5         ANOP  ,                                                 00087200
.ZPVCKE         ANOP  ,                                                 00087300
.********************************************************************   00087400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00087500
.********************************************************************   00087600
                  ACTR  10000                                           00087700
.*------------------------------------------------------------------    00087800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087900
&XMF              SETC  ''          INITIALIZE XVARIABLE                00088000
.*-------------------------------------------------------------------   00088100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00088200
.ZG39             ANOP  ,                                               00088300
&ZTLC             SETC 'S'                                              00088400
                  AIF   ('&MF(1)' NE '&ZTLC').ZG40                      00088500
&XMF              SETC  'S'         SET KEYWORD                         00088600
                  AIF   (N'&MF LE 1).ZG39A      CK NUM                  00088700
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00088800
&ZMS              SETC  '&ZMS.&MF"'                                     00088900
&ZMS              SETC  '&ZMS "MF"'                                     00089000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00089100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00089200
.ZG39A            ANOP  ,                                               00089300
.*-------------------------------------------------------------------   00089400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089500
.ZG40             ANOP  ,                                               00089600
&ZTLC             SETC 'L'                                              00089700
                  AIF   ('&MF(1)' NE '&ZTLC').ZG47                      00089800
&XMF              SETC  'L'         SET KEYWORD                         00089900
                  AIF   (N'&MF LE 3).ZG40A      CK NUM                  00090000
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00090100
&ZMS              SETC  '&ZMS.&MF"'                                     00090200
&ZMS              SETC  '&ZMS "MF"'                                     00090300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00090400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00090500
.ZG40A            ANOP  ,                                               00090600
.*-------------------------------------------------------------------   00090700
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00090800
                  AIF   (N'&SYSLIST NE 0).ZG40B  POSITIONALS?           00090900
                  AIF   ('&TRAXFRPT' NE '').ZG40B  KEYS?                00091000
                  AIF   ('&SYSEVPL' NE '').ZG40B  KEYS?                 00091100
                  AIF   ('&MONTKN' NE '').ZG40B  KEYS?                  00091200
                  AIF   ('&COMPLETION' NE '').ZG40B  KEYS?              00091300
                  AIF   ('&DISASSOCIATE' NE '').ZG40B  KEYS?            00091400
                  AIF   ('&CONNTKN' NE '').ZG40B  KEYS?                 00091500
                  AIF   ('&ENDTIME' NE '').ZG40B  KEYS?                 00091600
                  AIF   ('&RETCODE' NE '').ZG40B  KEYS?                 00091700
                  AIF   ('&RSNCODE' NE '').ZG40B  KEYS?                 00091800
                  AGO    .ZG40C     INVOCATION OKAY                     00091900
.ZG40B            ANOP  ,                                               00092000
&ZMS              SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE            00092100
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00092200
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00092300
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00092400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00092500
.ZG40C            ANOP  ,                                               00092600
.*-------------------------------------------------------------------   00092700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00092800
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00092900
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00093000
                  AIF   (N'&MF(2) GT 1).ZG42B   MULTI PARMS             00093100
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00093200
.ZG42B            AIF   (K'&MF(2) GT 0).ZG42C                           00093300
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00093400
&ZMS              SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*                00093500
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00093600
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00093700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00093800
.ZG42C            ANOP  ,                                               00093900
.*-------------------------------------------------------------------   00094000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00094100
                  AIF   (K'&ZXMFCTRL LE 0).ZG42P  NOT I/O               00094200
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG42P                  00094300
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00094400
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00094500
&ZMS              SETC  '&ZMS.&MF"'                                     00094600
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00094700
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00094800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00094900
.ZG42P            ANOP  ,                                               00095000
.*-------------------------------------------------------------------   00095100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00095200
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00095300
&XMFATTR          SETC  '0D'                                            00095400
                  AIF   (K'&MF(3) LE 0).ZG45B   PARM                    00095500
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00095600
                  AIF   (N'&MF(3) GT 1).ZG45B   MULTI PARMS             00095700
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00095800
.ZG45B            ANOP  ,                                               00095900
.*-------------------------------------------------------------------   00096000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00096100
                  AIF   (K'&ZXMFATTR LE 0).ZG45P  NOT I/O               00096200
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG45P                  00096300
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00096400
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00096500
&ZMS              SETC  '&ZMS.&MF"'                                     00096600
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00096700
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00096800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00096900
.ZG45P            ANOP  ,                                               00097000
.*-------------------------------------------------------------------   00097100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00097200
                  AIF   (K'&ZXMFATTR LE 0).ZG45S  NOT I/O               00097300
                  AIF   (K'&XMFATTR LE 60).ZG45S  LNG OK                00097400
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00097500
&ZMS              SETC  '"MF='      *KLNGA* MNOTE                       00097600
&ZMS              SETC  '&ZMS.&MF"'                                     00097700
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00097800
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00097900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00098000
.ZG45S            ANOP  ,                                               00098100
.*-------------------------------------------------------------------   00098200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098300
.ZG47             ANOP  ,                                               00098400
&ZTLC             SETC 'E'                                              00098500
                  AIF   ('&MF(1)' NE '&ZTLC').ZG55                      00098600
&XMF              SETC  'E'         SET KEYWORD                         00098700
                  AIF   (N'&MF LE 3).ZG47A      CK NUM                  00098800
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00098900
&ZMS              SETC  '&ZMS.&MF"'                                     00099000
&ZMS              SETC  '&ZMS "MF"'                                     00099100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00099200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00099300
.ZG47A            ANOP  ,                                               00099400
.*-------------------------------------------------------------------   00099500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00099600
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00099700
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00099800
                  AIF   (N'&MF(2) GT 1).ZG49B   MULTI PARMS             00099900
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00100000
.ZG49B            AIF   (K'&MF(2) GT 0).ZG49C                           00100100
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00100200
&ZMS              SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*                00100300
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00100400
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00100500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00100600
.ZG49C            ANOP  ,                                               00100700
.*-------------------------------------------------------------------   00100800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00100900
                  AIF   (K'&ZXMFCTRL LE 0).ZG49R  NOT I/O               00101000
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG49R                  00101100
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00101200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                    00101300
                  AIF   (K'&ZCGPR GT 2).ZG49Q                           00101400
                  AIF   ('&ZCGPR' EQ '0').ZG49Q                         00101500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00101600
                  AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME       00101700
.ZG49P            ANOP  ,                                               00101800
                  AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC            00101900
                  AIF   ('&ZCGPR' LT '1').ZG49Q                         00102000
                  AIF   ('&ZCGPR' LE '12').ZG49R                        00102100
.ZG49Q            ANOP  ,                                               00102200
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00102300
&ZMS              SETC  '&ZMS.&MF"'                                     00102400
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00102500
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00102600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00102700
.ZG49R            ANOP  ,                                               00102800
.*-------------------------------------------------------------------   00102900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00103000
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00103100
.ZG53A   AIF   ('&MF(3)' NE 'COMPLETE').ZG54A                           00103200
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00103300
.*-------------------------------------------------------------------   00103400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00103500
.ZG54A            AIF   (K'&XMFSCK GT 0).ZG54C  KEYWORD                 00103600
                  AIF   (K'&MF(3) LE 0).ZG54B                           00103700
&ZMS              SETC  '"MF='      *KUKWA* MNOTE                       00103800
&ZMS              SETC  '&ZMS.&MF"'                                     00103900
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00104000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00104100
&ZMS              SETC  '&ZMS "COMPLETE".'      VALID KEYWORD           00104200
                  MNOTE 8,' &ZMS '                                      00104300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00104400
.ZG54B            ANOP  ,                                               00104500
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00104600
.ZG54C            ANOP  ,                                               00104700
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00104800
.*------------------------------------------------------------------    00104900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105000
.ZG55             ANOP  ,                                               00105100
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00105200
                  AIF   (K'&XMF GT 0).ZG55E     VALID ARG               00105300
                  AIF   (T'&MF EQ 'O').ZG55D    OMITTED                 00105400
&ZASYSLNDX        SETA  0                                               00105500
.ZG55A            ANOP  ,           POSITIONAL MACRO KEY                00105600
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00105700
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG55C                00105800
&ZTLC             SETC 'MF'                                             00105900
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG55A       00106000
.ZG55B            ANOP  ,                                               00106100
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00106200
&ZMS              SETC  'THE "MF" KEY'          *KOPTA* MNOTE           00106300
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00106400
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00106500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00106600
                  AGO   .ZG55E                                          00106700
.ZG55C            ANOP  ,                                               00106800
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00106900
&ZMS              SETC  '"MF='      *KUKWA* MNOTE                       00107000
&ZMS              SETC  '&ZMS.&MF"'                                     00107100
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00107200
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00107300
&ZMS              SETC  '&ZMS "S",'             VALID KEYWORD           00107400
&ZMS              SETC  '&ZMS "L",'             VALID KEYWORD           00107500
&ZMS              SETC  '&ZMS OR "E".'          VALID KEYWORD           00107600
                  MNOTE 8,' &ZMS '                                      00107700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00107800
                  AGO   .ZG55E                                          00107900
.ZG55D            ANOP  ,                                               00108000
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00108100
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00108200
.ZG55E            ANOP  ,                                               00108300
.********************************************************************   00108400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00108500
.********************************************************************   00108600
                  ACTR  10000                                           00108700
.*-------------------------------------------------------------------   00108800
.***AG.MF03 MF=(SLE)                                                    00108900
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00109000
.*------------------------------------------------------------------    00109100
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109200
&XTRAXFRPT        SETC  ''          INITIALIZE XVARIABLE                00109300
.*-------------------------------------------------------------------   00109400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109500
.ZG3              ANOP  ,                                               00109600
                  AIF   (K'&TRAXFRPT(1) LE 0).ZG3A                      00109700
&ZTLC             SETC 'YES'                                            00109800
                  AIF   ('&TRAXFRPT(1)' NE '&ZTLC').ZG7                 00109900
&XTRAXFRPT        SETC  'YES'       SET KEYWORD                         00110000
                  AIF   (N'&TRAXFRPT LE 1).ZG3A  CK NUM                 00110100
&ZMS              SETC  '"TRAXFRPT='            *KPOSA* MNOTE           00110200
&ZMS              SETC  '&ZMS.&TRAXFRPT"'                               00110300
&ZMS              SETC  '&ZMS "TRAXFRPT"'                               00110400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00110500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00110600
.ZG3A             ANOP  ,                                               00110700
.*----------------------------------------------------------------***   00110800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00110900
                  AIF   (N'&SYSEVPL LE 1).ZG5A  CK NUM                  00111000
&ZMS              SETC  '"SYSEVPL='             *KPOSA* MNOTE           00111100
&ZMS              SETC  '&ZMS.&SYSEVPL"'                                00111200
&ZMS              SETC  '&ZMS "SYSEVPL"'                                00111300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00111400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00111500
.ZG5A             ANOP  ,                                               00111600
.*-------------------------------------------------------------------   00111700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00111800
&ZXSYSEVPL        SETC  'INPUT'     SET IN/OUTPUT                       00111900
&XSYSEVPL         SETC  '&SYSEVPL(1)'           SET XVARIABLE           00112000
                  AIF   (N'&SYSEVPL GT 1).ZG5B  MULTI PARMS             00112100
&XSYSEVPL         SETC  '&SYSEVPL'  SET XVARIABLE                       00112200
.ZG5B             AIF   (K'&SYSEVPL(1) GT 0).ZG5C                       00112300
&ZXSYSEVPL        SETC  ''          RESET IN/OUTPUT                     00112400
&ZMS              SETC  ' '         *KRQDA*                             00112500
&ZMS              SETC  '&ZMS "SYSEVPL" KEY AND ITS ARGUMENT'           00112600
                  MNOTE 8,' &ZMS ARE REQUIRED.'                         00112700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00112800
.ZG5C             ANOP  ,                                               00112900
.*-------------------------------------------------------------------   00113000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00113100
                  AIF   (K'&ZXSYSEVPL LE 0).ZG5R  NOT I/O               00113200
                  AIF   ('&XSYSEVPL'(1,1) NE '(').ZG5R                  00113300
&ZCGPR            SETC  '&XSYSEVPL'(2,K'&XSYSEVPL-2)                    00113400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                     00113500
                  AIF   (K'&ZCGPR GT 2).ZG5Q                            00113600
                  AIF   ('&ZCGPR' EQ '0').ZG5Q                          00113700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00113800
                  AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME        00113900
.ZG5P             ANOP  ,                                               00114000
                  AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC             00114100
                  AIF   ('&ZCGPR' LT '2').ZG5Q                          00114200
                  AIF   ('&ZCGPR' LE '12').ZG5R                         00114300
.ZG5Q             ANOP  ,                                               00114400
&ZMS              SETC  '"SYSEVPL='             *KGPRA* MNOTE           00114500
&ZMS              SETC  '&ZMS.&SYSEVPL"'                                00114600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00114700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00114800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00114900
.ZG5R             ANOP  ,                                               00115000
.*-------------------------------------------------------------------   00115100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115200
.ZG7              ANOP  ,                                               00115300
&ZTLC             SETC 'NO'                                             00115400
                  AIF   ('&TRAXFRPT(1)' NE '&ZTLC').ZG8                 00115500
&XTRAXFRPT        SETC  'NO'        SET KEYWORD                         00115600
                  AIF   (N'&TRAXFRPT LE 1).ZG7A  CK NUM                 00115700
&ZMS              SETC  '"TRAXFRPT='            *KPOSA* MNOTE           00115800
&ZMS              SETC  '&ZMS.&TRAXFRPT"'                               00115900
&ZMS              SETC  '&ZMS "TRAXFRPT"'                               00116000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00116100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00116200
.ZG7A             ANOP  ,                                               00116300
.*------------------------------------------------------------------    00116400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116500
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00116600
.ZG7A0            AIF   (K'&SYSEVPL LE 0).ZG7A1  OK                     00116700
&ZCVAL            SETC '&ZCVAL SYSEVPL'         INCORRECT KEY USED      00116800
.ZG7A1            AIF   (K'&ZCVAL LE 0).ZG7A2   OK                      00116900
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00117000
&ZMS              SETC  '"TRAXFRPT'             *KMEIA* MNOTE           00117100
&ZMS              SETC  '&ZMS.=&TRAXFRPT"'                              00117200
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00117300
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00117400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00117500
.ZG7A2            ANOP  ,                                               00117600
.*------------------------------------------------------------------    00117700
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117800
.ZG8              ANOP  ,                                               00117900
&ZXTRAXFRPT       SETC  'INPUT'     SET IN/OUTPUT                       00118000
                  AIF   (K'&XTRAXFRPT GT 0).ZG8E  VALID ARG             00118100
                  AIF   (T'&TRAXFRPT EQ 'O').ZG8D  OMITTED              00118200
&ZASYSLNDX        SETA  0                                               00118300
.ZG8A             ANOP  ,           POSITIONAL MACRO KEY                00118400
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00118500
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG8C                 00118600
&ZTLC             SETC 'TRAXFRPT'                                       00118700
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG8A        00118800
.ZG8B             ANOP  ,                                               00118900
&ZXTRAXFRPT       SETC  ''          RESET IN/OUTPUT                     00119000
&ZMS              SETC  'THE "TRAXFRPT" KEY'    *KOPTA* MNOTE           00119100
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00119200
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00119300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00119400
                  AGO   .ZG8E                                           00119500
.ZG8C             ANOP  ,                                               00119600
&ZXTRAXFRPT       SETC  ''          RESET IN/OUTPUT                     00119700
&ZMS              SETC  '"TRAXFRPT='            *KUKWA* MNOTE           00119800
&ZMS              SETC  '&ZMS.&TRAXFRPT"'                               00119900
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00120000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00120100
&ZMS              SETC  '&ZMS "YES"'            VALID KEYWORD           00120200
&ZMS              SETC  '&ZMS OR "NO".'         VALID KEYWORD           00120300
                  MNOTE 8,' &ZMS '                                      00120400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00120500
                  AGO   .ZG8E                                           00120600
.ZG8D             ANOP  ,                                               00120700
&XTRAXFRPT        SETC  'YES'       SET DEFAULT KEYWORD                 00120800
.ZG8E             ANOP  ,                                               00120900
.*------------------------------------------------------------------    00121000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121100
                  AIF   (K'&TRAXFRPT(1) GT 0).ZG8F  PARM                00121200
&XTRAXFRPT        SETC  ''          ENSURE NULL KEYWORD                 00121300
&ZXTRAXFRPT       SETC  ''          RESET IN/OUTPUT                     00121400
&ZMS              SETC  'THE'                                           00121500
&ZMS              SETC  '&ZMS "TRAXFRPT" KEY AND ITS ARGUMENT'          00121600
&ZMS              SETC  '&ZMS ARE REQUIRED.'                            00121700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00121800
&ZMS              SETC  '&ZMS "YES"'            VALID KEYWORD           00121900
&ZMS              SETC  '&ZMS OR "NO".'         VALID KEYWORD           00122000
                  MNOTE 8,' &ZMS '                                      00122100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00122200
.ZG8F             ANOP  ,                                               00122300
.*----------------------------------------------------------------***   00122400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00122500
                  AIF   (N'&MONTKN LE 1).ZG10A  CK NUM                  00122600
&ZMS              SETC  '"MONTKN='  *KPOSA* MNOTE                       00122700
&ZMS              SETC  '&ZMS.&MONTKN"'                                 00122800
&ZMS              SETC  '&ZMS "MONTKN"'                                 00122900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00123000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00123100
.ZG10A            ANOP  ,                                               00123200
.*-------------------------------------------------------------------   00123300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00123400
&ZXMONTKN         SETC  'INPUT'     SET IN/OUTPUT                       00123500
&XMONTKN          SETC  '&MONTKN(1)'            SET XVARIABLE           00123600
                  AIF   (N'&MONTKN GT 1).ZG10B  MULTI PARMS             00123700
&XMONTKN          SETC  '&MONTKN'   SET XVARIABLE                       00123800
.ZG10B            AIF   (K'&MONTKN(1) GT 0).ZG10C                       00123900
&ZXMONTKN         SETC  ''          RESET IN/OUTPUT                     00124000
&ZMS              SETC  ' '         *KRQDA*                             00124100
&ZMS              SETC  '&ZMS "MONTKN" KEY AND ITS ARGUMENT'            00124200
                  MNOTE 8,' &ZMS ARE REQUIRED.'                         00124300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00124400
.ZG10C            ANOP  ,                                               00124500
.*-------------------------------------------------------------------   00124600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00124700
                  AIF   (K'&ZXMONTKN LE 0).ZG10R  NOT I/O               00124800
                  AIF   ('&XMONTKN'(1,1) NE '(').ZG10R                  00124900
&ZCGPR            SETC  '&XMONTKN'(2,K'&XMONTKN-2)                      00125000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                    00125100
                  AIF   (K'&ZCGPR GT 2).ZG10Q                           00125200
                  AIF   ('&ZCGPR' EQ '0').ZG10Q                         00125300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00125400
                  AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME       00125500
.ZG10P            ANOP  ,                                               00125600
                  AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC            00125700
                  AIF   ('&ZCGPR' LT '2').ZG10Q                         00125800
                  AIF   ('&ZCGPR' LE '12').ZG10R                        00125900
.ZG10Q            ANOP  ,                                               00126000
&ZMS              SETC  '"MONTKN='  *KGPRA* MNOTE                       00126100
&ZMS              SETC  '&ZMS.&MONTKN"'                                 00126200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00126300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00126400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00126500
.ZG10R            ANOP  ,                                               00126600
.*------------------------------------------------------------------    00126700
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126800
&XCOMPLETION      SETC  ''          INITIALIZE XVARIABLE                00126900
.*-------------------------------------------------------------------   00127000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127100
.ZG14             ANOP  ,                                               00127200
                  AIF   (K'&COMPLETION(1) LE 0).ZG14A                   00127300
&ZTLC             SETC 'YES'                                            00127400
                  AIF   ('&COMPLETION(1)' NE '&ZTLC').ZG15              00127500
&XCOMPLETION      SETC  'YES'       SET KEYWORD                         00127600
                  AIF   (N'&COMPLETION LE 1).ZG14A  CK NUM              00127700
&ZMS              SETC  '"COMPLETION='          *KPOSA* MNOTE           00127800
&ZMS              SETC  '&ZMS.&COMPLETION"'                             00127900
&ZMS              SETC  '&ZMS "COMPLETION"'                             00128000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00128100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00128200
.ZG14A            ANOP  ,                                               00128300
.*-------------------------------------------------------------------   00128400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128500
.ZG15             ANOP  ,                                               00128600
&ZTLC             SETC 'NO'                                             00128700
                  AIF   ('&COMPLETION(1)' NE '&ZTLC').ZG16              00128800
&XCOMPLETION      SETC  'NO'        SET KEYWORD                         00128900
                  AIF   (N'&COMPLETION LE 1).ZG15A  CK NUM              00129000
&ZMS              SETC  '"COMPLETION='          *KPOSA* MNOTE           00129100
&ZMS              SETC  '&ZMS.&COMPLETION"'                             00129200
&ZMS              SETC  '&ZMS "COMPLETION"'                             00129300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00129400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00129500
.ZG15A            ANOP  ,                                               00129600
.*------------------------------------------------------------------    00129700
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129800
.ZG16             ANOP  ,                                               00129900
&ZXCOMPLETION     SETC  'INPUT'     SET IN/OUTPUT                       00130000
                  AIF   (K'&XCOMPLETION GT 0).ZG16E  VALID ARG          00130100
                  AIF   (T'&COMPLETION EQ 'O').ZG16D  OMITTED           00130200
&ZASYSLNDX        SETA  0                                               00130300
.ZG16A            ANOP  ,           POSITIONAL MACRO KEY                00130400
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00130500
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C                00130600
&ZTLC             SETC 'COMPLETION'                                     00130700
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG16A       00130800
.ZG16B            ANOP  ,                                               00130900
&ZXCOMPLETION     SETC  ''          RESET IN/OUTPUT                     00131000
&ZMS              SETC  'THE "COMPLETION" KEY'  *KOPTA* MNOTE           00131100
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00131200
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00131300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131400
                  AGO   .ZG16E                                          00131500
.ZG16C            ANOP  ,                                               00131600
&ZXCOMPLETION     SETC  ''          RESET IN/OUTPUT                     00131700
&ZMS              SETC  '"COMPLETION='          *KUKWA* MNOTE           00131800
&ZMS              SETC  '&ZMS.&COMPLETION"'                             00131900
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00132000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00132100
&ZMS              SETC  '&ZMS "YES"'            VALID KEYWORD           00132200
&ZMS              SETC  '&ZMS OR "NO".'         VALID KEYWORD           00132300
                  MNOTE 8,' &ZMS '                                      00132400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00132500
                  AGO   .ZG16E                                          00132600
.ZG16D            ANOP  ,                                               00132700
&XCOMPLETION      SETC  'YES'       SET DEFAULT KEYWORD                 00132800
.ZG16E            ANOP  ,                                               00132900
.*------------------------------------------------------------------    00133000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00133100
                  AIF   (K'&COMPLETION(1) GT 0).ZG16F  PARM             00133200
&XCOMPLETION      SETC  ''          ENSURE NULL KEYWORD                 00133300
&ZXCOMPLETION     SETC  ''          RESET IN/OUTPUT                     00133400
&ZMS              SETC  'THE'                                           00133500
&ZMS              SETC  '&ZMS "COMPLETION" KEY AND ITS ARGUMENT'        00133600
&ZMS              SETC  '&ZMS ARE REQUIRED.'                            00133700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00133800
&ZMS              SETC  '&ZMS "YES"'            VALID KEYWORD           00133900
&ZMS              SETC  '&ZMS OR "NO".'         VALID KEYWORD           00134000
                  MNOTE 8,' &ZMS '                                      00134100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00134200
.ZG16F            ANOP  ,                                               00134300
.*------------------------------------------------------------------    00134400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00134500
&XDISASSOCIATE    SETC  ''          INITIALIZE XVARIABLE                00134600
.*-------------------------------------------------------------------   00134700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00134800
.ZG19             ANOP  ,                                               00134900
                  AIF   (K'&DISASSOCIATE(1) LE 0).ZG19A                 00135000
&ZTLC             SETC 'YES'                                            00135100
                  AIF   ('&DISASSOCIATE(1)' NE '&ZTLC').ZG20            00135200
&XDISASSOCIATE    SETC  'YES'       SET KEYWORD                         00135300
                  AIF   (N'&DISASSOCIATE LE 1).ZG19A  CK NUM            00135400
&ZMS              SETC  '"DISASSOCIATE='        *KPOSA* MNOTE           00135500
&ZMS              SETC  '&ZMS.&DISASSOCIATE"'                           00135600
&ZMS              SETC  '&ZMS "DISASSOCIATE"'                           00135700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00135800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00135900
.ZG19A            ANOP  ,                                               00136000
.*-------------------------------------------------------------------   00136100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136200
.ZG20             ANOP  ,                                               00136300
&ZTLC             SETC 'NO'                                             00136400
                  AIF   ('&DISASSOCIATE(1)' NE '&ZTLC').ZG21            00136500
&XDISASSOCIATE    SETC  'NO'        SET KEYWORD                         00136600
                  AIF   (N'&DISASSOCIATE LE 1).ZG20A  CK NUM            00136700
&ZMS              SETC  '"DISASSOCIATE='        *KPOSA* MNOTE           00136800
&ZMS              SETC  '&ZMS.&DISASSOCIATE"'                           00136900
&ZMS              SETC  '&ZMS "DISASSOCIATE"'                           00137000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00137100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00137200
.ZG20A            ANOP  ,                                               00137300
.*------------------------------------------------------------------    00137400
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137500
.ZG21             ANOP  ,                                               00137600
&ZXDISASSOCIATE   SETC  'INPUT'     SET IN/OUTPUT                       00137700
                  AIF   (K'&XDISASSOCIATE GT 0).ZG21E  VALID ARG        00137800
                  AIF   (T'&DISASSOCIATE EQ 'O').ZG21D  OMITTED         00137900
&ZASYSLNDX        SETA  0                                               00138000
.ZG21A            ANOP  ,           POSITIONAL MACRO KEY                00138100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00138200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C                00138300
&ZTLC             SETC 'DISASSOCIATE'                                   00138400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG21A       00138500
.ZG21B            ANOP  ,                                               00138600
&ZXDISASSOCIATE   SETC  ''          RESET IN/OUTPUT                     00138700
&ZMS              SETC  'THE "DISASSOCIATE" KEY'  *KOPTA* MNOTE         00138800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00138900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00139000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00139100
                  AGO   .ZG21E                                          00139200
.ZG21C            ANOP  ,                                               00139300
&ZXDISASSOCIATE   SETC  ''          RESET IN/OUTPUT                     00139400
&ZMS              SETC  '"DISASSOCIATE='        *KUKWA* MNOTE           00139500
&ZMS              SETC  '&ZMS.&DISASSOCIATE"'                           00139600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00139700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00139800
&ZMS              SETC  '&ZMS "YES"'            VALID KEYWORD           00139900
&ZMS              SETC  '&ZMS OR "NO".'         VALID KEYWORD           00140000
                  MNOTE 8,' &ZMS '                                      00140100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00140200
                  AGO   .ZG21E                                          00140300
.ZG21D            ANOP  ,                                               00140400
&XDISASSOCIATE    SETC  'YES'       SET DEFAULT KEYWORD                 00140500
.ZG21E            ANOP  ,                                               00140600
.*------------------------------------------------------------------    00140700
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140800
                  AIF   (K'&DISASSOCIATE(1) GT 0).ZG21F  PARM           00140900
&XDISASSOCIATE    SETC  ''          ENSURE NULL KEYWORD                 00141000
&ZXDISASSOCIATE   SETC  ''          RESET IN/OUTPUT                     00141100
&ZMS              SETC  'THE'                                           00141200
&ZMS              SETC  '&ZMS "DISASSOCIATE" KEY AND ITS ARGUMENT'      00141300
&ZMS              SETC  '&ZMS ARE REQUIRED.'                            00141400
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00141500
&ZMS              SETC  '&ZMS "YES"'            VALID KEYWORD           00141600
&ZMS              SETC  '&ZMS OR "NO".'         VALID KEYWORD           00141700
                  MNOTE 8,' &ZMS '                                      00141800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00141900
.ZG21F            ANOP  ,                                               00142000
.*----------------------------------------------------------------***   00142100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00142200
                  AIF   (N'&CONNTKN LE 1).ZG23A  CK NUM                 00142300
&ZMS              SETC  '"CONNTKN='             *KPOSA* MNOTE           00142400
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00142500
&ZMS              SETC  '&ZMS "CONNTKN"'                                00142600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00142700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00142800
.ZG23A            ANOP  ,                                               00142900
.*-------------------------------------------------------------------   00143000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00143100
&ZXCONNTKN        SETC  'INPUT'     SET IN/OUTPUT                       00143200
&XCONNTKN         SETC  'NO_CONNTKN'                                    00143300
                  AIF   (K'&CONNTKN(1) LE 0).ZG23B  PARM                00143400
&XCONNTKN         SETC  '&CONNTKN(1)'           SET XVARIABLE           00143500
                  AIF   (N'&CONNTKN GT 1).ZG23B  MULTI PARMS            00143600
&XCONNTKN         SETC  '&CONNTKN'  SET XVARIABLE                       00143700
.ZG23B            ANOP  ,                                               00143800
.*-------------------------------------------------------------------   00143900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00144000
                  AIF   (K'&ZXCONNTKN LE 0).ZG23R  NOT I/O              00144100
                  AIF   ('&XCONNTKN' EQ 'NO_CONNTKN').ZG23R             00144200
                  AIF   ('&XCONNTKN'(1,1) NE '(').ZG23R                 00144300
&ZCGPR            SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                    00144400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                    00144500
                  AIF   (K'&ZCGPR GT 2).ZG23Q                           00144600
                  AIF   ('&ZCGPR' EQ '0').ZG23Q                         00144700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00144800
                  AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME       00144900
.ZG23P            ANOP  ,                                               00145000
                  AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC            00145100
                  AIF   ('&ZCGPR' LT '2').ZG23Q                         00145200
                  AIF   ('&ZCGPR' LE '12').ZG23R                        00145300
.ZG23Q            ANOP  ,                                               00145400
&ZMS              SETC  '"CONNTKN='             *KGPRA* MNOTE           00145500
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00145600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00145700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00145800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00145900
.ZG23R            ANOP  ,                                               00146000
.*----------------------------------------------------------------***   00146100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00146200
                  AIF   (N'&ENDTIME LE 1).ZG26A  CK NUM                 00146300
&ZMS              SETC  '"ENDTIME='             *KPOSA* MNOTE           00146400
&ZMS              SETC  '&ZMS.&ENDTIME"'                                00146500
&ZMS              SETC  '&ZMS "ENDTIME"'                                00146600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00146700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00146800
.ZG26A            ANOP  ,                                               00146900
.*-------------------------------------------------------------------   00147000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00147100
&ZXENDTIME        SETC  'INPUT'     SET IN/OUTPUT                       00147200
&XENDTIME         SETC  'CURRENT'                                       00147300
                  AIF   (K'&ENDTIME(1) LE 0).ZG26B  PARM                00147400
&XENDTIME         SETC  '&ENDTIME(1)'           SET XVARIABLE           00147500
                  AIF   (N'&ENDTIME GT 1).ZG26B  MULTI PARMS            00147600
&XENDTIME         SETC  '&ENDTIME'  SET XVARIABLE                       00147700
.ZG26B            ANOP  ,                                               00147800
.*-------------------------------------------------------------------   00147900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00148000
                  AIF   (K'&ZXENDTIME LE 0).ZG26R  NOT I/O              00148100
                  AIF   ('&XENDTIME' EQ 'CURRENT').ZG26R                00148200
                  AIF   ('&XENDTIME'(1,1) NE '(').ZG26R                 00148300
&ZCGPR            SETC  '&XENDTIME'(2,K'&XENDTIME-2)                    00148400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                    00148500
                  AIF   (K'&ZCGPR GT 2).ZG26Q                           00148600
                  AIF   ('&ZCGPR' EQ '0').ZG26Q                         00148700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00148800
                  AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME       00148900
.ZG26P            ANOP  ,                                               00149000
                  AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC            00149100
                  AIF   ('&ZCGPR' LT '2').ZG26Q                         00149200
                  AIF   ('&ZCGPR' LE '12').ZG26R                        00149300
.ZG26Q            ANOP  ,                                               00149400
&ZMS              SETC  '"ENDTIME='             *KGPRA* MNOTE           00149500
&ZMS              SETC  '&ZMS.&ENDTIME"'                                00149600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00149700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00149800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00149900
.ZG26R            ANOP  ,                                               00150000
.*----------------------------------------------------------------***   00150100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00150200
                  AIF   (N'&RETCODE LE 1).ZG29A  CK NUM                 00150300
&ZMS              SETC  '"RETCODE='             *KPOSA* MNOTE           00150400
&ZMS              SETC  '&ZMS.&RETCODE"'                                00150500
&ZMS              SETC  '&ZMS "RETCODE"'                                00150600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00150700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00150800
.ZG29A            ANOP  ,                                               00150900
.*-------------------------------------------------------------------   00151000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00151100
                  AIF   (K'&RETCODE(1) LE 0).ZG29C  NO PARM             00151200
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00151300
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00151400
                  AIF   (N'&RETCODE GT 1).ZG29C                         00151500
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00151600
.ZG29C            ANOP  ,                                               00151700
.*-------------------------------------------------------------------   00151800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00151900
                  AIF   (K'&ZXRETCODE LE 0).ZG29R  NOT I/O              00152000
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG29R                 00152100
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00152200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                    00152300
                  AIF   (K'&ZCGPR GT 2).ZG29Q                           00152400
                  AIF   ('&ZCGPR' EQ '0').ZG29Q                         00152500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00152600
                  AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME       00152700
.ZG29P            ANOP  ,                                               00152800
                  AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC            00152900
                  AIF   ('&ZCGPR' LT '2').ZG29Q                         00153000
                  AIF   ('&ZCGPR' LE '12').ZG29R                        00153100
.ZG29Q            ANOP  ,                                               00153200
&ZMS              SETC  '"RETCODE='             *KGPRA* MNOTE           00153300
&ZMS              SETC  '&ZMS.&RETCODE"'                                00153400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00153500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00153600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00153700
.ZG29R            ANOP  ,                                               00153800
.*----------------------------------------------------------------***   00153900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00154000
                  AIF   (N'&RSNCODE LE 1).ZG32A  CK NUM                 00154100
&ZMS              SETC  '"RSNCODE='             *KPOSA* MNOTE           00154200
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00154300
&ZMS              SETC  '&ZMS "RSNCODE"'                                00154400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00154500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00154600
.ZG32A            ANOP  ,                                               00154700
.*-------------------------------------------------------------------   00154800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00154900
                  AIF   (K'&RSNCODE(1) LE 0).ZG32C  NO PARM             00155000
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00155100
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00155200
                  AIF   (N'&RSNCODE GT 1).ZG32C                         00155300
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00155400
.ZG32C            ANOP  ,                                               00155500
.*-------------------------------------------------------------------   00155600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00155700
                  AIF   (K'&ZXRSNCODE LE 0).ZG32R  NOT I/O              00155800
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG32R                 00155900
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00156000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                    00156100
                  AIF   (K'&ZCGPR GT 2).ZG32Q                           00156200
                  AIF   ('&ZCGPR' EQ '0').ZG32Q                         00156300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00156400
                  AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME       00156500
.ZG32P            ANOP  ,                                               00156600
                  AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC            00156700
                  AIF   ('&ZCGPR' LT '2').ZG32Q                         00156800
                  AIF   ('&ZCGPR' LE '12').ZG32R                        00156900
.ZG32Q            ANOP  ,                                               00157000
&ZMS              SETC  '"RSNCODE='             *KGPRA* MNOTE           00157100
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00157200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00157300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00157400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00157500
.ZG32R            ANOP  ,                                               00157600
.******************************************************************     00157700
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00157800
.******************************************************************     00157900
                  ACTR  10000                                           00158000
.*----------------------------------------------------------------***   00158100
.***AH.P02 EXTRA POSITIONALS                                            00158200
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00158300
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00158400
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00158500
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00158600
.ZGLISTX1         ANOP  ,                                               00158700
&ZCVAL            SETC  ''          ERROR FIELD                         00158800
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00158900
.ZGLIST2          ANOP  ,                                               00159000
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00159100
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00159200
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00159300
                  AGO   .ZGLIST2                                        00159400
.*                                                                      00159500
.ZGLIST3          ANOP  ,                                               00159600
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00159700
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE        00159800
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00159900
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00160000
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00160100
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00160200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00160300
.ZGLISTX          ANOP  ,                                               00160400
&ZASYSLNDX        SETA  0                                               00160500
.*-------------------------------------------------------------------   00160600
.***AG.MF04 MF=(SLE)                                                    00160700
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00160800
.*******************************************************************    00160900
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00161000
.*******************************************************************    00161100
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00161200
.*******************************************************************    00161300
.***AE.01  START OF IWMMNTFY MACRO CODE                                 00161400
.*******************************************************************    00161500
                  LCLC  &M0M0001                 NAME                   00161600
&M0M0001          SETC  '&XLABEL'                SET NAME               00161700
                  AIF   (K'&XLABEL NE 0).XLAB2                          00161800
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00161900
.*                                                                      00162000
.XLAB2            ANOP  ,                                               00162100
                  AIF   ('&XMF' EQ 'L').XLAB3                           00162200
&M0M0001 DS    0H                             IWMMNTFY-0                00162300
.XLAB3            ANOP  ,                                               00162400
.*******************************************************************    00162500
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00162600
.*******************************************************************    00162700
              PUSH  PRINT                                               00162800
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00162900
                  PRINT OFF         ++ PR01                             00163000
                  AGO   .ZPRNTXX                                        00163100
.ZPRINTX          PRINT ON                                              00163200
.ZPRNTXX          ANOP  ,                                               00163300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00163400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00163500
.********************************************************************   00163600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00163700
.********************************************************************   00163800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00163900
                      LCLA  &ZOPN1         INVOCATION INDEX             00164000
                      LCLC  &ZOPL(4095)    LABEL                        00164100
                      LCLC  &ZOPO(4095)    OPERATION                    00164200
                      LCLC  &ZOPV(4095)    VALUE                        00164300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00164400
.*                                                                      00164500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00164600
.******************************************************************     00164700
.***AL.L10 IWMMNTFY FMT=LIST MF=S|L PARAMETERS                          00164800
.******************************************************************     00164900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00165000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00165100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00165200
&XMFATTR              SETC  '0D'                                        00165300
.*                                                                      00165400
&ZOPN                 SETA  &ZOPN+1                                     00165500
&ZOPL(&ZOPN)          SETC  ' '                                         00165600
&ZOPO(&ZOPN)          SETC  'B'                                         00165700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00165800
&ZOPD(&ZOPN)          SETC  '++ IWMMNTFY ARG PARMS'                     00165900
.*                                                                      00166000
&ZOPN                 SETA  &ZOPN+1                                     00166100
&ZOPL(&ZOPN)          SETC  ' '                                         00166200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00166300
&ZOPV(&ZOPN)          SETC  '1'                                         00166400
&ZOPD(&ZOPN)          SETC  ' '                                         00166500
.*                                                                      00166600
.ZLMFSL2              ANOP  ,                                           00166700
.*-------------------------------------------------------------------   00166800
.***AM.L00  IWMMNTFY FMT=LIST name                                      00166900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00167000
&ZOPN                 SETA &ZOPN+1                                      00167100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00167200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00167300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00167400
&ZOPD(&ZOPN)          SETC '++ IWMMNTFY NAME'                           00167500
.ZLMFSL2M             ANOP  ,                                           00167600
.*-------------------------------------------------------------------   00167700
.***AM.L01  IWMMNTFY FMT=LIST PARAMETERS                                00167800
&ZOPN                 SETA &ZOPN+1                                      00167900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00168000
&ZOPO(&ZOPN)          SETC 'DS'                                         00168100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00168200
&ZOPD(&ZOPN)          SETC '++ IWMMNTFY PARM LIST'                      00168300
.*-------------------------------------------------------------------   00168400
.***AM.L02 XVERSION XL1                                                 00168500
&ZOPN                 SETA &ZOPN+1                                      00168600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00168700
&ZOPO(&ZOPN)          SETC 'DS'                                         00168800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00168900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00169000
.*-------------------------------------------------------------------   00169100
.***AM.L03 XNOTIFY_OPTIONS BL.16                                        00169200
&ZOPN                 SETA &ZOPN+1                                      00169300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNOTIFY_OPTIONS'                  00169400
&ZOPO(&ZOPN)          SETC 'DS'                                         00169500
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00169600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00169700
.*                                                                      00169800
&ZOPN                 SETA  &ZOPN+1                                     00169900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTRAXFRPT_YES'                   00170000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00170100
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00170200
&ZOPD(&ZOPN)          SETC  '++ XTRAXFRPT.'                             00170300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00170400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00170500
.*                                                                      00170600
&ZOPN                 SETA  &ZOPN+1                                     00170700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCOMPLETION_YES'                 00170800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00170900
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00171000
&ZOPD(&ZOPN)          SETC  '++ XCOMPLETION.'                           00171100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00171200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00171300
.*                                                                      00171400
&ZOPN                 SETA  &ZOPN+1                                     00171500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDISASSOCIATE_YES'               00171600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00171700
&ZOPV(&ZOPN)          SETC  'B''0010000000000000'''                     00171800
&ZOPD(&ZOPN)          SETC  '++ XDISASSOCIATE.'                         00171900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00172000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00172100
.*-------------------------------------------------------------------   00172200
.***AM.L09  XRSV0003 CL1                                                00172300
&ZOPN                 SETA &ZOPN+1                                      00172400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00172500
&ZOPO(&ZOPN)          SETC 'DS'                                         00172600
&ZOPV(&ZOPN)          SETC 'CL1'                                        00172700
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0003'                      00172800
.*-------------------------------------------------------------------   00172900
.***AM.L09 ADDR XSYSEVPL A                                              00173000
&ZOPN                 SETA &ZOPN+1                                      00173100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSEVPL_ADDR'                    00173200
&ZOPO(&ZOPN)          SETC 'DS'                                         00173300
&ZOPV(&ZOPN)          SETC 'A'                                          00173400
&ZOPD(&ZOPN)          SETC '++ &ZXSYSEVPL ADDR XSYSEVPL'                00173500
.*-------------------------------------------------------------------   00173600
.***AM.L09  XCONNTKN BL.32                                              00173700
&ZOPN                 SETA &ZOPN+1                                      00173800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00173900
&ZOPO(&ZOPN)          SETC 'DS'                                         00174000
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00174100
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN  XCONNTKN'                    00174200
.*-------------------------------------------------------------------   00174300
.***AM.L09  XMONTKN BL.32                                               00174400
&ZOPN                 SETA &ZOPN+1                                      00174500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00174600
&ZOPO(&ZOPN)          SETC 'DS'                                         00174700
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00174800
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN  XMONTKN'                      00174900
.*-------------------------------------------------------------------   00175000
.***AM.L09  XENDTIME BL.64                                              00175100
&ZOPN                 SETA &ZOPN+1                                      00175200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XENDTIME'                         00175300
&ZOPO(&ZOPN)          SETC 'DS'                                         00175400
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00175500
&ZOPD(&ZOPN)          SETC '++ &ZXENDTIME  XENDTIME'                    00175600
.*-------------------------------------------------------------------   00175700
.***AM.L09  XRSVD0024 CL4                                               00175800
&ZOPN                 SETA &ZOPN+1                                      00175900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVD0024'                        00176000
&ZOPO(&ZOPN)          SETC 'DS'                                         00176100
&ZOPV(&ZOPN)          SETC 'CL4'                                        00176200
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSVD0024'                     00176300
.*-------------------------------------------------------------------   00176400
.***AM.L09  XRSVD0028 CL4                                               00176500
&ZOPN                 SETA &ZOPN+1                                      00176600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVD0028'                        00176700
&ZOPO(&ZOPN)          SETC 'DS'                                         00176800
&ZOPV(&ZOPN)          SETC 'CL4'                                        00176900
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSVD0028'                     00177000
.*-------------------------------------------------------------------   00177100
.***AM.L09  XRSVD002C CL4                                               00177200
&ZOPN                 SETA &ZOPN+1                                      00177300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVD002C'                        00177400
&ZOPO(&ZOPN)          SETC 'DS'                                         00177500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00177600
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSVD002C'                     00177700
.*-------------------------------------------------------------------   00177800
.***AM.L10 END OF IWMMNTFY LIST PARAMETERS                              00177900
&ZOPN                 SETA &ZOPN+1                                      00178000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00178100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00178200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00178300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00178400
.*                                                                      00178500
&ZOPN                 SETA &ZOPN+1                                      00178600
&ZOPL(&ZOPN)          SETC ' '                                          00178700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00178800
&ZOPV(&ZOPN)          SETC '1'                                          00178900
&ZOPD(&ZOPN)          SETC ' '                                          00179000
.*-------------------------------------------------------------------   00179100
.***AL.L12 IWMMNTFY FMT=LIST MF=S|L PARAMETERS                          00179200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00179300
.*                                                                      00179400
&ZOPN                 SETA  &ZOPN+1                                     00179500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00179600
&ZOPO(&ZOPN)          SETC  'DC'                                        00179700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00179800
&ZOPD(&ZOPN)          SETC  '++ IWMMNTFY ARG PARMS'                     00179900
.*                                                                      00180000
.ZLMFSLX              ANOP  ,                                           00180100
.*-------------------------------------------------------------------   00180200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00180300
&ZPLLEN               SETA 36                                           00180400
.*                                                                      00180500
.******************************************************************     00180600
.***AI.L01 IWMMNTFY FMT=LIST FILL IN PARAMETER AREA                     00180700
.******************************************************************     00180800
                      ACTR  10000                                       00180900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00181000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00181100
&ZCVAL                SETC  'LAE'          XAX MODE                     00181200
.ZIMFXA               ANOP ,                                            00181300
.*                                                                      00181400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00181500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00181600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00181700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00181800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00181900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00182000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00182100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00182200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00182300
&ZOPN                 SETA  &ZOPN+1                                     00182400
&ZOPL(&ZOPN)          SETC  ' '                                         00182500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00182600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00182700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00182800
                      AGO   .ZIMFNX                                     00182900
.*                                                                      00183000
.ZIMFN2               ANOP ,                                            00183100
&ZOPN                 SETA  &ZOPN+1                                     00183200
&ZOPL(&ZOPN)          SETC  ' '                                         00183300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00183400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00183500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00183600
.ZIMFNX               ANOP ,                                            00183700
.********************************************************************   00183800
.***AI.L02 IWMMNTFY FMT=LIST INITIALIZE PARAMETER AREA                  00183900
.********************************************************************   00184000
.***AI.L03 MF=(SLE)                                                     00184100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00184200
.*                                                                      00184300
&ZOPN                 SETA  &ZOPN+1                                     00184400
&ZOPL(&ZOPN)          SETC  ' '                                         00184500
&ZOPO(&ZOPN)          SETC  'XC'                                        00184600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00184700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00184800
.ZIMFLX               ANOP  ,                                           00184900
.*-------------------------------------------------------------------   00185000
.***AI.L05 XNOTIFY_OPTIONS BL2                                          00185100
&ZW                   SETC  ''                                          00185200
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00185300
.*-------------------------------------------------------------------   00185400
.***AI.L08 XNOTIFY_OPTIONS "YES"                                        00185500
.***      BL2'1XXXXXXXXXXXXXXX'                                         00185600
         AIF   ('&XTRAXFRPT' NE 'YES').ZI3A                             00185700
&ZW                   SETC  '&ZW.1'                                     00185800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00185900
                      AGO   .ZI3C                                       00186000
.*                                                                      00186100
.ZI3A                 ANOP  ,                                           00186200
&ZW                   SETC  '&ZW.0'                                     00186300
.ZI3C                 ANOP  ,                                           00186400
.*-------------------------------------------------------------------   00186500
.***AI.L08 XNOTIFY_OPTIONS "YES"                                        00186600
.***      BL2'X1XXXXXXXXXXXXXX'                                         00186700
         AIF   ('&XCOMPLETION' NE 'YES').ZI4A                           00186800
&ZW                   SETC  '&ZW.1'                                     00186900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00187000
                      AGO   .ZI4C                                       00187100
.*                                                                      00187200
.ZI4A                 ANOP  ,                                           00187300
&ZW                   SETC  '&ZW.0'                                     00187400
.ZI4C                 ANOP  ,                                           00187500
.*-------------------------------------------------------------------   00187600
.***AI.L08 XNOTIFY_OPTIONS "YES"                                        00187700
.***      BL2'XX1XXXXXXXXXXXXX'                                         00187800
         AIF   ('&XDISASSOCIATE' NE 'YES').ZI5A                         00187900
&ZW                   SETC  '&ZW.10000000000000'                        00188000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00188100
                      AGO   .ZI5C                                       00188200
.*                                                                      00188300
.ZI5A                 ANOP  ,                                           00188400
&ZW                   SETC  '&ZW.00000000000000'                        00188500
.ZI5C                 ANOP  ,                                           00188600
.*-------------------------------------------------------------------   00188700
.***AI.L10 XNOTIFY_OPTIONS BL2                                          00188800
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00188900
&ZOPN                 SETA  &ZOPN+1                                     00189000
&ZOPL(&ZOPN)          SETC  ' '                                         00189100
&ZOPO(&ZOPN)          SETC  'OC'                                        00189200
&ZOPV(&ZOPN)          SETC  '1(2,1),=BL2''&ZW'''                        00189300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00189400
.ZI5E                 ANOP  ,                                           00189500
.*-------------------------------------------------------------------   00189600
.***AI.L19 ADDR XSYSEVPL A                                              00189700
                      AIF   ('&ZXSYSEVPL' EQ '').ZI7H                   00189800
&ZCLNG                SETC  '&XSYSEVPL'                                 00189900
&ZCGPR                SETC  '14'                                        00190000
         AIF   ('&XSYSEVPL'(1,1) EQ '(').ZI7F  IN GPR                   00190100
.*                                                                      00190200
&ZOPN                 SETA  &ZOPN+1                                     00190300
&ZOPL(&ZOPN)          SETC  ' '                                         00190400
&ZOPO(&ZOPN)          SETC  'LA'                                        00190500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00190600
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSEVPL XSYSEVPL'                    00190700
.*                                                                      00190800
                      AGO   .ZI7G                                       00190900
.*                                                                      00191000
.ZI7F                 ANOP  ,                                           00191100
&ZCGPR   SETC  '&XSYSEVPL'(2,K'&XSYSEVPL-2)                             00191200
.*                                                                      00191300
.ZI7G                 ANOP  ,                                           00191400
.*                                                                      00191500
&ZOPN                 SETA  &ZOPN+1                                     00191600
&ZOPL(&ZOPN)          SETC  ' '                                         00191700
&ZOPO(&ZOPN)          SETC  'ST'                                        00191800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              00191900
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSEVPL XSYSEVPL'                    00192000
.*                                                                      00192100
.ZI7H                 ANOP  ,                                           00192200
.*-------------------------------------------------------------------   00192300
.***AI.L18  XCONNTKN XL4                                                00192400
         AIF   ('&XCONNTKN' NE 'NO_CONNTKN').ZI8                        00192500
&ZXCONNTKN            SETC  ''             RESET INPUT/OUTPUT           00192600
.ZI8                  ANOP  ,                                           00192700
.*-------------------------------------------------------------------   00192800
.***AI.L25  XCONNTKN XL4                                                00192900
                      AIF   ('&ZXCONNTKN' EQ '').ZI8E                   00193000
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI8E             00193100
&ZCGPR                SETC  '&XCONNTKN'                                 00193200
.*                                                                      00193300
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI8B              00193400
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00193500
                      AGO   .ZI8D                                       00193600
.ZI8B                 ANOP  ,                                           00193700
.*                                                                      00193800
&ZC                   SETC  '&XCONNTKN'(1,1)                            00193900
                      AIF   (T'&ZC NE 'N').ZI8D                         00194000
&ZC                   SETC  '&XCONNTKN'                                 00194100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00194200
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00194300
.*                                                                      00194400
.ZI8D                 ANOP  ,                                           00194500
.*                                                                      00194600
&ZOPN                 SETA  &ZOPN+1                                     00194700
&ZOPL(&ZOPN)          SETC  ' '                                         00194800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00194900
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00195000
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00195100
.*                                                                      00195200
.ZI8E                 ANOP  ,                                           00195300
.*-------------------------------------------------------------------   00195400
.***AI.L25  XMONTKN XL4                                                 00195500
                      AIF   ('&ZXMONTKN' EQ '').ZI9E                    00195600
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI9E              00195700
&ZCGPR                SETC  '&XMONTKN'                                  00195800
.*                                                                      00195900
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI9B               00196000
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00196100
                      AGO   .ZI9D                                       00196200
.ZI9B                 ANOP  ,                                           00196300
.*                                                                      00196400
&ZC                   SETC  '&XMONTKN'(1,1)                             00196500
                      AIF   (T'&ZC NE 'N').ZI9D                         00196600
&ZC                   SETC  '&XMONTKN'                                  00196700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00196800
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00196900
.*                                                                      00197000
.ZI9D                 ANOP  ,                                           00197100
.*                                                                      00197200
&ZOPN                 SETA  &ZOPN+1                                     00197300
&ZOPL(&ZOPN)          SETC  ' '                                         00197400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00197500
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00197600
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00197700
.*                                                                      00197800
.ZI9E                 ANOP  ,                                           00197900
.*-------------------------------------------------------------------   00198000
.***AI.L18  XENDTIME XL8                                                00198100
         AIF   ('&XENDTIME' NE 'CURRENT').ZI10                          00198200
&ZXENDTIME            SETC  ''             RESET INPUT/OUTPUT           00198300
.ZI10                 ANOP  ,                                           00198400
.*-------------------------------------------------------------------   00198500
.***AI.L25  XENDTIME XL8                                                00198600
                      AIF   ('&ZXENDTIME' EQ '').ZI10E                  00198700
                      AIF   ('&ZXENDTIME' EQ 'OUTPUT').ZI10E            00198800
&ZCGPR                SETC  '&XENDTIME'                                 00198900
.*                                                                      00199000
                      AIF   ('&XENDTIME'(1,1) NE '(').ZI10B             00199100
&ZCGPR   SETC  '0('.'&XENDTIME'(2,K'&XENDTIME-2).')'                    00199200
                      AGO   .ZI10D                                      00199300
.ZI10B                ANOP  ,                                           00199400
.*                                                                      00199500
&ZC                   SETC  '&XENDTIME'(1,1)                            00199600
                      AIF   (T'&ZC NE 'N').ZI10D                        00199700
&ZC                   SETC  '&XENDTIME'                                 00199800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00199900
&ZCGPR                SETC  '=BL8''&XENDTIME'''                         00200000
.*                                                                      00200100
.ZI10D                ANOP  ,                                           00200200
.*                                                                      00200300
&ZOPN                 SETA  &ZOPN+1                                     00200400
&ZOPL(&ZOPN)          SETC  ' '                                         00200500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00200600
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00200700
&ZOPD(&ZOPN)          SETC  '++ &ZXENDTIME XENDTIME'                    00200800
.*                                                                      00200900
.ZI10E                ANOP  ,                                           00201000
.*-------------------------------------------------------------------   00201100
&ZOPN1                SETA &ZOPN                                        00201200
.*******************************************************************    00201300
.***  PROCESS IWMMNTFY OUTPUT PARAMETERS                                00201400
.*******************************************************************    00201500
                      ACTR  10000                                       00201600
.*******************************************************************    00201700
.***AO.X02  RETURN CODE PROCESSING                                      00201800
.*******************************************************************    00201900
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00202000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00202100
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00202200
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00202300
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00202400
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00202500
&ZOPN                 SETA  &ZOPN+1                                     00202600
&ZOPL(&ZOPN)          SETC  ' '                                         00202700
&ZOPO(&ZOPN)          SETC  'ST'                                        00202800
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00202900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00203000
                      AGO   .ZMRETX                                     00203100
.*                                                                      00203200
.ZMRET2               ANOP  ,                                           00203300
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00203400
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00203500
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00203600
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00203700
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00203800
&ZOPN                 SETA  &ZOPN+1                                     00203900
&ZOPL(&ZOPN)          SETC  ' '                                         00204000
&ZOPO(&ZOPN)          SETC  'LR'                                        00204100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00204200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00204300
.ZMRETX               ANOP  ,                                           00204400
.*******************************************************************    00204500
.***AO.X03  REASON CODE PROCESSING                                      00204600
.*******************************************************************    00204700
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00204800
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00204900
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00205000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00205100
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00205200
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00205300
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00205400
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00205500
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00205600
&ZOPN                 SETA  &ZOPN+1                                     00205700
&ZOPL(&ZOPN)          SETC  ' '                                         00205800
&ZOPO(&ZOPN)          SETC  'ST'                                        00205900
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00206000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00206100
                      AGO   .ZMRSNX                                     00206200
.*                                                                      00206300
.ZMRSN2               ANOP  ,                                           00206400
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00206500
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00206600
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00206700
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00206800
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00206900
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00207000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00207100
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00207200
&ZOPN                 SETA  &ZOPN+1                                     00207300
&ZOPL(&ZOPN)          SETC  ' '                                         00207400
&ZOPO(&ZOPN)          SETC  'LR'                                        00207500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00207600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00207700
.ZMRSNX               ANOP  ,                                           00207800
.*******************************************************************    00207900
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00208000
.*******************************************************************    00208100
.ZMFLX                ANOP  ,              MF=L PROCESSING              00208200
.*******************************************************************    00208300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00208400
.*******************************************************************    00208500
                      ACTR  10000                                       00208600
.*                                                                      00208700
                      LCLA  &ZLC           COLUMN POSITION              00208800
                      LCLA  &ZOPX          LIST TABLE INDEX             00208900
                      LCLC  &ZLL           LABEL                        00209000
                      LCLC  &ZLOP          OPERATION                    00209100
                      LCLC  &ZLV           VALUE                        00209200
                      LCLC  &ZLD           DESCRIPTION                  00209300
.*                                                                      00209400
&ZOPX                 SETA  1                                           00209500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00209600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00209700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00209800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00209900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00210000
                      AIF   (K'&ZLD LE 0).ZL5                           00210100
&ZLC                  SETA  35             COMMENT COLUMN               00210200
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00210300
&ZLC                  SETA  33             COMMMENT COLUMN              00210400
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00210500
&ZLV                  SETC  '&ZLV'.' '                                  00210600
                      AGO   .ZL3                                        00210700
.*                                                                      00210800
.ZL4                  ANOP  ,                                           00210900
&ZLV                  SETC  '&ZLV'.' '                                  00211000
.ZL5                  ANOP  ,                                           00211100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00211200
.*                                                                      00211300
&ZLL     &ZLOP &ZLV                                                     00211400
.*                                                                      00211500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00211600
                      AGO   .ZL2           CONTINUE LOOPING             00211700
.*                                                                      00211800
.ZLX                  ANOP  ,                                           00211900
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00212000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00212100
         L     14,16(0,0)              GET CVT ADDRESS                  00212200
         TM    CVTOSLV1-CVT(14),X'40'      TEST FOR WLM PRESENCE        00212300
         BO    WLM&SYSNDX              BRANCH WHEN WLM IS PRESENT       00212400
         AIF   ('&SYSEVPL' NE '').NTFYSYSEV   BRANCH IF SYSEVENT NEEDED 00212500
         LA    0,IWMRSNCODENOWLM       SET REASON CODE = NO WLM         00212600
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00212700
         B     END&SYSNDX              BRANCH TO END LABEL              00212800
         AGO    .NTFYWLM                                                00212900
.NTFYSYSEV ANOP                                                         00213000
         L     1,4(1,0)                ESTABLISH THE SYSEVENT PL ADDR   00213100
         SYSEVENT TRAXFRPT,ENTRY=BRANCH                                 00213200
         LTR   15,15                                                    00213300
         BZ    END&SYSNDX              BRANCH TO END WHEN SUCCESSFUL    00213400
         LA    0,IWMRETCODEENVERROR                                     00213500
         CR    15,0                                                     00213600
         BE    R12&SYSNDX              BRANCH WHEN SYSEVENT RC=12       00213700
         DS    0H                      SYSEVENT RC = 8 (NO WORK ELT)    00213800
         LR    15,0                    SET RC = IWMRETCODEENVERROR      00213900
         LA    0,IWMRSNCODESYSEVENTNOWORKELT  SET REASONCODE            00214000
         B     END&SYSNDX              BRANCH TO END LABEL              00214100
R12&SYSNDX DS    0H                    SYEVENT RC=12 (REPORTING SUSP)   00214200
         LA    0,IWMRSNCODEREPORTINGSUSP      SET REASONCODE            00214300
         B     END&SYSNDX              BRANCH TO END LABEL              00214400
.NTFYWLM   ANOP                        CODE GENERATION FOR WLM PRESENT  00214500
*                                                                       00214600
WLM&SYSNDX DS    0H                    BRANCH LABEL FOR WLM PRESENT     00214700
         AIF   ('&XENDTIME' NE 'CURRENT').NTFYENDTIME                   00214800
         STCK  16(1)                   SAVE TOD IN P.L.                 00214900
         BC    8,IWMMNTFY_TIMEOK&SYSNDX BRANCH WHEN STCK CC=0           00215000
         LA    0,IWMRSNCODENOENDTIME   SET REASONCODE                   00215100
         LA    15,IWMRETCODEENVERROR   SET RC = IWMRETCODEENVERROR      00215200
         B     IWMMNTFY_FINIS&SYSNDX   BRANCH TO THE END                00215300
IWMMNTFY_TIMEOK&SYSNDX DS 0H           BRANCH LABEL FOR STCK CC=0       00215400
.NTFYENDTIME ANOP                      BRANCH LABEL WHEN ENDTIME GIVEN  00215500
         L     14,X'8C'(14,0)          GET ECVT ADDRESS                 00215600
         L     14,X'C4'(14,0)          GET WMVT ADDRESS                 00215700
         L     15,X'108'(14,0)         GET NOTIFY RTN ENTRY POINT ADDR  00215800
         BASR  14,15                   CALL NOTIFY ROUTINE              00215900
         AIF   ('&XENDTIME' NE 'CURRENT').NTFYEND                       00216000
IWMMNTFY_FINIS&SYSNDX DS 0H            BRANCH LABEL FOR STCK NON-0 CC   00216100
.NTFYEND     ANOP                                                       00216200
END&SYSNDX DS    0H                    END LABEL                        00216300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00216400
.ZLINKX               ANOP  ,                                           00216500
.*******************************************************************    00216600
.***AP.X01  FORMAT GENERATED CODE                                       00216700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00216800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00216900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00217000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00217100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00217200
                      AIF   (K'&ZLD LE 0).ZL51                          00217300
&ZLC                  SETA  35             COMMENT COLUMN               00217400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00217500
&ZLC                  SETA  33             COMMENT COLUMN               00217600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00217700
&ZLV                  SETC  '&ZLV'.' '                                  00217800
                      AGO   .ZL31                                       00217900
.*                                                                      00218000
.ZL41                 ANOP  ,                                           00218100
&ZLV                  SETC  '&ZLV'.' '                                  00218200
.ZL51                 ANOP  ,                                           00218300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00218400
.*                                                                      00218500
&ZLL     &ZLOP &ZLV                                                     00218600
.*                                                                      00218700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00218800
                      AGO   .ZL21          CONTINUE LOOPING             00218900
.*                                                                      00219000
.ZLX1                 ANOP  ,                                           00219100
.*******************************************************************    00219200
.***AP.X02  END OF IWMMNTFY MACRO                                       00219300
&ZIWMMNTFY            SETC  'YES'          SET IWMMNTFY USED            00219400
         POP   PRINT                                                    00219500
*                                            IWMMNTFY-0                 00219600
         SPACE 1                                                        00219700
.ZLX2                 ANOP  ,                                           00219800
         MEND                                                           00219900
**********************************************************************/ 00220000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00220100
*%IWMMNTFY: MACRO KEYS(TRAXFRPT,SYSEVPL,MONTKN,COMPLETION,              00220200
*                 DISASSOCIATE,CONNTKN,ENDTIME,RETCODE,RSNCODE,         00220300
*                 PLISTVER,MF);                                         00220400
*  ANS('?'||MACLABEL||' '||'IWMMNTFP '||MACLIST||                       00220500
*         ' '||MACKEYS||';') COL(MACLMAR);                              00220600
*%END IWMMNTFY;                                                         00220700
