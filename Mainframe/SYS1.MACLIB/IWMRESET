*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMRESET                              -04/02/97-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Change a Job's Performance Controls           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5647-A01 (C) COPYRIGHT IBM CORP. 1997                           * 00001300
*                                                                     * 00001400
* STATUS= JBB6604                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      The IWMRESET macro allows the caller to perform the same       * 00002200
*      functions as the RESET system command.  If the system is       * 00002300
*      running in workload management goal mode mode, the caller can: * 00002400
*                                                                     * 00002500
*                                                                     * 00002600
*      o   Change the service class of work currently in execution,   * 00002700
*          with the SRVCLASS keyword.  Resetting to a new service     * 00002800
*          class also resumes quiesced work.                          * 00002900
*                                                                     * 00003000
*      o   Quiesce work currently in execution, with the QUIESCE      * 00003100
*          keyword.                                                   * 00003200
*                                                                     * 00003300
*      o   Reclassify work currently in execution according to the    * 00003400
*          service policy in effect, with the RESUME keyword.  The    * 00003500
*          RESUME keyword also resumes quiesced work.                 * 00003600
*                                                                     * 00003700
*                                                                     * 00003800
*                                                                     * 00003900
*      If the system is running in workload management compatibility  * 00004000
*      mode, the caller can change the performance group of a job     * 00004100
*      currently in execution.                                        * 00004200
*                                                                     * 00004300
*      The system does not allow every address space to be reset.     * 00004400
*      The IWMRESET service has the same restrictions as the RESET    * 00004500
*      system command.  Refer to OS/390 MVS System Commands for more  * 00004600
*      information.                                                   * 00004700
*                                                                     * 00004800
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004900
*                                                                     * 00005000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00005100
*                                                                     * 00005200
*01* ENVIRONMENT:                                                     * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*      Minimum authorization: Supervisor state or program key mask    * 00005600
*                        (PKM) allowing keys 0-7.                     * 00005700
*                                                                     * 00005800
*      Dispatchable unit mode: Task mode.                             * 00005900
*                                                                     * 00006000
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00006100
*                                                                     * 00006200
*      AMODE:            31-bit.                                      * 00006300
*                                                                     * 00006400
*      ASC mode:         Primary.                                     * 00006500
*                                                                     * 00006600
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006700
*                                                                     * 00006800
*      Locks:            No locks held.                               * 00006900
*                                                                     * 00007000
*      Control parameters: Control parameters must be in the primary  * 00007100
*                        address space.                               * 00007200
*                                                                     * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*01* PROGRAMMING REQUIREMENTS:                                        * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*    1.  The macro CVT must be included to use this macro.            * 00007900
*                                                                     * 00008000
*    2.  The macro IWMYCON must be included to use this macro.        * 00008100
*                                                                     * 00008200
*    3.  The macro IWMPB must be in the library concatenation, since  * 00008300
*        it is included by IWMYCON.                                   * 00008400
*                                                                     * 00008500
*    4.  Note that the high order halfword of register 0, and the     * 00008600
*        reason code variable when specified, may be non-zero and     * 00008700
*        represents diagnostic data which is NOT part of the external * 00008800
*        interface.  The high order halfword should thus be excluded  * 00008900
*        from comparison with the reason code values described above. * 00009000
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00009100
*        be used for this purpose.                                    * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*01* RESTRICTIONS:                                                    * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*    1.  This macro may not be used prior to the completion of WLM    * 00009900
*        address space initialization.                                * 00010000
*                                                                     * 00010100
*    2.  This macro may only be used on MVS/ESA JBB6604 or higher.    * 00010200
*                                                                     * 00010300
*    3.  The caller cannot have an EUT FRR established.               * 00010400
*                                                                     * 00010500
*                                                                     * 00010600
*                                                                     * 00010700
*01* INPUT REGISTER INFORMATION:                                      * 00010800
*                                                                     * 00010900
*    Before issuing the IWMRESET macro, the caller does not have to   * 00011000
*    place any information into any register unless using it in       * 00011100
*    register notation for a particular parameter, or using it as a   * 00011200
*    base register.                                                   * 00011300
*                                                                     * 00011400
*01* OUTPUT REGISTER INFORMATION:                                     * 00011500
*                                                                     * 00011600
*    When control returns to the caller, the GPRs contain:            * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*    REGISTER  CONTENTS                                               * 00012000
*                                                                     * 00012100
*    0         Reason code if GR15 return code is non-zero            * 00012200
*                                                                     * 00012300
*    1         Used as work registers by the system                   * 00012400
*                                                                     * 00012500
*    2-13      Unchanged                                              * 00012600
*                                                                     * 00012700
*    14        Used as work registers by the system                   * 00012800
*                                                                     * 00012900
*    15        Return code                                            * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*    When control returns to the caller, the ARs contain:             * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*    REGISTER  CONTENTS                                               * 00013700
*                                                                     * 00013800
*    0-1       Used as work registers by the system                   * 00013900
*                                                                     * 00014000
*    2-13      Unchanged                                              * 00014100
*                                                                     * 00014200
*    14-15     Used as work registers by the system                   * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*    Some callers depend on register contents remaining the same      * 00014700
*    before and after issuing a service.  If the system changes the   * 00014800
*    contents of registers on which the caller depends, the caller    * 00014900
*    must save them before issuing the service, and restore them      * 00015000
*    after the system returns control.                                * 00015100
*                                                                     * 00015200
*01* PERFORMANCE IMPLICATIONS:                                        * 00015300
*                                                                     * 00015400
*    None                                                             * 00015500
*                                                                     * 00015600
*01* SYNTAX:                                                          * 00015700
*                                                                     * 00015800
*[xlabel]  IWMRESET    JOBNAME=xjobname                              * 00015900
*                     ,ASID=xasid                                    * 00016000
*                    [,FUNCTION=RESET                                * 00016100
*                    |    ,SRVCLASS=xsrvclass                        * 00016200
*                    |    ,PERFORM=xperform]                         * 00016300
*                    [,FUNCTION=QUIESCE]                             * 00016400
*                    [,FUNCTION=RESUME]                              * 00016500
*                      ,USERID=xuserid                                * 00016600
*                      ,PRODUCT=xproduct                              * 00016700
*                     [,RETCODE=xretcode]                             * 00016800
*                     [,RSNCODE=xrsncode]                             * 00016900
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00017000
*                    [,MF=S]                                         * 00017100
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00017200
*                    [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]            * 00017300
*                    [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]            * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*      Where:                                                         * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*      [xlabel]                                                       * 00018000
*          is an optional symbol, starting in column 1, that is the   * 00018100
*          name on the IWMRESET macro invocation.  The name must      * 00018200
*          conform to the rules for an ordinary assembler language    * 00018300
*          symbol.                                                    * 00018400
*          DEFAULT: No name.                                          * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*      The following is a group of keys.  At least one must be        * 00019000
*      specified.                                                     * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*      JOBNAME=xjobname                                               * 00019400
*          is the name (RS-type), or address in register (2)-(12), of * 00019500
*          an 8 character input which contains the jobname of the job * 00019600
*          you want to change.  If there is more than one executing   * 00019700
*          job with this jobname, you must specify the ASID parameter * 00019800
*          to identify the specific job.                              * 00019900
*                                                                     * 00020000
*      ASID=xasid                                                     * 00020100
*          is the name (RS-type), or address in register (2)-(12), of * 00020200
*          a halfword input which contains the address space          * 00020300
*          identifier (ASID) of the job you want to change.           * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*      End of group of keys.                                          * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*      [FUNCTION=RESET|QUIESCE|RESUME]                              * 00021200
*          is an optional keyword input which indicates the function  * 00021300
*          to perform against the job.                                * 00021400
*          DEFAULT: RESET                                             * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*          [FUNCTION=RESET                                            * 00021800
*                                                                     * 00021900
*              Requests that the job's service class or performance   * 00022000
*              group be changed.                                      * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*              The following is a set of mutually exclusive keys.     * 00022400
*              This set is required; only one key must be specified.  * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*              SRVCLASS=xsrvclass                                     * 00022800
*                  belongs to a set of mutually exclusive keys. It is * 00022900
*                  the name (RS-type), or address in register         * 00023000
*                  (2)-(12), of an 8 character input which is the     * 00023100
*                  service class to be assigned to the job.           * 00023200
*                  Resetting to a new service class also resumes      * 00023300
*                  quiesced work.  SRVCLASS applies only on a system  * 00023400
*                  operating in workload management goal mode.  It    * 00023500
*                  does not apply in workload management              * 00023600
*                  compatibility mode.                                * 00023700
*                                                                     * 00023800
*                  When you reset a server to a new service class,    * 00023900
*                  the goals associated with that service class are   * 00024000
*                  ignored.  However the resource group associated    * 00024100
*                  with the new service class is honored.  The one    * 00024200
*                  exception where the goal for a server is honored   * 00024300
*                  is when the transactions it is serving have been   * 00024400
*                  assigned a discretionary goal.                     * 00024500
*                                                                     * 00024600
*              PERFORM=xperform]                                      * 00024700
*                  belongs to a set of mutually exclusive keys. It is * 00024800
*                  the name (RS-type), or address in register         * 00024900
*                  (2)-(12), of a halfword input which contains the   * 00025000
*                  performance group number, between 1 and 999, to be * 00025100
*                  assigned to the job.  PERFORM applies only on a    * 00025200
*                  system operating in workload management            * 00025300
*                  compatibility mode.  It does not apply in workload * 00025400
*                  management goal mode.                              * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*              End of a set of mutually exclusive required keys.      * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*          [FUNCTION=QUIESCE]                                         * 00026200
*                                                                     * 00026300
*              Requests that the job be quiesced.  If the job is      * 00026400
*              non-swappable, it is given the lowest possible         * 00026500
*              performance characteristics.  QUIESCE applies only on  * 00026600
*              a system operating in workload management goal mode.   * 00026700
*              It does not apply in workload management compatibility * 00026800
*              mode.                                                  * 00026900
*                                                                     * 00027000
*          [FUNCTION=RESUME]                                          * 00027100
*                                                                     * 00027200
*              Requests that the job be reclassified according to the * 00027300
*              service policy in effect.  This undoes a prior request * 00027400
*              to reset the job to a particular service class, or to  * 00027500
*              quiesce the job.  RESUME applies only on a system      * 00027600
*              operating in workload management goal mode.  It does   * 00027700
*              not apply in workload management compatibility mode.   * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*      USERID=xuserid                                                 * 00028500
*          is the name (RS-type), or address in register (2)-(12), of * 00028600
*          a required 8 character input which contains the id of the  * 00028700
*          user who is requesting the job be changed.  The userid is  * 00028800
*          included in the SMF 90 subtype 30 record created by        * 00028900
*          IWMRESET.  If there is no userid available, the caller     * 00029000
*          should pass blanks.                                        * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*      PRODUCT=xproduct                                               * 00029600
*          is the name (RS-type), or address in register (2)-(12), of * 00029700
*          a required 8 character input which contains the product    * 00029800
*          name that is requesting the job be changed.  The product   * 00029900
*          name is included in the SMF 90 subtype 30 record created   * 00030000
*          by IWMRESET.                                               * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*      [RETCODE=xretcode]                                             * 00030600
*          is the name (RS-type) of an optional fullword output       * 00030700
*          variable, or register (2)-(12), into which the return code * 00030800
*          is to be copied from GPR 15.                               * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*      [RSNCODE=xrsncode]                                             * 00031400
*          is the name (RS-type) of an optional fullword output       * 00031500
*          variable, or register (2)-(12), into which the reason code * 00031600
*          is to be copied from GPR 0.                                * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00032200
*          is an optional byte input decimal value in the "0-0" range * 00032300
*          that specifies the macro version.  PLISTVER is the only    * 00032400
*          key allowed on the list form of MF and determines which    * 00032500
*          parameter list is generated (see Macro USAGE NOTE 2).      * 00032600
*          Note that MAX may be specified instead of a number, and    * 00032700
*          the parameter list will be of the largest size currently   * 00032800
*          supported. This size may grow from release to release      * 00032900
*          (thus possibly affecting the amount of storage needed by   * 00033000
*          your program).  If your program can tolerate this, IBM     * 00033100
*          recommends that you always specify MAX when creating the   * 00033200
*          list form parameter list as that will ensure that the list * 00033300
*          form parameter list is always long enough to hold whatever * 00033400
*          parameters might be specified on the execute form.         * 00033500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00033600
*          default is the lowest version which allows all of the      * 00033700
*          parameters specified on the invocation to be processed.    * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*      [MF=S|L|M|E]                                                 * 00034300
*          is an optional keyword input which specifies the macro     * 00034400
*          form.                                                      * 00034500
*          DEFAULT: S                                                 * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*          [MF=S]                                                     * 00034900
*              specifies the standard form of the macro.  The "S"     * 00035000
*              form generates code to put the parameters into an      * 00035100
*              in-line parameter list and invoke the desired service. * 00035200
*              Full checking for required macro keys is done along    * 00035300
*              with supplying defaults for omitted optional           * 00035400
*              parameters.                                            * 00035500
*                                                                     * 00035600
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00035700
*              specifies the list form of the macro.  The "L" form    * 00035800
*              defines an area to be used for the parameter list.     * 00035900
*              Only the PLISTVER key may be specified on the          * 00036000
*              invocation.  All other macro parameters are flagged as * 00036100
*              errors.  If PLISTVER is not specified, the original    * 00036200
*              parameter list definition is used.                     * 00036300
*                                                                     * 00036400
*            ,xmfctrl                                                 * 00036500
*              is a required input.  It is the name of a storage area * 00036600
*              for the parameter list.                                * 00036700
*                                                                     * 00036800
*            ,xmfattr|0D                                            * 00036900
*              is an optional 60 character input string that varies   * 00037000
*              from 1 to 60 characters. Use it to force boundary      * 00037100
*              alignment of the parameter list. Use any value that    * 00037200
*              represents a boundary and is valid on an assembler DS  * 00037300
*              pseudo op.                                             * 00037400
*              DEFAULT: 0D which forces the parameter list to a       * 00037500
*              doubleword boundary.                                   * 00037600
*                                                                     * 00037700
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00037800
*              specifies the modify form of the macro.  The "M" form  * 00037900
*              generates code to put the parameters into the          * 00038000
*              parameter list specified by xmfctrl.                   * 00038100
*                                                                     * 00038200
*            ,xmfctrl                                                 * 00038300
*              is a required input.  It is the name (RS-type), or     * 00038400
*              address in register (1)-(12), of a storage area for    * 00038500
*              the parameter list.                                    * 00038600
*                                                                     * 00038700
*            ,COMPLETE|NOCHECK]                                     * 00038800
*              is an optional keyword input which specifies the       * 00038900
*              degree of macro parameter syntax checking.             * 00039000
*              DEFAULT: COMPLETE                                      * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*              COMPLETE                                               * 00039400
*                  Checking for required macro keys is done and       * 00039500
*                  defaults are supplied for omitted optional         * 00039600
*                  parameters.  (See Macro Usage Note 2).             * 00039700
*                                                                     * 00039800
*              NOCHECK                                                * 00039900
*                  Checking for required macro keys is not done nor   * 00040000
*                  are defaults supplied for omitted optional         * 00040100
*                  parameters.                                        * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*                                                                     * 00040500
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00040600
*              specifies the execute form of the macro.  The "E" form * 00040700
*              generates code to put the parameters into the          * 00040800
*              parameter list specified by xmfctrl and invoke the     * 00040900
*              desired service.                                       * 00041000
*                                                                     * 00041100
*            ,xmfctrl                                                 * 00041200
*              is a required input.  It is the name (RS-type), or     * 00041300
*              address in register (1)-(12), of a storage area for    * 00041400
*              the parameter list.                                    * 00041500
*                                                                     * 00041600
*            ,COMPLETE|NOCHECK                                      * 00041700
*              is an optional keyword input which specifies the       * 00041800
*              degree of macro parameter syntax checking.             * 00041900
*              DEFAULT: COMPLETE                                      * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*              COMPLETE                                               * 00042300
*                  Checking for required macro keys is done and       * 00042400
*                  defaults are supplied for omitted optional         * 00042500
*                  parameters.  (See Macro Usage Note 2).             * 00042600
*                                                                     * 00042700
*              NOCHECK                                                * 00042800
*                  Checking for required macro keys is not done nor   * 00042900
*                  are defaults supplied for omitted optional         * 00043000
*                  parameters.                                        * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*01* ABEND CODES:  None.                                              * 00043900
*                                                                     * 00044000
*01* RETURN CODES:                                                    * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*            0    Name: IwmRetCodeOk                                  * 00044400
*                                                                     * 00044500
*                 Meaning: Successful completion.                     * 00044600
*                                                                     * 00044700
*                 Action: None required.                              * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*            4    Name: IwmRetCodeWarning                             * 00045100
*                                                                     * 00045200
*                 Meaning:  Successful completion, unusual conditions * 00045300
*                 noted.                                              * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*                 HEX REASON  MEANING/ACTION                          * 00045700
*                 CODE                                                * 00045800
*                                                                     * 00045900
*                 xxxx0408    Name: IwmRsnCodeWorkNotFound            * 00046000
*                                                                     * 00046100
*                             Meaning: A job matching the input job   * 00046200
*                             name or ASID was not found.             * 00046300
*                                                                     * 00046400
*                             Action: The caller should report the    * 00046500
*                             error appropriately.                    * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*            8    Name: IwmRetCodeInvocError                          * 00047100
*                                                                     * 00047200
*                 Meaning: Invalid invocation environment or          * 00047300
*                 parameters.                                         * 00047400
*                                                                     * 00047500
*                                                                     * 00047600
*                 HEX REASON  MEANING/ACTION                          * 00047700
*                 CODE                                                * 00047800
*                                                                     * 00047900
*                 xxxx0801    Name: IwmRsnCodeSRBMode                 * 00048000
*                                                                     * 00048100
*                             Meaning: Caller is in SRB mode.         * 00048200
*                                                                     * 00048300
*                             Action: Avoid requesting this function  * 00048400
*                             while in SRB mode.                      * 00048500
*                                                                     * 00048600
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00048700
*                                                                     * 00048800
*                             Meaning: Caller is disabled.            * 00048900
*                                                                     * 00049000
*                             Action: Avoid requesting this function  * 00049100
*                             while disabled.                         * 00049200
*                                                                     * 00049300
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00049400
*                                                                     * 00049500
*                             Meaning: Caller is locked.              * 00049600
*                                                                     * 00049700
*                             Action: Avoid requesting this function  * 00049800
*                             while locked.                           * 00049900
*                                                                     * 00050000
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00050100
*                                                                     * 00050200
*                             Meaning: Error accessing parameter      * 00050300
*                             list.                                   * 00050400
*                                                                     * 00050500
*                             Action: Check for possible storage      * 00050600
*                             overlay.                                * 00050700
*                                                                     * 00050800
*                 xxxx0810    Name: IwmRsnCodeEutFrr                  * 00050900
*                                                                     * 00051000
*                             Meaning: Caller has EUT FRR             * 00051100
*                             established.                            * 00051200
*                                                                     * 00051300
*                             Action: Avoid requesting this function  * 00051400
*                             with an EUT FRR set.                    * 00051500
*                                                                     * 00051600
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00051700
*                                                                     * 00051800
*                             Meaning: Caller invoked service but was * 00051900
*                             in 24 bit addressing mode.              * 00052000
*                                                                     * 00052100
*                             Action: Request this function only when * 00052200
*                             you are in 31 bit addressing mode.      * 00052300
*                                                                     * 00052400
*                 xxxx0825    Name: IwmRsnCodeAscModeNotPrimary       * 00052500
*                                                                     * 00052600
*                             Meaning: Caller invoked service but was * 00052700
*                             not in primary ASC mode.                * 00052800
*                                                                     * 00052900
*                             Action: Avoid requesting this function  * 00053000
*                             in this environment.                    * 00053100
*                                                                     * 00053200
*                 xxxx0827    Name: IwmRsnCodeRsvdNot0                * 00053300
*                                                                     * 00053400
*                             Meaning: Reserved field in parameter    * 00053500
*                             list was non-zero.                      * 00053600
*                                                                     * 00053700
*                             Action:  Check for use of keywords that * 00053800
*                             are not supported by the MVS release on * 00053900
*                             which the program is running.           * 00054000
*                                                                     * 00054100
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00054200
*                                                                     * 00054300
*                             Meaning: Version number in parameter    * 00054400
*                             list is not valid.                      * 00054500
*                                                                     * 00054600
*                             Action: Check for possible storage      * 00054700
*                             overlay of the parameter list.          * 00054800
*                                                                     * 00054900
*                 xxxx0829    Name: IwmRsnCodeBadOptions              * 00055000
*                                                                     * 00055100
*                             Meaning: Parameter list omits required  * 00055200
*                             parameters.                             * 00055300
*                                                                     * 00055400
*                             Action: Check for possible storage      * 00055500
*                             overlay of the parameter list.          * 00055600
*                                                                     * 00055700
*                 xxxx0841    Name: IwmRsnCodeXMemMode                * 00055800
*                                                                     * 00055900
*                             Meaning: Caller is in cross memory      * 00056000
*                             mode.                                   * 00056100
*                                                                     * 00056200
*                             Action: Invoke the function in          * 00056300
*                             non-cross memory mode.                  * 00056400
*                                                                     * 00056500
*                                                                     * 00056600
*                                                                     * 00056700
*                                                                     * 00056800
*            C    Name: IwmRetCodeEnvError                            * 00056900
*                                                                     * 00057000
*                 Meaning: Environmental error.                       * 00057100
*                                                                     * 00057200
*                                                                     * 00057300
*                 HEX REASON  MEANING/ACTION                          * 00057400
*                 CODE                                                * 00057500
*                                                                     * 00057600
*                 xxxx0C28    Name: IwmRsnCodeBadServiceClass         * 00057700
*                                                                     * 00057800
*                             Meaning: The input service class name   * 00057900
*                             is not defined in the active workload   * 00058000
*                             manager policy.                         * 00058100
*                                                                     * 00058200
*                             Action: Record or report the error if   * 00058300
*                             appropriate.                            * 00058400
*                                                                     * 00058500
*                 xxxx0C2D    Name: IwmRsnCodeBadPerformanceGroup     * 00058600
*                                                                     * 00058700
*                             Meaning: The input performance group    * 00058800
*                             number is not defined in the IPS.       * 00058900
*                                                                     * 00059000
*                             Action: Record or report the error if   * 00059100
*                             appropriate.                            * 00059200
*                                                                     * 00059300
*                 xxxx0C2E    Name: IwmRsnCodeWrongMode               * 00059400
*                                                                     * 00059500
*                             Meaning:  The caller tried to perform a * 00059600
*                             goal-mode function in compatibility     * 00059700
*                             mode, or vice versa.                    * 00059800
*                                                                     * 00059900
*                             Action: Record or report the error if   * 00060000
*                             appropriate.                            * 00060100
*                                                                     * 00060200
*                 xxxx0C2F    Name: IwmRsnCodeSystemSpace             * 00060300
*                                                                     * 00060400
*                             Meaning: The input address space is     * 00060500
*                             either a system component address space * 00060600
*                             or a privileged address space.  It      * 00060700
*                             cannot be reset.                        * 00060800
*                                                                     * 00060900
*                             Action: Record or report the error if   * 00061000
*                             appropriate.                            * 00061100
*                                                                     * 00061200
*                 xxxx0C30    Name: IwmRsnCodeDuplicateJobs           * 00061300
*                                                                     * 00061400
*                             Meaning:  There is more than one job    * 00061500
*                             active with the same jobname.           * 00061600
*                                                                     * 00061700
*                             Action: Specify the ASID parameter to   * 00061800
*                             identify the specific job.              * 00061900
*                                                                     * 00062000
*                 xxxx0C31    Name: IwmRsnCodeWrongASID               * 00062100
*                                                                     * 00062200
*                             Meaning:  The active job in the         * 00062300
*                             specified address space has a different * 00062400
*                             jobname than the one passed by the      * 00062500
*                             caller.                                 * 00062600
*                                                                     * 00062700
*                             Action: Record or report the error if   * 00062800
*                             appropriate.                            * 00062900
*                                                                     * 00063000
*                 xxxx0C32    Name: IwmRsnCodeNotEligibleForSrvClass  * 00063100
*                                                                     * 00063200
*                             Meaning:  The active job in the         * 00063300
*                             specified address space is not eligible * 00063400
*                             for reset into the specified system     * 00063500
*                             service class.  Only address spaces     * 00063600
*                             created with the ASCRE HIPRI attribute  * 00063700
*                             are eligible for reset into the SYSTEM  * 00063800
*                             service class.                          * 00063900
*                                                                     * 00064000
*                             Action: Record or report the error if   * 00064100
*                             appropriate.                            * 00064200
*                                                                     * 00064300
*                                                                     * 00064400
*                                                                     * 00064500
*            10   Name: IwmRetCodeCompError                           * 00064600
*                                                                     * 00064700
*                 Meaning: Component error.                           * 00064800
*                                                                     * 00064900
*                 Action: Contact your system programmer.             * 00065000
*                                                                     * 00065100
*                                                                     * 00065200
*                                                                     * 00065300
*                                                                     * 00065400
*01* REASON CODES:                                                    * 00065500
*                                                                     * 00065600
*       A unique reason code will be returned whenever the return     * 00065700
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00065800
*       under their corresponding return code.  Reason code and       * 00065900
*       return code constants are defined within IWMYCON.  Note that  * 00066000
*       the high order halfword of register 0, and the reason code    * 00066100
*       variable when specified, may be non-zero and represents       * 00066200
*       diagnostic data which is NOT part of the external interface.  * 00066300
*       The high order halfword should thus be excluded from          * 00066400
*       comparison with the reason code values described above.  The  * 00066500
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00066600
*       used for this purpose.                                        * 00066700
*                                                                     * 00066800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00066900
*                                                                     * 00067000
*02*   PROCESSOR:  ASSEM                                              * 00067100
*                                                                     * 00067200
*01* COMPONENT:  SCWLM                                                * 00067300
*                                                                     * 00067400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00067500
*                                                                     * 00067600
*01* EXAMPLES:                                                        * 00067700
*                                                                     * 00067800
*    To change the service class of the job executing in the          * 00067900
*    ASID at location JOBASID:                                        * 00068000
*                                                                     * 00068100
*               IWMRESET ASID=JOBASID,SRVCLASS=SCNAME,USERID=USR,     * 00068200
*                    PRODUCT=PROD                                     * 00068300
*      *                                                              * 00068400
*      * Storage areas                                                * 00068500
*      *                                                              * 00068600
*      JOBASID   DS   H               Contains the address space id   * 00068700
*      *                              of the job                      * 00068800
*      SCNAME    DS   CL8             Contains the service class name * 00068900
*      *                              to assign to the job            * 00069000
*      USR       DS   CL8             Contains the id of the user who * 00069100
*      *                              is requesting the change        * 00069200
*      PROD      DS   CL8             Contains the product name of    * 00069300
*      *                              the code invoking IWMRESET      * 00069400
*                                                                     * 00069500
*                                                                     * 00069600
*01* MACRO USAGE NOTES:                                               * 00069700
*                                                                     * 00069800
*                                                                     * 00069900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00070000
*        global macro variable.  Any value other than 'NO' will       * 00070100
*        result in the macro expansion being printed.  The default is * 00070200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00070300
*        variable should be set.                                      * 00070400
*                                                                     * 00070500
*                    GBLC &ZPRINT                                     * 00070600
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00070700
*                                                                     * 00070800
*                                                                     * 00070900
*    2.  When using the NOCHECK option in conjunction with the Modify * 00071000
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00071100
*        Modify   or  Execute  form  invocation  which  specifies  or * 00071200
*        defaults  to  the  COMPLETE  option.   This insures that the * 00071300
*        parameter  list  is  initialized completely.   The parameter * 00071400
*        list  field which identifies the version number of the macro * 00071500
*        is only set when the Standard form or the Complete option of * 00071600
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00071700
*        explicitly  specified.  Be sure that the resulting parameter * 00071800
*        list version number covers all the keys that you use.        * 00071900
*                                                                     * 00072000
*                                                                     * 00072100
*    3.  All   keys   currently   contained  in  the  IWMRESET  macro * 00072200
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00072300
*        value of 0 or MAX.                                           * 00072400
*                                                                     * 00072500
*                                                                     * 00072600
*                                                                     * 00072700
*                                                                     * 00072800
*01* CHANGE ACTIVITY:                                                 * 00072900
*                                                                     * 00073000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00073100
*                                                                     * 00073200
*    $L0=WLMP     JBB6604 961029 B9HAGD:  Batch Initiator Management  * 00073300
****** END OF SPECIFICATIONS *****************************************/ 00073400
*/* TLINE 1 *********************************************************** 00073500
         MACRO                                                          00073600
&XLABEL  IWMRESET &JOBNAME=,&ASID=,&FUNCTION=,&SRVCLASS=,&PERFORM=,    *00073700
               &USERID=,&PRODUCT=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=   00073800
.*                                                                      00073900
*              MACDATE -04/02/97-<0>                                    00074000
.*                                                                      00074100
.*******************************************************************    00074200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00074300
.*******************************************************************    00074400
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00074500
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00074600
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00074700
.*                                                                      00074800
              GBLC  &ZIWMRESET  YES=MACRO USED AT LEAST ONCE            00074900
.*******************************************************************    00075000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00075100
.*******************************************************************    00075200
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00075300
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00075400
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00075500
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00075600
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00075700
              LCLA  &ZAWRK      USED AS A WORK AREA                     00075800
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00075900
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00076000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00076100
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00076200
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00076300
              LCLA  &ZMACRET    MACRO RETURN CODE                       00076400
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00076500
.*                                                                      00076600
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00076700
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00076800
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00076900
              LCLC  &ZENDBASEPL                 End of base PL          00077000
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00077100
.*******************************************************************    00077200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00077300
.*******************************************************************    00077400
              LCLA  &ZI         INDEX FOR ARRAY                         00077500
              LCLA  &ZJ         INDEX FOR PARMS                         00077600
              LCLA  &ZK         INDEX FOR PARSE                         00077700
              LCLA  &ZLO        LOW RANGE VALUE                         00077800
              LCLA  &ZHI        HIGH RANGE VALUE                        00077900
              LCLC  &ZW         WORK AREA FOR PARM                      00078000
.********************************************************************   00078100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00078200
.********************************************************************   00078300
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00078400
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00078500
.*                                                                      00078600
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00078700
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00078800
              SPLEVEL  TEST                                             00078900
.ZSYS2        ANOP  ,                                                   00079000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00079100
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00079200
              SYSSTATE TEST                                             00079300
              AGO   .ZSYS4                                              00079400
.ZSYS3        ANOP  ,                                                   00079500
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00079600
.ZSYS4        ANOP  ,                                                   00079700
.*******************************************************************    00079800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00079900
.*******************************************************************    00080000
              LCLC  &XJOBNAME   ++ NAME                                 00080100
              LCLC  &XASID      ++ NAME                                 00080200
              LCLC  &XFUNCTION  ++ VALUE                                00080300
              LCLC  &XRESETKEY  ++ NAME                                 00080400
              LCLC  &XSRVCLASS  ++ NAME                                 00080500
              LCLC  &XPERFORM   ++ NAME                                 00080600
              LCLC  &XUSERID    ++ NAME                                 00080700
              LCLC  &XPRODUCT   ++ NAME                                 00080800
              LCLC  &XRETCODE   ++ NAME                                 00080900
              LCLC  &XRSNCODE   ++ NAME                                 00081000
              LCLA  &XPLISTVER  ++ VALUE                                00081100
              LCLC  &XMF        ++ VALUE                                00081200
              LCLC  &XMFCTRL    ++ NAME                                 00081300
              LCLC  &XMFATTR    ++ VALUE                                00081400
              LCLC  &XMFSCK     ++ VALUE                                00081500
.*******************************************************************    00081600
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00081700
.*******************************************************************    00081800
              LCLC  &ZXJOBNAME  ++ INPUT NAME                           00081900
              LCLC  &ZXASID     ++ INPUT NAME                           00082000
              LCLC  &ZXFUNCTION                 ++ INPUT VALUE          00082100
              LCLC  &ZXRESETKEY                 ++ INPUT NAME           00082200
              LCLC  &ZXSRVCLASS                 ++ INPUT NAME           00082300
              LCLC  &ZXPERFORM  ++ INPUT NAME                           00082400
              LCLC  &ZXUSERID   ++ INPUT NAME                           00082500
              LCLC  &ZXPRODUCT  ++ INPUT NAME                           00082600
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00082700
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00082800
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00082900
              LCLC  &ZXMF       ++ INPUT VALUE                          00083000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00083100
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00083200
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00083300
.********************************************************************   00083400
.***AC.PLV01  PROCESS PLISTVER                                      *   00083500
.********************************************************************   00083600
&XPLISTVER      SETA  0                                                 00083700
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00083800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00083900
&XPLISTVER      SETA  0                                                 00084000
.ZPLV0          ANOP  ,                                                 00084100
.*                                                                      00084200
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00084300
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00084400
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00084500
.*-------------------------------------------------------------------   00084600
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00084700
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00084800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00084900
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00085000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00085100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00085200
                AGO   .ZPVCK2                                           00085300
.ZPVCK3         ANOP  ,                                                 00085400
.*-------------------------------------------------------------------   00085500
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00085600
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00085700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00085800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00085900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00086000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00086100
                AGO   .ZPVCKE                                           00086200
.ZPVCK2         ANOP  ,                                                 00086300
.*-------------------------------------------------------------------   00086400
&ZCVAL          SETC  '&PLISTVER(1)'                                    00086500
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00086600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00086700
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00086800
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00086900
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00087000
.ZPVCK6         ANOP  ,                                                 00087100
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00087200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00087300
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00087400
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00087500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00087600
&XPLISTVER      SETA  0                                                 00087700
                AGO   .ZPVCKE                                           00087800
.*-------------------------------------------------------------------   00087900
.ZPVCK4A        ANOP  ,                                                 00088000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00088100
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00088200
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00088300
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00088400
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00088500
                MNOTE 8,' &ZMS IS REQUIRED.'                            00088600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00088700
                AGO   .ZPVCK5                                           00088800
.ZPVCK4         ANOP  ,                                                 00088900
&XPLISTVER      SETA  &PLISTVER(1)                                      00089000
.ZPVCK5         ANOP  ,                                                 00089100
.ZPVCKE         ANOP  ,                                                 00089200
.********************************************************************   00089300
.***AG.MF01 PROCESS MF MACRO FORMS                                      00089400
.********************************************************************   00089500
              ACTR  10000                                               00089600
.*------------------------------------------------------------------    00089700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089800
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00089900
.*-------------------------------------------------------------------   00090000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090100
.ZG32         ANOP  ,                                                   00090200
&ZTLC         SETC 'S'                                                  00090300
              AIF   ('&MF(1)' NE '&ZTLC').ZG33                          00090400
&XMF          SETC  'S'         SET KEYWORD                             00090500
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00090600
              AIF   (N'&MF LE 1).ZG32A          CK NUM                  00090700
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00090800
&ZMS          SETC  '&ZMS.&MF"'                                         00090900
&ZMS          SETC  '&ZMS "MF"'                                         00091000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00091100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00091200
.ZG32A        ANOP  ,                                                   00091300
.*-------------------------------------------------------------------   00091400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091500
.ZG33         ANOP  ,                                                   00091600
&ZTLC         SETC 'L'                                                  00091700
              AIF   ('&MF(1)' NE '&ZTLC').ZG40                          00091800
&XMF          SETC  'L'         SET KEYWORD                             00091900
              AIF   (N'&MF LE 3).ZG33A          CK NUM                  00092000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00092100
&ZMS          SETC  '&ZMS.&MF"'                                         00092200
&ZMS          SETC  '&ZMS "MF"'                                         00092300
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00092400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00092500
.ZG33A        ANOP  ,                                                   00092600
.*-------------------------------------------------------------------   00092700
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00092800
              AIF   (N'&SYSLIST NE 0).ZG33B     POSITIONALS?            00092900
              AIF   ('&JOBNAME' NE '').ZG33B    KEYS?                   00093000
              AIF   ('&ASID' NE '').ZG33B       KEYS?                   00093100
              AIF   ('&FUNCTION' NE '').ZG33B   KEYS?                   00093200
              AIF   ('&SRVCLASS' NE '').ZG33B   KEYS?                   00093300
              AIF   ('&PERFORM' NE '').ZG33B    KEYS?                   00093400
              AIF   ('&USERID' NE '').ZG33B     KEYS?                   00093500
              AIF   ('&PRODUCT' NE '').ZG33B    KEYS?                   00093600
              AIF   ('&RETCODE' NE '').ZG33B    KEYS?                   00093700
              AIF   ('&RSNCODE' NE '').ZG33B    KEYS?                   00093800
              AGO    .ZG33C     INVOCATION OKAY                         00093900
.ZG33B        ANOP  ,                                                   00094000
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            00094100
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00094200
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00094300
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00094400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094500
.ZG33C        ANOP  ,                                                   00094600
.*-------------------------------------------------------------------   00094700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00094800
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00094900
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00095000
              AIF   (N'&MF(2) GT 1).ZG35B       MULTI PARMS             00095100
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00095200
.ZG35B        AIF   (K'&MF(2) GT 0).ZG35C                               00095300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00095400
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00095500
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00095600
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00095700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095800
.ZG35C        ANOP  ,                                                   00095900
.*-------------------------------------------------------------------   00096000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00096100
              AIF   (K'&ZXMFCTRL LE 0).ZG35P    NOT I/O                 00096200
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG35P                      00096300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00096400
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00096500
&ZMS          SETC  '&ZMS.&MF"'                                         00096600
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00096700
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00096800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00096900
.ZG35P        ANOP  ,                                                   00097000
.*-------------------------------------------------------------------   00097100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00097200
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00097300
&XMFATTR      SETC  '0D'                                                00097400
              AIF   (K'&MF(3) LE 0).ZG38B       PARM                    00097500
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00097600
              AIF   (N'&MF(3) GT 1).ZG38B       MULTI PARMS             00097700
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00097800
.ZG38B        ANOP  ,                                                   00097900
.*-------------------------------------------------------------------   00098000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00098100
              AIF   (K'&ZXMFATTR LE 0).ZG38P    NOT I/O                 00098200
              AIF   ('&XMFATTR'(1,1) NE '(').ZG38P                      00098300
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00098400
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00098500
&ZMS          SETC  '&ZMS.&MF"'                                         00098600
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00098700
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00098800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098900
.ZG38P        ANOP  ,                                                   00099000
.*-------------------------------------------------------------------   00099100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00099200
              AIF   (K'&ZXMFATTR LE 0).ZG38S    NOT I/O                 00099300
              AIF   (K'&XMFATTR LE 60).ZG38S    LNG OK                  00099400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00099500
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00099600
&ZMS          SETC  '&ZMS.&MF"'                                         00099700
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00099800
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00099900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00100000
.ZG38S        ANOP  ,                                                   00100100
.*-------------------------------------------------------------------   00100200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100300
.ZG40         ANOP  ,                                                   00100400
&ZTLC         SETC 'M'                                                  00100500
              AIF   ('&MF(1)' NE '&ZTLC').ZG49                          00100600
&XMF          SETC  'M'         SET KEYWORD                             00100700
              AIF   (N'&MF LE 3).ZG40A          CK NUM                  00100800
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00100900
&ZMS          SETC  '&ZMS.&MF"'                                         00101000
&ZMS          SETC  '&ZMS "MF"'                                         00101100
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00101200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101300
.ZG40A        ANOP  ,                                                   00101400
.*-------------------------------------------------------------------   00101500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00101600
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00101700
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00101800
              AIF   (N'&MF(2) GT 1).ZG42B       MULTI PARMS             00101900
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00102000
.ZG42B        AIF   (K'&MF(2) GT 0).ZG42C                               00102100
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00102200
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 00102300
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00102400
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00102500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102600
.ZG42C        ANOP  ,                                                   00102700
.*-------------------------------------------------------------------   00102800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00102900
              AIF   (K'&ZXMFCTRL LE 0).ZG42R    NOT I/O                 00103000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG42R                      00103100
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00103200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                        00103300
              AIF   (K'&ZCGPR GT 2).ZG42Q                               00103400
              AIF   ('&ZCGPR' EQ '0').ZG42Q                             00103500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00103600
              AIF   (T'&ZCGPR NE 'N').ZG42Q     INVALID REG NAME        00103700
.ZG42P        ANOP  ,                                                   00103800
              AIF   (T'&ZCGPR NE 'N').ZG42R     NON NUMERIC             00103900
              AIF   ('&ZCGPR' LT '1').ZG42Q                             00104000
              AIF   ('&ZCGPR' LE '12').ZG42R                            00104100
.ZG42Q        ANOP  ,                                                   00104200
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00104300
&ZMS          SETC  '&ZMS.&MF"'                                         00104400
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00104500
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00104600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104700
.ZG42R        ANOP  ,                                                   00104800
.*-------------------------------------------------------------------   00104900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00105100
.ZG46A   AIF   ('&MF(3)' NE 'COMPLETE').ZG47A                           00105200
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00105300
.*-------------------------------------------------------------------   00105400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105500
.ZG47A   AIF   ('&MF(3)' NE 'NOCHECK').ZG48A                            00105600
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00105700
.*-------------------------------------------------------------------   00105800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105900
.ZG48A        AIF   (K'&XMFSCK GT 0).ZG48C      KEYWORD                 00106000
              AIF   (K'&MF(3) LE 0).ZG48B                               00106100
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00106200
&ZMS          SETC  '&ZMS.&MF"'                                         00106300
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00106400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00106500
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00106600
&ZMS          SETC  '&ZMS OR "NOCHECK".'        VALID KEYWORD           00106700
              MNOTE 8,' &ZMS '                                          00106800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00106900
.ZG48B        ANOP  ,                                                   00107000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00107100
.ZG48C        ANOP  ,                                                   00107200
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00107300
.*-------------------------------------------------------------------   00107400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107500
.ZG49         ANOP  ,                                                   00107600
&ZTLC         SETC 'E'                                                  00107700
              AIF   ('&MF(1)' NE '&ZTLC').ZG58                          00107800
&XMF          SETC  'E'         SET KEYWORD                             00107900
              AIF   (N'&MF LE 3).ZG49A          CK NUM                  00108000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00108100
&ZMS          SETC  '&ZMS.&MF"'                                         00108200
&ZMS          SETC  '&ZMS "MF"'                                         00108300
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00108400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00108500
.ZG49A        ANOP  ,                                                   00108600
.*-------------------------------------------------------------------   00108700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00108800
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00108900
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00109000
              AIF   (N'&MF(2) GT 1).ZG51B       MULTI PARMS             00109100
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00109200
.ZG51B        AIF   (K'&MF(2) GT 0).ZG51C                               00109300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00109400
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00109500
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00109600
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00109700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00109800
.ZG51C        ANOP  ,                                                   00109900
.*-------------------------------------------------------------------   00110000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00110100
              AIF   (K'&ZXMFCTRL LE 0).ZG51R    NOT I/O                 00110200
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG51R                      00110300
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00110400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG51P                        00110500
              AIF   (K'&ZCGPR GT 2).ZG51Q                               00110600
              AIF   ('&ZCGPR' EQ '0').ZG51Q                             00110700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00110800
              AIF   (T'&ZCGPR NE 'N').ZG51Q     INVALID REG NAME        00110900
.ZG51P        ANOP  ,                                                   00111000
              AIF   (T'&ZCGPR NE 'N').ZG51R     NON NUMERIC             00111100
              AIF   ('&ZCGPR' LT '1').ZG51Q                             00111200
              AIF   ('&ZCGPR' LE '12').ZG51R                            00111300
.ZG51Q        ANOP  ,                                                   00111400
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00111500
&ZMS          SETC  '&ZMS.&MF"'                                         00111600
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00111700
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00111800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00111900
.ZG51R        ANOP  ,                                                   00112000
.*-------------------------------------------------------------------   00112100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00112200
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00112300
.ZG55A   AIF   ('&MF(3)' NE 'COMPLETE').ZG56A                           00112400
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00112500
.*-------------------------------------------------------------------   00112600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00112700
.ZG56A   AIF   ('&MF(3)' NE 'NOCHECK').ZG57A                            00112800
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00112900
.*-------------------------------------------------------------------   00113000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00113100
.ZG57A        AIF   (K'&XMFSCK GT 0).ZG57C      KEYWORD                 00113200
              AIF   (K'&MF(3) LE 0).ZG57B                               00113300
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00113400
&ZMS          SETC  '&ZMS.&MF"'                                         00113500
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00113600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00113700
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00113800
&ZMS          SETC  '&ZMS OR "NOCHECK".'        VALID KEYWORD           00113900
              MNOTE 8,' &ZMS '                                          00114000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114100
.ZG57B        ANOP  ,                                                   00114200
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00114300
.ZG57C        ANOP  ,                                                   00114400
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00114500
.*------------------------------------------------------------------    00114600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114700
.ZG58         ANOP  ,                                                   00114800
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00114900
              AIF   (K'&XMF GT 0).ZG58E         VALID ARG               00115000
              AIF   (T'&MF EQ 'O').ZG58D        OMITTED                 00115100
&ZASYSLNDX    SETA  0                                                   00115200
.ZG58A        ANOP  ,           POSITIONAL MACRO KEY                    00115300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00115400
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG58C                    00115500
&ZTLC         SETC 'MF'                                                 00115600
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG58A           00115700
.ZG58B        ANOP  ,                                                   00115800
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00115900
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00116000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00116100
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00116200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116300
              AGO   .ZG58E                                              00116400
.ZG58C        ANOP  ,                                                   00116500
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00116600
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00116700
&ZMS          SETC  '&ZMS.&MF"'                                         00116800
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00116900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00117000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00117100
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00117200
&ZMS          SETC  '&ZMS "M",'                 VALID KEYWORD           00117300
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           00117400
              MNOTE 8,' &ZMS '                                          00117500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00117600
              AGO   .ZG58E                                              00117700
.ZG58D        ANOP  ,                                                   00117800
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00117900
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00118000
.ZG58E        ANOP  ,                                                   00118100
.********************************************************************   00118200
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00118300
.********************************************************************   00118400
              ACTR  10000                                               00118500
.*-------------------------------------------------------------------   00118600
.***AG.MF03 MF=(SLME)                                                   00118700
              AIF   ('&XMF' EQ 'L').ZGMFX                               00118800
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00118900
.*----------------------------------------------------------------***   00119000
.***AG.KMGRP05 NAME,  INPUT, ME GROUP -XVARIABLE KEY                    00119100
              AIF   (N'&JOBNAME LE 1).ZG2A      CK NUM                  00119200
&ZMS          SETC  '"JOBNAME='                 *KPOSA* MNOTE           00119300
&ZMS          SETC  '&ZMS.&JOBNAME"'                                    00119400
&ZMS          SETC  '&ZMS "JOBNAME"'                                    00119500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00119600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119700
.ZG2A         ANOP  ,                                                   00119800
.*-------------------------------------------------------------------   00119900
.***AG.KMGRP06 NAME,  INPUT, ME GROUP -XVARIABLE                        00120000
&ZXJOBNAME    SETC  'INPUT'     SET IN/OUTPUT                           00120100
&XJOBNAME     SETC  '&JOBNAME(1)'               SET XVARIABLE           00120200
              AIF   (N'&JOBNAME GT 1).ZG2B      MULTIPLE PARMS          00120300
&XJOBNAME     SETC  '&JOBNAME'  SET XVARIABLE                           00120400
.ZG2B         AIF   (K'&JOBNAME(1) GT 0).ZG2C                           00120500
&ZXJOBNAME    SETC  ''          RESET IN/OUTPUT                         00120600
.ZG2C         ANOP  ,                                                   00120700
.*-------------------------------------------------------------------   00120800
.***AG.KCK02 NAME,  INPUT, ME GROUP -GPR OUT OF RANGE                   00120900
              AIF   (K'&ZXJOBNAME LE 0).ZG2R    NOT I/O                 00121000
              AIF   ('&XJOBNAME'(1,1) NE '(').ZG2R                      00121100
&ZCGPR        SETC  '&XJOBNAME'(2,K'&XJOBNAME-2)                        00121200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         00121300
              AIF   (K'&ZCGPR GT 2).ZG2Q                                00121400
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              00121500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00121600
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        00121700
.ZG2P         ANOP  ,                                                   00121800
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             00121900
              AIF   ('&ZCGPR' LT '2').ZG2Q                              00122000
              AIF   ('&ZCGPR' LE '12').ZG2R                             00122100
.ZG2Q         ANOP  ,                                                   00122200
&ZMS          SETC  '"JOBNAME='                 *KGPRA* MNOTE           00122300
&ZMS          SETC  '&ZMS.&JOBNAME"'                                    00122400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00122500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00122600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122700
.ZG2R         ANOP  ,                                                   00122800
.*----------------------------------------------------------------***   00122900
.***AG.KMGRP05 NAME,  INPUT, ME GROUP -XVARIABLE KEY                    00123000
              AIF   (N'&ASID LE 1).ZG3A         CK NUM                  00123100
&ZMS          SETC  '"ASID='    *KPOSA* MNOTE                           00123200
&ZMS          SETC  '&ZMS.&ASID"'                                       00123300
&ZMS          SETC  '&ZMS "ASID"'                                       00123400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00123500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123600
.ZG3A         ANOP  ,                                                   00123700
.*-------------------------------------------------------------------   00123800
.***AG.KMGRP06 NAME,  INPUT, ME GROUP -XVARIABLE                        00123900
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           00124000
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           00124100
              AIF   (N'&ASID GT 1).ZG3B         MULTIPLE PARMS          00124200
&XASID        SETC  '&ASID'     SET XVARIABLE                           00124300
.ZG3B         AIF   (K'&ASID(1) GT 0).ZG3C                              00124400
&ZXASID       SETC  ''          RESET IN/OUTPUT                         00124500
.ZG3C         ANOP  ,                                                   00124600
.*-------------------------------------------------------------------   00124700
.***AG.KCK02 NAME,  INPUT, ME GROUP -GPR OUT OF RANGE                   00124800
              AIF   (K'&ZXASID LE 0).ZG3R       NOT I/O                 00124900
              AIF   ('&XASID'(1,1) NE '(').ZG3R                         00125000
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00125100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                         00125200
              AIF   (K'&ZCGPR GT 2).ZG3Q                                00125300
              AIF   ('&ZCGPR' EQ '0').ZG3Q                              00125400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00125500
              AIF   (T'&ZCGPR NE 'N').ZG3Q      INVALID REG NAME        00125600
.ZG3P         ANOP  ,                                                   00125700
              AIF   (T'&ZCGPR NE 'N').ZG3R      NON NUMERIC             00125800
              AIF   ('&ZCGPR' LT '2').ZG3Q                              00125900
              AIF   ('&ZCGPR' LE '12').ZG3R                             00126000
.ZG3Q         ANOP  ,                                                   00126100
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           00126200
&ZMS          SETC  '&ZMS.&ASID"'                                       00126300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00126400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00126500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126600
.ZG3R         ANOP  ,                                                   00126700
.*-------------------------------------------------------------------   00126800
.***AG.KMGRP11 NAME,  INPUT, ME GROUP -AT LEAST ONE SPECIFIED           00126900
&ZCVAL        SETC ''           ERROR KEY FIELD                         00127000
              AIF   (K'&XJOBNAME GT 0).ZG4J                             00127100
&ZCVAL        SETC '&ZCVAL,JOBNAME'             NOT USED KEY            00127200
              AIF   (K'&XASID GT 0).ZG4J                                00127300
&ZCVAL        SETC '&ZCVAL,ASID'                NOT USED KEY            00127400
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00127500
&ZMS          SETC  'ONE OR MORE OF THE'        *MGRPA* MNOTE           00127600
&ZMS          SETC  '&ZMS FOLLOWING KEY(S) IS REQUIRED: '               00127700
&ZMS          SETC  '&ZMS "JOBNAME",'                                   00127800
              MNOTE 8,' &ZMS " ASID".'                                  00127900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128000
.ZG4J         ANOP  ,                                                   00128100
.ZG4K         ANOP  ,                                                   00128200
.*-------------------------------------------------------------------   00128300
.***AG.KCK02 NAME,  INPUT, ME GROUP -GPR OUT OF RANGE                   00128400
              AIF   (K'&ZXASID LE 0).ZG4R       NOT I/O                 00128500
              AIF   ('&XASID'(1,1) NE '(').ZG4R                         00128600
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00128700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         00128800
              AIF   (K'&ZCGPR GT 2).ZG4Q                                00128900
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              00129000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00129100
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        00129200
.ZG4P         ANOP  ,                                                   00129300
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             00129400
              AIF   ('&ZCGPR' LT '2').ZG4Q                              00129500
              AIF   ('&ZCGPR' LE '12').ZG4R                             00129600
.ZG4Q         ANOP  ,                                                   00129700
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           00129800
&ZMS          SETC  '&ZMS.&ASID"'                                       00129900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00130000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00130100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00130200
.ZG4R         ANOP  ,                                                   00130300
.*------------------------------------------------------------------    00130400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130500
&XFUNCTION    SETC  ''          INITIALIZE XVARIABLE                    00130600
.*-------------------------------------------------------------------   00130700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130800
.ZG7          ANOP  ,                                                   00130900
              AIF   (K'&FUNCTION(1) LE 0).ZG7A                          00131000
&ZTLC         SETC 'RESET'                                              00131100
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG12                    00131200
&XFUNCTION    SETC  'RESET'     SET KEYWORD                             00131300
              AIF   (N'&FUNCTION LE 1).ZG7A     CK NUM                  00131400
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           00131500
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00131600
&ZMS          SETC  '&ZMS "FUNCTION"'                                   00131700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00131800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131900
.ZG7A         ANOP  ,                                                   00132000
.*----------------------------------------------------------------***   00132100
.***AG.KMEKY01 NAME, OPT RQD INPUT, ME KEYS -XVARIABLE                  00132200
&XRESETKEY    SETC  ''          INITIALIZE XVARIABLE                    00132300
              AIF   (K'&SRVCLASS LE 0).ZG9C                             00132400
&ZXRESETKEY   SETC  'INPUT'     SET IN/OUTPUT                           00132500
&XRESETKEY    SETC  'SRVCLASS'  SET XVARIABLE                           00132600
&ZXSRVCLASS   SETC  'INPUT'     SET IN/OUTPUT                           00132700
&XSRVCLASS    SETC  '&SRVCLASS(1)'              SET XVARIABLE PARM      00132800
              AIF   (N'&SRVCLASS GT 1).ZG9A     MULTIPLE PARMS          00132900
&XSRVCLASS    SETC  '&SRVCLASS'                 SET XVARIABLE PARM      00133000
.ZG9A         AIF   (N'&SRVCLASS LE 1).ZG9B     CK NUM                  00133100
&ZMS          SETC  '"SRVCLASS='                *KPOSA* MNOTE           00133200
&ZMS          SETC  '&ZMS.&SRVCLASS"'                                   00133300
&ZMS          SETC  '&ZMS "SRVCLASS"'                                   00133400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00133500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133600
.ZG9B         AIF   (K'&XSRVCLASS GT 0).ZG9C    ONE PARM                00133700
&ZXRESETKEY   SETC  ''          RESET IN/OUTPUT                         00133800
&ZXSRVCLASS   SETC  ''          RESET IN/OUTPUT                         00133900
&ZMS          SETC  ' '         *KRQDA*                                 00134000
&ZMS          SETC  '&ZMS "SRVCLASS" KEY AND ITS ARGUMENT'              00134100
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00134200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134300
.ZG9C         ANOP  ,                                                   00134400
.*----------------------------------------------------------------***   00134500
.***AG.KMEKY02 NAME, OPT RQD INPUT, ME KEYS -XVARIABLE                  00134600
              AIF   (K'&PERFORM LE 0).ZG10D     NO ME KEY               00134700
              AIF   (N'&PERFORM LE 1).ZG10A     CK NUM                  00134800
&ZMS          SETC  '"PERFORM='                 *KPOSA* MNOTE           00134900
&ZMS          SETC  '&ZMS.&PERFORM"'                                    00135000
&ZMS          SETC  '&ZMS "PERFORM"'                                    00135100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00135200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00135300
.ZG10A        AIF   (K'&XRESETKEY LE 0).ZG10B                           00135400
&ZMS          SETC  '"PERFORM'  *KMEKA* MNOTE                           00135500
&ZMS          SETC  '&ZMS.=&PERFORM"'                                   00135600
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00135700
&ZMS          SETC  '&ZMS "&XRESETKEY"'                                 00135800
              MNOTE 8,' &ZMS KEY.'                                      00135900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136000
              AGO   .ZG10D                                              00136100
.*                                                                      00136200
.ZG10B        ANOP  ,                                                   00136300
&ZXRESETKEY   SETC  'INPUT'     SET IN/OUTPUT                           00136400
&XRESETKEY    SETC  'PERFORM'   SET XVARIABLE                           00136500
&ZXPERFORM    SETC  'INPUT'     SET IN/OUTPUT                           00136600
&XPERFORM     SETC  '&PERFORM(1)'               SET XVARIABLE PARM      00136700
              AIF   (N'&PERFORM GT 1).ZG10C     MULTIPLE PARMS          00136800
&XPERFORM     SETC  '&PERFORM'  SET XVARIABLE PARM                      00136900
.ZG10C        AIF   (K'&XPERFORM GT 0).ZG10D    ONE PARM                00137000
&ZXRESETKEY   SETC  ''          RESET IN/OUTPUT                         00137100
&ZXPERFORM    SETC  ''          RESET IN/OUTPUT                         00137200
&ZMS          SETC  ' '         *KRQDA*                                 00137300
&ZMS          SETC  '&ZMS "PERFORM" KEY AND ITS ARGUMENT'               00137400
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00137500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00137600
.ZG10D        ANOP  ,                                                   00137700
.*------------------------------------------------------------------    00137800
.***AG.KME4Y09 NAME, OPT RQD INPUT, ME KEYS -CHECK IF KEY ENTERED       00137900
              AIF   (K'&XRESETKEY GT 0).ZG11B                           00138000
&ZXRESETKEY   SETC  ''          RESET IN/OUTPUT                         00138100
&ZXSRVCLASS   SETC  ''          RESET IN/OUTPUT                         00138200
&XRESETKEY    SETC  ''          ENSURE NULL                             00138300
&XSRVCLASS    SETC  ''          ENSURE NULL                             00138400
&ZMS          SETC  'ONE OF THE FOLLOWING'      *KMERA* MNOTE           00138500
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 00138600
&ZMS          SETC  '&ZMS REQUIRED:'                                    00138700
&ZMS          SETC  '&ZMS "SRVCLASS"'           VALID ME KEY            00138800
&ZMS          SETC  '&ZMS OR "PERFORM".'        VALID ME KEY            00138900
              MNOTE 8,' &ZMS '                                          00139000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00139100
.ZG11B        ANOP  ,                                                   00139200
.*-------------------------------------------------------------------   00139300
.***AG.KMEKY13 NAME, OPT RQD INPUT, ME KEYS -PROCESS DEPENDENCIES       00139400
.ZG9          AIF   ('&XRESETKEY' NE 'SRVCLASS').ZG10                   00139500
.*-------------------------------------------------------------------   00139600
.***AG.KCK02 NAME, OPT RQD INPUT, ME KEYS -GPR OUT OF RANGE             00139700
              AIF   (K'&ZXSRVCLASS LE 0).ZG9R   NOT I/O                 00139800
              AIF   ('&XSRVCLASS'(1,1) NE '(').ZG9R                     00139900
&ZCGPR        SETC  '&XSRVCLASS'(2,K'&XSRVCLASS-2)                      00140000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                         00140100
              AIF   (K'&ZCGPR GT 2).ZG9Q                                00140200
              AIF   ('&ZCGPR' EQ '0').ZG9Q                              00140300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00140400
              AIF   (T'&ZCGPR NE 'N').ZG9Q      INVALID REG NAME        00140500
.ZG9P         ANOP  ,                                                   00140600
              AIF   (T'&ZCGPR NE 'N').ZG9R      NON NUMERIC             00140700
              AIF   ('&ZCGPR' LT '2').ZG9Q                              00140800
              AIF   ('&ZCGPR' LE '12').ZG9R                             00140900
.ZG9Q         ANOP  ,                                                   00141000
&ZMS          SETC  '"SRVCLASS='                *KGPRA* MNOTE           00141100
&ZMS          SETC  '&ZMS.&SRVCLASS"'                                   00141200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00141300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00141400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141500
.ZG9R         ANOP  ,                                                   00141600
.*-------------------------------------------------------------------   00141700
.***AG.KMEKY13 NAME, OPT RQD INPUT, ME KEYS -PROCESS DEPENDENCIES       00141800
.ZG10         AIF   ('&XRESETKEY' NE 'PERFORM').ZG11                    00141900
.*-------------------------------------------------------------------   00142000
.***AG.KCK02 NAME, OPT RQD INPUT, ME KEYS -GPR OUT OF RANGE             00142100
              AIF   (K'&ZXPERFORM LE 0).ZG10R   NOT I/O                 00142200
              AIF   ('&XPERFORM'(1,1) NE '(').ZG10R                     00142300
&ZCGPR        SETC  '&XPERFORM'(2,K'&XPERFORM-2)                        00142400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00142500
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00142600
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00142700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00142800
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00142900
.ZG10P        ANOP  ,                                                   00143000
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00143100
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00143200
              AIF   ('&ZCGPR' LE '12').ZG10R                            00143300
.ZG10Q        ANOP  ,                                                   00143400
&ZMS          SETC  '"PERFORM='                 *KGPRA* MNOTE           00143500
&ZMS          SETC  '&ZMS.&PERFORM"'                                    00143600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00143700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00143800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00143900
.ZG10R        ANOP  ,                                                   00144000
.*-------------------------------------------------------------------   00144100
.***AG.KMEKY15 NAME, OPT RQD INPUT, ME KEYS -END                        00144200
.ZG11         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00144300
.*-------------------------------------------------------------------   00144400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144500
.ZG12         ANOP  ,                                                   00144600
&ZTLC         SETC 'QUIESCE'                                            00144700
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG13                    00144800
&XFUNCTION    SETC  'QUIESCE'   SET KEYWORD                             00144900
              AIF   (N'&FUNCTION LE 1).ZG12A    CK NUM                  00145000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           00145100
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00145200
&ZMS          SETC  '&ZMS "FUNCTION"'                                   00145300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00145400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145500
.ZG12A        ANOP  ,                                                   00145600
.*------------------------------------------------------------------    00145700
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145800
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00145900
.ZG12A0       AIF   (K'&SRVCLASS LE 0).ZG12A1   OK                      00146000
&ZCVAL        SETC '&ZCVAL SRVCLASS'            INCORRECT KEY USED      00146100
.ZG12A1       AIF   (K'&PERFORM LE 0).ZG12A2    OK                      00146200
&ZCVAL        SETC '&ZCVAL PERFORM'             INCORRECT KEY USED      00146300
.ZG12A2       AIF   (K'&ZCVAL LE 0).ZG12A3      OK                      00146400
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00146500
&ZMS          SETC  '"FUNCTION'                 *KMEIA* MNOTE           00146600
&ZMS          SETC  '&ZMS.=&FUNCTION"'                                  00146700
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00146800
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00146900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00147000
.ZG12A3       ANOP  ,                                                   00147100
.*-------------------------------------------------------------------   00147200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147300
.ZG13         ANOP  ,                                                   00147400
&ZTLC         SETC 'RESUME'                                             00147500
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG14                    00147600
&XFUNCTION    SETC  'RESUME'    SET KEYWORD                             00147700
              AIF   (N'&FUNCTION LE 1).ZG13A    CK NUM                  00147800
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           00147900
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00148000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   00148100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00148200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148300
.ZG13A        ANOP  ,                                                   00148400
.*------------------------------------------------------------------    00148500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148600
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00148700
.ZG13A0       AIF   (K'&SRVCLASS LE 0).ZG13A1   OK                      00148800
&ZCVAL        SETC '&ZCVAL SRVCLASS'            INCORRECT KEY USED      00148900
.ZG13A1       AIF   (K'&PERFORM LE 0).ZG13A2    OK                      00149000
&ZCVAL        SETC '&ZCVAL PERFORM'             INCORRECT KEY USED      00149100
.ZG13A2       AIF   (K'&ZCVAL LE 0).ZG13A3      OK                      00149200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00149300
&ZMS          SETC  '"FUNCTION'                 *KMEIA* MNOTE           00149400
&ZMS          SETC  '&ZMS.=&FUNCTION"'                                  00149500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00149600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00149700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149800
.ZG13A3       ANOP  ,                                                   00149900
.*------------------------------------------------------------------    00150000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150100
.ZG14         ANOP  ,                                                   00150200
&ZXFUNCTION   SETC  'INPUT'     SET IN/OUTPUT                           00150300
              AIF   (K'&XFUNCTION GT 0).ZG14E   VALID ARG               00150400
              AIF   (T'&FUNCTION EQ 'O').ZG14D  OMITTED                 00150500
&ZASYSLNDX    SETA  0                                                   00150600
.ZG14A        ANOP  ,           POSITIONAL MACRO KEY                    00150700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00150800
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG14C                    00150900
&ZTLC         SETC 'FUNCTION'                                           00151000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG14A           00151100
.ZG14B        ANOP  ,                                                   00151200
&ZXFUNCTION   SETC  ''          RESET IN/OUTPUT                         00151300
&ZMS          SETC  'THE "FUNCTION" KEY'        *KOPTA* MNOTE           00151400
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00151500
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00151600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151700
              AGO   .ZG14E                                              00151800
.ZG14C        ANOP  ,                                                   00151900
&ZXFUNCTION   SETC  ''          RESET IN/OUTPUT                         00152000
&ZMS          SETC  '"FUNCTION='                *KUKWA* MNOTE           00152100
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00152200
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00152300
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00152400
&ZMS          SETC  '&ZMS "RESET",'             VALID KEYWORD           00152500
&ZMS          SETC  '&ZMS "QUIESCE",'           VALID KEYWORD           00152600
&ZMS          SETC  '&ZMS OR "RESUME".'         VALID KEYWORD           00152700
              MNOTE 8,' &ZMS '                                          00152800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00152900
              AGO   .ZG14E                                              00153000
.ZG14D        ANOP  ,                                                   00153100
&XFUNCTION    SETC  'RESET'     SET DEFAULT KEYWORD                     00153200
.ZG14E        ANOP  ,                                                   00153300
.*----------------------------------------------------------------***   00153400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00153500
              AIF   (N'&USERID LE 1).ZG16A      CK NUM                  00153600
&ZMS          SETC  '"USERID='  *KPOSA* MNOTE                           00153700
&ZMS          SETC  '&ZMS.&USERID"'                                     00153800
&ZMS          SETC  '&ZMS "USERID"'                                     00153900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00154000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00154100
.ZG16A        ANOP  ,                                                   00154200
.*-------------------------------------------------------------------   00154300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00154400
&ZXUSERID     SETC  'INPUT'     SET IN/OUTPUT                           00154500
&XUSERID      SETC  '&USERID(1)'                SET XVARIABLE           00154600
              AIF   (N'&USERID GT 1).ZG16B      MULTI PARMS             00154700
&XUSERID      SETC  '&USERID'   SET XVARIABLE                           00154800
.ZG16B        AIF   (K'&USERID(1) GT 0).ZG16C                           00154900
&ZXUSERID     SETC  ''          RESET IN/OUTPUT                         00155000
&ZMS          SETC  ' '         *KRQDA*                                 00155100
&ZMS          SETC  '&ZMS "USERID" KEY AND ITS ARGUMENT'                00155200
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00155300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155400
.ZG16C        ANOP  ,                                                   00155500
.*-------------------------------------------------------------------   00155600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00155700
              AIF   (K'&ZXUSERID LE 0).ZG16R    NOT I/O                 00155800
              AIF   ('&XUSERID'(1,1) NE '(').ZG16R                      00155900
&ZCGPR        SETC  '&XUSERID'(2,K'&XUSERID-2)                          00156000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        00156100
              AIF   (K'&ZCGPR GT 2).ZG16Q                               00156200
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             00156300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00156400
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        00156500
.ZG16P        ANOP  ,                                                   00156600
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             00156700
              AIF   ('&ZCGPR' LT '2').ZG16Q                             00156800
              AIF   ('&ZCGPR' LE '12').ZG16R                            00156900
.ZG16Q        ANOP  ,                                                   00157000
&ZMS          SETC  '"USERID='  *KGPRA* MNOTE                           00157100
&ZMS          SETC  '&ZMS.&USERID"'                                     00157200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00157300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00157400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157500
.ZG16R        ANOP  ,                                                   00157600
.*----------------------------------------------------------------***   00157700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00157800
              AIF   (N'&PRODUCT LE 1).ZG19A     CK NUM                  00157900
&ZMS          SETC  '"PRODUCT='                 *KPOSA* MNOTE           00158000
&ZMS          SETC  '&ZMS.&PRODUCT"'                                    00158100
&ZMS          SETC  '&ZMS "PRODUCT"'                                    00158200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00158300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158400
.ZG19A        ANOP  ,                                                   00158500
.*-------------------------------------------------------------------   00158600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00158700
&ZXPRODUCT    SETC  'INPUT'     SET IN/OUTPUT                           00158800
&XPRODUCT     SETC  '&PRODUCT(1)'               SET XVARIABLE           00158900
              AIF   (N'&PRODUCT GT 1).ZG19B     MULTI PARMS             00159000
&XPRODUCT     SETC  '&PRODUCT'  SET XVARIABLE                           00159100
.ZG19B        AIF   (K'&PRODUCT(1) GT 0).ZG19C                          00159200
&ZXPRODUCT    SETC  ''          RESET IN/OUTPUT                         00159300
&ZMS          SETC  ' '         *KRQDA*                                 00159400
&ZMS          SETC  '&ZMS "PRODUCT" KEY AND ITS ARGUMENT'               00159500
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00159600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00159700
.ZG19C        ANOP  ,                                                   00159800
.*-------------------------------------------------------------------   00159900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00160000
              AIF   (K'&ZXPRODUCT LE 0).ZG19R   NOT I/O                 00160100
              AIF   ('&XPRODUCT'(1,1) NE '(').ZG19R                     00160200
&ZCGPR        SETC  '&XPRODUCT'(2,K'&XPRODUCT-2)                        00160300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        00160400
              AIF   (K'&ZCGPR GT 2).ZG19Q                               00160500
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             00160600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00160700
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        00160800
.ZG19P        ANOP  ,                                                   00160900
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             00161000
              AIF   ('&ZCGPR' LT '2').ZG19Q                             00161100
              AIF   ('&ZCGPR' LE '12').ZG19R                            00161200
.ZG19Q        ANOP  ,                                                   00161300
&ZMS          SETC  '"PRODUCT='                 *KGPRA* MNOTE           00161400
&ZMS          SETC  '&ZMS.&PRODUCT"'                                    00161500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00161600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00161700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00161800
.ZG19R        ANOP  ,                                                   00161900
.*----------------------------------------------------------------***   00162000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00162100
              AIF   (N'&RETCODE LE 1).ZG22A     CK NUM                  00162200
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00162300
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00162400
&ZMS          SETC  '&ZMS "RETCODE"'                                    00162500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00162600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162700
.ZG22A        ANOP  ,                                                   00162800
.*-------------------------------------------------------------------   00162900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00163000
              AIF   (K'&RETCODE(1) LE 0).ZG22C  NO PARM                 00163100
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00163200
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00163300
              AIF   (N'&RETCODE GT 1).ZG22C                             00163400
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00163500
.ZG22C        ANOP  ,                                                   00163600
.*-------------------------------------------------------------------   00163700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00163800
              AIF   (K'&ZXRETCODE LE 0).ZG22R   NOT I/O                 00163900
              AIF   ('&XRETCODE'(1,1) NE '(').ZG22R                     00164000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00164100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                        00164200
              AIF   (K'&ZCGPR GT 2).ZG22Q                               00164300
              AIF   ('&ZCGPR' EQ '0').ZG22Q                             00164400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00164500
              AIF   (T'&ZCGPR NE 'N').ZG22Q     INVALID REG NAME        00164600
.ZG22P        ANOP  ,                                                   00164700
              AIF   (T'&ZCGPR NE 'N').ZG22R     NON NUMERIC             00164800
              AIF   ('&ZCGPR' LT '2').ZG22Q                             00164900
              AIF   ('&ZCGPR' LE '12').ZG22R                            00165000
.ZG22Q        ANOP  ,                                                   00165100
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00165200
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00165300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00165400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00165500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00165600
.ZG22R        ANOP  ,                                                   00165700
.*----------------------------------------------------------------***   00165800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00165900
              AIF   (N'&RSNCODE LE 1).ZG25A     CK NUM                  00166000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00166100
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00166200
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00166300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00166400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00166500
.ZG25A        ANOP  ,                                                   00166600
.*-------------------------------------------------------------------   00166700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00166800
              AIF   (K'&RSNCODE(1) LE 0).ZG25C  NO PARM                 00166900
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00167000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00167100
              AIF   (N'&RSNCODE GT 1).ZG25C                             00167200
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00167300
.ZG25C        ANOP  ,                                                   00167400
.*-------------------------------------------------------------------   00167500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00167600
              AIF   (K'&ZXRSNCODE LE 0).ZG25R   NOT I/O                 00167700
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG25R                     00167800
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00167900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                        00168000
              AIF   (K'&ZCGPR GT 2).ZG25Q                               00168100
              AIF   ('&ZCGPR' EQ '0').ZG25Q                             00168200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00168300
              AIF   (T'&ZCGPR NE 'N').ZG25Q     INVALID REG NAME        00168400
.ZG25P        ANOP  ,                                                   00168500
              AIF   (T'&ZCGPR NE 'N').ZG25R     NON NUMERIC             00168600
              AIF   ('&ZCGPR' LT '2').ZG25Q                             00168700
              AIF   ('&ZCGPR' LE '12').ZG25R                            00168800
.ZG25Q        ANOP  ,                                                   00168900
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00169000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00169100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00169200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00169300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00169400
.ZG25R        ANOP  ,                                                   00169500
.******************************************************************     00169600
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00169700
.******************************************************************     00169800
              ACTR  10000                                               00169900
.*----------------------------------------------------------------***   00170000
.***AH.P02 EXTRA POSITIONALS                                            00170100
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00170200
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00170300
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00170400
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00170500
.ZGLISTX1     ANOP  ,                                                   00170600
&ZCVAL        SETC  ''          ERROR FIELD                             00170700
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00170800
.ZGLIST2      ANOP  ,                                                   00170900
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00171000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00171100
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00171200
              AGO   .ZGLIST2                                            00171300
.*                                                                      00171400
.ZGLIST3      ANOP  ,                                                   00171500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00171600
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00171700
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00171800
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00171900
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00172000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00172100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172200
.ZGLISTX      ANOP  ,                                                   00172300
&ZASYSLNDX    SETA  0                                                   00172400
.*-------------------------------------------------------------------   00172500
.***AG.MF04 MF=(SLME)                                                   00172600
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00172700
.********************************************************************   00172800
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00172900
.********************************************************************   00173000
              ACTR  10000                                               00173100
.*-------------------------------------------------------------------   00173200
.***AE.MF01 MF=(SLME)                                                   00173300
              AIF   ('&XMF' EQ 'L').ZEMFX                               00173400
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00173500
.********************************************************************   00173600
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00173700
.********************************************************************   00173800
&XFUNCTION    SETC  ''          INITIALIZE XVARIABLE                    00173900
.*----------------------------------------------------------------***   00174000
.***AE.KXGRP03 NAME, RQD INPUT, ME GROUP -XVAR KEY                      00174100
              AIF   (N'&JOBNAME LE 1).ZE2A      CK NUM                  00174200
&ZMS          SETC  '"JOBNAME='                 *KPOSA* MNOTE           00174300
&ZMS          SETC  '&ZMS.&JOBNAME"'                                    00174400
&ZMS          SETC  '&ZMS "JOBNAME"'                                    00174500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00174600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00174700
.ZE2A         ANOP  ,                                                   00174800
.*-------------------------------------------------------------------   00174900
.***AE.KXGRP04 NAME, RQD INPUT, ME GROUP -XVAR ARGUMENT                 00175000
              AIF   (K'&JOBNAME(1) LE 0).ZE2B   NO PRM                  00175100
&ZXJOBNAME    SETC  'INPUT'     SET IN/OUTPUT                           00175200
&XJOBNAME     SETC  '&JOBNAME(1)'               SET XVARIABLE           00175300
              AIF   (N'&JOBNAME GT 1).ZE2B      MULTIPLE PARMS          00175400
&XJOBNAME     SETC  '&JOBNAME'  SET XVARIABLE                           00175500
.ZE2B         ANOP  ,                                                   00175600
.*-------------------------------------------------------------------   00175700
.***AE.KCK02 NAME, RQD INPUT, ME GROUP -GPR OUT OF RANGE                00175800
              AIF   (K'&ZXJOBNAME LE 0).ZE2R    NOT I/O                 00175900
              AIF   ('&XJOBNAME'(1,1) NE '(').ZE2R                      00176000
&ZCGPR        SETC  '&XJOBNAME'(2,K'&XJOBNAME-2)                        00176100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                         00176200
              AIF   (K'&ZCGPR GT 2).ZE2Q                                00176300
              AIF   ('&ZCGPR' EQ '0').ZE2Q                              00176400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00176500
              AIF   (T'&ZCGPR NE 'N').ZE2Q      INVALID REG NAME        00176600
.ZE2P         ANOP  ,                                                   00176700
              AIF   (T'&ZCGPR NE 'N').ZE2R      NON NUMERIC             00176800
              AIF   ('&ZCGPR' LT '2').ZE2Q                              00176900
              AIF   ('&ZCGPR' LE '12').ZE2R                             00177000
.ZE2Q         ANOP  ,                                                   00177100
&ZMS          SETC  '"JOBNAME='                 *KGPRA* MNOTE           00177200
&ZMS          SETC  '&ZMS.&JOBNAME"'                                    00177300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00177400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00177500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00177600
.ZE2R         ANOP  ,                                                   00177700
.*----------------------------------------------------------------***   00177800
.***AE.KXGRP03 NAME, RQD INPUT, ME GROUP -XVAR KEY                      00177900
              AIF   (N'&ASID LE 1).ZE3A         CK NUM                  00178000
&ZMS          SETC  '"ASID='    *KPOSA* MNOTE                           00178100
&ZMS          SETC  '&ZMS.&ASID"'                                       00178200
&ZMS          SETC  '&ZMS "ASID"'                                       00178300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00178400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00178500
.ZE3A         ANOP  ,                                                   00178600
.*-------------------------------------------------------------------   00178700
.***AE.KXGRP04 NAME, RQD INPUT, ME GROUP -XVAR ARGUMENT                 00178800
              AIF   (K'&ASID(1) LE 0).ZE3B      NO PRM                  00178900
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           00179000
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           00179100
              AIF   (N'&ASID GT 1).ZE3B         MULTIPLE PARMS          00179200
&XASID        SETC  '&ASID'     SET XVARIABLE                           00179300
.ZE3B         ANOP  ,                                                   00179400
.*-------------------------------------------------------------------   00179500
.***AE.KCK02 NAME, RQD INPUT, ME GROUP -GPR OUT OF RANGE                00179600
              AIF   (K'&ZXASID LE 0).ZE3R       NOT I/O                 00179700
              AIF   ('&XASID'(1,1) NE '(').ZE3R                         00179800
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00179900
              AIF   ('&ZCGPR'(1,1) NE '0').ZE3P                         00180000
              AIF   (K'&ZCGPR GT 2).ZE3Q                                00180100
              AIF   ('&ZCGPR' EQ '0').ZE3Q                              00180200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00180300
              AIF   (T'&ZCGPR NE 'N').ZE3Q      INVALID REG NAME        00180400
.ZE3P         ANOP  ,                                                   00180500
              AIF   (T'&ZCGPR NE 'N').ZE3R      NON NUMERIC             00180600
              AIF   ('&ZCGPR' LT '2').ZE3Q                              00180700
              AIF   ('&ZCGPR' LE '12').ZE3R                             00180800
.ZE3Q         ANOP  ,                                                   00180900
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           00181000
&ZMS          SETC  '&ZMS.&ASID"'                                       00181100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00181200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00181300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00181400
.ZE3R         ANOP  ,                                                   00181500
.*-------------------------------------------------------------------   00181600
.***AE.KCK02 NAME, RQD INPUT, ME GROUP -GPR OUT OF RANGE                00181700
              AIF   (K'&ZXASID LE 0).ZE4R       NOT I/O                 00181800
              AIF   ('&XASID'(1,1) NE '(').ZE4R                         00181900
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00182000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE4P                         00182100
              AIF   (K'&ZCGPR GT 2).ZE4Q                                00182200
              AIF   ('&ZCGPR' EQ '0').ZE4Q                              00182300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00182400
              AIF   (T'&ZCGPR NE 'N').ZE4Q      INVALID REG NAME        00182500
.ZE4P         ANOP  ,                                                   00182600
              AIF   (T'&ZCGPR NE 'N').ZE4R      NON NUMERIC             00182700
              AIF   ('&ZCGPR' LT '2').ZE4Q                              00182800
              AIF   ('&ZCGPR' LE '12').ZE4R                             00182900
.ZE4Q         ANOP  ,                                                   00183000
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           00183100
&ZMS          SETC  '&ZMS.&ASID"'                                       00183200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00183300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00183400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00183500
.ZE4R         ANOP  ,                                                   00183600
.*-------------------------------------------------------------------   00183700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183800
&ZTLC         SETC 'RESET'                                              00183900
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZE7A                    00184000
&XFUNCTION    SETC  'RESET'     SET KEYWORD                             00184100
              AIF   (N'&FUNCTION LE 1).ZE7A     CK NUM                  00184200
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           00184300
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00184400
&ZMS          SETC  '&ZMS "FUNCTION"'                                   00184500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00184600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00184700
.ZE7A         ANOP  ,                                                   00184800
.*----------------------------------------------------------------***   00184900
.***AE.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00185000
&XRESETKEY    SETC  ''          INITIALIZE XVARIABLE                    00185100
              AIF   (K'&SRVCLASS LE 0).ZE9C                             00185200
&ZXRESETKEY   SETC  'INPUT'     SET IN/OUTPUT                           00185300
&XRESETKEY    SETC  'SRVCLASS'  SET XVARIABLE                           00185400
&ZXSRVCLASS   SETC  'INPUT'     SET IN/OUTPUT                           00185500
&XSRVCLASS    SETC  '&SRVCLASS(1)'              SET XVARIABLE PARM      00185600
              AIF   (N'&SRVCLASS GT 1).ZE9A     MULTIPLE PARMS          00185700
&XSRVCLASS    SETC  '&SRVCLASS'                 SET XVARIABLE PARM      00185800
.ZE9A         AIF   (N'&SRVCLASS LE 1).ZE9B     CK NUM                  00185900
&ZMS          SETC  '"SRVCLASS='                *KPOSA* MNOTE           00186000
&ZMS          SETC  '&ZMS.&SRVCLASS"'                                   00186100
&ZMS          SETC  '&ZMS "SRVCLASS"'                                   00186200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00186300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00186400
.ZE9B         AIF   (K'&XSRVCLASS GT 0).ZE9C    ONE PARM                00186500
&ZXRESETKEY   SETC  ''          RESET IN/OUTPUT                         00186600
&ZXSRVCLASS   SETC  ''          RESET IN/OUTPUT                         00186700
.ZE9C         ANOP  ,                                                   00186800
.*----------------------------------------------------------------***   00186900
.***AE.KMEKY02 NAME, RQD INPUT, ME KEYS -NON-XVAR KEY                   00187000
              AIF   (K'&PERFORM LE 0).ZE10D     NO ME KEY               00187100
              AIF   (N'&PERFORM LE 1).ZE10A     CK NUM                  00187200
&ZMS          SETC  '"PERFORM='                 *KPOSA* MNOTE           00187300
&ZMS          SETC  '&ZMS.&PERFORM"'                                    00187400
&ZMS          SETC  '&ZMS "PERFORM"'                                    00187500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00187600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00187700
.ZE10A        AIF   (K'&XRESETKEY LE 0).ZE10B                           00187800
&ZMS          SETC  '"PERFORM'  *KMEKA* MNOTE                           00187900
&ZMS          SETC  '&ZMS.=&PERFORM"'                                   00188000
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00188100
&ZMS          SETC  '&ZMS "&XRESETKEY"'                                 00188200
              MNOTE 8,' &ZMS KEY.'                                      00188300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00188400
              AGO   .ZE10D                                              00188500
.*                                                                      00188600
.ZE10B        ANOP  ,                                                   00188700
&ZXRESETKEY   SETC  'INPUT'     SET IN/OUTPUT                           00188800
&XRESETKEY    SETC  'PERFORM'   SET XVARIABLE                           00188900
&ZXPERFORM    SETC  'INPUT'     SET IN/OUTPUT                           00189000
&XPERFORM     SETC  '&PERFORM(1)'               SET PARM                00189100
              AIF   (N'&PERFORM GT 1).ZE10C     MULTIPLE PARMS          00189200
&XPERFORM     SETC  '&PERFORM'  SET PARM                                00189300
.ZE10C        AIF   (K'&XPERFORM GT 0).ZE10D    ONE PARM                00189400
&ZXRESETKEY   SETC  ''          RESET IN/OUTPUT                         00189500
&ZXPERFORM    SETC  ''          RESET IN/OUTPUT                         00189600
.ZE10D        ANOP  ,                                                   00189700
.*------------------------------------------------------------------    00189800
.***AE.KMEKY07 NAME, RQD INPUT, ME KEYS -CHECK IF ENTERED               00189900
              AIF   (K'&XRESETKEY GT 0).ZE11B                           00190000
&ZXRESETKEY   SETC  ''          RESET IN/OUTPUT                         00190100
&XRESETKEY    SETC  ''          SET NULL                                00190200
&ZXSRVCLASS   SETC  ''          RESET OUTPUT                            00190300
&XSRVCLASS    SETC  ''          SET NULL PARM                           00190400
.ZE11B        ANOP  ,                                                   00190500
.*-------------------------------------------------------------------   00190600
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00190700
.ZE9     AIF   ('&XRESETKEY' NE 'SRVCLASS').ZE10                        00190800
.*-------------------------------------------------------------------   00190900
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00191000
              AIF   (K'&ZXSRVCLASS LE 0).ZE9R   NOT I/O                 00191100
              AIF   ('&XSRVCLASS'(1,1) NE '(').ZE9R                     00191200
&ZCGPR        SETC  '&XSRVCLASS'(2,K'&XSRVCLASS-2)                      00191300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE9P                         00191400
              AIF   (K'&ZCGPR GT 2).ZE9Q                                00191500
              AIF   ('&ZCGPR' EQ '0').ZE9Q                              00191600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00191700
              AIF   (T'&ZCGPR NE 'N').ZE9Q      INVALID REG NAME        00191800
.ZE9P         ANOP  ,                                                   00191900
              AIF   (T'&ZCGPR NE 'N').ZE9R      NON NUMERIC             00192000
              AIF   ('&ZCGPR' LT '2').ZE9Q                              00192100
              AIF   ('&ZCGPR' LE '12').ZE9R                             00192200
.ZE9Q         ANOP  ,                                                   00192300
&ZMS          SETC  '"SRVCLASS='                *KGPRA* MNOTE           00192400
&ZMS          SETC  '&ZMS.&SRVCLASS"'                                   00192500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00192600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00192700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00192800
.ZE9R         ANOP  ,                                                   00192900
.*-------------------------------------------------------------------   00193000
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00193100
.ZE10     AIF   ('&XRESETKEY' NE 'PERFORM').ZE11                        00193200
.*-------------------------------------------------------------------   00193300
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00193400
              AIF   (K'&ZXPERFORM LE 0).ZE10R   NOT I/O                 00193500
              AIF   ('&XPERFORM'(1,1) NE '(').ZE10R                     00193600
&ZCGPR        SETC  '&XPERFORM'(2,K'&XPERFORM-2)                        00193700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        00193800
              AIF   (K'&ZCGPR GT 2).ZE10Q                               00193900
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             00194000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00194100
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        00194200
.ZE10P        ANOP  ,                                                   00194300
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             00194400
              AIF   ('&ZCGPR' LT '2').ZE10Q                             00194500
              AIF   ('&ZCGPR' LE '12').ZE10R                            00194600
.ZE10Q        ANOP  ,                                                   00194700
&ZMS          SETC  '"PERFORM='                 *KGPRA* MNOTE           00194800
&ZMS          SETC  '&ZMS.&PERFORM"'                                    00194900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00195000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00195100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00195200
.ZE10R        ANOP  ,                                                   00195300
.*-------------------------------------------------------------------   00195400
.***AE.KMEKY09 NAME, RQD INPUT, ME KEYS -END                            00195500
.ZE11         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00195600
.*-------------------------------------------------------------------   00195700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00195800
&ZTLC         SETC 'QUIESCE'                                            00195900
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZE12A                   00196000
&XFUNCTION    SETC  'QUIESCE'   SET KEYWORD                             00196100
              AIF   (N'&FUNCTION LE 1).ZE12A    CK NUM                  00196200
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           00196300
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00196400
&ZMS          SETC  '&ZMS "FUNCTION"'                                   00196500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00196600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00196700
.ZE12A        ANOP  ,                                                   00196800
.*-------------------------------------------------------------------   00196900
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00197000
&ZTLC         SETC 'RESUME'                                             00197100
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZE13A                   00197200
&XFUNCTION    SETC  'RESUME'    SET KEYWORD                             00197300
              AIF   (N'&FUNCTION LE 1).ZE13A    CK NUM                  00197400
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           00197500
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00197600
&ZMS          SETC  '&ZMS "FUNCTION"'                                   00197700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00197800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00197900
.ZE13A        ANOP  ,                                                   00198000
.*------------------------------------------------------------------    00198100
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00198200
.ZE14         AIF   (K'&XFUNCTION GT 0).ZE14A   VALID                   00198300
              AIF   (K'&FUNCTION(1) LE 0).ZE14B                         00198400
&ZMS          SETC  '"FUNCTION='                *KUKWA* MNOTE           00198500
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   00198600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00198700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00198800
&ZMS          SETC  '&ZMS "RESET",'             VALID KEYWORD           00198900
&ZMS          SETC  '&ZMS "QUIESCE",'           VALID KEYWORD           00199000
&ZMS          SETC  '&ZMS OR "RESUME".'         VALID KEYWORD           00199100
              MNOTE 8,' &ZMS '                                          00199200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00199300
              AGO   .ZE14B                                              00199400
.*                                                                      00199500
.ZE14A        ANOP  ,                                                   00199600
&ZXFUNCTION   SETC  'INPUT'     SET IN/OUTPUT                           00199700
.ZE14B        ANOP  ,                                                   00199800
.*----------------------------------------------------------------***   00199900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00200000
              AIF   (N'&USERID LE 1).ZE16A      CK NUM                  00200100
&ZMS          SETC  '"USERID='  *KPOSA* MNOTE                           00200200
&ZMS          SETC  '&ZMS.&USERID"'                                     00200300
&ZMS          SETC  '&ZMS "USERID"'                                     00200400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00200500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00200600
.ZE16A        ANOP  ,                                                   00200700
.*-------------------------------------------------------------------   00200800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00200900
              AIF   (K'&USERID(1) LE 0).ZE16B   NO PRM                  00201000
&ZXUSERID     SETC  'INPUT'     SET IN/OUTPUT                           00201100
&XUSERID      SETC  '&USERID(1)'                SET XVARIABLE           00201200
              AIF   (N'&USERID GT 1).ZE16B                              00201300
.*            ANOP              MULTIPLE PARMS                          00201400
&XUSERID      SETC  '&USERID'   SET XVARIABLE                           00201500
.ZE16B        ANOP  ,                                                   00201600
.*-------------------------------------------------------------------   00201700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00201800
              AIF   (K'&ZXUSERID LE 0).ZE16R    NOT I/O                 00201900
              AIF   ('&XUSERID'(1,1) NE '(').ZE16R                      00202000
&ZCGPR        SETC  '&XUSERID'(2,K'&XUSERID-2)                          00202100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                        00202200
              AIF   (K'&ZCGPR GT 2).ZE16Q                               00202300
              AIF   ('&ZCGPR' EQ '0').ZE16Q                             00202400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00202500
              AIF   (T'&ZCGPR NE 'N').ZE16Q     INVALID REG NAME        00202600
.ZE16P        ANOP  ,                                                   00202700
              AIF   (T'&ZCGPR NE 'N').ZE16R     NON NUMERIC             00202800
              AIF   ('&ZCGPR' LT '2').ZE16Q                             00202900
              AIF   ('&ZCGPR' LE '12').ZE16R                            00203000
.ZE16Q        ANOP  ,                                                   00203100
&ZMS          SETC  '"USERID='  *KGPRA* MNOTE                           00203200
&ZMS          SETC  '&ZMS.&USERID"'                                     00203300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00203400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00203500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00203600
.ZE16R        ANOP  ,                                                   00203700
.*----------------------------------------------------------------***   00203800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00203900
              AIF   (N'&PRODUCT LE 1).ZE19A     CK NUM                  00204000
&ZMS          SETC  '"PRODUCT='                 *KPOSA* MNOTE           00204100
&ZMS          SETC  '&ZMS.&PRODUCT"'                                    00204200
&ZMS          SETC  '&ZMS "PRODUCT"'                                    00204300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00204400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00204500
.ZE19A        ANOP  ,                                                   00204600
.*-------------------------------------------------------------------   00204700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00204800
              AIF   (K'&PRODUCT(1) LE 0).ZE19B  NO PRM                  00204900
&ZXPRODUCT    SETC  'INPUT'     SET IN/OUTPUT                           00205000
&XPRODUCT     SETC  '&PRODUCT(1)'               SET XVARIABLE           00205100
              AIF   (N'&PRODUCT GT 1).ZE19B                             00205200
.*            ANOP              MULTIPLE PARMS                          00205300
&XPRODUCT     SETC  '&PRODUCT'  SET XVARIABLE                           00205400
.ZE19B        ANOP  ,                                                   00205500
.*-------------------------------------------------------------------   00205600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00205700
              AIF   (K'&ZXPRODUCT LE 0).ZE19R   NOT I/O                 00205800
              AIF   ('&XPRODUCT'(1,1) NE '(').ZE19R                     00205900
&ZCGPR        SETC  '&XPRODUCT'(2,K'&XPRODUCT-2)                        00206000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE19P                        00206100
              AIF   (K'&ZCGPR GT 2).ZE19Q                               00206200
              AIF   ('&ZCGPR' EQ '0').ZE19Q                             00206300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00206400
              AIF   (T'&ZCGPR NE 'N').ZE19Q     INVALID REG NAME        00206500
.ZE19P        ANOP  ,                                                   00206600
              AIF   (T'&ZCGPR NE 'N').ZE19R     NON NUMERIC             00206700
              AIF   ('&ZCGPR' LT '2').ZE19Q                             00206800
              AIF   ('&ZCGPR' LE '12').ZE19R                            00206900
.ZE19Q        ANOP  ,                                                   00207000
&ZMS          SETC  '"PRODUCT='                 *KGPRA* MNOTE           00207100
&ZMS          SETC  '&ZMS.&PRODUCT"'                                    00207200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00207300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00207400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00207500
.ZE19R        ANOP  ,                                                   00207600
.*----------------------------------------------------------------***   00207700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00207800
              AIF   (N'&RETCODE LE 1).ZE22A     CK NUM                  00207900
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00208000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00208100
&ZMS          SETC  '&ZMS "RETCODE"'                                    00208200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00208300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00208400
.ZE22A        ANOP  ,                                                   00208500
.*-------------------------------------------------------------------   00208600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00208700
              AIF   (K'&RETCODE(1) LE 0).ZE22B  NO PRM                  00208800
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00208900
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00209000
              AIF   (N'&RETCODE GT 1).ZE22B                             00209100
.*            ANOP              MULTIPLE PARMS                          00209200
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00209300
.ZE22B        ANOP  ,                                                   00209400
.*-------------------------------------------------------------------   00209500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00209600
              AIF   (K'&ZXRETCODE LE 0).ZE22R   NOT I/O                 00209700
              AIF   ('&XRETCODE'(1,1) NE '(').ZE22R                     00209800
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00209900
              AIF   ('&ZCGPR'(1,1) NE '0').ZE22P                        00210000
              AIF   (K'&ZCGPR GT 2).ZE22Q                               00210100
              AIF   ('&ZCGPR' EQ '0').ZE22Q                             00210200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00210300
              AIF   (T'&ZCGPR NE 'N').ZE22Q     INVALID REG NAME        00210400
.ZE22P        ANOP  ,                                                   00210500
              AIF   (T'&ZCGPR NE 'N').ZE22R     NON NUMERIC             00210600
              AIF   ('&ZCGPR' LT '2').ZE22Q                             00210700
              AIF   ('&ZCGPR' LE '12').ZE22R                            00210800
.ZE22Q        ANOP  ,                                                   00210900
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00211000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00211100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00211200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00211300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00211400
.ZE22R        ANOP  ,                                                   00211500
.*----------------------------------------------------------------***   00211600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00211700
              AIF   (N'&RSNCODE LE 1).ZE25A     CK NUM                  00211800
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00211900
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00212000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00212100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00212200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00212300
.ZE25A        ANOP  ,                                                   00212400
.*-------------------------------------------------------------------   00212500
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00212600
              AIF   (K'&RSNCODE(1) LE 0).ZE25B  NO PRM                  00212700
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00212800
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00212900
              AIF   (N'&RSNCODE GT 1).ZE25B                             00213000
.*            ANOP              MULTIPLE PARMS                          00213100
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00213200
.ZE25B        ANOP  ,                                                   00213300
.*-------------------------------------------------------------------   00213400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00213500
              AIF   (K'&ZXRSNCODE LE 0).ZE25R   NOT I/O                 00213600
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE25R                     00213700
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00213800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE25P                        00213900
              AIF   (K'&ZCGPR GT 2).ZE25Q                               00214000
              AIF   ('&ZCGPR' EQ '0').ZE25Q                             00214100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00214200
              AIF   (T'&ZCGPR NE 'N').ZE25Q     INVALID REG NAME        00214300
.ZE25P        ANOP  ,                                                   00214400
              AIF   (T'&ZCGPR NE 'N').ZE25R     NON NUMERIC             00214500
              AIF   ('&ZCGPR' LT '2').ZE25Q                             00214600
              AIF   ('&ZCGPR' LE '12').ZE25R                            00214700
.ZE25Q        ANOP  ,                                                   00214800
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00214900
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00215000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00215100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00215200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00215300
.ZE25R        ANOP  ,                                                   00215400
.******************************************************************     00215500
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00215600
.******************************************************************     00215700
              ACTR  10000                                               00215800
.*----------------------------------------------------------------***   00215900
.***AF.P02 EXTRA POSITIONALS                                            00216000
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00216100
&ZCVAL        SETC  ''          ERROR FIELD                             00216200
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00216300
.ZELIST2      ANOP  ,                                                   00216400
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00216500
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00216600
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00216700
              AGO   .ZELIST2                                            00216800
.*                                                                      00216900
.ZELIST3      ANOP  ,                                                   00217000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00217100
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00217200
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00217300
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00217400
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00217500
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00217600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00217700
.ZELISTX      ANOP  ,                                                   00217800
&ZASYSLNDX    SETA  0                                                   00217900
.*-------------------------------------------------------------------   00218000
.***AE.MF02 MF=(SLME)                                                   00218100
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00218200
.*******************************************************************    00218300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00218400
.*******************************************************************    00218500
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00218600
.*******************************************************************    00218700
.***AE.01  START OF IWMRESET MACRO CODE                                 00218800
.*******************************************************************    00218900
              LCLC  &M0M0001                 NAME                       00219000
&M0M0001      SETC  '&XLABEL'                SET NAME                   00219100
              AIF   (K'&XLABEL NE 0).XLAB2                              00219200
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00219300
.*                                                                      00219400
.XLAB2        ANOP  ,                                                   00219500
              AIF   ('&XMF' EQ 'L').XLAB3                               00219600
&M0M0001 DS    0H                             IWMRESET-0                00219700
.XLAB3        ANOP  ,                                                   00219800
.*******************************************************************    00219900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00220000
.*******************************************************************    00220100
              PUSH  PRINT                                               00220200
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00220300
              PRINT OFF         ++ PR01                                 00220400
              AGO   .ZPRNTXX                                            00220500
.ZPRINTX      PRINT ON                                                  00220600
.ZPRNTXX      ANOP  ,                                                   00220700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00220800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00220900
.********************************************************************   00221000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00221100
.********************************************************************   00221200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00221300
                      LCLA  &ZOPN1         INVOCATION INDEX             00221400
                      LCLC  &ZOPL(4095)    LABEL                        00221500
                      LCLC  &ZOPO(4095)    OPERATION                    00221600
                      LCLC  &ZOPV(4095)    VALUE                        00221700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00221800
.*                                                                      00221900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00222000
.******************************************************************     00222100
.***AL.L10 IWMRESET FMT=LIST MF=S|L PARAMETERS                          00222200
.******************************************************************     00222300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00222400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00222500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00222600
&XMFATTR              SETC  '0D'                                        00222700
.*                                                                      00222800
&ZOPN                 SETA  &ZOPN+1                                     00222900
&ZOPL(&ZOPN)          SETC  ' '                                         00223000
&ZOPO(&ZOPN)          SETC  'B'                                         00223100
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00223200
&ZOPD(&ZOPN)          SETC  '++ IWMRESET ARG PARMS'                     00223300
.*                                                                      00223400
&ZOPN                 SETA  &ZOPN+1                                     00223500
&ZOPL(&ZOPN)          SETC  ' '                                         00223600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00223700
&ZOPV(&ZOPN)          SETC  '1'                                         00223800
&ZOPD(&ZOPN)          SETC  ' '                                         00223900
.*                                                                      00224000
.ZLMFSL2              ANOP  ,                                           00224100
.*-------------------------------------------------------------------   00224200
.***AM.L00  IWMRESET FMT=LIST name                                      00224300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00224400
&ZOPN                 SETA &ZOPN+1                                      00224500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00224600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00224700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00224800
&ZOPD(&ZOPN)          SETC '++ IWMRESET NAME'                           00224900
.ZLMFSL2M             ANOP  ,                                           00225000
.*-------------------------------------------------------------------   00225100
.***AM.L01  IWMRESET FMT=LIST PARAMETERS                                00225200
&ZOPN                 SETA &ZOPN+1                                      00225300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00225400
&ZOPO(&ZOPN)          SETC 'DS'                                         00225500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00225600
&ZOPD(&ZOPN)          SETC '++ IWMRESET PARM LIST'                      00225700
.*-------------------------------------------------------------------   00225800
.***AM.L02 XVERSION XL1                                                 00225900
&ZOPN                 SETA &ZOPN+1                                      00226000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00226100
&ZOPO(&ZOPN)          SETC 'DS'                                         00226200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00226300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00226400
.*-------------------------------------------------------------------   00226500
.***AM.L03 XOPTIONS BL.8                                                00226600
&ZOPN                 SETA &ZOPN+1                                      00226700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPTIONS'                         00226800
&ZOPO(&ZOPN)          SETC 'DS'                                         00226900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00227000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00227100
.*                                                                      00227200
&ZOPN                 SETA  &ZOPN+1                                     00227300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SRVCLASS'                00227400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00227500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00227600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00227700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SRVCLASS'                     00227800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00227900
.*                                                                      00228000
&ZOPN                 SETA  &ZOPN+1                                     00228100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PERFORM'                 00228200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00228300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00228400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00228500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PERFORM'                      00228600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00228700
.*                                                                      00228800
&ZOPN                 SETA  &ZOPN+1                                     00228900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNCTION_QUIESCE'               00229000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00229100
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00229200
&ZOPD(&ZOPN)          SETC  '++ XFUNCTION.'                             00229300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).QUIESCE'                      00229400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00229500
.*                                                                      00229600
&ZOPN                 SETA  &ZOPN+1                                     00229700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNCTION_RESUME'                00229800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00229900
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00230000
&ZOPD(&ZOPN)          SETC  '++ XFUNCTION.'                             00230100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RESUME'                       00230200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00230300
.*                                                                      00230400
&ZOPN                 SETA  &ZOPN+1                                     00230500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_JOBNAME'                 00230600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00230700
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00230800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00230900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).JOBNAME'                      00231000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00231100
.*                                                                      00231200
&ZOPN                 SETA  &ZOPN+1                                     00231300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ASID'                    00231400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00231500
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00231600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00231700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ASID'                         00231800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00231900
.*-------------------------------------------------------------------   00232000
.***AM.L09  XPLISTLEN XL2                                               00232100
&ZOPN                 SETA &ZOPN+1                                      00232200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00232300
&ZOPO(&ZOPN)          SETC 'DS'                                         00232400
&ZOPV(&ZOPN)          SETC 'XL2'                                        00232500
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        00232600
.*-------------------------------------------------------------------   00232700
.***AM.L09  XJOBNAME CL8                                                00232800
&ZOPN                 SETA &ZOPN+1                                      00232900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XJOBNAME'                         00233000
&ZOPO(&ZOPN)          SETC 'DS'                                         00233100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00233200
&ZOPD(&ZOPN)          SETC '++ &ZXJOBNAME  XJOBNAME'                    00233300
.*-------------------------------------------------------------------   00233400
.***AM.L09  XASID XL2                                                   00233500
&ZOPN                 SETA &ZOPN+1                                      00233600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XASID'                            00233700
&ZOPO(&ZOPN)          SETC 'DS'                                         00233800
&ZOPV(&ZOPN)          SETC 'XL2'                                        00233900
&ZOPD(&ZOPN)          SETC '++ &ZXASID  XASID'                          00234000
.*-------------------------------------------------------------------   00234100
.***AM.L09  XPERFORM XL2                                                00234200
&ZOPN                 SETA &ZOPN+1                                      00234300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPERFORM'                         00234400
&ZOPO(&ZOPN)          SETC 'DS'                                         00234500
&ZOPV(&ZOPN)          SETC 'XL2'                                        00234600
&ZOPD(&ZOPN)          SETC '++ &ZXPERFORM  XPERFORM'                    00234700
.*-------------------------------------------------------------------   00234800
.***AM.L09  XSRVCLASS CL8                                               00234900
&ZOPN                 SETA &ZOPN+1                                      00235000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSRVCLASS'                        00235100
&ZOPO(&ZOPN)          SETC 'DS'                                         00235200
&ZOPV(&ZOPN)          SETC 'CL8'                                        00235300
&ZOPD(&ZOPN)          SETC '++ &ZXSRVCLASS  XSRVCLASS'                  00235400
.*-------------------------------------------------------------------   00235500
.***AM.L09  XUSERID CL8                                                 00235600
&ZOPN                 SETA &ZOPN+1                                      00235700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERID'                          00235800
&ZOPO(&ZOPN)          SETC 'DS'                                         00235900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00236000
&ZOPD(&ZOPN)          SETC '++ &ZXUSERID  XUSERID'                      00236100
.*-------------------------------------------------------------------   00236200
.***AM.L09  XPRODUCT CL8                                                00236300
&ZOPN                 SETA &ZOPN+1                                      00236400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPRODUCT'                         00236500
&ZOPO(&ZOPN)          SETC 'DS'                                         00236600
&ZOPV(&ZOPN)          SETC 'CL8'                                        00236700
&ZOPD(&ZOPN)          SETC '++ &ZXPRODUCT  XPRODUCT'                    00236800
.*-------------------------------------------------------------------   00236900
.***AM.L10 END OF IWMRESET LIST PARAMETERS                              00237000
&ZOPN                 SETA &ZOPN+1                                      00237100
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00237200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00237300
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00237400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00237500
.*                                                                      00237600
&ZOPN                 SETA &ZOPN+1                                      00237700
&ZOPL(&ZOPN)          SETC ' '                                          00237800
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00237900
&ZOPV(&ZOPN)          SETC '1'                                          00238000
&ZOPD(&ZOPN)          SETC ' '                                          00238100
.*-------------------------------------------------------------------   00238200
.***AL.L12 IWMRESET FMT=LIST MF=S|L PARAMETERS                          00238300
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00238400
.*                                                                      00238500
&ZOPN                 SETA  &ZOPN+1                                     00238600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00238700
&ZOPO(&ZOPN)          SETC  'DC'                                        00238800
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00238900
&ZOPD(&ZOPN)          SETC  '++ IWMRESET ARG PARMS'                     00239000
.*                                                                      00239100
.ZLMFSLX              ANOP  ,                                           00239200
.*-------------------------------------------------------------------   00239300
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00239400
&ZPLLEN               SETA 40                                           00239500
.*                                                                      00239600
.******************************************************************     00239700
.***AI.L01 IWMRESET FMT=LIST FILL IN PARAMETER AREA                     00239800
.******************************************************************     00239900
                      ACTR  10000                                       00240000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00240100
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00240200
&ZCVAL                SETC  'LAE'          XAX MODE                     00240300
.ZIMFXA               ANOP ,                                            00240400
.*                                                                      00240500
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00240600
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00240700
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00240800
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00240900
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00241000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00241100
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00241200
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00241300
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00241400
&ZOPN                 SETA  &ZOPN+1                                     00241500
&ZOPL(&ZOPN)          SETC  ' '                                         00241600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00241700
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00241800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00241900
                      AGO   .ZIMFNX                                     00242000
.*                                                                      00242100
.ZIMFN2               ANOP ,                                            00242200
&ZOPN                 SETA  &ZOPN+1                                     00242300
&ZOPL(&ZOPN)          SETC  ' '                                         00242400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00242500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00242600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00242700
.ZIMFNX               ANOP ,                                            00242800
.********************************************************************   00242900
.***AI.L02 IWMRESET FMT=LIST INITIALIZE PARAMETER AREA                  00243000
.********************************************************************   00243100
.***AI.L03 MF=(SLME)                                                    00243200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00243300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00243400
.*                                                                      00243500
&ZOPN                 SETA  &ZOPN+1                                     00243600
&ZOPL(&ZOPN)          SETC  ' '                                         00243700
&ZOPO(&ZOPN)          SETC  'XC'                                        00243800
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00243900
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00244000
.ZIMFLX               ANOP  ,                                           00244100
.*-------------------------------------------------------------------   00244200
.***AI.L05 XOPTIONS BL1                                                 00244300
&ZW                   SETC  ''                                          00244400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00244500
&ZMS                  SETC  ''                                          00244600
&ZC                   SETC  ''                                          00244700
.*-------------------------------------------------------------------   00244800
.***AI.L08 XOPTIONS "SRVCLASS"                                          00244900
.***      BL1'1XXXXXXX'                                                 00245000
         AIF   ('&SRVCLASS' EQ '').ZI3A                                 00245100
&ZW                   SETC  '&ZW.1'                                     00245200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00245300
&ZMS                  SETC  '&ZMS.0'                                    00245400
                      AGO   .ZI3C                                       00245500
.*                                                                      00245600
.ZI3A                 ANOP  ,                                           00245700
&ZW                   SETC  '&ZW.0'                                     00245800
&ZMS                  SETC  '&ZMS.1'                                    00245900
.ZI3C                 ANOP  ,                                           00246000
.*-------------------------------------------------------------------   00246100
.***AI.L08 XOPTIONS "PERFORM"                                           00246200
.***      BL1'X1XXXXXX'                                                 00246300
         AIF   ('&PERFORM' EQ '').ZI4A                                  00246400
&ZW                   SETC  '&ZW.1'                                     00246500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00246600
&ZMS                  SETC  '&ZMS.0'                                    00246700
                      AGO   .ZI4C                                       00246800
.*                                                                      00246900
.ZI4A                 ANOP  ,                                           00247000
&ZW                   SETC  '&ZW.0'                                     00247100
&ZMS                  SETC  '&ZMS.1'                                    00247200
.ZI4C                 ANOP  ,                                           00247300
.*-------------------------------------------------------------------   00247400
.***AI.L08 XOPTIONS "QUIESCE"                                           00247500
.***      BL1'XX1XXXXX'                                                 00247600
         AIF   ('&XFUNCTION' NE 'QUIESCE').ZI5A                         00247700
&ZW                   SETC  '&ZW.1'                                     00247800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00247900
&ZMS                  SETC  '&ZMS.1'                                    00248000
                      AGO   .ZI5C                                       00248100
.*                                                                      00248200
.ZI5A                 ANOP  ,                                           00248300
&ZW                   SETC  '&ZW.0'                                     00248400
         AIF   ('&ZXFUNCTION' EQ '').ZI5B                               00248500
&ZMS                  SETC  '&ZMS.0'                                    00248600
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00248700
                      AGO   .ZI5C                                       00248800
.*                                                                      00248900
.ZI5B                 ANOP  ,                                           00249000
&ZMS                  SETC  '&ZMS.1'                                    00249100
.ZI5C                 ANOP  ,                                           00249200
.*-------------------------------------------------------------------   00249300
.***AI.L08 XOPTIONS "RESUME"                                            00249400
.***      BL1'XXX1XXXX'                                                 00249500
         AIF   ('&XFUNCTION' NE 'RESUME').ZI6A                          00249600
&ZW                   SETC  '&ZW.1'                                     00249700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00249800
&ZMS                  SETC  '&ZMS.1'                                    00249900
                      AGO   .ZI6C                                       00250000
.*                                                                      00250100
.ZI6A                 ANOP  ,                                           00250200
&ZW                   SETC  '&ZW.0'                                     00250300
         AIF   ('&ZXFUNCTION' EQ '').ZI6B                               00250400
&ZMS                  SETC  '&ZMS.0'                                    00250500
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00250600
                      AGO   .ZI6C                                       00250700
.*                                                                      00250800
.ZI6B                 ANOP  ,                                           00250900
&ZMS                  SETC  '&ZMS.1'                                    00251000
.ZI6C                 ANOP  ,                                           00251100
.*-------------------------------------------------------------------   00251200
.***AI.L08 XOPTIONS "JOBNAME"                                           00251300
.***      BL1'XXXX1XXX'                                                 00251400
         AIF   ('&JOBNAME' EQ '').ZI7A                                  00251500
&ZW                   SETC  '&ZW.1'                                     00251600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00251700
&ZMS                  SETC  '&ZMS.0'                                    00251800
                      AGO   .ZI7C                                       00251900
.*                                                                      00252000
.ZI7A                 ANOP  ,                                           00252100
&ZW                   SETC  '&ZW.0'                                     00252200
&ZMS                  SETC  '&ZMS.1'                                    00252300
.ZI7C                 ANOP  ,                                           00252400
.*-------------------------------------------------------------------   00252500
.***AI.L08 XOPTIONS "ASID"                                              00252600
.***      BL1'XXXXX1XX'                                                 00252700
         AIF   ('&ASID' EQ '').ZI8A                                     00252800
&ZW                   SETC  '&ZW.100'                                   00252900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00253000
&ZMS                  SETC  '&ZMS.011'                                  00253100
                      AGO   .ZI8C                                       00253200
.*                                                                      00253300
.ZI8A                 ANOP  ,                                           00253400
&ZW                   SETC  '&ZW.000'                                   00253500
&ZMS                  SETC  '&ZMS.111'                                  00253600
.ZI8C                 ANOP  ,                                           00253700
.*-------------------------------------------------------------------   00253800
.***AI.L11 XOPTIONS BL1                                                 00253900
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI8D               00254000
                      AIF   ('&ZC' NE 'YES').ZI8D                       00254100
&ZOPN                 SETA  &ZOPN+1                                     00254200
&ZOPL(&ZOPN)          SETC  ' '                                         00254300
&ZOPO(&ZOPN)          SETC  'NI'                                        00254400
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00254500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00254600
.ZI8D                 ANOP  ,                                           00254700
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     00254800
&ZOPN                 SETA  &ZOPN+1                                     00254900
&ZOPL(&ZOPN)          SETC  ' '                                         00255000
&ZOPO(&ZOPN)          SETC  'OI'                                        00255100
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00255200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00255300
.ZI8E                 ANOP  ,                                           00255400
.*-------------------------------------------------------------------   00255500
.***AI.L04 XPLISTLEN XL2                                                00255600
&ZOPN                 SETA  &ZOPN+1                                     00255700
&ZOPL(&ZOPN)          SETC  ' '                                         00255800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00255900
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      00256000
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00256100
.*-------------------------------------------------------------------   00256200
.***AI.L25  XJOBNAME CL8                                                00256300
                      AIF   ('&ZXJOBNAME' EQ '').ZI10E                  00256400
                      AIF   ('&ZXJOBNAME' EQ 'OUTPUT').ZI10E            00256500
&ZCGPR                SETC  '&XJOBNAME'                                 00256600
.*                                                                      00256700
                      AIF   ('&XJOBNAME'(1,1) NE '(').ZI10B             00256800
&ZCGPR   SETC  '0('.'&XJOBNAME'(2,K'&XJOBNAME-2).')'                    00256900
.ZI10B                ANOP  ,                                           00257000
.*                                                                      00257100
&ZOPN                 SETA  &ZOPN+1                                     00257200
&ZOPL(&ZOPN)          SETC  ' '                                         00257300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00257400
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             00257500
&ZOPD(&ZOPN)          SETC  '++ &ZXJOBNAME XJOBNAME'                    00257600
.*                                                                      00257700
.ZI10E                ANOP  ,                                           00257800
.*-------------------------------------------------------------------   00257900
.***AI.L25  XASID XL2                                                   00258000
                      AIF   ('&ZXASID' EQ '').ZI11E                     00258100
                      AIF   ('&ZXASID' EQ 'OUTPUT').ZI11E               00258200
&ZCGPR                SETC  '&XASID'                                    00258300
.*                                                                      00258400
                      AIF   ('&XASID'(1,1) NE '(').ZI11B                00258500
&ZCGPR   SETC  '0('.'&XASID'(2,K'&XASID-2).')'                          00258600
                      AGO   .ZI11D                                      00258700
.ZI11B                ANOP  ,                                           00258800
.*                                                                      00258900
&ZC                   SETC  '&XASID'(1,1)                               00259000
                      AIF   (T'&ZC NE 'N').ZI11D                        00259100
&ZC                   SETC  '&XASID'                                    00259200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00259300
&ZCGPR                SETC  '=FL2''&XASID'''                            00259400
.*                                                                      00259500
.ZI11D                ANOP  ,                                           00259600
.*                                                                      00259700
&ZOPN                 SETA  &ZOPN+1                                     00259800
&ZOPL(&ZOPN)          SETC  ' '                                         00259900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00260000
&ZOPV(&ZOPN)          SETC  '12(2,1),&ZCGPR'                            00260100
&ZOPD(&ZOPN)          SETC  '++ &ZXASID XASID'                          00260200
.*                                                                      00260300
.ZI11E                ANOP  ,                                           00260400
.*-------------------------------------------------------------------   00260500
.***AI.L25  XPERFORM XL2                                                00260600
                      AIF   ('&ZXPERFORM' EQ '').ZI12E                  00260700
                      AIF   ('&ZXPERFORM' EQ 'OUTPUT').ZI12E            00260800
&ZCGPR                SETC  '&XPERFORM'                                 00260900
.*                                                                      00261000
                      AIF   ('&XPERFORM'(1,1) NE '(').ZI12B             00261100
&ZCGPR   SETC  '0('.'&XPERFORM'(2,K'&XPERFORM-2).')'                    00261200
                      AGO   .ZI12D                                      00261300
.ZI12B                ANOP  ,                                           00261400
.*                                                                      00261500
&ZC                   SETC  '&XPERFORM'(1,1)                            00261600
                      AIF   (T'&ZC NE 'N').ZI12D                        00261700
&ZC                   SETC  '&XPERFORM'                                 00261800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00261900
&ZCGPR                SETC  '=FL2''&XPERFORM'''                         00262000
.*                                                                      00262100
.ZI12D                ANOP  ,                                           00262200
.*                                                                      00262300
&ZOPN                 SETA  &ZOPN+1                                     00262400
&ZOPL(&ZOPN)          SETC  ' '                                         00262500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00262600
&ZOPV(&ZOPN)          SETC  '14(2,1),&ZCGPR'                            00262700
&ZOPD(&ZOPN)          SETC  '++ &ZXPERFORM XPERFORM'                    00262800
.*                                                                      00262900
.ZI12E                ANOP  ,                                           00263000
.*-------------------------------------------------------------------   00263100
.***AI.L25  XSRVCLASS CL8                                               00263200
                      AIF   ('&ZXSRVCLASS' EQ '').ZI13E                 00263300
                      AIF   ('&ZXSRVCLASS' EQ 'OUTPUT').ZI13E           00263400
&ZCGPR                SETC  '&XSRVCLASS'                                00263500
.*                                                                      00263600
                      AIF   ('&XSRVCLASS'(1,1) NE '(').ZI13B            00263700
&ZCGPR   SETC  '0('.'&XSRVCLASS'(2,K'&XSRVCLASS-2).')'                  00263800
.ZI13B                ANOP  ,                                           00263900
.*                                                                      00264000
&ZOPN                 SETA  &ZOPN+1                                     00264100
&ZOPL(&ZOPN)          SETC  ' '                                         00264200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00264300
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00264400
&ZOPD(&ZOPN)          SETC  '++ &ZXSRVCLASS XSRVCLASS'                  00264500
.*                                                                      00264600
.ZI13E                ANOP  ,                                           00264700
.*-------------------------------------------------------------------   00264800
.***AI.L25  XUSERID CL8                                                 00264900
                      AIF   ('&ZXUSERID' EQ '').ZI14E                   00265000
                      AIF   ('&ZXUSERID' EQ 'OUTPUT').ZI14E             00265100
&ZCGPR                SETC  '&XUSERID'                                  00265200
.*                                                                      00265300
                      AIF   ('&XUSERID'(1,1) NE '(').ZI14B              00265400
&ZCGPR   SETC  '0('.'&XUSERID'(2,K'&XUSERID-2).')'                      00265500
.ZI14B                ANOP  ,                                           00265600
.*                                                                      00265700
&ZOPN                 SETA  &ZOPN+1                                     00265800
&ZOPL(&ZOPN)          SETC  ' '                                         00265900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00266000
&ZOPV(&ZOPN)          SETC  '24(8,1),&ZCGPR'                            00266100
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERID XUSERID'                      00266200
.*                                                                      00266300
.ZI14E                ANOP  ,                                           00266400
.*-------------------------------------------------------------------   00266500
.***AI.L25  XPRODUCT CL8                                                00266600
                      AIF   ('&ZXPRODUCT' EQ '').ZI15E                  00266700
                      AIF   ('&ZXPRODUCT' EQ 'OUTPUT').ZI15E            00266800
&ZCGPR                SETC  '&XPRODUCT'                                 00266900
.*                                                                      00267000
                      AIF   ('&XPRODUCT'(1,1) NE '(').ZI15B             00267100
&ZCGPR   SETC  '0('.'&XPRODUCT'(2,K'&XPRODUCT-2).')'                    00267200
.ZI15B                ANOP  ,                                           00267300
.*                                                                      00267400
&ZOPN                 SETA  &ZOPN+1                                     00267500
&ZOPL(&ZOPN)          SETC  ' '                                         00267600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00267700
&ZOPV(&ZOPN)          SETC  '32(8,1),&ZCGPR'                            00267800
&ZOPD(&ZOPN)          SETC  '++ &ZXPRODUCT XPRODUCT'                    00267900
.*                                                                      00268000
.ZI15E                ANOP  ,                                           00268100
.*-------------------------------------------------------------------   00268200
&ZOPN1                SETA &ZOPN                                        00268300
.*-------------------------------------------------------------------   00268400
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00268500
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00268600
.*******************************************************************    00268700
.***  PROCESS IWMRESET OUTPUT PARAMETERS                                00268800
.*******************************************************************    00268900
                      ACTR  10000                                       00269000
.*******************************************************************    00269100
.***AO.X02  RETURN CODE PROCESSING                                      00269200
.*******************************************************************    00269300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00269400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00269500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00269600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00269700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00269800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00269900
&ZOPN                 SETA  &ZOPN+1                                     00270000
&ZOPL(&ZOPN)          SETC  ' '                                         00270100
&ZOPO(&ZOPN)          SETC  'ST'                                        00270200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00270300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00270400
                      AGO   .ZMRETX                                     00270500
.*                                                                      00270600
.ZMRET2               ANOP  ,                                           00270700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00270800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00270900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00271000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00271100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00271200
&ZOPN                 SETA  &ZOPN+1                                     00271300
&ZOPL(&ZOPN)          SETC  ' '                                         00271400
&ZOPO(&ZOPN)          SETC  'LR'                                        00271500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00271600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00271700
.ZMRETX               ANOP  ,                                           00271800
.*******************************************************************    00271900
.***AO.X03  REASON CODE PROCESSING                                      00272000
.*******************************************************************    00272100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00272200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00272300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00272400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00272500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00272600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00272700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00272800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00272900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00273000
&ZOPN                 SETA  &ZOPN+1                                     00273100
&ZOPL(&ZOPN)          SETC  ' '                                         00273200
&ZOPO(&ZOPN)          SETC  'ST'                                        00273300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00273400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00273500
                      AGO   .ZMRSNX                                     00273600
.*                                                                      00273700
.ZMRSN2               ANOP  ,                                           00273800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00273900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00274000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00274100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00274200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00274300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00274400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00274500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00274600
&ZOPN                 SETA  &ZOPN+1                                     00274700
&ZOPL(&ZOPN)          SETC  ' '                                         00274800
&ZOPO(&ZOPN)          SETC  'LR'                                        00274900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00275000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00275100
.ZMRSNX               ANOP  ,                                           00275200
.*******************************************************************    00275300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00275400
.*******************************************************************    00275500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00275600
.*******************************************************************    00275700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00275800
.*******************************************************************    00275900
                      ACTR  10000                                       00276000
.*                                                                      00276100
                      LCLA  &ZLC           COLUMN POSITION              00276200
                      LCLA  &ZOPX          LIST TABLE INDEX             00276300
                      LCLC  &ZLL           LABEL                        00276400
                      LCLC  &ZLOP          OPERATION                    00276500
                      LCLC  &ZLV           VALUE                        00276600
                      LCLC  &ZLD           DESCRIPTION                  00276700
.*                                                                      00276800
&ZOPX                 SETA  1                                           00276900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00277000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00277100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00277200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00277300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00277400
                      AIF   (K'&ZLD LE 0).ZL5                           00277500
&ZLC                  SETA  35             COMMENT COLUMN               00277600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00277700
&ZLC                  SETA  33             COMMMENT COLUMN              00277800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00277900
&ZLV                  SETC  '&ZLV'.' '                                  00278000
                      AGO   .ZL3                                        00278100
.*                                                                      00278200
.ZL4                  ANOP  ,                                           00278300
&ZLV                  SETC  '&ZLV'.' '                                  00278400
.ZL5                  ANOP  ,                                           00278500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00278600
.*                                                                      00278700
&ZLL     &ZLOP &ZLV                                                     00278800
.*                                                                      00278900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00279000
                      AGO   .ZL2           CONTINUE LOOPING             00279100
.*                                                                      00279200
.ZLX                  ANOP  ,                                           00279300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00279400
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00279500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00279600
         L     14,16(0,0)              GET CVT ADDRESS                  00279700
         L     14,772(14,0)            GET SFT ADDRESS                  00279800
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       00279900
         LA    15,62                   GET EX FOR SERVICE ROUTINE       00280000
         OR    14,15                   GET PC NUMBER                    00280100
         PC    0(14)                                                    00280200
END&SYSNDX DS    0H                    END LABEL                        00280300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00280400
.ZLINKX               ANOP  ,                                           00280500
.*******************************************************************    00280600
.***AP.X01  FORMAT GENERATED CODE                                       00280700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00280800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00280900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00281000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00281100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00281200
                      AIF   (K'&ZLD LE 0).ZL51                          00281300
&ZLC                  SETA  35             COMMENT COLUMN               00281400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00281500
&ZLC                  SETA  33             COMMENT COLUMN               00281600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00281700
&ZLV                  SETC  '&ZLV'.' '                                  00281800
                      AGO   .ZL31                                       00281900
.*                                                                      00282000
.ZL41                 ANOP  ,                                           00282100
&ZLV                  SETC  '&ZLV'.' '                                  00282200
.ZL51                 ANOP  ,                                           00282300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00282400
.*                                                                      00282500
&ZLL     &ZLOP &ZLV                                                     00282600
.*                                                                      00282700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00282800
                      AGO   .ZL21          CONTINUE LOOPING             00282900
.*                                                                      00283000
.ZLX1                 ANOP  ,                                           00283100
.*******************************************************************    00283200
.***AP.X02  END OF IWMRESET MACRO                                       00283300
&ZIWMRESET            SETC  'YES'          SET IWMRESET USED            00283400
         POP   PRINT                                                    00283500
*                                            IWMRESET-0                 00283600
         SPACE 1                                                        00283700
.ZLX2                 ANOP  ,                                           00283800
         MEND                                                           00283900
**********************************************************************/ 00284000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00284100
*%IWMRESET: MACRO KEYS(JOBNAME,ASID,FUNCTION,SRVCLASS,PERFORM,USERID,   00284200
*                 PRODUCT,RETCODE,RSNCODE,PLISTVER,MF);                 00284300
*  ANS('?'||MACLABEL||' '||'IWMRESEP '||MACLIST||                       00284400
*         ' '||MACKEYS||';') COL(MACLMAR);                              00284500
*%END IWMRESET;                                                         00284600
