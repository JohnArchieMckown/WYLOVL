*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMRPT                                -07/30/96-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Report response time                          * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1993, 1997                     * 00001300
*                                                                     * 00001400
* STATUS= HBB6603                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      The primary purpose of this service is to allow MVS to obtain  * 00002200
*      the total response time for a completed work request and its   * 00002300
*      corresponding service class and (when customer specified) its  * 00002400
*      report class.                                                  * 00002500
*                                                                     * 00002600
*      The second purpose in using this service is to allow MVS to    * 00002700
*      know which address spaces were involved in serving the service * 00002800
*      class.                                                         * 00002900
*                                                                     * 00003000
*      When a monitoring token is provided, the third purpose in      * 00003100
*      using this service is to allow MVS to know that the monitoring * 00003200
*      environment should no longer be associated with the now        * 00003300
*      completed work request.  The use of this service will render   * 00003400
*      the information associated with the monitoring environment     * 00003500
*      unpredictable.  To associate a work request with the           * 00003600
*      monitoring environment following use of Report, first use      * 00003700
*      Initialize Mode(Reset) or Relate/Transfer.                     * 00003800
*                                                                     * 00003900
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004000
*                                                                     * 00004100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004200
*                                                                     * 00004300
*01* ENVIRONMENT:                                                     * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*      Dispatchable unit mode: Task or SRB mode.                      * 00004700
*                                                                     * 00004800
*      Minimum authorization: Supervisor state.  PSW key must either  * 00004900
*                        be 0 or match the value supplied on IWMCONN. * 00005000
*                        PSW key must either be 0 or match the value  * 00005100
*                        supplied on IWMMCREA when a monitoring token * 00005200
*                        is passed.  PSW key must be 0-7. See         * 00005300
*                        restrictions below.                          * 00005400
*                                                                     * 00005500
*      AMODE:            31-bit.                                      * 00005600
*                                                                     * 00005700
*      ASC mode:         Primary.                                     * 00005800
*                                                                     * 00005900
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00006000
*                                                                     * 00006100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006200
*                                                                     * 00006300
*      Locks:            LOCAL lock held.                             * 00006400
*                                                                     * 00006500
*      Control parameters: Control parameters must be in the primary  * 00006600
*                        address space.                               * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*01* PROGRAMMING REQUIREMENTS:                                        * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*    1.  The macro CVT must be included to use this macro.            * 00007400
*                                                                     * 00007500
*    2.  The macro IWMYCON must be included to use this macro.        * 00007600
*                                                                     * 00007700
*    3.  The macro IWMPB must be in the library concatenation, since  * 00007800
*        it is included by IWMYCON.                                   * 00007900
*                                                                     * 00008000
*    4.  Note that the high order halfword of register 0, and the     * 00008100
*        reason code variable when specified, may be non-zero and     * 00008200
*        represents diagnostic data which is NOT part of the external * 00008300
*        interface.  The high order halfword should thus be excluded  * 00008400
*        from comparison with the reason code values described above. * 00008500
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00008600
*        be used for this purpose.                                    * 00008700
*                                                                     * 00008800
*    5.  All character data, unless otherwise specified, is assumed   * 00008900
*        to be left justified and padded with blanks on the right, as * 00009000
*        needed, to occupy the specified number of bytes.             * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*01* RESTRICTIONS:                                                    * 00009500
*                                                                     * 00009600
*                                                                     * 00009700
*    1.  This macro may not be used prior to the completion of WLM    * 00009800
*        address space initialization.                                * 00009900
*                                                                     * 00010000
*    2.  This macro may only be used on MVS/ESA (version 3 or         * 00010100
*        higher), NOT versions 1 or 2 of MVS.                         * 00010200
*                                                                     * 00010300
*    3.  Caller is responsible for error recovery                     * 00010400
*                                                                     * 00010500
*    4.  Though the caller is required to be enabled, this is not     * 00010600
*        checked.  Violation of this restriction may cause disabled   * 00010700
*        program checks which would be the responsibility of the      * 00010800
*        caller's recovery to handle.                                 * 00010900
*                                                                     * 00011000
*    5.  When the invocation requests use of SYSEVENT TRAXFRPT, the   * 00011100
*        restrictions for that service must be satisfied. These are:  * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*        o   Local lock must be held.                                 * 00011500
*                                                                     * 00011600
*        o   Supervisor state.                                        * 00011700
*                                                                     * 00011800
*        o   PSW key must be 0.                                       * 00011900
*                                                                     * 00012000
*        o   Parameter list must be fully initialized (information    * 00012100
*            will not be copied from the other parameters supplied to * 00012200
*            complete initialization of the SYSEVENT parameter list). * 00012300
*                                                                     * 00012400
*        o   Note that SYSEVENT TRAXFRPT supports disabled callers,   * 00012500
*            in which case the parameter list and save area must be   * 00012600
*            fixed, but IWMRPT does not support disablement.          * 00012700
*                                                                     * 00012800
*        o   Provide error recovery.                                  * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*    6.  If a delay monitoring token is provided, then                * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*        o   The caller must serialize to prevent any delay           * 00013600
*            monitoring services from being invoked concurrently for  * 00013700
*            the environment represented by the monitoring token.     * 00013800
*                                                                     * 00013900
*        o   The monitoring environment must contain the information  * 00014000
*            saved by IWMMINIT, not IWMMRELA                          * 00014100
*                                                                     * 00014200
*        o   If the key specified on IWMMCREA was a system key (0-7), * 00014300
*            then the current PSW key must be 0 or match the key      * 00014400
*            specified on IWMMCREA.                                   * 00014500
*                                                                     * 00014600
*        o   If the key specified on IWMMCREA was a user key (8-F),   * 00014700
*            then                                                     * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*            -   PSW key must be 0                                    * 00015100
*                                                                     * 00015200
*            -   current primary must match the primary at the time   * 00015300
*                that IWMMCREA was invoked.  Calling from a subspace  * 00015400
*                is not supported.                                    * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*    7.  If the the key specified on IWMCONN for the input connect    * 00016100
*        token was a user key (8-F), then                             * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*        o   PSW key must be 0                                        * 00016500
*                                                                     * 00016600
*        o   current primary must match the primary at the time that  * 00016700
*            IWMCONN was invoked.  Calling from a subspace is not     * 00016800
*            supported.                                               * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*01* INPUT REGISTER INFORMATION:                                      * 00017500
*                                                                     * 00017600
*    Before issuing the IWMRPT macro, the caller must ensure that the * 00017700
*    following general purpose registers (GPRs) contain the specified * 00017800
*    information:                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*    REGISTER  CONTENTS                                               * 00018200
*                                                                     * 00018300
*    13        The address of a 72-byte standard save area in the     * 00018400
*              primary address space                                  * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*    Before issuing the IWMRPT macro, the caller does not have to     * 00018900
*    place any information into any AR unless using it in register    * 00019000
*    notation for a particular parameter, or using it as a base       * 00019100
*    register.                                                        * 00019200
*                                                                     * 00019300
*01* OUTPUT REGISTER INFORMATION:                                     * 00019400
*                                                                     * 00019500
*    When control returns to the caller, the GPRs contain:            * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*    REGISTER  CONTENTS                                               * 00019900
*                                                                     * 00020000
*    0-1       Used as work registers by the system                   * 00020100
*                                                                     * 00020200
*    2-13      Unchanged                                              * 00020300
*                                                                     * 00020400
*    14-15     Used as work registers by the system.                  * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*    When control returns to the caller, the ARs contain:             * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*    REGISTER  CONTENTS                                               * 00021200
*                                                                     * 00021300
*    0-1       Used as work registers by the system                   * 00021400
*                                                                     * 00021500
*    2-13      Unchanged                                              * 00021600
*                                                                     * 00021700
*    14-15     Used as work registers by the system.                  * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*    Some callers depend on register contents remaining the same      * 00022200
*    before and after issuing a service.  If the system changes the   * 00022300
*    contents of registers on which the caller depends, the caller    * 00022400
*    must save them before issuing the service, and restore them      * 00022500
*    after the system returns control.                                * 00022600
*                                                                     * 00022700
*01* PERFORMANCE IMPLICATIONS:                                        * 00022800
*                                                                     * 00022900
*    None                                                             * 00023000
*                                                                     * 00023100
*01* SYNTAX:                                                          * 00023200
*                                                                     * 00023300
*[xlabel]  IWMRPT    TRAXFRPT=YES                                    * 00023400
*                  |     ,SYSEVPL=xsysevpl                            * 00023500
*                   ,TRAXFRPT=NO                                     * 00023600
*                       ,PSWKEYP=VALUE                               * 00023700
*                      |     ,PSWKEY=xpswkey                          * 00023800
*                       ,PSWKEYP=CURRENT                             * 00023900
*                   ,MONTKNI=YES                                     * 00024000
*                  |     ,MONTKN=xmontkn                              * 00024100
*                   ,MONTKNI=NO                                      * 00024200
*                        ,ARRIVALTIME=xarrivaltime                    * 00024300
*                       ,EXSTARTTIMEP=NO                             * 00024400
*                       ,EXSTARTTIMEP=YES                            * 00024500
*                            ,EXSTARTTIME=xexstarttime                * 00024600
*                        ,SERVCLS=xservcls                            * 00024700
*                    ,CONNTKN=xconntkn                                * 00024800
*                   [,ENDTIME=xendtime|CURRENT]                     * 00024900
*                  [,STATUS=NORMAL                                   * 00025000
*                  |    [,WORK_COMPCD=xwork_compcd|NO_WORK_COMPCD]] * 00025100
*                  [,STATUS=ABNORMAL                                 * 00025200
*                  |    [,WORK_COMPCD=xwork_compcd|NO_WORK_COMPCD]] * 00025300
*                  [,STATUS=NORMAL_LE_VAL                            * 00025400
*                  |     ,WORK_COMPCD=xwork_compcd                    * 00025500
*                  |     ,OK_THRESHOLD=xok_threshold]                 * 00025600
*                  [,STATUS=NORMAL_GE_VAL                            * 00025700
*                        ,WORK_COMPCD=xwork_compcd                    * 00025800
*                        ,OK_THRESHOLD=xok_threshold]                 * 00025900
*                   [,RETCODE=xretcode]                               * 00026000
*                   [,RSNCODE=xrsncode]                               * 00026100
*                   [,PLISTVER=xplistver|IMPLIED_VERSION]           * 00026200
*                  [,MF=S]                                           * 00026300
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 00026400
*                  [,MF=(E,xmfctrl,COMPLETE)]                      * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*      Where:                                                         * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*      [xlabel]                                                       * 00027100
*          is an optional symbol, starting in column 1, that is the   * 00027200
*          name on the IWMRPT macro invocation.  The name must        * 00027300
*          conform to the rules for an ordinary assembler language    * 00027400
*          symbol.                                                    * 00027500
*          DEFAULT: No name.                                          * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*      TRAXFRPT=YES|NO                                              * 00028100
*          is a required keyword input which indicates whether a      * 00028200
*          SYSEVENT TRAXFRPT should be issued when the system is in   * 00028300
*          compatibility mode.                                        * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*          TRAXFRPT=YES                                               * 00028700
*              indicates that a SYSEVENT TRAXFRPT should be issued    * 00028800
*              when the system is in compatibility mode.              * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*              SYSEVPL=xsysevpl                                       * 00029200
*                  is the name (RS-type), or address in register      * 00029300
*                  (2)-(12), of a required 40 character input which   * 00029400
*                  is the fully initialized SYSEVENT parameter list,  * 00029500
*                  as mapped by IHATRBPL.                             * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*          TRAXFRPT=NO                                                * 00030000
*                                                                     * 00030100
*              indicates that no SYSEVENT TRAXFRPT should be issued   * 00030200
*              when the system is in compatibility mode.              * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*              PSWKEYP=VALUE|CURRENT                                * 00030600
*                  is a required keyword input which describes how to * 00030700
*                  determine the current PSW key.                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                  PSWKEYP=VALUE                                      * 00031100
*                                                                     * 00031200
*                      indicates that the key is being passed         * 00031300
*                      explicitly via PSWKEY.                         * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                      PSWKEY=xpswkey                                 * 00031700
*                          is the name (RS-type), or address in       * 00031800
*                          register (2)-(12), of a required 8 bit     * 00031900
*                          input which contains the current PSW key.  * 00032000
*                          The low order 4 bits (bits 4-7) contain    * 00032100
*                          the key value.  The high order 4 bits      * 00032200
*                          (bits 0-3) contain zeros.                  * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                  PSWKEYP=CURRENT                                    * 00032700
*                      indicates that the current PSW key should be   * 00032800
*                      determined.                                    * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*      MONTKNI=YES|NO                                               * 00034000
*          is a required keyword input which indicates whether a      * 00034100
*          delay monitoring token is provided.                        * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*          MONTKNI=YES                                                * 00034500
*              indicates that a delay monitoring token is provided.   * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*              MONTKN=xmontkn                                         * 00034900
*                  is the name (RS-type), or address in register      * 00035000
*                  (2)-(12), of a required 32 bit input which         * 00035100
*                  contains the delay monitoring token                * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*          MONTKNI=NO                                                 * 00035600
*              indicates that no delay monitoring token is provided.  * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*              ARRIVALTIME=xarrivaltime                               * 00036000
*                  is the name (RS-type), or address in register      * 00036100
*                  (2)-(12), of a required 64 bit input which         * 00036200
*                  contains the arrival time for the work unit in     * 00036300
*                  STCK format.                                       * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*              EXSTARTTIMEP=NO|YES                                  * 00036900
*                  is a required keyword input which indicates        * 00037000
*                  whether the start execution time value is passed.  * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                  EXSTARTTIMEP=NO                                    * 00037400
*                      indicates that the start execution time value  * 00037500
*                      is not passed.                                 * 00037600
*                                                                     * 00037700
*                  EXSTARTTIMEP=YES                                   * 00037800
*                      indicates that the start execution time value  * 00037900
*                      is passed.  Note that this should only be used * 00038000
*                      when IWMMNTFY was NOT used to pass the         * 00038100
*                      execution time for this work request.          * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                      EXSTARTTIME=xexstarttime                       * 00038500
*                          is the name (RS-type), or address in       * 00038600
*                          register (2)-(12), of a required 64 bit    * 00038700
*                          input which contains the start execution   * 00038800
*                          time in STCK format.  Note that this       * 00038900
*                          should only be used when IWMMNTFY was NOT  * 00039000
*                          used to pass the execution time for this   * 00039100
*                          work request.                              * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*              SERVCLS=xservcls                                       * 00040100
*                  is the name (RS-type), or address in register      * 00040200
*                  (2)-(12), of a required 32 bit input which         * 00040300
*                  contains the service class token.                  * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*      CONNTKN=xconntkn                                               * 00041300
*          is the name (RS-type), or address in register (2)-(12), of * 00041400
*          a required 32 bit input which is returned by IWMCONN.      * 00041500
*                                                                     * 00041600
*          If a monitoring token is passed (MONTKNI(YES)), AND this   * 00041700
*          monitoring token was obtained using a connect token on     * 00041800
*          IWMMCREA, then the latter connect token is expected to be  * 00041900
*          the same as that specified for IWMRPT.                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*      [ENDTIME=xendtime|CURRENT]                                   * 00042500
*          is the name (RS-type), or address in register (2)-(12), of * 00042600
*          an optional 64 bit input which specifies the ending time   * 00042700
*          for the transaction (typically, when the output is sent or * 00042800
*          available to be sent) in STCK format.                      * 00042900
*          DEFAULT: CURRENT indicates that the current time should be * 00043000
*          used.                                                      * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*      [STATUS=NORMAL|ABNORMAL|NORMAL_LE_VAL|NORMAL_GE_VAL]         * 00043600
*          is an optional keyword input which indicates whether the   * 00043700
*          portion of the work request associated with the Report     * 00043800
*          call has completed normally or not.                        * 00043900
*          DEFAULT: NORMAL                                            * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*          [STATUS=NORMAL                                             * 00044300
*              indicates that work request execution associated with  * 00044400
*              the Report call has completed normally.                * 00044500
*              DEFAULT: NORMAL indicates that work request execution  * 00044600
*              associated with the Report call has completed          * 00044700
*              normally.                                              * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*              [WORK_COMPCD=xwork_compcd|NO_WORK_COMPCD]]           * 00045100
*                  is the name (RS-type), or address in register      * 00045200
*                  (2)-(12), of an optional fullword input which      * 00045300
*                  contains the completion/return code for the work   * 00045400
*                  request execution associated with the Report call. * 00045500
*                  DEFAULT: NO_WORK_COMPCD indicates that NO          * 00045600
*                  completion/return code is passed.                  * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*          [STATUS=ABNORMAL                                           * 00046100
*              indicates that work request execution associated with  * 00046200
*              the Report call has completed abnormally.              * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*              [WORK_COMPCD=xwork_compcd|NO_WORK_COMPCD]]           * 00046600
*                  is the name (RS-type), or address in register      * 00046700
*                  (2)-(12), of an optional fullword input which      * 00046800
*                  contains the completion/return code for the work   * 00046900
*                  request execution associated with the Report call. * 00047000
*                  DEFAULT: NO_WORK_COMPCD indicates that NO          * 00047100
*                  completion/return code is passed.                  * 00047200
*                                                                     * 00047300
*                                                                     * 00047400
*                                                                     * 00047500
*          [STATUS=NORMAL_LE_VAL                                      * 00047600
*              indicates that work request execution associated with  * 00047700
*              the Report call has completed normally PROVIDED the    * 00047800
*              work completion code is below or at (<=) the threshold * 00047900
*              value given by OK_THRESHOLD.                           * 00048000
*                                                                     * 00048100
*                                                                     * 00048200
*              WORK_COMPCD=xwork_compcd                               * 00048300
*                  is the name (RS-type), or address in register      * 00048400
*                  (2)-(12), of a required fullword input which       * 00048500
*                  contains the completion/return code for the work   * 00048600
*                  request execution associated with the Report call. * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*                                                                     * 00049100
*              OK_THRESHOLD=xok_threshold]                            * 00049200
*                  is the name (RS-type), or address in register      * 00049300
*                  (2)-(12), of a required fullword input which       * 00049400
*                  contains the threshold value at which the work     * 00049500
*                  request is considered to have ended normally.      * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*                                                                     * 00049900
*          [STATUS=NORMAL_GE_VAL                                      * 00050000
*              indicates that work request execution associated with  * 00050100
*              the Report call has completed normally PROVIDED the    * 00050200
*              work completion code is above or at (>=) the threshold * 00050300
*              value given by OK_THRESHOLD.                           * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*              WORK_COMPCD=xwork_compcd                               * 00050700
*                  is the name (RS-type), or address in register      * 00050800
*                  (2)-(12), of a required fullword input which       * 00050900
*                  contains the completion/return code for the work   * 00051000
*                  request execution associated with the Report call. * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*              OK_THRESHOLD=xok_threshold]                            * 00051600
*                  is the name (RS-type), or address in register      * 00051700
*                  (2)-(12), of a required fullword input which       * 00051800
*                  contains the threshold value at which the work     * 00051900
*                  request is considered to have ended normally.      * 00052000
*                                                                     * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*                                                                     * 00052700
*                                                                     * 00052800
*      [RETCODE=xretcode]                                             * 00052900
*          is the name (RS-type) of an optional fullword output       * 00053000
*          variable, or register (2)-(12), into which the return code * 00053100
*          is to be copied from GPR 15.                               * 00053200
*                                                                     * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*      [RSNCODE=xrsncode]                                             * 00053700
*          is the name (RS-type) of an optional fullword output       * 00053800
*          variable, or register (2)-(12), into which the reason code * 00053900
*          is to be copied from GPR 0.                                * 00054000
*                                                                     * 00054100
*                                                                     * 00054200
*                                                                     * 00054300
*                                                                     * 00054400
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00054500
*          is an optional byte input decimal value in the "0-0" range * 00054600
*          that specifies the macro version.  PLISTVER is the only    * 00054700
*          key allowed on the list form of MF and determines which    * 00054800
*          parameter list is generated.  Note that MAX may be         * 00054900
*          specified instead of a number, and the parameter list will * 00055000
*          be of the largest size currently supported. This size may  * 00055100
*          grow from release to release (thus possibly affecting the  * 00055200
*          amount of storage needed by your program).  If your        * 00055300
*          program can tolerate this, IBM recommends that you always  * 00055400
*          specify MAX when creating the list form parameter list as  * 00055500
*          that will ensure that the list form parameter list is      * 00055600
*          always long enough to hold whatever parameters might be    * 00055700
*          specified on the execute form.                             * 00055800
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00055900
*          default is the lowest version which allows all of the      * 00056000
*          parameters specified on the invocation to be processed.    * 00056100
*                                                                     * 00056200
*                                                                     * 00056300
*                                                                     * 00056400
*                                                                     * 00056500
*      [MF=S|L|E]                                                   * 00056600
*          is an optional keyword input which specifies the macro     * 00056700
*          form.                                                      * 00056800
*          DEFAULT: S                                                 * 00056900
*                                                                     * 00057000
*                                                                     * 00057100
*          [MF=S]                                                     * 00057200
*              specifies the standard form of the macro.  The "S"     * 00057300
*              form generates code to put the parameters into an      * 00057400
*              in-line parameter list and invoke the desired service. * 00057500
*              Full checking for required macro keys is done along    * 00057600
*              with supplying defaults for omitted optional           * 00057700
*              parameters.                                            * 00057800
*                                                                     * 00057900
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00058000
*              specifies the list form of the macro.  The "L" form    * 00058100
*              defines an area to be used for the parameter list.     * 00058200
*              Only the PLISTVER key may be specified on the          * 00058300
*              invocation.  All other macro parameters are flagged as * 00058400
*              errors.  If PLISTVER is not specified, the original    * 00058500
*              parameter list definition is used.                     * 00058600
*                                                                     * 00058700
*            ,xmfctrl                                                 * 00058800
*              is a required input.  It is the name of a storage area * 00058900
*              for the parameter list.                                * 00059000
*                                                                     * 00059100
*            ,xmfattr|0D                                            * 00059200
*              is an optional 60 character input string that varies   * 00059300
*              from 1 to 60 characters. Use it to force boundary      * 00059400
*              alignment of the parameter list. Use any value that    * 00059500
*              represents a boundary and is valid on an assembler DS  * 00059600
*              pseudo op.                                             * 00059700
*              DEFAULT: 0D which forces the parameter list to a       * 00059800
*              doubleword boundary.                                   * 00059900
*                                                                     * 00060000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00060100
*              specifies the execute form of the macro.  The "E" form * 00060200
*              generates code to put the parameters into the          * 00060300
*              parameter list specified by xmfctrl and provides full  * 00060400
*              syntax checking with default setting.                  * 00060500
*                                                                     * 00060600
*            ,xmfctrl                                                 * 00060700
*              is a required input.  It is the name (RS-type), or     * 00060800
*              address in register (1)-(12), of a storage area for    * 00060900
*              the parameter list.                                    * 00061000
*                                                                     * 00061100
*            ,COMPLETE                                              * 00061200
*              is an optional keyword input which specifies the       * 00061300
*              degree of macro parameter syntax checking.             * 00061400
*              DEFAULT: COMPLETE                                      * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*              COMPLETE                                               * 00061800
*                  Checking for required macro keys is done and       * 00061900
*                  defaults are supplied for omitted optional         * 00062000
*                  parameters.                                        * 00062100
*                                                                     * 00062200
*                                                                     * 00062300
*                                                                     * 00062400
*                                                                     * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*                                                                     * 00062800
*01* ABEND CODES:  None.                                              * 00062900
*                                                                     * 00063000
*01* RETURN CODES:                                                    * 00063100
*                                                                     * 00063200
*                                                                     * 00063300
*            0    Name: IwmRetCodeOk                                  * 00063400
*                                                                     * 00063500
*                 Meaning: Successful completion.                     * 00063600
*                                                                     * 00063700
*                 Action: None required.                              * 00063800
*                                                                     * 00063900
*            4    Name: IwmRetCodeWarning                             * 00064000
*                                                                     * 00064100
*                 Meaning: Successful completion, unusual conditions  * 00064200
*                 noted.                                              * 00064300
*                                                                     * 00064400
*                                                                     * 00064500
*                 HEX REASON  MEANING/ACTION                          * 00064600
*                 CODE                                                * 00064700
*                                                                     * 00064800
*                 xxxx0401    Name: IwmRsnCodeNoWLM                   * 00064900
*                                                                     * 00065000
*                             Meaning:  System does not support delay * 00065100
*                             monitoring services.  This return code  * 00065200
*                             is only set when the MVS release is     * 00065300
*                             prior to MVS/ESA SP5.1.0.               * 00065400
*                                                                     * 00065500
*                             Action: None required.                  * 00065600
*                                                                     * 00065700
*                 xxxx0404    Name: IwmRsnCodeCompatNoSyseventRqd     * 00065800
*                                                                     * 00065900
*                             Meaning:  System is in compatibility    * 00066000
*                             mode and NO SYSEVENT TRAXFRPT was       * 00066100
*                             requested, hence MVS did not receive    * 00066200
*                             the information.                        * 00066300
*                                                                     * 00066400
*                             Action: None required.                  * 00066500
*                                                                     * 00066600
*                 xxxx0405    Name: IwmRsnCodeGoalNoMonEnv            * 00066700
*                                                                     * 00066800
*                             Meaning:  System is in goal mode but    * 00066900
*                             the input monitoring token indicates no * 00067000
*                             monitoring environment was established, * 00067100
*                             hence MVS did not receive the           * 00067200
*                             information.                            * 00067300
*                                                                     * 00067400
*                             Action: None required.                  * 00067500
*                                                                     * 00067600
*                 xxxx0409    Name: IwmRsnCodeNoConn                  * 00067700
*                                                                     * 00067800
*                             Meaning:  Connect token does not        * 00067900
*                             reflect a successful Connect.  The      * 00068000
*                             system did not receive the information  * 00068100
*                             (applies to both goal mode and          * 00068200
*                             compatibility mode). No SYSEVENT        * 00068300
*                             TRAXFRPT was issued.                    * 00068400
*                                                                     * 00068500
*                             Action: None required.                  * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*                                                                     * 00068900
*            8    Name: IwmRetCodeInvocError                          * 00069000
*                                                                     * 00069100
*                 Meaning: Invalid invocation environment or          * 00069200
*                 parameters.                                         * 00069300
*                                                                     * 00069400
*                                                                     * 00069500
*                 HEX REASON  MEANING/ACTION                          * 00069600
*                 CODE                                                * 00069700
*                                                                     * 00069800
*                 xxxx080C    Name: IwmRsnCodeMonEnvLacksData         * 00069900
*                                                                     * 00070000
*                             Meaning:  Input monitoring environment  * 00070100
*                             does not contain the necessary          * 00070200
*                             information.                            * 00070300
*                                                                     * 00070400
*                             Action: Ensure that the monitoring      * 00070500
*                             environment was established with the    * 00070600
*                             necessary information.                  * 00070700
*                                                                     * 00070800
*                 xxxx080E    Name: IwmRsnCodeArrTimeGTEndTime        * 00070900
*                                                                     * 00071000
*                             Meaning:  Input arrival time later than * 00071100
*                             end time.                               * 00071200
*                                                                     * 00071300
*                             Action: Check for possible storage      * 00071400
*                             overlay of the parameter list or        * 00071500
*                             variable.                               * 00071600
*                                                                     * 00071700
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00071800
*                                                                     * 00071900
*                             Meaning:  Input monitoring environment  * 00072000
*                             does not pass short form validity       * 00072100
*                             checking.                               * 00072200
*                                                                     * 00072300
*                             Action: Check for possible storage      * 00072400
*                             overlay.                                * 00072500
*                                                                     * 00072600
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 00072700
*                                                                     * 00072800
*                             Meaning:  Input connect token does not  * 00072900
*                             pass validity checking.                 * 00073000
*                                                                     * 00073100
*                             Action: Check for possible storage      * 00073200
*                             overlay.                                * 00073300
*                                                                     * 00073400
*                 xxxx082D    Name: IwmRsnCodeExStTimeGTEndTime       * 00073500
*                                                                     * 00073600
*                             Meaning:  Execution start time greater  * 00073700
*                             than execution end time                 * 00073800
*                                                                     * 00073900
*                             Action: Check for possible storage      * 00074000
*                             overlay of the parameter list or        * 00074100
*                             variable.                               * 00074200
*                                                                     * 00074300
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 00074400
*                                                                     * 00074500
*                             Meaning:  Caller's space connection is  * 00074600
*                             not enabled for this service.           * 00074700
*                                                                     * 00074800
*                             Action: Avoid requesting this function  * 00074900
*                             under the input connection.  IWMCONN    * 00075000
*                             options must be specified previously to * 00075100
*                             enable this service.                    * 00075200
*                                                                     * 00075300
*                                                                     * 00075400
*                                                                     * 00075500
*            C    Name: IwmRetCodeEnvError                            * 00075600
*                                                                     * 00075700
*                 Meaning: Environmental error.                       * 00075800
*                                                                     * 00075900
*                                                                     * 00076000
*                 HEX REASON  MEANING/ACTION                          * 00076100
*                 CODE                                                * 00076200
*                                                                     * 00076300
*                 xxxx0C02    Name: IwmRsnCodeReportingSusp           * 00076400
*                                                                     * 00076500
*                             Meaning:  SYSEVENT TRAXFRPT invoked,    * 00076600
*                             but reporting is temporarily suspended  * 00076700
*                             for one of the following reasons:       * 00076800
*                                                                     * 00076900
*                                                                     * 00077000
*                             o   RMF workload activity reporting is  * 00077100
*                                 not active                          * 00077200
*                                                                     * 00077300
*                             o   There is no installation control    * 00077400
*                                 specification (IEAICSxx parmlib     * 00077500
*                                 member with RPGN specified for some * 00077600
*                                 subsystem other than TSO) in        * 00077700
*                                 effect.  No data reported but a     * 00077800
*                                 later reissue could be successful.  * 00077900
*                                                                     * 00078000
*                                                                     * 00078100
*                                                                     * 00078200
*                             Action: Invoke the function when the    * 00078300
*                             conditions are alleviated.              * 00078400
*                                                                     * 00078500
*                 xxxx0C03    Name: IwmRsnCodeSyseventNoWorkElt       * 00078600
*                                                                     * 00078700
*                             Meaning:  SYSEVENT TRAXFRPT invoked,    * 00078800
*                             but no work element was available to    * 00078900
*                             save the input information.             * 00079000
*                                                                     * 00079100
*                             Action: Invoke the function when the    * 00079200
*                             conditions are alleviated.  This        * 00079300
*                             condition may be due to a common        * 00079400
*                             storage shortage condition.             * 00079500
*                                                                     * 00079600
*                 xxxx0C05    Name: IwmRsnCodeRptNoWorkElt            * 00079700
*                                                                     * 00079800
*                             Meaning:  Report routine invoked, but   * 00079900
*                             no work element was available to save   * 00080000
*                             the input information.                  * 00080100
*                                                                     * 00080200
*                             Action: Invoke the function when the    * 00080300
*                             conditions are alleviated.  This        * 00080400
*                             condition may be due to a common        * 00080500
*                             storage shortage condition.             * 00080600
*                                                                     * 00080700
*                 xxxx0C06    Name: IwmRsnCodeNoEndTime               * 00080800
*                                                                     * 00080900
*                             Meaning:  No end time was supplied to   * 00081000
*                             the service and STCK gave a non-zero    * 00081100
*                             condition code.                         * 00081200
*                                                                     * 00081300
*                             Action: No action required.             * 00081400
*                                                                     * 00081500
*                                                                     * 00081600
*                                                                     * 00081700
*                                                                     * 00081800
*                                                                     * 00081900
*                                                                     * 00082000
*01* REASON CODES:                                                    * 00082100
*                                                                     * 00082200
*       A unique reason code will be returned whenever the return     * 00082300
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00082400
*       under their corresponding return code.  Reason code and       * 00082500
*       return code constants are defined within IWMYCON.  Note that  * 00082600
*       the high order halfword of register 0, and the reason code    * 00082700
*       variable when specified, may be non-zero and represents       * 00082800
*       diagnostic data which is NOT part of the external interface.  * 00082900
*       The high order halfword should thus be excluded from          * 00083000
*       comparison with the reason code values described above.  The  * 00083100
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00083200
*       used for this purpose.                                        * 00083300
*                                                                     * 00083400
*01* MODULE TYPE:  ASSEM MACRO                                        * 00083500
*                                                                     * 00083600
*02*   PROCESSOR:  ASSEM                                              * 00083700
*                                                                     * 00083800
*01* COMPONENT:  SCWLM                                                * 00083900
*                                                                     * 00084000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00084100
*                                                                     * 00084200
*01* EXAMPLES:                                                        * 00084300
*                                                                     * 00084400
*01* MACRO USAGE NOTES:                                               * 00084500
*                                                                     * 00084600
*                                                                     * 00084700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00084800
*        global macro variable.  Any value other than 'NO' will       * 00084900
*        result in the macro expansion being printed.  The default is * 00085000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00085100
*        variable should be set.                                      * 00085200
*                                                                     * 00085300
*                    GBLC &ZPRINT                                     * 00085400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00085500
*                                                                     * 00085600
*                                                                     * 00085700
*    2.  All  keys currently contained in the IWMRPT macro correspond * 00085800
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00085900
*        MAX.                                                         * 00086000
*                                                                     * 00086100
*                                                                     * 00086200
*                                                                     * 00086300
*                                                                     * 00086400
*01* CHANGE ACTIVITY:                                                 * 00086500
*                                                                     * 00086600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00086700
*                                                                     * 00086800
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 00086900
*    $L1=WLMP     HBB6603 950313 PDRK:  Added new reason code -       * 00087000
*                                         IwmRsnCodeServiceNotEnabled * 00087100
****** END OF SPECIFICATIONS *****************************************/ 00087200
*/********************************************************************* 00087300
         MACRO                                                          00087400
&XLABEL  IWMRPT &TRAXFRPT=,&SYSEVPL=,&PSWKEYP=,&PSWKEY=,&MONTKNI=,     *00087500
               &MONTKN=,&ARRIVALTIME=,&EXSTARTTIMEP=,&EXSTARTTIME=,    *00087600
               &SERVCLS=,&CONNTKN=,&ENDTIME=,&STATUS=,&WORK_COMPCD=,   *00087700
               &OK_THRESHOLD=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=       00087800
.*                                                                      00087900
*                   MACDATE -07/30/96-<0>                               00088000
.*                                                                      00088100
.*******************************************************************    00088200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00088300
.*******************************************************************    00088400
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00088500
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00088600
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00088700
.*                                                                      00088800
                   GBLC  &ZIWMRPT    YES=MACRO USED AT LEAST ONCE       00088900
.*******************************************************************    00089000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00089100
.*******************************************************************    00089200
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00089300
                   LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS       00089400
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00089500
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00089600
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00089700
                   LCLA  &ZAWRK      USED AS A WORK AREA                00089800
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00089900
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00090000
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00090100
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00090200
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00090300
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00090400
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00090500
.*                                                                      00090600
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00090700
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00090800
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00090900
                   LCLC  &ZENDBASEPL            End of base PL          00091000
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00091100
.*******************************************************************    00091200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00091300
.*******************************************************************    00091400
                   LCLA  &ZI         INDEX FOR ARRAY                    00091500
                   LCLA  &ZJ         INDEX FOR PARMS                    00091600
                   LCLA  &ZK         INDEX FOR PARSE                    00091700
                   LCLA  &ZLO        LOW RANGE VALUE                    00091800
                   LCLA  &ZHI        HIGH RANGE VALUE                   00091900
                   LCLC  &ZW         WORK AREA FOR PARM                 00092000
.********************************************************************   00092100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00092200
.********************************************************************   00092300
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00092400
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00092500
.*                                                                      00092600
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00092700
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00092800
                   SPLEVEL  TEST                                        00092900
.ZSYS2             ANOP  ,                                              00093000
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00093100
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00093200
                   SYSSTATE TEST                                        00093300
                   AGO   .ZSYS4                                         00093400
.ZSYS3             ANOP  ,                                              00093500
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00093600
.ZSYS4             ANOP  ,                                              00093700
.*******************************************************************    00093800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00093900
.*******************************************************************    00094000
                   LCLC  &XTRAXFRPT  ++ VALUE                           00094100
                   LCLC  &XSYSEVPL   ++ NAME                            00094200
                   LCLC  &XPSWKEYP   ++ VALUE                           00094300
                   LCLC  &XPSWKEY    ++ NAME                            00094400
                   LCLC  &XMONTKNI   ++ VALUE                           00094500
                   LCLC  &XMONTKN    ++ NAME                            00094600
                   LCLC  &XARRIVALTIME          ++ NAME                 00094700
                   LCLC  &XEXSTARTTIMEP         ++ VALUE                00094800
                   LCLC  &XEXSTARTTIME          ++ NAME                 00094900
                   LCLC  &XSERVCLS   ++ NAME                            00095000
                   LCLC  &XCONNTKN   ++ NAME                            00095100
                   LCLC  &XENDTIME   ++ NAME                            00095200
                   LCLC  &XSTATUS    ++ VALUE                           00095300
                   LCLC  &XWORK_COMPCD          ++ NAME                 00095400
                   LCLC  &XOK_THRESHOLD         ++ NAME                 00095500
                   LCLC  &XRETCODE   ++ NAME                            00095600
                   LCLC  &XRSNCODE   ++ NAME                            00095700
                   LCLA  &XPLISTVER  ++ VALUE                           00095800
                   LCLC  &XMF        ++ VALUE                           00095900
                   LCLC  &XMFCTRL    ++ NAME                            00096000
                   LCLC  &XMFATTR    ++ VALUE                           00096100
                   LCLC  &XMFSCK     ++ VALUE                           00096200
.*******************************************************************    00096300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00096400
.*******************************************************************    00096500
                   LCLC  &ZXTRAXFRPT            ++ INPUT VALUE          00096600
                   LCLC  &ZXSYSEVPL  ++ INPUT NAME                      00096700
                   LCLC  &ZXPSWKEYP  ++ INPUT VALUE                     00096800
                   LCLC  &ZXPSWKEY   ++ INPUT NAME                      00096900
                   LCLC  &ZXMONTKNI  ++ INPUT VALUE                     00097000
                   LCLC  &ZXMONTKN   ++ INPUT NAME                      00097100
                   LCLC  &ZXARRIVALTIME         ++ INPUT NAME           00097200
                   LCLC  &ZXEXSTARTTIMEP        ++ INPUT VALUE          00097300
                   LCLC  &ZXEXSTARTTIME         ++ INPUT NAME           00097400
                   LCLC  &ZXSERVCLS  ++ INPUT NAME                      00097500
                   LCLC  &ZXCONNTKN  ++ INPUT NAME                      00097600
                   LCLC  &ZXENDTIME  ++ INPUT NAME                      00097700
                   LCLC  &ZXSTATUS   ++ INPUT VALUE                     00097800
                   LCLC  &ZXWORK_COMPCD         ++ INPUT NAME           00097900
                   LCLC  &ZXOK_THRESHOLD        ++ INPUT NAME           00098000
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00098100
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00098200
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00098300
                   LCLC  &ZXMF       ++ INPUT VALUE                     00098400
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00098500
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00098600
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00098700
.********************************************************************   00098800
.***AC.PLV01  PROCESS PLISTVER                                      *   00098900
.********************************************************************   00099000
&XPLISTVER      SETA  0                                                 00099100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00099200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00099300
&XPLISTVER      SETA  0                                                 00099400
.ZPLV0          ANOP  ,                                                 00099500
.*                                                                      00099600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00099700
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00099800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00099900
.*-------------------------------------------------------------------   00100000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00100100
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00100200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00100300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00100400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00100500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00100600
                AGO   .ZPVCK2                                           00100700
.ZPVCK3         ANOP  ,                                                 00100800
.*-------------------------------------------------------------------   00100900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00101000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00101100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00101200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00101300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00101400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00101500
                AGO   .ZPVCKE                                           00101600
.ZPVCK2         ANOP  ,                                                 00101700
.*-------------------------------------------------------------------   00101800
&ZCVAL          SETC  '&PLISTVER(1)'                                    00101900
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00102000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00102100
                AIF   (&XPLISTVER LT 0).ZPVCK6  TOO LOW                 00102200
                AIF   (&XPLISTVER LE 0).ZPVCKE  NOT HIGH                00102300
.ZPVCK6         ANOP  ,                                                 00102400
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00102500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00102600
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00102700
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00102800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00102900
&XPLISTVER      SETA  0                                                 00103000
                AGO   .ZPVCKE                                           00103100
.*-------------------------------------------------------------------   00103200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00103300
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00103400
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00103500
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00103600
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00103700
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00103800
                MNOTE 8,' &ZMS IS REQUIRED.'                            00103900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00104000
                AGO   .ZPVCK5                                           00104100
.ZPVCK4         ANOP  ,                                                 00104200
&XPLISTVER      SETA  &PLISTVER(1)                                      00104300
.ZPVCK5         ANOP  ,                                                 00104400
.ZPVCKE         ANOP  ,                                                 00104500
.********************************************************************   00104600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00104700
.********************************************************************   00104800
                   ACTR  10000                                          00104900
.*------------------------------------------------------------------    00105000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105100
&XMF               SETC  ''          INITIALIZE XVARIABLE               00105200
.*-------------------------------------------------------------------   00105300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105400
.ZG81              ANOP  ,                                              00105500
&ZTLC              SETC 'S'                                             00105600
                   AIF   ('&MF(1)' NE '&ZTLC').ZG82                     00105700
&XMF               SETC  'S'         SET KEYWORD                        00105800
                   AIF   (N'&MF LE 1).ZG81A     CK NUM                  00105900
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      00106000
&ZMS               SETC  '&ZMS.&MF"'                                    00106100
&ZMS               SETC  '&ZMS "MF"'                                    00106200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00106300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00106400
.ZG81A             ANOP  ,                                              00106500
.*-------------------------------------------------------------------   00106600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106700
.ZG82              ANOP  ,                                              00106800
&ZTLC              SETC 'L'                                             00106900
                   AIF   ('&MF(1)' NE '&ZTLC').ZG89                     00107000
&XMF               SETC  'L'         SET KEYWORD                        00107100
                   AIF   (N'&MF LE 3).ZG82A     CK NUM                  00107200
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      00107300
&ZMS               SETC  '&ZMS.&MF"'                                    00107400
&ZMS               SETC  '&ZMS "MF"'                                    00107500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00107600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00107700
.ZG82A             ANOP  ,                                              00107800
.*-------------------------------------------------------------------   00107900
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00108000
                   AIF   (N'&SYSLIST NE 0).ZG82B  POSITIONALS?          00108100
                   AIF   ('&TRAXFRPT' NE '').ZG82B  KEYS?               00108200
                   AIF   ('&SYSEVPL' NE '').ZG82B  KEYS?                00108300
                   AIF   ('&PSWKEYP' NE '').ZG82B  KEYS?                00108400
                   AIF   ('&PSWKEY' NE '').ZG82B  KEYS?                 00108500
                   AIF   ('&MONTKNI' NE '').ZG82B  KEYS?                00108600
                   AIF   ('&MONTKN' NE '').ZG82B  KEYS?                 00108700
                   AIF   ('&ARRIVALTIME' NE '').ZG82B  KEYS?            00108800
                   AIF   ('&EXSTARTTIMEP' NE '').ZG82B  KEYS?           00108900
                   AIF   ('&EXSTARTTIME' NE '').ZG82B  KEYS?            00109000
                   AIF   ('&SERVCLS' NE '').ZG82B  KEYS?                00109100
                   AIF   ('&CONNTKN' NE '').ZG82B  KEYS?                00109200
                   AIF   ('&ENDTIME' NE '').ZG82B  KEYS?                00109300
                   AIF   ('&STATUS' NE '').ZG82B  KEYS?                 00109400
                   AIF   ('&WORK_COMPCD' NE '').ZG82B  KEYS?            00109500
                   AIF   ('&OK_THRESHOLD' NE '').ZG82B  KEYS?           00109600
                   AIF   ('&RETCODE' NE '').ZG82B  KEYS?                00109700
                   AIF   ('&RSNCODE' NE '').ZG82B  KEYS?                00109800
                   AGO    .ZG82C     INVOCATION OKAY                    00109900
.ZG82B             ANOP  ,                                              00110000
&ZMS               SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE           00110100
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00110200
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00110300
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00110400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00110500
.ZG82C             ANOP  ,                                              00110600
.*-------------------------------------------------------------------   00110700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00110800
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00110900
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00111000
                   AIF   (N'&MF(2) GT 1).ZG84B  MULTI PARMS             00111100
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00111200
.ZG84B             AIF   (K'&MF(2) GT 0).ZG84C                          00111300
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00111400
&ZMS               SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*               00111500
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00111600
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00111700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00111800
.ZG84C             ANOP  ,                                              00111900
.*-------------------------------------------------------------------   00112000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00112100
                   AIF   (K'&ZXMFCTRL LE 0).ZG84P  NOT I/O              00112200
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG84P                 00112300
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00112400
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      00112500
&ZMS               SETC  '&ZMS.&MF"'                                    00112600
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00112700
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00112800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00112900
.ZG84P             ANOP  ,                                              00113000
.*-------------------------------------------------------------------   00113100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00113200
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00113300
&XMFATTR           SETC  '0D'                                           00113400
                   AIF   (K'&MF(3) LE 0).ZG87B  PARM                    00113500
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00113600
                   AIF   (N'&MF(3) GT 1).ZG87B  MULTI PARMS             00113700
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00113800
.ZG87B             ANOP  ,                                              00113900
.*-------------------------------------------------------------------   00114000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00114100
                   AIF   (K'&ZXMFATTR LE 0).ZG87P  NOT I/O              00114200
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG87P                 00114300
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00114400
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      00114500
&ZMS               SETC  '&ZMS.&MF"'                                    00114600
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00114700
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00114800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00114900
.ZG87P             ANOP  ,                                              00115000
.*-------------------------------------------------------------------   00115100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00115200
                   AIF   (K'&ZXMFATTR LE 0).ZG87S  NOT I/O              00115300
                   AIF   (K'&XMFATTR LE 60).ZG87S  LNG OK               00115400
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00115500
&ZMS               SETC  '"MF='      *KLNGA* MNOTE                      00115600
&ZMS               SETC  '&ZMS.&MF"'                                    00115700
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00115800
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00115900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00116000
.ZG87S             ANOP  ,                                              00116100
.*-------------------------------------------------------------------   00116200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116300
.ZG89              ANOP  ,                                              00116400
&ZTLC              SETC 'E'                                             00116500
                   AIF   ('&MF(1)' NE '&ZTLC').ZG97                     00116600
&XMF               SETC  'E'         SET KEYWORD                        00116700
                   AIF   (N'&MF LE 3).ZG89A     CK NUM                  00116800
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      00116900
&ZMS               SETC  '&ZMS.&MF"'                                    00117000
&ZMS               SETC  '&ZMS "MF"'                                    00117100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00117200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00117300
.ZG89A             ANOP  ,                                              00117400
.*-------------------------------------------------------------------   00117500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00117600
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00117700
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00117800
                   AIF   (N'&MF(2) GT 1).ZG91B  MULTI PARMS             00117900
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00118000
.ZG91B             AIF   (K'&MF(2) GT 0).ZG91C                          00118100
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00118200
&ZMS               SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*               00118300
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00118400
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00118500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118600
.ZG91C             ANOP  ,                                              00118700
.*-------------------------------------------------------------------   00118800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00118900
                   AIF   (K'&ZXMFCTRL LE 0).ZG91R  NOT I/O              00119000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG91R                 00119100
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00119200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG91P                   00119300
                   AIF   (K'&ZCGPR GT 2).ZG91Q                          00119400
                   AIF   ('&ZCGPR' EQ '0').ZG91Q                        00119500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00119600
                   AIF   (T'&ZCGPR NE 'N').ZG91Q  INVALID REG NAME      00119700
.ZG91P             ANOP  ,                                              00119800
                   AIF   (T'&ZCGPR NE 'N').ZG91R  NON NUMERIC           00119900
                   AIF   ('&ZCGPR' LT '1').ZG91Q                        00120000
                   AIF   ('&ZCGPR' LE '12').ZG91R                       00120100
.ZG91Q             ANOP  ,                                              00120200
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      00120300
&ZMS               SETC  '&ZMS.&MF"'                                    00120400
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00120500
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00120600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00120700
.ZG91R             ANOP  ,                                              00120800
.*-------------------------------------------------------------------   00120900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121000
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00121100
.ZG95A   AIF   ('&MF(3)' NE 'COMPLETE').ZG96A                           00121200
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00121300
.*-------------------------------------------------------------------   00121400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121500
.ZG96A             AIF   (K'&XMFSCK GT 0).ZG96C  KEYWORD                00121600
                   AIF   (K'&MF(3) LE 0).ZG96B                          00121700
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      00121800
&ZMS               SETC  '&ZMS.&MF"'                                    00121900
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00122000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00122100
&ZMS               SETC  '&ZMS "COMPLETE".'     VALID KEYWORD           00122200
                   MNOTE 8,' &ZMS '                                     00122300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00122400
.ZG96B             ANOP  ,                                              00122500
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00122600
.ZG96C             ANOP  ,                                              00122700
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00122800
.*------------------------------------------------------------------    00122900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123000
.ZG97              ANOP  ,                                              00123100
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00123200
                   AIF   (K'&XMF GT 0).ZG97E    VALID ARG               00123300
                   AIF   (T'&MF EQ 'O').ZG97D   OMITTED                 00123400
&ZASYSLNDX         SETA  0                                              00123500
.ZG97A             ANOP  ,           POSITIONAL MACRO KEY               00123600
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00123700
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG97C               00123800
&ZTLC              SETC 'MF'                                            00123900
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG97A      00124000
.ZG97B             ANOP  ,                                              00124100
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00124200
&ZMS               SETC  'THE "MF" KEY'         *KOPTA* MNOTE           00124300
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00124400
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00124500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00124600
                   AGO   .ZG97E                                         00124700
.ZG97C             ANOP  ,                                              00124800
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00124900
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      00125000
&ZMS               SETC  '&ZMS.&MF"'                                    00125100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00125200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00125300
&ZMS               SETC  '&ZMS "S",'            VALID KEYWORD           00125400
&ZMS               SETC  '&ZMS "L",'            VALID KEYWORD           00125500
&ZMS               SETC  '&ZMS OR "E".'         VALID KEYWORD           00125600
                   MNOTE 8,' &ZMS '                                     00125700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00125800
                   AGO   .ZG97E                                         00125900
.ZG97D             ANOP  ,                                              00126000
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00126100
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00126200
.ZG97E             ANOP  ,                                              00126300
.********************************************************************   00126400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00126500
.********************************************************************   00126600
                   ACTR  10000                                          00126700
.*-------------------------------------------------------------------   00126800
.***AG.MF03 MF=(SLE)                                                    00126900
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00127000
.*------------------------------------------------------------------    00127100
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127200
&XTRAXFRPT         SETC  ''          INITIALIZE XVARIABLE               00127300
.*-------------------------------------------------------------------   00127400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127500
.ZG3               ANOP  ,                                              00127600
                   AIF   (K'&TRAXFRPT(1) LE 0).ZG3A                     00127700
&ZTLC              SETC 'YES'                                           00127800
                   AIF   ('&TRAXFRPT(1)' NE '&ZTLC').ZG7                00127900
&XTRAXFRPT         SETC  'YES'       SET KEYWORD                        00128000
                   AIF   (N'&TRAXFRPT LE 1).ZG3A  CK NUM                00128100
&ZMS               SETC  '"TRAXFRPT='           *KPOSA* MNOTE           00128200
&ZMS               SETC  '&ZMS.&TRAXFRPT"'                              00128300
&ZMS               SETC  '&ZMS "TRAXFRPT"'                              00128400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00128500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00128600
.ZG3A              ANOP  ,                                              00128700
.*------------------------------------------------------------------    00128800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128900
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00129000
.ZG3A0             AIF   (K'&PSWKEYP LE 0).ZG3A1  OK                    00129100
&ZCVAL             SETC '&ZCVAL PSWKEYP'        INCORRECT KEY USED      00129200
.ZG3A1             AIF   (K'&PSWKEY LE 0).ZG3A2  OK                     00129300
&ZCVAL             SETC '&ZCVAL PSWKEY'         INCORRECT KEY USED      00129400
.ZG3A2             AIF   (K'&ZCVAL LE 0).ZG3A3  OK                      00129500
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00129600
&ZMS               SETC  '"TRAXFRPT'            *KMEIA* MNOTE           00129700
&ZMS               SETC  '&ZMS.=&TRAXFRPT"'                             00129800
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00129900
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00130000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00130100
.ZG3A3             ANOP  ,                                              00130200
.*----------------------------------------------------------------***   00130300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00130400
                   AIF   (N'&SYSEVPL LE 1).ZG5A  CK NUM                 00130500
&ZMS               SETC  '"SYSEVPL='            *KPOSA* MNOTE           00130600
&ZMS               SETC  '&ZMS.&SYSEVPL"'                               00130700
&ZMS               SETC  '&ZMS "SYSEVPL"'                               00130800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00130900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00131000
.ZG5A              ANOP  ,                                              00131100
.*-------------------------------------------------------------------   00131200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00131300
&ZXSYSEVPL         SETC  'INPUT'     SET IN/OUTPUT                      00131400
&XSYSEVPL          SETC  '&SYSEVPL(1)'          SET XVARIABLE           00131500
                   AIF   (N'&SYSEVPL GT 1).ZG5B  MULTI PARMS            00131600
&XSYSEVPL          SETC  '&SYSEVPL'  SET XVARIABLE                      00131700
.ZG5B              AIF   (K'&SYSEVPL(1) GT 0).ZG5C                      00131800
&ZXSYSEVPL         SETC  ''          RESET IN/OUTPUT                    00131900
&ZMS               SETC  ' '         *KRQDA*                            00132000
&ZMS               SETC  '&ZMS "SYSEVPL" KEY AND ITS ARGUMENT'          00132100
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00132200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00132300
.ZG5C              ANOP  ,                                              00132400
.*-------------------------------------------------------------------   00132500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00132600
                   AIF   (K'&ZXSYSEVPL LE 0).ZG5R  NOT I/O              00132700
                   AIF   ('&XSYSEVPL'(1,1) NE '(').ZG5R                 00132800
&ZCGPR             SETC  '&XSYSEVPL'(2,K'&XSYSEVPL-2)                   00132900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                    00133000
                   AIF   (K'&ZCGPR GT 2).ZG5Q                           00133100
                   AIF   ('&ZCGPR' EQ '0').ZG5Q                         00133200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00133300
                   AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME       00133400
.ZG5P              ANOP  ,                                              00133500
                   AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC            00133600
                   AIF   ('&ZCGPR' LT '2').ZG5Q                         00133700
                   AIF   ('&ZCGPR' LE '12').ZG5R                        00133800
.ZG5Q              ANOP  ,                                              00133900
&ZMS               SETC  '"SYSEVPL='            *KGPRA* MNOTE           00134000
&ZMS               SETC  '&ZMS.&SYSEVPL"'                               00134100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00134200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00134300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00134400
.ZG5R              ANOP  ,                                              00134500
.*-------------------------------------------------------------------   00134600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00134700
.ZG7               ANOP  ,                                              00134800
&ZTLC              SETC 'NO'                                            00134900
                   AIF   ('&TRAXFRPT(1)' NE '&ZTLC').ZG16               00135000
&XTRAXFRPT         SETC  'NO'        SET KEYWORD                        00135100
                   AIF   (N'&TRAXFRPT LE 1).ZG7A  CK NUM                00135200
&ZMS               SETC  '"TRAXFRPT='           *KPOSA* MNOTE           00135300
&ZMS               SETC  '&ZMS.&TRAXFRPT"'                              00135400
&ZMS               SETC  '&ZMS "TRAXFRPT"'                              00135500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00135600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00135700
.ZG7A              ANOP  ,                                              00135800
.*------------------------------------------------------------------    00135900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136000
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00136100
.ZG7A0             AIF   (K'&SYSEVPL LE 0).ZG7A1  OK                    00136200
&ZCVAL             SETC '&ZCVAL SYSEVPL'        INCORRECT KEY USED      00136300
.ZG7A1             AIF   (K'&ZCVAL LE 0).ZG7A2  OK                      00136400
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00136500
&ZMS               SETC  '"TRAXFRPT'            *KMEIA* MNOTE           00136600
&ZMS               SETC  '&ZMS.=&TRAXFRPT"'                             00136700
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00136800
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00136900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00137000
.ZG7A2             ANOP  ,                                              00137100
.*------------------------------------------------------------------    00137200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137300
&XPSWKEYP          SETC  ''          INITIALIZE XVARIABLE               00137400
.*-------------------------------------------------------------------   00137500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137600
.ZG10              ANOP  ,                                              00137700
                   AIF   (K'&PSWKEYP(1) LE 0).ZG10A                     00137800
&ZTLC              SETC 'VALUE'                                         00137900
                   AIF   ('&PSWKEYP(1)' NE '&ZTLC').ZG14                00138000
&XPSWKEYP          SETC  'VALUE'     SET KEYWORD                        00138100
                   AIF   (N'&PSWKEYP LE 1).ZG10A  CK NUM                00138200
&ZMS               SETC  '"PSWKEYP='            *KPOSA* MNOTE           00138300
&ZMS               SETC  '&ZMS.&PSWKEYP"'                               00138400
&ZMS               SETC  '&ZMS "PSWKEYP"'                               00138500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00138600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00138700
.ZG10A             ANOP  ,                                              00138800
.*----------------------------------------------------------------***   00138900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00139000
                   AIF   (N'&PSWKEY LE 1).ZG12A  CK NUM                 00139100
&ZMS               SETC  '"PSWKEY='  *KPOSA* MNOTE                      00139200
&ZMS               SETC  '&ZMS.&PSWKEY"'                                00139300
&ZMS               SETC  '&ZMS "PSWKEY"'                                00139400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00139500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00139600
.ZG12A             ANOP  ,                                              00139700
.*-------------------------------------------------------------------   00139800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00139900
&ZXPSWKEY          SETC  'INPUT'     SET IN/OUTPUT                      00140000
&XPSWKEY           SETC  '&PSWKEY(1)'           SET XVARIABLE           00140100
                   AIF   (N'&PSWKEY GT 1).ZG12B  MULTI PARMS            00140200
&XPSWKEY           SETC  '&PSWKEY'   SET XVARIABLE                      00140300
.ZG12B             AIF   (K'&PSWKEY(1) GT 0).ZG12C                      00140400
&ZXPSWKEY          SETC  ''          RESET IN/OUTPUT                    00140500
&ZMS               SETC  ' '         *KRQDA*                            00140600
&ZMS               SETC  '&ZMS "PSWKEY" KEY AND ITS ARGUMENT'           00140700
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00140800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00140900
.ZG12C             ANOP  ,                                              00141000
.*-------------------------------------------------------------------   00141100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00141200
                   AIF   (K'&ZXPSWKEY LE 0).ZG12R  NOT I/O              00141300
                   AIF   ('&XPSWKEY'(1,1) NE '(').ZG12R                 00141400
&ZCGPR             SETC  '&XPSWKEY'(2,K'&XPSWKEY-2)                     00141500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                   00141600
                   AIF   (K'&ZCGPR GT 2).ZG12Q                          00141700
                   AIF   ('&ZCGPR' EQ '0').ZG12Q                        00141800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00141900
                   AIF   (T'&ZCGPR NE 'N').ZG12Q  INVALID REG NAME      00142000
.ZG12P             ANOP  ,                                              00142100
                   AIF   (T'&ZCGPR NE 'N').ZG12R  NON NUMERIC           00142200
                   AIF   ('&ZCGPR' LT '2').ZG12Q                        00142300
                   AIF   ('&ZCGPR' LE '12').ZG12R                       00142400
.ZG12Q             ANOP  ,                                              00142500
&ZMS               SETC  '"PSWKEY='  *KGPRA* MNOTE                      00142600
&ZMS               SETC  '&ZMS.&PSWKEY"'                                00142700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00142800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00142900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00143000
.ZG12R             ANOP  ,                                              00143100
.*-------------------------------------------------------------------   00143200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143300
.ZG14              ANOP  ,                                              00143400
&ZTLC              SETC 'CURRENT'                                       00143500
                   AIF   ('&PSWKEYP(1)' NE '&ZTLC').ZG15                00143600
&XPSWKEYP          SETC  'CURRENT'   SET KEYWORD                        00143700
                   AIF   (N'&PSWKEYP LE 1).ZG14A  CK NUM                00143800
&ZMS               SETC  '"PSWKEYP='            *KPOSA* MNOTE           00143900
&ZMS               SETC  '&ZMS.&PSWKEYP"'                               00144000
&ZMS               SETC  '&ZMS "PSWKEYP"'                               00144100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00144200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00144300
.ZG14A             ANOP  ,                                              00144400
.*------------------------------------------------------------------    00144500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144600
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00144700
.ZG14A0            AIF   (K'&PSWKEY LE 0).ZG14A1  OK                    00144800
&ZCVAL             SETC '&ZCVAL PSWKEY'         INCORRECT KEY USED      00144900
.ZG14A1            AIF   (K'&ZCVAL LE 0).ZG14A2  OK                     00145000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00145100
&ZMS               SETC  '"PSWKEYP'  *KMEIA* MNOTE                      00145200
&ZMS               SETC  '&ZMS.=&PSWKEYP"'                              00145300
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00145400
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00145500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00145600
.ZG14A2            ANOP  ,                                              00145700
.*------------------------------------------------------------------    00145800
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145900
.ZG15              ANOP  ,                                              00146000
&ZXPSWKEYP         SETC  'INPUT'     SET IN/OUTPUT                      00146100
                   AIF   (K'&XPSWKEYP GT 0).ZG15E  VALID ARG            00146200
                   AIF   (T'&PSWKEYP EQ 'O').ZG15D  OMITTED             00146300
&ZASYSLNDX         SETA  0                                              00146400
.ZG15A             ANOP  ,           POSITIONAL MACRO KEY               00146500
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00146600
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG15C               00146700
&ZTLC              SETC 'PSWKEYP'                                       00146800
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG15A      00146900
.ZG15B             ANOP  ,                                              00147000
&ZXPSWKEYP         SETC  ''          RESET IN/OUTPUT                    00147100
&ZMS               SETC  'THE "PSWKEYP" KEY'    *KOPTA* MNOTE           00147200
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00147300
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00147400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00147500
                   AGO   .ZG15E                                         00147600
.ZG15C             ANOP  ,                                              00147700
&ZXPSWKEYP         SETC  ''          RESET IN/OUTPUT                    00147800
&ZMS               SETC  '"PSWKEYP='            *KUKWA* MNOTE           00147900
&ZMS               SETC  '&ZMS.&PSWKEYP"'                               00148000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00148100
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00148200
&ZMS               SETC  '&ZMS "VALUE"'         VALID KEYWORD           00148300
&ZMS               SETC  '&ZMS OR "CURRENT".'   VALID KEYWORD           00148400
                   MNOTE 8,' &ZMS '                                     00148500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00148600
                   AGO   .ZG15E                                         00148700
.ZG15D             ANOP  ,                                              00148800
&XPSWKEYP          SETC  'VALUE'     SET DEFAULT KEYWORD                00148900
.ZG15E             ANOP  ,                                              00149000
.*------------------------------------------------------------------    00149100
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149200
                   AIF   (K'&PSWKEYP(1) GT 0).ZG15F  PARM               00149300
&XPSWKEYP          SETC  ''          ENSURE NULL KEYWORD                00149400
&ZXPSWKEYP         SETC  ''          RESET IN/OUTPUT                    00149500
&ZMS               SETC  'THE'                                          00149600
&ZMS               SETC  '&ZMS "PSWKEYP" KEY AND ITS ARGUMENT'          00149700
&ZMS               SETC  '&ZMS ARE REQUIRED.'                           00149800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00149900
&ZMS               SETC  '&ZMS "VALUE"'         VALID KEYWORD           00150000
&ZMS               SETC  '&ZMS OR "CURRENT".'   VALID KEYWORD           00150100
                   MNOTE 8,' &ZMS '                                     00150200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00150300
.ZG15F             ANOP  ,                                              00150400
.*------------------------------------------------------------------    00150500
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150600
.ZG16              ANOP  ,                                              00150700
&ZXTRAXFRPT        SETC  'INPUT'     SET IN/OUTPUT                      00150800
                   AIF   (K'&XTRAXFRPT GT 0).ZG16E  VALID ARG           00150900
                   AIF   (T'&TRAXFRPT EQ 'O').ZG16D  OMITTED            00151000
&ZASYSLNDX         SETA  0                                              00151100
.ZG16A             ANOP  ,           POSITIONAL MACRO KEY               00151200
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00151300
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C               00151400
&ZTLC              SETC 'TRAXFRPT'                                      00151500
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG16A      00151600
.ZG16B             ANOP  ,                                              00151700
&ZXTRAXFRPT        SETC  ''          RESET IN/OUTPUT                    00151800
&ZMS               SETC  'THE "TRAXFRPT" KEY'   *KOPTA* MNOTE           00151900
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00152000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00152100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00152200
                   AGO   .ZG16E                                         00152300
.ZG16C             ANOP  ,                                              00152400
&ZXTRAXFRPT        SETC  ''          RESET IN/OUTPUT                    00152500
&ZMS               SETC  '"TRAXFRPT='           *KUKWA* MNOTE           00152600
&ZMS               SETC  '&ZMS.&TRAXFRPT"'                              00152700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00152800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00152900
&ZMS               SETC  '&ZMS "YES"'           VALID KEYWORD           00153000
&ZMS               SETC  '&ZMS OR "NO".'        VALID KEYWORD           00153100
                   MNOTE 8,' &ZMS '                                     00153200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00153300
                   AGO   .ZG16E                                         00153400
.ZG16D             ANOP  ,                                              00153500
&XTRAXFRPT         SETC  'YES'       SET DEFAULT KEYWORD                00153600
.ZG16E             ANOP  ,                                              00153700
.*------------------------------------------------------------------    00153800
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153900
                   AIF   (K'&TRAXFRPT(1) GT 0).ZG16F  PARM              00154000
&XTRAXFRPT         SETC  ''          ENSURE NULL KEYWORD                00154100
&ZXTRAXFRPT        SETC  ''          RESET IN/OUTPUT                    00154200
&ZMS               SETC  'THE'                                          00154300
&ZMS               SETC  '&ZMS "TRAXFRPT" KEY AND ITS ARGUMENT'         00154400
&ZMS               SETC  '&ZMS ARE REQUIRED.'                           00154500
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00154600
&ZMS               SETC  '&ZMS "YES"'           VALID KEYWORD           00154700
&ZMS               SETC  '&ZMS OR "NO".'        VALID KEYWORD           00154800
                   MNOTE 8,' &ZMS '                                     00154900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00155000
.ZG16F             ANOP  ,                                              00155100
.*------------------------------------------------------------------    00155200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155300
&XMONTKNI          SETC  ''          INITIALIZE XVARIABLE               00155400
.*-------------------------------------------------------------------   00155500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155600
.ZG19              ANOP  ,                                              00155700
                   AIF   (K'&MONTKNI(1) LE 0).ZG19A                     00155800
&ZTLC              SETC 'YES'                                           00155900
                   AIF   ('&MONTKNI(1)' NE '&ZTLC').ZG23                00156000
&XMONTKNI          SETC  'YES'       SET KEYWORD                        00156100
                   AIF   (N'&MONTKNI LE 1).ZG19A  CK NUM                00156200
&ZMS               SETC  '"MONTKNI='            *KPOSA* MNOTE           00156300
&ZMS               SETC  '&ZMS.&MONTKNI"'                               00156400
&ZMS               SETC  '&ZMS "MONTKNI"'                               00156500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00156600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00156700
.ZG19A             ANOP  ,                                              00156800
.*------------------------------------------------------------------    00156900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157000
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00157100
.ZG19A0            AIF   (K'&ARRIVALTIME LE 0).ZG19A1  OK               00157200
&ZCVAL             SETC '&ZCVAL ARRIVALTIME'    INCORRECT KEY USED      00157300
.ZG19A1            AIF   (K'&EXSTARTTIMEP LE 0).ZG19A2  OK              00157400
&ZCVAL             SETC '&ZCVAL EXSTARTTIMEP'   INCORRECT KEY USED      00157500
.ZG19A2            AIF   (K'&EXSTARTTIME LE 0).ZG19A3  OK               00157600
&ZCVAL             SETC '&ZCVAL EXSTARTTIME'    INCORRECT KEY USED      00157700
.ZG19A3            AIF   (K'&SERVCLS LE 0).ZG19A4  OK                   00157800
&ZCVAL             SETC '&ZCVAL SERVCLS'        INCORRECT KEY USED      00157900
.ZG19A4            AIF   (K'&ZCVAL LE 0).ZG19A5  OK                     00158000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00158100
&ZMS               SETC  '"MONTKNI'  *KMEIA* MNOTE                      00158200
&ZMS               SETC  '&ZMS.=&MONTKNI"'                              00158300
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00158400
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00158500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00158600
.ZG19A5            ANOP  ,                                              00158700
.*----------------------------------------------------------------***   00158800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00158900
                   AIF   (N'&MONTKN LE 1).ZG21A  CK NUM                 00159000
&ZMS               SETC  '"MONTKN='  *KPOSA* MNOTE                      00159100
&ZMS               SETC  '&ZMS.&MONTKN"'                                00159200
&ZMS               SETC  '&ZMS "MONTKN"'                                00159300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00159400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00159500
.ZG21A             ANOP  ,                                              00159600
.*-------------------------------------------------------------------   00159700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00159800
&ZXMONTKN          SETC  'INPUT'     SET IN/OUTPUT                      00159900
&XMONTKN           SETC  '&MONTKN(1)'           SET XVARIABLE           00160000
                   AIF   (N'&MONTKN GT 1).ZG21B  MULTI PARMS            00160100
&XMONTKN           SETC  '&MONTKN'   SET XVARIABLE                      00160200
.ZG21B             AIF   (K'&MONTKN(1) GT 0).ZG21C                      00160300
&ZXMONTKN          SETC  ''          RESET IN/OUTPUT                    00160400
&ZMS               SETC  ' '         *KRQDA*                            00160500
&ZMS               SETC  '&ZMS "MONTKN" KEY AND ITS ARGUMENT'           00160600
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00160700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00160800
.ZG21C             ANOP  ,                                              00160900
.*-------------------------------------------------------------------   00161000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00161100
                   AIF   (K'&ZXMONTKN LE 0).ZG21R  NOT I/O              00161200
                   AIF   ('&XMONTKN'(1,1) NE '(').ZG21R                 00161300
&ZCGPR             SETC  '&XMONTKN'(2,K'&XMONTKN-2)                     00161400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                   00161500
                   AIF   (K'&ZCGPR GT 2).ZG21Q                          00161600
                   AIF   ('&ZCGPR' EQ '0').ZG21Q                        00161700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00161800
                   AIF   (T'&ZCGPR NE 'N').ZG21Q  INVALID REG NAME      00161900
.ZG21P             ANOP  ,                                              00162000
                   AIF   (T'&ZCGPR NE 'N').ZG21R  NON NUMERIC           00162100
                   AIF   ('&ZCGPR' LT '2').ZG21Q                        00162200
                   AIF   ('&ZCGPR' LE '12').ZG21R                       00162300
.ZG21Q             ANOP  ,                                              00162400
&ZMS               SETC  '"MONTKN='  *KGPRA* MNOTE                      00162500
&ZMS               SETC  '&ZMS.&MONTKN"'                                00162600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00162700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00162800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00162900
.ZG21R             ANOP  ,                                              00163000
.*-------------------------------------------------------------------   00163100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00163200
.ZG23              ANOP  ,                                              00163300
&ZTLC              SETC 'NO'                                            00163400
                   AIF   ('&MONTKNI(1)' NE '&ZTLC').ZG38                00163500
&XMONTKNI          SETC  'NO'        SET KEYWORD                        00163600
                   AIF   (N'&MONTKNI LE 1).ZG23A  CK NUM                00163700
&ZMS               SETC  '"MONTKNI='            *KPOSA* MNOTE           00163800
&ZMS               SETC  '&ZMS.&MONTKNI"'                               00163900
&ZMS               SETC  '&ZMS "MONTKNI"'                               00164000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00164100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00164200
.ZG23A             ANOP  ,                                              00164300
.*------------------------------------------------------------------    00164400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00164500
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00164600
.ZG23A0            AIF   (K'&MONTKN LE 0).ZG23A1  OK                    00164700
&ZCVAL             SETC '&ZCVAL MONTKN'         INCORRECT KEY USED      00164800
.ZG23A1            AIF   (K'&ZCVAL LE 0).ZG23A2  OK                     00164900
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00165000
&ZMS               SETC  '"MONTKNI'  *KMEIA* MNOTE                      00165100
&ZMS               SETC  '&ZMS.=&MONTKNI"'                              00165200
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00165300
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00165400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00165500
.ZG23A2            ANOP  ,                                              00165600
.*----------------------------------------------------------------***   00165700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00165800
                   AIF   (N'&ARRIVALTIME LE 1).ZG25A  CK NUM            00165900
&ZMS               SETC  '"ARRIVALTIME='        *KPOSA* MNOTE           00166000
&ZMS               SETC  '&ZMS.&ARRIVALTIME"'                           00166100
&ZMS               SETC  '&ZMS "ARRIVALTIME"'                           00166200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00166300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166400
.ZG25A             ANOP  ,                                              00166500
.*-------------------------------------------------------------------   00166600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00166700
&ZXARRIVALTIME     SETC  'INPUT'     SET IN/OUTPUT                      00166800
&XARRIVALTIME      SETC  '&ARRIVALTIME(1)'      SET XVARIABLE           00166900
                   AIF   (N'&ARRIVALTIME GT 1).ZG25B  MULTI PARMS       00167000
&XARRIVALTIME      SETC  '&ARRIVALTIME'         SET XVARIABLE           00167100
.ZG25B             AIF   (K'&ARRIVALTIME(1) GT 0).ZG25C                 00167200
&ZXARRIVALTIME     SETC  ''          RESET IN/OUTPUT                    00167300
&ZMS               SETC  ' '         *KRQDA*                            00167400
&ZMS               SETC  '&ZMS "ARRIVALTIME" KEY AND ITS ARGUMENT'      00167500
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00167600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00167700
.ZG25C             ANOP  ,                                              00167800
.*-------------------------------------------------------------------   00167900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00168000
                   AIF   (K'&ZXARRIVALTIME LE 0).ZG25R  NOT I/O         00168100
                   AIF   ('&XARRIVALTIME'(1,1) NE '(').ZG25R            00168200
&ZCGPR             SETC  '&XARRIVALTIME'(2,K'&XARRIVALTIME-2)           00168300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                   00168400
                   AIF   (K'&ZCGPR GT 2).ZG25Q                          00168500
                   AIF   ('&ZCGPR' EQ '0').ZG25Q                        00168600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00168700
                   AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME      00168800
.ZG25P             ANOP  ,                                              00168900
                   AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC           00169000
                   AIF   ('&ZCGPR' LT '2').ZG25Q                        00169100
                   AIF   ('&ZCGPR' LE '12').ZG25R                       00169200
.ZG25Q             ANOP  ,                                              00169300
&ZMS               SETC  '"ARRIVALTIME='        *KGPRA* MNOTE           00169400
&ZMS               SETC  '&ZMS.&ARRIVALTIME"'                           00169500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00169600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00169700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00169800
.ZG25R             ANOP  ,                                              00169900
.*------------------------------------------------------------------    00170000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170100
&XEXSTARTTIMEP     SETC  ''          INITIALIZE XVARIABLE               00170200
.*-------------------------------------------------------------------   00170300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170400
.ZG29              ANOP  ,                                              00170500
                   AIF   (K'&EXSTARTTIMEP(1) LE 0).ZG29A                00170600
&ZTLC              SETC 'NO'                                            00170700
                   AIF   ('&EXSTARTTIMEP(1)' NE '&ZTLC').ZG30           00170800
&XEXSTARTTIMEP     SETC  'NO'        SET KEYWORD                        00170900
                   AIF   (N'&EXSTARTTIMEP LE 1).ZG29A  CK NUM           00171000
&ZMS               SETC  '"EXSTARTTIMEP='       *KPOSA* MNOTE           00171100
&ZMS               SETC  '&ZMS.&EXSTARTTIMEP"'                          00171200
&ZMS               SETC  '&ZMS "EXSTARTTIMEP"'                          00171300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00171400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00171500
.ZG29A             ANOP  ,                                              00171600
.*------------------------------------------------------------------    00171700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171800
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00171900
.ZG29A0            AIF   (K'&EXSTARTTIME LE 0).ZG29A1  OK               00172000
&ZCVAL             SETC '&ZCVAL EXSTARTTIME'    INCORRECT KEY USED      00172100
.ZG29A1            AIF   (K'&ZCVAL LE 0).ZG29A2  OK                     00172200
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00172300
&ZMS               SETC  '"EXSTARTTIMEP'        *KMEIA* MNOTE           00172400
&ZMS               SETC  '&ZMS.=&EXSTARTTIMEP"'                         00172500
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00172600
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00172700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00172800
.ZG29A2            ANOP  ,                                              00172900
.*-------------------------------------------------------------------   00173000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173100
.ZG30              ANOP  ,                                              00173200
&ZTLC              SETC 'YES'                                           00173300
                   AIF   ('&EXSTARTTIMEP(1)' NE '&ZTLC').ZG34           00173400
&XEXSTARTTIMEP     SETC  'YES'       SET KEYWORD                        00173500
                   AIF   (N'&EXSTARTTIMEP LE 1).ZG30A  CK NUM           00173600
&ZMS               SETC  '"EXSTARTTIMEP='       *KPOSA* MNOTE           00173700
&ZMS               SETC  '&ZMS.&EXSTARTTIMEP"'                          00173800
&ZMS               SETC  '&ZMS "EXSTARTTIMEP"'                          00173900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00174000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00174100
.ZG30A             ANOP  ,                                              00174200
.*----------------------------------------------------------------***   00174300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00174400
                   AIF   (N'&EXSTARTTIME LE 1).ZG32A  CK NUM            00174500
&ZMS               SETC  '"EXSTARTTIME='        *KPOSA* MNOTE           00174600
&ZMS               SETC  '&ZMS.&EXSTARTTIME"'                           00174700
&ZMS               SETC  '&ZMS "EXSTARTTIME"'                           00174800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00174900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00175000
.ZG32A             ANOP  ,                                              00175100
.*-------------------------------------------------------------------   00175200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00175300
&ZXEXSTARTTIME     SETC  'INPUT'     SET IN/OUTPUT                      00175400
&XEXSTARTTIME      SETC  '&EXSTARTTIME(1)'      SET XVARIABLE           00175500
                   AIF   (N'&EXSTARTTIME GT 1).ZG32B  MULTI PARMS       00175600
&XEXSTARTTIME      SETC  '&EXSTARTTIME'         SET XVARIABLE           00175700
.ZG32B             AIF   (K'&EXSTARTTIME(1) GT 0).ZG32C                 00175800
&ZXEXSTARTTIME     SETC  ''          RESET IN/OUTPUT                    00175900
&ZMS               SETC  ' '         *KRQDA*                            00176000
&ZMS               SETC  '&ZMS "EXSTARTTIME" KEY AND ITS ARGUMENT'      00176100
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00176200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00176300
.ZG32C             ANOP  ,                                              00176400
.*-------------------------------------------------------------------   00176500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00176600
                   AIF   (K'&ZXEXSTARTTIME LE 0).ZG32R  NOT I/O         00176700
                   AIF   ('&XEXSTARTTIME'(1,1) NE '(').ZG32R            00176800
&ZCGPR             SETC  '&XEXSTARTTIME'(2,K'&XEXSTARTTIME-2)           00176900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                   00177000
                   AIF   (K'&ZCGPR GT 2).ZG32Q                          00177100
                   AIF   ('&ZCGPR' EQ '0').ZG32Q                        00177200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00177300
                   AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME      00177400
.ZG32P             ANOP  ,                                              00177500
                   AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC           00177600
                   AIF   ('&ZCGPR' LT '2').ZG32Q                        00177700
                   AIF   ('&ZCGPR' LE '12').ZG32R                       00177800
.ZG32Q             ANOP  ,                                              00177900
&ZMS               SETC  '"EXSTARTTIME='        *KGPRA* MNOTE           00178000
&ZMS               SETC  '&ZMS.&EXSTARTTIME"'                           00178100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00178200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00178300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00178400
.ZG32R             ANOP  ,                                              00178500
.*------------------------------------------------------------------    00178600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00178700
.ZG34              ANOP  ,                                              00178800
&ZXEXSTARTTIMEP    SETC  'INPUT'     SET IN/OUTPUT                      00178900
                   AIF   (K'&XEXSTARTTIMEP GT 0).ZG34E  VALID ARG       00179000
                   AIF   (T'&EXSTARTTIMEP EQ 'O').ZG34D  OMITTED        00179100
&ZASYSLNDX         SETA  0                                              00179200
.ZG34A             ANOP  ,           POSITIONAL MACRO KEY               00179300
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00179400
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG34C               00179500
&ZTLC              SETC 'EXSTARTTIMEP'                                  00179600
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG34A      00179700
.ZG34B             ANOP  ,                                              00179800
&ZXEXSTARTTIMEP    SETC  ''          RESET IN/OUTPUT                    00179900
&ZMS               SETC  'THE "EXSTARTTIMEP" KEY'  *KOPTA* MNOTE        00180000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00180100
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00180200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00180300
                   AGO   .ZG34E                                         00180400
.ZG34C             ANOP  ,                                              00180500
&ZXEXSTARTTIMEP    SETC  ''          RESET IN/OUTPUT                    00180600
&ZMS               SETC  '"EXSTARTTIMEP='       *KUKWA* MNOTE           00180700
&ZMS               SETC  '&ZMS.&EXSTARTTIMEP"'                          00180800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00180900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00181000
&ZMS               SETC  '&ZMS "NO"'            VALID KEYWORD           00181100
&ZMS               SETC  '&ZMS OR "YES".'       VALID KEYWORD           00181200
                   MNOTE 8,' &ZMS '                                     00181300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00181400
                   AGO   .ZG34E                                         00181500
.ZG34D             ANOP  ,                                              00181600
&XEXSTARTTIMEP     SETC  'NO'        SET DEFAULT KEYWORD                00181700
.ZG34E             ANOP  ,                                              00181800
.*------------------------------------------------------------------    00181900
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00182000
                   AIF   (K'&EXSTARTTIMEP(1) GT 0).ZG34F  PARM          00182100
&XEXSTARTTIMEP     SETC  ''          ENSURE NULL KEYWORD                00182200
&ZXEXSTARTTIMEP    SETC  ''          RESET IN/OUTPUT                    00182300
&ZMS               SETC  'THE'                                          00182400
&ZMS               SETC  '&ZMS "EXSTARTTIMEP" KEY AND ITS ARGUMENT'     00182500
&ZMS               SETC  '&ZMS ARE REQUIRED.'                           00182600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00182700
&ZMS               SETC  '&ZMS "NO"'            VALID KEYWORD           00182800
&ZMS               SETC  '&ZMS OR "YES".'       VALID KEYWORD           00182900
                   MNOTE 8,' &ZMS '                                     00183000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00183100
.ZG34F             ANOP  ,                                              00183200
.*----------------------------------------------------------------***   00183300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00183400
                   AIF   (N'&SERVCLS LE 1).ZG36A  CK NUM                00183500
&ZMS               SETC  '"SERVCLS='            *KPOSA* MNOTE           00183600
&ZMS               SETC  '&ZMS.&SERVCLS"'                               00183700
&ZMS               SETC  '&ZMS "SERVCLS"'                               00183800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00183900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00184000
.ZG36A             ANOP  ,                                              00184100
.*-------------------------------------------------------------------   00184200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00184300
&ZXSERVCLS         SETC  'INPUT'     SET IN/OUTPUT                      00184400
&XSERVCLS          SETC  '&SERVCLS(1)'          SET XVARIABLE           00184500
                   AIF   (N'&SERVCLS GT 1).ZG36B  MULTI PARMS           00184600
&XSERVCLS          SETC  '&SERVCLS'  SET XVARIABLE                      00184700
.ZG36B             AIF   (K'&SERVCLS(1) GT 0).ZG36C                     00184800
&ZXSERVCLS         SETC  ''          RESET IN/OUTPUT                    00184900
&ZMS               SETC  ' '         *KRQDA*                            00185000
&ZMS               SETC  '&ZMS "SERVCLS" KEY AND ITS ARGUMENT'          00185100
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00185200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00185300
.ZG36C             ANOP  ,                                              00185400
.*-------------------------------------------------------------------   00185500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00185600
                   AIF   (K'&ZXSERVCLS LE 0).ZG36R  NOT I/O             00185700
                   AIF   ('&XSERVCLS'(1,1) NE '(').ZG36R                00185800
&ZCGPR             SETC  '&XSERVCLS'(2,K'&XSERVCLS-2)                   00185900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG36P                   00186000
                   AIF   (K'&ZCGPR GT 2).ZG36Q                          00186100
                   AIF   ('&ZCGPR' EQ '0').ZG36Q                        00186200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00186300
                   AIF   (T'&ZCGPR NE 'N').ZG36Q  INVALID REG NAME      00186400
.ZG36P             ANOP  ,                                              00186500
                   AIF   (T'&ZCGPR NE 'N').ZG36R  NON NUMERIC           00186600
                   AIF   ('&ZCGPR' LT '2').ZG36Q                        00186700
                   AIF   ('&ZCGPR' LE '12').ZG36R                       00186800
.ZG36Q             ANOP  ,                                              00186900
&ZMS               SETC  '"SERVCLS='            *KGPRA* MNOTE           00187000
&ZMS               SETC  '&ZMS.&SERVCLS"'                               00187100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00187200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00187300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00187400
.ZG36R             ANOP  ,                                              00187500
.*------------------------------------------------------------------    00187600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00187700
.ZG38              ANOP  ,                                              00187800
&ZXMONTKNI         SETC  'INPUT'     SET IN/OUTPUT                      00187900
                   AIF   (K'&XMONTKNI GT 0).ZG38E  VALID ARG            00188000
                   AIF   (T'&MONTKNI EQ 'O').ZG38D  OMITTED             00188100
&ZASYSLNDX         SETA  0                                              00188200
.ZG38A             ANOP  ,           POSITIONAL MACRO KEY               00188300
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00188400
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG38C               00188500
&ZTLC              SETC 'MONTKNI'                                       00188600
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG38A      00188700
.ZG38B             ANOP  ,                                              00188800
&ZXMONTKNI         SETC  ''          RESET IN/OUTPUT                    00188900
&ZMS               SETC  'THE "MONTKNI" KEY'    *KOPTA* MNOTE           00189000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00189100
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00189200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00189300
                   AGO   .ZG38E                                         00189400
.ZG38C             ANOP  ,                                              00189500
&ZXMONTKNI         SETC  ''          RESET IN/OUTPUT                    00189600
&ZMS               SETC  '"MONTKNI='            *KUKWA* MNOTE           00189700
&ZMS               SETC  '&ZMS.&MONTKNI"'                               00189800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00189900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00190000
&ZMS               SETC  '&ZMS "YES"'           VALID KEYWORD           00190100
&ZMS               SETC  '&ZMS OR "NO".'        VALID KEYWORD           00190200
                   MNOTE 8,' &ZMS '                                     00190300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00190400
                   AGO   .ZG38E                                         00190500
.ZG38D             ANOP  ,                                              00190600
&XMONTKNI          SETC  'YES'       SET DEFAULT KEYWORD                00190700
.ZG38E             ANOP  ,                                              00190800
.*------------------------------------------------------------------    00190900
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00191000
                   AIF   (K'&MONTKNI(1) GT 0).ZG38F  PARM               00191100
&XMONTKNI          SETC  ''          ENSURE NULL KEYWORD                00191200
&ZXMONTKNI         SETC  ''          RESET IN/OUTPUT                    00191300
&ZMS               SETC  'THE'                                          00191400
&ZMS               SETC  '&ZMS "MONTKNI" KEY AND ITS ARGUMENT'          00191500
&ZMS               SETC  '&ZMS ARE REQUIRED.'                           00191600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00191700
&ZMS               SETC  '&ZMS "YES"'           VALID KEYWORD           00191800
&ZMS               SETC  '&ZMS OR "NO".'        VALID KEYWORD           00191900
                   MNOTE 8,' &ZMS '                                     00192000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00192100
.ZG38F             ANOP  ,                                              00192200
.*----------------------------------------------------------------***   00192300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00192400
                   AIF   (N'&CONNTKN LE 1).ZG40A  CK NUM                00192500
&ZMS               SETC  '"CONNTKN='            *KPOSA* MNOTE           00192600
&ZMS               SETC  '&ZMS.&CONNTKN"'                               00192700
&ZMS               SETC  '&ZMS "CONNTKN"'                               00192800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00192900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00193000
.ZG40A             ANOP  ,                                              00193100
.*-------------------------------------------------------------------   00193200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00193300
&ZXCONNTKN         SETC  'INPUT'     SET IN/OUTPUT                      00193400
&XCONNTKN          SETC  '&CONNTKN(1)'          SET XVARIABLE           00193500
                   AIF   (N'&CONNTKN GT 1).ZG40B  MULTI PARMS           00193600
&XCONNTKN          SETC  '&CONNTKN'  SET XVARIABLE                      00193700
.ZG40B             AIF   (K'&CONNTKN(1) GT 0).ZG40C                     00193800
&ZXCONNTKN         SETC  ''          RESET IN/OUTPUT                    00193900
&ZMS               SETC  ' '         *KRQDA*                            00194000
&ZMS               SETC  '&ZMS "CONNTKN" KEY AND ITS ARGUMENT'          00194100
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00194200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00194300
.ZG40C             ANOP  ,                                              00194400
.*-------------------------------------------------------------------   00194500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00194600
                   AIF   (K'&ZXCONNTKN LE 0).ZG40R  NOT I/O             00194700
                   AIF   ('&XCONNTKN'(1,1) NE '(').ZG40R                00194800
&ZCGPR             SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                   00194900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                   00195000
                   AIF   (K'&ZCGPR GT 2).ZG40Q                          00195100
                   AIF   ('&ZCGPR' EQ '0').ZG40Q                        00195200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00195300
                   AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME      00195400
.ZG40P             ANOP  ,                                              00195500
                   AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC           00195600
                   AIF   ('&ZCGPR' LT '2').ZG40Q                        00195700
                   AIF   ('&ZCGPR' LE '12').ZG40R                       00195800
.ZG40Q             ANOP  ,                                              00195900
&ZMS               SETC  '"CONNTKN='            *KGPRA* MNOTE           00196000
&ZMS               SETC  '&ZMS.&CONNTKN"'                               00196100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00196200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00196300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00196400
.ZG40R             ANOP  ,                                              00196500
.*----------------------------------------------------------------***   00196600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00196700
                   AIF   (N'&ENDTIME LE 1).ZG43A  CK NUM                00196800
&ZMS               SETC  '"ENDTIME='            *KPOSA* MNOTE           00196900
&ZMS               SETC  '&ZMS.&ENDTIME"'                               00197000
&ZMS               SETC  '&ZMS "ENDTIME"'                               00197100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00197200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00197300
.ZG43A             ANOP  ,                                              00197400
.*-------------------------------------------------------------------   00197500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00197600
&ZXENDTIME         SETC  'INPUT'     SET IN/OUTPUT                      00197700
&XENDTIME          SETC  'CURRENT'                                      00197800
                   AIF   (K'&ENDTIME(1) LE 0).ZG43B  PARM               00197900
&XENDTIME          SETC  '&ENDTIME(1)'          SET XVARIABLE           00198000
                   AIF   (N'&ENDTIME GT 1).ZG43B  MULTI PARMS           00198100
&XENDTIME          SETC  '&ENDTIME'  SET XVARIABLE                      00198200
.ZG43B             ANOP  ,                                              00198300
.*-------------------------------------------------------------------   00198400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00198500
                   AIF   (K'&ZXENDTIME LE 0).ZG43R  NOT I/O             00198600
                   AIF   ('&XENDTIME' EQ 'CURRENT').ZG43R               00198700
                   AIF   ('&XENDTIME'(1,1) NE '(').ZG43R                00198800
&ZCGPR             SETC  '&XENDTIME'(2,K'&XENDTIME-2)                   00198900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                   00199000
                   AIF   (K'&ZCGPR GT 2).ZG43Q                          00199100
                   AIF   ('&ZCGPR' EQ '0').ZG43Q                        00199200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00199300
                   AIF   (T'&ZCGPR NE 'N').ZG43Q  INVALID REG NAME      00199400
.ZG43P             ANOP  ,                                              00199500
                   AIF   (T'&ZCGPR NE 'N').ZG43R  NON NUMERIC           00199600
                   AIF   ('&ZCGPR' LT '2').ZG43Q                        00199700
                   AIF   ('&ZCGPR' LE '12').ZG43R                       00199800
.ZG43Q             ANOP  ,                                              00199900
&ZMS               SETC  '"ENDTIME='            *KGPRA* MNOTE           00200000
&ZMS               SETC  '&ZMS.&ENDTIME"'                               00200100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00200200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00200300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00200400
.ZG43R             ANOP  ,                                              00200500
.*------------------------------------------------------------------    00200600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00200700
&XSTATUS           SETC  ''          INITIALIZE XVARIABLE               00200800
.*-------------------------------------------------------------------   00200900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00201000
.ZG47              ANOP  ,                                              00201100
                   AIF   (K'&STATUS(1) LE 0).ZG47A                      00201200
&ZTLC              SETC 'NORMAL'                                        00201300
                   AIF   ('&STATUS(1)' NE '&ZTLC').ZG51                 00201400
&XSTATUS           SETC  'NORMAL'    SET KEYWORD                        00201500
                   AIF   (N'&STATUS LE 1).ZG47A  CK NUM                 00201600
&ZMS               SETC  '"STATUS='  *KPOSA* MNOTE                      00201700
&ZMS               SETC  '&ZMS.&STATUS"'                                00201800
&ZMS               SETC  '&ZMS "STATUS"'                                00201900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00202000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00202100
.ZG47A             ANOP  ,                                              00202200
.*------------------------------------------------------------------    00202300
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00202400
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00202500
.ZG47A0            AIF   (K'&OK_THRESHOLD LE 0).ZG47A1  OK              00202600
&ZCVAL             SETC '&ZCVAL OK_THRESHOLD'   INCORRECT KEY USED      00202700
.ZG47A1            AIF   (K'&ZCVAL LE 0).ZG47A2  OK                     00202800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00202900
&ZMS               SETC  '"STATUS'   *KMEIA* MNOTE                      00203000
&ZMS               SETC  '&ZMS.=&STATUS"'                               00203100
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00203200
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00203300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00203400
.ZG47A2            ANOP  ,                                              00203500
.*----------------------------------------------------------------***   00203600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00203700
                   AIF   (N'&WORK_COMPCD LE 1).ZG49A  CK NUM            00203800
&ZMS               SETC  '"WORK_COMPCD='        *KPOSA* MNOTE           00203900
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00204000
&ZMS               SETC  '&ZMS "WORK_COMPCD"'                           00204100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00204200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00204300
.ZG49A             ANOP  ,                                              00204400
.*-------------------------------------------------------------------   00204500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00204600
&ZXWORK_COMPCD     SETC  'INPUT'     SET IN/OUTPUT                      00204700
&XWORK_COMPCD      SETC  'NO_WORK_COMPCD'                               00204800
                   AIF   (K'&WORK_COMPCD(1) LE 0).ZG49B  PARM           00204900
&XWORK_COMPCD      SETC  '&WORK_COMPCD(1)'      SET XVARIABLE           00205000
                   AIF   (N'&WORK_COMPCD GT 1).ZG49B  MULTI PARMS       00205100
&XWORK_COMPCD      SETC  '&WORK_COMPCD'         SET XVARIABLE           00205200
.ZG49B             ANOP  ,                                              00205300
.*-------------------------------------------------------------------   00205400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00205500
                   AIF   (K'&ZXWORK_COMPCD LE 0).ZG49R  NOT I/O         00205600
                   AIF   ('&XWORK_COMPCD' EQ 'NO_WORK_COMPCD').ZG49R    00205700
                   AIF   ('&XWORK_COMPCD'(1,1) NE '(').ZG49R            00205800
&ZCGPR             SETC  '&XWORK_COMPCD'(2,K'&XWORK_COMPCD-2)           00205900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                   00206000
                   AIF   (K'&ZCGPR GT 2).ZG49Q                          00206100
                   AIF   ('&ZCGPR' EQ '0').ZG49Q                        00206200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00206300
                   AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME      00206400
.ZG49P             ANOP  ,                                              00206500
                   AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC           00206600
                   AIF   ('&ZCGPR' LT '2').ZG49Q                        00206700
                   AIF   ('&ZCGPR' LE '12').ZG49R                       00206800
.ZG49Q             ANOP  ,                                              00206900
&ZMS               SETC  '"WORK_COMPCD='        *KGPRA* MNOTE           00207000
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00207100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00207200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00207300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00207400
.ZG49R             ANOP  ,                                              00207500
.*-------------------------------------------------------------------   00207600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00207700
.ZG51              ANOP  ,                                              00207800
&ZTLC              SETC 'ABNORMAL'                                      00207900
                   AIF   ('&STATUS(1)' NE '&ZTLC').ZG55                 00208000
&XSTATUS           SETC  'ABNORMAL'  SET KEYWORD                        00208100
                   AIF   (N'&STATUS LE 1).ZG51A  CK NUM                 00208200
&ZMS               SETC  '"STATUS='  *KPOSA* MNOTE                      00208300
&ZMS               SETC  '&ZMS.&STATUS"'                                00208400
&ZMS               SETC  '&ZMS "STATUS"'                                00208500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00208600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00208700
.ZG51A             ANOP  ,                                              00208800
.*------------------------------------------------------------------    00208900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00209000
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00209100
.ZG51A0            AIF   (K'&OK_THRESHOLD LE 0).ZG51A1  OK              00209200
&ZCVAL             SETC '&ZCVAL OK_THRESHOLD'   INCORRECT KEY USED      00209300
.ZG51A1            AIF   (K'&ZCVAL LE 0).ZG51A2  OK                     00209400
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00209500
&ZMS               SETC  '"STATUS'   *KMEIA* MNOTE                      00209600
&ZMS               SETC  '&ZMS.=&STATUS"'                               00209700
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00209800
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00209900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00210000
.ZG51A2            ANOP  ,                                              00210100
.*----------------------------------------------------------------***   00210200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00210300
                   AIF   (N'&WORK_COMPCD LE 1).ZG53A  CK NUM            00210400
&ZMS               SETC  '"WORK_COMPCD='        *KPOSA* MNOTE           00210500
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00210600
&ZMS               SETC  '&ZMS "WORK_COMPCD"'                           00210700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00210800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00210900
.ZG53A             ANOP  ,                                              00211000
.*-------------------------------------------------------------------   00211100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00211200
&ZXWORK_COMPCD     SETC  'INPUT'     SET IN/OUTPUT                      00211300
&XWORK_COMPCD      SETC  'NO_WORK_COMPCD'                               00211400
                   AIF   (K'&WORK_COMPCD(1) LE 0).ZG53B  PARM           00211500
&XWORK_COMPCD      SETC  '&WORK_COMPCD(1)'      SET XVARIABLE           00211600
                   AIF   (N'&WORK_COMPCD GT 1).ZG53B  MULTI PARMS       00211700
&XWORK_COMPCD      SETC  '&WORK_COMPCD'         SET XVARIABLE           00211800
.ZG53B             ANOP  ,                                              00211900
.*-------------------------------------------------------------------   00212000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00212100
                   AIF   (K'&ZXWORK_COMPCD LE 0).ZG53R  NOT I/O         00212200
                   AIF   ('&XWORK_COMPCD' EQ 'NO_WORK_COMPCD').ZG53R    00212300
                   AIF   ('&XWORK_COMPCD'(1,1) NE '(').ZG53R            00212400
&ZCGPR             SETC  '&XWORK_COMPCD'(2,K'&XWORK_COMPCD-2)           00212500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG53P                   00212600
                   AIF   (K'&ZCGPR GT 2).ZG53Q                          00212700
                   AIF   ('&ZCGPR' EQ '0').ZG53Q                        00212800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00212900
                   AIF   (T'&ZCGPR NE 'N').ZG53Q  INVALID REG NAME      00213000
.ZG53P             ANOP  ,                                              00213100
                   AIF   (T'&ZCGPR NE 'N').ZG53R  NON NUMERIC           00213200
                   AIF   ('&ZCGPR' LT '2').ZG53Q                        00213300
                   AIF   ('&ZCGPR' LE '12').ZG53R                       00213400
.ZG53Q             ANOP  ,                                              00213500
&ZMS               SETC  '"WORK_COMPCD='        *KGPRA* MNOTE           00213600
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00213700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00213800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00213900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00214000
.ZG53R             ANOP  ,                                              00214100
.*-------------------------------------------------------------------   00214200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00214300
.ZG55              ANOP  ,                                              00214400
&ZTLC              SETC 'NORMAL_LE_VAL'                                 00214500
                   AIF   ('&STATUS(1)' NE '&ZTLC').ZG62                 00214600
&XSTATUS           SETC  'NORMAL_LE_VAL'        SET KEYWORD             00214700
                   AIF   (N'&STATUS LE 1).ZG55A  CK NUM                 00214800
&ZMS               SETC  '"STATUS='  *KPOSA* MNOTE                      00214900
&ZMS               SETC  '&ZMS.&STATUS"'                                00215000
&ZMS               SETC  '&ZMS "STATUS"'                                00215100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00215200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00215300
.ZG55A             ANOP  ,                                              00215400
.*----------------------------------------------------------------***   00215500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00215600
                   AIF   (N'&WORK_COMPCD LE 1).ZG57A  CK NUM            00215700
&ZMS               SETC  '"WORK_COMPCD='        *KPOSA* MNOTE           00215800
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00215900
&ZMS               SETC  '&ZMS "WORK_COMPCD"'                           00216000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00216100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00216200
.ZG57A             ANOP  ,                                              00216300
.*-------------------------------------------------------------------   00216400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00216500
&ZXWORK_COMPCD     SETC  'INPUT'     SET IN/OUTPUT                      00216600
&XWORK_COMPCD      SETC  '&WORK_COMPCD(1)'      SET XVARIABLE           00216700
                   AIF   (N'&WORK_COMPCD GT 1).ZG57B  MULTI PARMS       00216800
&XWORK_COMPCD      SETC  '&WORK_COMPCD'         SET XVARIABLE           00216900
.ZG57B             AIF   (K'&WORK_COMPCD(1) GT 0).ZG57C                 00217000
&ZXWORK_COMPCD     SETC  ''          RESET IN/OUTPUT                    00217100
&ZMS               SETC  'WHEN "NORMAL_LE_VAL" IS SPECIFIED'  *KRQDA*   00217200
&ZMS               SETC  '&ZMS , "WORK_COMPCD" KEY AND ITS ARGUMENT'    00217300
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00217400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00217500
.ZG57C             ANOP  ,                                              00217600
.*-------------------------------------------------------------------   00217700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00217800
                   AIF   (K'&ZXWORK_COMPCD LE 0).ZG57R  NOT I/O         00217900
                   AIF   ('&XWORK_COMPCD'(1,1) NE '(').ZG57R            00218000
&ZCGPR             SETC  '&XWORK_COMPCD'(2,K'&XWORK_COMPCD-2)           00218100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                   00218200
                   AIF   (K'&ZCGPR GT 2).ZG57Q                          00218300
                   AIF   ('&ZCGPR' EQ '0').ZG57Q                        00218400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00218500
                   AIF   (T'&ZCGPR NE 'N').ZG57Q  INVALID REG NAME      00218600
.ZG57P             ANOP  ,                                              00218700
                   AIF   (T'&ZCGPR NE 'N').ZG57R  NON NUMERIC           00218800
                   AIF   ('&ZCGPR' LT '2').ZG57Q                        00218900
                   AIF   ('&ZCGPR' LE '12').ZG57R                       00219000
.ZG57Q             ANOP  ,                                              00219100
&ZMS               SETC  '"WORK_COMPCD='        *KGPRA* MNOTE           00219200
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00219300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00219400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00219500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00219600
.ZG57R             ANOP  ,                                              00219700
.*----------------------------------------------------------------***   00219800
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00219900
                   AIF   (N'&OK_THRESHOLD LE 1).ZG60A  CK NUM           00220000
&ZMS               SETC  '"OK_THRESHOLD='       *KPOSA* MNOTE           00220100
&ZMS               SETC  '&ZMS.&OK_THRESHOLD"'                          00220200
&ZMS               SETC  '&ZMS "OK_THRESHOLD"'                          00220300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00220400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00220500
.ZG60A             ANOP  ,                                              00220600
.*-------------------------------------------------------------------   00220700
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00220800
&ZXOK_THRESHOLD    SETC  'INPUT'     SET IN/OUTPUT                      00220900
&XOK_THRESHOLD     SETC  '&OK_THRESHOLD(1)'     SET XVARIABLE           00221000
                   AIF   (N'&OK_THRESHOLD GT 1).ZG60B  MULTI PARMS      00221100
&XOK_THRESHOLD     SETC  '&OK_THRESHOLD'        SET XVARIABLE           00221200
.ZG60B             AIF   (K'&OK_THRESHOLD(1) GT 0).ZG60C                00221300
&ZXOK_THRESHOLD    SETC  ''          RESET IN/OUTPUT                    00221400
&ZMS               SETC  'WHEN "NORMAL_LE_VAL" IS SPECIFIED'  *KRQDA*   00221500
&ZMS               SETC  '&ZMS , "OK_THRESHOLD" KEY AND ITS ARGUMENT'   00221600
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00221700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00221800
.ZG60C             ANOP  ,                                              00221900
.*-------------------------------------------------------------------   00222000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00222100
                   AIF   (K'&ZXOK_THRESHOLD LE 0).ZG60R  NOT I/O        00222200
                   AIF   ('&XOK_THRESHOLD'(1,1) NE '(').ZG60R           00222300
&ZCGPR             SETC  '&XOK_THRESHOLD'(2,K'&XOK_THRESHOLD-2)         00222400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG60P                   00222500
                   AIF   (K'&ZCGPR GT 2).ZG60Q                          00222600
                   AIF   ('&ZCGPR' EQ '0').ZG60Q                        00222700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00222800
                   AIF   (T'&ZCGPR NE 'N').ZG60Q  INVALID REG NAME      00222900
.ZG60P             ANOP  ,                                              00223000
                   AIF   (T'&ZCGPR NE 'N').ZG60R  NON NUMERIC           00223100
                   AIF   ('&ZCGPR' LT '2').ZG60Q                        00223200
                   AIF   ('&ZCGPR' LE '12').ZG60R                       00223300
.ZG60Q             ANOP  ,                                              00223400
&ZMS               SETC  '"OK_THRESHOLD='       *KGPRA* MNOTE           00223500
&ZMS               SETC  '&ZMS.&OK_THRESHOLD"'                          00223600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00223700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00223800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00223900
.ZG60R             ANOP  ,                                              00224000
.*-------------------------------------------------------------------   00224100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00224200
.ZG62              ANOP  ,                                              00224300
&ZTLC              SETC 'NORMAL_GE_VAL'                                 00224400
                   AIF   ('&STATUS(1)' NE '&ZTLC').ZG69                 00224500
&XSTATUS           SETC  'NORMAL_GE_VAL'        SET KEYWORD             00224600
                   AIF   (N'&STATUS LE 1).ZG62A  CK NUM                 00224700
&ZMS               SETC  '"STATUS='  *KPOSA* MNOTE                      00224800
&ZMS               SETC  '&ZMS.&STATUS"'                                00224900
&ZMS               SETC  '&ZMS "STATUS"'                                00225000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00225100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00225200
.ZG62A             ANOP  ,                                              00225300
.*----------------------------------------------------------------***   00225400
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00225500
                   AIF   (N'&WORK_COMPCD LE 1).ZG64A  CK NUM            00225600
&ZMS               SETC  '"WORK_COMPCD='        *KPOSA* MNOTE           00225700
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00225800
&ZMS               SETC  '&ZMS "WORK_COMPCD"'                           00225900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00226000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00226100
.ZG64A             ANOP  ,                                              00226200
.*-------------------------------------------------------------------   00226300
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00226400
&ZXWORK_COMPCD     SETC  'INPUT'     SET IN/OUTPUT                      00226500
&XWORK_COMPCD      SETC  '&WORK_COMPCD(1)'      SET XVARIABLE           00226600
                   AIF   (N'&WORK_COMPCD GT 1).ZG64B  MULTI PARMS       00226700
&XWORK_COMPCD      SETC  '&WORK_COMPCD'         SET XVARIABLE           00226800
.ZG64B             AIF   (K'&WORK_COMPCD(1) GT 0).ZG64C                 00226900
&ZXWORK_COMPCD     SETC  ''          RESET IN/OUTPUT                    00227000
&ZMS               SETC  'WHEN "NORMAL_GE_VAL" IS SPECIFIED'  *KRQDA*   00227100
&ZMS               SETC  '&ZMS , "WORK_COMPCD" KEY AND ITS ARGUMENT'    00227200
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00227300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00227400
.ZG64C             ANOP  ,                                              00227500
.*-------------------------------------------------------------------   00227600
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00227700
                   AIF   (K'&ZXWORK_COMPCD LE 0).ZG64R  NOT I/O         00227800
                   AIF   ('&XWORK_COMPCD'(1,1) NE '(').ZG64R            00227900
&ZCGPR             SETC  '&XWORK_COMPCD'(2,K'&XWORK_COMPCD-2)           00228000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG64P                   00228100
                   AIF   (K'&ZCGPR GT 2).ZG64Q                          00228200
                   AIF   ('&ZCGPR' EQ '0').ZG64Q                        00228300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00228400
                   AIF   (T'&ZCGPR NE 'N').ZG64Q  INVALID REG NAME      00228500
.ZG64P             ANOP  ,                                              00228600
                   AIF   (T'&ZCGPR NE 'N').ZG64R  NON NUMERIC           00228700
                   AIF   ('&ZCGPR' LT '2').ZG64Q                        00228800
                   AIF   ('&ZCGPR' LE '12').ZG64R                       00228900
.ZG64Q             ANOP  ,                                              00229000
&ZMS               SETC  '"WORK_COMPCD='        *KGPRA* MNOTE           00229100
&ZMS               SETC  '&ZMS.&WORK_COMPCD"'                           00229200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00229300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00229400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00229500
.ZG64R             ANOP  ,                                              00229600
.*----------------------------------------------------------------***   00229700
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00229800
                   AIF   (N'&OK_THRESHOLD LE 1).ZG67A  CK NUM           00229900
&ZMS               SETC  '"OK_THRESHOLD='       *KPOSA* MNOTE           00230000
&ZMS               SETC  '&ZMS.&OK_THRESHOLD"'                          00230100
&ZMS               SETC  '&ZMS "OK_THRESHOLD"'                          00230200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00230300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00230400
.ZG67A             ANOP  ,                                              00230500
.*-------------------------------------------------------------------   00230600
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00230700
&ZXOK_THRESHOLD    SETC  'INPUT'     SET IN/OUTPUT                      00230800
&XOK_THRESHOLD     SETC  '&OK_THRESHOLD(1)'     SET XVARIABLE           00230900
                   AIF   (N'&OK_THRESHOLD GT 1).ZG67B  MULTI PARMS      00231000
&XOK_THRESHOLD     SETC  '&OK_THRESHOLD'        SET XVARIABLE           00231100
.ZG67B             AIF   (K'&OK_THRESHOLD(1) GT 0).ZG67C                00231200
&ZXOK_THRESHOLD    SETC  ''          RESET IN/OUTPUT                    00231300
&ZMS               SETC  'WHEN "NORMAL_GE_VAL" IS SPECIFIED'  *KRQDA*   00231400
&ZMS               SETC  '&ZMS , "OK_THRESHOLD" KEY AND ITS ARGUMENT'   00231500
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00231600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00231700
.ZG67C             ANOP  ,                                              00231800
.*-------------------------------------------------------------------   00231900
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00232000
                   AIF   (K'&ZXOK_THRESHOLD LE 0).ZG67R  NOT I/O        00232100
                   AIF   ('&XOK_THRESHOLD'(1,1) NE '(').ZG67R           00232200
&ZCGPR             SETC  '&XOK_THRESHOLD'(2,K'&XOK_THRESHOLD-2)         00232300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG67P                   00232400
                   AIF   (K'&ZCGPR GT 2).ZG67Q                          00232500
                   AIF   ('&ZCGPR' EQ '0').ZG67Q                        00232600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00232700
                   AIF   (T'&ZCGPR NE 'N').ZG67Q  INVALID REG NAME      00232800
.ZG67P             ANOP  ,                                              00232900
                   AIF   (T'&ZCGPR NE 'N').ZG67R  NON NUMERIC           00233000
                   AIF   ('&ZCGPR' LT '2').ZG67Q                        00233100
                   AIF   ('&ZCGPR' LE '12').ZG67R                       00233200
.ZG67Q             ANOP  ,                                              00233300
&ZMS               SETC  '"OK_THRESHOLD='       *KGPRA* MNOTE           00233400
&ZMS               SETC  '&ZMS.&OK_THRESHOLD"'                          00233500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00233600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00233700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00233800
.ZG67R             ANOP  ,                                              00233900
.*------------------------------------------------------------------    00234000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00234100
.ZG69              ANOP  ,                                              00234200
&ZXSTATUS          SETC  'INPUT'     SET IN/OUTPUT                      00234300
                   AIF   (K'&XSTATUS GT 0).ZG69E  VALID ARG             00234400
                   AIF   (T'&STATUS EQ 'O').ZG69D  OMITTED              00234500
&ZASYSLNDX         SETA  0                                              00234600
.ZG69A             ANOP  ,           POSITIONAL MACRO KEY               00234700
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00234800
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG69C               00234900
&ZTLC              SETC 'STATUS'                                        00235000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG69A      00235100
.ZG69B             ANOP  ,                                              00235200
&ZXSTATUS          SETC  ''          RESET IN/OUTPUT                    00235300
&ZMS               SETC  'THE "STATUS" KEY'     *KOPTA* MNOTE           00235400
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00235500
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00235600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00235700
                   AGO   .ZG69E                                         00235800
.ZG69C             ANOP  ,                                              00235900
&ZXSTATUS          SETC  ''          RESET IN/OUTPUT                    00236000
&ZMS               SETC  '"STATUS='  *KUKWA* MNOTE                      00236100
&ZMS               SETC  '&ZMS.&STATUS"'                                00236200
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00236300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00236400
&ZMS               SETC  '&ZMS "NORMAL",'       VALID KEYWORD           00236500
&ZMS               SETC  '&ZMS "ABNORMAL",'     VALID KEYWORD           00236600
&ZMS               SETC  '&ZMS "NORMAL_LE_VAL",'  VALID KEYWORD         00236700
&ZMS               SETC  '&ZMS OR "NORMAL_GE_VAL".'  VALID KEYWORD      00236800
                   MNOTE 8,' &ZMS '                                     00236900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00237000
                   AGO   .ZG69E                                         00237100
.ZG69D             ANOP  ,                                              00237200
&XSTATUS           SETC  'NORMAL'    SET DEFAULT KEYWORD                00237300
.ZG69E             ANOP  ,                                              00237400
.*----------------------------------------------------------------***   00237500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00237600
                   AIF   (N'&RETCODE LE 1).ZG71A  CK NUM                00237700
&ZMS               SETC  '"RETCODE='            *KPOSA* MNOTE           00237800
&ZMS               SETC  '&ZMS.&RETCODE"'                               00237900
&ZMS               SETC  '&ZMS "RETCODE"'                               00238000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00238100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00238200
.ZG71A             ANOP  ,                                              00238300
.*-------------------------------------------------------------------   00238400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00238500
                   AIF   (K'&RETCODE(1) LE 0).ZG71C  NO PARM            00238600
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00238700
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00238800
                   AIF   (N'&RETCODE GT 1).ZG71C                        00238900
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00239000
.ZG71C             ANOP  ,                                              00239100
.*-------------------------------------------------------------------   00239200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00239300
                   AIF   (K'&ZXRETCODE LE 0).ZG71R  NOT I/O             00239400
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG71R                00239500
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00239600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG71P                   00239700
                   AIF   (K'&ZCGPR GT 2).ZG71Q                          00239800
                   AIF   ('&ZCGPR' EQ '0').ZG71Q                        00239900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00240000
                   AIF   (T'&ZCGPR NE 'N').ZG71Q  INVALID REG NAME      00240100
.ZG71P             ANOP  ,                                              00240200
                   AIF   (T'&ZCGPR NE 'N').ZG71R  NON NUMERIC           00240300
                   AIF   ('&ZCGPR' LT '2').ZG71Q                        00240400
                   AIF   ('&ZCGPR' LE '12').ZG71R                       00240500
.ZG71Q             ANOP  ,                                              00240600
&ZMS               SETC  '"RETCODE='            *KGPRA* MNOTE           00240700
&ZMS               SETC  '&ZMS.&RETCODE"'                               00240800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00240900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00241000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00241100
.ZG71R             ANOP  ,                                              00241200
.*----------------------------------------------------------------***   00241300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00241400
                   AIF   (N'&RSNCODE LE 1).ZG74A  CK NUM                00241500
&ZMS               SETC  '"RSNCODE='            *KPOSA* MNOTE           00241600
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00241700
&ZMS               SETC  '&ZMS "RSNCODE"'                               00241800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00241900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00242000
.ZG74A             ANOP  ,                                              00242100
.*-------------------------------------------------------------------   00242200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00242300
                   AIF   (K'&RSNCODE(1) LE 0).ZG74C  NO PARM            00242400
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00242500
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00242600
                   AIF   (N'&RSNCODE GT 1).ZG74C                        00242700
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00242800
.ZG74C             ANOP  ,                                              00242900
.*-------------------------------------------------------------------   00243000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00243100
                   AIF   (K'&ZXRSNCODE LE 0).ZG74R  NOT I/O             00243200
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG74R                00243300
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00243400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG74P                   00243500
                   AIF   (K'&ZCGPR GT 2).ZG74Q                          00243600
                   AIF   ('&ZCGPR' EQ '0').ZG74Q                        00243700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00243800
                   AIF   (T'&ZCGPR NE 'N').ZG74Q  INVALID REG NAME      00243900
.ZG74P             ANOP  ,                                              00244000
                   AIF   (T'&ZCGPR NE 'N').ZG74R  NON NUMERIC           00244100
                   AIF   ('&ZCGPR' LT '2').ZG74Q                        00244200
                   AIF   ('&ZCGPR' LE '12').ZG74R                       00244300
.ZG74Q             ANOP  ,                                              00244400
&ZMS               SETC  '"RSNCODE='            *KGPRA* MNOTE           00244500
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00244600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00244700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00244800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00244900
.ZG74R             ANOP  ,                                              00245000
.******************************************************************     00245100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00245200
.******************************************************************     00245300
                   ACTR  10000                                          00245400
.*----------------------------------------------------------------***   00245500
.***AH.P02 EXTRA POSITIONALS                                            00245600
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00245700
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00245800
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00245900
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00246000
.ZGLISTX1          ANOP  ,                                              00246100
&ZCVAL             SETC  ''          ERROR FIELD                        00246200
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00246300
.ZGLIST2           ANOP  ,                                              00246400
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00246500
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00246600
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00246700
                   AGO   .ZGLIST2                                       00246800
.*                                                                      00246900
.ZGLIST3           ANOP  ,                                              00247000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00247100
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE       00247200
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00247300
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00247400
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00247500
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00247600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00247700
.ZGLISTX           ANOP  ,                                              00247800
&ZASYSLNDX         SETA  0                                              00247900
.*-------------------------------------------------------------------   00248000
.***AG.MF04 MF=(SLE)                                                    00248100
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00248200
.*******************************************************************    00248300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00248400
.*******************************************************************    00248500
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00248600
.*******************************************************************    00248700
.***AE.01  START OF IWMRPT MACRO CODE                                   00248800
.*******************************************************************    00248900
                   LCLC  &M0M0001                 NAME                  00249000
&M0M0001           SETC  '&XLABEL'                SET NAME              00249100
                   AIF   (K'&XLABEL NE 0).XLAB2                         00249200
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00249300
.*                                                                      00249400
.XLAB2             ANOP  ,                                              00249500
                   AIF   ('&XMF' EQ 'L').XLAB3                          00249600
&M0M0001 DS    0H                             IWMRPT-0                  00249700
.XLAB3             ANOP  ,                                              00249800
.*******************************************************************    00249900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00250000
.*******************************************************************    00250100
              PUSH  PRINT                                               00250200
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00250300
                   PRINT OFF         ++ PR01                            00250400
                   AGO   .ZPRNTXX                                       00250500
.ZPRINTX           PRINT ON                                             00250600
.ZPRNTXX           ANOP  ,                                              00250700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00250800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00250900
.********************************************************************   00251000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00251100
.********************************************************************   00251200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00251300
                      LCLA  &ZOPN1         INVOCATION INDEX             00251400
                      LCLC  &ZOPL(4095)    LABEL                        00251500
                      LCLC  &ZOPO(4095)    OPERATION                    00251600
                      LCLC  &ZOPV(4095)    VALUE                        00251700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00251800
.*                                                                      00251900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00252000
.******************************************************************     00252100
.***AL.L10 IWMRPT FMT=LIST MF=S|L PARAMETERS                            00252200
.******************************************************************     00252300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00252400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00252500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00252600
&XMFATTR              SETC  '0D'                                        00252700
.*                                                                      00252800
&ZOPN                 SETA  &ZOPN+1                                     00252900
&ZOPL(&ZOPN)          SETC  ' '                                         00253000
&ZOPO(&ZOPN)          SETC  'B'                                         00253100
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00253200
&ZOPD(&ZOPN)          SETC  '++ IWMRPT ARG PARMS'                       00253300
.*                                                                      00253400
&ZOPN                 SETA  &ZOPN+1                                     00253500
&ZOPL(&ZOPN)          SETC  ' '                                         00253600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00253700
&ZOPV(&ZOPN)          SETC  '1'                                         00253800
&ZOPD(&ZOPN)          SETC  ' '                                         00253900
.*                                                                      00254000
.ZLMFSL2              ANOP  ,                                           00254100
.*-------------------------------------------------------------------   00254200
.***AM.L00  IWMRPT FMT=LIST name                                        00254300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00254400
&ZOPN                 SETA &ZOPN+1                                      00254500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00254600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00254700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00254800
&ZOPD(&ZOPN)          SETC '++ IWMRPT NAME'                             00254900
.ZLMFSL2M             ANOP  ,                                           00255000
.*-------------------------------------------------------------------   00255100
.***AM.L01  IWMRPT FMT=LIST PARAMETERS                                  00255200
&ZOPN                 SETA &ZOPN+1                                      00255300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00255400
&ZOPO(&ZOPN)          SETC 'DS'                                         00255500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00255600
&ZOPD(&ZOPN)          SETC '++ IWMRPT PARM LIST'                        00255700
.*-------------------------------------------------------------------   00255800
.***AM.L02 XVERSION XL1                                                 00255900
&ZOPN                 SETA &ZOPN+1                                      00256000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00256100
&ZOPO(&ZOPN)          SETC 'DS'                                         00256200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00256300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00256400
.*-------------------------------------------------------------------   00256500
.***AM.L03 XREPORT_OPTIONS BL.16                                        00256600
&ZOPN                 SETA &ZOPN+1                                      00256700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREPORT_OPTIONS'                  00256800
&ZOPO(&ZOPN)          SETC 'DS'                                         00256900
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00257000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00257100
.*                                                                      00257200
&ZOPN                 SETA  &ZOPN+1                                     00257300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTRAXFRPT_YES'                   00257400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00257500
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00257600
&ZOPD(&ZOPN)          SETC  '++ XTRAXFRPT.'                             00257700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00257800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00257900
.*                                                                      00258000
&ZOPN                 SETA  &ZOPN+1                                     00258100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMONTKNI_YES'                    00258200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00258300
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00258400
&ZOPD(&ZOPN)          SETC  '++ XMONTKNI.'                              00258500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00258600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00258700
.*                                                                      00258800
&ZOPN                 SETA  &ZOPN+1                                     00258900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XEXSTARTTIMEP_YES'               00259000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00259100
&ZOPV(&ZOPN)          SETC  'B''0010000000000000'''                     00259200
&ZOPD(&ZOPN)          SETC  '++ XEXSTARTTIMEP.'                         00259300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00259400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00259500
.*                                                                      00259600
&ZOPN                 SETA  &ZOPN+1                                     00259700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATUS_NORMAL'                  00259800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00259900
&ZOPV(&ZOPN)          SETC  'B''0001000000000000'''                     00260000
&ZOPD(&ZOPN)          SETC  '++ XSTATUS.'                               00260100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NORMAL'                       00260200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00260300
.*                                                                      00260400
&ZOPN                 SETA  &ZOPN+1                                     00260500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATUS_ABNORMAL'                00260600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00260700
&ZOPV(&ZOPN)          SETC  'B''0000100000000000'''                     00260800
&ZOPD(&ZOPN)          SETC  '++ XSTATUS.'                               00260900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ABNORMAL'                     00261000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00261100
.*                                                                      00261200
&ZOPN                 SETA  &ZOPN+1                                     00261300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATUS_NORMAL_LE_VAL'           00261400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00261500
&ZOPV(&ZOPN)          SETC  'B''0000010000000000'''                     00261600
&ZOPD(&ZOPN)          SETC  '++ XSTATUS.'                               00261700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NORMAL_LE_VAL'                00261800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00261900
.*                                                                      00262000
&ZOPN                 SETA  &ZOPN+1                                     00262100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATUS_NORMAL_GE_VAL'           00262200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00262300
&ZOPV(&ZOPN)          SETC  'B''0000001000000000'''                     00262400
&ZOPD(&ZOPN)          SETC  '++ XSTATUS.'                               00262500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NORMAL_GE_VAL'                00262600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00262700
.*                                                                      00262800
&ZOPN                 SETA  &ZOPN+1                                     00262900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_WORK_COMPCD'             00263000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00263100
&ZOPV(&ZOPN)          SETC  'B''0000000100000000'''                     00263200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00263300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).WORK_COMPCD'                  00263400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00263500
.*                                                                      00263600
&ZOPN                 SETA  &ZOPN+1                                     00263700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_OK_THRESHOLD'            00263800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00263900
&ZOPV(&ZOPN)          SETC  'B''0000000010000000'''                     00264000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00264100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).OK_THRESHOLD'                 00264200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00264300
.*-------------------------------------------------------------------   00264400
.***AM.L09  XPSWKEY BL.8                                                00264500
&ZOPN                 SETA &ZOPN+1                                      00264600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPSWKEY'                          00264700
&ZOPO(&ZOPN)          SETC 'DS'                                         00264800
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00264900
&ZOPD(&ZOPN)          SETC '++ &ZXPSWKEY  XPSWKEY'                      00265000
.*-------------------------------------------------------------------   00265100
.***AM.L09 ADDR XSYSEVPL A                                              00265200
&ZOPN                 SETA &ZOPN+1                                      00265300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSEVPL_ADDR'                    00265400
&ZOPO(&ZOPN)          SETC 'DS'                                         00265500
&ZOPV(&ZOPN)          SETC 'A'                                          00265600
&ZOPD(&ZOPN)          SETC '++ &ZXSYSEVPL ADDR XSYSEVPL'                00265700
.*-------------------------------------------------------------------   00265800
.***AM.L09  XMONTKN BL.32                                               00265900
&ZOPN                 SETA &ZOPN+1                                      00266000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00266100
&ZOPO(&ZOPN)          SETC 'DS'                                         00266200
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00266300
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN  XMONTKN'                      00266400
.*-------------------------------------------------------------------   00266500
.***AM.L09  XSERVCLS BL.32                                              00266600
&ZOPN                 SETA &ZOPN+1                                      00266700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVCLS'                         00266800
&ZOPO(&ZOPN)          SETC 'DS'                                         00266900
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00267000
&ZOPD(&ZOPN)          SETC '++ &ZXSERVCLS  XSERVCLS'                    00267100
.*-------------------------------------------------------------------   00267200
.***AM.L09  XCONNTKN BL.32                                              00267300
&ZOPN                 SETA &ZOPN+1                                      00267400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00267500
&ZOPO(&ZOPN)          SETC 'DS'                                         00267600
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00267700
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN  XCONNTKN'                    00267800
.*-------------------------------------------------------------------   00267900
.***AM.L09  XRSVD0020 CL4                                               00268000
&ZOPN                 SETA &ZOPN+1                                      00268100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVD0020'                        00268200
&ZOPO(&ZOPN)          SETC 'DS'                                         00268300
&ZOPV(&ZOPN)          SETC 'CL4'                                        00268400
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSVD0020'                     00268500
.*-------------------------------------------------------------------   00268600
.***AM.L09  XARRIVALTIME BL.64                                          00268700
&ZOPN                 SETA &ZOPN+1                                      00268800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XARRIVALTIME'                     00268900
&ZOPO(&ZOPN)          SETC 'DS'                                         00269000
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00269100
&ZOPD(&ZOPN)          SETC '++ &ZXARRIVALTIME  XARRIVALTIME'            00269200
.*-------------------------------------------------------------------   00269300
.***AM.L09  XEXSTARTTIME BL.64                                          00269400
&ZOPN                 SETA &ZOPN+1                                      00269500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEXSTARTTIME'                     00269600
&ZOPO(&ZOPN)          SETC 'DS'                                         00269700
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00269800
&ZOPD(&ZOPN)          SETC '++ &ZXEXSTARTTIME  XEXSTARTTIME'            00269900
.*-------------------------------------------------------------------   00270000
.***AM.L09  XENDTIME BL.64                                              00270100
&ZOPN                 SETA &ZOPN+1                                      00270200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XENDTIME'                         00270300
&ZOPO(&ZOPN)          SETC 'DS'                                         00270400
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00270500
&ZOPD(&ZOPN)          SETC '++ &ZXENDTIME  XENDTIME'                    00270600
.*-------------------------------------------------------------------   00270700
.***AM.L09  XWORK_COMPCD F                                              00270800
&ZOPN                 SETA &ZOPN+1                                      00270900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWORK_COMPCD'                     00271000
&ZOPO(&ZOPN)          SETC 'DS'                                         00271100
&ZOPV(&ZOPN)          SETC 'F'                                          00271200
&ZOPD(&ZOPN)          SETC '++ &ZXWORK_COMPCD  XWORK_COMPCD'            00271300
.*-------------------------------------------------------------------   00271400
.***AM.L09  XOK_THRESHOLD F                                             00271500
&ZOPN                 SETA &ZOPN+1                                      00271600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOK_THRESHOLD'                    00271700
&ZOPO(&ZOPN)          SETC 'DS'                                         00271800
&ZOPV(&ZOPN)          SETC 'F'                                          00271900
&ZOPD(&ZOPN)          SETC '++ &ZXOK_THRESHOLD  XOK_THRESHOLD'          00272000
.*-------------------------------------------------------------------   00272100
.***AM.L10 END OF IWMRPT LIST PARAMETERS                                00272200
&ZOPN                 SETA &ZOPN+1                                      00272300
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00272400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00272500
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00272600
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00272700
.*                                                                      00272800
&ZOPN                 SETA &ZOPN+1                                      00272900
&ZOPL(&ZOPN)          SETC ' '                                          00273000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00273100
&ZOPV(&ZOPN)          SETC '1'                                          00273200
&ZOPD(&ZOPN)          SETC ' '                                          00273300
.*-------------------------------------------------------------------   00273400
.***AL.L12 IWMRPT FMT=LIST MF=S|L PARAMETERS                            00273500
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00273600
.*                                                                      00273700
&ZOPN                 SETA  &ZOPN+1                                     00273800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00273900
&ZOPO(&ZOPN)          SETC  'DC'                                        00274000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00274100
&ZOPD(&ZOPN)          SETC  '++ IWMRPT ARG PARMS'                       00274200
.*                                                                      00274300
.ZLMFSLX              ANOP  ,                                           00274400
.*-------------------------------------------------------------------   00274500
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00274600
&ZPLLEN               SETA 56                                           00274700
.*                                                                      00274800
.******************************************************************     00274900
.***AI.L01 IWMRPT FMT=LIST FILL IN PARAMETER AREA                       00275000
.******************************************************************     00275100
                      ACTR  10000                                       00275200
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00275300
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00275400
&ZCVAL                SETC  'LAE'          XAX MODE                     00275500
.ZIMFXA               ANOP ,                                            00275600
.*                                                                      00275700
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00275800
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00275900
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00276000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00276100
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00276200
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00276300
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00276400
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00276500
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00276600
&ZOPN                 SETA  &ZOPN+1                                     00276700
&ZOPL(&ZOPN)          SETC  ' '                                         00276800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00276900
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00277000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00277100
                      AGO   .ZIMFNX                                     00277200
.*                                                                      00277300
.ZIMFN2               ANOP ,                                            00277400
&ZOPN                 SETA  &ZOPN+1                                     00277500
&ZOPL(&ZOPN)          SETC  ' '                                         00277600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00277700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00277800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00277900
.ZIMFNX               ANOP ,                                            00278000
.********************************************************************   00278100
.***AI.L02 IWMRPT FMT=LIST INITIALIZE PARAMETER AREA                    00278200
.********************************************************************   00278300
.***AI.L03 MF=(SLE)                                                     00278400
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00278500
.*                                                                      00278600
&ZOPN                 SETA  &ZOPN+1                                     00278700
&ZOPL(&ZOPN)          SETC  ' '                                         00278800
&ZOPO(&ZOPN)          SETC  'XC'                                        00278900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00279000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00279100
.ZIMFLX               ANOP  ,                                           00279200
.*-------------------------------------------------------------------   00279300
.***AI.L05 XREPORT_OPTIONS BL2                                          00279400
&ZW                   SETC  ''                                          00279500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00279600
.*-------------------------------------------------------------------   00279700
.***AI.L08 XREPORT_OPTIONS "YES"                                        00279800
.***      BL2'1XXXXXXXXXXXXXXX'                                         00279900
         AIF   ('&XTRAXFRPT' NE 'YES').ZI3A                             00280000
&ZW                   SETC  '&ZW.1'                                     00280100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00280200
                      AGO   .ZI3C                                       00280300
.*                                                                      00280400
.ZI3A                 ANOP  ,                                           00280500
&ZW                   SETC  '&ZW.0'                                     00280600
.ZI3C                 ANOP  ,                                           00280700
.*-------------------------------------------------------------------   00280800
.***AI.L08 XREPORT_OPTIONS "YES"                                        00280900
.***      BL2'X1XXXXXXXXXXXXXX'                                         00281000
         AIF   ('&XMONTKNI' NE 'YES').ZI4A                              00281100
&ZW                   SETC  '&ZW.1'                                     00281200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00281300
                      AGO   .ZI4C                                       00281400
.*                                                                      00281500
.ZI4A                 ANOP  ,                                           00281600
&ZW                   SETC  '&ZW.0'                                     00281700
.ZI4C                 ANOP  ,                                           00281800
.*-------------------------------------------------------------------   00281900
.***AI.L08 XREPORT_OPTIONS "YES"                                        00282000
.***      BL2'XX1XXXXXXXXXXXXX'                                         00282100
         AIF   ('&XEXSTARTTIMEP' NE 'YES').ZI5A                         00282200
&ZW                   SETC  '&ZW.1'                                     00282300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00282400
                      AGO   .ZI5C                                       00282500
.*                                                                      00282600
.ZI5A                 ANOP  ,                                           00282700
&ZW                   SETC  '&ZW.0'                                     00282800
.ZI5C                 ANOP  ,                                           00282900
.*-------------------------------------------------------------------   00283000
.***AI.L08 XREPORT_OPTIONS "NORMAL"                                     00283100
.***      BL2'XXX1XXXXXXXXXXXX'                                         00283200
         AIF   ('&XSTATUS' NE 'NORMAL').ZI6A                            00283300
&ZW                   SETC  '&ZW.1'                                     00283400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00283500
                      AGO   .ZI6C                                       00283600
.*                                                                      00283700
.ZI6A                 ANOP  ,                                           00283800
&ZW                   SETC  '&ZW.0'                                     00283900
.ZI6C                 ANOP  ,                                           00284000
.*-------------------------------------------------------------------   00284100
.***AI.L08 XREPORT_OPTIONS "ABNORMAL"                                   00284200
.***      BL2'XXXX1XXXXXXXXXXX'                                         00284300
         AIF   ('&XSTATUS' NE 'ABNORMAL').ZI7A                          00284400
&ZW                   SETC  '&ZW.1'                                     00284500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00284600
                      AGO   .ZI7C                                       00284700
.*                                                                      00284800
.ZI7A                 ANOP  ,                                           00284900
&ZW                   SETC  '&ZW.0'                                     00285000
.ZI7C                 ANOP  ,                                           00285100
.*-------------------------------------------------------------------   00285200
.***AI.L08 XREPORT_OPTIONS "NORMAL_LE_VAL"                              00285300
.***      BL2'XXXXX1XXXXXXXXXX'                                         00285400
         AIF   ('&XSTATUS' NE 'NORMAL_LE_VAL').ZI8A                     00285500
&ZW                   SETC  '&ZW.1'                                     00285600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00285700
                      AGO   .ZI8C                                       00285800
.*                                                                      00285900
.ZI8A                 ANOP  ,                                           00286000
&ZW                   SETC  '&ZW.0'                                     00286100
.ZI8C                 ANOP  ,                                           00286200
.*-------------------------------------------------------------------   00286300
.***AI.L08 XREPORT_OPTIONS "NORMAL_GE_VAL"                              00286400
.***      BL2'XXXXXX1XXXXXXXXX'                                         00286500
         AIF   ('&XSTATUS' NE 'NORMAL_GE_VAL').ZI9A                     00286600
&ZW                   SETC  '&ZW.1'                                     00286700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00286800
                      AGO   .ZI9C                                       00286900
.*                                                                      00287000
.ZI9A                 ANOP  ,                                           00287100
&ZW                   SETC  '&ZW.0'                                     00287200
.ZI9C                 ANOP  ,                                           00287300
.*-------------------------------------------------------------------   00287400
.***AI.L08 XREPORT_OPTIONS "WORK_COMPCD"                                00287500
.***      BL2'XXXXXXX1XXXXXXXX'                                         00287600
         AIF   ('&WORK_COMPCD' EQ '').ZI10A                             00287700
         AIF   ('&WORK_COMPCD' EQ 'NO_WORK_COMPCD').ZI10A               00287800
&ZW                   SETC  '&ZW.1'                                     00287900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00288000
                      AGO   .ZI10C                                      00288100
.*                                                                      00288200
.ZI10A                ANOP  ,                                           00288300
&ZW                   SETC  '&ZW.0'                                     00288400
.ZI10C                ANOP  ,                                           00288500
.*-------------------------------------------------------------------   00288600
.***AI.L08 XREPORT_OPTIONS "OK_THRESHOLD"                               00288700
.***      BL2'XXXXXXXX1XXXXXXX'                                         00288800
         AIF   ('&OK_THRESHOLD' EQ '').ZI11A                            00288900
&ZW                   SETC  '&ZW.10000000'                              00289000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00289100
                      AGO   .ZI11C                                      00289200
.*                                                                      00289300
.ZI11A                ANOP  ,                                           00289400
&ZW                   SETC  '&ZW.00000000'                              00289500
.ZI11C                ANOP  ,                                           00289600
.*-------------------------------------------------------------------   00289700
.***AI.L10 XREPORT_OPTIONS BL2                                          00289800
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    00289900
&ZOPN                 SETA  &ZOPN+1                                     00290000
&ZOPL(&ZOPN)          SETC  ' '                                         00290100
&ZOPO(&ZOPN)          SETC  'OC'                                        00290200
&ZOPV(&ZOPN)          SETC  '1(2,1),=BL2''&ZW'''                        00290300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00290400
.ZI11E                ANOP  ,                                           00290500
.*-------------------------------------------------------------------   00290600
.***AI.L25  XPSWKEY XL1                                                 00290700
                      AIF   ('&ZXPSWKEY' EQ '').ZI12E                   00290800
                      AIF   ('&ZXPSWKEY' EQ 'OUTPUT').ZI12E             00290900
&ZCGPR                SETC  '&XPSWKEY'                                  00291000
.*                                                                      00291100
                      AIF   ('&XPSWKEY'(1,1) NE '(').ZI12B              00291200
&ZCGPR   SETC  '0('.'&XPSWKEY'(2,K'&XPSWKEY-2).')'                      00291300
                      AGO   .ZI12D                                      00291400
.ZI12B                ANOP  ,                                           00291500
.*                                                                      00291600
&ZC                   SETC  '&XPSWKEY'(1,1)                             00291700
                      AIF   (T'&ZC NE 'N').ZI12D                        00291800
&ZC                   SETC  '&XPSWKEY'                                  00291900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00292000
&ZCGPR                SETC  '=BL1''&XPSWKEY'''                          00292100
.*                                                                      00292200
.ZI12D                ANOP  ,                                           00292300
.*                                                                      00292400
&ZOPN                 SETA  &ZOPN+1                                     00292500
&ZOPL(&ZOPN)          SETC  ' '                                         00292600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00292700
&ZOPV(&ZOPN)          SETC  '3(1,1),&ZCGPR'                             00292800
&ZOPD(&ZOPN)          SETC  '++ &ZXPSWKEY XPSWKEY'                      00292900
.*                                                                      00293000
.ZI12E                ANOP  ,                                           00293100
.*-------------------------------------------------------------------   00293200
.***AI.L19 ADDR XSYSEVPL A                                              00293300
                      AIF   ('&ZXSYSEVPL' EQ '').ZI13H                  00293400
&ZCLNG                SETC  '&XSYSEVPL'                                 00293500
&ZCGPR                SETC  '14'                                        00293600
         AIF   ('&XSYSEVPL'(1,1) EQ '(').ZI13F  IN GPR                  00293700
.*                                                                      00293800
&ZOPN                 SETA  &ZOPN+1                                     00293900
&ZOPL(&ZOPN)          SETC  ' '                                         00294000
&ZOPO(&ZOPN)          SETC  'LA'                                        00294100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00294200
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSEVPL XSYSEVPL'                    00294300
.*                                                                      00294400
                      AGO   .ZI13G                                      00294500
.*                                                                      00294600
.ZI13F                ANOP  ,                                           00294700
&ZCGPR   SETC  '&XSYSEVPL'(2,K'&XSYSEVPL-2)                             00294800
.*                                                                      00294900
.ZI13G                ANOP  ,                                           00295000
.*                                                                      00295100
&ZOPN                 SETA  &ZOPN+1                                     00295200
&ZOPL(&ZOPN)          SETC  ' '                                         00295300
&ZOPO(&ZOPN)          SETC  'ST'                                        00295400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              00295500
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSEVPL XSYSEVPL'                    00295600
.*                                                                      00295700
.ZI13H                ANOP  ,                                           00295800
.*-------------------------------------------------------------------   00295900
.***AI.L25  XMONTKN XL4                                                 00296000
                      AIF   ('&ZXMONTKN' EQ '').ZI14E                   00296100
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI14E             00296200
&ZCGPR                SETC  '&XMONTKN'                                  00296300
.*                                                                      00296400
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI14B              00296500
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00296600
                      AGO   .ZI14D                                      00296700
.ZI14B                ANOP  ,                                           00296800
.*                                                                      00296900
&ZC                   SETC  '&XMONTKN'(1,1)                             00297000
                      AIF   (T'&ZC NE 'N').ZI14D                        00297100
&ZC                   SETC  '&XMONTKN'                                  00297200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI14D               00297300
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00297400
.*                                                                      00297500
.ZI14D                ANOP  ,                                           00297600
.*                                                                      00297700
&ZOPN                 SETA  &ZOPN+1                                     00297800
&ZOPL(&ZOPN)          SETC  ' '                                         00297900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00298000
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00298100
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00298200
.*                                                                      00298300
.ZI14E                ANOP  ,                                           00298400
.*-------------------------------------------------------------------   00298500
.***AI.L25  XSERVCLS XL4                                                00298600
                      AIF   ('&ZXSERVCLS' EQ '').ZI15E                  00298700
                      AIF   ('&ZXSERVCLS' EQ 'OUTPUT').ZI15E            00298800
&ZCGPR                SETC  '&XSERVCLS'                                 00298900
.*                                                                      00299000
                      AIF   ('&XSERVCLS'(1,1) NE '(').ZI15B             00299100
&ZCGPR   SETC  '0('.'&XSERVCLS'(2,K'&XSERVCLS-2).')'                    00299200
                      AGO   .ZI15D                                      00299300
.ZI15B                ANOP  ,                                           00299400
.*                                                                      00299500
&ZC                   SETC  '&XSERVCLS'(1,1)                            00299600
                      AIF   (T'&ZC NE 'N').ZI15D                        00299700
&ZC                   SETC  '&XSERVCLS'                                 00299800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               00299900
&ZCGPR                SETC  '=BL4''&XSERVCLS'''                         00300000
.*                                                                      00300100
.ZI15D                ANOP  ,                                           00300200
.*                                                                      00300300
&ZOPN                 SETA  &ZOPN+1                                     00300400
&ZOPL(&ZOPN)          SETC  ' '                                         00300500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00300600
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00300700
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVCLS XSERVCLS'                    00300800
.*                                                                      00300900
.ZI15E                ANOP  ,                                           00301000
.*-------------------------------------------------------------------   00301100
.***AI.L25  XCONNTKN XL4                                                00301200
                      AIF   ('&ZXCONNTKN' EQ '').ZI16E                  00301300
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI16E            00301400
&ZCGPR                SETC  '&XCONNTKN'                                 00301500
.*                                                                      00301600
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI16B             00301700
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00301800
                      AGO   .ZI16D                                      00301900
.ZI16B                ANOP  ,                                           00302000
.*                                                                      00302100
&ZC                   SETC  '&XCONNTKN'(1,1)                            00302200
                      AIF   (T'&ZC NE 'N').ZI16D                        00302300
&ZC                   SETC  '&XCONNTKN'                                 00302400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               00302500
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00302600
.*                                                                      00302700
.ZI16D                ANOP  ,                                           00302800
.*                                                                      00302900
&ZOPN                 SETA  &ZOPN+1                                     00303000
&ZOPL(&ZOPN)          SETC  ' '                                         00303100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00303200
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00303300
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00303400
.*                                                                      00303500
.ZI16E                ANOP  ,                                           00303600
.*-------------------------------------------------------------------   00303700
.***AI.L25  XARRIVALTIME XL8                                            00303800
                      AIF   ('&ZXARRIVALTIME' EQ '').ZI18E              00303900
                      AIF   ('&ZXARRIVALTIME' EQ 'OUTPUT').ZI18E        00304000
&ZCGPR                SETC  '&XARRIVALTIME'                             00304100
.*                                                                      00304200
                      AIF   ('&XARRIVALTIME'(1,1) NE '(').ZI18B         00304300
&ZCGPR   SETC  '0('.'&XARRIVALTIME'(2,K'&XARRIVALTIME-2).')'            00304400
                      AGO   .ZI18D                                      00304500
.ZI18B                ANOP  ,                                           00304600
.*                                                                      00304700
&ZC                   SETC  '&XARRIVALTIME'(1,1)                        00304800
                      AIF   (T'&ZC NE 'N').ZI18D                        00304900
&ZC                   SETC  '&XARRIVALTIME'                             00305000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               00305100
&ZCGPR                SETC  '=BL8''&XARRIVALTIME'''                     00305200
.*                                                                      00305300
.ZI18D                ANOP  ,                                           00305400
.*                                                                      00305500
&ZOPN                 SETA  &ZOPN+1                                     00305600
&ZOPL(&ZOPN)          SETC  ' '                                         00305700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00305800
&ZOPV(&ZOPN)          SETC  '24(8,1),&ZCGPR'                            00305900
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            00306000
.*                                                                      00306100
.ZI18E                ANOP  ,                                           00306200
.*-------------------------------------------------------------------   00306300
.***AI.L25  XEXSTARTTIME XL8                                            00306400
                      AIF   ('&ZXEXSTARTTIME' EQ '').ZI19E              00306500
                      AIF   ('&ZXEXSTARTTIME' EQ 'OUTPUT').ZI19E        00306600
&ZCGPR                SETC  '&XEXSTARTTIME'                             00306700
.*                                                                      00306800
                      AIF   ('&XEXSTARTTIME'(1,1) NE '(').ZI19B         00306900
&ZCGPR   SETC  '0('.'&XEXSTARTTIME'(2,K'&XEXSTARTTIME-2).')'            00307000
                      AGO   .ZI19D                                      00307100
.ZI19B                ANOP  ,                                           00307200
.*                                                                      00307300
&ZC                   SETC  '&XEXSTARTTIME'(1,1)                        00307400
                      AIF   (T'&ZC NE 'N').ZI19D                        00307500
&ZC                   SETC  '&XEXSTARTTIME'                             00307600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00307700
&ZCGPR                SETC  '=BL8''&XEXSTARTTIME'''                     00307800
.*                                                                      00307900
.ZI19D                ANOP  ,                                           00308000
.*                                                                      00308100
&ZOPN                 SETA  &ZOPN+1                                     00308200
&ZOPL(&ZOPN)          SETC  ' '                                         00308300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00308400
&ZOPV(&ZOPN)          SETC  '32(8,1),&ZCGPR'                            00308500
&ZOPD(&ZOPN)          SETC  '++ &ZXEXSTARTTIME XEXSTARTTIME'            00308600
.*                                                                      00308700
.ZI19E                ANOP  ,                                           00308800
.*-------------------------------------------------------------------   00308900
.***AI.L18  XENDTIME XL8                                                00309000
         AIF   ('&XENDTIME' NE 'CURRENT').ZI20                          00309100
&ZXENDTIME            SETC  ''             RESET INPUT/OUTPUT           00309200
.ZI20                 ANOP  ,                                           00309300
.*-------------------------------------------------------------------   00309400
.***AI.L25  XENDTIME XL8                                                00309500
                      AIF   ('&ZXENDTIME' EQ '').ZI20E                  00309600
                      AIF   ('&ZXENDTIME' EQ 'OUTPUT').ZI20E            00309700
&ZCGPR                SETC  '&XENDTIME'                                 00309800
.*                                                                      00309900
                      AIF   ('&XENDTIME'(1,1) NE '(').ZI20B             00310000
&ZCGPR   SETC  '0('.'&XENDTIME'(2,K'&XENDTIME-2).')'                    00310100
                      AGO   .ZI20D                                      00310200
.ZI20B                ANOP  ,                                           00310300
.*                                                                      00310400
&ZC                   SETC  '&XENDTIME'(1,1)                            00310500
                      AIF   (T'&ZC NE 'N').ZI20D                        00310600
&ZC                   SETC  '&XENDTIME'                                 00310700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI20D               00310800
&ZCGPR                SETC  '=BL8''&XENDTIME'''                         00310900
.*                                                                      00311000
.ZI20D                ANOP  ,                                           00311100
.*                                                                      00311200
&ZOPN                 SETA  &ZOPN+1                                     00311300
&ZOPL(&ZOPN)          SETC  ' '                                         00311400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00311500
&ZOPV(&ZOPN)          SETC  '40(8,1),&ZCGPR'                            00311600
&ZOPD(&ZOPN)          SETC  '++ &ZXENDTIME XENDTIME'                    00311700
.*                                                                      00311800
.ZI20E                ANOP  ,                                           00311900
.*-------------------------------------------------------------------   00312000
.***AI.L18  XWORK_COMPCD F                                              00312100
         AIF   ('&XWORK_COMPCD' NE 'NO_WORK_COMPCD').ZI21               00312200
&ZXWORK_COMPCD        SETC  ''             RESET INPUT/OUTPUT           00312300
.ZI21                 ANOP  ,                                           00312400
.*-------------------------------------------------------------------   00312500
.***AI.L25  XWORK_COMPCD F                                              00312600
                      AIF   ('&ZXWORK_COMPCD' EQ '').ZI21E              00312700
                      AIF   ('&ZXWORK_COMPCD' EQ 'OUTPUT').ZI21E        00312800
&ZCGPR                SETC  '&XWORK_COMPCD'                             00312900
.*                                                                      00313000
                      AIF   ('&XWORK_COMPCD'(1,1) NE '(').ZI21B         00313100
&ZCGPR   SETC  '0('.'&XWORK_COMPCD'(2,K'&XWORK_COMPCD-2).')'            00313200
                      AGO   .ZI21D                                      00313300
.ZI21B                ANOP  ,                                           00313400
.*                                                                      00313500
&ZC                   SETC  '&XWORK_COMPCD'(1,1)                        00313600
                      AIF   (T'&ZC NE 'N').ZI21D                        00313700
&ZC                   SETC  '&XWORK_COMPCD'                             00313800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI21D               00313900
&ZCGPR                SETC  '=FL4''&XWORK_COMPCD'''                     00314000
.*                                                                      00314100
.ZI21D                ANOP  ,                                           00314200
.*                                                                      00314300
&ZOPN                 SETA  &ZOPN+1                                     00314400
&ZOPL(&ZOPN)          SETC  ' '                                         00314500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00314600
&ZOPV(&ZOPN)          SETC  '48(4,1),&ZCGPR'                            00314700
&ZOPD(&ZOPN)          SETC  '++ &ZXWORK_COMPCD XWORK_COMPCD'            00314800
.*                                                                      00314900
.ZI21E                ANOP  ,                                           00315000
.*-------------------------------------------------------------------   00315100
.***AI.L25  XOK_THRESHOLD F                                             00315200
                      AIF   ('&ZXOK_THRESHOLD' EQ '').ZI22E             00315300
                      AIF   ('&ZXOK_THRESHOLD' EQ 'OUTPUT').ZI22E       00315400
&ZCGPR                SETC  '&XOK_THRESHOLD'                            00315500
.*                                                                      00315600
                      AIF   ('&XOK_THRESHOLD'(1,1) NE '(').ZI22B        00315700
&ZCGPR   SETC  '0('.'&XOK_THRESHOLD'(2,K'&XOK_THRESHOLD-2).')'          00315800
                      AGO   .ZI22D                                      00315900
.ZI22B                ANOP  ,                                           00316000
.*                                                                      00316100
&ZC                   SETC  '&XOK_THRESHOLD'(1,1)                       00316200
                      AIF   (T'&ZC NE 'N').ZI22D                        00316300
&ZC                   SETC  '&XOK_THRESHOLD'                            00316400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI22D               00316500
&ZCGPR                SETC  '=FL4''&XOK_THRESHOLD'''                    00316600
.*                                                                      00316700
.ZI22D                ANOP  ,                                           00316800
.*                                                                      00316900
&ZOPN                 SETA  &ZOPN+1                                     00317000
&ZOPL(&ZOPN)          SETC  ' '                                         00317100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00317200
&ZOPV(&ZOPN)          SETC  '52(4,1),&ZCGPR'                            00317300
&ZOPD(&ZOPN)          SETC  '++ &ZXOK_THRESHOLD XOK_THRESHOLD'          00317400
.*                                                                      00317500
.ZI22E                ANOP  ,                                           00317600
.*-------------------------------------------------------------------   00317700
&ZOPN1                SETA &ZOPN                                        00317800
.*******************************************************************    00317900
.***  PROCESS IWMRPT OUTPUT PARAMETERS                                  00318000
.*******************************************************************    00318100
                      ACTR  10000                                       00318200
.*******************************************************************    00318300
.***AO.X02  RETURN CODE PROCESSING                                      00318400
.*******************************************************************    00318500
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00318600
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00318700
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00318800
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00318900
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00319000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00319100
&ZOPN                 SETA  &ZOPN+1                                     00319200
&ZOPL(&ZOPN)          SETC  ' '                                         00319300
&ZOPO(&ZOPN)          SETC  'ST'                                        00319400
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00319500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00319600
                      AGO   .ZMRETX                                     00319700
.*                                                                      00319800
.ZMRET2               ANOP  ,                                           00319900
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00320000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00320100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00320200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00320300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00320400
&ZOPN                 SETA  &ZOPN+1                                     00320500
&ZOPL(&ZOPN)          SETC  ' '                                         00320600
&ZOPO(&ZOPN)          SETC  'LR'                                        00320700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00320800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00320900
.ZMRETX               ANOP  ,                                           00321000
.*******************************************************************    00321100
.***AO.X03  REASON CODE PROCESSING                                      00321200
.*******************************************************************    00321300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00321400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00321500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00321600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00321700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00321800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00321900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00322000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00322100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00322200
&ZOPN                 SETA  &ZOPN+1                                     00322300
&ZOPL(&ZOPN)          SETC  ' '                                         00322400
&ZOPO(&ZOPN)          SETC  'ST'                                        00322500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00322600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00322700
                      AGO   .ZMRSNX                                     00322800
.*                                                                      00322900
.ZMRSN2               ANOP  ,                                           00323000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00323100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00323200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00323300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00323400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00323500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00323600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00323700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00323800
&ZOPN                 SETA  &ZOPN+1                                     00323900
&ZOPL(&ZOPN)          SETC  ' '                                         00324000
&ZOPO(&ZOPN)          SETC  'LR'                                        00324100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00324200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00324300
.ZMRSNX               ANOP  ,                                           00324400
.*******************************************************************    00324500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00324600
.*******************************************************************    00324700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00324800
.*******************************************************************    00324900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00325000
.*******************************************************************    00325100
                      ACTR  10000                                       00325200
.*                                                                      00325300
                      LCLA  &ZLC           COLUMN POSITION              00325400
                      LCLA  &ZOPX          LIST TABLE INDEX             00325500
                      LCLC  &ZLL           LABEL                        00325600
                      LCLC  &ZLOP          OPERATION                    00325700
                      LCLC  &ZLV           VALUE                        00325800
                      LCLC  &ZLD           DESCRIPTION                  00325900
.*                                                                      00326000
&ZOPX                 SETA  1                                           00326100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00326200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00326300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00326400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00326500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00326600
                      AIF   (K'&ZLD LE 0).ZL5                           00326700
&ZLC                  SETA  35             COMMENT COLUMN               00326800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00326900
&ZLC                  SETA  33             COMMMENT COLUMN              00327000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00327100
&ZLV                  SETC  '&ZLV'.' '                                  00327200
                      AGO   .ZL3                                        00327300
.*                                                                      00327400
.ZL4                  ANOP  ,                                           00327500
&ZLV                  SETC  '&ZLV'.' '                                  00327600
.ZL5                  ANOP  ,                                           00327700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00327800
.*                                                                      00327900
&ZLL     &ZLOP &ZLV                                                     00328000
.*                                                                      00328100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00328200
                      AGO   .ZL2           CONTINUE LOOPING             00328300
.*                                                                      00328400
.ZLX                  ANOP  ,                                           00328500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00328600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00328700
         L     14,16(0,0)              GET CVT ADDRESS                  00328800
         TM    CVTOSLV1-CVT(14),X'40'      TEST FOR WLM PRESENCE        00328900
         BO    WLM&SYSNDX              BRANCH WHEN WLM IS PRESENT       00329000
         AIF   ('&SYSEVPL' NE '').RPTSYSEV   BRANCH IF SYSEVENT NEEDED  00329100
         LA    0,IWMRSNCODENOWLM       SET REASON CODE = NO WLM         00329200
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00329300
         B     END&SYSNDX              BRANCH TO END LABEL              00329400
         AGO    .RPTWLM                                                 00329500
.RPTSYSEV ANOP                                                          00329600
         L     1,4(1,0)                ESTABLISH THE SYSEVENT PL ADDR   00329700
         SYSEVENT TRAXFRPT,ENTRY=BRANCH                                 00329800
         LTR   15,15                                                    00329900
         BZ    END&SYSNDX              BRANCH TO END WHEN SUCCESSFUL    00330000
         LA    0,IWMRETCODEENVERROR                                     00330100
         CR    15,0                                                     00330200
         BE    R12&SYSNDX              BRANCH WHEN SYSEVENT RC=12       00330300
         DS    0H                      SYSEVENT RC = 8 (NO WORK ELT)    00330400
         LR    15,0                    SET RC = IWMRETCODEENVERROR      00330500
         LA    0,IWMRSNCODESYSEVENTNOWORKELT  SET REASONCODE            00330600
         B     END&SYSNDX              BRANCH TO END LABEL              00330700
R12&SYSNDX DS    0H                    SYSEVENT RC=12 (REPORTING SUSP)  00330800
         LA    0,IWMRSNCODEREPORTINGSUSP      SET REASONCODE            00330900
         B     END&SYSNDX              BRANCH TO END LABEL              00331000
.RPTWLM   ANOP                         CODE GENERATION FOR WLM PRESENT  00331100
*                                                                       00331200
WLM&SYSNDX DS    0H                    BRANCH LABEL FOR WLM PRESENT     00331300
         AIF   ('&XENDTIME' NE 'CURRENT').RPTENDTIME                    00331400
         STCK  40(1)                   SAVE TOD IN P.L.                 00331500
         BC    8,IWMRPT_TIMEOK&SYSNDX  BRANCH WHEN STCK CC=0            00331600
         LA    0,IWMRSNCODENOENDTIME   SET REASONCODE                   00331700
         LA    15,IWMRETCODEENVERROR   SET RC = IWMRETCODEENVERROR      00331800
         B     IWMRPT_FINIS&SYSNDX     BRANCH TO THE END                00331900
IWMRPT_TIMEOK&SYSNDX DS   0H           BRANCH LABEL FOR STCK CC=0       00332000
.RPTENDTIME ANOP                       BRANCH LABEL WHEN ENDTIME GIVEN  00332100
         AIF   ('&PSWKEYP' NE 'CURRENT').RPTNKEY BRANCH IF NOT PSWKEY   00332200
         LR    0,2                     SAVE GPR 2                       00332300
         SLR   2,2                                                      00332400
         IPK                           SET BITS 24-27 OF GPR2 TO PSWKEY 00332500
         SRL   2,4(0)                  SHIFT PSWKEY TO BITS 28-31       00332600
         STC   2,3(1,0)                SAVE THE SHIFTED PSWKEY IN P.L.  00332700
         LR    2,0                     RESTORE GPR 2 TO ORIGINAL VALUE  00332800
.RPTNKEY ANOP                                                           00332900
         L     14,X'8C'(14,0)                                           00333000
         L     14,X'C4'(14,0)                                           00333100
         L     15,X'100'(14,0)         GET REPORT RTN FOR MONTKN INPUT  00333200
         BASR  14,15                   CALL REPORT ROUTINE              00333300
         AIF   ('&XENDTIME' NE 'CURRENT').RPTEND                        00333400
IWMRPT_FINIS&SYSNDX DS   0H            BRANCH LABEL FOR STCK NON-0 CC   00333500
.RPTEND      ANOP                                                       00333600
END&SYSNDX DS    0H                    END LABEL                        00333700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00333800
.ZLINKX               ANOP  ,                                           00333900
.*******************************************************************    00334000
.***AP.X01  FORMAT GENERATED CODE                                       00334100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00334200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00334300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00334400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00334500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00334600
                      AIF   (K'&ZLD LE 0).ZL51                          00334700
&ZLC                  SETA  35             COMMENT COLUMN               00334800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00334900
&ZLC                  SETA  33             COMMENT COLUMN               00335000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00335100
&ZLV                  SETC  '&ZLV'.' '                                  00335200
                      AGO   .ZL31                                       00335300
.*                                                                      00335400
.ZL41                 ANOP  ,                                           00335500
&ZLV                  SETC  '&ZLV'.' '                                  00335600
.ZL51                 ANOP  ,                                           00335700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00335800
.*                                                                      00335900
&ZLL     &ZLOP &ZLV                                                     00336000
.*                                                                      00336100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00336200
                      AGO   .ZL21          CONTINUE LOOPING             00336300
.*                                                                      00336400
.ZLX1                 ANOP  ,                                           00336500
.*******************************************************************    00336600
.***AP.X02  END OF IWMRPT MACRO                                         00336700
&ZIWMRPT              SETC  'YES'          SET IWMRPT USED              00336800
         POP   PRINT                                                    00336900
*                                            IWMRPT-0                   00337000
         SPACE 1                                                        00337100
.ZLX2                 ANOP  ,                                           00337200
         MEND                                                           00337300
**********************************************************************/ 00337400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00337500
*%IWMRPT: MACRO KEYS(TRAXFRPT,SYSEVPL,PSWKEYP,PSWKEY,MONTKNI,MONTKN,    00337600
*                 ARRIVALTIME,EXSTARTTIMEP,EXSTARTTIME,SERVCLS,         00337700
*                 CONNTKN,ENDTIME,STATUS,WORK_COMPCD,OK_THRESHOLD,      00337800
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00337900
*  ANS('?'||MACLABEL||' '||'IWMRPTP '||MACLIST||                        00338000
*         ' '||MACKEYS||';') COL(MACLMAR);                              00338100
*%END IWMRPT;                                                           00338200
