*/**** START OF SPECIFICATIONS **************************************** 00001000
*                                                                     * 00001700
*                                                                     * 00002400
*01* MACRO NAME:  MCSOPER                               -97/02/03-<1> * 00002600
*                                                                     * 00002800
*                                                                     * 00003000
*01* DESCRIPTIVE NAME:  MCSOPER MACRO SERVICE                         * 00003200
*                                                                     * 00003800
*01* PROPRIETARY STATEMENT:                                           * 00004500
*                                                                     * 00008000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00012000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00012200
*     5695-047 (C) COPYRIGHT IBM CORP. 1992                           * 00012400
*                                                                     * 00013000
* STATUS= HBB4430                                                     * 00013200
*                                                                     * 00014200
*                                                                     * 00014600
*                                                                     * 00015000
*01* FUNCTION:                                                        * 00016000
*                                                                     * 00017000
*      This macro will build the parameter list and perform the non   * 00018000
*      space switch PC to the MCSOPER services.                       * 00019000
*                                                                     * 00019200
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00019400
*                                                                     * 00019600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00019800
*                                                                     * 00020000
*01* ENVIRONMENT:                                                     * 00021000
*                                                                     * 00022000
*                                                                     * 00023000
*      Dispatchable unit mode: Task mode.                             * 00024000
*                                                                     * 00025000
*      Minimum authorization: Supervisor state.  Any PSW key.         * 00026000
*                                                                     * 00027000
*      AMODE:            31-bit.                                      * 00028000
*                                                                     * 00029000
*      ASC mode:         Primary.                                     * 00030000
*                                                                     * 00031000
*      Serialization:    Enabled.                                     * 00032000
*                                                                     * 00033000
*      Restrictions:     None.                                        * 00034000
*                                                                     * 00035000
*                                                                     * 00036000
*                                                                     * 00036500
*01* SYNTAX:                                                          * 00037000
*                                                                     * 00038000
*[xlabel]  MCSOPER    REQUEST=ACTIVATE                               * 00039000
*                   |     ,NAME=xname                                 * 00039900
*                   |     ,CONSID=xconsid                             * 00040800
*                   |    [,MIGID=xmigid]                              * 00041700
*                   |    [,MIGIDREL=NO|AUTO]                        * 00042600
*                   |     ,TERMNAME=xtermname                         * 00043500
*                   |     ,MCSCSA=xmcscsa                             * 00044400
*                   |         ,MCSCSAA=xmcscsaa                       * 00045300
*                   |    [,OPERPARM=xoperparm|0]                    * 00046200
*                   |   [,MSGDLVRY=FIFO                              * 00047100
*                   |   |     ,MSGECB=xmsgecb                         * 00048000
*                   |   |    [,QLIMIT=xqlimit|2147483647]           * 00048900
*                   |   |    [,ALERTECB=xalertecb|0                 * 00049800
*                   |   |        [,ALERTPCT=xalertpct|100]]         * 00050700
*                   |   |    [,QRESUME=xqresume|0]]                 * 00051600
*                   |   [,MSGDLVRY=SEARCH                            * 00052500
*                   |   |     ,MSGECB=xmsgecb                         * 00053400
*                   |   |    [,QLIMIT=xqlimit|2147483647]           * 00054300
*                   |   |    [,ALERTECB=xalertecb|0                 * 00055200
*                   |   |        [,ALERTPCT=xalertpct|100]]         * 00056100
*                   |   |    [,QRESUME=xqresume|0]]                 * 00057000
*                   |   [,MSGDLVRY=NONE]                             * 00057900
*                    ,REQUEST=DEACTIVATE                             * 00059000
*                   |     ,CONSID=xconsid                             * 00060000
*                   |    [,ABTERM=NO|YES]                           * 00061000
*                    ,REQUEST=RELEASE                                * 00062000
*                         ,MIGID=xmigid                               * 00063000
*                    [,RTNCODE=xrtncode]                              * 00064000
*                    [,RSNCODE=xrsncode]                              * 00065000
*                   [,MF=S]                                          * 00066000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 00067000
*                   [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]             * 00068000
*                   [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]             * 00069000
*                                                                     * 00070000
*                                                                     * 00071000
*      Where:                                                         * 00072000
*                                                                     * 00073000
*                                                                     * 00074000
*      [xlabel]                                                       * 00075000
*          is an optional symbol, starting in column 1, that is the   * 00075800
*          name on the MCSOPER macro invocation.  The name must       * 00076600
*          conform to the rules for an ordinary assembler language    * 00077400
*          symbol.                                                    * 00078200
*          DEFAULT: No name.                                          * 00079000
*                                                                     * 00080000
*                                                                     * 00081000
*                                                                     * 00082000
*                                                                     * 00082500
*      REQUEST=ACTIVATE|DEACTIVATE|RELEASE                          * 00083000
*          is a required keyword input that specifies which MCSOPER   * 00084000
*          function is to be performed.                               * 00085000
*                                                                     * 00086000
*                                                                     * 00087000
*          REQUEST=ACTIVATE                                           * 00088000
*              Activate the extended MCS console.                     * 00089000
*                                                                     * 00090000
*                                                                     * 00091000
*              NAME=xname                                             * 00092000
*                  is the name (RS-type), or address in register      * 00093000
*                  (2)-(12), of a required 8 character input that     * 00094000
*                  specifies the name of the console being activated. * 00095000
*                                                                     * 00096000
*                                                                     * 00097000
*                                                                     * 00098000
*                                                                     * 00098500
*              CONSID=xconsid                                         * 00099000
*                  is the name (RS-type), or address in register      * 00100000
*                  (2)-(12), of a required fullword output that       * 00101000
*                  specifies the 4 byte console ID which identifies   * 00102000
*                  the user.                                          * 00103000
*                                                                     * 00103100
*                                                                     * 00103200
*                                                                     * 00103300
*                                                                     * 00103400
*              [MIGID=xmigid]                                         * 00103500
*                  is the name (RS-type), or address in register      * 00103600
*                  (2)-(12), of an optional byte output that          * 00103700
*                  specifies the migration ID to be assigned.         * 00103800
*                                                                     * 00103900
*                                                                     * 00104000
*                                                                     * 00104100
*                                                                     * 00104200
*              [MIGIDREL=NO|AUTO]                                   * 00104300
*                  is an optional keyword input that specifies if the * 00104400
*                  system will automatically release the migration    * 00104500
*                  id.  This keyword is ignored if a migration ID is  * 00104600
*                  not requested.                                     * 00104700
*                  DEFAULT: NO                                        * 00104800
*                                                                     * 00104900
*                                                                     * 00105000
*                  MIGIDREL=NO                                        * 00105100
*                      keyword that specifies the migration id is     * 00105200
*                      never automatically released.                  * 00105300
*                                                                     * 00105400
*                  MIGIDREL=AUTO                                      * 00105500
*                      keyword that specifies the migration id is     * 00105600
*                      automatically released when a requested or     * 00105700
*                      system-initiated deactivation occurs.          * 00105800
*                                                                     * 00105900
*                                                                     * 00106000
*                                                                     * 00106100
*                                                                     * 00106200
*                                                                     * 00106300
*                                                                     * 00106400
*              TERMNAME=xtermname                                     * 00107000
*                  is the name (RS-type), or address in register      * 00108000
*                  (2)-(12), of a required 8 character input that     * 00109000
*                  specifies the terminal name, VTAM LU name, or      * 00110000
*                  other identification of the source for the         * 00111000
*                  activate request.  This name is logged when the    * 00112000
*                  activate occurs and has no other use.              * 00113000
*                                                                     * 00114000
*                                                                     * 00115000
*                                                                     * 00116000
*                                                                     * 00116500
*              MCSCSA=xmcscsa                                         * 00117000
*                  is the name (RS-type), or address in register      * 00118000
*                  (2)-(12), of a required 4 byte output that will    * 00119000
*                  contain the address of the MCS Console Status      * 00120000
*                  Area.                                              * 00121000
*                                                                     * 00122000
*                                                                     * 00123000
*                  MCSCSAA=xmcscsaa                                   * 00124000
*                      is the name (RS-type), or address in register  * 00125000
*                      (2)-(12), of a required fullword output that   * 00126000
*                      specifies the ALET for the MCS Console Status  * 00127000
*                      Area.                                          * 00128000
*                                                                     * 00129000
*                                                                     * 00130000
*                                                                     * 00131000
*                                                                     * 00132000
*                                                                     * 00132300
*                                                                     * 00132600
*              [OPERPARM=xoperparm|0]                               * 00133000
*                  is an optional input.  It is the name (RS-type),   * 00134000
*                  or address in register (2)-(12), that specifies    * 00135000
*                  the MCSOPPRM area containing information on        * 00136000
*                  operator parameters.  The MCSOPPRM area is mapped  * 00137000
*                  by the macro IEZVG111.                             * 00138000
*                  DEFAULT: 0.                                        * 00139000
*                                                                     * 00140000
*                                                                     * 00141000
*                                                                     * 00142000
*                                                                     * 00142500
*              [MSGDLVRY=FIFO|SEARCH|NONE]                          * 00143000
*                  is an optional keyword input that specifies        * 00144000
*                  whether the application will receive messages FIFO * 00145000
*                  (first in, first out), specify search criteria for * 00146000
*                  delivery, or not receive messages at all.          * 00147000
*                  DEFAULT: FIFO                                      * 00148000
*                                                                     * 00149000
*                                                                     * 00150000
*                  [MSGDLVRY=FIFO                                     * 00151000
*                      FIFO delivery only.                            * 00152000
*                                                                     * 00153000
*                                                                     * 00154000
*                      MSGECB=xmsgecb                                 * 00155000
*                          is a required input.  It is the name       * 00156000
*                          (RS-type), or address in register          * 00157000
*                          (2)-(12), that specifies the ECB which is  * 00158000
*                          posted when a message is queued to this    * 00159000
*                          console.                                   * 00160000
*                                                                     * 00161000
*                                                                     * 00162000
*                                                                     * 00163000
*                                                                     * 00163500
*                      [QLIMIT=xqlimit|2147483647]                  * 00164000
*                          is the name (RS-type), or address in       * 00165000
*                          register (2)-(12), of an optional fullword * 00166000
*                          input that specifies the maximum number of * 00167000
*                          messages which may be queued to this       * 00168000
*                          console.                                   * 00169000
*                          DEFAULT: 2147483647.                       * 00170000
*                                                                     * 00171000
*                                                                     * 00172000
*                                                                     * 00173000
*                                                                     * 00173500
*                      [ALERTECB=xalertecb|0                        * 00174000
*                          is an optional input.  It is the name      * 00175000
*                          (RS-type), or address in register          * 00176000
*                          (2)-(12), that specifies the ECB to be     * 00177000
*                          posted when the queue depth reaches a      * 00178000
*                          critical threshold, when there is no       * 00179000
*                          memory available to queue additional       * 00180000
*                          messages, or an internal error has been    * 00181000
*                          detected for this console.                 * 00182000
*                          DEFAULT: 0.                                * 00183000
*                                                                     * 00184000
*                                                                     * 00185000
*                          [ALERTPCT=xalertpct|100]]                * 00186000
*                              is the name (RS-type), or address in   * 00187000
*                              register (2)-(12), of an optional byte * 00188000
*                              input that specifies the queue depth   * 00189000
*                              alert percent.  When queuing reaches   * 00190000
*                              this percentage of the queue depth, as * 00191000
*                              defined by QLIMIT, the alert ECB will  * 00192000
*                              be posted                              * 00193000
*                              DEFAULT: 100.                          * 00194000
*                                                                     * 00195000
*                                                                     * 00196000
*                                                                     * 00197000
*                                                                     * 00198000
*                                                                     * 00198300
*                                                                     * 00198600
*                      [QRESUME=xqresume|0]]                        * 00199000
*                          is the name (RS-type), or address in       * 00200000
*                          register (2)-(12), of an optional byte     * 00201000
*                          input that specifies the queue depth       * 00202000
*                          resume percent.  If queuing was disabled   * 00203000
*                          due to a critical threshold in the queue   * 00204000
*                          depth, as defined by QLIMIT, and the queue * 00205000
*                          depth has lowered to this resume           * 00206000
*                          percentage, then queuing will              * 00207000
*                          automatically resume for this console.     * 00208000
*                          DEFAULT: 0.                                * 00209000
*                                                                     * 00210000
*                                                                     * 00211000
*                                                                     * 00211500
*                  [MSGDLVRY=SEARCH                                   * 00212000
*                      Search parameters may be specified on          * 00213000
*                      MCSOPMSG.                                      * 00214000
*                                                                     * 00215000
*                                                                     * 00216000
*                      MSGECB=xmsgecb                                 * 00217000
*                          is a required input.  It is the name       * 00218000
*                          (RS-type), or address in register          * 00219000
*                          (2)-(12), that specifies the ECB which is  * 00220000
*                          posted when a message is queued to this    * 00221000
*                          console.                                   * 00222000
*                                                                     * 00223000
*                                                                     * 00224000
*                                                                     * 00225000
*                                                                     * 00225500
*                      [QLIMIT=xqlimit|2147483647]                  * 00226000
*                          is the name (RS-type), or address in       * 00227000
*                          register (2)-(12), of an optional fullword * 00228000
*                          input that specifies the maximum number of * 00229000
*                          messages which may be queued to this       * 00230000
*                          console.                                   * 00231000
*                          DEFAULT: 2147483647.                       * 00232000
*                                                                     * 00233000
*                                                                     * 00234000
*                                                                     * 00235000
*                                                                     * 00235500
*                      [ALERTECB=xalertecb|0                        * 00236000
*                          is an optional input.  It is the name      * 00237000
*                          (RS-type), or address in register          * 00238000
*                          (2)-(12), that specifies the ECB to be     * 00239000
*                          posted when the queue depth reaches a      * 00240000
*                          critical threshold, when there is no       * 00241000
*                          memory available to queue additional       * 00242000
*                          messages, or an internal error has been    * 00243000
*                          detected for this console.                 * 00244000
*                          DEFAULT: 0.                                * 00245000
*                                                                     * 00246000
*                                                                     * 00247000
*                          [ALERTPCT=xalertpct|100]]                * 00248000
*                              is the name (RS-type), or address in   * 00249000
*                              register (2)-(12), of an optional byte * 00250000
*                              input that specifies the queue depth   * 00251000
*                              alert percent.  When queuing reaches   * 00252000
*                              this percentage of the queue depth, as * 00253000
*                              defined by QLIMIT, the alert ECB will  * 00254000
*                              be posted                              * 00255000
*                              DEFAULT: 100.                          * 00256000
*                                                                     * 00257000
*                                                                     * 00258000
*                                                                     * 00259000
*                                                                     * 00260000
*                                                                     * 00260300
*                                                                     * 00260600
*                      [QRESUME=xqresume|0]]                        * 00261000
*                          is the name (RS-type), or address in       * 00262000
*                          register (2)-(12), of an optional byte     * 00263000
*                          input that specifies the queue depth       * 00264000
*                          resume percent.  If queuing was disabled   * 00265000
*                          due to a critical threshold in the queue   * 00266000
*                          depth, as defined by QLIMIT, and the queue * 00267000
*                          depth has lowered to this resume           * 00268000
*                          percentage, then queuing will              * 00269000
*                          automatically resume for this console.     * 00270000
*                          DEFAULT: 0.                                * 00271000
*                                                                     * 00272000
*                                                                     * 00273000
*                                                                     * 00273500
*                  [MSGDLVRY=NONE]                                    * 00274000
*                      No messages are delivered to this console.     * 00275000
*                                                                     * 00276000
*                                                                     * 00277000
*                                                                     * 00278000
*                                                                     * 00278300
*                                                                     * 00278600
*          REQUEST=DEACTIVATE                                         * 00279000
*              Deactivate the extended console.                       * 00280000
*                                                                     * 00281000
*                                                                     * 00282000
*              CONSID=xconsid                                         * 00283000
*                  is the name (RS-type), or address in register      * 00284000
*                  (2)-(12), of a required fullword input that        * 00285000
*                  specifies the 4 byte console ID which identifies   * 00286000
*                  the user.                                          * 00287000
*                                                                     * 00288000
*                                                                     * 00289000
*                                                                     * 00290000
*                                                                     * 00290500
*              [ABTERM=NO|YES]                                      * 00291000
*                  is an optional keyword input that indicates        * 00292000
*                  abnormal termination for extended operator.        * 00293000
*                  DEFAULT: NO                                        * 00294000
*                                                                     * 00295000
*                                                                     * 00296000
*                  ABTERM=NO                                          * 00297000
*                      keyword that indicates abnormal termination is * 00298000
*                      not requested for extended operator.           * 00299000
*                                                                     * 00300000
*                  ABTERM=YES                                         * 00300600
*                      keyword that indicates abnormal termination is * 00301200
*                      requested for extended operator.               * 00301800
*                                                                     * 00302400
*                                                                     * 00303000
*                                                                     * 00304000
*                                                                     * 00305000
*                                                                     * 00306000
*          REQUEST=RELEASE                                            * 00307000
*              Release a migration ID.                                * 00308000
*                                                                     * 00309000
*                                                                     * 00310000
*              MIGID=xmigid                                           * 00311000
*                  is the name (RS-type), or address in register      * 00312000
*                  (2)-(12), of a required byte input that specifies  * 00313000
*                  the migration ID to be released.                   * 00314000
*                                                                     * 00315000
*                                                                     * 00316000
*                                                                     * 00317000
*                                                                     * 00318000
*                                                                     * 00319000
*                                                                     * 00319200
*                                                                     * 00319400
*                                                                     * 00319600
*      [RTNCODE=xrtncode]                                             * 00320000
*          is the name (RS-type) of an optional fullword output       * 00321000
*          variable, or register (2)-(12), into which the return code * 00322000
*          is to be copied from GPR 15.                               * 00323000
*                                                                     * 00323500
*                                                                     * 00324000
*                                                                     * 00325000
*                                                                     * 00326000
*      [RSNCODE=xrsncode]                                             * 00327000
*          is the name (RS-type) of an optional fullword output       * 00328000
*          variable, or register (2)-(12), into which the reason code * 00329000
*          is to be copied from GPR 0.                                * 00330000
*                                                                     * 00330500
*                                                                     * 00331000
*                                                                     * 00332000
*                                                                     * 00333000
*      [MF=S|L|M|E]                                                 * 00334000
*          is an optional keyword input which specifies the macro     * 00335000
*          form.                                                      * 00336000
*          DEFAULT: S                                                 * 00337000
*                                                                     * 00338000
*                                                                     * 00339000
*          [MF=S]                                                     * 00340000
*              specifies the standard form of the macro.  The "S"     * 00341000
*              form generates code to put the parameters into an      * 00342000
*              in-line parameter list and invoke the desired service. * 00343000
*              Full checking for required macro keys is done along    * 00344000
*              with supplying defaults for omitted optional           * 00345000
*              parameters.                                            * 00346000
*                                                                     * 00347000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00348000
*              specifies the list form of the macro.  The "L" form    * 00349000
*              defines an area to be used for the parameter list.     * 00350000
*              Any other macro parameters are flagged as errors.      * 00351000
*                                                                     * 00352000
*            ,xmfctrl                                                 * 00353000
*              is a required input.  It is the name of a storage area * 00354000
*              for the parameter list.                                * 00355000
*                                                                     * 00356000
*            ,xmfattr|0D                                            * 00357000
*              is an optional 60 character input string that varies   * 00357700
*              from 1 to 60 characters. Use it to force boundary      * 00358800
*              alignment of the parameter list. Use only 0F or 0D.    * 00359900
*              DEFAULT: 0D which forces the parameter list to a       * 00361200
*              doubleword boundary.                                   * 00361900
*                                                                     * 00363000
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00364000
*              specifies the modify form of the macro.  The "M" form  * 00365000
*              generates code to put the parameters into the          * 00366000
*              parameter list specified by xmfctrl.                   * 00367000
*                                                                     * 00368000
*            ,xmfctrl                                                 * 00369000
*              is a required input.  It is the name (RS-type), or     * 00370000
*              address in register (1)-(12), of a storage area for    * 00371000
*              the parameter list.                                    * 00372000
*                                                                     * 00373000
*            ,COMPLETE|NOCHECK]                                     * 00374000
*              is an optional keyword input which specifies the       * 00375000
*              degree of macro parameter syntax checking.             * 00376000
*              DEFAULT: COMPLETE                                      * 00377000
*                                                                     * 00378000
*                                                                     * 00379000
*              COMPLETE                                               * 00380000
*                  Checking for required macro keys is done and       * 00381000
*                  defaults are supplied for omitted optional         * 00382000
*                  parameters.  (See Macro Usage Note 2).             * 00383000
*                                                                     * 00384000
*              NOCHECK                                                * 00384600
*                  Checking for required macro keys is not done nor   * 00385200
*                  are defaults supplied for omitted optional         * 00385800
*                  parameters.                                        * 00386400
*                                                                     * 00387000
*                                                                     * 00388000
*                                                                     * 00389000
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00390000
*              specifies the execute form of the macro.  The "E" form * 00391000
*              generates code to put the parameters into the          * 00392000
*              parameter list specified by xmfctrl and invoke the     * 00393000
*              desired service.                                       * 00394000
*                                                                     * 00395000
*            ,xmfctrl                                                 * 00396000
*              is a required input.  It is the name (RS-type), or     * 00397000
*              address in register (1)-(12), of a storage area for    * 00398000
*              the parameter list.                                    * 00399000
*                                                                     * 00400000
*            ,COMPLETE|NOCHECK                                      * 00401000
*              is an optional keyword input which specifies the       * 00402000
*              degree of macro parameter syntax checking.             * 00403000
*              DEFAULT: COMPLETE                                      * 00404000
*                                                                     * 00405000
*                                                                     * 00406000
*              COMPLETE                                               * 00407000
*                  Checking for required macro keys is done and       * 00408000
*                  defaults are supplied for omitted optional         * 00409000
*                  parameters.  (See Macro Usage Note 2).             * 00410000
*                                                                     * 00411000
*              NOCHECK                                                * 00411500
*                  Checking for required macro keys is not done nor   * 00412000
*                  are defaults supplied for omitted optional         * 00412500
*                  parameters.                                        * 00413000
*                                                                     * 00413500
*                                                                     * 00414000
*                                                                     * 00414500
*                                                                     * 00415000
*                                                                     * 00416000
*                                                                     * 00417000
*                                                                     * 00418000
*01* RETURN CODES:                                                    * 00419000
*                                                                     * 00420000
*                                                                     * 00421000
*            0    Successful processing                               * 00422000
*                                                                     * 00423000
*            4    For activate - the operator was already active.     * 00424000
*                                                                     * 00425000
*                 For deactivate - the operator was not active.       * 00426000
*                                                                     * 00427000
*                 Both of these cases are considered user errors      * 00428000
*                 (JES3, TSO/E, etc.)  In each situation, however,    * 00429000
*                 the desired situation exists already.               * 00430000
*                                                                     * 00431000
*            8    For deactivate - the operator has never been        * 00432000
*                 defined.                                            * 00433000
*                                                                     * 00433200
*            12   For activate - the console name does not have       * 00433400
*                 authority to read the user's profile.  Activate     * 00433600
*                 failed.                                             * 00433800
*                                                                     * 00434000
*            16   An error was detected in the input parameter list   * 00435000
*                 (IEZVG111)                                          * 00436000
*                                                                     * 00437000
*            20   Service routine failed.                             * 00438000
*                                                                     * 00439000
*            24   User is not in supervisor state.                    * 00440000
*                                                                     * 00441000
*            28   For release - the migration ID specified does not   * 00442000
*                 identify a defined user.                            * 00443000
*                                                                     * 00444000
*            32   For release - the console with the specified        * 00445000
*                 migration ID is still active.                       * 00446000
*                                                                     * 00447000
*                                                                     * 00448000
*                                                                     * 00448500
*01* REASON CODES:                                                    * 00449000
*                                                                     * 00450000
*       REASON    RETURN                                              * 00451000
*       CODE      CODE      DESCRIPTION                               * 00452000
*                                          * 00453000
*                                                                     * 00454000
*                                                                     * 00455000
*              4  0         An  operator  was successfully activated; * 00456000
*                           however,  a migration id was not obtained * 00457000
*                           if one was requested.                     * 00458000
*                                                                     * 00459000
*              0  16        Invalid function specified                * 00460000
*                                                                     * 00461000
*              8  16        Userid  is  not a valid id, e.g. only one * 00462000
*                           character or starts with a numeric        * 00463000
*                                                                     * 00464000
*             12  16        Invalid console id was specified          * 00465000
*                                                                     * 00466000
*             24  16        Invalid authority level was specified     * 00467000
*                                                                     * 00468000
*             28  16        Invalid message format was specified      * 00469000
*                                                                     * 00470000
*             32  16        Invalid message level was specified       * 00471000
*                                                                     * 00472000
*             36  16        Invalid message type was specified        * 00473000
*                                                                     * 00474000
*             40  16        Invalid log command response              * 00475000
*                                                                     * 00476000
*             44  16        Invalid acronym was specified             * 00477000
*                                                                     * 00478000
*             48  16        Invalid key was specified                 * 00479000
*                                                                     * 00480000
*             52  16        Invalid migration id was specified        * 00481000
*                                                                     * 00482000
*             56  16        Invalid CMDSYS was specified              * 00483000
*                                                                     * 00484000
*             60  16        Invalid  MSCOPE  was specified.  Possible * 00485000
*                           reasons are:                              * 00486000
*                                                                     * 00487000
*                                                                     * 00488000
*                           o   *ALL specified with some other value  * 00489000
*                                                                     * 00490000
*                           o   Syntax error in a system name         * 00491000
*                                                                     * 00492000
*                           o   Duplicate  system  name found in list * 00493000
*                               of systems specified.                 * 00494000
*                                                                     * 00495000
*                           o   Invalid number of systems specified.  * 00496000
*                                                                     * 00497000
*                                                                     * 00497100
*                                                                     * 00497200
*             64  16        Alternate group name in operparms segment * 00497300
*                           is not valid.                             * 00497400
*                                                                     * 00497500
*             68  16        Primary  address  space  is  not equal to * 00497600
*                           home address space.                       * 00497700
*                                                                     * 00498000
*              0  20        No  room  in  system tables (CLT, ODT, or * 00499000
*                           MCSCSA).                                  * 00500000
*                                                                     * 00501000
*              8  20        Retry from an abend.                      * 00502000
*                                                                     * 00503000
*             12  20        SAF service routine error.                * 00504000
*                                                                     * 00505000
*             16  20        The  XSYSMCS service routine had an error * 00506000
*                           that  could  not be recovered, processing * 00507000
*                           could not complete.                       * 00508000
*                                                                     * 00509000
*             20  20        CONVCON service routine error.            * 00510000
*                                                                     * 00511000
*             24  20        The  console  id specified is not defined * 00512000
*                           to the SYSPLEX at this time.              * 00513000
*                                                                     * 00514000
*             28  20        Create of ESTAE environment failed.       * 00515000
*                                                                     * 00516000
*             32  20        Data  space  initialization  error.   The * 00517000
*                           data space could not be created because a * 00518000
*                           data space or ALET could not be obtained. * 00519000
*                                                                     * 00520000
*             36  20        Data  access failure.  An attempt was mad * 00521000
*                           to access a control block that:           * 00522000
*                                                                     * 00523000
*                                                                     * 00524000
*                           o   Has a zero pointer in it              * 00525000
*                                                                     * 00526000
*                           o   Had  a  bad  pointer to it (points to * 00527000
*                               non-addressable storage)              * 00528000
*                                                                     * 00529000
*                           o   Had a invalid acronym in the header.  * 00530000
*                                                                     * 00531000
*                                                                     * 00532000
*                                                                     * 00533000
*                                                                     * 00533300
*                                                                     * 00533600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00534000
*                                                                     * 00535000
*02*   PROCESSOR:  ASSEM                                              * 00536000
*                                                                     * 00537000
*01* COMPONENT:  SC1CK                                                * 00538000
*                                                                     * 00539000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00540000
*                                                                     * 00541000
*01* MACRO USAGE NOTES:                                               * 00542000
*                                                                     * 00543000
*                                                                     * 00544000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00545000
*        global macro variable.  Any value other than 'NO' will       * 00546000
*        result in the macro expansion being printed.  The default is * 00547000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00548000
*        variable should be set.                                      * 00549000
*                                                                     * 00550000
*                    GBLC &ZPRINT                                     * 00550500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00551000
*                                                                     * 00552000
*                                                                     * 00553000
*    2.  When using the NOCHECK option in conjunction with the Modify * 00554000
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00555000
*        Modify   or  Execute  form  invocation  which  specifies  or * 00556000
*        defaults  to  the  COMPLETE  option.   This insures that the * 00557000
*        parameter list is initialized completely.                    * 00558000
*                                                                     * 00559000
*                                                                     * 00560000
*                                                                     * 00560500
*01* CHANGE ACTIVITY:                                                 * 00561000
*                                                                     * 00562000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00563000
*                                                                     * 00564000
*    $L0=CNSL1EBU HBB4410 890417 PDBU:  CONSOLE ENHANCEMENTS 1        * 00565000
*    $L1=CNSL2ADQ HBB4420 900122 PDDQ:  CONSOLE ENHANCEMENTS 2        * 00566000
*    $P1=PH32102  HBB4420 910201 PDDQ:  ADD Return code 12 in prolog  * 00567000
*    $P2=PKB3660  HBB4430 920722 PDCI:  ADD Document new reason codes * 00567300
*                                         for return code 16.         * 00567600
*    $01=OY54135  HBB4420 920501 PDDQ:  ADD MIGID in ACTIVATE request * 00567800
*    $02=OW20039  HBB4430 970203 PDDH:  ADD MIGIDREL in ACTIVATE      * 00568200
*                                         request                     * 00568600
****** END OF SPECIFICATIONS *****************************************/ 00569000
*/* TLINE 1 *********************************************************** 00569400
         MACRO                                                          00570000
&XLABEL  MCSOPER &REQUEST=,&NAME=,&CONSID=,&MIGID=,&MIGIDREL=,         *00571000
               &TERMNAME=,&MCSCSA=,&MCSCSAA=,&OPERPARM=,&MSGDLVRY=,    *00572000
               &MSGECB=,&QLIMIT=,&ALERTECB=,&ALERTPCT=,&QRESUME=,      *00573000
               &ABTERM=,&RTNCODE=,&RSNCODE=,&MF=                        00574000
.*                                                                      00575000
*                MACDATE -97/02/03-<1>                                  00576000
.*                                                                      00577000
.*******************************************************************    00578000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00579000
.*******************************************************************    00580000
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00581000
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00582000
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00583000
.*                                                                      00584000
                GBLC  &ZMCSOPER   YES=MACRO USED AT LEAST ONCE          00585000
.*******************************************************************    00586000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00587000
.*******************************************************************    00588000
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00589000
                LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS          00590000
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00591000
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00592000
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00593000
                LCLA  &ZAWRK      USED AS A WORK AREA                   00594000
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00595000
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00596000
                LCLC  &ZC         CHARACTER WORK VARIABLE               00597000
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00597300
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00597600
                LCLA  &ZMACRET    MACRO RETURN CODE                     00598000
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00599000
.*                                                                      00600000
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00601000
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00602000
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00603000
                LCLC  &ZENDBASEPL               End of base PL          00603500
.********************************************************************   00604000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00605000
.********************************************************************   00606000
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00607000
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00608000
.*                                                                      00609000
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00610000
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00611000
                SPLEVEL  TEST                                           00612000
.ZSYS2          ANOP  ,                                                 00613000
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00614000
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00615000
                SYSSTATE TEST                                           00616000
                AGO   .ZSYS4                                            00617000
.ZSYS3          ANOP  ,                                                 00618000
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00619000
.ZSYS4          ANOP  ,                                                 00620000
.*******************************************************************    00621000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00622000
.*******************************************************************    00623000
                LCLC  &XREQUEST   ++ VALUE                              00624000
                LCLC  &XNAME      ++ NAME                               00625000
                LCLC  &XCONSID    ++ NAME                               00626000
                LCLC  &XMIGID     ++ NAME                               00626500
                LCLC  &XMIGIDREL  ++ VALUE                              00626700
                LCLC  &XTERMNAME  ++ NAME                               00627000
                LCLC  &XMCSCSA    ++ NAME                               00628000
                LCLC  &XMCSCSAA   ++ NAME                               00629000
                LCLC  &XOPERPARM  ++ NAME                               00630000
                LCLC  &XMSGDLVRY  ++ VALUE                              00631000
                LCLC  &XMSGECB    ++ NAME                               00632000
                LCLC  &XQLIMIT    ++ NAME                               00633000
                LCLC  &XALERTECB  ++ NAME                               00634000
                LCLC  &XALERTPCT  ++ NAME                               00635000
                LCLC  &XQRESUME   ++ NAME                               00636000
                LCLC  &XABTERM    ++ VALUE                              00637000
                LCLC  &XRTNCODE   ++ NAME                               00639000
                LCLC  &XRSNCODE   ++ NAME                               00640000
                LCLC  &XMF        ++ VALUE                              00641000
                LCLC  &XMFCTRL    ++ NAME                               00642000
                LCLC  &XMFATTR    ++ VALUE                              00643000
                LCLC  &XMFSCK     ++ VALUE                              00644000
.*******************************************************************    00645000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00646000
.*******************************************************************    00647000
                LCLC  &ZXREQUEST  ++ INPUT VALUE                        00648000
                LCLC  &ZXNAME     ++ INPUT NAME                         00649000
                LCLC  &ZXCONSID   ++ OUTPUT NAME                        00650000
                LCLC  &ZXMIGID    ++ OUTPUT NAME                        00650500
                LCLC  &ZXMIGIDREL               ++ INPUT VALUE          00650700
                LCLC  &ZXTERMNAME               ++ INPUT NAME           00651000
                LCLC  &ZXMCSCSA   ++ OUTPUT NAME                        00652000
                LCLC  &ZXMCSCSAA  ++ OUTPUT NAME                        00653000
                LCLC  &ZXOPERPARM               ++ INPUT NAME           00654000
                LCLC  &ZXMSGDLVRY               ++ INPUT VALUE          00655000
                LCLC  &ZXMSGECB   ++ INPUT NAME                         00656000
                LCLC  &ZXQLIMIT   ++ INPUT NAME                         00657000
                LCLC  &ZXALERTECB               ++ INPUT NAME           00658000
                LCLC  &ZXALERTPCT               ++ INPUT NAME           00659000
                LCLC  &ZXQRESUME  ++ INPUT NAME                         00660000
                LCLC  &ZXABTERM   ++ INPUT VALUE                        00661000
                LCLC  &ZXRTNCODE  ++ OUTPUT NAME                        00663000
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00664000
                LCLC  &ZXMF       ++ INPUT VALUE                        00665000
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00666000
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00667000
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00668000
.********************************************************************   00669000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00670000
.********************************************************************   00671000
                ACTR  10000                                             00672000
.*------------------------------------------------------------------    00673000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00674000
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00675000
.*-------------------------------------------------------------------   00676000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00677000
.ZG88           ANOP  ,                                                 00677800
&ZTLC           SETC 'S'                                                00678600
                AIF   ('&MF(1)' NE '&ZTLC').ZG89                        00679300
&XMF            SETC  'S'         SET KEYWORD                           00680000
&XMFSCK         SETC  'COMPLETE'  SET XMFSCK                            00681000
                AIF   (N'&MF LE 1).ZG88A        CK NUM                  00682000
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00683000
&ZMS            SETC  '&ZMS.&MF"'                                       00684000
&ZMS            SETC  '&ZMS "MF"'                                       00685000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00686000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00687000
.ZG88A          ANOP  ,                                                 00688000
.*-------------------------------------------------------------------   00689000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00690000
.ZG89           ANOP  ,                                                 00690800
&ZTLC           SETC 'L'                                                00691600
                AIF   ('&MF(1)' NE '&ZTLC').ZG96                        00692300
&XMF            SETC  'L'         SET KEYWORD                           00693000
                AIF   (N'&MF LE 3).ZG89A        CK NUM                  00694000
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00695000
&ZMS            SETC  '&ZMS.&MF"'                                       00696000
&ZMS            SETC  '&ZMS "MF"'                                       00697000
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00698000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00699000
.ZG89A          ANOP  ,                                                 00700000
.*-------------------------------------------------------------------   00701000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00702000
                AIF   (N'&SYSLIST NE 0).ZG89B   POSITIONALS?            00702900
                AIF   ('&REQUEST' NE '').ZG89B  KEYS?                   00703800
                AIF   ('&NAME' NE '').ZG89B     KEYS?                   00704700
                AIF   ('&CONSID' NE '').ZG89B   KEYS?                   00705600
                AIF   ('&MIGID' NE '').ZG89B    KEYS?                   00706500
                AIF   ('&MIGIDREL' NE '').ZG89B  KEYS?                  00707400
                AIF   ('&TERMNAME' NE '').ZG89B  KEYS?                  00708300
                AIF   ('&MCSCSA' NE '').ZG89B   KEYS?                   00709200
                AIF   ('&MCSCSAA' NE '').ZG89B  KEYS?                   00710100
                AIF   ('&OPERPARM' NE '').ZG89B  KEYS?                  00711000
                AIF   ('&MSGDLVRY' NE '').ZG89B  KEYS?                  00711900
                AIF   ('&MSGECB' NE '').ZG89B   KEYS?                   00712800
                AIF   ('&QLIMIT' NE '').ZG89B   KEYS?                   00713700
                AIF   ('&ALERTECB' NE '').ZG89B  KEYS?                  00714600
                AIF   ('&ALERTPCT' NE '').ZG89B  KEYS?                  00715500
                AIF   ('&QRESUME' NE '').ZG89B  KEYS?                   00716400
                AIF   ('&ABTERM' NE '').ZG89B   KEYS?                   00717300
                AIF   ('&RTNCODE' NE '').ZG89B  KEYS?                   00718200
                AIF   ('&RSNCODE' NE '').ZG89B  KEYS?                   00719100
                AGO    .ZG89C     INVOCATION OKAY                       00720000
.ZG89B          ANOP  ,                                                 00720900
&ZMS            SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE       00723000
&ZMS            SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                 00724000
&ZMS            SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'            00725000
                MNOTE 8,' &ZMS ON THE INVOCATION.'                      00726000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00727000
.ZG89C          ANOP  ,                                                 00728000
.*-------------------------------------------------------------------   00729000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00730000
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00731000
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00732000
                AIF   (N'&MF(2) GT 1).ZG91B     MULTI PARMS             00733000
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00734000
.ZG91B          AIF   (K'&MF(2) GT 0).ZG91C                             00735000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00736000
&ZMS            SETC  ' '         *KRQDA*                               00737000
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00738000
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00739000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00740000
.ZG91C          ANOP  ,                                                 00741000
.*-------------------------------------------------------------------   00742000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00743000
                AIF   (K'&ZXMFCTRL LE 0).ZG91P  NOT I/O                 00744000
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG91P                    00745000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00746000
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00747000
&ZMS            SETC  '&ZMS.&MF"'                                       00748000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00749000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00750000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00751000
.ZG91P          ANOP  ,                                                 00752000
.*-------------------------------------------------------------------   00753000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00754000
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00755000
&XMFATTR        SETC  '0D'                                              00756000
                AIF   (K'&MF(3) LE 0).ZG94B     PARM                    00757000
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00758000
                AIF   (N'&MF(3) GT 1).ZG94B     MULTI PARMS             00759000
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00760000
.ZG94B          ANOP  ,                                                 00761000
.*-------------------------------------------------------------------   00762000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00763000
                AIF   (K'&ZXMFATTR LE 0).ZG94P  NOT I/O                 00764000
                AIF   ('&XMFATTR'(1,1) NE '(').ZG94P                    00765000
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00766000
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00767000
&ZMS            SETC  '&ZMS.&MF"'                                       00768000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00769000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00770000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00771000
.ZG94P          ANOP  ,                                                 00772000
.*-------------------------------------------------------------------   00773000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00774000
                AIF   (K'&ZXMFATTR LE 0).ZG94S  NOT I/O                 00775000
                AIF   (K'&XMFATTR LE 60).ZG94S  LNG OK                  00776000
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00777000
&ZMS            SETC  '"MF='      *KLNGA* MNOTE                         00778000
&ZMS            SETC  '&ZMS.&MF"'                                       00779000
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00780000
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00781000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00782000
.ZG94S          ANOP  ,                                                 00783000
.*-------------------------------------------------------------------   00784000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00785000
.ZG96           ANOP  ,                                                 00785800
&ZTLC           SETC 'M'                                                00786600
                AIF   ('&MF(1)' NE '&ZTLC').ZG105                       00787300
&XMF            SETC  'M'         SET KEYWORD                           00788000
                AIF   (N'&MF LE 3).ZG96A        CK NUM                  00789000
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00790000
&ZMS            SETC  '&ZMS.&MF"'                                       00791000
&ZMS            SETC  '&ZMS "MF"'                                       00792000
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00793000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00794000
.ZG96A          ANOP  ,                                                 00795000
.*-------------------------------------------------------------------   00796000
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00797000
                AIF   ('&MCSCSA' NE '').ZG96B   OUTPUT SPECIFIED?       00798000
                AIF   ('&MCSCSAA' NE '').ZG96B                          00799000
                AIF   ('&RTNCODE' NE '').ZG96B                          00800000
                AGO    .ZG96C     INVOCATION OKAY                       00801000
.ZG96B          ANOP  ,                                                 00802000
&ZMS            SETC  'THE "M" FORM OF "MF" CANNOT'  *MFMOA* MNOTE      00803000
&ZMS            SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'           00804000
&ZMS            SETC  '&ZMS SPECIFIED ON THE INVOCATION:'               00805000
&ZMS            SETC  '&ZMS "MCSCSA"'                                   00805800
&ZMS            SETC  '&ZMS OR "MCSCSAA"'                               00806600
&ZMS            SETC  '&ZMS OR "RTNCODE"'                               00807400
                MNOTE 8,' &ZMS '                                        00808200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00809000
.ZG96C          ANOP  ,                                                 00810000
.*-------------------------------------------------------------------   00811000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00812000
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00813000
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00814000
                AIF   (N'&MF(2) GT 1).ZG98B     MULTI PARMS             00815000
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00816000
.ZG98B          AIF   (K'&MF(2) GT 0).ZG98C                             00817000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00818000
&ZMS            SETC  ' '         *KRQDA*                               00819000
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00820000
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00821000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00822000
.ZG98C          ANOP  ,                                                 00823000
.*-------------------------------------------------------------------   00824000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00825000
                AIF   (K'&ZXMFCTRL LE 0).ZG98R  NOT I/O                 00826000
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG98R                    00827000
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00828000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG98P                      00829000
                AIF   (K'&ZCGPR GT 2).ZG98Q                             00830000
                AIF   ('&ZCGPR' EQ '0').ZG98Q                           00831000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00832000
                AIF   (T'&ZCGPR NE 'N').ZG98Q   INVALID REG NAME        00833000
.ZG98P          ANOP  ,                                                 00834000
                AIF   (T'&ZCGPR NE 'N').ZG98R   NON NUMERIC             00835000
                AIF   ('&ZCGPR' LT '1').ZG98Q                           00836000
                AIF   ('&ZCGPR' LE '12').ZG98R                          00837000
.ZG98Q          ANOP  ,                                                 00838000
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00839000
&ZMS            SETC  '&ZMS.&MF"'                                       00840000
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00841000
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00842000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00843000
.ZG98R          ANOP  ,                                                 00844000
.*-------------------------------------------------------------------   00845000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00846000
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00847000
.ZG102A   AIF   ('&MF(3)' NE 'COMPLETE').ZG103A                         00848000
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00849000
.*-------------------------------------------------------------------   00850000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00851000
.ZG103A   AIF   ('&MF(3)' NE 'NOCHECK').ZG104A                          00852000
&XMFSCK         SETC  'NOCHECK'   SET KEYWORD                           00853000
.*-------------------------------------------------------------------   00854000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00855000
.ZG104A         AIF   (K'&XMFSCK GT 0).ZG104C   KEYWORD                 00856000
                AIF   (K'&MF(3) LE 0).ZG104B                            00857000
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00858000
&ZMS            SETC  '&ZMS.&MF"'                                       00859000
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00860000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00861000
&ZMS            SETC  '&ZMS "COMPLETE"'                                 00861700
&ZMS            SETC  '&ZMS OR "NOCHECK".'                              00862400
                MNOTE 8,' &ZMS '                                        00863200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00864000
.ZG104B         ANOP  ,                                                 00865000
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00866000
.ZG104C         ANOP  ,                                                 00867000
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00868000
.*-------------------------------------------------------------------   00869000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00870000
.ZG105          ANOP  ,                                                 00870800
&ZTLC           SETC 'E'                                                00871600
                AIF   ('&MF(1)' NE '&ZTLC').ZG114                       00872300
&XMF            SETC  'E'         SET KEYWORD                           00873000
                AIF   (N'&MF LE 3).ZG105A       CK NUM                  00874000
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00875000
&ZMS            SETC  '&ZMS.&MF"'                                       00876000
&ZMS            SETC  '&ZMS "MF"'                                       00877000
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00878000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00879000
.ZG105A         ANOP  ,                                                 00880000
.*-------------------------------------------------------------------   00881000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00882000
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00883000
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00884000
                AIF   (N'&MF(2) GT 1).ZG107B    MULTI PARMS             00885000
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00886000
.ZG107B         AIF   (K'&MF(2) GT 0).ZG107C                            00887000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00888000
&ZMS            SETC  'WHEN "E" IS SPECIFIED'   *KRQDA*                 00889000
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00890000
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00891000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00892000
.ZG107C         ANOP  ,                                                 00893000
.*-------------------------------------------------------------------   00894000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00895000
                AIF   (K'&ZXMFCTRL LE 0).ZG107R  NOT I/O                00896000
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG107R                   00897000
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00898000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG107P                     00899000
                AIF   (K'&ZCGPR GT 2).ZG107Q                            00900000
                AIF   ('&ZCGPR' EQ '0').ZG107Q                          00901000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00902000
                AIF   (T'&ZCGPR NE 'N').ZG107Q  INVALID REG NAME        00903000
.ZG107P         ANOP  ,                                                 00904000
                AIF   (T'&ZCGPR NE 'N').ZG107R  NON NUMERIC             00905000
                AIF   ('&ZCGPR' LT '1').ZG107Q                          00906000
                AIF   ('&ZCGPR' LE '12').ZG107R                         00907000
.ZG107Q         ANOP  ,                                                 00908000
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00909000
&ZMS            SETC  '&ZMS.&MF"'                                       00910000
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00911000
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00912000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00913000
.ZG107R         ANOP  ,                                                 00914000
.*-------------------------------------------------------------------   00915000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00916000
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00917000
.ZG111A   AIF   ('&MF(3)' NE 'COMPLETE').ZG112A                         00918000
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00919000
.*-------------------------------------------------------------------   00920000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00921000
.ZG112A   AIF   ('&MF(3)' NE 'NOCHECK').ZG113A                          00922000
&XMFSCK         SETC  'NOCHECK'   SET KEYWORD                           00923000
.*-------------------------------------------------------------------   00924000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00925000
.ZG113A         AIF   (K'&XMFSCK GT 0).ZG113C   KEYWORD                 00926000
                AIF   (K'&MF(3) LE 0).ZG113B                            00927000
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00928000
&ZMS            SETC  '&ZMS.&MF"'                                       00929000
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00930000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00931000
&ZMS            SETC  '&ZMS "COMPLETE"'                                 00931700
&ZMS            SETC  '&ZMS OR "NOCHECK".'                              00932400
                MNOTE 8,' &ZMS '                                        00933200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00934000
.ZG113B         ANOP  ,                                                 00935000
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00936000
.ZG113C         ANOP  ,                                                 00937000
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00938000
.*------------------------------------------------------------------    00939000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00940000
.ZG114          ANOP  ,                                                 00941000
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00942000
                AIF   (K'&XMF GT 0).ZG114E      VALID ARG               00943000
                AIF   (T'&MF EQ 'O').ZG114D     OMITTED                 00944000
&ZASYSLNDX      SETA  0                                                 00945000
.ZG114A         ANOP  ,           POSITIONAL MACRO KEY                  00946000
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00947000
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG114C                 00947800
&ZTLC           SETC 'MF'                                               00948600
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG114A        00949400
.ZG114B         ANOP  ,                                                 00950200
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00951000
&ZMS            SETC  'THE "MF" KEY'            *KOPTA* MNOTE           00952000
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00953000
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00954000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00955000
                AGO   .ZG114E                                           00956000
.ZG114C         ANOP  ,                                                 00957000
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00958000
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00959000
&ZMS            SETC  '&ZMS.&MF"'                                       00960000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00961000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00962000
&ZMS            SETC  '&ZMS "S",'                                       00962800
&ZMS            SETC  '&ZMS "L",'                                       00963600
&ZMS            SETC  '&ZMS "M",'                                       00964400
&ZMS            SETC  '&ZMS OR "E".'                                    00965200
                MNOTE 8,' &ZMS '                                        00966200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00967000
                AGO   .ZG114E                                           00968000
.ZG114D         ANOP  ,                                                 00969000
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00970000
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00971000
.ZG114E         ANOP  ,                                                 00972000
.********************************************************************   00973000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00974000
.********************************************************************   00975000
                ACTR  10000                                             00976000
.*-------------------------------------------------------------------   00977000
.***AG.MF03 MF=(SLME)                                                   00978000
                AIF   ('&XMF' EQ 'L').ZGMFX                             00979000
                AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                   00980000
.*------------------------------------------------------------------    00981000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00982000
&XREQUEST       SETC  ''          INITIALIZE XVARIABLE                  00983000
.*-------------------------------------------------------------------   00984000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00985000
.ZG3            ANOP  ,                                                 00986000
                AIF   (K'&REQUEST(1) LE 0).ZG3A                         00987000
&ZTLC           SETC 'ACTIVATE'                                         00987600
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZG66                   00988300
&XREQUEST       SETC  'ACTIVATE'  SET KEYWORD                           00989000
                AIF   (N'&REQUEST LE 1).ZG3A    CK NUM                  00990000
&ZMS            SETC  '"REQUEST='               *KPOSA* MNOTE           00991000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  00992000
&ZMS            SETC  '&ZMS "REQUEST"'                                  00993000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00994000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00995000
.ZG3A           ANOP  ,                                                 00996000
.*------------------------------------------------------------------    00997000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00998000
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00999000
.ZG3A0          AIF   (K'&ABTERM LE 0).ZG3A1    OK                      01000000
&ZCVAL          SETC '&ZCVAL ABTERM'            INCORRECT KEY USED      01001000
.ZG3A1          AIF   (K'&ZCVAL LE 0).ZG3A2     OK                      01003000
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             01005000
&ZMS            SETC  '"REQUEST'  *KMEIA* MNOTE                         01006000
&ZMS            SETC  '&ZMS.=&REQUEST"'                                 01007000
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              01008000
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              01009000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01010000
.ZG3A2          ANOP  ,                                                 01011000
.*----------------------------------------------------------------***   01012000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01013000
                AIF   (N'&NAME LE 1).ZG5A       CK NUM                  01014000
&ZMS            SETC  '"NAME='    *KPOSA* MNOTE                         01015000
&ZMS            SETC  '&ZMS.&NAME"'                                     01016000
&ZMS            SETC  '&ZMS "NAME"'                                     01017000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01018000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01019000
.ZG5A           ANOP  ,                                                 01020000
.*-------------------------------------------------------------------   01021000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01022000
&ZXNAME         SETC  'INPUT'     SET IN/OUTPUT                         01023000
&XNAME          SETC  '&NAME(1)'  SET XVARIABLE                         01024000
                AIF   (N'&NAME GT 1).ZG5B       MULTI PARMS             01025000
&XNAME          SETC  '&NAME'     SET XVARIABLE                         01026000
.ZG5B           AIF   (K'&NAME(1) GT 0).ZG5C                            01027000
&ZXNAME         SETC  ''          RESET IN/OUTPUT                       01028000
&ZMS            SETC  ' '         *KRQDA*                               01029000
&ZMS            SETC  '&ZMS "NAME" KEY AND ITS ARGUMENT'                01030000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01031000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01032000
.ZG5C           ANOP  ,                                                 01033000
.*-------------------------------------------------------------------   01034000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01035000
                AIF   (K'&ZXNAME LE 0).ZG5R     NOT I/O                 01036000
                AIF   ('&XNAME'(1,1) NE '(').ZG5R                       01037000
&ZCGPR          SETC  '&XNAME'(2,K'&XNAME-2)                            01038000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                       01039000
                AIF   (K'&ZCGPR GT 2).ZG5Q                              01040000
                AIF   ('&ZCGPR' EQ '0').ZG5Q                            01041000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01042000
                AIF   (T'&ZCGPR NE 'N').ZG5Q    INVALID REG NAME        01043000
.ZG5P           ANOP  ,                                                 01044000
                AIF   (T'&ZCGPR NE 'N').ZG5R    NON NUMERIC             01045000
                AIF   ('&ZCGPR' LT '2').ZG5Q                            01046000
                AIF   ('&ZCGPR' LE '12').ZG5R                           01047000
.ZG5Q           ANOP  ,                                                 01048000
&ZMS            SETC  '"NAME='    *KGPRA* MNOTE                         01049000
&ZMS            SETC  '&ZMS.&NAME"'                                     01050000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01051000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01052000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01053000
.ZG5R           ANOP  ,                                                 01054000
.*-------------------------------------------------------------------   01055000
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             01056000
                AIF   ('&XMF' EQ 'M').ZG9       BYPASS IF MF=M          01057000
.*----------------------------------------------------------------***   01058000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    01059000
                AIF   (N'&CONSID LE 1).ZG8A     CK NUM                  01060000
&ZMS            SETC  '"CONSID='  *KPOSA* MNOTE                         01061000
&ZMS            SETC  '&ZMS.&CONSID"'                                   01062000
&ZMS            SETC  '&ZMS "CONSID"'                                   01063000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01064000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01065000
.ZG8A           ANOP  ,                                                 01066000
.*-------------------------------------------------------------------   01067000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        01068000
&ZXCONSID       SETC  'OUTPUT'    SET IN/OUTPUT                         01069000
&XCONSID        SETC  '&CONSID(1)'              SET XVARIABLE           01070000
                AIF   (N'&CONSID GT 1).ZG8B     MULTI PARMS             01071000
&XCONSID        SETC  '&CONSID'   SET XVARIABLE                         01072000
.ZG8B           AIF   (K'&CONSID(1) GT 0).ZG8C                          01073000
&ZXCONSID       SETC  ''          RESET IN/OUTPUT                       01074000
&ZMS            SETC  ' '         *KRQDA*                               01075000
&ZMS            SETC  '&ZMS "CONSID" KEY AND ITS ARGUMENT'              01076000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01077000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01078000
.ZG8C           ANOP  ,                                                 01079000
.*-------------------------------------------------------------------   01080000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   01081000
                AIF   (K'&ZXCONSID LE 0).ZG8R   NOT I/O                 01082000
                AIF   ('&XCONSID'(1,1) NE '(').ZG8R                     01083000
&ZCGPR          SETC  '&XCONSID'(2,K'&XCONSID-2)                        01084000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                       01085000
                AIF   (K'&ZCGPR GT 2).ZG8Q                              01086000
                AIF   ('&ZCGPR' EQ '0').ZG8Q                            01087000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01088000
                AIF   (T'&ZCGPR NE 'N').ZG8Q    INVALID REG NAME        01089000
.ZG8P           ANOP  ,                                                 01090000
                AIF   (T'&ZCGPR NE 'N').ZG8R    NON NUMERIC             01091000
                AIF   ('&ZCGPR' LT '2').ZG8Q                            01092000
                AIF   ('&ZCGPR' LE '12').ZG8R                           01093000
.ZG8Q           ANOP  ,                                                 01094000
&ZMS            SETC  '"CONSID='  *KGPRA* MNOTE                         01095000
&ZMS            SETC  '&ZMS.&CONSID"'                                   01096000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01097000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01098000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01099000
.ZG8R           ANOP  ,                                                 01100000
.*-------------------------------------------------------------------   01101000
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               01102000
.ZG9            ANOP  ,           END OF BYPASS CHECK                   01103000
.*-------------------------------------------------------------------   01103200
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             01103400
                AIF   ('&XMF' EQ 'M').ZG12      BYPASS IF MF=M          01103600
.*----------------------------------------------------------------***   01104000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01105000
                AIF   (N'&MIGID LE 1).ZG11A     CK NUM                  01106000
&ZMS            SETC  '"MIGID='   *KPOSA* MNOTE                         01107000
&ZMS            SETC  '&ZMS.&MIGID"'                                    01108000
&ZMS            SETC  '&ZMS "MIGID"'                                    01109000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01110000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01111000
.ZG11A          ANOP  ,                                                 01112000
.*-------------------------------------------------------------------   01113000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01114700
                AIF   (K'&MIGID(1) LE 0).ZG11C  NO PARM                 01116400
&ZXMIGID        SETC  'OUTPUT'    SET OUTPUT                            01118100
&XMIGID         SETC  '&MIGID(1)'               SET XVARIABLE           01119800
                AIF   (N'&MIGID GT 1).ZG11C                             01121500
&XMIGID         SETC  '&MIGID'    SET XVARIABLE                         01123200
.ZG11C          ANOP  ,                                                 01125000
.*-------------------------------------------------------------------   01126000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01127000
                AIF   (K'&ZXMIGID LE 0).ZG11R   NOT I/O                 01128000
                AIF   ('&XMIGID'(1,1) NE '(').ZG11R                     01129000
&ZCGPR          SETC  '&XMIGID'(2,K'&XMIGID-2)                          01130000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                      01131000
                AIF   (K'&ZCGPR GT 2).ZG11Q                             01132000
                AIF   ('&ZCGPR' EQ '0').ZG11Q                           01133000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01134000
                AIF   (T'&ZCGPR NE 'N').ZG11Q   INVALID REG NAME        01135000
.ZG11P          ANOP  ,                                                 01136000
                AIF   (T'&ZCGPR NE 'N').ZG11R   NON NUMERIC             01137000
                AIF   ('&ZCGPR' LT '2').ZG11Q                           01138000
                AIF   ('&ZCGPR' LE '12').ZG11R                          01139000
.ZG11Q          ANOP  ,                                                 01140000
&ZMS            SETC  '"MIGID='   *KGPRA* MNOTE                         01141000
&ZMS            SETC  '&ZMS.&MIGID"'                                    01142000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01143000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01144000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01145000
.ZG11R          ANOP  ,                                                 01146000
.*-------------------------------------------------------------------   01147000
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               01148000
.ZG12           ANOP  ,           END OF BYPASS CHECK                   01149000
.*----------------------------------------------------------------***   01150000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01150100
                AIF   (N'&MIGIDREL LE 1).ZG14A  CK NUM                  01150200
&ZMS            SETC  '"MIGIDREL='              *KPOSA* MNOTE           01150300
&ZMS            SETC  '&ZMS.&MIGIDREL"'                                 01150400
&ZMS            SETC  '&ZMS "MIGIDREL"'                                 01150500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01150600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01150700
.ZG14A          ANOP  ,                                                 01150800
.*-------------------------------------------------------------------   01150900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01151000
&XMIGIDREL      SETC  ''          INITIALIZE XVARIABLE                  01151100
.ZG15A   AIF   ('&MIGIDREL(1)' NE 'NO').ZG16A                           01151200
&XMIGIDREL      SETC  'NO'        SET KEYWORD                           01151300
.*-------------------------------------------------------------------   01151400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01151500
.ZG16A   AIF   ('&MIGIDREL(1)' NE 'AUTO').ZG17A                         01151600
&XMIGIDREL      SETC  'AUTO'      SET KEYWORD                           01151700
.*-------------------------------------------------------------------   01151800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01151900
.ZG17A          AIF   (K'&XMIGIDREL GT 0).ZG17C  KEYWORD                01152000
                AIF   (K'&MIGIDREL(1) LE 0).ZG17B                       01152100
&ZMS            SETC  '"MIGIDREL='              *KUKWA* MNOTE           01152200
&ZMS            SETC  '&ZMS.&MIGIDREL"'                                 01152300
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         01152400
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               01152500
&ZMS            SETC  '&ZMS "NO"'                                       01152600
&ZMS            SETC  '&ZMS OR "AUTO".'                                 01152700
                MNOTE 8,' &ZMS '                                        01152800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01152900
.ZG17B          ANOP  ,                                                 01153000
&XMIGIDREL      SETC  'NO'        SET DEFAULT KEYWORD                   01153100
.ZG17C          ANOP  ,                                                 01153200
&ZXMIGIDREL     SETC  'INPUT'     SET IN/OUTPUT                         01153300
.*----------------------------------------------------------------***   01153400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01153500
                AIF   (N'&TERMNAME LE 1).ZG19A  CK NUM                  01153600
&ZMS            SETC  '"TERMNAME='              *KPOSA* MNOTE           01153700
&ZMS            SETC  '&ZMS.&TERMNAME"'                                 01154000
&ZMS            SETC  '&ZMS "TERMNAME"'                                 01155000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01156000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01157000
.ZG19A          ANOP  ,                                                 01158000
.*-------------------------------------------------------------------   01159000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01160000
&ZXTERMNAME     SETC  'INPUT'     SET IN/OUTPUT                         01161000
&XTERMNAME      SETC  '&TERMNAME(1)'            SET XVARIABLE           01162000
                AIF   (N'&TERMNAME GT 1).ZG19B  MULTI PARMS             01163000
&XTERMNAME      SETC  '&TERMNAME'               SET XVARIABLE           01164000
.ZG19B          AIF   (K'&TERMNAME(1) GT 0).ZG19C                       01165000
&ZXTERMNAME     SETC  ''          RESET IN/OUTPUT                       01166000
&ZMS            SETC  ' '         *KRQDA*                               01167000
&ZMS            SETC  '&ZMS "TERMNAME" KEY AND ITS ARGUMENT'            01168000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01169000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01170000
.ZG19C          ANOP  ,                                                 01217000
.*-------------------------------------------------------------------   01218000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01219000
                AIF   (K'&ZXTERMNAME LE 0).ZG19R  NOT I/O               01220000
                AIF   ('&XTERMNAME'(1,1) NE '(').ZG19R                  01221000
&ZCGPR          SETC  '&XTERMNAME'(2,K'&XTERMNAME-2)                    01222000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                      01223000
                AIF   (K'&ZCGPR GT 2).ZG19Q                             01224000
                AIF   ('&ZCGPR' EQ '0').ZG19Q                           01225000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01226000
                AIF   (T'&ZCGPR NE 'N').ZG19Q   INVALID REG NAME        01227000
.ZG19P          ANOP  ,                                                 01228000
                AIF   (T'&ZCGPR NE 'N').ZG19R   NON NUMERIC             01229000
                AIF   ('&ZCGPR' LT '2').ZG19Q                           01230000
                AIF   ('&ZCGPR' LE '12').ZG19R                          01231000
.ZG19Q          ANOP  ,                                                 01232000
&ZMS            SETC  '"TERMNAME='              *KGPRA* MNOTE           01233000
&ZMS            SETC  '&ZMS.&TERMNAME"'                                 01234000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01235000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01236000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01237000
.ZG19R          ANOP  ,                                                 01238000
.*-------------------------------------------------------------------   01239000
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             01239100
                AIF   ('&XMF' EQ 'M').ZG26      BYPASS IF MF=M          01239200
.*----------------------------------------------------------------***   01239300
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    01239400
                AIF   (N'&MCSCSA LE 1).ZG22A    CK NUM                  01239500
&ZMS            SETC  '"MCSCSA='  *KPOSA* MNOTE                         01239600
&ZMS            SETC  '&ZMS.&MCSCSA"'                                   01239700
&ZMS            SETC  '&ZMS "MCSCSA"'                                   01239800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01239900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01240000
.ZG22A          ANOP  ,                                                 01240100
.*-------------------------------------------------------------------   01240200
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        01240300
&ZXMCSCSA       SETC  'OUTPUT'    SET IN/OUTPUT                         01240400
&XMCSCSA        SETC  '&MCSCSA(1)'              SET XVARIABLE           01240500
                AIF   (N'&MCSCSA GT 1).ZG22B    MULTI PARMS             01240600
&XMCSCSA        SETC  '&MCSCSA'   SET XVARIABLE                         01240700
.ZG22B          AIF   (K'&MCSCSA(1) GT 0).ZG22C                         01240800
&ZXMCSCSA       SETC  ''          RESET IN/OUTPUT                       01240900
&ZMS            SETC  ' '         *KRQDA*                               01241000
&ZMS            SETC  '&ZMS "MCSCSA" KEY AND ITS ARGUMENT'              01241100
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01241200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01241300
.ZG22C          ANOP  ,                                                 01241400
.*-------------------------------------------------------------------   01241500
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   01241600
                AIF   (K'&ZXMCSCSA LE 0).ZG22R  NOT I/O                 01241700
                AIF   ('&XMCSCSA'(1,1) NE '(').ZG22R                    01241800
&ZCGPR          SETC  '&XMCSCSA'(2,K'&XMCSCSA-2)                        01241900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                      01242000
                AIF   (K'&ZCGPR GT 2).ZG22Q                             01242100
                AIF   ('&ZCGPR' EQ '0').ZG22Q                           01242200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01242300
                AIF   (T'&ZCGPR NE 'N').ZG22Q   INVALID REG NAME        01242400
.ZG22P          ANOP  ,                                                 01242500
                AIF   (T'&ZCGPR NE 'N').ZG22R   NON NUMERIC             01242600
                AIF   ('&ZCGPR' LT '2').ZG22Q                           01242700
                AIF   ('&ZCGPR' LE '12').ZG22R                          01242800
.ZG22Q          ANOP  ,                                                 01242900
&ZMS            SETC  '"MCSCSA='  *KGPRA* MNOTE                         01243000
&ZMS            SETC  '&ZMS.&MCSCSA"'                                   01243100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01243200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01243300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01243400
.ZG22R          ANOP  ,                                                 01243500
.*-------------------------------------------------------------------   01243600
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             01243700
                AIF   ('&XMF' EQ 'M').ZG25      BYPASS IF MF=M          01243800
.*----------------------------------------------------------------***   01243900
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    01244000
                AIF   (N'&MCSCSAA LE 1).ZG24A   CK NUM                  01244100
&ZMS            SETC  '"MCSCSAA='               *KPOSA* MNOTE           01244200
&ZMS            SETC  '&ZMS.&MCSCSAA"'                                  01244300
&ZMS            SETC  '&ZMS "MCSCSAA"'                                  01244400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01244500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01244600
.ZG24A          ANOP  ,                                                 01244700
.*-------------------------------------------------------------------   01244800
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        01244900
&ZXMCSCSAA      SETC  'OUTPUT'    SET IN/OUTPUT                         01245000
&XMCSCSAA       SETC  '&MCSCSAA(1)'             SET XVARIABLE           01245100
                AIF   (N'&MCSCSAA GT 1).ZG24B   MULTI PARMS             01245200
&XMCSCSAA       SETC  '&MCSCSAA'  SET XVARIABLE                         01245300
.ZG24B          AIF   (K'&MCSCSAA(1) GT 0).ZG24C                        01245400
&ZXMCSCSAA      SETC  ''          RESET IN/OUTPUT                       01245500
&ZMS            SETC  ' '         *KRQDA*                               01245600
&ZMS            SETC  '&ZMS "MCSCSAA" KEY AND ITS ARGUMENT'             01245700
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01245800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01245900
.ZG24C          ANOP  ,                                                 01246000
.*-------------------------------------------------------------------   01246100
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   01246200
                AIF   (K'&ZXMCSCSAA LE 0).ZG24R  NOT I/O                01246300
                AIF   ('&XMCSCSAA'(1,1) NE '(').ZG24R                   01246400
&ZCGPR          SETC  '&XMCSCSAA'(2,K'&XMCSCSAA-2)                      01246500
                AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                      01246600
                AIF   (K'&ZCGPR GT 2).ZG24Q                             01246700
                AIF   ('&ZCGPR' EQ '0').ZG24Q                           01246800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01246900
                AIF   (T'&ZCGPR NE 'N').ZG24Q   INVALID REG NAME        01247000
.ZG24P          ANOP  ,                                                 01247100
                AIF   (T'&ZCGPR NE 'N').ZG24R   NON NUMERIC             01247200
                AIF   ('&ZCGPR' LT '2').ZG24Q                           01247300
                AIF   ('&ZCGPR' LE '12').ZG24R                          01247400
.ZG24Q          ANOP  ,                                                 01247500
&ZMS            SETC  '"MCSCSAA='               *KGPRA* MNOTE           01247600
&ZMS            SETC  '&ZMS.&MCSCSAA"'                                  01247700
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01247800
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01247900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01248000
.ZG24R          ANOP  ,                                                 01248100
.*-------------------------------------------------------------------   01248200
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               01248300
.ZG25           ANOP  ,           END OF BYPASS CHECK                   01248400
.*-------------------------------------------------------------------   01248500
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               01248600
.ZG26           ANOP  ,           END OF BYPASS CHECK                   01248700
.*----------------------------------------------------------------***   01248800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01248900
                AIF   (N'&OPERPARM LE 1).ZG28A  CK NUM                  01249000
&ZMS            SETC  '"OPERPARM='              *KPOSA* MNOTE           01249100
&ZMS            SETC  '&ZMS.&OPERPARM"'                                 01249200
&ZMS            SETC  '&ZMS "OPERPARM"'                                 01250000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01251000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01252000
.ZG28A          ANOP  ,                                                 01253000
.*-------------------------------------------------------------------   01254000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01255000
&ZXOPERPARM     SETC  'INPUT'     SET IN/OUTPUT                         01256000
&XOPERPARM      SETC  '0'                                               01257000
                AIF   (K'&OPERPARM(1) LE 0).ZG28B  PARM                 01258000
&XOPERPARM      SETC  '&OPERPARM(1)'            SET XVARIABLE           01259000
                AIF   (N'&OPERPARM GT 1).ZG28B  MULTI PARMS             01260000
&XOPERPARM      SETC  '&OPERPARM'               SET XVARIABLE           01261000
.ZG28B          ANOP  ,                                                 01262000
.*-------------------------------------------------------------------   01263000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01264000
                AIF   (K'&ZXOPERPARM LE 0).ZG28R  NOT I/O               01265000
         AIF   ('&XOPERPARM' EQ '0').ZG28R                              01266000
                AIF   ('&XOPERPARM'(1,1) NE '(').ZG28R                  01267000
&ZCGPR          SETC  '&XOPERPARM'(2,K'&XOPERPARM-2)                    01268000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                      01269000
                AIF   (K'&ZCGPR GT 2).ZG28Q                             01270000
                AIF   ('&ZCGPR' EQ '0').ZG28Q                           01271000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01272000
                AIF   (T'&ZCGPR NE 'N').ZG28Q   INVALID REG NAME        01273000
.ZG28P          ANOP  ,                                                 01274000
                AIF   (T'&ZCGPR NE 'N').ZG28R   NON NUMERIC             01275000
                AIF   ('&ZCGPR' LT '2').ZG28Q                           01276000
                AIF   ('&ZCGPR' LE '12').ZG28R                          01277000
.ZG28Q          ANOP  ,                                                 01278000
&ZMS            SETC  '"OPERPARM='              *KGPRA* MNOTE           01279000
&ZMS            SETC  '&ZMS.&OPERPARM"'                                 01280000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01281000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01282000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01283000
.ZG28R          ANOP  ,                                                 01284000
.*------------------------------------------------------------------    01285000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01286000
&XMSGDLVRY      SETC  ''          INITIALIZE XVARIABLE                  01287000
.*-------------------------------------------------------------------   01288000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01289000
.ZG32           ANOP  ,                                                 01289800
                AIF   (K'&MSGDLVRY(1) LE 0).ZG32A                       01290600
&ZTLC           SETC 'FIFO'                                             01291600
                AIF   ('&MSGDLVRY(1)' NE '&ZTLC').ZG48                  01292300
&XMSGDLVRY      SETC  'FIFO'      SET KEYWORD                           01293000
                AIF   (N'&MSGDLVRY LE 1).ZG32A  CK NUM                  01294000
&ZMS            SETC  '"MSGDLVRY='              *KPOSA* MNOTE           01295000
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 01296000
&ZMS            SETC  '&ZMS "MSGDLVRY"'                                 01297000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01298000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01299000
.ZG32A          ANOP  ,                                                 01300000
.*----------------------------------------------------------------***   01301000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 01302000
                AIF   (N'&MSGECB LE 1).ZG34A    CK NUM                  01303000
&ZMS            SETC  '"MSGECB='  *KPOSA* MNOTE                         01304000
&ZMS            SETC  '&ZMS.&MSGECB"'                                   01305000
&ZMS            SETC  '&ZMS "MSGECB"'                                   01306000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01307000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01308000
.ZG34A          ANOP  ,                                                 01309000
.*-------------------------------------------------------------------   01310000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     01311000
&ZXMSGECB       SETC  'INPUT'     SET IN/OUTPUT                         01312000
&XMSGECB        SETC  '&MSGECB(1)'              SET XVARIABLE           01313000
                AIF   (N'&MSGECB GT 1).ZG34B    MULTI PARMS             01314000
&XMSGECB        SETC  '&MSGECB'   SET XVARIABLE                         01315000
.ZG34B          AIF   (K'&MSGECB(1) GT 0).ZG34C                         01316000
&ZXMSGECB       SETC  ''          RESET IN/OUTPUT                       01317000
&ZMS            SETC  ' '         *KRQDA*                               01318000
&ZMS            SETC  '&ZMS "MSGECB" KEY AND ITS ARGUMENT'              01319000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01320000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01321000
.ZG34C          ANOP  ,                                                 01322000
.*-------------------------------------------------------------------   01323000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                01324000
                AIF   (K'&ZXMSGECB LE 0).ZG34R  NOT I/O                 01325000
                AIF   ('&XMSGECB'(1,1) NE '(').ZG34R                    01326000
&ZCGPR          SETC  '&XMSGECB'(2,K'&XMSGECB-2)                        01327000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                      01337700
                AIF   (K'&ZCGPR GT 2).ZG34Q                             01348400
                AIF   ('&ZCGPR' EQ '0').ZG34Q                           01359100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01370000
                AIF   (T'&ZCGPR NE 'N').ZG34Q   INVALID REG NAME        01371000
.ZG34P          ANOP  ,                                                 01372000
                AIF   (T'&ZCGPR NE 'N').ZG34R   NON NUMERIC             01373000
                AIF   ('&ZCGPR' LT '2').ZG34Q                           01374000
                AIF   ('&ZCGPR' LE '12').ZG34R                          01375000
.ZG34Q          ANOP  ,                                                 01376000
&ZMS            SETC  '"MSGECB='  *KGPRA* MNOTE                         01377000
&ZMS            SETC  '&ZMS.&MSGECB"'                                   01378000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01379000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01380000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01381000
.ZG34R          ANOP  ,                                                 01382000
.*----------------------------------------------------------------***   01383000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01384000
                AIF   (N'&QLIMIT LE 1).ZG37A    CK NUM                  01385000
&ZMS            SETC  '"QLIMIT='  *KPOSA* MNOTE                         01386000
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   01387000
&ZMS            SETC  '&ZMS "QLIMIT"'                                   01388000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01389000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01390000
.ZG37A          ANOP  ,                                                 01391000
.*-------------------------------------------------------------------   01392000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01393000
&ZXQLIMIT       SETC  'INPUT'     SET IN/OUTPUT                         01394000
&XQLIMIT        SETC  '2147483647'                                      01395000
                AIF   (K'&QLIMIT(1) LE 0).ZG37B  PARM                   01396000
&XQLIMIT        SETC  '&QLIMIT(1)'              SET XVARIABLE           01397000
                AIF   (N'&QLIMIT GT 1).ZG37B    MULTI PARMS             01398000
&XQLIMIT        SETC  '&QLIMIT'   SET XVARIABLE                         01399000
.ZG37B          ANOP  ,                                                 01400000
.*-------------------------------------------------------------------   01401000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01402000
                AIF   (K'&ZXQLIMIT LE 0).ZG37R  NOT I/O                 01403200
                AIF   ('&XQLIMIT'(1,1) NE '(').ZG37R                    01404400
&ZCGPR          SETC  '&XQLIMIT'(2,K'&XQLIMIT-2)                        01405600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                      01454000
                AIF   (K'&ZCGPR GT 2).ZG37Q                             01455000
                AIF   ('&ZCGPR' EQ '0').ZG37Q                           01456000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01457000
                AIF   (T'&ZCGPR NE 'N').ZG37Q   INVALID REG NAME        01458000
.ZG37P          ANOP  ,                                                 01459000
                AIF   (T'&ZCGPR NE 'N').ZG37R   NON NUMERIC             01460000
                AIF   ('&ZCGPR' LT '2').ZG37Q                           01461000
                AIF   ('&ZCGPR' LE '12').ZG37R                          01462000
.ZG37Q          ANOP  ,                                                 01463000
&ZMS            SETC  '"QLIMIT='  *KGPRA* MNOTE                         01464000
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   01465000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01466000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01467000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01468000
.ZG37R          ANOP  ,                                                 01469000
.*----------------------------------------------------------------***   01470000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01471000
                AIF   (N'&ALERTECB LE 1).ZG40A  CK NUM                  01521000
&ZMS            SETC  '"ALERTECB='              *KPOSA* MNOTE           01645200
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 01645300
&ZMS            SETC  '&ZMS "ALERTECB"'                                 01645400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01645500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01645600
.ZG40A          ANOP  ,                                                 01645700
.*-------------------------------------------------------------------   01645800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01645900
&ZXALERTECB     SETC  'INPUT'     SET IN/OUTPUT                         01646000
&XALERTECB      SETC  '0'                                               01646100
                AIF   (K'&ALERTECB(1) LE 0).ZG40B  PARM                 01646200
&XALERTECB      SETC  '&ALERTECB(1)'            SET XVARIABLE           01646300
                AIF   (N'&ALERTECB GT 1).ZG40B  MULTI PARMS             01646400
&XALERTECB      SETC  '&ALERTECB'               SET XVARIABLE           01646500
.ZG40B          ANOP  ,                                                 01646600
.*-------------------------------------------------------------------   01646700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01646800
                AIF   (K'&ZXALERTECB LE 0).ZG40R  NOT I/O               01646900
         AIF   ('&XALERTECB' EQ '0').ZG40R                              01647000
                AIF   ('&XALERTECB'(1,1) NE '(').ZG40R                  01647100
&ZCGPR          SETC  '&XALERTECB'(2,K'&XALERTECB-2)                    01647200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                      01647300
                AIF   (K'&ZCGPR GT 2).ZG40Q                             01647400
                AIF   ('&ZCGPR' EQ '0').ZG40Q                           01647500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01647600
                AIF   (T'&ZCGPR NE 'N').ZG40Q   INVALID REG NAME        01647700
.ZG40P          ANOP  ,                                                 01647800
                AIF   (T'&ZCGPR NE 'N').ZG40R   NON NUMERIC             01647900
                AIF   ('&ZCGPR' LT '2').ZG40Q                           01648000
                AIF   ('&ZCGPR' LE '12').ZG40R                          01648100
.ZG40Q          ANOP  ,                                                 01648200
&ZMS            SETC  '"ALERTECB='              *KGPRA* MNOTE           01648300
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 01648400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01648500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01648600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01648700
.ZG40R          ANOP  ,                                                 01648800
.*----------------------------------------------------------------***   01648900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01649000
                AIF   (N'&ALERTPCT LE 1).ZG42A  CK NUM                  01649100
&ZMS            SETC  '"ALERTPCT='              *KPOSA* MNOTE           01649200
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 01649300
&ZMS            SETC  '&ZMS "ALERTPCT"'                                 01649400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01650000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01651000
.ZG42A          ANOP  ,                                                 01652000
.*-------------------------------------------------------------------   01653000
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         01654000
&XALERTPCT      SETC  '100'       SET DEFAULT                           01655000
                AIF   (K'&ALERTPCT(1) LE 0).ZG42C  PARM                 01656000
&XALERTPCT      SETC  '&ALERTPCT(1)'            SET XVARIABLE           01657000
                AIF   (N'&ALERTPCT GT 1).ZG42B  MULTI PARMS             01658000
&XALERTPCT      SETC  '&ALERTPCT'               SET XVARIABLE           01659000
.ZG42B          AIF   (K'&ALERTECB(1) GT 0).ZG42C  KEY                  01660000
&ZMS            SETC  '"ALERTPCT'               *KDEPA* MNOTE           01661000
&ZMS            SETC  '&ZMS.=&ALERTPCT"'                                01662000
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   01663000
&ZMS            SETC  '&ZMS '                                           01664000
&ZMS            SETC  '&ZMS "ALERTECB"'                                 01665000
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      01666000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01667000
.ZG42C          ANOP  ,                                                 01668000
&ZXALERTPCT     SETC  'INPUT'     SET IN/OUTPUT                         01669000
.*-------------------------------------------------------------------   01670000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01671000
                AIF   (K'&ZXALERTPCT LE 0).ZG42R  NOT I/O               01672000
                AIF   ('&XALERTPCT'(1,1) NE '(').ZG42R                  01673000
&ZCGPR          SETC  '&XALERTPCT'(2,K'&XALERTPCT-2)                    01674000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                      01674100
                AIF   (K'&ZCGPR GT 2).ZG42Q                             01674200
                AIF   ('&ZCGPR' EQ '0').ZG42Q                           01674300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01674400
                AIF   (T'&ZCGPR NE 'N').ZG42Q   INVALID REG NAME        01674500
.ZG42P          ANOP  ,                                                 01674600
                AIF   (T'&ZCGPR NE 'N').ZG42R   NON NUMERIC             01674700
                AIF   ('&ZCGPR' LT '2').ZG42Q                           01674800
                AIF   ('&ZCGPR' LE '12').ZG42R                          01674900
.ZG42Q          ANOP  ,                                                 01675000
&ZMS            SETC  '"ALERTPCT='              *KGPRA* MNOTE           01675100
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 01675200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01675300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01675400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01675500
.ZG42R          ANOP  ,                                                 01675600
.*----------------------------------------------------------------***   01675700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01675800
                AIF   (N'&QRESUME LE 1).ZG46A   CK NUM                  01675900
&ZMS            SETC  '"QRESUME='               *KPOSA* MNOTE           01676000
&ZMS            SETC  '&ZMS.&QRESUME"'                                  01676100
&ZMS            SETC  '&ZMS "QRESUME"'                                  01676200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01676300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01676400
.ZG46A          ANOP  ,                                                 01676500
.*-------------------------------------------------------------------   01676600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01676700
&ZXQRESUME      SETC  'INPUT'     SET IN/OUTPUT                         01676800
&XQRESUME       SETC  '0'                                               01676900
                AIF   (K'&QRESUME(1) LE 0).ZG46B  PARM                  01677000
&XQRESUME       SETC  '&QRESUME(1)'             SET XVARIABLE           01677100
                AIF   (N'&QRESUME GT 1).ZG46B   MULTI PARMS             01677200
&XQRESUME       SETC  '&QRESUME'  SET XVARIABLE                         01677300
.ZG46B          ANOP  ,                                                 01677400
.*-------------------------------------------------------------------   01677500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01677600
                AIF   (K'&ZXQRESUME LE 0).ZG46R  NOT I/O                01677700
         AIF   ('&XQRESUME' EQ '0').ZG46R                               01677800
                AIF   ('&XQRESUME'(1,1) NE '(').ZG46R                   01677900
&ZCGPR          SETC  '&XQRESUME'(2,K'&XQRESUME-2)                      01678000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                      01678100
                AIF   (K'&ZCGPR GT 2).ZG46Q                             01678200
                AIF   ('&ZCGPR' EQ '0').ZG46Q                           01678300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01678400
                AIF   (T'&ZCGPR NE 'N').ZG46Q   INVALID REG NAME        01678500
.ZG46P          ANOP  ,                                                 01678600
                AIF   (T'&ZCGPR NE 'N').ZG46R   NON NUMERIC             01678700
                AIF   ('&ZCGPR' LT '2').ZG46Q                           01678800
                AIF   ('&ZCGPR' LE '12').ZG46R                          01678900
.ZG46Q          ANOP  ,                                                 01679000
&ZMS            SETC  '"QRESUME='               *KGPRA* MNOTE           01679100
&ZMS            SETC  '&ZMS.&QRESUME"'                                  01679200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01679300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01679400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01679500
.ZG46R          ANOP  ,                                                 01679600
.*-------------------------------------------------------------------   01679700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01679800
.ZG48           ANOP  ,                                                 01679900
&ZTLC           SETC 'SEARCH'                                           01680000
                AIF   ('&MSGDLVRY(1)' NE '&ZTLC').ZG64                  01680100
&XMSGDLVRY      SETC  'SEARCH'    SET KEYWORD                           01680200
                AIF   (N'&MSGDLVRY LE 1).ZG48A  CK NUM                  01680300
&ZMS            SETC  '"MSGDLVRY='              *KPOSA* MNOTE           01680400
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 01680500
&ZMS            SETC  '&ZMS "MSGDLVRY"'                                 01680600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01680700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01680800
.ZG48A          ANOP  ,                                                 01680900
.*----------------------------------------------------------------***   01681000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 01681100
                AIF   (N'&MSGECB LE 1).ZG50A    CK NUM                  01681200
&ZMS            SETC  '"MSGECB='  *KPOSA* MNOTE                         01681300
&ZMS            SETC  '&ZMS.&MSGECB"'                                   01681400
&ZMS            SETC  '&ZMS "MSGECB"'                                   01681500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01681600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01681700
.ZG50A          ANOP  ,                                                 01681800
.*-------------------------------------------------------------------   01681900
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     01682000
&ZXMSGECB       SETC  'INPUT'     SET IN/OUTPUT                         01682100
&XMSGECB        SETC  '&MSGECB(1)'              SET XVARIABLE           01682200
                AIF   (N'&MSGECB GT 1).ZG50B    MULTI PARMS             01682300
&XMSGECB        SETC  '&MSGECB'   SET XVARIABLE                         01682400
.ZG50B          AIF   (K'&MSGECB(1) GT 0).ZG50C                         01682500
&ZXMSGECB       SETC  ''          RESET IN/OUTPUT                       01682600
&ZMS            SETC  ' '         *KRQDA*                               01682700
&ZMS            SETC  '&ZMS "MSGECB" KEY AND ITS ARGUMENT'              01682800
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01682900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01683000
.ZG50C          ANOP  ,                                                 01683100
.*-------------------------------------------------------------------   01683200
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                01683300
                AIF   (K'&ZXMSGECB LE 0).ZG50R  NOT I/O                 01683400
                AIF   ('&XMSGECB'(1,1) NE '(').ZG50R                    01683500
&ZCGPR          SETC  '&XMSGECB'(2,K'&XMSGECB-2)                        01683600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG50P                      01683700
                AIF   (K'&ZCGPR GT 2).ZG50Q                             01683800
                AIF   ('&ZCGPR' EQ '0').ZG50Q                           01683900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01684000
                AIF   (T'&ZCGPR NE 'N').ZG50Q   INVALID REG NAME        01684100
.ZG50P          ANOP  ,                                                 01684200
                AIF   (T'&ZCGPR NE 'N').ZG50R   NON NUMERIC             01684300
                AIF   ('&ZCGPR' LT '2').ZG50Q                           01684400
                AIF   ('&ZCGPR' LE '12').ZG50R                          01684500
.ZG50Q          ANOP  ,                                                 01684600
&ZMS            SETC  '"MSGECB='  *KGPRA* MNOTE                         01684700
&ZMS            SETC  '&ZMS.&MSGECB"'                                   01684800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01684900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01685000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01685100
.ZG50R          ANOP  ,                                                 01685200
.*----------------------------------------------------------------***   01685300
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01685400
                AIF   (N'&QLIMIT LE 1).ZG53A    CK NUM                  01685500
&ZMS            SETC  '"QLIMIT='  *KPOSA* MNOTE                         01685600
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   01685700
&ZMS            SETC  '&ZMS "QLIMIT"'                                   01685800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01685900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01686000
.ZG53A          ANOP  ,                                                 01686100
.*-------------------------------------------------------------------   01686200
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01686300
&ZXQLIMIT       SETC  'INPUT'     SET IN/OUTPUT                         01686400
&XQLIMIT        SETC  '2147483647'                                      01686500
                AIF   (K'&QLIMIT(1) LE 0).ZG53B  PARM                   01686600
&XQLIMIT        SETC  '&QLIMIT(1)'              SET XVARIABLE           01686700
                AIF   (N'&QLIMIT GT 1).ZG53B    MULTI PARMS             01686800
&XQLIMIT        SETC  '&QLIMIT'   SET XVARIABLE                         01686900
.ZG53B          ANOP  ,                                                 01687000
.*-------------------------------------------------------------------   01687100
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01687200
                AIF   (K'&ZXQLIMIT LE 0).ZG53R  NOT I/O                 01687300
                AIF   ('&XQLIMIT'(1,1) NE '(').ZG53R                    01687400
&ZCGPR          SETC  '&XQLIMIT'(2,K'&XQLIMIT-2)                        01687500
                AIF   ('&ZCGPR'(1,1) NE '0').ZG53P                      01687600
                AIF   (K'&ZCGPR GT 2).ZG53Q                             01687700
                AIF   ('&ZCGPR' EQ '0').ZG53Q                           01687800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01687900
                AIF   (T'&ZCGPR NE 'N').ZG53Q   INVALID REG NAME        01688000
.ZG53P          ANOP  ,                                                 01688100
                AIF   (T'&ZCGPR NE 'N').ZG53R   NON NUMERIC             01688200
                AIF   ('&ZCGPR' LT '2').ZG53Q                           01688300
                AIF   ('&ZCGPR' LE '12').ZG53R                          01688400
.ZG53Q          ANOP  ,                                                 01688500
&ZMS            SETC  '"QLIMIT='  *KGPRA* MNOTE                         01688600
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   01688700
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01688800
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01688900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01689000
.ZG53R          ANOP  ,                                                 01690000
.*----------------------------------------------------------------***   01691000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01692000
                AIF   (N'&ALERTECB LE 1).ZG56A  CK NUM                  01692100
&ZMS            SETC  '"ALERTECB='              *KPOSA* MNOTE           01692200
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 01692300
&ZMS            SETC  '&ZMS "ALERTECB"'                                 01692400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01692500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01692600
.ZG56A          ANOP  ,                                                 01692700
.*-------------------------------------------------------------------   01692800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01692900
&ZXALERTECB     SETC  'INPUT'     SET IN/OUTPUT                         01693000
&XALERTECB      SETC  '0'                                               01693100
                AIF   (K'&ALERTECB(1) LE 0).ZG56B  PARM                 01693200
&XALERTECB      SETC  '&ALERTECB(1)'            SET XVARIABLE           01693300
                AIF   (N'&ALERTECB GT 1).ZG56B  MULTI PARMS             01693400
&XALERTECB      SETC  '&ALERTECB'               SET XVARIABLE           01693500
.ZG56B          ANOP  ,                                                 01693600
.*-------------------------------------------------------------------   01693700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01693800
                AIF   (K'&ZXALERTECB LE 0).ZG56R  NOT I/O               01693900
         AIF   ('&XALERTECB' EQ '0').ZG56R                              01694000
                AIF   ('&XALERTECB'(1,1) NE '(').ZG56R                  01694100
&ZCGPR          SETC  '&XALERTECB'(2,K'&XALERTECB-2)                    01694200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG56P                      01694300
                AIF   (K'&ZCGPR GT 2).ZG56Q                             01694400
                AIF   ('&ZCGPR' EQ '0').ZG56Q                           01694500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01694600
                AIF   (T'&ZCGPR NE 'N').ZG56Q   INVALID REG NAME        01694700
.ZG56P          ANOP  ,                                                 01694800
                AIF   (T'&ZCGPR NE 'N').ZG56R   NON NUMERIC             01694900
                AIF   ('&ZCGPR' LT '2').ZG56Q                           01695000
                AIF   ('&ZCGPR' LE '12').ZG56R                          01695100
.ZG56Q          ANOP  ,                                                 01695200
&ZMS            SETC  '"ALERTECB='              *KGPRA* MNOTE           01695300
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 01695400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01695500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01695600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01695700
.ZG56R          ANOP  ,                                                 01695800
.*----------------------------------------------------------------***   01695900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01696000
                AIF   (N'&ALERTPCT LE 1).ZG58A  CK NUM                  01696100
&ZMS            SETC  '"ALERTPCT='              *KPOSA* MNOTE           01696200
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 01696300
&ZMS            SETC  '&ZMS "ALERTPCT"'                                 01696400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01696500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01696600
.ZG58A          ANOP  ,                                                 01696700
.*-------------------------------------------------------------------   01696800
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         01696900
&XALERTPCT      SETC  '100'       SET DEFAULT                           01697000
                AIF   (K'&ALERTPCT(1) LE 0).ZG58C  PARM                 01697100
&XALERTPCT      SETC  '&ALERTPCT(1)'            SET XVARIABLE           01697200
                AIF   (N'&ALERTPCT GT 1).ZG58B  MULTI PARMS             01697300
&XALERTPCT      SETC  '&ALERTPCT'               SET XVARIABLE           01697400
.ZG58B          AIF   (K'&ALERTECB(1) GT 0).ZG58C  KEY                  01697500
&ZMS            SETC  '"ALERTPCT'               *KDEPA* MNOTE           01697600
&ZMS            SETC  '&ZMS.=&ALERTPCT"'                                01697700
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   01697800
&ZMS            SETC  '&ZMS '                                           01697900
&ZMS            SETC  '&ZMS "ALERTECB"'                                 01698000
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      01698100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01698200
.ZG58C          ANOP  ,                                                 01698300
&ZXALERTPCT     SETC  'INPUT'     SET IN/OUTPUT                         01698400
.*-------------------------------------------------------------------   01698500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01698600
                AIF   (K'&ZXALERTPCT LE 0).ZG58R  NOT I/O               01698700
                AIF   ('&XALERTPCT'(1,1) NE '(').ZG58R                  01698800
&ZCGPR          SETC  '&XALERTPCT'(2,K'&XALERTPCT-2)                    01698900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG58P                      01699000
                AIF   (K'&ZCGPR GT 2).ZG58Q                             01699100
                AIF   ('&ZCGPR' EQ '0').ZG58Q                           01699200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01699300
                AIF   (T'&ZCGPR NE 'N').ZG58Q   INVALID REG NAME        01699400
.ZG58P          ANOP  ,                                                 01699500
                AIF   (T'&ZCGPR NE 'N').ZG58R   NON NUMERIC             01699600
                AIF   ('&ZCGPR' LT '2').ZG58Q                           01699700
                AIF   ('&ZCGPR' LE '12').ZG58R                          01699800
.ZG58Q          ANOP  ,                                                 01699900
&ZMS            SETC  '"ALERTPCT='              *KGPRA* MNOTE           01700000
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 01700100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01700200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01700300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01700400
.ZG58R          ANOP  ,                                                 01700500
.*----------------------------------------------------------------***   01700600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01700700
                AIF   (N'&QRESUME LE 1).ZG62A   CK NUM                  01700800
&ZMS            SETC  '"QRESUME='               *KPOSA* MNOTE           01700900
&ZMS            SETC  '&ZMS.&QRESUME"'                                  01701000
&ZMS            SETC  '&ZMS "QRESUME"'                                  01701100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01701200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01701300
.ZG62A          ANOP  ,                                                 01701400
.*-------------------------------------------------------------------   01701500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01701600
&ZXQRESUME      SETC  'INPUT'     SET IN/OUTPUT                         01702000
&XQRESUME       SETC  '0'                                               01703000
                AIF   (K'&QRESUME(1) LE 0).ZG62B  PARM                  01704000
&XQRESUME       SETC  '&QRESUME(1)'             SET XVARIABLE           01705000
                AIF   (N'&QRESUME GT 1).ZG62B   MULTI PARMS             01706000
&XQRESUME       SETC  '&QRESUME'  SET XVARIABLE                         01707000
.ZG62B          ANOP  ,                                                 01708000
.*-------------------------------------------------------------------   01709000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01710000
                AIF   (K'&ZXQRESUME LE 0).ZG62R  NOT I/O                01711000
         AIF   ('&XQRESUME' EQ '0').ZG62R                               01712000
                AIF   ('&XQRESUME'(1,1) NE '(').ZG62R                   01713000
&ZCGPR          SETC  '&XQRESUME'(2,K'&XQRESUME-2)                      01714000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG62P                      01715000
                AIF   (K'&ZCGPR GT 2).ZG62Q                             01716000
                AIF   ('&ZCGPR' EQ '0').ZG62Q                           01717000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01718000
                AIF   (T'&ZCGPR NE 'N').ZG62Q   INVALID REG NAME        01719000
.ZG62P          ANOP  ,                                                 01720000
                AIF   (T'&ZCGPR NE 'N').ZG62R   NON NUMERIC             01721000
                AIF   ('&ZCGPR' LT '2').ZG62Q                           01722000
                AIF   ('&ZCGPR' LE '12').ZG62R                          01723000
.ZG62Q          ANOP  ,                                                 01724000
&ZMS            SETC  '"QRESUME='               *KGPRA* MNOTE           01725000
&ZMS            SETC  '&ZMS.&QRESUME"'                                  01726000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01727000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01728000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01729000
.ZG62R          ANOP  ,                                                 01730000
.*-------------------------------------------------------------------   01731000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01732000
.ZG64           ANOP  ,                                                 01732800
&ZTLC           SETC 'NONE'                                             01733600
                AIF   ('&MSGDLVRY(1)' NE '&ZTLC').ZG65                  01734300
&XMSGDLVRY      SETC  'NONE'      SET KEYWORD                           01735000
                AIF   (N'&MSGDLVRY LE 1).ZG64A  CK NUM                  01736000
&ZMS            SETC  '"MSGDLVRY='              *KPOSA* MNOTE           01737000
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 01738000
&ZMS            SETC  '&ZMS "MSGDLVRY"'                                 01739000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01740000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01741000
.ZG64A          ANOP  ,                                                 01742000
.*------------------------------------------------------------------    01743000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01744000
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           01745000
.ZG64A0         AIF   (K'&MSGECB LE 0).ZG64A1   OK                      01746000
&ZCVAL          SETC '&ZCVAL MSGECB'            INCORRECT KEY USED      01747000
.ZG64A1         AIF   (K'&QLIMIT LE 0).ZG64A2   OK                      01748000
&ZCVAL          SETC '&ZCVAL QLIMIT'            INCORRECT KEY USED      01749000
.ZG64A2         AIF   (K'&ALERTECB LE 0).ZG64A3  OK                     01750000
&ZCVAL          SETC '&ZCVAL ALERTECB'          INCORRECT KEY USED      01751000
.ZG64A3         AIF   (K'&ALERTPCT LE 0).ZG64A4  OK                     01752000
&ZCVAL          SETC '&ZCVAL ALERTPCT'          INCORRECT KEY USED      01753000
.ZG64A4         AIF   (K'&QRESUME LE 0).ZG64A5  OK                      01754000
&ZCVAL          SETC '&ZCVAL QRESUME'           INCORRECT KEY USED      01755000
.ZG64A5         AIF   (K'&ZCVAL LE 0).ZG64A6    OK                      01756000
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             01757000
&ZMS            SETC  '"MSGDLVRY'               *KMEIA* MNOTE           01758000
&ZMS            SETC  '&ZMS.=&MSGDLVRY"'                                01759000
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              01760000
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              01761000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01762000
.ZG64A6         ANOP  ,                                                 01763000
.*------------------------------------------------------------------    01764000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01765000
.ZG65           ANOP  ,                                                 01766000
&ZXMSGDLVRY     SETC  'INPUT'     SET IN/OUTPUT                         01767000
                AIF   (K'&XMSGDLVRY GT 0).ZG65E  VALID ARG              01768000
                AIF   (T'&MSGDLVRY EQ 'O').ZG65D  OMITTED               01769000
&ZASYSLNDX      SETA  0                                                 01770000
.ZG65A          ANOP  ,           POSITIONAL MACRO KEY                  01771000
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      01772000
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG65C                  01772800
&ZTLC           SETC 'MSGDLVRY'                                         01773600
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG65A         01774400
.ZG65B          ANOP  ,                                                 01775200
&ZXMSGDLVRY     SETC  ''          RESET IN/OUTPUT                       01776000
&ZMS            SETC  'THE "MSGDLVRY" KEY'      *KOPTA* MNOTE           01777000
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           01778000
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  01779000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01780000
                AGO   .ZG65E                                            01781000
.ZG65C          ANOP  ,                                                 01782000
&ZXMSGDLVRY     SETC  ''          RESET IN/OUTPUT                       01783000
&ZMS            SETC  '"MSGDLVRY='              *KUKWA* MNOTE           01784000
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 01785000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         01786000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               01787000
&ZMS            SETC  '&ZMS "FIFO",'                                    01787800
&ZMS            SETC  '&ZMS "SEARCH",'                                  01788600
&ZMS            SETC  '&ZMS OR "NONE".'                                 01789400
                MNOTE 8,' &ZMS '                                        01790200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01791000
                AGO   .ZG65E                                            01792000
.ZG65D          ANOP  ,                                                 01793000
&XMSGDLVRY      SETC  'FIFO'      SET DEFAULT KEYWORD                   01794000
.ZG65E          ANOP  ,                                                 01795000
.*-------------------------------------------------------------------   01796000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01797000
.ZG66           ANOP  ,                                                 01797800
&ZTLC           SETC 'DEACTIVATE'                                       01798600
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZG75                   01799300
&XREQUEST       SETC  'DEACTIVATE'              SET KEYWORD             01800000
                AIF   (N'&REQUEST LE 1).ZG66A   CK NUM                  01801000
&ZMS            SETC  '"REQUEST='               *KPOSA* MNOTE           01802000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  01803000
&ZMS            SETC  '&ZMS "REQUEST"'                                  01804000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01805000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01806000
.ZG66A          ANOP  ,                                                 01807000
.*------------------------------------------------------------------    01808000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01809000
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           01810000
.ZG66A0         AIF   (K'&NAME LE 0).ZG66A1     OK                      01811000
&ZCVAL          SETC '&ZCVAL NAME'              INCORRECT KEY USED      01812000
.ZG66A1         AIF   (K'&MIGID LE 0).ZG66A2    OK                      01823000
&ZCVAL          SETC '&ZCVAL MIGID'             INCORRECT KEY USED      01834000
.ZG66A2         AIF   (K'&MIGIDREL LE 0).ZG66A3  OK                     01834100
&ZCVAL          SETC '&ZCVAL MIGIDREL'          INCORRECT KEY USED      01834200
.ZG66A3         AIF   (K'&TERMNAME LE 0).ZG66A4  OK                     01834300
&ZCVAL          SETC '&ZCVAL TERMNAME'          INCORRECT KEY USED      01834400
.ZG66A4         AIF   (K'&MCSCSA LE 0).ZG66A5   OK                      01834500
&ZCVAL          SETC '&ZCVAL MCSCSA'            INCORRECT KEY USED      01834600
.ZG66A5         AIF   (K'&MCSCSAA LE 0).ZG66A6  OK                      01834700
&ZCVAL          SETC '&ZCVAL MCSCSAA'           INCORRECT KEY USED      01834800
.ZG66A6         AIF   (K'&OPERPARM LE 0).ZG66A7  OK                     01834900
&ZCVAL          SETC '&ZCVAL OPERPARM'          INCORRECT KEY USED      01835000
.ZG66A7         AIF   (K'&MSGDLVRY LE 0).ZG66A8  OK                     01835100
&ZCVAL          SETC '&ZCVAL MSGDLVRY'          INCORRECT KEY USED      01835200
.ZG66A8         AIF   (K'&MSGECB LE 0).ZG66A9   OK                      01835300
&ZCVAL          SETC '&ZCVAL MSGECB'            INCORRECT KEY USED      01835400
.ZG66A9         AIF   (K'&QLIMIT LE 0).ZG66A10  OK                      01835500
&ZCVAL          SETC '&ZCVAL QLIMIT'            INCORRECT KEY USED      01835600
.ZG66A10        AIF   (K'&ALERTECB LE 0).ZG66A11  OK                    01835700
&ZCVAL          SETC '&ZCVAL ALERTECB'          INCORRECT KEY USED      01835800
.ZG66A11        AIF   (K'&ALERTPCT LE 0).ZG66A12  OK                    01835900
&ZCVAL          SETC '&ZCVAL ALERTPCT'          INCORRECT KEY USED      01836000
.ZG66A12        AIF   (K'&QRESUME LE 0).ZG66A13  OK                     01836100
&ZCVAL          SETC '&ZCVAL QRESUME'           INCORRECT KEY USED      01836200
.ZG66A13        AIF   (K'&ZCVAL LE 0).ZG66A14   OK                      01836300
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             01836400
&ZMS            SETC  '"REQUEST'  *KMEIA* MNOTE                         01837000
&ZMS            SETC  '&ZMS.=&REQUEST"'                                 01838000
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              01839000
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              01840000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01841000
.ZG66A14        ANOP  ,                                                 01842000
.*----------------------------------------------------------------***   01843000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01844000
                AIF   (N'&CONSID LE 1).ZG68A    CK NUM                  01845000
&ZMS            SETC  '"CONSID='  *KPOSA* MNOTE                         01846000
&ZMS            SETC  '&ZMS.&CONSID"'                                   01847000
&ZMS            SETC  '&ZMS "CONSID"'                                   01848000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01849000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01850000
.ZG68A          ANOP  ,                                                 01851000
.*-------------------------------------------------------------------   01852000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01853000
&ZXCONSID       SETC  'INPUT'     SET IN/OUTPUT                         01854000
&XCONSID        SETC  '&CONSID(1)'              SET XVARIABLE           01855000
                AIF   (N'&CONSID GT 1).ZG68B    MULTI PARMS             01856000
&XCONSID        SETC  '&CONSID'   SET XVARIABLE                         01857000
.ZG68B          AIF   (K'&CONSID(1) GT 0).ZG68C                         01858000
&ZXCONSID       SETC  ''          RESET IN/OUTPUT                       01859000
&ZMS            SETC  ' '         *KRQDA*                               01860000
&ZMS            SETC  '&ZMS "CONSID" KEY AND ITS ARGUMENT'              01861000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01862000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01863000
.ZG68C          ANOP  ,                                                 01864000
.*-------------------------------------------------------------------   01865000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01866000
                AIF   (K'&ZXCONSID LE 0).ZG68R  NOT I/O                 01867000
                AIF   ('&XCONSID'(1,1) NE '(').ZG68R                    01868000
&ZCGPR          SETC  '&XCONSID'(2,K'&XCONSID-2)                        01869000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG68P                      01870000
                AIF   (K'&ZCGPR GT 2).ZG68Q                             01871000
                AIF   ('&ZCGPR' EQ '0').ZG68Q                           01872000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01873000
                AIF   (T'&ZCGPR NE 'N').ZG68Q   INVALID REG NAME        01874000
.ZG68P          ANOP  ,                                                 01875000
                AIF   (T'&ZCGPR NE 'N').ZG68R   NON NUMERIC             01876000
                AIF   ('&ZCGPR' LT '2').ZG68Q                           01877000
                AIF   ('&ZCGPR' LE '12').ZG68R                          01878000
.ZG68Q          ANOP  ,                                                 01879000
&ZMS            SETC  '"CONSID='  *KGPRA* MNOTE                         01880000
&ZMS            SETC  '&ZMS.&CONSID"'                                   01881000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         01882000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  01883000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01884000
.ZG68R          ANOP  ,                                                 01885000
.*----------------------------------------------------------------***   01886000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01887000
                AIF   (N'&ABTERM LE 1).ZG71A    CK NUM                  01888000
&ZMS            SETC  '"ABTERM='  *KPOSA* MNOTE                         01889000
&ZMS            SETC  '&ZMS.&ABTERM"'                                   01890000
&ZMS            SETC  '&ZMS "ABTERM"'                                   01891000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01892000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01893000
.ZG71A          ANOP  ,                                                 01894000
.*-------------------------------------------------------------------   01895000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01896000
&XABTERM        SETC  ''          INITIALIZE XVARIABLE                  01897000
.ZG72A   AIF   ('&ABTERM(1)' NE 'NO').ZG73A                             01898000
&XABTERM        SETC  'NO'        SET KEYWORD                           01899000
.*-------------------------------------------------------------------   01900000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01901000
.ZG73A   AIF   ('&ABTERM(1)' NE 'YES').ZG74A                            01902000
&XABTERM        SETC  'YES'       SET KEYWORD                           01903000
.*-------------------------------------------------------------------   01904000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01905000
.ZG74A          AIF   (K'&XABTERM GT 0).ZG74C   KEYWORD                 01906000
                AIF   (K'&ABTERM(1) LE 0).ZG74B                         01907000
&ZMS            SETC  '"ABTERM='  *KUKWA* MNOTE                         01908000
&ZMS            SETC  '&ZMS.&ABTERM"'                                   01909000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         01910000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               01911000
&ZMS            SETC  '&ZMS "NO"'                                       01911700
&ZMS            SETC  '&ZMS OR "YES".'                                  01912400
                MNOTE 8,' &ZMS '                                        01913200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01914000
.ZG74B          ANOP  ,                                                 01915000
&XABTERM        SETC  'NO'        SET DEFAULT KEYWORD                   01916000
.ZG74C          ANOP  ,                                                 01917000
&ZXABTERM       SETC  'INPUT'     SET IN/OUTPUT                         01918000
.*-------------------------------------------------------------------   01919000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01920000
.ZG75           ANOP  ,                                                 01920800
&ZTLC           SETC 'RELEASE'                                          01921600
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZG79                   01922300
&XREQUEST       SETC  'RELEASE'   SET KEYWORD                           01923000
                AIF   (N'&REQUEST LE 1).ZG75A   CK NUM                  01924000
&ZMS            SETC  '"REQUEST='               *KPOSA* MNOTE           01925000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  01926000
&ZMS            SETC  '&ZMS "REQUEST"'                                  01927000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01928000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01929000
.ZG75A          ANOP  ,                                                 01930000
.*------------------------------------------------------------------    01931000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01932000
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           01933000
.ZG75A0         AIF   (K'&NAME LE 0).ZG75A1     OK                      01934000
&ZCVAL          SETC '&ZCVAL NAME'              INCORRECT KEY USED      01935000
.ZG75A1         AIF   (K'&CONSID LE 0).ZG75A2   OK                      01936000
&ZCVAL          SETC '&ZCVAL CONSID'            INCORRECT KEY USED      01937000
.ZG75A2         AIF   (K'&MIGIDREL LE 0).ZG75A3  OK                     01937500
&ZCVAL          SETC '&ZCVAL MIGIDREL'          INCORRECT KEY USED      01938000
.ZG75A3         AIF   (K'&TERMNAME LE 0).ZG75A4  OK                     01938500
&ZCVAL          SETC '&ZCVAL TERMNAME'          INCORRECT KEY USED      01939000
.ZG75A4         AIF   (K'&MCSCSA LE 0).ZG75A5   OK                      01940000
&ZCVAL          SETC '&ZCVAL MCSCSA'            INCORRECT KEY USED      01941000
.ZG75A5         AIF   (K'&MCSCSAA LE 0).ZG75A6  OK                      01942000
&ZCVAL          SETC '&ZCVAL MCSCSAA'           INCORRECT KEY USED      01943000
.ZG75A6         AIF   (K'&OPERPARM LE 0).ZG75A7  OK                     01944000
&ZCVAL          SETC '&ZCVAL OPERPARM'          INCORRECT KEY USED      01945000
.ZG75A7         AIF   (K'&MSGDLVRY LE 0).ZG75A8  OK                     01946000
&ZCVAL          SETC '&ZCVAL MSGDLVRY'          INCORRECT KEY USED      01947000
.ZG75A8         AIF   (K'&MSGECB LE 0).ZG75A9   OK                      01948000
&ZCVAL          SETC '&ZCVAL MSGECB'            INCORRECT KEY USED      01949000
.ZG75A9         AIF   (K'&QLIMIT LE 0).ZG75A10  OK                      01950000
&ZCVAL          SETC '&ZCVAL QLIMIT'            INCORRECT KEY USED      01951000
.ZG75A10        AIF   (K'&ALERTECB LE 0).ZG75A11  OK                    01952000
&ZCVAL          SETC '&ZCVAL ALERTECB'          INCORRECT KEY USED      01953000
.ZG75A11        AIF   (K'&ALERTPCT LE 0).ZG75A12  OK                    01954000
&ZCVAL          SETC '&ZCVAL ALERTPCT'          INCORRECT KEY USED      01955000
.ZG75A12        AIF   (K'&QRESUME LE 0).ZG75A13  OK                     01956000
&ZCVAL          SETC '&ZCVAL QRESUME'           INCORRECT KEY USED      01957000
.ZG75A13        AIF   (K'&ABTERM LE 0).ZG75A14  OK                      01958000
&ZCVAL          SETC '&ZCVAL ABTERM'            INCORRECT KEY USED      01959000
.ZG75A14        AIF   (K'&ZCVAL LE 0).ZG75A15   OK                      01960000
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             01961000
&ZMS            SETC  '"REQUEST'  *KMEIA* MNOTE                         01962000
&ZMS            SETC  '&ZMS.=&REQUEST"'                                 01963000
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              01964000
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              01965000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01966000
.ZG75A15        ANOP  ,                                                 01967000
.*----------------------------------------------------------------***   01968000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01969000
                AIF   (N'&MIGID LE 1).ZG77A     CK NUM                  01970000
&ZMS            SETC  '"MIGID='   *KPOSA* MNOTE                         01971000
&ZMS            SETC  '&ZMS.&MIGID"'                                    01972000
&ZMS            SETC  '&ZMS "MIGID"'                                    01973000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               01974000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01975000
.ZG77A          ANOP  ,                                                 01976000
.*-------------------------------------------------------------------   01977000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01978000
&ZXMIGID        SETC  'INPUT'     SET IN/OUTPUT                         01979000
&XMIGID         SETC  '&MIGID(1)'               SET XVARIABLE           01980000
                AIF   (N'&MIGID GT 1).ZG77B     MULTI PARMS             01981000
&XMIGID         SETC  '&MIGID'    SET XVARIABLE                         01982000
.ZG77B          AIF   (K'&MIGID(1) GT 0).ZG77C                          01983000
&ZXMIGID        SETC  ''          RESET IN/OUTPUT                       01984000
&ZMS            SETC  ' '         *KRQDA*                               01985000
&ZMS            SETC  '&ZMS "MIGID" KEY AND ITS ARGUMENT'               01986000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           01987000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           01988000
.ZG77C          ANOP  ,                                                 01989000
.*-------------------------------------------------------------------   01990000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01991000
                AIF   (K'&ZXMIGID LE 0).ZG77R   NOT I/O                 01992000
                AIF   ('&XMIGID'(1,1) NE '(').ZG77R                     01993000
&ZCGPR          SETC  '&XMIGID'(2,K'&XMIGID-2)                          01994000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG77P                      01995000
                AIF   (K'&ZCGPR GT 2).ZG77Q                             01996000
                AIF   ('&ZCGPR' EQ '0').ZG77Q                           01997000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     01998000
                AIF   (T'&ZCGPR NE 'N').ZG77Q   INVALID REG NAME        01999000
.ZG77P          ANOP  ,                                                 02000000
                AIF   (T'&ZCGPR NE 'N').ZG77R   NON NUMERIC             02001000
                AIF   ('&ZCGPR' LT '2').ZG77Q                           02002000
                AIF   ('&ZCGPR' LE '12').ZG77R                          02003000
.ZG77Q          ANOP  ,                                                 02004000
&ZMS            SETC  '"MIGID='   *KGPRA* MNOTE                         02005000
&ZMS            SETC  '&ZMS.&MIGID"'                                    02006000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02007000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02008000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02009000
.ZG77R          ANOP  ,                                                 02010000
.*------------------------------------------------------------------    02011000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02012000
.ZG79           ANOP  ,                                                 02013000
&ZXREQUEST      SETC  'INPUT'     SET IN/OUTPUT                         02014000
                AIF   (K'&XREQUEST GT 0).ZG79E  VALID ARG               02015000
                AIF   (T'&REQUEST EQ 'O').ZG79D  OMITTED                02016000
&ZASYSLNDX      SETA  0                                                 02017000
.ZG79A          ANOP  ,           POSITIONAL MACRO KEY                  02018000
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      02019000
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG79C                  02019800
&ZTLC           SETC 'REQUEST'                                          02020600
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG79A         02021400
.ZG79B          ANOP  ,                                                 02022200
&ZXREQUEST      SETC  ''          RESET IN/OUTPUT                       02023000
&ZMS            SETC  'THE "REQUEST" KEY'       *KOPTA* MNOTE           02024000
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           02025000
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  02026000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02027000
                AGO   .ZG79E                                            02028000
.ZG79C          ANOP  ,                                                 02029000
&ZXREQUEST      SETC  ''          RESET IN/OUTPUT                       02030000
&ZMS            SETC  '"REQUEST='               *KUKWA* MNOTE           02031000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  02032000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         02033000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               02034000
&ZMS            SETC  '&ZMS "ACTIVATE",'                                02034800
&ZMS            SETC  '&ZMS "DEACTIVATE",'                              02035600
&ZMS            SETC  '&ZMS OR "RELEASE".'                              02036400
                MNOTE 8,' &ZMS '                                        02037200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02038000
                AGO   .ZG79E                                            02039000
.ZG79D          ANOP  ,                                                 02040000
&XREQUEST       SETC  'ACTIVATE'  SET DEFAULT KEYWORD                   02041000
.ZG79E          ANOP  ,                                                 02042000
.*------------------------------------------------------------------    02043000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02044000
                AIF   (K'&REQUEST(1) GT 0).ZG79F  PARM                  02045000
&XREQUEST       SETC  ''          ENSURE NULL KEYWORD                   02046000
&ZXREQUEST      SETC  ''          RESET IN/OUTPUT                       02047000
&ZMS            SETC  'THE'                                             02048000
&ZMS            SETC  '&ZMS "REQUEST" KEY AND ITS ARGUMENT'             02049000
&ZMS            SETC  '&ZMS ARE REQUIRED.'                              02050000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               02051000
&ZMS            SETC  '&ZMS "ACTIVATE",'                                02051800
&ZMS            SETC  '&ZMS "DEACTIVATE",'                              02052600
&ZMS            SETC  '&ZMS OR "RELEASE".'                              02053400
                MNOTE 8,' &ZMS '                                        02054200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02055000
.ZG79F          ANOP  ,                                                 02056000
.*-------------------------------------------------------------------   02057000
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             02058000
                AIF   ('&XMF' EQ 'M').ZG82      BYPASS IF MF=M          02059000
.*----------------------------------------------------------------***   02060000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    02061000
                AIF   (N'&RTNCODE LE 1).ZG81A   CK NUM                  02062000
&ZMS            SETC  '"RTNCODE='               *KPOSA* MNOTE           02063000
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  02064000
&ZMS            SETC  '&ZMS "RTNCODE"'                                  02065000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02066000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02067000
.ZG81A          ANOP  ,                                                 02088500
.*-------------------------------------------------------------------   02110000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        02111000
                AIF   (K'&RTNCODE(1) LE 0).ZG81C  NO PARM               02112000
&ZXRTNCODE      SETC  'OUTPUT'    SET OUTPUT                            02113000
&XRTNCODE       SETC  '&RTNCODE(1)'             SET XVARIABLE           02114000
                AIF   (N'&RTNCODE GT 1).ZG81C                           02115000
&XRTNCODE       SETC  '&RTNCODE'  SET XVARIABLE                         02116000
.ZG81C          ANOP  ,                                                 02117000
.*-------------------------------------------------------------------   02118000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   02119000
                AIF   (K'&ZXRTNCODE LE 0).ZG81R  NOT I/O                02120000
                AIF   ('&XRTNCODE'(1,1) NE '(').ZG81R                   02121000
&ZCGPR          SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                      02122000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG81P                      02123000
                AIF   (K'&ZCGPR GT 2).ZG81Q                             02124000
                AIF   ('&ZCGPR' EQ '0').ZG81Q                           02125000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02126000
                AIF   (T'&ZCGPR NE 'N').ZG81Q   INVALID REG NAME        02126800
.ZG81P          ANOP  ,                                                 02127600
                AIF   (T'&ZCGPR NE 'N').ZG81R   NON NUMERIC             02128400
                AIF   ('&ZCGPR' LT '2').ZG81Q                           02129200
                AIF   ('&ZCGPR' LE '12').ZG81R                          02130000
.ZG81Q          ANOP  ,                                                 02130800
&ZMS            SETC  '"RTNCODE='               *KGPRA* MNOTE           02132100
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  02132200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02132300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02132400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02132500
.ZG81R          ANOP  ,                                                 02132600
.*-------------------------------------------------------------------   02132700
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               02132800
.ZG82           ANOP  ,           END OF BYPASS CHECK                   02132900
.*----------------------------------------------------------------***   02133000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    02133100
                AIF   (N'&RSNCODE LE 1).ZG84A   CK NUM                  02133200
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           02133300
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  02133400
&ZMS            SETC  '&ZMS "RSNCODE"'                                  02133500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02133600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02133700
.ZG84A          ANOP  ,                                                 02133800
.*-------------------------------------------------------------------   02133900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        02134000
                AIF   (K'&RSNCODE(1) LE 0).ZG84C  NO PARM               02134100
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            02134200
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           02134300
                AIF   (N'&RSNCODE GT 1).ZG84C                           02134400
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         02134500
.ZG84C          ANOP  ,                                                 02134600
.*-------------------------------------------------------------------   02134700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   02134800
                AIF   (K'&ZXRSNCODE LE 0).ZG84R  NOT I/O                02134900
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG84R                   02135000
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      02135100
                AIF   ('&ZCGPR'(1,1) NE '0').ZG84P                      02135200
                AIF   (K'&ZCGPR GT 2).ZG84Q                             02135300
                AIF   ('&ZCGPR' EQ '0').ZG84Q                           02135400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02135500
                AIF   (T'&ZCGPR NE 'N').ZG84Q   INVALID REG NAME        02135600
.ZG84P          ANOP  ,                                                 02135700
                AIF   (T'&ZCGPR NE 'N').ZG84R   NON NUMERIC             02135800
                AIF   ('&ZCGPR' LT '2').ZG84Q                           02135900
                AIF   ('&ZCGPR' LE '12').ZG84R                          02136000
.ZG84Q          ANOP  ,                                                 02136100
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           02136200
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  02136300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02136400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02136500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02137000
.ZG84R          ANOP  ,                                                 02138000
.******************************************************************     02139000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        02140000
.******************************************************************     02141000
                ACTR  10000                                             02142000
.*----------------------------------------------------------------***   02143000
.***AH.P02 EXTRA POSITIONALS                                            02144000
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              02145000
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              02145200
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          02145400
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           02145600
.ZGLISTX1       ANOP  ,                                                 02145800
&ZCVAL          SETC  ''          ERROR FIELD                           02146000
&ZAWRK          SETA  0           POSITIONAL NUMBER                     02147000
.ZGLIST2        ANOP  ,                                                 02148000
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       02149000
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              02150000
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   02151000
                AGO   .ZGLIST2                                          02152000
.*                                                                      02153000
.ZGLIST3        ANOP  ,                                                 02154000
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             02155000
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          02156000
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   02157000
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            02158000
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    02159000
                MNOTE 8,' &ZMS ARE ALLOWED.'                            02160000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02161000
.ZGLISTX        ANOP  ,                                                 02162000
&ZASYSLNDX      SETA  0                                                 02163000
.*-------------------------------------------------------------------   02164000
.***AG.MF04 MF=(SLME)                                                   02165000
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              02166000
.********************************************************************   02167000
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             02168000
.********************************************************************   02169000
                ACTR  10000                                             02170000
.*-------------------------------------------------------------------   02171000
.***AE.MF01 MF=(SLME)                                                   02172000
                AIF   ('&XMF' EQ 'L').ZEMFX                             02173000
                AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                    02174000
.********************************************************************   02174700
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        02175400
.********************************************************************   02176100
&XREQUEST       SETC  ''          INITIALIZE XVARIABLE                  02177000
&XMIGIDREL      SETC  ''          INITIALIZE XVARIABLE                  02177100
&XMSGDLVRY      SETC  ''          INITIALIZE XVARIABLE                  02177300
&XABTERM        SETC  ''          INITIALIZE XVARIABLE                  02177600
.*-------------------------------------------------------------------   02178000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02179000
&ZTLC           SETC 'ACTIVATE'                                         02179600
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A                   02180200
&XREQUEST       SETC  'ACTIVATE'  SET KEYWORD                           02181000
                AIF   (N'&REQUEST LE 1).ZE3A    CK NUM                  02182000
&ZMS            SETC  '"REQUEST='               *KPOSA* MNOTE           02183000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  02184000
&ZMS            SETC  '&ZMS "REQUEST"'                                  02185000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02186000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02187000
.ZE3A           ANOP  ,                                                 02188000
.*----------------------------------------------------------------***   02189000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02190000
                AIF   (N'&NAME LE 1).ZE5A       CK NUM                  02191000
&ZMS            SETC  '"NAME='    *KPOSA* MNOTE                         02192000
&ZMS            SETC  '&ZMS.&NAME"'                                     02193000
&ZMS            SETC  '&ZMS "NAME"'                                     02194000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02195000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02196000
.ZE5A           ANOP  ,                                                 02197000
.*-------------------------------------------------------------------   02198000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02199000
                AIF   (K'&NAME(1) LE 0).ZE5B    NO PRM                  02200000
&ZXNAME         SETC  'INPUT'     SET IN/OUTPUT                         02201000
&XNAME          SETC  '&NAME(1)'  SET XVARIABLE                         02202000
                AIF   (N'&NAME GT 1).ZE5B                               02202600
.*              ANOP              MULTIPLE PARMS                        02203200
&XNAME          SETC  '&NAME'     SET XVARIABLE                         02204000
.ZE5B           ANOP  ,                                                 02205000
.*-------------------------------------------------------------------   02206000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02207000
                AIF   (K'&ZXNAME LE 0).ZE5R     NOT I/O                 02208000
                AIF   ('&XNAME'(1,1) NE '(').ZE5R                       02209000
&ZCGPR          SETC  '&XNAME'(2,K'&XNAME-2)                            02210000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                       02211000
                AIF   (K'&ZCGPR GT 2).ZE5Q                              02212000
                AIF   ('&ZCGPR' EQ '0').ZE5Q                            02213000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02214000
                AIF   (T'&ZCGPR NE 'N').ZE5Q    INVALID REG NAME        02215000
.ZE5P           ANOP  ,                                                 02216000
                AIF   (T'&ZCGPR NE 'N').ZE5R    NON NUMERIC             02217000
                AIF   ('&ZCGPR' LT '2').ZE5Q                            02218000
                AIF   ('&ZCGPR' LE '12').ZE5R                           02219000
.ZE5Q           ANOP  ,                                                 02220000
&ZMS            SETC  '"NAME='    *KGPRA* MNOTE                         02221000
&ZMS            SETC  '&ZMS.&NAME"'                                     02222000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02223000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02224000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02225000
.ZE5R           ANOP  ,                                                 02226000
.*----------------------------------------------------------------***   02227000
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         02228000
                AIF   (N'&CONSID LE 1).ZE8A     CK NUM                  02229000
&ZMS            SETC  '"CONSID='  *KPOSA* MNOTE                         02230000
&ZMS            SETC  '&ZMS.&CONSID"'                                   02231000
&ZMS            SETC  '&ZMS "CONSID"'                                   02232000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02233000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02234000
.ZE8A           ANOP  ,                                                 02235000
.*-------------------------------------------------------------------   02236000
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    02237000
                AIF   (K'&CONSID(1) LE 0).ZE8B  NO PRM                  02238000
&ZXCONSID       SETC  'OUTPUT'    SET IN/OUTPUT                         02239000
&XCONSID        SETC  '&CONSID(1)'              SET XVARIABLE           02240000
                AIF   (N'&CONSID GT 1).ZE8B                             02240600
.*              ANOP              MULTIPLE PARMS                        02241200
&XCONSID        SETC  '&CONSID'   SET XVARIABLE                         02242000
.ZE8B           ANOP  ,                                                 02243000
.*-------------------------------------------------------------------   02244000
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   02245000
                AIF   (K'&ZXCONSID LE 0).ZE8R   NOT I/O                 02246000
                AIF   ('&XCONSID'(1,1) NE '(').ZE8R                     02247000
&ZCGPR          SETC  '&XCONSID'(2,K'&XCONSID-2)                        02248000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                       02249000
                AIF   (K'&ZCGPR GT 2).ZE8Q                              02250000
                AIF   ('&ZCGPR' EQ '0').ZE8Q                            02251000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02252000
                AIF   (T'&ZCGPR NE 'N').ZE8Q    INVALID REG NAME        02253000
.ZE8P           ANOP  ,                                                 02254000
                AIF   (T'&ZCGPR NE 'N').ZE8R    NON NUMERIC             02255000
                AIF   ('&ZCGPR' LT '2').ZE8Q                            02256000
                AIF   ('&ZCGPR' LE '12').ZE8R                           02257000
.ZE8Q           ANOP  ,                                                 02258000
&ZMS            SETC  '"CONSID='  *KGPRA* MNOTE                         02259000
&ZMS            SETC  '&ZMS.&CONSID"'                                   02260000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02261000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02262000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02263000
.ZE8R           ANOP  ,                                                 02264000
.*----------------------------------------------------------------***   02265000
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         02266000
                AIF   (N'&MIGID LE 1).ZE11A     CK NUM                  02267000
&ZMS            SETC  '"MIGID='   *KPOSA* MNOTE                         02268000
&ZMS            SETC  '&ZMS.&MIGID"'                                    02269000
&ZMS            SETC  '&ZMS "MIGID"'                                    02270000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02271000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02272000
.ZE11A          ANOP  ,                                                 02273000
.*-------------------------------------------------------------------   02274000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    02275000
                AIF   (K'&MIGID(1) LE 0).ZE11B  NO PRM                  02276000
&ZXMIGID        SETC  'OUTPUT'    SET IN/OUTPUT                         02277000
&XMIGID         SETC  '&MIGID(1)'               SET XVARIABLE           02278000
                AIF   (N'&MIGID GT 1).ZE11B                             02278600
.*              ANOP              MULTIPLE PARMS                        02279200
&XMIGID         SETC  '&MIGID'    SET XVARIABLE                         02280000
.ZE11B          ANOP  ,                                                 02281000
.*-------------------------------------------------------------------   02282000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   02283000
                AIF   (K'&ZXMIGID LE 0).ZE11R   NOT I/O                 02284000
                AIF   ('&XMIGID'(1,1) NE '(').ZE11R                     02285000
&ZCGPR          SETC  '&XMIGID'(2,K'&XMIGID-2)                          02286000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                      02287000
                AIF   (K'&ZCGPR GT 2).ZE11Q                             02288000
                AIF   ('&ZCGPR' EQ '0').ZE11Q                           02289000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02290000
                AIF   (T'&ZCGPR NE 'N').ZE11Q   INVALID REG NAME        02291000
.ZE11P          ANOP  ,                                                 02292000
                AIF   (T'&ZCGPR NE 'N').ZE11R   NON NUMERIC             02293000
                AIF   ('&ZCGPR' LT '2').ZE11Q                           02294000
                AIF   ('&ZCGPR' LE '12').ZE11R                          02295000
.ZE11Q          ANOP  ,                                                 02296000
&ZMS            SETC  '"MIGID='   *KGPRA* MNOTE                         02297000
&ZMS            SETC  '&ZMS.&MIGID"'                                    02298000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02299000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02300000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02301000
.ZE11R          ANOP  ,                                                 02302000
.*----------------------------------------------------------------***   02303000
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02303100
                AIF   (N'&MIGIDREL LE 1).ZE14A  CK NUM                  02303200
&ZMS            SETC  '"MIGIDREL='              *KPOSA* MNOTE           02303300
&ZMS            SETC  '&ZMS.&MIGIDREL"'                                 02303400
&ZMS            SETC  '&ZMS "MIGIDREL"'                                 02303500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02303600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02303700
.ZE14A          ANOP  ,                                                 02303800
.*-------------------------------------------------------------------   02303900
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02304000
.ZE15A   AIF   ('&MIGIDREL(1)' NE 'NO').ZE16A                           02304100
&XMIGIDREL      SETC  'NO'        SET KEYWORD                           02304200
.*-------------------------------------------------------------------   02304300
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02304400
.ZE16A   AIF   ('&MIGIDREL(1)' NE 'AUTO').ZE17A                         02304500
&XMIGIDREL      SETC  'AUTO'      SET KEYWORD                           02304600
.*-------------------------------------------------------------------   02304700
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02304800
.ZE17A          AIF   (K'&XMIGIDREL GT 0).ZE17B                         02304900
                AIF   (K'&MIGIDREL(1) LE 0).ZE17C                       02305000
&ZMS            SETC  '"MIGIDREL='              *KUKWA* MNOTE           02305100
&ZMS            SETC  '&ZMS.&MIGIDREL"'                                 02305200
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         02305300
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               02305400
&ZMS            SETC  '&ZMS "NO"'                                       02305500
&ZMS            SETC  '&ZMS OR "AUTO".'                                 02305600
                MNOTE 8,' &ZMS '                                        02305700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02305800
                AGO   .ZE17C                                            02305900
.*                                                                      02306000
.ZE17B          ANOP  ,                                                 02306100
&ZXMIGIDREL     SETC  'INPUT'     SET IN/OUTPUT                         02306200
.ZE17C          ANOP  ,                                                 02306300
.*----------------------------------------------------------------***   02306400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02306500
                AIF   (N'&TERMNAME LE 1).ZE19A  CK NUM                  02306600
&ZMS            SETC  '"TERMNAME='              *KPOSA* MNOTE           02306700
&ZMS            SETC  '&ZMS.&TERMNAME"'                                 02307000
&ZMS            SETC  '&ZMS "TERMNAME"'                                 02308000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02309000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02310000
.ZE19A          ANOP  ,                                                 02349000
.*-------------------------------------------------------------------   02350000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02350800
                AIF   (K'&TERMNAME(1) LE 0).ZE19B NO PRM                02351600
&ZXTERMNAME     SETC  'INPUT'     SET IN/OUTPUT                         02352400
&XTERMNAME      SETC  '&TERMNAME(1)'            SET XVARIABLE           02353200
                AIF   (N'&TERMNAME GT 1).ZE19B                          02354000
.*              ANOP              MULTIPLE PARMS                        02355200
&XTERMNAME      SETC  '&TERMNAME'               SET XVARIABLE           02356100
.ZE19B          ANOP  ,                                                 02357000
.*-------------------------------------------------------------------   02358000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02359000
                AIF   (K'&ZXTERMNAME LE 0).ZE19R  NOT I/O               02360000
                AIF   ('&XTERMNAME'(1,1) NE '(').ZE19R                  02361000
&ZCGPR          SETC  '&XTERMNAME'(2,K'&XTERMNAME-2)                    02362000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE19P                      02363000
                AIF   (K'&ZCGPR GT 2).ZE19Q                             02364000
                AIF   ('&ZCGPR' EQ '0').ZE19Q                           02365000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02366000
                AIF   (T'&ZCGPR NE 'N').ZE19Q   INVALID REG NAME        02367000
.ZE19P          ANOP  ,                                                 02368000
                AIF   (T'&ZCGPR NE 'N').ZE19R   NON NUMERIC             02369000
                AIF   ('&ZCGPR' LT '2').ZE19Q                           02370000
                AIF   ('&ZCGPR' LE '12').ZE19R                          02371000
.ZE19Q          ANOP  ,                                                 02372000
&ZMS            SETC  '"TERMNAME='              *KGPRA* MNOTE           02373000
&ZMS            SETC  '&ZMS.&TERMNAME"'                                 02374000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02375000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02376000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02377000
.ZE19R          ANOP  ,                                                 02378000
.*----------------------------------------------------------------***   02379000
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         02379100
                AIF   (N'&MCSCSA LE 1).ZE22A    CK NUM                  02379200
&ZMS            SETC  '"MCSCSA='  *KPOSA* MNOTE                         02379300
&ZMS            SETC  '&ZMS.&MCSCSA"'                                   02379400
&ZMS            SETC  '&ZMS "MCSCSA"'                                   02379500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02379600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02379700
.ZE22A          ANOP  ,                                                 02379800
.*-------------------------------------------------------------------   02379900
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    02380000
                AIF   (K'&MCSCSA(1) LE 0).ZE22B NO PRM                  02380100
&ZXMCSCSA       SETC  'OUTPUT'    SET IN/OUTPUT                         02380200
&XMCSCSA        SETC  '&MCSCSA(1)'              SET XVARIABLE           02380300
                AIF   (N'&MCSCSA GT 1).ZE22B                            02380400
.*              ANOP              MULTIPLE PARMS                        02380500
&XMCSCSA        SETC  '&MCSCSA'   SET XVARIABLE                         02380600
.ZE22B          ANOP  ,                                                 02380700
.*-------------------------------------------------------------------   02380800
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   02380900
                AIF   (K'&ZXMCSCSA LE 0).ZE22R  NOT I/O                 02381000
                AIF   ('&XMCSCSA'(1,1) NE '(').ZE22R                    02381100
&ZCGPR          SETC  '&XMCSCSA'(2,K'&XMCSCSA-2)                        02381200
                AIF   ('&ZCGPR'(1,1) NE '0').ZE22P                      02381300
                AIF   (K'&ZCGPR GT 2).ZE22Q                             02381400
                AIF   ('&ZCGPR' EQ '0').ZE22Q                           02381500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02381600
                AIF   (T'&ZCGPR NE 'N').ZE22Q   INVALID REG NAME        02381700
.ZE22P          ANOP  ,                                                 02381800
                AIF   (T'&ZCGPR NE 'N').ZE22R   NON NUMERIC             02381900
                AIF   ('&ZCGPR' LT '2').ZE22Q                           02382000
                AIF   ('&ZCGPR' LE '12').ZE22R                          02382100
.ZE22Q          ANOP  ,                                                 02382200
&ZMS            SETC  '"MCSCSA='  *KGPRA* MNOTE                         02382300
&ZMS            SETC  '&ZMS.&MCSCSA"'                                   02382400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02382500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02382600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02382700
.ZE22R          ANOP  ,                                                 02382800
.*----------------------------------------------------------------***   02382900
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         02383000
                AIF   (N'&MCSCSAA LE 1).ZE24A   CK NUM                  02383100
&ZMS            SETC  '"MCSCSAA='               *KPOSA* MNOTE           02383200
&ZMS            SETC  '&ZMS.&MCSCSAA"'                                  02383300
&ZMS            SETC  '&ZMS "MCSCSAA"'                                  02383400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02383500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02383600
.ZE24A          ANOP  ,                                                 02383700
.*-------------------------------------------------------------------   02383800
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    02383900
                AIF   (K'&MCSCSAA(1) LE 0).ZE24B NO PRM                 02384000
&ZXMCSCSAA      SETC  'OUTPUT'    SET IN/OUTPUT                         02384100
&XMCSCSAA       SETC  '&MCSCSAA(1)'             SET XVARIABLE           02384200
                AIF   (N'&MCSCSAA GT 1).ZE24B                           02384300
.*              ANOP              MULTIPLE PARMS                        02384400
&XMCSCSAA       SETC  '&MCSCSAA'  SET XVARIABLE                         02384500
.ZE24B          ANOP  ,                                                 02384600
.*-------------------------------------------------------------------   02384700
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   02384800
                AIF   (K'&ZXMCSCSAA LE 0).ZE24R  NOT I/O                02384900
                AIF   ('&XMCSCSAA'(1,1) NE '(').ZE24R                   02385000
&ZCGPR          SETC  '&XMCSCSAA'(2,K'&XMCSCSAA-2)                      02385100
                AIF   ('&ZCGPR'(1,1) NE '0').ZE24P                      02385200
                AIF   (K'&ZCGPR GT 2).ZE24Q                             02385300
                AIF   ('&ZCGPR' EQ '0').ZE24Q                           02385400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02385500
                AIF   (T'&ZCGPR NE 'N').ZE24Q   INVALID REG NAME        02385600
.ZE24P          ANOP  ,                                                 02385700
                AIF   (T'&ZCGPR NE 'N').ZE24R   NON NUMERIC             02385800
                AIF   ('&ZCGPR' LT '2').ZE24Q                           02385900
                AIF   ('&ZCGPR' LE '12').ZE24R                          02386000
.ZE24Q          ANOP  ,                                                 02386100
&ZMS            SETC  '"MCSCSAA='               *KGPRA* MNOTE           02386200
&ZMS            SETC  '&ZMS.&MCSCSAA"'                                  02386300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02386400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02386500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02386600
.ZE24R          ANOP  ,                                                 02386700
.*----------------------------------------------------------------***   02386800
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02386900
                AIF   (N'&OPERPARM LE 1).ZE28A  CK NUM                  02387000
&ZMS            SETC  '"OPERPARM='              *KPOSA* MNOTE           02387100
&ZMS            SETC  '&ZMS.&OPERPARM"'                                 02387200
&ZMS            SETC  '&ZMS "OPERPARM"'                                 02387300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02387400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02387500
.ZE28A          ANOP  ,                                                 02387600
.*-------------------------------------------------------------------   02388000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02389000
                AIF   (K'&OPERPARM(1) LE 0).ZE28B NO PRM                02390000
&ZXOPERPARM     SETC  'INPUT'     SET IN/OUTPUT                         02391000
&XOPERPARM      SETC  '&OPERPARM(1)'            SET XVARIABLE           02392000
                AIF   (N'&OPERPARM GT 1).ZE28B                          02392600
.*              ANOP              MULTIPLE PARMS                        02393200
&XOPERPARM      SETC  '&OPERPARM'               SET XVARIABLE           02394000
.ZE28B          ANOP  ,                                                 02395000
.*-------------------------------------------------------------------   02396000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02397000
                AIF   (K'&ZXOPERPARM LE 0).ZE28R  NOT I/O               02398000
                AIF   ('&XOPERPARM'(1,1) NE '(').ZE28R                  02399000
&ZCGPR          SETC  '&XOPERPARM'(2,K'&XOPERPARM-2)                    02400000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE28P                      02401000
                AIF   (K'&ZCGPR GT 2).ZE28Q                             02402000
                AIF   ('&ZCGPR' EQ '0').ZE28Q                           02403000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02404000
                AIF   (T'&ZCGPR NE 'N').ZE28Q   INVALID REG NAME        02405000
.ZE28P          ANOP  ,                                                 02406000
                AIF   (T'&ZCGPR NE 'N').ZE28R   NON NUMERIC             02407000
                AIF   ('&ZCGPR' LT '2').ZE28Q                           02408000
                AIF   ('&ZCGPR' LE '12').ZE28R                          02409000
.ZE28Q          ANOP  ,                                                 02410000
&ZMS            SETC  '"OPERPARM='              *KGPRA* MNOTE           02411000
&ZMS            SETC  '&ZMS.&OPERPARM"'                                 02412000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02413000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02414000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02415000
.ZE28R          ANOP  ,                                                 02417500
.*-------------------------------------------------------------------   02420000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           02421000
&ZTLC           SETC 'FIFO'                                             02421600
                AIF   ('&MSGDLVRY(1)' NE '&ZTLC').ZE32A                 02422300
&XMSGDLVRY      SETC  'FIFO'      SET KEYWORD                           02423000
                AIF   (N'&MSGDLVRY LE 1).ZE32A  CK NUM                  02424000
&ZMS            SETC  '"MSGDLVRY='              *KPOSA* MNOTE           02425000
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 02426000
&ZMS            SETC  '&ZMS "MSGDLVRY"'                                 02427000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02428000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02429000
.ZE32A          ANOP  ,                                                 02430000
.*----------------------------------------------------------------***   02431000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02432000
                AIF   (N'&MSGECB LE 1).ZE34A    CK NUM                  02433000
&ZMS            SETC  '"MSGECB='  *KPOSA* MNOTE                         02434000
&ZMS            SETC  '&ZMS.&MSGECB"'                                   02435000
&ZMS            SETC  '&ZMS "MSGECB"'                                   02436000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02437000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02438000
.ZE34A          ANOP  ,                                                 02458000
.*-------------------------------------------------------------------   02478000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02479000
                AIF   (K'&MSGECB(1) LE 0).ZE34B NO PRM                  02480000
&ZXMSGECB       SETC  'INPUT'     SET IN/OUTPUT                         02481000
&XMSGECB        SETC  '&MSGECB(1)'              SET XVARIABLE           02482000
                AIF   (N'&MSGECB GT 1).ZE34B                            02482600
.*              ANOP              MULTIPLE PARMS                        02483200
&XMSGECB        SETC  '&MSGECB'   SET XVARIABLE                         02484000
.ZE34B          ANOP  ,                                                 02485000
.*-------------------------------------------------------------------   02486000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02487000
                AIF   (K'&ZXMSGECB LE 0).ZE34R  NOT I/O                 02488000
                AIF   ('&XMSGECB'(1,1) NE '(').ZE34R                    02489000
&ZCGPR          SETC  '&XMSGECB'(2,K'&XMSGECB-2)                        02490000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE34P                      02491000
                AIF   (K'&ZCGPR GT 2).ZE34Q                             02492000
                AIF   ('&ZCGPR' EQ '0').ZE34Q                           02493000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02494000
                AIF   (T'&ZCGPR NE 'N').ZE34Q   INVALID REG NAME        02495000
.ZE34P          ANOP  ,                                                 02496000
                AIF   (T'&ZCGPR NE 'N').ZE34R   NON NUMERIC             02497000
                AIF   ('&ZCGPR' LT '2').ZE34Q                           02498000
                AIF   ('&ZCGPR' LE '12').ZE34R                          02499000
.ZE34Q          ANOP  ,                                                 02500000
&ZMS            SETC  '"MSGECB='  *KGPRA* MNOTE                         02501000
&ZMS            SETC  '&ZMS.&MSGECB"'                                   02502000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02503000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02504000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02505000
.ZE34R          ANOP  ,                                                 02506000
.*----------------------------------------------------------------***   02507000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02508000
                AIF   (N'&QLIMIT LE 1).ZE37A    CK NUM                  02509000
&ZMS            SETC  '"QLIMIT='  *KPOSA* MNOTE                         02510000
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   02511000
&ZMS            SETC  '&ZMS "QLIMIT"'                                   02512000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02513000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02514000
.ZE37A          ANOP  ,                                                 02553000
.*-------------------------------------------------------------------   02554000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02555000
                AIF   (K'&QLIMIT(1) LE 0).ZE37B NO PRM                  02555800
&ZXQLIMIT       SETC  'INPUT'     SET IN/OUTPUT                         02556600
&XQLIMIT        SETC  '&QLIMIT(1)'              SET XVARIABLE           02557400
                AIF   (N'&QLIMIT GT 1).ZE37B                            02558200
.*              ANOP              MULTIPLE PARMS                        02559200
&XQLIMIT        SETC  '&QLIMIT'   SET XVARIABLE                         02560100
.ZE37B          ANOP  ,                                                 02561000
.*-------------------------------------------------------------------   02562000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02563000
                AIF   (K'&ZXQLIMIT LE 0).ZE37R  NOT I/O                 02564000
                AIF   ('&XQLIMIT'(1,1) NE '(').ZE37R                    02565000
&ZCGPR          SETC  '&XQLIMIT'(2,K'&XQLIMIT-2)                        02566000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE37P                      02567000
                AIF   (K'&ZCGPR GT 2).ZE37Q                             02568000
                AIF   ('&ZCGPR' EQ '0').ZE37Q                           02569000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02570000
                AIF   (T'&ZCGPR NE 'N').ZE37Q   INVALID REG NAME        02571000
.ZE37P          ANOP  ,                                                 02572000
                AIF   (T'&ZCGPR NE 'N').ZE37R   NON NUMERIC             02573000
                AIF   ('&ZCGPR' LT '2').ZE37Q                           02574000
                AIF   ('&ZCGPR' LE '12').ZE37R                          02575000
.ZE37Q          ANOP  ,                                                 02576000
&ZMS            SETC  '"QLIMIT='  *KGPRA* MNOTE                         02577000
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   02578000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02579000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02580000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02581000
.ZE37R          ANOP  ,                                                 02582000
.*----------------------------------------------------------------***   02583000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02584000
                AIF   (N'&ALERTECB LE 1).ZE40A  CK NUM                  02634000
&ZMS            SETC  '"ALERTECB='              *KPOSA* MNOTE           02747200
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 02747300
&ZMS            SETC  '&ZMS "ALERTECB"'                                 02747400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02747500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02747600
.ZE40A          ANOP  ,                                                 02747700
.*-------------------------------------------------------------------   02747800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02747900
                AIF   (K'&ALERTECB(1) LE 0).ZE40B NO PRM                02748000
&ZXALERTECB     SETC  'INPUT'     SET IN/OUTPUT                         02748100
&XALERTECB      SETC  '&ALERTECB(1)'            SET XVARIABLE           02748200
                AIF   (N'&ALERTECB GT 1).ZE40B                          02748300
.*              ANOP              MULTIPLE PARMS                        02748400
&XALERTECB      SETC  '&ALERTECB'               SET XVARIABLE           02748500
.ZE40B          ANOP  ,                                                 02748600
.*-------------------------------------------------------------------   02748700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02748800
                AIF   (K'&ZXALERTECB LE 0).ZE40R  NOT I/O               02748900
                AIF   ('&XALERTECB'(1,1) NE '(').ZE40R                  02749000
&ZCGPR          SETC  '&XALERTECB'(2,K'&XALERTECB-2)                    02749100
                AIF   ('&ZCGPR'(1,1) NE '0').ZE40P                      02749200
                AIF   (K'&ZCGPR GT 2).ZE40Q                             02749300
                AIF   ('&ZCGPR' EQ '0').ZE40Q                           02749400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02749500
                AIF   (T'&ZCGPR NE 'N').ZE40Q   INVALID REG NAME        02749600
.ZE40P          ANOP  ,                                                 02749700
                AIF   (T'&ZCGPR NE 'N').ZE40R   NON NUMERIC             02749800
                AIF   ('&ZCGPR' LT '2').ZE40Q                           02749900
                AIF   ('&ZCGPR' LE '12').ZE40R                          02750000
.ZE40Q          ANOP  ,                                                 02750100
&ZMS            SETC  '"ALERTECB='              *KGPRA* MNOTE           02750200
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 02750300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02750400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02750500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02750600
.ZE40R          ANOP  ,                                                 02750700
.*----------------------------------------------------------------***   02750800
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02750900
                AIF   (N'&ALERTPCT LE 1).ZE42A  CK NUM                  02751000
&ZMS            SETC  '"ALERTPCT='              *KPOSA* MNOTE           02751100
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 02751200
&ZMS            SETC  '&ZMS "ALERTPCT"'                                 02751300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02752000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02753000
.ZE42A          ANOP  ,                                                 02753100
.*-------------------------------------------------------------------   02753200
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02753300
                AIF   (K'&ALERTPCT(1) LE 0).ZE42B NO PRM                02753400
&ZXALERTPCT     SETC  'INPUT'     SET IN/OUTPUT                         02753500
&XALERTPCT      SETC  '&ALERTPCT(1)'            SET XVARIABLE           02753600
                AIF   (N'&ALERTPCT GT 1).ZE42B                          02753700
.*              ANOP              MULTIPLE PARMS                        02753800
&XALERTPCT      SETC  '&ALERTPCT'               SET XVARIABLE           02753900
.ZE42B          ANOP  ,                                                 02754000
.*-------------------------------------------------------------------   02754100
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02754200
                AIF   (K'&ZXALERTPCT LE 0).ZE42R  NOT I/O               02754300
                AIF   ('&XALERTPCT'(1,1) NE '(').ZE42R                  02754400
&ZCGPR          SETC  '&XALERTPCT'(2,K'&XALERTPCT-2)                    02754500
                AIF   ('&ZCGPR'(1,1) NE '0').ZE42P                      02754600
                AIF   (K'&ZCGPR GT 2).ZE42Q                             02754700
                AIF   ('&ZCGPR' EQ '0').ZE42Q                           02754800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02754900
                AIF   (T'&ZCGPR NE 'N').ZE42Q   INVALID REG NAME        02755000
.ZE42P          ANOP  ,                                                 02755100
                AIF   (T'&ZCGPR NE 'N').ZE42R   NON NUMERIC             02755200
                AIF   ('&ZCGPR' LT '2').ZE42Q                           02755300
                AIF   ('&ZCGPR' LE '12').ZE42R                          02755400
.ZE42Q          ANOP  ,                                                 02755500
&ZMS            SETC  '"ALERTPCT='              *KGPRA* MNOTE           02755600
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 02755700
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02755800
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02755900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02756000
.ZE42R          ANOP  ,                                                 02756100
.*----------------------------------------------------------------***   02756200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02756300
                AIF   (N'&QRESUME LE 1).ZE46A   CK NUM                  02756400
&ZMS            SETC  '"QRESUME='               *KPOSA* MNOTE           02756500
&ZMS            SETC  '&ZMS.&QRESUME"'                                  02756600
&ZMS            SETC  '&ZMS "QRESUME"'                                  02756700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02756800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02756900
.ZE46A          ANOP  ,                                                 02757000
.*-------------------------------------------------------------------   02757100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02757200
                AIF   (K'&QRESUME(1) LE 0).ZE46B NO PRM                 02757300
&ZXQRESUME      SETC  'INPUT'     SET IN/OUTPUT                         02757400
&XQRESUME       SETC  '&QRESUME(1)'             SET XVARIABLE           02757500
                AIF   (N'&QRESUME GT 1).ZE46B                           02757600
.*              ANOP              MULTIPLE PARMS                        02757700
&XQRESUME       SETC  '&QRESUME'  SET XVARIABLE                         02757800
.ZE46B          ANOP  ,                                                 02757900
.*-------------------------------------------------------------------   02758000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02758100
                AIF   (K'&ZXQRESUME LE 0).ZE46R  NOT I/O                02758200
                AIF   ('&XQRESUME'(1,1) NE '(').ZE46R                   02758300
&ZCGPR          SETC  '&XQRESUME'(2,K'&XQRESUME-2)                      02758400
                AIF   ('&ZCGPR'(1,1) NE '0').ZE46P                      02758500
                AIF   (K'&ZCGPR GT 2).ZE46Q                             02758600
                AIF   ('&ZCGPR' EQ '0').ZE46Q                           02758700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02758800
                AIF   (T'&ZCGPR NE 'N').ZE46Q   INVALID REG NAME        02758900
.ZE46P          ANOP  ,                                                 02759000
                AIF   (T'&ZCGPR NE 'N').ZE46R   NON NUMERIC             02759100
                AIF   ('&ZCGPR' LT '2').ZE46Q                           02759200
                AIF   ('&ZCGPR' LE '12').ZE46R                          02759300
.ZE46Q          ANOP  ,                                                 02759400
&ZMS            SETC  '"QRESUME='               *KGPRA* MNOTE           02759500
&ZMS            SETC  '&ZMS.&QRESUME"'                                  02759600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02759700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02759800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02759900
.ZE46R          ANOP  ,                                                 02760000
.*-------------------------------------------------------------------   02760100
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           02760200
&ZTLC           SETC 'SEARCH'                                           02760300
                AIF   ('&MSGDLVRY(1)' NE '&ZTLC').ZE48A                 02760400
&XMSGDLVRY      SETC  'SEARCH'    SET KEYWORD                           02760500
                AIF   (N'&MSGDLVRY LE 1).ZE48A  CK NUM                  02760600
&ZMS            SETC  '"MSGDLVRY='              *KPOSA* MNOTE           02760700
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 02760800
&ZMS            SETC  '&ZMS "MSGDLVRY"'                                 02760900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02761000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02761100
.ZE48A          ANOP  ,                                                 02761200
.*----------------------------------------------------------------***   02761300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02761400
                AIF   (N'&MSGECB LE 1).ZE50A    CK NUM                  02761500
&ZMS            SETC  '"MSGECB='  *KPOSA* MNOTE                         02761600
&ZMS            SETC  '&ZMS.&MSGECB"'                                   02761700
&ZMS            SETC  '&ZMS "MSGECB"'                                   02761800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02761900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02762000
.ZE50A          ANOP  ,                                                 02762100
.*-------------------------------------------------------------------   02762200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02762300
                AIF   (K'&MSGECB(1) LE 0).ZE50B NO PRM                  02762400
&ZXMSGECB       SETC  'INPUT'     SET IN/OUTPUT                         02762500
&XMSGECB        SETC  '&MSGECB(1)'              SET XVARIABLE           02762600
                AIF   (N'&MSGECB GT 1).ZE50B                            02762700
.*              ANOP              MULTIPLE PARMS                        02762800
&XMSGECB        SETC  '&MSGECB'   SET XVARIABLE                         02762900
.ZE50B          ANOP  ,                                                 02763000
.*-------------------------------------------------------------------   02763100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02763200
                AIF   (K'&ZXMSGECB LE 0).ZE50R  NOT I/O                 02763300
                AIF   ('&XMSGECB'(1,1) NE '(').ZE50R                    02763400
&ZCGPR          SETC  '&XMSGECB'(2,K'&XMSGECB-2)                        02763500
                AIF   ('&ZCGPR'(1,1) NE '0').ZE50P                      02763600
                AIF   (K'&ZCGPR GT 2).ZE50Q                             02763700
                AIF   ('&ZCGPR' EQ '0').ZE50Q                           02763800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02763900
                AIF   (T'&ZCGPR NE 'N').ZE50Q   INVALID REG NAME        02764000
.ZE50P          ANOP  ,                                                 02764100
                AIF   (T'&ZCGPR NE 'N').ZE50R   NON NUMERIC             02764200
                AIF   ('&ZCGPR' LT '2').ZE50Q                           02764300
                AIF   ('&ZCGPR' LE '12').ZE50R                          02764400
.ZE50Q          ANOP  ,                                                 02764500
&ZMS            SETC  '"MSGECB='  *KGPRA* MNOTE                         02764600
&ZMS            SETC  '&ZMS.&MSGECB"'                                   02764700
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02764800
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02764900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02765000
.ZE50R          ANOP  ,                                                 02765100
.*----------------------------------------------------------------***   02765200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02765300
                AIF   (N'&QLIMIT LE 1).ZE53A    CK NUM                  02765400
&ZMS            SETC  '"QLIMIT='  *KPOSA* MNOTE                         02765500
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   02765600
&ZMS            SETC  '&ZMS "QLIMIT"'                                   02765700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02765800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02765900
.ZE53A          ANOP  ,                                                 02766000
.*-------------------------------------------------------------------   02766100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02766200
                AIF   (K'&QLIMIT(1) LE 0).ZE53B NO PRM                  02766300
&ZXQLIMIT       SETC  'INPUT'     SET IN/OUTPUT                         02766400
&XQLIMIT        SETC  '&QLIMIT(1)'              SET XVARIABLE           02766500
                AIF   (N'&QLIMIT GT 1).ZE53B                            02766600
.*              ANOP              MULTIPLE PARMS                        02766700
&XQLIMIT        SETC  '&QLIMIT'   SET XVARIABLE                         02766800
.ZE53B          ANOP  ,                                                 02766900
.*-------------------------------------------------------------------   02767000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02767100
                AIF   (K'&ZXQLIMIT LE 0).ZE53R  NOT I/O                 02767200
                AIF   ('&XQLIMIT'(1,1) NE '(').ZE53R                    02767300
&ZCGPR          SETC  '&XQLIMIT'(2,K'&XQLIMIT-2)                        02767400
                AIF   ('&ZCGPR'(1,1) NE '0').ZE53P                      02768000
                AIF   (K'&ZCGPR GT 2).ZE53Q                             02769000
                AIF   ('&ZCGPR' EQ '0').ZE53Q                           02770000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02771000
                AIF   (T'&ZCGPR NE 'N').ZE53Q   INVALID REG NAME        02772000
.ZE53P          ANOP  ,                                                 02773000
                AIF   (T'&ZCGPR NE 'N').ZE53R   NON NUMERIC             02774000
                AIF   ('&ZCGPR' LT '2').ZE53Q                           02775000
                AIF   ('&ZCGPR' LE '12').ZE53R                          02776000
.ZE53Q          ANOP  ,                                                 02777000
&ZMS            SETC  '"QLIMIT='  *KGPRA* MNOTE                         02778000
&ZMS            SETC  '&ZMS.&QLIMIT"'                                   02779000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02780000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02781000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02782000
.ZE53R          ANOP  ,                                                 02783000
.*----------------------------------------------------------------***   02784000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02785000
                AIF   (N'&ALERTECB LE 1).ZE56A  CK NUM                  02785100
&ZMS            SETC  '"ALERTECB='              *KPOSA* MNOTE           02785200
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 02785300
&ZMS            SETC  '&ZMS "ALERTECB"'                                 02785400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02785500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02785600
.ZE56A          ANOP  ,                                                 02785700
.*-------------------------------------------------------------------   02785800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02785900
                AIF   (K'&ALERTECB(1) LE 0).ZE56B NO PRM                02786000
&ZXALERTECB     SETC  'INPUT'     SET IN/OUTPUT                         02786100
&XALERTECB      SETC  '&ALERTECB(1)'            SET XVARIABLE           02786200
                AIF   (N'&ALERTECB GT 1).ZE56B                          02786300
.*              ANOP              MULTIPLE PARMS                        02786400
&XALERTECB      SETC  '&ALERTECB'               SET XVARIABLE           02786500
.ZE56B          ANOP  ,                                                 02786600
.*-------------------------------------------------------------------   02786700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02786800
                AIF   (K'&ZXALERTECB LE 0).ZE56R  NOT I/O               02786900
                AIF   ('&XALERTECB'(1,1) NE '(').ZE56R                  02787000
&ZCGPR          SETC  '&XALERTECB'(2,K'&XALERTECB-2)                    02787100
                AIF   ('&ZCGPR'(1,1) NE '0').ZE56P                      02787200
                AIF   (K'&ZCGPR GT 2).ZE56Q                             02787300
                AIF   ('&ZCGPR' EQ '0').ZE56Q                           02787400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02787500
                AIF   (T'&ZCGPR NE 'N').ZE56Q   INVALID REG NAME        02787600
.ZE56P          ANOP  ,                                                 02787700
                AIF   (T'&ZCGPR NE 'N').ZE56R   NON NUMERIC             02787800
                AIF   ('&ZCGPR' LT '2').ZE56Q                           02787900
                AIF   ('&ZCGPR' LE '12').ZE56R                          02788000
.ZE56Q          ANOP  ,                                                 02788100
&ZMS            SETC  '"ALERTECB='              *KGPRA* MNOTE           02788200
&ZMS            SETC  '&ZMS.&ALERTECB"'                                 02788300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02788400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02788500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02788600
.ZE56R          ANOP  ,                                                 02788700
.*----------------------------------------------------------------***   02788800
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02788900
                AIF   (N'&ALERTPCT LE 1).ZE58A  CK NUM                  02789000
&ZMS            SETC  '"ALERTPCT='              *KPOSA* MNOTE           02789100
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 02789200
&ZMS            SETC  '&ZMS "ALERTPCT"'                                 02789300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02789400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02789500
.ZE58A          ANOP  ,                                                 02789600
.*-------------------------------------------------------------------   02789700
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02789800
                AIF   (K'&ALERTPCT(1) LE 0).ZE58B NO PRM                02789900
&ZXALERTPCT     SETC  'INPUT'     SET IN/OUTPUT                         02790000
&XALERTPCT      SETC  '&ALERTPCT(1)'            SET XVARIABLE           02790100
                AIF   (N'&ALERTPCT GT 1).ZE58B                          02790200
.*              ANOP              MULTIPLE PARMS                        02790300
&XALERTPCT      SETC  '&ALERTPCT'               SET XVARIABLE           02790400
.ZE58B          ANOP  ,                                                 02790500
.*-------------------------------------------------------------------   02790600
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02790700
                AIF   (K'&ZXALERTPCT LE 0).ZE58R  NOT I/O               02790800
                AIF   ('&XALERTPCT'(1,1) NE '(').ZE58R                  02790900
&ZCGPR          SETC  '&XALERTPCT'(2,K'&XALERTPCT-2)                    02791000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE58P                      02791100
                AIF   (K'&ZCGPR GT 2).ZE58Q                             02791200
                AIF   ('&ZCGPR' EQ '0').ZE58Q                           02791300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02791400
                AIF   (T'&ZCGPR NE 'N').ZE58Q   INVALID REG NAME        02791500
.ZE58P          ANOP  ,                                                 02791600
                AIF   (T'&ZCGPR NE 'N').ZE58R   NON NUMERIC             02791700
                AIF   ('&ZCGPR' LT '2').ZE58Q                           02791800
                AIF   ('&ZCGPR' LE '12').ZE58R                          02791900
.ZE58Q          ANOP  ,                                                 02792000
&ZMS            SETC  '"ALERTPCT='              *KGPRA* MNOTE           02792100
&ZMS            SETC  '&ZMS.&ALERTPCT"'                                 02792200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02792300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02792400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02792500
.ZE58R          ANOP  ,                                                 02792600
.*----------------------------------------------------------------***   02792700
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02792800
                AIF   (N'&QRESUME LE 1).ZE62A   CK NUM                  02792900
&ZMS            SETC  '"QRESUME='               *KPOSA* MNOTE           02793000
&ZMS            SETC  '&ZMS.&QRESUME"'                                  02793100
&ZMS            SETC  '&ZMS "QRESUME"'                                  02793200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02793300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02793400
.ZE62A          ANOP  ,                                                 02793500
.*-------------------------------------------------------------------   02793600
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02794000
                AIF   (K'&QRESUME(1) LE 0).ZE62B NO PRM                 02795000
&ZXQRESUME      SETC  'INPUT'     SET IN/OUTPUT                         02796000
&XQRESUME       SETC  '&QRESUME(1)'             SET XVARIABLE           02797000
                AIF   (N'&QRESUME GT 1).ZE62B                           02797600
.*              ANOP              MULTIPLE PARMS                        02798200
&XQRESUME       SETC  '&QRESUME'  SET XVARIABLE                         02799000
.ZE62B          ANOP  ,                                                 02800000
.*-------------------------------------------------------------------   02801000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    02802000
                AIF   (K'&ZXQRESUME LE 0).ZE62R  NOT I/O                02803000
                AIF   ('&XQRESUME'(1,1) NE '(').ZE62R                   02804000
&ZCGPR          SETC  '&XQRESUME'(2,K'&XQRESUME-2)                      02805000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE62P                      02806000
                AIF   (K'&ZCGPR GT 2).ZE62Q                             02807000
                AIF   ('&ZCGPR' EQ '0').ZE62Q                           02808000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02809000
                AIF   (T'&ZCGPR NE 'N').ZE62Q   INVALID REG NAME        02810000
.ZE62P          ANOP  ,                                                 02811000
                AIF   (T'&ZCGPR NE 'N').ZE62R   NON NUMERIC             02812000
                AIF   ('&ZCGPR' LT '2').ZE62Q                           02813000
                AIF   ('&ZCGPR' LE '12').ZE62R                          02814000
.ZE62Q          ANOP  ,                                                 02815000
&ZMS            SETC  '"QRESUME='               *KGPRA* MNOTE           02816000
&ZMS            SETC  '&ZMS.&QRESUME"'                                  02817000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02818000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02819000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02820000
.ZE62R          ANOP  ,                                                 02821000
.*-------------------------------------------------------------------   02822000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           02823000
&ZTLC           SETC 'NONE'                                             02823600
                AIF   ('&MSGDLVRY(1)' NE '&ZTLC').ZE64A                 02824300
&XMSGDLVRY      SETC  'NONE'      SET KEYWORD                           02825000
                AIF   (N'&MSGDLVRY LE 1).ZE64A  CK NUM                  02826000
&ZMS            SETC  '"MSGDLVRY='              *KPOSA* MNOTE           02827000
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 02828000
&ZMS            SETC  '&ZMS "MSGDLVRY"'                                 02829000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02830000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02831000
.ZE64A          ANOP  ,                                                 02832000
.*------------------------------------------------------------------    02833000
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           02834000
.ZE65           AIF   (K'&XMSGDLVRY GT 0).ZE65A  VALID                  02835000
                AIF   (K'&MSGDLVRY(1) LE 0).ZE65B                       02836000
&ZMS            SETC  '"MSGDLVRY='              *KUKWA* MNOTE           02837000
&ZMS            SETC  '&ZMS.&MSGDLVRY"'                                 02838000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         02839000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               02840000
&ZMS            SETC  '&ZMS "FIFO",'                                    02840800
&ZMS            SETC  '&ZMS "SEARCH",'                                  02841600
&ZMS            SETC  '&ZMS OR "NONE".'                                 02842400
                MNOTE 8,' &ZMS '                                        02843200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02844000
                AGO   .ZE65B                                            02845000
.*                                                                      02846000
.ZE65A          ANOP  ,                                                 02847000
&ZXMSGDLVRY     SETC  'INPUT'     SET IN/OUTPUT                         02848000
.ZE65B          ANOP  ,                                                 02849000
.*-------------------------------------------------------------------   02850000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02851000
&ZTLC           SETC 'DEACTIVATE'                                       02851600
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZE66A                  02852300
&XREQUEST       SETC  'DEACTIVATE'              SET KEYWORD             02853000
                AIF   (N'&REQUEST LE 1).ZE66A   CK NUM                  02854000
&ZMS            SETC  '"REQUEST='               *KPOSA* MNOTE           02855000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  02856000
&ZMS            SETC  '&ZMS "REQUEST"'                                  02857000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02858000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02859000
.ZE66A          ANOP  ,                                                 02860000
.*----------------------------------------------------------------***   02861000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02862000
                AIF   (N'&CONSID LE 1).ZE68A    CK NUM                  02863000
&ZMS            SETC  '"CONSID='  *KPOSA* MNOTE                         02864000
&ZMS            SETC  '&ZMS.&CONSID"'                                   02865000
&ZMS            SETC  '&ZMS "CONSID"'                                   02866000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02867000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02868000
.ZE68A          ANOP  ,                                                 02869000
.*-------------------------------------------------------------------   02870000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02871000
                AIF   (K'&CONSID(1) LE 0).ZE68B NO PRM                  02872000
&ZXCONSID       SETC  'INPUT'     SET IN/OUTPUT                         02873000
&XCONSID        SETC  '&CONSID(1)'              SET XVARIABLE           02874000
                AIF   (N'&CONSID GT 1).ZE68B                            02874600
.*              ANOP              MULTIPLE PARMS                        02875200
&XCONSID        SETC  '&CONSID'   SET XVARIABLE                         02876000
.ZE68B          ANOP  ,                                                 02877000
.*-------------------------------------------------------------------   02878000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02879000
                AIF   (K'&ZXCONSID LE 0).ZE68R  NOT I/O                 02880000
                AIF   ('&XCONSID'(1,1) NE '(').ZE68R                    02881000
&ZCGPR          SETC  '&XCONSID'(2,K'&XCONSID-2)                        02882000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE68P                      02883000
                AIF   (K'&ZCGPR GT 2).ZE68Q                             02884000
                AIF   ('&ZCGPR' EQ '0').ZE68Q                           02885000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02886000
                AIF   (T'&ZCGPR NE 'N').ZE68Q   INVALID REG NAME        02887000
.ZE68P          ANOP  ,                                                 02888000
                AIF   (T'&ZCGPR NE 'N').ZE68R   NON NUMERIC             02889000
                AIF   ('&ZCGPR' LT '2').ZE68Q                           02890000
                AIF   ('&ZCGPR' LE '12').ZE68R                          02891000
.ZE68Q          ANOP  ,                                                 02892000
&ZMS            SETC  '"CONSID='  *KGPRA* MNOTE                         02893000
&ZMS            SETC  '&ZMS.&CONSID"'                                   02894000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02895000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02896000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02897000
.ZE68R          ANOP  ,                                                 02898000
.*----------------------------------------------------------------***   02899000
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02900000
                AIF   (N'&ABTERM LE 1).ZE71A    CK NUM                  02901000
&ZMS            SETC  '"ABTERM='  *KPOSA* MNOTE                         02902000
&ZMS            SETC  '&ZMS.&ABTERM"'                                   02903000
&ZMS            SETC  '&ZMS "ABTERM"'                                   02904000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02905000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02906000
.ZE71A          ANOP  ,                                                 02907000
.*-------------------------------------------------------------------   02908000
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02909000
.ZE72A   AIF   ('&ABTERM(1)' NE 'NO').ZE73A                             02910500
&XABTERM        SETC  'NO'        SET KEYWORD                           02912000
.*-------------------------------------------------------------------   02913000
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02914000
.ZE73A   AIF   ('&ABTERM(1)' NE 'YES').ZE74A                            02915000
&XABTERM        SETC  'YES'       SET KEYWORD                           02916000
.*-------------------------------------------------------------------   02917000
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             02918000
.ZE74A          AIF   (K'&XABTERM GT 0).ZE74B                           02919000
                AIF   (K'&ABTERM(1) LE 0).ZE74C                         02920000
&ZMS            SETC  '"ABTERM='  *KUKWA* MNOTE                         02921000
&ZMS            SETC  '&ZMS.&ABTERM"'                                   02922000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         02923000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               02924000
&ZMS            SETC  '&ZMS "NO"'                                       02924700
&ZMS            SETC  '&ZMS OR "YES".'                                  02925400
                MNOTE 8,' &ZMS '                                        02926200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02927000
                AGO   .ZE74C                                            02928000
.*                                                                      02929000
.ZE74B          ANOP  ,                                                 02930000
&ZXABTERM       SETC  'INPUT'     SET IN/OUTPUT                         02931000
.ZE74C          ANOP  ,                                                 02932000
.*-------------------------------------------------------------------   02933000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02934000
&ZTLC           SETC 'RELEASE'                                          02934600
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZE75A                  02935300
&XREQUEST       SETC  'RELEASE'   SET KEYWORD                           02936000
                AIF   (N'&REQUEST LE 1).ZE75A   CK NUM                  02937000
&ZMS            SETC  '"REQUEST='               *KPOSA* MNOTE           02938000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  02939000
&ZMS            SETC  '&ZMS "REQUEST"'                                  02940000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02941000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02942000
.ZE75A          ANOP  ,                                                 02943000
.*----------------------------------------------------------------***   02944000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02945000
                AIF   (N'&MIGID LE 1).ZE77A     CK NUM                  02946000
&ZMS            SETC  '"MIGID='   *KPOSA* MNOTE                         02947000
&ZMS            SETC  '&ZMS.&MIGID"'                                    02948000
&ZMS            SETC  '&ZMS "MIGID"'                                    02949000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               02950000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02951000
.ZE77A          ANOP  ,                                                 02952000
.*-------------------------------------------------------------------   02953000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02954000
                AIF   (K'&MIGID(1) LE 0).ZE77B  NO PRM                  02955000
&ZXMIGID        SETC  'INPUT'     SET IN/OUTPUT                         02956000
&XMIGID         SETC  '&MIGID(1)'               SET XVARIABLE           02957000
                AIF   (N'&MIGID GT 1).ZE77B                             02957600
.*              ANOP              MULTIPLE PARMS                        02958200
&XMIGID         SETC  '&MIGID'    SET XVARIABLE                         02959000
.ZE77B          ANOP  ,                                                 02960000
.*-------------------------------------------------------------------   02961000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02962000
                AIF   (K'&ZXMIGID LE 0).ZE77R   NOT I/O                 02963000
                AIF   ('&XMIGID'(1,1) NE '(').ZE77R                     02964000
&ZCGPR          SETC  '&XMIGID'(2,K'&XMIGID-2)                          02965000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE77P                      02966000
                AIF   (K'&ZCGPR GT 2).ZE77Q                             02967000
                AIF   ('&ZCGPR' EQ '0').ZE77Q                           02968000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     02969000
                AIF   (T'&ZCGPR NE 'N').ZE77Q   INVALID REG NAME        02970000
.ZE77P          ANOP  ,                                                 02971000
                AIF   (T'&ZCGPR NE 'N').ZE77R   NON NUMERIC             02972000
                AIF   ('&ZCGPR' LT '2').ZE77Q                           02973000
                AIF   ('&ZCGPR' LE '12').ZE77R                          02974000
.ZE77Q          ANOP  ,                                                 02975000
&ZMS            SETC  '"MIGID='   *KGPRA* MNOTE                         02976000
&ZMS            SETC  '&ZMS.&MIGID"'                                    02977000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         02978000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  02979000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02980000
.ZE77R          ANOP  ,                                                 02981000
.*------------------------------------------------------------------    02982000
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02983000
.ZE79           AIF   (K'&XREQUEST GT 0).ZE79A  VALID                   02984000
                AIF   (K'&REQUEST(1) LE 0).ZE79B                        02985000
&ZMS            SETC  '"REQUEST='               *KUKWA* MNOTE           02986000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  02987000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         02988000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               02989000
&ZMS            SETC  '&ZMS "ACTIVATE",'                                02989800
&ZMS            SETC  '&ZMS "DEACTIVATE",'                              02990600
&ZMS            SETC  '&ZMS OR "RELEASE".'                              02991400
                MNOTE 8,' &ZMS '                                        02992200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           02993000
                AGO   .ZE79B                                            02994000
.*                                                                      02995000
.ZE79A          ANOP  ,                                                 02996000
&ZXREQUEST      SETC  'INPUT'     SET IN/OUTPUT                         02997000
.ZE79B          ANOP  ,                                                 02998000
.*----------------------------------------------------------------***   02999000
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         03000000
                AIF   (N'&RTNCODE LE 1).ZE81A   CK NUM                  03001000
&ZMS            SETC  '"RTNCODE='               *KPOSA* MNOTE           03002000
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  03003000
&ZMS            SETC  '&ZMS "RTNCODE"'                                  03004000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               03005000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           03006000
.ZE81A          ANOP  ,                                                 03026000
.*-------------------------------------------------------------------   03046000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    03047000
                AIF   (K'&RTNCODE(1) LE 0).ZE81B NO PRM                 03048000
&ZXRTNCODE      SETC  'OUTPUT'    SET IN/OUTPUT                         03049000
&XRTNCODE       SETC  '&RTNCODE(1)'             SET XVARIABLE           03050000
                AIF   (N'&RTNCODE GT 1).ZE81B                           03050600
.*              ANOP              MULTIPLE PARMS                        03051200
&XRTNCODE       SETC  '&RTNCODE'  SET XVARIABLE                         03052000
.ZE81B          ANOP  ,                                                 03053000
.*-------------------------------------------------------------------   03054000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   03055000
                AIF   (K'&ZXRTNCODE LE 0).ZE81R  NOT I/O                03056000
                AIF   ('&XRTNCODE'(1,1) NE '(').ZE81R                   03057000
&ZCGPR          SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                      03058000
                AIF   ('&ZCGPR'(1,1) NE '0').ZE81P                      03059000
                AIF   (K'&ZCGPR GT 2).ZE81Q                             03060000
                AIF   ('&ZCGPR' EQ '0').ZE81Q                           03061000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     03062000
                AIF   (T'&ZCGPR NE 'N').ZE81Q   INVALID REG NAME        03062800
.ZE81P          ANOP  ,                                                 03063600
                AIF   (T'&ZCGPR NE 'N').ZE81R   NON NUMERIC             03064400
                AIF   ('&ZCGPR' LT '2').ZE81Q                           03065200
                AIF   ('&ZCGPR' LE '12').ZE81R                          03066000
.ZE81Q          ANOP  ,                                                 03066800
&ZMS            SETC  '"RTNCODE='               *KGPRA* MNOTE           03068100
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  03068200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         03068300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  03068400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           03068500
.ZE81R          ANOP  ,                                                 03068600
.*----------------------------------------------------------------***   03068700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         03068800
                AIF   (N'&RSNCODE LE 1).ZE84A   CK NUM                  03068900
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           03069000
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  03069100
&ZMS            SETC  '&ZMS "RSNCODE"'                                  03069200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               03069300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           03069400
.ZE84A          ANOP  ,                                                 03069500
.*-------------------------------------------------------------------   03069600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    03069700
                AIF   (K'&RSNCODE(1) LE 0).ZE84B NO PRM                 03069800
&ZXRSNCODE      SETC  'OUTPUT'    SET IN/OUTPUT                         03069900
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           03070000
                AIF   (N'&RSNCODE GT 1).ZE84B                           03070100
.*              ANOP              MULTIPLE PARMS                        03070200
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         03070300
.ZE84B          ANOP  ,                                                 03070400
.*-------------------------------------------------------------------   03070500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   03070600
                AIF   (K'&ZXRSNCODE LE 0).ZE84R  NOT I/O                03070700
                AIF   ('&XRSNCODE'(1,1) NE '(').ZE84R                   03070800
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      03070900
                AIF   ('&ZCGPR'(1,1) NE '0').ZE84P                      03071000
                AIF   (K'&ZCGPR GT 2).ZE84Q                             03071100
                AIF   ('&ZCGPR' EQ '0').ZE84Q                           03071200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     03071300
                AIF   (T'&ZCGPR NE 'N').ZE84Q   INVALID REG NAME        03071400
.ZE84P          ANOP  ,                                                 03071500
                AIF   (T'&ZCGPR NE 'N').ZE84R   NON NUMERIC             03071600
                AIF   ('&ZCGPR' LT '2').ZE84Q                           03071700
                AIF   ('&ZCGPR' LE '12').ZE84R                          03071800
.ZE84Q          ANOP  ,                                                 03071900
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           03072000
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  03072100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         03072200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  03072300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           03073000
.ZE84R          ANOP  ,                                                 03074000
.******************************************************************     03075000
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        03076000
.******************************************************************     03077000
                ACTR  10000                                             03078000
.*----------------------------------------------------------------***   03079000
.***AF.P02 EXTRA POSITIONALS                                            03080000
                AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS              03081000
&ZCVAL          SETC  ''          ERROR FIELD                           03082000
&ZAWRK          SETA  0           POSITIONAL NUMBER                     03083000
.ZELIST2        ANOP  ,                                                 03084000
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       03085000
                AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE              03086000
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   03087000
                AGO   .ZELIST2                                          03088000
.*                                                                      03089000
.ZELIST3        ANOP  ,                                                 03090000
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             03091000
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          03092000
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   03093000
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            03094000
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    03095000
                MNOTE 8,' &ZMS ARE ALLOWED.'                            03096000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           03097000
.ZELISTX        ANOP  ,                                                 03098000
&ZASYSLNDX      SETA  0                                                 03099000
.*-------------------------------------------------------------------   03100000
.***AE.MF02 MF=(SLME)                                                   03101000
.ZEMFX          ANOP  ,           END OF PARTIAL SYNTAX CHECK           03102000
.*******************************************************************    03103000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       03104000
.*******************************************************************    03105000
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          03106000
.*******************************************************************    03107000
.***AE.01  START OF MCSOPER MACRO CODE                                  03108000
.*******************************************************************    03109000
                LCLC  &M0M0001                 NAME                     03110000
&M0M0001        SETC  '&XLABEL'                SET NAME                 03111000
                AIF   (K'&XLABEL NE 0).XLAB2                            03112000
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             03113000
.*                                                                      03114000
.XLAB2          ANOP  ,                                                 03115000
                AIF   ('&XMF' EQ 'L').XLAB3                             03115500
&M0M0001 DS    0H                             MCSOPER-1                 03116000
.XLAB3          ANOP  ,                                                 03116500
.*******************************************************************    03117000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              03118000
.*******************************************************************    03119000
              PUSH  PRINT                                               03120000
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        03121000
                PRINT OFF         ++ PR01                               03122000
                AGO   .ZPRNTXX                                          03123000
.ZPRINTX        PRINT ON                                                03124000
.ZPRNTXX        ANOP  ,                                                 03125000
.********************************************************************   03126000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     03127000
.********************************************************************   03128000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       03129000
                      LCLA  &ZOPN1         INVOCATION INDEX             03130000
                      LCLC  &ZOPL(4095)    LABEL                        03131000
                      LCLC  &ZOPO(4095)    OPERATION                    03132000
                      LCLC  &ZOPV(4095)    VALUE                        03133000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  03134000
.*                                                                      03135000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     03136000
.******************************************************************     03137000
.***AL.L10 MCSOPER FMT=LIST MF=S|L PARAMETERS                           03138000
.******************************************************************     03139000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     03140000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     03141000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     03142000
&XMFATTR              SETC  '0D'                                        03143000
.*                                                                      03144000
&ZOPN                 SETA  &ZOPN+1                                     03145000
&ZOPL(&ZOPN)          SETC  ' '                                         03146000
&ZOPO(&ZOPN)          SETC  'B'                                         03147000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                03148000
&ZOPD(&ZOPN)          SETC  '++ MCSOPER ARG PARMS'                      03149000
.*                                                                      03150000
&ZOPN                 SETA  &ZOPN+1                                     03151000
&ZOPL(&ZOPN)          SETC  ' '                                         03152000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     03153000
&ZOPV(&ZOPN)          SETC  '1'                                         03154000
&ZOPD(&ZOPN)          SETC  ' '                                         03155000
.*                                                                      03156000
.ZLMFSL2              ANOP  ,                                           03157000
.*-------------------------------------------------------------------   03157100
.***AM.L00  MCSOPER FMT=LIST name                                       03157200
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    03157300
&ZOPN                 SETA &ZOPN+1                                      03157400
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   03157500
&ZOPO(&ZOPN)          SETC 'EQU'                                        03157600
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   03157700
&ZOPD(&ZOPN)          SETC '++ MCSOPER NAME'                            03157800
.ZLMFSL2M             ANOP  ,                                           03157900
.*-------------------------------------------------------------------   03158000
.***AM.L01  MCSOPER FMT=LIST PARAMETERS                                 03159000
&ZOPN                 SETA &ZOPN+1                                      03160000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   03161000
&ZOPO(&ZOPN)          SETC 'DS'                                         03162000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   03163000
&ZOPD(&ZOPN)          SETC '++ MCSOPER PARM LIST'                       03164000
.*-------------------------------------------------------------------   03165000
.***AM.L09  XACRO CL4                                                   03166000
&ZOPN                 SETA &ZOPN+1                                      03167000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRO'                            03168000
&ZOPO(&ZOPN)          SETC 'DS'                                         03169000
&ZOPV(&ZOPN)          SETC 'CL4'                                        03170000
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XACRO'                         03171000
.*-------------------------------------------------------------------   03172000
.***AM.L02 XVERSION XL1                                                 03173000
&ZOPN                 SETA &ZOPN+1                                      03174000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         03175000
&ZOPO(&ZOPN)          SETC 'DS'                                         03176000
&ZOPV(&ZOPN)          SETC 'XL1'                                        03177000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          03178000
.*-------------------------------------------------------------------   03179000
.***AM.L05 XREQUEST XL1                                                 03180000
&ZOPN                 SETA &ZOPN+1                                      03181000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         03182000
&ZOPO(&ZOPN)          SETC 'DS'                                         03183000
&ZOPV(&ZOPN)          SETC 'XL1'                                        03184000
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     03185000
.*                                                                      03186000
&ZOPN                 SETA  &ZOPN+1                                     03187000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._ACTIVATE'                        03188000
&ZOPO(&ZOPN)          SETC  'EQU'                                       03189000
&ZOPV(&ZOPN)          SETC  '1'                                         03190000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              03191000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ACTIVATE'                     03192000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03193000
.*                                                                      03194000
&ZOPN                 SETA  &ZOPN+1                                     03195000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._DEACTIVATE'                      03196000
&ZOPO(&ZOPN)          SETC  'EQU'                                       03197000
&ZOPV(&ZOPN)          SETC  '2'                                         03198000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              03199000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEACTIVATE'                   03200000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03201000
.*                                                                      03202000
&ZOPN                 SETA  &ZOPN+1                                     03203000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._RELEASE'                         03204000
&ZOPO(&ZOPN)          SETC  'EQU'                                       03205000
&ZOPV(&ZOPN)          SETC  '3'                                         03206000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              03207000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RELEASE'                      03208000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03209000
.*-------------------------------------------------------------------   03210000
.***AM.L03 XFLAG BL.8                                                   03211000
&ZOPN                 SETA &ZOPN+1                                      03212000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAG'                            03213000
&ZOPO(&ZOPN)          SETC 'DS'                                         03214000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       03215000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             03216000
.*                                                                      03217000
&ZOPN                 SETA  &ZOPN+1                                     03218000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XABTERM_YES'                     03219000
&ZOPO(&ZOPN)          SETC  'EQU'                                       03220000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             03221000
&ZOPD(&ZOPN)          SETC  '++ XABTERM.'                               03222000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          03223000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03223100
.*                                                                      03223200
&ZOPN                 SETA  &ZOPN+1                                     03223300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MIGID'                   03223400
&ZOPO(&ZOPN)          SETC  'EQU'                                       03223500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             03223600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               03223700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MIGID'                        03223800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03223900
.*                                                                      03224000
&ZOPN                 SETA  &ZOPN+1                                     03224100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMIGIDREL_AUTO'                  03224200
&ZOPO(&ZOPN)          SETC  'EQU'                                       03224300
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             03224400
&ZOPD(&ZOPN)          SETC  '++ XMIGIDREL.'                             03224500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).AUTO'                         03224600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03224700
.*-------------------------------------------------------------------   03225000
.***AM.L09  XRSV0001 CL1                                                03226000
&ZOPN                 SETA &ZOPN+1                                      03227000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         03228000
&ZOPO(&ZOPN)          SETC 'DS'                                         03229000
&ZOPV(&ZOPN)          SETC 'CL1'                                        03230000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      03231000
.*-------------------------------------------------------------------   03232000
.***AM.L09  XOPERPARM A                                                 03233000
&ZOPN                 SETA &ZOPN+1                                      03234000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPERPARM'                        03235000
&ZOPO(&ZOPN)          SETC 'DS'                                         03236000
&ZOPV(&ZOPN)          SETC 'A'                                          03237000
&ZOPD(&ZOPN)          SETC '++ &ZXOPERPARM  XOPERPARM'                  03238000
.*-------------------------------------------------------------------   03239000
.***AM.L09  XNAME CL8                                                   03240000
&ZOPN                 SETA &ZOPN+1                                      03241000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNAME'                            03242000
&ZOPO(&ZOPN)          SETC 'DS'                                         03243000
&ZOPV(&ZOPN)          SETC 'CL8'                                        03244000
&ZOPD(&ZOPN)          SETC '++ &ZXNAME  XNAME'                          03245000
.*-------------------------------------------------------------------   03246000
.***AM.L09  XTERMNAME CL8                                               03247000
&ZOPN                 SETA &ZOPN+1                                      03248000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTERMNAME'                        03249000
&ZOPO(&ZOPN)          SETC 'DS'                                         03250000
&ZOPV(&ZOPN)          SETC 'CL8'                                        03251000
&ZOPD(&ZOPN)          SETC '++ &ZXTERMNAME  XTERMNAME'                  03252000
.*-------------------------------------------------------------------   03253000
.***AM.L09  XCONSID F                                                   03254000
&ZOPN                 SETA &ZOPN+1                                      03255000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONSID'                          03256000
&ZOPO(&ZOPN)          SETC 'DS'                                         03257000
&ZOPV(&ZOPN)          SETC 'F'                                          03258000
&ZOPD(&ZOPN)          SETC '++ &ZXCONSID  XCONSID'                      03259000
.*-------------------------------------------------------------------   03260000
.***AM.L09  XQLIMIT F                                                   03261000
&ZOPN                 SETA &ZOPN+1                                      03262000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQLIMIT'                          03263000
&ZOPO(&ZOPN)          SETC 'DS'                                         03264000
&ZOPV(&ZOPN)          SETC 'F'                                          03265000
&ZOPD(&ZOPN)          SETC '++ &ZXQLIMIT  XQLIMIT'                      03266000
.*-------------------------------------------------------------------   03267000
.***AM.L09  XMCSCSAA F                                                  03268000
&ZOPN                 SETA &ZOPN+1                                      03269000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMCSCSAA'                         03270000
&ZOPO(&ZOPN)          SETC 'DS'                                         03271000
&ZOPV(&ZOPN)          SETC 'F'                                          03272000
&ZOPD(&ZOPN)          SETC '++ &ZXMCSCSAA  XMCSCSAA'                    03273000
.*-------------------------------------------------------------------   03274000
.***AM.L09  XMCSCSA A                                                   03275000
&ZOPN                 SETA &ZOPN+1                                      03276000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMCSCSA'                          03277000
&ZOPO(&ZOPN)          SETC 'DS'                                         03278000
&ZOPV(&ZOPN)          SETC 'A'                                          03279000
&ZOPD(&ZOPN)          SETC '++ &ZXMCSCSA  XMCSCSA'                      03280000
.*-------------------------------------------------------------------   03281000
.***AM.L09  XRSV0002 CL4                                                03282000
&ZOPN                 SETA &ZOPN+1                                      03283000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         03284000
&ZOPO(&ZOPN)          SETC 'DS'                                         03285000
&ZOPV(&ZOPN)          SETC 'CL4'                                        03286000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      03287000
.*-------------------------------------------------------------------   03288000
.***AM.L09  XMSGECB A                                                   03289000
&ZOPN                 SETA &ZOPN+1                                      03290000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSGECB'                          03291000
&ZOPO(&ZOPN)          SETC 'DS'                                         03292000
&ZOPV(&ZOPN)          SETC 'A'                                          03293000
&ZOPD(&ZOPN)          SETC '++ &ZXMSGECB  XMSGECB'                      03294000
.*-------------------------------------------------------------------   03295000
.***AM.L09  XALERTECB A                                                 03296000
&ZOPN                 SETA &ZOPN+1                                      03297000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XALERTECB'                        03298000
&ZOPO(&ZOPN)          SETC 'DS'                                         03299000
&ZOPV(&ZOPN)          SETC 'A'                                          03300000
&ZOPD(&ZOPN)          SETC '++ &ZXALERTECB  XALERTECB'                  03301000
.*-------------------------------------------------------------------   03302000
.***AM.L09  XMIGID XL1                                                  03303000
&ZOPN                 SETA &ZOPN+1                                      03304000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMIGID'                           03305000
&ZOPO(&ZOPN)          SETC 'DS'                                         03306000
&ZOPV(&ZOPN)          SETC 'XL1'                                        03307000
&ZOPD(&ZOPN)          SETC '++ &ZXMIGID  XMIGID'                        03308000
.*-------------------------------------------------------------------   03309000
.***AM.L09  XALERTPCT XL1                                               03310000
&ZOPN                 SETA &ZOPN+1                                      03311000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XALERTPCT'                        03312000
&ZOPO(&ZOPN)          SETC 'DS'                                         03313000
&ZOPV(&ZOPN)          SETC 'XL1'                                        03314000
&ZOPD(&ZOPN)          SETC '++ &ZXALERTPCT  XALERTPCT'                  03315000
.*-------------------------------------------------------------------   03316000
.***AM.L09  XQRESUME XL1                                                03317000
&ZOPN                 SETA &ZOPN+1                                      03318000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQRESUME'                         03319000
&ZOPO(&ZOPN)          SETC 'DS'                                         03320000
&ZOPV(&ZOPN)          SETC 'XL1'                                        03321000
&ZOPD(&ZOPN)          SETC '++ &ZXQRESUME  XQRESUME'                    03322000
.*-------------------------------------------------------------------   03323000
.***AM.L05 XMSGDLVRY XL1                                                03324000
&ZOPN                 SETA &ZOPN+1                                      03325000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSGDLVRY'                        03326000
&ZOPO(&ZOPN)          SETC 'DS'                                         03327000
&ZOPV(&ZOPN)          SETC 'XL1'                                        03328000
&ZOPD(&ZOPN)          SETC '++ &ZXMSGDLVRY XMSGDLVRY'                   03329000
.*                                                                      03330000
&ZOPN                 SETA  &ZOPN+1                                     03331000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._FIFO'                            03332000
&ZOPO(&ZOPN)          SETC  'EQU'                                       03333000
&ZOPV(&ZOPN)          SETC  '128'                                       03334000
&ZOPD(&ZOPN)          SETC  '++ XMSGDLVRY.'                             03335000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).FIFO'                         03336000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03337000
.*                                                                      03338000
&ZOPN                 SETA  &ZOPN+1                                     03339000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._SEARCH'                          03340000
&ZOPO(&ZOPN)          SETC  'EQU'                                       03341000
&ZOPV(&ZOPN)          SETC  '64'                                        03342000
&ZOPD(&ZOPN)          SETC  '++ XMSGDLVRY.'                             03343000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SEARCH'                       03344000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03345000
.*                                                                      03346000
&ZOPN                 SETA  &ZOPN+1                                     03347000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._NONE'                            03348000
&ZOPO(&ZOPN)          SETC  'EQU'                                       03349000
&ZOPV(&ZOPN)          SETC  '32'                                        03350000
&ZOPD(&ZOPN)          SETC  '++ XMSGDLVRY.'                             03351000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NONE'                         03352000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      03353000
.*-------------------------------------------------------------------   03354000
.***AM.L09  XRSV0003 CL16                                               03355000
&ZOPN                 SETA &ZOPN+1                                      03356000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         03357000
&ZOPO(&ZOPN)          SETC 'DS'                                         03358000
&ZOPV(&ZOPN)          SETC 'CL16'                                       03359000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0003'                      03360000
.*-------------------------------------------------------------------   03361000
.***AM.L10 END OF MCSOPER LIST PARAMETERS                               03362000
&ZOPN                 SETA &ZOPN+1                                      03363000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 03364000
&ZOPO(&ZOPN)          SETC 'EQU'                                        03365000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 03366000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         03367000
.*                                                                      03368000
&ZOPN                 SETA &ZOPN+1                                      03369000
&ZOPL(&ZOPN)          SETC ' '                                          03370000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      03371000
&ZOPV(&ZOPN)          SETC '1'                                          03372000
&ZOPD(&ZOPN)          SETC ' '                                          03373000
.*-------------------------------------------------------------------   03374000
.***AL.L12 MCSOPER FMT=LIST MF=S|L PARAMETERS                           03375000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         03376000
.*                                                                      03377000
&ZOPN                 SETA  &ZOPN+1                                     03378000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                03379000
&ZOPO(&ZOPN)          SETC  'DC'                                        03380000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   03381000
&ZOPD(&ZOPN)          SETC  '++ MCSOPER ARG PARMS'                      03382000
.*                                                                      03383000
.ZLMFSLX              ANOP  ,                                           03384000
.*-------------------------------------------------------------------   03385000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          03386000
&ZPLLEN               SETA 76                                           03387000
.*                                                                      03388000
.******************************************************************     03389000
.***AI.L01 MCSOPER FMT=LIST FILL IN PARAMETER AREA                      03390000
.******************************************************************     03391000
                      ACTR  10000                                       03392000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               03393000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    03394000
&ZCVAL                SETC  'LAE'          XAX MODE                     03395000
.ZIMFXA               ANOP ,                                            03396000
.*                                                                      03397000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    03398000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         03399000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 03400000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                03401000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 03402000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                03403000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   03404000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    03405000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   03406000
&ZOPN                 SETA  &ZOPN+1                                     03407000
&ZOPL(&ZOPN)          SETC  ' '                                         03408000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    03409000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              03410000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       03411000
                      AGO   .ZIMFNX                                     03412000
.*                                                                      03413000
.ZIMFN2               ANOP ,                                            03414000
&ZOPN                 SETA  &ZOPN+1                                     03415000
&ZOPL(&ZOPN)          SETC  ' '                                         03416000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    03417000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                03418000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       03419000
.ZIMFNX               ANOP ,                                            03420000
.********************************************************************   03421000
.***AI.L02 MCSOPER FMT=LIST INITIALIZE PARAMETER AREA                   03422000
.********************************************************************   03423000
.***AI.L03 MF=(SLME)                                                    03424000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      03425000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            03426000
.*                                                                      03427000
&ZOPN                 SETA  &ZOPN+1                                     03428000
&ZOPL(&ZOPN)          SETC  ' '                                         03429000
&ZOPO(&ZOPN)          SETC  'XC'                                        03430000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         03431000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             03432000
.ZIMFLX               ANOP  ,                                           03433000
.*-------------------------------------------------------------------   03434000
.***AI.L60 XACRO CL4                                                    03435000
&ZOPN                 SETA  &ZOPN+1                                     03436000
&ZOPL(&ZOPN)          SETC  ' '                                         03437000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03438000
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''MCSO'''                       03439000
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           03440000
.*-------------------------------------------------------------------   03441000
.***AI.L04B XVERSION XL1                                                03442000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFVZ            03443000
&ZOPN                 SETA  &ZOPN+1                                     03444000
&ZOPL(&ZOPN)          SETC  ' '                                         03445000
&ZOPO(&ZOPN)          SETC  'MVI'                                       03446000
&ZOPV(&ZOPN)          SETC  '4(1),1'                                    03447000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     03448000
.ZIMFVZ               ANOP  ,                                           03449000
.*-------------------------------------------------------------------   03450000
.***AI.L07 XREQUEST AL1                                                 03451000
&ZW                   SETC  ''                                          03452000
.*-------------------------------------------------------------------   03453000
.***AI.L15 XREQUEST "ACTIVATE" AL1                                      03454000
         AIF   ('&XREQUEST' NE 'ACTIVATE').ZI4A                         03455000
&ZW                   SETC  '1'                                         03456000
.ZI4A                 ANOP  ,                                           03457000
.*-------------------------------------------------------------------   03458000
.***AI.L15 XREQUEST "DEACTIVATE" AL1                                    03459000
         AIF   ('&XREQUEST' NE 'DEACTIVATE').ZI5A                       03460000
&ZW                   SETC  '2'                                         03461000
.ZI5A                 ANOP  ,                                           03462000
.*-------------------------------------------------------------------   03463000
.***AI.L15 XREQUEST "RELEASE" AL1                                       03464000
         AIF   ('&XREQUEST' NE 'RELEASE').ZI6A                          03465000
&ZW                   SETC  '3'                                         03466000
.ZI6A                 ANOP  ,                                           03467000
.*-------------------------------------------------------------------   03468000
.***AI.L17 XREQUEST AL1                                                 03469000
                      AIF   ('&ZW' NE '0').ZI6C                         03470000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI6B              03471000
.ZI6C                 ANOP  ,                                           03472000
                      AIF   ('&ZW' EQ '').ZI6B                          03473000
.*                                                                      03474000
&ZOPN                 SETA  &ZOPN+1                                     03475000
&ZOPL(&ZOPN)          SETC  ' '                                         03476000
&ZOPO(&ZOPN)          SETC  'MVI'                                       03477000
&ZOPV(&ZOPN)          SETC  '5(1),&ZW'                                  03478000
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    03479000
.ZI6B                 ANOP  ,                                           03480000
.*-------------------------------------------------------------------   03481000
.***AI.L05 XFLAG BL1                                                    03482000
&ZW                   SETC  ''                                          03483000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            03484000
&ZMS                  SETC  ''                                          03485000
&ZC                   SETC  ''                                          03486000
.*-------------------------------------------------------------------   03487000
.***AI.L08 XFLAG "YES"                                                  03488000
.***      BL1'1XXXXXXX'                                                 03489000
         AIF   ('&XABTERM' NE 'YES').ZI8A                               03490000
&ZW                   SETC  '&ZW.1'                                     03491000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              03492000
&ZMS                  SETC  '&ZMS.1'                                    03493000
                      AGO   .ZI8C                                       03494000
.*                                                                      03495000
.ZI8A                 ANOP  ,                                           03496000
&ZW                   SETC  '&ZW.0'                                     03497000
         AIF   ('&ZXABTERM' EQ '').ZI8B                                 03498000
&ZMS                  SETC  '&ZMS.0'                                    03499000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             03500000
                      AGO   .ZI8C                                       03501000
.*                                                                      03502000
.ZI8B                 ANOP  ,                                           03503000
&ZMS                  SETC  '&ZMS.1'                                    03504000
.ZI8C                 ANOP  ,                                           03505000
.*-------------------------------------------------------------------   03506000
.***AI.L08 XFLAG "MIGID"                                                03506200
.***      BL1'X1XXXXXX'                                                 03506400
         AIF   ('&MIGID' EQ '').ZI9A                                    03506600
&ZW                   SETC  '&ZW.1'                                     03506800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              03507000
&ZMS                  SETC  '&ZMS.0'                                    03507200
                      AGO   .ZI9C                                       03507400
.*                                                                      03507600
.ZI9A                 ANOP  ,                                           03507800
&ZW                   SETC  '&ZW.0'                                     03508000
&ZMS                  SETC  '&ZMS.1'                                    03508200
.ZI9C                 ANOP  ,                                           03508400
.*-------------------------------------------------------------------   03508600
.***AI.L08 XFLAG "AUTO"                                                 03508700
.***      BL1'XX1XXXXX'                                                 03508800
         AIF   ('&XMIGIDREL' NE 'AUTO').ZI10A                           03508900
&ZW                   SETC  '&ZW.100000'                                03509000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              03509100
&ZMS                  SETC  '&ZMS.111111'                               03509200
                      AGO   .ZI10C                                      03509300
.*                                                                      03509400
.ZI10A                ANOP  ,                                           03509500
&ZW                   SETC  '&ZW.000000'                                03509600
         AIF   ('&ZXMIGIDREL' EQ '').ZI10B                              03509700
&ZMS                  SETC  '&ZMS.011111'                               03509800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             03509900
                      AGO   .ZI10C                                      03510000
.*                                                                      03510100
.ZI10B                ANOP  ,                                           03510200
&ZMS                  SETC  '&ZMS.111111'                               03510300
.ZI10C                ANOP  ,                                           03510400
.*-------------------------------------------------------------------   03510500
.***AI.L11 XFLAG BL1                                                    03510600
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI10D              03510700
                      AIF   ('&ZC' NE 'YES').ZI10D                      03510800
&ZOPN                 SETA  &ZOPN+1                                     03510900
&ZOPL(&ZOPN)          SETC  ' '                                         03511000
&ZOPO(&ZOPN)          SETC  'NI'                                        03512000
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZMS'''                            03513000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              03514000
.ZI10D                ANOP  ,                                           03515000
                      AIF   ('&ZCLNG' NE 'YES').ZI10E  ALL ZERO BITS    03516000
&ZOPN                 SETA  &ZOPN+1                                     03517000
&ZOPL(&ZOPN)          SETC  ' '                                         03518000
&ZOPO(&ZOPN)          SETC  'OI'                                        03519000
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZW'''                             03520000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              03521000
.ZI10E                ANOP  ,                                           03522000
.*-------------------------------------------------------------------   03523000
.***AI.L18  XOPERPARM A                                                 03524000
         AIF   ('&XOPERPARM' NE '0').ZI12                               03525000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI12  CK *        03526000
&ZXOPERPARM           SETC  ''             RESET INPUT/OUTPUT           03527000
.ZI12                 ANOP  ,                                           03528000
.*-------------------------------------------------------------------   03529000
.***AI.L19  XOPERPARM A                                                 03530000
                      AIF   ('&ZXOPERPARM' EQ '').ZI12H                 03531000
&ZCLNG                SETC  '&XOPERPARM'                                03532000
&ZCGPR                SETC  '14'                                        03533000
         AIF   ('&XOPERPARM'(1,1) EQ '(').ZI12F  IN GPR                 03534000
        AIF   ('&XOPERPARM' NE '0').ZI12A                               03535000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI12H             03536000
.*                                                                      03537000
&ZCLNG                SETC  '=XL4''00'''                                03538000
.ZI12A                ANOP  ,                                           03539000
.*                                                                      03540000
&ZOPN                 SETA  &ZOPN+1                                     03541000
&ZOPL(&ZOPN)          SETC  ' '                                         03542000
&ZOPO(&ZOPN)          SETC  'LA'                                        03543000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             03544000
&ZOPD(&ZOPN)          SETC  '++ &ZXOPERPARM XOPERPARM'                  03545000
.*                                                                      03546000
                      AGO   .ZI12G                                      03547000
.*                                                                      03548000
.ZI12F                ANOP  ,                                           03549000
&ZCGPR   SETC  '&XOPERPARM'(2,K'&XOPERPARM-2)                           03550000
.*                                                                      03551000
.ZI12G                ANOP  ,                                           03552000
.*                                                                      03553000
&ZOPN                 SETA  &ZOPN+1                                     03554000
&ZOPL(&ZOPN)          SETC  ' '                                         03555000
&ZOPO(&ZOPN)          SETC  'ST'                                        03556000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              03557000
&ZOPD(&ZOPN)          SETC  '++ &ZXOPERPARM XOPERPARM'                  03558000
.*                                                                      03559000
.ZI12H                ANOP  ,                                           03560000
.*-------------------------------------------------------------------   03561000
.***AI.L25  XNAME CL8                                                   03562000
                      AIF   ('&ZXNAME' EQ '').ZI13E                     03563000
                      AIF   ('&ZXNAME' EQ 'OUTPUT').ZI13E               03564000
&ZCGPR                SETC  '&XNAME'                                    03565000
.*                                                                      03566000
                      AIF   ('&XNAME'(1,1) NE '(').ZI13B                03567000
&ZCGPR   SETC  '0('.'&XNAME'(2,K'&XNAME-2).')'                          03568000
.ZI13B                ANOP  ,                                           03586000
.*                                                                      03587000
&ZOPN                 SETA  &ZOPN+1                                     03588000
&ZOPL(&ZOPN)          SETC  ' '                                         03589000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03590000
&ZOPV(&ZOPN)          SETC  '12(8,1),&ZCGPR'                            03591000
&ZOPD(&ZOPN)          SETC  '++ &ZXNAME XNAME'                          03592000
.*                                                                      03593000
.ZI13E                ANOP  ,                                           03594000
.*-------------------------------------------------------------------   03595000
.***AI.L25  XTERMNAME CL8                                               03596000
                      AIF   ('&ZXTERMNAME' EQ '').ZI14E                 03597000
                      AIF   ('&ZXTERMNAME' EQ 'OUTPUT').ZI14E           03598000
&ZCGPR                SETC  '&XTERMNAME'                                03599000
.*                                                                      03600000
                      AIF   ('&XTERMNAME'(1,1) NE '(').ZI14B            03601300
&ZCGPR   SETC  '0('.'&XTERMNAME'(2,K'&XTERMNAME-2).')'                  03602600
.ZI14B                ANOP  ,                                           03604000
.*                                                                      03611000
&ZOPN                 SETA  &ZOPN+1                                     03612000
&ZOPL(&ZOPN)          SETC  ' '                                         03613000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03614000
&ZOPV(&ZOPN)          SETC  '20(8,1),&ZCGPR'                            03615000
&ZOPD(&ZOPN)          SETC  '++ &ZXTERMNAME XTERMNAME'                  03616000
.*                                                                      03617000
.ZI14E                ANOP  ,                                           03618000
.*-------------------------------------------------------------------   03619000
.***AI.L25  XCONSID F                                                   03620000
                      AIF   ('&ZXCONSID' EQ '').ZI15E                   03621000
                      AIF   ('&ZXCONSID' EQ 'OUTPUT').ZI15E             03622000
&ZCGPR                SETC  '&XCONSID'                                  03623000
.*                                                                      03624000
                      AIF   ('&XCONSID'(1,1) NE '(').ZI15B              03625000
&ZCGPR   SETC  '0('.'&XCONSID'(2,K'&XCONSID-2).')'                      03626000
                      AGO   .ZI15D                                      03627000
.ZI15B                ANOP  ,                                           03628000
.*                                                                      03629000
&ZC                   SETC  '&XCONSID'(1,1)                             03630000
                      AIF   (T'&ZC NE 'N').ZI15D                        03631000
&ZC                   SETC  '&XCONSID'                                  03631500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               03632000
&ZCGPR                SETC  '=FL4''&XCONSID'''                          03632500
.*                                                                      03633000
.ZI15D                ANOP  ,                                           03634000
.*                                                                      03635000
&ZOPN                 SETA  &ZOPN+1                                     03636000
&ZOPL(&ZOPN)          SETC  ' '                                         03637000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03638000
&ZOPV(&ZOPN)          SETC  '28(4,1),&ZCGPR'                            03639000
&ZOPD(&ZOPN)          SETC  '++ &ZXCONSID XCONSID'                      03640000
.*                                                                      03641000
.ZI15E                ANOP  ,                                           03642000
.*-------------------------------------------------------------------   03643000
.***AI.L25  XQLIMIT F                                                   03643100
                      AIF   ('&ZXQLIMIT' EQ '').ZI16E                   03643200
                      AIF   ('&ZXQLIMIT' EQ 'OUTPUT').ZI16E             03643300
&ZCGPR                SETC  '&XQLIMIT'                                  03643400
.*                                                                      03643500
                      AIF   ('&XQLIMIT'(1,1) NE '(').ZI16B              03643600
&ZCGPR   SETC  '0('.'&XQLIMIT'(2,K'&XQLIMIT-2).')'                      03643700
                      AGO   .ZI16D                                      03643800
.ZI16B                ANOP  ,                                           03643900
.*                                                                      03644000
&ZC                   SETC  '&XQLIMIT'(1,1)                             03644100
                      AIF   (T'&ZC NE 'N').ZI16D                        03644200
&ZC                   SETC  '&XQLIMIT'                                  03644300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               03644400
&ZCGPR                SETC  '=FL4''&XQLIMIT'''                          03644500
.*                                                                      03644600
.ZI16D                ANOP  ,                                           03644700
.*                                                                      03644800
&ZOPN                 SETA  &ZOPN+1                                     03644900
&ZOPL(&ZOPN)          SETC  ' '                                         03645000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03645100
&ZOPV(&ZOPN)          SETC  '32(4,1),&ZCGPR'                            03645200
&ZOPD(&ZOPN)          SETC  '++ &ZXQLIMIT XQLIMIT'                      03645300
.*                                                                      03645400
.ZI16E                ANOP  ,                                           03645500
.*-------------------------------------------------------------------   03645600
.***AI.L19  XMSGECB A                                                   03645700
                      AIF   ('&ZXMSGECB' EQ '').ZI20H                   03645800
&ZCLNG                SETC  '&XMSGECB'                                  03646000
&ZCGPR                SETC  '14'                                        03647000
         AIF   ('&XMSGECB'(1,1) EQ '(').ZI20F  IN GPR                   03648000
.*                                                                      03649000
&ZOPN                 SETA  &ZOPN+1                                     03650000
&ZOPL(&ZOPN)          SETC  ' '                                         03651000
&ZOPO(&ZOPN)          SETC  'LA'                                        03652000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             03653000
&ZOPD(&ZOPN)          SETC  '++ &ZXMSGECB XMSGECB'                      03673000
.*                                                                      03693000
                      AGO   .ZI20G                                      03694000
.*                                                                      03695000
.ZI20F                ANOP  ,                                           03696000
&ZCGPR   SETC  '&XMSGECB'(2,K'&XMSGECB-2)                               03697000
.*                                                                      03698000
.ZI20G                ANOP  ,                                           03699000
.*                                                                      03700000
&ZOPN                 SETA  &ZOPN+1                                     03701000
&ZOPL(&ZOPN)          SETC  ' '                                         03702000
&ZOPO(&ZOPN)          SETC  'ST'                                        03703000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,48(,1)'                             03704000
&ZOPD(&ZOPN)          SETC  '++ &ZXMSGECB XMSGECB'                      03705000
.*                                                                      03706000
.ZI20H                ANOP  ,                                           03707000
.*-------------------------------------------------------------------   03708000
.***AI.L18  XALERTECB A                                                 03708300
         AIF   ('&XALERTECB' NE '0').ZI21                               03708600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI21  CK *        03708900
&ZXALERTECB           SETC  ''             RESET INPUT/OUTPUT           03709200
.ZI21                 ANOP  ,                                           03709500
.*-------------------------------------------------------------------   03709800
.***AI.L19  XALERTECB A                                                 03710100
                      AIF   ('&ZXALERTECB' EQ '').ZI21H                 03710400
&ZCLNG                SETC  '&XALERTECB'                                03710700
&ZCGPR                SETC  '14'                                        03711000
         AIF   ('&XALERTECB'(1,1) EQ '(').ZI21F  IN GPR                 03711300
        AIF   ('&XALERTECB' NE '0').ZI21A                               03711600
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI21H             03711900
.*                                                                      03713000
&ZCLNG                SETC  '=XL4''00'''                                03716600
.ZI21A                ANOP  ,                                           03720200
.*                                                                      03724000
&ZOPN                 SETA  &ZOPN+1                                     03725000
&ZOPL(&ZOPN)          SETC  ' '                                         03726000
&ZOPO(&ZOPN)          SETC  'LA'                                        03727000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             03728000
&ZOPD(&ZOPN)          SETC  '++ &ZXALERTECB XALERTECB'                  03729000
.*                                                                      03730000
                      AGO   .ZI21G                                      03730100
.*                                                                      03730200
.ZI21F                ANOP  ,                                           03730300
&ZCGPR   SETC  '&XALERTECB'(2,K'&XALERTECB-2)                           03730400
.*                                                                      03730500
.ZI21G                ANOP  ,                                           03730600
.*                                                                      03730700
&ZOPN                 SETA  &ZOPN+1                                     03730800
&ZOPL(&ZOPN)          SETC  ' '                                         03730900
&ZOPO(&ZOPN)          SETC  'ST'                                        03731000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,52(,1)'                             03731100
&ZOPD(&ZOPN)          SETC  '++ &ZXALERTECB XALERTECB'                  03731200
.*                                                                      03731300
.ZI21H                ANOP  ,                                           03731400
.*-------------------------------------------------------------------   03732000
.***AI.L25  XMIGID XL1                                                  03733000
                      AIF   ('&ZXMIGID' EQ '').ZI22E                    03734000
                      AIF   ('&ZXMIGID' EQ 'OUTPUT').ZI22E              03735000
&ZCGPR                SETC  '&XMIGID'                                   03736000
.*                                                                      03737000
                      AIF   ('&XMIGID'(1,1) NE '(').ZI22B               03738000
&ZCGPR   SETC  '0('.'&XMIGID'(2,K'&XMIGID-2).')'                        03739000
                      AGO   .ZI22D                                      03740000
.ZI22B                ANOP  ,                                           03741000
.*                                                                      03742000
&ZC                   SETC  '&XMIGID'(1,1)                              03743000
                      AIF   (T'&ZC NE 'N').ZI22D                        03744000
&ZC                   SETC  '&XMIGID'                                   03744500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI22D               03745000
&ZCGPR                SETC  '=AL1(&XMIGID)'                             03745500
.*                                                                      03746000
.ZI22D                ANOP  ,                                           03747000
.*                                                                      03748000
&ZOPN                 SETA  &ZOPN+1                                     03749000
&ZOPL(&ZOPN)          SETC  ' '                                         03750000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03751000
&ZOPV(&ZOPN)          SETC  '56(1,1),&ZCGPR'                            03752000
&ZOPD(&ZOPN)          SETC  '++ &ZXMIGID XMIGID'                        03753000
.*                                                                      03754000
.ZI22E                ANOP  ,                                           03755000
.*-------------------------------------------------------------------   03756000
.***AI.L25  XALERTPCT XL1                                               03758600
                      AIF   ('&ZXALERTPCT' EQ '').ZI23E                 03761200
                      AIF   ('&ZXALERTPCT' EQ 'OUTPUT').ZI23E           03763800
&ZCGPR                SETC  '&XALERTPCT'                                03766400
.*                                                                      03769000
                      AIF   ('&XALERTPCT'(1,1) NE '(').ZI23B            03771000
&ZCGPR   SETC  '0('.'&XALERTPCT'(2,K'&XALERTPCT-2).')'                  03773000
                      AGO   .ZI23D                                      03775000
.ZI23B                ANOP  ,                                           03776000
.*                                                                      03777000
&ZC                   SETC  '&XALERTPCT'(1,1)                           03778000
                      AIF   (T'&ZC NE 'N').ZI23D                        03779000
&ZC                   SETC  '&XALERTPCT'                                03779500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI23D               03780000
&ZCGPR                SETC  '=AL1(&XALERTPCT)'                          03780500
.*                                                                      03781000
.ZI23D                ANOP  ,                                           03782000
.*                                                                      03783000
&ZOPN                 SETA  &ZOPN+1                                     03784000
&ZOPL(&ZOPN)          SETC  ' '                                         03785000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03786000
&ZOPV(&ZOPN)          SETC  '57(1,1),&ZCGPR'                            03787000
&ZOPD(&ZOPN)          SETC  '++ &ZXALERTPCT XALERTPCT'                  03788000
.*                                                                      03789000
.ZI23E                ANOP  ,                                           03790000
.*-------------------------------------------------------------------   03790100
.***AI.L18  XQRESUME XL1                                                03790200
         AIF   ('&XQRESUME' NE '0').ZI24                                03790300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI24  CK *        03790400
&ZXQRESUME            SETC  ''             RESET INPUT/OUTPUT           03790500
.ZI24                 ANOP  ,                                           03790600
.*-------------------------------------------------------------------   03790700
.***AI.L25  XQRESUME XL1                                                03790800
                      AIF   ('&ZXQRESUME' EQ '').ZI24E                  03790900
                      AIF   ('&ZXQRESUME' EQ 'OUTPUT').ZI24E            03791000
&ZCGPR                SETC  '&XQRESUME'                                 03791100
         AIF   ('&XQRESUME' NE '0').ZI24A                               03791200
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI24E                          03791300
.*                                                                      03791400
&ZCGPR                SETC  '=XL1''00'''                                03791500
.ZI24A                ANOP  ,                                           03791600
.*                                                                      03791700
                      AIF   ('&XQRESUME'(1,1) NE '(').ZI24B             03791800
&ZCGPR   SETC  '0('.'&XQRESUME'(2,K'&XQRESUME-2).')'                    03791900
                      AGO   .ZI24D                                      03792000
.ZI24B                ANOP  ,                                           03792100
.*                                                                      03792200
&ZC                   SETC  '&XQRESUME'(1,1)                            03792300
                      AIF   (T'&ZC NE 'N').ZI24D                        03792400
&ZC                   SETC  '&XQRESUME'                                 03792500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI24D               03792600
&ZCGPR                SETC  '=AL1(&XQRESUME)'                           03792700
.*                                                                      03792800
.ZI24D                ANOP  ,                                           03792900
.*                                                                      03793000
&ZOPN                 SETA  &ZOPN+1                                     03793100
&ZOPL(&ZOPN)          SETC  ' '                                         03793200
&ZOPO(&ZOPN)          SETC  'MVC'                                       03793300
&ZOPV(&ZOPN)          SETC  '58(1,1),&ZCGPR'                            03793400
&ZOPD(&ZOPN)          SETC  '++ &ZXQRESUME XQRESUME'                    03793500
.*                                                                      03793600
.ZI24E                ANOP  ,                                           03793700
.*-------------------------------------------------------------------   03793800
.***AI.L07 XMSGDLVRY AL1                                                03793900
&ZW                   SETC  ''                                          03794000
.*-------------------------------------------------------------------   03794100
.***AI.L15 XMSGDLVRY "FIFO" AL1                                         03795000
         AIF   ('&XMSGDLVRY' NE 'FIFO').ZI26A                           03796000
&ZW                   SETC  '128'                                       03797000
.ZI26A                ANOP  ,                                           03808000
.*-------------------------------------------------------------------   03809000
.***AI.L15 XMSGDLVRY "SEARCH" AL1                                       03809100
         AIF   ('&XMSGDLVRY' NE 'SEARCH').ZI27A                         03809200
&ZW                   SETC  '64'                                        03809300
.ZI27A                ANOP  ,                                           03809400
.*-------------------------------------------------------------------   03809500
.***AI.L15 XMSGDLVRY "NONE" AL1                                         03810000
         AIF   ('&XMSGDLVRY' NE 'NONE').ZI28A                           03810500
&ZW                   SETC  '32'                                        03811000
.ZI28A                ANOP  ,                                           03811500
.*-------------------------------------------------------------------   03812000
.***AI.L17 XMSGDLVRY AL1                                                03812500
                      AIF   ('&ZW' NE '0').ZI28C                        03813000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI28B             03813500
.ZI28C                ANOP  ,                                           03814000
                      AIF   ('&ZW' EQ '').ZI28B                         03814500
.*                                                                      03815000
&ZOPN                 SETA  &ZOPN+1                                     03816000
&ZOPL(&ZOPN)          SETC  ' '                                         03817000
&ZOPO(&ZOPN)          SETC  'MVI'                                       03818000
&ZOPV(&ZOPN)          SETC  '59(1),&ZW'                                 03819000
&ZOPD(&ZOPN)          SETC  '++ &ZXMSGDLVRY XMSGDLVRY'                  03820000
.ZI28B                ANOP  ,                                           03821000
.*-------------------------------------------------------------------   03822000
&ZOPN1                SETA &ZOPN                                        03823000
.*-------------------------------------------------------------------   03824000
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              03825000
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         03826000
.*******************************************************************    03827000
.***  PROCESS MCSOPER OUTPUT PARAMETERS                                 03828000
.*******************************************************************    03829000
                      ACTR  10000                                       03830000
.*------------------------------------------------------------------    03831000
.***AO.L02 XCONSID F                                                    03832000
         AIF   ('&ZXCONSID' EQ 'OUTPUT').ZO15A  OUTPUT                  03833000
         AIF   ('&ZXCONSID' NE 'INOUT').ZO15C  INOUT                    03834000
.ZO15A    AIF   ('&XCONSID'(1,1) NE '(').ZO15B  ADDR IN GPR             03835000
&ZCGPR   SETC  '&XCONSID'(2,K'&XCONSID-2)                               03836000
&ZOPN                 SETA  &ZOPN+1                                     03837000
&ZOPL(&ZOPN)          SETC  ' '                                         03838000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03839000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),28(1)'                         03840000
&ZOPD(&ZOPN)          SETC  '++ XCONSID F'                              03841000
                      AGO   .ZO15C                                      03842000
.*                                                                      03843000
.ZO15B                ANOP  ,                                           03843500
&ZAWRK   SETA  K'&XCONSID                                               03844100
         AIF   ('&XCONSID'(&ZAWRK,1) NE ')').ZO15G                      03844200
&ZN      SETA  2                                                        03844300
.ZO15H    ANOP                                                          03844400
         AIF   (&ZN GE &ZAWRK).ZO15G                                    03844500
         AIF   ('&XCONSID'(&ZN,1) NE '(').ZO15I                         03844600
&ZC      SETC  '&XCONSID'(1,&ZN).'4'.','                                03844700
&ZC      SETC  '&ZC'.'&XCONSID'(&ZN+1,&ZAWRK-&ZN).',28(1)'              03844800
         AGO   .ZO15J                                                   03844900
.ZO15I    ANOP                                                          03845000
&ZN      SETA  &ZN+1                                                    03845100
         AGO   .ZO15H                                                   03845200
.ZO15G    ANOP                                                          03845300
&ZC      SETC  '&XCONSID.(4),28(1)'                                     03845400
.ZO15J    ANOP                                                          03845500
&ZOPN                 SETA  &ZOPN+1                                     03845600
&ZOPL(&ZOPN)          SETC  ' '                                         03846000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03847000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       03848000
&ZOPD(&ZOPN)          SETC  '++ XCONSID F'                              03849000
.ZO15C                ANOP  ,                                           03850000
.*------------------------------------------------------------------    03851000
.***AO.L02 XMCSCSAA F                                                   03852000
         AIF   ('&ZXMCSCSAA' EQ 'OUTPUT').ZO17A  OUTPUT                 03853000
         AIF   ('&ZXMCSCSAA' NE 'INOUT').ZO17C  INOUT                   03854000
.ZO17A    AIF   ('&XMCSCSAA'(1,1) NE '(').ZO17B  ADDR IN GPR            03855000
&ZCGPR   SETC  '&XMCSCSAA'(2,K'&XMCSCSAA-2)                             03856000
&ZOPN                 SETA  &ZOPN+1                                     03857000
&ZOPL(&ZOPN)          SETC  ' '                                         03858000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03859000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),36(1)'                         03860000
&ZOPD(&ZOPN)          SETC  '++ XMCSCSAA F'                             03861000
                      AGO   .ZO17C                                      03862000
.*                                                                      03863000
.ZO17B                ANOP  ,                                           03863500
&ZAWRK   SETA  K'&XMCSCSAA                                              03864100
         AIF   ('&XMCSCSAA'(&ZAWRK,1) NE ')').ZO17G                     03864200
&ZN      SETA  2                                                        03864300
.ZO17H    ANOP                                                          03864400
         AIF   (&ZN GE &ZAWRK).ZO17G                                    03864500
         AIF   ('&XMCSCSAA'(&ZN,1) NE '(').ZO17I                        03864600
&ZC      SETC  '&XMCSCSAA'(1,&ZN).'4'.','                               03864700
&ZC      SETC  '&ZC'.'&XMCSCSAA'(&ZN+1,&ZAWRK-&ZN).',36(1)'             03864800
         AGO   .ZO17J                                                   03864900
.ZO17I    ANOP                                                          03865000
&ZN      SETA  &ZN+1                                                    03865100
         AGO   .ZO17H                                                   03865200
.ZO17G    ANOP                                                          03865300
&ZC      SETC  '&XMCSCSAA.(4),36(1)'                                    03865400
.ZO17J    ANOP                                                          03865500
&ZOPN                 SETA  &ZOPN+1                                     03865600
&ZOPL(&ZOPN)          SETC  ' '                                         03866000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03867000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       03868000
&ZOPD(&ZOPN)          SETC  '++ XMCSCSAA F'                             03869000
.ZO17C                ANOP  ,                                           03870000
.*------------------------------------------------------------------    03871000
.***AO.L02 XMCSCSA A                                                    03872000
         AIF   ('&ZXMCSCSA' EQ 'OUTPUT').ZO18A  OUTPUT                  03873000
         AIF   ('&ZXMCSCSA' NE 'INOUT').ZO18C  INOUT                    03874000
.ZO18A    AIF   ('&XMCSCSA'(1,1) NE '(').ZO18B  ADDR IN GPR             03875000
&ZCGPR   SETC  '&XMCSCSA'(2,K'&XMCSCSA-2)                               03876000
&ZOPN                 SETA  &ZOPN+1                                     03877000
&ZOPL(&ZOPN)          SETC  ' '                                         03878000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03879000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),40(1)'                         03880000
&ZOPD(&ZOPN)          SETC  '++ XMCSCSA A'                              03881000
                      AGO   .ZO18C                                      03882000
.*                                                                      03883000
.ZO18B                ANOP  ,                                           03883500
&ZAWRK   SETA  K'&XMCSCSA                                               03884100
         AIF   ('&XMCSCSA'(&ZAWRK,1) NE ')').ZO18G                      03884200
&ZN      SETA  2                                                        03884300
.ZO18H    ANOP                                                          03884400
         AIF   (&ZN GE &ZAWRK).ZO18G                                    03884500
         AIF   ('&XMCSCSA'(&ZN,1) NE '(').ZO18I                         03884600
&ZC      SETC  '&XMCSCSA'(1,&ZN).'4'.','                                03884700
&ZC      SETC  '&ZC'.'&XMCSCSA'(&ZN+1,&ZAWRK-&ZN).',40(1)'              03884800
         AGO   .ZO18J                                                   03884900
.ZO18I    ANOP                                                          03885000
&ZN      SETA  &ZN+1                                                    03885100
         AGO   .ZO18H                                                   03885200
.ZO18G    ANOP                                                          03885300
&ZC      SETC  '&XMCSCSA.(4),40(1)'                                     03885400
.ZO18J    ANOP                                                          03885500
&ZOPN                 SETA  &ZOPN+1                                     03885600
&ZOPL(&ZOPN)          SETC  ' '                                         03886000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03887000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       03888000
&ZOPD(&ZOPN)          SETC  '++ XMCSCSA A'                              03889000
.ZO18C                ANOP  ,                                           03889100
.*------------------------------------------------------------------    03889200
.***AO.L02 XMIGID FL1                                                   03889300
         AIF   ('&ZXMIGID' EQ 'OUTPUT').ZO22A  OUTPUT                   03889400
         AIF   ('&ZXMIGID' NE 'INOUT').ZO22C  INOUT                     03889500
.ZO22A    AIF   ('&XMIGID'(1,1) NE '(').ZO22B  ADDR IN GPR              03889600
&ZCGPR   SETC  '&XMIGID'(2,K'&XMIGID-2)                                 03889700
&ZOPN                 SETA  &ZOPN+1                                     03889800
&ZOPL(&ZOPN)          SETC  ' '                                         03889900
&ZOPO(&ZOPN)          SETC  'MVC'                                       03890000
&ZOPV(&ZOPN)          SETC  '0(1,&ZCGPR),56(1)'                         03890100
&ZOPD(&ZOPN)          SETC  '++ XMIGID FL1'                             03890200
                      AGO   .ZO22C                                      03890300
.*                                                                      03890400
.ZO22B                ANOP  ,                                           03890500
&ZAWRK   SETA  K'&XMIGID                                                03890600
         AIF   ('&XMIGID'(&ZAWRK,1) NE ')').ZO22G                       03890700
&ZN      SETA  2                                                        03890800
.ZO22H    ANOP                                                          03890900
         AIF   (&ZN GE &ZAWRK).ZO22G                                    03891000
         AIF   ('&XMIGID'(&ZN,1) NE '(').ZO22I                          03891100
&ZC      SETC  '&XMIGID'(1,&ZN).'1'.','                                 03891200
&ZC      SETC  '&ZC'.'&XMIGID'(&ZN+1,&ZAWRK-&ZN).',56(1)'               03891300
         AGO   .ZO22J                                                   03891400
.ZO22I    ANOP                                                          03891500
&ZN      SETA  &ZN+1                                                    03891600
         AGO   .ZO22H                                                   03891700
.ZO22G    ANOP                                                          03891800
&ZC      SETC  '&XMIGID.(1),56(1)'                                      03891900
.ZO22J    ANOP                                                          03892000
&ZOPN                 SETA  &ZOPN+1                                     03892100
&ZOPL(&ZOPN)          SETC  ' '                                         03892200
&ZOPO(&ZOPN)          SETC  'MVC'                                       03892300
&ZOPV(&ZOPN)          SETC  '&ZC'                                       03892400
&ZOPD(&ZOPN)          SETC  '++ XMIGID FL1'                             03892500
.ZO22C                ANOP  ,                                           03892600
.*******************************************************************    03892700
.***AO.X01  LABEL TO BYPASS INVOCATION                                  03892800
.*******************************************************************    03893000
&ZOPN                 SETA  &ZOPN+1                                     03894000
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               03895000
&ZOPO(&ZOPN)          SETC  'DS'                                        03896000
&ZOPV(&ZOPN)          SETC  '0H'                                        03897000
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      03898000
.*******************************************************************    03899000
.***AO.X02  RETURN CODE PROCESSING                                      03900000
.*******************************************************************    03901000
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    03902000
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            03903000
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             03904000
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             03905000
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               03906000
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                03907000
&ZOPN                 SETA  &ZOPN+1                                     03908000
&ZOPL(&ZOPN)          SETC  ' '                                         03909000
&ZOPO(&ZOPN)          SETC  'ST'                                        03910000
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              03911000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        03912000
                      AGO   .ZMRETX                                     03913000
.*                                                                      03914000
.ZMRET2               ANOP  ,                                           03915000
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                03916000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                03917000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                03918000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  03919000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   03920000
&ZOPN                 SETA  &ZOPN+1                                     03921000
&ZOPL(&ZOPN)          SETC  ' '                                         03922000
&ZOPO(&ZOPN)          SETC  'LR'                                        03923000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 03924000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        03925000
.ZMRETX               ANOP  ,                                           03926000
.*******************************************************************    03927000
.***AO.X03  REASON CODE PROCESSING                                      03928000
.*******************************************************************    03929000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    03930000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            03931000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              03932000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             03933000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              03934000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             03935000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                03936000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 03937000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                03938000
&ZOPN                 SETA  &ZOPN+1                                     03939000
&ZOPL(&ZOPN)          SETC  ' '                                         03940000
&ZOPO(&ZOPN)          SETC  'ST'                                        03941000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               03942000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        03943000
                      AGO   .ZMRSNX                                     03944000
.*                                                                      03945000
.ZMRSN2               ANOP  ,                                           03946000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                03947000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 03948000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                03949000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 03950000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                03951000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   03952000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    03953000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   03954000
&ZOPN                 SETA  &ZOPN+1                                     03955000
&ZOPL(&ZOPN)          SETC  ' '                                         03956000
&ZOPO(&ZOPN)          SETC  'LR'                                        03957000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  03958000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        03959000
.ZMRSNX               ANOP  ,                                           03960000
.*******************************************************************    03961000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   03962000
.*******************************************************************    03963000
.ZMFLX                ANOP  ,              MF=L PROCESSING              03964000
.*******************************************************************    03965000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               03966000
.*******************************************************************    03967000
                      ACTR  10000                                       03968000
.*                                                                      03969000
                      LCLA  &ZLC           COLUMN POSITION              03970000
                      LCLA  &ZOPX          LIST TABLE INDEX             03971000
                      LCLC  &ZLL           LABEL                        03972000
                      LCLC  &ZLOP          OPERATION                    03973000
                      LCLC  &ZLV           VALUE                        03974000
                      LCLC  &ZLD           DESCRIPTION                  03975000
.*                                                                      03976000
&ZOPX                 SETA  1                                           03977000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            03978000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              03979000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              03980000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              03981000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              03982000
                      AIF   (K'&ZLD LE 0).ZL5                           03983000
&ZLC                  SETA  35             COMMENT COLUMN               03984000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    03985000
&ZLC                  SETA  33             COMMMENT COLUMN              03986000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   03987000
&ZLV                  SETC  '&ZLV'.' '                                  03988000
                      AGO   .ZL3                                        03989000
.*                                                                      03990000
.ZL4                  ANOP  ,                                           03991000
&ZLV                  SETC  '&ZLV'.' '                                  03992000
.ZL5                  ANOP  ,                                           03993000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               03994000
.*                                                                      03995000
&ZLL     &ZLOP &ZLV                                                     03996000
.*                                                                      03997000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               03998000
                      AGO   .ZL2           CONTINUE LOOPING             03999000
.*                                                                      04000000
.ZLX                  ANOP  ,                                           04001000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                04002000
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                04003000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  04004000
         L     15,16(0,0)         GET ADDRESS OF CVT FROM PSA           04005000
         L     15,772(,15)        GET ADDRESS OF SFT FROM CVT           04006000
         LA    14,1(0,0)          GET MCSOPER INDEX INTO LINKAGE TABLE  04007000
         AL    14,100(,15)        POINT REG14 TO MCSOPER ETD ENTRY      04008000
         PC    0(14)              PC TO MCSOPER SERVICE                 04009000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  04010000
.ZLINKX               ANOP  ,                                           04011000
.*******************************************************************    04012000
.***AP.X01  FORMAT GENERATED CODE                                       04013000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            04014000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              04015000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              04016000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              04017000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              04018000
                      AIF   (K'&ZLD LE 0).ZL51                          04019000
&ZLC                  SETA  35             COMMENT COLUMN               04020000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   04021000
&ZLC                  SETA  33             COMMENT COLUMN               04022000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  04023000
&ZLV                  SETC  '&ZLV'.' '                                  04024000
                      AGO   .ZL31                                       04025000
.*                                                                      04026000
.ZL41                 ANOP  ,                                           04027000
&ZLV                  SETC  '&ZLV'.' '                                  04028000
.ZL51                 ANOP  ,                                           04029000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               04030000
.*                                                                      04031000
&ZLL     &ZLOP &ZLV                                                     04032000
.*                                                                      04033000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               04034000
                      AGO   .ZL21          CONTINUE LOOPING             04035000
.*                                                                      04036000
.ZLX1                 ANOP  ,                                           04037000
.*******************************************************************    04038000
.***AP.X02  END OF MCSOPER MACRO                                        04039000
&ZMCSOPER             SETC  'YES'          SET MCSOPER USED             04040000
         POP   PRINT                                                    04041000
*                                            MCSOPER-1                  04042000
         SPACE 1                                                        04043000
.ZLX2                 ANOP  ,                                           04044000
         MEND                                                           04045000
**********************************************************************/ 04046000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  04047000
*%MCSOPER: MACRO KEYS(REQUEST,NAME,CONSID,MIGID,MIGIDREL,TERMNAME,      04048000
*                 MCSCSA,MCSCSAA,OPERPARM,MSGDLVRY,MSGECB,QLIMIT,       04049000
*                 ALERTECB,ALERTPCT,QRESUME,ABTERM,RTNCODE,RSNCODE,MF); 04050000
*  ANS('?'||MACLABEL||' '||'MCSOPERP '||MACLIST||                       04051000
*         ' '||MACKEYS||';') COL(MACLMAR);                              04052000
*%END MCSOPER;                                                          04053000
