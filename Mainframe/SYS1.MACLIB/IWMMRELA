*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMMRELA                              -04/04/00-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Relate monitoring environments                * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5647-A01 (C) COPYRIGHT IBM CORP. 1993, 2000                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7703                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The  purpose of this service is to initialize a monitoring     * 00002100
*      environment, referred to as the dependent monitoring           * 00002200
*      environment, which needs to inherit the characteristics either * 00002300
*      of a previously established monitoring environment, called the * 00002400
*      parent monitoring environment, or the current home address     * 00002500
*      space.                                                         * 00002600
*                                                                     * 00002700
*      This service may be used when the caller does not have direct  * 00002800
*      access to the information needed by IWMMINIT. If the caller    * 00002900
*      has the monitoring token for a monitoring environment that is  * 00003000
*      established for the same work request, this may be provided.   * 00003100
*      If the caller does not possess the parent monitoring token,    * 00003200
*      FINDACTIVE may be specified to request that the parent         * 00003300
*      monitoring environment is the active monitoring environment    * 00003400
*      owned by the current HOME address space and which is           * 00003500
*      associated with the TCB provided via PARENTTCB.                * 00003600
*                                                                     * 00003700
*      In either case, when no parent monitoring environment has been * 00003800
*      established, the input monitoring environment will be related  * 00003900
*      to the current home address space.                             * 00004000
*                                                                     * 00004100
*      This service does not make the dependent environment a valid   * 00004200
*      representation for a work request - it merely establishes the  * 00004300
*      potential so that a subsequent IWMMXFER will render the        * 00004400
*      dependent environment valid for a work request.                * 00004500
*                                                                     * 00004600
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004700
*                                                                     * 00004800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004900
*                                                                     * 00005000
*01* ENVIRONMENT:                                                     * 00005100
*                                                                     * 00005200
*                                                                     * 00005300
*      Dispatchable unit mode: Task or SRB mode.                      * 00005400
*                                                                     * 00005500
*      Minimum authorization: Either problem state or supervisor      * 00005600
*                        state.  PSW key must either be 0 or match    * 00005700
*                        the value supplied on IWMMCREA.              * 00005800
*                                                                     * 00005900
*      AMODE:            31-bit.                                      * 00006000
*                                                                     * 00006100
*      ASC mode:         Primary.  Any P,S,H.                         * 00006200
*                                                                     * 00006300
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006400
*                        FRRs are allowed.                            * 00006500
*                                                                     * 00006600
*01* RESTRICTIONS:                                                    * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*    1.  This macro may not be used prior to the completion of WLM    * 00007000
*        address space initialization                                 * 00007100
*                                                                     * 00007200
*    2.  All parameter areas must reside in current primary, except   * 00007300
*        that the TCB (if specified) must reside in current home.     * 00007400
*                                                                     * 00007500
*    3.  When PARENTP(YES) is specified, the caller is responsible    * 00007600
*        for error recovery When PARENTENV(HOME) is specified, it is  * 00007700
*        also necessary that the program reside in the MVS common     * 00007800
*        area.                                                        * 00007900
*                                                                     * 00008000
*    4.  When PARENTP(FINDACTIVE) is specified, the caller must be    * 00008100
*        unlocked                                                     * 00008200
*                                                                     * 00008300
*    5.  If the key specified on IWMMCREA for the input MONTKN was a  * 00008400
*        user key (8-F), then the following must be true:             * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*        o   When PARENTP(YES) is specified, primary addressability   * 00008800
*            must exist to the performance block IWMMCREA obtained.   * 00008900
*            This condition is satisfied by ensuring that current     * 00009000
*            primary matches primary at the time that IWMMCREA was    * 00009100
*            invoked.  If this service is invoked in a subspace, the  * 00009200
*            condition may be satisfied by ensuring that the          * 00009300
*            performance block is shared with the base space.         * 00009400
*                                                                     * 00009500
*        o   When PARENTP(FINDACTIVE) is specified, the caller must   * 00009600
*            be in non-cross-memory mode (P=S=H). This implies that   * 00009700
*            the current primary (and home) must match the primary    * 00009800
*            (and home) at the time that IWMMCREA was invoked.        * 00009900
*            Running in a subspace is not supported.                  * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*    6.  If the key specified on IWMMCREA for the parent environment  * 00010400
*        was a user key (8-F), then primary OR secondary OR home      * 00010500
*        addressability must exist to the performance block for the   * 00010600
*        parent environment.                                          * 00010700
*                                                                     * 00010800
*    7.  Both monitoring environments must be established on the same * 00010900
*        MVS image.                                                   * 00011000
*                                                                     * 00011100
*    8.  The caller must serialize to prevent any delay monitoring    * 00011200
*        services from being invoked concurrently for the environment * 00011300
*        represented by the dependent monitoring token.               * 00011400
*                                                                     * 00011500
*    9.  Only limited checking is done of the monitoring token for    * 00011600
*        the parent environment.                                      * 00011700
*                                                                     * 00011800
*    10. Only limited checking is done of the monitoring token for    * 00011900
*        the dependent environment.                                   * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00012600
*                      GR2-GR13    Undefined                          * 00012700
*                      GR14-GR15   Reserved                           * 00012800
*                      AR0-AR1     Reserved                           * 00012900
*                      AR2-AR13    Undefined                          * 00013000
*                      AR14-AR15   Reserved                           * 00013100
*                                                                     * 00013200
*01* OUTPUT REGISTERS: GR0         Reason code if GR15 return code is * 00013300
*                                  non-zero                           * 00013400
*                      GR1         Used as a work register by the     * 00013500
*                                  macro                              * 00013600
*                      GR2-GR13    Unchanged                          * 00013700
*                      GR14        Used as a work register by the     * 00013800
*                                  macro                              * 00013900
*                      GR15        Return code                        * 00014000
*                      AR0-AR1     Used as a work register by the     * 00014100
*                                  macro                              * 00014200
*                      AR2-AR13    Unchanged                          * 00014300
*                      AR14-AR15   Used as a work register by the     * 00014400
*                                  macro                              * 00014500
*                                                                     * 00014600
*01* SYNTAX:                                                          * 00014700
*                                                                     * 00014800
*[xlabel]  IWMMRELA    FUNCTION=CREATE                               * 00014900
*                    |    [,OWNER_TOKEN                               * 00015000
*                    |                  =xowner_token|NO_OWNER_TOKEN * 00015100
*                    |                  ]                            * 00015200
*                    |    [,OWNER_DATA=xowner_data|NO_OWNER_DATA]   * 00015300
*                    |    ,DISPTYPE=TCB                              * 00015400
*                    |   |     ,TCB=xtcb                              * 00015500
*                    |    ,DISPTYPE=SRB                              * 00015600
*                    |        ,SAMEDU=YES                            * 00015700
*                    |        ,SAMEDU=NO                             * 00015800
*                    |    ,PARENTP=YES                               * 00015900
*                    |   |     ,PARENTMONTKN=xparentmontkn            * 00016000
*                    |   |    ,PARENTENV=NOSWITCH                    * 00016100
*                    |   |    ,PARENTENV=SECONDARY                   * 00016200
*                    |   |    ,PARENTENV=HOME                        * 00016300
*                    |    ,PARENTP=FINDACTIVE                        * 00016400
*                    |         ,PARENTTCB=xparenttcb                  * 00016500
*                     ,FUNCTION=DELETE                               * 00016600
*                      ,MONTKN=xmontkn                                * 00016700
*                     [,RETCODE=xretcode]                             * 00016800
*                     [,RSNCODE=xrsncode]                             * 00016900
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00017000
*                    [,MF=S]                                         * 00017100
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00017200
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      Where:                                                         * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*      [xlabel]                                                       * 00017900
*          is an optional symbol, starting in column 1, that is the   * 00018000
*          name on the IWMMRELA macro invocation.  The name must      * 00018100
*          conform to the rules for an ordinary assembler language    * 00018200
*          symbol.                                                    * 00018300
*          DEFAULT: No name.                                          * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*      FUNCTION=CREATE|DELETE                                       * 00018900
*          is a required keyword input which indicates whether the    * 00019000
*          relationship is being established or inactivated.          * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*          FUNCTION=CREATE                                            * 00019400
*              indicates that the relationship is being established.  * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*              [OWNER_TOKEN=xowner_token|NO_OWNER_TOKEN]            * 00019800
*                  is the name (RS-type), or address in register      * 00019900
*                  (2)-(12), of an optional 32 bit input which        * 00020000
*                  contains a token maintained by the user/owner of   * 00020100
*                  the monitoring environment.  The format is         * 00020200
*                  undefined to MVS.                                  * 00020300
*                  DEFAULT: NO_OWNER_TOKEN indicates that no owner    * 00020400
*                  token is provided on this service.                 * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*              [OWNER_DATA=xowner_data|NO_OWNER_DATA]               * 00021000
*                  is the name (RS-type), or address in register      * 00021100
*                  (2)-(12), of an optional 32 bit input which        * 00021200
*                  contains data maintained by the user/owner of the  * 00021300
*                  monitoring environment.  The format is undefined   * 00021400
*                  to MVS.                                            * 00021500
*                  DEFAULT: NO_OWNER_DATA indicates that no owner     * 00021600
*                  data is provided.                                  * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*              DISPTYPE=TCB|SRB                                     * 00022200
*                  is a required keyword input which describes the    * 00022300
*                  nature of the MVS dispatchable units which         * 00022400
*                  participate in processing work requests associated * 00022500
*                  with the delay monitoring environment associated   * 00022600
*                  with MONTKN.                                       * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                  DISPTYPE=TCB                                       * 00023000
*                                                                     * 00023100
*                      indicates that work requests run in TCB mode   * 00023200
*                      under a TCB within the current home address    * 00023300
*                      space. Note that in cross-memory mode, this    * 00023400
*                      may be different from the current primary      * 00023500
*                      address space.                                 * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*                      TCB=xtcb                                       * 00023900
*                          is the name (RS-type), or address in       * 00024000
*                          register (2)-(12), of a required character * 00024100
*                          input which defines the TCB within the     * 00024200
*                          current home address space which will      * 00024300
*                          serve the work request.  Note that this    * 00024400
*                          name is not the pointer to the TCB, but    * 00024500
*                          the name of the data area containing the   * 00024600
*                          TCB.  A typical invocation might replace   * 00024700
*                          xTCB with TCB.                             * 00024800
*                                                                     * 00024900
*                          Ordinarily the input TCB specified should  * 00025000
*                          be the TCB under which the work request    * 00025100
*                          (e.g. transaction program) runs and under  * 00025200
*                          which the delay information is recorded    * 00025300
*                          (in spite of the fact that task switches   * 00025400
*                          may occur).                                * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*                  DISPTYPE=SRB                                       * 00025900
*                                                                     * 00026000
*                      indicates that work requests run in SRB mode   * 00026100
*                      within the current home address space.         * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                      SAMEDU=YES|NO                                * 00026500
*                          is a required keyword input which          * 00026600
*                          describes whether the dependent monitoring * 00026700
*                          environment associated with MONTKN is      * 00026800
*                          running under the same dispatchable unit   * 00026900
*                          as the parent.  In that case, it would     * 00027000
*                          behave as a "subroutine" and execute on    * 00027100
*                          the same processor (CP, a.k.a. CPU) as the * 00027200
*                          parent environment.                        * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                          SAMEDU=YES                                 * 00027600
*                                                                     * 00027700
*                              indicates that the work request runs   * 00027800
*                              as a subroutine of the parent.         * 00027900
*                                                                     * 00028000
*                              YES may not be specified when          * 00028100
*                              PARENTP(FINDACTIVE) is coded.          * 00028200
*                                                                     * 00028300
*                          SAMEDU=NO                                  * 00028400
*                                                                     * 00028500
*                              indicates that the work request runs   * 00028600
*                              in SRB mode and is independent of the  * 00028700
*                              parent dispatchable unit.              * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*              PARENTP=YES|FINDACTIVE                               * 00029900
*                  is a required keyword input which describes        * 00030000
*                  whether the parent monitoring environment is known * 00030100
*                  or not.                                            * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                  PARENTP=YES                                        * 00030500
*                                                                     * 00030600
*                      indicates that the parent monitoring           * 00030700
*                      environment is known.                          * 00030800
*                                                                     * 00030900
*                      Note that this produces an inline expansion    * 00031000
*                      rather than an out-of-line service, so that no * 00031100
*                      parameter list is needed.  Thus the MF keyword * 00031200
*                      is not applicable when this option is          * 00031300
*                      specified, and is not allowed.  Registers 0,   * 00031400
*                      1, 14, and 15 are not preserved across the     * 00031500
*                      expansion.                                     * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                      PARENTMONTKN=xparentmontkn                     * 00031900
*                          is the name (RS-type), or address in       * 00032000
*                          register (2)-(12), of a required 32 bit    * 00032100
*                          input which contains the delay monitoring  * 00032200
*                          token for the parent environment, i.e. the * 00032300
*                          monitoring environment which was           * 00032400
*                          established earlier and contains the       * 00032500
*                          characteristics to be inherited.           * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                      PARENTENV=NOSWITCH|SECONDARY|HOME            * 00033100
*                          is a required keyword input which          * 00033200
*                          describes whether a space switch is needed * 00033300
*                          to access the parent monitoring            * 00033400
*                          environment.                               * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                          PARENTENV=NOSWITCH                         * 00033800
*                                                                     * 00033900
*                              indicates that NO space switch is      * 00034000
*                              needed to access the parent monitoring * 00034100
*                              environment.  This would be            * 00034200
*                              appropriate if the parent monitoring   * 00034300
*                              environment was established (by        * 00034400
*                              IWMMCREA) to be used by routines in a  * 00034500
*                              specific system key or if it was       * 00034600
*                              established to be used in a specific   * 00034700
*                              user key in the current primary.       * 00034800
*                                                                     * 00034900
*                          PARENTENV=SECONDARY                        * 00035000
*                                                                     * 00035100
*                              indicates that the parent monitoring   * 00035200
*                              environment was established in current * 00035300
*                              secondary (for use by a specific user  * 00035400
*                              key).                                  * 00035500
*                                                                     * 00035600
*                          PARENTENV=HOME                             * 00035700
*                                                                     * 00035800
*                              indicates that the parent monitoring   * 00035900
*                              environment was established in current * 00036000
*                              home (for use by a specific user key). * 00036100
*                              Use of this option requires that the   * 00036200
*                              program must reside in the MVS common  * 00036300
*                              area.                                  * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                  PARENTP=FINDACTIVE                                 * 00037000
*                                                                     * 00037100
*                      indicates that the parent monitoring           * 00037200
*                      environment is unknown, but requests that the  * 00037300
*                      input monitoring environment be related to the * 00037400
*                      active monitoring environment owned by the     * 00037500
*                      current HOME address space and which is        * 00037600
*                      associated with the TCB specified by PARENTTCB * 00037700
*                      and which has no further continuations to      * 00037800
*                      other monitoring environments.  When no such   * 00037900
*                      monitoring environment exists, the input       * 00038000
*                      monitoring environment will be related to the  * 00038100
*                      current home address space.                    * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                      PARENTTCB=xparenttcb                           * 00038500
*                          is the name (RS-type), or address in       * 00038600
*                          register (2)-(12), of a required character * 00038700
*                          input which defines the TCB owned by the   * 00038800
*                          current home address space associated with * 00038900
*                          a monitoring environment via               * 00039000
*                          Initialize/Relate Disptype=TCB TCB= . This * 00039100
*                          TCB need not be the owner of the           * 00039200
*                          monitoring environment.  Note that this    * 00039300
*                          name is not the pointer to the TCB, but    * 00039400
*                          the name of the data area containing the   * 00039500
*                          TCB.  A typical invocation might replace   * 00039600
*                          xTCB with TCB.                             * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*          FUNCTION=DELETE                                            * 00040500
*              which indicates that the relationship is being         * 00040600
*              inactivated.                                           * 00040700
*                                                                     * 00040800
*              Note that this produces an inline expansion rather     * 00040900
*              than an out-of-line service, so that no parameter list * 00041000
*              is needed.  Thus the MF keyword is not applicable when * 00041100
*              this option is specified, and is not allowed.          * 00041200
*              Registers 0, 1, 14, and 15 are not preserved across    * 00041300
*              the expansion.                                         * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*      MONTKN=xmontkn                                                 * 00042100
*          is the name (RS-type), or address in register (2)-(12), of * 00042200
*          a required 32 bit input which contains the delay           * 00042300
*          monitoring token for the dependent environment.            * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*                                                                     * 00042800
*      [RETCODE=xretcode]                                             * 00042900
*          is the name (RS-type) of an optional fullword output       * 00043000
*          variable, or register (2)-(12), into which the return code * 00043100
*          is to be copied from GPR 15.                               * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*      [RSNCODE=xrsncode]                                             * 00043700
*          is the name (RS-type) of an optional fullword output       * 00043800
*          variable, or register (2)-(12), into which the reason code * 00043900
*          is to be copied from GPR 0.                                * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00044500
*          is an optional byte input decimal value in the "0-0" range * 00044600
*          that specifies the macro version.  PLISTVER is the only    * 00044700
*          key allowed on the list form of MF and determines which    * 00044800
*          parameter list is generated.  Note that MAX may be         * 00044900
*          specified instead of a number, and the parameter list will * 00045000
*          be of the largest size currently supported. This size may  * 00045100
*          grow from release to release (thus possibly affecting the  * 00045200
*          amount of storage needed by your program).  If your        * 00045300
*          program can tolerate this, IBM recommends that you always  * 00045400
*          specify MAX when creating the list form parameter list as  * 00045500
*          that will ensure that the list form parameter list is      * 00045600
*          always long enough to hold whatever parameters might be    * 00045700
*          specified on the execute form.                             * 00045800
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00045900
*          default is the lowest version which allows all of the      * 00046000
*          parameters specified on the invocation to be processed.    * 00046100
*                                                                     * 00046200
*                                                                     * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*      [MF=S|L|E]                                                   * 00046600
*          is an optional keyword input which specifies the macro     * 00046700
*          form.                                                      * 00046800
*          DEFAULT: S                                                 * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*          [MF=S]                                                     * 00047200
*              specifies the standard form of the macro.  The "S"     * 00047300
*              form generates code to put the parameters into an      * 00047400
*              in-line parameter list and invoke the desired service. * 00047500
*              Full checking for required macro keys is done along    * 00047600
*              with supplying defaults for omitted optional           * 00047700
*              parameters.                                            * 00047800
*                                                                     * 00047900
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00048000
*              specifies the list form of the macro.  The "L" form    * 00048100
*              defines an area to be used for the parameter list.     * 00048200
*              Only the PLISTVER key may be specified on the          * 00048300
*              invocation.  All other macro parameters are flagged as * 00048400
*              errors.  If PLISTVER is not specified, the original    * 00048500
*              parameter list definition is used.                     * 00048600
*                                                                     * 00048700
*            ,xmfctrl                                                 * 00048800
*              is a required input.  It is the name of a storage area * 00048900
*              for the parameter list.                                * 00049000
*                                                                     * 00049100
*            ,xmfattr|0D                                            * 00049200
*              is an optional 60 character input string that varies   * 00049300
*              from 1 to 60 characters. Use it to force boundary      * 00049400
*              alignment of the parameter list. Use only 0F or 0D.    * 00049500
*              DEFAULT: 0D which forces the parameter list to a       * 00049600
*              doubleword boundary.                                   * 00049700
*                                                                     * 00049800
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00049900
*              specifies the execute form of the macro.  The "E" form * 00050000
*              generates code to put the parameters into the          * 00050100
*              parameter list specified by xmfctrl and provides full  * 00050200
*              syntax checking with default setting.                  * 00050300
*                                                                     * 00050400
*            ,xmfctrl                                                 * 00050500
*              is a required input.  It is the name (RS-type), or     * 00050600
*              address in register (1)-(12), of a storage area for    * 00050700
*              the parameter list.                                    * 00050800
*                                                                     * 00050900
*            ,COMPLETE                                              * 00051000
*              is an optional keyword input which specifies the       * 00051100
*              degree of macro parameter syntax checking.             * 00051200
*              DEFAULT: COMPLETE                                      * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*              COMPLETE                                               * 00051600
*                  Checking for required macro keys is done and       * 00051700
*                  defaults are supplied for omitted optional         * 00051800
*                  parameters.                                        * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*01* RETURN CODES:                                                    * 00052700
*                                                                     * 00052800
*                                                                     * 00052900
*            0    IwmRetCodeOk:  Successful completion.               * 00053000
*                                                                     * 00053100
*            4    IwmRetCodeWarning:  Successful completion, unusual  * 00053200
*                 conditions noted.                                   * 00053300
*                                                                     * 00053400
*                 HEX REASON  MEANING                                 * 00053500
*                 CODE                                                * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                 xxxx0401    IwmRsnCodeNoWLM:  System does not       * 00053900
*                             support delay monitoring services.      * 00054000
*                             This return code is only set when the   * 00054100
*                             MVS release is prior to MVS/ESA         * 00054200
*                             SP5.1.0.                                * 00054300
*                                                                     * 00054400
*                 xxxx0402    IwmRsncodeNoMonEnv:  Input monitoring   * 00054500
*                             token indicates no monitoring           * 00054600
*                             environment was established.            * 00054700
*                                                                     * 00054800
*                 xxxx0406    IwmRsncodeNoParEnv:  No parent          * 00054900
*                             monitoring environment was established. * 00055000
*                             The input dependent monitoring          * 00055100
*                             environment is now related to the Home  * 00055200
*                             address space.                          * 00055300
*                                                                     * 00055400
*                                                                     * 00055500
*                                                                     * 00055600
*                                                                     * 00055700
*            8    IwmRetCodeInvocError:  Invalid invocation           * 00055800
*                 environment or parameters                           * 00055900
*                                                                     * 00056000
*                 HEX REASON  MEANING                                 * 00056100
*                 CODE                                                * 00056200
*                                                                     * 00056300
*                                                                     * 00056400
*                 xxxx0802    IwmRsnCodeXmemUserKeyTkn:  Caller is in * 00056500
*                             cross-memory mode while the token was   * 00056600
*                             obtained in user key.                   * 00056700
*                                                                     * 00056800
*                 xxxx0803    IwmRsnCodeDisabled:  Caller is disabled * 00056900
*                                                                     * 00057000
*                 xxxx0804    IwmRsnCodeLocked:  Caller is locked     * 00057100
*                                                                     * 00057200
*                 xxxx080B    IwmRsnCodeBadPl:  Error accessing       * 00057300
*                             parameter list.                         * 00057400
*                                                                     * 00057500
*                 xxxx081A    IwmRsnCodeCallerNotAuthDepEnv:  Caller  * 00057600
*                             is not authorized to update the         * 00057700
*                             dependent monitoring environment        * 00057800
*                                                                     * 00057900
*                 xxxx0820    IwmRsnCodeBadMonEnv:  Monitoring        * 00058000
*                             environment does not pass verification. * 00058100
*                                                                     * 00058200
*                 xxxx0822    IwmRsnCodeBadParEnv:  Parent monitoring * 00058300
*                             environment does not pass verification. * 00058400
*                                                                     * 00058500
*                 xxxx0823    IwmRsnCodeDatoff:  Caller invoked       * 00058600
*                             service while DATOFF                    * 00058700
*                                                                     * 00058800
*                 xxxx0824    IwmRsnCodeAmode24:  Caller invoked      * 00058900
*                             service but was was in 24 bit           * 00059000
*                             addressing mode.                        * 00059100
*                                                                     * 00059200
*                 xxxx0825    IwmRsnCodeAscModeNotPrimary:  Caller    * 00059300
*                             invoked service but was not DAT on      * 00059400
*                             Primary ASC mode.                       * 00059500
*                                                                     * 00059600
*                 xxxx0827    IwmRsnCodeRsvdNot0:  Reserved field in  * 00059700
*                             parameter list was non-zero             * 00059800
*                                                                     * 00059900
*                 xxxx0828    IwmRsnCodeBadVersion:  Version number   * 00060000
*                             in parameter list is not valid.         * 00060100
*                                                                     * 00060200
*                 xxxx0829    IwmRsnCodeBadOptions:  Parameter list   * 00060300
*                             omits required parameters or supplies   * 00060400
*                             mutually exclusive parameters or        * 00060500
*                             provides data associated with options   * 00060600
*                             not selected.                           * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*                                                                     * 00061100
*            10   IwmRetCodeCompError:  Component error               * 00061200
*                                                                     * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*01* REASON CODES:                                                    * 00061600
*                                                                     * 00061700
*       A unique reason code will be returned whenever the return     * 00061800
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00061900
*       under their corresponding return code.  Reason code and       * 00062000
*       return code constants are defined within IWMYCON.  Note that  * 00062100
*       the high order halfword of register 0, and the reason code    * 00062200
*       variable when specified, may be non-zero and represents       * 00062300
*       diagnostic data which is NOT part of the external interface.  * 00062400
*       The high order halfword should thus be excluded from          * 00062500
*       comparison with the reason code values described above.  The  * 00062600
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00062700
*       used for this purpose.                                        * 00062800
*                                                                     * 00062900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00063000
*                                                                     * 00063100
*02*   PROCESSOR:  ASSEM                                              * 00063200
*                                                                     * 00063300
*01* COMPONENT:  SCWLM                                                * 00063400
*                                                                     * 00063500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00063600
*                                                                     * 00063700
*01* MACRO USAGE NOTES:                                               * 00063800
*                                                                     * 00063900
*                                                                     * 00064000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00064100
*        global macro variable.  Any value other than 'NO' will       * 00064200
*        result in the macro expansion being printed.  The default is * 00064300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00064400
*        variable should be set.                                      * 00064500
*                                                                     * 00064600
*                    GBLC &ZPRINT                                     * 00064700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00064800
*                                                                     * 00064900
*                                                                     * 00065000
*    2.  All   keys   currently   contained  in  the  IWMMRELA  macro * 00065100
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00065200
*        value of 0 or MAX.                                           * 00065300
*                                                                     * 00065400
*                                                                     * 00065500
*    3.  The  macro  CVT  must  be  included  to  use this macro when * 00065600
*        FUNCTION(CREATE) PARENTP(FINDACTIVE) is specified.           * 00065700
*                                                                     * 00065800
*    4.  This  macro  may  only  be  used  on  MVS/ESA  (version 3 or * 00065900
*        higher), NOT versions 1 or 2 of MVS.                         * 00066000
*                                                                     * 00066100
*    5.  The macro IWMYCON must be included to use this macro.        * 00066200
*                                                                     * 00066300
*    6.  The  macro IWMPB must be in the library concatenation, since * 00066400
*        it is included by IWMYCON.                                   * 00066500
*                                                                     * 00066600
*    7.  Use   of  PARENTP(YES)  PARENTENV(HOME)  requires  that  the * 00066700
*        invoking program reside in the MVS common area.              * 00066800
*                                                                     * 00066900
*    8.  Note  that  the  high  order halfword of register 0, and the * 00067000
*        reason  code  variable  when  specified, may be non-zero and * 00067100
*        represents diagnostic data which is NOT part of the external * 00067200
*        interface.   The high order halfword should thus be excluded * 00067300
*        from comparison with the reason code values described above. * 00067400
*        The  constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may * 00067500
*        be used for this purpose.                                    * 00067600
*                                                                     * 00067700
*    9.  The  PL/AS version of the macro needs the EPILOG macro to be * 00067800
*        included.                                                    * 00067900
*                                                                     * 00068000
*    10. Note  that specification of PARENTP(YES) or FUNCTION(DELETE) * 00068100
*        produces  an  inline  expansion  rather  than an out-of-line * 00068200
*        service,  so  that no parameter list is needed.  Thus the MF * 00068300
*        keyword is not applicable when this option is specified, and * 00068400
*        is  not  allowed.    Registers  0,  1,  14,  and  15 are not * 00068500
*        preserved across the expansion.                              * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*                                                                     * 00068900
*01* CHANGE ACTIVITY:                                                 * 00069000
*                                                                     * 00069100
*   Flag LineItem  FMID    Date   ID    Comment                       * 00069200
*                                                                     * 00069300
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 00069400
*    $P1=PIG7010  HBB5510 921029 PD16:  Remove check for RSNCODE for  * 00069500
*                                         GPR00F declare              * 00069600
*    $01=OW26040  HBB6603 970407 PDSN:  Make clear length dependent   * 00069700
*                                         on version level, new       * 00069800
*                                         length field                * 00069900
*    $P2=PWA0230  JBB6607 980619 PDKN:  Ensure dynamic area is not    * 00070000
*                                         used when clearing out PB   * 00070100
*                                         fields.                     * 00070200
*    $P3=64BITSRM HBB7703 990714 B9HAGB:  Remove GEN CODE for         * 00070300
*                                         clearing PB_CLEAR           * 00070400
****** END OF SPECIFICATIONS *****************************************/ 00070500
*/* TLINE 1 *********************************************************** 00070600
         MACRO                                                          00070700
&XLABEL  IWMMRELA &FUNCTION=,&OWNER_TOKEN=,&OWNER_DATA=,&DISPTYPE=,    *00070800
               &TCB=,&SAMEDU=,&PARENTP=,&PARENTMONTKN=,&PARENTENV=,    *00070900
               &PARENTTCB=,&MONTKN=,&RETCODE=,&RSNCODE=,&PLISTVER=,    *00071000
               &MF=                                                     00071100
.*                                                                      00071200
*                  MACDATE -04/04/00-<0>                                00071300
.*                                                                      00071400
.*******************************************************************    00071500
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00071600
.*******************************************************************    00071700
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00071800
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00071900
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00072000
.*                                                                      00072100
                  GBLC  &ZIWMMRELA  YES=MACRO USED AT LEAST ONCE        00072200
.*******************************************************************    00072300
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00072400
.*******************************************************************    00072500
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00072600
                  LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS        00072700
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00072800
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00072900
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00073000
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00073100
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00073200
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00073300
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00073400
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00073500
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00073600
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00073700
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00073800
.*                                                                      00073900
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00074000
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00074100
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00074200
                  LCLC  &ZENDBASEPL             End of base PL          00074300
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00074400
.*******************************************************************    00074500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00074600
.*******************************************************************    00074700
                  LCLA  &ZI         INDEX FOR ARRAY                     00074800
                  LCLA  &ZJ         INDEX FOR PARMS                     00074900
                  LCLA  &ZK         INDEX FOR PARSE                     00075000
                  LCLA  &ZLO        LOW RANGE VALUE                     00075100
                  LCLA  &ZHI        HIGH RANGE VALUE                    00075200
                  LCLC  &ZW         WORK AREA FOR PARM                  00075300
.********************************************************************   00075400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00075500
.********************************************************************   00075600
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00075700
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00075800
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00075900
.*                                                                      00076000
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00076100
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00076200
                  SPLEVEL  TEST                                         00076300
.ZSYS2            ANOP  ,                                               00076400
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00076500
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00076600
                  SYSSTATE TEST                                         00076700
                  AGO   .ZSYS4                                          00076800
.ZSYS3            ANOP  ,                                               00076900
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00077000
.ZSYS4            ANOP  ,                                               00077100
.*******************************************************************    00077200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00077300
.*******************************************************************    00077400
                  LCLC  &XFUNCTION  ++ VALUE                            00077500
                  LCLC  &XOWNER_TOKEN           ++ NAME                 00077600
                  LCLC  &XOWNER_DATA            ++ NAME                 00077700
                  LCLC  &XDISPTYPE  ++ VALUE                            00077800
                  LCLC  &XTCB       ++ NAME                             00077900
                  LCLC  &XSAMEDU    ++ VALUE                            00078000
                  LCLC  &XPARENTP   ++ VALUE                            00078100
                  LCLC  &XPARENTMONTKN          ++ NAME                 00078200
                  LCLC  &XPARENTENV             ++ VALUE                00078300
                  LCLC  &XPARENTTCB             ++ NAME                 00078400
                  LCLC  &XMONTKN    ++ NAME                             00078500
                  LCLC  &XRETCODE   ++ NAME                             00078600
                  LCLC  &XRSNCODE   ++ NAME                             00078700
                  LCLA  &XPLISTVER  ++ VALUE                            00078800
                  LCLC  &XMF        ++ VALUE                            00078900
                  LCLC  &XMFCTRL    ++ NAME                             00079000
                  LCLC  &XMFATTR    ++ VALUE                            00079100
                  LCLC  &XMFSCK     ++ VALUE                            00079200
.*******************************************************************    00079300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00079400
.*******************************************************************    00079500
                  LCLC  &ZXFUNCTION             ++ INPUT VALUE          00079600
                  LCLC  &ZXOWNER_TOKEN          ++ INPUT NAME           00079700
                  LCLC  &ZXOWNER_DATA           ++ INPUT NAME           00079800
                  LCLC  &ZXDISPTYPE             ++ INPUT VALUE          00079900
                  LCLC  &ZXTCB      ++ INPUT NAME                       00080000
                  LCLC  &ZXSAMEDU   ++ INPUT VALUE                      00080100
                  LCLC  &ZXPARENTP  ++ INPUT VALUE                      00080200
                  LCLC  &ZXPARENTMONTKN         ++ INPUT NAME           00080300
                  LCLC  &ZXPARENTENV            ++ INPUT VALUE          00080400
                  LCLC  &ZXPARENTTCB            ++ INPUT NAME           00080500
                  LCLC  &ZXMONTKN   ++ INPUT NAME                       00080600
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00080700
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00080800
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00080900
                  LCLC  &ZXMF       ++ INPUT VALUE                      00081000
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00081100
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00081200
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00081300
.********************************************************************   00081400
.***AC.PLV01  PROCESS PLISTVER                                      *   00081500
.********************************************************************   00081600
&XPLISTVER      SETA  0                                                 00081700
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00081800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00081900
&XPLISTVER      SETA  0                                                 00082000
.ZPLV0          ANOP  ,                                                 00082100
.*                                                                      00082200
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00082300
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00082400
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00082500
.*-------------------------------------------------------------------   00082600
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00082700
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00082800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00082900
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00083000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00083100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00083200
                AGO   .ZPVCK2                                           00083300
.ZPVCK3         ANOP  ,                                                 00083400
.*-------------------------------------------------------------------   00083500
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00083600
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00083700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00083800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00083900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00084000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084100
                AGO   .ZPVCKE                                           00084200
.ZPVCK2         ANOP  ,                                                 00084300
.*-------------------------------------------------------------------   00084400
&ZCVAL          SETC  '&PLISTVER(1)'                                    00084500
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00084600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00084700
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00084800
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00084900
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00085000
.ZPVCK6         ANOP  ,                                                 00085100
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00085200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00085300
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00085400
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00085500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00085600
&XPLISTVER      SETA  0                                                 00085700
                AGO   .ZPVCKE                                           00085800
.*-------------------------------------------------------------------   00085900
.ZPVCK4A        ANOP  ,                                                 00086000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00086100
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00086200
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00086300
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00086400
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00086500
                MNOTE 8,' &ZMS IS REQUIRED.'                            00086600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00086700
                AGO   .ZPVCK5                                           00086800
.ZPVCK4         ANOP  ,                                                 00086900
&XPLISTVER      SETA  &PLISTVER(1)                                      00087000
.ZPVCK5         ANOP  ,                                                 00087100
.ZPVCKE         ANOP  ,                                                 00087200
.********************************************************************   00087300
.***AG.MF01 PROCESS MF MACRO FORMS                                      00087400
.********************************************************************   00087500
                  ACTR  10000                                           00087600
.*------------------------------------------------------------------    00087700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087800
&XMF              SETC  ''          INITIALIZE XVARIABLE                00087900
.*-------------------------------------------------------------------   00088000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00088100
.ZG56             ANOP  ,                                               00088200
&ZTLC             SETC 'S'                                              00088300
                  AIF   ('&MF(1)' NE '&ZTLC').ZG57                      00088400
&XMF              SETC  'S'         SET KEYWORD                         00088500
                  AIF   (N'&MF LE 1).ZG56A      CK NUM                  00088600
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00088700
&ZMS              SETC  '&ZMS.&MF"'                                     00088800
&ZMS              SETC  '&ZMS "MF"'                                     00088900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00089000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00089100
.ZG56A            ANOP  ,                                               00089200
.*-------------------------------------------------------------------   00089300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089400
.ZG57             ANOP  ,                                               00089500
&ZTLC             SETC 'L'                                              00089600
                  AIF   ('&MF(1)' NE '&ZTLC').ZG64                      00089700
&XMF              SETC  'L'         SET KEYWORD                         00089800
                  AIF   (N'&MF LE 3).ZG57A      CK NUM                  00089900
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00090000
&ZMS              SETC  '&ZMS.&MF"'                                     00090100
&ZMS              SETC  '&ZMS "MF"'                                     00090200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00090300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00090400
.ZG57A            ANOP  ,                                               00090500
.*-------------------------------------------------------------------   00090600
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00090700
                  AIF   (N'&SYSLIST NE 0).ZG57B  POSITIONALS?           00090800
                  AIF   ('&FUNCTION' NE '').ZG57B  KEYS?                00090900
                  AIF   ('&OWNER_TOKEN' NE '').ZG57B  KEYS?             00091000
                  AIF   ('&OWNER_DATA' NE '').ZG57B  KEYS?              00091100
                  AIF   ('&DISPTYPE' NE '').ZG57B  KEYS?                00091200
                  AIF   ('&TCB' NE '').ZG57B    KEYS?                   00091300
                  AIF   ('&SAMEDU' NE '').ZG57B  KEYS?                  00091400
                  AIF   ('&PARENTP' NE '').ZG57B  KEYS?                 00091500
                  AIF   ('&PARENTMONTKN' NE '').ZG57B  KEYS?            00091600
                  AIF   ('&PARENTENV' NE '').ZG57B  KEYS?               00091700
                  AIF   ('&PARENTTCB' NE '').ZG57B  KEYS?               00091800
                  AIF   ('&MONTKN' NE '').ZG57B  KEYS?                  00091900
                  AIF   ('&RETCODE' NE '').ZG57B  KEYS?                 00092000
                  AIF   ('&RSNCODE' NE '').ZG57B  KEYS?                 00092100
                  AGO    .ZG57C     INVOCATION OKAY                     00092200
.ZG57B            ANOP  ,                                               00092300
&ZMS              SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE            00092400
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00092500
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00092600
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00092700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00092800
.ZG57C            ANOP  ,                                               00092900
.*-------------------------------------------------------------------   00093000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00093100
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00093200
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00093300
                  AIF   (N'&MF(2) GT 1).ZG59B   MULTI PARMS             00093400
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00093500
.ZG59B            AIF   (K'&MF(2) GT 0).ZG59C                           00093600
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00093700
&ZMS              SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*                00093800
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00093900
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00094000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00094100
.ZG59C            ANOP  ,                                               00094200
.*-------------------------------------------------------------------   00094300
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00094400
                  AIF   (K'&ZXMFCTRL LE 0).ZG59P  NOT I/O               00094500
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG59P                  00094600
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00094700
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00094800
&ZMS              SETC  '&ZMS.&MF"'                                     00094900
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00095000
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00095100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00095200
.ZG59P            ANOP  ,                                               00095300
.*-------------------------------------------------------------------   00095400
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00095500
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00095600
&XMFATTR          SETC  '0D'                                            00095700
                  AIF   (K'&MF(3) LE 0).ZG62B   PARM                    00095800
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00095900
                  AIF   (N'&MF(3) GT 1).ZG62B   MULTI PARMS             00096000
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00096100
.ZG62B            ANOP  ,                                               00096200
.*-------------------------------------------------------------------   00096300
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00096400
                  AIF   (K'&ZXMFATTR LE 0).ZG62P  NOT I/O               00096500
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG62P                  00096600
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00096700
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00096800
&ZMS              SETC  '&ZMS.&MF"'                                     00096900
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00097000
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00097100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00097200
.ZG62P            ANOP  ,                                               00097300
.*-------------------------------------------------------------------   00097400
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00097500
                  AIF   (K'&ZXMFATTR LE 0).ZG62S  NOT I/O               00097600
                  AIF   (K'&XMFATTR LE 60).ZG62S  LNG OK                00097700
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00097800
&ZMS              SETC  '"MF='      *KLNGA* MNOTE                       00097900
&ZMS              SETC  '&ZMS.&MF"'                                     00098000
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00098100
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00098200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00098300
.ZG62S            ANOP  ,                                               00098400
.*-------------------------------------------------------------------   00098500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098600
.ZG64             ANOP  ,                                               00098700
&ZTLC             SETC 'E'                                              00098800
                  AIF   ('&MF(1)' NE '&ZTLC').ZG72                      00098900
&XMF              SETC  'E'         SET KEYWORD                         00099000
                  AIF   (N'&MF LE 3).ZG64A      CK NUM                  00099100
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00099200
&ZMS              SETC  '&ZMS.&MF"'                                     00099300
&ZMS              SETC  '&ZMS "MF"'                                     00099400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00099500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00099600
.ZG64A            ANOP  ,                                               00099700
.*-------------------------------------------------------------------   00099800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00099900
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00100000
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00100100
                  AIF   (N'&MF(2) GT 1).ZG66B   MULTI PARMS             00100200
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00100300
.ZG66B            AIF   (K'&MF(2) GT 0).ZG66C                           00100400
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00100500
&ZMS              SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*                00100600
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00100700
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00100800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00100900
.ZG66C            ANOP  ,                                               00101000
.*-------------------------------------------------------------------   00101100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00101200
                  AIF   (K'&ZXMFCTRL LE 0).ZG66R  NOT I/O               00101300
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG66R                  00101400
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00101500
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG66P                    00101600
                  AIF   (K'&ZCGPR GT 2).ZG66Q                           00101700
                  AIF   ('&ZCGPR' EQ '0').ZG66Q                         00101800
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00101900
                  AIF   (T'&ZCGPR NE 'N').ZG66Q  INVALID REG NAME       00102000
.ZG66P            ANOP  ,                                               00102100
                  AIF   (T'&ZCGPR NE 'N').ZG66R  NON NUMERIC            00102200
                  AIF   ('&ZCGPR' LT '1').ZG66Q                         00102300
                  AIF   ('&ZCGPR' LE '12').ZG66R                        00102400
.ZG66Q            ANOP  ,                                               00102500
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00102600
&ZMS              SETC  '&ZMS.&MF"'                                     00102700
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00102800
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00102900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00103000
.ZG66R            ANOP  ,                                               00103100
.*-------------------------------------------------------------------   00103200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00103300
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00103400
.ZG70A   AIF   ('&MF(3)' NE 'COMPLETE').ZG71A                           00103500
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00103600
.*-------------------------------------------------------------------   00103700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00103800
.ZG71A            AIF   (K'&XMFSCK GT 0).ZG71C  KEYWORD                 00103900
                  AIF   (K'&MF(3) LE 0).ZG71B                           00104000
&ZMS              SETC  '"MF='      *KUKWA* MNOTE                       00104100
&ZMS              SETC  '&ZMS.&MF"'                                     00104200
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00104300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00104400
&ZMS              SETC  '&ZMS "COMPLETE".'                              00104500
                  MNOTE 8,' &ZMS '                                      00104600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00104700
.ZG71B            ANOP  ,                                               00104800
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00104900
.ZG71C            ANOP  ,                                               00105000
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00105100
.*------------------------------------------------------------------    00105200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105300
.ZG72             ANOP  ,                                               00105400
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00105500
                  AIF   (K'&XMF GT 0).ZG72E     VALID ARG               00105600
                  AIF   (T'&MF EQ 'O').ZG72D    OMITTED                 00105700
&ZASYSLNDX        SETA  0                                               00105800
.ZG72A            ANOP  ,           POSITIONAL MACRO KEY                00105900
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00106000
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG72C                00106100
&ZTLC             SETC 'MF'                                             00106200
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG72A       00106300
.ZG72B            ANOP  ,                                               00106400
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00106500
&ZMS              SETC  'THE "MF" KEY'          *KOPTA* MNOTE           00106600
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00106700
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00106800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00106900
                  AGO   .ZG72E                                          00107000
.ZG72C            ANOP  ,                                               00107100
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00107200
&ZMS              SETC  '"MF='      *KUKWA* MNOTE                       00107300
&ZMS              SETC  '&ZMS.&MF"'                                     00107400
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00107500
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00107600
&ZMS              SETC  '&ZMS "S",'                                     00107700
&ZMS              SETC  '&ZMS "L",'                                     00107800
&ZMS              SETC  '&ZMS OR "E".'                                  00107900
                  MNOTE 8,' &ZMS '                                      00108000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00108100
                  AGO   .ZG72E                                          00108200
.ZG72D            ANOP  ,                                               00108300
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00108400
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00108500
.ZG72E            ANOP  ,                                               00108600
.********************************************************************   00108700
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00108800
.********************************************************************   00108900
                  ACTR  10000                                           00109000
.*-------------------------------------------------------------------   00109100
.***AG.MF03 MF=(SLE)                                                    00109200
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00109300
.*------------------------------------------------------------------    00109400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109500
&XFUNCTION        SETC  ''          INITIALIZE XVARIABLE                00109600
.*-------------------------------------------------------------------   00109700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109800
.ZG3              ANOP  ,                                               00109900
                  AIF   (K'&FUNCTION(1) LE 0).ZG3A                      00110000
&ZTLC             SETC 'CREATE'                                         00110100
                  AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG40                00110200
&XFUNCTION        SETC  'CREATE'    SET KEYWORD                         00110300
                  AIF   (N'&FUNCTION LE 1).ZG3A  CK NUM                 00110400
&ZMS              SETC  '"FUNCTION='            *KPOSA* MNOTE           00110500
&ZMS              SETC  '&ZMS.&FUNCTION"'                               00110600
&ZMS              SETC  '&ZMS "FUNCTION"'                               00110700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00110800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00110900
.ZG3A             ANOP  ,                                               00111000
.*----------------------------------------------------------------***   00111100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00111200
                  AIF   (N'&OWNER_TOKEN LE 1).ZG5A  CK NUM              00111300
&ZMS              SETC  '"OWNER_TOKEN='         *KPOSA* MNOTE           00111400
&ZMS              SETC  '&ZMS.&OWNER_TOKEN"'                            00111500
&ZMS              SETC  '&ZMS "OWNER_TOKEN"'                            00111600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00111700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00111800
.ZG5A             ANOP  ,                                               00111900
.*-------------------------------------------------------------------   00112000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00112100
&ZXOWNER_TOKEN    SETC  'INPUT'     SET IN/OUTPUT                       00112200
&XOWNER_TOKEN     SETC  'NO_OWNER_TOKEN'                                00112300
                  AIF   (K'&OWNER_TOKEN(1) LE 0).ZG5B  PARM             00112400
&XOWNER_TOKEN     SETC  '&OWNER_TOKEN(1)'       SET XVARIABLE           00112500
                  AIF   (N'&OWNER_TOKEN GT 1).ZG5B  MULTI PARMS         00112600
&XOWNER_TOKEN     SETC  '&OWNER_TOKEN'          SET XVARIABLE           00112700
.ZG5B             ANOP  ,                                               00112800
.*-------------------------------------------------------------------   00112900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00113000
                  AIF   (K'&ZXOWNER_TOKEN LE 0).ZG5R  NOT I/O           00113100
         AIF   ('&XOWNER_TOKEN' EQ 'NO_OWNER_TOKEN').ZG5R               00113200
                  AIF   ('&XOWNER_TOKEN'(1,1) NE '(').ZG5R              00113300
&ZCGPR            SETC  '&XOWNER_TOKEN'(2,K'&XOWNER_TOKEN-2)            00113400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                     00113500
                  AIF   (K'&ZCGPR GT 2).ZG5Q                            00113600
                  AIF   ('&ZCGPR' EQ '0').ZG5Q                          00113700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00113800
                  AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME        00113900
.ZG5P             ANOP  ,                                               00114000
                  AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC             00114100
                  AIF   ('&ZCGPR' LT '2').ZG5Q                          00114200
                  AIF   ('&ZCGPR' LE '12').ZG5R                         00114300
.ZG5Q             ANOP  ,                                               00114400
&ZMS              SETC  '"OWNER_TOKEN='         *KGPRA* MNOTE           00114500
&ZMS              SETC  '&ZMS.&OWNER_TOKEN"'                            00114600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00114700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00114800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00114900
.ZG5R             ANOP  ,                                               00115000
.*----------------------------------------------------------------***   00115100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00115200
                  AIF   (N'&OWNER_DATA LE 1).ZG8A  CK NUM               00115300
&ZMS              SETC  '"OWNER_DATA='          *KPOSA* MNOTE           00115400
&ZMS              SETC  '&ZMS.&OWNER_DATA"'                             00115500
&ZMS              SETC  '&ZMS "OWNER_DATA"'                             00115600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00115700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00115800
.ZG8A             ANOP  ,                                               00115900
.*-------------------------------------------------------------------   00116000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00116100
&ZXOWNER_DATA     SETC  'INPUT'     SET IN/OUTPUT                       00116200
&XOWNER_DATA      SETC  'NO_OWNER_DATA'                                 00116300
                  AIF   (K'&OWNER_DATA(1) LE 0).ZG8B  PARM              00116400
&XOWNER_DATA      SETC  '&OWNER_DATA(1)'        SET XVARIABLE           00116500
                  AIF   (N'&OWNER_DATA GT 1).ZG8B  MULTI PARMS          00116600
&XOWNER_DATA      SETC  '&OWNER_DATA'           SET XVARIABLE           00116700
.ZG8B             ANOP  ,                                               00116800
.*-------------------------------------------------------------------   00116900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00117000
                  AIF   (K'&ZXOWNER_DATA LE 0).ZG8R  NOT I/O            00117100
         AIF   ('&XOWNER_DATA' EQ 'NO_OWNER_DATA').ZG8R                 00117200
                  AIF   ('&XOWNER_DATA'(1,1) NE '(').ZG8R               00117300
&ZCGPR            SETC  '&XOWNER_DATA'(2,K'&XOWNER_DATA-2)              00117400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                     00117500
                  AIF   (K'&ZCGPR GT 2).ZG8Q                            00117600
                  AIF   ('&ZCGPR' EQ '0').ZG8Q                          00117700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00117800
                  AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME        00117900
.ZG8P             ANOP  ,                                               00118000
                  AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC             00118100
                  AIF   ('&ZCGPR' LT '2').ZG8Q                          00118200
                  AIF   ('&ZCGPR' LE '12').ZG8R                         00118300
.ZG8Q             ANOP  ,                                               00118400
&ZMS              SETC  '"OWNER_DATA='          *KGPRA* MNOTE           00118500
&ZMS              SETC  '&ZMS.&OWNER_DATA"'                             00118600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00118700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00118800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00118900
.ZG8R             ANOP  ,                                               00119000
.*------------------------------------------------------------------    00119100
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119200
&XDISPTYPE        SETC  ''          INITIALIZE XVARIABLE                00119300
.*-------------------------------------------------------------------   00119400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119500
.ZG12             ANOP  ,                                               00119600
                  AIF   (K'&DISPTYPE(1) LE 0).ZG12A                     00119700
&ZTLC             SETC 'TCB'                                            00119800
                  AIF   ('&DISPTYPE(1)' NE '&ZTLC').ZG16                00119900
&XDISPTYPE        SETC  'TCB'       SET KEYWORD                         00120000
                  AIF   (N'&DISPTYPE LE 1).ZG12A  CK NUM                00120100
&ZMS              SETC  '"DISPTYPE='            *KPOSA* MNOTE           00120200
&ZMS              SETC  '&ZMS.&DISPTYPE"'                               00120300
&ZMS              SETC  '&ZMS "DISPTYPE"'                               00120400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00120500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00120600
.ZG12A            ANOP  ,                                               00120700
.*------------------------------------------------------------------    00120800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120900
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00121000
.ZG12A0           AIF   (K'&SAMEDU LE 0).ZG12A1  OK                     00121100
&ZCVAL            SETC '&ZCVAL SAMEDU'          INCORRECT KEY USED      00121200
.ZG12A1           AIF   (K'&ZCVAL LE 0).ZG12A2  OK                      00121300
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00121400
&ZMS              SETC  '"DISPTYPE'             *KMEIA* MNOTE           00121500
&ZMS              SETC  '&ZMS.=&DISPTYPE"'                              00121600
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00121700
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00121800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00121900
.ZG12A2           ANOP  ,                                               00122000
.*----------------------------------------------------------------***   00122100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00122200
                  AIF   (N'&TCB LE 1).ZG14A     CK NUM                  00122300
&ZMS              SETC  '"TCB='     *KPOSA* MNOTE                       00122400
&ZMS              SETC  '&ZMS.&TCB"'                                    00122500
&ZMS              SETC  '&ZMS "TCB"'                                    00122600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00122700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00122800
.ZG14A            ANOP  ,                                               00122900
.*-------------------------------------------------------------------   00123000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00123100
&ZXTCB            SETC  'INPUT'     SET IN/OUTPUT                       00123200
&XTCB             SETC  '&TCB(1)'   SET XVARIABLE                       00123300
                  AIF   (N'&TCB GT 1).ZG14B     MULTI PARMS             00123400
&XTCB             SETC  '&TCB'      SET XVARIABLE                       00123500
.ZG14B            AIF   (K'&TCB(1) GT 0).ZG14C                          00123600
&ZXTCB            SETC  ''          RESET IN/OUTPUT                     00123700
&ZMS              SETC  ' '         *KRQDA*                             00123800
&ZMS              SETC  '&ZMS "TCB" KEY AND ITS'                        00123900
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00124000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00124100
.ZG14C            ANOP  ,                                               00124200
.*-------------------------------------------------------------------   00124300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00124400
                  AIF   (K'&ZXTCB LE 0).ZG14R   NOT I/O                 00124500
                  AIF   ('&XTCB'(1,1) NE '(').ZG14R                     00124600
&ZCGPR            SETC  '&XTCB'(2,K'&XTCB-2)                            00124700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                    00124800
                  AIF   (K'&ZCGPR GT 2).ZG14Q                           00124900
                  AIF   ('&ZCGPR' EQ '0').ZG14Q                         00125000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00125100
                  AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME       00125200
.ZG14P            ANOP  ,                                               00125300
                  AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC            00125400
                  AIF   ('&ZCGPR' LT '2').ZG14Q                         00125500
                  AIF   ('&ZCGPR' LE '12').ZG14R                        00125600
.ZG14Q            ANOP  ,                                               00125700
&ZMS              SETC  '"TCB='     *KGPRA* MNOTE                       00125800
&ZMS              SETC  '&ZMS.&TCB"'                                    00125900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00126000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00126100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00126200
.ZG14R            ANOP  ,                                               00126300
.*-------------------------------------------------------------------   00126400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126500
.ZG16             ANOP  ,                                               00126600
&ZTLC             SETC 'SRB'                                            00126700
                  AIF   ('&DISPTYPE(1)' NE '&ZTLC').ZG22                00126800
&XDISPTYPE        SETC  'SRB'       SET KEYWORD                         00126900
                  AIF   (N'&DISPTYPE LE 1).ZG16A  CK NUM                00127000
&ZMS              SETC  '"DISPTYPE='            *KPOSA* MNOTE           00127100
&ZMS              SETC  '&ZMS.&DISPTYPE"'                               00127200
&ZMS              SETC  '&ZMS "DISPTYPE"'                               00127300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00127400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00127500
.ZG16A            ANOP  ,                                               00127600
.*------------------------------------------------------------------    00127700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127800
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00127900
.ZG16A0           AIF   (K'&TCB LE 0).ZG16A1    OK                      00128000
&ZCVAL            SETC '&ZCVAL TCB'             INCORRECT KEY USED      00128100
.ZG16A1           AIF   (K'&ZCVAL LE 0).ZG16A2  OK                      00128200
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00128300
&ZMS              SETC  '"DISPTYPE'             *KMEIA* MNOTE           00128400
&ZMS              SETC  '&ZMS.=&DISPTYPE"'                              00128500
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00128600
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00128700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00128800
.ZG16A2           ANOP  ,                                               00128900
.*------------------------------------------------------------------    00129000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129100
&XSAMEDU          SETC  ''          INITIALIZE XVARIABLE                00129200
.*-------------------------------------------------------------------   00129300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129400
.ZG19             ANOP  ,                                               00129500
                  AIF   (K'&SAMEDU(1) LE 0).ZG19A                       00129600
&ZTLC             SETC 'YES'                                            00129700
                  AIF   ('&SAMEDU(1)' NE '&ZTLC').ZG20                  00129800
&XSAMEDU          SETC  'YES'       SET KEYWORD                         00129900
                  AIF   (N'&SAMEDU LE 1).ZG19A  CK NUM                  00130000
&ZMS              SETC  '"SAMEDU='  *KPOSA* MNOTE                       00130100
&ZMS              SETC  '&ZMS.&SAMEDU"'                                 00130200
&ZMS              SETC  '&ZMS "SAMEDU"'                                 00130300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00130400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00130500
.ZG19A            ANOP  ,                                               00130600
.*-------------------------------------------------------------------   00130700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130800
.ZG20             ANOP  ,                                               00130900
&ZTLC             SETC 'NO'                                             00131000
                  AIF   ('&SAMEDU(1)' NE '&ZTLC').ZG21                  00131100
&XSAMEDU          SETC  'NO'        SET KEYWORD                         00131200
                  AIF   (N'&SAMEDU LE 1).ZG20A  CK NUM                  00131300
&ZMS              SETC  '"SAMEDU='  *KPOSA* MNOTE                       00131400
&ZMS              SETC  '&ZMS.&SAMEDU"'                                 00131500
&ZMS              SETC  '&ZMS "SAMEDU"'                                 00131600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00131700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131800
.ZG20A            ANOP  ,                                               00131900
.*------------------------------------------------------------------    00132000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00132100
.ZG21             ANOP  ,                                               00132200
&ZXSAMEDU         SETC  'INPUT'     SET IN/OUTPUT                       00132300
                  AIF   (K'&XSAMEDU GT 0).ZG21E  VALID ARG              00132400
                  AIF   (T'&SAMEDU EQ 'O').ZG21D  OMITTED               00132500
&ZASYSLNDX        SETA  0                                               00132600
.ZG21A            ANOP  ,           POSITIONAL MACRO KEY                00132700
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00132800
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C                00132900
&ZTLC             SETC 'SAMEDU'                                         00133000
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG21A       00133100
.ZG21B            ANOP  ,                                               00133200
&ZXSAMEDU         SETC  ''          RESET IN/OUTPUT                     00133300
&ZMS              SETC  'THE "SAMEDU" KEY'      *KOPTA* MNOTE           00133400
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00133500
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00133600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00133700
                  AGO   .ZG21E                                          00133800
.ZG21C            ANOP  ,                                               00133900
&ZXSAMEDU         SETC  ''          RESET IN/OUTPUT                     00134000
&ZMS              SETC  '"SAMEDU='  *KUKWA* MNOTE                       00134100
&ZMS              SETC  '&ZMS.&SAMEDU"'                                 00134200
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00134300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00134400
&ZMS              SETC  '&ZMS "YES"'                                    00134500
&ZMS              SETC  '&ZMS OR "NO".'                                 00134600
                  MNOTE 8,' &ZMS '                                      00134700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00134800
                  AGO   .ZG21E                                          00134900
.ZG21D            ANOP  ,                                               00135000
&XSAMEDU          SETC  'YES'       SET DEFAULT KEYWORD                 00135100
.ZG21E            ANOP  ,                                               00135200
.*------------------------------------------------------------------    00135300
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00135400
                  AIF   (K'&SAMEDU(1) GT 0).ZG21F  PARM                 00135500
&XSAMEDU          SETC  ''          ENSURE NULL KEYWORD                 00135600
&ZXSAMEDU         SETC  ''          RESET IN/OUTPUT                     00135700
&ZMS              SETC  'THE'                                           00135800
&ZMS              SETC  '&ZMS "SAMEDU" KEY AND ITS'                     00135900
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00136000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00136100
&ZMS              SETC  '&ZMS "YES"'                                    00136200
&ZMS              SETC  '&ZMS OR "NO".'                                 00136300
                  MNOTE 8,' &ZMS '                                      00136400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00136500
.ZG21F            ANOP  ,                                               00136600
.*------------------------------------------------------------------    00136700
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136800
.ZG22             ANOP  ,                                               00136900
&ZXDISPTYPE       SETC  'INPUT'     SET IN/OUTPUT                       00137000
                  AIF   (K'&XDISPTYPE GT 0).ZG22E  VALID ARG            00137100
                  AIF   (T'&DISPTYPE EQ 'O').ZG22D  OMITTED             00137200
&ZASYSLNDX        SETA  0                                               00137300
.ZG22A            ANOP  ,           POSITIONAL MACRO KEY                00137400
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00137500
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG22C                00137600
&ZTLC             SETC 'DISPTYPE'                                       00137700
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG22A       00137800
.ZG22B            ANOP  ,                                               00137900
&ZXDISPTYPE       SETC  ''          RESET IN/OUTPUT                     00138000
&ZMS              SETC  'THE "DISPTYPE" KEY'    *KOPTA* MNOTE           00138100
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00138200
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00138300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00138400
                  AGO   .ZG22E                                          00138500
.ZG22C            ANOP  ,                                               00138600
&ZXDISPTYPE       SETC  ''          RESET IN/OUTPUT                     00138700
&ZMS              SETC  '"DISPTYPE='            *KUKWA* MNOTE           00138800
&ZMS              SETC  '&ZMS.&DISPTYPE"'                               00138900
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00139000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00139100
&ZMS              SETC  '&ZMS "TCB"'                                    00139200
&ZMS              SETC  '&ZMS OR "SRB".'                                00139300
                  MNOTE 8,' &ZMS '                                      00139400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00139500
                  AGO   .ZG22E                                          00139600
.ZG22D            ANOP  ,                                               00139700
&XDISPTYPE        SETC  'TCB'       SET DEFAULT KEYWORD                 00139800
.ZG22E            ANOP  ,                                               00139900
.*------------------------------------------------------------------    00140000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140100
                  AIF   (K'&DISPTYPE(1) GT 0).ZG22F  PARM               00140200
&XDISPTYPE        SETC  ''          ENSURE NULL KEYWORD                 00140300
&ZXDISPTYPE       SETC  ''          RESET IN/OUTPUT                     00140400
&ZMS              SETC  'THE'                                           00140500
&ZMS              SETC  '&ZMS "DISPTYPE" KEY AND ITS'                   00140600
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00140700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00140800
&ZMS              SETC  '&ZMS "TCB"'                                    00140900
&ZMS              SETC  '&ZMS OR "SRB".'                                00141000
                  MNOTE 8,' &ZMS '                                      00141100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00141200
.ZG22F            ANOP  ,                                               00141300
.*------------------------------------------------------------------    00141400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141500
&XPARENTP         SETC  ''          INITIALIZE XVARIABLE                00141600
.*-------------------------------------------------------------------   00141700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141800
.ZG25             ANOP  ,                                               00141900
                  AIF   (K'&PARENTP(1) LE 0).ZG25A                      00142000
&ZTLC             SETC 'YES'                                            00142100
                  AIF   ('&PARENTP(1)' NE '&ZTLC').ZG35                 00142200
&XPARENTP         SETC  'YES'       SET KEYWORD                         00142300
                  AIF   (N'&PARENTP LE 1).ZG25A  CK NUM                 00142400
&ZMS              SETC  '"PARENTP='             *KPOSA* MNOTE           00142500
&ZMS              SETC  '&ZMS.&PARENTP"'                                00142600
&ZMS              SETC  '&ZMS "PARENTP"'                                00142700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00142800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00142900
.ZG25A            ANOP  ,                                               00143000
.*------------------------------------------------------------------    00143100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143200
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00143300
.ZG25A0           AIF   (K'&PARENTTCB LE 0).ZG25A1  OK                  00143400
&ZCVAL            SETC '&ZCVAL PARENTTCB'       INCORRECT KEY USED      00143500
.ZG25A1           AIF   (K'&ZCVAL LE 0).ZG25A2  OK                      00143600
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00143700
&ZMS              SETC  '"PARENTP'  *KMEIA* MNOTE                       00143800
&ZMS              SETC  '&ZMS.=&PARENTP"'                               00143900
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00144000
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00144100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00144200
.ZG25A2           ANOP  ,                                               00144300
.*----------------------------------------------------------------***   00144400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00144500
                  AIF   (N'&PARENTMONTKN LE 1).ZG27A  CK NUM            00144600
&ZMS              SETC  '"PARENTMONTKN='        *KPOSA* MNOTE           00144700
&ZMS              SETC  '&ZMS.&PARENTMONTKN"'                           00144800
&ZMS              SETC  '&ZMS "PARENTMONTKN"'                           00144900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00145000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00145100
.ZG27A            ANOP  ,                                               00145200
.*-------------------------------------------------------------------   00145300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00145400
&ZXPARENTMONTKN   SETC  'INPUT'     SET IN/OUTPUT                       00145500
&XPARENTMONTKN    SETC  '&PARENTMONTKN(1)'      SET XVARIABLE           00145600
                  AIF   (N'&PARENTMONTKN GT 1).ZG27B  MULTI PARMS       00145700
&XPARENTMONTKN    SETC  '&PARENTMONTKN'         SET XVARIABLE           00145800
.ZG27B            AIF   (K'&PARENTMONTKN(1) GT 0).ZG27C                 00145900
&ZXPARENTMONTKN   SETC  ''          RESET IN/OUTPUT                     00146000
&ZMS              SETC  ' '         *KRQDA*                             00146100
&ZMS              SETC  '&ZMS "PARENTMONTKN" KEY AND ITS'               00146200
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00146300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00146400
.ZG27C            ANOP  ,                                               00146500
.*-------------------------------------------------------------------   00146600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00146700
                  AIF   (K'&ZXPARENTMONTKN LE 0).ZG27R  NOT I/O         00146800
                  AIF   ('&XPARENTMONTKN'(1,1) NE '(').ZG27R            00146900
&ZCGPR            SETC  '&XPARENTMONTKN'(2,K'&XPARENTMONTKN-2)          00147000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                    00147100
                  AIF   (K'&ZCGPR GT 2).ZG27Q                           00147200
                  AIF   ('&ZCGPR' EQ '0').ZG27Q                         00147300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00147400
                  AIF   (T'&ZCGPR NE 'N').ZG27Q  INVALID REG NAME       00147500
.ZG27P            ANOP  ,                                               00147600
                  AIF   (T'&ZCGPR NE 'N').ZG27R  NON NUMERIC            00147700
                  AIF   ('&ZCGPR' LT '2').ZG27Q                         00147800
                  AIF   ('&ZCGPR' LE '12').ZG27R                        00147900
.ZG27Q            ANOP  ,                                               00148000
&ZMS              SETC  '"PARENTMONTKN='        *KGPRA* MNOTE           00148100
&ZMS              SETC  '&ZMS.&PARENTMONTKN"'                           00148200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00148300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00148400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00148500
.ZG27R            ANOP  ,                                               00148600
.*------------------------------------------------------------------    00148700
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148800
&XPARENTENV       SETC  ''          INITIALIZE XVARIABLE                00148900
.*-------------------------------------------------------------------   00149000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149100
.ZG31             ANOP  ,                                               00149200
                  AIF   (K'&PARENTENV(1) LE 0).ZG31A                    00149300
&ZTLC             SETC 'NOSWITCH'                                       00149400
                  AIF   ('&PARENTENV(1)' NE '&ZTLC').ZG32               00149500
&XPARENTENV       SETC  'NOSWITCH'  SET KEYWORD                         00149600
                  AIF   (N'&PARENTENV LE 1).ZG31A  CK NUM               00149700
&ZMS              SETC  '"PARENTENV='           *KPOSA* MNOTE           00149800
&ZMS              SETC  '&ZMS.&PARENTENV"'                              00149900
&ZMS              SETC  '&ZMS "PARENTENV"'                              00150000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00150100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00150200
.ZG31A            ANOP  ,                                               00150300
.*-------------------------------------------------------------------   00150400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150500
.ZG32             ANOP  ,                                               00150600
&ZTLC             SETC 'SECONDARY'                                      00150700
                  AIF   ('&PARENTENV(1)' NE '&ZTLC').ZG33               00150800
&XPARENTENV       SETC  'SECONDARY'             SET KEYWORD             00150900
                  AIF   (N'&PARENTENV LE 1).ZG32A  CK NUM               00151000
&ZMS              SETC  '"PARENTENV='           *KPOSA* MNOTE           00151100
&ZMS              SETC  '&ZMS.&PARENTENV"'                              00151200
&ZMS              SETC  '&ZMS "PARENTENV"'                              00151300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00151400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00151500
.ZG32A            ANOP  ,                                               00151600
.*-------------------------------------------------------------------   00151700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151800
.ZG33             ANOP  ,                                               00151900
&ZTLC             SETC 'HOME'                                           00152000
                  AIF   ('&PARENTENV(1)' NE '&ZTLC').ZG34               00152100
&XPARENTENV       SETC  'HOME'      SET KEYWORD                         00152200
                  AIF   (N'&PARENTENV LE 1).ZG33A  CK NUM               00152300
&ZMS              SETC  '"PARENTENV='           *KPOSA* MNOTE           00152400
&ZMS              SETC  '&ZMS.&PARENTENV"'                              00152500
&ZMS              SETC  '&ZMS "PARENTENV"'                              00152600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00152700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00152800
.ZG33A            ANOP  ,                                               00152900
.*------------------------------------------------------------------    00153000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153100
.ZG34             ANOP  ,                                               00153200
&ZXPARENTENV      SETC  'INPUT'     SET IN/OUTPUT                       00153300
                  AIF   (K'&XPARENTENV GT 0).ZG34E  VALID ARG           00153400
                  AIF   (T'&PARENTENV EQ 'O').ZG34D  OMITTED            00153500
&ZASYSLNDX        SETA  0                                               00153600
.ZG34A            ANOP  ,           POSITIONAL MACRO KEY                00153700
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00153800
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG34C                00153900
&ZTLC             SETC 'PARENTENV'                                      00154000
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG34A       00154100
.ZG34B            ANOP  ,                                               00154200
&ZXPARENTENV      SETC  ''          RESET IN/OUTPUT                     00154300
&ZMS              SETC  'THE "PARENTENV" KEY'   *KOPTA* MNOTE           00154400
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00154500
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00154600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00154700
                  AGO   .ZG34E                                          00154800
.ZG34C            ANOP  ,                                               00154900
&ZXPARENTENV      SETC  ''          RESET IN/OUTPUT                     00155000
&ZMS              SETC  '"PARENTENV='           *KUKWA* MNOTE           00155100
&ZMS              SETC  '&ZMS.&PARENTENV"'                              00155200
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00155300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00155400
&ZMS              SETC  '&ZMS "NOSWITCH",'                              00155500
&ZMS              SETC  '&ZMS "SECONDARY",'                             00155600
&ZMS              SETC  '&ZMS OR "HOME".'                               00155700
                  MNOTE 8,' &ZMS '                                      00155800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00155900
                  AGO   .ZG34E                                          00156000
.ZG34D            ANOP  ,                                               00156100
&XPARENTENV       SETC  'NOSWITCH'  SET DEFAULT KEYWORD                 00156200
.ZG34E            ANOP  ,                                               00156300
.*------------------------------------------------------------------    00156400
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156500
                  AIF   (K'&PARENTENV(1) GT 0).ZG34F  PARM              00156600
&XPARENTENV       SETC  ''          ENSURE NULL KEYWORD                 00156700
&ZXPARENTENV      SETC  ''          RESET IN/OUTPUT                     00156800
&ZMS              SETC  'THE'                                           00156900
&ZMS              SETC  '&ZMS "PARENTENV" KEY AND ITS'                  00157000
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00157100
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00157200
&ZMS              SETC  '&ZMS "NOSWITCH",'                              00157300
&ZMS              SETC  '&ZMS "SECONDARY",'                             00157400
&ZMS              SETC  '&ZMS OR "HOME".'                               00157500
                  MNOTE 8,' &ZMS '                                      00157600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00157700
.ZG34F            ANOP  ,                                               00157800
.*-------------------------------------------------------------------   00157900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158000
.ZG35             ANOP  ,                                               00158100
&ZTLC             SETC 'FINDACTIVE'                                     00158200
                  AIF   ('&PARENTP(1)' NE '&ZTLC').ZG39                 00158300
&XPARENTP         SETC  'FINDACTIVE'            SET KEYWORD             00158400
                  AIF   (N'&PARENTP LE 1).ZG35A  CK NUM                 00158500
&ZMS              SETC  '"PARENTP='             *KPOSA* MNOTE           00158600
&ZMS              SETC  '&ZMS.&PARENTP"'                                00158700
&ZMS              SETC  '&ZMS "PARENTP"'                                00158800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00158900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00159000
.ZG35A            ANOP  ,                                               00159100
.*------------------------------------------------------------------    00159200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00159300
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00159400
.ZG35A0           AIF   (K'&PARENTMONTKN LE 0).ZG35A1  OK               00159500
&ZCVAL            SETC '&ZCVAL PARENTMONTKN'    INCORRECT KEY USED      00159600
.ZG35A1           AIF   (K'&PARENTENV LE 0).ZG35A2  OK                  00159700
&ZCVAL            SETC '&ZCVAL PARENTENV'       INCORRECT KEY USED      00159800
.ZG35A2           AIF   (K'&ZCVAL LE 0).ZG35A3  OK                      00159900
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00160000
&ZMS              SETC  '"PARENTP'  *KMEIA* MNOTE                       00160100
&ZMS              SETC  '&ZMS.=&PARENTP"'                               00160200
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00160300
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00160400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00160500
.ZG35A3           ANOP  ,                                               00160600
.*----------------------------------------------------------------***   00160700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00160800
                  AIF   (N'&PARENTTCB LE 1).ZG37A  CK NUM               00160900
&ZMS              SETC  '"PARENTTCB='           *KPOSA* MNOTE           00161000
&ZMS              SETC  '&ZMS.&PARENTTCB"'                              00161100
&ZMS              SETC  '&ZMS "PARENTTCB"'                              00161200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00161300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00161400
.ZG37A            ANOP  ,                                               00161500
.*-------------------------------------------------------------------   00161600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00161700
&ZXPARENTTCB      SETC  'INPUT'     SET IN/OUTPUT                       00161800
&XPARENTTCB       SETC  '&PARENTTCB(1)'         SET XVARIABLE           00161900
                  AIF   (N'&PARENTTCB GT 1).ZG37B  MULTI PARMS          00162000
&XPARENTTCB       SETC  '&PARENTTCB'            SET XVARIABLE           00162100
.ZG37B            AIF   (K'&PARENTTCB(1) GT 0).ZG37C                    00162200
&ZXPARENTTCB      SETC  ''          RESET IN/OUTPUT                     00162300
&ZMS              SETC  ' '         *KRQDA*                             00162400
&ZMS              SETC  '&ZMS "PARENTTCB" KEY AND ITS'                  00162500
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00162600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00162700
.ZG37C            ANOP  ,                                               00162800
.*-------------------------------------------------------------------   00162900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00163000
                  AIF   (K'&ZXPARENTTCB LE 0).ZG37R  NOT I/O            00163100
                  AIF   ('&XPARENTTCB'(1,1) NE '(').ZG37R               00163200
&ZCGPR            SETC  '&XPARENTTCB'(2,K'&XPARENTTCB-2)                00163300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                    00163400
                  AIF   (K'&ZCGPR GT 2).ZG37Q                           00163500
                  AIF   ('&ZCGPR' EQ '0').ZG37Q                         00163600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00163700
                  AIF   (T'&ZCGPR NE 'N').ZG37Q  INVALID REG NAME       00163800
.ZG37P            ANOP  ,                                               00163900
                  AIF   (T'&ZCGPR NE 'N').ZG37R  NON NUMERIC            00164000
                  AIF   ('&ZCGPR' LT '2').ZG37Q                         00164100
                  AIF   ('&ZCGPR' LE '12').ZG37R                        00164200
.ZG37Q            ANOP  ,                                               00164300
&ZMS              SETC  '"PARENTTCB='           *KGPRA* MNOTE           00164400
&ZMS              SETC  '&ZMS.&PARENTTCB"'                              00164500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00164600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00164700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00164800
.ZG37R            ANOP  ,                                               00164900
.*------------------------------------------------------------------    00165000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165100
.ZG39             ANOP  ,                                               00165200
&ZXPARENTP        SETC  'INPUT'     SET IN/OUTPUT                       00165300
                  AIF   (K'&XPARENTP GT 0).ZG39E  VALID ARG             00165400
                  AIF   (T'&PARENTP EQ 'O').ZG39D  OMITTED              00165500
&ZASYSLNDX        SETA  0                                               00165600
.ZG39A            ANOP  ,           POSITIONAL MACRO KEY                00165700
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00165800
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG39C                00165900
&ZTLC             SETC 'PARENTP'                                        00166000
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG39A       00166100
.ZG39B            ANOP  ,                                               00166200
&ZXPARENTP        SETC  ''          RESET IN/OUTPUT                     00166300
&ZMS              SETC  'THE "PARENTP" KEY'     *KOPTA* MNOTE           00166400
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00166500
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00166600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00166700
                  AGO   .ZG39E                                          00166800
.ZG39C            ANOP  ,                                               00166900
&ZXPARENTP        SETC  ''          RESET IN/OUTPUT                     00167000
&ZMS              SETC  '"PARENTP='             *KUKWA* MNOTE           00167100
&ZMS              SETC  '&ZMS.&PARENTP"'                                00167200
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00167300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00167400
&ZMS              SETC  '&ZMS "YES"'                                    00167500
&ZMS              SETC  '&ZMS OR "FINDACTIVE".'                         00167600
                  MNOTE 8,' &ZMS '                                      00167700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00167800
                  AGO   .ZG39E                                          00167900
.ZG39D            ANOP  ,                                               00168000
&XPARENTP         SETC  'YES'       SET DEFAULT KEYWORD                 00168100
.ZG39E            ANOP  ,                                               00168200
.*------------------------------------------------------------------    00168300
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168400
                  AIF   (K'&PARENTP(1) GT 0).ZG39F  PARM                00168500
&XPARENTP         SETC  ''          ENSURE NULL KEYWORD                 00168600
&ZXPARENTP        SETC  ''          RESET IN/OUTPUT                     00168700
&ZMS              SETC  'THE'                                           00168800
&ZMS              SETC  '&ZMS "PARENTP" KEY AND ITS'                    00168900
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00169000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00169100
&ZMS              SETC  '&ZMS "YES"'                                    00169200
&ZMS              SETC  '&ZMS OR "FINDACTIVE".'                         00169300
                  MNOTE 8,' &ZMS '                                      00169400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00169500
.ZG39F            ANOP  ,                                               00169600
.*-------------------------------------------------------------------   00169700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169800
.ZG40             ANOP  ,                                               00169900
&ZTLC             SETC 'DELETE'                                         00170000
                  AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG41                00170100
&XFUNCTION        SETC  'DELETE'    SET KEYWORD                         00170200
                  AIF   (N'&FUNCTION LE 1).ZG40A  CK NUM                00170300
&ZMS              SETC  '"FUNCTION='            *KPOSA* MNOTE           00170400
&ZMS              SETC  '&ZMS.&FUNCTION"'                               00170500
&ZMS              SETC  '&ZMS "FUNCTION"'                               00170600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00170700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00170800
.ZG40A            ANOP  ,                                               00170900
.*------------------------------------------------------------------    00171000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171100
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00171200
.ZG40A0           AIF   (K'&OWNER_TOKEN LE 0).ZG40A1  OK                00171300
&ZCVAL            SETC '&ZCVAL OWNER_TOKEN'     INCORRECT KEY USED      00171400
.ZG40A1           AIF   (K'&OWNER_DATA LE 0).ZG40A2  OK                 00171500
&ZCVAL            SETC '&ZCVAL OWNER_DATA'      INCORRECT KEY USED      00171600
.ZG40A2           AIF   (K'&DISPTYPE LE 0).ZG40A3  OK                   00171700
&ZCVAL            SETC '&ZCVAL DISPTYPE'        INCORRECT KEY USED      00171800
.ZG40A3           AIF   (K'&TCB LE 0).ZG40A4    OK                      00171900
&ZCVAL            SETC '&ZCVAL TCB'             INCORRECT KEY USED      00172000
.ZG40A4           AIF   (K'&SAMEDU LE 0).ZG40A5  OK                     00172100
&ZCVAL            SETC '&ZCVAL SAMEDU'          INCORRECT KEY USED      00172200
.ZG40A5           AIF   (K'&PARENTP LE 0).ZG40A6  OK                    00172300
&ZCVAL            SETC '&ZCVAL PARENTP'         INCORRECT KEY USED      00172400
.ZG40A6           AIF   (K'&PARENTMONTKN LE 0).ZG40A7  OK               00172500
&ZCVAL            SETC '&ZCVAL PARENTMONTKN'    INCORRECT KEY USED      00172600
.ZG40A7           AIF   (K'&PARENTENV LE 0).ZG40A8  OK                  00172700
&ZCVAL            SETC '&ZCVAL PARENTENV'       INCORRECT KEY USED      00172800
.ZG40A8           AIF   (K'&PARENTTCB LE 0).ZG40A9  OK                  00172900
&ZCVAL            SETC '&ZCVAL PARENTTCB'       INCORRECT KEY USED      00173000
.ZG40A9           AIF   (K'&ZCVAL LE 0).ZG40A10  OK                     00173100
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00173200
&ZMS              SETC  '"FUNCTION'             *KMEIA* MNOTE           00173300
&ZMS              SETC  '&ZMS.=&FUNCTION"'                              00173400
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00173500
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00173600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00173700
.ZG40A10          ANOP  ,                                               00173800
.*------------------------------------------------------------------    00173900
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174000
.ZG41             ANOP  ,                                               00174100
&ZXFUNCTION       SETC  'INPUT'     SET IN/OUTPUT                       00174200
                  AIF   (K'&XFUNCTION GT 0).ZG41E  VALID ARG            00174300
                  AIF   (T'&FUNCTION EQ 'O').ZG41D  OMITTED             00174400
&ZASYSLNDX        SETA  0                                               00174500
.ZG41A            ANOP  ,           POSITIONAL MACRO KEY                00174600
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00174700
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG41C                00174800
&ZTLC             SETC 'FUNCTION'                                       00174900
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG41A       00175000
.ZG41B            ANOP  ,                                               00175100
&ZXFUNCTION       SETC  ''          RESET IN/OUTPUT                     00175200
&ZMS              SETC  'THE "FUNCTION" KEY'    *KOPTA* MNOTE           00175300
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00175400
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00175500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00175600
                  AGO   .ZG41E                                          00175700
.ZG41C            ANOP  ,                                               00175800
&ZXFUNCTION       SETC  ''          RESET IN/OUTPUT                     00175900
&ZMS              SETC  '"FUNCTION='            *KUKWA* MNOTE           00176000
&ZMS              SETC  '&ZMS.&FUNCTION"'                               00176100
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00176200
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00176300
&ZMS              SETC  '&ZMS "CREATE"'                                 00176400
&ZMS              SETC  '&ZMS OR "DELETE".'                             00176500
                  MNOTE 8,' &ZMS '                                      00176600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00176700
                  AGO   .ZG41E                                          00176800
.ZG41D            ANOP  ,                                               00176900
&XFUNCTION        SETC  'CREATE'    SET DEFAULT KEYWORD                 00177000
.ZG41E            ANOP  ,                                               00177100
.*------------------------------------------------------------------    00177200
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177300
                  AIF   (K'&FUNCTION(1) GT 0).ZG41F  PARM               00177400
&XFUNCTION        SETC  ''          ENSURE NULL KEYWORD                 00177500
&ZXFUNCTION       SETC  ''          RESET IN/OUTPUT                     00177600
&ZMS              SETC  'THE'                                           00177700
&ZMS              SETC  '&ZMS "FUNCTION" KEY AND ITS'                   00177800
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00177900
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00178000
&ZMS              SETC  '&ZMS "CREATE"'                                 00178100
&ZMS              SETC  '&ZMS OR "DELETE".'                             00178200
                  MNOTE 8,' &ZMS '                                      00178300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00178400
.ZG41F            ANOP  ,                                               00178500
.*----------------------------------------------------------------***   00178600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00178700
                  AIF   (N'&MONTKN LE 1).ZG43A  CK NUM                  00178800
&ZMS              SETC  '"MONTKN='  *KPOSA* MNOTE                       00178900
&ZMS              SETC  '&ZMS.&MONTKN"'                                 00179000
&ZMS              SETC  '&ZMS "MONTKN"'                                 00179100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00179200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00179300
.ZG43A            ANOP  ,                                               00179400
.*-------------------------------------------------------------------   00179500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00179600
&ZXMONTKN         SETC  'INPUT'     SET IN/OUTPUT                       00179700
&XMONTKN          SETC  '&MONTKN(1)'            SET XVARIABLE           00179800
                  AIF   (N'&MONTKN GT 1).ZG43B  MULTI PARMS             00179900
&XMONTKN          SETC  '&MONTKN'   SET XVARIABLE                       00180000
.ZG43B            AIF   (K'&MONTKN(1) GT 0).ZG43C                       00180100
&ZXMONTKN         SETC  ''          RESET IN/OUTPUT                     00180200
&ZMS              SETC  ' '         *KRQDA*                             00180300
&ZMS              SETC  '&ZMS "MONTKN" KEY AND ITS'                     00180400
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00180500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00180600
.ZG43C            ANOP  ,                                               00180700
.*-------------------------------------------------------------------   00180800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00180900
                  AIF   (K'&ZXMONTKN LE 0).ZG43R  NOT I/O               00181000
                  AIF   ('&XMONTKN'(1,1) NE '(').ZG43R                  00181100
&ZCGPR            SETC  '&XMONTKN'(2,K'&XMONTKN-2)                      00181200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                    00181300
                  AIF   (K'&ZCGPR GT 2).ZG43Q                           00181400
                  AIF   ('&ZCGPR' EQ '0').ZG43Q                         00181500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00181600
                  AIF   (T'&ZCGPR NE 'N').ZG43Q  INVALID REG NAME       00181700
.ZG43P            ANOP  ,                                               00181800
                  AIF   (T'&ZCGPR NE 'N').ZG43R  NON NUMERIC            00181900
                  AIF   ('&ZCGPR' LT '2').ZG43Q                         00182000
                  AIF   ('&ZCGPR' LE '12').ZG43R                        00182100
.ZG43Q            ANOP  ,                                               00182200
&ZMS              SETC  '"MONTKN='  *KGPRA* MNOTE                       00182300
&ZMS              SETC  '&ZMS.&MONTKN"'                                 00182400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00182500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00182600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00182700
.ZG43R            ANOP  ,                                               00182800
.*----------------------------------------------------------------***   00182900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00183000
                  AIF   (N'&RETCODE LE 1).ZG46A  CK NUM                 00183100
&ZMS              SETC  '"RETCODE='             *KPOSA* MNOTE           00183200
&ZMS              SETC  '&ZMS.&RETCODE"'                                00183300
&ZMS              SETC  '&ZMS "RETCODE"'                                00183400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00183500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00183600
.ZG46A            ANOP  ,                                               00183700
.*-------------------------------------------------------------------   00183800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00183900
                  AIF   (K'&RETCODE(1) LE 0).ZG46C  NO PARM             00184000
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00184100
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00184200
                  AIF   (N'&RETCODE GT 1).ZG46C                         00184300
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00184400
.ZG46C            ANOP  ,                                               00184500
.*-------------------------------------------------------------------   00184600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00184700
                  AIF   (K'&ZXRETCODE LE 0).ZG46R  NOT I/O              00184800
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG46R                 00184900
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00185000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                    00185100
                  AIF   (K'&ZCGPR GT 2).ZG46Q                           00185200
                  AIF   ('&ZCGPR' EQ '0').ZG46Q                         00185300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00185400
                  AIF   (T'&ZCGPR NE 'N').ZG46Q  INVALID REG NAME       00185500
.ZG46P            ANOP  ,                                               00185600
                  AIF   (T'&ZCGPR NE 'N').ZG46R  NON NUMERIC            00185700
                  AIF   ('&ZCGPR' LT '2').ZG46Q                         00185800
                  AIF   ('&ZCGPR' LE '12').ZG46R                        00185900
.ZG46Q            ANOP  ,                                               00186000
&ZMS              SETC  '"RETCODE='             *KGPRA* MNOTE           00186100
&ZMS              SETC  '&ZMS.&RETCODE"'                                00186200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00186300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00186400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00186500
.ZG46R            ANOP  ,                                               00186600
.*----------------------------------------------------------------***   00186700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00186800
                  AIF   (N'&RSNCODE LE 1).ZG49A  CK NUM                 00186900
&ZMS              SETC  '"RSNCODE='             *KPOSA* MNOTE           00187000
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00187100
&ZMS              SETC  '&ZMS "RSNCODE"'                                00187200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00187300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00187400
.ZG49A            ANOP  ,                                               00187500
.*-------------------------------------------------------------------   00187600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00187700
                  AIF   (K'&RSNCODE(1) LE 0).ZG49C  NO PARM             00187800
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00187900
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00188000
                  AIF   (N'&RSNCODE GT 1).ZG49C                         00188100
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00188200
.ZG49C            ANOP  ,                                               00188300
.*-------------------------------------------------------------------   00188400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00188500
                  AIF   (K'&ZXRSNCODE LE 0).ZG49R  NOT I/O              00188600
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG49R                 00188700
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00188800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                    00188900
                  AIF   (K'&ZCGPR GT 2).ZG49Q                           00189000
                  AIF   ('&ZCGPR' EQ '0').ZG49Q                         00189100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00189200
                  AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME       00189300
.ZG49P            ANOP  ,                                               00189400
                  AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC            00189500
                  AIF   ('&ZCGPR' LT '2').ZG49Q                         00189600
                  AIF   ('&ZCGPR' LE '12').ZG49R                        00189700
.ZG49Q            ANOP  ,                                               00189800
&ZMS              SETC  '"RSNCODE='             *KGPRA* MNOTE           00189900
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00190000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00190100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00190200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00190300
.ZG49R            ANOP  ,                                               00190400
.******************************************************************     00190500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00190600
.******************************************************************     00190700
                  ACTR  10000                                           00190800
.*----------------------------------------------------------------***   00190900
.***AH.P02 EXTRA POSITIONALS                                            00191000
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00191100
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00191200
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00191300
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00191400
.ZGLISTX1         ANOP  ,                                               00191500
&ZCVAL            SETC  ''          ERROR FIELD                         00191600
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00191700
.ZGLIST2          ANOP  ,                                               00191800
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00191900
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00192000
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00192100
                  AGO   .ZGLIST2                                        00192200
.*                                                                      00192300
.ZGLIST3          ANOP  ,                                               00192400
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00192500
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE        00192600
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00192700
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00192800
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00192900
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00193000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00193100
.ZGLISTX          ANOP  ,                                               00193200
&ZASYSLNDX        SETA  0                                               00193300
.*-------------------------------------------------------------------   00193400
.***AG.MF04 MF=(SLE)                                                    00193500
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00193600
.*******************************************************************    00193700
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00193800
.*******************************************************************    00193900
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00194000
.*******************************************************************    00194100
.***AE.01  START OF IWMMRELA MACRO CODE                                 00194200
.*******************************************************************    00194300
                  LCLC  &M0M0001                 NAME                   00194400
&M0M0001          SETC  '&XLABEL'                SET NAME               00194500
                  AIF   (K'&XLABEL NE 0).XLAB2                          00194600
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00194700
.*                                                                      00194800
.XLAB2            ANOP  ,                                               00194900
                  AIF   ('&XMF' EQ 'L').XLAB3                           00195000
&M0M0001 DS    0H                             IWMMRELA-0                00195100
.XLAB3            ANOP  ,                                               00195200
.*******************************************************************    00195300
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00195400
.*******************************************************************    00195500
              PUSH  PRINT                                               00195600
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00195700
                  PRINT OFF         ++ PR01                             00195800
                  AGO   .ZPRNTXX                                        00195900
.ZPRINTX          PRINT ON                                              00196000
.ZPRNTXX          ANOP  ,                                               00196100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00196200
         LCLC  &T1                                                      00196300
         AIF   ('&XFUNCTION' EQ 'DELETE').TESTMF                        00196400
         AIF   ('&XPARENTP' EQ 'YES').TESTMF                            00196500
         AIF   ('&XPARENTP' NE 'FINDACTIVE').NOCODENEEDED               00196600
.*    PARENTP SPECIFIED AS FINDACTIVE                                   00196700
         AIF   ('&DISPTYPE' NE 'SRB').NOCODENEEDED                      00196800
         AIF   ('&SAMEDU' NE 'YES').NOCODENEEDED                        00196900
.*    DISPTYPE SPECIFIED AS SRB, SAMEDU SPECIFIED AS YES                00197000
&T1      SETC  'FUNCTION(CREATE) DISPTYPE(SRB) SAMEDU(YES) CANNOT BE '  00197100
&T1      SETC  '&T1.SPECIFIED WITH PARENTP(FINDACTIVE)'                 00197200
         MNOTE 8,'&T1'                                                  00197300
         MEXIT                                                          00197400
.*                                                                      00197500
.TESTMF  ANOP                                                           00197600
         AIF   ('&MF' EQ '').NOMF                                       00197700
&T1      SETC  'MF IS NOT VALID WITH FUNCTION(DELETE) OR PARENTP(YES)'  00197800
         MNOTE 4,'&T1'                                                  00197900
.NOMF    ANOP                                                           00198000
&T1      SETC  '&MONTKN'                                                00198100
         AIF   ('&MONTKN'(1,1) NE '(').MONTKNRS                         00198200
&T1      SETC  '&MONTKN'(2,K'&MONTKN-2)                                 00198300
&T1      SETC  '0(&T1.)'                                                00198400
.MONTKNRS  ANOP                                                         00198500
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                      00198600
         ICM   14,15,&T1               FETCH MONITORING TOKEN           00198700
         BNZ   MONENV&SYSNDX           BRANCH WHEN MON ENV IS PRESENT   00198800
         LA    0,IWMRSNCODENOMONENV    SET REASON CODE = NO MON ENV     00198900
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00199000
         B     END&SYSNDX              BRANCH TO END LABEL              00199100
MONENV&SYSNDX DS    0H                 BRANCH LABEL FOR MON ENV PRESENT 00199200
         CLC   PB_ID-PB(4,14),=CL4'PB  '                                00199300
         BE    MONENVOK&SYSNDX         BRANCH WHEN MON ENV PASSES       00199400
         LA    0,IWMRSNCODEBADMONENV   SET REASON CODE = BAD MON ENV    00199500
         LA    15,IWMRETCODEINVOCERROR SET INVOCATION ERROR RETURN CODE 00199600
         B     END&SYSNDX              BRANCH TO END LABEL              00199700
MONENVOK&SYSNDX DS    0H               BRANCH LABEL FOR MON ENV OK      00199800
         USING PB,14                                                    00199900
         AIF   ('&XFUNCTION' NE 'CREATE').ENDCREATE                     00200000
.*                                                                      00200100
.* THE FOLLOWING CODE HANDLES FUNCTION(CREATE)                          00200200
.*                                                                      00200300
.*       XC    PB_CLEAR,PB_CLEAR          INITIALIZE                    00200400
         LH    15,PB_NEW_LENGTH                               @OW26040  00200500
         LTR   15,15                                          @OW26040  00200600
         BZ    NOLENGTH&SYSNDX                                @OW26040  00200700
         BCTR  15,0                                           @OW26040  00200800
         EX    15,A&SYSNDX                                    @OW26040  00200900
         B     ENDXC&SYSNDX                                   @OW26040  00201000
NOLENGTH&SYSNDX DS    0H        BRANCH LABEL FOR PRE-APAR PB  @OW26040  00201100
         CLI   PB_VERSION,1                                   @OW26040  00201200
         BE    VERSION1&SYSNDX                                @OW26040  00201300
         CLI   PB_VERSION,2                                   @OW26040  00201400
         BNE   NOVERSIO&SYSNDX                                @OW26040  00201500
         B     VERSION2&SYSNDX                                @OW26040  00201600
VERSION1&SYSNDX DS    0H        BRANCH LABEL FOR VERSION 1 PB @OW26040  00201700
         XC    PB_CLEAR_FLD(168),PB_CLEAR_FLD                 @OW26040  00201800
         B     ENDXC&SYSNDX                                   @OW26040  00201900
VERSION2&SYSNDX DS    0H        BRANCH LABEL FOR VERSION 2 PB @OW26040  00202000
         XC    PB_CLEAR_FLD(192),PB_CLEAR_FLD                 @OW26040  00202100
         B     ENDXC&SYSNDX                                   @OW26040  00202200
NOVERSIO&SYSNDX DS    0H        BRANCH LABEL FOR UNKNOWN PB   @OW26040  00202300
.*       ABEND X'15F',DUMP,,SYSTEM,REASON=352                 @OW26040  00202400
         ABEND X'15F',DUMP,,SYSTEM,REASON=352                 @OW26040  00202500
         B     ENDXC&SYSNDX                                   @OW26040  00202600
A&SYSNDX XC    PB_CLEAR_FLD(0),PB_CLEAR_FLD                   @OW26040  00202700
ENDXC&SYSNDX    DS    0H                                      @OW26040  00202800
         AIF   ('&XOWNER_TOKEN' NE 'NO_OWNER_TOKEN').OWNERTKN           00202900
         AGO   .ENDOWNERTKN                                             00203000
.*                                                                      00203100
.OWNERTKN   ANOP                                                        00203200
&T1      SETC  '&OWNERTKN'                                              00203300
         AIF   ('&OWNERTKN'(1,1) NE '(').OWNERTKNRS                     00203400
&T1      SETC  '&OWNERTKN'(2,K'&OWNERTKN-2)                             00203500
&T1      SETC  '0(&T1.)'                                                00203600
.OWNERTKNRS ANOP                                                        00203700
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                      00203800
         L     1,&T1                   COPY OWNER_TOKEN VIA L,ST        00203900
         ST    1,PB_OWNER_TKN                                           00204000
.ENDOWNERTKN   ANOP                                                     00204100
.*                                                                      00204200
.*       OWNER_DATA PROCESSING                                          00204300
.*                                                                      00204400
         AIF   ('&XOWNER_DATA' NE 'NO_OWNER_DATA').OWNER_DATA           00204500
         AGO   .ENDOWNER_DATA                                           00204600
.*                                                                      00204700
.OWNER_DATA ANOP                                                        00204800
&T1      SETC  '&OWNER_DATA'                                            00204900
         AIF   ('&OWNER_DATA'(1,1) NE '(').OWNER_DATARS                 00205000
&T1      SETC  '&OWNER_DATA'(2,K'&OWNER_DATA-2)                         00205100
&T1      SETC  '0(&T1.)'                                                00205200
.OWNER_DATARS ANOP                                                      00205300
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                      00205400
         L     1,&T1                   COPY OWNER_DATA VIA L,ST         00205500
         ST    1,PB_OWNER_DATA                                          00205600
.ENDOWNER_DATA ANOP                                                     00205700
*                                                                       00205800
*                                                                       00205900
         AIF   ('&XDISPTYPE' NE 'TCB').ENDTCB                           00206000
&T1      SETC  '&TCB'                                                   00206100
         AIF   ('&TCB'(1,1) NE '(').TCBRS                               00206200
&T1      SETC  '&TCB'(2,K'&TCB-2)                                       00206300
.*    &T1      SETC  '0(&T1.)'       OLD NON-OPTIMIZED CODE DID LA,ST   00206400
         ST    &T1,PB_DU                                                00206500
         AGO   .ENDDISPTYPE                                             00206600
.TCBRS ANOP                                                             00206700
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                      00206800
         LA    0,&T1                   COPY TCB ADDRESS VIA LA,ST       00206900
         ST    0,PB_DU                                                  00207000
         AGO   .ENDDISPTYPE                                             00207100
.ENDTCB    ANOP                                                         00207200
&T1      SETC  'PB_SRB_SAMEDU_&XSAMEDU'                                 00207300
         LA    0,&T1                   INDICATE SRB MODE,SAMEDU VALUE   00207400
         ST    0,PB_DU                                                  00207500
.ENDDISPTYPE   ANOP                                                     00207600
*                                                                       00207700
         L     1,X'224'(0,0)           COPY PSAAOLD VIA L,ST            00207800
         ST    1,PB_DU_ASCB                                             00207900
*                                                                       00208000
&T1      SETC  '&PARENTMONTKN'                                          00208100
         AIF   ('&PARENTMONTKN'(1,1) NE '(').PARENTMONTKNRS             00208200
&T1      SETC  '&PARENTMONTKN'(2,K'&PARENTMONTKN-2)                     00208300
&T1      SETC  '0(&T1.)'                                                00208400
.PARENTMONTKNRS ANOP                                                    00208500
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                      00208600
         ICM   15,15,&T1               COPY PARENT MONITORING TOKEN     00208700
         BNZ   PAR_EXISTS&SYSNDX       BRANCH IF PARENT ENV EXISTS      00208800
         LH    1,X'24'(1,0)            COPY ASID FOR CURRENT HOME       00208900
         STH   1,PB_PARENT_HOME_ASID                                    00209000
         LA    0,IWMRSNCODENOPARENV    SET REASON CODE = NO PARENT ENV  00209100
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00209200
         B     SETRELATE&SYSNDX        BRANCH TO SET STATE TO RELATE    00209300
PAR_EXISTS&SYSNDX DS    0H             BRANCH LABEL FOR PAR ENV EXISTS  00209400
.*                                                                      00209500
.*                                                                      00209600
         LCLC  &SACTO2                                                  00209700
         LCLC  &SACBACK1                                                00209800
         LCLC  &SACBACK2                                                00209900
&SACBACK1 SETC  'DS'                                                    00210000
&SACBACK2 SETC  '0H'                                                    00210100
.*                                                                      00210200
         AIF   ('&XPARENTENV' NE 'NOSWITCH').NOSWITCHEND                00210300
.*                                                                      00210400
.*   THE FOLLOWING CODE HANDLES                                         00210500
.*   ===========================>    PARENTENV(PRIMARY)                 00210600
.*                                                                      00210700
         CLC   PB_ID-PB(4,15),=CL4'PB  '                                00210800
         AGO   .COMMONCONT1                                             00210900
.*                                                                      00211000
.NOSWITCHEND ANOP                                                       00211100
.*   THE FOLLOWING CODE HANDLES                                         00211200
.*   ===========================>    PARENTENV(SECONDARY|HOME)          00211300
.*                                                                      00211400
         AIF   ('&XPARENTENV' NE 'SECONDARY').HOMESWITCH                00211500
&SACTO2 SETC  '256'                                                     00211600
         AGO   .HOMESWITCHEND                                           00211700
.HOMESWITCH ANOP                                                        00211800
&SACTO2 SETC  '768'                                                     00211900
.HOMESWITCHEND ANOP                                                     00212000
.*                                                                      00212100
&SACBACK1 SETC  'SAC'                                                   00212200
&SACBACK2 SETC  '0'                                                     00212300
.*                                                                      00212400
.*       THE PB ACRONYM, REFERENCED AS A LITERAL, RESIDES IN CURRENT    00212500
.*         PRIMARY, AND MUST BE LOADED BEFORE CHANGING ASC MODE         00212600
.*                                                                      00212700
         L     0,=CL4'PB  '                                             00212800
         SAC   &SACTO2                                                  00212900
         CL    0,PB_ID-PB(0,15)                                         00213000
.*                                                                      00213100
.*             COMMON CODE FOR SHORT-FORM/MINIMAL VERIFICATION          00213200
.*                                                                      00213300
.COMMONCONT1 ANOP                                                       00213400
         BE    PARENVOK&SYSNDX         BRANCH WHEN PARENT ENV PASSES    00213500
         &SACBACK1 &SACBACK2                                            00213600
         LA    0,IWMRSNCODEBADPARENV   SET REASON CODE = BAD PAR ENV    00213700
         LA    15,IWMRETCODEINVOCERROR SET INVOCATION ERROR RETURN CODE 00213800
         B     END&SYSNDX              BRANCH TO END LABEL              00213900
PARENVOK&SYSNDX DS    0H               BRANCH LABEL FOR MON ENV OK      00214000
         L     0,PB_MIRROR_TKN-PB(15,0)  FETCH PARENT MIRROR TOKEN      00214100
         &SACBACK1 &SACBACK2                                            00214200
         ST    0,PB_PARENT_MIRROR_TKN    COPY PARENT MIRROR TOKEN       00214300
         ST    15,PB_PARENT_MONTKN                                      00214400
*                                                                       00214500
         LA    15,IWMRETCODEOK           SET RETURN CODE = OK           00214600
SETRELATE&SYSNDX DS   0H                BRANCH LABEL FOR RELATE TO HOME 00214700
         OI    PB_WORKDEF,PB_RELATE     SET RELATE                      00214800
         AGO   .ENDINLINE                                               00214900
.ENDCREATE  ANOP                                                        00215000
.*                                                                      00215100
.* THE FOLLOWING CODE HANDLES FUNCTION(DELETE)                          00215200
.*                                                                      00215300
         NI    PB_WORKDEF,X'FF'-PB_RELATE     RESET RELATE              00215400
         SLR   15,15                           SET RETURN CODE = OK     00215500
         ST    15,PB_PARENT_MONTKN                                      00215600
         ST    15,PB_PARENT_MIRROR_TKN                                  00215700
.ENDINLINE ANOP                                                         00215800
         DROP  14                                                       00215900
END&SYSNDX DS    0H                    END LABEL                        00216000
.*******************************************************************    00216100
.***        RETURN CODE PROCESSING                                      00216200
.*******************************************************************    00216300
         AIF   (N'&RETCODE LE 0).IWMMRELA_ENDRC_EXP                     00216400
         AIF   ('&XRETCODE'(1,1) EQ '(').IWMMRELA_RC_REG                00216500
         AIF   ('&XRETCODE' EQ 'GPR15').IWMMRELA_ENDRC_EXP              00216600
         AIF   ('&XRETCODE' EQ 'REG15').IWMMRELA_ENDRC_EXP              00216700
         AIF   ('&XRETCODE' EQ 'R15').IWMMRELA_ENDRC_EXP                00216800
         AIF   ('&XRETCODE' EQ '15').IWMMRELA_ENDRC_EXP                 00216900
         ST    15,&XRETCODE                                             00217000
         AGO   .IWMMRELA_ENDRC_EXP                                      00217100
.*                                                                      00217200
.IWMMRELA_RC_REG      ANOP  ,                                           00217300
&T1      SETC  '&XRETCODE'(2,K'&XRETCODE-2)                             00217400
         AIF   ('&T1' EQ 'GPR15').IWMMRELA_ENDRC_EXP                    00217500
         AIF   ('&T1' EQ 'REG15').IWMMRELA_ENDRC_EXP                    00217600
         AIF   ('&T1' EQ 'R15').IWMMRELA_ENDRC_EXP                      00217700
         AIF   ('&T1' EQ '15').IWMMRELA_ENDRC_EXP                       00217800
         LR    &T1,15                                                   00217900
.IWMMRELA_ENDRC_EXP   ANOP  ,                                           00218000
.*******************************************************************    00218100
.***        REASON CODE PROCESSING                                      00218200
.*******************************************************************    00218300
         AIF   (N'&RSNCODE LE 0).IWMMRELA_ENDRSN_EXP                    00218400
         AIF   ('&XRSNCODE'(1,1) EQ '(').IWMMRELA_RSN_REG               00218500
         AIF   ('&XRSNCODE' EQ 'GPR0').IWMMRELA_ENDRSN_EXP              00218600
         AIF   ('&XRSNCODE' EQ 'GPR00').IWMMRELA_ENDRSN_EXP             00218700
         AIF   ('&XRSNCODE' EQ 'REG0').IWMMRELA_ENDRSN_EXP              00218800
         AIF   ('&XRSNCODE' EQ 'REG00').IWMMRELA_ENDRSN_EXP             00218900
         AIF   ('&XRSNCODE' EQ 'R0').IWMMRELA_ENDRSN_EXP                00219000
         AIF   ('&XRSNCODE' EQ '0').IWMMRELA_ENDRSN_EXP                 00219100
         AIF   ('&XRSNCODE' EQ '00').IWMMRELA_ENDRSN_EXP                00219200
         ST    0,&XRSNCODE                                              00219300
         AGO   .IWMMRELA_ENDRSN_EXP                                     00219400
.*                                                                      00219500
.IWMMRELA_RSN_REG     ANOP  ,                                           00219600
&T1      SETC '&XRSNCODE'(2,K'&XRSNCODE-2)                              00219700
         AIF  ('&ZCGPR' EQ 'GPR0').IWMMRELA_ENDRSN_EXP                  00219800
         AIF  ('&ZCGPR' EQ 'GPR00').IWMMRELA_ENDRSN_EXP                 00219900
         AIF  ('&ZCGPR' EQ 'REG0').IWMMRELA_ENDRSN_EXP                  00220000
         AIF  ('&ZCGPR' EQ 'REG00').IWMMRELA_ENDRSN_EXP                 00220100
         AIF  ('&ZCGPR' EQ 'R0').IWMMRELA_ENDRSN_EXP                    00220200
         AIF  ('&ZCGPR' EQ '0').IWMMRELA_ENDRSN_EXP                     00220300
         AIF  ('&ZCGPR' EQ '00').IWMMRELA_ENDRSN_EXP                    00220400
         LR   &T1,0                                                     00220500
.IWMMRELA_ENDRSN_EXP  ANOP  ,                                           00220600
.*******************************************************************    00220700
&ZIWMMRELA            SETC  'YES'          SET IWMMRELA USED            00220800
         POP   PRINT                                                    00220900
*                                            IWMMRELA END               00221000
         SPACE 1                                                        00221100
         MEXIT                                                          00221200
.NOCODENEEDED ANOP                                                      00221300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00221400
.********************************************************************   00221500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00221600
.********************************************************************   00221700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00221800
                      LCLA  &ZOPN1         INVOCATION INDEX             00221900
                      LCLC  &ZOPL(4095)    LABEL                        00222000
                      LCLC  &ZOPO(4095)    OPERATION                    00222100
                      LCLC  &ZOPV(4095)    VALUE                        00222200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00222300
.*                                                                      00222400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00222500
.******************************************************************     00222600
.***AL.L10 IWMMRELA FMT=LIST MF=S|L PARAMETERS                          00222700
.******************************************************************     00222800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00222900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00223000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00223100
&XMFATTR              SETC  '0D'                                        00223200
.*                                                                      00223300
&ZOPN                 SETA  &ZOPN+1                                     00223400
&ZOPL(&ZOPN)          SETC  ' '                                         00223500
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00223600
&ZOPO(&ZOPN)          SETC  'B'                                         00223700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00223800
                      AGO   .ZALVL6B                                    00223900
.ZALVL6A              ANOP                                              00224000
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00224100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00224200
.ZALVL6B              ANOP                                              00224300
&ZOPD(&ZOPN)          SETC  '++ IWMMRELA ARG PARMS'                     00224400
.*                                                                      00224500
&ZOPN                 SETA  &ZOPN+1                                     00224600
&ZOPL(&ZOPN)          SETC  ' '                                         00224700
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00224800
&ZOPV(&ZOPN)          SETC  '1'                                         00224900
&ZOPD(&ZOPN)          SETC  ' '                                         00225000
.*                                                                      00225100
.ZLMFSL2              ANOP  ,                                           00225200
.*-------------------------------------------------------------------   00225300
.***AM.L00  IWMMRELA FMT=LIST name                                      00225400
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00225500
&ZOPN                 SETA &ZOPN+1                                      00225600
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00225700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00225800
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00225900
&ZOPD(&ZOPN)          SETC '++ IWMMRELA NAME'                           00226000
.ZLMFSL2M             ANOP  ,                                           00226100
.*-------------------------------------------------------------------   00226200
.***AM.L01  IWMMRELA FMT=LIST PARAMETERS                                00226300
&ZOPN                 SETA &ZOPN+1                                      00226400
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00226500
&ZOPO(&ZOPN)          SETC 'DS'                                         00226600
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00226700
&ZOPD(&ZOPN)          SETC '++ IWMMRELA PARM LIST'                      00226800
.*-------------------------------------------------------------------   00226900
.***AM.L02 XVERSION XL1                                                 00227000
&ZOPN                 SETA &ZOPN+1                                      00227100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00227200
&ZOPO(&ZOPN)          SETC 'DS'                                         00227300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00227400
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00227500
.*-------------------------------------------------------------------   00227600
.***AM.L03 XRELATE_OPTIONS BL.8                                         00227700
&ZOPN                 SETA &ZOPN+1                                      00227800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRELATE_OPTIONS'                  00227900
&ZOPO(&ZOPN)          SETC 'DS'                                         00228000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00228100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00228200
.*                                                                      00228300
&ZOPN                 SETA  &ZOPN+1                                     00228400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDISPTYPE_TCB'                   00228500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00228600
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00228700
&ZOPD(&ZOPN)          SETC  '++ XDISPTYPE.'                             00228800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TCB'                          00228900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00229000
.*                                                                      00229100
&ZOPN                 SETA  &ZOPN+1                                     00229200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDISPTYPE_SRB'                   00229300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00229400
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00229500
&ZOPD(&ZOPN)          SETC  '++ XDISPTYPE.'                             00229600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SRB'                          00229700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00229800
.*                                                                      00229900
&ZOPN                 SETA  &ZOPN+1                                     00230000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSAMEDU_YES'                     00230100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00230200
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00230300
&ZOPD(&ZOPN)          SETC  '++ XSAMEDU.'                               00230400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00230500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00230600
.*                                                                      00230700
&ZOPN                 SETA  &ZOPN+1                                     00230800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPARENTP_FINDACTIVE'             00230900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00231000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00231100
&ZOPD(&ZOPN)          SETC  '++ XPARENTP.'                              00231200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).FINDACTIVE'                   00231300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00231400
.*-------------------------------------------------------------------   00231500
.***AM.L09  XRSV0002 CL2                                                00231600
&ZOPN                 SETA &ZOPN+1                                      00231700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00231800
&ZOPO(&ZOPN)          SETC 'DS'                                         00231900
&ZOPV(&ZOPN)          SETC 'CL2'                                        00232000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00232100
.*-------------------------------------------------------------------   00232200
.***AM.L09  XOWNER_DATA BL.32                                           00232300
&ZOPN                 SETA &ZOPN+1                                      00232400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOWNER_DATA'                      00232500
&ZOPO(&ZOPN)          SETC 'DS'                                         00232600
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00232700
&ZOPD(&ZOPN)          SETC '++ &ZXOWNER_DATA  XOWNER_DATA'              00232800
.*-------------------------------------------------------------------   00232900
.***AM.L09  XOWNER_TOKEN BL.32                                          00233000
&ZOPN                 SETA &ZOPN+1                                      00233100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOWNER_TOKEN'                     00233200
&ZOPO(&ZOPN)          SETC 'DS'                                         00233300
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00233400
&ZOPD(&ZOPN)          SETC '++ &ZXOWNER_TOKEN  XOWNER_TOKEN'            00233500
.*-------------------------------------------------------------------   00233600
.***AM.L09 ADDR XTCB A                                                  00233700
&ZOPN                 SETA &ZOPN+1                                      00233800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTCB_ADDR'                        00233900
&ZOPO(&ZOPN)          SETC 'DS'                                         00234000
&ZOPV(&ZOPN)          SETC 'A'                                          00234100
&ZOPD(&ZOPN)          SETC '++ &ZXTCB ADDR XTCB'                        00234200
.*-------------------------------------------------------------------   00234300
.***AM.L09 ADDR XPARENTTCB A                                            00234400
&ZOPN                 SETA &ZOPN+1                                      00234500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPARENTTCB_ADDR'                  00234600
&ZOPO(&ZOPN)          SETC 'DS'                                         00234700
&ZOPV(&ZOPN)          SETC 'A'                                          00234800
&ZOPD(&ZOPN)          SETC '++ &ZXPARENTTCB ADDR XPARENTTCB'            00234900
.*-------------------------------------------------------------------   00235000
.***AM.L09  XMONTKN BL.32                                               00235100
&ZOPN                 SETA &ZOPN+1                                      00235200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00235300
&ZOPO(&ZOPN)          SETC 'DS'                                         00235400
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00235500
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN  XMONTKN'                      00235600
.*-------------------------------------------------------------------   00235700
.***AM.L09  XRSV0018 CL4                                                00235800
&ZOPN                 SETA &ZOPN+1                                      00235900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0018'                         00236000
&ZOPO(&ZOPN)          SETC 'DS'                                         00236100
&ZOPV(&ZOPN)          SETC 'CL4'                                        00236200
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0018'                      00236300
.*-------------------------------------------------------------------   00236400
.***AM.L10 END OF IWMMRELA LIST PARAMETERS                              00236500
&ZOPN                 SETA &ZOPN+1                                      00236600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00236700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00236800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00236900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00237000
.*                                                                      00237100
&ZOPN                 SETA &ZOPN+1                                      00237200
&ZOPL(&ZOPN)          SETC ' '                                          00237300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00237400
&ZOPV(&ZOPN)          SETC '1'                                          00237500
&ZOPD(&ZOPN)          SETC ' '                                          00237600
.*-------------------------------------------------------------------   00237700
.***AL.L12 IWMMRELA FMT=LIST MF=S|L PARAMETERS                          00237800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00237900
.*                                                                      00238000
&ZOPN                 SETA  &ZOPN+1                                     00238100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00238200
&ZOPO(&ZOPN)          SETC  'DC'                                        00238300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00238400
&ZOPD(&ZOPN)          SETC  '++ IWMMRELA ARG PARMS'                     00238500
.*                                                                      00238600
.ZLMFSLX              ANOP  ,                                           00238700
.*-------------------------------------------------------------------   00238800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00238900
&ZPLLEN               SETA 28                                           00239000
.*                                                                      00239100
.******************************************************************     00239200
.***AI.L01 IWMMRELA FMT=LIST FILL IN PARAMETER AREA                     00239300
.******************************************************************     00239400
                      ACTR  10000                                       00239500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00239600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00239700
&ZCVAL                SETC  'LAE'          XAX MODE                     00239800
.ZIMFXA               ANOP ,                                            00239900
.*                                                                      00240000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00240100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00240200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00240300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00240400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00240500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00240600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00240700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00240800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00240900
&ZOPN                 SETA  &ZOPN+1                                     00241000
&ZOPL(&ZOPN)          SETC  ' '                                         00241100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00241200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00241300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00241400
                      AGO   .ZIMFNX                                     00241500
.*                                                                      00241600
.ZIMFN2               ANOP ,                                            00241700
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00241800
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00241900
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00242000
&ZOPN                 SETA  &ZOPN+1                                     00242100
&ZOPL(&ZOPN)          SETC  ' '                                         00242200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00242300
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00242400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00242500
                      AGO   .ZIMFNX                                     00242600
.ZIMFNX1              ANOP ,                                            00242700
&ZOPN                 SETA  &ZOPN+1                                     00242800
&ZOPL(&ZOPN)          SETC  ' '                                         00242900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00243000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00243100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00243200
.ZIMFNX               ANOP ,                                            00243300
.********************************************************************   00243400
.***AI.L02 IWMMRELA FMT=LIST INITIALIZE PARAMETER AREA                  00243500
.********************************************************************   00243600
.***AI.L03 MF=(SLE)                                                     00243700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00243800
.*                                                                      00243900
&ZOPN                 SETA  &ZOPN+1                                     00244000
&ZOPL(&ZOPN)          SETC  ' '                                         00244100
&ZOPO(&ZOPN)          SETC  'XC'                                        00244200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00244300
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00244400
.ZIMFLX               ANOP  ,                                           00244500
.*-------------------------------------------------------------------   00244600
.***AI.L05 XRELATE_OPTIONS BL1                                          00244700
&ZW                   SETC  ''                                          00244800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00244900
.*-------------------------------------------------------------------   00245000
.***AI.L08 XRELATE_OPTIONS "TCB"                                        00245100
.***      BL1'1XXXXXXX'                                                 00245200
         AIF   ('&XDISPTYPE' NE 'TCB').ZI3A                             00245300
&ZW                   SETC  '&ZW.1'                                     00245400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00245500
                      AGO   .ZI3C                                       00245600
.*                                                                      00245700
.ZI3A                 ANOP  ,                                           00245800
&ZW                   SETC  '&ZW.0'                                     00245900
.ZI3C                 ANOP  ,                                           00246000
.*-------------------------------------------------------------------   00246100
.***AI.L08 XRELATE_OPTIONS "SRB"                                        00246200
.***      BL1'X1XXXXXX'                                                 00246300
         AIF   ('&XDISPTYPE' NE 'SRB').ZI4A                             00246400
&ZW                   SETC  '&ZW.1'                                     00246500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00246600
                      AGO   .ZI4C                                       00246700
.*                                                                      00246800
.ZI4A                 ANOP  ,                                           00246900
&ZW                   SETC  '&ZW.0'                                     00247000
.ZI4C                 ANOP  ,                                           00247100
.*-------------------------------------------------------------------   00247200
.***AI.L08 XRELATE_OPTIONS "YES"                                        00247300
.***      BL1'XX1XXXXX'                                                 00247400
         AIF   ('&XSAMEDU' NE 'YES').ZI5A                               00247500
&ZW                   SETC  '&ZW.1'                                     00247600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00247700
                      AGO   .ZI5C                                       00247800
.*                                                                      00247900
.ZI5A                 ANOP  ,                                           00248000
&ZW                   SETC  '&ZW.0'                                     00248100
.ZI5C                 ANOP  ,                                           00248200
.*-------------------------------------------------------------------   00248300
.***AI.L08 XRELATE_OPTIONS "FINDACTIVE"                                 00248400
.***      BL1'XXX1XXXX'                                                 00248500
         AIF   ('&XPARENTP' NE 'FINDACTIVE').ZI6A                       00248600
&ZW                   SETC  '&ZW.10000'                                 00248700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00248800
                      AGO   .ZI6C                                       00248900
.*                                                                      00249000
.ZI6A                 ANOP  ,                                           00249100
&ZW                   SETC  '&ZW.00000'                                 00249200
.ZI6C                 ANOP  ,                                           00249300
.*-------------------------------------------------------------------   00249400
.***AI.L11 XRELATE_OPTIONS BL1                                          00249500
                      AIF   ('&ZCLNG' NE 'YES').ZI6E  ALL ZERO BITS     00249600
&ZOPN                 SETA  &ZOPN+1                                     00249700
&ZOPL(&ZOPN)          SETC  ' '                                         00249800
&ZOPO(&ZOPN)          SETC  'OI'                                        00249900
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00250000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00250100
.ZI6E                 ANOP  ,                                           00250200
.*-------------------------------------------------------------------   00250300
.***AI.L18  XOWNER_DATA XL4                                             00250400
         AIF   ('&XOWNER_DATA' NE 'NO_OWNER_DATA').ZI8                  00250500
&ZXOWNER_DATA         SETC  ''             RESET INPUT/OUTPUT           00250600
.ZI8                  ANOP  ,                                           00250700
.*-------------------------------------------------------------------   00250800
.***AI.L25  XOWNER_DATA XL4                                             00250900
                      AIF   ('&ZXOWNER_DATA' EQ '').ZI8E                00251000
                      AIF   ('&ZXOWNER_DATA' EQ 'OUTPUT').ZI8E          00251100
&ZCGPR                SETC  '&XOWNER_DATA'                              00251200
.*                                                                      00251300
                      AIF   ('&XOWNER_DATA'(1,1) NE '(').ZI8B           00251400
&ZCGPR   SETC  '0('.'&XOWNER_DATA'(2,K'&XOWNER_DATA-2).')'              00251500
                      AGO   .ZI8D                                       00251600
.ZI8B                 ANOP  ,                                           00251700
.*                                                                      00251800
&ZC                   SETC  '&XOWNER_DATA'(1,1)                         00251900
                      AIF   (T'&ZC NE 'N').ZI8D                         00252000
&ZC                   SETC  '&XOWNER_DATA'                              00252100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00252200
&ZCGPR                SETC  '=BL4''&XOWNER_DATA'''                      00252300
.*                                                                      00252400
.ZI8D                 ANOP  ,                                           00252500
.*                                                                      00252600
&ZOPN                 SETA  &ZOPN+1                                     00252700
&ZOPL(&ZOPN)          SETC  ' '                                         00252800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00252900
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00253000
&ZOPD(&ZOPN)          SETC  '++ &ZXOWNER_DATA XOWNER_DATA'              00253100
.*                                                                      00253200
.ZI8E                 ANOP  ,                                           00253300
.*-------------------------------------------------------------------   00253400
.***AI.L18  XOWNER_TOKEN XL4                                            00253500
         AIF   ('&XOWNER_TOKEN' NE 'NO_OWNER_TOKEN').ZI9                00253600
&ZXOWNER_TOKEN        SETC  ''             RESET INPUT/OUTPUT           00253700
.ZI9                  ANOP  ,                                           00253800
.*-------------------------------------------------------------------   00253900
.***AI.L25  XOWNER_TOKEN XL4                                            00254000
                      AIF   ('&ZXOWNER_TOKEN' EQ '').ZI9E               00254100
                      AIF   ('&ZXOWNER_TOKEN' EQ 'OUTPUT').ZI9E         00254200
&ZCGPR                SETC  '&XOWNER_TOKEN'                             00254300
.*                                                                      00254400
                      AIF   ('&XOWNER_TOKEN'(1,1) NE '(').ZI9B          00254500
&ZCGPR   SETC  '0('.'&XOWNER_TOKEN'(2,K'&XOWNER_TOKEN-2).')'            00254600
                      AGO   .ZI9D                                       00254700
.ZI9B                 ANOP  ,                                           00254800
.*                                                                      00254900
&ZC                   SETC  '&XOWNER_TOKEN'(1,1)                        00255000
                      AIF   (T'&ZC NE 'N').ZI9D                         00255100
&ZC                   SETC  '&XOWNER_TOKEN'                             00255200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00255300
&ZCGPR                SETC  '=BL4''&XOWNER_TOKEN'''                     00255400
.*                                                                      00255500
.ZI9D                 ANOP  ,                                           00255600
.*                                                                      00255700
&ZOPN                 SETA  &ZOPN+1                                     00255800
&ZOPL(&ZOPN)          SETC  ' '                                         00255900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00256000
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00256100
&ZOPD(&ZOPN)          SETC  '++ &ZXOWNER_TOKEN XOWNER_TOKEN'            00256200
.*                                                                      00256300
.ZI9E                 ANOP  ,                                           00256400
.*-------------------------------------------------------------------   00256500
.***AI.L19 ADDR XTCB A                                                  00256600
                      AIF   ('&ZXTCB' EQ '').ZI10H                      00256700
&ZCLNG                SETC  '&XTCB'                                     00256800
&ZCGPR                SETC  '14'                                        00256900
         AIF   ('&XTCB'(1,1) EQ '(').ZI10F  IN GPR                      00257000
.*                                                                      00257100
&ZOPN                 SETA  &ZOPN+1                                     00257200
&ZOPL(&ZOPN)          SETC  ' '                                         00257300
&ZOPO(&ZOPN)          SETC  'LA'                                        00257400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00257500
&ZOPD(&ZOPN)          SETC  '++ &ZXTCB XTCB'                            00257600
.*                                                                      00257700
                      AGO   .ZI10G                                      00257800
.*                                                                      00257900
.ZI10F                ANOP  ,                                           00258000
&ZCGPR   SETC  '&XTCB'(2,K'&XTCB-2)                                     00258100
.*                                                                      00258200
.ZI10G                ANOP  ,                                           00258300
.*                                                                      00258400
&ZOPN                 SETA  &ZOPN+1                                     00258500
&ZOPL(&ZOPN)          SETC  ' '                                         00258600
&ZOPO(&ZOPN)          SETC  'ST'                                        00258700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00258800
&ZOPD(&ZOPN)          SETC  '++ &ZXTCB XTCB'                            00258900
.*                                                                      00259000
.ZI10H                ANOP  ,                                           00259100
.*-------------------------------------------------------------------   00259200
.***AI.L19 ADDR XPARENTTCB A                                            00259300
                      AIF   ('&ZXPARENTTCB' EQ '').ZI11H                00259400
&ZCLNG                SETC  '&XPARENTTCB'                               00259500
&ZCGPR                SETC  '14'                                        00259600
         AIF   ('&XPARENTTCB'(1,1) EQ '(').ZI11F  IN GPR                00259700
.*                                                                      00259800
&ZOPN                 SETA  &ZOPN+1                                     00259900
&ZOPL(&ZOPN)          SETC  ' '                                         00260000
&ZOPO(&ZOPN)          SETC  'LA'                                        00260100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00260200
&ZOPD(&ZOPN)          SETC  '++ &ZXPARENTTCB XPARENTTCB'                00260300
.*                                                                      00260400
                      AGO   .ZI11G                                      00260500
.*                                                                      00260600
.ZI11F                ANOP  ,                                           00260700
&ZCGPR   SETC  '&XPARENTTCB'(2,K'&XPARENTTCB-2)                         00260800
.*                                                                      00260900
.ZI11G                ANOP  ,                                           00261000
.*                                                                      00261100
&ZOPN                 SETA  &ZOPN+1                                     00261200
&ZOPL(&ZOPN)          SETC  ' '                                         00261300
&ZOPO(&ZOPN)          SETC  'ST'                                        00261400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00261500
&ZOPD(&ZOPN)          SETC  '++ &ZXPARENTTCB XPARENTTCB'                00261600
.*                                                                      00261700
.ZI11H                ANOP  ,                                           00261800
.*-------------------------------------------------------------------   00261900
.***AI.L25  XMONTKN XL4                                                 00262000
                      AIF   ('&ZXMONTKN' EQ '').ZI12E                   00262100
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI12E             00262200
&ZCGPR                SETC  '&XMONTKN'                                  00262300
.*                                                                      00262400
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI12B              00262500
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00262600
                      AGO   .ZI12D                                      00262700
.ZI12B                ANOP  ,                                           00262800
.*                                                                      00262900
&ZC                   SETC  '&XMONTKN'(1,1)                             00263000
                      AIF   (T'&ZC NE 'N').ZI12D                        00263100
&ZC                   SETC  '&XMONTKN'                                  00263200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00263300
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00263400
.*                                                                      00263500
.ZI12D                ANOP  ,                                           00263600
.*                                                                      00263700
&ZOPN                 SETA  &ZOPN+1                                     00263800
&ZOPL(&ZOPN)          SETC  ' '                                         00263900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00264000
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00264100
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00264200
.*                                                                      00264300
.ZI12E                ANOP  ,                                           00264400
.*-------------------------------------------------------------------   00264500
&ZOPN1                SETA &ZOPN                                        00264600
.*******************************************************************    00264700
.***  PROCESS IWMMRELA OUTPUT PARAMETERS                                00264800
.*******************************************************************    00264900
                      ACTR  10000                                       00265000
.*******************************************************************    00265100
.***AO.X02  RETURN CODE PROCESSING                                      00265200
.*******************************************************************    00265300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00265400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00265500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00265600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00265700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00265800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00265900
&ZOPN                 SETA  &ZOPN+1                                     00266000
&ZOPL(&ZOPN)          SETC  ' '                                         00266100
&ZOPO(&ZOPN)          SETC  'ST'                                        00266200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00266300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00266400
                      AGO   .ZMRETX                                     00266500
.*                                                                      00266600
.ZMRET2               ANOP  ,                                           00266700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00266800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00266900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00267000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00267100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00267200
&ZOPN                 SETA  &ZOPN+1                                     00267300
&ZOPL(&ZOPN)          SETC  ' '                                         00267400
&ZOPO(&ZOPN)          SETC  'LR'                                        00267500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00267600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00267700
.ZMRETX               ANOP  ,                                           00267800
.*******************************************************************    00267900
.***AO.X03  REASON CODE PROCESSING                                      00268000
.*******************************************************************    00268100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00268200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00268300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00268400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00268500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00268600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00268700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00268800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00268900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00269000
&ZOPN                 SETA  &ZOPN+1                                     00269100
&ZOPL(&ZOPN)          SETC  ' '                                         00269200
&ZOPO(&ZOPN)          SETC  'ST'                                        00269300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00269400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00269500
                      AGO   .ZMRSNX                                     00269600
.*                                                                      00269700
.ZMRSN2               ANOP  ,                                           00269800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00269900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00270000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00270100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00270200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00270300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00270400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00270500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00270600
&ZOPN                 SETA  &ZOPN+1                                     00270700
&ZOPL(&ZOPN)          SETC  ' '                                         00270800
&ZOPO(&ZOPN)          SETC  'LR'                                        00270900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00271000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00271100
.ZMRSNX               ANOP  ,                                           00271200
.*******************************************************************    00271300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00271400
.*******************************************************************    00271500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00271600
.*******************************************************************    00271700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00271800
.*******************************************************************    00271900
                      ACTR  10000                                       00272000
.*                                                                      00272100
                      LCLA  &ZLC           COLUMN POSITION              00272200
                      LCLA  &ZOPX          LIST TABLE INDEX             00272300
                      LCLC  &ZLL           LABEL                        00272400
                      LCLC  &ZLOP          OPERATION                    00272500
                      LCLC  &ZLV           VALUE                        00272600
                      LCLC  &ZLD           DESCRIPTION                  00272700
.*                                                                      00272800
&ZOPX                 SETA  1                                           00272900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00273000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00273100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00273200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00273300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00273400
                      AIF   (K'&ZLD LE 0).ZL5                           00273500
&ZLC                  SETA  35             COMMENT COLUMN               00273600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00273700
&ZLC                  SETA  33             COMMMENT COLUMN              00273800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00273900
&ZLV                  SETC  '&ZLV'.' '                                  00274000
                      AGO   .ZL3                                        00274100
.*                                                                      00274200
.ZL4                  ANOP  ,                                           00274300
&ZLV                  SETC  '&ZLV'.' '                                  00274400
.ZL5                  ANOP  ,                                           00274500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00274600
.*                                                                      00274700
&ZLL     &ZLOP &ZLV                                                     00274800
.*                                                                      00274900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00275000
                      AGO   .ZL2           CONTINUE LOOPING             00275100
.*                                                                      00275200
.ZLX                  ANOP  ,                                           00275300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00275400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00275500
         L     14,16(0,0)              GET CVT ADDRESS                  00275600
         TM    CVTOSLV1-CVT(14),X'40'    TEST FOR WLM PRESENCE          00275700
         BO    WLM&SYSNDX              BRANCH WHEN WLM IS PRESENT       00275800
         LA    0,IWMRSNCODENOWLM       SET REASON CODE = NO WLM         00275900
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00276000
         B     END&SYSNDX              BRANCH TO END LABEL              00276100
WLM&SYSNDX DS    0H                    BRANCH LABEL FOR WLM PRESENT     00276200
         L     14,772(14,0)            GET SFT ADDRESS                  00276300
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       00276400
         LA    15,3                    GET EX FOR SERVICE ROUTINE       00276500
         OR    14,15                   GET PC NUMBER                    00276600
         PC    0(14)                                                    00276700
END&SYSNDX DS    0H                    END LABEL                        00276800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00276900
.ZLINKX               ANOP  ,                                           00277000
.*******************************************************************    00277100
.***AP.X01  FORMAT GENERATED CODE                                       00277200
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00277300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00277400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00277500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00277600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00277700
                      AIF   (K'&ZLD LE 0).ZL51                          00277800
&ZLC                  SETA  35             COMMENT COLUMN               00277900
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00278000
&ZLC                  SETA  33             COMMENT COLUMN               00278100
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00278200
&ZLV                  SETC  '&ZLV'.' '                                  00278300
                      AGO   .ZL31                                       00278400
.*                                                                      00278500
.ZL41                 ANOP  ,                                           00278600
&ZLV                  SETC  '&ZLV'.' '                                  00278700
.ZL51                 ANOP  ,                                           00278800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00278900
.*                                                                      00279000
&ZLL     &ZLOP &ZLV                                                     00279100
.*                                                                      00279200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00279300
                      AGO   .ZL21          CONTINUE LOOPING             00279400
.*                                                                      00279500
.ZLX1                 ANOP  ,                                           00279600
.*******************************************************************    00279700
.***AP.X02  END OF IWMMRELA MACRO                                       00279800
&ZIWMMRELA            SETC  'YES'          SET IWMMRELA USED            00279900
         POP   PRINT                                                    00280000
*                                            IWMMRELA-0                 00280100
         SPACE 1                                                        00280200
.ZLX2                 ANOP  ,                                           00280300
         MEND                                                           00280400
**********************************************************************/ 00280500
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00280600
*%IWMMRELA: MACRO KEYS(FUNCTION,OWNER_TOKEN,OWNER_DATA,DISPTYPE,TCB,    00280700
*                 SAMEDU,PARENTP,PARENTMONTKN,PARENTENV,PARENTTCB,      00280800
*                 MONTKN,RETCODE,RSNCODE,PLISTVER,MF);                  00280900
*  ANS('?'||MACLABEL||' '||'IWMMRELP '||MACLIST||                       00281000
*         ' '||MACKEYS||';') COL(MACLMAR);                              00281100
*%END IWMMRELA;                                                         00281200
