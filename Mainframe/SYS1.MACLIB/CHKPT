* %GOTO CHKPTC1; /*                                                     00050000
         MACRO                                                          00800000
&NAME    CHKPT &DCB,                                                   *00850000
               &ID,                                                    *00900000
               &LNG,                                                   *00950000
               &DDNADDR=,                                              *01000000
               &IDADDR=,                                               *01050000
               &IDLNG=,                                                *01100000
               &MF=S                                                    01150000
.**** START OF SPECIFICATIONS ***************************************** 01200000
.*                                                                    * 01250000
.*$MAC(CHKPT): CHECKPOINT INVOCATION MACRO.                           * 01300000
.*                                                                    * 01350000
.*PROPRIETARY V3 STATEMENT                                              01352300
.*LICENSED MATERIALS - PROPERTY OF IBM                                  01354600
.*"RESTRICTED MATERIALS OF IBM"                                         01356900
.*5695-DF1                                                              01359200
.*(C) COPYRIGHT 1982  IBM CORP.                                         01361500
.*END PROPRIETARY V3 STATEMENT                                          01365000
.*                                                                    * 01368500
.********************************************************************** 01372500
.*                                                                    * 01395100
.*01* MACRO NAME = CHKPT                                              * 01400000
.*                                                                    * 01450000
.*01* DESCRIPTIVE-NAME = CHECKPOINT INVOCATION MACRO                  * 01500000
.*                                                                    * 01550000
.*01* STATUS = MVS/XA DFP RELEASE 1                                   * 01600000
.*                                                                    * 01650000
.*01* FUNCTION = THIS MACRO WILL SET UP THE CHECKPOINT PARAMETER      * 01800000
.*     LIST TO ALLOW THE CALLER TO INVOCATE CHECKPOINT TO CREATE A    * 01850000
.*     CHECKPOINT RECORD ON A CHECKPOINT DATA SET.                    * 01900000
.*                                                                    * 01950000
.*02* KEYWORDS =                                                      * 02000000
.*                                                                    * 02050000
.*     THE 'MF' KEYWORD DETERMINES WHETHER THE CHECKPOINT PARAMETER   * 02100000
.*     LIST IS EXPANDED AND/OR EXECUTABLE INSTRUCTIONS ARE GENERATED  * 02150000
.*     TO INVOKE CHECKPOINT.                                          * 02200000
.*                                                                    * 02250000
.*     THE SPECIFICATION OF MF=(E,ADDR), WILL RESULT IN THE           * 02300000
.*     MODIFICATION OF AN EXISTING CHECKPOINT PARAMETER LIST. THE     * 02350000
.*     ADDRESS OF THE PARAMETER LIST IS PROVIDED VIA A SECOND         * 02400000
.*     SUBPARAMETER OF THE 'MF' KEYWORD.  IT ALSO GENERATES CODE      * 02450000
.*     NECESSARY TO INVOKE CHECKPOINT. THIS IS CALLED THE             * 02500000
.*     EXECUTE-FORM OF THE MACRO.                                     * 02550000
.*                                                                    * 02600000
.*     WITH A SPECIFICATION OF MF=S, OR NOT SPECIFYING THE 'MF'       * 02650000
.*     KEYWORD AT ALL, THIS MACRO WILL EXPAND THE CHECKPOINT PARAMETER* 02700000
.*     LIST AND INITIALIZE IT ACCORDING TO THE OPTIONS SELECTED       * 02750000
.*     VIA THE ALLOWABLE KEYWORDS.  IT ALSO GENERATES CODE            * 02800000
.*     NECESSARY TO ISSUE SVC 63 TO INVOKE CHECKPOINT. THIS IS        * 02850000
.*     CALLED THE STANDARD-FORM (NORMAL-FORM) OF THE MACRO.           * 02900000
.*                                                                    * 02950000
.*     THE SPECIFICATION OF MF=L WILL RESULT IN THE EXPANSION OF THE  * 03000000
.*     PARAMETER LIST AND INITIALIZE IT ACCORDING TO THE SPECIFIED    * 03050000
.*     KEYWORDS. HOWEVER IT DOES NOT GENERATE THE CODE TO INVOKE      * 03100000
.*     CHECKPOINT. THIS IS CALLED THE LIST-FORM OF THE MACRO.         * 03150000
.*                                                                    * 03200000
.*     POSITIONAL OPERANDS ARE:                                       * 03250000
.*                                                                    * 03300000
.*        DCB - WILL PUT THE ADDRESS OF THE DCB INTO THE CHECKPOINT   * 03350000
.*              PARAMETER LIST. THIS OPERAND MAY SPECIFY A REGISTER   * 03400000
.*              WHICH POINTS TO THE LOCATION OF THE DCB, THE LABEL OF * 03450000
.*              THE LOCATION OF A DCB, OR "CANCEL". THIS FIELD IS     * 03500000
.*              REQUIRED FOR THE STANDARD FORM IF THE DDNADDR=        * 03550000
.*              OPERAND IS NOT USED.                                  * 03600000
.*                                                                    * 03650000
.*              VALID ENTRIES:  (RX)  ONE OF THE GENERAL REGISTERS 2  * 03700000
.*                                    THROUGH 12 EXCEPT FOR THE       * 03750000
.*                                    REGISTER USED FOR MF= (IF THE   * 03800000
.*                                    REGISTER FORM IS USED).         * 03850000
.*                                    ASSEMBLER ONLY.                 * 03900000
.*                              DCBADDR                               * 03950000
.*                              (DCBADDR)  PLS ONLY. REGISTER FORM.   * 04000000
.*                              CANCEL                                * 04050000
.*                                                                    * 04100000
.*        ID - WILL PUT THE ADDRESS OF THE FIELD CONTAINING (OR TO    * 04150000
.*             RECEIVE) THE CHECKPOINT ID INTO THE CHECKPOINT         * 04200000
.*             PARAMETER LIST. THIS OPERAND MAY SPECIFY A REGISTER    * 04250000
.*             WHICH POINTS TO THE CHECKPOINT ID FIELD OR THE LABEL OF* 04300000
.*             THE CHECKPOINT ID FIELD. THIS OPERAND IS OPTIONAL.     * 04350000
.*                                                                    * 04400000
.*             VALID ENTRIES: (RX)   ONE OF THE GENERAL REGISTERS 2   * 04450000
.*                                   THROUGH 12 EXCEPT FOR THE        * 04500000
.*                                   REGISTER USED FOR MF=, DCB, OR   * 04550000
.*                                   DDNADDR= (IF THE REGISTER FORM OF* 04600000
.*                                   ANY OF THESE OPERANDS IS USED).  * 04650000
.*                                   ASSEMBLER ONLY.                  * 04700000
.*                            CKIDADDR                                * 04750000
.*                            (CKIDADDR) PLS ONLY. REGISTER FORM.     * 04800000
.*                                                                    * 04850000
.*        LNG - WILL PUT THE LENGTH OF THE CHECKPOINT ID FIELD INTO   * 04900000
.*              THE CHECKPOINT PARAMETER LIST. THIS OPERAND MAY       * 04950000
.*              SPECIFY A REGISTER WHICH CONTAINS THE LENGTH OR A BASE* 05000000
.*              DISPLACEMENT TYPE VALUE. THIS OPERAND IS OPTIONAL.    * 05050000
.*                                                                    * 05100000
.*              FOR ASSEMBLY: IF LNG AND IDLNG ARE OMMITTED AND ID OR * 05150000
.*              IDADDR ARE SPECIFIED, THIS VALUE WILL DEFAULT TO 8.   * 05200000
.*                                                                    * 05250000
.*             VALID ENTRIES: (RX)    ONE OF THE GENERAL REGISTERS 2  * 05300000
.*                                    THROUGH 12 EXCEPT FOR THE       * 05350000
.*                                    REGISTER USED FOR MF=, DCB, ID, * 05400000
.*                                    DDNADDR=, OR IDADDR= (IF THE    * 05450000
.*                                    THE REGISTER FORM OF ANY        * 05500000
.*                                    OF THESE OPERANDS IS USED).     * 05550000
.*                                    ASSEMBLER ONLY.                 * 05600000
.*                             L'CKIDADDR                             * 05650000
.*                             CKIDLNTH                               * 05700000
.*                                                                    * 05750000
.*     KEYWORDS APPLICABLE TO THE CHECKPOINT MACRO ARE:               * 05800000
.*                                                                    * 05850000
.*       DDNADDR - WILL SET THE ADDRESS OF THE FIELD OF THE DD NAME   * 05900000
.*                 INTO THE CHECKPOINT PARAMETER LIST. THIS KEYWORD   * 05950000
.*                 IS REQUIRED FOR THE STANDARD FORM IF THE POSITIONAL* 06000000
.*                 OPERAND DCB IS OMMITTED.                           * 06050000
.*                                                                    * 06100000
.*                 FOR PLS, THE REGISTER FORM GENERATES ASSIGNMENT    * 06150000
.*                 OR INIT VALUES TO THE OPERAND VALUE. OTHERWIZE,    * 06200000
.*                 THE ADDRESS OF THE OPERAND VALUE IS GENERATED.     * 06250000
.*                                                                    * 06300000
.*                 VALID ENTRIES:  DDNADDR=(RX) ONE OF THE GENERAL    * 06350000
.*                                              REGISTERS 2 THROUGH   * 06400000
.*                                              12 EXCEPT FOR THE     * 06450000
.*                                              REGISTER USED FOR     * 06500000
.*                                              MF= (IF THE REGISTER  * 06550000
.*                                              FORM IS USED).        * 06600000
.*                                              ASSEMBLER ONLY.       * 06650000
.*                                 DDNADDR=DDNADDR ASSEMBLER.         * 06700000
.*                                 DDNADDR(DDNADDR) PLS               * 06750000
.*                                 DDNADDR((DDNADDR)) PLS. REG. FORM. * 06800000
.*                                                                    * 06850000
.*       IDADDR  - WILL SET THE ADDRESS OF THE FIELD CONTAINING (OR   * 06900000
.*                 TO RECEIVE) THE CHECKPOINT ID INTO THE CHECKPOINT  * 06950000
.*                 PARAMETER LIST. THIS OPERAND MAY SPECIFY A REGISTER* 07000000
.*                 WHICH POINTS TO THE CHECKPOINT ID FIELD OR THE     * 07050000
.*                 LABEL OF THE CHECKPOINT ID FIELD. THIS OPERAND IS  * 07100000
.*                 OPTIONAL.                                          * 07150000
.*                                                                    * 07200000
.*                 FOR PLS, THE REGISTER FORM GENERATES ASSIGNMENT    * 07250000
.*                 OR INIT VALUES TO THE OPERAND VALUE. OTHERWIZE,    * 07300000
.*                 THE ADDRESS OF THE OPERAND VALUE IS GENERATED.     * 07350000
.*                                                                    * 07400000
.*                 VALID ENTRIES: IDADDR=(RX) ONE OF THE GENERAL REGS * 07450000
.*                                           2 THROUGH 12 EXCEPT      * 07500000
.*                                           FOR THE REGISER USED     * 07550000
.*                                           FOR MF=, DCB, OR DDNADDR=* 07600000
.*                                           (IF THE REGISTER FORM OF * 07650000
.*                                           ANY OF THESE OPERANDS IS * 07700000
.*                                           USED).                   * 07750000
.*                                           ASSEMBLER ONLY.          * 07800000
.*                                IDADDR=CKIDADDR ASSEMBLER.          * 07850000
.*                                IDADDR(CKIDADDR) PLS.               * 07900000
.*                                IDADDR((CKIDADR)) PLS. REG. FORM.   * 07950000
.*                                                                    * 08000000
.*       IDLNG - WILL SET THE LENGTH OF THE CHECKPOINT ID FIELD INTO  * 08050000
.*              THE CHECKPOINT PARAMETER LIST. THIS OPERAND MAY       * 08100000
.*              SPECIFY A REGISTER WHICH CONTAINS THE LENGTH OR A BASE* 08150000
.*              DISPLACEMENT TYPE VALUE. THIS OPERAND IS OPTIONAL.    * 08200000
.*                                                                    * 08250000
.*              FOR ASSEMBLY: IF LNG AND IDLNG ARE OMMITTED AND ID OR * 08300000
.*              IDADDR ARE SPECIFIED, THIS VALUE WILL DEFAULT TO 8.   * 08350000
.*                                                                    * 08400000
.*              VALID ENTRIES: IDLNG=(RX) ONE OF THE GENERAL REGISTERS* 08450000
.*                                        2 THROUGH 12 EXCEPT FOR THE * 08500000
.*                                        REGISTER USED FOR MF=, DCB, * 08550000
.*                                        ID, DDNADDR=, OR IDADDR=    * 08600000
.*                                        (IF THE REGISTER FORM OF ANY* 08650000
.*                                        OF THESE OPERANDS IS USED). * 08700000
.*                                        ASSEMBLER ONLY.             * 08750000
.*                             IDLNG=L'CKIDADDR                       * 08800000
.*                             IDLNG=CKIDLNTH                         * 08850000
.*                                                                    * 08900000
.*                                                                    * 08950000
.*       MF      - SEE THE OPENING PARAGRAPHS ABOVE.  IF THE MF       * 09000000
.*                 KEYWORD IS NOT SPECIFIED, THE DEFAULT, MF=S, WILL  * 09050000
.*                 BE IN EFFECT.                                      * 09100000
.*                                                                    * 09150000
.*               - FOR PLS:                                           * 09200000
.*                 MF(L,NAME) GENERATES A STATIC LOCAL LIST.          * 09250000
.*                 MF(L,NAME1,NAME2) GENERATES A STATIC LOCAL         * 09300000
.*                 STRUCTURE DECLARED AS NAME2, AND AN AUTODATA       * 09350000
.*                 STRUCTURE DECLARED AS NAME1.                       * 09400000
.*                 MF(S,ADDR1,ADDR2) FIRST GENERATES A STATIC LOCAL   * 09450000
.*                 STRUCTURE DECLARED AS ADDR2, AND AN AUTODATA       * 09500000
.*                 STRUCTURE DECLARED AS ADDR1, THEN MOVES THE        * 09550000
.*                 LIST FROM ADDR2 TO ADDR1. THE VALUES SPECIFIED ARE * 09600000
.*                 THEN STORED IN THE LIST ADDR1.                     * 09650000
.*                                                                    * 09700000
.*               - FOR PLS AND ASSEMBLER:                             * 09750000
.*                 MF=(E,ADDR1,ADDR2) FIRST MOVES THE MODEL LIST FROM * 09800000
.*                 ADDR2 TO ADDR1, THEN UPDATES THE LIST AS NEEDED IN * 09850000
.*                 ADDR1. ADDR1 AND ADDR2 MUST BE ADDRESSABLE TO USE  * 09900000
.*                 THIS FORM.                                         * 09950000
.*                                                                    * 10000000
.*               - THE ADDR2 OR NAME2 OPTION IS USEFUL WHERE AUTODATA * 10050000
.*                 MUST BE USED FOR A LIST.                           * 10100000
.*                                                                    * 10150000
.*               - FOR THE STANDARD-FORM (MF=S), THE                  * 10200000
.*                 FOLLOWING VALIDITY CHECK WILL BE MADE:             * 10250000
.*                      EITHER THE POSITIONAL OPERAND DCB OR THE      * 10300000
.*                      KEYWORD DDNADDR= IS REQUIRED.                 * 10350000
.*                                                                    * 10400000
.*               - FOR ALL FORMS OF THE MACRO, THE FOLLOWING          * 10450000
.*                 VALIDITY CHECKS WILL BE MADE:                      * 10500000
.*                   1. VALID KEYWORD OPERANDS.                       * 10550000
.*                   2. DCB AND DDNADDR ARE MUTUALLY EXCLUSIVE.       * 10600000
.*                   3. ID AND IDADDR ARE MUTUALLY EXCLUSIVE.         * 10650000
.*                   4. LNG AND IDLNG ARE MUTUALLY EXCLUSIVE.         * 10700000
.*                   5. FOR LNG OR IDLNG, EITHER ID OR IDADDR IS      * 10750000
.*                      REQUIRED.                                     * 10800000
.*                                                                    * 10850000
.*                 VALID ENTRIES:  MF=S             DEFAULT           * 10900000
.*                                 MF=(S,ADDR)                        * 10950000
.*                                 MF(S,ADDR1,ADDR2) PLS ONLY         * 11000000
.*                                 MF=L               ASM ONLY        * 11050000
.*                                 MF=(L,NAME)                        * 11100000
.*                                 MF(L,NAME1,NAME2) PLS ONLY         * 11150000
.*                                 MF=(E,(RX))      ASSEMBLER ONLY.   * 11200000
.*                                         WHERE RX IS ONE OF THE     * 11250000
.*                                         GENERAL REGISTERS 2 THROUGH* 11300000
.*                                         12.                        * 11350000
.*                                 MF=(E,(1))       ASSEMBLER ONLY.   * 11400000
.*                                 MF=(E,ADDR)                        * 11450000
.*                                 MF=(E,ADDR1,ADDR2)                 * 11500000
.*                                 MF=(E,(RX),(RX)) REGISTER FORM     * 11550000
.*                                                                    * 11600000
.*01* NOTES = N/A                                                     * 11650000
.*                                                                    * 11700000
.*01* MODULE-TYPE = MACRO                                             * 11750000
.*                                                                    * 11800000
.*02* PROCESSOR = BILINQUAL. ASSEMBLER LANGUAGE OR PLS3.              * 11850000
.*                                                                    * 11900000
.*02* ATTRIBUTES = EXECUTABLE MACRO                                   * 11950000
.*                                                                    * 12000000
.*01* ENTRY-POINT = MACRO STATEMENT.                                  * 12050000
.*                                                                    * 12100000
.*02* INPUT = SEE DESCRIPTION OF OPERANDS AND KEYWORDS UNDER          * 12150000
.*           "FUNCTION".                                              * 12200000
.*                                                                    * 12250000
.*02* OUTPUT = CHECKPOINT PARAMETER LIST WITH THE FLAGS AND THE       * 12300000
.*           ADDRESSES SET DEPENDING UPON THE OPERANDS AND  KEYWORDS  * 12350000
.*           SPECIFIED AS DEFINED UNDER "OPERANDS" AND "KEYWORDS"     * 12400000
.*           ABOVE.                                                   * 12450000
.*                                                                    * 12500000
.*          FORMAT:                                                   * 12550000
.*                                                                    * 12600000
.*          BYTES  BIT  EXPLANATION                                   * 12650000
.*             0    0   THE ADDRESS OF THE CHECKPOINT ID FIELD WAS    * 12700000
.*                      NOT SUPPLIED.                                 * 12750000
.*                  1   RESERVED.                                     * 12800000
.*                  2   RESERVED.                                     * 12850000
.*                  3   RESERVED.                                     * 12900000
.*                  4   RESERVED.                                     * 12950000
.*                  5   =1 - RETURN SYSTEM GENERATED CHECKPOINT ID.   * 13000000
.*                      =0 - USE CHECKPOINT ID PROVIDED BY CALLER.    * 13050000
.*                  6   =1 - DDNADDR WAS SPECIFIED.                   * 13100000
.*                      =0 - DCB ADDRESS WAS SPECIFIED.               * 13150000
.*                  7   =1. THIS PARAMETER LIST IS IN THE MVS/XA      * 13200000
.*                          FORM.                                     * 13250000
.*             1        LENGTH OF USER SUPPLIED FIELD FOR CHECKPOINT  * 13300000
.*                      ID.                                           * 13350000
.*             2        LENGTH OF THIS CHECKPOINT PARAMETER LIST.     * 13400000
.*             3        RESERVED.                                     * 13450000
.*           4-7        ADDRESS OF DD NAME OR DCB.                    * 13500000
.*           8-11       ADDRESS OF THE CHECKPOINT ID FIELD OR 0.      * 13550000
.*                                                                    * 13600000
.*01* EXIT-NORMAL = MEND STATEMENT OR PLS END STATEMENT.              * 13650000
.*                                                                    * 13700000
.*01* EXIT-ERROR = (FOR ASSEMBLER)                                    * 13750000
.*               MNOTE AND MEND STATEMENT.  MNOTES WILL BE GENERATED  * 13800000
.*               FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED:         * 13850000
.*                                                                    * 13900000
.*                 FOR THE MF=S FORM OF THE MACRO:                    * 13950000
.*                   1. DCB OR DDNADDR= NOT SUPPLIED.                 * 14000000
.*                                                                    * 14050000
.*                 FOR ALL FORMS OF THE MACRO:                        * 14100000
.*                   1. INVALID KEYWORD OPERAND.                      * 14150000
.*                   2. DCB AND DDNADDR ARE MUTUALLY EXCLUSIVE.       * 14200000
.*                   3. ID AND IDADDR ARE MUTUALLY EXCLUSIVE.         * 14250000
.*                   4. LNG AND IDLNG ARE MUTUALLY EXCLUSIVE.         * 14300000
.*                   5. FOR LNG OR IDLNG, EITHER ID OR IDADDR IS      * 14350000
.*                      REQUIRED.                                     * 14400000
.*                                                                    * 14450000
.*01* EXTERNAL-REFERENCES = NONE                                      * 14500000
.*                                                                    * 14550000
.*01* TABLES = NONE                                                   * 14600000
.*                                                                    * 14650000
.*01* MACROS = NONE                                                   * 14700000
.*                                                                    * 14750000
.*01* CHANGE ACTIVITY = AS FOLLOWS:                                   * 14800000
.*                                                                    * 14850000
.*$L0=CKPT21,HDP1102,,STLJAK: SUPPORT FOR MVS/XA                      * 14900000
.*$L1=OY18896,HDP3310,,STLLTH: INCORRECT LEVEL OF PARMLIST        @L1A* 14925000
.*$P1=KC11252,HDP3330,,SJLERM: INCORRECT CLASS IN COPYRIGHT MACRO @P1A* 14937500
.*                                                                    * 14950000
.**** END OF SPECIFICATIONS ******************************************* 15000000
         GBLC  &SYSSPLV           1 = 370, 2 = SP2.1 (31 BIT ADDR)      15050000
         LCLA  &A                 COUNT OF OPERANDS USED                15100000
         LCLA  &IHJRC             MACRO RETURN CODE                     15150000
         LCLA  &IHJFLGN           FLAGS TO BE TURNED OFF                15200000
         LCLA  &IHJFLGO           FLAGS TO BE TURNED ON                 15250000
         LCLA  &IHJFLGS           FLAG CALCULATION VARIABLE             15300000
         LCLA  &MFCNT             NUMBER OF MF SUBOPERANDS              15350000
         LCLA  &MFLEN             LENGTH OF MF SUBOPERAND 2 OR 3        15400000
         LCLB  &DCBUSED           DCB OPERAND SPECIFIED                 15450000
         LCLB  &DDNUSED           DDNADDR KEYWORD SPECIFIED             15500000
         LCLB  &IDRGEN            RETURN SYSTEM GENERATED ID            15550000
         LCLB  &IDLUSED           LNG OPERAND OR KEYWORD IDLNG USED     15600000
         LCLB  &IDUSED            ID OPERAND OR KEYWORD IDADDR USED     15650000
         LCLB  &IDREG             REG FORM OF ID                        15700000
         LCLB  &DDNREG            REG FORM OF DDN OR DCB                15750000
         LCLB  &IDLNREG           REG FORM OF CHKID LEN                 15800000
         LCLC  &CKIDADR           VALUE FROM ID OR IDADDR               15850000
         LCLC  &DDNDCBA           VALUE FROM DCB OR DDNADDR             15900000
         LCLC  &IDLEN             VALUE FROM LNG OR IDLNG               15950000
         LCLC  &MFNAM1            NAME OF PARAMETER LIST                16000000
         LCLC  &MFNAMRG           REG FORM OF NAME1                     16025000
         LCLC  &MFNAM2            NAME OF MODEL PARAMETER LIST          16050000
         AIF   (N'&SYSLIST LE 3).POSITOK                                16060000
         MNOTE 4,'IHJA01W TOO MANY POSITIONAL OPERANDS. ONLY THREE WILL*16070000
                BE USED. '                                              16080000
.POSITOK ANOP                                                           16090000
         SPLEVEL TEST                                                   16100000
         AIF   ('&SYSSPLV' GE '2').MVSSP21                              16150000
         AIF   (N'&DDNADDR EQ 0).PM38OK1                                16200000
         MNOTE 4,'IHJA26W KEYWORD DDNADDR IS IGNORED FOR SPLEVEL=1.'    16250000
         AIF   (&IHJRC GE 4).PM38OK1                                    16300000
&IHJRC   SETA  4                                                        16350000
.PM38OK1 ANOP                                                           16400000
         AIF   (N'&IDADDR EQ 0).PM38OK2                                 16450000
         MNOTE 4,'IHJA27W KEYWORD IDADDR IS IGNORED FOR SPLEVEL=1.'     16500000
         AIF   (&IHJRC GE 4).PM38OK2                                    16550000
&IHJRC   SETA  4                                                        16600000
.PM38OK2 ANOP                                                           16650000
         AIF   (N'&IDLNG EQ 0).PM38OK3                                  16700000
         MNOTE 4,'IHJA28W KEYWORD IDLNG IS IGNORED FOR SPLEVEL=1.'      16750000
         AIF   (&IHJRC GE 4).PM38OK3                                    16800000
&IHJRC   SETA  4                                                        16850000
.PM38OK3 ANOP                                                           16900000
&NAME    CHKPT7 &DCB,&ID,&LNG,MF=&MF                                    16950000
         MEXIT                                                          28000000
.MVSSP21 ANOP                                                           28050000
&MFCNT   SETA  N'&MF              GET NUMBER OF MF SUBOPERANDS          28100000
         AIF   (N'&DCB LE 1).PRMOK05 LIMIT TO ONE SUBOPERAND            28150000
         MNOTE 8,'IHJA02E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND D*28200000
               CB.'                                                     28250000
         AIF   (&IHJRC GE 8).PRMOK05 SET RC TO 8 IF NOT GREATER         28300000
&IHJRC   SETA  8                                                        28350000
.PRMOK05 ANOP                                                           28400000
         AIF   (N'&ID LE 1).PRMOK10 LIMIT TO ONE SUBOPERAND             28450000
         MNOTE 8,'IHJA03E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND I*28500000
               D.'                                                      28550000
         AIF   (&IHJRC GE 8).PRMOK10 SET RC TO 8 IF NOT GREATER         28600000
&IHJRC   SETA  8                                                        28650000
.PRMOK10 ANOP                                                           28700000
         AIF   (N'&LNG LE 1).PRMOK15 LIMIT TO ONE SUBOPERAND            28750000
         MNOTE 8,'IHJA04E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND L*28800000
               NG.'                                                     28850000
         AIF   (&IHJRC GE 8).PRMOK15 SET RC TO 8 IF NOT GREATER         28900000
&IHJRC   SETA  8                                                        28950000
.PRMOK15 ANOP                                                           29000000
         AIF   (N'&DDNADDR LE 1).PRMOK20 LIMIT TO ONE SUBOPERAND        29050000
         MNOTE 8,'IHJA05E TOO MANY SUBOPERANDS FOR KEYWORD DDNADDR.'    29100000
         AIF   (&IHJRC GE 8).PRMOK20 SET RC TO 8 IF NOT GREATER         29150000
&IHJRC   SETA  8                                                        29200000
.PRMOK20 ANOP                                                           29250000
         AIF   (N'&IDADDR LE 1).PRMOK25 LIMIT TO ONE SUBOPERAND         29300000
         MNOTE 8,'IHJA06E TOO MANY SUBOPERANDS FOR KEYWORD IDADDR.'     29350000
         AIF   (&IHJRC GE 8).PRMOK25 SET RC TO 8 IF NOT GREATER         29400000
&IHJRC   SETA  8                                                        29450000
.PRMOK25 ANOP                                                           29500000
         AIF   (N'&IDLNG LE 1).PRMOK30 LIMIT TO ONE SUBOPERAND          29550000
         MNOTE 8,'IHJA07E TOO MANY SUBOPERANDS FOR KEYWORD IDLNG.'      29600000
         AIF   (&IHJRC GE 8).PRMOK30 SET RC TO 8 IF NOT GREATER         29650000
&IHJRC   SETA  8                                                        29700000
.PRMOK30 ANOP                                                           29750000
         AIF   ('&MF(1)' EQ 'S' OR '&MF(1)' EQ 'E').PRMOK35             29800000
         AIF   ('&MF(1)' EQ 'L').PRMOK35                                29850000
         MNOTE 12,'IHJA08S MF=&MF IS INVALID.'                          29900000
         AIF   (&IHJRC GE 12).PRMOK45                                   29950000
&IHJRC   SETA  12                                                       30000000
         AGO   .PRMOK45                                                 30050000
.PRMOK35 ANOP                                                           30100000
         AIF   (&MFCNT LT 2).PRMOK40 NOT SPECIFIED                      30150000
         AIF   ('&MF(1)' EQ 'E' AND &MFCNT LE 3).PRMOK40 EXECUTE FORM   30200000
         AIF   (&MFCNT LE 2).PRMOK40 LIST FORM                          30250000
         MNOTE 8,'IHJA09E TOO MANY SUBOPERANDS FOR KEYWORD MF.'         30300000
         AIF   (&IHJRC GE 8).PRMOK45 SET RC TO 8 IF NOT GREATER         30350000
&IHJRC   SETA  8                                                        30400000
&MFCNT   SETA  3                                                        30450000
         AIF   ('&MF(1)' EQ 'E').PRMOK45                                30500000
&MFCNT   SETA  2                                                        30550000
         AGO   .PRMOK45                                                 30600000
.PRMOK40 ANOP                                                           30650000
         AIF   (&MFCNT GE 2).PRMOK45 MORE THAN 1 SUBOPERAND FOR MF      30700000
         AIF   (&MFCNT EQ 1 AND '&MF(1)' EQ 'L').PRMOK45                30750000
         AIF   ('&MF(1)' NE 'E' AND '&MF(1)' NE 'L').PRMOK45            30800000
         MNOTE 8,'IHJA10S TOO FEW SUBOPERANDS FOR KEYWORD MF.'          30850000
         AIF   (&IHJRC GE 12).PRMOK45 SET RC TO 12 IF NOT GREATER       30900000
&IHJRC   SETA  12                                                       30950000
.PRMOK45 ANOP                                                           31000000
         AIF   (N'&DCB EQ 0 OR N'&DDNADDR EQ 0).PRMOK50                 31050000
         MNOTE 8,'IHJA11E POSITIONAL OPERAND DCB AND KEYWORD DDNADDR AR*31100000
               E MUTUALLY EXCLUSIVE. DDNADDR WILL BE USED.'             31150000
         AIF   (&IHJRC GE 8).PRMOK50 SET RC TO 8 IF NOT GREATER         31200000
&IHJRC   SETA  8                                                        31250000
.PRMOK50 ANOP                                                           31300000
         AIF   (N'&ID EQ 0 OR N'&IDADDR EQ 0).PRMOK55                   31350000
         MNOTE 8,'IHJA12E POSITIONAL OPERAND ID AND KEYWORD IDADDR ARE *31400000
               MUTUALLY EXCLUSIVE. IDADDR WILL BE USED.'                31450000
         AIF   (&IHJRC GE 8).PRMOK55 SET RC TO 8 IF NOT GREATER         31500000
&IHJRC   SETA  8                                                        31550000
.PRMOK55 ANOP                                                           31600000
         AIF   (N'&LNG EQ 0 OR N'&IDLNG EQ 0).PRMOK60                   31650000
         MNOTE 8,'IHJA13E POSITIONAL OPERAND LNG AND KEYWORD IDLNG ARE *31700000
               MUTUALLY EXCLUSIVE. IDLNG WILL BE USED.'                 31750000
         AIF   (&IHJRC GE 8).PRMOK60 SET RC TO 8 IF NOT GREATER         31800000
&IHJRC   SETA  8                                                        31850000
.PRMOK60 ANOP                                                           31900000
         AIF   (N'&MF LT 3).PRMOK65                                     31950000
         AIF   ('&MF(2)' NE '&MF(3)').PRMOK65                           32000000
         MNOTE 8,'IHJA14E KEYWORD MF SUBOPERAND 2 IS THE SAME AS SUBOPE*32050000
               RAND 3. SUBOPERAND 3 IS IGNORED.'                        32100000
&MFCNT   SETA  2                                                        32150000
         AIF   (&IHJRC GE 8).PRMOK65 SET RC TO 8 IF NOT GREATER         32200000
&IHJRC   SETA  8                                                        32250000
.PRMOK65 ANOP                                                           32300000
         AIF   ('&DCB' NE 'CANCEL' AND '&DDNADDR' NE 'CANCEL').PRMOK70  32350000
&A       SETA  N'&ID+N'&LNG+N'&DDNADDR+N'&IDADDR+N'&IDLNG               32400000
         AIF   ('&MF' EQ 'S').PRMOK67                                   32450000
&A       SETA  &A+N'&MF                                                 32500000
.PRMOK67 ANOP                                                           32550000
         AIF   (&A LE 1).PRMOK70                                        32600000
         MNOTE 8,'IHJA15E TOO MANY OPERANDS/KEYWORDS WITH A CANCEL REQU*32650000
               EST. ALL OPERANDS/KEYWORDS EXCEPT CANCEL WILL BE IGNORED*32700000
               .'                                                       32750000
         AIF   (&IHJRC GE 8).PRMOK70                                    32800000
&IHJRC   SETA  8                                                        32850000
.PRMOK70 ANOP                                                           32900000
         AIF   (N'&LNG EQ 0 AND N'&IDLNG EQ 0).PRMOK75                  32950000
         AIF   (&MFCNT GT 0 AND '&MF(1)' EQ 'E').PRMOK75                33000000
         AIF   (N'&ID GE 1 OR N'&IDADDR GE 1).PRMOK75                   33050000
         MNOTE 12,'IHJA16S EITHER POSITIONAL OPERAND ID OR KEYWORD IDAD*33100000
               DR IS REQUIRED WITH POSITIONAL OPERAND LNG OR KEYWORD ID*33150000
               LNG.'                                                    33200000
         AIF   (&IHJRC GE 12).PRMOK75                                   33250000
&IHJRC   SETA  12                                                       33300000
.PRMOK75 ANOP                                                           33350000
         AIF   ('&MF(1)' NE 'S').PRMOK80                                33400000
         AIF   (N'&DCB EQ 1 OR N'&DDNADDR EQ 1).PRMOK80                 33450000
         MNOTE 12,'IHJA17S EITHER POSITIONAL OPERAND DCB OR KEYWORD DDN*33500000
               ADDR IS REQUIRED WITH MF=S.'                             33550000
         AIF   (&IHJRC GE 12).PRMOK80                                   33600000
&IHJRC   SETA  12                                                       33650000
.PRMOK80 ANOP                                                           33700000
         AIF   (N'&MF LT 2).PRMOK85                                     33750000
         AIF   ('&MF(1)' EQ 'E').PRMOK82                                33775000
         AIF   (K'&MF(2) LE 7).PRMOK85                                  33800000
         AGO   .PRMCK83                                                 33821400
.PRMOK82 ANOP                                                           33842800
         AIF   (K'&MF(2) LE 8).PRMOK85                                  33864200
.PRMCK83 ANOP                                                           33885600
         MNOTE 8,'IHJA18E SUBOPERAND 2 OF KEYWORD MF IS TOO LONG. IT WI*33907000
               LL BE TRUNCATED.'                                        33928400
         AIF   (&IHJRC GE 8).PRMOK85                                    33950000
&IHJRC   SETA  8                                                        34000000
.PRMOK85 ANOP                                                           34050000
         AIF   (N'&MF LT 3).PRMOK90                                     34100000
         AIF   ('&MF(1)' EQ 'E').PRMOK87                                34150000
         AIF   (K'&MF(3) LE 7).PRMOK90                                  34200000
         AGO   .PRMCK88                                                 34221400
.PRMOK87 ANOP                                                           34242800
         AIF   (K'&MF(3) LE 8).PRMOK90                                  34264200
.PRMCK88 ANOP                                                           34285600
         MNOTE 8,'IHJA19E SUBOPERAND 3 OF KEYWORD MF IS TOO LONG. IT WI*34307000
               LL BE TRUNCATED.'                                        34328400
         AIF   (&IHJRC GE 8).PRMOK90                                    34350000
&IHJRC   SETA  8                                                        34400000
.PRMOK90 ANOP                                                           34450000
         AIF   ('&MF(1)' NE 'L').PRMOK9Z                                34500000
         AIF   (N'&DCB LT 1).PRMOK0P                                    34550000
         AIF   (N'&DCB GT 1).PRMOK0E                                    34600000
         AIF   ('&DCB'(1,1) EQ '(').PRMOK0J                             34650000
         AGO   .PRMOK0P                                                 34700000
.PRMOK0E ANOP                                                           34750000
         AIF   ('&DCB(1)'(1,1) NE '(').PRMOK0P                          34800000
.PRMOK0J ANOP                                                           34850000
         MNOTE 12,'IHJA20S DCB=&DCB IS INVALID FOR MF=L.'               34900000
         AIF   (&IHJRC GE 12).PRMOK0P                                   34950000
&IHJRC   SETA  12                                                       35000000
.PRMOK0P ANOP                                                           35050000
         AIF   (N'&ID LT 1).PRMOK1E                                     35100000
         AIF   (N'&ID GT 1).PRMOK0U                                     35150000
         AIF   ('&ID'(1,1) EQ '(').PRMOK0Z                              35200000
         AGO   .PRMOK1E                                                 35250000
.PRMOK0U ANOP                                                           35300000
         AIF   ('&ID(1)'(1,1) NE '(').PRMOK1E                           35350000
.PRMOK0Z ANOP                                                           35400000
         MNOTE 12,'IHJA21S ID=&ID IS INVALID FOR MF=L.'                 35450000
         AIF   (&IHJRC GE 12).PRMOK1E                                   35500000
&IHJRC   SETA  12                                                       35550000
.PRMOK1E ANOP                                                           35600000
         AIF   (N'&LNG LT 1).PRMOK1U                                    35650000
         AIF   (N'&ID GT 1).PRMOK1J                                     35700000
         AIF   ('&ID'(1,1) EQ '(').PRMOK1P                              35750000
         AGO   .PRMOK1U                                                 35800000
.PRMOK1J ANOP                                                           35850000
         AIF   ('&LNG(1)'(1,1) NE '(').PRMOK1U                          35900000
.PRMOK1P ANOP                                                           35950000
         MNOTE 12,'IHJA22S LNG=&LNG IS INVALID FOR MF=L.'               36000000
         AIF   (&IHJRC GE 12).PRMOK1U                                   36050000
&IHJRC   SETA  12                                                       36100000
.PRMOK1U ANOP                                                           36150000
         AIF   (N'&DDNADDR LT 1).PRMOK2J                                36200000
         AIF   (N'&DDNADDR GT 1).PRMOK1Z                                36250000
         AIF   ('&DDNADDR'(1,1) EQ '(').PRMOK2E                         36300000
         AGO   .PRMOK2J                                                 36350000
.PRMOK1Z ANOP                                                           36400000
         AIF   ('&DDNADDR(1)'(1,1) NE '(').PRMOK2J                      36450000
.PRMOK2E ANOP                                                           36500000
         MNOTE 12,'IHJA23S DDNADDR=&DDNADDR IS INVALID FOR MF=L.'       36550000
         AIF   (&IHJRC GE 12).PRMOK2J                                   36600000
&IHJRC   SETA  12                                                       36650000
.PRMOK2J ANOP                                                           36700000
         AIF   (N'&IDADDR LT 1).PRMOK2Z                                 36750000
         AIF   (N'&IDADDR GT 1).PRMOK2P                                 36800000
         AIF   ('&IDADDR'(1,1) EQ '(').PRMOK2U                          36850000
         AGO   .PRMOK2Z                                                 36900000
.PRMOK2P ANOP                                                           36950000
         AIF   ('&IDADDR(1)'(1,1) NE '(').PRMOK2Z                       37000000
.PRMOK2U ANOP                                                           37050000
         MNOTE 12,'IHJA24S IDADDR=&IDADDR IS INVALID FOR MF=L.'         37100000
         AIF   (&IHJRC GE 12).PRMOK2Z                                   37150000
&IHJRC   SETA  12                                                       37200000
.PRMOK2Z ANOP                                                           37250000
         AIF   (N'&IDLNG LT 1).PRMOK9Z                                  37300000
         AIF   (N'&IDLNG GT 1).PRMOK3E                                  37350000
         AIF   ('&IDLNG'(1,1) EQ '(').PRMOK3J                           37400000
         AGO   .PRMOK9Z                                                 37450000
.PRMOK3E ANOP                                                           37500000
         AIF   ('&IDLNG(1)'(1,1) NE '(').PRMOK9Z                        37550000
.PRMOK3J ANOP                                                           37600000
         MNOTE 12,'IHJA25S IDLNG=&IDLNG IS INVALID FOR MF=L.'           37650000
         AIF   (&IHJRC GE 12).PRMOK9Z                                   37700000
&IHJRC   SETA  12                                                       37750000
.PRMOK9Z ANOP                                                           37800000
         AIF   (&IHJRC LT 12).PRMOK95                                   37850000
         MEXIT                                                          38400000
.PRMOK95 ANOP                                                           38450000
.*     SET ASSEMBLER VARIABLES                                          38500000
         AIF   (N'&DDNADDR LT 1).SETV08                                 38550000
&DDNUSED SETB  1                                                        38600000
         AIF   (N'&DDNADDR GT 1).SETV04                                 38650000
&DDNDCBA SETC  '&DDNADDR'                                               38700000
         AGO   .SETV17                                                  38750000
.SETV04  ANOP                                                           38800000
&DDNDCBA SETC  '&DDNADDR(1)'                                            38850000
         AGO   .SETV17                                                  38900000
.SETV08  ANOP                                                           38950000
         AIF   (N'&DCB LT 1).SETV17                                     39000000
&DCBUSED SETB  1                                                        39050000
         AIF   (N'&DCB GT 1).SETV13                                     39100000
&DDNDCBA SETC  '&DCB'                                                   39150000
         AGO   .SETV17                                                  39200000
.SETV13  ANOP                                                           39250000
&DDNDCBA SETC  '&DCB(1)'                                                39300000
.SETV17  ANOP                                                           39350000
         AIF   (&DDNUSED).SETV21                                        39400000
         AIF   (NOT &DCBUSED).SETV26                                    39450000
.SETV21  ANOP                                                           39500000
         AIF   ('&DDNDCBA'(1,1) NE '(').SETV26                          39550000
&DDNREG  SETB  1                                                        39600000
&DDNDCBA SETC  '&DDNDCBA'(2,K'&DDNDCBA-2)                               39650000
.SETV26  ANOP                                                           39700000
         AIF   (N'&IDADDR LT 1).SETV34                                  39750000
&IDUSED  SETB  1                                                        39800000
         AIF   (N'&IDADDR GT 1).SETV30                                  39850000
&CKIDADR SETC  '&IDADDR'                                                39900000
         AGO   .SETV43                                                  39950000
.SETV30  ANOP                                                           40000000
&CKIDADR SETC  '&IDADDR(1)'                                             40050000
         AGO   .SETV43                                                  40100000
.SETV34  ANOP                                                           40150000
         AIF   (N'&ID LT 1).SETV43                                      40200000
&IDUSED  SETB  1                                                        40250000
         AIF   (N'&ID GT 1).SETV39                                      40300000
&CKIDADR SETC  '&ID'                                                    40350000
         AGO   .SETV43                                                  40400000
.SETV39  ANOP                                                           40450000
&CKIDADR SETC  '&ID(1)'                                                 40500000
.SETV43  ANOP                                                           40550000
         AIF   (NOT &IDUSED).SETV47                                     40600000
         AIF   ('&CKIDADR'(1,1) NE '(').SETV47                          40650000
&IDREG   SETB  1                                                        40700000
&CKIDADR SETC  '&CKIDADR'(2,K'&CKIDADR-2)                               40750000
.SETV47  ANOP                                                           40800000
         AIF   (N'&IDLNG LT 1).SETV56                                   40850000
&IDLUSED SETB  1                                                        40900000
         AIF   (N'&IDLNG GT 1).SETV52                                   40950000
         AIF   ('&IDLNG' EQ '''S''').SETV63                             41000000
&IDLEN   SETC  '&IDLNG'                                                 41050000
         AGO   .SETV65                                                  41100000
.SETV52  ANOP                                                           41150000
         AIF   ('&IDLNG(1)' EQ '''S''').SETV63                          41200000
&IDLEN   SETC  '&IDLNG(1)'                                              41250000
         AGO   .SETV65                                                  41300000
.SETV56  ANOP                                                           41350000
         AIF   (N'&LNG LT 1).SETV65                                     41400000
&IDLUSED SETB  1                                                        41450000
         AIF   (N'&LNG GT 1).SETV60                                     41500000
         AIF   ('&LNG' EQ '''S''').SETV63                               41550000
&IDLEN   SETC  '&LNG'                                                   41600000
         AGO   .SETV65                                                  41650000
.SETV60  ANOP                                                           41700000
         AIF   ('&LNG(1)' EQ '''S''').SETV63                            41750000
&IDLEN   SETC  '&LNG(1)'                                                41800000
         AGO   .SETV65                                                  41850000
.SETV63  ANOP                                                           41900000
&IDRGEN  SETB  1                                                        41950000
&IDLEN   SETC  '8'                                                      42000000
.SETV65  ANOP                                                           42050000
         AIF   (NOT &IDLUSED).SETV69                                    42100000
         AIF   ('&IDLEN'(1,1) NE '(').SETV69                            42150000
&IDLNREG SETB  1                                                        42200000
&IDLEN   SETC  '&IDLEN'(2,K'&IDLEN-2)                                   42250000
.SETV69  ANOP                                                           42300000
         AIF   (NOT &IDUSED).SETV70                                     42308300
         AIF   (&IDLUSED).SETV70                                        42316600
&IDLUSED SETB  1                                                        42324900
&IDLEN   SETC  '8'                                                      42333200
.SETV70  ANOP                                                           42341500
         AIF   (&MFCNT GE 2).SETV73                                     42350000
         AIF   (&MFCNT EQ 1 AND '&MF(1)' EQ 'L' AND '&NAME' NE '').SETV*42400000
               71                                                       42450000
&MFNAM1  SETC  'IHJP&SYSNDX'                                            42500000
         AGO   .SETV86                                                  42550000
.SETV71  ANOP                                                           42600000
&MFNAM1  SETC  '&NAME'                                                  42650000
         AGO   .SETV86                                                  42700000
.SETV73  ANOP                                                           42750000
&MFLEN   SETA  K'&MF(2)                                                 42800000
         AIF   (&MFLEN LE 7).SETV78                                     42850000
&MFLEN   SETA  8                                                        42862500
         AIF   ('&MF(1)' EQ 'E').SETV78                                 42875000
         AIF   ('&MF(1)' EQ 'L').SETV78                                 42887500
&MFLEN   SETA  7                                                        42900000
.SETV78  ANOP                                                           42950000
&MFNAM1  SETC  '&MF(2)'(1,&MFLEN)                                       43000000
         AIF   ('&MFNAM1'(1,1) NE '(').SETV80                           43012500
&MFNAM1  SETC  '&MFNAM1'(2,K'&MFNAM1-2)                                 43025000
.SETV80  ANOP                                                           43037500
         AIF   (&MFCNT LT 3).SETV86                                     43050000
&MFLEN   SETA  K'&MF(3)                                                 43100000
         AIF   (&MFLEN LE 7).SETV82                                     43150000
&MFLEN   SETA  8                                                        43162500
         AIF   ('&MF(1)' EQ 'E').SETV82                                 43175000
         AIF   ('&MF(1)' EQ 'L').SETV82                                 43187500
&MFLEN   SETA  7                                                        43200000
.SETV82  ANOP                                                           43250000
&MFNAM2  SETC  '&MF(3)'(1,&MFLEN)                                       43300000
         AIF   ('&MFNAM2'(1,1) NE '(').SETV91                           43316600
&MFNAM2  SETC  '&MFNAM2'(2,K'&MFNAM2-2)                                 43333200
         AGO   .SETV91                                                  43350000
.SETV86  ANOP                                                           43400000
&MFNAM2  SETC  '&MFNAM1'                                                43450000
.SETV91  ANOP                                                           43500000
&IHJFLGS SETA  &DDNUSED*2+&IDRGEN*4+1                                   43550000
         AIF   (&IDUSED).SETV93                                         43600000
&IHJFLGS SETA  &IHJFLGS+128                                             43650000
.SETV93  ANOP                                                           43700000
         AIF   ('&DDNDCBA' EQ 'CANCEL').GENCD25                         43750000
         AIF   ('&MF(1)' EQ 'L').GENCD09                                43800000
.*   GENERATE PART OF THE EXECUTABLE CODE                               43850000
         AIF   (N'&NAME LT 1).GENCD04                                   43900000
&NAME    DS    0H                                                       43950000
.GENCD04 ANOP                                                           44000000
         AIF   ('&MF(1)' EQ 'E').GENCD13                                44050000
         CNOP  0,4                ALIGN TO FULL WD BDY FOR PARM LIST    44075000
         BAL   1,IHJE&SYSNDX                                            44100000
.GENCD09 ANOP                                                           44150000
.*   GENERATE THE LIST.                                                 44200000
&MFNAM2  DS    0F                 PUT LIST ON FULL WORD BOUNDRY         44250000
         DC    AL1(&IHJFLGS)      FLAG BYTE                             44300000
         AIF   ('&MF(1)' EQ 'S').GENLS05                                44350000
         AIF   (&IDLUSED).GENLS20                                       44400000
.GENLS05 ANOP                                                           44450000
         DC    AL1(0)             ID LENGTH                             44500000
         AGO   .GENLS30                                                 44550000
.GENLS20 ANOP                                                           44600000
         DC    AL1(&IDLEN)        LENGTH OF CHECKPOINT ID               44650000
.GENLS30 ANOP                                                           44700000
         DC    AL1(12)            LENGTH OF CHECKPOINT PARAMETER LIST   44750000
         DC    AL1(0)             RESERVED                              44800000
         AIF   ('&MF(1)' EQ 'S').GENLS40                                44850000
         AIF   (&DCBUSED OR &DDNUSED).GENLS50                           44900000
.GENLS40 ANOP                                                           44950000
         DC    A(0)               ADDRESS OF DD NAME OR DCB             45000000
         AGO   .GENLS60                                                 45050000
.GENLS50 ANOP                                                           45100000
         DC    A(&DDNDCBA)        ADDRESS OF DD NAME OR DCB             45150000
.GENLS60 ANOP                                                           45200000
         AIF   ('&MF(1)' EQ 'S').GENLS70                                45250000
         AIF   (&IDUSED).GENLS80                                        45300000
.GENLS70 ANOP                                                           45350000
         DC    A(0)               ADDRESS OF CHECKPOINT ID NOT GIVEN    45400000
         AGO   .GENLS90                                                 45450000
.GENLS80 ANOP                                                           45500000
         DC    A(&CKIDADR)        ADDRESS OF CHECKPOINT ID              45550000
.GENLS90 ANOP                                                           45600000
         AIF   ('&MF(1)' NE 'L').GENCD13                                45650000
         MEXIT                                                          48800000
.GENCD13 ANOP                                                           48850000
         AIF   ('&MF(1)' NE 'S').GENCD15                                48900000
IHJE&SYSNDX DS 0H                                                       48950000
         AGO   .GENCD25                                                 49000000
.GENCD15 ANOP                                                           49050000
         AIF   (&MFCNT LT 3).GENCD18                                    49100000
         AIF   ('&MF(2)'(1,1) NE '(').GENCD17                           49103800
         AIF   ('&MF(3)'(1,1) NE '(').GENCD16                           49107600
         MVC   0(12,&MFNAM1.),0(&MFNAM2.)                               49111400
         AGO   .GENCD18                                                 49115200
.GENCD16 ANOP                                                           49119000
         MVC   0(12,&MFNAM1),&MFNAM2                                    49122800
         AGO   .GENCD18                                                 49126600
.GENCD17 ANOP                                                           49130400
         AIF   ('&MF(3)'(1,1) NE '(').GENCD19                           49134200
         MVC   &MFNAM1.(12),0(&MFNAM2.)                                 49138000
         AGO   .GENCD20                                                 49141800
.GENCD19 ANOP                                                           49145600
         MVC   &MFNAM1.(12),&MFNAM2                                     49150000
         AGO   .GENCD20                                                 49175000
.GENCD18 ANOP                                                           49200000
         AIF   ('&MF(2)'(1,1) NE '(').GENCD20                           49208300
         AIF   ('&MF(2)' EQ '(1)').GENCD25                              49216600
         LR    1,&MFNAM1                                                49224900
         AGO   .GENCD25                                                 49233200
.GENCD20 ANOP                                                           49241500
         LA    1,&MFNAM1                                                49250000
.*    GENERATE THE REST OF THE EXECUTABLE CODE.                         49300000
.GENCD25 ANOP                                                           49350000
         AIF   ('&DDNDCBA' NE 'CANCEL').GENCD27                         49400000
         AIF   (N'&NAME LT 1).GENCD26                                   49412500
&NAME    DS    0H                                                       49425000
.GENCD26 ANOP                                                           49437500
         SR    1,1                ZERO REG1 FOR CANCEL REQUEST          49450000
         AGO   .GENCD94                                                 49500000
.GENCD27 ANOP                                                           49550000
         AIF   ('&MF(1)' EQ 'S').GENCD63                                49600000
         AIF   (&DCBUSED).GENCD36                                       49650000
         AIF   (&DDNUSED).GENCD40                                       49700000
         AGO   .GENCD45                                                 49750000
.GENCD36 ANOP                                                           49800000
&IHJFLGN SETA  &IHJFLGN+2         TURN OFF DDN FLAG                     49850000
         AGO   .GENCD45                                                 49900000
.GENCD40 ANOP                                                           49950000
&IHJFLGO SETA  &IHJFLGO+2         TURN ON DDN FLAG                      50000000
.GENCD45 ANOP                                                           50050000
         AIF   (NOT &IDUSED).GENCD47                                    50100000
&IHJFLGN SETA  &IHJFLGN+128                                             50150000
.GENCD47 ANOP                                                           50200000
         AIF   (NOT &IDLUSED).GENCD54                                   50250000
         AIF   (&IDRGEN).GENCD49                                        50300000
&IHJFLGN SETA  &IHJFLGN+4                                               50350000
         AGO   .GENCD54                                                 50400000
.GENCD49 ANOP                                                           50450000
&IHJFLGO SETA  &IHJFLGO+4                                               50500000
.GENCD54 ANOP                                                           50550000
         AIF   (&IHJFLGN LT 1).GENCD58                                  50600000
         NI    0(1),255-&IHJFLGN  TURN OFF FLAGS                        50650000
.GENCD58 ANOP                                                           50700000
         AIF   (&IHJFLGO LT 1).GENCD63                                  50750000
         OI    0(1),&IHJFLGO      TURN ON FLAGS                         50800000
.GENCD63 ANOP                                                           50850000
         AIF   (NOT &IDLUSED).GENCD72                                   50900000
         AIF   (&IDLNREG).GENCD67                                       50950000
         MVI   1(1),&IDLEN        STORE LENGTH OF CHECKPOINT ID         51000000
         AGO   .GENCD72                                                 51050000
.GENCD67 ANOP                                                           51100000
         STC   &IDLEN,1(,1)                                             51150000
.GENCD72 ANOP                                                           51200000
         AIF   (&DCBUSED).GENCD76                                       51250000
         AIF   (NOT &DDNUSED).GENCD85                                   51300000
.GENCD76 ANOP                                                           51350000
         AIF   (&DDNREG).GENCD81                                        51400000
         LA    15,&DDNDCBA        GET ADDRESS OF DD NAME OR DCB         51450000
         ST    15,4(,1)           STORE ADDRESS OF DD NAME OR DCB       51500000
         AGO   .GENCD85                                                 51550000
.GENCD81 ANOP                                                           51600000
         ST    &DDNDCBA,4(,1) STORE ADDRESS OF DD NAME OR DCB           51650000
.GENCD85 ANOP                                                           51700000
         AIF   (NOT &IDUSED).GENCD94                                    51750000
         AIF   (&IDREG).GENCD90                                         51800000
         LA    15,&CKIDADR        GET ADDRESS OF CHECKPOINT ID          51850000
         ST    15,8(,1)           STORE ADDRESS OF CHECKPOINT ID        51900000
         AGO   .GENCD94                                                 51950000
.GENCD90 ANOP                                                           52000000
         ST    &CKIDADR,8(,1) STORE ADDR OF CHKPT ID                    52050000
.GENCD94 ANOP                                                           52100000
         SVC   63                 INVOKE CHECKPOINT                     52150000
         MEND                                        */                 52200000
* %CHKPTC1: ;                                                           52250000
* %CHKPT: MACRO KEYS(DDNADDR,  /* CONTAINS THE ADDR OF THE DD NAME */   52300000
*                   IDADDR,  /* CONTAINS THE ADDR OF THE CHKPT ID */    52350000
*                   IDLNG, /* SPECIFIES THE LENGTH OF THE CHKPT ID */   52400000
*                   MF)                                                 52450000
*                        ; /* SPECIFIES THE MACRO FORM */               52500000
*                   /* ALSO, POSITIONAL OPERANDS:                       52550000
*                   DCB,    CONTAINS THE ADDRESS OF THE DCB             52600000
*                   ID,     CONTAINS THE ADDRESS OF THE CHKPT ID        52650000
*                   LNG,    SPECIFIES THE LENGTH OF THE CHKPT ID */     52700000
* /* */                                                                 52750000
* /*   DEFINE EXTERNAL MACRO VARIABLES   */                             52800000
* /* */                                                                 52850000
* DCL                                                                   52900000
*   EHAREGS CHAR EXTERNAL,   /* REGISTERS TO BE DECLARED BY EPILOG */   52950000
*   EHARC   FIXED EXTERNAL;  /* RETURN CODE FROM MACRO */               53000000
* /* */                                                                 53050000
* /*   DEFINE AND INITIALIZE INTERNAL MACRO VARIABLES  */               53100000
* /* */                                                                 53150000
* DCL                                                                   53200000
*   (DCBUSED,    /* DCB OPERAND USED */                                 53250000
*   DDNUSED,     /* DDNADDR KEYWORD USED */                             53300000
*   DDNREG,      /* ADDRESS FORM OF KEYWORD USED */                     53350000
*   IDUSED,      /* ID OPERAND OR IDADDR KEYWORD USED */                53400000
*   IDREG,       /* ADDRESS FORM OF KEYWORD USED */                     53450000
*   IDLNUSED)    /* LNG OPERAND OR IDLNG KEYWORD USED */                53500000
*   FIXED;                                                              53550000
* DCL                                                                   53600000
*   MFCNT FIXED, /* NO OF SUB-OPERANDS FOR MF KEYWORD */                53650000
*   MFNAM1 CHAR, /* LOCATION OF LIST 1 */                               53700000
*   MFNAM2 CHAR, /* LOCATION OF LIST 2 */                               53750000
*   MFLEN FIXED; /* WORK VARIABLE */                                    53800000
* DCL IHJFLAG FIXED;  /* CALCULATED FLAG BITS FOR FLAG FIELD IN LIST */ 53850000
* DCL                                                                   53900000
*   IHJRC FIXED,  /* RETURN CODE FROM MACRO */                          53950000
*   CKIDADDR CHAR,  /* CONTAINS ADDRESS OF CHECKPOINT ID */             54000000
*   IDLENGTH CHAR,  /* CONTAINS CHECKPOINT ID LENGTH */                 54050000
*   DDNDCBAD CHAR;  /* CONTAINS LOCATION OF DCB OR DD NAME */           54100000
* IHJRC = 0;                                                            54150000
* DCBUSED = 0;                                                          54200000
* DDNUSED = 0;                                                          54250000
* IDUSED = 0;                                                           54300000
* IDLNUSED = 0;                                                         54350000
* MFCNT = 0;                                                            54400000
* MFNAM1 = '';                                                          54450000
* MFNAM2 = '';                                                          54500000
* CKIDADDR = '';                                                        54550000
* DDNDCBAD = '';                                                        54600000
* IDLENGTH = '';                                                        54650000
* ANS('/* ?CHKPT '||MACLIST||' '||MACKEYS||' */') COL(3)                54700000
*     SKIP(2) NORESCAN;                                                 54750000
*       /* CHECK INPUT PARAMETERS FOR ERRORS */                         54800000
* IF NUMBER(MACLIST) > 3 THEN  /* HOW MANY POSITIONAL OPERANDS */       54850000
*   DO;                                                                 54900000
*     ANS MSG('IHJC01E TOO MANY POSITIONAL OPERANDS.');                 54950000
*     ANS(COMMENT('IHJC01E TOO MANY POSITIONAL OPERANDS.'))             55000000
*         SKIP NORESCAN COL(MACCOL);                                    55050000
*     IF IHJRC < 8 THEN                                                 55100000
*       IHJRC = 8;                                                      55150000
*     ELSE;                                                             55200000
*   END;                                                                55250000
* ELSE;                                                                 55300000
* IF NUMBER(MACLIST(1)) > 1 THEN  /* HOW MANY SUBOPERANDS */            55350000
*   DO;                                                                 55400000
*     ANS MSG('IHJC02E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND '||  55450000
*             'DCB.');                                                  55500000
*     ANS(COMMENT(                                                      55550000
*         'IHJC02E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND DCB. ')) 55600000
*         SKIP NORESCAN COL(MACCOL);                                    55650000
*     IF IHJRC < 8 THEN                                                 55700000
*       IHJRC = 8;                                                      55750000
*     ELSE;                                                             55800000
*   END;                                                                55850000
* ELSE;                                                                 55900000
* IF NUMBER(MACLIST(2)) > 1 THEN  /* HOW MANY SUBOPERANDS */            55950000
*   DO;                                                                 56000000
*     ANS MSG('IHJC03E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND '||  56050000
*             'ID.');                                                   56100000
*     ANS(COMMENT(                                                      56150000
*         'IHJC03E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND ID. '))  56200000
*         SKIP NORESCAN COL(MACCOL);                                    56250000
*     IF IHJRC < 8 THEN                                                 56300000
*       IHJRC = 8;                                                      56350000
*     ELSE;                                                             56400000
*   END;                                                                56450000
* ELSE;                                                                 56500000
* IF NUMBER(MACLIST(3)) > 1 THEN  /* HOW MANY SUBOPERANDS */            56550000
*   DO;                                                                 56600000
*     ANS MSG('IHJC04E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND '||  56650000
*             'LNG.');                                                  56700000
*     ANS(COMMENT(                                                      56750000
*         'IHJC04E TOO MANY SUBOPERANDS FOR POSITIONAL OPERAND LNG. ')) 56800000
*         SKIP NORESCAN COL(MACCOL);                                    56850000
*     IF IHJRC < 8 THEN                                                 56900000
*       IHJRC = 8;                                                      56950000
*     ELSE;                                                             57000000
*   END;                                                                57050000
* ELSE;                                                                 57100000
* IF NUMBER(DDNADDR) > 1 THEN  /* HOW MANY SUBOPERANDS */               57150000
*   DO;                                                                 57200000
*     ANS MSG('IHJC05E TOO MANY SUBOPERANDS FOR KEYWORD DDNADDR.');     57250000
*     ANS(COMMENT('IHJC05E TOO MANY SUBOPERANDS FOR KEYWORD DDNADDR.')) 57300000
*         SKIP NORESCAN COL(MACCOL);                                    57350000
*     IF IHJRC < 8 THEN                                                 57400000
*       IHJRC = 8;                                                      57450000
*     ELSE;                                                             57500000
*   END;                                                                57550000
* ELSE;                                                                 57600000
* IF NUMBER(IDADDR) > 1 THEN  /* HOW MANY SUBOPERANDS */                57650000
*   DO;                                                                 57700000
*     ANS MSG('IHJC06E TOO MANY SUBOPERANDS FOR KEYWORD IDADDR.');      57750000
*     ANS(COMMENT('IHJC06E TOO MANY SUBOPERANDS FOR KEYWORD IDADDR.'))  57800000
*         SKIP NORESCAN COL(MACCOL);                                    57850000
*     IF IHJRC < 8 THEN                                                 57900000
*       IHJRC = 8;                                                      57950000
*     ELSE;                                                             58000000
*   END;                                                                58050000
* ELSE;                                                                 58100000
* IF NUMBER(IDLNG) > 1 THEN  /* HOW MANY SUBOPERANDS */                 58150000
*   DO;                                                                 58200000
*     ANS MSG('IHJC07E TOO MANY SUBOPERANDS FOR KEYWORD IDLNG.');       58250000
*     ANS(COMMENT('IHJC07E TOO MANY SUBOPERANDS FOR KEYWORD IDLNG.'))   58300000
*         SKIP NORESCAN COL(MACCOL);                                    58350000
*     IF IHJRC < 8 THEN                                                 58400000
*       IHJRC = 8;                                                      58450000
*     ELSE;                                                             58500000
*   END;                                                                58550000
* ELSE;                                                                 58600000
* IF NUMBER(MF) > 0 & MF(1) ^= 'S' & MF(1) ^= 'E' & MF(1) ^= 'L' THEN   58650000
*   DO;                                                                 58700000
*     ANS MSG('IHJC08S MF='||MF||' IS INVALID.');                       58750000
*     ANS('/* IHJC08S MF='||MF||' IS INVALID. */')                      58800000
*         SKIP NORESCAN COL(MACCOL);                                    58850000
*     IF IHJRC < 12 THEN                                                58900000
*       IHJRC = 12;                                                     58950000
*     ELSE;                                                             59000000
*   END;                                                                59050000
* ELSE;                                                                 59100000
* IF NUMBER(MF) > 0 &    /* MF SPECIFIED */                             59150000
*     (MF(1) = 'S' & NUMBER(MF) > 3 |                                   59200000
*     MF(1) = 'L' & NUMBER(MF) > 3 |                                    59250000
*     MF(1) = 'E' & NUMBER(MF) > 3) THEN                                59300000
*   DO;                                                                 59350000
*     ANS MSG('IHJC09E TOO MANY SUBOPERANDS FOR KEYWORD MF.');          59400000
*     ANS(COMMENT('IHJC09E TOO MANY SUBOPERANDS FOR KEYWORD MF.'))      59450000
*         SKIP NORESCAN COL(MACCOL);                                    59500000
*     IF IHJRC < 8 THEN                                                 59550000
*       IHJRC = 8;                                                      59600000
*     ELSE;                                                             59650000
*   END;                                                                59700000
* ELSE;                                                                 59750000
* IF NUMBER(MF) < 2 &  /* MF SPECIFIED */                               59800000
*     (MF(1) = 'E' |                                                    59850000
*     MF(1) = 'L') THEN                                                 59900000
*   DO;                                                                 59950000
*     ANS MSG('IHJC10S TOO FEW SUBOPERANDS FOR KEYWORD MF.');           60000000
*     ANS(COMMENT('IHJC10S TOO FEW SUBOPERANDS FOR KEYWORD MF.'))       60050000
*         SKIP NORESCAN COL(MACCOL);                                    60100000
*     IF IHJRC < 12 THEN                                                60150000
*       IHJRC = 12;                                                     60200000
*     ELSE;                                                             60250000
*   END;                                                                60300000
* ELSE;                                                                 60350000
* IF NUMBER(MACLIST(1)) > 0 & NUMBER(DDNADDR) > 0 THEN                  60400000
*   DO;                                                                 60450000
*     ANS MSG('IHJC11E POSITIONAL OPERAND DCB AND KEYWORD DDNADDR '||   60500000
*             'ARE MUTUALLY EXCLUSIVE. DDNADDR WILL BE USED.');         60550000
*     ANS('/* IHJC11E POSITIONAL OPERAND DCB AND KEYWORD DDNADDR ')     60600000
*         SKIP NORESCAN COL(MACCOL);                                    60650000
*     ANS('ARE MUTUALLY EXCLUSIVE. DDNADDR WILL BE USED. */') NORESCAN; 60700000
*     IF IHJRC < 8 THEN                                                 60750000
*       IHJRC = 8;                                                      60800000
*     ELSE;                                                             60850000
*   END;                                                                60900000
* ELSE;                                                                 60950000
* IF NUMBER(MACLIST(2)) > 0 & NUMBER(IDADDR) > 0 THEN                   61000000
*   DO;                                                                 61050000
*     ANS MSG('IHJC12E POSITIONAL OPERAND ID AND KEYWORD IDADDR '||     61100000
*             'ARE MUTUALLY EXCLUSIVE. IDADDR WILL BE USED.');          61150000
*     ANS('/* IHJC12E POSITIONAL OPERAND ID AND KEYWORD IDADDR ')       61200000
*         SKIP NORESCAN COL(MACCOL);                                    61250000
*     ANS('ARE MUTUALLY EXCLUSIVE. IDADDR WILL BE USED. */') NORESCAN;  61300000
*     IF IHJRC < 8 THEN                                                 61350000
*       IHJRC = 8;                                                      61400000
*     ELSE;                                                             61450000
*   END;                                                                61500000
* ELSE;                                                                 61550000
* IF NUMBER(MACLIST(3)) > 0 & NUMBER(IDLNG) > 0 THEN                    61600000
*   DO;                                                                 61650000
*     ANS MSG('IHJC13E POSITIONAL OPERAND LNG AND KEYWORD IDLNG '||     61700000
*             'ARE MUTUALLY EXCLUSIVE. IDLNG WILL BE USED.');           61750000
*     ANS('/* IHJC13E POSITIONAL OPERAND LNG AND KEYWORD IDLNG ')       61800000
*         SKIP NORESCAN COL(MACCOL);                                    61850000
*     ANS('ARE MUTUALLY EXCLUSIVE. IDLNG WILL BE USED. */') NORESCAN;   61900000
*     IF IHJRC < 8 THEN                                                 61950000
*       IHJRC = 8;                                                      62000000
*     ELSE;                                                             62050000
*   END;                                                                62100000
* ELSE;                                                                 62150000
* MFCNT = NUMBER(MF);                                                   62200000
* IF MFCNT > 2 & MF(2) = MF(3) THEN                                     62250000
*   DO;                                                                 62300000
*     ANS MSG('IHJC14E KEYWORD MF SUBOPERAND 2 IS THE SAME AS '||       62350000
*             'SUBOPERAND 3. SUBOPERAND 3 IS IGNORED.');                62400000
*     ANS('/* IHJC14E KEYWORD MF SUBOPERAND 2 IS THE SAME AS ')         62450000
*         SKIP NORESCAN COL(MACCOL);                                    62500000
*     ANS('SUBOPERAND 3. SUBOPERAND 3 IS IGNORED. */') NORESCAN;        62550000
*     IF IHJRC < 8 THEN                                                 62600000
*       IHJRC = 8;                                                      62650000
*     ELSE;                                                             62700000
*     MFCNT = 2;                                                        62750000
*   END;                                                                62800000
* ELSE;                                                                 62850000
* MFLEN = NUMBER(DDNADDR) + NUMBER(IDADDR) + NUMBER(IDLNG);             62900000
* IF MF(1) ^= S THEN                                                    62950000
*   MFLEN = MFLEN + 1;                                                  63000000
* ELSE;                                                                 63050000
* IF (MACLIST(1) = 'CANCEL' | DDNADDR(1) = 'CANCEL') &                  63100000
*     MFLEN > 1 THEN                                                    63150000
*   DO;                                                                 63200000
*     ANS MSG('IHJC15E TOO MANY OPERANDS/KEYWORDS WITH A CANCEL '||     63250000
*             'REQUEST. ALL OPERANDS/KEYWORDS EXCEPT CANCEL WILL BE '|| 63300000
*             'IGNORED.');                                              63350000
*     ANS('/* IHJC15E TOO MANY OPERANDS/KEYWORDS WITH A CANCEL ')       63400000
*         SKIP NORESCAN COL(MACCOL);                                    63450000
*     ANS('REQUEST. ALL OPERANDS/KEYWORDS EXCEPT CANCEL WILL BE ')      63500000
*         NORESCAN;                                                     63550000
*     ANS('IGNORED. */') NORESCAN;                                      63600000
*     IF IHJRC < 8 THEN                                                 63650000
*       IHJRC = 8;                                                      63700000
*     ELSE;                                                             63750000
*     MFCNT = 0;                                                        63800000
*   END;                                                                63850000
* ELSE;                                                                 63900000
* IF (NUMBER(MACLIST(3)) = 1 | NUMBER(IDLNG) = 1) & /* LNG SPECIFIED */ 63950000
*     (NUMBER(MACLIST(2)) = 0 & NUMBER(IDADDR) = 0) THEN /* NO ID */    64000000
*   DO;                                                                 64050000
*     ANS MSG('IHJC16S EITHER POSITIONAL OPERAND ID OR KEYWORD '||      64100000
*             'IDADDR IS REQUIRED WITH POSITIONAL OPERAND LNG OR '||    64150000
*             'KEYWORD IDLNG.');                                        64200000
*     ANS('/* IHJC16S EITHER POSITIONAL OPERAND ID OR KEYWORD ')        64250000
*         SKIP NORESCAN COL(MACCOL);                                    64300000
*     ANS('IDADDR IS REQUIRED WITH POSITIONAL OPERAND LNG OR ')         64350000
*         NORESCAN;                                                     64400000
*     ANS('KEYWORD IDLNG. */') NORESCAN;                                64450000
*     IF IHJRC < 12 THEN                                                64500000
*       IHJRC = 12;                                                     64550000
*     ELSE;                                                             64600000
*   END;                                                                64650000
* ELSE;                                                                 64700000
* IF MF(1) = 'S' & NUMBER(DDNADDR) = 0 & NUMBER(MACLIST(1)) = 0 THEN    64750000
*   DO;                                                                 64800000
*     ANS MSG('IHJC17S EITHER POSITIONAL OPERAND DCB OR KEYWORD '||     64850000
*             'DDNADDR IS REQUIRED WITH MF('||MF(1)||')');              64900000
*     ANS('/* IHJC17S EITHER POSITIONAL OPERAND DCB OR KEYWORD ')       64950000
*         SKIP NORESCAN COL(MACCOL);                                    65000000
*     ANS('DDNADDR IS REQUIRED WITH MF('||MF(1)||') */') NORESCAN;      65050000
*     IF IHJRC < 12 THEN                                                65100000
*       IHJRC = 12;                                                     65150000
*     ELSE;                                                             65200000
*   END;                                                                65250000
* ELSE;                                                                 65300000
* IF NUMBER(MF) > 1 & LENGTH(MF(2)) > 7 THEN                            65350000
*   DO;                                                                 65400000
*     ANS MSG('IHJC18E SUBOPERAND 2 OF KEYWORD MF IS LONGER THAN '||    65450000
*             '7 CHARACTERS. ONLY 7 CHARACTERS WILL BE USED.');         65500000
*     ANS('/* IHJC18E SUBOPERAND 2 OF KEYWORD MF IS LONGER THAN ')      65550000
*         SKIP NORESCAN COL(MACCOL);                                    65600000
*     ANS('7 CHARACTERS. ONLY 7 CHARACTERS WILL BE USED. */') NORESCAN; 65650000
*     IF IHJRC < 8 THEN                                                 65700000
*       IHJRC = 8;                                                      65750000
*     ELSE;                                                             65800000
*   END;                                                                65850000
* ELSE;                                                                 65900000
* IF (MF(1) = 'S' | MF(1) = 'E') & NUMBER(MF) > 2 &                     65950000
*     LENGTH(MF(3)) > 7 THEN                                            66000000
*   DO;                                                                 66050000
*     ANS MSG('IHJC19E SUBOPERAND 3 OF KEYWORD MF IS LONGER THAN '||    66100000
*             '7 CHARACTERS. ONLY 7 CHARACTERS WILL BE USED.');         66150000
*     ANS('/* IHJC19E SUBOPERAND 3 OF KEYWORD MF IS LONGER THAN ')      66200000
*         SKIP NORESCAN COL(MACCOL);                                    66250000
*     ANS('7 CHARACTERS. ONLY 7 CHARACTERS WILL BE USED. */') NORESCAN; 66300000
*     IF IHJRC < 8 THEN                                                 66350000
*       IHJRC = 8;                                                      66400000
*     ELSE;                                                             66450000
*   END;                                                                66500000
* ELSE;                                                                 66550000
* IF NUMBER(DDNADDR) > 0 THEN                                           66600000
*   DO;                                                                 66650000
*     DDNUSED = 1;                                                      66700000
*     IF DDNADDR(1,1:1) = '(' THEN                                      66750000
*       DO;                                                             66800000
*         DDNREG = 1;                                                   66850000
*         DDNDCBAD = DDNADDR(1,1);                                      66900000
*       END;                                                            66950000
*     ELSE                                                              67000000
*       DDNDCBAD = DDNADDR(1);                                          67050000
*   END;                                                                67100000
* ELSE                                                                  67150000
*   IF NUMBER(MACLIST(1)) > 0 THEN                                      67200000
*     DO;                                                               67250000
*       DCBUSED = 1;                                                    67300000
*       IF MACLIST(1,1:1) = '(' THEN                                    67350000
*         DO;                                                           67400000
*           DDNREG = 1;                                                 67450000
*           DDNDCBAD = MACLIST(1,1);                                    67500000
*         END;                                                          67550000
*       ELSE                                                            67600000
*         DDNDCBAD = MACLIST(1);                                        67650000
*     END;                                                              67700000
*   ELSE;                                                               67750000
* IF NUMBER(IDADDR) > 0 THEN                                            67800000
*   DO;                                                                 67850000
*     IDUSED = 1;                                                       67900000
*     IF IDADDR(1,1:1) = '(' THEN                                       67950000
*       DO;                                                             68000000
*         IDREG = 1;                                                    68050000
*         CKIDADDR = IDADDR(1,1);                                       68100000
*       END;                                                            68150000
*     ELSE                                                              68200000
*       CKIDADDR = IDADDR(1);                                           68250000
*   END;                                                                68300000
* ELSE                                                                  68350000
*   IF NUMBER(MACLIST(2)) > 0 THEN                                      68400000
*     DO;                                                               68450000
*       IDUSED = 1;                                                     68500000
*       IF MACLIST(2,1:1) = '(' THEN                                    68550000
*         DO;                                                           68600000
*           IDREG = 1;                                                  68650000
*           CKIDADDR = MACLIST(2,1);                                    68700000
*         END;                                                          68750000
*       ELSE                                                            68800000
*         CKIDADDR = MACLIST(2);                                        68850000
*     END;                                                              68900000
*   ELSE;                                                               68950000
* IF MF(1) = 'L' & (IDREG = 1 | DDNREG = 1) THEN                        69000000
*   DO;                                                                 69050000
*     ANS MSG('IHJC20S THE ADDRESS FORM OF KEYWORDS DDNADDR OR '||      69100000
*             'IDADDR OR POSITIONAL PARAMETERS DCB OR ID CANNOT BE '||  69150000
*             'USED WITH MF('||MF||') ');                               69200000
*     ANS('/* IHJC20E THE ADDRESS FORM OF KEYWORDS DDNADDR OR IDADDR ') 69250000
*         SKIP NORESCAN COL(MACCOL);                                    69300000
*     ANS('OR POSITIONAL PARAMETERS DCB OR ID CANNOT BE USED WITH MF(') 69350000
*         NORESCAN;                                                     69400000
*     ANS(MF)                                                           69450000
*         NORESCAN;                                                     69500000
*     ANS(') */')                                                       69550000
*         NORESCAN;                                                     69600000
*     IF IHJRC < 12 THEN                                                69650000
*       IHJRC = 12;                                                     69700000
*     ELSE;                                                             69750000
*   END;                                                                69800000
* ELSE;                                                                 69850000
* IF IHJRC > 8 THEN                                                     69900000
*   RETURN CODE(IHJRC);                                                 69950000
* ELSE;                                                                 70000000
* IF NUMBER(IDLNG) > 0 THEN                                             70050000
*   DO;                                                                 70100000
*     IDLNUSED = 1;                                                     70150000
*     IDLENGTH = IDLNG(1);                                              70200000
*   END;                                                                70250000
* ELSE                                                                  70300000
*   IF NUMBER(MACLIST(3)) > 0 THEN                                      70350000
*     DO;                                                               70400000
*       IDLNUSED = 1;                                                   70450000
*       IDLENGTH = MACLIST(3);                                          70500000
*     END;                                                              70550000
*   ELSE                                                                70600000
*     IF IDUSED = 1 THEN                                                70650000
*       IDLENGTH = 'LENGTH('||CKIDADDR||')';                            70700000
*     ELSE                                                              70750000
*       IDLENGTH = '0';                                                 70800000
* IF NUMBER(MF) < 2 THEN                                                70850000
*   MFNAM1 = 'IHJP'||MACINDEX(2:4);                                     70900000
* ELSE                                                                  70950000
*   DO;                                                                 71000000
*     IF LENGTH(MF(2)) > 7 THEN                                         71050000
*       MFLEN = 7;                                                      71100000
*     ELSE                                                              71150000
*       MFLEN = LENGTH(MF(2));                                          71200000
*     MFNAM1 = MF(2,1:MFLEN);                                           71250000
*   END;                                                                71300000
* IF NUMBER(MF) = 3 THEN                                                71350000
*   DO;                                                                 71400000
*     IF LENGTH(MF(3)) > 7 THEN                                         71450000
*       MFLEN = 7;                                                      71500000
*     ELSE                                                              71550000
*       MFLEN = LENGTH(MF(3));                                          71600000
*     MFNAM2 = MF(3,1:MFLEN);                                           71650000
*   END;                                                                71700000
* ELSE                                                                  71750000
*   MFNAM2 = MFNAM1;                                                    71800000
* IHJFLAG = DDNUSED * 2 + 1;                                            71850000
* IF IDLENGTH = 'S' THEN                                                71900000
*   DO;                                                                 71950000
*     IHJFLAG = IHJFLAG + 4;                                            72000000
*     IDLENGTH = '8';                                                   72050000
*   END;                                                                72100000
* ELSE;                                                                 72150000
* IF IDUSED < 1 THEN                                                    72200000
*   IHJFLAG = IHJFLAG + 128;                                            72250000
* ELSE;                                                                 72300000
* IF DDNDCBAD ^= 'CANCEL' &                                             72350000
*     (MFCNT = 0 | MF(1) = 'S' | MF(1) = 'L') THEN                      72400000
*   DO;                                                                 72450000
*         /* GENERATE DECLARE FOR STATIC LOCAL */                       72500000
*     ANS(COMMENT(' DECLARE PARAMETER LIST IN STATIC LOCAL ')) SKIP(2)  72550000
*         NORESCAN COL(MACCOL+10);                                      72600000
*     ANS ('DCL') COL(MACCOL) NORESCAN SKIP;                            72650000
*     ANS ('1 '||MFNAM2||' BDY(WORD) STATIC LOCAL, ') COL(MACCOL + 2)   72700000
*         NORESCAN SKIP;                                                72750000
*     ANS(COMMENT(' CHECKPOINT PARAMETER LIST ')) NORESCAN;             72800000
*     ANS('2 '||MFNAM2||'A BIT(8) ') COL(MACCOL + 4) SKIP NORESCAN;     72850000
*     ANS('INIT('||CHAR(IHJFLAG)||'), ') NORESCAN;                      72900000
*     ANS(COMMENT(' FLAG BYTE ')) NORESCAN;                             72950000
*     ANS('3 '||MFNAM2||'B BIT(1), '||COMMENT(' ID FIELD SUPPLIED '))   73000000
*         COL(MACCOL + 6) SKIP NORESCAN;                                73050000
*     ANS('3 * BIT(4), '||COMMENT(' RESERVED ')) COL(MACCOL + 6) SKIP   73100000
*         NORESCAN;                                                     73150000
*     ANS('3 '||MFNAM2||'C BIT(1), '||COMMENT(' CHECKID SOURCE BIT '))  73200000
*         COL(MACCOL + 6) SKIP NORESCAN;                                73250000
*     ANS('3 '||MFNAM2||'D BIT(1), '||COMMENT(' DD ADDRESS GIVEN '))    73300000
*         COL(MACCOL + 6) SKIP NORESCAN;                                73350000
*     ANS('3 * BIT(1), '||COMMENT(' NEW FORMAT BIT '))                  73400000
*         COL(MACCOL + 6) SKIP NORESCAN;                                73450000
*     ANS('2 '||MFNAM2||'E FIXED(8) ') COL(MACCOL + 4) SKIP NORESCAN;   73500000
*     IF MF(1) = 'L' THEN                                               73550000
*       ANS('INIT('||IDLENGTH||'), ') NORESCAN;                         73600000
*     ELSE                                                              73650000
*       ANS('INIT(0), ') NORESCAN;                                      73700000
*     ANS(COMMENT(' ID LENGTH ')) NORESCAN;                             73750000
*     ANS('2 '||MFNAM2||'F FIXED(8) INIT(12), ')                        73800000
*          COL(MACCOL + 4) NORESCAN SKIP;                               73850000
*     ANS(COMMENT(' LENGTH OF CHECKPOINT PARAMETER LIST ')) NORESCAN;   73900000
*     ANS('2 * FIXED(8) INIT(0), '||COMMENT(' RESERVED '))              73950000
*         COL(MACCOL + 4) SKIP NORESCAN;                                74000000
*     ANS('2 '||MFNAM2||'G PTR(31) ') COL(MACCOL + 4) SKIP NORESCAN;    74050000
*     IF MF(1) = 'L' THEN                                               74100000
*       IF DDNUSED = 1 & DDNREG = 1 THEN                                74150000
*         ANS('INIT('||DDNDCBAD||'), ') NORESCAN;                       74200000
*       ELSE                                                            74250000
*         IF DDNUSED = 1 THEN                                           74300000
*           ANS('INIT(ADDR('||DDNDCBAD||')), ') NORESCAN;               74350000
*         ELSE                                                          74400000
*           ANS('INIT(0), ') NORESCAN;                                  74450000
*     ELSE                                                              74500000
*       ANS('INIT(0), ') NORESCAN;                                      74550000
*     ANS(COMMENT(' ADDRESS OF DCB OR DD NAME ')) NORESCAN;             74600000
*     ANS('2 '||MFNAM2||'H PTR(31) ') COL(MACCOL + 4) SKIP NORESCAN;    74650000
*     IF MF(1) = 'L' THEN                                               74700000
*       IF IDUSED = 1 & IDREG = 1 THEN                                  74750000
*         ANS('INIT('||CKIDADDR||'); ') NORESCAN;                       74800000
*       ELSE                                                            74850000
*         IF IDUSED = 1 THEN                                            74900000
*           ANS('INIT(ADDR('||CKIDADDR||')); ') NORESCAN;               74950000
*         ELSE                                                          75000000
*           ANS('INIT(0); ') NORESCAN;                                  75050000
*     ELSE                                                              75100000
*       ANS('INIT(0); ') NORESCAN;                                      75150000
*     ANS(COMMENT(' ADDRESS OF CHECKPOINT ID ')) NORESCAN;              75200000
*     ANS(COMMENT(' END OF CHECKPOINT PARAMETER LIST ')) NORESCAN       75250000
*         COL(3) SKIP;                                                  75300000
*   END;                                                                75350000
* ELSE;                                                                 75400000
* IF MFCNT = 3 & DDNDCBAD ^= 'CANCEL' &                                 75450000
*     (MF(1) = 'L' | MF(1) = 'S') THEN                                  75500000
*   DO;                                                                 75550000
*         /* GENERATE DECLARE FOR AUTODATA */                           75600000
*     ANS(COMMENT(' DECLARE PARMLIST IN AUTODATA ')) NORESCAN SKIP(2)   75650000
*          COL(MACCOL+10);                                              75700000
*     ANS('DCL') COL(MACCOL) NORESCAN SKIP;                             75750000
*     ANS('1 '||MFNAM1||' BDY(WORD), ') COL(MACCOL + 2) NORESCAN SKIP;  75800000
*     ANS(COMMENT(' CHECKPOINT PARAMETER LIST ')) NORESCAN;             75850000
*     ANS('2 '||MFNAM1||'A BIT(8), ') COL(MACCOL + 4) SKIP NORESCAN;    75900000
*     ANS(COMMENT(' FLAG BYTE ')) NORESCAN;                             75950000
*     ANS('3 '||MFNAM1||'B BIT(1), '||COMMENT(' ID FIELD SUPPLIED '))   76000000
*         COL(MACCOL + 6) SKIP NORESCAN;                                76050000
*     ANS('3 * BIT(4), '||COMMENT(' RESERVED ')) COL(MACCOL + 6) SKIP   76100000
*         NORESCAN;                                                     76150000
*     ANS('3 '||MFNAM1||'C BIT(1), '||COMMENT(' CHECKID SOURCE BIT '))  76200000
*         COL(MACCOL + 6) SKIP NORESCAN;                                76250000
*     ANS('3 '||MFNAM1||'D BIT(1), '||COMMENT(' DD ADDRESS GIVEN '))    76300000
*         COL(MACCOL + 6) SKIP NORESCAN;                                76350000
*     ANS('3 * BIT(1), '||COMMENT(' NEW FORMAT BIT '))                  76400000
*         COL(MACCOL + 6) SKIP NORESCAN;                                76450000
*     ANS('2 '||MFNAM1||'E FIXED(8), ') COL(MACCOL + 4) NORESCAN SKIP;  76500000
*     ANS(COMMENT(' ID LENGTH ')) NORESCAN;                             76550000
*     ANS('2 '||MFNAM1||'F FIXED(8), ') COL(MACCOL + 4) NORESCAN SKIP;  76600000
*     ANS(COMMENT(' CHECKPOINT PARAMETER LENGTH ')) NORESCAN;           76650000
*     ANS('2 * FIXED(8), ') COL(MACCOL + 4) SKIP NORESCAN;              76700000
*     ANS(COMMENT(' RESERVED ')) NORESCAN;                              76750000
*     ANS('2 '||MFNAM1||'G PTR(31), ') COL(MACCOL + 4) NORESCAN SKIP;   76800000
*     ANS(COMMENT(' ADDRESS OF DD NAME OR DCB ')) NORESCAN;             76850000
*     ANS('2 '||MFNAM1||'H PTR(31); ') COL(MACCOL + 4) NORESCAN SKIP;   76900000
*     ANS(COMMENT(' ADDRESS OF CHECKPOINT ID. ')) NORESCAN;             76950000
*     ANS(COMMENT(' END OF CHECKPOINT PARAMETER LIST ')) NORESCAN       77000000
*         COL(3) SKIP;                                                  77050000
*   END;                                                                77100000
* ELSE;                                                                 77150000
* IF MFCNT = 0 | MF(1) = 'S' | MF(1) = 'E' THEN                         77200000
*   DO;                                                                 77250000
*         /* GENERATE EXECUTE CODE */                                   77300000
*     ANS('DO;') SKIP NORESCAN COL(MACCOL);                             77350000
*     IF MFCNT = 3 THEN                                                 77400000
*       DO;                                                             77450000
*         ANS(MFNAM1||' = '||MFNAM2||'; ') COL(MACCOL + 2) RESCAN SKIP; 77500000
*         ANS(COMMENT(' MOVE MODEL TO WORK AREA ')) NORESCAN;           77550000
*       END;                                                            77600000
*     ELSE;                                                             77650000
*     IF DDNDCBAD ^= 'CANCEL' THEN                                      77700000
*       DO;                                                             77750000
*         IF MF(1) ^= 'S' THEN                                          77800000
*           DO;                                                         77850000
*             IF DCBUSED = 1 THEN                                       77900000
*               DO;                                                     77950000
*                 ANS(MFNAM1||'D = '||QUOTE('0')||'B; ')                78000000
*                     COL(MACCOL + 2) SKIP NORESCAN;                    78050000
*                 ANS(COMMENT(' DCB ADDRESS GIVEN ')) NORESCAN;         78100000
*               END;                                                    78150000
*             ELSE;                                                     78200000
*             IF IDUSED = 1 THEN                                        78250000
*               DO;                                                     78300000
*                 ANS(MFNAM1||'B = '||QUOTE('0')||'B; ')                78350000
*                     COL(MACCOL + 2) SKIP NORESCAN;                    78400000
*                 ANS(COMMENT(' CHECKPOINT ID FIELD GIVEN ')) NORESCAN; 78450000
*                 IF IDLNG(1) = 'S' THEN                                78500000
*                   DO;                                                 78550000
*                     ANS(MFNAM1||'C = '||QUOTE('1')||'B; ')            78600000
*                         COL(MACCOL + 2) SKIP NORESCAN;                78650000
*                     ANS(COMMENT(' RETURN CHECKPOINT ID' )) NORESCAN;  78700000
*                   END;                                                78750000
*                 ELSE                                                  78800000
*                   DO;                                                 78850000
*                     ANS(MFNAM1||'C = '||QUOTE('0')||'B; ')            78900000
*                         COL(MACCOL + 2) SKIP NORESCAN;                78950000
*                     ANS(COMMENT(' USE USER CHECKPOINT ID '))          79000000
*                         NORESCAN;                                     79050000
*                   END;                                                79100000
*               END;                                                    79150000
*             ELSE;                                                     79200000
*             IF DDNUSED = 1 THEN                                       79250000
*               DO;                                                     79300000
*                 ANS(MFNAM1||'D = '||QUOTE('1')||'B; ')                79350000
*                     COL(MACCOL + 2) SKIP NORESCAN;                    79400000
*                 ANS(COMMENT(' DD NAME ADDRESS GIVEN ')) NORESCAN;     79450000
*               END;                                                    79500000
*             ELSE;                                                     79550000
*           END;                                                        79600000
*         ELSE;                                                         79650000
*         IF IDUSED = 1 THEN                                            79700000
*           IF IDLNUSED = 1 THEN                                        79750000
*             DO;                                                       79800000
*               ANS(MFNAM1||'E = '||IDLENGTH||'; ') SKIP NORESCAN       79850000
*                   COL(MACCOL + 2);                                    79900000
*               ANS(COMMENT(' CHECKPOINT ID LENGTH' )) NORESCAN;        79950000
*             END;                                                      80000000
*           ELSE                                                        80050000
*             IF IDREG = 0 THEN                                         80100000
*               DO;                                                     80150000
*                 ANS(MFNAM1||'E = LENGTH('||CKIDADDR||'); ')           80200000
*                     SKIP NORESCAN COL(MACCOL + 2);                    80250000
*                 ANS(COMMENT(' CHECKPOINT ID LENGTH' )) NORESCAN;      80300000
*               END;                                                    80350000
*             ELSE                                                      80400000
*               DO;                                                     80450000
*                 ANS(MFNAM1||'E = 8; ') SKIP NORESCAN COL(MACCOL + 2); 80500000
*                 ANS(COMMENT(' DEFAULT CHKPT ID LENGTH ')) NORESCAN;   80550000
*               END;                                                    80600000
*         ELSE;                                                         80650000
*         IF DCBUSED = 1 | DDNUSED = 1 THEN                             80700000
*           DO;                                                         80750000
*             IF DDNREG = 1 THEN                                        80800000
*               ANS(MFNAM1||'G = '||DDNDCBAD||'; ') SKIP NORESCAN       80850000
*                   COL(MACCOL + 2);                                    80900000
*             ELSE                                                      80950000
*               ANS(MFNAM1||'G = ADDR('||DDNDCBAD||'); ') SKIP NORESCAN 81000000
*                   COL(MACCOL + 2);                                    81050000
*             ANS(COMMENT(' DD NAME OR DCB ADDRESS ')) NORESCAN;        81100000
*           END;                                                        81150000
*         ELSE;                                                         81200000
*         IF IDUSED = 1 THEN                                            81250000
*           DO;                                                         81300000
*             IF IDREG = 1 THEN                                         81350000
*               ANS(MFNAM1||'H = '||CKIDADDR||'; ') SKIP NORESCAN       81400000
*                   COL(MACCOL + 2);                                    81450000
*             ELSE                                                      81500000
*               ANS(MFNAM1||'H = ADDR('||CKIDADDR||'); ') SKIP NORESCAN 81550000
*                   COL(MACCOL + 2);                                    81600000
*             ANS(COMMENT(' CHECKPOINT ID ADDRESS ')) NORESCAN;         81650000
*           END;                                                        81700000
*         ELSE;                                                         81750000
*       END;                                                            81800000
*     ELSE;                                                             81850000
*     IF INDEX(EHAREGS,'01P') = 0 THEN                                  81900000
*       EHAREGS = EHAREGS||'01P';                                       81950000
*     ELSE;                                                             82000000
*     ANS('RFY GPR01P RSTD; '||COMMENT(' RESTRICT REG 1' )) NORESCAN    82050000
*         SKIP COL(MACCOL + 2);                                         82100000
*     IF DDNDCBAD = 'CANCEL' THEN                                       82150000
*       DO;                                                             82200000
*         ANS('GPR01P = 0; ') SKIP NORESCAN COL(MACCOL + 2);            82250000
*         ANS(COMMENT(' PUT 0 IN REG 1 FOR CANCEL REQUEST ')) NORESCAN; 82300000
*       END;                                                            82350000
*     ELSE                                                              82400000
*       DO;                                                             82450000
*         ANS('GPR01P = ADDR('||MFNAM1||'); ') SKIP NORESCAN            82500000
*             COL(MACCOL + 2);                                          82550000
*         ANS(COMMENT(' ADDRESS CHECKPOINT PARAMETER LIST ')) NORESCAN; 82600000
*       END;                                                            82650000
*     ANS('SVC(63); '||COMMENT(' ISSUE CHECKPOINT SVC ')) NORESCAN SKIP 82700000
*         COL(MACCOL + 2);                                              82750000
*     ANS('RFY GPR01P UNRSTD; '||COMMENT(' RELEASE REG 1 ')) NORESCAN   82800000
*         COL(MACCOL + 2) SKIP;                                         82850000
*     ANS('END;') NORESCAN COL(MACCOL) SKIP;                            82900000
*   END;                                                                82950000
* ELSE;                                                                 83000000
* RETURN CODE(IHJRC);                                                   83050000
* %END CHKPT;                                                           83100000
