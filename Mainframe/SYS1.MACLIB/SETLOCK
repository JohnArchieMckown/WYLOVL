*/***PROPRIETARY_STATEMENT********************************************/ 00004200
*/*                                                                  */ 00006300
*/*                                                                  */ 00008400
*/* LICENSED MATERIALS - PROPERTY OF IBM                             */ 00010500
*/* THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      */ 00012600
*/* 5645-001 (C) COPYRIGHT IBM CORP. 1980, 1997                      */ 00014700
*/*                                                                  */ 00016800
*/* STATUS= HBB6603                                                  */ 00018900
*/*                                                                  */ 00021000
*/***END_OF_PROPRIETARY_STATEMENT*************************************/ 00023100
*%/*                                                                    00050000
         MACRO                                                          00100000
&NAME    SETLOCK &REQUEST,&TYPE=,&ADDR=,&MODE=,&DISABLE,&RELATED=,     X00150000
               &REGS=,&BRANCH=,&ASCB=,&LOCKHLD=,&SCOPE=,&LOCK=,        X00183300
               &WORKREG=                                           @L8C 00216600
.**************************************************************         00250000
.*01*  MACRO NAME = SETLOCK                                             00275000
.*                                                                      01126100
.*01*  External Classification:                                         01126300
.*02*  NONE: BASE                                                       01126500
.*02*  GUPI: For OBTAIN and RELEASE, TYPE=CPU,                          01126700
.*                                   TYPE=CMS,                          01126900
.*                                   TYPE=LOCAL,                        01127100
.*                                   TYPE=CML,ASCB                      01127300
.*                                      MODE                            01127500
.*                                      REGS                            01127700
.*                                      RELATED                         01127900
.*           For TEST, TYPE=CPU,                                        01128100
.*                     TYPE=CMS,                                        01128300
.*                     TYPE=LOCAL,                                      01128500
.*                     TYPE=ALOCAL                                      01128700
.*                     TYPE=CML,ASCB                                    01128900
.*                        LOCKHLD                                       01129100
.*                        BRANCH                                        01129300
.*                        RELATED                                       01129500
.*01*  End of External Classification:                                  01129700
.*                                                                      01131600
.*01*  FUNCTION = GENERATE THE LINKAGE TO SPIN AND SUSPEND              01132800
.*                LOCK MANAGER                                          01134000
.*                                                                      01135200
.*01*  COMPONENT = SC1C5 (SUPERVISOR CONTROL)                           01136400
.*                                                                      01137600
.*01*  MACLIB = AMACLIB                                                 01138800
.*                                                                      01140000
.*02*   NOTES =                                                         01140600
.*        AR-MODE INVOKERS:                                        @L3A 01141200
.*          SYSSTATE IS USED TO TEST FOR AN AR-MODE INVOKER.            01141800
.*          FOR INSTRUCTIONS SUCH AS LM WITH NO INDEX REGISTER, THE     01142400
.*            AR OF THE BASE REGISTER IS SET BEFOREHAND.                01143000
.*          PRIMARY MODE IS ENTERED BEFORE THE CALL, AND AR-MODE        01143600
.*            IS REENTERED AFTER THE CALL.                              01144200
.*          R14 HOLDS THE PSALITA RATHER THAN R13 TO CONFORM TO THE     01144800
.*            PL/AS SUPPORT.                                            01145400
.*          FOR REGS=SAVE, THE STM IS DONE OFF R13 SINCE AR13 MUST HAVE 01146000
.*            BEEN ESTABLISHED BY AN AR-MODE INVOKER.                   01146600
.*          FOR REGS=SAVE, UPON RETURN, SINCE AR13 IS NEEDED TO DO THE  01147200
.*            LM, BUT THE ADDRESS IS IN R15 WITH THE RETURN CODE IN     01147800
.*            R13, THE TWO REGS ARE SWAPPED BEFORE DOING THE LM.        01148400
.*            THIS SAVES A STORAGE REFERENCE.                           01149000
.*          FOR LM OF ONLY 2 REGS, RATHER THAN SETTING THE AR, 2 LOADS  01149600
.*            ARE DONE SPECIFYING INDEX RATHER THAN BASE REG.           01150200
.*        WHEN REGS=STDSAVE IS SPECIFIED, ONLY GENERAL REGISTERS 2-12   01150300
.*          ARE PRESERVED.  GENERAL REGISTERS 14,15,0, AND 1 ARE NOT    01150400
.*          RESTORED BECAUSE ACCESS REGISTERS 14,15,0, AND 1 MAY NOT    01150500
.*          BE COUNTED ON ACROSS THE MACRO CALL.                        01150600
.*                                                                      01150700
.*01*  DEPENDENCIES =                                                   01150800
.*        Modules using SETLOCK must include the IHAPSA mapping         01150900
.*        prior to invocation.                                          01151000
.*                                                                      01151100
.*01*  SYNTAX  =                                                        01151200
.*                                                                      01151300
.* LABEL: SETLOCK                                                       01151400
.*                                                                      01151500
.*        OBTAIN                                                        01151600
.*                                                                      01151700
.*          ,TYPE=ASM        ,ADDR=LOCKWORD ADDRESS                     01151800
.*                                 (11)                                 01151900
.*                                                                      01152000
.*                ASMGL      ,ADDR=LOCKWORD ADDRESS                     01152100
.*                                 (11)                                 01152200
.*                                                                      01152300
.*                BMFLSD     ,ADDR=LOCKWORD ADDRESS                     01152400
.*                                 (11)                                 01152500
.*                                                                      01152600
.*                CML        ,ASCB=ASCB ADDRESS                         01152700
.*                                 (11)                   {2}           01152800
.*                                                                      01152900
.*                CMS                                     {2}           01153000
.*                                                                      01153100
.*                CMSALL                                  {2,4}         01153200
.*                                                                      01153300
.*                CMSEQDQ                                 {2}           01153400
.*                                                                      01153500
.*                CMSSMF                                  {2}           01153600
.*                                                                      01153700
.*                CPU                                     {1}           01153800
.*                                                                      01153900
.*                DISP                                                  01154000
.*                                                                      01154100
.*                ETRSET                                                01154200
.*                                                                      01154300
.*                IOS        ,SCOPE=SHR                                 01154400
.*                                  EXCL                                01154500
.*                                                                      01154600
.*           ***  IOSCAT        NO LONGER SUPPORTED                     01154700
.*                                                                      01154800
.*           ***  IOSLCH        NO LONGER SUPPORTED                     01154900
.*                                                                      01155000
.*                IOSUCB     ,ADDR=LOCKWORD ADDRESS                     01155100
.*                                 (11)                                 01155200
.*                                                                      01155300
.*                IOSULUT    ,SCOPE=SHR                                 01155400
.*                                  EXCL                                01155500
.*                                                                      01155600
.*                IOSYNCH    ,ADDR=LOCKWORD ADDRESS                     01155700
.*                                 (11)                                 01155800
.*                                                                      01155900
.*                IXLDS      ,ADDR=LOCKWORD ADDRESS                     01156000
.*                                 (11)                                 01156100
.*                                                                      01156200
.*                IXLREQST   ,ADDR=LOCKWORD ADDRESS                     01156300
.*                                 (11)                                 01156400
.*                                                                      01156500
.*                IXLSCH     ,ADDR=LOCKWORD ADDRESS                     01156600
.*                                 (11)                                 01156700
.*                                                                      01156800
.*                IXLSHELL   ,ADDR=LOCKWORD ADDRESS                     01156900
.*                                 (11)                                 01157000
.*                                                                      01157100
.*                IXLSHR     ,SCOPE=SHR                                 01157200
.*                                  EXCL                                01157300
.*                                                                      01157400
.*                LOCAL                                   {2}           01157500
.*                                                                      01157600
.*                RSM        ,SCOPE=SHR                                 01157700
.*                                  EXCL                                01157800
.*                                                                      01157900
.*                RSMAD      ,ADDR=LOCKWORD ADDRESS                     01158000
.*                                 (11)                                 01158100
.*                                                                      01158200
.*                RSMCM      ,ADDR=LOCKWORD ADDRESS                     01158300
.*                                 (11)                                 01158400
.*                                                                      01158500
.*                RSMDS      ,ADDR=LOCKWORD ADDRESS                     01158600
.*                                 (11)                                 01158700
.*                                                                      01158800
.*                RSMGL      ,ADDR=LOCKWORD ADDRESS                     01158900
.*                                 (11)                                 01159000
.*                                                                      01159100
.*                RSMST      ,ADDR=LOCKWORD ADDRESS                     01159200
.*                                 (11)                                 01159300
.*                                                                      01159400
.*                RSMXM      ,ADDR=LOCKWORD ADDRESS                     01159500
.*                                 (11)                                 01159600
.*                                                                      01159700
.*                SALLOC                                                01159800
.*                                                                      01159900
.*                SRM                                                   01160000
.*                                                                      01160100
.*                TPACBDEB   ,ADDR=LOCKWORD ADDRESS                     01160200
.*                                 (11)                                 01160300
.*                                                                      01160400
.*           ***  TPDNCB        NO LONGER SUPPORTED                     01160500
.*                                                                      01160600
.*           ***  TPNCB         NO LONGER SUPPORTED                     01160700
.*                                                                      01160800
.*                TRACE      ,SCOPE=SHR                                 01160900
.*                                  EXCL                                01161000
.*                                                                      01161100
.*                VSMFIX                                                01161200
.*                                                                      01161300
.*                VSMPAG                                                01161400
.*                                                                      01161500
.*                XCFDS      ,ADDR=LOCKWORD ADDRESS                     01161600
.*                                 (11)                                 01161700
.*                                                                      01161800
.*                XCFQ       ,SCOPE=SHR                                 01161900
.*                                  EXCL                                01162000
.*                                                                      01162100
.*                XCFRES     ,ADDR=LOCKWORD ADDRESS                     01162200
.*                                 (11)                                 01162300
.*                                                                      01162400
.*                WLMRES     ,ADDR=LOCKWORD ADDRESS                     01162500
.*                                 (11)                                 01162600
.*                                                                      01162700
.*                WLMQ       ,SCOPE=SHR                                 01162800
.*                                  EXCL                                01162900
.*                                                                      01163000
.*                CONTEXT    ,ADDR=LOCKWORD ADDRESS                     01163100
.*                                 (11)                                 01163200
.*                                                                      01163300
.*                REGSRV     ,SCOPE=SHR                                 01163400
.*                                  EXCL                                01163500
.*                                                                      01163600
.*                                                                      01163700
.*          ,MODE=COND                                    {4}           01163800
.*                (COND,IN)                               {3}           01163900
.*                UNCOND   < ,DISABLED >                  {1,2}         01164000
.*                                                                      01164100
.*        < ,REGS=SAVE                                                  01164200
.*                USE                                                   01164300
.*                STDSAVE  >                                            01164400
.*                                                                      01164500
.*        < ,RELATED=VALUE  >                                           01164600
.*                                                                      01164700
.*   NOTES: SETLOCK OBTAIN ONLY                                         01164800
.*                                                                      01164900
.*     {1}  THE MODE PARAMETER IS IGNORED IF TYPE=CPU IS                01165000
.*          SPECIFIED.                                                  01165100
.*                                                                      01165200
.*     {2}  THE DISABLED PARAMETER MAY NOT BE SPECIFIED WITH            01165300
.*          TYPE=CMS, TYPE=CMSEQDQ, TYPE=CMSSMF,                        01165400
.*          TYPE=CMSALL, TYPE=LOCAL, TYPE=CML OR                        01165500
.*          MODE=COND.                                                  01165600
.*                                                                      01165700
.*     {3}  THE MODE=(COND,IN) PARAMETER IS ONLY VALID WITH             01165800
.*          TYPE=CML.                                                   01165900
.*                                                                      01166000
.*     {4}  A MODE=COND MAY NOT BE SPECIFIED WITH TYPE=CMSALL.          01166100
.*                                                                      01166200
.*--------------------------------------------------------------------- 01166300
.*                                                                      01166400
.*        RELEASE                                                       01166500
.*                                                                      01166600
.*          ,TYPE=ALL                                                   01166700
.*                                                                      01166800
.*                ASM        ,ADDR=LOCKWORD ADDRESS                     01166900
.*                                 (11)                                 01167000
.*                                                                      01167100
.*                ASMGL      ,ADDR=LOCKWORD ADDRESS                     01167200
.*                                 (11)                                 01167300
.*                                                                      01167400
.*                BMFLSD     ,ADDR=LOCKWORD ADDRESS                     01167500
.*                                 (11)                                 01167600
.*                                                                      01167700
.*                CML        ,ASCB=ASCB ADDRESS                         01167800
.*                                 (11)                                 01167900
.*                                                                      01168000
.*                CMS                                                   01168100
.*                                                                      01168200
.*                CMSALL                                                01168300
.*                                                                      01168400
.*                CMSEQDQ                                               01168500
.*                                                                      01168600
.*                CMSSMF                                                01168700
.*                                                                      01168800
.*                CPU                                                   01168900
.*                                                                      01169000
.*                DISP                                                  01169100
.*                                                                      01169200
.*                ETRSET                                                01169300
.*                                                                      01169400
.*                IOS        ,SCOPE=SHR                                 01169500
.*                                  EXCL                                01169600
.*                                                                      01169700
.*           ***  IOSCAT        NO LONGER SUPPORTED                     01169800
.*                                                                      01169900
.*           ***  IOSLCH        NO LONGER SUPPORTED                     01170000
.*                                                                      01170100
.*                IOSUCB     ,ADDR=LOCKWORD ADDRESS                     01170200
.*                                 (11)                                 01170300
.*                                                                      01170400
.*                IOSULUT    ,SCOPE=SHR                                 01170500
.*                                  EXCL                                01170600
.*                                                                      01170700
.*                IOSYNCH    ,ADDR=LOCKWORD ADDRESS                     01170800
.*                                 (11)                                 01170900
.*                                                                      01171000
.*                IXLDS      ,ADDR=LOCKWORD ADDRESS                     01171100
.*                                 (11)                                 01171200
.*                                                                      01171300
.*                IXLREQST   ,ADDR=LOCKWORD ADDRESS                     01171400
.*                                 (11)                                 01171500
.*                                                                      01171600
.*                IXLSCH     ,ADDR=LOCKWORD ADDRESS                     01171700
.*                                 (11)                                 01171800
.*                                                                      01171900
.*                IXLSHELL   ,ADDR=LOCKWORD ADDRESS                     01172000
.*                                 (11)                                 01172100
.*                                                                      01172200
.*                IXLSHR     ,SCOPE=SHR                                 01172300
.*                                  EXCL                                01172400
.*                                                                      01172500
.*                LOCAL                                                 01172600
.*                                                                      01172700
.*                (REG)                                                 01172800
.*                                                                      01172900
.*                RSM        ,SCOPE=SHR                                 01173000
.*                                  EXCL                                01173100
.*                                                                      01173200
.*                RSMAD      ,ADDR=LOCKWORD ADDRESS                     01173300
.*                                 (11)                                 01173400
.*                                                                      01173500
.*                RSMCM      ,ADDR=LOCKWORD ADDRESS                     01173600
.*                                 (11)                                 01173700
.*                                                                      01173800
.*                RSMDS      ,ADDR=LOCKWORD ADDRESS                     01173900
.*                                 (11)                                 01174000
.*                                                                      01174100
.*                RSMGL      ,ADDR=LOCKWORD ADDRESS                     01174200
.*                                 (11)                                 01174300
.*                                                                      01174400
.*                RSMST      ,ADDR=LOCKWORD ADDRESS                     01174500
.*                                 (11)                                 01174600
.*                                                                      01174700
.*                RSMXM      ,ADDR=LOCKWORD ADDRESS                     01174800
.*                                 (11)                                 01174900
.*                                                                      01175000
.*                SALLOC                                                01175100
.*                                                                      01175200
.*                SPIN                                                  01175300
.*                                                                      01175400
.*                SRM                                                   01175500
.*                                                                      01175600
.*                TPACBDEB   ,ADDR=LOCKWORD ADDRESS                     01175700
.*                                 (11)                                 01175800
.*                                                                      01175900
.*           ***  TPDNCB        NO LONGER SUPPORTED                     01176000
.*                                                                      01176100
.*           ***  TPNCB         NO LONGER SUPPORTED                     01176200
.*                                                                      01176300
.*                TRACE      ,SCOPE=SHR                                 01176400
.*                                  EXCL                                01176500
.*                                                                      01176600
.*                VSMFIX                                                01176700
.*                                                                      01176800
.*                VSMPAG                                                01176900
.*                                                                      01177000
.*                XCFDS      ,ADDR=LOCKWORD ADDRESS                     01177100
.*                                 (11)                                 01177200
.*                                                                      01177300
.*                XCFQ       ,SCOPE=SHR                                 01177400
.*                                  EXCL                                01177500
.*                                                                      01177600
.*                XCFRES     ,ADDR=LOCKWORD ADDRESS                     01177700
.*                                 (11)                                 01177800
.*                                                                      01177900
.*                WLMRES     ,ADDR=LOCKWORD ADDRESS                     01178000
.*                                 (11)                                 01178100
.*                                                                      01178200
.*                WLMQ       ,SCOPE=SHR                                 01178300
.*                                  EXCL                                01178400
.*                                                                      01178500
.*                CONTEXT    ,ADDR=LOCKWORD ADDRESS                     01178600
.*                                 (11)                                 01178700
.*                                                                      01178800
.*                REGSRV     ,SCOPE=SHR                                 01178900
.*                                  EXCL                                01179000
.*                                                                      01179100
.*                                                                      01179200
.*                                                                      01179300
.*        < ,DISABLED >                                                 01179400
.*                                                                      01179500
.*        < ,REGS=SAVE                                                  01179600
.*                USE                                                   01179700
.*                STDSAVE  >                                            01179800
.*                                                                      01179900
.*        < ,RELATED=VALUE  >                                           01180000
.*                                                                      01180100
.*--------------------------------------------------------------------- 01180200
.*                                                                      01180300
.*        TEST                                                          01180400
.*                                                                      01180500
.*          ,TYPE=ALL                                                   01180600
.*                                                                      01180700
.*                ALOCAL   < ,LOCKHLD=(SYMBOLIC REG) >                  01180800
.*                                                                      01180900
.*                ASM      < ,ADDR=(SYMBOLIC REG) >                     01181000
.*                                                                      01181100
.*                ASMGL    < ,ADDR=(SYMBOLIC REG) >                     01181200
.*                                                                      01181300
.*                BMFLSD   < ,ADDR=(SYMBOLIC REG) >      {3}            01181400
.*                                                                      01181500
.*                CML        ,ASCB=(SYMBOLIC REG)                       01181600
.*                           ,LOCKHLD=(SYMBOLIC REG)     {4}            01181700
.*                                                                      01181800
.*                CMS                                                   01181900
.*                                                                      01182000
.*                CPU      < ,LOCKHLD=(SYMBOLIC REG) >                  01182100
.*                                                                      01182200
.*                DISP                                                  01182300
.*                                                                      01182400
.*                ETRSET                                 {3}            01182500
.*                                                                      01182600
.*                HIER       ,LOCK=ASM                   {3}            01182700
.*                                 ASMGL                 {3}            01182800
.*                                 BMFLSD                {3}            01182900
.*                                 DISP                  {3}            01183000
.*                                 ETRSET                {3}            01183100
.*                                 IOS                   {3}            01183200
.*                                 IOSUCB                {3}            01183300
.*                                 IOSULUT               {3}            01183400
.*                                 IOSYNCH               {3}            01183500
.*                                 IXLDS                 {3}            01183600
.*                                 IXLSCH                {3}            01183700
.*                                 IXLREQST              {3}            01183800
.*                                 IXLSHELL              {3}            01183900
.*                                 IXLSHR                {3}            01184000
.*                                 RSM                   {3}            01184100
.*                                 RSMAD                 {3}            01184200
.*                                 RSMCM                 {3}            01184300
.*                                 RSMDS                 {3}            01184400
.*                                 RSMGL                 {3}            01184500
.*                                 RSMST                 {3}            01184600
.*                                 RSMXM                 {3}            01184700
.*                                 SALLOC                {3}            01184800
.*                                 SRM                   {3}            01184900
.*                                 TPACBDEB              {3}            01185000
.*                                 TPDNCB                {3}            01185100
.*                                 TPNCB                 {3}            01185200
.*                                 TRACE                 {3}            01185300
.*                                 VSMFIX                {3}            01185400
.*                                 VSMPAG                {3}            01185500
.*                                 XCFDS                 {3}            01185600
.*                                 XCFQ                  {3}            01185700
.*                                 XCFRES                {3}            01185800
.*                                 WLMRES                {3}            01185900
.*                                 WLMQ                  {3}            01186000
.*                                 CONTEXT               {3}            01186100
.*                                 REGSRV                {3}            01186200
.*                                                                      01186300
.*                IOS      < ,SCOPE=SHR                                 01186400
.*                                  EXCL >                              01186500
.*                                                                      01186600
.*           ***  IOSCAT        NO LONGER SUPPORTED                     01186700
.*                                                                      01186800
.*           ***  IOSLCH        NO LONGER SUPPORTED                     01186900
.*                                                                      01187000
.*                IOSUCB   < ,ADDR=(SYMBOLIC REG) >                     01187100
.*                                                                      01187200
.*                IOSULUT  < ,SCOPE=SHR                                 01187300
.*                                  EXCL >               {3}            01187400
.*                                                                      01187500
.*                IOSYNCH  < ,ADDR=(SYMBOLIC REG) >                     01187600
.*                                                                      01187700
.*                IXLDS    < ,ADDR=(SYMBOLIC REG) >      {3}            01187800
.*                                                                      01187900
.*                IXLREQST < ,ADDR=(SYMBOLIC REG) >      {3}            01188000
.*                                                                      01188100
.*                IXLSCH   < ,ADDR=(SYMBOLIC REG) >      {3}            01188200
.*                                                                      01188300
.*                IXLSHELL < ,ADDR=(SYMBOLIC REG) >      {3}            01188400
.*                                                                      01188500
.*                IXLSHR   < ,SCOPE=SHR                                 01188600
.*                                  EXCL >                              01188700
.*                                                                      01188800
.*                LOCAL                                                 01188900
.*                                                                      01189000
.*                (REG)    < ,REGS=(SYMBOLIC REG) >      {1,5}          01189100
.*                                                                      01189200
.*                RSM      < ,SCOPE=SHR                                 01189300
.*                                  EXCL >                              01189400
.*                                                                      01189500
.*                RSMAD    < ,ADDR=(SYMBOLIC REG) >                     01189600
.*                                                                      01189700
.*                RSMCM    < ,ADDR=(SYMBOLIC REG) >                     01189800
.*                                                                      01189900
.*                RSMDS    < ,ADDR=(SYMBOLIC REG) >                     01190000
.*                                                                      01190100
.*                RSMGL    < ,ADDR=(SYMBOLIC REG) >                     01190200
.*                                                                      01190300
.*                RSMST    < ,ADDR=(SYMBOLIC REG) >                     01190400
.*                                                                      01190500
.*                RSMXM    < ,ADDR=(SYMBOLIC REG) >                     01190600
.*                                                                      01190700
.*                SALLOC                                                01190800
.*                                                                      01190900
.*                SPIN                                   {3}            01191000
.*                                                                      01191100
.*                SRM                                                   01191200
.*                                                                      01191300
.*                TPACBDEB < ,ADDR=(SYMBOLIC REG) >                     01191400
.*                                                                      01191500
.*           ***  TPDNCB        NO LONGER SUPPORTED                     01191600
.*                                                                      01191700
.*           ***  TPNCB         NO LONGER SUPPORTED                     01191800
.*                                                                      01191900
.*                TRACE    < ,SCOPE=SHR                                 01192000
.*                                  EXCL >                              01192100
.*                                                                      01192200
.*                VSMFIX                                                01192300
.*                                                                      01192400
.*                VSMPAG                                                01192500
.*                                                                      01192600
.*                XCFDS    < ,ADDR=(SYMBOLIC REG) >      {3}            01192700
.*                                                                      01192800
.*                XCFQ     < ,SCOPE=SHR                  {3}            01192900
.*                                  EXCL >                              01193000
.*                                                                      01193100
.*                XCFRES   < ,ADDR=(SYMBOLIC REG) >      {3}            01193200
.*                                                                      01193300
.*                WLMRES   < ,ADDR=(SYMBOLIC REG) >      {3}            01193400
.*                                                                      01193500
.*                WLMQ     < ,SCOPE=SHR                  {3}            01193600
.*                                  EXCL >                              01193700
.*                                                                      01193800
.*                CONTEXT  < ,ADDR=(SYMBOLIC REG) >      {3}            01193900
.*                                                                      01194000
.*                REGSRV   < ,SCOPE=SHR                  {3}            01194100
.*                                  EXCL >                              01194200
.*                                                                      01194300
.*                                                                      01194400
.*                                                                      01194500
.*       < ,BRANCH=(HELD,LABEL)                                         01194600
.*                 (NOTHELD,LABEL) >                     {2,3,5}        01194700
.*                                                                      01194800
.*       < ,WORKREG=(SYMBOLIC REG) >                     {1,2}          01194900
.*                                                                      01195000
.*       < ,RELATED=VALUE >                                             01195100
.*                                                                      01195200
.*   NOTES: SETLOCK TEST ONLY                                           01195300
.*                                                                      01195400
.*     {1}  THE WORKREG PARAMETER CANNOT BE SPECIFIED WITH              01195500
.*          TYPE=(REG).                                                 01195600
.*                                                                      01195700
.*     {2}  THE WORKREG PARAMETER WILL BE IGNORED IF THE                01195800
.*          BRANCH PARAMETER IS NOT SPECIFIED.                          01195900
.*                                                                      01196000
.*     {3}  IF THE WORKREG PARAMETER IS SPECIFIED WITH                  01196100
.*          TYPE=SPIN, TYPE=HIER, TYPE=BMFLSD, TYPE=ETRSET,             01196200
.*          TYPE=XCFDS, TYPE=XCFRES, TYPE=XCFQ,                         01196300
.*          TYPE=WLMRES, TYPE=WLMQ, TYPE=CONTEXT, TYPE=REGSRV,          01196400
.*          TYPE=IOSULUT, TYPE=IXLDS, TYPE=IXLREQST, TYPE=IXLSCH,       01196500
.*          TYPE=IXLSHELL, OR TYPE=IXLSHR, THEN THE BRANCH              01196600
.*          PARAMETER IS REQUIRED.                                      01196700
.*                                                                      01196800
.*     {4}  IF THE TYPE=CML PARAMETER IS SPECIFIED, THEN                01196900
.*          THE LOCKHLD AND/OR ASCB PARAMETERS MUST BE                  01197000
.*          SPECIFIED.                                                  01197100
.*                                                                      01197200
.*     {5}  The REGS parameter, if specified, is only valid with        01197300
.*          TYPE=(REG).  REGS is REQUIRED if BOTH TYPE=(REG)            01197400
.*          and the BRANCH keywords are specified.                      01197500
.*                                                                      01197600
.*--------------------------------------------------------------------- 01197700
.*                                                                      01197800
.*01*   CHANGE ACTIVITY =                                               01197900
.*    OZ35343 - CHANGE REFERENCES TO PSA LOCATIONS TO USE EXPLICIT      01198000
.*              ADDRESSABILITY SO THAT A USING PSA,0 IS NOT NEEDED TO   01198100
.*              INVOKE THE MACRO                                        01198200
.*                                                                      01198300
.*  $L1=AR       HBB3310  850801  PD16H4:  ACCESS REGISTER SUPPORT      01208600
.*  $L2=DATASPAC HBB3310  860220  PD22XB:  AR-MODE INVOKER SUPPORT      01221400
.*  $L3=DATASPAC HBB3310  860903  PD16Q4:  RSMDS LOCK                   01225700
.*  $D1=DCR0031  HBB3310  860903  PD16Q4:  IOS LOCK                     01230000
.*  $P1=PC40381  HBB3310  861101  PD16H4:  LOAD PARMS BEFORE PSALITA    01232100
.*  $P2=PC40337  HBB3310  861229  PD16Q4:  TEST FOR LOCK PARM WHEN      01232600
.*                                         TYPE=HIER IS NOT SPECIFIED   01233100
.*                                         ON TEST OPTION               01233600
.*  $L4=LOCKR    HBB4410  880715  PD16BN:  ADD STDSAVE OPTION FOR       01234400
.*                                         REGS KEYWORD                 01235200
.*  $L5=COUPL    HBB4410  880715  PD16BN:  XCFDS,XCFRES,XCFQ LOCKS      01236000
.*  $L6=CLOCK    HBB4410  870831  PD16BN:  ETRSET LOCK                  01236800
.*  $L7=JUP03    HBB4410  880715  PD16BN:  BMFLSD LOCK                  01237600
.*  $L8=LOCKR    HBB4410  870831  PD16BN:  LOCK RESTRUCTURE             01238400
.*  $P3=PEO0033  HBB4410  871026  PD16BN:  ADD SPACE AFTER COMMA ON     01239200
.*                                         SETLOCK8 INVOCATION          01240000
.*  $P4=PHB1079  HBB4410  890313  PD16BN:  PUT OUT CORRECT MNOTE FOR    01240800
.*                                         OBTAIN,TYPE=ALL              01241600
.*  $L9=USERV    FBB4418  890626  PD16EJ:  UCB SERVICES SUPPORT         01242400
.*                                         IOSULUT SPIN LOCK ADDED      01243200
.*  $LA=SYSLK    HBB5510  890821  PD16EJ:  SYSTEM LOCK MANAGER SUPPORT. 01243600
.*  $LB=SYSLK    HBB5510  900904  PD16EI:  SYSTEM LOCK MANAGER LOCK     01244000
.*                                         CHANGES                      01244400
.*  $P5=PIG0101  HBB5510  920812  PD16IG:  Changed error messages for   01244800
.*                                         SETLOCK TEST w/ REGS         01245200
.*  $01=OW02794  HBB5510  931207  PD162M:  IXLREQST spin lock added     01245600
.*  $LC=WLMPASM  HBB6603  951212  PD16FB:  WLM, CONTEXT services Locks  01245800
.*                                                                      01246000
.**************************************************************@G50EPXS 01250000
.*                                                                      01275000
.*   CMSSMF LOCK SUPPORT                                       @G741PXT 01300000
.*   CML LOCK SUPPORT                                          @G387PXR 01350000
.*   DELETE IOSCAT,IOSLCH LOCKS                                @G860PXB 01362500
.*   CHANGES FOR SALLOC LOCK BREAKUP                           @G860PXA 01375000
.*   ADD CPU LOCK                                              @G860PXA 01387500
.*   CML TEST SUPPORT                                          @G382PXR 01400000
.*   ADD TEST SUPPORT FOR THE SALLOC LOCK BREAKUP              @G860PXA 01407100
.*   SUPPORT NEW INTERFACE FOR RELEASE ALL AND RELEASE REG     @G860PXA 01414200
.*   CPU TEST SUPPORT                                          @G860PXK 01421300
.*   ADD RSMCM LOCK                                            @G860PXJ 01428400
.*   ADD TEST SUPPORT FOR TYPE=HIER                            @G860PXA 01435500
.*   ADD "MODE=(COND,IN)" SUPPORT FOR CML LOCK OBTAIN              @L1A 01439000
.*   ADD RSMDS LOCK                                                @L3A 01440200
.*   ADD IOS LOCK                                                  @D1A 01441400
.*   ADD STDSAVE                                                   @L4A 01441500
.*   ADD XCFDS, XCFRES, AND XCFQ LOCKS                             @L5A 01441600
.*   ADD ETRSET LOCK                                               @L6A 01441700
.*   ADD BMFLSD LOCK                                               @L7A 01441800
.*   ADD LOCK RESTRUCTURE SUPPORT                                  @L8A 01441900
.*   ADD IOSULUT LOCK SUPPORT                                      @L9A 01442000
.*   ADD IXLSCH, IXLSHR, IXLDS, AND IXLSHELL LOCKS                 @LBA 01442200
.*   ADD IXLREQST LOCK                                             @01A 01442300
.*   ADD WLMRES, WLMQ LOCKS, CONTEXT LOCKS, REGSRV LOCKS           @LCA 01442400
.*                                                                      01442500
.**************************************************************@G860PXK 01442600
.*                                                                      01446300
         GBLC  &SYSASCE             GLOBAL FOR SYSSTATE MACRO      @L2A 01446500
         SYSSTATE TEST              OBTAIN DEFAULT SYSASCE         @L2A 01446700
         GBLC  &SYSSPLV             GLOBAL FOR SPLEVEL MACRO   @G860PXD 01447000
         SPLEVEL TEST               OBTAIN DEFAULT SYSSPLV     @G860PXD 01447700
         AIF   ('&SYSSPLV' LT '4').LEVEL1   GO GEN DOWNWARD        @L8C 01448400
.*                                  COMPATIBLE MACRO                    01449100
         GBLC  &MESSAGE                                                 01450000
         LCLA  &INDEX                                              @L8C 01451300
         LCLA  &OFSET,&MASK,&BYTE                                       01452600
         LCLA  &X,&FCN,&PSAPTR                                     @L8A 01453900
         LCLA  &COBT(56),&UOBT(56),&REL(56),&RELD(56)              @LCC 01455200
         LCLC  &MESSAG2,&REG1                                      @L8C 01456500
         LCLC  &LABEL                                              @L8C 01457800
         LCLC  &LKNAMES(56)                                        @LCC 01459100
         LCLC  &GNAME1,&GNAME2,&GNAME3,&GNAME4                     @L8A 01460400
.*                                                                      01461700
.*******************************************************************    01463000
.*                                                                 *    01464300
.*       LOCK NAMES                                                *    01465600
.*                                                                 *    01466900
.*******************************************************************    01468200
.*                                                                      01469500
&LKNAMES(1)  SETC 'DISP'                                           @L8A 01470800
&LKNAMES(2)  SETC 'RSMDS'                                          @L8A 01472100
&LKNAMES(3)  SETC 'IOSUCB'                                         @L8A 01473400
&LKNAMES(4)  SETC 'IOSLCH'                                         @L8A 01474700
&LKNAMES(5)  SETC 'IOSYNCH'                                        @L8A 01476000
&LKNAMES(6)  SETC 'TPNCB'                                          @L8A 01477300
&LKNAMES(7)  SETC 'TPDNCB'                                         @L8A 01478600
&LKNAMES(8)  SETC 'TPACBDEB'                                       @L8A 01479900
&LKNAMES(9)  SETC 'ASM'                                            @L8A 01481200
&LKNAMES(10) SETC 'SALLOC'                                         @L8A 01482500
&LKNAMES(11) SETC 'SRM'                                            @L8A 01483800
&LKNAMES(12) SETC 'CMS'                                            @L8A 01485100
&LKNAMES(13) SETC 'LOCAL'                                          @L8A 01486400
&LKNAMES(14) SETC 'SPIN'                                           @L8A 01487700
&LKNAMES(15) SETC 'CMSEQDQ'                                        @L8A 01489000
&LKNAMES(16) SETC 'CMSALL'                                         @L8A 01490300
&LKNAMES(17) SETC 'ALLCMSHELD'                                     @L8A 01491600
&LKNAMES(18) SETC 'CMSSMF'                                         @L8A 01492900
&LKNAMES(19) SETC 'CML'                                            @L8A 01494200
&LKNAMES(20) SETC 'TRACE_S'                                        @L8A 01495500
&LKNAMES(21) SETC 'TRACE_E'                                        @L8A 01496800
&LKNAMES(22) SETC 'VSMPAG'                                         @L8A 01498100
&LKNAMES(23) SETC 'RSM_S'                                          @L8A 01499400
&LKNAMES(24) SETC 'RSM_E'                                          @L8A 01500700
&LKNAMES(25) SETC 'RSMAD'                                          @L8A 01502000
&LKNAMES(26) SETC 'RSMXM'                                          @L8A 01503300
&LKNAMES(27) SETC 'RSMST'                                          @L8A 01504600
&LKNAMES(28) SETC 'ASMGL'                                          @L8A 01505900
&LKNAMES(29) SETC 'VSMFIX'                                         @L8A 01507200
&LKNAMES(30) SETC 'RSMGL'                                          @L8A 01508500
&LKNAMES(31) SETC 'CPU'                                            @L8A 01509800
&LKNAMES(32) SETC 'ALL'                                            @L8A 01511100
&LKNAMES(33) SETC '(REG)'                                          @L8A 01512400
&LKNAMES(34) SETC 'RSMCM'                                          @L8A 01513700
&LKNAMES(35) SETC 'IOS_S'                                          @L8A 01515000
&LKNAMES(36) SETC 'IOS_E'                                          @L8A 01516300
&LKNAMES(37) SETC 'BMFLSD'                                         @L7A 01517600
&LKNAMES(38) SETC 'ETRSET'                                         @L6A 01518900
&LKNAMES(39) SETC 'XCFDS'                                          @L5A 01520200
&LKNAMES(40) SETC 'XCFRES'                                         @L5A 01521500
&LKNAMES(41) SETC 'XCFQ_S'                                         @L5A 01522800
&LKNAMES(42) SETC 'XCFQ_E'                                         @L5A 01524100
&LKNAMES(43) SETC 'IOSULUT_S'                                      @L9A 01525400
&LKNAMES(44) SETC 'IOSULUT_E'                                      @L9A 01526700
&LKNAMES(45) SETC 'IXLSCH'                                         @LBC 01526900
&LKNAMES(46) SETC 'IXLSHR_S'                                       @LBC 01527100
&LKNAMES(47) SETC 'IXLSHR_E'                                       @LBC 01527300
&LKNAMES(48) SETC 'IXLDS'                                          @LBC 01527500
&LKNAMES(49) SETC 'IXLSHELL'                                       @LBA 01527700
&LKNAMES(50) SETC 'IXLREQST'                                       @01A 01527800
&LKNAMES(51) SETC 'WLMQ_S'                                         @LCA 01528100
&LKNAMES(52) SETC 'WLMQ_E'                                         @LCA 01528400
&LKNAMES(53) SETC 'WLMRES'                                         @LCA 01528700
&LKNAMES(54) SETC 'REGSRV_S'                                       @LCA 01528800
&LKNAMES(55) SETC 'REGSRV_E'                                       @LCA 01528900
&LKNAMES(56) SETC 'CONTEXT'                                        @LCA 01529000
.*                                                                      01529100
.*******************************************************************    01529300
.*                                                                 *    01530600
.*       CONDITIONAL OBTAIN LIT OFFSETS (DECIMAL)                  *    01531900
.*                                                                 *    01533200
.*******************************************************************    01534500
.*                                                                      01535800
&COBT(1)     SETA 0           DISPATCHER LOCK                      @L8A 01537100
&COBT(2)     SETA 48          RSMDS LOCK                           @L8A 01538400
&COBT(3)     SETA 96          IOSUCB LOCK                          @L8A 01539700
&COBT(4)     SETA 144         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01541000
&COBT(5)     SETA 192         IOSYNCH LOCK                         @L8A 01542300
&COBT(6)     SETA 240         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01543600
&COBT(7)     SETA 288         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01544900
&COBT(8)     SETA 336         TPACBDEB LOCK                        @L8A 01546200
&COBT(9)     SETA 384         ASM LOCK                             @L8A 01547500
&COBT(10)    SETA 432         SALLOC LOCK                          @L8A 01548800
&COBT(11)    SETA 480         SRM LOCK                             @L8A 01550100
&COBT(12)    SETA 528         CMS LOCK                             @L8A 01551400
&COBT(13)    SETA 564         LOCAL LOCK                           @L8A 01552700
&COBT(14)    SETA -1          SPIN - USED FOR RELEASE ONLY         @L8A 01554000
&COBT(15)    SETA 612         CMSEQDQ LOCK                         @L8A 01555300
&COBT(16)    SETA -1          CMSALL - COND OBTAIN NOT SUPPORTED   @L8A 01556600
&COBT(17)    SETA -1          ALL CMS LOCKS HELD- FOR RELEASE ONLY @L8A 01557900
&COBT(18)    SETA 684         CMSSMF LOCK                          @L8A 01559200
&COBT(19)    SETA 720         CML LOCK                             @L8A 01560500
&COBT(20)    SETA 756         TRACE LOCK - SHARED ENTRY            @L8A 01561800
&COBT(21)    SETA 804         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01563100
&COBT(22)    SETA 852         VSMPAG LOCK                          @L8A 01564400
&COBT(23)    SETA 900         RSM LOCK - SHARED ENTRY              @L8A 01565700
&COBT(24)    SETA 948         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01567000
&COBT(25)    SETA 996         RSMAD LOCK                           @L8A 01568300
&COBT(26)    SETA 1044        RSMXM LOCK                           @L8A 01569600
&COBT(27)    SETA 1092        RSMST LOCK                           @L8A 01570900
&COBT(28)    SETA 1140        ASMGL LOCK                           @L8A 01572200
&COBT(29)    SETA 1188        VSMFIX LOCK                          @L8A 01573500
&COBT(30)    SETA 1236        RSMGL LOCK                           @L8A 01574800
&COBT(31)    SETA 1284        CPU LOCK                             @L8A 01576100
&COBT(32)    SETA -1          ALL - USED FOR RELEASE ONLY          @L8A 01577400
&COBT(33)    SETA -1          (REG) - USED FOR RELEASE ONLY        @L8A 01578700
&COBT(34)    SETA 1356        RSMCM LOCK                           @L8A 01580000
&COBT(35)    SETA 1420        IOS LOCK - SHARED ENTRY              @L8A 01581300
&COBT(36)    SETA 1468        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01582600
&COBT(37)    SETA 0           BMFLSD LOCK                          @L7A 01583900
&COBT(38)    SETA 48          ETRSET LOCK                          @L6A 01585200
&COBT(39)    SETA 96          XCFDS LOCK                           @L5A 01586500
&COBT(40)    SETA 144         XCFRES LOCK                          @L5A 01587800
&COBT(41)    SETA 192         XCFQ LOCK - SHARED ENTRY             @L5A 01589100
&COBT(42)    SETA 240         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01590400
&COBT(43)    SETA 292         IOSULUT LOCK - SHARED ENTRY          @L9A 01591700
&COBT(44)    SETA 340         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01593000
&COBT(45)    SETA 388         IXLSCH LOCK                          @LBC 01593200
&COBT(46)    SETA 436         IXLSHR LOCK - SHARED ENTRY           @LBC 01593400
&COBT(47)    SETA 484         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBA 01593600
&COBT(48)    SETA 532         IXLDS LOCK                           @LBC 01593800
&COBT(49)    SETA 580         IXLSHELL LOCK                        @LBC 01594000
&COBT(50)    SETA 628         IXLREQST LOCK                        @01A 01594100
&COBT(51)    SETA 676         WLMQ LOCK - SHARED ENTRY             @LCA 01594400
&COBT(52)    SETA 724         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01594700
&COBT(53)    SETA 772         WLMRES LOCK                          @LCA 01595000
&COBT(54)    SETA 820         REGSRV LOCK - SHARED ENTRY           @LCA 01595100
&COBT(55)    SETA 868         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01595200
&COBT(56)    SETA 916         CONTEXT LOCK                         @LCA 01595300
.*                                                                      01595400
.*******************************************************************    01595600
.*                                                                 *    01596900
.*       UNCONDITIONAL OBTAIN LIT OFFSETS (DECIMAL)                *    01598200
.*                                                                 *    01599500
.*******************************************************************    01600800
.*                                                                      01602100
&UOBT(1)     SETA 12          DISPATCHER LOCK                      @L8A 01603400
&UOBT(2)     SETA 60          RSMDS LOCK                           @L8A 01604700
&UOBT(3)     SETA 108         IOSUCB LOCK                          @L8A 01606000
&UOBT(4)     SETA 156         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01607300
&UOBT(5)     SETA 204         IOSYNCH LOCK                         @L8A 01608600
&UOBT(6)     SETA 252         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01609900
&UOBT(7)     SETA 300         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01611200
&UOBT(8)     SETA 348         TPACBDEB LOCK                        @L8A 01612500
&UOBT(9)     SETA 396         ASM LOCK                             @L8A 01613800
&UOBT(10)    SETA 444         SALLOC LOCK                          @L8A 01615100
&UOBT(11)    SETA 492         SRM LOCK                             @L8A 01616400
&UOBT(12)    SETA 540         CMS LOCK                             @L8A 01617700
&UOBT(13)    SETA 576         LOCAL LOCK                           @L8A 01619000
&UOBT(14)    SETA -1          SPIN - USED FOR RELEASE ONLY         @L8A 01620300
&UOBT(15)    SETA 624         CMSEQDQ LOCK                         @L8A 01621600
&UOBT(16)    SETA 648         CMSALL                               @L8A 01622900
&UOBT(17)    SETA -1          ALL CMS LOCKS HELD- FOR RELEASE ONLY @L8A 01624200
&UOBT(18)    SETA 696         CMSSMF LOCK                          @L8A 01625500
&UOBT(19)    SETA 732         CML LOCK                             @L8A 01626800
&UOBT(20)    SETA 768         TRACE LOCK - SHARED ENTRY            @L8A 01628100
&UOBT(21)    SETA 816         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01629400
&UOBT(22)    SETA 864         VSMPAG LOCK                          @L8A 01630700
&UOBT(23)    SETA 912         RSM LOCK - SHARED ENTRY              @L8A 01632000
&UOBT(24)    SETA 960         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01633300
&UOBT(25)    SETA 1008        RSMAD LOCK                           @L8A 01634600
&UOBT(26)    SETA 1056        RSMXM LOCK                           @L8A 01635900
&UOBT(27)    SETA 1104        RSMST LOCK                           @L8A 01637200
&UOBT(28)    SETA 1152        ASMGL LOCK                           @L8A 01638500
&UOBT(29)    SETA 1200        VSMFIX LOCK                          @L8A 01639800
&UOBT(30)    SETA 1248        RSMGL LOCK                           @L8A 01641100
&UOBT(31)    SETA 1284        CPU LOCK                             @L8A 01642400
&UOBT(32)    SETA -1          ALL - USED FOR RELEASE ONLY          @L8A 01643700
&UOBT(33)    SETA -1          (REG) - USED FOR RELEASE ONLY        @L8A 01645000
&UOBT(34)    SETA 1368        RSMCM LOCK                           @L8A 01646300
&UOBT(35)    SETA 1432        IOS LOCK - SHARED ENTRY              @L8A 01647600
&UOBT(36)    SETA 1480        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01648900
&UOBT(37)    SETA 12          BMFLSD LOCK                          @L7A 01650200
&UOBT(38)    SETA 60          ETRSET LOCK                          @L6A 01651500
&UOBT(39)    SETA 108         XCFDS LOCK                           @L5A 01652800
&UOBT(40)    SETA 156         XCFRES LOCK                          @L5A 01654100
&UOBT(41)    SETA 204         XCFQ LOCK - SHARED ENTRY             @L5A 01655400
&UOBT(42)    SETA 252         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01656700
&UOBT(43)    SETA 304         IOSULUT LOCK - SHARED ENTRY          @L9A 01658000
&UOBT(44)    SETA 352         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01659300
&UOBT(45)    SETA 400         IXLSCH LOCK                          @LBC 01659500
&UOBT(46)    SETA 448         IXLSHR LOCK - SHARED ENTRY           @LBC 01659700
&UOBT(47)    SETA 496         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBC 01659900
&UOBT(48)    SETA 544         IXLDS LOCK                           @LBC 01660100
&UOBT(49)    SETA 592         IXLSHELL LOCK                        @LBA 01660300
&UOBT(50)    SETA 640         IXLREQST LOCK                        @01A 01660400
&UOBT(51)    SETA 688         WLMQ LOCK - SHARED ENTRY             @LCA 01660700
&UOBT(52)    SETA 736         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01661000
&UOBT(53)    SETA 784         WLMRES LOCK                          @LCA 01661300
&UOBT(54)    SETA 832         REGSRV LOCK - SHARED ENTRY           @LCA 01661400
&UOBT(55)    SETA 880         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01661500
&UOBT(56)    SETA 928         CONTEXT LOCK                         @LCA 01661600
.*                                                                      01661700
.*******************************************************************    01661900
.*                                                                 *    01663200
.*       RELEASE LIT OFFSETS (DECIMAL)                             *    01664500
.*                                                                 *    01665800
.*******************************************************************    01667100
.*                                                                      01668400
&REL(1)      SETA 24          DISPATCHER LOCK                      @L8A 01669700
&REL(2)      SETA 72          RSMDS LOCK                           @L8A 01671000
&REL(3)      SETA 120         IOSUCB LOCK                          @L8A 01672300
&REL(4)      SETA 168         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01673600
&REL(5)      SETA 216         IOSYNCH LOCK                         @L8A 01674900
&REL(6)      SETA 264         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01676200
&REL(7)      SETA 312         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01677500
&REL(8)      SETA 360         TPACBDEB LOCK                        @L8A 01678800
&REL(9)      SETA 408         ASM LOCK                             @L8A 01680100
&REL(10)     SETA 456         SALLOC LOCK                          @L8A 01681400
&REL(11)     SETA 504         SRM LOCK                             @L8A 01682700
&REL(12)     SETA 552         CMS LOCK                             @L8A 01684000
&REL(13)     SETA 588         LOCAL LOCK                           @L8A 01685300
&REL(14)     SETA 600         SPIN - RELEASE ALL SPIN LOCKS HELD   @L8A 01686600
&REL(15)     SETA 636         CMSEQDQ LOCK                         @L8A 01687900
&REL(16)     SETA 660         CMSALL                               @L8A 01689200
&REL(17)     SETA 672         ALL CMS LOCKS HELD                   @L8A 01690500
&REL(18)     SETA 708         CMSSMF LOCK                          @L8A 01691800
&REL(19)     SETA 744         CML LOCK                             @L8A 01693100
&REL(20)     SETA 780         TRACE LOCK - SHARED ENTRY            @L8A 01694400
&REL(21)     SETA 828         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01695700
&REL(22)     SETA 876         VSMPAG LOCK                          @L8A 01697000
&REL(23)     SETA 924         RSM LOCK - SHARED ENTRY              @L8A 01698300
&REL(24)     SETA 972         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01699600
&REL(25)     SETA 1020        RSMAD LOCK                           @L8A 01700900
&REL(26)     SETA 1068        RSMXM LOCK                           @L8A 01702200
&REL(27)     SETA 1116        RSMST LOCK                           @L8A 01703500
&REL(28)     SETA 1164        ASMGL LOCK                           @L8A 01704800
&REL(29)     SETA 1212        VSMFIX LOCK                          @L8A 01706100
&REL(30)     SETA 1260        RSMGL LOCK                           @L8A 01707400
&REL(31)     SETA 1296        CPU LOCK                             @L8A 01708700
&REL(32)     SETA 1308        ALL - RELEASE ALL LOCKS HELD         @L8A 01710000
&REL(33)     SETA 1332        (REG) - RELEASE LOCKS SPECIFIED      @L8A 01711300
&REL(34)     SETA 1380        RSMCM LOCK                           @L8A 01712600
&REL(35)     SETA 1444        IOS LOCK - SHARED ENTRY              @L8A 01713900
&REL(36)     SETA 1492        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01715200
&REL(37)     SETA 24          BMFLSD LOCK                          @L7A 01716500
&REL(38)     SETA 72          ETRSET LOCK                          @L6A 01717800
&REL(39)     SETA 120         XCFDS LOCK                           @L5A 01719100
&REL(40)     SETA 168         XCFRES LOCK                          @L5A 01720400
&REL(41)     SETA 216         XCFQ LOCK - SHARED ENTRY             @L5A 01721700
&REL(42)     SETA 264         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01723000
&REL(43)     SETA 316         IOSULUT LOCK - SHARED ENTRY          @L9A 01724300
&REL(44)     SETA 364         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01725600
&REL(45)     SETA 412         IXLSCH LOCK                          @LBC 01725800
&REL(46)     SETA 460         IXLSHR LOCK - SHARED ENTRY           @LBC 01726000
&REL(47)     SETA 508         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBC 01726200
&REL(48)     SETA 556         IXLDS LOCK                           @LBC 01726400
&REL(49)     SETA 604         IXLSHELL LOCK                        @LBA 01726600
&REL(50)     SETA 652         IXLREQST LOCK                        @01A 01726700
&REL(51)     SETA 700         WLMQ LOCK - SHARED ENTRY             @LCA 01727000
&REL(52)     SETA 748         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01727300
&REL(53)     SETA 796         WLMRES LOCK                          @LCA 01727600
&REL(54)     SETA 844         REGSRV LOCK - SHARED ENTRY           @LCA 01727700
&REL(55)     SETA 892         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01727800
&REL(56)     SETA 940         CONTEXT LOCK                         @LCA 01727900
.*                                                                      01728000
.*******************************************************************    01728200
.*                                                                 *    01729500
.*       RELEASE DISABLED LIT OFFSETS (DECIMAL)                    *    01730800
.*                                                                 *    01732100
.*******************************************************************    01733400
.*                                                                      01734700
&RELD(1)     SETA 36          DISPATCHER LOCK                      @L8A 01736000
&RELD(2)     SETA 84          RSMDS LOCK                           @L8A 01737300
&RELD(3)     SETA 132         IOSUCB LOCK                          @L8A 01738600
&RELD(4)     SETA 180         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01739900
&RELD(5)     SETA 228         IOSYNCH LOCK                         @L8A 01741200
&RELD(6)     SETA 276         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01742500
&RELD(7)     SETA 324         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01743800
&RELD(8)     SETA 372         TPACBDEB LOCK                        @L8A 01745100
&RELD(9)     SETA 420         ASM LOCK                             @L8A 01746400
&RELD(10)    SETA 468         SALLOC LOCK                          @L8A 01747700
&RELD(11)    SETA 516         SRM LOCK                             @L8A 01749000
&RELD(12)    SETA -1          CMS LOCK - DISABLED NOT SUPPORTED    @L8A 01750300
&RELD(13)    SETA -1          LOCAL LOCK - DISABLED NOT SUPPORTED  @L8A 01751600
&RELD(14)    SETA 600         SPIN - RELEASE ALL SPIN LOCKS HELD   @L8A 01752900
&RELD(15)    SETA -1          CMSEQDQ LOCK - DISABLED NOT SUPPORTED@L8A 01754200
&RELD(16)    SETA -1          CMSALL - DISABLED NOT SUPPORTED      @L8A 01755500
&RELD(17)    SETA -1          ALL CMS LOCKS HELD- DISABLED NOT     @L8A 01756800
.*                            SUPPORTED                                 01758100
&RELD(18)    SETA -1          CMSSMF LOCK - DISABLED NOT SUPPORTED @L8A 01759400
&RELD(19)    SETA -1          CML LOCK - DISABLED NOT SUPPORTED    @L8A 01760700
&RELD(20)    SETA 792         TRACE LOCK - SHARED ENTRY            @L8A 01762000
&RELD(21)    SETA 840         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01763300
&RELD(22)    SETA 888         VSMPAG LOCK                          @L8A 01764600
&RELD(23)    SETA 936         RSM LOCK - SHARED ENTRY              @L8A 01765900
&RELD(24)    SETA 984         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01767200
&RELD(25)    SETA 1032        RSMAD LOCK                           @L8A 01768500
&RELD(26)    SETA 1080        RSMXM LOCK                           @L8A 01769800
&RELD(27)    SETA 1128        RSMST LOCK                           @L8A 01771100
&RELD(28)    SETA 1176        ASMGL LOCK                           @L8A 01772400
&RELD(29)    SETA 1224        VSMFIX LOCK                          @L8A 01773700
&RELD(30)    SETA 1272        RSMGL LOCK                           @L8A 01775000
&RELD(31)    SETA 1296        CPU LOCK                             @L8A 01776300
&RELD(32)    SETA 1320        ALL - RELEASE ALL LOCKS HELD         @L8A 01777600
&RELD(33)    SETA 1344        (REG) - RELEASE LOCKS SPECIFIED      @L8A 01778900
&RELD(34)    SETA 1392        RSMCM LOCK                           @L8A 01780200
&RELD(35)    SETA 1456        IOS LOCK - SHARED ENTRY              @L8A 01781500
&RELD(36)    SETA 1504        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01782800
&RELD(37)    SETA 36          BMFLSD LOCK                          @L7A 01784100
&RELD(38)    SETA 84          ETRSET LOCK                          @L6A 01785400
&RELD(39)    SETA 132         XCFDS LOCK                           @L5A 01786700
&RELD(40)    SETA 180         XCFRES LOCK                          @L5A 01788000
&RELD(41)    SETA 228         XCFQ LOCK - SHARED ENTRY             @L5A 01789300
&RELD(42)    SETA 276         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01790600
&RELD(43)    SETA 328         IOSULUT LOCK - SHARED ENTRY          @L9A 01791900
&RELD(44)    SETA 376         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01793200
&RELD(45)    SETA 424         IXLSCH LOCK                          @LBC 01793400
&RELD(46)    SETA 472         IXLSHR LOCK - SHARED ENTRY           @LBC 01793600
&RELD(47)    SETA 520         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBC 01793800
&RELD(48)    SETA 568         IXLDS LOCK                           @LBC 01794000
&RELD(49)    SETA 616         IXLSHELL LOCK                        @LBA 01794200
&RELD(50)    SETA 664         IXLREQST LOCK                        @01A 01794300
&RELD(51)    SETA 712         WLMQ LOCK - SHARED ENTRY             @LCA 01794600
&RELD(52)    SETA 760         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01794900
&RELD(53)    SETA 808         WLMRES LOCK                          @LCA 01795200
&RELD(54)    SETA 856         REGSRV LOCK - SHARED ENTRY           @LCA 01795300
&RELD(55)    SETA 904         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01795400
&RELD(56)    SETA 952         CONTEXT LOCKS                        @LCA 01795500
.*                                                                      01795600
.*******************************************************************    01795800
.*                                                                      01797100
&LABEL   SETC  'IHA&SYSNDX'                                    @G860PXA 01816600
&GNAME1  SETC  'IHB'.'&SYSNDX'.'K'                                 @L8A 01830500
&GNAME2  SETC  'IHB'.'&SYSNDX'.'R'                                 @L8A 01844400
&GNAME3  SETC  'IHB'.'&SYSNDX'.'T'                                 @L8A 01858300
&GNAME4  SETC  'IHB'.'&SYSNDX'.'W'                                 @L8A 01872200
*        MACDATE = 12/12/95                                        @LCA 01886100
&INDEX   SETA  0                                                        01900000
         AIF   ('&REQUEST' EQ 'TEST').TEST                              01950000
.*                                                                      02000000
&FCN     SETA  0                                                   @L8A 02050000
.*                                                                      02100000
         AIF   ('&REQUEST' EQ 'OBTAIN').OBTAIN                          02450000
         AIF   ('&REQUEST' NE 'RELEASE').ERRREQ                    @L8C 02456200
.*                                                                      02462400
.*******************************************************************    02468600
.*                                                                 *    02474800
.*       RELEASE PROCESSING                                        *    02481000
.*                                                                 *    02487200
.*******************************************************************    02493400
.*                                                                      02499600
         AIF   (T'&BRANCH NE 'O').ERRBR                            @L8C 02505800
         AIF   (T'&WORKREG NE 'O').ERRWK                           @L8A 02512000
         AIF   (T'&LOCK NE 'O').NOLOCK                             @L8A 02518200
         AIF   (T'&LOCKHLD NE 'O').ERRLHLD                         @L8C 02524400
         AIF   (T'&TYPE EQ 'O').ERRTYPE                        @G387PXR 02530600
         AIF   (T'&MODE NE 'O').ERRMODE                        @G387PXR 02536800
         AIF   ('&TYPE' EQ 'ALOCAL').ERRALOC                   @G387PXR 02543000
         AIF   ('&DISABLE' EQ 'DISABLED').TESTSUP  TEST FOR SUSPEND REQ 02549200
         AIF   ('&DISABLE' NE '').ERRDIS1                          @L8C 02555400
.*                                                                      02561600
.*       RELEASE WITHOUT DISABLE                                   @L8A 02567800
.*                                                                      02574000
&FCN     SETA  3                                                   @L8A 02580200
         AGO   .REGS                                               @L8A 02586400
.*                                                                      02592600
.TESTSUP ANOP                      CHECK DISABLE INVALID CASES @G860PXA 02598800
         AIF   ('&TYPE'(1,3) EQ 'CMS').ERRDIS2                 @G741PXT 02605000
         AIF   ('&TYPE' EQ 'LOCAL').ERRDIS2                             02611200
         AIF   ('&TYPE' EQ 'CML').ERRDIS2                      @G387PXR 02617400
         AIF   ('&TYPE' EQ 'CPU').ERRDIS2                      @G860PXA 02623600
.*                                                                      02629800
.*       RELEASE DISABLED                                          @L8A 02636000
.*                                                                      02642200
&FCN     SETA  4                                                   @L8A 02648400
         AGO   .REGS                                               @L8A 02654600
.*                                                                      02660800
.*******************************************************************    02667000
.*                                                                 *    02673200
.*       OBTAIN PROCESSING                                         *    02679400
.*                                                                 *    02685600
.*******************************************************************    02691800
.*                                                                      02698000
.OBTAIN  ANOP                                                           02704200
         AIF   (T'&BRANCH NE 'O').ERRBR                                 02710400
         AIF   (T'&WORKREG NE 'O').ERRWK                           @L8A 02716600
         AIF   (T'&LOCK NE 'O').NOLOCK                             @L8A 02722800
         AIF   (T'&LOCKHLD NE 'O').ERRLHLD                         @L8C 02729000
         AIF   (T'&TYPE EQ 'O').ERRTYPE                        @G837PXR 02735200
         AIF   ('&TYPE' EQ 'ALOCAL').EROALOC                   @G837PXR 02741400
         AIF   ('&DISABLE' EQ '').OBTAIN2                               02750000
         AIF   ('&DISABLE' NE 'DISABLED').ERRDIS1                       02769400
.*                                                                      02788800
.* NOTE THAT ON AN OBTAIN, TYPE=CPU, DISABLED IS NOT SUPPORTED @G860PXA 02808300
.*                                                                      02816600
         AIF   ('&TYPE' EQ 'CPU').INVDIS                           @L8C 02824900
         AGO   .MODECK                                             @L8A 02833200
.*                                                                      02841500
.OBTAIN2 ANOP                                                           02850000
         AIF   ('&TYPE' NE 'CPU').MODECK                       @G860PXA 02858300
         AIF   (T'&MODE EQ 'O').COND                           @G860PXA 02866600
         MNOTE 0,'*** MODE IGNORED WITH TYPE=CPU'              @G860PXA 02874900
         AGO   .COND                                           @G860PXA 02883200
.*                                                                      02899900
.MODECK  ANOP                                                           02916600
         AIF   ('&MODE' EQ 'COND').COND                                 02933300
         AIF   ('&MODE' EQ 'UNCOND').UNCOND                             02950000
         AIF   ('&MODE' EQ '(COND,IN)').CONDIN                     @L1A 02975000
         AIF   ('&MODE' EQ '').NOMODE                              @L8C 03025000
         AGO   .MODERR                                             @L8C 03075000
.*                                                                      03125000
.*       UNCONDITIONAL OBTAIN                                      @L8A 03175000
.*                                                                      03225000
.UNCOND  ANOP                                                      @L8A 03275000
&FCN     SETA  2                                                   @L8A 03325000
         AGO   .REGS                                               @L8A 03375000
.*                                                                      03425000
.*       CONDITIONAL OBTAIN                                        @L8A 03475000
.*                                                                      03525000
.COND    ANOP                                                           05900000
         AIF   ('&DISABLE' EQ 'DISABLED').ERRDIS3                  @L8C 05925000
&FCN     SETA  1                                                   @L8A 05950000
.*                                                                      05975000
.REGS    ANOP                                                           06000000
         AIF   ('&REGS' EQ 'SAVE').TYPE SAVE IS VALID PARAMETER         06050000
         AIF   ('&REGS' EQ 'STDSAVE').TYPE STDSAVE IS VALID        @L4A 06066600
.*                                         PARAMETER                    06083200
         AIF   ('&REGS' EQ 'USE').TYPE  USE IS VALID PARAMETER          06100000
         AIF   ('&REGS' NE '').BADREGS  INDICATE REGS IS INVALID   @L8C 06150000
.*                                                                      06200000
.TYPE    ANOP                                                           06350000
.*********************************************************************  06353700
.*                                                                   *  06357400
.*    &X REFERS TO THE INDEX WITHIN THE 4 OFFSET ARRAYS, COBT,       *  06361100
.*    UOBT, REL, AND RELD.                                           *  06364800
.*                                                                   *  06368500
.*    NOTE:  &X SHOULD BE INCREMENTED BY 2 INSTEAD OF 1 AFTER        *  06372200
.*    SHR/EXCL LOCKS.                                                *  06375900
.*                                                                   *  06379600
.*********************************************************************  06383300
&PSAPTR  SETA  0                                                   @L8A 06387500
&X       SETA  1              UPDATE INDEX TO DISP ENTRY           @L8C 06425000
         AIF   ('&TYPE' EQ 'DISP').CODE1                       @G387PXR 06462500
&X       SETA  2              UPDATE INDEX TO RSMDS ENTRY          @L8C 06500000
         AIF   ('&TYPE' EQ 'IOSCAT').INVTYP  NOT SUPPORTED     @G860PXB 06537500
         AIF   ('&TYPE' EQ 'RSMDS').CODEA                          @L3A 06575000
&X       SETA  3              UPDATE INDEX TO IOSUCB ENTRY         @L8C 06600000
         AIF   ('&TYPE' EQ 'IOSUCB').CODEA                              06650000
&X       SETA  4              UPDATE INDEX TO IOSLCH ENTRY         @L8C 06700000
         AIF   ('&TYPE' EQ 'IOSLCH').INVTYP  NOT SUPPORTED     @G860PXB 06750000
&X       SETA  5              UPDATE INDEX TO IOSYNCH ENTRY        @L8C 06800000
         AIF   ('&TYPE' EQ 'IOSYNCH').CODEA                             06850000
&X       SETA  6              UPDATE INDEX TO TPNCB ENTRY          @L8C 06900000
         AIF   ('&TYPE' EQ 'TPNCB').INVTYP   NOT SUPPORTED         @L8C 06950000
&X       SETA  7              UPDATE INDEX TO TPDNCB ENTRY         @L8C 07000000
         AIF   ('&TYPE' EQ 'TPDNCB').INVTYP  NOT SUPPORTED         @L8C 07050000
&X       SETA  8              UPDATE INDEX TO TPACBDEB ENTRY       @L8C 07100000
         AIF   ('&TYPE' EQ 'TPACBDEB').CODEA                            07150000
&X       SETA  9              UPDATE INDEX TO ASM ENTRY            @L8C 07200000
         AIF   ('&TYPE' EQ 'ASM').CODEA                                 07250000
&X       SETA  10             UPDATE INDEX TO SALLOC ENTRY         @L8C 07300000
         AIF   ('&TYPE' EQ 'SALLOC').CODE1                     @G387PXR 07350000
&X       SETA  11             UPDATE INDEX TO SRM ENTRY            @L8C 07400000
         AIF   ('&TYPE' EQ 'SRM').CODE1                        @G387PXR 07450000
&X       SETA  12             UPDATE INDEX TO CMS ENTRY            @L8C 07500000
         AIF   ('&TYPE' EQ 'CMS').CODE1                        @G387PXR 07550000
&X       SETA  13             UPDATE INDEX TO LOCAL ENTRY          @L8C 07600000
         AIF   ('&TYPE' EQ 'LOCAL').CODE1                      @G387PXR 07650000
&X       SETA  14             UPDATE INDEX TO SPIN ENTRY           @L8C 07655000
         AIF   ('&TYPE' EQ 'SPIN').CKSPNAL                     @G860PXA 07660000
&X       SETA  15             UPDATE INDEX TO CMSEQDQ ENTRY        @L8C 07665000
         AIF   ('&TYPE' EQ 'CMSEQDQ').CODE1                    @G387PXR 07670000
&X       SETA  16             UPDATE INDEX TO CMSALL ENTRY         @L8C 07675000
         AIF   ('&TYPE' EQ 'CMSALL').CKALL                     @G741PXT 07680000
&X       SETA  18             UPDATE INDEX TO CMSSMF ENTRY         @L8C 07685000
         AIF   ('&TYPE' EQ 'CMSSMF').CODE1                     @G387PXR 07690000
&X       SETA  19             UPDATE INDEX TO CML ENTRY            @L8C 07695000
         AIF   ('&TYPE' EQ 'CML').CODE                         @G387PXR 07700000
&X       SETA  20             UPDATE INDEX TO TRACE ENTRY          @L8C 07705000
         AIF   ('&TYPE' EQ 'TRACE').SCOPE                      @G860PXA 07710000
&X       SETA  22             UPDATE INDEX TO VSMPAG ENTRY         @L8C 07715000
         AIF   ('&TYPE' EQ 'VSMPAG').CODE1                     @G860PXA 07720000
&X       SETA  23             UPDATE INDEX TO RSM ENTRY            @L8C 07725000
         AIF   ('&TYPE' EQ 'RSM').SCOPE                        @G860PXA 07730000
&X       SETA  25             UPDATE INDEX TO RSMAD ENTRY          @L8C 07735000
         AIF   ('&TYPE' EQ 'RSMAD').CODEA                      @G860PXA 07740000
&X       SETA  26             UPDATE INDEX TO RSMXM ENTRY          @L8C 07745000
         AIF   ('&TYPE' EQ 'RSMXM').CODEA                      @G860PXA 07750000
&X       SETA  27             UPDATE INDEX TO RSMST ENTRY          @L8C 07755000
         AIF   ('&TYPE' EQ 'RSMST').CODEA                      @G860PXA 07760000
&X       SETA  28             UPDATE INDEX TO ASMGL ENTRY          @L8C 07765000
         AIF   ('&TYPE' EQ 'ASMGL').CODEA                      @G860PXA 07770000
&X       SETA  29             UPDATE INDEX TO VSMFIX ENTRY         @L8C 07775000
         AIF   ('&TYPE' EQ 'VSMFIX').CODE1                     @G860PXA 07780000
&X       SETA  30             UPDATE INDEX TO RSMGL ENTRY          @L8C 07785000
         AIF   ('&TYPE' EQ 'RSMGL').CODEA                      @G860PXA 07790000
&X       SETA  31             UPDATE INDEX TO CPU ENTRY            @L8C 07795000
         AIF   ('&TYPE' EQ 'CPU').CODE1                        @G860PXA 07800000
&X       SETA  32             UPDATE INDEX TO ALL ENTRY            @L8C 07805000
         AIF   ('&TYPE' EQ 'ALL').CKSPNAL                      @G860PXA 07810000
&X       SETA  33             UPDATE INDEX TO (REG) ENTRY          @L8C 07815000
         AIF   ('&TYPE'(1,1) EQ '(').CKSPNAL                       @L8C 07820000
&X       SETA  34             UPDATE INDEX TO RSMCM ENTRY          @L8C 07825000
         AIF   ('&TYPE' EQ 'RSMCM').CODEA                      @G860PXJ 07830000
&X       SETA  35             UPDATE INDEX TO IOS ENTRY            @L8C 07835000
         AIF   ('&TYPE' EQ 'IOS').SCOPE                            @D1A 07840000
&PSAPTR  SETA  1                                                   @L8A 07845000
&X       SETA  37             UPDATE INDEX TO BMFLSD ENTRY         @L7A 07850000
         AIF   ('&TYPE' EQ 'BMFLSD').CODEA                         @L7A 07855000
&X       SETA  38             UPDATE INDEX TO ETRSET ENTRY         @L6A 07860000
         AIF   ('&TYPE' EQ 'ETRSET').CODE1                         @L6A 07865000
&X       SETA  39             UPDATE INDEX TO XCFDS ENTRY          @L5A 07870000
         AIF   ('&TYPE' EQ 'XCFDS').CODEA                          @L5A 07875000
&X       SETA  40             UPDATE INDEX TO XCFRES ENTRY         @L5A 07880000
         AIF   ('&TYPE' EQ 'XCFRES').CODEA                         @L5A 07885000
&X       SETA  41             UPDATE INDEX TO XCFQ ENTRY           @L5A 07890000
         AIF   ('&TYPE' EQ 'XCFQ').SCOPE                           @L5A 07895000
&X       SETA  43             UPDATE INDEX TO IOSULUT ENTRY        @L9A 07900000
         AIF   ('&TYPE' EQ 'IOSULUT').SCOPE                        @L9A 07905000
&X       SETA  45             UPDATE INDEX TO IXLSCH ENTRY         @LBC 07905500
         AIF   ('&TYPE' EQ 'IXLSCH').CODEA                         @LBC 07906000
&X       SETA  46             UPDATE INDEX TO IXLSHR ENTRY         @LBC 07906500
         AIF   ('&TYPE' EQ 'IXLSHR').SCOPE                         @LBC 07907000
&X       SETA  48             UPDATE INDEX TO IXLDS ENTRY          @LBC 07907500
         AIF   ('&TYPE' EQ 'IXLDS').CODEA                          @LAA 07908000
&X       SETA  49             UPDATE INDEX TO IXLSHELL ENTRY       @LBC 07908500
         AIF   ('&TYPE' EQ 'IXLSHELL').CODEA                       @LBC 07909000
&X       SETA  50             UPDATE INDEX TO IXLREQST ENTRY       @01A 07909300
         AIF   ('&TYPE' EQ 'IXLREQST').CODEA                       @01A 07909600
&X       SETA  51             UPDATE INDEX TO WLMQ ENTRY           @LCA 07910500
         AIF   ('&TYPE' EQ 'WLMQ').SCOPE                           @LCA 07911400
&X       SETA  53             UPDATE INDEX TO WLMRES ENTRY         @LCA 07912300
         AIF   ('&TYPE' EQ 'WLMRES').CODEA                         @LCA 07913200
&X       SETA  54             UPDATE INDEX TO REGSRV ENTRY         @LCA 07913300
         AIF   ('&TYPE' EQ 'REGSRV').SCOPE                         @LCA 07913400
&X       SETA  56             UPDATE INDEX TO CONTEXT ENTRY        @LCA 07913500
         AIF   ('&TYPE' EQ 'CONTEXT').CODEA                        @LCA 07913600
         AIF   ('&TYPE' NE '').INVTYP  INDICATE TYPE IS INVALID         07914100
         AGO   .NOTYP                  INDICATE TYPE NOT SPECIFIED @L8A 07915000
.*                                                                      07920000
.CKSPNAL ANOP                                                  @G860PXA 07925000
         AIF   ('&REQUEST' NE 'RELEASE').INVTYP  TYPE SPIN|ALL|    @P4C 07930000
.*                                               (REG) ONLY VALID FOR   07935000
.*                                               RELEASE                07940000
         AIF   (T'&ADDR NE 'O').ERRAD                                   07945000
         AIF   ('&TYPE' EQ 'SPIN').RSPIN                                07950000
         AIF   ('&TYPE' EQ 'ALL').RALL                                  08000000
         AIF   ('&TYPE'(K'&TYPE,1) EQ ')').RREG                         08100000
         AGO   .INVTYP                 INDICATE TYPE IS INVALID    @L8A 08150000
.*                                                                      08200000
.CKALL   ANOP                                                  @G741PXT 08650000
         AIF   ('&MODE' EQ 'COND').CNOTSUP  COND IS NOT SUPPORTED  @L8C 08700000
.*                                          FOR CMSALL REQUEST          08750000
         AGO   .CODE1                                              @L8A 08800000
.*                                                                      08850000
.SCOPE   ANOP         CHECK LOCKS THAT REQUIRE SCOPE KEYWORD   @G860PXA 09204700
         AIF   (T'&SCOPE EQ 'O').SCOPREQ                       @G860PXA 09209400
         AIF   ('&SCOPE' EQ 'SHR').CODE1A                      @G860PXA 09214100
&X       SETA  (&X+1)       UPDATE TO EXCLUSIVE ENTRY              @L8C 09228200
         AIF   ('&SCOPE' NE 'EXCL').INVSCOP                        @L8C 09242300
         AGO   .CODE1A                                             @L8A 09256400
.*                                                                      09270500
.CODE1   ANOP         CHECK CASES WHERE SCOPE IS NOT ALLOWED   @G860PXA 09284600
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 09289300
.CODE1A  ANOP                                                  @G860PXA 09312600
         AIF   (T'&ASCB NE 'O').ERRASCB  ASCB VALID FOR CML    @G860PXA 09335900
.*                                       ONLY                           09359200
.CODE    ANOP                                                      @L8A 09382500
.*                                                                      09405800
.*       CHECK THE REQUEST                                              09429100
.*                                                                      09452400
         AIF   (&FCN GT 1).ISIT2                                   @L8A 09475700
&INDEX   SETA  &COBT(&X)       CONDITIONAL OBTAIN REQUEST          @L8A 09499000
         AGO   .CONTINU                                            @L8A 09522300
.ISIT2   ANOP                                                      @L8A 09545600
         AIF   (&FCN GT 2).ISIT3                                   @L8A 09568900
&INDEX   SETA  &UOBT(&X)       UNCONDITIONAL OBTAIN REQUEST        @L8A 09592200
         AGO   .CONTINU                                            @L8A 09615500
.ISIT3   ANOP                                                      @L8A 09638800
         AIF   (&FCN GT 3).ISIT4                                   @L8A 09662100
&INDEX   SETA  &REL(&X)        RELEASE WITHOUT DISABLE REQUEST     @L8A 09685400
         AGO   .CONTINU                                            @L8A 09708700
.ISIT4   ANOP                                                      @L8A 09732000
&INDEX   SETA  &RELD(&X)       RELEASE DISABLED REQUEST            @L8A 09755300
.*                                                                      09778600
.CONTINU ANOP                                                      @L8A 09801900
         AIF   ('&ADDR' NE '').ERRAD                                    09825200
         AIF   ('&REGS' EQ 'SAVE').SAVE1                                09850000
         AIF   ('&REGS' EQ 'STDSAVE').STD1                         @L4A 09875000
         AIF   ('&REGS' EQ 'USE').USE1                                  09900000
&NAME    DS    0H                                                  @P1A 09950000
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                10000000
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 10050000
         AIF   (&PSAPTR EQ 0).OLDLIT1                              @L8A 10053000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 10056000
         AGO   .ARCHK1              GO CHECK FOR AR-MODE           @L8A 10059000
.OLDLIT1 ANOP                                                      @L8A 10062000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 10065000
.ARCHK1  ANOP                                                      @L8A 10068000
         AIF   ('&SYSASCE' EQ 'P').NOAR1                           @L2A 10071400
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 10092800
.NOAR1   ANOP                                                           10114200
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 10135600
*                                   PARM LIST POINTER, AND LOCK RTN     10157000
*                                   ENTRY POINT.                        10178400
         AGO   .MNLCODE                                                 10200000
.*                                                                      10225000
.SAVE1   ANOP                                                           10250000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              10300000
         STM   11,14,0(13)          SAVE REGISTERS                 @L2C 10350000
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                10450000
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 10500000
         AIF   (&PSAPTR EQ 0).OLDLIT2                              @L8A 10503000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 10506000
         AGO   .ARCHK2                                             @L8A 10509000
.OLDLIT2 ANOP                                                      @L8A 10512000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 10515000
.ARCHK2  ANOP                                                      @L8A 10518000
         AIF   ('&SYSASCE' EQ 'P').NOAR3                           @L2A 10521400
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 10542800
.NOAR3   ANOP                                                           10564200
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 10585600
*                                   PARM LIST POINTER, AND LOCK RTN     10607000
*                                   ENTRY POINT.                        10628400
         AGO   .MNLCODE                                                 10650000
.*                                                                      10652300
.STD1    ANOP                                                      @L4A 10654600
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 10656900
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 10659200
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                           @L4A 10661500
         AIF   ('&TYPE' EQ 'CML').LOAD                             @L4A 10663800
         AIF   (&PSAPTR EQ 0).OLDLIT3                              @L8A 10666100
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 10668400
         AGO   .ARCHK3                                             @L8A 10670700
.OLDLIT3 ANOP                                                      @L8A 10673000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 10675300
.ARCHK3  ANOP                                                      @L8A 10677600
         AIF   ('&SYSASCE' EQ 'P').NOAR4                           @L4A 10679900
         LAE   14,0(14,0)           GET ALET OF 0                  @L4A 10682200
.NOAR4   ANOP                                                      @L4A 10684500
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L4A 10686800
*                                   PARM LIST POINTER, AND LOCK RTN     10689100
*                                   ENTRY POINT.                        10691400
         AGO   .MNLCODE                                                 10693700
.*                                                                      10696000
.USE1    ANOP                                                           10700000
&NAME    LR    15,11                SAVE REGISTER 11                    10750000
         LR    0,12                 SAVE REGISTER 12                    10800000
         LR    1,13                 SAVE REGISTER 13                    10850000
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                10950000
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 11000000
         AIF   (&PSAPTR EQ 0).OLDLIT4                              @L8A 11003000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 11006000
         AGO   .ARCHK4                                             @L8A 11009000
.OLDLIT4 ANOP                                                      @L8A 11012000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 11015000
.ARCHK4  ANOP                                                      @L8A 11018000
         AIF   ('&SYSASCE' EQ 'P').NOAR5                           @L2A 11021400
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 11042800
.NOAR5   ANOP                                                           11064200
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 11085600
*                                   PARM LIST POINTER, AND LOCK RTN     11107000
*                                   ENTRY POINT.                        11128400
         AGO   .MNLCODE                                                 11150000
.LOAD    ANOP                                                           11200000
         AIF   ('&TYPE' EQ 'CML').CODEB                                 11228500
.*                                                                      11257000
.*       TYPE IS LOCAL                                         @G387PXR 11285500
.*                                                                      11314000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 11342500
         L     13,&INDEX.+8(14,0)   LOAD ADDRESS OF LOCK RTN       @L8C 11371000
         AGO   .MNLCODE                                                 11400000
.*                                                                      11450000
.CODEB   ANOP                                                  @G387PXR 12600000
.*                                                                      12620000
.*       TYPE IS CML                                                    12640000
.*                                                                      12660000
         AIF   (T'&ASCB EQ 'O').ASCBREQ                        @G387PXR 12680000
         AIF   ('&ASCB' EQ '(11)').CMLR11                      @G387PXR 12700000
         AIF   ('&ASCB'(1,1) EQ '(').ERREG2                    @G387PXR 12750000
         L     11,&ASCB                                            @L8C 12800000
.CMLR11  ANOP                                                  @G387PXR 13050000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 13075000
         L     13,&INDEX.+8(14,0)   LOAD ADDRESS OF LOCK RTN       @L8C 13100000
         AGO   .MNLCODE                                        @G387PXR 13150000
.*                                                                      13175000
.CODEA   ANOP                                                           13200000
.*                                                                      13225000
.*  SCOPE KEYWORD IS NOT ALLOWED FOR LOCKS IN THIS PATH       @G860PXA  13250000
.*                                                                      13275000
.*       CHECK THE REQUEST                                              13300000
.*                                                                      13325000
         AIF   (&FCN GT 1).CHECK2                                  @L8A 13350000
&INDEX   SETA  &COBT(&X)       CONDITIONAL OBTAIN REQUEST          @L8A 13375000
         AGO   .DOMORE                                             @L8A 13400000
.CHECK2  ANOP                                                      @L8A 13425000
         AIF   (&FCN GT 2).CHECK3                                  @L8A 13450000
&INDEX   SETA  &UOBT(&X)       UNCONDITIONAL OBTAIN REQUEST        @L8A 13475000
         AGO   .DOMORE                                             @L8A 13500000
.CHECK3  ANOP                                                      @L8A 13525000
         AIF   (&FCN GT 3).CHECK4                                  @L8A 13550000
&INDEX   SETA  &REL(&X)        RELEASE WITHOUT DISABLE REQUEST     @L8A 13575000
         AGO   .DOMORE                                             @L8A 13600000
.CHECK4  ANOP                                                      @L8A 13625000
&INDEX   SETA  &RELD(&X)       RELEASE DISABLED REQUEST            @L8A 13650000
.*                                                                      13675000
.DOMORE  ANOP                                                      @L8A 13700000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 13725000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G387PXR 13750000
.CODEA1  ANOP                      LOCK ADDRESS ALREADY LOADED @G387PXR 13775000
         AIF   ('&ADDR' EQ '(11)').MR11                        @G387PXR 13800000
         AIF   ('&ADDR' EQ '').ADDREQ                              @L8C 13825000
.ADRLA   ANOP                                                           13850000
         AIF   ('&ADDR'(1,1) EQ '(').ERREG1                             13900000
         AIF   ('&REGS' EQ 'SAVE').SAVE2                                13950000
         AIF   ('&REGS' EQ 'STDSAVE').STD2                         @L4A 13975000
         AIF   ('&REGS' EQ 'USE').USE2                                  14000000
&NAME    LA    11,&ADDR             LOCKWORD ADDRESS                    14010400
         AIF   (&PSAPTR EQ 0).OLDLIT5                              @L8A 14020800
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 14031200
         AGO   .ARCHK5                                             @L8A 14041600
.OLDLIT5 ANOP                                                      @L8A 14052000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 14062400
.ARCHK5  ANOP                                                      @L8A 14072800
         AIF   ('&SYSASCE' EQ 'P').NOAR6                           @L2A 14083200
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 14099800
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 14116400
         AGO   .MNLCODE                                            @L2A 14133000
.NOAR6   ANOP                                                           14149600
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 14166200
*                                   RTN ENTRY POINT.                    14182800
         AGO   .MNLCODE                                                 14200000
.SAVE2   ANOP                                                           14250000
.*                                                                      14266600
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              14283200
         STM   11,14,0(13)          SAVE REGISTERS                 @L2A 14299800
         LA    11,&ADDR             LOCKWORD ADDRESS                    14316400
         AIF   (&PSAPTR EQ 0).OLDLIT6                              @L8A 14333000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 14349600
         AGO   .ARCHK6                                             @L8A 14366200
.OLDLIT6 ANOP                                                      @L8A 14382800
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 14399400
.ARCHK6  ANOP                                                      @L8A 14416000
         AIF   ('&SYSASCE' EQ 'P').NOAR9                           @L2A 14433200
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 14449800
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 14466400
         AGO   .MNLCODE                                            @L2A 14483000
.NOAR9   ANOP                                                           14499600
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 14516200
*                                   RTN ENTRY POINT.                    14532800
         AGO   .MNLCODE                                                 14550000
.*                                                                      14552300
.STD2    ANOP                                                      @L4A 14554600
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 14556900
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 14559200
         LA    11,&ADDR             LOCKWORD ADDRESS               @L4A 14561500
         AIF   (&PSAPTR EQ 0).OLDLIT7                              @L8A 14563800
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 14566100
         AGO   .ARCHK7                                             @L8A 14568400
.OLDLIT7 ANOP                                                      @L8A 14570700
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 14573000
.ARCHK7  ANOP                                                      @L8A 14575300
         AIF   ('&SYSASCE' EQ 'P').NOAR10                          @L4A 14577600
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 14579900
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 14582200
         AGO   .MNLCODE                                            @L4A 14584500
.NOAR10  ANOP                                                      @L4A 14586800
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 14589100
*                                   RTN ENTRY POINT.                    14591400
         AGO   .MNLCODE                                                 14593700
.*                                                                      14596000
.USE2    ANOP                                                           14600000
&NAME    LR    15,11                SAVE REGISTER 11                    14621200
         LR    0,12                 SAVE REGISTER 12                    14642400
         LR    1,13                 SAVE REGISTER 13                    14663600
         LA    11,&ADDR             LOCKWORD ADDRESS                    14684800
         AIF   (&PSAPTR EQ 0).OLDLIT8                              @L8A 14706000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 14727200
         AGO   .ARCHK8                                             @L8A 14748400
.OLDLIT8 ANOP                                                      @L8A 14769600
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 14790800
.ARCHK8  ANOP                                                      @L8A 14812000
         AIF   ('&SYSASCE' EQ 'P').NOAR11                          @L2A 14833200
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 14849800
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 14866400
         AGO   .MNLCODE                                            @L2A 14883000
.NOAR11  ANOP                                                           14899600
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 14916200
*                                   RTN ENTRY POINT.                    14932800
         AGO   .MNLCODE                                                 14950000
.*                                                                      14975000
.MR11    ANOP                                                           15000000
         AIF   ('&REGS' EQ 'SAVE').SAVE3                                15050000
         AIF   ('&REGS' EQ 'STDSAVE').STD3                         @L4A 15075000
         AIF   ('&REGS' EQ 'USE').USE3                                  15100000
         AIF   (&PSAPTR EQ 0).OLDLIT9                              @L8A 15104700
&NAME    L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 15109400
         AGO   .ARCHK9                                             @L8A 15114100
.OLDLIT9 ANOP                                                      @L8A 15118800
&NAME    L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 15123500
.ARCHK9  ANOP                                                      @L8A 15128200
         AIF   ('&SYSASCE' EQ 'P').NOAR13                          @L2A 15133200
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 15149800
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 15166400
         AGO   .MNLCODE                                            @L8C 15183000
.NOAR13  ANOP                                                           15199600
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 15216200
*                                   RTN ENTRY POINT.                    15232800
         AGO   .MNLCODE                                                 15250000
.*                                                                      15275000
.SAVE3   ANOP                                                           15300000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              15312200
         STM   11,14,0(13)          SAVE REGISTERS                 @L2A 15324400
         AIF   (&PSAPTR EQ 0).OLDLITA                              @L8A 15336600
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 15348800
         AGO   .ARCHKA                                             @L8A 15361000
.OLDLITA ANOP                                                      @L8A 15373200
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 15385400
.ARCHKA  ANOP                                                      @L8A 15397600
         AIF   ('&SYSASCE' EQ 'P').NOAR15                          @L2A 15410000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 15430000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 15450000
         AGO   .MNLCODE                                            @L2A 15470000
.NOAR15  ANOP                                                           15490000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 15510000
*                                   RTN ENTRY POINT.                    15530000
         AGO   .MNLCODE                                                 15550000
.*                                                                      15552500
.STD3    ANOP                                                      @L4A 15555000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 15557500
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 15560000
         AIF   (&PSAPTR EQ 0).OLDLITB                              @L8A 15562500
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 15565000
         AGO   .ARCHKB                                             @L8A 15567500
.OLDLITB ANOP                                                      @L8A 15570000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 15572500
.ARCHKB  ANOP                                                      @L8A 15575000
         AIF   ('&SYSASCE' EQ 'P').NOAR16                          @L4A 15577500
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 15580000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 15582500
         AGO   .MNLCODE                                            @L4A 15585000
.NOAR16  ANOP                                                      @L4A 15587500
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 15590000
*                                   RTN ENTRY POINT.                    15592500
         AGO   .MNLCODE                                                 15595000
.*                                                                      15597500
.USE3    ANOP                                                           15600000
&NAME    LR    15,11                SAVE REGISTER 11                    15618300
         LR    0,12                 SAVE REGISTER 12                    15636600
         LR    1,13                 SAVE REGISTER 13                    15654900
         AIF   (&PSAPTR EQ 0).OLDLITC                              @L8A 15673200
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 15691500
         AGO   .ARCHKC                                             @L8A 15709800
.OLDLITC ANOP                                                      @L8A 15728100
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 15746400
.ARCHKC  ANOP                                                      @L8A 15764700
         AIF   ('&SYSASCE' EQ 'P').NOAR17                          @L2A 15783200
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 15799800
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 15816400
         AGO   .MNLCODE                                            @L2A 15833000
.NOAR17  ANOP                                                           15849600
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 15862200
*                                   RTN ENTRY POINT.                    15874800
.*                                                                      15887400
.MNLCODE ANOP                                                           15900000
         AIF   ('&MODE' EQ 'UNCOND').BALCK                              15950000
.*                                                                      15975000
.MNLCOD2 ANOP                                                           16000000
         AIF   ('&SYSASCE' EQ 'P').NOAR36                          @L2A 16012500
         SAC   0                    PRIMARY MODE                   @L2A 16025000
.NOAR36  ANOP                                                           16037500
         AIF   (&PSAPTR EQ 0).NONOTE1                              @L8A 16042500
*        NOTE: THIS LOCK SUPPORTED IN 31-BIT AMODE ONLY            @L8A 16047500
.NONOTE1 ANOP                                                      @L8A 16052500
         BALR  14,13                BRANCH ENTER LOCK ROUTINE           16057500
         AIF   ('&SYSASCE' EQ 'P').NOAR37                          @L2A 16062500
         SAC   X'200'               AR MODE                        @L2A 16075000
.NOAR37  ANOP                                                           16087500
         AGO   .MNLCOD3                                                 16088000
.*                                                                      16088500
.BALCK   ANOP                                                           16089000
         AIF   ('&DISABLE' EQ '').MNLCOD2                               16089500
         AIF   ('&TYPE' EQ 'LOCAL').ERRDIS3                             16090000
         AIF   ('&TYPE' EQ 'CML').ERRDIS3                      @G387PXR 16090500
         AIF   ('&TYPE'(1,3) EQ 'CMS').ERRDIS3                 @G741PXT 16091000
         AIF   ('&SYSASCE' EQ 'P').NOAR42                          @L2A 16091500
         SAC   0                    PRIMARY MODE                   @L2A 16092000
.NOAR42  ANOP                                                           16092500
         AIF   (&PSAPTR EQ 0).NONOTE2                              @L8A 16093000
*                                                                       16093500
*        NOTE: THIS LOCK SUPPORTED IN 31-BIT AMODE ONLY            @L8A 16094000
.NONOTE2 ANOP                                                      @L8A 16094500
         BAL   14,4(0,13)           BRANCH TO LOCK RTN AT DISABLED      16095000
*                                   ENTRY POINT                         16095500
*        NOTE: YOU HAVE JUST SAID THAT YOU ARE DISABLED                 16096000
         AIF   ('&SYSASCE' EQ 'P').NOAR43                          @L2A 16096500
         SAC   X'200'               AR MODE                        @L2A 16097000
.NOAR43  ANOP                                                           16097500
.*                                                                      16098000
.MNLCOD3 ANOP                                                           16100000
         AIF   ('&REGS' EQ 'SAVE').SAVE4                                16150000
         AIF   ('&REGS' EQ 'STDSAVE').STD4                         @L4A 16175000
         AIF   ('&REGS' NE 'USE').ENDIT                                 16200000
         LR    11,15                RESTORE REGISTER 11                 16250000
         LR    15,13                PUT RETURN CODE IN REGISTER 15      16300000
         LR    12,0                 RESTORE REGISTER 12                 16350000
         LR    13,1                 RESTORE REGISTER 13                 16400000
         MEXIT                                                          16450000
.*                                                                      16500000
.SAVE4   ANOP                                                           16875000
.LMEXIT  LR    12,13                SWAP REGISTERS                 @L4C 16900000
         LR    13,15                               R13 AND         @L4C 16925000
         LR    15,12                                       R15     @L4C 16950000
         LM    11,14,0(13)          RESTORE REGS                   @L2C 16975000
         MEXIT                                                          17000000
.*                                                                      17000100
.STD4    ANOP                                                      @L4A 17000200
.LM1EXIT LR    12,13                SWAP REGISTERS                 @L4A 17000300
         LR    13,15                               R13 AND         @L4A 17000400
         LR    15,12                                       R15     @L4A 17000500
         LM    2,12,28(13)          RESTORE REGS PRESERVING        @L4A 17000600
*                                   THE RETURN CODE IN R15              17000700
         MEXIT                                                          17000800
.*                                                                      17000900
.*******************************************************************    17001000
.*       PROCESS "COND,IN" REQUEST FOR CML LOCK ONLY               *    17001100
.*******************************************************************    17001200
.*                                                                      17001300
.CONDIN  ANOP                                                      @L1A 17001400
         AIF   ('&TYPE' NE 'CML').CONDINC  COND,IN REQUEST VALID   @L1A 17001500
.*                                         ONLY FOR CML LOCK OBTAIN     17001600
.*                                                                      17001700
         AIF   (T'&DISABLE NE 'O').ERRDIS3 DISABLED IS NOT VALID   @L1A 17001800
.*                                         FOR CONDITIONAL OBTAIN       17001900
         AIF   (T'&SCOPE NE 'O').NOSCOPE   SCOPE IS INVALID        @L1A 17002000
.*                                                                      17002100
         AIF   (T'&ADDR NE 'O').ERRAD      ADDR IS INVALID         @L1A 17002200
.*                                                                      17002300
         AIF   (T'&ASCB EQ 'O').ASCBREQ    ASCB MUST BE SPECIFIED  @L1A 17002400
.*                                                                      17002500
         AIF   ('&ASCB' EQ '(11)').CONDIN0 ASCB=(11) IS OK         @L1A 17002600
         AIF   ('&ASCB'(1,1) EQ '(').ERREG2  ASCB MUST NOT BE A    @L1A 17002700
.*                                         REGISTER EXCEPT (11)         17002800
.*                                                                      17002900
.CONDIN0 ANOP                                                      @L1A 17003000
         AIF   (T'&NAME EQ 'O').CONDIN1    BRANCH IF LABEL WAS NOT @L1A 17003100
.*                                         SPECIFIED                    17003200
&NAME    DS    0H                                                  @L1A 17003300
.*                                                                      17003400
.CONDIN1 ANOP                                                      @L1A 17003500
         AIF   ('&REGS' EQ 'SAVE').CONDIN2                         @L1A 17003600
         AIF   ('&REGS' EQ 'STDSAVE').CONDIN2A                     @L4A 17003700
         AIF   ('&REGS' EQ 'USE').CONDIN3                          @L1A 17003800
         AIF   (T'&REGS EQ 'O').CONDIN4                            @L1A 17003900
.*                                                                      17004000
         AGO   .BADREGS                    REGS PARAMETER IS BAD   @L1A 17004100
.*                                                                      17004200
.*                                                                      17004300
.CONDIN2 ANOP                                                      @L1A 17004400
         LR    15,13                LOAD SAVE AREA ADDRESS         @L1A 17004500
         STM   11,14,0(13)          SAVE REGISTERS                 @L2C 17004600
         AGO   .CONDIN4                                                 17004700
.*                                                                      17004800
.CONDIN2A ANOP                                                     @L4A 17004900
         LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 17005000
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 17005100
         AGO   .CONDIN4                                            @L4A 17005200
.*                                                                      17005300
.CONDIN3 ANOP                                                      @L1A 17005400
         LR    15,11                SAVE REGISTER 11               @L1A 17005500
         LR    0,12                 SAVE REGISTER 12               @L1A 17005600
         LR    1,13                 SAVE REGISTER 13               @L1A 17005700
.*                                                                      17005800
.CONDIN4 ANOP                                                      @L1A 17005900
         AIF   ('&ASCB' EQ '(11)').CONDIN4A BRANCH IF ASCB IN R11  @P1A 17006000
.*                                                                      17006100
         L     11,&ASCB             LOAD ASCB ADDRESS              @L1A 17006200
.*                                                                      17006300
.CONDIN4A ANOP                                                     @P1A 17006400
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 17006500
         L     13,1416(14,0)        LOCK ROUTINE ENTRY POINT       @L2C 17006600
.*                                                                      17006700
         AGO   .MNLCOD2                                            @L1A 17006800
.*                                                                      17006900
.*                                                                      17007000
.*******************************************************************    17007100
.*       BEGINNING OF RELEASE TYPE=(REG) PROCESSING                *    17007200
.*******************************************************************    17007300
.*                                                                      17007400
.RREG    ANOP                                                           17008000
         AIF   ('&DISABLE' EQ 'DISABLED').STDIS                    @L8C 17008100
&INDEX   SETA  &REL(&X)                    RELEASE LOCKS ENABLED   @L8A 17008200
         AGO   .ASCBS                                                   17008300
.*                                                                      17008400
.STDIS   ANOP                              RELEASE LOCKS DISABLED  @L8A 17008500
&INDEX   SETA  &RELD(&X)                                           @L8A 17008600
.*                                                                      17008700
.ASCBS   ANOP                                                      @L8A 17008800
         AIF   (T'&ASCB NE 'O').RREGASI                            @L8C 17008900
         AIF   (T'&LOCKHLD NE 'O').RREGLKH                         @L8C 17009000
.*                                                                      17009100
         AIF   ('&NAME' EQ '').RREGNN                              @L8C 17009200
&NAME    DC    0H'0'                                           @G860PXA 17009300
.RREGNN  ANOP                                                           17009400
         AIF   (T'&REGS EQ 'O').RREG4                          @G860PXA 17009500
         AIF   ('&REGS' EQ 'SAVE').RREG3                       @G860PXA 17009600
         AIF   ('&REGS' EQ 'STDSAVE').RREG3A                       @L4A 17009700
.*                                                                      17009800
.*  REGS=USE SPECIFIED                                                  17009900
.*                                                                      17010000
         LR    15,11                SAVE REG 11                @G860PXA 17010100
         LR    0,12                 SAVE REG 12                         17010200
         LR    1,13                 SAVE REG 13                         17010300
         AGO   .RREG4                                          @G860PXA 17010400
.*                                                                      17010500
.RREG3   ANOP                                                      @L8A 17010600
         LR    15,13                SAVE AREA ADDRESS          @G860PXA 17010700
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 17010800
         AGO   .RREG4                                              @L4A 17010900
.*                                                                      17011000
.RREG3A  ANOP                                                      @L8A 17011100
         LR    15,13                SAVE AREA ADDRESS              @L4A 17011200
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 17011300
.*                                                                      17011400
.RREG4   ANOP                                                      @L8A 17011500
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 17011600
         AIF   ('&SYSASCE' EQ 'P').NOAR35                          @L2A 17011700
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 17011800
.NOAR35  ANOP                                                      @L8A 17011900
         AIF   ('&TYPE' EQ '(11)').RREG50                      @ZMC0388 17012000
         LR    11,&TYPE(1)          PUT STRING IN PROPER REG   @G860PXA 17012100
.RREG50  ANOP                                                      @L8A 17012200
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDR          @L2C 17012300
         AIF   ('&SYSASCE' EQ 'P').NOAR46                          @L2A 17012400
         SAC   0                    PRIMARY MODE                   @L2A 17012500
.NOAR46  ANOP                                                      @L8A 17012600
         BALR  14,13                LINK TO LOCK RTN           @G387PXR 17012700
         AIF   ('&SYSASCE' EQ 'P').NOAR47                          @L2A 17012800
         SAC   X'200'               AR MODE                        @L2A 17012900
.NOAR47  ANOP                                                      @L8A 17013000
         AIF   (T'&REGS EQ 'O').RREG9                          @G860PXA 17013100
         AIF   ('&REGS' EQ 'SAVE').LMEXIT                          @L2C 17013200
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT                      @L4A 17013300
.*                                                                      17013400
.*   REGS=USE SPECIFIED                                                 17013500
.*                                                                      17013600
         LR    11,15                RESTORE REG 11             @G860PXA 17013700
         LR    15,13                PUT RETURN CODE IN REG 15  @ZMC0683 17013800
         LR    12,0                 RESTORE REG 12             @G860PXA 17013900
         LR    13,1                 RESTORE REG 13             @G860PXA 17014000
.*                                                                      17014100
.RREG9   ANOP                                                      @L8A 17014200
         MEXIT                                                 @G860PXA 17014300
.*                                                                      17014400
.*******************************************************************    17014500
.*       BEGINNING OF RELEASE ALL PROCESSING                       *    17014600
.*******************************************************************    17014700
.*                                                                      17014800
.RALL    ANOP                                                           17014900
         AIF   ('&DISABLE' EQ 'DISABLED').SETDIS                   @L8C 17015000
&INDEX   SETA  &REL(&X)                    RELEASE ALL ENABLED     @L8A 17015100
         AGO   .ASCBCK                                             @L8A 17015200
.*                                                                      17015300
.SETDIS  ANOP                              RELEASE ALL DISABLED    @L8A 17015400
&INDEX   SETA  &RELD(&X)                                           @L8A 17015500
.*                                                                      17015600
.ASCBCK  ANOP                                                      @L8A 17015700
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 17015800
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8C 17015900
.*                                                                      17016000
         AIF   ('&NAME' EQ '').RALLNN                          @G860PXA 17016100
&NAME    DC    0H'0'                                                    17016200
.RALLNN  ANOP                                                      @L8A 17016300
         AIF   (T'&REGS EQ 'O').RALL4                          @G860PXA 17016400
         AIF   ('&REGS' EQ 'SAVE').RALL3                       @G860PXA 17016500
         AIF   ('&REGS' EQ 'STDSAVE').RALL3A                       @L4A 17016600
.*                                                                      17016700
.*  REGS=USE SPECIFIED                                                  17016800
.*                                                                      17016900
         LR    15,11                SAVE REG 11                @G860PXA 17017000
         LR    0,12                 SAVE REG 12                         17017100
         LR    1,13                 SAVE REG 13                         17017200
         AGO   .RALL4                                          @G860PXA 17017300
.*                                                                      17017400
.RALL3   ANOP                                                      @L8A 17017500
         LR    15,13                SAVE AREA ADDRESS          @G860PXA 17017600
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 17017700
         AGO   .RALL4                                              @L4A 17017800
.*                                                                      17017900
.RALL3A  ANOP                                                      @L8A 17018000
         LR    15,13                SAVE AREA ADDRESS              @L4A 17018100
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 17018200
.*                                                                      17018300
.RALL4   ANOP                                                      @L8A 17018400
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 17018500
         AIF   ('&SYSASCE' EQ 'P').NOAR33                          @L2A 17018600
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 17018700
.*                                                                      17018800
.NOAR33  ANOP                                                           17018900
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDR          @L2C 17019000
         AIF   ('&SYSASCE' EQ 'P').NOAR38                          @L2A 17020700
         SAC   0                    PRIMARY MODE                   @L2A 17020800
.*                                                                      17020900
.NOAR38  ANOP                                                           17021000
         BALR  14,13                LINK TO LOCK RTN           @G387PXR 17021100
         AIF   ('&SYSASCE' EQ 'P').NOAR39                          @L2A 17021200
         SAC   X'200'               AR MODE                        @L2A 17021300
.*                                                                      17021400
.NOAR39  ANOP                                                           17021500
         AIF   (T'&REGS EQ 'O').RALL9                          @G860PXA 17021600
         AIF   ('&REGS' EQ 'SAVE').LMEXIT                          @L2C 17022000
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT                      @L4A 17022200
.*                                                                      17022400
.*  REGS=USE SPECIFIED                                                  17022600
.*                                                                      17022800
         LR    11,15                RESTORE REG 11             @G860PXA 17023000
         LR    15,13                PUT RETURN CODE IN REG 15  @ZMC0683 17023200
         LR    12,0                 RESTORE REG 12             @G860PXA 17023400
         LR    13,1                 RESTORE REG 13             @G860PXA 17023600
.*                                                                      17023800
.RALL9   ANOP                                                  @G860PXA 17024000
         MEXIT                                                          17024200
.*                                                                      17024400
.*******************************************************************    17024600
.*       BEGINNING OF RELEASE TYPE=SPIN PROCESSING                 *    17024800
.*******************************************************************    17025000
.*                                                                      17025200
.RSPIN   ANOP                                                           17026000
         AIF   ('&DISABLE' EQ 'DISABLED').SETDIS2                  @L8C 17026100
&INDEX   SETA  &REL(&X)           RELEASE SPIN LOCKS ENABLED       @L8A 17026200
         AGO   .NAMECK                                             @L8A 17026300
.*                                                                      17026400
.SETDIS2 ANOP                     RELEASE SPIN LOCKS DISABLED      @L8A 17026500
&INDEX   SETA  &RELD(&X)                                           @L8A 17026600
.*                                                                      17026700
.NAMECK  ANOP                                                      @L8A 17026800
         AIF   ('&NAME' EQ '').RSPINNN                                  17026900
&NAME    DC    0H'0'                                                    17027000
.RSPINNN AIF   (T'&REGS EQ 'O').RSPINC                                  17027200
         AIF   ('&REGS' EQ 'SAVE').RSPINS                               17027600
         AIF   ('&REGS' EQ 'STDSAVE').RSPINS1                      @L4A 17027900
         LR    15,11                SAVE REG 11                         17028200
         LR    0,12                 SAVE REG 12                         17028500
         LR    1,13                 SAVE REG 13                         17028800
         AGO   .RSPINC                                                  17029200
.RSPINS  ANOP                                                           17029600
         LR    15,13                SAVE AREA ADDRESS                   17029700
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 17029800
         AGO   .RSPINC                                             @L4A 17029900
.RSPINS1 ANOP                                                      @L4A 17030000
         LR    15,13                SAVE AREA ADDRESS              @L4A 17030100
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 17030200
.RSPINC  ANOP                                                           17030800
         AIF   (T'&DISABLE EQ 'O').RSPINE                      @ZMC0587 17031200
         MVI   PSAMPSW-PSA(0),X'00' INDICATE RETURN DISABLED   @ZMC0587 17032000
         AGO   .RSPINR                                         @ZMC0587 17032400
.RSPINE  ANOP                                                  @ZMC0587 17032800
         MVI   PSAMPSW-PSA(0),X'03' INDICATE RETURN ENABLED    @ZMC0587 17033200
.RSPINR  ANOP                                                  @ZMC0587 17033600
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 17033700
         AIF   ('&SYSASCE' EQ 'P').NOAR34                          @L2A 17033800
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L2A 17033900
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L2A 17034000
         SAC   0                    PRIMARY MODE                   @L2A 17034100
         AGO   .AR34                                               @L2A 17034200
.NOAR34  ANOP                                                           17034300
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDRESS       @L2C 17034400
.AR34    BALR  14,13                LINK TO LOCK MANAGER                17034500
         AIF   ('&SYSASCE' EQ 'P').NOAR41                          @L2A 17034600
         SAC   X'200'               AR MODE                        @L2A 17034700
.NOAR41  ANOP                                                           17034800
         AIF   (T'&REGS EQ 'O').RSPINX                                  17036000
         AIF   ('&REGS' EQ 'USE').RSPINU                                17036400
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT  SAVE RETURN CODE,   @L4A 17036500
.*                                  RESTORE REGS 2 THRU 12              17036600
         AGO   .LMEXIT              SAVE RETURN CODE, RESTORE REGS @L4C 17036700
.*                                  11 THRU 14                          17036800
.RSPINX  MEXIT                                                          17037200
.RSPINU  ANOP                                                           17037600
         LR    11,15                RESTORE REG 11                      17038000
         LR    15,13                PUT RETURN CODE IN         @ZMC0683 17038100
*                                   REGISTER 15                @ZMC0683 17038200
         LR    12,0                 RESTORE REG 12                      17038400
         LR    13,1                 RESTORE REG 13                      17038800
         MEXIT                                                          17039200
.*                                                                      17039400
.************************************************************* @G860PXA 17039600
.* BEGINNING OF TEST SUPPORT                                   @G860PXA 17040000
.************************************************************* @G860PXA 17040400
.*                                                                      17040600
.TEST    ANOP                                                           17040800
         AIF   (T'&TYPE EQ 'O').ERRTYPE   TYPE REQUIRED       @G860PXA  17041200
         AIF   (T'&MODE NE 'O').INVMODE   MODE IS NOT VALID             17041600
         AIF   (T'&DISABLE NE 'O').NODIS  DISABLED IS NOT VALID         17042000
         AIF   ('&TYPE' EQ 'HIER').HIER01                         @L8A  17042400
         AIF   ('&TYPE' EQ 'ALL').TALLC                           @L8A  17042800
         AIF   ('&TYPE' EQ 'SPIN').SPIN01                         @L8A  17043200
         AGO   .TSTADR                                            @L8C  17043600
.*                                                                      17044000
.************************************************************* @G860PXA 17045200
.* BEGINNING OF TEST,TYPE=HIER PROCESSING                      @G860PXA 17045600
.************************************************************* @G860PXA 17046000
.*                                                                      17046200
.HIER01  ANOP                                                      @L8A 17046400
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 17046600
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 17046800
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 17047000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 17047200
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 17047400
.*                                                                      17047600
         AIF   (T'&LOCK EQ 'O').TERR007                        @G860PXA 17048000
.*********************************************************************  17048100
.*                                                                   *  17048200
.*    &X REFERS TO THE INDEX WITHIN THE 4 OFFSET ARRAYS, COBT,       *  17048300
.*    UOBT, REL, AND RELD.                                           *  17048400
.*                                                                   *  17048500
.*    NOTE:  &X SHOULD BE INCREMENTED BY 2 INSTEAD OF 1 AFTER        *  17048600
.*    SHR/EXCL LOCKS.                                                *  17048700
.*                                                                   *  17048800
.*********************************************************************  17048900
&X       SETA  1              UPDATE INDEX TO DISP ENTRY           @L8C 17049000
         AIF   ('&LOCK' EQ 'DISP').HIER02                      @G860PXA 17049100
&X       SETA  2              UPDATE INDEX TO RSMDS ENTRY          @L8C 17049200
         AIF   ('&LOCK' EQ 'RSMDS').HIER02                         @L3A 17049300
&X       SETA  3              UPDATE INDEX TO IOSUCB ENTRY         @L8C 17049400
         AIF   ('&LOCK' EQ 'IOSUCB').HIER02                    @G860PXA 17049500
&X       SETA  5              UPDATE INDEX TO IOSYNCH ENTRY        @L8C 17049600
         AIF   ('&LOCK' EQ 'IOSYNCH').HIER02                   @G860PXA 17050000
&X       SETA  8              UPDATE INDEX TO TPACBDEB ENTRY       @L8C 17051200
         AIF   ('&LOCK' EQ 'TPACBDEB').HIER02                  @G860PXA 17052400
&X       SETA  9              UPDATE INDEX TO ASM ENTRY            @L8C 17052800
         AIF   ('&LOCK' EQ 'ASM').HIER02                       @G860PXA 17053200
&X       SETA  10             UPDATE INDEX TO SALLOC ENTRY         @L8C 17053600
         AIF   ('&LOCK' EQ 'SALLOC').HIER02                    @G860PXA 17054000
&X       SETA  11             UPDATE INDEX TO SRM ENTRY            @L8C 17054400
         AIF   ('&LOCK' EQ 'SRM').HIER02                       @G860PXA 17054800
&X       SETA  20             UPDATE INDEX TO TRACE ENTRY          @L8C 17055200
         AIF   ('&LOCK' EQ 'TRACE').HIER02                     @G860PXA 17055600
&X       SETA  22             UPDATE INDEX TO VSMPAG ENTRY         @L8C 17056000
         AIF   ('&LOCK' EQ 'VSMPAG').HIER02                    @G860PXA 17056400
&X       SETA  23             UPDATE INDEX TO RSM ENTRY            @L8C 17056800
         AIF   ('&LOCK' EQ 'RSM').HIER02                       @G860PXA 17057200
&X       SETA  25             UPDATE INDEX TO RSMAD ENTRY          @L8C 17057600
         AIF   ('&LOCK' EQ 'RSMAD').HIER02                     @G860PXA 17058000
&X       SETA  26             UPDATE INDEX TO RSMXM ENTRY          @L8C 17058400
         AIF   ('&LOCK' EQ 'RSMXM').HIER02                     @G860PXA 17058800
&X       SETA  27             UPDATE INDEX TO RSMST ENTRY          @L8C 17059200
         AIF   ('&LOCK' EQ 'RSMST').HIER02                     @G860PXA 17059600
&X       SETA  28             UPDATE INDEX TO ASMGL ENTRY          @L8C 17060000
         AIF   ('&LOCK' EQ 'ASMGL').HIER02                     @G860PXA 17060400
&X       SETA  29             UPDATE INDEX TO VSMFIX ENTRY         @L8C 17060800
         AIF   ('&LOCK' EQ 'VSMFIX').HIER02                    @G860PXA 17061200
&X       SETA  30             UPDATE INDEX TO RSMGL ENTRY          @L8C 17061600
         AIF   ('&LOCK' EQ 'RSMGL').HIER02                     @G860PXA 17062000
&X       SETA  34             UPDATE INDEX TO RSMCM ENTRY          @L8C 17062400
         AIF   ('&LOCK' EQ 'RSMCM').HIER02                         @L3C 17062500
&X       SETA  35             UPDATE INDEX TO IOS ENTRY            @L8C 17062700
         AIF   ('&LOCK' EQ 'IOS').HIER02                           @L8C 17062900
&PSAPTR  SETA  1                                                   @L8A 17063100
&X       SETA  37             UPDATE INDEX TO BMFLSD ENTRY         @L7A 17063300
         AIF   ('&LOCK' EQ 'BMFLSD').HIER02                        @L7A 17063500
&X       SETA  38             UPDATE INDEX TO ETRSET ENTRY         @L6A 17063700
         AIF   ('&LOCK' EQ 'ETRSET').HIER02                        @L6A 17063900
&X       SETA  39             UPDATE INDEX TO XCFDS ENTRY          @L5A 17064100
         AIF   ('&LOCK' EQ 'XCFDS').HIER02                         @L5A 17064300
&X       SETA  40             UPDATE INDEX TO XCFRES ENTRY         @L5A 17064500
         AIF   ('&LOCK' EQ 'XCFRES').HIER02                        @L5A 17064700
&X       SETA  41             UPDATE INDEX TO XCFQ ENTRY           @L5A 17064900
         AIF   ('&LOCK' EQ 'XCFQ').HIER02                          @L9C 17065100
&X       SETA  43             UPDATE INDEX TO IOSULUT ENTRY        @L9A 17065300
         AIF   ('&LOCK' EQ 'IOSULUT').HIER02                       @LAC 17065400
&X       SETA  45             UPDATE INDEX TO IXLSCH ENTRY         @LBC 17065500
         AIF   ('&LOCK' EQ 'IXLSCH').HIER02                        @LBC 17065600
&X       SETA  46             UPDATE INDEX TO IXLSHR ENTRY         @LBC 17065700
         AIF   ('&LOCK' EQ 'IXLSHR').HIER02                        @LBC 17065800
&X       SETA  48             UPDATE INDEX TO IXLDS ENTRY          @LBC 17065900
         AIF   ('&LOCK' EQ 'IXLDS').HIER02                         @LAA 17066000
&X       SETA  49             UPDATE INDEX TO IXLSHELL ENTRY       @LBC 17066100
         AIF   ('&LOCK' EQ 'IXLSHELL').HIER02                      @LBC 17066200
&X       SETA  50             UPDATE INDEX TO IXLREQST ENTRY       @01A 17066400
         AIF   ('&LOCK' EQ 'IXLREQST').HIER02                      @01A 17066600
&X       SETA  51             UPDATE INDEX TO WLMQ ENTRY           @LCA 17066700
         AIF   ('&LOCK' EQ 'WLMQ').HIER02                          @LCA 17066800
&X       SETA  53             UPDATE INDEX TO WLMRES ENTRY         @LCA 17066900
         AIF   ('&LOCK' EQ 'WLMRES').HIER02                        @LCA 17067000
&X       SETA  54             UPDATE INDEX TO REGSRV ENTRY         @LCA 17067100
         AIF   ('&LOCK' EQ 'REGSRV').HIER02                        @LCA 17067200
&X       SETA  56             UPDATE INDEX TO CONTEXT ENTRY        @LCA 17067300
         AIF   ('&LOCK' EQ 'CONTEXT').HIER02                       @LCA 17067400
         AGO   .TERR008                                            @LAA 17067500
.HIER02  ANOP                                                           17067600
&INDEX   SETA  &COBT(&X)   GET INDEX INTO LIT, USED TO OBTAIN PARM @L8A 17067700
.*                         LIST ADDRESS FOR SPECIFIED LOCK              17067800
         AIF   (T'&BRANCH EQ 'O').CKWKRG  WORKREG SPECIFIED        @L8A 17067900
.*                                        WITHOUT BRANCH?               17068000
.*  BRANCH WAS SPECIFIED                                                17068100
.*                                                                      17068200
         AIF   (N'&BRANCH NE 2).TINVBR                         @G860PXA 17068400
         AIF   ('&BRANCH(1)' EQ 'HELD').HIER08                 @G860PXA 17068800
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND             @G860PXA 17069200
.*                                                                      17069300
.*  BRANCH OPERAND VALID                                                17069400
.*                                                                      17069500
.HIER08  ANOP                                                           17069600
         AIF   (T'&WORKREG EQ 'O').NOWKREG WORKREG REQUIRED WITH   @L8A 17069700
.*                                         BRANCH                       17069800
.*  WORKREG WAS SPECIFIED                                               17069900
.*                                                                      17070000
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 17070100
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 17070200
         AIF   ('&NAME' EQ '').NN1                                 @L8A 17070300
&NAME    DC    0H'0'                                               @L8A 17070400
.NN1     ANOP                                                      @L8A 17070500
         AGO   .GENCODE                   GENERATE CODE WITH       @L8A 17070600
.*                                        WORKREG                       17070700
.*  BRANCH WAS NOT SPECIFIED                                            17070800
.*                                                                      17070900
.CKWKRG  ANOP                                                      @L8A 17071000
         AIF   (T'&WORKREG NE 'O').WARNWK WORKREG IGNORED WITHOUT  @L8A 17071100
.*                                        BRANCH                        17071200
.WRNWKR  ANOP                                                      @L8A 17071300
         AIF   ('&NAME' EQ '').NN2                                 @L8A 17071400
&NAME    DC    0H'0'                                               @L8A 17071500
.NN2     ANOP                                                      @L8A 17071600
         AGO   .GENCOD2                   GENERATE CODE WITHOUT    @L8A 17071700
.*                                        WORKREG                       17071800
.GENCODE ANOP                             WORKREG SPECIFIED        @L8A 17071900
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 17072000
.*                                                                      17072100
.GENCOD2 ANOP                       WORKREG NOT SPECIFIED          @L8A 17072200
         IAC   15                   SET CONDITION CODE BASED ON    @L8A 17072300
*                                   ASC MODE TO BE USED BY THE IPM      17072400
*                                   INSTRUCTION WHICH FOLLOWS.          17072500
         SAC   0                    SAC TO PRIMARY FOR BAKR        @L8A 17072600
         LA    15,&GNAME1           RETURN ADDRESS FOR PR          @L8A 17072700
         BSM   15,0                 SET AMODE BIT FOR RETURN ADDR  @L8A 17072800
         BAKR  15,0                 SAVE STATUS ON THE LINKAGE     @L8A 17072900
*                                   STACK AND SET UP RETURN ADDRESS FOR 17073000
*                                   THE PR                              17073100
         IPM   0                    PUT IAC CC BITS INTO REG 0     @L8A 17073200
         SRL   0,20                 SHIFT IAC CC TO BITS 22-23     @L8A 17073300
         L     15,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 17073400
         AIF   (&PSAPTR EQ 1).NEWLIT                               @L8A 17073500
         L     12,&INDEX.+4(15,0)   PARM LIST ADDRESS FOR          @L8A 17073600
*                                   SPECIFIED LOCK                      17073700
         AGO   .EPA                                                @L8A 17073800
.NEWLIT  ANOP                                                      @L8A 17073900
         L     12,PSALIT2-PSA(0,0)  EXTENDED LOCK INTERFACE TABLE  @L8A 17074000
*                                   ADDRESS                             17074100
         L     12,&INDEX.+4(12,0)   PARM LIST ADDRESS FOR          @L8A 17074200
*                                   SPECIFIED LOCK                      17074300
.EPA     ANOP                                                      @L8A 17074400
         L     15,1524(15,0)        LOCK MANAGER ENTRY POINT       @L8A 17074500
*                                   ADDRESS                             17074600
         BASSM 14,15                BRANCH TO SERVICE RTN.         @L8A 17074700
         EREG  0,1                  RESTORE REGISTERS 0,1          @L8A 17074800
         PR                         RESTORE STATUS                 @L8A 17074900
&GNAME1  EQU   *                                                   @L8A 17075000
*                                                                       17075100
*    THE ASC-MODE OF THE CALLER HAS BEEN RESTORED TO GENERAL REGISTER   17075200
*    15 BY THE SERVICE ROUTINE FOR USE IN THE SAC INSTRUCTION.          17075300
*                                                                       17075400
         SAC   0(15)                RESTORE ORIGINAL ASC-MODE      @L8A 17075500
         ICM   15,B'1110',PSAFZERO-PSA(0) CLEAN RETURN CODE FROM   @L8A 17075600
*                                         LOCK MANAGER                  17075700
*                                                                  @L8A 17075800
         AIF   (T'&BRANCH EQ 'O').DONE                             @L8A 17075900
*                                                                       17076000
*    INSTRUCTIONS THAT CHANGE THE CONDITION CODE MAY NOT BE INSERTED    17076100
*    BETWEEN THE LTR AND THE RESULTING BRANCH WHICH IS GENERATED.       17076200
*                                                                       17076300
         LTR   15,15                                               @L8A 17076400
         LR    15,&WORKREG(1)       RESTORE GPR15                  @L8A 17076500
         AIF   ('&BRANCH(1)' EQ 'HELD').HIER10                     @L8A 17076600
         BZ    &BRANCH(2)           BRANCH NO HIGHER LOCKS HELD    @L8A 17076700
*                                   (R.C. IS 0)                         17076800
         MEXIT                                                     @L8A 17076900
.HIER10  ANOP                                                      @L8A 17077000
         BNZ   &BRANCH(2)           BRANCH HIGHER LOCKS HELD       @L8A 17077100
*                                   (R.C. IS 4)                         17077200
.DONE    ANOP                                                      @L8A 17077300
         MEXIT                                                          17082400
.*                                                                      17082500
.*************************************************************          17082600
.*   BEGINNING OF TEST,TYPE=ALL PROCESSING                   *          17082700
.*************************************************************          17082800
.*                                                                      17082900
.TALLC   ANOP                                                           17083000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 17083100
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G387PXR 17083200
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G387PXR 17083300
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 17083400
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 17083500
         AIF   (T'&LOCK NE 'O').TERR009                            @L8A 17083600
         AIF   ('&BRANCH' EQ '').CKWREG5                           @L8A 17083700
.*                                                                      17083800
.*  BRANCH WAS SPECIFIED                                                17083900
.*                                                                      17084000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 17084100
         AIF   ('&BRANCH(1)' EQ 'HELD').TALLC2                     @L8A 17084200
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 17084300
.*                                                                      17084400
.*  BRANCH OPERAND VALID                                                17084500
.*                                                                      17084600
.TALLC2  ANOP                                                      @L8A 17084700
         AIF   ('&WORKREG' EQ '').NOWKREG                          @L8A 17084800
.*                                                                      17084900
.*  WORKREG WAS SPECIFIED                                               17085000
.*                                                                      17085100
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 17085200
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 17085300
         AGO   .NN5                                                @L8A 17085400
.*                                                                      17085500
.*  BRANCH WAS NOT SPECIFIED                                            17085600
.*                                                                      17085700
.CKWREG5 ANOP                                                      @L8A 17085800
         AIF   (T'&WORKREG NE 'O').WARNWK5                         @L8A 17085900
.NN5     ANOP                                                      @L8A 17086000
         AIF   ('&NAME' EQ '').TALLCNA                             @L8A 17086100
&NAME    DC    0H'0'                                               @L8A 17086200
.TALLCNA ANOP                                                      @L8A 17086300
         AIF   (T'&BRANCH EQ 'O').SKPLD6                           @L8A 17086400
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 17086500
.*                                                                      17086600
.SKPLD6  ANOP                                                      @L8A 17086700
         L     15,PSACLHS-PSA(0,0)  LOAD CLHS FOR TESTING          @L8A 17086800
         LTR   15,15                ARE ANY LOCKS HELD?            @L8A 17086900
         AIF   (T'&BRANCH EQ 'O').TALLRC                                17087000
.*                                                                      17087100
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 17087200
         AIF   ('&BRANCH(1)' EQ 'HELD').TALLBH                          17087300
         BZ    &BRANCH(2)           BRANCH ON NOTHELD                   17087400
         MEXIT                                                          17087500
.*                                                                      17087600
.TALLBH  ANOP                                                           17087700
         BNZ   &BRANCH(2)           BRANCH ON HELD                      17087800
         MEXIT                                                          17087900
.*                                                                      17088000
.TALLRC  ANOP                                                           17088100
         BZ    *+12                 BRANCH ON NOTHELD                   17088200
         LA    15,0(0,0)            SET LOCKS HELD R.C.                 17088300
         B     &LABEL.D                                                 17088400
         LA    15,4(0,0)            SET LOCKS NOT HELD R.C.             17088500
&LABEL.D DC    0H'0'                                                    17088600
         MEXIT                                                          17089600
.*                                                                      17089700
.*************************************************************          17089800
.*   BEGINNING OF TEST,TYPE=SPIN PROCESSING                  *          17089900
.*************************************************************          17090000
.*                                                                      17090100
.SPIN01  ANOP                                                           17090200
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 17090300
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 17090400
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 17090500
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 17090600
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 17090700
         AIF   (T'&LOCK NE 'O').TERR009                            @L8A 17090800
         AIF   (T'&BRANCH EQ 'O').CKWREG                           @L8A 17090900
.*                                                                      17091000
.*  BRANCH WAS SPECIFIED                                                17091100
.*                                                                      17091200
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 17091300
         AIF   ('&BRANCH(1)' EQ 'HELD').SPIN02                     @L8A 17091400
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                      17091500
.*                                                                      17091600
.*  BRANCH OPERAND VALID                                                17091700
.*                                                                      17091800
.SPIN02  ANOP                                                           17091900
         AIF   ('&WORKREG' EQ '').NOWKREG                          @L8A 17092000
.*                                                                      17092100
.*  WORKREG WAS SPECIFIED                                               17092200
.*                                                                      17092300
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 17092400
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 17092500
         AIF   ('&NAME' EQ '').NN3                                 @L8A 17092600
&NAME    DC    0H'0'                                               @L8A 17092700
.NN3     ANOP                                                      @L8A 17092800
         AGO   .SPNCODE                    GENERATE CODE WITH      @L8A 17092900
.*                                         WORKREG                      17093000
.*  BRANCH WAS NOT SPECIFIED                                            17093100
.*                                                                      17093200
.CKWREG  ANOP                                                      @L8A 17093300
         AIF   (T'&WORKREG NE 'O').WARNWK2 WORKREG IGNORED WITHOUT @L8A 17093400
.WRNWKR2 ANOP                                                      @L8A 17093500
         AIF   ('&NAME' EQ '').NN4                                 @L8A 17093600
&NAME    DC    0H'0'                                               @L8A 17093700
.NN4     ANOP                                                      @L8A 17093800
         AGO   .SPNCOD2                    GENERATE CODE WITHOUT   @L8A 17093900
.*                                         WORKREG                      17094000
.SPNCODE ANOP                              WORKREG SPECIFIED       @L8A 17094100
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 17094200
.*                                                                      17094300
.SPNCOD2 ANOP                       WORKREG NOT SPECIFIED          @L8A 17094400
         IAC   15                   SET CONDITION CODE BASED ON    @L8A 17094500
*                                   ASC MODE TO BE USED BY THE IPM      17094600
*                                   INSTRUCTION WHICH FOLLOWS.          17094700
         SAC   0                    SAC TO PRIMARY FOR THE BAKR    @L8A 17094800
         LA    15,&GNAME3           RETURN ADDRESS FOR THE PR      @L8A 17094900
         BSM   15,0                 SET AMODE BIT FOR RETURN ADDR  @L8A 17095000
         BAKR  15,0                 SAVE STATUS ON THE LINKAGE     @L8A 17095100
*                                   STACK AND SET UP RETURN ADDRESS FOR 17095200
*                                   THE PR                              17095300
         IPM   0                    PUT IAC CC BITS INTO REG 0     @L8A 17095400
         SRL   0,20                 SHIFT IAC CC TO BITS 22-23     @L8A 17095500
         L     15,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 17095600
         L     15,1528(15,0)        LOCK MANAGER ENTRY POINT       @L8A 17095700
*                                   ADDRESS                             17095800
         BASSM 14,15                BRANCH TO SERVICE RTN.         @L8A 17095900
         EREG  0,1                  RESTORE REGISTERS 0,1          @L8A 17096000
         PR                         RESTORE STATUS                 @L8A 17096100
&GNAME3  EQU   *                                                   @L8A 17096200
*                                                                       17096300
*    THE ASC-MODE OF THE CALLER HAS BEEN RESTORED TO GENERAL REGISTER   17096400
*    15 BY THE SERVICE ROUTINE FOR USE IN THE SAC INSTRUCTION.          17096500
*                                                                       17096600
         SAC   0(15)                RESTORE ORIGINAL ASC-MODE      @L8A 17096700
         ICM   15,B'1110',PSAFZERO-PSA(0)  CLEAN RETURN CODE FROM  @L8A 17096800
*                                          LOCK MANAGER                 17096900
*                                                                  @L8A 17097000
         AIF   (T'&BRANCH EQ 'O').STOP                             @L8A 17097100
*                                                                       17097200
*    INSTRUCTIONS THAT CHANGE THE CONDITION CODE MAY NOT BE INSERTED    17097300
*    BETWEEN THE LTR AND THE RESULTING BRANCH WHICH IS GENERATED.       17097400
*                                                                       17097500
         LTR   15,15                                               @L8A 17097600
         LR    15,&WORKREG(1)       RESTORE GPR15                  @L8A 17097700
         AIF   ('&BRANCH(1)' EQ 'NOTHELD').SPIN03                  @L8A 17097800
         BZ    &BRANCH(2)           BRANCH AT LEAST ONE SPIN LOCK  @L8A 17097900
*                                   WAS HELD   (R.C. IS 0)              17098000
         MEXIT                                                     @L8A 17098100
.SPIN03  ANOP                                                      @L8A 17098200
         BNZ   &BRANCH(2)           BRANCH NO SPIN LOCKS WERE      @L8A 17098300
*                                   HELD       (R.C. IS 4)              17098400
.STOP    ANOP                                                      @L8A 17098500
         MEXIT                                                          17098600
.*                                                                      17098700
.********************************************************************** 17098800
.* BEGINNING OF TEST,TYPE=USER-SPECIFIED LOCK & TYPE=(REG) PROCESSING * 17098900
.********************************************************************** 17099000
.*                                                                      17099100
.TSTADR  ANOP                                                           17099200
         AIF   (T'&LOCK NE 'O').TERR009                            @P2C 17099300
         AIF   (T'&ADDR EQ 'O').TSTTYPE                            @L8A 17099400
         AIF   ('&ADDR'(1,1) NE '(').TSTBADR                            17099500
         AIF   ('&ADDR'(K'&ADDR,1) NE ')').TSTBADR                 @L8C 17099600
.*                                                                      17099700
.TSTTYPE ANOP                                                  @G860PXA 17099800
&PSAPTR  SETA  0              CLHT SELECTED                        @L8A 17099900
&BYTE    SETA  0              CLHS BYTE 0 SELECTED             @G860PXA 17100000
&OFSET   SETA  96             CLHT ENTRY FOR CPU LOCK          @G860PXA 17100100
&MASK    SETA  128            CLHS POSITION FOR CPU LOCK       @G860PXA 17100200
         AIF   ('&TYPE' EQ 'CPU').TALOC                            @L8C 17100300
.*                                                             @G860PXA 17100400
&OFSET   SETA  80             CLHT ENTRY FOR RSM LOCK          @G860PXA 17100500
&MASK    SETA  8              CLHS POSITION FOR RSM LOCK       @G860PXA 17100600
         AIF   ('&TYPE' EQ 'RSM').TNMSYS1                          @L8C 17100700
.*                                                             @G860PXA 17100800
&OFSET   SETA  84             CLHT ENTRY FOR TRACE LOCK        @G860PXA 17100900
&MASK    SETA  4              CLHS POSITION FOR TRACE LOCK     @G860PXA 17101000
         AIF   ('&TYPE' EQ 'TRACE').TNMSYS1                        @L8C 17101100
.*                                                                 @D1A 17101200
&OFSET   SETA  88             CLHT ENTRY FOR IOS LOCK              @D1A 17101300
&MASK    SETA  2              CLHS POSITION FOR IOS LOCK           @D1A 17101400
         AIF   ('&TYPE' EQ 'IOS').TNMSYS1                          @L8C 17101500
.*                                                             @G860PXA 17101600
&BYTE    SETA  1              CLHS BYTE 1 SELECTED             @G860PXA 17101700
&OFSET   SETA  72             CLHT ENTRY FOR RSMCM LOCK        @G860PXJ 17101800
&MASK    SETA  16             CLHS POSITION FOR RSMCM LOCK     @G860PXJ 17101900
         AIF   ('&TYPE' EQ 'RSMCM').TNAMC1                         @L8C 17102000
.*                                                             @G860PXA 17102100
&OFSET   SETA  44             CLHT ENTRY FOR RSMGL LOCK        @ZMC0568 17102200
&MASK    SETA  8              CLHS POSITION FOR RSMGL LOCK     @G860PXJ 17102300
         AIF   ('&TYPE' EQ 'RSMGL').TNAMC1                         @L8C 17102400
.*                                                             @G860PXA 17102500
&OFSET   SETA  48             CLHT ENTRY FOR VSMFIX LOCK       @G860PXA 17102600
&MASK    SETA  4              CLHS POSITION FOR VSMFIX LOCK    @G860PXA 17102700
         AIF   ('&TYPE' EQ 'VSMFIX').TNMSYS1                       @L8C 17102800
.*                                                             @G860PXA 17102900
&OFSET   SETA  52             CLHT ENTRY FOR ASMGL LOCK        @G860PXA 17103000
&MASK    SETA  2              CLHS POSITION FOR ASMGL LOCK     @G860PXA 17103100
         AIF   ('&TYPE' EQ 'ASMGL').TNAMC1                         @L8C 17103200
.*                                                             @G860PXA 17103300
&OFSET   SETA  56             CLHT ENTRY FOR RSMST LOCK        @G860PXA 17103400
&MASK    SETA  1              CLHS POSITION FOR RSMST LOCK     @G860PXA 17103500
         AIF   ('&TYPE' EQ 'RSMST').TNAMC1                         @L8C 17103600
.*                                                             @G860PXA 17103700
&BYTE    SETA  2              CLHS BYTE 2 SELECTED             @G860PXA 17103800
&OFSET   SETA  60             CLHT ENTRY FOR RSMXM LOCK        @G860PXA 17103900
&MASK    SETA  128            CLHS POSITION FOR RSMXM LOCK     @G860PXA 17104000
         AIF   ('&TYPE' EQ 'RSMXM').TNAMC1                         @L8C 17104100
.*                                                             @G860PXA 17105600
&OFSET   SETA  64             CLHT ENTRY FOR RSMAD LOCK        @G860PXA 17106000
&MASK    SETA  64             CLHS POSITION FOR RSMAD LOCK     @G860PXA 17106400
         AIF   ('&TYPE' EQ 'RSMAD').TNAMC1                         @L8C 17106800
.*                                                             @G860PXA 17107200
&OFSET   SETA  68             CLHT ENTRY FOR VSMPAG LOCK       @G860PXA 17107600
&MASK    SETA  32             CLHS POSITION FOR VSMPAG LOCK    @G860PXA 17108000
         AIF   ('&TYPE' EQ 'VSMPAG').TNMSYS1                       @L8C 17108400
.*                                                             @G860PXA 17108800
&OFSET   SETA  0              CLHT ENTRY FOR DISP LOCK         @G860PXA 17109000
&MASK    SETA  16             CLHS POSITION FOR DISP LOCK      @G860PXA 17109200
         AIF   ('&TYPE' EQ 'DISP').TNMSYS1                         @L8C 17109400
.*                                                                      17109600
&OFSET   SETA  4              CLHT ENTRY FOR ASM LOCK                   17109800
&MASK    SETA  8              CLHS POSITION FOR ASM LOCK                17110000
         AIF   ('&TYPE' EQ 'ASM').TNAMC1                           @L8C 17110200
.*                                                                      17110400
&OFSET   SETA  8              CLHT ENTRY FOR SALLOC LOCK                17110600
&MASK    SETA  4              CLHS POSITION FOR SALLOC LOCK             17110800
         AIF   ('&TYPE' EQ 'SALLOC').TNMSYS1                       @L8C 17111000
.*                                                                      17111200
&OFSET   SETA  12             CLHT ENTRY FOR IOSYNCH LOCK               17111400
&MASK    SETA  2              CLHS POSITION FOR IOSYNCH LOCK            17111600
         AIF   ('&TYPE' EQ 'IOSYNCH').TNAMC1                       @L8C 17111800
.*                                                                      17112000
&OFSET   SETA  16             CLHT ENTRY FOR RSMDS LOCK                 17112200
&MASK    SETA  1              CLHS POSITION FOR RSMDS LOCK              17112400
         AIF   ('&TYPE' EQ 'IOSCAT').INVTYP                    @G860PXB 17112600
         AIF   ('&TYPE' EQ 'RSMDS').TNAMC1                         @L8C 17112800
.*                                                                      17113000
&BYTE    SETA  3              CLHS BYTE 3 SELECTED                      17113200
&OFSET   SETA  20             CLHT ENTRY FOR IOSUCB LOCK                17113400
&MASK    SETA  128            CLHS POSITION FOR IOSUCB LOCK             17113600
         AIF   ('&TYPE' EQ 'IOSUCB').TNAMC1                             17113800
.*                                                                      17114000
&OFSET   SETA  36             CLHT ENTRY FOR TPACBDEB LOCK              17114200
&MASK    SETA  8              CLHS POSITION FOR TPACBDEB LOCK           17114400
         AIF   ('&TYPE' EQ 'IOSLCH').INVTYP                    @G860PXB 17114600
         AIF   ('&TYPE' EQ 'TPNCB').INVTYP                         @L8C 17114800
         AIF   ('&TYPE' EQ 'TPDNCB').INVTYP                        @L8C 17115000
         AIF   ('&TYPE' EQ 'TPACBDEB').TNAMC1                      @L8C 17115200
.*                                                                      17115400
&OFSET   SETA  40             CLHT ENTRY FOR SRM LOCK                   17115600
&MASK    SETA  4              CLHS POSITION FOR SRM LOCK                17115800
         AIF   ('&TYPE' EQ 'SRM').TNMSYS1                          @L8C 17116000
.*                                                                      17116200
&OFSET   SETA  104            CLHT ENTRY FOR CMS LOCK                   17116400
&MASK    SETA  2              CLHS POSITION FOR CMS LOCK                17116600
         AIF   ('&TYPE' EQ 'CMS').TNMSYS1                          @L8C 17116800
.*                                                                      17117000
&OFSET   SETA  108            CLHT ENTRY FOR LOCAL LOCK                 17117200
&MASK    SETA  1              CLHS POSITION FOR LOCAL LOCK              17117400
         AIF   ('&TYPE' EQ 'LOCAL').TLOCAL                         @L8C 17117600
         AIF   ('&TYPE' EQ 'CML').TCMLCK                           @L8C 17117800
         AIF   ('&TYPE' EQ 'ALOCAL').TALOC                         @L8C 17118000
         AIF   ('&TYPE'(1,1) EQ '(').CKRTP                         @L8C 17118200
         AGO   .NEWLKS        TYPE IS NOT (REG)                    @L8A 17118400
.CKRTP   ANOP                                                      @L8A 17118600
         AIF   ('&TYPE'(K'&TYPE,1) EQ ')').TREGC                   @L8C 17118800
         AGO   .INVTYP                                             @L8A 17119000
.*                                                                      17119200
.NEWLKS  ANOP                                                      @L8A 17119400
&PSAPTR  SETA  1              ECLHT SELECTED                       @L8A 17119600
&BYTE    SETA  0              CLHSE BYTE 0 SELECTED                @L8A 17119800
&OFSET   SETA  0              ECLHT ENTRY FOR BMFLSD LOCK          @L7A 17120000
&MASK    SETA  128            CLHSE POSITION FOR BMFLSD LOCK       @L7A 17120200
         AIF   ('&TYPE' EQ 'BMFLSD').TNAMC2                        @L7A 17120400
.*                                                                 @L7A 17120600
&OFSET   SETA  4              ECLHT ENTRY FOR XCFDS LOCK           @L5A 17120800
&MASK    SETA  64             CLHSE POSITION FOR XCFDS LOCK        @L5A 17121000
         AIF   ('&TYPE' EQ 'XCFDS').TNAMC2                         @L5A 17121200
.*                                                                 @L5A 17121400
&OFSET   SETA  8              ECLHT ENTRY FOR XCFRES LOCK          @L5A 17121600
&MASK    SETA  32             CLHSE POSITION FOR XCFRES LOCK       @L5A 17121800
         AIF   ('&TYPE' EQ 'XCFRES').TNAMC2                        @L5A 17122000
.*                                                                 @L5A 17122200
&OFSET   SETA  12             ECLHT ENTRY FOR XCFQ LOCK            @L5A 17122400
&MASK    SETA  16             CLHSE POSITION FOR XCFQ LOCK         @L5A 17122600
         AIF   ('&TYPE' EQ 'XCFQ').TNMSYS2                         @L5A 17122800
.*                                                                 @L5A 17123000
&OFSET   SETA  16             ECLHT ENTRY FOR ETRSET LOCK          @L6A 17123200
&MASK    SETA  8              CLHSE POSITION FOR ETRSET LOCK       @L6A 17123400
         AIF   ('&TYPE' EQ 'ETRSET').TNMSYS2                       @L6A 17123600
.*                                                                      17123700
&OFSET   SETA  20             ECLHT ENTRY FOR IXLSCH LOCK          @LBC 17123800
&MASK    SETA  4              CLHSE POSITION FOR IXLSCH LOCK       @LBC 17123900
         AIF   ('&TYPE' EQ 'IXLSCH').TNAMC2                        @LBC 17124000
.*                                                                      17124100
&OFSET   SETA  24             ECLHT ENTRY FOR IXLSHR LOCK          @LBC 17124200
&MASK    SETA  2              CLHSE POSITION FOR IXLSHR LOCK       @LBC 17124300
         AIF   ('&TYPE' EQ 'IXLSHR').TNMSYS2                       @LBC 17124400
.*                                                                      17124500
&OFSET   SETA  28             ECLHT ENTRY FOR IXLDS LOCK           @LAA 17124600
&MASK    SETA  1              CLHSE POSITION FOR IXLDS LOCK        @LAA 17124700
         AIF   ('&TYPE' EQ 'IXLDS').TNAMC2                         @LAA 17124800
.*                                                                      17124900
&BYTE    SETA  1              CLSHE BYTE 1 SELECTED                @L9A 17125000
&OFSET   SETA  32             ECLHT ENTRY FOR IXLSHELL LOCK        @LBC 17125100
&MASK    SETA  128            CLHSE POSITION FOR IXLSHELL LOCK     @LBC 17125200
         AIF   ('&TYPE' EQ 'IXLSHELL').TNAMC2                      @LBC 17125300
.*                                                                      17125400
&OFSET   SETA  36             ECLHT ENTRY FOR IOSULUT LOCK         @L9A 17125500
&MASK    SETA  64             CLHSE POSITION FOR IOSULUT LOCK      @L9A 17125600
         AIF   ('&TYPE' EQ 'IOSULUT').TNMSYS2                      @L9A 17125700
.*                                                                      17125800
&OFSET   SETA  40             ECLHT ENTRY FOR IXLREQST LOCK        @01A 17125900
&MASK    SETA  32             CLHSE POSITION FOR IXLREQST LOCK     @01A 17126000
         AIF   ('&TYPE' EQ 'IXLREQST').TNAMC2                      @01A 17126300
.*                                                                      17126600
&OFSET   SETA  44             ECLHT ENTRY FOR WLMRES LOCK          @LCA 17126900
&MASK    SETA  16             CLHSE POSITION FOR WLMRES LOCK       @LCA 17127200
         AIF   ('&TYPE' EQ 'WLMRES').TNAMC2                        @LCA 17127500
.*                                                                      17127800
&OFSET   SETA  48             ECLHT ENTRY FOR WLMQ LOCKS           @LCA 17128100
&MASK    SETA  8              CLHSE POSITION FOR WLMQ LOCKS        @LCA 17128400
         AIF   ('&TYPE' EQ 'WLMQ').TNMSYS2                         @LCA 17128700
.*                                                                      17128800
&OFSET   SETA  52             ECLHT ENTRY FOR CONTEXT LOCKS        @LCA 17128900
&MASK    SETA  4              CLHSE POSITION FOR CONTEXT LOCK      @LCA 17129000
         AIF   ('&TYPE' EQ 'CONTEXT').TNAMC2                       @LCA 17129100
.*                                                                      17129200
&OFSET   SETA  56             ECLHT ENTRY FOR REGSRV LOCKS         @LCA 17129300
&MASK    SETA  2              CLHSE POSITION FOR REGSRV LOCKS      @LCA 17129400
         AIF   ('&TYPE' EQ 'REGSRV').TNMSYS2                       @LCA 17129500
         AGO   .INVTYP                                                  17129600
.********************************************************************** 17129700
.*                                                                      17129800
.********************************************************************** 17129900
.***********  THIS SECTION IS FOR PRE-4.1.0 LOCK PROCESSING  ********** 17130200
.********************************************************************** 17130500
.*                                                                      17130800
.TNMSYS1 ANOP                                                           17131100
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 17131400
         AIF   (NOT('&TYPE' EQ 'TRACE' OR '&TYPE' EQ 'RSM' OR '&TYPE'  +17131700
               EQ 'IOS')).TNAMC1                                   @D1C 17132000
.*                                                                      17132300
.*  CHECK PRE-4.1.0 SHR/EXCL LOCKS                                      17132600
.*                                                                      17132900
         AIF   (T'&SCOPE EQ 'O').TNAMC1A                       @G860PXA 17133200
.*                                                                      17133500
.*  SCOPE WAS SPECIFIED                                                 17133800
.*                                                                      17134100
         AIF   ('&SCOPE' NE 'SHR' AND '&SCOPE' NE 'EXCL').INVSCOP       17134400
         AGO   .TNAMC1A                                        @G860PXA 17134700
.*                                                                      17135000
.TNAMC1  ANOP                                                           17135600
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 17135700
.TNAMC1A ANOP                                                           17135800
         AIF   (T'&REGS NE 'O').NOREGS                             @L8C 17135900
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 17136000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 17136100
         AIF   (T'&BRANCH EQ 'O').TSTW                             @L8A 17136200
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 17136300
         AIF   ('&BRANCH(1)' EQ 'HELD').NAMCK                      @L8A 17136400
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 17136500
         AGO   .NAMCK                                              @L8A 17136600
.TSTW    ANOP                                                      @L8A 17136700
         AIF   (T'&WORKREG NE 'O').WARNWKA                         @L8A 17136800
.NAMCK   ANOP                                                      @L8A 17136900
         AIF   ('&NAME' EQ '').TNAMNN                                   17137000
&NAME    DC    0H'0'                                                    17137100
.TNAMNN  ANOP                                                           17137200
         AIF   (T'&BRANCH NE 'O').TNAMNB                                17137300
         SR    15,15                PRESET LOCK HELD RETURN CODE        17137400
.TNAMNB  ANOP                                                           17137500
         AIF   (T'&ADDR EQ 'O').TSCOPE3                        @G860PXA 17137600
.*                                                                      17137700
.*  MUST BE A CLASS LOCK WITH ADDR KEYWORD SPECIFIED                    17137800
.*                                                                      17137900
         C     &ADDR(1),PSACLHT-PSA+&OFSET.(0,0)  CHECK LKWD ADDR       17138000
*                                                 IN CLHT      @ZA35343 17138100
         AIF   (T'&BRANCH EQ 'O').TNAMARC                               17139200
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAMABH                         17139600
         BNE   &BRANCH(2)           BRANCH ON NOTHELD                   17140000
         MEXIT                                                          17140400
.TNAMABH ANOP                                                           17140600
         BE    &BRANCH(2)           BRANCH ON HELD                      17140800
         MEXIT                                                          17141200
.TNAMARC ANOP                                                           17141500
         BE    *+8                                                      17141800
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE       17142100
         MEXIT                                                          17142400
.*                                                                      17142600
.TSCOPE3 ANOP                                                           17142800
         AIF   (T'&SCOPE EQ 'O').TNAMTM                        @G860PXA 17143000
         AIF   ('&SCOPE' EQ 'EXCL').TEXCL1                     @G860PXA 17143200
.*                                                                      17143400
.************ PROCESS SCOPE=SHR REQUEST ********************** @G860PXA 17143600
.*                                                                      17143800
         TM    PSACLHT-PSA+&OFSET.(0),X'80' IS LOCK HELD SHR?  @G860PXA 17144000
         AIF   (T'&BRANCH EQ 'O').GOTOG                        @G860PXA 17144200
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE5                @G860PXA 17144800
.GOTOG   ANOP                                                  @G860PXA 17145100
         BO    &LABEL.G             BRANCH IF NOT HELD WITH    @G860PXA 17145400
*                                   REQUESTED SCOPE                     17145700
.*****************************************************************      17146000
.*  IF THE HIGH ORDER BIT OF THE LOCKWORD IN THE CLHT IS OFF,    *      17146300
.*  THE LOCK MAY OR MAY NOT BE HELD AS SHARED.  THE CORRECT BIT  *      17146600
.*  IN PSACLHS MUST BE INTERROGATED TO BE SURE.                  *      17146900
.*****************************************************************      17147200
         AGO   .TNAMTM1                                            @L8C 17147500
.TSCOPE5 ANOP                                                  @G860PXA 17147800
         BO    &BRANCH(2)           BRANCH ON NOT HELD         @G860PXA 17148100
.*                                                                      17148400
.TNAMTM1 ANOP                                                           17148700
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  TEST BIT IN        @G860PXA 17149000
*                                           CURRENT LOCK HELD STRING    17149300
         AIF   (T'&BRANCH EQ 'O').TNAMRC1                          @L8C 17149600
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAMBH1                    @L8C 17149900
         BZ    &BRANCH(2)           BRANCH ON NOT HELD         @G860PXA 17150200
         MEXIT                                                     @L8A 17150500
.*                                                                      17150800
.TNAMBH1 ANOP                                                      @L8C 17151100
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 17151400
&LABEL.G DC    0H'0'                BRANCH LABEL               @G860PXA 17151700
         MEXIT                                                          17153600
.TNAMRC1 ANOP                                                           17154000
         BO    *+8                  BRANCH HELD                         17154400
&LABEL.G DC    0H'0'                BRANCH LABEL               @G860PXA 17154800
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G860PXA 17155200
         MEXIT                                                          17156000
.*                                                                      17206000
.************ PROCESS SCOPE=EXCL REQUEST *********************          17256000
.*                                                                      17306000
.TEXCL1  ANOP                                                  @G860PXA 17356000
         TM    PSACLHT-PSA+&OFSET.(0),X'80' IS LOCK HELD EXCL? @G860PXA 17406000
         AIF   (T'&BRANCH EQ 'O').TNAMRC2                      @G860PXA 17456000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE6                @G860PXA 17506000
         BO    &BRANCH(2)           BRANCH ON HELD             @G860PXA 17556000
         MEXIT                                                          17606000
.*                                                                      17656000
.TSCOPE6 ANOP                                                           17706000
         BZ    &BRANCH(2)           BRANCH ON NOTHELD          @G860PXA 17756000
         MEXIT                                                          17806000
.*                                                                      17856000
.TNAMRC2 ANOP                                                           17906000
         BO    *+8                  BRANCH ON HELD                      17956000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN   @G860PXA 18006000
*                                   CODE                                18056000
         MEXIT                                                          18106000
.*                                                                      18156000
.*************************************************************          18206000
.*******       PROCESS GARDEN VARIETY LOCK, OR         *******          18256000
.*******       CMS LOCK, OR                            *******          18306000
.*******       CLASS LOCK WITHOUT ADDR KEYWORD, OR     *******          18356000
.*******       SHR/EXCL LOCK WITHOUT SCOPE KEYWORD     *******          18406000
.*******       TEST REQUESTS                           *******          18456000
.*************************************************************          18506000
.*                                                                      18556000
.TNAMTM  ANOP                                                  @G860PXA 18606000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  IS LOCK HELD?      @G860PXA 18656000
         AIF   (T'&BRANCH EQ 'O').TNAMRC3                      @G860PXA 18706000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE9                @G860PXA 18756000
         BO    &BRANCH(2)           BRANCH ON HELD             @G860PXA 18806000
         MEXIT                                                          18856000
.*                                                                      18906000
.TSCOPE9 ANOP                                                           18956000
         BZ    &BRANCH(2)           BRANCH ON NOTHELD          @G860PXA 19006000
         MEXIT                                                          19056000
.*                                                                      19106000
.TNAMRC3 ANOP                                                           19156000
         BO    *+8                                                      19206000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN   @G860PXA 19256000
*                                   CODE                                19306000
         MEXIT                                                          19356000
.*                                                                      19406000
.******************  END PRE-4.1.0 LOCK PROCESSING  ******************* 19456000
.*                                                                      19506000
.********************************************************************** 19556000
.***   THIS SECTION IS FOR 4.1.0 AND LATER LOCK PROCESSING  *********** 19606000
.********************************************************************** 19656000
.*                                                                      19706000
.TNMSYS2 ANOP                                                           19756000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 19806000
         AIF   (NOT('&TYPE' EQ 'XCFQ' OR                               +19856000
               '&TYPE' EQ 'WLMQ' OR                                    +19872600
               '&TYPE' EQ 'REGSRV' OR                                  +19880900
               '&TYPE' EQ 'IOSULUT' OR                                 +19889300
               '&TYPE' EQ 'IXLSHR')).TNAMC2                        @LCC 19922600
.*                                                                      19956000
.*  CHECK SHR/EXCL LOCKS                                           @L8A 20006000
.*                                                                      20056000
         AIF   (T'&SCOPE EQ 'O').TNAMC2B                           @L8A 20106000
.*                                                                      20156000
.*  SCOPE WAS SPECIFIED                                            @L8A 20206000
.*                                                                      20256000
         AIF   ('&SCOPE' NE 'SHR' AND '&SCOPE' NE 'EXCL').INVSCOP  @L8A 20306000
         AGO   .TNAMC2B                                            @L8A 20356000
.*                                                                      20406000
.TNAMC2  ANOP                                                      @L8A 20456000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 20506000
.TNAMC2B ANOP                                                      @L8A 20556000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 20606000
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 20656000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8A 20706000
         AIF   (T'&BRANCH EQ 'O').CKWREG1                          @L8A 20756000
.*                                                                      20806000
.*  BRANCH WAS SPECIFIED                                                20856000
.*                                                                      20906000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 20956000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAM02                     @L8A 21006000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                      21056000
.*                                                                      21106000
.*  BRANCH OPERAND VALID                                                21156000
.*                                                                      21206000
.TNAM02  ANOP                                                           21256000
         AIF   (T'&WORKREG EQ 'O').NOWKREG                         @L8A 21306000
.*                                                                      21356000
.*  WORKREG WAS SPECIFIED                                               21406000
.*                                                                      21456000
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 21506000
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 21556000
         AGO   .WRNWKRB                                            @L8A 21606000
.CKWREG1 ANOP                                                      @L8A 21656000
         AIF   (T'&WORKREG NE 'O').WARNWKB                         @L8A 21706000
.WRNWKRB ANOP                                                      @L8A 21756000
         AIF   ('&NAME' EQ '').TNAMNN2                             @L8A 21806000
&NAME    DC    0H'0'                                               @L8A 21856000
.TNAMNN2 ANOP                                                      @L8A 21906000
         AIF   (T'&ADDR EQ 'O').TSCOP32                            @L8A 21956000
.*                                                                      22006000
.*  MUST BE A CLASS LOCK WITH ADDR KEYWORD SPECIFIED                    22056000
.*                                                                      22106000
         AIF   (T'&BRANCH EQ 'O').NOLOAD1                          @L8A 22156000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 22206000
.NOLOAD1 ANOP                                                      @L8A 22256000
         L     15,PSAECLTP-PSA(0)   ADDRESS OF ECLHT               @L8A 22306000
         C     &ADDR(1),&OFSET.(15,0) CHECK LKWD ADDR IN ECLHT     @L8A 22356000
         AIF   (T'&BRANCH EQ 'O').TNMARC2                          @L8A 22406000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 22456000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNMABH2                    @L8A 22506000
         BNE   &BRANCH(2)           BRANCH ON NOTHELD              @L8A 22556000
         MEXIT                                                     @L8A 22606000
.TNMABH2 ANOP                                                      @L8A 22656000
         BE    &BRANCH(2)           BRANCH ON HELD                 @L8A 22706000
         MEXIT                                                     @L8A 22756000
.TNMARC2 ANOP                                                      @L8A 22806000
         BE    *+12                                                @L8A 22856000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE  @L8A 22906000
         B     &LABEL.F                                            @L8A 22956000
         LA    15,0(0,0)            SET LOCK HELD RETURN CODE      @L8A 23006000
&LABEL.F DC    0H'0'                BRANCH LABEL                   @L8A 23056000
         MEXIT                                                     @L8A 23106000
.*                                                                      23156000
.TSCOP32 ANOP                                                      @L8A 23206000
         AIF   (T'&SCOPE EQ 'O').TNAMTMA                           @L8A 23256000
         AIF   ('&SCOPE' EQ 'EXCL').TEXCL2                         @L8A 23306000
.*                                                                      23356000
.************ PROCESS SCOPE=SHR REQUEST **********************          23406000
.*                                                                      23456000
         AIF   (T'&BRANCH EQ 'O').SKPLD                            @L8A 23506000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 23556000
         AIF   ('&SYSASCE' EQ 'P').SKPLD                           @L8A 23606000
         CPYA  &WORKREG(1),15       SAVE AR15 VALUE                @L8A 23656000
.SKPLD   ANOP                                                      @L8A 23706000
         L     15,PSAECLTP-PSA(0)   ADDRESS OF ECLHT               @L8A 23756000
         AIF   ('&SYSASCE' EQ 'P').NOART1                          @L8A 23806000
         LAE   15,0(15,0)           GET ALET OF 0                  @L8A 23856000
.NOART1  ANOP                                                      @L8A 23906000
         TM    &OFSET.(15),X'80'    IS LOCK HELD SHR?              @L8A 23956000
         AIF   (T'&BRANCH NE 'O').NORC1                            @L8A 24006000
         LA    15,0(0,0)            PRESET SUCCESSFUL RETURN CODE  @L8A 24056000
         AGO   .GOTOG2                                             @L8A 24106000
.NORC1   ANOP                                                      @L8A 24156000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 24206000
         AIF   ('&SYSASCE' EQ 'P').NOART2                          @L8A 24256000
         CPYA  15,&WORKREG(1)       RESTORE AR15 VALUE             @L8A 24306000
.NOART2  ANOP                                                      @L8A 24356000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP52                    @L8A 24406000
.GOTOG2  ANOP                                                      @L8A 24456000
         BO    &LABEL.L             BRANCH IF NOT HELD WITH        @L8A 24506000
*                                   REQUESTED SCOPE                     24556000
.*****************************************************************      24606000
.*  IF THE HIGH ORDER BIT OF THE LOCKWORD IN THE ECLHT IS OFF,   *      24656000
.*  THE LOCK MAY OR MAY NOT BE HELD AS SHARED.  THE CORRECT BIT  *      24706000
.*  IN PSACLHSE MUST BE INTERROGATED TO BE SURE.                 *      24756000
.*****************************************************************      24806000
         AGO   .TNMTM1B                                            @L8A 24856000
.TSCOP52 ANOP                                                      @L8A 24906000
         BO    &BRANCH(2)           BRANCH ON NOT HELD             @L8A 24956000
.*                                                                      25006000
.TNMTM1B ANOP                                                      @L8A 25056000
         TM    PSACLHSE-PSA+&BYTE.(0),&MASK IS LOCK REALLY HELD?   @L8A 25106000
         AIF   (T'&BRANCH EQ 'O').TNMRC12                          @L8A 25156000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNMBH12                    @L8A 25206000
         BZ    &BRANCH(2)           BRANCH ON NOT HELD             @L8A 25256000
         MEXIT                                                     @L8A 25306000
.*                                                                      25356000
.TNMBH12 ANOP                                                      @L8A 25406000
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 25456000
&LABEL.L DC    0H'0'                BRANCH LABEL                   @L8A 25506000
         MEXIT                                                     @L8A 25556000
.TNMRC12 ANOP                                                      @L8A 25606000
         BO    *+8                  BRANCH HELD                    @L8A 25656000
&LABEL.L DC    0H'0'                BRANCH LABEL                   @L8A 25706000
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.         @L8A 25756000
         MEXIT                                                     @L8A 25806000
.*                                                                      25856000
.************ PROCESS SCOPE=EXCL REQUEST *********************          25906000
.*                                                                      25956000
.TEXCL2  ANOP                                                      @L8A 26006000
         AIF   (T'&BRANCH EQ 'O').SKPLD1                           @L8A 26056000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 26106000
         AIF   ('&SYSASCE' EQ 'P').SKPLD1                          @L8A 26156000
         CPYA  &WORKREG(1),15       SAVE AR15 VALUE                @L8A 26206000
.SKPLD1  ANOP                                                      @L8A 26256000
         L     15,PSAECLTP-PSA(0)   ADDRESS OF ECLHT               @L8A 26306000
         AIF   ('&SYSASCE' EQ 'P').NOART3                          @L8A 26356000
         LAE   15,0(15,0)           GET ALET OF 0                  @L8A 26406000
.NOART3  ANOP                                                      @L8A 26456000
         TM    &OFSET.(15),X'80'    IS LOCK HELD EXCL?             @L8A 26506000
         AIF   (T'&BRANCH NE 'O').NORC2                            @L8A 26556000
         LA    15,0(0,0)            PRESET LOCK HELD R.C.          @L8A 26606000
         AGO   .TNMRC22                                            @L8A 26656000
.NORC2   ANOP                                                      @L8A 26706000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 26756000
         AIF   ('&SYSASCE' EQ 'P').NOART4                          @L8A 26806000
         CPYA  15,&WORKREG(1)       RESTORE AR15 VALUE             @L8A 26856000
.NOART4  ANOP                                                      @L8A 26906000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP62                    @L8A 26956000
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 27006000
         MEXIT                                                     @L8A 27056000
.*                                                                      27106000
.TSCOP62 ANOP                                                      @L8A 27156000
         BZ    &BRANCH(2)           BRANCH ON NOTHELD              @L8A 27206000
         MEXIT                                                     @L8A 27256000
.*                                                                      27306000
.TNMRC22 ANOP                                                      @L8A 27356000
         BO    *+8                  BRANCH ON HELD                 @L8A 27406000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE  @L8A 27456000
         MEXIT                                                     @L8A 27506000
.*                                                                      27556000
.************ PROCESS GARDEN VARIETY TEST REQUEST ************          27606000
.*                                                                      27656000
.TNAMTMA ANOP                                                      @L8A 27706000
         AIF   (T'&BRANCH NE 'O').NORC3                            @L8A 27756000
         SR    15,15                PRESET LOCK HELD R.C.          @L8A 27806000
.NORC3   ANOP                                                      @L8A 27856000
         TM    PSACLHSE-PSA+&BYTE.(0),&MASK IS LOCK HELD?          @L8A 27906000
         AIF   (T'&BRANCH EQ 'O').TNMRC32                          @L8A 27956000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP92                    @L8A 28006000
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 28056000
         MEXIT                                                     @L8A 28106000
.*                                                                      28156000
.TSCOP92 ANOP                                                      @L8A 28206000
         BZ    &BRANCH(2)           BRANCH ON NOTHELD              @L8A 28256000
         MEXIT                                                     @L8A 28306000
.*                                                                      28356000
.TNMRC32 ANOP                                                      @L8A 28406000
         BO    *+8                                                 @L8A 28456000
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.         @L8A 28506000
         MEXIT                                                     @L8A 28556000
.*                                                                      28606000
.*************************************************************          28656000
.*   BEGINNING OF TEST,TYPE=LOCAL LOCK PROCESSING            *          28706000
.*************************************************************          28756000
.*                                                                      28806000
.TLOCAL  ANOP                                                           28856000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 28906000
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 28956000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8A 29006000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 29056000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 29106000
         AIF   ('&NAME' EQ '').NN6                                 @L8A 29156000
&NAME    DC    0H'0'                                               @L8A 29206000
.NN6     ANOP                                                      @L8A 29256000
         AIF   (T'&BRANCH NE 'O').CHECKIT                          @L8C 29306000
.*                                                                      29356000
.*  BRANCH WAS NOT SPECIFIED                                            29406000
.*                                                                      29456000
         AIF   (T'&WORKREG NE 'O').WARNWKE                         @L8A 29506000
.WRNWKRE ANOP                                                      @L8A 29556000
         SR    15,15                PRESET LOCK HELD R.C.          @L8A 29606000
.*                                                                      29656000
.CHECKIT ANOP                                                      @L8A 29706000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  IS LOCAL/CML HELD?     @L8C 29756000
         AIF   (T'&BRANCH EQ 'O').TLOCRC                       @G387PXR 29806000
         AIF   ('&BRANCH(1)' EQ 'HELD').TLOCBH                 @G387PXR 29856000
         BZ    &BRANCH(2)           BRANCH ON NOTHELD          @G387PXR 29906000
         AGO   .TLOCCL                                         @G387PXR 29956000
.*                                                                      30006000
.TLOCRC  ANOP                                                  @G387PXR 30056000
         BZ    &LABEL.A             BRANCH ON NOTHELD          @G387PXR 30106000
         AGO   .TLOCCL                                         @G387PXR 30156000
.*                                                                      30206000
.TLOCBH  ANOP                                                  @G387PXR 30256000
         BZ    &LABEL.B             BRANCH ON NOTHELD          @G387PXR 30306000
.*                                                                      30356000
.TLOCCL  ANOP                                                  @G387PXR 30406000
         CLC   PSALOCAL-PSA(4,0),PSAFZERO-PSA(0) IS LOCAL LOCK @ZMP0008 30456000
*                                                HELD?                  30506000
         AIF   (T'&BRANCH EQ 'O').TLOCRC1                      @G387PXR 30556000
         AIF   ('&BRANCH(1)' EQ 'HELD').TLOCBH1                @G387PXR 30606000
         BNE   &BRANCH(2)           BRANCH ON NOTHELD          @ZMP0008 30656000
         MEXIT                                                 @G387PXR 30706000
.*                                                                      30756000
.TLOCRC1 ANOP                                                  @G387PXR 30806000
         BE    *+8                  BRANCH ON HELD             @ZMP0008 30856000
&LABEL.A LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G387PXR 30906000
         MEXIT                                                 @G387PXR 30956000
.TLOCBH1 ANOP                                                  @G387PXR 31006000
         BE    &BRANCH(2)           BRANCH ON HELD             @ZMP0008 31056000
&LABEL.B DC    0H'0'                                           @G387PXR 31106000
         MEXIT                                                 @G387PXR 31156000
.*                                                                      31206000
.*************************************************************          31256000
.*   BEGINNING OF TEST,TYPE=(REG) PROCESSING                 *          31306000
.*************************************************************          31356000
.*                                                                      31406000
.TREGC   ANOP                                                           35750000
         AIF   (T'&WORKREG NE 'O').INVWKRG                         @L8A 35795800
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 35841600
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 35887400
         AIF   (T'&ASCB NE 'O').TREGCA                         @G387PXR 35933200
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G387PXR 35979000
         AIF   (T'&REGS EQ 'O').CKB                                @L8A 36024800
         AIF   ('&REGS'(1,1) NE '(').BADREGS                            36070600
         AIF   ('&REGS'(K'&REGS,1) NE ')').BADREGS                      36116400
.CKB     ANOP                                                      @L8A 36162200
         AIF   (T'&BRANCH EQ 'O').TREGCNB                               36208000
         AIF   (T'&REGS EQ 'O').REGREQ                             @L8C 36253800
         AIF   ('&NAME' EQ '').TREGCNN                                  36300000
&NAME    DC    0H'0'                                                    36350000
.TREGCNN LR    &REGS(1),&TYPE(1)    SAVE INPUT STRING                   36400000
         N     &REGS(1),PSACLHS-PSA(0,0) COMPARE TO LOCKS HELD          36450000
*                                       STRING                 @ZA35343 36500000
         CR    &REGS(1),&TYPE(1)    ARE ALL SPECIFIED LOCKS HELD        36550000
         AIF   ('&BRANCH(1)' EQ 'HELD').TREGCBH                         36600000
         BNE   &BRANCH(2)           BRANCH NOT ALL HELD                 36650000
         MEXIT                                                          36700000
.TREGCBH BE    &BRANCH(2)           BRANCH ALL HELD                     36750000
         MEXIT                                                          36800000
.TREGCNB ANOP                                                           36850000
         AIF   ('&NAME' EQ '').TREGRNN                                  36900000
&NAME    DC    0H'0'                                                    36950000
.TREGRNN LR    15,&TYPE(1)          SAVE INPUT STRING                   37000000
&REG1    SETC  '&TYPE(1)'                                      @G387PXR 37050000
         AIF   (T'&REGS EQ 'O').TREGCNR                                 37100000
&REG1    SETC  '&REGS(1)'                                      @G387PXR 37150000
         LR    &REG1,&TYPE(1)       MOVE STRING IN WORK REG    @G387PXR 37200000
.TREGCNR N     &REG1,PSACLHS-PSA(0,0)   COMPARE TO LOCKS HELD  @G387PXR 37250000
*                                       STRING                 @ZA35343 37300000
         XR    15,&REG1             SET RC=0 IF ALL HELD       @G387PXR 37350000
         BZ    *+8                  EXIT ALL HELD                       37400000
         LA    15,4(0,0)            SET RC NOT ALL HELD                 37450000
         MEXIT                                                          37500000
.*                                                                      37500100
.*************************************************************          37500200
.*   BEGINNING OF TEST,TYPE=CML PROCESSING                   *          37500300
.*************************************************************          37500400
.*                                                                      37500500
.TCMLCK  ANOP                                                  @G387PXR 37500600
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 37500700
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 37500800
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 37500900
         AIF   (T'&BRANCH EQ 'O').TSTW2                            @L8A 37501000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 37501100
         AIF   ('&BRANCH(1)' EQ 'HELD').CMLPROC                    @L8A 37501200
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 37501300
         AGO   .CMLPROC                                            @L8A 37501400
.*                                                                      37501500
.TSTW2   ANOP                                                      @L8A 37501600
         AIF   (T'&WORKREG NE 'O').WARNWKC                         @L8A 37501700
.*                                                                      37501800
.CMLPROC ANOP                                                      @L8A 37501900
         AIF   ('&NAME' EQ '').NONAME                              @L8A 37502000
&NAME    DC    0H'0'                                               @L8A 37502100
.NONAME  ANOP                                                      @L8A 37502200
         AIF   (T'&ASCB NE 'O').TCMLAS                         @G387PXR 37502300
         AIF   (T'&LOCKHLD NE 'O').TCMLREG                     @G387PXR 37502400
         AGO   .LKASREQ                                            @L8C 37502500
.*                                                                      37502600
.TCMLAS  ANOP                                                  @G387PXR 37502700
         AIF   (T'&LOCKHLD EQ 'O').TCMLASC                     @G387PXR 37502800
         AGO   .LKHINV                                             @L8C 37502900
.*                                                                      37503000
.TCMLREG ANOP                                                  @G387PXR 37503100
         AIF   ('&LOCKHLD'(1,1) NE '(').BLKHLD                 @G387PXR 37503200
         AIF   ('&LOCKHLD'(K'&LOCKHLD,1) NE ')').BLKHLD        @G387PXR 37503300
         AIF   (T'&BRANCH NE 'O').TCMLR                        @G387PXR 37503400
         SR    15,15                PRESET LOCK HELD R.C.      @G387PXR 37503500
.TCMLR   ANOP                                                           37503600
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 37503700
         AIF   (T'&BRANCH EQ 'O').TCMLRC                       @G387PXR 37503800
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLBH                 @G387PXR 37503900
         BZ    &BRANCH(2)           BRANCH CML NOT HELD        @G387PXR 37504000
         AGO   .TCMLRCL                                        @G387PXR 37504100
.TCMLRC  BZ    &LABEL.A             BRANCH CML NOT HELD        @G387PXR 37504200
         AGO   .TCMLRCL                                        @G387PXR 37504300
.TCMLBH  BZ    &LABEL.X             BRANCH CML NOT HELD        @G387PXR 37504400
.*                                                                      37504500
.TCMLRCL ANOP                                                  @G387PXR 37504600
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0) LOAD CLHT CML     @G387PXR 37504700
         LTR   &LOCKHLD(1),&LOCKHLD(1)       CML LOCK HELD?    @G387PXR 37504800
         AIF   (T'&BRANCH EQ 'O').TCMLRC1                      @G387PXR 37504900
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLRBH                @G387PXR 37505000
         BZ    &BRANCH(2)           BRANCH CML NOT HELD        @G387PXR 37505100
         MEXIT                                                 @G387PXR 37505200
.TCMLRC1 ANOP                                                  @G387PXR 37505300
         BNZ   *+8                  BRANCH - CML HELD          @G387PXR 37505400
&LABEL.A LA    15,4(0,0)            SET R.C.=4 NOT HELD        @G387PXR 37505500
         MEXIT                                                 @G387PXR 37505600
.TCMLRBH BNZ   &BRANCH(2)           BRANCH - LOCK HELD         @G387PXR 37505700
&LABEL.X DC    0H'0'                                           @G387PXR 37505800
         MEXIT                                                 @G387PXR 37505900
.*                                                                      37506000
.TCMLASC ANOP                                                  @G387PXR 37506100
         AIF   ('&ASCB'(1,1) NE '(').TCMLANV                   @G387PXR 37506200
         AIF   ('&ASCB'(K'&ASCB,1) NE ')').TCMLANV             @G387PXR 37506300
         AIF   (T'&BRANCH NE 'O').TCMLASA                      @G387PXR 37506400
         SR    15,15                PRESET LOCK HELD R.C.      @G387PXR 37506500
.TCMLASA ANOP                                                  @G387PXR 37506600
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 37506700
         AIF   (T'&BRANCH EQ 'O').TCMLARC                      @G387PXR 37506800
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLABH                @G387PXR 37506900
         BZ    &BRANCH(2)           BRANCH - LOCK NOT HELD     @G387PXR 37507000
         AGO   .TCMLACL                                        @G387PXR 37507100
.TCMLARC BZ    &LABEL.B             BRANCH - LOCK NOT HELD     @G387PXR 37507200
         AGO   .TCMLACL                                        @G387PXR 37507300
.TCMLABH BZ    &LABEL.C             BRANCH - LOCK NOT HELD     @G387PXR 37507400
.TCMLACL ANOP                                                  @G387PXR 37507500
         CLC   PSAFZERO-PSA(4,0),PSALOCAL-PSA(0)  CML LOCK     @ZMB0398 37507600
*                                                 HELD?        @ZMB0398 37507700
         BNE   &LABEL.D             YES CONTINUE CHECKS        @G382PXR 37507800
         CL    &ASCB(1),PSAAOLD-PSA(0,0)  ASCB SPECIFIED=HOME? @G382PXR 37507900
         AIF   (T'&BRANCH EQ 'O').TCMLAR1                      @G387PXR 37508000
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLAH1                @G387PXR 37508100
         BNE   &BRANCH(2)           BRANCH LOCK NOT HELD       @G387PXR 37508200
         B     &LABEL.C             BRANCH LOCK HELD           @G382PXR 37508300
         AGO   .TCMLAC1             CONTINUE CHECKS            @G382PXR 37508400
.TCMLAR1 ANOP                                                  @G382PXR 37508500
         BE    &LABEL.C             BRANCH LOCK HELD           @G382PXR 37508600
         B     &LABEL.B             BRANCH - SET R.C.          @G382PXR 37508700
         AGO   .TCMLAC1                                        @G382PXR 37508800
.TCMLAH1 ANOP                                                  @G382PXR 37508900
         BE    &BRANCH(2)           BRANCH  LOCK HELD          @G382PXR 37509000
         B     &LABEL.C             BRANCH  LOCK NOT HELD      @G382PXR 37509100
.TCMLAC1 ANOP                                                  @G382PXR 37509200
&LABEL.D CL    &ASCB(1),PSALOCAL-PSA(0,0)  CML LOCK HELD?      @G382PXR 37509300
         AIF   (T'&BRANCH EQ 'O').TCMLAR2                      @G382PXR 37509400
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLAH2                @G382PXR 37509500
         BNE   &BRANCH(2)           BRANCH NOT HELD            @G382PXR 37509600
         AGO   .TCMLEND             END OF CML CHECKS          @G382PXR 37509700
.TCMLAR2 ANOP                                                  @G382PXR 37509800
         BE    &LABEL.C             BRANCH LOCK HELD           @G382PXR 37509900
         AGO   .TCMLAR3                                        @G382PXR 37510000
.TCMLAH2 ANOP                                                  @G382PXR 37510100
         BE    &BRANCH(2)           BRANCH LOCK HELD           @G382PXR 37510200
         AGO   .TCMLEND                                        @G382PXR 37510300
.TCMLAR3 ANOP                                                  @G382PXR 37510400
&LABEL.B LA    15,4(0,0)            LOCK NOT HELD R.C.         @G382PXR 37510500
.TCMLEND ANOP                                                  @G382PXR 37510600
&LABEL.C DC    0H'0'                BRANCH LABEL               @G382PXR 37510700
         MEXIT                                                 @G387PXR 37510800
.*                                                                      37510900
.************************************************************* @G860PXK 37511000
.* BEGINNING OF TEST PROCESSING; TYPE = ALOCAL OR CPU        * @G860PXK 37511100
.************************************************************* @G860PXK 37511200
.*                                                                      37511300
.TALOC   ANOP                                                  @G860PXK 37511400
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 37511500
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 37511600
         AIF   (T'&REGS NE 'O').REGINV4                            @L8A 37511700
.REGRET4 ANOP                                                      @L8A 37511800
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 37511900
         AIF   (T'&BRANCH EQ 'O').TSTCAL                           @L8A 37512000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 37512100
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCNN                    @L8A 37512200
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 37512300
         AGO   .TALOCNN                                            @L8A 37512400
.*                                                                      37512500
.TSTCAL  ANOP                                                      @L8A 37512600
         AIF   (T'&WORKREG NE 'O').WARNWKD                         @L8A 37512700
.TALOCNN ANOP                                                  @G387PXR 37512800
         AIF   ('&NAME' EQ '').TALCNN2                         @G387PXR 37512900
&NAME    DC    0H'0'                                           @G387PXR 37513000
.TALCNN2 ANOP                                                  @G387PXR 37513100
         AIF   (T'&LOCKHLD EQ 'O').TALOCBR                     @G387PXR 37513200
         AIF   ('&LOCKHLD'(1,1) NE '(').BLKHLD                 @G387PXR 37513300
         AIF   ('&LOCKHLD'(K'&LOCKHLD,1) NE ')').BLKHLD        @G387PXR 37513400
         AIF   (T'&BRANCH NE 'O').TALOC1                       @G387PXR 37513500
         LA    15,4(0,0)            PRESET NOT HELD R.C.       @G387PXR 37513600
.TALOC1  ANOP                                                  @G387PXR 37513700
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 37513800
         AIF   (T'&BRANCH EQ 'O').TALOCRC                      @G387PXR 37513900
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCHD                @G387PXR 37514000
         BZ    &BRANCH(2)           BRANCH NOT HELD            @G387PXR 37514100
         AIF   ('&TYPE' EQ 'CPU').TCPU1                        @G860PXK 37514200
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 37514300
*                                   OF LOCKED ADDR. SPACE      @G387PXR 37514400
         MEXIT                                                 @G387PXR 37514500
.TCPU1   ANOP                                                  @G860PXK 37514600
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 37514700
*                                   HELD CNT                            37514800
         MEXIT                                                 @G860PXK 37514900
.TALOCHD ANOP                                                  @G387PXR 37515000
         BZ    &LABEL.A             BRANCH NOT HELD            @G387PXR 37515100
         AIF   ('&TYPE' EQ 'CPU').TCPU2                        @G860PXK 37515200
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 37515300
*                                   OF LOCKED ADDR. SPACE      @G387PXR 37515400
         AGO   .TCPU2A                                         @G860PXK 37515500
.TCPU2   ANOP                                                  @G860PXK 37515600
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 37515700
*                                   HELD CNT                            37515800
.TCPU2A  ANOP                                                  @G860PXK 37515900
         B     &BRANCH(2)           BRANCH HELD                @G387PXR 37516000
&LABEL.A DC    0H'0'                BRANCH LABEL               @G387PXR 37516100
         MEXIT                                                 @G387PXR 37516200
.TALOCRC ANOP                                                  @G387PXR 37516300
         BZ    &LABEL.B             BRANCH NOT HELD            @G387PXR 37516400
         AIF   ('&TYPE' EQ 'CPU').TCPU3                        @G860PXK 37516500
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 37516600
*                                   OF LOCKED ADDR. SPACE      @G387PXR 37516700
         AGO   .TCPU3A                                         @G860PXK 37516800
.TCPU3   ANOP                                                  @G860PXK 37516900
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 37517000
*                                   HELD CNT                            37517100
.TCPU3A  ANOP                                                  @G860PXK 37517200
         SLR   15,15                SET LOCK HELD R.C.         @G387PXR 37517300
&LABEL.B DC    0H'0'                BRANCH LABEL               @G387PXR 37517400
         MEXIT                                                 @G387PXR 37517500
.TALOCBR ANOP                                                  @G387PXR 37517600
.*                                                                      37517700
.* NOTE - TEST - NO LOCKHLD PARM SPECIFIED                     @G860PXK 37517800
.*                                                                      37517900
         AIF   (T'&BRANCH NE 'O').TALOC2                       @G387PXR 37518000
         SLR   15,15                PRESET LOCK HELD R.C.      @G387PXR 37518100
.TALOC2  ANOP                                                  @G387PXR 37518200
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 37518300
         AIF   (T'&BRANCH EQ 'O').TALOCR1                      @G387PXR 37518400
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCH1                @G387PXR 37518500
         BZ    &BRANCH(2)           BRANCH NOT HELD            @G387PXR 37518600
         MEXIT                                                 @G387PXR 37518700
.TALOCH1 ANOP                                                  @G387PXR 37518800
         BNZ   &BRANCH(2)           BRANCH HELD                @G387PXR 37518900
         MEXIT                                                 @G387PXR 37519000
.TALOCR1 ANOP                                                  @G387PXR 37519100
         BNZ   &LABEL.C             BRANCH HELD                @G860PXK 37519200
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G387PXR 37519300
&LABEL.C DC    0H'0'                BRANCH LABEL               @G387PXR 37519400
         MEXIT                                                 @G387PXR 37519500
.ENDIT   ANOP                                                           37519600
         MEXIT                                                 @G860PXD 37519700
.*                                                                      37519800
.*************************************************************          37519900
.*   MESSAGES ISSUED BY SETLOCK PROCESSING                   *          37520000
.*************************************************************          37520100
.*                                                                      37520200
.ADDREQ  ANOP                                                           37520300
.*       IHB001 ADDR OPERAND REQUIRED, NOT SPECIFIED                    37520400
         IHBERMAC 1006,ADDR                                             37520500
         MEXIT                                                          37520600
.ASCBREQ ANOP                                                  @G387PXR 37520700
.*       IHB001 ASCB OPERAND REQUIRED, NOT SPECIFIED           @G387PXR 37520800
         IHBERMAC 1006,ASCB                                    @G387PXR 37520900
         MEXIT                                                 @G387PXR 37521000
.BADREGS ANOP                                                      @L1A 37521100
.*       IHB002 INVALID REGS OPERAND SPECIFIED - XXX                    37521200
         IHBERMAC 1001,REGS,&REGS                                       37521300
         MEXIT                                                          37521400
.CNOTSUP ANOP                                                           37521500
         MNOTE 8,'*** &TYPE CONDITIONAL OBTAIN NOT SUPPORTED'  @G50EPXS 37521600
         MEXIT                                                 @G50EPXS 37521700
.CONDINC ANOP                                                      @L1A 37521800
.*       IHB280 MODE=(COND,IN) INVALID WITH TYPE=&TYPE             @L1A 37521900
&MESSAGE SETC 'MODE=(COND,IN)'                                     @L1A 37522000
&MESSAG2 SETC 'TYPE='.'&TYPE'                                      @L1A 37522100
         IHBERMAC 1020,&MESSAGE,&MESSAG2                           @L1A 37522200
         MEXIT                                                     @L1A 37522300
.EROALOC ANOP                                                  @G387PXR 37522400
.*       IHB280 ALOCAL INVALID WITH OBTAIN                     @G387PXR 37522500
         IHBERMAC 1020,ALOCAL,OBTAIN                           @G387PXR 37522600
         MEXIT                                                 @G387PXR 37522700
.ERRAD   ANOP                                                           37522800
.*       IHB280 ADDR INVALID WITH TYPE=XXX                              37522900
&MESSAGE SETC 'TYPE='.'&TYPE'                                           37523000
         IHBERMAC 1020,ADDR,&MESSAGE                                    37523100
         MEXIT                                                          37523200
.ERRALOC ANOP                                                  @G387PXR 37523300
.*       IHB280 ALOCAL INVALID WITH RELEASE                    @G387PXR 37523400
         IHBERMAC 1020,ALOCAL,RELEASE                          @G387PXR 37523500
         MEXIT                                                 @G387PXR 37523600
.ERRASCB ANOP                                                  @G387PXR 37523700
.*       IHB280 ASCB INVALID WITH TYPE=XXX                     @G387PXR 37523800
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 37523900
         IHBERMAC 1020,ASCB,&MESSAGE                           @G387PXR 37524000
         MEXIT                                                 @G387PXR 37524100
.ERRBR   ANOP                                                           37524200
.*       IHB280 BRANCH INVALID WITH OBTAIN/RELEASE                      37524300
         IHBERMAC 1020,BRANCH,&REQUEST                                  37524400
         MEXIT                                                          37524500
.ERRDIS1 ANOP                                                  @G860PXA 37524600
.*       IHB244 INVALID POSIT-NL XXX OPERAND                            37524700
         IHBERMAC 1008,&DISABLE,1                                       37524800
         MEXIT                                                          37524900
.ERRDIS2 ANOP                                                           37525000
.*       IHB280 DISABLE INVALID WITH CMS/LOCAL/CML/CPU                  37525100
         IHBERMAC 1020,&DISABLE,&TYPE                                   37525200
         MEXIT                                                          37525300
.ERRDIS3 ANOP                                                           37525400
.*       IHB280 DISABLE INVALID WITH COND OR SUSPEND LOCK OBTAIN        37525500
&MESSAGE SETC 'COND OR SUSPEND LOCK OBTAIN'                             37525600
         IHBERMAC 1020,&DISABLE,&MESSAGE                                37525700
         MEXIT                                                          37525800
.ERREG1  ANOP                                                           37525900
.*       IHB280 REGISTER NOTATION INVALID WITH ADDR                     37526000
&MESSAGE SETC 'REGISTER NOTATION'                                       37526100
         IHBERMAC 1020,&MESSAGE,ADDR                                    37526200
         MEXIT                                                          37526300
.ERREG2  ANOP                                                  @G387PXR 37526400
.*       IHB280 REGISTER NOTATION INVALID WITH ASCB            @G387PXR 37526500
&MESSAGE SETC 'REGISTER NOTATION'                              @G387PXR 37526600
         IHBERMAC 1020,&MESSAGE,ASCB                           @G387PXR 37526700
         MEXIT                                                 @G387PXR 37526800
.ERRLHLD ANOP                                                      @L8A 37526900
.*       IHB280 LOCKHLD INVALID WITH OBTAIN/RELEASE                @L8A 37527000
         IHBERMAC 1020,LOCKHLD,&REQUEST                            @L8A 37527100
         MEXIT                                                     @L8A 37527200
.ERRLOCK ANOP                                                  @G387PXR 37527300
.*       IHB280 LOCKHLD INVALID WITH TYPE=XXX                  @G387PXR 37527400
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 37527500
         IHBERMAC 1020,LOCKHLD,&MESSAGE                        @G387PXR 37527600
         MEXIT                                                 @G387PXR 37527700
.ERRMODE ANOP                                                           37527800
.*       IHB280 MODE INVALID WITH RELEASE                               37527900
         IHBERMAC 1020,MODE,RELEASE                                     37528000
         MEXIT                                                          37528100
.ERRREQ  ANOP                                                           37528200
         IHBERMAC 24                                                    37528300
         MEXIT                                                          37528400
.ERRTYPE ANOP                                                  @G387PXR 37528500
.*       IHB001 TYPE OPERAND REQUIRED, NOT SPECIFIED           @G387PXR 37528600
         IHBERMAC 1006,TYPE                                    @G387PXR 37528700
         MEXIT                                                 @G387PXR 37528800
.ERRWK   ANOP                                                           37528900
         MNOTE 12,'WORKREG KEYWORD IS NOT VALID WITH OBTAIN/RELEASE'    37529000
         MEXIT                                                          37529100
.INVCOND ANOP                                                           37529200
.*       IHB002 INVALID BRANCH OPERAND SPECIFIED - XXX                  37529300
         IHBERMAC 1001,BRANCH,&BRANCH(1)                                37529400
         MEXIT                                                          37529500
.INVDIS  ANOP                                                  @G860PXA 37529600
.*       IHB280 DISABLE INVALID WITH CPU                       @G860PXA 37529700
         IHBERMAC 1020,&DISABLE,&TYPE                          @G860PXA 37529800
         MEXIT                                                 @G860PXA 37529900
.INVMODE ANOP                                                           37530000
.*       IHB280 MODE INVALID WITH TEST                                  37530100
         IHBERMAC 1020,MODE,TEST                                        37530200
         MEXIT                                                          37530300
.INVSCOP ANOP                                                  @G860PXA 37530400
.*       IHB002 INVALID SCOPE OPERAND SPECIFIED - XXX          @G860PXA 37530500
         IHBERMAC 1001,SCOPE,&SCOPE                            @G860PXA 37530600
         MEXIT                                                 @G860PXA 37530700
.INVTYP  ANOP                                                           37530800
.*       IHB002 INVALID TYPE OPERAND SPECIFIED - XXX                    37530900
         IHBERMAC 1001,TYPE,&TYPE                                       37531000
         MEXIT                                                          37531100
.INVWKRG ANOP                                                      @L8A 37531200
.*       IHB280 WORKREG INVALID WITH TYPE=(REG)                    @L8A 37531300
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 37531400
         IHBERMAC 1020,WORKREG,&MESSAGE                        @G387PXR 37531500
         MEXIT                                                 @G387PXR 37531600
.LKASREQ ANOP                                                  @G387PXR 37531700
.*       IHB001 LOCKHLD/ASCB OPERAND REQUIRED NOT SPECIFIED    @G387PXR 37531800
         IHBERMAC 1006,LOCKHLD/ASCB                            @G387PXR 37531900
         MEXIT                                                 @G387PXR 37532000
.LKHINV  ANOP                                                  @G387PXR 37532100
.*       IHB280 LOCKHLD INVALID WITH ASCB                      @G387PXR 37532200
         IHBERMAC 1020,LOCKHLD,ASCB                            @G387PXR 37532300
         MEXIT                                                 @G387PXR 37532400
.MODERR  ANOP                                                           37532500
.*       IHB002 INVALID MODE OPERAND SPECIFIED - XXX                    37532600
         IHBERMAC 1001,MODE,&MODE                                       37532700
         MEXIT                                                          37532800
.NODIS   ANOP                                                           37532900
.*       IHB280 DISABLED INVALID WITH TEST                              37533000
         IHBERMAC 1020,&DISABLE,TEST                                    37533100
         MEXIT                                                          37533200
.NOLOCK  ANOP                                                           37533300
         MNOTE 12,'LOCK KEYWORD IS NOT VALID WITH OBTAIN/RELEASE'       37533400
         MEXIT                                                          37533500
.NOMODE  ANOP                                                           37533600
.*       IHB001 MODE OPERAND REQUIRED, NOT SPECIFIED                    37533700
         IHBERMAC 1006,MODE                                             37533800
         MEXIT                                                          37533900
.NOREGS  ANOP                                                      @L8A 37534000
         MNOTE 12,' ON SETLOCK TEST, REGS IS ONLY VALID WITH TYPE=(REG)*37534100
               . '                                                 @P5C 37534200
         MEXIT                                                     @L8A 37534400
.NOSCOPE ANOP                                                  @G860PXA 37534500
.*       IHB280 SCOPE INVALID WITH TYPE=XXX                    @G860PXA 37534600
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G860PXA 37534700
         IHBERMAC 1020,SCOPE,&MESSAGE                          @G860PXA 37534800
         MEXIT                                                 @G860PXA 37534900
.NOTAREG ANOP                                                      @L8A 37535000
         MNOTE 12,'WORKREG REQUIRES A REGISTER OPERAND'            @L8A 37535100
         MEXIT                                                     @L8A 37535200
.NOTYP   ANOP                                                           37535300
.*       IHB001 TYPE OPERAND REQUIRED, NOT SPECIFIED                    37535400
         IHBERMAC 1006,TYPE                                             37535500
         MEXIT                                                          37535600
.NOWKREG ANOP                                                      @L8A 37535700
         MNOTE 12,'WORKREG IS REQUIRED WITH BRANCH'                @L8A 37535800
         MEXIT                                                          37535900
.REGINV4 ANOP                                                      @L8A 37536000
         MNOTE 0,'REGS IGNORED WITH SPECIFIED TYPE'                @L8A 37536100
         AGO .REGRET4                                              @L8A 37536200
.REGREQ  ANOP                                                      @L8A 37536300
         MNOTE 12,' REGS IS REQUIRED IF BOTH TYPE=(REG) AND BRANCH ARE *37536400
               SPECIFIED. '                                        @P5C 37536500
         MEXIT                                                          37536800
.RREGASI ANOP                                                      @L8A 37536900
.*       IHB280 ASCB INVALID WITH TYPE=REG                         @L8A 37537000
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 37537100
         IHBERMAC 1020,ASCB,&MESSAGE                               @L8A 37537200
         MEXIT                                                          37537300
.RREGLKH ANOP                                                      @L8A 37537400
.*       IHB280 LOCKHLD INVALID WITH TYPE=REG                      @L8A 37537500
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 37537600
         IHBERMAC 1020,LOCKHLD,&MESSAGE                            @L8A 37537700
         MEXIT                                                          37537800
.SCOPREQ ANOP                                                  @G860PXA 37537900
.*       IHB001 SCOPE OPERAND REQUIRED, NOT SPECIFIED          @G860PXA 37538000
         IHBERMAC 1006,SCOPE                                   @G860PXA 37538100
         MEXIT                                                 @G860PXA 37538200
.BLKHLD  ANOP                                                  @G387PXR 37538300
.*       IHB002 INVALID LOCKHLD OPERAND SPECIFIED - XXX        @G387PXR 37538400
         IHBERMAC 1001,LOCKHLD,&LOCKHLD                        @G387PXR 37538500
         MEXIT                                                 @G387PXR 37538600
.TCMLANV ANOP                                                  @G387PXR 37538700
.*       IHB002  INVALID ASCB OPERAND SPECIFIED - XXX          @G387PXR 37538800
         IHBERMAC 1001,ASCB,&ASCB                              @G387PXR 37538900
         MEXIT                                                 @G387PXR 37539000
.TERR007 ANOP                                                  @G860PXA 37539100
.*       IHB001 LOCK OPERAND REQUIRED, NOT SPECIFIED           @G860PXA 37539200
         IHBERMAC 1006,LOCK                                    @G860PXA 37539300
         MEXIT                                                 @G860PXA 37539400
.TERR008 ANOP                                                  @G860PXA 37539500
.*       IHB002 INVALID LOCK OPERAND SPECIFIED                 @G860PXA 37539600
         IHBERMAC 1001,LOCK,&LOCK                              @G860PXA 37539700
         MEXIT                                                 @G860PXA 37539800
.TERR009 ANOP                                                      @L8A 37539900
.*       IHB280 LOCK INVALID WITH TYPE=XXX                         @L8A 37540000
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 37540100
         IHBERMAC 1020,LOCK,&MESSAGE                               @L8A 37540200
         MEXIT                                                     @L8A 37540300
.TINVBR  ANOP                                                      @L8A 37540400
         MNOTE 12,'TWO BRANCH VALUES ARE REQUIRED'                 @L8A 37540500
         MEXIT                                                          37540600
.TINVWK  ANOP                                                      @L8A 37540700
         MNOTE 12,'ONE WORKREG VALUE IS REQUIRED'                  @L8A 37540800
         MEXIT                                                     @L8A 37540900
.TREGCA  ANOP                                                  @G387PXR 37550000
.*       IHB280 ASCB INVALID WITH TYPE=REG                     @G387PXR 37600000
&MESSAGE SETC   'TYPE='.'&TYPE'                                @G387PXR 37650000
         IHBERMAC 1020,ASCB,&MESSAGE                           @G387PXR 37700000
         MEXIT                                                 @G387PXR 37750000
.TSTBADR ANOP                                                           37800000
.*       IHB002 INVALID ADDR OPERAND SPECIFIED - XXX                    37850000
         IHBERMAC 1001,ADDR,&ADDR                                       37900000
         MEXIT                                                          37950000
.WARNWK  ANOP                                                      @L8A 38000000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 38050000
         AGO   .WRNWKR                                             @L8A 38100000
.WARNWK2 ANOP                                                      @L8A 38150000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 38200000
         AGO   .WRNWKR2                                            @L8A 38250000
.WARNWK5 ANOP                                                      @L8A 38300000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 38350000
         AGO   .NN5                                                @L8A 38400000
.WARNWKA ANOP                                                      @L8A 38450000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 38500000
         AGO   .NAMCK                                              @L8A 38550000
.WARNWKB ANOP                                                      @L8A 38600000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 38650000
         AGO   .WRNWKRB                                            @L8A 38700000
.WARNWKC ANOP                                                      @L8A 38750000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 38800000
         AGO   .CMLPROC                                            @L8A 38850000
.WARNWKD ANOP                                                      @L8A 38900000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 38950000
         AGO   .TALOCNN                                            @L8A 39000000
.WARNWKE ANOP                                                      @L8A 39050000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 39100000
         AGO   .WRNWKRE                                            @L8A 39150000
.LEVEL1  ANOP                                                  @G860PXD 46214200
&NAME    SETLOCK8 &REQUEST,TYPE=&TYPE,ADDR=&ADDR,MODE=&MODE,   @G860PXD-46221300
               RELATED=&RELATED,REGS=&REGS,BRANCH=&BRANCH,     @G860PXD-46228400
               ASCB=&ASCB,LOCKHLD=&LOCKHLD,&DISABLE,               @P3C-46233100
               LOCK=&LOCK,SCOPE=&SCOPE                             @P3C 46237800
         MEXIT                                                 @G860PXD 46242600
         MEND                                                           46250000
* */                                                                    46300000
*  SETLOCK :                                                            46350000
*  MACRO                                                                46400000
*  KEYS(TYPE,ADDR,MODE,DISABLED,ASCB,SCOPE,REGS,LOCK,      /*@ZMC0463*/ 46433300
*       BRANCH,LOCKHLD,WORKREG,RELATED);                   /*    @L8C*/ 46466600
*  ANS('?'||MACLABEL||'SETLOCKP '||MACLIST||MACKEYS||';');              46500000
*% END;                                                                 46550000
