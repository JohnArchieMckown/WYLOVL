*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXCSETUS                              -10/25/95-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  XCF Set User State                            * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1993, 1996                     * 00001300
*                                                                     * 00001400
* STATUS= JBB6602                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      The SET USER STATE routine is given control from the IXCSETUS  * 00002200
*      macro.  The IXCSETUS macro will complete the parameter list    * 00002300
*      with caller provided data and generate a stacking, space       * 00002400
*      switching, program call to the set user state service.  The    * 00002500
*      IXCSETUS macro is provided in list, execute, and standard      * 00002600
*      form.  The list form accepts no variable parameters and is     * 00002700
*      used only to reserve space for the set user state parameter    * 00002800
*      list.  The standard form is provided for use with routines     * 00002900
*      which do not require reentrant code.  The execute form is      * 00003000
*      provided for use with the list format for reentrant routines.  * 00003100
*      The IXCSETUS macro is provided in PL/AS and assembler formats. * 00003200
*                                                                     * 00003300
*      The parameter list must be in the caller's primary address     * 00003400
*      space or be addressable by the dispatchable unit access list.  * 00003500
*                                                                     * 00003600
*                                                                     * 00003700
*                                                                     * 00003800
*      INPUT REGISTERS:                                               * 00003900
*                                                                     * 00004000
*                                                                     * 00004100
*                          GR0-GR1     reserved                       * 00004200
*                                                                     * 00004300
*                          GR2-GR13    undefined                      * 00004400
*                                                                     * 00004500
*                          GR14-GR15   reserved                       * 00004600
*                                                                     * 00004700
*                          AR0-AR1     reserved                       * 00004800
*                                                                     * 00004900
*                          AR2-AR13    undefined                      * 00005000
*                                                                     * 00005100
*                          AR14-AR15   reserved                       * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*      OUTPUT ENVIRONMENT: Same as on entry                           * 00005600
*                                                                     * 00005700
*      OUTPUT REGISTERS:                                              * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*                          GR0         reason code based on GR15 or 0 * 00006100
*                                                                     * 00006200
*                          GR1         unpredictable                  * 00006300
*                                                                     * 00006400
*                          GR2-GR13    unchanged                      * 00006500
*                                                                     * 00006600
*                          GR14        unpredictable                  * 00006700
*                                                                     * 00006800
*                          GR15        return code                    * 00006900
*                                                                     * 00007000
*                          AR0-AR1     unpredictable                  * 00007100
*                                                                     * 00007200
*                          AR2-AR13    unchanged                      * 00007300
*                                                                     * 00007400
*                          AR14-AR15   unpredictable                  * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00008100
*                                                                     * 00008200
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00008300
*                                                                     * 00008400
*01* ENVIRONMENT:                                                     * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*      Dispatchable unit mode: Task mode.                             * 00008800
*                                                                     * 00008900
*      Minimum authorization: Supervisor state or PKM allowing keys   * 00009000
*                        0-7.                                         * 00009100
*                                                                     * 00009200
*      AMODE:            31-bit.                                      * 00009300
*                                                                     * 00009400
*      ASC mode:         Primary or Access Register.                  * 00009500
*                                                                     * 00009600
*                        If in Access Register ASC mode, specify      * 00009700
*                        SYSSTATE ASCENV=AR before invoking this      * 00009800
*                        macro.                                       * 00009900
*                                                                     * 00010000
*                        Primary equal to the requesting member's     * 00010100
*                        primary at the time the group was joined;    * 00010200
*                        any secondary address space; any home        * 00010300
*                        address space                                * 00010400
*                                                                     * 00010500
*                        Swappable or non-swappable primary address   * 00010600
*                        space                                        * 00010700
*                                                                     * 00010800
*      Serialization:                                                 * 00010900
*                                                                     * 00011000
*                        Enabled for I/O and external interrupts      * 00011100
*                                                                     * 00011200
*                        No locks held                                * 00011300
*                                                                     * 00011400
*                        No EUT FRR set                               * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*01* SYNTAX:                                                          * 00011900
*                                                                     * 00012000
*[xlabel]  IXCSETUS     MEMTOKEN=xmemtoken                            * 00012100
*                      ,NEWUS=xnewus                                  * 00012200
*                      ,USLEN=xuslen                                  * 00012300
*                      ,TARGET=xtarget                                * 00012400
*                     [,COMPUS=xcompus|NO_COMPUS]                   * 00012500
*                     [,OLDUS=xoldus]                                 * 00012600
*                     [,ECB=xecb|NO_ECB]                            * 00012700
*                     [,RETCODE=xretcode]                             * 00012800
*                     [,RSNCODE=xrsncode]                             * 00012900
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00013000
*                    [,MF=S]                                         * 00013100
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00013200
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*      Where:                                                         * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*      [xlabel]                                                       * 00013900
*          is an optional symbol, starting in column 1, that is the   * 00014000
*          name on the IXCSETUS macro invocation.  The name must      * 00014100
*          conform to the rules for an ordinary assembler language    * 00014200
*          symbol.                                                    * 00014300
*          DEFAULT: No name.                                          * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*      MEMTOKEN=xmemtoken                                             * 00014900
*          is the name (RS-type), or address in register (2)-(12), of * 00015000
*          a required 64 bit input variable containing the calling    * 00015100
*          member's token.                                            * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*      NEWUS=xnewus                                                   * 00015700
*          is the name (RS-type), or address in register (2)-(12), of * 00015800
*          a required character input variable containing the user    * 00015900
*          state value to be placed in the member record.  The length * 00016000
*          of the field is specified by the USLEN keyword.            * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*      USLEN=xuslen                                                   * 00016600
*          is the name (RS-type), or address in register (2)-(12), of * 00016700
*          a required fullword input variable that contains the       * 00016800
*          length of the user state field provided.  A decimal value  * 00016900
*          can also be specified.  The length must be no greater than * 00017000
*          32, and cannot be 0.                                       * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      TARGET=xtarget                                                 * 00017600
*          is the name (RS-type), or address in register (2)-(12), of * 00017700
*          a required 64 bit input variable containing the token (as  * 00017800
*          returned by IXCQUERY) of the member whose user state value * 00017900
*          is to be altered.                                          * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      [COMPUS=xcompus|NO_COMPUS]                                   * 00018500
*          is the name (RS-type), or address in register (2)-(12), of * 00018600
*          an optional character input variable indicating a user     * 00018700
*          state field for comparison.  If specified, the user state  * 00018800
*          field at the time of execution of the set user state       * 00018900
*          service must equal the provided value before the new user  * 00019000
*          state value indicated by NEWUS will be placed in the       * 00019100
*          member record.  If SYSSTATE ASCENV=AR had been specified,  * 00019200
*          the ALET accompanying this address will also be passed and * 00019300
*          verified.  Note that a user state value of 0 is valid;     * 00019400
*          only if the parameter is not specified will the comparison * 00019500
*          be skipped.  The length of the field is specified by the   * 00019600
*          USLEN keyword.                                             * 00019700
*          DEFAULT: NO_COMPUS                                         * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*      [OLDUS=xoldus]                                                 * 00020300
*          is the name (RS-type), or address in register (2)-(12), of * 00020400
*          an optional character output variable to contain the old   * 00020500
*          user state value.  Caution: If ECB is specified with       * 00020600
*          OLDUS, then the OLDUS area must be in commonly addressable * 00020700
*          storage. In such a case, the input ALET if provided must   * 00020800
*          be 0.  This variable is set whenever return code 0 or 4 is * 00020900
*          set.  COMPUS and OLDUS can both refer to the same area of  * 00021000
*          storage, if it is desired to have the compare value        * 00021100
*          updated with the old user state value when the comparison  * 00021200
*          fails.  The length of the field is specified by the USLEN  * 00021300
*          keyword.                                                   * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*      [ECB=xecb|NO_ECB]                                            * 00021900
*          is the name (RS-type), or address in register (2)-(12), of * 00022000
*          an optional 32 bit input variable indicating an ECB to be  * 00022100
*          POSTed when the Set User State operation completes. When   * 00022200
*          this option is specified, the caller of the service may    * 00022300
*          get control back before the completion of the function.    * 00022400
*          The caller should then check the return code. If it is 0,  * 00022500
*          then the caller should WAIT on the ECB to detect           * 00022600
*          completion.  When a return code other than 0 is passed     * 00022700
*          back, the ECB will not be posted.  If ECB is not           * 00022800
*          specified, the function is completed synchronously.  The   * 00022900
*          ECB is assumed to be in the caller's home address space,   * 00023000
*          since the caller can only WAIT on an ECB in the home       * 00023100
*          address space.  Callers running with Primary not equal to  * 00023200
*          Home must use caution when using the ECB parameter to      * 00023300
*          ensure that the ECB actually is addressable from the home  * 00023400
*          address space.  Note that if ECB is specified with OLDUS,  * 00023500
*          then the OLDUS variable is filled in, when appropriate,    * 00023600
*          just before the ECB is posted, and that OLDUS variable     * 00023700
*          must refer to commonly addressable storage.                * 00023800
*                                                                     * 00023900
*          Upon being posted, bits 8-31 of the ECB will contain:      * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*          o   Bits 8-23: the low order halfword of the reason code   * 00024300
*              that would have been returned in R0.                   * 00024400
*                                                                     * 00024500
*          o   Bits 24-31: the low order byte of the return code that * 00024600
*              would have been returned in R15.                       * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*          DEFAULT: NO_ECB                                            * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*      [RETCODE=xretcode]                                             * 00025500
*          is the name (RS-type) of an optional fullword output       * 00025600
*          variable, or register (2)-(12), into which the return code * 00025700
*          is to be copied from GPR 15.                               * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*      [RSNCODE=xrsncode]                                             * 00026300
*          is the name (RS-type) of an optional fullword output       * 00026400
*          variable, or register (2)-(12), into which the reason code * 00026500
*          is to be copied from GPR 0.                                * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00027100
*          is an optional byte input decimal value in the "0-0" range * 00027200
*          that specifies the macro version.  PLISTVER is the only    * 00027300
*          key allowed on the list form of MF and determines which    * 00027400
*          parameter list is generated.  Note that MAX may be         * 00027500
*          specified instead of a number, and the parameter list will * 00027600
*          be of the largest size currently supported. This size may  * 00027700
*          grow from release to release (thus possibly affecting the  * 00027800
*          amount of storage needed by your program).  If your        * 00027900
*          program can tolerate this, IBM recommends that you always  * 00028000
*          specify MAX when creating the list form parameter list as  * 00028100
*          that will ensure that the list form parameter list is      * 00028200
*          always long enough to hold whatever parameters might be    * 00028300
*          specified on the execute form.                             * 00028400
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00028500
*          default is the lowest version which allows all of the      * 00028600
*          parameters specified on the invocation to be processed.    * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*      [MF=S|L|E]                                                   * 00029200
*          is an optional keyword input which specifies the macro     * 00029300
*          form.                                                      * 00029400
*          DEFAULT: S                                                 * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*          [MF=S]                                                     * 00029800
*              specifies the standard form of the macro.  The "S"     * 00029900
*              form generates code to put the parameters into an      * 00030000
*              in-line parameter list and invoke the desired service. * 00030100
*              Full checking for required macro keys is done along    * 00030200
*              with supplying defaults for omitted optional           * 00030300
*              parameters.                                            * 00030400
*                                                                     * 00030500
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00030600
*              specifies the list form of the macro.  The "L" form    * 00030700
*              defines an area to be used for the parameter list.     * 00030800
*              Only the PLISTVER key may be specified on the          * 00030900
*              invocation.  All other macro parameters are flagged as * 00031000
*              errors.  If PLISTVER is not specified, the original    * 00031100
*              parameter list definition is used.                     * 00031200
*                                                                     * 00031300
*            ,xmfctrl                                                 * 00031400
*              is a required input.  It is the name of a storage area * 00031500
*              for the parameter list.                                * 00031600
*                                                                     * 00031700
*            ,xmfattr|0D                                            * 00031800
*              is an optional 60 character input string that varies   * 00031900
*              from 1 to 60 characters. It can contain any value that * 00032000
*              is valid on an assembler DS pseudo-op. You can use     * 00032100
*              this parameter to force boundary alignment of the      * 00032200
*              parameter list.                                        * 00032300
*              DEFAULT: 0D which forces the parameter list to a       * 00032400
*              doubleword boundary.                                   * 00032500
*                                                                     * 00032600
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00032700
*              specifies the execute form of the macro.  The "E" form * 00032800
*              generates code to put the parameters into the          * 00032900
*              parameter list specified by xmfctrl and provides full  * 00033000
*              syntax checking with default setting.                  * 00033100
*                                                                     * 00033200
*            ,xmfctrl                                                 * 00033300
*              is a required input.  It is the name (RS-type), or     * 00033400
*              address in register (1)-(12), of a storage area for    * 00033500
*              the parameter list.                                    * 00033600
*                                                                     * 00033700
*            ,COMPLETE                                              * 00033800
*              is an optional keyword input which specifies the       * 00033900
*              degree of macro parameter syntax checking.             * 00034000
*              DEFAULT: COMPLETE                                      * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*              COMPLETE                                               * 00034400
*                  Checking for required macro keys is done and       * 00034500
*                  defaults are supplied for omitted optional         * 00034600
*                  parameters.                                        * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*                                                                     * 00035000
*                                                                     * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*01* RETURN CODES:                                                    * 00035500
*                                                                     * 00035600
*                                                                     * 00035700
*       0         successful completion;                              * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                 o   If ECB was not specified, then user state value * 00036100
*                     set in member record. Old user state value      * 00036200
*                     returned if OLDUS was specified.                * 00036300
*                                                                     * 00036400
*                 o   If ECB was specified, then processing will      * 00036500
*                     complete asynchronously.                        * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*       4         warning, reason code in R0                          * 00037000
*                                                                     * 00037100
*                 No change has been made and no members notified.    * 00037200
*                 The old value is returned if OLDUS was specified.   * 00037300
*                                                                     * 00037400
*                 HEX REASON       MEANING                            * 00037500
*                 CODE                                                * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                 4           COMPUS was not specified, and the       * 00037900
*                             specified new user state value was      * 00038000
*                             equal to the user state value at the    * 00038100
*                             time of execution.                      * 00038200
*                                                                     * 00038300
*                 8           COMPUS was specified and the user state * 00038400
*                             value for comparison was not equal to   * 00038500
*                             the user state value at the time of     * 00038600
*                             execution.                              * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*       8         invalid parameters, reason code in R0               * 00039100
*                                                                     * 00039200
*                 HEX REASON       MEANING                            * 00039300
*                 CODE                                                * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*                 4           Member token does not identify an       * 00039700
*                             active member associated with the       * 00039800
*                             primary address space current when the  * 00039900
*                             set user state service was invoked      * 00040000
*                                                                     * 00040100
*                 8           Caller's STOKEN does not match the      * 00040200
*                             STOKEN from the JOIN request.           * 00040300
*                                                                     * 00040400
*                 C           Target member token does not identify   * 00040500
*                             the same group as the caller.           * 00040600
*                                                                     * 00040700
*                 10          invalid target member token             * 00040800
*                                                                     * 00040900
*                 14          ECB and OLDUS were specified, but the   * 00041000
*                             ALET of the OLDUS variable was not 0.   * 00041100
*                                                                     * 00041200
*                 18          ECB and OLDUS were specified, but the   * 00041300
*                             OLDUS address is not in common storage. * 00041400
*                                                                     * 00041500
*                 28          OLDUS specifies an invalid ALET.  The   * 00041600
*                             ALET is neither 0 nor a public entry on * 00041700
*                             the dispatchable unit access list.      * 00041800
*                                                                     * 00041900
*                 xxyy003C    Error updating the OLDUS value. "xx" is * 00042000
*                             the return code (0 or 4) and "yy" is    * 00042100
*                             the reason code that would have         * 00042200
*                             normally been presented to the caller.  * 00042300
*                                                                     * 00042400
*                 40          Reserved field in parameter list not 0  * 00042500
*                                                                     * 00042600
*                 100         ALET invalid for parameter list         * 00042700
*                                                                     * 00042800
*                 104         Invalid version number in parameter     * 00042900
*                             list                                    * 00043000
*                                                                     * 00043100
*                 108         Invalid function code in parameter list * 00043200
*                                                                     * 00043300
*                 10C         Error accessing parameter list          * 00043400
*                                                                     * 00043500
*                 110         Error fetching NEWUS value              * 00043600
*                                                                     * 00043700
*                 114         Invalid USLEN (greater than 32, or less * 00043800
*                             than 1 if USTATE was specified)         * 00043900
*                                                                     * 00044000
*                 118         Not task mode                           * 00044100
*                                                                     * 00044200
*                 11C         Not enabled                             * 00044300
*                                                                     * 00044400
*                 124         Error fetching COMPUS value             * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*       C         environmental error, reason code in R0              * 00045000
*                                                                     * 00045100
*                 Hex Reason       Meaning                            * 00045200
*                 Code                                                * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*                 18          While the issuing task was suspended    * 00045600
*                             for XCF processing, the task was        * 00045700
*                             abended (ie. another unit of work       * 00045800
*                             attempted to abnormally terminate this  * 00045900
*                             task).  The state of the IXCSETUS       * 00046000
*                             request is unpredictable.  This reason  * 00046100
*                             code does not apply to IXCSETUS         * 00046200
*                             requests that specify the ECB keyword.  * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*                                                                     * 00046600
*                                                                     * 00046700
*       10        failure in XCF processing                           * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*01* REASON CODES:                                                    * 00047200
*                                                                     * 00047300
*       A unique reason code will be returned whenever the return     * 00047400
*       code is non-zero.                                             * 00047500
*                                                                     * 00047600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00047700
*                                                                     * 00047800
*02*   PROCESSOR:  ASSEM                                              * 00047900
*                                                                     * 00048000
*01* COMPONENT:  SCXCF                                                * 00048100
*                                                                     * 00048200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00048300
*                                                                     * 00048400
*01* MACRO USAGE NOTES:                                               * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00048800
*        global macro variable.  Any value other than 'NO' will       * 00048900
*        result in the macro expansion being printed.  The default is * 00049000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00049100
*        variable should be set.                                      * 00049200
*                                                                     * 00049300
*                    GBLC &ZPRINT                                     * 00049400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*    2.  All   keys   currently   contained  in  the  IXCSETUS  macro * 00049800
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00049900
*        value of 0 or MAX.                                           * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*01* CHANGE ACTIVITY:                                                 * 00050500
*                                                                     * 00050600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00050700
*                                                                     * 00050800
*    $L0=COUPLXGP HBB4410 860901 PDXB:  Coupling Support              * 00050900
*    $P1=PEO3329  HBB4410 900226 PDT8:  Update return code 8, reason  * 00051000
*                                         code 4                      * 00051100
*    $P2=PKB2941  HBB4430 920617 PDT8:  Update prolog to state only   * 00051200
*                                         31 bit addressing mode is   * 00051300
*                                         supported                   * 00051400
*    $P3=PKB3181  HBB4430 920617 PDT8:  Add new reason code '18'X for * 00051500
*                                         return code 'C'X for        * 00051600
*                                         scenario where issuing task * 00051700
*                                         is abended while suspended  * 00051800
*                                         for XCF processing          * 00051900
*    $P4=PIG2739  HBB5510 930909 PD00CJ:  Remove HP3/HP2 amg tags     * 00052000
*                                         from the prologue since the * 00052100
*                                         no longer work with AMG.    * 00052200
****** END OF SPECIFICATIONS *****************************************/ 00052300
*/********************************************************************* 00052400
         MACRO                                                          00052500
&XLABEL  IXCSETUS &MEMTOKEN=,&NEWUS=,&USLEN=,&TARGET=,&COMPUS=,&OLDUS=,*00052600
               &ECB=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                00052700
.*                                                                      00052800
*              MACDATE -10/25/95-<0>                                    00052900
.*                                                                      00053000
.*******************************************************************    00053100
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00053200
.*******************************************************************    00053300
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00053400
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00053500
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00053600
.*                                                                      00053700
              GBLC  &ZIXCSETUS  YES=MACRO USED AT LEAST ONCE            00053800
.*******************************************************************    00053900
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00054000
.*******************************************************************    00054100
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00054200
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00054300
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00054400
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00054500
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00054600
              LCLA  &ZAWRK      USED AS A WORK AREA                     00054700
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00054800
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00054900
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00055000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00055100
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00055200
              LCLA  &ZMACRET    MACRO RETURN CODE                       00055300
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00055400
.*                                                                      00055500
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00055600
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00055700
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00055800
              LCLC  &ZENDBASEPL                 End of base PL          00055900
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00056000
.*******************************************************************    00056100
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00056200
.*******************************************************************    00056300
              LCLA  &ZI         INDEX FOR ARRAY                         00056400
              LCLA  &ZJ         INDEX FOR PARMS                         00056500
              LCLA  &ZK         INDEX FOR PARSE                         00056600
              LCLA  &ZLO        LOW RANGE VALUE                         00056700
              LCLA  &ZHI        HIGH RANGE VALUE                        00056800
              LCLC  &ZW         WORK AREA FOR PARM                      00056900
.********************************************************************   00057000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00057100
.********************************************************************   00057200
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00057300
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00057400
.*                                                                      00057500
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00057600
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00057700
              SPLEVEL  TEST                                             00057800
.ZSYS2        ANOP  ,                                                   00057900
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00058000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00058100
              SYSSTATE TEST                                             00058200
              AGO   .ZSYS4                                              00058300
.ZSYS3        ANOP  ,                                                   00058400
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00058500
.ZSYS4        ANOP  ,                                                   00058600
.*******************************************************************    00058700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00058800
.*******************************************************************    00058900
              LCLC  &XMEMTOKEN  ++ NAME                                 00059000
              LCLC  &XNEWUS     ++ NAME                                 00059100
              LCLC  &XUSLEN     ++ NAME                                 00059200
              LCLC  &XTARGET    ++ NAME                                 00059300
              LCLC  &XCOMPUS    ++ NAME                                 00059400
              LCLC  &XOLDUS     ++ NAME                                 00059500
              LCLC  &XECB       ++ NAME                                 00059600
              LCLC  &XRETCODE   ++ NAME                                 00059700
              LCLC  &XRSNCODE   ++ NAME                                 00059800
              LCLA  &XPLISTVER  ++ VALUE                                00059900
              LCLC  &XMF        ++ VALUE                                00060000
              LCLC  &XMFCTRL    ++ NAME                                 00060100
              LCLC  &XMFATTR    ++ VALUE                                00060200
              LCLC  &XMFSCK     ++ VALUE                                00060300
.*******************************************************************    00060400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00060500
.*******************************************************************    00060600
              LCLC  &ZXMEMTOKEN                 ++ INPUT NAME           00060700
              LCLC  &ZXNEWUS    ++ INPUT NAME                           00060800
              LCLC  &ZXUSLEN    ++ INPUT NAME                           00060900
              LCLC  &ZXTARGET   ++ INPUT NAME                           00061000
              LCLC  &ZXCOMPUS   ++ INPUT NAME                           00061100
              LCLC  &ZXOLDUS    ++ OUTPUT NAME                          00061200
              LCLC  &ZXECB      ++ INPUT NAME                           00061300
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00061400
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00061500
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00061600
              LCLC  &ZXMF       ++ INPUT VALUE                          00061700
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00061800
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00061900
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00062000
.********************************************************************   00062100
.***AC.PLV01  PROCESS PLISTVER                                      *   00062200
.********************************************************************   00062300
&XPLISTVER      SETA  0                                                 00062400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00062500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00062600
&XPLISTVER      SETA  0                                                 00062700
.ZPLV0          ANOP  ,                                                 00062800
.*                                                                      00062900
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00063000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00063100
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00063200
.*-------------------------------------------------------------------   00063300
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00063400
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00063500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00063600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00063700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00063800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00063900
                AGO   .ZPVCK2                                           00064000
.ZPVCK3         ANOP  ,                                                 00064100
.*-------------------------------------------------------------------   00064200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00064300
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00064400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00064500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00064600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00064700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00064800
                AGO   .ZPVCKE                                           00064900
.ZPVCK2         ANOP  ,                                                 00065000
.*-------------------------------------------------------------------   00065100
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00065200
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00065300
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00065400
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00065500
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00065600
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00065700
                MNOTE 8,' &ZMS IS REQUIRED.'                            00065800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00065900
                AGO   .ZPVCK5                                           00066000
.ZPVCK4         ANOP  ,                                                 00066100
&XPLISTVER      SETA  &PLISTVER(1)                                      00066200
.ZPVCK5         ANOP  ,                                                 00066300
.*-------------------------------------------------------------------   00066400
&ZCVAL          SETC  '&PLISTVER(1)'                                    00066500
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00066600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00066700
                AIF   (&XPLISTVER LT 0).ZPVCK6  TOO LOW                 00066800
                AIF   (&XPLISTVER LE 0).ZPVCKE  NOT HIGH                00066900
.ZPVCK6         ANOP   ,                                                00067000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00067100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00067200
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00067300
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00067400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00067500
.ZPVCKE         ANOP   ,                                                00067600
.********************************************************************   00067700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00067800
.********************************************************************   00067900
              ACTR  10000                                               00068000
.*------------------------------------------------------------------    00068100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068200
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00068300
.*-------------------------------------------------------------------   00068400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068500
.ZG33         ANOP  ,                                                   00068600
&ZTLC         SETC 'S'                                                  00068700
              AIF   ('&MF(1)' NE '&ZTLC').ZG34                          00068800
&XMF          SETC  'S'         SET KEYWORD                             00068900
              AIF   (N'&MF LE 1).ZG33A          CK NUM                  00069000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00069100
&ZMS          SETC  '&ZMS.&MF"'                                         00069200
&ZMS          SETC  '&ZMS "MF"'                                         00069300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00069400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00069500
.ZG33A        ANOP  ,                                                   00069600
.*-------------------------------------------------------------------   00069700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00069800
.ZG34         ANOP  ,                                                   00069900
&ZTLC         SETC 'L'                                                  00070000
              AIF   ('&MF(1)' NE '&ZTLC').ZG41                          00070100
&XMF          SETC  'L'         SET KEYWORD                             00070200
              AIF   (N'&MF LE 3).ZG34A          CK NUM                  00070300
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00070400
&ZMS          SETC  '&ZMS.&MF"'                                         00070500
&ZMS          SETC  '&ZMS "MF"'                                         00070600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00070700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00070800
.ZG34A        ANOP  ,                                                   00070900
.*-------------------------------------------------------------------   00071000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00071100
              AIF   (N'&SYSLIST NE 0).ZG34B     POSITIONALS?            00071200
              AIF   ('&MEMTOKEN' NE '').ZG34B   KEYS?                   00071300
              AIF   ('&NEWUS' NE '').ZG34B      KEYS?                   00071400
              AIF   ('&USLEN' NE '').ZG34B      KEYS?                   00071500
              AIF   ('&TARGET' NE '').ZG34B     KEYS?                   00071600
              AIF   ('&COMPUS' NE '').ZG34B     KEYS?                   00071700
              AIF   ('&OLDUS' NE '').ZG34B      KEYS?                   00071800
              AIF   ('&ECB' NE '').ZG34B        KEYS?                   00071900
              AIF   ('&RETCODE' NE '').ZG34B    KEYS?                   00072000
              AIF   ('&RSNCODE' NE '').ZG34B    KEYS?                   00072100
              AGO    .ZG34C     INVOCATION OKAY                         00072200
.ZG34B        ANOP  ,                                                   00072300
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            00072400
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00072500
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00072600
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00072700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00072800
.ZG34C        ANOP  ,                                                   00072900
.*-------------------------------------------------------------------   00073000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00073100
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00073200
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00073300
              AIF   (N'&MF(2) GT 1).ZG36B       MULTI PARMS             00073400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00073500
.ZG36B        AIF   (K'&MF(2) GT 0).ZG36C                               00073600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00073700
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00073800
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00073900
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00074000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00074100
.ZG36C        ANOP  ,                                                   00074200
.*-------------------------------------------------------------------   00074300
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00074400
              AIF   (K'&ZXMFCTRL LE 0).ZG36P    NOT I/O                 00074500
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG36P                      00074600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00074700
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00074800
&ZMS          SETC  '&ZMS.&MF"'                                         00074900
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00075000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00075100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00075200
.ZG36P        ANOP  ,                                                   00075300
.*-------------------------------------------------------------------   00075400
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00075500
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00075600
&XMFATTR      SETC  '0D'                                                00075700
              AIF   (K'&MF(3) LE 0).ZG39B       PARM                    00075800
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00075900
              AIF   (N'&MF(3) GT 1).ZG39B       MULTI PARMS             00076000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00076100
.ZG39B        ANOP  ,                                                   00076200
.*-------------------------------------------------------------------   00076300
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00076400
              AIF   (K'&ZXMFATTR LE 0).ZG39P    NOT I/O                 00076500
              AIF   ('&XMFATTR'(1,1) NE '(').ZG39P                      00076600
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00076700
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00076800
&ZMS          SETC  '&ZMS.&MF"'                                         00076900
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00077000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00077100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00077200
.ZG39P        ANOP  ,                                                   00077300
.*-------------------------------------------------------------------   00077400
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00077500
              AIF   (K'&ZXMFATTR LE 0).ZG39S    NOT I/O                 00077600
              AIF   (K'&XMFATTR LE 60).ZG39S    LNG OK                  00077700
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00077800
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00077900
&ZMS          SETC  '&ZMS.&MF"'                                         00078000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00078100
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00078200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00078300
.ZG39S        ANOP  ,                                                   00078400
.*-------------------------------------------------------------------   00078500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00078600
.ZG41         ANOP  ,                                                   00078700
&ZTLC         SETC 'E'                                                  00078800
              AIF   ('&MF(1)' NE '&ZTLC').ZG49                          00078900
&XMF          SETC  'E'         SET KEYWORD                             00079000
              AIF   (N'&MF LE 3).ZG41A          CK NUM                  00079100
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00079200
&ZMS          SETC  '&ZMS.&MF"'                                         00079300
&ZMS          SETC  '&ZMS "MF"'                                         00079400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00079500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00079600
.ZG41A        ANOP  ,                                                   00079700
.*-------------------------------------------------------------------   00079800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00079900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00080000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00080100
              AIF   (N'&MF(2) GT 1).ZG43B       MULTI PARMS             00080200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00080300
.ZG43B        AIF   (K'&MF(2) GT 0).ZG43C                               00080400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00080500
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00080600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00080700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00080800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00080900
.ZG43C        ANOP  ,                                                   00081000
.*-------------------------------------------------------------------   00081100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00081200
              AIF   (K'&ZXMFCTRL LE 0).ZG43R    NOT I/O                 00081300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG43R                      00081400
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00081500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                        00081600
              AIF   (K'&ZCGPR GT 2).ZG43Q                               00081700
              AIF   ('&ZCGPR' EQ '0').ZG43Q                             00081800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00081900
              AIF   (T'&ZCGPR NE 'N').ZG43Q     INVALID REG NAME        00082000
.ZG43P        ANOP  ,                                                   00082100
              AIF   (T'&ZCGPR NE 'N').ZG43R     NON NUMERIC             00082200
              AIF   ('&ZCGPR' LT '1').ZG43Q                             00082300
              AIF   ('&ZCGPR' LE '12').ZG43R                            00082400
.ZG43Q        ANOP  ,                                                   00082500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00082600
&ZMS          SETC  '&ZMS.&MF"'                                         00082700
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00082800
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00082900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00083000
.ZG43R        ANOP  ,                                                   00083100
.*-------------------------------------------------------------------   00083200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00083300
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00083400
.ZG47A   AIF   ('&MF(3)' NE 'COMPLETE').ZG48A                           00083500
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00083600
.*-------------------------------------------------------------------   00083700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00083800
.ZG48A        AIF   (K'&XMFSCK GT 0).ZG48C      KEYWORD                 00083900
              AIF   (K'&MF(3) LE 0).ZG48B                               00084000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00084100
&ZMS          SETC  '&ZMS.&MF"'                                         00084200
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00084300
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00084400
&ZMS          SETC  '&ZMS "COMPLETE".'          VALID KEYWORD           00084500
              MNOTE 8,' &ZMS '                                          00084600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00084700
.ZG48B        ANOP  ,                                                   00084800
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00084900
.ZG48C        ANOP  ,                                                   00085000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00085100
.*------------------------------------------------------------------    00085200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085300
.ZG49         ANOP  ,                                                   00085400
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00085500
              AIF   (K'&XMF GT 0).ZG49E         VALID ARG               00085600
              AIF   (T'&MF EQ 'O').ZG49D        OMITTED                 00085700
&ZASYSLNDX    SETA  0                                                   00085800
.ZG49A        ANOP  ,           POSITIONAL MACRO KEY                    00085900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00086000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG49C                    00086100
&ZTLC         SETC 'MF'                                                 00086200
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG49A           00086300
.ZG49B        ANOP  ,                                                   00086400
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00086500
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00086600
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00086700
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00086800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00086900
              AGO   .ZG49E                                              00087000
.ZG49C        ANOP  ,                                                   00087100
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00087200
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00087300
&ZMS          SETC  '&ZMS.&MF"'                                         00087400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00087500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00087600
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00087700
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00087800
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           00087900
              MNOTE 8,' &ZMS '                                          00088000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00088100
              AGO   .ZG49E                                              00088200
.ZG49D        ANOP  ,                                                   00088300
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00088400
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00088500
.ZG49E        ANOP  ,                                                   00088600
.********************************************************************   00088700
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00088800
.********************************************************************   00088900
              ACTR  10000                                               00089000
.*-------------------------------------------------------------------   00089100
.***AG.MF03 MF=(SLE)                                                    00089200
              AIF   ('&XMF' EQ 'L').ZGMFX                               00089300
.*----------------------------------------------------------------***   00089400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00089500
              AIF   (N'&MEMTOKEN LE 1).ZG2A     CK NUM                  00089600
&ZMS          SETC  '"MEMTOKEN='                *KPOSA* MNOTE           00089700
&ZMS          SETC  '&ZMS.&MEMTOKEN"'                                   00089800
&ZMS          SETC  '&ZMS "MEMTOKEN"'                                   00089900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00090000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090100
.ZG2A         ANOP  ,                                                   00090200
.*-------------------------------------------------------------------   00090300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00090400
&ZXMEMTOKEN   SETC  'INPUT'     SET IN/OUTPUT                           00090500
&XMEMTOKEN    SETC  '&MEMTOKEN(1)'              SET XVARIABLE           00090600
              AIF   (N'&MEMTOKEN GT 1).ZG2B     MULTI PARMS             00090700
&XMEMTOKEN    SETC  '&MEMTOKEN'                 SET XVARIABLE           00090800
.ZG2B         AIF   (K'&MEMTOKEN(1) GT 0).ZG2C                          00090900
&ZXMEMTOKEN   SETC  ''          RESET IN/OUTPUT                         00091000
&ZMS          SETC  ' '         *KRQDA*                                 00091100
&ZMS          SETC  '&ZMS "MEMTOKEN" KEY AND ITS ARGUMENT'              00091200
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00091300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00091400
.ZG2C         ANOP  ,                                                   00091500
.*-------------------------------------------------------------------   00091600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00091700
              AIF   (K'&ZXMEMTOKEN LE 0).ZG2R   NOT I/O                 00091800
              AIF   ('&XMEMTOKEN'(1,1) NE '(').ZG2R                     00091900
&ZCGPR        SETC  '&XMEMTOKEN'(2,K'&XMEMTOKEN-2)                      00092000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         00092100
              AIF   (K'&ZCGPR GT 2).ZG2Q                                00092200
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              00092300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00092400
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        00092500
.ZG2P         ANOP  ,                                                   00092600
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             00092700
              AIF   ('&ZCGPR' LT '2').ZG2Q                              00092800
              AIF   ('&ZCGPR' LE '12').ZG2R                             00092900
.ZG2Q         ANOP  ,                                                   00093000
&ZMS          SETC  '"MEMTOKEN='                *KGPRA* MNOTE           00093100
&ZMS          SETC  '&ZMS.&MEMTOKEN"'                                   00093200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00093300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00093400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093500
.ZG2R         ANOP  ,                                                   00093600
.*----------------------------------------------------------------***   00093700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00093800
              AIF   (N'&NEWUS LE 1).ZG5A        CK NUM                  00093900
&ZMS          SETC  '"NEWUS='   *KPOSA* MNOTE                           00094000
&ZMS          SETC  '&ZMS.&NEWUS"'                                      00094100
&ZMS          SETC  '&ZMS "NEWUS"'                                      00094200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00094300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094400
.ZG5A         ANOP  ,                                                   00094500
.*-------------------------------------------------------------------   00094600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00094700
&ZXNEWUS      SETC  'INPUT'     SET IN/OUTPUT                           00094800
&XNEWUS       SETC  '&NEWUS(1)'                 SET XVARIABLE           00094900
              AIF   (N'&NEWUS GT 1).ZG5B        MULTI PARMS             00095000
&XNEWUS       SETC  '&NEWUS'    SET XVARIABLE                           00095100
.ZG5B         AIF   (K'&NEWUS(1) GT 0).ZG5C                             00095200
&ZXNEWUS      SETC  ''          RESET IN/OUTPUT                         00095300
&ZMS          SETC  ' '         *KRQDA*                                 00095400
&ZMS          SETC  '&ZMS "NEWUS" KEY AND ITS ARGUMENT'                 00095500
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00095600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095700
.ZG5C         ANOP  ,                                                   00095800
.*-------------------------------------------------------------------   00095900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00096000
              AIF   (K'&ZXNEWUS LE 0).ZG5R      NOT I/O                 00096100
              AIF   ('&XNEWUS'(1,1) NE '(').ZG5R                        00096200
&ZCGPR        SETC  '&XNEWUS'(2,K'&XNEWUS-2)                            00096300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00096400
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00096500
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00096600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00096700
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00096800
.ZG5P         ANOP  ,                                                   00096900
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00097000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00097100
              AIF   ('&ZCGPR' LE '12').ZG5R                             00097200
.ZG5Q         ANOP  ,                                                   00097300
&ZMS          SETC  '"NEWUS='   *KGPRA* MNOTE                           00097400
&ZMS          SETC  '&ZMS.&NEWUS"'                                      00097500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00097600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00097700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00097800
.ZG5R         ANOP  ,                                                   00097900
.*----------------------------------------------------------------***   00098000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00098100
              AIF   (N'&USLEN LE 1).ZG8A        CK NUM                  00098200
&ZMS          SETC  '"USLEN='   *KPOSA* MNOTE                           00098300
&ZMS          SETC  '&ZMS.&USLEN"'                                      00098400
&ZMS          SETC  '&ZMS "USLEN"'                                      00098500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00098600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098700
.ZG8A         ANOP  ,                                                   00098800
.*-------------------------------------------------------------------   00098900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00099000
&ZXUSLEN      SETC  'INPUT'     SET IN/OUTPUT                           00099100
&XUSLEN       SETC  '&USLEN(1)'                 SET XVARIABLE           00099200
              AIF   (N'&USLEN GT 1).ZG8B        MULTI PARMS             00099300
&XUSLEN       SETC  '&USLEN'    SET XVARIABLE                           00099400
.ZG8B         AIF   (K'&USLEN(1) GT 0).ZG8C                             00099500
&ZXUSLEN      SETC  ''          RESET IN/OUTPUT                         00099600
&ZMS          SETC  ' '         *KRQDA*                                 00099700
&ZMS          SETC  '&ZMS "USLEN" KEY AND ITS ARGUMENT'                 00099800
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00099900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00100000
.ZG8C         ANOP  ,                                                   00100100
.*-------------------------------------------------------------------   00100200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00100300
              AIF   (K'&ZXUSLEN LE 0).ZG8R      NOT I/O                 00100400
              AIF   ('&XUSLEN'(1,1) NE '(').ZG8R                        00100500
&ZCGPR        SETC  '&XUSLEN'(2,K'&XUSLEN-2)                            00100600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         00100700
              AIF   (K'&ZCGPR GT 2).ZG8Q                                00100800
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              00100900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00101000
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        00101100
.ZG8P         ANOP  ,                                                   00101200
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             00101300
              AIF   ('&ZCGPR' LT '2').ZG8Q                              00101400
              AIF   ('&ZCGPR' LE '12').ZG8R                             00101500
.ZG8Q         ANOP  ,                                                   00101600
&ZMS          SETC  '"USLEN='   *KGPRA* MNOTE                           00101700
&ZMS          SETC  '&ZMS.&USLEN"'                                      00101800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00101900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00102000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102100
.ZG8R         ANOP  ,                                                   00102200
.*----------------------------------------------------------------***   00102300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00102400
              AIF   (N'&TARGET LE 1).ZG11A      CK NUM                  00102500
&ZMS          SETC  '"TARGET='  *KPOSA* MNOTE                           00102600
&ZMS          SETC  '&ZMS.&TARGET"'                                     00102700
&ZMS          SETC  '&ZMS "TARGET"'                                     00102800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00102900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00103000
.ZG11A        ANOP  ,                                                   00103100
.*-------------------------------------------------------------------   00103200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00103300
&ZXTARGET     SETC  'INPUT'     SET IN/OUTPUT                           00103400
&XTARGET      SETC  '&TARGET(1)'                SET XVARIABLE           00103500
              AIF   (N'&TARGET GT 1).ZG11B      MULTI PARMS             00103600
&XTARGET      SETC  '&TARGET'   SET XVARIABLE                           00103700
.ZG11B        AIF   (K'&TARGET(1) GT 0).ZG11C                           00103800
&ZXTARGET     SETC  ''          RESET IN/OUTPUT                         00103900
&ZMS          SETC  ' '         *KRQDA*                                 00104000
&ZMS          SETC  '&ZMS "TARGET" KEY AND ITS ARGUMENT'                00104100
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00104200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104300
.ZG11C        ANOP  ,                                                   00104400
.*-------------------------------------------------------------------   00104500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00104600
              AIF   (K'&ZXTARGET LE 0).ZG11R    NOT I/O                 00104700
              AIF   ('&XTARGET'(1,1) NE '(').ZG11R                      00104800
&ZCGPR        SETC  '&XTARGET'(2,K'&XTARGET-2)                          00104900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                        00105000
              AIF   (K'&ZCGPR GT 2).ZG11Q                               00105100
              AIF   ('&ZCGPR' EQ '0').ZG11Q                             00105200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00105300
              AIF   (T'&ZCGPR NE 'N').ZG11Q     INVALID REG NAME        00105400
.ZG11P        ANOP  ,                                                   00105500
              AIF   (T'&ZCGPR NE 'N').ZG11R     NON NUMERIC             00105600
              AIF   ('&ZCGPR' LT '2').ZG11Q                             00105700
              AIF   ('&ZCGPR' LE '12').ZG11R                            00105800
.ZG11Q        ANOP  ,                                                   00105900
&ZMS          SETC  '"TARGET='  *KGPRA* MNOTE                           00106000
&ZMS          SETC  '&ZMS.&TARGET"'                                     00106100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00106200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00106300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00106400
.ZG11R        ANOP  ,                                                   00106500
.*----------------------------------------------------------------***   00106600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00106700
              AIF   (N'&COMPUS LE 1).ZG14A      CK NUM                  00106800
&ZMS          SETC  '"COMPUS='  *KPOSA* MNOTE                           00106900
&ZMS          SETC  '&ZMS.&COMPUS"'                                     00107000
&ZMS          SETC  '&ZMS "COMPUS"'                                     00107100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00107200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107300
.ZG14A        ANOP  ,                                                   00107400
.*-------------------------------------------------------------------   00107500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00107600
&ZXCOMPUS     SETC  'INPUT'     SET IN/OUTPUT                           00107700
&XCOMPUS      SETC  'NO_COMPUS'                                         00107800
              AIF   (K'&COMPUS(1) LE 0).ZG14B   PARM                    00107900
&XCOMPUS      SETC  '&COMPUS(1)'                SET XVARIABLE           00108000
              AIF   (N'&COMPUS GT 1).ZG14B      MULTI PARMS             00108100
&XCOMPUS      SETC  '&COMPUS'   SET XVARIABLE                           00108200
.ZG14B        ANOP  ,                                                   00108300
.*-------------------------------------------------------------------   00108400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00108500
              AIF   (K'&ZXCOMPUS LE 0).ZG14R    NOT I/O                 00108600
              AIF   ('&XCOMPUS' EQ 'NO_COMPUS').ZG14R                   00108700
              AIF   ('&XCOMPUS'(1,1) NE '(').ZG14R                      00108800
&ZCGPR        SETC  '&XCOMPUS'(2,K'&XCOMPUS-2)                          00108900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                        00109000
              AIF   (K'&ZCGPR GT 2).ZG14Q                               00109100
              AIF   ('&ZCGPR' EQ '0').ZG14Q                             00109200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00109300
              AIF   (T'&ZCGPR NE 'N').ZG14Q     INVALID REG NAME        00109400
.ZG14P        ANOP  ,                                                   00109500
              AIF   (T'&ZCGPR NE 'N').ZG14R     NON NUMERIC             00109600
              AIF   ('&ZCGPR' LT '2').ZG14Q                             00109700
              AIF   ('&ZCGPR' LE '12').ZG14R                            00109800
.ZG14Q        ANOP  ,                                                   00109900
&ZMS          SETC  '"COMPUS='  *KGPRA* MNOTE                           00110000
&ZMS          SETC  '&ZMS.&COMPUS"'                                     00110100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00110200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00110300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110400
.ZG14R        ANOP  ,                                                   00110500
.*----------------------------------------------------------------***   00110600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00110700
              AIF   (N'&OLDUS LE 1).ZG17A       CK NUM                  00110800
&ZMS          SETC  '"OLDUS='   *KPOSA* MNOTE                           00110900
&ZMS          SETC  '&ZMS.&OLDUS"'                                      00111000
&ZMS          SETC  '&ZMS "OLDUS"'                                      00111100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00111200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00111300
.ZG17A        ANOP  ,                                                   00111400
.*-------------------------------------------------------------------   00111500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00111600
              AIF   (K'&OLDUS(1) LE 0).ZG17C    NO PARM                 00111700
&ZXOLDUS      SETC  'OUTPUT'    SET OUTPUT                              00111800
&XOLDUS       SETC  '&OLDUS(1)'                 SET XVARIABLE           00111900
              AIF   (N'&OLDUS GT 1).ZG17C                               00112000
&XOLDUS       SETC  '&OLDUS'    SET XVARIABLE                           00112100
.ZG17C        ANOP  ,                                                   00112200
.*-------------------------------------------------------------------   00112300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00112400
              AIF   (K'&ZXOLDUS LE 0).ZG17R     NOT I/O                 00112500
              AIF   ('&XOLDUS'(1,1) NE '(').ZG17R                       00112600
&ZCGPR        SETC  '&XOLDUS'(2,K'&XOLDUS-2)                            00112700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                        00112800
              AIF   (K'&ZCGPR GT 2).ZG17Q                               00112900
              AIF   ('&ZCGPR' EQ '0').ZG17Q                             00113000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00113100
              AIF   (T'&ZCGPR NE 'N').ZG17Q     INVALID REG NAME        00113200
.ZG17P        ANOP  ,                                                   00113300
              AIF   (T'&ZCGPR NE 'N').ZG17R     NON NUMERIC             00113400
              AIF   ('&ZCGPR' LT '2').ZG17Q                             00113500
              AIF   ('&ZCGPR' LE '12').ZG17R                            00113600
.ZG17Q        ANOP  ,                                                   00113700
&ZMS          SETC  '"OLDUS='   *KGPRA* MNOTE                           00113800
&ZMS          SETC  '&ZMS.&OLDUS"'                                      00113900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00114000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00114100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114200
.ZG17R        ANOP  ,                                                   00114300
.*----------------------------------------------------------------***   00114400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00114500
              AIF   (N'&ECB LE 1).ZG20A         CK NUM                  00114600
&ZMS          SETC  '"ECB='     *KPOSA* MNOTE                           00114700
&ZMS          SETC  '&ZMS.&ECB"'                                        00114800
&ZMS          SETC  '&ZMS "ECB"'                                        00114900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00115000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00115100
.ZG20A        ANOP  ,                                                   00115200
.*-------------------------------------------------------------------   00115300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00115400
&ZXECB        SETC  'INPUT'     SET IN/OUTPUT                           00115500
&XECB         SETC  'NO_ECB'                                            00115600
              AIF   (K'&ECB(1) LE 0).ZG20B      PARM                    00115700
&XECB         SETC  '&ECB(1)'   SET XVARIABLE                           00115800
              AIF   (N'&ECB GT 1).ZG20B         MULTI PARMS             00115900
&XECB         SETC  '&ECB'      SET XVARIABLE                           00116000
.ZG20B        ANOP  ,                                                   00116100
.*-------------------------------------------------------------------   00116200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00116300
              AIF   (K'&ZXECB LE 0).ZG20R       NOT I/O                 00116400
              AIF   ('&XECB' EQ 'NO_ECB').ZG20R                         00116500
              AIF   ('&XECB'(1,1) NE '(').ZG20R                         00116600
&ZCGPR        SETC  '&XECB'(2,K'&XECB-2)                                00116700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                        00116800
              AIF   (K'&ZCGPR GT 2).ZG20Q                               00116900
              AIF   ('&ZCGPR' EQ '0').ZG20Q                             00117000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00117100
              AIF   (T'&ZCGPR NE 'N').ZG20Q     INVALID REG NAME        00117200
.ZG20P        ANOP  ,                                                   00117300
              AIF   (T'&ZCGPR NE 'N').ZG20R     NON NUMERIC             00117400
              AIF   ('&ZCGPR' LT '2').ZG20Q                             00117500
              AIF   ('&ZCGPR' LE '12').ZG20R                            00117600
.ZG20Q        ANOP  ,                                                   00117700
&ZMS          SETC  '"ECB='     *KGPRA* MNOTE                           00117800
&ZMS          SETC  '&ZMS.&ECB"'                                        00117900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00118000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00118100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00118200
.ZG20R        ANOP  ,                                                   00118300
.*----------------------------------------------------------------***   00118400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00118500
              AIF   (N'&RETCODE LE 1).ZG23A     CK NUM                  00118600
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00118700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00118800
&ZMS          SETC  '&ZMS "RETCODE"'                                    00118900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00119000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119100
.ZG23A        ANOP  ,                                                   00119200
.*-------------------------------------------------------------------   00119300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00119400
              AIF   (K'&RETCODE(1) LE 0).ZG23C  NO PARM                 00119500
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00119600
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00119700
              AIF   (N'&RETCODE GT 1).ZG23C                             00119800
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00119900
.ZG23C        ANOP  ,                                                   00120000
.*-------------------------------------------------------------------   00120100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00120200
              AIF   (K'&ZXRETCODE LE 0).ZG23R   NOT I/O                 00120300
              AIF   ('&XRETCODE'(1,1) NE '(').ZG23R                     00120400
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00120500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                        00120600
              AIF   (K'&ZCGPR GT 2).ZG23Q                               00120700
              AIF   ('&ZCGPR' EQ '0').ZG23Q                             00120800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00120900
              AIF   (T'&ZCGPR NE 'N').ZG23Q     INVALID REG NAME        00121000
.ZG23P        ANOP  ,                                                   00121100
              AIF   (T'&ZCGPR NE 'N').ZG23R     NON NUMERIC             00121200
              AIF   ('&ZCGPR' LT '2').ZG23Q                             00121300
              AIF   ('&ZCGPR' LE '12').ZG23R                            00121400
.ZG23Q        ANOP  ,                                                   00121500
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00121600
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00121700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00121800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00121900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122000
.ZG23R        ANOP  ,                                                   00122100
.*----------------------------------------------------------------***   00122200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00122300
              AIF   (N'&RSNCODE LE 1).ZG26A     CK NUM                  00122400
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00122500
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00122600
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00122700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00122800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122900
.ZG26A        ANOP  ,                                                   00123000
.*-------------------------------------------------------------------   00123100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00123200
              AIF   (K'&RSNCODE(1) LE 0).ZG26C  NO PARM                 00123300
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00123400
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00123500
              AIF   (N'&RSNCODE GT 1).ZG26C                             00123600
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00123700
.ZG26C        ANOP  ,                                                   00123800
.*-------------------------------------------------------------------   00123900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00124000
              AIF   (K'&ZXRSNCODE LE 0).ZG26R   NOT I/O                 00124100
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG26R                     00124200
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00124300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        00124400
              AIF   (K'&ZCGPR GT 2).ZG26Q                               00124500
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             00124600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00124700
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        00124800
.ZG26P        ANOP  ,                                                   00124900
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             00125000
              AIF   ('&ZCGPR' LT '2').ZG26Q                             00125100
              AIF   ('&ZCGPR' LE '12').ZG26R                            00125200
.ZG26Q        ANOP  ,                                                   00125300
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00125400
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00125500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00125600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00125700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125800
.ZG26R        ANOP  ,                                                   00125900
.******************************************************************     00126000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00126100
.******************************************************************     00126200
              ACTR  10000                                               00126300
.*----------------------------------------------------------------***   00126400
.***AH.P02 EXTRA POSITIONALS                                            00126500
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00126600
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00126700
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00126800
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00126900
.ZGLISTX1     ANOP  ,                                                   00127000
&ZCVAL        SETC  ''          ERROR FIELD                             00127100
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00127200
.ZGLIST2      ANOP  ,                                                   00127300
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00127400
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00127500
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00127600
              AGO   .ZGLIST2                                            00127700
.*                                                                      00127800
.ZGLIST3      ANOP  ,                                                   00127900
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00128000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00128100
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00128200
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00128300
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00128400
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00128500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128600
.ZGLISTX      ANOP  ,                                                   00128700
&ZASYSLNDX    SETA  0                                                   00128800
.*-------------------------------------------------------------------   00128900
.***AG.MF04 MF=(SLE)                                                    00129000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00129100
.*******************************************************************    00129200
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00129300
.*******************************************************************    00129400
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00129500
.*******************************************************************    00129600
.***AE.01  START OF IXCSETUS MACRO CODE                                 00129700
.*******************************************************************    00129800
              LCLC  &M0M0001                 NAME                       00129900
&M0M0001      SETC  '&XLABEL'                SET NAME                   00130000
              AIF   (K'&XLABEL NE 0).XLAB2                              00130100
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00130200
.*                                                                      00130300
.XLAB2        ANOP  ,                                                   00130400
&M0M0001 DS    0H                             IXCSETUS-0                00130500
.*******************************************************************    00130600
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00130700
.*******************************************************************    00130800
              PUSH  PRINT                                               00130900
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00131000
              PRINT OFF         ++ PR01                                 00131100
              AGO   .ZPRNTXX                                            00131200
.ZPRINTX      PRINT ON                                                  00131300
.ZPRNTXX      ANOP  ,                                                   00131400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00131500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00131600
.********************************************************************   00131700
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00131800
.********************************************************************   00131900
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00132000
                      LCLA  &ZOPN1         INVOCATION INDEX             00132100
                      LCLC  &ZOPL(4095)    LABEL                        00132200
                      LCLC  &ZOPO(4095)    OPERATION                    00132300
                      LCLC  &ZOPV(4095)    VALUE                        00132400
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00132500
.*                                                                      00132600
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00132700
.******************************************************************     00132800
.***AL.L10 IXCSETUS FMT=LIST MF=S|L PARAMETERS                          00132900
.******************************************************************     00133000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00133100
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00133200
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00133300
&XMFATTR              SETC  '0D'                                        00133400
.*                                                                      00133500
&ZOPN                 SETA  &ZOPN+1                                     00133600
&ZOPL(&ZOPN)          SETC  ' '                                         00133700
&ZOPO(&ZOPN)          SETC  'B'                                         00133800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00133900
&ZOPD(&ZOPN)          SETC  '++ IXCSETUS ARG PARMS'                     00134000
.*                                                                      00134100
&ZOPN                 SETA  &ZOPN+1                                     00134200
&ZOPL(&ZOPN)          SETC  ' '                                         00134300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00134400
&ZOPV(&ZOPN)          SETC  '1'                                         00134500
&ZOPD(&ZOPN)          SETC  ' '                                         00134600
.*                                                                      00134700
.ZLMFSL2              ANOP  ,                                           00134800
.*-------------------------------------------------------------------   00134900
.***AM.L01  IXCSETUS FMT=LIST PARAMETERS                                00135000
&ZOPN                 SETA &ZOPN+1                                      00135100
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00135200
&ZOPO(&ZOPN)          SETC 'DS'                                         00135300
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00135400
&ZOPD(&ZOPN)          SETC '++ IXCSETUS PARM LIST'                      00135500
.*-------------------------------------------------------------------   00135600
.***AM.L02 XVERSION XL1                                                 00135700
&ZOPN                 SETA &ZOPN+1                                      00135800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00135900
&ZOPO(&ZOPN)          SETC 'DS'                                         00136000
&ZOPV(&ZOPN)          SETC 'XL1'                                        00136100
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00136200
.*-------------------------------------------------------------------   00136300
.***AM.L09  XSERVICE XL1                                                00136400
&ZOPN                 SETA &ZOPN+1                                      00136500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVICE'                         00136600
&ZOPO(&ZOPN)          SETC 'DS'                                         00136700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00136800
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XSERVICE'                      00136900
.*-------------------------------------------------------------------   00137000
.***AM.L09  XRSV0002 CL2                                                00137100
&ZOPN                 SETA &ZOPN+1                                      00137200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00137300
&ZOPO(&ZOPN)          SETC 'DS'                                         00137400
&ZOPV(&ZOPN)          SETC 'CL2'                                        00137500
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00137600
.*-------------------------------------------------------------------   00137700
.***AM.L09  XMEMTOKEN BL.64                                             00137800
&ZOPN                 SETA &ZOPN+1                                      00137900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMEMTOKEN'                        00138000
&ZOPO(&ZOPN)          SETC 'DS'                                         00138100
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00138200
&ZOPD(&ZOPN)          SETC '++ &ZXMEMTOKEN  XMEMTOKEN'                  00138300
.*-------------------------------------------------------------------   00138400
.***AM.L09 ADDR XNEWUS A                                                00138500
&ZOPN                 SETA &ZOPN+1                                      00138600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNEWUS_ADDR'                      00138700
&ZOPO(&ZOPN)          SETC 'DS'                                         00138800
&ZOPV(&ZOPN)          SETC 'A'                                          00138900
&ZOPD(&ZOPN)          SETC '++ &ZXNEWUS ADDR XNEWUS'                    00139000
.*-------------------------------------------------------------------   00139100
.***AM.L09 ALET XNEWUS F                                                00139200
&ZOPN                 SETA &ZOPN+1                                      00139300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNEWUS_ALET'                      00139400
&ZOPO(&ZOPN)          SETC 'DS'                                         00139500
&ZOPV(&ZOPN)          SETC 'F'                                          00139600
&ZOPD(&ZOPN)          SETC '++ &ZXNEWUS ALET XNEWUS'                    00139700
.*-------------------------------------------------------------------   00139800
.***AM.L09  XUSLEN F                                                    00139900
&ZOPN                 SETA &ZOPN+1                                      00140000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSLEN'                           00140100
&ZOPO(&ZOPN)          SETC 'DS'                                         00140200
&ZOPV(&ZOPN)          SETC 'F'                                          00140300
&ZOPD(&ZOPN)          SETC '++ &ZXUSLEN  XUSLEN'                        00140400
.*-------------------------------------------------------------------   00140500
.***AM.L09  XTARGET BL.64                                               00140600
&ZOPN                 SETA &ZOPN+1                                      00140700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTARGET'                          00140800
&ZOPO(&ZOPN)          SETC 'DS'                                         00140900
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00141000
&ZOPD(&ZOPN)          SETC '++ &ZXTARGET  XTARGET'                      00141100
.*-------------------------------------------------------------------   00141200
.***AM.L09 ADDR XCOMPUS A                                               00141300
&ZOPN                 SETA &ZOPN+1                                      00141400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPUS_ADDR'                     00141500
&ZOPO(&ZOPN)          SETC 'DS'                                         00141600
&ZOPV(&ZOPN)          SETC 'A'                                          00141700
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPUS ADDR XCOMPUS'                  00141800
.*-------------------------------------------------------------------   00141900
.***AM.L09 ALET XCOMPUS F                                               00142000
&ZOPN                 SETA &ZOPN+1                                      00142100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPUS_ALET'                     00142200
&ZOPO(&ZOPN)          SETC 'DS'                                         00142300
&ZOPV(&ZOPN)          SETC 'F'                                          00142400
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPUS ALET XCOMPUS'                  00142500
.*-------------------------------------------------------------------   00142600
.***AM.L09 ADDR XOLDUS A                                                00142700
&ZOPN                 SETA &ZOPN+1                                      00142800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOLDUS_ADDR'                      00142900
&ZOPO(&ZOPN)          SETC 'DS'                                         00143000
&ZOPV(&ZOPN)          SETC 'A'                                          00143100
&ZOPD(&ZOPN)          SETC '++ &ZXOLDUS ADDR XOLDUS'                    00143200
.*-------------------------------------------------------------------   00143300
.***AM.L09 ALET XOLDUS F                                                00143400
&ZOPN                 SETA &ZOPN+1                                      00143500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOLDUS_ALET'                      00143600
&ZOPO(&ZOPN)          SETC 'DS'                                         00143700
&ZOPV(&ZOPN)          SETC 'F'                                          00143800
&ZOPD(&ZOPN)          SETC '++ &ZXOLDUS ALET XOLDUS'                    00143900
.*-------------------------------------------------------------------   00144000
.***AM.L09 ADDR XECB A                                                  00144100
&ZOPN                 SETA &ZOPN+1                                      00144200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XECB_ADDR'                        00144300
&ZOPO(&ZOPN)          SETC 'DS'                                         00144400
&ZOPV(&ZOPN)          SETC 'A'                                          00144500
&ZOPD(&ZOPN)          SETC '++ &ZXECB ADDR XECB'                        00144600
.*-------------------------------------------------------------------   00144700
.***AM.L10 END OF IXCSETUS LIST PARAMETERS                              00144800
&ZOPN                 SETA &ZOPN+1                                      00144900
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00145000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00145100
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00145200
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00145300
.*                                                                      00145400
&ZOPN                 SETA &ZOPN+1                                      00145500
&ZOPL(&ZOPN)          SETC ' '                                          00145600
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00145700
&ZOPV(&ZOPN)          SETC '1'                                          00145800
&ZOPD(&ZOPN)          SETC ' '                                          00145900
.*-------------------------------------------------------------------   00146000
.***AL.L12 IXCSETUS FMT=LIST MF=S|L PARAMETERS                          00146100
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00146200
.*                                                                      00146300
&ZOPN                 SETA  &ZOPN+1                                     00146400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00146500
&ZOPO(&ZOPN)          SETC  'DC'                                        00146600
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00146700
&ZOPD(&ZOPN)          SETC  '++ IXCSETUS ARG PARMS'                     00146800
.*                                                                      00146900
.ZLMFSLX              ANOP  ,                                           00147000
.*-------------------------------------------------------------------   00147100
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00147200
&ZPLLEN               SETA 52                                           00147300
.*                                                                      00147400
.******************************************************************     00147500
.***AI.L01 IXCSETUS FMT=LIST FILL IN PARAMETER AREA                     00147600
.******************************************************************     00147700
                      ACTR  10000                                       00147800
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00147900
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00148000
&ZCVAL                SETC  'LAE'          XAX MODE                     00148100
.ZIMFXA               ANOP ,                                            00148200
.*                                                                      00148300
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00148400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00148500
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00148600
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00148700
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00148800
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00148900
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00149000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00149100
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00149200
&ZOPN                 SETA  &ZOPN+1                                     00149300
&ZOPL(&ZOPN)          SETC  ' '                                         00149400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00149500
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00149600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00149700
                      AGO   .ZIMFNX                                     00149800
.*                                                                      00149900
.ZIMFN2               ANOP ,                                            00150000
&ZOPN                 SETA  &ZOPN+1                                     00150100
&ZOPL(&ZOPN)          SETC  ' '                                         00150200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00150300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00150400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00150500
.ZIMFNX               ANOP ,                                            00150600
.********************************************************************   00150700
.***AI.L02 IXCSETUS FMT=LIST INITIALIZE PARAMETER AREA                  00150800
.********************************************************************   00150900
.***AI.L03 MF=(SLE)                                                     00151000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00151100
.*                                                                      00151200
&ZOPN                 SETA  &ZOPN+1                                     00151300
&ZOPL(&ZOPN)          SETC  ' '                                         00151400
&ZOPO(&ZOPN)          SETC  'XC'                                        00151500
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00151600
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00151700
.ZIMFLX               ANOP  ,                                           00151800
.*-------------------------------------------------------------------   00151900
.***AI.L53 XSERVICE XL1                                                 00152000
&ZOPN                 SETA  &ZOPN+1                                     00152100
&ZOPL(&ZOPN)          SETC  ' '                                         00152200
&ZOPO(&ZOPN)          SETC  'MVI'                                       00152300
&ZOPV(&ZOPN)          SETC  '1(1),6'                                    00152400
&ZOPD(&ZOPN)          SETC  '++ XL1 CONSTANT'                           00152500
.*-------------------------------------------------------------------   00152600
.***AI.L25  XMEMTOKEN XL8                                               00152700
                      AIF   ('&ZXMEMTOKEN' EQ '').ZI4E  NOT USED        00152800
                      AIF   ('&ZXMEMTOKEN' EQ 'OUTPUT').ZI4E            00152900
&ZCGPR                SETC  '&XMEMTOKEN'                                00153000
.*                                                                      00153100
                      AIF   ('&XMEMTOKEN'(1,1) NE '(').ZI4B             00153200
&ZCGPR   SETC  '0('.'&XMEMTOKEN'(2,K'&XMEMTOKEN-2).')'                  00153300
                      AGO   .ZI4D                                       00153400
.ZI4B                 ANOP  ,                                           00153500
.*                                                                      00153600
&ZC                   SETC  '&XMEMTOKEN'(1,1)                           00153700
                      AIF   (T'&ZC NE 'N').ZI4D                         00153800
&ZC                   SETC  '&XMEMTOKEN'                                00153900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI4D                00154000
&ZCGPR                SETC  '=BL8''&XMEMTOKEN'''                        00154100
.*                                                                      00154200
.ZI4D                 ANOP  ,                                           00154300
.*                                                                      00154400
&ZOPN                 SETA  &ZOPN+1                                     00154500
&ZOPL(&ZOPN)          SETC  ' '                                         00154600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00154700
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             00154800
&ZOPD(&ZOPN)          SETC  '++ &ZXMEMTOKEN XMEMTOKEN XL8'              00154900
.*                                                                      00155000
.ZI4E                 ANOP  ,                                           00155100
.*-------------------------------------------------------------------   00155200
.***AI.L19 ADDR XNEWUS A                                                00155300
                      AIF   ('&ZXNEWUS' EQ '').ZI5H  NOT USED           00155400
&ZCLNG                SETC  '&XNEWUS'                                   00155500
&ZCGPR                SETC  '14'                                        00155600
         AIF   ('&XNEWUS'(1,1) EQ '(').ZI5F  IN GPR                     00155700
.*                                                                      00155800
&ZOPN                 SETA  &ZOPN+1                                     00155900
&ZOPL(&ZOPN)          SETC  ' '                                         00156000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00156100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00156200
&ZOPD(&ZOPN)          SETC  '++ &ZXNEWUS XNEWUS A'                      00156300
.*                                                                      00156400
                      AGO   .ZI5G                                       00156500
.*                                                                      00156600
.ZI5F                 ANOP  ,                                           00156700
&ZCGPR   SETC  '&XNEWUS'(2,K'&XNEWUS-2)                                 00156800
.*                                                                      00156900
.ZI5G                 ANOP  ,                                           00157000
.*                                                                      00157100
&ZOPN                 SETA  &ZOPN+1                                     00157200
&ZOPL(&ZOPN)          SETC  ' '                                         00157300
&ZOPO(&ZOPN)          SETC  'ST'                                        00157400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00157500
&ZOPD(&ZOPN)          SETC  '++ &ZXNEWUS XNEWUS A'                      00157600
.*                                                                      00157700
.ZI5H                 ANOP  ,                                           00157800
.*-------------------------------------------------------------------   00157900
.***AI.L23 ALET XNEWUS F                                                00158000
         AIF   ('&ZXNEWUS' EQ '').ZI6G     NOT USED                     00158100
         AIF   ('&SYSASCE' EQ 'P').ZI6G    SYSSTATE PRIMARY             00158200
&ZCLNG                SETC  '&XNEWUS'                                   00158300
         AIF   ('&XNEWUS'(1,1) EQ '(').ZI6E  IN AR                      00158400
.*                                                                      00158500
&ZCGPR                SETC  '14'                                        00158600
                      AGO   .ZI6F                                       00158700
.*                                                                      00158800
.ZI6E                 ANOP  ,                                           00158900
&ZCGPR   SETC  '&XNEWUS'(2,K'&XNEWUS-2)                                 00159000
.*                                                                      00159100
.ZI6F                 ANOP  ,                                           00159200
.*                                                                      00159300
&ZOPN                 SETA  &ZOPN+1                                     00159400
&ZOPL(&ZOPN)          SETC  ' '                                         00159500
&ZOPO(&ZOPN)          SETC  'STAM'                                      00159600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,16(1)'                       00159700
&ZOPD(&ZOPN)          SETC  '++ &ZXNEWUS XNEWUS F'                      00159800
.*                                                                      00159900
.ZI6G                 ANOP  ,                                           00160000
.*-------------------------------------------------------------------   00160100
.***AI.L25  XUSLEN F                                                    00160200
                      AIF   ('&ZXUSLEN' EQ '').ZI7E  NOT USED           00160300
                      AIF   ('&ZXUSLEN' EQ 'OUTPUT').ZI7E               00160400
&ZCGPR                SETC  '&XUSLEN'                                   00160500
.*                                                                      00160600
                      AIF   ('&XUSLEN'(1,1) NE '(').ZI7B                00160700
&ZCGPR   SETC  '0('.'&XUSLEN'(2,K'&XUSLEN-2).')'                        00160800
                      AGO   .ZI7D                                       00160900
.ZI7B                 ANOP  ,                                           00161000
.*                                                                      00161100
&ZC                   SETC  '&XUSLEN'(1,1)                              00161200
                      AIF   (T'&ZC NE 'N').ZI7D                         00161300
&ZC                   SETC  '&XUSLEN'                                   00161400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00161500
&ZCGPR                SETC  '=FL4''&XUSLEN'''                           00161600
.*                                                                      00161700
.ZI7D                 ANOP  ,                                           00161800
.*                                                                      00161900
&ZOPN                 SETA  &ZOPN+1                                     00162000
&ZOPL(&ZOPN)          SETC  ' '                                         00162100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00162200
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00162300
&ZOPD(&ZOPN)          SETC  '++ &ZXUSLEN XUSLEN F'                      00162400
.*                                                                      00162500
.ZI7E                 ANOP  ,                                           00162600
.*-------------------------------------------------------------------   00162700
.***AI.L25  XTARGET XL8                                                 00162800
                      AIF   ('&ZXTARGET' EQ '').ZI8E  NOT USED          00162900
                      AIF   ('&ZXTARGET' EQ 'OUTPUT').ZI8E              00163000
&ZCGPR                SETC  '&XTARGET'                                  00163100
.*                                                                      00163200
                      AIF   ('&XTARGET'(1,1) NE '(').ZI8B               00163300
&ZCGPR   SETC  '0('.'&XTARGET'(2,K'&XTARGET-2).')'                      00163400
                      AGO   .ZI8D                                       00163500
.ZI8B                 ANOP  ,                                           00163600
.*                                                                      00163700
&ZC                   SETC  '&XTARGET'(1,1)                             00163800
                      AIF   (T'&ZC NE 'N').ZI8D                         00163900
&ZC                   SETC  '&XTARGET'                                  00164000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00164100
&ZCGPR                SETC  '=BL8''&XTARGET'''                          00164200
.*                                                                      00164300
.ZI8D                 ANOP  ,                                           00164400
.*                                                                      00164500
&ZOPN                 SETA  &ZOPN+1                                     00164600
&ZOPL(&ZOPN)          SETC  ' '                                         00164700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00164800
&ZOPV(&ZOPN)          SETC  '24(8,1),&ZCGPR'                            00164900
&ZOPD(&ZOPN)          SETC  '++ &ZXTARGET XTARGET XL8'                  00165000
.*                                                                      00165100
.ZI8E                 ANOP  ,                                           00165200
.*-------------------------------------------------------------------   00165300
.***AI.L18 ADDR XCOMPUS A                                               00165400
         AIF   ('&XCOMPUS' NE 'NO_COMPUS').ZI9                          00165500
&ZXCOMPUS             SETC  ''             RESET INPUT/OUTPUT           00165600
.ZI9                  ANOP  ,                                           00165700
.*-------------------------------------------------------------------   00165800
.***AI.L19 ADDR XCOMPUS A                                               00165900
                      AIF   ('&ZXCOMPUS' EQ '').ZI9H  NOT USED          00166000
&ZCLNG                SETC  '&XCOMPUS'                                  00166100
&ZCGPR                SETC  '14'                                        00166200
         AIF   ('&XCOMPUS'(1,1) EQ '(').ZI9F  IN GPR                    00166300
.*                                                                      00166400
&ZOPN                 SETA  &ZOPN+1                                     00166500
&ZOPL(&ZOPN)          SETC  ' '                                         00166600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00166700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00166800
&ZOPD(&ZOPN)          SETC  '++ &ZXCOMPUS XCOMPUS A'                    00166900
.*                                                                      00167000
                      AGO   .ZI9G                                       00167100
.*                                                                      00167200
.ZI9F                 ANOP  ,                                           00167300
&ZCGPR   SETC  '&XCOMPUS'(2,K'&XCOMPUS-2)                               00167400
.*                                                                      00167500
.ZI9G                 ANOP  ,                                           00167600
.*                                                                      00167700
&ZOPN                 SETA  &ZOPN+1                                     00167800
&ZOPL(&ZOPN)          SETC  ' '                                         00167900
&ZOPO(&ZOPN)          SETC  'ST'                                        00168000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,32(,1)'                             00168100
&ZOPD(&ZOPN)          SETC  '++ &ZXCOMPUS XCOMPUS A'                    00168200
.*                                                                      00168300
.ZI9H                 ANOP  ,                                           00168400
.*-------------------------------------------------------------------   00168500
.***AI.L18 ALET XCOMPUS F                                               00168600
         AIF   ('&XCOMPUS' NE 'NO_COMPUS').ZI10                         00168700
&ZXCOMPUS             SETC  ''             RESET INPUT/OUTPUT           00168800
.ZI10                 ANOP  ,                                           00168900
.*-------------------------------------------------------------------   00169000
.***AI.L23 ALET XCOMPUS F                                               00169100
         AIF   ('&ZXCOMPUS' EQ '').ZI10G   NOT USED                     00169200
         AIF   ('&SYSASCE' EQ 'P').ZI10G   SYSSTATE PRIMARY             00169300
&ZCLNG                SETC  '&XCOMPUS'                                  00169400
         AIF   ('&XCOMPUS'(1,1) EQ '(').ZI10E  IN AR                    00169500
.*                                                                      00169600
&ZCGPR                SETC  '14'                                        00169700
                      AGO   .ZI10F                                      00169800
.*                                                                      00169900
.ZI10E                ANOP  ,                                           00170000
&ZCGPR   SETC  '&XCOMPUS'(2,K'&XCOMPUS-2)                               00170100
.*                                                                      00170200
.ZI10F                ANOP  ,                                           00170300
.*                                                                      00170400
&ZOPN                 SETA  &ZOPN+1                                     00170500
&ZOPL(&ZOPN)          SETC  ' '                                         00170600
&ZOPO(&ZOPN)          SETC  'STAM'                                      00170700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,36(1)'                       00170800
&ZOPD(&ZOPN)          SETC  '++ &ZXCOMPUS XCOMPUS F'                    00170900
.*                                                                      00171000
.ZI10G                ANOP  ,                                           00171100
.*-------------------------------------------------------------------   00171200
.***AI.L19 ADDR XOLDUS A                                                00171300
                      AIF   ('&ZXOLDUS' EQ '').ZI11H  NOT USED          00171400
&ZCLNG                SETC  '&XOLDUS'                                   00171500
&ZCGPR                SETC  '14'                                        00171600
         AIF   ('&XOLDUS'(1,1) EQ '(').ZI11F  IN GPR                    00171700
.*                                                                      00171800
&ZOPN                 SETA  &ZOPN+1                                     00171900
&ZOPL(&ZOPN)          SETC  ' '                                         00172000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00172100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00172200
&ZOPD(&ZOPN)          SETC  '++ &ZXOLDUS XOLDUS A'                      00172300
.*                                                                      00172400
                      AGO   .ZI11G                                      00172500
.*                                                                      00172600
.ZI11F                ANOP  ,                                           00172700
&ZCGPR   SETC  '&XOLDUS'(2,K'&XOLDUS-2)                                 00172800
.*                                                                      00172900
.ZI11G                ANOP  ,                                           00173000
.*                                                                      00173100
&ZOPN                 SETA  &ZOPN+1                                     00173200
&ZOPL(&ZOPN)          SETC  ' '                                         00173300
&ZOPO(&ZOPN)          SETC  'ST'                                        00173400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,40(,1)'                             00173500
&ZOPD(&ZOPN)          SETC  '++ &ZXOLDUS XOLDUS A'                      00173600
.*                                                                      00173700
.ZI11H                ANOP  ,                                           00173800
.*-------------------------------------------------------------------   00173900
.***AI.L23 ALET XOLDUS F                                                00174000
         AIF   ('&ZXOLDUS' EQ '').ZI12G    NOT USED                     00174100
         AIF   ('&SYSASCE' EQ 'P').ZI12G   SYSSTATE PRIMARY             00174200
&ZCLNG                SETC  '&XOLDUS'                                   00174300
         AIF   ('&XOLDUS'(1,1) EQ '(').ZI12E  IN AR                     00174400
.*                                                                      00174500
&ZCGPR                SETC  '14'                                        00174600
                      AGO   .ZI12F                                      00174700
.*                                                                      00174800
.ZI12E                ANOP  ,                                           00174900
&ZCGPR   SETC  '&XOLDUS'(2,K'&XOLDUS-2)                                 00175000
.*                                                                      00175100
.ZI12F                ANOP  ,                                           00175200
.*                                                                      00175300
&ZOPN                 SETA  &ZOPN+1                                     00175400
&ZOPL(&ZOPN)          SETC  ' '                                         00175500
&ZOPO(&ZOPN)          SETC  'STAM'                                      00175600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,44(1)'                       00175700
&ZOPD(&ZOPN)          SETC  '++ &ZXOLDUS XOLDUS F'                      00175800
.*                                                                      00175900
.ZI12G                ANOP  ,                                           00176000
.*-------------------------------------------------------------------   00176100
.***AI.L18 ADDR XECB A                                                  00176200
         AIF   ('&XECB' NE 'NO_ECB').ZI13                               00176300
&ZXECB                SETC  ''             RESET INPUT/OUTPUT           00176400
.ZI13                 ANOP  ,                                           00176500
.*-------------------------------------------------------------------   00176600
.***AI.L19 ADDR XECB A                                                  00176700
                      AIF   ('&ZXECB' EQ '').ZI13H  NOT USED            00176800
&ZCLNG                SETC  '&XECB'                                     00176900
&ZCGPR                SETC  '14'                                        00177000
         AIF   ('&XECB'(1,1) EQ '(').ZI13F  IN GPR                      00177100
         AIF   ('&XECB'(1,1) EQ '0').ZI13B  BIT STRING                  00177200
         AIF   ('&XECB'(1,1) EQ '1').ZI13B  BIT STRING                  00177300
         AIF   (T'&XECB EQ 'N').ZI13C      SELF DEFINING TERM           00177400
                      AGO   .ZI13D                                      00177500
.ZI13B                ANOP  ,                                           00177600
&ZCLNG                SETC  '=BL4''&XECB'''                             00177700
                      AGO   .ZI13D                                      00177800
.ZI13C                ANOP  ,                                           00177900
&ZCLNG                SETC  '=&XECB'                                    00178000
.ZI13D                ANOP  ,                                           00178100
.*                                                                      00178200
&ZOPN                 SETA  &ZOPN+1                                     00178300
&ZOPL(&ZOPN)          SETC  ' '                                         00178400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00178500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00178600
&ZOPD(&ZOPN)          SETC  '++ &ZXECB XECB A'                          00178700
.*                                                                      00178800
                      AGO   .ZI13G                                      00178900
.*                                                                      00179000
.ZI13F                ANOP  ,                                           00179100
&ZCGPR   SETC  '&XECB'(2,K'&XECB-2)                                     00179200
.*                                                                      00179300
.ZI13G                ANOP  ,                                           00179400
.*                                                                      00179500
&ZOPN                 SETA  &ZOPN+1                                     00179600
&ZOPL(&ZOPN)          SETC  ' '                                         00179700
&ZOPO(&ZOPN)          SETC  'ST'                                        00179800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,48(,1)'                             00179900
&ZOPD(&ZOPN)          SETC  '++ &ZXECB XECB A'                          00180000
.*                                                                      00180100
.ZI13H                ANOP  ,                                           00180200
.*-------------------------------------------------------------------   00180300
&ZOPN1                SETA &ZOPN                                        00180400
.*******************************************************************    00180500
.***  PROCESS IXCSETUS OUTPUT PARAMETERS                                00180600
.*******************************************************************    00180700
                      ACTR  10000                                       00180800
.*******************************************************************    00180900
.***AO.X02  RETURN CODE PROCESSING                                      00181000
.*******************************************************************    00181100
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00181200
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00181300
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00181400
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00181500
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00181600
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00181700
&ZOPN                 SETA  &ZOPN+1                                     00181800
&ZOPL(&ZOPN)          SETC  ' '                                         00181900
&ZOPO(&ZOPN)          SETC  'ST'                                        00182000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00182100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00182200
                      AGO   .ZMRETX                                     00182300
.*                                                                      00182400
.ZMRET2               ANOP  ,                                           00182500
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00182600
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00182700
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00182800
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00182900
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00183000
&ZOPN                 SETA  &ZOPN+1                                     00183100
&ZOPL(&ZOPN)          SETC  ' '                                         00183200
&ZOPO(&ZOPN)          SETC  'LR'                                        00183300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00183400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00183500
.ZMRETX               ANOP  ,                                           00183600
.*******************************************************************    00183700
.***AO.X03  REASON CODE PROCESSING                                      00183800
.*******************************************************************    00183900
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00184000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00184100
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00184200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00184300
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00184400
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00184500
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00184600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00184700
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00184800
&ZOPN                 SETA  &ZOPN+1                                     00184900
&ZOPL(&ZOPN)          SETC  ' '                                         00185000
&ZOPO(&ZOPN)          SETC  'ST'                                        00185100
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00185200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00185300
                      AGO   .ZMRSNX                                     00185400
.*                                                                      00185500
.ZMRSN2               ANOP  ,                                           00185600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00185700
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00185800
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00185900
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00186000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00186100
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00186200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00186300
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00186400
&ZOPN                 SETA  &ZOPN+1                                     00186500
&ZOPL(&ZOPN)          SETC  ' '                                         00186600
&ZOPO(&ZOPN)          SETC  'LR'                                        00186700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00186800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00186900
.ZMRSNX               ANOP  ,                                           00187000
.*******************************************************************    00187100
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00187200
.*******************************************************************    00187300
.ZMFLX                ANOP  ,              MF=L PROCESSING              00187400
.*******************************************************************    00187500
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00187600
.*******************************************************************    00187700
                      ACTR  10000                                       00187800
.*                                                                      00187900
                      LCLA  &ZLC           COLUMN POSITION              00188000
                      LCLA  &ZOPX          LIST TABLE INDEX             00188100
                      LCLC  &ZLL           LABEL                        00188200
                      LCLC  &ZLOP          OPERATION                    00188300
                      LCLC  &ZLV           VALUE                        00188400
                      LCLC  &ZLD           DESCRIPTION                  00188500
.*                                                                      00188600
&ZOPX                 SETA  1                                           00188700
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00188800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00188900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00189000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00189100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00189200
                      AIF   (K'&ZLD LE 0).ZL5                           00189300
&ZLC                  SETA  35             COMMENT COLUMN               00189400
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00189500
&ZLC                  SETA  33             COMMMENT COLUMN              00189600
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00189700
&ZLV                  SETC  '&ZLV'.' '                                  00189800
                      AGO   .ZL3                                        00189900
.*                                                                      00190000
.ZL4                  ANOP  ,                                           00190100
&ZLV                  SETC  '&ZLV'.' '                                  00190200
.ZL5                  ANOP  ,                                           00190300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00190400
.*                                                                      00190500
&ZLL     &ZLOP &ZLV                                                     00190600
.*                                                                      00190700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00190800
                      AGO   .ZL2           CONTINUE LOOPING             00190900
.*                                                                      00191000
.ZLX                  ANOP  ,                                           00191100
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00191200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00191300
         L     14,16(0,0)              GET CVT ADDRESS                  00191400
         L     14,772(14,0)            GET SFT ADDRESS                  00191500
         L     14,220(14,0)            GET LX FOR SERVICE ROUTINE       00191600
         LA    15,2                    GET EX FOR SERVICE ROUTINE       00191700
         OR    14,15                   GET PC NUMBER                    00191800
         PC    0(14)                                                    00191900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00192000
.ZLINKX               ANOP  ,                                           00192100
.*******************************************************************    00192200
.***AP.X01  FORMAT GENERATED CODE                                       00192300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00192400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00192500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00192600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00192700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00192800
                      AIF   (K'&ZLD LE 0).ZL51                          00192900
&ZLC                  SETA  35             COMMENT COLUMN               00193000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00193100
&ZLC                  SETA  33             COMMENT COLUMN               00193200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00193300
&ZLV                  SETC  '&ZLV'.' '                                  00193400
                      AGO   .ZL31                                       00193500
.*                                                                      00193600
.ZL41                 ANOP  ,                                           00193700
&ZLV                  SETC  '&ZLV'.' '                                  00193800
.ZL51                 ANOP  ,                                           00193900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00194000
.*                                                                      00194100
&ZLL     &ZLOP &ZLV                                                     00194200
.*                                                                      00194300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00194400
                      AGO   .ZL21          CONTINUE LOOPING             00194500
.*                                                                      00194600
.ZLX1                 ANOP  ,                                           00194700
.*******************************************************************    00194800
.***AP.X02  END OF IXCSETUS MACRO                                       00194900
&ZIXCSETUS            SETC  'YES'          SET IXCSETUS USED            00195000
         POP   PRINT                                                    00195100
*                                            IXCSETUS-0                 00195200
         SPACE 1                                                        00195300
.ZLX2                 ANOP  ,                                           00195400
         MEND                                                           00195500
**********************************************************************/ 00195600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00195700
*%IXCSETUS: MACRO KEYS(MEMTOKEN,NEWUS,USLEN,TARGET,COMPUS,OLDUS,ECB,    00195800
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00195900
*  ANS('?'||MACLABEL||' '||'IXCSETUP '||MACLIST||                       00196000
*         ' '||MACKEYS||';') COL(MACLMAR);                              00196100
*%END IXCSETUS;                                                         00196200
