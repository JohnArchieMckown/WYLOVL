* /*******************************************************************/ 00050000
* /*                                                                 */ 00100000
* /* MACRO-NAME = ATTACH7                                            */ 00150000
* /*                                                                 */ 00200000
* /* COPYRIGHT = 5740-XC6 COPYRIGHT IBM CORP. 1981,                  */ 00250000
* /*             LICENSED MATERIAL-PROGRAM, PROPERTY OF IBM,         */ 00300000
* /*             REFER TO COPYRIGHT INSTRUCTIONS FORM G120-2083.     */ 00350000
* /*                                                                 */ 00400000
* /* STATUS = OS/VS2 HBB2102                                         */ 00450000
* /*                                                                 */ 00500000
* /* FUNCTION = DOWNWARD COMPATIBLE VERSION OF THE ATTACH MACRO      */ 00550000
* /*            (EQUIVALENT TO THE JBB1326 VERSION).                 */ 00600000
* /*                                                                 */ 00650000
* /* CHANGE ACTIVITY =                                               */ 00700000
* /*           @G860PXZ - HBB2102 SUPPORT                            */ 00750000
* /*                                                                 */ 00800000
* /*******************************************************************/ 00850000
         MACRO                                                          00900000
&NAME    ATTACH7 &EP=,&EPLOC=,&DE=,&DCB=,&PARAM=,&VL=,&ECB=,       I270X00950000
               &GSPV=,&KEY=PROP,&GSPL=,&SHSPL=,&ETXR=,&LPMOD=,     I270X01000000
               &DPMOD=,&MF=I,&SF=I,&SHSPV=,&SM=PROB,&SZERO=YES,    I270X01050000
               &JSTCB=NO,&SVAREA=YES,&ROLL=(YES,NO),&HIARCHY=,     I270X01100000
               &JSCB=,&GIVEJPQ=NO,&TASKLIB=,&TSLOGON=NO,          20021X01150000
               &STAI=,&PURGE=,&ASYNCH=,                          Y02752X01200000
               &ESTAI=,&TERM=NO,&NSHSPL=,&NSHSPV=,&RSAPF=NO,   @Z40RP9BX01250000
               &RELATED=,                                              X01300000
               &LSQA=0,&DISP=YES,&TID=0,&TQE=,&FPREGSA=          X02050 01350000
.*A000000-999999                                               @G860PXZ 01400000
         GBLB  &IHBSWA,&IHBSWB                                          01450000
         GBLC  &IHBNO                                                   01500000
         LCLA  &A,&E,&F,&G,&L,&K,&X,&NUMB                               01550000
         LCLA  &NUMB1,&NUMB2,&NUMB3,&NUMB4                       Y02752 01600000
         LCLB  &SWSTAI,&SWESTAI                                  Y02752 01650000
         LCLC  &STAITYP,&STXADDR,&STPADDR                        Y02752 01700000
         LCLC  &H,&CHAR,&PARA,&FUDGE,&GNAME                             01750000
* /* MACDATE 06/29/81                                                */ 01800000
* /*                                                                    01850000
&SWSTAI  SETB  ('&STAI(1)' NE '' )   SWITCH VALUE 1 IF STAI      Y02752 01900000
&SWESTAI SETB  ('&ESTAI(1)' NE '' )  SWITCH VALUE 1 IF ESTAI     Y02752 01950000
         AIF   (&SWSTAI AND &SWESTAI).ERSTAI                     Y02752 02000000
         AIF   (NOT &SWESTAI).STTYP1                             Y02752 02050000
         AIF   (N'&ESTAI GT 2).ERROR                             Y02752 02100000
&STXADDR SETC  '&ESTAI(1)'        EXIT RTN ADDR                  Y02752 02150000
&STPADDR SETC  '&ESTAI(2)'        PARM LIST FOR EXIT RTN         Y02752 02200000
&STAITYP SETC  'ESTAI'                                           Y02752 02250000
         AGO   .STTYP2                                           Y02752 02300000
.STTYP1  AIF   (NOT &SWSTAI).STTYP2                              Y02752 02350000
         AIF   (N'&STAI GT 2).ERROR                              Y02752 02400000
&STXADDR SETC  '&STAI(1)'         EXIT RTN ADDR                  Y02752 02450000
&STPADDR SETC  '&STAI(2)'         PARM LIST FOR EXIT RTN         Y02752 02500000
&STAITYP SETC  'STAI'                                            Y02752 02550000
.STTYP2  ANOP                                                    Y02752 02600000
&IHBNO   SETC  '306'                                                    02650000
 AIF ('&HIARCHY' NE '' AND '&HIARCHY' NE '0'                           *02700000
               AND '&HIARCHY' NE '1').ERRHID                       LCS1 02750000
         AIF   ('&MF' EQ 'L' OR('&SF' EQ 'L' AND '&MF(1)' EQ 'E')).E1   02800000
         AIF   ('&SF' EQ 'L' AND '&PARAM' NE '').ERROR2                 02850000
         AIF   ('&EP' NE '' AND '&EPLOC' NE '').ERROR4                  02900000
         AIF   ('&EP' NE '' AND '&DE' NE '').ERROR4                     02950000
         AIF   ('&DE' NE '' AND '&EPLOC' NE '').ERROR4                  03000000
         AIF   ('&LPMOD' EQ '').CONTAAA                                 03050000
         AIF   ('&LPMOD'(1,1) EQ '-').ERROR7                            03100000
.CONTAAA ANOP                                                           03150000
         AIF   ('&DISP' NE 'YES' AND '&DISP' NE 'NO').ERDISP            03200000
         AIF   ('&LSQA' NE '0' AND (&SWSTAI OR &SWESTAI)).E2     Y02752 03250000
         AIF   ('&LSQA' NE '0' AND '&PURGE' NE '' ).E3           Y02752 03300000
         AIF   ('&LSQA' NE '0' AND '&ASYNCH' NE '' ).E4          Y02752 03350000
         AIF   ('&LSQA' NE '0' AND ('&SZERO' NE 'NO')).E5               03400000
         AIF   ('&GIVEJPQ' NE 'NO' AND '&LSQA' NE '0').E6               03450000
         AIF   ('&LSQA' NE '0' AND '&GSPV' NE '').E7                    03500000
         AIF   ('&LSQA' NE '0' AND '&GSPL' NE '').E8                    03550000
         AIF   ('&LSQA' NE '0' AND '&SHSPV' NE '').E9                   03600000
         AIF   ('&LSQA' NE '0' AND '&SHSPL' NE '').E10                  03650000
         AIF   ('&TQE' NE 'YES' AND '&TQE' NE 'NO' AND '&TQE' NE '').ERX03700000
               TQE                                               X02050 03750000
         AIF   ('&FPREGSA' NE 'YES' AND '&FPREGSA' NE 'NO' AND '&FPREGSX03800000
               A' NE '').ERFP                                    X02050 03850000
         AIF   ('&NSHSPL' NE '' AND '&NSHSPV' NE '').ERNSHSP     Y02752 03900000
         AIF   ('&TERM' NE 'YES' AND '&TERM' NE 'NO').ERTERM     Y02752 03950000
.* HERE INITIALIZE VARIABLES &NUMB,&NUMB1,&NUMB2,&NUMB3,&NUMB4   Y02752 04000000
.* THESE MUST NOT BE ALTERED ONCE SET.                           Y02752 04050000
.* BYTE AT OFFSET DECIMAL 27 IS DEFINED BY &NUMB                 Y02752 04100000
         AIF   ('&DISP' EQ 'YES').NUMBX1                         Y02752 04150000
&NUMB    SETA  (&NUMB+128)        DISP=NO FLAG SET TO 1          Y02752 04200000
.NUMBX1  ANOP                                                    Y02752 04250000
         AIF   ('&JSCB' EQ '').NUMBX2                            Y02752 04300000
&NUMB    SETA  (&NUMB+64)         JSCB ADDRESS SPECIFIED FLAG    Y02752 04350000
.NUMBX2  ANOP                                                    Y02752 04400000
         AIF   ('&GIVEJPQ' EQ 'NO').NUMBX3                       Y02752 04450000
&NUMB    SETA  (&NUMB+32)         GIVEJPQ=YES FLAG SET TO 1      Y02752 04500000
.NUMBX3  ANOP                                                    Y02752 04550000
         AIF   ('&KEY' EQ 'PROP').NUMBX4                         Y02752 04600000
&NUMB    SETA  (&NUMB+16)         KEY=ZERO FLAG ON               Y02752 04650000
.NUMBX4  ANOP                                                    Y02752 04700000
         AIF   ('&SZERO' EQ 'YES').NUMBX5                        Y02752 04750000
&NUMB    SETA  (&NUMB+8)          SZERO=NO FLAG SET TO 1         Y02752 04800000
.NUMBX5  ANOP                                                    Y02752 04850000
         AIF   ('&SVAREA' EQ 'YES').NUMBX6                       Y02752 04900000
&NUMB    SETA  (&NUMB+4)          SVAREA=NO FLAG SET TO 1        Y02752 04950000
.NUMBX6  ANOP                                                    Y02752 05000000
         AIF   ('&JSTCB' NE 'YES').NUMBX7                        Y02752 05050000
&NUMB    SETA  (&NUMB+2)          JSTCB=YES FLAG SET TO 1        Y02752 05100000
.NUMBX7  ANOP                                                    Y02752 05150000
         AIF   ('&SM' NE 'SUPV').NUMBX8                          Y02752 05200000
&NUMB    SETA  (&NUMB+1)          SM=SUPV FLAG ON                Y02752 05250000
.NUMBX8  ANOP                     BYTE IS COMPLETE               Y02752 05300000
.* BYTE AT OFFSET DECIMAL 8 IS DEFINED BY &NUMB1                 Y02752 05350000
&NUMB1   SETA  8                  OS/VS2 REL 2 EXTNDED PARM LIST Y02752 05400000
         AIF   ('&TSLOGON' NE 'YES').NUMB1X1                     Y02752 05450000
&NUMB1   SETA  (&NUMB1+4)         TSLOGON=YES FLAG ON            Y02752 05500000
.NUMB1X1 ANOP                                                    Y02752 05550000
         AIF   ('&TASKLIB' EQ '').NUMB1X2                        Y02752 05600000
&NUMB1   SETA  (&NUMB1+2)         TASKLIB ADDRESS SPECIFIED FLAG Y02752 05650000
.NUMB1X2 ANOP                                                    Y02752 05700000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).NUMB1X3              Y02752 05750000
&NUMB1   SETA  (&NUMB1+1)         FLAG FOR STAI OR ESTAI         Y02752 05800000
.NUMB1X3 ANOP                     BYTE IS COMPLETE               Y02752 05850000
.* BYTE AT OFFSET DECIMAL 20 IS DEFINED BY &NUMB2                Y02752 05900000
         AIF   ('&TQE' NE 'NO').NUMB2X1                          Y02752 05950000
&NUMB2   SETA  (&NUMB2+128)       BIT0=1 FOR TQE=NO, OS/VS1 ONLY Y02752 06000000
         AGO   .NUMB2X3                                          Y02752 06050000
.NUMB2X1 ANOP                                                    Y02752 06100000
         AIF   ('&TQE' NE 'YES').NUMB2X3                         Y02752 06150000
&NUMB4   SETA  128                FOR TQE BIT OFF                Y02752 06200000
.NUMB2X3 ANOP                                                    Y02752 06250000
         AIF   ('&FPREGSA' NE 'NO').NUMB2X2                      Y02752 06300000
&NUMB2   SETA  (&NUMB2+64)        BIT1=1, FPREGSA=NO,OS/VS1 ONLY Y02752 06350000
         AGO   .NUMB2X4                                          Y02752 06400000
.NUMB2X2 ANOP                                                    Y02752 06450000
         AIF   ('&FPREGSA' NE 'YES').NUMB2X4                     Y02752 06500000
&NUMB4   SETA  (&NUMB4+64)        FOR FPREGSA BIT OFF            Y02752 06550000
.NUMB2X4 ANOP                                                    Y02752 06600000
&NUMB2   SETA  (&NUMB2+32)        BIT2=1 FOR OS/VS2 REL 1 LIST   Y02752 06650000
&NUMB4   SETA  (255-&NUMB4)       FOR RESETTING TQE,FPREGSA BITS Y02752 06700000
.* BYTE AT OFFSET DECIMAL 44 IS DEFINED BY &NUMB3                Y02752 06750000
         AIF   (NOT (&SWSTAI OR &SWESTAI)  ).NUMB3X1             Y02752 06800000
.* PURGE BITS (BITS 6 AND 7) ARE 00, CORRECT FOR PURGE=QUIESCE   Y02752 06850000
         AIF   ('&PURGE' EQ '').NOPRGE                           Y02752 06900000
         AIF   ('&PURGE' EQ 'QUIESCE').PRGEOK                    Y02752 06950000
&NUMB3   SETA  1                  SET TO PURGE=HALT FLAGS        Y02752 07000000
         AIF   ('&PURGE' EQ 'HALT').PRGEOK                       Y02752 07050000
&NUMB3   SETA  2                  SET TO PURGE=NONE FLAGS        Y02752 07100000
         AIF   ('&PURGE' EQ 'NONE').PRGEOK                       Y02752 07150000
         AGO   .ERROZ             INVALED PURGE OPERAND          Y02752 07200000
.NOPRGE  ANOP                     &NUMB3 IS SET TO QUIESCE       Y02752 07250000
         AIF   (&SWSTAI).PRGEOK   CORRECT DEFAULT FOR STAI       Y02752 07300000
&NUMB3   SETA  2                  SET TO NONE, DEFAULT FOR ESTAI Y02752 07350000
.PRGEOK  ANOP                     PURGE BITS ARE SET CORRECTLY   Y02752 07400000
         AIF   ('&ASYNCH' EQ '').NOASYNC                         Y02752 07450000
         AIF   ('&ASYNCH' EQ 'NO').ASYNCOK                       Y02752 07500000
&NUMB3   SETA  (&NUMB3+4)         SET ASYNCH=YES FLAG            Y02752 07550000
         AIF   ('&ASYNCH' EQ 'YES').ASYNCOK                      Y02752 07600000
         AGO   .ERROZ             INVALID ASYNCH OPERAND         Y02752 07650000
.NOASYNC ANOP                     CHECK DEFAULTS                 Y02752 07700000
         AIF   (&SWSTAI).ASYNCOK  ASYNCH=NO IS STAI DEFAULT      Y02752 07750000
&NUMB3   SETA  (&NUMB3+4)         ASYNCH=YES IS ESTAI DEFAULT    Y02752 07800000
.ASYNCOK ANOP                     ASYNCH BIT IS SET CORRECTLY    Y02752 07850000
         AIF   (&SWSTAI).NUMB3X1  TERM AND ESTAI FLAGS NOT SET   Y02752 07900000
&NUMB3   SETA  (&NUMB3+8)         BIT4=1 FOR ESTAI               Y02752 07950000
         AIF   ('&TERM' EQ 'NO').NUMB3X1                         Y02752 08000000
&NUMB3   SETA  (&NUMB3+16)        BIT3=1 FOR TERM=YES            Y02752 08050000
.NUMB3X1 ANOP                     BYTE IS COMPLETE               Y02752 08100000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          08150000
&IHBSWA  SETB  ('&VL' EQ '1')                                           08200000
&IHBSWB  SETB  ('&SF' EQ '(E,(15))')                                    08250000
         AIF   ('&NAME' EQ '' OR '&SF' EQ 'L').CONTAA                   08300000
&NAME    DS    0H                                                       08350000
.CONTAA  AIF   ('&PARAM' EQ '' AND '&MF(1)' NE 'E').CONTA               08400000
         IHBOPLST ,&PARAM,MF=&MF                                        08450000
.CONTA   AIF   ('&SF' EQ 'I').IROUT                                     08500000
         AIF   ('&SF' EQ 'L').LROUT                                     08550000
         AIF   (N'&SF NE 2).ERROR3                                      08600000
         AIF   ('&SF(1)' NE 'E').ERROR3                                 08650000
         AIF   ('&SF'(4,1) EQ '(').ISAREG                               08700000
         LA    15,&SF(2)                         LOAD LIST ADDR INTO 15 08750000
         AGO   .CONTB                                                   08800000
.E1      IHBERMAC 35,&IHBNO,&MF,,,0                              Y02752 08850000
         MEXIT                                                          08900000
.ERROR2  IHBERMAC 71,&IHBNO,&PARAM                                      08950000
         MEXIT                                                          09000000
.ERROR3  IHBERMAC 41,&IHBNO,&SF,,,0                              Y02752 09050000
         MEXIT                                                          09100000
.ERROR4  IHBERMAC 88,&IHBNO                                             09150000
         MEXIT                                                          09200000
.ERROR5  IHBERMAC 72,&IHBNO                                             09250000
         MEXIT                                                          09300000
.ERROR6  IHBERMAC 31,&IHBNO                                             09350000
         MEXIT                                                          09400000
.ERROR7  IHBERMAC 240,,LPMOD                                            09450000
         MEXIT                                                          09500000
.ERRHID IHBERMAC 195                                                    09550000
         MEXIT                                                          09600000
.ISAREG  AIF   ('&SF(2)' EQ '(15)').CONTB                               09650000
&A       SETA  K'&SF-6                                                  09700000
&H       SETC  '&SF'(5,&A)                                              09750000
         LR    15,&H                             LOAD LIST ADDR INTO 15 09800000
.CONTB   ANOP                                                           09850000
.* E FORM MUST ALLOW SETTING OF ALL FIELDS, SO THAT A LIST FORM  Y02752 09900000
.* OF ALL ZEROS IS ACCEPTABLE. EXTENDED PARM LIST BITS AND       Y02752 09950000
.* LENGTH FIELD MUST BE SET.                                     Y02752 10000000
         AIF   ('&EP' EQ '').CONTC                                      10050000
         LA    14,28(15,0)                       PICK UP EP ADDRESS     10100000
         ST    14,0(15,0)                        INSERT EP ADDR IN LIST 10150000
         MVC   28(8,15),*+10                     MOVE EP SYMB INTO LIST 10200000
         B     *+12                              BRANCH AROUND EP SYMB. 10250000
         DC    CL8'&EP'                          EP SYMBOL              10300000
         AGO   .CONTE                                                   10350000
.CONTC   AIF   ('&EPLOC' EQ '').CONTD                                   10400000
         AIF   ('&EPLOC'(1,1) EQ '(').ISAREGA                           10450000
         LA    14,&EPLOC                         PICK UP EPLOC ADDRESS  10500000
         ST    14,0(15,0)                        INSERT EPLOC INTO LIST 10550000
         AGO   .CONTE                                                   10600000
.ISAREGA ST    &EPLOC(1),0(15,0)                 INSERT EPLOC INTO LIST 10650000
         AGO   .CONTE                                                   10700000
.CONTD   AIF   ('&DE' EQ '').CONTE                                      10750000
         AIF   ('&DE'(1,1) EQ '(').ISAREGB                              10800000
         LA    14,&DE                            PICK UP DE ADDRESS     10850000
         ST    14,0(15,0)                        INSERT DE INTO LIST    10900000
         MVI   0(15),X'80'                       SET BIT INDICATING DE  10950000
         AGO   .CONTE                                                   11000000
.ISAREGB ST    &DE(1),0(15,0)                    INSERT DE INTO LIST    11050000
         MVI   0(15),X'80'                       SET BIT INDICATING DE  11100000
.CONTE   AIF   ('&DCB' EQ '').CONHID                                    11150000
         AIF   ('&DCB'(1,1) EQ '(').ISAREGC                             11200000
         LA    14,&DCB             PICK UP DCB ADDRESS                  11250000
         STCM  14,7,5(15)          STORE DCB INTO LIST                  11300000
         AGO   .CONHID                                                  11350000
.ISAREGC STCM  &DCB(1),7,5(15)     STORE INTO LIST                      11400000
.* BITS 6 AND 7 OF BYTE 4 PREVIOUSLY DEFINED FOR HIARCHY PARM    Y02752 11450000
.CONHID  ANOP                                                    Y02752 11500000
.CONTF   AIF   ('&ECB' EQ '').CONTG                                     11550000
         AIF   ('&ECB'(1,1) EQ '(').ISAREGD                             11600000
         LA    14,&ECB                           PICK UP ECB ADDRESS    11650000
         STCM  14,7,9(15)                        INSERT ECB INTO LIST   11700000
         AGO   .CONTG                                                   11750000
.ISAREGD STCM  &ECB(1),7,9(15)                 INSERT ECB INTO LIST     11800000
.CONTG   ANOP                                                    Y02752 11850000
         OI    8(15),&NUMB1       SET FLAG BYTE                  Y02752 11900000
         AIF   ('&GSPV' EQ '').CONTH                                    11950000
         AIF   ('&GSPV'(1,1) EQ '(').ISAREGE                            12000000
         LA    14,&GSPV.(0,0)                    PICK UP GSPV VALUE     12050000
         ST    14,12(15,0)                       INSERT GSPV INTO LIST  12100000
         AGO   .CONTI                                                   12150000
.ISAREGE ST    &GSPV(1),12(15,0)                 INSERT GSPV INTO LIST  12200000
         AGO   .CONTI                                                   12250000
.CONTH   AIF   ('&GSPL' EQ '').CONTI                                    12300000
         AIF   ('&GSPL'(1,1) EQ '(').ISAREGF                            12350000
         LA    14,&GSPL                          PICK UP GSPL ADDRESS   12400000
         ST    14,12(15,0)                       INSERT GSPL INTO LIST  12450000
         MVI   12(15),X'01'                      SET LIST BIT ON        12500000
         AGO   .CONTI                                                   12550000
.ISAREGF ST    &GSPL(1),12(15,0)                 INSERT GSPL INTO LIST  12600000
         MVI   12(15),X'01'                      SET LIST BIT ON        12650000
.CONTI   AIF   ('&SHSPV' EQ '').CONTK                                   12700000
         AIF   ('&SHSPV'(1,1) EQ '(').ISAREGG                           12750000
         LA    14,&SHSPV.(0,0)                   PICK UP SHSPV VALUE    12800000
         ST    14,16(15,0)                       INSERT SHSPV INTO LIST 12850000
         AGO   .CONTL                                                   12900000
.ISAREGG ST    &SHSPV(1),16(15,0)                INSERT SHSPV INTO LIST 12950000
         AGO   .CONTL                                                   13000000
.CONTK   AIF   ('&SHSPL' EQ '').CONTL                                   13050000
         AIF   ('&SHSPL'(1,1) EQ '(').ISAREGH                           13100000
         LA    14,&SHSPL                         PICK UP SHSPL ADDRESS  13150000
         ST    14,16(15,0)                       INSERT SHSPL INTO LIST 13200000
         MVI   16(15),X'01'                      SET LIST BIT ON        13250000
         AGO   .CONTL                                                   13300000
.ISAREGH ST    &SHSPL(1),16(15,0)                INSERT SHSPL INTO LIST 13350000
         MVI   16(15),X'01'                      SET LIST BIT ON        13400000
.CONTL   AIF   ('&ETXR' EQ '').CONTN                                    13450000
         AIF   ('&ETXR'(1,1) EQ '(').ISAREGI                            13500000
         LA    14,&ETXR                          PICK UP ETXR ADDRESS   13550000
         STCM  14,7,21(15)             INSERT ETXR IN LIST              13600000
         AGO   .CONTN                                                   13650000
.ISAREGI STCM  &ETXR(1),7,21(15)       INSERT ETXR IN LIST              13700000
.CONTN   ANOP                                                           13750000
.CONTN0  AIF   ('&DPMOD' EQ '').CONTO                              RORI 13800000
         AIF   ('&DPMOD'(1,1) EQ '(').ISAREGJ                           13850000
         B     *+6                               BRANCH AROUND DPMOD    13900000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNA     13950000
         DC    AL2(&DPMOD)                       DPMOD VALUE            14000000
         MVC   24(2,15),*-2                      INSERT DPMOD IN LIST   14050000
         AGO   .CONTO                                                   14100000
.SIGNA   DC    AL2(0&DPMOD)                      DPMOD VALUE            14150000
         MVC   24(2,15),*-2                      INSERT DPMOD IN LIST   14200000
         AGO   .CONTO                                                   14250000
.ISAREGJ STH   &DPMOD(1),24(15,0)                INSERT DPMOD IN LIST   14300000
.CONTO   AIF   ('&LPMOD' EQ '').CONTP                                   14350000
         AIF   ('&LPMOD'(1,1) EQ '(').ISAREGK                           14400000
         MVI   26(15),&LPMOD                     INSERT LPMOD IN LIST   14450000
         AGO   .CONTP                                                   14500000
.ISAREGK STC   &LPMOD(1),26(15,0)                INSERT LPMOD IN LIST   14550000
.CONTP   ANOP                                                      I270 14600000
.* BITS 6 AND 7 OF BYTE 20 PREVIOUSLY DEFINED FOR ROLL PARMS     Y02752 14650000
         AIF   (&NUMB4 EQ 255).TQEFPR1                           Y02752 14700000
         NI    20(15),&NUMB4      SET TQE AND/OR FPREGSA OFF     Y02752 14750000
.TQEFPR1 ANOP                                                    X02050 14800000
         OI    20(15),&NUMB2      OS/VS2 LIST, TQE,FPREGSA       Y02752 14850000
         AIF   (&NUMB EQ 0).LSQA1                                       14900000
         OI    27(15),&NUMB                                             14950000
.LSQA1   AIF   ('&LSQA' EQ '0').JSCB1                                   15000000
         AIF   ('&LSQA'(1,1) EQ '(').ISAREGL                            15050000
         MVI   36(15),&LSQA        INSERT LSQA IN LIST                  15100000
         AGO   .JSCB1                                                   15150000
.ISAREGL STC   &LSQA(1),36(15,0)   INSERT LSQA IN LIST           YM1995 15200000
.JSCB1   AIF   ('&JSCB' EQ '').CONTQ5                                   15250000
         AIF   ('&JSCB'(1,1) EQ '(').ISAREG1                            15300000
         LA    14,&JSCB           PICK UP JSCB ADDRESS                  15350000
         STCM  14,7,37(15)        INSERT JSCB INTO LIST                 15400000
         AGO   .CONTQ5                                            20028 15450000
.ISAREG1 STCM  &JSCB(1),7,37(15)  INSERT JSCB INTO LIST                 15500000
.CONTQ5  ANOP                                                     20028 15550000
         AIF   ( NOT (&SWSTAI OR &SWESTAI) ).TTID  NEITHER GIVEN Y02752 15600000
.* IF EITHER STAI OR ESTAI GIVEN, OVERRIDE BYTES DEC 41 - 47     Y02752 15650000
.STAIRB  AIF   ('&STXADDR'(1,1) EQ '(' ).REG1                    Y02752 15700000
         LA    14,&STXADDR        GET STAI/ESTAI EXIT ADDR       Y02752 15750000
         ST    14,44(,15)         STAI/ESTAI EXIT ADDR INTO LIST Y02752 15800000
         AGO   .STAI2                                             20028 15850000
.REG1    ST    &STXADDR,44(,15)   STAI/ESTAI EXIT ADDR INTO LIST Y02752 15900000
.STAI2   ANOP                                                    Y02752 15950000
         AIF   (&NUMB3 EQ 0).STAZ  NO FLAGS TO BE SET            Y02752 16000000
         MVI   44(15),&NUMB3      SET STAI/ESTAI FLAGS           Y02752 16050000
.STAZ    ANOP                                                    Y02752 16100000
         AIF   ('&STPADDR' NE '').STY                            Y02752 16150000
         SR    14,14                                             Y02752 16200000
         STCM  14,7,41(15)        NO STAI/ESTAI PARM LIST ADDR   Y02752 16250000
         AGO   .TTID                                             Y02752 16300000
.STY     ANOP                                                    Y02752 16350000
         AIF   ('&STPADDR'(1,1) EQ '(').REG2                     Y02752 16400000
         LA    14,&STPADDR        GET STAI/ESTAI PARM LIST ADDR  Y02752 16450000
         STCM  14,7,41(15)        STAI/ESTAI PARM LIST ADDR      Y02752 16500000
         AGO   .TTID                                                    16550000
.REG2    STCM  &STPADDR,7,41(15)  STAI/ESTAI PARM LIST ADDR      Y02752 16600000
.TTID    AIF   ('&TID' EQ '0').TLIBE                                    16650000
         AIF   ('&TID'(1,1) EQ '(').REGTID                              16700000
         MVI   40(15),&TID         INSERT TID IN LIST                   16750000
         AGO   .TLIBE                                                   16800000
.REGTID  STC   &TID(1),40(15,0)    INSERT TID IN LIST            YM1995 16850000
.TLIBE   AIF   ('&TASKLIB' EQ '').NSHSP1                         Y02752 16900000
.TLIBEA  AIF   ('&TASKLIB'(1,1) EQ '(').TREGE                     20021 16950000
         LA    14,&TASKLIB(1) GET TASKLIB DCB ADDR.               20021 17000000
         ST    14,48(,15)    .PUT TASKLIB DCB ADDR. IN LIST.      20021 17050000
         AGO   .NSHSP1                                           Y02752 17100000
.TREGE   ST    &TASKLIB(1),48(,15) TASKLIB DCB ADDR. IN LIST.     20021 17150000
.NSHSP1  ANOP                                                    Y02752 17200000
         MVI   55(15),60          SET LENGTH OF THIS PARM LIST   Y02752 17250000
         AIF   ('&NSHSPL' EQ '').NSHSP2                          Y02752 17300000
         AIF   ('&RSAPF' EQ 'YES').NSHSP6   RSAPF ALSO ON      @Z40RP9B 17350000
         OI    52(15),X'80'       NEXT WORD HAS SP LIST ADDR     Y02752 17400000
.NSHSP7  ANOP                                                  @Z40RP9B 17450000
         AIF   ('&NSHSPL'(1,1) EQ '(' ).NSHSP3                   Y02752 17500000
         LA    14,&NSHSPL         GET SP LIST ADDR               Y02752 17550000
         ST    14,56(,15)         NSHSPL ADDR INTO PARM LIST     Y02752 17600000
         AGO   .SVC                                               20021 17650000
.NSHSP3  ANOP                                                    Y02752 17700000
         ST    &NSHSPL(1),56(,15) NSHSPL ADDR INTO PARM LIST     Y02752 17750000
         AGO   .SVC                                              Y02752 17800000
.NSHSP2  ANOP                                                    Y02752 17850000
         AIF   ('&NSHSPV' EQ '').NSHSP8                        @Z40RP9B 17900000
         NI    52(15),X'7F'       NEXT WORD CONTAINS SP VALUE    Y02752 17950000
         AIF   ('&RSAPF' NE 'YES').NSHSP5                      @Z40RP9B 18000000
         OI    52(15),X'40'        SET APF FLAG ON             @Z40RP9B 18050000
.NSHSP5  ANOP                                                  @Z40RP9B 18100000
         AIF   ('&NSHSPV'(1,1) EQ '(' ).NSHSP4                   Y02752 18150000
         LA    14,&NSHSPV.(0,0)   SP VALUE FOR NSHSPV            YM1995 18200000
         ST    14,56(,15)          PARM INTO LIST                Y02752 18250000
         AGO   .SVC                                              Y02752 18300000
.NSHSP4  ANOP                                                    Y02752 18350000
         ST    &NSHSPV(1),56(,15) SET SP VALUE FOR NSHSPV        Y02752 18400000
         AGO   .SVC                                              Y02752 18450000
.NSHSP6  OI    52(15),X'C0'      SET NSHSPL AND RSAPF FLAGS    @Z40RP9B 18500000
         AGO   .NSHSP7                                         @Z40RP9B 18550000
.NSHSP8  ANOP                                                  @Z40RP9B 18600000
         AIF   ('&RSAPF' NE 'YES').SVC NO FLGS ON              @Z40RP9B 18650000
         OI    52(15),X'40'      SET APF FLAG ON               @Z40RP9B 18700000
         AGO   .SVC                                            @Z40RP9B 18750000
.LROUT   ANOP                                                           18800000
.* L FORM MUST ACCEPT ALL PARAMETERS POSSIBLE. A LIST OF ALL     Y02752 18850000
.* ZEROS MUST BE ACCEPTABLE AS AN L FORM.                               18900000
&NAME    DS    0F                                                       18950000
         AIF   ('&EP' EQ '').CONTLA                                     19000000
         AIF   ('&EP'(1,1) EQ '(').ERROR5                               19050000
         DC    A(*+28)                           POINTER TO SYMB NAME   19100000
         AGO   .COHID                                              LCS1 19150000
.CONTLA  AIF   ('&EPLOC' EQ '').CONTLB                                  19200000
         AIF   ('&EPLOC'(1,1) EQ '(').ERROR5                            19250000
         DC    A(&EPLOC)                         POINTER TO SYMB NAME   19300000
         AGO   .COHID                                              LCS1 19350000
.CONTLB  AIF   ('&DE' EQ '').CONTLLA                                    19400000
         AIF   ('&DE'(1,1) EQ '(').ERROR5                               19450000
         DC    X'80'                             SET BIT TO INDICATE DE 19500000
         DC    AL3(&DE)                          DIRECTORY ENTRY POINTR 19550000
         AGO   .COHID                                              LCS1 19600000
.CONTLLA DC    A(0)                              DE OR EPLOC ADDRESS    19650000
.COHID   ANOP                                                    Y02752 19700000
.* BITS 6 AND 7 OF BYTE 4 PREVIOUSLY DEFINED FOR HIARCHY PARM    Y02752 19750000
.CHID    DC    AL1(0)                                                   19800000
.CONTLC  AIF   ('&DCB' EQ '').CONTLD                                    19850000
         AIF   ('&DCB'(1,1) EQ '(').ERROR5                              19900000
         DC    AL3(&DCB)                                           LCS1 19950000
         AGO   .CONTLSE                                           20028 20000000
.CONTLD  DC    AL3(0)                  DCB ADDRESS                 LCS1 20050000
.CONTLSE ANOP                                                    Y02572 20100000
         AIF   (&NUMB1 EQ 8).NOTSOLW DO NOT SET EXTND LIST ALONE Y02752 20150000
         DC    AL1(&NUMB1)        FLAGS                          Y02752 20200000
         AGO   .NOTSOLX                                          Y02752 20250000
.NOTSOLW ANOP                                                     20021 20300000
         DC    AL1(0)                                             20021 20350000
.NOTSOLX ANOP                                                     20021 20400000
.CONTLE  AIF   ('&ECB' EQ '').CONTLF                                    20450000
         AIF   ('&ECB'(1,1) EQ '(').ERROR5                              20500000
         DC    AL3(&ECB)                         ECB ADDRESS      20028 20550000
         AGO   .CONTLG                                                  20600000
.CONTLF  DC    AL3(0)                            ECB ADDRESS      20028 20650000
.CONTLG  AIF   ('&GSPV' EQ '').CONTLH                                   20700000
         AIF   ('&GSPV'(1,1) EQ '(').ERROR5                             20750000
         DC    A(&GSPV)                          GSPV VALUE             20800000
         AGO   .CONTLI                                                  20850000
.CONTLH  AIF   ('&GSPL' EQ '').CONTLJ                                   20900000
         AIF   ('&GSPL'(1,1) EQ '(').ERROR5                             20950000
         DC    AL1(1)                            SET LIST BIT ON        21000000
         DC    AL3(&GSPL)                        GSPL ADDRESS           21050000
         AGO   .CONTLI                                                  21100000
.CONTLJ  DC    A(0)                              GSPL OR GSPV           21150000
.CONTLI  AIF   ('&SHSPV' EQ '').CONTLK                                  21200000
         AIF   ('&SHSPV'(1,1) EQ '(').ERROR5                            21250000
         DC    A(&SHSPV)                         SHSPV VALUE            21300000
         AGO   .CONTLL                                                  21350000
.CONTLK  AIF   ('&SHSPL' EQ '').CONTLM                                  21400000
         AIF   ('&SHSPL'(1,1) EQ '(').ERROR5                            21450000
         DC    AL1(1)                            SET LIST BIT ON        21500000
         DC    AL3(&SHSPL)                       SHSPL ADDRESS          21550000
         AGO   .CONTLL                                                  21600000
.CONTLM  DC    A(0)                              SHSPV OR SHSPL         21650000
.CONTLL  ANOP                                                           21700000
.* BITS 6 AND 7 OF BYTE 20 PREVIOUSLY DEFINED FOR ROLL PARMS     Y02752 21750000
         AIF   (&NUMB2 EQ 32).BYT20Z DO NOT SET EXT PARM ALONE   Y02752 21800000
         DC    AL1(&NUMB2)        FLAGS                          Y02752 21850000
         AGO   .BYT20C                                           Y02752 21900000
.BYT20Z  ANOP                                                    Y02752 21950000
         DC    AL1(0)                                            Y02752 22000000
.BYT20C  ANOP                                                    Y02752 22050000
         AIF   ('&ETXR' EQ '').CONTLN                              RORI 22100000
         AIF   ('&ETXR'(1,1) EQ '(').ERROR5                             22150000
         DC    AL3(&ETXR)                    EXIT ROUT. ADDRESS    RORI 22200000
         AGO   .CONTLO                                                  22250000
.CONTLN  DC    AL3(0)                        EXIT ROUT. ADDRESS    RORI 22300000
.CONTLO  AIF   ('&DPMOD' EQ '').CONTLP                                  22350000
         AIF   ('&DPMOD'(1,1) EQ '(').ERROR5                            22400000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNB     22450000
         DC    AL2(&DPMOD)                       DPMOD VALUE            22500000
         AGO   .CONTLQ                                                  22550000
.SIGNB   DC    AL2(0&DPMOD)                      DPMOD VALUE            22600000
         AGO   .CONTLQ                                                  22650000
.CONTLP  DC    AL2(0)                            DPMOD VALUE            22700000
.CONTLQ  AIF   ('&LPMOD' EQ '').CONTLR                                  22750000
         AIF   ('&LPMOD'(1,1) EQ '(').ERROR5                            22800000
         DC    AL1(&LPMOD)                       LPMOD VALUE            22850000
         AGO   .CONTLS6                                                 22900000
.CONTLR  DC    AL1(0)                            LPMOD VALUE            22950000
.CONTLS6 ANOP                                                    Y02752 23000000
.CONTLU  DC    AL1(&NUMB)                                               23050000
         AIF   ('&EP' EQ '').CONTLV                                     23100000
         DC    CL8'&EP'                          EP SYMBOL              23150000
         AGO   .CONTLV1                                            1270 23200000
.* SET EP NAME SPACE TO ZEROS TO ALLOW ALL ZERO LIST FORM        Y02752 23250000
.CONTLV  DC    2A(0)              EP NAME SPACE                  Y02752 23300000
.CONTLV1 AIF   ('&LSQA' EQ '0').NOLSQA                                  23350000
         AIF   ('&LSQA'(1,1) EQ '(').ERROR5                             23400000
         DC    AL1(&LSQA)          LSQA VALUE                           23450000
         AGO   .CONTLV2                                                 23500000
.NOLSQA  DC    AL1(0)              NO LSQA                              23550000
.CONTLV2 AIF   ('&JSCB' EQ '').NOJSCB                             20021 23600000
         AIF   ('&JSCB'(1,1) EQ '(').ERROR5                        I270 23650000
         DC    AL3(&JSCB)          ADDRESS OF JSCB                      23700000
         AGO   .LTID                                                    23750000
.NOJSCB  ANOP                                                     20028 23800000
         DC    AL3(0)    .                                              23850000
.LTID    AIF   ('&TID' EQ '0').NOTID                                    23900000
         AIF   ('&TID'(1,1) EQ '(').ERROR5                              23950000
         DC    AL1(&TID)           TID VALUE                            24000000
         AGO   .CONTLW                                                  24050000
.NOTID   DC    AL1(0)              .NO TID                              24100000
.CONTLW  AIF   (&SWSTAI OR &SWESTAI).CONTLX                      Y02752 24150000
         DC    AL3(0)             STAI/ESTAI PARM LIST           Y02752 24200000
         DC    A(0)                .EXIT ADDRESS                        24250000
         AGO   .TLCONT                                            20021 24300000
.CONTLX  ANOP                                                    Y02752 24350000
         AIF   ('&STXADDR'(1,1) EQ '(' ).ERROR5                  Y02752 24400000
         AIF   ('&STPADDR' EQ '').CONTLY                          20028 24450000
         AIF   ('&STPADDR'(1,1) EQ '(' ).ERROR5                  Y02752 24500000
         DC    AL3(&STPADDR)      STAI/ESTAI PARM LIST ADDR      Y02752 24550000
         AGO   .TLCX                                              20021 24600000
.CONTLY  DC    AL3(0)             STAI/ESTAI PARAMETER LIST      Y02752 24650000
.TLCX    ANOP                                                    Y02752 24700000
         DC    AL1(&NUMB3)        STAI/ESTAI FLAGS               Y02752 24750000
.TLCZ    DC    AL3(&STXADDR)      STAI/ESTAI EXIT ROUTINE ADDR   Y02752 24800000
.TLCONT  AIF   ('&TASKLIB' NE '').TLCONTA                         20021 24850000
         DC    A(0)                     .TASKLIB.                 20021 24900000
         AGO   .LNSHSP1                                          Y02752 24950000
.TLCONTA ANOP                                                     20021 25000000
         AIF   ('&TASKLIB'(1,1) EQ '(' ).ERROR5                  Y02752 25050000
         DC    A(&TASKLIB)   .TASKLIB DCB ADDRESS.                20021 25100000
.* ATTACH PARM LIST LENGTH IS NOT SET IN LIST FORM, MUST BE SET  Y02752 25150000
.* IN EXECUTE FORM. ALSO EXTENDED PARM LIST FLAGS MUST BE SET    Y02752 25200000
.* IN E FORM TO INSURE SERVICE RTN RECEIVES A COMPLETE PARM LIST Y02752 25250000
.LNSHSP1 ANOP                                                    Y02752 25300000
         AIF   ('&NSHSPL' EQ '').LNSHSP2                         Y02752 25350000
         AIF   ('&NSHSPL'(1,1) EQ '(' ).ERROR5                   Y02752 25400000
         AIF   ('&RSAPF' EQ 'YES').LNSHSP6                     @Z40RP9B 25450000
         DC    AL1(128)           SP LIST ADDR IN FOLLOWING WORD Y02752 25500000
.LNSHSP4 ANOP                                                  @Z40RP9B 25550000
         DC    AL3(0)             PARM LIST LENGTH FIELD         Y02752 25600000
         DC    A(&NSHSPL)         NSHSPL ADDRESS                 Y02752 25650000
         AGO   .END                                               20021 25700000
.LNSHSP2 ANOP                                                    Y02752 25750000
         AIF   ('&RSAPF' EQ 'YES').LNSHSP7                     @Z40RP9B 25800000
         DC    A(0)               FLAGS AND PARM LIST LENGTH     Y02752 25850000
.LNSHSP5 ANOP                                                  @Z40RP9B 25900000
         AIF   ('&NSHSPV' EQ '').LNSHSP3                         Y02752 25950000
         AIF   ('&NSHSPV'(1,1) EQ '(' ).ERROR5                   Y02752 26000000
         DC    AL3(0)             NSHSPV                         Y02752 26050000
         DC    AL1(&NSHSPV)        VALUE                         Y02752 26100000
         AGO   .END                                              Y02752 26150000
.LNSHSP3 ANOP                                                    Y02752 26200000
         DC    A(0)               NO NSHSPV OR NSHSPL PARM       Y02752 26250000
         AGO   .END                                              Y02752 26300000
.LNSHSP6 DC    AL1(192)         NSHSPL AND RSAPF FLGS ON       @Z40RP9B 26350000
         AGO   .LNSHSP4                                        @Z40RP9B 26400000
.LNSHSP7 DC    AL1(64)          NSHSPV AND RSAPF FLGS ON       @Z40RP9B 26450000
         DC    AL3(0)           PARM LIST LENGTH FIELD         @Z40RP9B 26500000
         AGO   .LNSHSP5                                        @Z40RP9B 26550000
.IROUT   ANOP                                                           26600000
.* NORMAL FORM. IN-LINE LIST.                                    Y02752 26650000
         LA    15,&GNAME                         LOAD 15 WITH LIST ADDR 26700000
         AIF   ('&EPLOC' EQ '').ICONTA                                  26750000
         AIF   ('&EPLOC'(1,1) NE '(').ICONTB                            26800000
         ST    &EPLOC(1),0(0,15)                 STORE EPLOC INTO LIST  26850000
         AGO   .ICONTB                                                  26900000
.ICONTA  AIF   ('&DE' EQ '').ICONTB                                     26950000
         AIF   ('&DE'(1,1) NE '(').ICONTB                               27000000
         ST    &DE(1),0(0,15)                    STORE  DE INTO LIST    27050000
         MVI   0(15),X'80'                       SET DE BIT ON          27100000
.ICONTB  AIF   ('&DCB' EQ '').ICOHID                               LCS1 27150000
         AIF   ('&DCB'(1,1) NE '(').ICOHID                         LCS1 27200000
         STCM  &DCB(1),7,5(15)     STORE DCB INTO LIST                  27250000
.* BITS 6 AND 7 OF BYTE 4 PREVIOUSLY DEFINED FOR HIARCHY         Y02752 27300000
.ICOHID  ANOP                                                      LCS1 27350000
.ICONTC  AIF   ('&ECB' EQ '').ICONTD                                    27400000
         AIF   ('&ECB'(1,1) NE '(').ICONTD                              27450000
         STCM  &ECB(1),7,9(15)         STORE ECB INTO LIST              27500000
.ICONTD  AIF   ('&GSPV' EQ '').ICONTE                                   27550000
         AIF   ('&GSPV'(1,1) NE '(').ICONTF                             27600000
         ST    &GSPV(1),12(0,15)    STORE GSPV INTO LIST                27650000
         AGO   .ICONTF                                                  27700000
.ICONTE  AIF   ('&GSPL' EQ '').ICONTF                                   27750000
         AIF   ('&GSPL'(1,1) NE '(').ICONTF                             27800000
         ST    &GSPL(1),12(0,15)                 STORE GSPL INTO LIST   27850000
         MVI   12(15),X'01'                      SET LIST BIT ON        27900000
.ICONTF  AIF   ('&SHSPV' EQ '').ICONTG                                  27950000
         AIF   ('&SHSPV'(1,1) NE '(').ICONTH                            28000000
         ST    &SHSPV(1),16(0,15)                STORE SHSPV INTO LIST  28050000
         AGO   .ICONTH                                                  28100000
.ICONTG  AIF   ('&SHSPL' EQ '').ICONTH                                  28150000
         AIF   ('&SHSPL'(1,1) NE '(').ICONTH                            28200000
         ST    &SHSPL(1),16(0,15)                STORE SHSPL INTO LIST  28250000
         MVI   16(15),X'01'                      SET LIST BIT ON        28300000
.ICONTH  AIF   ('&ETXR' EQ '').ICONTI                                   28350000
         AIF   ('&ETXR'(1,1) NE '(').ICONTI                             28400000
         STCM  &ETXR(1),7,21(15)       STORE ETXR INTO LIST             28450000
.ICONTI  AIF   ('&DPMOD' EQ '').ICONTJ                                  28500000
         AIF   ('&DPMOD'(1,1) NE '(').ICONTJ                            28550000
         STH   &DPMOD(1),24(15,0)                STORE DPMOD INTO LIST  28600000
.ICONTJ  AIF   ('&LPMOD' EQ '').ICONTJ0                                 28650000
         AIF   ('&LPMOD'(1,1) NE '(').ICONTJ0                           28700000
         STC   &LPMOD(1),26(15,0)                STORE LPMOD INTO LIST  28750000
.ICONTJ0 AIF   ('&LSQA' EQ '0').ICONTK                                  28800000
         AIF   ('&LSQA'(1,1) NE '(').ICONTK                             28850000
         STC   &LSQA(1),36(15,0)   INSERT LSQA INTO LIST         YM1995 28900000
.ICONTK  AIF   ('&JSCB' EQ '').ICONTL0                            20028 28950000
         AIF   ('&JSCB'(1,1) NE '(').ICONTL0                      20028 29000000
         STCM  &JSCB(1),7,37(15)    INSERT JSCB INTO LIST               29050000
.ICONTL0 ANOP                                                           29100000
         AIF   ('&TID' EQ '0').ICONTL1                                  29150000
         AIF   ('&TID'(1,1) NE '(').ICONTL1                             29200000
         STC   &TID(1),40(15,0)    INSERT TID INTO LIST          YM1995 29250000
.ICONTL1 ANOP                                                           29300000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).ICONTO               Y02572 29350000
         AIF   ('&STXADDR'(1,1) NE '(' ).ICZ                     Y02572 29400000
         STCM  &STXADDR,7,45(15)   SET STAI/ESTAI EXIT ADDR      Y02572 29450000
.ICZ     AIF   ('&STPADDR' EQ '').ICONTO                         Y02752 29500000
         AIF   ('&STPADDR'(1,1) NE '(' ).ICONTO                  Y02752 29550000
         STCM  &STPADDR,7,41(15)  STAI/ESTAI PARM LIST ADDR      Y02752 29600000
.ICONTO  AIF   ('&TASKLIB' EQ '').ICONTP                          20021 29650000
.ICONTQ  AIF   ('&TASKLIB'(1,1) NE '(').ICONTP                    20021 29700000
         ST    &TASKLIB(1),48(,15)  .PUT TASKLIB DCB ADDR. IN LIST.     29750000
.ICONTP  ANOP                                                    Y02752 29800000
         AIF   ('&NSHSPL' EQ '').ICONTP0                         Y02752 29850000
         AIF   ('&NSHSPL'(1,1) NE '(' ).ICONTP1                  Y02752 29900000
         ST    &NSHSPL(1),56(,15) NSHSPL ADDR INTO LIST          Y02752 29950000
         AGO   .ICONTP1                                          Y02752 30000000
.ICONTP0 ANOP                                                    Y02752 30050000
         AIF   ('&NSHSPV' EQ '').ICONTP1                         Y02752 30100000
         AIF   ('&NSHSPV'(1,1) NE '(' ).ICONTP1                  Y02752 30150000
         STC   &NSHSPV(1),59(,15) NSHSPV VALUE INTO LIST         Y02752 30200000
.ICONTP1 ANOP                                                    Y02752 30250000
         B     60(,15)            BRANCH AROUND LIST             Y02752 30300000
&GNAME   DS    0F                                SUP. PARAM. LIST       30350000
         AIF   ('&EP' EQ '').CNTA                                       30400000
         DC    A(*+28)                           ADDRESS OF SYMB NAME   30450000
         AGO   .CCHID                                              LCS1 30500000
.CNTA    AIF   ('&EPLOC' EQ '').CNTC                                    30550000
         AIF   ('&EPLOC'(1,1) EQ '(').CNTD                              30600000
         DC    A(&EPLOC)                         ADDRESS OF SYMB NAME   30650000
         AGO   .CCHID                                              LCS1 30700000
.CNTC    AIF   ('&DE' EQ '').ERROR6                                     30750000
         AIF   ('&DE'(1,1) EQ '(').CNTD                                 30800000
         DC    X'80'                             SET BIT TO INDICATE DE 30850000
         DC    AL3(&DE)                          DE ADDRESS             30900000
         AGO   .CCHID                                              LCS1 30950000
.CNTD    DC    A(0)                              DE OR EPLOC ADDRESS    31000000
.CCHID   ANOP                                                    Y02752 31050000
.* BITS 6 AND 7 OF BYTE 4 PREVIOUSLY DEFINED FOR HIARCHY PARM    Y02752 31100000
.CCCHID  DC    AL1(0)                                                   31150000
.CNTB    AIF   ('&DCB' EQ '').CNTE                                      31200000
         AIF   ('&DCB'(1,1) EQ '(').CNTE                                31250000
         DC    AL3(&DCB)               DCB ADDRESS                 LCS1 31300000
         AGO   .CNTF                                                    31350000
.CNTE    DC    AL3(0)                  DCB ADDRESS                 LCS1 31400000
.CNTF    ANOP                                                           31450000
         DC    AL1(&NUMB1)        FLAGS                          Y02752 31500000
         AIF   ('&ECB' EQ '').CNTG                               Y02752 31550000
         AIF   ('&ECB'(1,1) EQ '(').CNTG                                31600000
         DC    AL3(&ECB)          ECB ADDRESS                    Y02752 31650000
         AGO   .CNTH                                                    31700000
.CNTG    DC    AL3(0)             ECB ADDRESS                    Y02752 31750000
.CNTH    AIF   ('&GSPV' EQ '').CNTI                                     31800000
         AIF   ('&GSPV'(1,1) EQ '(').CNTJ                               31850000
         DC    A(&GSPV)                          GSPV VALUE             31900000
         AGO   .CNTK                                                    31950000
.CNTI    AIF   ('&GSPL' EQ '').CNTJ                                     32000000
         AIF   ('&GSPL'(1,1) EQ '(').CNTJ                               32050000
         DC    AL1(1)                            SET LIST BIT ON        32100000
         DC    AL3(&GSPL)                        GSPL ADDRESS           32150000
         AGO   .CNTK                                                    32200000
.CNTJ    DC    A(0)                              GSPV VALUE OR GSPL ADR 32250000
.CNTK    AIF   ('&SHSPV' EQ '').CNTL                                    32300000
         AIF   ('&SHSPV'(1,1) EQ '(').CNTM                              32350000
         DC    A(&SHSPV)                         SHSPV VALUE            32400000
         AGO   .CNTN                                                    32450000
.CNTL   AIF   ('&SHSPL' EQ '').CNTM                                     32500000
         AIF   ('&SHSPL'(1,1) EQ '(').CNTM                              32550000
         DC    AL1(1)                            SET LIST BIT ON        32600000
         DC    AL3(&SHSPL)                       SHSPL ADDRESS          32650000
         AGO   .CNTN                                                    32700000
.CNTM    DC    A(0)                              SHSPL OR SHSPV         32750000
.CNTN    ANOP                                                           32800000
.* BITS 6 AND 7 OF BYTE 20 PREVIOUSLY DEFINED FOR ROLL PARM      Y02752 32850000
         DC    AL1(&NUMB2)        FLAGS                          Y02752 32900000
         AIF   ('&ETXR' EQ '').CNTO                                RORI 32950000
         AIF   ('&ETXR'(1,1) EQ '(').CNTO                               33000000
         DC    AL3(&ETXR)                    EXIT ROUT. ADDRESS    RORI 33050000
         AGO   .CNTP                                                    33100000
.CNTO    DC    AL3(0)                        ETXR ROUT. ADDRESS    RORI 33150000
.CNTP    AIF   ('&DPMOD' EQ '').CNTQ                                    33200000
         AIF   ('&DPMOD'(1,1) EQ '(').CNTQ                              33250000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNC     33300000
         DC    AL2(&DPMOD)                       DPMOD VALUE            33350000
         AGO   .CNTR                                                    33400000
.SIGNC   DC    AL2(0&DPMOD)                      DPMOD VALUE            33450000
         AGO   .CNTR                                                    33500000
.CNTQ    DC    AL2(0)                            DPMOD VALUE            33550000
.CNTR    AIF   ('&LPMOD' EQ '').CNTS                                    33600000
         AIF   ('&LPMOD'(1,1) EQ '(').CNTS                              33650000
         DC    AL1(&LPMOD)                       LPMOD VALUE            33700000
         AGO   .CNTT0C                                                  33750000
.CNTS    DC    AL1(0)                            LPMOD VALUE            33800000
.CNTT0C  ANOP                                                    Y02752 33850000
.CNTV    DC    AL1(&NUMB)                                               33900000
         AIF   ('&EP' EQ '').CNTW                                       33950000
         DC    CL8'&EP'            EP SYMBOL                            34000000
         AGO   .CNTXX                                              I270 34050000
.CNTW    DC    CL8' '                                              I270 34100000
.CNTXX   AIF   ('&LSQA' EQ '0').CNTXX1                                  34150000
         AIF   ('&LSQA'(1,1) EQ '(').CNTXX1                             34200000
         DC    AL1(&LSQA)          LSQA                                 34250000
         AGO   .CNTX                                                    34300000
.CNTXX1  DC    AL1(0)              LSQA=0                               34350000
.CNTX    AIF   ('&JSCB' EQ '').CONTQ6                             20028 34400000
         AIF   ('&JSCB'(1,1) EQ '(').CONTQ6                        I270 34450000
         DC    AL3(&JSCB)          ADDRESS OF JSCB                      34500000
         AGO   .CNTYY                                                   34550000
.CONTQ6  DC    AL3(0)              ADDRESS OF JSCB                      34600000
.CNTYY   AIF   ('&TID' EQ '0').CNTYY1                                   34650000
         AIF   ('&TID'(1,1) EQ '(').CNTYY1                              34700000
         DC    AL1(&TID)           TID                                  34750000
         AGO   .CNTY                                                    34800000
.CNTYY1  DC    AL1(0)              TID=0                                34850000
.CNTY    AIF   (NOT (&SWSTAI OR &SWESTAI) ).TLICN                Y02752 34900000
         AIF   ('&STPADDR' EQ '').CREG2                          Y02752 34950000
         AIF   ('&STPADDR'(1,1) EQ '(' ).CREG2                   Y02752 35000000
         DC    AL3(&STPADDR)      STAI/ESTAI PARM LIST ADDR      Y02752 35050000
         AGO   .CKREG1                                            20028 35100000
.CREG2   DC    AL3(0)             STAI/ESTAI PARM LIST ADDR      Y02752 35150000
.CKREG1  ANOP                                                    Y02752 35200000
         DC    AL1(&NUMB3)        STAI/ESTAI FLAGS               Y02752 35250000
         AIF   ('&STXADDR'(1,1) EQ '(' ).CREG1                   Y02752 35300000
         DC    AL3(&STXADDR)      STAI/ESTAI EXIT RTN ADDRESS    Y02752 35350000
         AGO   .TLICNA                                            20021 35400000
.CREG1   DC    AL3(0)             STAI/ESTAI EXIT RTN ADDRESS    Y02752 35450000
         AGO   .TLICNA                                                  35500000
.TLICN   DC    AL3(0)             NO STAI/ESTAI PARM LIST ADDR   Y02752 35550000
         DC    A(0)                .NO EXIT ADDR                        35600000
.TLICNA  ANOP                                                    Y02752 35650000
         AIF   ('&TASKLIB' EQ '').TLICNC                         Y02752 35700000
         AIF   ('&TASKLIB'(1,1) EQ '(' ).TLICNC                  Y02752 35750000
         DC    A(&TASKLIB)   .TASKLIB DCB ADDRESS.                20021 35800000
         AGO   .INSHSP1                                          Y02752 35850000
.TLICNC  DC    A(0)          .TASKLIB DCB ADDRESS.                20021 35900000
.INSHSP1 ANOP                                                    Y02752 35950000
         AIF   ('&NSHSPL' EQ '').INSHSP2                         Y02752 36000000
         AIF   ('&RSAPF' EQ 'YES').C0  APF NSHSPL ON           @Z40RP9B 36050000
         DC    X'80'              NSHSPL FLAG                    Y02752 36100000
.T1      ANOP                                                  @Z40RP9B 36150000
         DC    AL3(60)            LENGTH OF THIS PARAMETER LIST  Y02752 36200000
         AIF   ('&NSHSPL'(1,1) EQ '(' ).INSHSP3                  Y02752 36250000
         DC    A(&NSHSPL)         NSHSPL ADDRESS                 Y02752 36300000
         AGO   .SVC                                              Y02752 36350000
.INSHSP2 ANOP                                                    Y02752 36400000
         AIF   ('&RSAPF' EQ 'YES').FOUR0   APF FLAG ON ONLY    @Z40RP9B 36450000
         DC    X'00'                       NO FLAGS ON         @Z40RP9B 36500000
.T2      ANOP                                                  @Z40RP9B 36550000
         DC    AL3(60)            LENGTH OF THIS PARM LIST     @Z40RP9B 36600000
         AIF   ('&NSHSPV' EQ '').INSHSP3                         Y02752 36650000
         AIF   ('&NSHSPV'(1,1) EQ '(' ).INSHSP3                  Y02752 36700000
         DC    A(&NSHSPV)         NSHSPV VALUE                   Y02752 36750000
         AGO   .SVC                                              Y02752 36800000
.C0      ANOP                                                  @Z40RP9B 36850000
         DC    X'C0'             NSHSPL AND APF FLAGS ON       @Z40RP9B 36900000
         AGO   .T1                                             @Z40RP9B 36950000
.FOUR0   ANOP                                                           37000000
         DC    X'40'             APF FLAG ON ONLY                       37050000
         AGO   .T2                                             @Z40RP9B 37100000
.INSHSP3 ANOP                                                    Y02752 37150000
         DC    A(0)               NSHSPV VALUE OR NSHSPL ADDR    Y02752 37200000
.SVC     SVC   42                                ISSUE ATTACH SVC       37250000
         MEXIT                                                    20028 37300000
.ERROZ   IHBERMAC 1003,PURGE,ASYNCH                               20021 37350000
         MEXIT                                                   Y02752 37400000
.ERROR   IHBERMAC 1004,&STAITYP                                  Y02752 37450000
         MEXIT                                                   Y02752 37500000
.E2      IHBERMAC 1005,&STAITYP                                  Y02752 37550000
         MEXIT                                                          37600000
.E3      IHBERMAC 1005,PURGE                                            37650000
         MEXIT                                                          37700000
.E4      IHBERMAC 1005,ASYNCH                                           37750000
         MEXIT                                                          37800000
.E5      IHBERMAC 1005,SZERO,YES                                        37850000
         MEXIT                                                          37900000
.E6      IHBERMAC 1005,GIVEJPQ                                          37950000
         MEXIT                                                          38000000
.E7      IHBERMAC 1005,GSPV                                             38050000
         MEXIT                                                          38100000
.E8      IHBERMAC 1005,GSPL                                             38150000
         MEXIT                                                          38200000
.E9      IHBERMAC 1005,SHSPV                                            38250000
         MEXIT                                                          38300000
.E10     IHBERMAC 1005,SHSPL                                            38350000
         MEXIT                                                          38400000
.ERDISP  IHBERMAC 1001,DISP,&DISP                                       38450000
         MEXIT                                                   X02050 38500000
.ERTQE   IHBERMAC 1001,TQE,&TQE                                  X02050 38550000
         MEXIT                                                   X02050 38600000
.ERFP    IHBERMAC 1001,FPREGSA,&FPREGSA                          X02050 38650000
         MEXIT                                                   Y02752 38700000
.ERTERM  IHBERMAC 1001,TERM,&TERM                                Y02752 38750000
         MEXIT                                                   Y02752 38800000
.ERNSHSP IHBERMAC 1020,NSHSPV,NSHSPL                             Y02752 38850000
         MEXIT                                                   Y02752 38900000
.ERSTAI  IHBERMAC 1020,STAI,ESTAI                                Y02752 38950000
.END     MEND                                                           39000000
