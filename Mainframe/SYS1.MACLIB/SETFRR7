         MACRO                                                          00050000
&NAME    SETFRR7   &OPT,&FRRAD=,&PARMAD=,&WRKREGS=,&RELATED=,&CLEAR=,  C00150000
               &MODE=,&EUT=,&INLINE=NO,&ASSIST=NO,&OPT2        @G860P1C 00200000
.* A-000000-999999                                             @G860P1C 00225000
.* PTM FIX MOVED PROMT COMMENT ABOVE                           @ZMC3023 00250000
*    MACDATE    01/03/83  S/370 LEVEL OF SETFRR                    @H1C 00275000
.*                                                                      00300000
.********************************************************************** 00350000
.*                                                                    * 00400000
.*                                                                    * 00442800
.* COPYRIGHT =                                                        * 00485600
.*               5740-XC6                                             * 00528400
.*               THIS MODULE IS "RESTRICTED MATERIALS OF IBM"         * 00571200
.*               (C) COPYRIGHT IBM CORP. 1977, 1984                   * 00614000
.*               LICENSED MATERIALS - PROPERTY OF IBM                 * 00656800
.*                                                                    * 00700000
.*    STATUS = OS/VS2 JBB2133                                     @H1C* 00750000
.*                                                                    * 00800000
.*    MACMEAN = SET UP FUNCTIONAL RECOVERY ROUTINES           @G860P1C* 00850000
.*              SYSTEM 370 COMPATIBLE LEVEL                   @G860P1C* 00900000
.*                                                                    * 00950000
.*     THE SETFRR MACRO EXPANSION GENERATES CODE WHICH MANIPULATES A  * 01000000
.*     STACK WHEN INLINE=YES IS SPECIFIED.  WHEN INLINE=YES   @G381P2F* 01050000
.*     IS NOT SPECIFIED, THE SETFRR MACRO EXPANSION           @G381P2F* 01100000
.*     GENERATES CODE WHICH CALLS IEAVTSFR TO MANIPULATE      @G381P2F* 01150000
.*     THE CURRENT STACK.                                             * 01200000
.*                                                                    * 01500000
.*                                                                    * 01525000
.*   THERE  ARE TWO STACKS WHICH CAN BE MANIPULATED VIA THE SETFRR    * 01550000
.*   MACRO                                                            * 01600000
.*         1. A STACK FOR FRRS  RUNNING IN SUPERVISOR CONTROL MODE    * 01650000
.*         2. A STACK FOR FRRS RUNNING IN NON-SUPERVISOR CONTROL MODE * 01700000
.*                                                                    * 01750000
.*   THE HEADER FORMAT FOR EACH OF THESE STACKS IS AS FOLLOWS         * 01800000
.*                                                                    * 01850000
.*      NON-SUPERVISOR CONTROL STACK HEADER FORMAT                    * 01900000
.*                                                                    * 01950000
.*       ***********************************************              * 02000000
.*       * ADDRESS OF STACK - 32 BYTES                 *              * 02050000
.*       ***********************************************              * 02100000
.*       *    ADDRESS OF LAST ENTRY IN THE STACK       *              * 02150000
.*       ***********************************************              * 02200000
.*       *  LENGTH OF EACH ENTRY IN THE STACK  (32)    *              * 02250000
.*       ***********************************************              * 02300000
.*       *ADDRESS OF CURRENT FRR ADDRESS IN THE STACK  *              * 02350000
.*       *(INITIALIZED TO THE ADDRESS OF STACK - 32)   *              * 02400000
.*       ***********************************************              * 02450000
.*                                                                    * 02500000
.*      SUPERVISOR CONTROL STACK HEADER FORMAT                        * 02550000
.*                                                                    * 02600000
.*       ***********************************************              * 02650000
.*       * ADDRESS OF STACK                            *              * 02700000
.*       ***********************************************              * 02750000
.*       *    ADDRESS OF LAST ENTRY IN THE STACK       *              * 02800000
.*       ***********************************************              * 02850000
.*       *  LENGTH OF EACH ENTRY IN THE STACK  (32)    *              * 02900000
.*       ***********************************************              * 02950000
.*       *ADDRESS OF CURRENT FRR ADDRESS IN THE STACK  *              * 03000000
.*       *(INITIALIZED TO THE ADDRESS OF THE STACK )   *              * 03050000
.*       ***********************************************              * 03100000
.*                                                                    * 03150000
.* PRIOR TO ISSUING SETFRR THE USER MUST HAVE PERFORMED THE FOLLOWING * 03200000
.*     1.  ESTABLISHED ADDRESSABILITY TO THE PSA(THE FIRST            * 03250000
.*         INSTRUCTION GENERATED BY THE SETFRR EXPANSION REFERENCES   * 03300000
.*         THE PSACSTK FIELD OF THE PSA)                              * 03350000
.*                                                                    * 03400000
.*     2.  HAVE ISSUED THE FRR STACK MAPPING MACRO(IHAFRRS)           * 03450000
.*                                                                    * 03500000
.* CHANGE-ACTIVITY                                            @G381P2F* 03550000
.*         MVS/SYSTEM PRODUCT RELEASE 2 2/21/79               @G381P2F* 03600000
.*                 CROSS MEMORY PARAMETERS (MODE,EUT)         @G381P2F* 03650000
.*                 INTRODUCED OUT-OF-LINE CODE (INLINE)       @G381P2F* 03700000
.*                 RACE CONDITION FIXED                       @G381P2F* 03750000
.*                 INTRODUCED ADD FRR INSTRUCTION (SETFRRI) 4/17/80   * 03800000
.*                                                            @G38LP1S* 03850000
.*                 - USE LA TO OBTAIN NORMAL STACK ADDRESS    @ZM49899* 03900000
.*                 - ADDED OPT2 TO CATCH MISSING PARENS AND   @ZM50139* 03950000
.*                 FIXED OVERFLOW OF COMMENTS WHEN SYMBOLIC   @ZM50139* 04000000
.*                 NAMES ARE USED IN WRKREGS  4/24/79         @ZM50139* 04050000
.*                 - ON ADDFLUSH, CHANGED THE LOAD ADDRESS    @ZMB0044* 04100000
.*                 OF FRRSENTS TO AN ADD OF FRRSELEN TO REG 1 @ZMB0044* 04150000
.*                 TO ADDRESS THE FIRST ENTRY 8/29/79         @ZMB0044* 04200000
.*      $H1=ADVPROC1,JBB2133,830103,PDXB: REMOVE ASSIST SUPPORT       * 04225000
.*                                                                    * 04250000
.********************************************************************** 04300000
      LCLA    &CTRLNK                                          @G381P2F 04350000
      LCLA    &I                                               @G381P2F 04400000
      LCLA    &J                                               @G381P2F 04450000
      LCLA    &MODFLG                                          @G381P2F 04500000
      LCLB    &B(5)                                            @G381P2F 04550000
      LCLC    &R1                                                       04600000
      LCLC    &R2                                                       04650000
      LCLC    &R3                                                       04700000
      LCLC    &R4                                                       04750000
         LCLC  &LABEL                                          @G38LP1S 04800000
         LCLC  &LABELA,&LABELB                                 @G38LP1S 04850000
         LCLC  &RX,&RY,&T                                      @G38LP1S 04900000
&J    SETA    N'&MODE                                          @G381P2F 04950000
.*    VERIFY THAT THERE ARE NO POSITIONAL PARAMETERS OTHER     @ZM50139 05000000
.*    THAN OPTION,  THIS COULD OCCUR IF MODE WAS SPECIFIED     @ZM50139 05050000
.*    WITH MORE THAN ONE PARAMETER AND PARENTHESIS WERE NOT    @ZM50139 05100000
.*    USED                                                     @ZM50139 05150000
      AIF    ('&OPT2' NE '').MSG12                             @ZM50139 05200000
         AIF   ('&ASSIST' NE 'YES').ASSTOK   SKIP IF ASSIST NOT WANTED X05400000
                                                               @G38LP1S 05450000
         MNOTE  8,'SETFRR ASSIST NOT SUPPORTED'                    @H1A 05500000
         AGO   .END                     LEAVE MACRO                @H1A 05550000
.*                                                                8@H1D 05600000
.ASSTOK  ANOP  ,                                               @G38LP1S 05900000
.*    VERIFY VALID OPTION SPECIFIED FOR CLEAR KEYWORD                   05950000
.C1   AIF    ('&CLEAR' EQ '' OR '&CLEAR' EQ 'Y' OR '&CLEAR' EQ 'N').C2  06000000
      AIF    ('&CLEAR' EQ 'YES' OR '&CLEAR' EQ 'NO').C2                 06050000
      AIF    ('&OPT' EQ 'A').CLEARY                            @G38LP2F 06100000
.*    DEFAULT FOR REPLACE AND ADDFLUSH IS CLEAR=NO             @G38LP2F 06150000
      MNOTE  0,'INVALID CLEAR OPTION, CLEAR=NO ASSUMED'        @G38LP2F 06200000
         AGO      .C2                                          @G38LP2F 06250000
.CLEARY  ANOP  ,                                               @G38LP2F 06300000
.*    DEFAULT FOR ADD IS CLEAR=YES                             @G38LP2F 06350000
      MNOTE  0,'INVALID CLEAR OPTION, CLEAR=YES ASSUMED'       @G38LP2F 06400000
         AGO      .C2                                                   06450000
.C4      MNOTE      8,'** PARMAD MUST BE SPECIFIED WITH CLEAR OPTION'   06500000
         MEXIT                                                          06550000
.C2      AIF       ('&CLEAR' NE '' AND '&PARMAD' EQ '').C4              06600000
         AIF       ('&WRKREGS' EQ '').MSG1            CHECK TO SEE IF   06650000
.*                                                    WORK REGISTERS    06700000
.*                                                    ARE SPECIFIED     06750000
         AIF   ('&INLINE' EQ 'NO' OR '&INLINE' EQ 'N').OUTLINE          06800000
.*                                          BRANCH IF INLINE=YES WAS    06850000
.*                                          NOT SPECIFIED      @G381P2F 06900000
         AIF   ('&INLINE' NE 'YES' AND '&INLINE' NE 'Y').MSG9           06950000
.*                                          ISSUE MESSAGE IF &INLINE    07000000
.*                                          IS SPECIFIED INCORRECTLY    07050000
.*                                                             @G381P2F 07100000
         AIF   ('&MODE' NE '' AND '&MODE(1)' NE 'HOME').MSG7   @G381P2F 07150000
         AIF   ('&MODE' NE '' AND &J GT 1).MSG7                @G381P2F 07200000
.*                                          ISSUE MESSAGE IF &MODE      07250000
.*                                          IS SPECIFIED INCORRECTLY    07300000
.*                                          WITH INLINE=YES    @G381P2F 07350000
         AIF   ('&EUT' NE '').MSG6                             @G381P2F 07400000
.*                                          ISSUE MESSAGE IF &EUT       07450000
.*                                          IS SPECIFIED WITH           07500000
.*                                          INLINE=YES         @G381P2F 07550000
         AIF       ('&WRKREGS'(1,1) NE '(' OR N'&WRKREGS NE 2).MSG2     07600000
.*                                                    IF &WRKREGS IS    07650000
.*                                                    SPECIFIED BUT     07700000
.*                                                    INVALIDLY ISSUE   07750000
.*                                                    ERROR MESSAGE.    07800000
.*    SET UP LOCAL CHARACTER FOR USE IN EXPANSIONS                      07850000
&R1    SETC    '&WRKREGS(1)'                                            07900000
&R2    SETC    '&WRKREGS(2)'                                            07950000
&R3    SETC    '&PARMAD(1)'                                             08000000
&R4    SETC    '&FRRAD(1)'                                              08050000
.*                                                    OTHERWISE CHECK   08100000
.*                                                    &OPT FOR A VALID  08150000
.*                                                    OPTION            08200000
         AIF       ('&OPT' EQ 'A' OR '&OPT' EQ 'R').ADREP               08250000
         AIF       ('&OPT' EQ 'D' OR '&OPT' EQ 'P').EXPAND              08300000
         AIF       ('&OPT' EQ 'F').FLUSH                                08350000
         AIF       ('&OPT' EQ 'AF').ADFL  ADD/FLUSH OPTION              08400000
.INVOPT  MNOTE     12,'INVALID OPTION &OPT SPECIFIED'          @G38LP1S 08450000
.*                                                    MESSAGE STATING   08500000
.*                                                    INVALID OPTION    08550000
         AGO       .END                               STOP EXPANSION    08600000
.ADREP   AIF       ('&FRRAD' EQ '').MSG3              ISSUE MESSAGE IF  08650000
.*                                                    &FRRAD  IS NOT    08700000
.*                                                    SPECIFIED FOR     08750000
.*                                                    THE ADD/REPLACE   08800000
.*                                                    OPTION            08850000
         AGO       .EXPAND1                                             08900000
.EXPAND  ANOP                                         BEGIN EXPANSION   08950000
         AIF       ('&FRRAD' NE '' OR '&PARMAD' NE '').WARN             09000000
         AGO       .EXPAND1                                             09050000
.WARN    MNOTE     *,'FRRAD AND/OR PARMAD SPECIFIED FOR DELETE/PURGE'   09100000
         MNOTE     0,'FRRAD AND/OR PARMAD IGNORED-DELETE/PURGE HONORED' 09150000
.*                                                             @G38LP2F 09200000
.EXPAND1 ANOP                                                           09250000
&NAME    L     &R1,PSACSTK-PSA(0,0)         ADDRESS OF CURRENT STACK    09300000
         AIF       ('&OPT' EQ 'P').PURGE              GO EXPAND FOR A   09350000
.*                                                    PURGE OF THE FRR  09400000
.*                                                    STACK             09450000
         AIF       ('&OPT' EQ 'A').ADD   GO TO ADD ROUTINE              09500000
         L     &R2,FRRSCURR-FRRS(0,&R1)     ADDR OF CURRENT             09550000
*                                           ELEMENT                     09600000
         CL    &R2,FRRSEMP-FRRS(0,&R1)      IS THE FRR STACK EMPTY      09650000
         AIF       ('&OPT' EQ 'R').BRANCH             IF OPTION IS      09700000
.*                                                    REPLACE EXPAND    09750000
.*                                                    AT .BRANCH        09800000
         BE    *+12                         YES, DO NOT DELETE ENTRY    09850000
         SL    &R2,FRRSELEN-FRRS(0,&R1)     DECREMENT CURRENT           09900000
*                                           ADDRESS                     09950000
         AGO       .UPDATE                                              10000000
.ADD     L     &R2,FRRSELEN-FRRS(0,&R1)     LENGTH OF FRR STACK         10050000
*                                           ENTRY              @G381P2F 10100000
.*                                          (USE FRRSELEN INSTEAD OF    10150000
.*                                           OF 32)            @G381P2F 10200000
         AL    &R2,FRRSCURR-FRRS(0,&R1)     COMPUTE NEXT ENTRY          10250000
*                                           ADDRESS                     10300000
         CL    &R2,FRRSLAST-FRRS(0,&R1)     WILL STACK OVERFLOW         10350000
         BH    PSALSFCC-PSA(0,0)            YES, ISSUE 07D ABEND        10400000
         AGO       .COMMON1                                             10450000
.BRANCH  BNE   *+8                          NO, SKIP UPDATE    @G381P2F 10500000
.COMMON  AL    &R2,FRRSELEN-FRRS(0,&R1)     COMPUTE NEXT ENTRY ADDR     10550000
.COMMON1 ANOP                                                  @G381P2F 10600000
         AIF        ('&FRRAD'(1,1) EQ '(').STFRR                        10650000
         AIF        (T'&FRRAD EQ 'N').MSG4                              10700000
         MVC   FRRSFRRA-FRRSENTR(4,&R2),&FRRAD  PUT FRR ADDRESS         10750000
*                                               INTO THE STACK @G381P2F 10800000
         AGO         .PMCHK                                             10850000
.STFRR   ST    &R4,FRRSFRRA-FRRSENTR(0,&R2) ADD ADDR TO STACK           10900000
.PMCHK   AIF    ('&PARMAD' EQ '' ).UPDATE                      @G381P2F 10950000
.*                             DETERMINE IF PARMS ARE SPECIFIED         11000000
         AIF        ('&PARMAD'(1,1) EQ '(').LPARM                       11050000
         AIF        (T'&PARMAD EQ 'N').MSG4                             11100000
         AIF     ('&OPT' EQ 'R' AND '&CLEAR' EQ 'Y').C5                 11150000
         AIF     ('&OPT' EQ 'R' AND '&CLEAR' EQ 'YES').C5               11200000
         AIF       ('&OPT' NE 'A').NOZERO1            IS THIS THE       11250000
.*                                                    ADD OPTION        11300000
.*                                                   YES DO FOLLOWING   11350000
         AIF   ('&CLEAR' EQ 'N' OR '&CLEAR' EQ 'NO').NOZERO1            11400000
.C5      XC    FRRSPARM-FRRSENTR(24,&R2),FRRSPARM-FRRSENTR(&R2)         11450000
*                                           ZERO FRR PARM AREA          11500000
.NOZERO1 ST    &R2,FRRSCURR-FRRS(0,&R1)     UPDATE CURRENT              11550000
*                                           ENTRY ADDRESS      @G381P2F 11600000
         LA    &R2,FRRSPARM-FRRSENTR(0,&R2) RETURN PARM AREA            11650000
         ST    &R2,&PARMAD                  ADDRESS TO USER             11700000
         AGO        .END                                                11750000
.LPARM   ANOP                                                           11800000
         AIF      ('&OPT' EQ 'R' AND '&CLEAR' EQ 'Y').C6                11850000
         AIF      ('&OPT' EQ 'R' AND '&CLEAR' EQ 'YES').C6              11900000
         AIF       ('&OPT' NE 'A').NOZERO2            IS THIS THE       11950000
.*                                                    ADD OPTION        12000000
.*                                                   YES DO FOLLOWING   12050000
         AIF   ('&CLEAR' EQ 'N' OR '&CLEAR' EQ 'NO').NOZERO2            12100000
.C6      XC    FRRSPARM-FRRSENTR(24,&R2),FRRSPARM-FRRSENTR(&R2)         12150000
*                                           ZERO FRR PARM AREA          12200000
.NOZERO2 ST    &R2,FRRSCURR-FRRS(0,&R1)     UPDATE CURRENT              12250000
*                                           ENTRY ADDRESS      @G381P2F 12300000
         LA    &R3,FRRSPARM-FRRSENTR(0,&R2) ADDR OF PARM AREA           12350000
         AGO       .END                                                 12400000
.PURGE   L     &R2,FRRSEMP-FRRS(0,&R1)      LOAD EMPTY STACK ADDR       12450000
.UPDATE  ST    &R2,FRRSCURR-FRRS(0,&R1)     UPDATE CURRENT STACK        12500000
*                                           ENTRY                       12550000
         AIF       ('&OPT' NE 'P').END      FINISHED IF NOT             12600000
*                                           PURGE              @G382P2F 12650000
         CL    &R1,PSANSTK-PSA(0,0)         IS THIS THE NORMAL          12700000
*                                           STACK              @G382P2F 12750000
         BNE   *+8                          NO, BRANCH         @G382P2F 12800000
         NI    PSAMFLGS-PSA(0),X'7F'        ENSURE PSANSS FLAG          12850000
*                                           IS OFF             @G382P2F 12900000
         AGO       .END                                                 12950000
.FLUSH   ANOP                                                           13000000
&NAME    L     &R1,PSASTAK-PSA(0,0)               NORMAL STACK PTR      13050000
         ST    &R1,PSASTAK-PSA+FRRSCURR-FRRS(0,0) PURGE STACK           13100000
         MVI   PSASTAK-PSA+FRRSRTMW-FRRS(0),X'00' ZERO RECURSION BYTE   13150000
         NI    PSAMFLGS-PSA(0),X'7F'             ENSURE PSANSS          13200000
*                                                FLAG IS OFF   @G381P2F 13250000
         AGO   .END                                                     13300000
.ADFL    ANOP                                                           13350000
         AIF   ('&FRRAD' EQ '').MSG3  INSURE FRR AD IS SPECIFIED        13400000
         AIF   ('&FRRAD'(1,1) EQ '(').B10                               13450000
         AIF   (T'&FRRAD EQ 'N').MSG4                                   13500000
&R4      SETC  '&WRKREGS(2)'   SET WORK REG                             13550000
&NAME    L     &R4,&FRRAD                        LOAD FRR ADDRESS       13600000
         MVI   PSASTAK-PSA+FRRSRTMW-FRRS(0),0    ZERO RECURSION BYTE    13650000
         AGO  .B11                                                      13700000
.B10     ANOP                                                           13750000
&NAME    MVI   PSASTAK-PSA+FRRSRTMW-FRRS(0),0    ZERO RECURSION BYTE    13800000
.B11     NI    PSAMFLGS-PSA(0),X'7F'             ENSURE PSANSS          13850000
*                                                FLAG IS OFF   @G381P2F 13900000
         L     &R1,PSASTAK-PSA+FRRSEMP-FRRS(,0)  EMPTY STACK ADDRESS    13950000
*                                                              @G381P2F 14000000
         ST    &R1,PSASTAK-PSA+FRRSCURR-FRRS(,0) RESET STACK            14050000
         AL    &R1,PSASTAK-PSA+FRRSELEN-FRRS(,0) FIRST ENTRY ADDRESS    14100000
*                                                              @ZMB0044 14150000
         ST    &R4,FRRSFRRA-FRRSENTR(0,&R1)      ADD ADDRESS TO STACK   14200000
         AIF   ('&PARMAD' EQ '').C14    IF NO PARMS REQUEST BRANCH      14250000
.*                                      TO RESET THE STACK     @G381P2F 14300000
         AIF    ('&CLEAR' NE 'Y' AND '&CLEAR' NE 'YES').C14    @G381P2F 14350000
         XC    FRRSPARM-FRRSENTR(24,&R1),FRRSPARM-FRRSENTR(&R1)         14400000
*                                                CLEAR PARM AREA        14450000
.C14     ST    &R1,PSASTAK-PSA+FRRSCURR-FRRS(,0) RESET STACK            14500000
*                                                              @G381P2F 14550000
         AIF   ('&PARMAD' EQ '').END   FINISHED IF NO PARMS REQUEST     14600000
.*                                                             @G381P2F 14650000
         AIF   ('&PARMAD'(1,1) EQ '(').C10                              14700000
         AIF   (T'&PARMAD EQ 'N').MSG4                                  14750000
         AGO   .C13                                                     14800000
.C10     LA    &R3,FRRSPARM-FRRSENTR(0,&R1)      FRR PARM ADDRESS       14850000
         AGO   .END                                                     14900000
.C13     LA    &R2,FRRSPARM-FRRSENTR(0,&R1)      FRR PARM ADDRESS       14950000
         ST    &R2,&PARMAD                       RETURN TO USER         15000000
         AGO   .END                                                     15050000
.*                                        ***************************   15100000
.OUTLINE ANOP                                                  @G381P2F 15150000
.*                                        FOLLOWING IS CODE TO          15200000
.*                                        BRANCH TO IEAVTSFR   @G381P2F 15250000
.*                                        AND PERFORM ADD FRR  @G38LP1S 15300000
.*                                        INSTRUCTION          @G38LP1S 15350000
.*                                                                      15400000
.*    SET UP LOCAL CHARACTER FOR USE IN EXPANSIONS                      15450000
&I       SETA  1                 INIT INDEX FOR MODE           @G381P2F 15500000
&MODFLG  SETA  0                 INIT MODE FLAGS               @G381P2F 15550000
&CTRLNK  SETA  0                 INIT BRANCH TABLE CTR         @G381P2F 15600000
&B(1)    SETB  0                 INIT MODE=HOME IND            @G381P2F 15650000
&B(2)    SETB  0                 INIT MODE=FULLXM IND          @G381P2F 15700000
&B(3)    SETB  0                 INIT MODE=PRIMARY IND         @G381P2F 15750000
&B(4)    SETB  0                 INIT MODE=LOCAL IND           @G381P2F 15800000
&B(5)    SETB  0                 INIT MODE=GLOBAL IND          @G381P2F 15850000
&R1      SETC  '&WRKREGS(1)'                                   @G381P2F 15900000
&R3      SETC  '&PARMAD(1)'                                    @G381P2F 15950000
&R4      SETC  '&FRRAD(1)'                                     @G381P2F 16000000
.*                                                    OTHERWISE CHECK   16050000
.*                                                    &OPT FOR A VALID  16100000
.*                                                    OPTION            16150000
         AIF       ('&OPT' EQ 'A' OR '&OPT' EQ 'R').ADREP2     @G381P2F 16200000
         AIF       ('&OPT' EQ 'D' OR '&OPT' EQ 'P').EXPAND2    @G381P2F 16250000
         AIF       ('&OPT' EQ 'F').FLUSH2                      @G381P2F 16300000
         AIF       ('&OPT' EQ 'AF').ADFL2  ADD/FLUSH OPTION    @G381P2F 16350000
         MNOTE     12,'INVALID OPTION &OPT SPECIFIED'                   16400000
.*                                                    MESSAGE STATING   16450000
.*                                                    INVALID OPTION    16500000
         AGO       .END                               STOP EXPANSION    16550000
.*                                                                      16600000
.ADREP2  ANOP                              SYNTAX CHECK FOR ADD         16650000
.*                                         AND REPLACE         @G381P2F 16700000
.*                                                                      16750000
         AIF       ('&FRRAD' EQ '').MSG3              ISSUE MESSAGE IF  16800000
.*                                                    &FRRAD  IS NOT    16850000
.*                                                    SPECIFIED FOR     16900000
.*                                                    THE ADD/REPLACE   16950000
.*                                                    OPTION   @G381P2F 17000000
         AIF       ('&MODE' NE '').MODELP  CHECK MODE          @G381P2F 17050000
&B(1)    SETB      1                      IND HOME DEFAULTED   @G381P2F 17100000
         AGO       .CHKEUT                                              17150000
.MODELP  ANOP                              MODE LOOP WILL SCAN THE      17200000
.*                                         MODE OPTIONS, SYNTAX CHECK   17250000
.*                                         AND INDICATE THE OPTIONS     17300000
.*                                         CHOSEN              @G381P2F 17350000
         AIF       ('&MODE(&I)' NE 'HOME').FULL  IF NOT HOME, CHECK     17400000
.*                                               FOR FULLXM    @G381P2F 17450000
         AIF       (&B(2) OR &B(3)).MSG10  ISSUE MESSAGE IF FULLXM OR   17500000
.*                                         PRIMARY HAS ALSO BEEN        17550000
.*                                         SPECIFIED           @G381P2F 17600000
&B(1)    SETB      1                       IND HOME SPEC       @G381P2F 17650000
         AGO       .INITLP                                     @G381P2F 17700000
.FULL    ANOP                                                  @G381P2F 17750000
         AIF       ('&MODE(&I)' NE 'FULLXM').PRIM IF NOT FULLXM,CHECK   17800000
.*                                               FOR PRIMARY   @G381P2F 17850000
         AIF       (&B(2)).INITLP          IGNORE IF FULLXM WAS         17900000
.*                                         SPECIFIED BEFORE    @G381P2F 17950000
         AIF       (&B(1) OR &B(3)).MSG10  ISSUE MESSAGE IF HOME OR     18000000
.*                                         PRIMARY HAS ALSO BEEN        18050000
.*                                         SPECIFIED           @G381P2F 18100000
&MODFLG  SETA      &MODFLG+8               IND FULLXM          @G381P2F 18150000
&B(2)    SETB      1                       IND FULLXM SPEC     @G381P2F 18200000
         AGO       .INITLP                                     @G381P2F 18250000
.PRIM    ANOP                                                  @G381P2F 18300000
         AIF       ('&MODE(&I)' NE 'PRIMARY').LCL IF NOT PRIMARY, CHK   18350000
.*                                                FOR LOCAL    @G381P2F 18400000
         AIF       (&B(3)).INITLP          IGNORE IF PRIMARY WAS        18450000
.*                                         SPECIFIED BEFORE    @G381P2F 18500000
         AIF       (&B(1) OR &B(2)).MSG10  ISSUE MESSAGE IF HOME OR     18550000
.*                                         FULLXM HAS ALSO BEEN         18600000
.*                                         SPECIFIED           @G381P2F 18650000
&MODFLG  SETA      &MODFLG+4               IND PRIMARY         @G381P2F 18700000
&B(3)    SETB      1                       IND PRIMARY SPEC    @G381P2F 18750000
         AGO       .INITLP                                     @G381P2F 18800000
.LCL     ANOP                                                  @G381P2F 18850000
         AIF       ('&MODE(&I)' NE 'LOCAL').GLB  IF NOT LOCAL, CHECK    18900000
.*                                               FOR GLOBAL    @G381P2F 18950000
         AIF       (&B(4)).INITLP          IGNORE IF LOCAL WAS          19000000
.*                                         SPECIFIED BEFORE    @G381P2F 19050000
&MODFLG  SETA      &MODFLG+2               IND LOCAL           @G381P2F 19100000
&B(4)    SETB      1                       IND LOCAL SPEC      @G381P2F 19150000
         AGO       .INITLP                                     @G381P2F 19200000
.GLB     ANOP                                                  @G381P2F 19250000
         AIF       ('&MODE(&I)' NE 'GLOBAL').MSG10  IF NOT GLOBAL,      19300000
.*                                               ISSUE MESSAGE THAT     19350000
.*                                               MODE IS SPECIFIED      19400000
.*                                               INCORRECTLY   @G381P2F 19450000
         AIF       (&B(5)).INITLP          IGNORE IF GLOBAL WAS         19500000
.*                                         SPECIFIED BEFORE    @G381P2F 19550000
&MODFLG  SETA      &MODFLG+1               IND GLOBAL          @G381P2F 19600000
&B(5)    SETB      1                       IND GLOBAL SPEC     @G381P2F 19650000
.INITLP  ANOP                                                  @G381P2F 19700000
&I       SETA      &I+1                    INCR ELEMENT CTR    @G381P2F 19750000
         AIF       (&I LE &J).MODELP       IF MORE ELEMENTS, LOOP TO    19800000
.*                                         SCAN THE NEXT ONE   @G381P2F 19850000
.*                                                                      19900000
.CHKEUT  ANOP                              CHECK EUT           @G382P2F 19950000
.*                                                                      20000000
         AIF       ('&EUT' NE '' AND '&EUT' NE 'Y' AND                 S20050000
                   '&EUT' NE 'YES').MSG8    ISSUE MESSAGE IF &EUT       20100000
.*                                          IS SPECIFIED INCORRECTLY    20150000
.*                                                             @G382P2F 20200000
         AGO        .EXPAND3                                   @G382P2F 20250000
.*                                                                      20300000
.EXPAND2 ANOP                             SYNTAX CHECK FOR DELETE       20350000
.*                                        AND PURGE            @G381P2F 20400000
.*                                                                      20450000
         AIF       ('&FRRAD' EQ '' AND '&PARMAD' EQ '').WARN2           20500000
.*                                                             @G381P2F 20550000
         MNOTE     *,'FRRAD AND/OR PARMAD SPECIFIED FOR DELETE/PURGE'   20600000
.*                                                             @G381P2F 20650000
         MNOTE     0,'FRRAD AND/OR PARMAD IGNORED-DELETE/PURGE HONORED' 20700000
.*                                                             @G38LP2F 20750000
.WARN2   ANOP                                                  @G381P2F 20800000
         AIF       ('&WRKREGS'(1,1) NE '(' OR N'&WRKREGS NE 2).MSG2     20850000
.*                                       IF &WRKREGS IS SPECIFIED BUT   20900000
.*                                       INVALIDLY, ISSUE ERROR         20950000
.*                                       MESSAGE.              @G382P2F 21000000
&R2    SETC    '&WRKREGS(2)'                                   &G382P2F 21050000
         AIF       ('&MODE' EQ '').WARN3                       @G381P2F 21100000
         MNOTE     0,'MODE SPECIFIED FOR DELETE/PURGE - MODE IGNORED'   21150000
.*                                                             @G38LP2F 21200000
.WARN3   ANOP                                                  @G381P2F 21250000
         AIF       ('&EUT' NE '' AND '&OPT' EQ 'P').MSG11      @G381P2F 21300000
         AIF       ('&EUT' EQ '').CHKEUT                       @G382P2F 21350000
         MNOTE     0,'EUT SPECIFIED FOR DELETE - EUT IGNORED'  @G38LP2F 21400000
.*                                                                      21450000
.EXPAND3 ANOP                          START CODE GENERATION FOR        21500000
.*                                     ADD, REPLACE, DELETE, AND        21550000
.*                                     PURGE                   @G381P2F 21600000
&LABEL   SETC  '&NAME'        LABEL REQUESTED BY CALLER        @G38LP1S 21650000
&LABELA  SETC  'IHB&SYSNDX.A' FOR LOCAL BRANCHING              @G38LP1S 21700000
&LABELB  SETC  'IHB&SYSNDX.B' FOR LOCAL BRANCHING              @G38LP1S 21750000
.*                                                                5@H1D 21800000
.*                                                                      22150000
&LABEL   L     &R1,PSACSTK-PSA(0,0)      ADDR OF CURRENT STACK @G38LP1S 22200000
         AIF       ('&OPT' EQ 'D' OR '&OPT' EQ 'P').CHKMPTY  BRANCH     22250000
.*                                        IF DELETE OR PURGE   @G381P2F 22300000
         AIF       ('&EUT' EQ '').SAVREGS  BRANCH IF NOT EUT   @G381P2F 22350000
         CL    &R1,PSANSTK-PSA(0,0)      IS CURRENT STACK THE           22400000
*                                        NORMAL STACK          @G382P2F 22450000
         BNE   *+8                       NO, BRANCH            @G382P2F 22500000
         OI    PSAMFLGS-PSA(0),X'80'     IND EUT TYPE FRR      @G381P2F 22550000
         AGO   .SAVREGS                                            @H1C 22600000
.*                                                                3@H1D 22650000
.CHKMPTY ANOP                                                  @G382P2F 22900000
         L     &R2,FRRSCURR-FRRS(0,&R1)     ADDR OF CURRENT             22950000
*                                           ELEMENT            @G382P2F 23000000
         CL    &R2,FRRSEMP-FRRS(0,&R1)      IS THE FRR STACK            23050000
*                                           EMPTY              @G382P2F 23100000
         AIF        (T'&WRKREGS(1) NE 'N').BRMPTY1  IF NOT SELF-        23150000
.*                                          DEFINING, BRANCH   @G381P2F 23200000
         AIF        (&R1 EQ 1).BRMPTY2      IF FIRST WORK REG PASSED    23250000
.*                                          IS REG 1, BRANCH   @G381P2F 23300000
.BRMPTY1 ANOP                                                  @G382P2F 23350000
         BE    *+40                     YES, NO NEED TO UPDATE @G381P2F 23400000
         AGO        .SAVREGS                                   @G381P2F 23450000
.BRMPTY2 ANOP                                                  @G382P2F 23500000
         BE    *+38                     YES, NO NEED TO UPDATE @G381P2F 23550000
         AGO        .SAVREGS                                   @G381P2F 23600000
.*                                                                      23650000
.ADFL2   ANOP                          SYNTAX CHECK FOR ADD/FLUSH       23700000
.*                                                             @G381P2F 23750000
.*                                                                      23800000
         AIF       ('&FRRAD' EQ '').MSG3              ISSUE MESSAGE IF  23850000
.*                                                    &FRRAD  IS NOT    23900000
.*                                                    SPECIFIED FOR     23950000
.*                                                    THE ADD/FLUSH     24000000
.*                                                    OPTION   @G381P2F 24050000
         AIF       ('&MODE' EQ '').ADFLEUT                     @G381P2F 24100000
         MNOTE     0,'MODE SPECIFIED FOR ADDFLUSH - MODE IGNORED'       24150000
.*                                                             @G38LP2F 24200000
.ADFLEUT ANOP                                                  @G381P2F 24250000
         AIF       ('&EUT' NE '').MSG11                        @G381P2F 24300000
.*                                                                      24350000
.*                                     START CODE GENERATION FOR        24400000
.*                                     ADDFLUSH                @G381P2F 24450000
.*                                                                      24500000
&NAME    LA    &R1,PSASTAK-PSA(0,0)      NORMAL STACK ADDR     @ZM49899 24550000
.*                                                             @G381P2F 24600000
.SAVREGS ANOP                          CONTINUE WITH CODE GENERATION    24650000
.*                                     FOR ADD, REPLACE, ADDFLUSH,      24700000
.*                                     DELETE, AND PURGE       @G381P2F 24750000
.*                                                             @G381P2F 24800000
         STM   14,3,16(&R1)              SAVE REGS 14-3        @G381P2F 24850000
         AIF        ('&OPT' EQ 'D' OR '&OPT' EQ 'P').DELPUR    @G381P2F 24900000
.*                                                             @G381P2F 24950000
.*                                   IF OPTION IS ADD, REPLACE, OR      25000000
.*                                   ADD/FLUSH, SAVE &FRRAD    @G381P2F 25050000
.*                                                             @G381P2F 25100000
         AIF        ('&FRRAD'(1,1) EQ '(').STFRR2 IF A REG WAS          25150000
.*                                                SPECIFIED    @G381P2F 25200000
         AIF        (T'&FRRAD EQ 'N').MSG4                     @G381P2F 25250000
         L     0,&FRRAD                  LOAD FRR ADDRESS      @G381P2F 25300000
         AGO         .LDREG1                                   @G381P2F 25350000
.STFRR2  ANOP                                                  @G381P2F 25400000
         AIF        (T'&FRRAD NE 'N').LDREG0  IF NOT SELF-DEFINING,     25450000
.*                                          BRANCH             @G381P2F 25500000
         AIF        (&R4 EQ 0).LDREG1       IF FRR ADDR PASSED IN       25550000
.*                                          REG 0, BRANCH      @G381P2F 25600000
.LDREG0  ANOP                                                  @G381P2F 25650000
         LR    0,&R4                     LOAD FRR ADDRESS      @G381P2F 25700000
.LDREG1  ANOP                                                  @G381P2F 25750000
         AIF        (T'&WRKREGS(1) NE 'N').LDREG1A  IF NOT SELF-        25800000
.*                                          DEFINING, BRANCH   @G381P2F 25850000
         AIF        (&R1 EQ 1).NTRYAD       IF FIRST WORK REG PASSED    25900000
.*                                          IS REG 1, BRANCH   @G381P2F 25950000
.LDREG1A ANOP                                                  @G381P2F 26000000
         LR    1,&R1                     SAVE STACK PTR        @G381P2F 26050000
.NTRYAD  ANOP                                                  @G381P2F 26100000
.*                                   CALCULATE ENTRY ADDRESS INTO       26150000
.*                                   IEAVTSFR                  @G381P2F 26200000
.*                                                             @G381P2F 26250000
         AIF   ('&CLEAR' EQ 'Y' OR '&CLEAR' EQ 'YES').CLEAR    @G381P2F 26300000
         AIF   ('&OPT' NE 'A').CHKADFL   DEFAULT FOR ADDFLUSH AND       26350000
.*                                       REPLACE IS CLEAR=NO   @G381P2F 26400000
         AIF   ('&CLEAR' EQ 'N' OR '&CLEAR' EQ 'NO').CHKADFL            26450000
.*                                       DEFAULT FOR ADD IS             26500000
.*                                       CLEAR=YES             @G381P2F 26550000
.CLEAR   ANOP                                                  @G381P2F 26600000
&CTRLNK  SETA    4                       OFFSET FOR CLEAR=YES           26650000
.*                                       (IEAVTSFR BR TABLE)   @G381P2F 26700000
.CHKADFL ANOP                                                  @G381P2F 26750000
         AIF   ('&OPT' NE 'AF').CHKEM    CHK IF ADDFLUSH       @G381P2F 26800000
&CTRLNK  SETA  &CTRLNK+48                OFFSET FOR ADDFLUSH   @G381P2F 26850000
         AGO   .BALR                                           @G381P2F 26900000
.CHKEM   ANOP                                                  @G381P2F 26950000
         AIF   ('&EUT' EQ '').CHKMODE    CHECK FOR MODE IF EUT NOT      27000000
.*                                       SPECIFIED             @G381P2F 27050000
&MODFLG  SETA  &MODFLG+128               IND EUT=YES           @G381P2F 27100000
         AGO   .INDEM                                          @G381P2F 27150000
.CHKMODE ANOP                                                  @G381P2F 27200000
         AIF   (&MODFLG EQ 0).OPTS       BRANCH IF MODE WAS NOT         27250000
.*                                       SPECIFIED OR =HOME    @G381P2F 27300000
.INDEM   ANOP                            IND EUT OR MODE (OTHER THAN    27350000
.*                                       HOME) WAS SPECIFIED   @G381P2F 27400000
         AIF   (&B(2) OR &B(3)).SAVXM    BRANCH IF MODE=FULLXM OR       27450000
.*                                       PRIMARY WAS SPEC      @G381P2F 27500000
&CTRLNK  SETA  &CTRLNK+8                 OFFSET FOR EUT OR MODE BUT     27550000
.*                                       WITHOUT CROSS MEMORY STATUS    27600000
.*                                       (IEAVTSFR BR TABLE)   @G381P2F 27650000
         AGO   .INITR2                                         @G381P2F 27700000
.SAVXM   ANOP                                                  @G381P2F 27750000
&CTRLNK  SETA  &CTRLNK+16                OFFSET FOR EUT OR MODE AND     27800000
.*                                       SAVING CROSS MEMORY STATUS     27850000
.*                                       (IEAVTSFR BR TABLE)   @G381P2F 27900000
.INITR2  ANOP                                                  @G381P2F 27950000
         LA    2,&MODFLG                 IND PARAMETERS CHOSEN @G381P2F 28000000
.OPTS    ANOP                                                  @G381P2F 28050000
         AIF   ('&OPT' NE 'R').BALR      CHK IF REPLACE        @G381P2F 28100000
&CTRLNK  SETA  &CTRLNK+24                OFFSET FOR REPLACE    @G381P2F 28150000
         AGO   .BALR                                           @G381P2F 28200000
.*                                                             @G381P2F 28250000
.DELPUR  ANOP                            DELETE OR PURGE       @G381P2F 28300000
         AIF        (T'&WRKREGS(1) NE 'N').LDREG1D  IF NOT SELF-        28350000
.*                                          DEFINING, BRANCH   @G381P2F 28400000
         AIF        (&R1 EQ 1).BRIFPUR      IF FIRST WORK REG PASSED    28450000
.*                                          IS REG 1, BRANCH   @G381P2F 28500000
.LDREG1D ANOP                                                  @G381P2F 28550000
         LR    1,&R1                     SAVE STACK PTR        @G381P2F 28600000
.BRIFPUR ANOP                                                  @G381P2F 28650000
         AIF        ('&OPT' EQ 'P').PURGE2   GO TO PURGE       @G381P2F 28700000
.*                                                             @G381P2F 28750000
&CTRLNK  SETA  56                        OFFSET FOR DELETE     @G381P2F 28800000
         AGO   .BALR                                           @G381P2F 28850000
.PURGE2  ANOP                                                  @G381P2F 28900000
&CTRLNK  SETA  64                        OFFSET FOR PURGE      @G381P2F 28950000
         AGO   .BALR                                           @G381P2F 29000000
.*                                                                      29050000
.FLUSH2  ANOP                           SYNTAX CHECK AND CODE           29100000
.*                                      GENERATION FOR FLUSH   @G381P2F 29150000
.*                                                                      29200000
         AIF       ('&MODE' EQ '').FLEUT                       @G381P2F 29250000
         MNOTE     0,'MODE SPECIFIED FOR FLUSH - MODE IGNORED'          29300000
.*                                                             @G38LP2F 29350000
.FLEUT   ANOP                                                  @G381P2F 29400000
         AIF       ('&EUT' NE '').MSG11                        @G381P2F 29450000
&CTRLNK  SETA  68                        OFFSET FOR FLUSH      @G381P2F 29500000
&NAME    LA    &R1,PSASTAK-PSA(0,0)      NORMAL STACK ADDR     @ZM49899 29550000
         STM   14,3,16(&R1)              SAVE REGS 14-3        @G381P2F 29600000
         AIF        (T'&WRKREGS(1) NE 'N').LDREG1E  IF NOT SELF-        29650000
.*                                          DEFINING, BRANCH   @G381P2F 29700000
         AIF        (&R1 EQ 1).BALR         IF FIRST WORK REG PASSED    29750000
.*                                          IS REG 1, BRANCH   @G381P2F 29800000
.LDREG1E ANOP                                                  @G381P2F 29850000
         LR    1,&R1                     SAVE STACK PTR        @G381P2F 29900000
.*                                                                      29950000
.*                                       BALR TO IEAVTSFR      @G381P2F 30000000
.*                                                                      30050000
.BALR    ANOP                                                  @G381P2F 30100000
.*                                                                4@H1D 30150000
         L     15,16(0,0)                LOAD CVT ADDRESS      @G381P2F 30350000
         L     15,276(0,15)              ADDR OF IEAVTSFR      @G381P2F 30400000
         L     15,&CTRLNK.(,15)          ADDR OF ENTRY POINT   @G381P2F 30450000
         BALR  14,15                     GO TO IEAVTSFR        @G381P2F 30500000
         AIF       ('&OPT' EQ 'F').LMREGS                      @G382P2F 30550000
         AIF       ('&OPT' EQ 'P' OR '&OPT' EQ 'D').LMNSS      @G382P2F 30600000
.*                                                             @G381P2F 30650000
.*                                 IF OPTION IS ADD, REPLACE, OR        30700000
.*                                 ADDFLUSH CHECK PARMAD       @G381P2F 30750000
.*                                                             @G381P2F 30800000
         AIF   ('&PARMAD' EQ '').LMREGS  CHECK IF PARMAD       @G381P2F 30850000
         AIF   ('&PARMAD'(1,1) EQ '(').C19                     @G381P2F 30900000
         AIF   (T'&PARMAD EQ 'N').MSG4                         @G381P2F 30950000
         LM    14,3,16(1)                RESTORE REGS          @G381P2F 31000000
         L     &R1,FRRSCURR-FRRS(0,&R1)  CURRENT ENTRY                  31050000
*                                                              @G381P2F 31100000
         LA    &R1,FRRSPARM-FRRSENTR(0,&R1) FRR PARM ADDRESS            31150000
*                                                              @G381P2F 31200000
         ST    &R1,&PARMAD               RETURN ADDR TO USER   @G381P2F 31250000
         AGO   .ASST1                                          @G38LP1S 31300000
.C19     ANOP                                                  @G381P2F 31350000
         AIF   (T'&PARMAD(1) NE 'N').LM1ST  IF NOT SELF-DEFINING,       31400000
.*                                          BRANCH             @G381P2F 31450000
         AIF   (&R3 GT 2 AND &R3 LT 14).PARM1ST                @G381P2F 31500000
.LM1ST   ANOP                                                  @G381P2F 31550000
         LM    14,3,16(1)                RESTORE REGS          @G381P2F 31600000
         L     &R1,FRRSCURR-FRRS(0,&R1)  CURRENT ENTRY                  31650000
*                                                              @G381P2F 31700000
         LA    &R3,FRRSPARM-FRRSENTR(0,&R1) FRR PARM ADDRESS            31750000
*                                                              @G381P2F 31800000
         AGO   .ASST1                                          @G38LP1S 31850000
.PARM1ST ANOP                                                  @G381P2F 31900000
         LA    &R3,FRRSPARM-FRRSENTR(0,3) ADDR OF PARM AREA    @G381P2F 31950000
         AIF   (&R3 EQ 3).LMNOT3                               @G381P2F 32000000
.LMREGS  ANOP                                                  @G381P2F 32050000
         LM    14,3,16(1)                RESTORE REGS          @G381P2F 32100000
         AGO   .ASST1                                          @G38LP1S 32150000
.LMNOT3  ANOP                                                  @G381P2F 32200000
         LM    14,2,16(1)                RESTORE REGS          @G381P2F 32250000
.ASST1   ANOP  ,                                               @G38LP1S 32300000
         AGO   .END                     THAT'S ALL                 @H1C 32350000
.*                                                               37@H1D 32400000
.LMNSS   ANOP                                                  @G381P2F 35650000
         LM    14,3,16(1)                RESTORE REGS          @G382P2F 35700000
         B     *+12                                            @G382P2F 35750000
*                  IEAVTSFR RETURNS HERE WHEN THE PSANSS       @G382P2F 35800000
*                  BIT (EUT FLAG) NEEDS TO BE SET OFF          @G382P2F 35850000
         LM    14,3,16(1)                RESTORE REGS          @G382P2F 35900000
         NI    PSAMFLGS-PSA(0),X'7F'     SET PSANSS FLAG OFF   @G382P2F 35950000
         AGO   .END                                            @G382P2F 36000000
.MSG1    MNOTE     12,'WORK REGISTERS NOT SPECIFIED'                    36050000
         AGO       .END                                                 36100000
.MSG2    MNOTE     8,'WORK REGISTERS SPECIFIED INCORRECTLY'             36150000
.MSG5    MNOTE     8,'SPECIFY AS FOLLOWS - WRKREGS=(REGISTER,REGISTER)' 36200000
         AGO       .END                                                 36250000
.MSG3    MNOTE     8,'FRR ADDRESS NOT SPECIFIED FOR ADD/REPLACE'        36300000
         AGO        .END                                                36350000
.MSG4    MNOTE  8,'ADDRESS SPECIFIED FOR FRRAD/PARMAD IS SELF-DEFINING' 36400000
         AGO       .END                                        @G381P2F 36450000
.MSG6    MNOTE     8,'EUT NOT ALLOWED WITH INLINE=YES'         @G381P2F 36500000
         AGO       .END                                        @G381P2F 36550000
.MSG7    MNOTE    8,'MODE SPECIFIED INCORRECTLY WITH INLINE'   @G381P2F 36600000
         AGO        .END                                       @G381P2F 36650000
.MSG8    MNOTE     8,'EUT SPECIFIED INCORRECTLY'               @G381P2F 36700000
         AGO       .END                                        @G381P2F 36750000
.MSG9    MNOTE     8,'INLINE SPECIFIED INCORRECTLY'            @G381P2F 36800000
         AGO       .END                                        @G381P2F 36850000
.MSG10   MNOTE    12,'INVALID OPTION IN MODE SUBSTRING ELEMENT &I'      36900000
.*                                                             @G381P2F 36950000
         AGO        .END                                       @G381P2F 37000000
.MSG11   MNOTE     8,'EUT NOT ALLOWED WITH PURGE/FLUSH/ADDFLUSH'        37050000
.*                                                             @G381P2F 37100000
         AGO       .END                                        @ZM50139 37150000
.MSG12   MNOTE    12,'INVALID PARM &OPT2, PARENTHESIS MAY BE MISSING'   37200000
.*                                                             @ZM50139 37250000
         AGO   .END                                            @G38LP1S 37300000
.MSG13   MNOTE 8,'INVALID CLEAR OPTION'                        @G38LP1S 37350000
.END     MEND                                                           37400000
