*%/*                                                                    00050000
         MACRO                                                          01150000
&NAME    ATTACH &EP=,&EPLOC=,&DE=,&DCB=,&PARAM=,&VL=,&ECB=,        I270X01200000
               &GSPV=,&KEY=PROP,&GSPL=,&SHSPL=,&ETXR=,&LPMOD=,     I270X01250000
               &DPMOD=,&MF=I,&SF=I,&SHSPV=,&SM=PROB,&SZERO=YES,    I270X01300000
               &JSTCB=NO,&SVAREA=YES,&ROLL=(YES,NO),&HIARCHY=,     I270X01350000
               &JSCB=,&GIVEJPQ=NO,&TASKLIB=,&TSLOGON=NO,          20021X01400000
               &STAI=,&PURGE=,&ASYNCH=,                          Y02752X01450000
               &ESTAI=,&TERM=NO,&NSHSPL=,&NSHSPV=,&RSAPF=NO,   @Z40RP9BX01500000
               &RELATED=,                                              X01550000
               &LSQA=0,&DISP=YES,&TID=0,&TQE=,&FPREGSA=,         X02050X01583300
               &ALCOPY=,                                           @L1AX01594600
               &TCB=                                               @L2A 01605900
         AGO   .SKIP                                                    01617300
**** START OF SPECIFICATIONS ****************************************** 01618000
*                                                                       01618700
*01*  MACRO NAME: ATTACH                                                01619400
*                                                                       01620100
*01*  COPYRIGHT =                                                       01620800
*                                                                       01621500
*      5647-A01                                                         01622200
*      THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      01622900
*      (C)COPYRIGHT IBM CORP. 1981, 2000                                01623600
*      LICENSED MATERIALS - PROPERTY OF IBM                             01624300
*                                                                       01626400
*01*  STATUS: HBB7703                                                   01626600
*                                                                       01626800
*01*  EXTERNAL CLASSIFICATION: PI                                       01627000
*01*  END OF EXTERNAL CLASSIFICATION:                                   01627200
*                                                                       01627800
*01*  FUNCTION:                                                         01628500
*        Provide the interface to the ATTACH subtask service routine    01629200
*        (IEAVEAT0) via SVC 42                                          01629900
*                                                                       01630600
*                                                                       01631300
*01*  COMPONENT: SC1CL (Task Management)                                01632000
*                                                                       01632700
*01*  MACLIB: AMACLIB                                                   01633400
*                                                                       01634100
*01*  CHANGE ACTIVITY:                                                  01634800
*    MACCOMP Y-1 SC1CL/PZD81                                            01635500
*    MACSTAT Y-1 80020/G860PXB                                          01636200
*    MACSTAT Y-1 83229/OZ72420 - ENSURE THAT THE EXECUTE     @ZA72420   01636900
*                                FORM DOES NOT INVALIDLY     @ZA72420   01637600
*                                RESET BITS IN THE PLIST     @ZA72420   01638300
*                                PREVIOUSLY SET BY THE LIST  @ZA72420   01639000
*                                FORM.                       @ZA72420   01639700
*                                                                       01640400
*   $P1=PAB0182  JBB2110  821112  PD16FH:  BIT3 OF ATFLAGS2             01641100
*                                          NO LONGER SET OFF            01641800
*   $L1=AR       HBB3310  860106  PD16Q9:  ACCESS REGISTERS             01642500
*   $D1=DCR0049  HBB3310  860707  PD16Q9:  ATTACHX SUPPORT              01643200
*   $L2=DBFMC    HBB4430  910807  PD16FH:  STATUS REWRITE               01643400
*   $P2=PKB0146  HBB4430  911106  PD16FH:  ATFORMNM for DISP=RESET      01643600
*   $P3=PKB0754  HBB4430  920629  PD16CU:  Set ATNFORM correctly for    01643700
*                                          DISP=RESET                   01643800
*   $L3=64BITSUP HBB7703 981204 PD00XB: ESAME                           01644000
*                                                                       01644200
**** END OF SPECIFICATIONS *****************************************    01644600
.SKIP    ANOP  ,                                                        01645300
         GBLC  &SYSSPLV              GLOBAL FOR SPLEVEL MACRO  @G860PXZ 01650000
         SPLEVEL TEST                OBTAIN DEFAULT SYSSPLV    @G860PXZ 01700000
         AIF   ('&SYSSPLV' EQ '1').LEVEL1 CHECK LEVEL TO GEN   @G860PXZ 01750000
         GBLB  &IHBSWA,&IHBSWB                                          01800000
         GBLC  &IHBNO                                                   01850000
         GBLC  &SYSASCE              ASC ENVIRONMENT               @L1A 01875000
         GBLC  &SYSAM64           AMODE                            @L3A 01877600
         GBLA  &SYSALVL           ARCHLVL                          @L3A 01880200
         SYSSTATE TEST            WHAT IS ASC ENVIRONMENT          @L1A 01882800
         AIF ('&SYSAM64' EQ 'YES').INVKATTACHX AMODE 64, ATTACHX   @L3A 01885400
         AIF (&SYSALVL GT 1).INVKATTACHX ESAME, ATTACHX            @L3A 01888000
         AIF   ('&SYSASCE' NE 'P').INVKATTACHX IF NOT PRIMARY ASC  @D1AX01890600
               .                             MODE, INVOKE ATTACHX       01893600
         LCLA  &A,&E,&F,&G,&L,&K,&X,&NUMB                               01900000
         LCLA  &NUMB1,&NUMB2,&NUMB3,&NUMB4                       Y02752 01950000
         LCLA  &NI52,&NI60                                     @ZA72420 02000000
         LCLB  &F52(8),&F60(8)                                 @ZA72420 02050000
         LCLB  &NUMB3B                                         @G860PXB 02100000
         LCLB  &SWSTAI,&SWESTAI                                  Y02752 02150000
         LCLC  &STAITYP,&STXADDR,&STPADDR                        Y02752 02200000
         LCLC  &H,&CHAR,&PARA,&FUDGE,&GNAME,&NSHSP             @G860PXB 02250000
         LCLC  &FORM#                FORMAT NUMBER             @G860PXB 02300000
         LCLC  &NICOPY               MASK TO TURN OFF ALCOPY BIT   @L1A 02350000
&F52(1)  SETB  1                     INITIALIZE NSHSPL BIT     @ZA72420 02400000
&F60(1)  SETB  1                     INITIALIZE DE BIT         @ZA72420 02450000
&F60(2)  SETB  1                     INITIALIZE GSPL BIT       @ZA72420 02500000
&F60(3)  SETB  1                     INITIALIZE SHSPL BIT      @ZA72420 02550000
&NICOPY  SETC  '1'                   INITIALIZE TO LEAVE ON BIT    @L1A 02600000
&FORM#   SETC  '1'                   INITIAL FORMAT NUMBER   @G860PXB*/ 02800000
* /* MACDATE   11/11/91                                          @L2C*/ 02850000
* /*                                                                    02900000
.********************************************************************** 02908300
.*   TEST FOR REQUEST TO RESET A SUBTASK VIA DISP=RESET WITH TCB      * 02916600
.********************************************************************** 02924900
         AIF (T'&TCB NE 'O').ATTCHD                                @L2A 02933200
         AIF ('&DISP' EQ 'RESET').ATTCHD                           @L2A 02941500
&SWSTAI  SETB  ('&STAI(1)' NE '' )   SWITCH VALUE 1 IF STAI      Y02752 02950000
&SWESTAI SETB  ('&ESTAI(1)' NE '' )  SWITCH VALUE 1 IF ESTAI     Y02752 03000000
         AIF   (&SWSTAI AND &SWESTAI).ERSTAI                     Y02752 03050000
         AIF   (NOT &SWESTAI).STTYP1                             Y02752 03100000
         AIF   (N'&ESTAI GT 2).ERROR                             Y02752 03150000
&STXADDR SETC  '&ESTAI(1)'        EXIT RTN ADDR                  Y02752 03200000
&STPADDR SETC  '&ESTAI(2)'        PARM LIST FOR EXIT RTN         Y02752 03250000
&STAITYP SETC  'ESTAI'                                           Y02752 03300000
         AGO   .STTYP2                                           Y02752 03350000
.STTYP1  AIF   (NOT &SWSTAI).STTYP2                              Y02752 03400000
         AIF   (N'&STAI GT 2).ERROR                              Y02752 03450000
&STXADDR SETC  '&STAI(1)'         EXIT RTN ADDR                  Y02752 03500000
&STPADDR SETC  '&STAI(2)'         PARM LIST FOR EXIT RTN         Y02752 03550000
&STAITYP SETC  'STAI'                                            Y02752 03600000
.STTYP2  ANOP                                                    Y02752 03650000
&IHBNO   SETC  '306'                                                    03700000
 AIF ('&HIARCHY' NE '' AND '&HIARCHY' NE '0'                           *03750000
               AND '&HIARCHY' NE '1').ERRHID                       LCS1 03800000
         AIF   ('&MF' EQ 'L' OR('&SF' EQ 'L' AND '&MF(1)' EQ 'E')).E1   03850000
         AIF   ('&SF' EQ 'L' AND '&PARAM' NE '').ERROR2                 03900000
         AIF   ('&EP' NE '' AND '&EPLOC' NE '').ERROR4                  03950000
         AIF   ('&EP' NE '' AND '&DE' NE '').ERROR4                     04000000
         AIF   ('&DE' NE '' AND '&EPLOC' NE '').ERROR4                  04050000
         AIF   ('&LPMOD' EQ '').CONTAAA                                 04100000
         AIF   ('&LPMOD'(1,1) EQ '-').ERROR7                            04150000
.CONTAAA ANOP                                                           04200000
         AIF   ('&DISP' NE 'YES' AND '&DISP' NE 'NO').ERDISP            04250000
         AIF   ('&LSQA' NE '0' AND (&SWSTAI OR &SWESTAI)).E2     Y02752 04300000
         AIF   ('&LSQA' NE '0' AND '&PURGE' NE '' ).E3           Y02752 04350000
         AIF   ('&LSQA' NE '0' AND '&ASYNCH' NE '' ).E4          Y02752 04400000
         AIF   ('&LSQA' NE '0' AND ('&SZERO' NE 'NO')).E5               04450000
         AIF   ('&GIVEJPQ' NE 'NO' AND '&LSQA' NE '0').E6               04500000
         AIF   ('&LSQA' NE '0' AND '&GSPV' NE '').E7                    04550000
         AIF   ('&LSQA' NE '0' AND '&GSPL' NE '').E8                    04600000
         AIF   ('&LSQA' NE '0' AND '&SHSPV' NE '').E9                   04650000
         AIF   ('&LSQA' NE '0' AND '&SHSPL' NE '').E10                  04700000
         AIF   ('&TQE' NE 'YES' AND '&TQE' NE 'NO' AND '&TQE' NE '').ERX04750000
               TQE                                               X02050 04800000
         AIF   ('&FPREGSA' NE 'YES' AND '&FPREGSA' NE 'NO' AND '&FPREGSX04850000
               A' NE '').ERFP                                    X02050 04900000
         AIF   ('&NSHSPL' NE '' AND '&NSHSPV' NE '').ERNSHSP     Y02752 04950000
         AIF   ('&TERM' NE 'YES' AND '&TERM' NE 'NO').ERTERM     Y02752 05000000
         AIF   ('&ALCOPY' NE 'YES' AND '&ALCOPY' NE 'NO' AND '&ALCOPY' X05004600
               NE '').ERALCPY                                      @L1A 05009200
.* HERE INITIALIZE VARIABLES &NUMB,&NUMB1,&NUMB2,&NUMB3,&NUMB4   Y02752 05050000
.* THESE MUST NOT BE ALTERED ONCE SET.                           Y02752 05100000
.* BYTE AT OFFSET DECIMAL 27 IS DEFINED BY &NUMB                 Y02752 05150000
         AIF   ('&DISP' EQ 'YES').NUMBX1                         Y02752 05200000
&NUMB    SETA  (&NUMB+128)        DISP=NO FLAG SET TO 1          Y02752 05250000
.NUMBX1  ANOP                                                    Y02752 05300000
         AIF   ('&JSCB' EQ '').NUMBX2                            Y02752 05350000
&NUMB    SETA  (&NUMB+64)         JSCB ADDRESS SPECIFIED FLAG    Y02752 05400000
.NUMBX2  ANOP                                                    Y02752 05450000
         AIF   ('&GIVEJPQ' EQ 'NO').NUMBX3                       Y02752 05500000
&NUMB    SETA  (&NUMB+32)         GIVEJPQ=YES FLAG SET TO 1      Y02752 05550000
.NUMBX3  ANOP                                                    Y02752 05600000
         AIF   ('&KEY' EQ 'PROP').NUMBX4                         Y02752 05650000
&NUMB    SETA  (&NUMB+16)         KEY=ZERO FLAG ON               Y02752 05700000
.NUMBX4  ANOP                                                    Y02752 05750000
         AIF   ('&SZERO' EQ 'YES').NUMBX5                        Y02752 05800000
&NUMB    SETA  (&NUMB+8)          SZERO=NO FLAG SET TO 1         Y02752 05850000
.NUMBX5  ANOP                                                    Y02752 05900000
         AIF   ('&SVAREA' EQ 'YES').NUMBX6                       Y02752 05950000
&NUMB    SETA  (&NUMB+4)          SVAREA=NO FLAG SET TO 1        Y02752 06000000
.NUMBX6  ANOP                                                    Y02752 06050000
         AIF   ('&JSTCB' NE 'YES').NUMBX7                        Y02752 06100000
&NUMB    SETA  (&NUMB+2)          JSTCB=YES FLAG SET TO 1        Y02752 06150000
.NUMBX7  ANOP                                                    Y02752 06200000
         AIF   ('&SM' NE 'SUPV').NUMBX8                          Y02752 06250000
&NUMB    SETA  (&NUMB+1)          SM=SUPV FLAG ON                Y02752 06300000
.NUMBX8  ANOP                     BYTE IS COMPLETE               Y02752 06350000
.* BYTE AT OFFSET DECIMAL 60 IS DEFINED BY &NUMB1              @G860PXB 06400000
&NUMB1   SETA  0                                               @G860PXB 06450000
         AIF   ('&TASKLIB' EQ '').NUMB1X2                        Y02752 06500000
&NUMB1   SETA  (&NUMB1+2)         TASKLIB ADDRESS SPECIFIED FLAG Y02752 06550000
.NUMB1X2 ANOP                                                    Y02752 06600000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).NUMB1X3              Y02752 06650000
&NUMB1   SETA  (&NUMB1+1)         FLAG FOR STAI OR ESTAI         Y02752 06700000
.NUMB1X3 ANOP                     BYTE IS COMPLETE               Y02752 06750000
.* BYTE AT OFFSET DECIMAL 52 IS DEFINED BY &NUMB3              @G860PXB 06800000
         AIF   (NOT (&SWSTAI OR &SWESTAI)  ).NUMB3X1             Y02752 06850000
.* PURGE BITS (BITS 6 AND 7) ARE 00, CORRECT FOR PURGE=QUIESCE   Y02752 06900000
         AIF   ('&PURGE' EQ '').NOPRGE                           Y02752 06950000
         AIF   ('&PURGE' EQ 'QUIESCE').PRGEOK                    Y02752 07000000
&NUMB3   SETA  1                  SET TO PURGE=HALT FLAGS        Y02752 07050000
         AIF   ('&PURGE' EQ 'HALT').PRGEOK                       Y02752 07100000
&NUMB3   SETA  2                  SET TO PURGE=NONE FLAGS        Y02752 07150000
         AIF   ('&PURGE' EQ 'NONE').PRGEOK                       Y02752 07200000
         AGO   .ERROZ             INVALED PURGE OPERAND          Y02752 07250000
.NOPRGE  ANOP                     &NUMB3 IS SET TO QUIESCE       Y02752 07300000
         AIF   (&SWSTAI).PRGEOK   CORRECT DEFAULT FOR STAI       Y02752 07350000
&NUMB3   SETA  2                  SET TO NONE, DEFAULT FOR ESTAI Y02752 07400000
.PRGEOK  ANOP                     PURGE BITS ARE SET CORRECTLY   Y02752 07450000
         AIF   ('&ASYNCH' EQ '').NOASYNC                         Y02752 07500000
         AIF   ('&ASYNCH' EQ 'NO').ASYNCOK                       Y02752 07550000
&NUMB3   SETA  (&NUMB3+4)         SET ASYNCH=YES FLAG            Y02752 07600000
         AIF   ('&ASYNCH' EQ 'YES').ASYNCOK                      Y02752 07650000
         AGO   .ERROZ             INVALID ASYNCH OPERAND         Y02752 07700000
.NOASYNC ANOP                     CHECK DEFAULTS                 Y02752 07750000
         AIF   (&SWSTAI).ASYNCOK  ASYNCH=NO IS STAI DEFAULT      Y02752 07800000
&NUMB3   SETA  (&NUMB3+4)         ASYNCH=YES IS ESTAI DEFAULT    Y02752 07850000
.ASYNCOK ANOP                     ASYNCH BIT IS SET CORRECTLY    Y02752 07900000
         AIF   (&SWSTAI).NUMB3X1  TERM AND ESTAI FLAGS NOT SET   Y02752 07950000
&NUMB3   SETA  (&NUMB3+8)         BIT4=1 FOR ESTAI               Y02752 08000000
         AIF   ('&TERM' EQ 'NO').NUMB3X1                         Y02752 08050000
&NUMB3   SETA  (&NUMB3+16)        BIT3=1 FOR TERM=YES            Y02752 08100000
.NUMB3X1 ANOP                                                           08120000
         AIF   ('&ALCOPY' EQ 'NO').COPYNO                          @L1A 08133300
         AIF   ('&ALCOPY' NE 'YES').NUMB3X2                        @L1A 08146600
&NUMB3   SETA  (&NUMB3+32)        BIT2=1 FOR ALCOPY=YES            @L1A 08160000
         AGO   .NUMB3X2                                            @L1A 08165000
.COPYNO  ANOP                                                      @L1A 08170000
&NICOPY  SETC  '0'                TURN OFF ALCOPY BIT IF ALCOPY=NO @L1A 08175000
.NUMB3X2 ANOP                     BYTE IS COMPLETE                 @L1A 08180000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          08200000
&IHBSWA  SETB  ('&VL' EQ '1')                                           08250000
&IHBSWB  SETB  ('&SF' EQ '(E,(15))')                                    08300000
         AIF   ('&NAME' EQ '' OR '&SF' EQ 'L').CONTAA                   08350000
&NAME    DS    0H                                                       08400000
.CONTAA  AIF   ('&PARAM' EQ '' AND '&MF(1)' NE 'E').CONTA               08450000
         IHBOPLTX ,&PARAM,MF=&MF                                   @L1C 08500000
.CONTA   AIF   ('&SF' EQ 'I').IROUT                                     08550000
         AIF   ('&SF' EQ 'L').LROUT                                     08600000
         AIF   (N'&SF NE 2).ERROR3                                      08650000
         AIF   ('&SF(1)' NE 'E').ERROR3                                 08700000
         AIF   ('&SF'(4,1) EQ '(').ISAREG                               08750000
         LA    15,&SF(2)          LOAD LIST ADDRESS            @G860PXB 08800000
         AGO   .CONTB                                                   08850000
.E1      IHBERMAC 35,&IHBNO,&MF,,,0                              Y02752 08900000
         MEXIT                                                          08950000
.ERROR2  IHBERMAC 71,&IHBNO,&PARAM                                      09000000
         MEXIT                                                          09050000
.ERROR3  IHBERMAC 41,&IHBNO,&SF,,,0                              Y02752 09100000
         MEXIT                                                          09150000
.ERROR4  IHBERMAC 88,&IHBNO                                             09200000
         MEXIT                                                          09250000
.ERROR5  IHBERMAC 72,&IHBNO                                             09300000
         MEXIT                                                          09350000
.ERROR6  IHBERMAC 31,&IHBNO                                             09400000
         MEXIT                                                          09450000
.ERROR7  IHBERMAC 240,,LPMOD                                            09500000
         MEXIT                                                          09550000
.ERRHID IHBERMAC 195                                                    09600000
         MEXIT                                                          09650000
.ISAREG  AIF   ('&SF(2)' EQ '(15)').CONTB                               09700000
&A       SETA  K'&SF-6                                                  09750000
&H       SETC  '&SF'(5,&A)                                              09800000
         LR    15,&H              LOAD LIST ADDRESS            @G860PXB 09850000
.CONTB   ANOP                                                           09900000
.* E FORM MUST ALLOW SETTING OF ALL FIELDS, SO THAT A LIST FORM  Y02752 09950000
.* OF ALL ZEROS IS ACCEPTABLE. EXTENDED PARM LIST BITS AND       Y02752 10000000
.* LENGTH FIELD MUST BE SET.                                     Y02752 10050000
         AIF   ('&EP' EQ '').CONTC                                      10100000
&F60(1)  SETB  0                  RESET DE INDICATION          @ZA72420 10150000
         LA    14,28(,15)         PICK UP EP ADDRESS           @G860PXB 10200000
         ST    14,0(,15)          INSERT EP ADDRESS INTO LIST  @G860PXB 10250000
         MVC   28(8,15),*+10      MOVE EP SYMB INTO LIST       @G860PXB 10300000
         B     *+12               BRANCH AROUND EP SYMBOL      @G860PXB 10350000
         DC    CL8'&EP'           EP SYMBOL                    @G860PXB 10400000
         AGO   .CONTE                                                   10450000
.CONTC   AIF   ('&EPLOC' EQ '').CONTD                                   10500000
&F60(1)  SETB  0                  RESET DE INDICATION          @ZA72420 10550000
         AIF   ('&EPLOC'(1,1) EQ '(').ISAREGA                           10600000
         LA    14,&EPLOC          PICK UP EPLOC ADDRESS        @G860PXB 10650000
         ST    14,0(,15)          INSERT EPLOC INTO LIST       @G860PXB 10700000
         AGO   .CONTE                                                   10750000
.ISAREGA ST    &EPLOC(1),0(,15)   INSERT EPLOC INTO LIST       @G860PXB 10800000
         AGO   .CONTE                                                   10850000
.CONTD   AIF   ('&DE' EQ '').CONTE                                      10900000
&NUMB1   SETA  &NUMB1+128         DE BIT                       @G860PXB 10950000
         AIF   ('&DE'(1,1) EQ '(').ISAREGB                              11000000
         LA    14,&DE             PICK UP DE ADDRESS           @G860PXB 11050000
         ST    14,0(,15)          INSERT DE INTO LIST          @G860PXB 11100000
         AGO   .CONTE                                                   11150000
.ISAREGB ST    &DE(1),0(,15)      INSERT DE INTO LIST          @G860PXB 11200000
.CONTE   AIF   ('&DCB' EQ '').CONHID                                    11250000
         AIF   ('&DCB'(1,1) EQ '(').ISAREGC                             11300000
         LA    14,&DCB            PICK UP DCB ADDRESS          @G860PXB 11350000
         ST    14,4(,15)          STORE DCB INTO LIST          @G860PXB 11400000
         AGO   .CONHID                                                  11450000
.ISAREGC ST    &DCB(1),4(,15)     STORE INTO LIST              @G860PXB 11500000
.CONHID  ANOP                                                    Y02752 11550000
.CONTF   AIF   ('&ECB' EQ '').CONTG                                     11600000
         AIF   ('&ECB'(1,1) EQ '(').ISAREGD                             11650000
         LA    14,&ECB            PICK UP ECB ADDRESS          @G860PXB 11700000
         ST    14,8(,15)          ECB INTO LIST                @G860PXB 11750000
         AGO   .CONTG                                                   11800000
.ISAREGD ST    &ECB(1),8(,15)     ECB INTO LIST                @G860PXB 11850000
.CONTG   ANOP                                                    Y02752 11900000
         AIF   ('&GSPV' EQ '').CONTH                                    11950000
&F60(2)  SETB  0                  RESET GSPL INDICATION        @ZA72420 12000000
         AIF   ('&GSPV'(1,1) EQ '(').ISAREGE                            12050000
         LA    14,&GSPV.(0,0)     PICK UP GSPV VALUE           @G860PXB 12100000
         ST    14,12(,15)         GSPV INTO LIST               @G860PXB 12150000
         AGO   .CONTI                                                   12200000
.ISAREGE ST    &GSPV(1),12(,15)   GSPV INTO LIST               @G860PXB 12250000
         AGO   .CONTI                                                   12300000
.CONTH   AIF   ('&GSPL' EQ '').CONTI                                    12350000
&NUMB1   SETA  &NUMB1+64          INDICATE GSPL                @G860PXB 12400000
         AIF   ('&GSPL'(1,1) EQ '(').ISAREGF                            12450000
         LA    14,&GSPL           PICK UP GSPL ADDRESS         @G860PXB 12500000
         ST    14,12(,15)         GSPL INTO LIST               @G860PXB 12550000
         AGO   .CONTI                                                   12600000
.ISAREGF ST    &GSPL(1),12(,15)   GSPL INTO LIST               @G860PXB 12650000
.CONTI   AIF   ('&SHSPV' EQ '').CONTK                                   12700000
&F60(3)  SETB  0                  RESET SHSPL INDICATION       @ZA72420 12750000
         AIF   ('&SHSPV'(1,1) EQ '(').ISAREGG                           12800000
         LA    14,&SHSPV.(0,0)    PICK UP SHSPV VALUE          @G860PXB 12850000
         ST    14,16(,15)         SHSPV INTO LIST              @G860PXB 12900000
         AGO   .CONTL                                                   12950000
.ISAREGG ST    &SHSPV(1),16(,15)  SHSPV INTO LIST              @G860PXB 13000000
         AGO   .CONTL                                                   13050000
.CONTK   AIF   ('&SHSPL' EQ '').CONTL                                   13100000
&NUMB1   SETA  &NUMB1+32          SHSPL PRESENT                @G860PXB 13150000
         AIF   ('&SHSPL'(1,1) EQ '(').ISAREGH                           13200000
         LA    14,&SHSPL          PICK UP SHSPL ADDRESS        @G860PXB 13250000
         ST    14,16(,15)         SHSPL INTO LIST              @G860PXB 13300000
         AGO   .CONTL                                                   13350000
.ISAREGH ST    &SHSPL(1),16(,15)  SHSPL INTO LIST              @G860PXB 13400000
.CONTL   AIF   ('&ETXR' EQ '').CONTN                                    13450000
         AIF   ('&ETXR'(1,1) EQ '(').ISAREGI                            13500000
         LA    14,&ETXR           PICK UP ETXR ADDRESS         @G860PXB 13550000
         ST    14,20(,15)         INSERT ETXR INTO LIST        @G860PXB 13600000
         AGO   .CONTN                                                   13650000
.ISAREGI ST    &ETXR(1),20(,15)   INSERT ETXR INTO LIST        @G860PXB 13700000
.CONTN   ANOP                                                           13750000
.CONTN0  AIF   ('&DPMOD' EQ '').CONTO                                   13800000
         AIF   ('&DPMOD'(1,1) EQ '(').ISAREGJ                           13850000
         B     *+6                BRANCH AROUND DPMOD          @G860PXB 13900000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNA     13950000
         DC    AL2(&DPMOD)        DPMOD VALUE                  @G860PXB 14000000
         MVC   24(2,15),*-2       INSERT DPMOD IN LIST         @G860PXB 14050000
         AGO   .CONTO                                                   14100000
.SIGNA   DC    AL2(0&DPMOD)       DPMOD VALUE                  @G860PXB 14150000
         MVC   24(2,15),*-2       INSERT DPMOD IN LIST         @G860PXB 14200000
         AGO   .CONTO                                                   14250000
.ISAREGJ STH   &DPMOD(1),24(,15)  DPMOD IN LIST                @G860PXB 14300000
.CONTO   AIF   ('&LPMOD' EQ '').CONTP                                   14350000
         AIF   ('&LPMOD'(1,1) EQ '(').ISAREGK                           14400000
         MVI   26(15),&LPMOD      INSERT LPMOD IN LIST                  14450000
         AGO   .CONTP                                                   14500000
.ISAREGK STC   &LPMOD(1),26(,15)  LPMOD IN LIST                @G860PXB 14550000
.CONTP   ANOP                                                      I270 14600000
         AIF   (&NUMB EQ 0).JSCB1                              @G860PXB 14650000
         OI    27(15),&NUMB       SET STATUS BYTE              @G860PXB 14700000
.JSCB1   AIF   ('&JSCB' EQ '').CONTQ5                                   14750000
         AIF   ('&JSCB'(1,1) EQ '(').ISAREG1                            14800000
         LA    14,&JSCB           PICK UP JSCB ADDRESS                  14850000
         ST    14,36(,15)         INSERT JSCB INTO LIST        @G860PXB 14900000
         AGO   .CONTQ5                                            20028 14950000
.ISAREG1 ST    &JSCB(1),36(,15)   INSERT JSCB INTO LIST        @G860PXB 15000000
.CONTQ5  ANOP                                                     20028 15050000
         AIF   ( NOT (&SWSTAI OR &SWESTAI) ).TTID  NEITHER GIVEN Y02752 15100000
.* IF EITHER STAI OR ESTAI GIVEN, OVERRIDE BYTES DEC 41 - 47     Y02752 15150000
.STAIRB  AIF   ('&STXADDR'(1,1) EQ '(' ).REG1                    Y02752 15200000
         LA    14,&STXADDR        GET (E)STAI EXIT ADDRESS     @G860PXB 15250000
         ST    14,44(,15)         (E)STAI EXIT ADDR INTO LIST  @G860PXB 15300000
         AGO   .STAI2                                             20028 15350000
.REG1    ST    &STXADDR,44(,15)   (E)STAI EXIT ADDR INTO LIST  @G860PXB 15400000
.STAI2   ANOP                                                    Y02752 15450000
         AIF   ('&STPADDR' NE '').STY                            Y02752 15500000
         SR    14,14                                             Y02752 15550000
         ST    14,40(,15)         NO STAI/ESTAI PARM LIST ADDR @G860PXB 15600000
         AGO   .TTID                                             Y02752 15650000
.STY     ANOP                                                    Y02752 15700000
         AIF   ('&STPADDR'(1,1) EQ '(').REG2                     Y02752 15750000
         LA    14,&STPADDR        GET STAI/ESTAI PARM LIST ADDR  Y02752 15800000
         ST    14,40(,15)         STAI/ESTAI PARM LIST ADDR    @G860PXB 15850000
         AGO   .TTID                                                    15900000
.REG2    ST    &STPADDR,40(,15)   STAI/ESTAI PARM LIST ADDR    @G860PXB 15950000
.TTID    AIF   ('&TID' EQ '0').TLIBE                                    16000000
         AIF   ('&TID'(1,1) EQ '(').REGTID                              16050000
         MVI   53(15),&TID        INSERT TID INTO LIST         @G860PXB 16100000
         AGO   .TLIBE                                                   16150000
.REGTID  STC   &TID(1),53(,15)    INSERT TID INTO LIST         @G860PXB 16200000
.TLIBE   AIF   ('&TASKLIB' EQ '').NSHSP1                         Y02752 16250000
.TLIBEA  AIF   ('&TASKLIB'(1,1) EQ '(').TREGE                     20021 16300000
         LA    14,&TASKLIB(1)     GET TASKLIB DCB ADDRESS      @G860PXB 16350000
         ST    14,48(,15)         TASKLIB DCB ADDRESS IN LIST  @G860PXB 16400000
         AGO   .NSHSP1                                           Y02752 16450000
.TREGE   ST    &TASKLIB(1),48(,15) TASKLIB DCB ADDR. IN LIST.     20021 16500000
.NSHSP1  ANOP                                                    Y02752 16550000
         MVI   55(15),72          SET LENGTH OF THIS PARM LIST @G860PXB 16600000
&NUMB3B  SETB  (&NUMB3 NE 0)      STAI BITS PRESENT?           @G860PXB 16650000
         AIF   ('&NSHSPL' EQ '').NSHSP2                          Y02752 16700000
         AIF   ('&RSAPF' EQ 'YES').NSHSP6   RSAPF ALSO ON      @Z40RP9B 16750000
&NUMB3   SETA  &NUMB3+X'80'       INDICATE SP LIST             @G860PXB 16800000
.NSHSP7  ANOP                                                  @Z40RP9B 16850000
         AIF   ('&NSHSPL'(1,1) EQ '(' ).NSHSP3                   Y02752 16900000
         LA    14,&NSHSPL         GET SP LIST ADDR               Y02752 16950000
         ST    14,56(,15)         NSHSPL ADDR INTO PARM LIST     Y02752 17000000
         AGO   .PRESVC                                         @G860PXB 17050000
.NSHSP3  ANOP                                                    Y02752 17100000
         ST    &NSHSPL(1),56(,15) NSHSPL ADDR INTO PARM LIST     Y02752 17150000
         AGO   .PRESVC                                         @G860PXB 17200000
.NSHSP2  ANOP                                                    Y02752 17250000
         AIF   ('&NSHSPV' EQ '').NSHSP8                        @Z40RP9B 17300000
&F52(1)  SETB  0                  RESET NSHSPL INDICATION      @ZA72420 17350000
         AIF   ('&RSAPF' NE 'YES').NSHSP5                      @Z40RP9B 17400000
&NUMB3   SETA  &NUMB3+X'40'       SET APF FLAG ON              @G860PXB 17450000
.NSHSP5  ANOP                                                  @Z40RP9B 17500000
         AIF   ('&NSHSPV'(1,1) EQ '(' ).NSHSP4                   Y02752 17550000
         LA    14,&NSHSPV.(0,0)   SP VALUE FOR NSHSPV            YM1995 17600000
         ST    14,56(,15)         PARM INTO LIST               @G860PXB 17650000
         AGO   .PRESVC                                         @G860PXB 17700000
.NSHSP4  ANOP                                                    Y02752 17750000
         ST    &NSHSPV(1),56(,15) SET SP VALUE FOR NSHSPV        Y02752 17800000
         AGO   .PRESVC                                         @G860PXB 17850000
.NSHSP6  ANOP                                                  @G860PXB 17900000
&NUMB3   SETA  &NUMB3+X'C0'       SET NSHSPL,RSAPF             @G860PXB 17950000
         AGO   .NSHSP7                                         @Z40RP9B 18000000
.NSHSP8  ANOP                                                  @Z40RP9B 18050000
         AIF   ('&RSAPF' NE 'YES').PRESVC NO FLAGS ON          @G860PXB 18100000
&NUMB3   SETA  &NUMB3+X'40'       SET APF FLAG ON              @G860PXB 18150000
.PRESVC  ANOP                                                  @G860PXB 18200000
.* SET MASKS USED FOR CLEARING UNWANTED BITS IN FLAG BYTES     @ZA72420 18250000
&NI52    SETA  128*&F52(1)+64+32*&NICOPY+16+8+7                    @L1C 18300000
&NI60    SETA  128*&F60(1)+64*&F60(2)+32*&F60(3)+16+8+7            @P2C 18350000
         OI    8(15),X'80'        SET NEW FORMAT BIT           @G860PXB 18400000
         NI    60(15),&NI60       CLEAR UNWANTED BITS          @ZA72420 18500000
.NONI60  AIF   (&NUMB1 EQ 0).NO60 SKIP IF 0                    @G860PXB 18550000
         OI    60(15),&NUMB1      SET FLAG BYTE                @G860PXB 18600000
.NO60    AIF   (&NI52 EQ 255).NONI52  ANY BITS TO BE RESET?    @ZA72420 18650000
         NI    52(15),&NI52       CLEAR UNWANTED BITS          @ZA72420 18700000
.NONI52  AIF   (NOT &NUMB3B).NO60B CHECK FOR STAI BITS         @G860PXB 18750000
         OI    52(15),&NUMB3      TURN ON SPECIFIED BITS       @ZA72420 18800000
         AGO   .NO52                                           @G860PXB 18850000
.NO60B   AIF   (&NUMB3 EQ 0).NO52 SKIP IF 0                    @ZA72420 18900000
         OI    52(15),&NUMB3      TURN ON SPECIFIED BITS       @G860PXB 18950000
.NO52    MVI   61(15),&FORM#      SET FORMAT NUMBER            @G860PXB 19000000
         AGO   .SVC                                            @Z40RP9B 19050000
.LROUT   ANOP                                                           19100000
.* L FORM MUST ACCEPT ALL PARAMETERS POSSIBLE. A LIST OF ALL     Y02752 19150000
.* ZEROS MUST BE ACCEPTABLE AS AN L FORM.                               19200000
&NAME    DS    0F                                                       19250000
         AIF   ('&EP' EQ '').CONTLA                                     19300000
         AIF   ('&EP'(1,1) EQ '(').ERROR5                               19350000
         DC    A(*+28)            POINTER TO SYMBOL NAME       @G860PXB 19400000
         AGO   .COHID                                              LCS1 19450000
.CONTLA  AIF   ('&EPLOC' EQ '').CONTLB                                  19500000
         AIF   ('&EPLOC'(1,1) EQ '(').ERROR5                            19550000
         DC    A(&EPLOC)          POINTER TO SYMBOL NAME       @G860PXB 19600000
         AGO   .COHID                                              LCS1 19650000
.CONTLB  AIF   ('&DE' EQ '').CONTLLA                                    19700000
         AIF   ('&DE'(1,1) EQ '(').ERROR5                               19750000
         DC    A(&DE)             SET DE POINTER               @G860PXB 19800000
&NUMB1   SETA  &NUMB1+X'80'                                    @G860PXB 19850000
         AGO   .COHID                                              LCS1 19900000
.CONTLLA DC    A(0)               DE OR EPLOC ADDRESS          @G860PXB 19950000
.COHID   ANOP                                                    Y02752 20000000
.CHID    ANOP                                                  @G860PXB 20050000
.CONTLC  AIF   ('&DCB' EQ '').CONTLD                                    20100000
         AIF   ('&DCB'(1,1) EQ '(').ERROR5                              20150000
         DC    A(&DCB)            DCB ADDRESS                  @G860PXB 20200000
         AGO   .CONTLSE                                           20028 20250000
.CONTLD  DC    A(0)               DCB ADDRESS                  @G860PXB 20300000
.CONTLSE ANOP                                                    Y02572 20350000
.CONTLE  AIF   ('&ECB' EQ '').CONTLF                                    20400000
         AIF   ('&ECB'(1,1) EQ '(').ERROR5                              20450000
         DC    A(X'80000000'+&ECB) NEW FORMAT + ECB ADDR       @G860PXB 20500000
         AGO   .CONTLG                                                  20550000
.CONTLF  DC    A(X'80000000')     NEW FORMAT + ECB ADDR        @G860PXB 20600000
.CONTLG  AIF   ('&GSPV' EQ '').CONTLH                                   20650000
         AIF   ('&GSPV'(1,1) EQ '(').ERROR5                             20700000
         DC    A(&GSPV)           GSPV VALUE                   @G860PXB 20750000
         AGO   .CONTLI                                                  20800000
.CONTLH  AIF   ('&GSPL' EQ '').CONTLJ                                   20850000
         AIF   ('&GSPL'(1,1) EQ '(').ERROR5                             20900000
&NUMB1   SETA  &NUMB1+X'40'       INDICATE GSPL                @G860PXB 20950000
         DC    A(&GSPL)           SET GSPL ADDRESS             @G860PXB 21000000
         AGO   .CONTLI                                                  21050000
.CONTLJ  DC    A(0)               GSPL OR GSPV                 @G860PXB 21100000
.CONTLI  AIF   ('&SHSPV' EQ '').CONTLK                                  21150000
         AIF   ('&SHSPV'(1,1) EQ '(').ERROR5                            21200000
         DC    A(&SHSPV)          SHSPV VALUE                  @G860PXB 21250000
         AGO   .CONTLL                                                  21300000
.CONTLK  AIF   ('&SHSPL' EQ '').CONTLM                                  21350000
         AIF   ('&SHSPL'(1,1) EQ '(').ERROR5                            21400000
         DC    A(&SHSPL)          SET SHSPL ADDRESS            @G860PXB 21450000
&NUMB1   SETA  &NUMB1+X'20'       SHSPL PRESENT                @G860PXB 21500000
         AGO   .CONTLL                                                  21550000
.CONTLM  DC    A(0)               SHSPV OR SHSPL               @G860PXB 21600000
.CONTLL  ANOP                                                           21650000
         AIF   ('&ETXR' EQ '').CONTLN                                   21700000
         AIF   ('&ETXR'(1,1) EQ '(').ERROR5                             21750000
         DC    A(&ETXR)           EXIT ROUTINE ADDRESS         @G860PXB 21800000
         AGO   .CONTLO                                                  21850000
.CONTLN  DC    A(0)               EXIT ROUTINE ADDRESS         @G860PXB 21900000
.CONTLO  AIF   ('&DPMOD' EQ '').CONTLP                                  21950000
         AIF   ('&DPMOD'(1,1) EQ '(').ERROR5                            22000000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNB     22050000
         DC    AL2(&DPMOD)        DPMOD VALUE                  @G860PXB 22100000
         AGO   .CONTLQ                                                  22150000
.SIGNB   DC    AL2(0&DPMOD)       DPMOD VALUE                  @G860PXB 22200000
         AGO   .CONTLQ                                                  22250000
.CONTLP  DC    AL2(0)             DPMOD VALUE                  @G860PXB 22300000
.CONTLQ  AIF   ('&LPMOD' EQ '').CONTLR                                  22350000
         AIF   ('&LPMOD'(1,1) EQ '(').ERROR5                            22400000
         DC    AL1(&LPMOD)        LPMOD VALUE                  @G860PXB 22450000
         AGO   .CONTLS6                                                 22500000
.CONTLR  DC    AL1(0)             LPMOD VALUE                  @G860PXB 22550000
.CONTLS6 ANOP                                                    Y02752 22600000
.CONTLU  DC    AL1(&NUMB)         STATUS BYTE                  @G860PXB 22650000
         AIF   ('&EP' EQ '').CONTLV                                     22700000
         DC    CL8'&EP'           EP SYMBOL                    @G860PXB 22750000
         AGO   .CONTLV1                                            1270 22800000
.* SET EP NAME SPACE TO ZEROS TO ALLOW ALL ZERO LIST FORM        Y02752 22850000
.CONTLV  DC    2A(0)              EP NAME SPACE                @G860PXB 22900000
.CONTLV1 ANOP                                                  @G860PXB 22950000
         AIF   ('&JSCB' EQ '').NOJSCB                          @G860PXB 23000000
         AIF   ('&JSCB'(1,1) EQ '(').ERROR5                        I270 23050000
         DC    A(&JSCB)           ADDRESS OF JSCB              @G860PXB 23100000
         AGO   .LTID                                                    23150000
.NOJSCB  ANOP                                                     20028 23200000
         DC    A(0)               ADDRESS OF JSCB              @G860PXB 23250000
.LTID    ANOP                                                  @G860PXB 23300000
.CONTLW  AIF   (&SWSTAI OR &SWESTAI).CONTLX                      Y02752 23350000
         DC    A(0)               (E)STAI PARM LIST            @G860PXB 23400000
         DC    A(0)               EXIT ADDRESS                 @G860PXB 23450000
         AGO   .TLCONT                                            20021 23500000
.CONTLX  ANOP                                                    Y02752 23550000
         AIF   ('&STXADDR'(1,1) EQ '(' ).ERROR5                  Y02752 23600000
         AIF   ('&STPADDR' EQ '').CONTLY                          20028 23650000
         AIF   ('&STPADDR'(1,1) EQ '(' ).ERROR5                  Y02752 23700000
         DC    A(&STPADDR)        STAI/ESTAI PARM LIST ADDR    @G860PXB 23750000
         AGO   .TLCX                                              20021 23800000
.CONTLY  DC    A(0)               STAI/ESTAI PARAMETER LIST    @G860PXB 23850000
.TLCX    ANOP                                                    Y02752 23900000
.TLCZ    DC    A(&STXADDR)        STAI/ESTAI EXIT ROUTINE ADDR @G860PXB 23950000
.TLCONT  AIF   ('&TASKLIB' NE '').TLCONTA                         20021 24000000
         DC    A(0)               TASKLIB                      @G860PXB 24050000
         AGO   .LNSHSP1                                          Y02752 24100000
.TLCONTA ANOP                                                     20021 24150000
         AIF   ('&TASKLIB'(1,1) EQ '(' ).ERROR5                  Y02752 24200000
         DC    A(&TASKLIB)        TASKLIB DCB ADDRESS          @G860PXB 24250000
.* ATTACH PARM LIST LENGTH MUST BE SET IN EXECUTE FORM.        @G860PXB 24300000
.LNSHSP1 ANOP                                                    Y02752 24350000
&NSHSP   SETC  '0'                ASSUME NO NSHSPL,NSHSPV      @G860PXB 24400000
         AIF   ('&NSHSPL' EQ '').LNSHSP4   NSHSPL SPECIFIED:   @G860PXB 24450000
&NUMB3   SETA  &NUMB3+128         SET BIT TO INDICATE LIST     @G860PXB 24500000
&NSHSP   SETC  '&NSHSPL'          INDICATE NSHSPL              @G860PXB 24550000
         AGO   .LNSHSP2                                        @G860PXB 24600000
.LNSHSP4 AIF   ('&NSHSPV' EQ '').LNSHSP2    NSHSPV SPECIFIED:  @G860PXB 24650000
&NSHSP   SETC  '&NSHSPV'          INDICATE NSHSPV              @G860PXB 24700000
.LNSHSP2 AIF   ('&RSAPF' NE 'YES').LNSHSP3 RSAPF SPECIFIED:    @G860PXB 24750000
&NUMB3   SETA  &NUMB3+64          SET BIT TO INDICATE IT       @G860PXB 24800000
.LNSHSP3 DC    AL1(&NUMB3)        FLAG BYTE                    @G860PXB 24850000
         AIF   ('&TID'(1,1) EQ '(').ERROR5                     @G860PXB 24900000
         AIF   ('&NSHSP'(1,1) EQ '(').ERROR5                   @G860PXB 24950000
         DC    AL1(&TID)          TASK ID                      @G860PXB 25000000
         DC    AL2(72)            PARM LIST LENGTH             @G860PXB 25050000
         DC    A(&NSHSP)          SUBPOOL LIST ADDRESS/VALUE   @G860PXB 25100000
.LBYTE60 DC    AL1(&NUMB1)        SET FLAGS                    @G860PXB 25150000
         DC    AL1(&FORM#)        SET UP FORMAT NUMBER         @G860PXB 25200000
         DC    XL10'00'           RESERVED BYTES FOR FUTURE    @G860PXB 25250000
         AGO   .END                                            @G860PXB 25300000
.IROUT   ANOP                                                           25350000
.* NORMAL FORM. IN-LINE LIST.                                    Y02752 25400000
         LA    15,&GNAME          SET UP LIST ADDRESS          @G860PXB 25450000
         AIF   ('&EPLOC' EQ '').ICONTA                                  25500000
         AIF   ('&EPLOC'(1,1) NE '(').ICONTB                            25550000
         ST    &EPLOC(1),0(,15)   PUT EPLOC INTO LIST          @G860PXB 25600000
         AGO   .ICONTB                                                  25650000
.ICONTA  AIF   ('&DE' EQ '').ICONTB                                     25700000
&NUMB1   SETA  &NUMB1+X'80'       INDICATE DE PRESENT          @G860PXB 25750000
         AIF   ('&DE'(1,1) NE '(').ICONTB                               25800000
         ST    &DE(1),0(,15)      PUT DE INTO LIST             @G860PXB 25850000
.ICONTB  AIF   ('&DCB' EQ '').ICOHID                               LCS1 25900000
         AIF   ('&DCB'(1,1) NE '(').ICOHID                         LCS1 25950000
         ST    &DCB(1),4(,15)     STORE DCB INTO LIST          @G860PXB 26000000
.* BITS 6 AND 7 OF BYTE 4 PREVIOUSLY DEFINED FOR HIARCHY         Y02752 26050000
.ICOHID  ANOP                                                      LCS1 26100000
.ICONTC  AIF   ('&ECB' EQ '').ICONTD                                    26150000
         AIF   ('&ECB'(1,1) NE '(').ICONTD                              26200000
         ST    &ECB(1),8(,15)     STORE ECB INTO LIST          @G860PXB 26250000
         OI    8(15),X'80'        INDICATE NEW FORMAT          @G860PXB 26300000
.ICONTD  AIF   ('&GSPV' EQ '').ICONTE                                   26350000
         AIF   ('&GSPV'(1,1) NE '(').ICONTF                             26400000
         ST    &GSPV(1),12(,15)   STORE GSPV INTO LIST         @G860PXB 26450000
         AGO   .ICONTF                                                  26500000
.ICONTE  AIF   ('&GSPL' EQ '').ICONTF                                   26550000
&NUMB1   SETA  &NUMB1+X'40'       INDICATE GSPL                @G860PXB 26600000
         AIF   ('&GSPL'(1,1) NE '(').ICONTF                             26650000
         ST    &GSPL(1),12(,15)   STORE GSPL INTO LIST         @G860PXB 26700000
.ICONTF  AIF   ('&SHSPV' EQ '').ICONTG                                  26750000
         AIF   ('&SHSPV'(1,1) NE '(').ICONTH                            26800000
         ST    &SHSPV(1),16(,15)  STORE SHSPV INTO LIST        @G860PXB 26850000
         AGO   .ICONTH                                                  26900000
.ICONTG  AIF   ('&SHSPL' EQ '').ICONTH                                  26950000
&NUMB1   SETA  &NUMB1+X'20'       INDICATE SHSPL PRESENT       @G860PXB 27000000
         AIF   ('&SHSPL'(1,1) NE '(').ICONTH                            27050000
         ST    &SHSPL(1),16(,15)  STORE SHSPL INTO LIST        @G860PXB 27100000
.ICONTH  AIF   ('&ETXR' EQ '').ICONTI                                   27150000
         AIF   ('&ETXR'(1,1) NE '(').ICONTI                             27200000
         ST    &ETXR(1),20(,15)   STORE ETXR INTO LIST         @G860PXB 27250000
.ICONTI  AIF   ('&DPMOD' EQ '').ICONTJ                                  27300000
         AIF   ('&DPMOD'(1,1) NE '(').ICONTJ                            27350000
         STH   &DPMOD(1),24(,15)  STORE DPMOD INTO LIST        @G860PXB 27400000
.ICONTJ  AIF   ('&LPMOD' EQ '').ICONTJ0                                 27450000
         AIF   ('&LPMOD'(1,1) NE '(').ICONTJ0                           27500000
         STC   &LPMOD(1),26(,15)  STORE LPMOD INTO LIST        @G860PXB 27550000
.ICONTJ0 ANOP                                                  @G860PXB 27600000
.ICONTK  AIF   ('&JSCB' EQ '').ICONTL0                         @G860PXB 27650000
         AIF   ('&JSCB'(1,1) NE '(').ICONTL0                      20028 27700000
         ST    &JSCB(1),36(,15)   INSERT JSCB INTO LIST        @G860PXB 27750000
.ICONTL0 ANOP                                                           27800000
         AIF   ('&TID' EQ '0').ICONTL1                                  27850000
         AIF   ('&TID'(1,1) NE '(').ICONTL1                             27900000
         STC   &TID(1),53(,15)    INSERT TID INTO LIST         @G860PXB 27950000
.ICONTL1 ANOP                                                           28000000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).ICONTO               Y02572 28050000
         AIF   ('&STXADDR'(1,1) NE '(' ).ICZ                     Y02572 28100000
         ST    &STXADDR,44(,15)   SET STAI/ESTAI EXIT ADDR     @G860PXB 28150000
.ICZ     AIF   ('&STPADDR' EQ '').ICONTO                         Y02752 28200000
         AIF   ('&STPADDR'(1,1) NE '(' ).ICONTO                  Y02752 28250000
         ST    &STPADDR,40(,15)   STAI/ESTAI PARM LIST ADDR    @G860PXB 28300000
.ICONTO  AIF   ('&TASKLIB' EQ '').ICONTP                          20021 28350000
.ICONTQ  AIF   ('&TASKLIB'(1,1) NE '(').ICONTP                    20021 28400000
         ST    &TASKLIB(1),48(,15) TASKLIB DCB ADDRESS         @G860PXB 28450000
.ICONTP  ANOP                                                    Y02752 28500000
         AIF   ('&NSHSPL' EQ '').ICONTP0                         Y02752 28550000
         AIF   ('&NSHSPL'(1,1) NE '(' ).ICONTP1                  Y02752 28600000
         ST    &NSHSPL(1),56(,15) NSHSPL ADDR INTO LIST        @G860PXB 28650000
         AGO   .ICONTP1                                          Y02752 28700000
.ICONTP0 ANOP                                                    Y02752 28750000
         AIF   ('&NSHSPV' EQ '').ICONTP1                         Y02752 28800000
         AIF   ('&NSHSPV'(1,1) NE '(' ).ICONTP1                  Y02752 28850000
         STC   &NSHSPV(1),59(,15) NSHSPV VALUE INTO LIST         Y02752 28900000
.ICONTP1 ANOP                                                    Y02752 28950000
         B     72(,15)            BRANCH AROUND LIST           @G860PXB 29000000
&GNAME   DS    0F                 SUP. PARAM. LIST             @G860PXB 29050000
         AIF   ('&EP' EQ '').CNTA                                       29100000
         DC    A(*+28)            ADDRESS OF SYMB NAME         @G860PXB 29150000
         AGO   .CCHID                                              LCS1 29200000
.CNTA    AIF   ('&EPLOC' EQ '').CNTC                                    29250000
         AIF   ('&EPLOC'(1,1) EQ '(').CNTD                              29300000
         DC    A(&EPLOC)          ADDRESS OF SYMB NAME         @G860PXB 29350000
         AGO   .CCHID                                              LCS1 29400000
.CNTC    AIF   ('&DE' EQ '').ERROR6                                     29450000
         AIF   ('&DE'(1,1) EQ '(').CNTD                                 29500000
         DC    A(&DE)             SET DE ADDR                  @G860PXB 29550000
         AGO   .CCHID                                              LCS1 29600000
.CNTD    DC    A(0)               DE OR EPLOC ADDRESS          @G860PXB 29650000
.CCHID   ANOP                                                    Y02752 29700000
.CCCHID  ANOP                                                  @G860PXB 29750000
.CNTB    AIF   ('&DCB' EQ '').CNTE                                      29800000
         AIF   ('&DCB'(1,1) EQ '(').CNTE                                29850000
         DC    A(&DCB)            DCB ADDRESS                  @G860PXB 29900000
         AGO   .CNTF                                                    29950000
.CNTE    DC    A(0)               DCB ADDRESS                  @G860PXB 30000000
.CNTF    ANOP                                                           30050000
         AIF   ('&ECB' EQ '').CNTG                               Y02752 30100000
         AIF   ('&ECB'(1,1) EQ '(').CNTG                                30150000
         DC    A(X'80000000'+&ECB)  ECB ADDRESS, NEW FORMAT    @G860PXB 30200000
         AGO   .CNTH                                                    30250000
.CNTG    DC    A(X'80000000')     ECB ADDRESS, NEW FORMAT      @G860PXB 30300000
.CNTH    AIF   ('&GSPV' EQ '').CNTI                                     30350000
         AIF   ('&GSPV'(1,1) EQ '(').CNTJ                               30400000
         DC    A(&GSPV)           GSPV VALUE                   @G860PXB 30450000
         AGO   .CNTK                                                    30500000
.CNTI    AIF   ('&GSPL' EQ '').CNTJ                                     30550000
         AIF   ('&GSPL'(1,1) EQ '(').CNTJ                               30600000
         DC    A(&GSPL)           SET GSPL ADDR                @G860PXB 30650000
         AGO   .CNTK                                                    30700000
.CNTJ    DC    A(0)               GSPV VALUE OR GSPL ADDRESS   @G860PXB 30750000
.CNTK    AIF   ('&SHSPV' EQ '').CNTL                                    30800000
         AIF   ('&SHSPV'(1,1) EQ '(').CNTM                              30850000
         DC    A(&SHSPV)          SHSPV VALUE                  @G860PXB 30900000
         AGO   .CNTN                                                    30950000
.CNTL   AIF   ('&SHSPL' EQ '').CNTM                                     31000000
         AIF   ('&SHSPL'(1,1) EQ '(').CNTM                              31050000
         DC    A(&SHSPL)          SET SHSPL ADDRESS            @G860PXB 31100000
         AGO   .CNTN                                                    31150000
.CNTM    DC    A(0)               SHSPL OR SHSPV               @G860PXB 31200000
.CNTN    ANOP                                                           31250000
         AIF   ('&ETXR' EQ '').CNTO                                     31300000
         AIF   ('&ETXR'(1,1) EQ '(').CNTO                               31350000
         DC    A(&ETXR)           EXIT ROUTINE ADDRESS         @G860PXB 31400000
         AGO   .CNTP                                                    31450000
.CNTO    DC    A(0)               EXIT ROUTINE ADDRESS         @G860PXB 31500000
.CNTP    AIF   ('&DPMOD' EQ '').CNTQ                                    31550000
         AIF   ('&DPMOD'(1,1) EQ '(').CNTQ                              31600000
         AIF   ('&DPMOD'(1,1) EQ '+' OR '&DPMOD'(1,1) EQ '-').SIGNC     31650000
         DC    AL2(&DPMOD)        DPMOD VALUE                  @G860PXB 31700000
         AGO   .CNTR                                                    31750000
.SIGNC   DC    AL2(0&DPMOD)       DPMOD VALUE                  @G860PXB 31800000
         AGO   .CNTR                                                    31850000
.CNTQ    DC    AL2(0)             DPMOD VALUE                  @G860PXB 31900000
.CNTR    AIF   ('&LPMOD' EQ '').CNTS                                    31950000
         AIF   ('&LPMOD'(1,1) EQ '(').CNTS                              32000000
         DC    AL1(&LPMOD)        LPMOD VALUE                  @G860PXB 32050000
         AGO   .CNTT0C                                                  32100000
.CNTS    DC    AL1(0)             LPMOD VALUE                  @G860PXB 32150000
.CNTT0C  ANOP                                                    Y02752 32200000
.CNTV    DC    AL1(&NUMB)         STATUS BYTE                  @G860PXB 32250000
         AIF   ('&EP' EQ '').CNTW                                       32300000
         DC    CL8'&EP'           EP SYMBOL                    @G860PXB 32350000
         AGO   .CNTXX                                              I270 32400000
.CNTW    DC    CL8' '             EP SYMBOL                    @G860PXB 32450000
.CNTXX   ANOP                                                  @G860PXB 32500000
         AIF   ('&JSCB' EQ '').CONTQ6                          @G860PXB 32550000
         AIF   ('&JSCB'(1,1) EQ '(').CONTQ6                        I270 32600000
         DC    A(&JSCB)           ADDRESS OF JSCB              @G860PXB 32650000
         AGO   .CNTYY                                                   32700000
.CONTQ6  DC    A(0)               ADDRESS OF JSCB              @G860PXB 32750000
.CNTYY   ANOP                                                  @G860PXB 32800000
         AIF   (NOT (&SWSTAI OR &SWESTAI) ).TLICN              @G860PXB 32850000
         AIF   ('&STPADDR' EQ '').CREG2                          Y02752 32900000
         AIF   ('&STPADDR'(1,1) EQ '(' ).CREG2                   Y02752 32950000
         DC    A(&STPADDR)        STAI/ESTAI PARM LIST ADDR    @G860PXB 33000000
         AGO   .CKREG1                                            20028 33050000
.CREG2   DC    A(0)               STAI/ESTAI PARM LIST ADDR    @G860PXB 33100000
.CKREG1  ANOP                                                    Y02752 33150000
         AIF   ('&STXADDR'(1,1) EQ '(' ).CREG1                   Y02752 33200000
         DC    A(&STXADDR)        STAI/ESTAI EXIT RTN ADDRESS  @G860PXB 33250000
         AGO   .TLICNA                                            20021 33300000
.CREG1   DC    A(0)               STAI/ESTAI EXIT RTN ADDRESS  @G860PXB 33350000
         AGO   .TLICNA                                                  33400000
.TLICN   DC    A(0)               NO STAI/ESTAI PARM LIST ADDR @G860PXB 33450000
         DC    A(0)               NO EXIT ADDRESS              @G860PXB 33500000
.TLICNA  ANOP                                                    Y02752 33550000
         AIF   ('&TASKLIB' EQ '').TLICNC                         Y02752 33600000
         AIF   ('&TASKLIB'(1,1) EQ '(' ).TLICNC                  Y02752 33650000
         DC    A(&TASKLIB)        TASKLIB DCB ADDRESS          @G860PXB 33700000
         AGO   .INSHSP1                                          Y02752 33750000
.TLICNC  DC    A(0)               TASKLIB DCB ADDRESS          @G860PXB 33800000
.INSHSP1 ANOP                                                    Y02752 33850000
&NSHSP   SETC  '0'                ASSUME NO NSHSPL,NSHSPV      @G860PXB 33900000
         AIF   ('&NSHSPL' EQ '').INSHSP4   NSHSPL SPECIFIED:   @G860PXB 33950000
&NUMB3   SETA  &NUMB3+128         SET BIT TO INDICATE LIST     @G860PXB 34000000
&NSHSP   SETC  '&NSHSPL'          INDICATE NSHSPL              @G860PXB 34050000
         AGO   .INSHSP2                                        @G860PXB 34100000
.INSHSP4 AIF   ('&NSHSPV' EQ '').INSHSP2    NSHSPV SPECIFIED:  @G860PXB 34150000
&NSHSP   SETC  '&NSHSPV'          INDICATE NSHSPV              @G860PXB 34200000
.INSHSP2 AIF   ('&RSAPF' NE 'YES').INSHSP3 RSAPF SPECIFIED:    @G860PXB 34250000
&NUMB3   SETA  &NUMB3+64          SET BIT TO INDICATE IT       @G860PXB 34300000
.INSHSP3 DC    AL1(&NUMB3)        FLAG BYTE                    @G860PXB 34350000
         AIF   ('&TID'(1,1) EQ '(').BYT53A                     @G860PXB 34400000
         DC    AL1(&TID)          TASK ID                      @G860PXB 34450000
         AGO   .BYT53B                                         @G860PXB 34500000
.BYT53A  DC    AL1(0)             TID = 0                      @G860PXB 34550000
.BYT53B  ANOP                                                  @G860PXB 34600000
         DC    AL2(72)            PARM LIST LENGTH             @G860PXB 34650000
         AIF   ('&NSHSP'(1,1) EQ '(').INSHSP5                  @G860PXB 34700000
         DC    A(&NSHSP)          NSHSPV VALUE OR NSHSPL ADDR  @G860PXB 34750000
         AGO   .BYTE60                                         @G860PXB 34800000
.INSHSP5 ANOP                                                  @G860PXB 34850000
         DC    A(0)               NSHSPV VALUE OR NSHSPL ADDR    Y02752 34900000
.BYTE60  ANOP                                                           34950000
         DC    AL1(&NUMB1)        FLAG BYTE                    @G860PXB 35000000
         DC    AL1(&FORM#)        SET UP FORMAT NUMBER         @G860PXB 35050000
         DC    XL10'00'           RESERVED BYTES AT END        @G860PXB 35100000
.SVC     SVC   42                 ISSUE ATTACH SVC             @G860PXB 35150000
         MEXIT                                                    20028 35200000
.ERROZ   IHBERMAC 1003,PURGE,ASYNCH                               20021 35250000
         MEXIT                                                   Y02752 35300000
.ERROR   IHBERMAC 1004,&STAITYP                                  Y02752 35350000
         MEXIT                                                   Y02752 35400000
.E2      IHBERMAC 1005,&STAITYP                                  Y02752 35450000
         MEXIT                                                          35500000
.E3      IHBERMAC 1005,PURGE                                            35550000
         MEXIT                                                          35600000
.E4      IHBERMAC 1005,ASYNCH                                           35650000
         MEXIT                                                          35700000
.E5      IHBERMAC 1005,SZERO,YES                                        35750000
         MEXIT                                                          35800000
.E6      IHBERMAC 1005,GIVEJPQ                                          35850000
         MEXIT                                                          35900000
.E7      IHBERMAC 1005,GSPV                                             35950000
         MEXIT                                                          36000000
.E8      IHBERMAC 1005,GSPL                                             36050000
         MEXIT                                                          36100000
.E9      IHBERMAC 1005,SHSPV                                            36150000
         MEXIT                                                          36200000
.E10     IHBERMAC 1005,SHSPL                                            36250000
         MEXIT                                                          36300000
.ERDISP  IHBERMAC 1001,DISP,&DISP                                       36350000
         MEXIT                                                   X02050 36400000
.ERTQE   IHBERMAC 1001,TQE,&TQE                                  X02050 36450000
         MEXIT                                                   X02050 36500000
.ERFP    IHBERMAC 1001,FPREGSA,&FPREGSA                          X02050 36550000
         MEXIT                                                   Y02752 36600000
.ERTERM  IHBERMAC 1001,TERM,&TERM                                Y02752 36650000
         MEXIT                                                   Y02752 36700000
.ERALCPY IHBERMAC 1001,ALCOPY,&ALCOPY                              @L1A 36716600
         MEXIT                                                     @L1A 36733200
.ERNSHSP IHBERMAC 1020,NSHSPV,NSHSPL                             Y02752 36750000
         MEXIT                                                   Y02752 36800000
.ERSTAI  IHBERMAC 1020,STAI,ESTAI                                Y02752 36850000
.END     ANOP                                                  @G860PXZ 36900000
         MEXIT                                                 @G860PXZ 36950000
.LEVEL1  ANOP                     GENERATE JBB1326 MACRO       @G860PXZ 37000000
&NAME    ATTACH7 EP=&EP,EPLOC=&EPLOC,DE=&DE,DCB=&DCB,PARAM=&PARAM,     X37050000
               VL=&VL,ECB=&ECB,GSPV=&GSPV,KEY=&KEY,GSPL=&GSPL,         X37100000
               SHSPL=&SHSPL,ETXR=&ETXR,LPMOD=&LPMOD,DPMOD=&DPMOD,      X37150000
               MF=&MF,SF=&SF,SHSPV=&SHSPV,SM=&SM,SZERO=&SZERO,         X37200000
               JSTCB=&JSTCB,SVAREA=&SVAREA,ROLL=&ROLL,HIARCHY=&HIARCHY,X37250000
               JSCB=&JSCB,GIVEJPQ=&GIVEJPQ,TASKLIB=&TASKLIB,           X37300000
               TSLOGON=&TSLOGON,STAI=&STAI,PURGE=&PURGE,               X37350000
               ASYNCH=&ASYNCH,ESTAI=&ESTAI,TERM=&TERM,NSHSPL=&NSHSPL,  X37400000
               NSHSPV=&NSHSPV,RSAPF=&RSAPF,RELATED=&RELATED,           X37450000
               LSQA=&LSQA,DISP=&DISP,TID=&TID,TQE=&TQE,                X37500000
               FPREGSA=&FPREGSA                                @G860PXZ 37550000
         MEXIT                                                     @D1A 37553300
.********************************************************************** 37553400
.*   HANDLE DISP=RESET WITH TCB REQUEST                               * 37553500
.********************************************************************** 37553600
.ATTCHD  ANOP                                                      @L2A 37553700
.********************************************************************** 37553800
.*                                                                    * 37553900
.* PROCESSING OF ATTACH WITH DISP=YES AND TCB ADDRESS                 * 37554000
.*                                                                    * 37554100
.********************************************************************** 37554200
.RESET00 ANOP                                                      @L2A 37554300
         LCLC  &PLENGTH    PARAMETER LIST LENGTH                        37554400
         LCLC  &ZJUMP      WORK STRING FOR PARAMETER LIST LENGTH        37554500
         LCLC  &ZMS        MNOTE ERROR STRING                           37554600
         LCLC  &FLEN       TOTAL LENGTH OF PARAMETER LIST               37554700
         LCLC  &FLAE       XA OR ESA LOAD ADDRESS                       37554800
&FLEN    SETC  '72'                                                     37554900
&FLAE    SETC  'LA'                                                     37555000
&FORM#   SETC  '3'         PARAMETER LIST FOR DISP=RESET WITH TCB  @P2A 37555100
.********************************************************************** 37555200
.*       PERFORM CHECK FOR UNRECOGNIZED DISP KEYWORD                  * 37555300
.********************************************************************** 37555400
&ZMACRET SETA  0           INIT RETURN CODE                        @L2A 37555500
         AIF   ('&DISP' EQ 'RESET').RESET0B                        @L2A 37555600
         AIF   ('&DISP' EQ 'YES').RESET0B                          @L2A 37555700
         AIF   ('&DISP' EQ 'NO').RESET0B                           @L2A 37555800
         IHBERMAC 1001,DISP,&DISP                                       37555900
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 37556000
.********************************************************************** 37556100
.*       PERFORM CHECK FOR CORRECT COMBINATION OF DISP=RESET WITH TCB * 37556200
.********************************************************************** 37556300
.RESET0B ANOP                                                      @L2A 37556400
         AIF   ('&DISP' EQ 'RESET' AND T'&TCB NE 'O').RESET01      @L2A 37556500
&ZMS     SETC  'DISP=RESET MUST BE SPECIFIED WITH TCB KEYWORD. '   @L2A 37556600
         MNOTE 8,' &ZMS '                                          @L2A 37556700
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 37556800
.********************************************************************** 37556900
.*       PERFORM CHECK FOR LIST FORM INVOCATION                       * 37557000
.********************************************************************** 37557100
.RESET01 ANOP                                                      @L2A 37557200
         AIF   ('&SF' NE 'L'  ).RESET02                            @L2A 37557300
&ZMS     SETC  'LIST FORM IS INCOMPATIBLE WITH DISP=RESET WITH TCB. '   37557400
         MNOTE 8,' &ZMS '                                               37557500
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 37557600
         AGO   .RESET02                                                 37557700
.********************************************************************** 37557800
.*       PERFORM CHECK FOR INCOMPATIBLE PARAMETERS                    * 37557900
.********************************************************************** 37558000
.RESET02 ANOP                                                      @L2A 37558100
         AIF   (T'&EP NE 'O').RESET03                              @L2A 37558200
         AIF   (T'&EPLOC NE 'O').RESET03                           @L2A 37558300
         AIF   (T'&DE NE 'O').RESET03                              @L2A 37558400
         AIF   (T'&DCB NE 'O').RESET03                             @L2A 37558500
         AIF   (T'&PARAM NE 'O').RESET03                           @L2A 37558600
         AIF   (T'&VL NE 'O').RESET03                              @L2A 37558700
         AIF   (T'&ECB NE 'O').RESET03                             @L2A 37558800
         AIF   (T'&GSPV NE 'O').RESET03                            @L2A 37558900
         AIF   (T'&GSPL NE 'O').RESET03                            @L2A 37559000
         AIF   (T'&SHSPL NE 'O').RESET03                           @L2A 37559100
         AIF   (T'&ETXR NE 'O').RESET03                            @L2A 37559200
         AIF   (T'&LPMOD NE 'O').RESET03                           @L2A 37559300
         AIF   (T'&DPMOD NE 'O').RESET03                           @L2A 37559400
         AIF   (T'&SHSPV NE 'O').RESET03                           @L2A 37559500
         AIF   (T'&HIARCHY NE 'O').RESET03                         @L2A 37559600
         AIF   (T'&JSCB NE 'O').RESET03                            @L2A 37559700
         AIF   (T'&TASKLIB NE 'O').RESET03                         @L2A 37559800
         AIF   (T'&STAI NE 'O').RESET03                            @L2A 37559900
         AIF   (T'&PURGE NE 'O').RESET03                           @L2A 37560000
         AIF   (T'&ASYNCH NE 'O').RESET03                          @L2A 37560100
         AIF   (T'&ESTAI NE 'O').RESET03                           @L2A 37560200
         AIF   (T'&NSHSPL NE 'O').RESET03                          @L2A 37560300
         AIF   (T'&NSHSPV NE 'O').RESET03                          @L2A 37560400
         AIF   (T'&TQE NE 'O').RESET03                             @L2A 37560500
         AIF   (T'&FPREGSA NE 'O').RESET03                         @L2A 37560600
         AIF   (T'&ALCOPY NE 'O').RESET03                          @L2A 37560700
         AGO .RESET04                                                   37560800
.********************************************************************** 37560900
.*       INCOMPATIBLE PARAMETER DETECTED                              * 37561000
.********************************************************************** 37561100
.RESET03 ANOP                                                      @L2A 37561200
&ZMS     SETC  'KEYWORD(S) SPECIFIED IS INCOMPATIBLE'                   37561300
&ZMS     SETC  '&ZMS. WITH DISP=RESET AND TCB KEYWORD. '                37561400
         MNOTE 8,' &ZMS '                                               37561500
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 37561600
.********************************************************************** 37561700
.*       VERIFY THAT TCB PARAMETER IS O.K.                            * 37561800
.********************************************************************** 37561900
.RESET04 ANOP                                                      @L2A 37562000
         AIF   ('&TCB' NE '(15)').RESET05                          @L2A 37562100
&ZMS     SETC  'TCB ADDRESS CANNOT BE PASSED IN REGISTER 15.'      @L2A 37562200
         MNOTE 8,' &ZMS '                                               37562300
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 37562400
.RESET05 ANOP                                                      @L2A 37562500
         AIF   ('&SF'    EQ 'I'  ).RESET09                         @L2A 37562600
         AIF   ('&SF(1)' EQ 'E'  ).RESET06                         @L2A 37562700
         AGO   .RESET09                                            @L2A 37562800
.*                                                                      37562900
.*       VERIFY EXECUTE TCB SPECIFICATION                               37563000
.*                                                                      37563100
.RESET06 ANOP                                                      @L2A 37563200
         AIF   ('&SF(2)' NE ''  ).RESET09                          @L2A 37563300
&ZMS     SETC  'LIST ADDRESS MUST BE SUPPLIED WITH EXECUTE FORM. '      37563400
         MNOTE 8,' &ZMS '                                               37563500
&ZMACRET SETA  8           SET ERROR RETURN CODE                   @L2A 37563600
.********************************************************************** 37563700
.*        END CHECKING OF TCB SPECIFICATION                           * 37563800
.********************************************************************** 37563900
.RESET09 ANOP                                                           37564000
.********************************************************************** 37564100
.*        ERROR-CHECKING COMPLETE                                     * 37564200
.********************************************************************** 37564300
.RESET26 ANOP                                                      @L2A 37564400
         AIF   (&ZMACRET NE 0).RESET99  IF ERRORS DETECTED THEN QUIT    37564500
.********************************************************************** 37564600
.*                                      ELSE, GENERATE CODE           * 37564700
.*--------------------------------------------------------------------* 37564800
.*        SEPARATE IN-LINE AND EXECUTE FORMS                          * 37564900
.********************************************************************** 37565000
         AIF   ('&SF'    EQ 'I').RESETIN     IN-LINE MACRO FORM    @L2A 37565100
         AIF   ('&SF(1)' EQ 'E').RESETEX     EXECUTE MACRO FORM    @L2A 37565200
.********************************************************************** 37565300
.*        HANDLE IN-LINE FORM                                         * 37565400
.********************************************************************** 37565500
.RESETIN ANOP                                                      @L2A 37565600
&GNAME   SETC  'IHB'.'&SYSNDX'    GENERATE LIST NAME               @L2A 37565700
&ZJUMP   SETC  '&FLEN'.'(,15)'    GENERATE BRANCH AROUND LIST      @L2A 37565800
&NAME    DS    0H                                                       37565900
         CNOP  0,4                                                      37566000
         &FLAE 15,&GNAME          SET UP LIST ADDRESS                   37566100
         B     &ZJUMP             BRANCH AROUND LIST                    37566200
&GNAME   DS    0F                 SUP. PARM LIST                        37566300
         DC    XL8'00'                                             @P3A 37566400
         DC    XL4'80000000'                                       @P3A 37566500
         DC    XL42'00'                                            @P3C 37566600
         DC    AL2(&FLEN)         PARM LIST LENGTH                      37566700
         DC    A(0)               NSHSPV VALUE OR NSHSPL ADDR           37566800
         DC    X'00'              FLAG BYTE                             37566900
         DC    AL1(&FORM#)        SET UP FORMAT NUMBER                  37567000
         DC    XL(&FLEN-62)'00'   RESERVED BYTES AT END                 37567100
         AGO   .RESETCB           GENERATE CODE TO GET TCB ADDRESS @L2A 37567200
.********************************************************************** 37567300
.*        HANDLE EXECUTE FORM                                         * 37567400
.********************************************************************** 37567500
.RESETEX ANOP                                                      @L2A 37567600
&NAME    DS    0H                                                       37567700
         AIF   ('&SF(2)' EQ '(15)').RESETE3  LIST ADDRESS IN REG 15     37567800
         AIF   ('&SF'(4,1) EQ '(' ).RESETE2  LIST ADDRESS IN OTHER REG  37567900
         AGO   .RESETE1                      LIST ADDRESS TO BE LOADED  37568000
.RESETE1 ANOP                 LIST ADDRESS TO BE LOADED            @L2A 37568100
         &FLAE 15,&SF(2)          SET UP LIST ADDRESS                   37568200
         AGO   .RESETE4           GENERATE CODE TO SET BITS        @L2A 37568300
.RESETE2 ANOP                 LIST ADDRESS IN OTHER REG            @L2A 37568400
         LR    15,&H              COPY LIST ADDRESS                     37568500
         AGO   .RESETE4           GENERATE CODE TO SET BITS        @L2A 37568600
.RESETE3 ANOP                 LIST ADDRESS IN REG 15               @L2A 37568700
         AGO   .RESETE4           GENERATE CODE TO SET BITS        @L2A 37568800
.********************************************************************** 37568900
.*        GENERATE BAL CODE TO SET OPTION BIT IN ATTACH PARAMETER LIST  37569000
.********************************************************************** 37569100
.RESETE4 ANOP                                                      @L2A 37569200
         MVI   55(15),72          SET LENGTH OF THIS PARM LIST          37569300
         OI    8(15),X'80'        SET NEW FORMAT BIT                    37569400
         MVI   61(15),&FORM#      SET FORMAT NUMBER                     37569500
         AGO   .RESETCB       GENERATE CODE TO GET TCB ADDRESS     @L2A 37569600
.********************************************************************** 37569700
.*        GENERATE BAL CODE TO GET TCB ADDRESS                        * 37569800
.********************************************************************** 37569900
.RESETCB ANOP                                                      @L2A 37570000
         AIF  ('&TCB' EQ '(1)').RESETB3                            @L2A 37570100
         AIF  ('&TCB'(1,1) EQ '(').RESETB2                         @L2A 37570200
.*                                                                      37570300
.*       TCB ADDRESS IS IN STORAGE                                      37570400
.*                                                                      37570500
         L     1,&TCB             LOAD TCB ADDRESS                      37570600
         AGO   .RESETB3         GO ISSUE SVC                       @L2A 37570700
.*                                                                      37570800
.*       TCB ADDRESS IS IN A REGISTER OTHER THAN REG 1                  37570900
.*                                                                      37571000
.RESETB2 ANOP                                                      @L2A 37571100
         LR    1,&TCB(1)          COPY TCB ADDRESS                      37571200
.********************************************************************   37571300
.***       ISSUE ATTACH SVC                                             37571400
.********************************************************************   37571500
.RESETB3 ANOP                   TCB ADDRESS IS IN REGISTER 1            37571600
         SVC   42                 ISSUE ATTACH SVC                      37571700
.********************************************************************   37571800
.***       EXIT MACRO                                                   37571900
.********************************************************************   37572000
.RESET99 ANOP                                                           37572100
         SPACE 1                                                        37572200
         MEXIT                                                          37572300
.INVKATTACHX ANOP                                                  @L3A 37572400
         MNOTE 4,'*** ATTACHX MACRO SUBSTITUTED FOR ATTACH MACRO BECAUSX37572500
               E ASCENV=AR/ANY, AMODE64=YES, OR ARCHLVL>1 SPECIFIED ON X37572600
               PREVIOUSLY ISSUED SYSSTATE MACRO'                   @L3C 37572700
         MNOTE 4,'*** IF THE IEZATTCH MACRO WAS USED, REPLACE IT WITH TX37572800
               HE IEZATTCX MACRO. '                                @D1A 37572900
&NAME    ATTACHX EP=&EP,EPLOC=&EPLOC,DE=&DE,DCB=&DCB,PARAM=&PARAM,     X37573000
               VL=&VL,ECB=&ECB,GSPV=&GSPV,KEY=&KEY,GSPL=&GSPL,         X37573100
               SHSPL=&SHSPL,ETXR=&ETXR,LPMOD=&LPMOD,DPMOD=&DPMOD,      X37573200
               MF=&MF,SF=&SF,SHSPV=&SHSPV,SM=&SM,SZERO=&SZERO,         X37574100
               JSTCB=&JSTCB,SVAREA=&SVAREA,ROLL=&ROLL,                 X37576600
               HIARCHY=&HIARCHY,JSCB=&JSCB,GIVEJPQ=&GIVEJPQ,           X37579100
               TASKLIB=&TASKLIB,TSLOGON=&TSLOGON,STAI=&STAI,           X37581600
               PURGE=&PURGE,ASYNCH=&ASYNCH,ESTAI=&ESTAI,TERM=&TERM,    X37584100
               NSHSPL=&NSHSPL,NSHSPV=&NSHSPV,RSAPF=&RSAPF,             X37586600
               RELATED=&RELATED,LSQA=&LSQA,DISP=&DISP,TID=&TID,        X37589100
               TQE=&TQE,FPREGSA=&FPREGSA,ALCOPY=&ALCOPY,               X37592700
               TCB=&TCB                                            @L2A 37596300
         MEND                                                  @G860PXZ 37600000
**/                                                                     37650000
*  ATTACH :        /**************************************************/ 37700000
*/********************************************************************/ 37750000
*/**************** PL/S VERSION OF THE ATTACH MACRO ******************/ 37800000
*/********************************************************************/ 37850000
* MACRO                                                                 37900000
*   KEYS( ALCOPY, ASYNCH, DCB, DE, DPMOD, ECB, EP, ESTAI, ETXR,         37950000
*         GIVEJPQ, GSPL, GSPV, JSCB, JSTCB, KEYZERO, LPMOD, MF,         38000000
*         NOASYNCH, NODISP, NOSVAREA, NOSZERO, NSHSPL, NSHSPV, PARAM,   38050000
*         PURGE, RTCD, SF, SHSPL, SHSPV, SM, STAI, TASKLIB, TCB, TERM,  38100000
*         TID, VL, RELATED, RSAPF, DISP);            /*          @L2C*/ 38150000
*        DCL SYSSPLV CHAR EXT;    /* GLOBAL FOR SPLEVEL MAC  @G860PXZ*/ 38200000
*        DCL SYSASCE CHAR EXT;    /* GLOBAL FOR SYSSTATE MACRO   @D1A*/ 38225000
*        ANS('?SPLEVEL (TEST);'); /* OBTAIN DEFAULT SYSSPLV  @G860PXZ*/ 38250000
*        IF SYSSPLV = '1' THEN    /* INVOKE JBB1326 LEVEL    @G860PXZ*/ 38300000
*          ANS('?'||MACLABEL||'ATTACHP7 '||MACLIST||MACKEYS||';');      38350000
*        ELSE                     /* INVOKE THE BASE LEVEL MACRO     */ 38400000
*         DO;                                                           38416600
*           DCL SYSAM64 CHAR EXT;  /* GLOBAL FOR SYSSTATE MACRO  @L3A*/ 38423400
*           DCL SYSALVL FIXED EXT; /* GLOBAL FOR SYSSTATE MACRO  @L3A*/ 38430200
*           ANS('?SYSSTATE (TEST);'); /* OBTAIN DEFAULTS         @L2A*/ 38437000
*           IF SYSASCE = 'P'       /* INVOKE NORMAL ATTACH       @L2A*/ 38443800
*            & SYSAM64 ^= 'YES'    /* INVOKE NORMAL ATTACH       @L3A*/ 38450600
*            & SYSALVL <= 1 THEN   /* INVOKE NORMAL ATTACH       @L3A*/ 38457400
*             ANS('?'||MACLABEL||'ATTACHP '||MACLIST||MACKEYS||';');    38464200
*           ELSE DO;               /* INVOKE ATTACHX             @L2A*/ 38471000
*             ANS MSG('ATTACHX MACRO SUBSTITUTED FOR ATTACH MACRO'||    38477800
*                     ' BECAUSE ASCENV(AR/ANY), AMODE64(YES), OR' ||    38484600
*                     ' ARCHLVL(>1) SPECIFIED ON PREVIOUSLY ISSUED' ||  38491400
*                     ' SYSSTATE MACRO');     /*                 @L3C*/ 38498200
*               ANS MSG('IF THE IEZATTCH MACRO WAS USED, REPLACE '||    38505000
*                   'IT WITH THE IEZATTCX MACRO. '); /*          @D1A*/ 38511800
*             ANS('?'||MACLABEL||'ATTACHXP '||MACLIST||MACKEYS||';'); /*38518600
*                                       INVOKE X-VERSION         @L2A*/ 38525400
*           END;                   /*                            @L2A*/ 38532200
*         END;                                                          38540000
*%END;                                                                  38550000
