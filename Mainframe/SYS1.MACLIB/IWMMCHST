*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMMCHST                              -10/01/96-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Monitoring change state of work unit          * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1993, 1997                     * 00001300
*                                                                     * 00001400
* STATUS= HBB6603                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      The purpose of this service is to reflect in a monitoring      * 00002200
*      environment what the current state of a work request is with   * 00002300
*      respect to delays.                                             * 00002400
*                                                                     * 00002500
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002600
*                                                                     * 00002700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002800
*                                                                     * 00002900
*01* ENVIRONMENT:                                                     * 00003000
*                                                                     * 00003100
*                                                                     * 00003200
*      Dispatchable unit mode: Task or SRB mode.                      * 00003300
*                                                                     * 00003400
*      Minimum authorization: Problem or Supervisor state.  PSW key   * 00003500
*                        must either be 0 or match the value supplied * 00003600
*                        on IWMMCREA.                                 * 00003700
*                                                                     * 00003800
*      AMODE:            31-bit.                                      * 00003900
*                                                                     * 00004000
*      ASC mode:         Primary.                                     * 00004100
*                                                                     * 00004200
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004300
*                                                                     * 00004400
*      Locks:            Suspend locks are allowed.                   * 00004500
*                                                                     * 00004600
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00004700
*                                                                     * 00004800
*      Control parameters: Control parameters must be in the primary  * 00004900
*                        address space.                               * 00005000
*                                                                     * 00005100
*                                                                     * 00005200
*                                                                     * 00005300
*01* PROGRAMMING REQUIREMENTS:                                        * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*    1.  The macro IWMYCON must be included to use this macro.        * 00005700
*                                                                     * 00005800
*    2.  The macro IWMPB must be in the library concatenation, since  * 00005900
*        it is included by IWMYCON.                                   * 00006000
*                                                                     * 00006100
*    3.  Note that the high order halfword of register 0, and the     * 00006200
*        reason code variable when specified, may be non-zero and     * 00006300
*        represents diagnostic data which is NOT part of the external * 00006400
*        interface.  The high order halfword should thus be excluded  * 00006500
*        from comparison with the reason code values described above. * 00006600
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00006700
*        be used for this purpose.                                    * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*01* RESTRICTIONS:                                                    * 00007200
*                                                                     * 00007300
*                                                                     * 00007400
*    1.  This macro may not be used prior to the completion of WLM    * 00007500
*        address space initialization                                 * 00007600
*                                                                     * 00007700
*    2.  Programs which invoke this macro may only execute on MVS/ESA * 00007800
*        (version 5 or higher).                                       * 00007900
*                                                                     * 00008000
*    3.  Caller is responsible for error recovery                     * 00008100
*                                                                     * 00008200
*    4.  Only limited checking is done against the input monitoring   * 00008300
*        token.                                                       * 00008400
*                                                                     * 00008500
*    5.  If the key specified on IWMMCREA was a user key (8-F), then  * 00008600
*        the primary addressability must exist to the performance     * 00008700
*        block IWMMCREA obtained.  This condition is satisfied by     * 00008800
*        ensuring that current primary matches primary at the time    * 00008900
*        that IWMMCREA was invoked.  If this service is invoked in a  * 00009000
*        subspace, the condition may be satisfied by ensuring that    * 00009100
*        the performance block is shared with the base space.         * 00009200
*                                                                     * 00009300
*    6.  The caller must serialize to prevent any delay monitoring    * 00009400
*        services from being invoked concurrently for the environment * 00009500
*        represented by the monitoring token.                         * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*01* INPUT REGISTER INFORMATION:                                      * 00010000
*                                                                     * 00010100
*    Before issuing the IWMMCHST macro, the caller does not have to   * 00010200
*    place any information into any register unless using it in       * 00010300
*    register notation for a particular parameter, or using it as a   * 00010400
*    base register.                                                   * 00010500
*                                                                     * 00010600
*01* OUTPUT REGISTER INFORMATION:                                     * 00010700
*                                                                     * 00010800
*    When control returns to the caller, the GPRs contain:            * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*    REGISTER  CONTENTS                                               * 00011200
*                                                                     * 00011300
*    0         Reason code if GR15 return code is non-zero            * 00011400
*                                                                     * 00011500
*    1         Used as work registers by the system                   * 00011600
*                                                                     * 00011700
*    2-13      Unchanged                                              * 00011800
*                                                                     * 00011900
*    14        Used as work registers by the system                   * 00012000
*                                                                     * 00012100
*    15        Return code                                            * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*    When control returns to the caller, the ARs contain:             * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*    REGISTER  CONTENTS                                               * 00012900
*                                                                     * 00013000
*    0-1       Used as work registers by the system                   * 00013100
*                                                                     * 00013200
*    2-13      Unchanged                                              * 00013300
*                                                                     * 00013400
*    14-15     Used as work registers by the system                   * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*    Some callers depend on register contents remaining the same      * 00013900
*    before and after issuing a service.  If the system changes the   * 00014000
*    contents of registers on which the caller depends, the caller    * 00014100
*    must save them before issuing the service, and restore them      * 00014200
*    after the system returns control.                                * 00014300
*                                                                     * 00014400
*01* PERFORMANCE IMPLICATIONS:                                        * 00014500
*                                                                     * 00014600
*    None                                                             * 00014700
*                                                                     * 00014800
*01* SYNTAX:                                                          * 00014900
*                                                                     * 00015000
*[xlabel]  IWMMCHST    STATE=FREE                                    * 00015100
*                     ,STATE=ACTIVE                                  * 00015200
*                     ,STATE=READY                                   * 00015300
*                     ,STATE=IDLE                                    * 00015400
*                     ,STATE=WAITING                                 * 00015500
*                         ,RESOURCE=LATCH                            * 00015600
*                         ,RESOURCE=LOCK                             * 00015700
*                         ,RESOURCE=IO                               * 00015800
*                         ,RESOURCE=CONV                             * 00015900
*                         ,RESOURCE=DISTRIB                          * 00016000
*                         ,RESOURCE=SESS_LOCALMVS                    * 00016100
*                         ,RESOURCE=SESS_NETWORK                     * 00016200
*                         ,RESOURCE=SESS_SYSPLEX                     * 00016300
*                         ,RESOURCE=TIMER                            * 00016400
*                         ,RESOURCE=OTHER_PRODUCT                    * 00016500
*                         ,RESOURCE=MISC                             * 00016600
*                      ,MONTKN=xmontkn                                * 00016700
*                    [,RUNTIME_VER=SHORT_FORM]                       * 00016800
*                    [,RUNTIME_VER=MINIMAL]                          * 00016900
*                    [,COMPCODE=YES]                                 * 00017000
*                    [,COMPCODE=NO]                                  * 00017100
*                     [,RETCODE=xretcode]                             * 00017200
*                     [,RSNCODE=xrsncode]                             * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      Where:                                                         * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*      [xlabel]                                                       * 00017900
*          is an optional symbol, starting in column 1, that is the   * 00018000
*          name on the IWMMCHST macro invocation.  The name must      * 00018100
*          conform to the rules for an ordinary assembler language    * 00018200
*          symbol.                                                    * 00018300
*          DEFAULT: No name.                                          * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*      STATE=FREE|ACTIVE|READY|IDLE|WAITING                         * 00018900
*          is a required keyword input which indicates the current    * 00019000
*          state for the work request.                                * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*          STATE=FREE                                                 * 00019400
*              indicates that the work manager has no work request    * 00019500
*              associated with the monitoring environment.            * 00019600
*                                                                     * 00019700
*          STATE=ACTIVE                                               * 00019800
*              indicates that there is a program executing on behalf  * 00019900
*              of the work request described by the monitoring        * 00020000
*              environment.  This is an indication from the           * 00020100
*              perspective of the work manager using this service,    * 00020200
*              who should not try to factor in MVS decisions in       * 00020300
*              preempting work, etc.                                  * 00020400
*                                                                     * 00020500
*          STATE=READY                                                * 00020600
*              indicates that there is a program ready to execute on  * 00020700
*              behalf of the work request described by the monitoring * 00020800
*              environment, but the work manager has given priority   * 00020900
*              to another work request.                               * 00021000
*                                                                     * 00021100
*          STATE=IDLE                                                 * 00021200
*              indicates that the work manager has no work requests   * 00021300
*              that it is allowed to service within the monitoring    * 00021400
*              environment.  This represents a delay that is not      * 00021500
*              under the control of the work manager itself and which * 00021600
*              it cannot eliminate.  This may be caused by limits     * 00021700
*              imposed by the installation or by the nature of the    * 00021800
*              work request itself.                                   * 00021900
*                                                                     * 00022000
*          STATE=WAITING                                              * 00022100
*              indicates that the work manager is waiting for a       * 00022200
*              resource on behalf of the work request described by    * 00022300
*              the the monitoring environment.                        * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*              RESOURCE=LATCH|LOCK|IO|CONV|DISTRIB|SESS_LOCALMVS|SES * 00022700
*                  S_NETWORK|SESS_SYSPLEX|TIMER|OTHER_PRODUCT|MISC   * 00022800
*                                                                     * 00022900
*                  is a required keyword input which indicates the    * 00023000
*                  resource that the work manager is waiting for on   * 00023100
*                  behalf of the work request described by the        * 00023200
*                  monitoring environment.                            * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*                  RESOURCE=LATCH                                     * 00023600
*                      indicates that the work manager is waiting on  * 00023700
*                      a latch.                                       * 00023800
*                                                                     * 00023900
*                  RESOURCE=LOCK                                      * 00024000
*                      indicates that the work manager is waiting on  * 00024100
*                      a lock.                                        * 00024200
*                                                                     * 00024300
*                  RESOURCE=IO                                        * 00024400
*                      indicates that the work manager is waiting on  * 00024500
*                      an activity related to an I/O request. This    * 00024600
*                      may either be an actual I/O operation or some  * 00024700
*                      function associated with an IO request that    * 00024800
*                      cannot be more precisely determined by the     * 00024900
*                      work manager (e.g. locks, buffers, etc.).      * 00025000
*                                                                     * 00025100
*                  RESOURCE=CONV                                      * 00025200
*                      indicates that the work manager is waiting on  * 00025300
*                      a conversation.  This may be used in           * 00025400
*                      conjunction with IWMMSWCH to identify where    * 00025500
*                      the target is located.                         * 00025600
*                                                                     * 00025700
*                  RESOURCE=DISTRIB                                   * 00025800
*                      indicates that the work manager is waiting on  * 00025900
*                      a distributed request.  This says at a high    * 00026000
*                      level that some function or data must be       * 00026100
*                      routed prior to resumption of the work         * 00026200
*                      request.  This is to be contrasted with        * 00026300
*                      Waiting on Conversation, which is a low level  * 00026400
*                      view of the precise resource that is needed. A * 00026500
*                      distributed request could involve waiting on a * 00026600
*                      conversation as part of its processing.        * 00026700
*                                                                     * 00026800
*                  RESOURCE=SESS_LOCALMVS                             * 00026900
*                      indicates that the work manager is waiting to  * 00027000
*                      establish a session somewhere in the current   * 00027100
*                      MVS image.                                     * 00027200
*                                                                     * 00027300
*                  RESOURCE=SESS_NETWORK                              * 00027400
*                      indicates that the work manager is waiting to  * 00027500
*                      establish a session somewhere in the network.  * 00027600
*                                                                     * 00027700
*                  RESOURCE=SESS_SYSPLEX                              * 00027800
*                      indicates that the work manager is waiting to  * 00027900
*                      establish a session somewhere in the sysplex.  * 00028000
*                                                                     * 00028100
*                  RESOURCE=TIMER                                     * 00028200
*                      indicates that the work request is waiting on  * 00028300
*                      a timer.                                       * 00028400
*                                                                     * 00028500
*                  RESOURCE=OTHER_PRODUCT                             * 00028600
*                      indicates that the work manager is waiting on  * 00028700
*                      another product to complete its function.      * 00028800
*                                                                     * 00028900
*                  RESOURCE=MISC                                      * 00029000
*                      indicates that the work manager is waiting on  * 00029100
*                      some unidentified resource, possibly among the * 00029200
*                      previous categories.                           * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*      MONTKN=xmontkn                                                 * 00030400
*          is the name (RS-type), or address in register (2)-(12), of * 00030500
*          a required 32 bit input which contains the delay           * 00030600
*          monitoring token                                           * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*      [RUNTIME_VER=SHORT_FORM|MINIMAL]                             * 00031200
*          is an optional keyword input which indicates what level of * 00031300
*          runtime verification will be performed.                    * 00031400
*          DEFAULT: SHORT_FORM                                        * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*          [RUNTIME_VER=SHORT_FORM]                                   * 00031800
*              indicates that checking should verify that a           * 00031900
*              monitoring environment is established and passes a     * 00032000
*              short form of verification prior to being used.        * 00032100
*                                                                     * 00032200
*          [RUNTIME_VER=MINIMAL]                                      * 00032300
*              indicates that checking will only be done to verify    * 00032400
*              that a monitoring environment may be established,      * 00032500
*              assuming that it would be valid and useable if         * 00032600
*              established.                                           * 00032700
*              DEFAULT: SHORT_FORM indicates that short form checking * 00032800
*              is desired.                                            * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*      [COMPCODE=YES|NO]                                            * 00033600
*          is an optional keyword input which indicates whether       * 00033700
*          completion status for this service is needed.              * 00033800
*          DEFAULT: YES                                               * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*          [COMPCODE=YES]                                             * 00034200
*              indicates that completion status is needed.            * 00034300
*                                                                     * 00034400
*          [COMPCODE=NO]                                              * 00034500
*              indicates that completion status is not needed.        * 00034600
*              Registers 0, 15 cannot be used as reason code and      * 00034700
*              return code registers upon completion of the macro     * 00034800
*              expansion. For this reason neither RETCODE NOR RSNCODE * 00034900
*              may be specified when COMPCODE(NO) is specified.       * 00035000
*              DEFAULT: YES indicates that completion status is       * 00035100
*              needed.                                                * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*      [RETCODE=xretcode]                                             * 00035900
*          is the name (RS-type) of an optional fullword output       * 00036000
*          variable, or register (2)-(12), into which the return code * 00036100
*          is to be copied from GPR 15.                               * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*      [RSNCODE=xrsncode]                                             * 00036700
*          is the name (RS-type) of an optional fullword output       * 00036800
*          variable, or register (2)-(12), into which the reason code * 00036900
*          is to be copied from GPR 0.                                * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*01* ABEND CODES:  None.                                              * 00037400
*                                                                     * 00037500
*01* RETURN CODES:                                                    * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*            0    Name: IwmRetCodeOk                                  * 00037900
*                                                                     * 00038000
*                 Meaning: Successful completion.                     * 00038100
*                                                                     * 00038200
*                 Action: None required.                              * 00038300
*                                                                     * 00038400
*            4    Name: IwmRetCodeWarning                             * 00038500
*                                                                     * 00038600
*                 Meaning: Successful completion, unusual conditions  * 00038700
*                 noted.                                              * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*                 HEX REASON  MEANING/ACTION                          * 00039100
*                 CODE                                                * 00039200
*                                                                     * 00039300
*                 xxxx0402    Name: IwmRsnCodeNoMonEnv                * 00039400
*                                                                     * 00039500
*                             Meaning:  Input monitoring token        * 00039600
*                             indicates no monitoring environment was * 00039700
*                             established.                            * 00039800
*                                                                     * 00039900
*                             Action: None required.                  * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*            8    Name: IwmRetCodeInvocError                          * 00040400
*                                                                     * 00040500
*                 Meaning: Invalid invocation environment or          * 00040600
*                 parameters.                                         * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                 HEX REASON  MEANING/ACTION                          * 00041000
*                 CODE                                                * 00041100
*                                                                     * 00041200
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00041300
*                                                                     * 00041400
*                             Meaning:  Monitoring environment does   * 00041500
*                             not pass short form verification.       * 00041600
*                                                                     * 00041700
*                             Action: Check for possible storage      * 00041800
*                             overlay.                                * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*01* REASON CODES:                                                    * 00042500
*                                                                     * 00042600
*       A unique reason code will be returned whenever the return     * 00042700
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00042800
*       under their corresponding return code.  Reason code and       * 00042900
*       return code constants are defined within IWMYCON.  Note that  * 00043000
*       the high order halfword of register 0, and the reason code    * 00043100
*       variable when specified, may be non-zero and represents       * 00043200
*       diagnostic data which is NOT part of the external interface.  * 00043300
*       The high order halfword should thus be excluded from          * 00043400
*       comparison with the reason code values described above.  The  * 00043500
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00043600
*       used for this purpose.                                        * 00043700
*                                                                     * 00043800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00043900
*                                                                     * 00044000
*02*   PROCESSOR:  ASSEM                                              * 00044100
*                                                                     * 00044200
*01* COMPONENT:  SCWLM                                                * 00044300
*                                                                     * 00044400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00044500
*                                                                     * 00044600
*01* EXAMPLES:                                                        * 00044700
*                                                                     * 00044800
*01* MACRO USAGE NOTES:                                               * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00045200
*        global macro variable.  Any value other than 'NO' will       * 00045300
*        result in the macro expansion being printed.  The default is * 00045400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00045500
*        variable should be set.                                      * 00045600
*                                                                     * 00045700
*                    GBLC &ZPRINT                                     * 00045800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*01* CHANGE ACTIVITY:                                                 * 00046300
*                                                                     * 00046400
*   Flag LineItem  FMID    Date   ID    Comment                       * 00046500
*                                                                     * 00046600
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 00046700
*    $P1=PIG7010  HBB5510 921029 PD16:  Remove check for RSNCODE for  * 00046800
*                                         GPR00F declare              * 00046900
*    $L1=WLMP     HBB6603 950213 PD16:  Dynamic Buffer Pool           * 00047000
*                                         Management                  * 00047100
****** END OF SPECIFICATIONS *****************************************/ 00047200
*/********************************************************************* 00047300
         MACRO                                                          00047400
&XLABEL  IWMMCHST &STATE=,&RESOURCE=,&MONTKN=,&RUNTIME_VER=,&COMPCODE=,*00047500
               &RETCODE=,&RSNCODE=                                      00047600
.*                                                                      00047700
*                   MACDATE -10/01/96-<0>                               00047800
.*                                                                      00047900
.*******************************************************************    00048000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00048100
.*******************************************************************    00048200
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00048300
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00048400
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00048500
.*                                                                      00048600
                   GBLC  &ZIWMMCHST  YES=MACRO USED AT LEAST ONCE       00048700
.*******************************************************************    00048800
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00048900
.*******************************************************************    00049000
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00049100
                   LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS       00049200
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00049300
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00049400
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00049500
                   LCLA  &ZAWRK      USED AS A WORK AREA                00049600
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00049700
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00049800
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00049900
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00050000
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00050100
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00050200
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00050300
.*                                                                      00050400
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00050500
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00050600
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00050700
                   LCLC  &ZENDBASEPL            End of base PL          00050800
.*******************************************************************    00050900
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00051000
.*******************************************************************    00051100
                   LCLC  &XSTATE     ++ VALUE                           00051200
                   LCLC  &XRESOURCE  ++ VALUE                           00051300
                   LCLC  &XMONTKN    ++ NAME                            00051400
                   LCLC  &XRUNTIME_VER          ++ VALUE                00051500
                   LCLC  &XCOMPCODE  ++ VALUE                           00051600
                   LCLC  &XRETCODE   ++ NAME                            00051700
                   LCLC  &XRSNCODE   ++ NAME                            00051800
.*******************************************************************    00051900
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00052000
.*******************************************************************    00052100
                   LCLC  &ZXSTATE    ++ INPUT VALUE                     00052200
                   LCLC  &ZXRESOURCE            ++ INPUT VALUE          00052300
                   LCLC  &ZXMONTKN   ++ INPUT NAME                      00052400
                   LCLC  &ZXRUNTIME_VER         ++ INPUT VALUE          00052500
                   LCLC  &ZXCOMPCODE            ++ INPUT VALUE          00052600
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00052700
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00052800
.********************************************************************   00052900
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00053000
.********************************************************************   00053100
                   ACTR  10000                                          00053200
.*------------------------------------------------------------------    00053300
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053400
&XSTATE            SETC  ''          INITIALIZE XVARIABLE               00053500
.*-------------------------------------------------------------------   00053600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053700
.ZG3               ANOP  ,                                              00053800
                   AIF   (K'&STATE(1) LE 0).ZG3A                        00053900
&ZTLC              SETC 'FREE'                                          00054000
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG4                   00054100
&XSTATE            SETC  'FREE'      SET KEYWORD                        00054200
                   AIF   (N'&STATE LE 1).ZG3A   CK NUM                  00054300
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00054400
&ZMS               SETC  '&ZMS.&STATE"'                                 00054500
&ZMS               SETC  '&ZMS "STATE"'                                 00054600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00054700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00054800
.ZG3A              ANOP  ,                                              00054900
.*------------------------------------------------------------------    00055000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00055100
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00055200
.ZG3A0             AIF   (K'&RESOURCE LE 0).ZG3A1  OK                   00055300
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00055400
.ZG3A1             AIF   (K'&ZCVAL LE 0).ZG3A2  OK                      00055500
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00055600
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00055700
&ZMS               SETC  '&ZMS.=&STATE"'                                00055800
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00055900
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00056000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00056100
.ZG3A2             ANOP  ,                                              00056200
.*-------------------------------------------------------------------   00056300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00056400
.ZG4               ANOP  ,                                              00056500
&ZTLC              SETC 'ACTIVE'                                        00056600
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG5                   00056700
&XSTATE            SETC  'ACTIVE'    SET KEYWORD                        00056800
                   AIF   (N'&STATE LE 1).ZG4A   CK NUM                  00056900
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00057000
&ZMS               SETC  '&ZMS.&STATE"'                                 00057100
&ZMS               SETC  '&ZMS "STATE"'                                 00057200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00057300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00057400
.ZG4A              ANOP  ,                                              00057500
.*------------------------------------------------------------------    00057600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00057700
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00057800
.ZG4A0             AIF   (K'&RESOURCE LE 0).ZG4A1  OK                   00057900
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00058000
.ZG4A1             AIF   (K'&ZCVAL LE 0).ZG4A2  OK                      00058100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00058200
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00058300
&ZMS               SETC  '&ZMS.=&STATE"'                                00058400
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00058500
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00058600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00058700
.ZG4A2             ANOP  ,                                              00058800
.*-------------------------------------------------------------------   00058900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00059000
.ZG5               ANOP  ,                                              00059100
&ZTLC              SETC 'READY'                                         00059200
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG6                   00059300
&XSTATE            SETC  'READY'     SET KEYWORD                        00059400
                   AIF   (N'&STATE LE 1).ZG5A   CK NUM                  00059500
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00059600
&ZMS               SETC  '&ZMS.&STATE"'                                 00059700
&ZMS               SETC  '&ZMS "STATE"'                                 00059800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00059900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00060000
.ZG5A              ANOP  ,                                              00060100
.*------------------------------------------------------------------    00060200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00060300
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00060400
.ZG5A0             AIF   (K'&RESOURCE LE 0).ZG5A1  OK                   00060500
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00060600
.ZG5A1             AIF   (K'&ZCVAL LE 0).ZG5A2  OK                      00060700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00060800
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00060900
&ZMS               SETC  '&ZMS.=&STATE"'                                00061000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00061100
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00061200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00061300
.ZG5A2             ANOP  ,                                              00061400
.*-------------------------------------------------------------------   00061500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00061600
.ZG6               ANOP  ,                                              00061700
&ZTLC              SETC 'IDLE'                                          00061800
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG7                   00061900
&XSTATE            SETC  'IDLE'      SET KEYWORD                        00062000
                   AIF   (N'&STATE LE 1).ZG6A   CK NUM                  00062100
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00062200
&ZMS               SETC  '&ZMS.&STATE"'                                 00062300
&ZMS               SETC  '&ZMS "STATE"'                                 00062400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00062500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00062600
.ZG6A              ANOP  ,                                              00062700
.*------------------------------------------------------------------    00062800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00062900
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00063000
.ZG6A0             AIF   (K'&RESOURCE LE 0).ZG6A1  OK                   00063100
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00063200
.ZG6A1             AIF   (K'&ZCVAL LE 0).ZG6A2  OK                      00063300
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00063400
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00063500
&ZMS               SETC  '&ZMS.=&STATE"'                                00063600
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00063700
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00063800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00063900
.ZG6A2             ANOP  ,                                              00064000
.*-------------------------------------------------------------------   00064100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00064200
.ZG7               ANOP  ,                                              00064300
&ZTLC              SETC 'WAITING'                                       00064400
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG22                  00064500
&XSTATE            SETC  'WAITING'   SET KEYWORD                        00064600
                   AIF   (N'&STATE LE 1).ZG7A   CK NUM                  00064700
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00064800
&ZMS               SETC  '&ZMS.&STATE"'                                 00064900
&ZMS               SETC  '&ZMS "STATE"'                                 00065000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00065100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00065200
.ZG7A              ANOP  ,                                              00065300
.*------------------------------------------------------------------    00065400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00065500
&XRESOURCE         SETC  ''          INITIALIZE XVARIABLE               00065600
.*-------------------------------------------------------------------   00065700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00065800
.ZG10              ANOP  ,                                              00065900
                   AIF   (K'&RESOURCE(1) LE 0).ZG10A                    00066000
&ZTLC              SETC 'LATCH'                                         00066100
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG11               00066200
&XRESOURCE         SETC  'LATCH'     SET KEYWORD                        00066300
                   AIF   (N'&RESOURCE LE 1).ZG10A  CK NUM               00066400
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00066500
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00066600
&ZMS               SETC  '&ZMS "RESOURCE"'                              00066700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00066800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00066900
.ZG10A             ANOP  ,                                              00067000
.*-------------------------------------------------------------------   00067100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067200
.ZG11              ANOP  ,                                              00067300
&ZTLC              SETC 'LOCK'                                          00067400
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG12               00067500
&XRESOURCE         SETC  'LOCK'      SET KEYWORD                        00067600
                   AIF   (N'&RESOURCE LE 1).ZG11A  CK NUM               00067700
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00067800
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00067900
&ZMS               SETC  '&ZMS "RESOURCE"'                              00068000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00068100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00068200
.ZG11A             ANOP  ,                                              00068300
.*-------------------------------------------------------------------   00068400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068500
.ZG12              ANOP  ,                                              00068600
&ZTLC              SETC 'IO'                                            00068700
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG13               00068800
&XRESOURCE         SETC  'IO'        SET KEYWORD                        00068900
                   AIF   (N'&RESOURCE LE 1).ZG12A  CK NUM               00069000
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00069100
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00069200
&ZMS               SETC  '&ZMS "RESOURCE"'                              00069300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00069400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00069500
.ZG12A             ANOP  ,                                              00069600
.*-------------------------------------------------------------------   00069700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00069800
.ZG13              ANOP  ,                                              00069900
&ZTLC              SETC 'CONV'                                          00070000
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG14               00070100
&XRESOURCE         SETC  'CONV'      SET KEYWORD                        00070200
                   AIF   (N'&RESOURCE LE 1).ZG13A  CK NUM               00070300
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00070400
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00070500
&ZMS               SETC  '&ZMS "RESOURCE"'                              00070600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00070700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00070800
.ZG13A             ANOP  ,                                              00070900
.*-------------------------------------------------------------------   00071000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00071100
.ZG14              ANOP  ,                                              00071200
&ZTLC              SETC 'DISTRIB'                                       00071300
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG15               00071400
&XRESOURCE         SETC  'DISTRIB'   SET KEYWORD                        00071500
                   AIF   (N'&RESOURCE LE 1).ZG14A  CK NUM               00071600
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00071700
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00071800
&ZMS               SETC  '&ZMS "RESOURCE"'                              00071900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00072000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00072100
.ZG14A             ANOP  ,                                              00072200
.*-------------------------------------------------------------------   00072300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00072400
.ZG15              ANOP  ,                                              00072500
&ZTLC              SETC 'SESS_LOCALMVS'                                 00072600
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG16               00072700
&XRESOURCE         SETC  'SESS_LOCALMVS'        SET KEYWORD             00072800
                   AIF   (N'&RESOURCE LE 1).ZG15A  CK NUM               00072900
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00073000
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00073100
&ZMS               SETC  '&ZMS "RESOURCE"'                              00073200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00073300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00073400
.ZG15A             ANOP  ,                                              00073500
.*-------------------------------------------------------------------   00073600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00073700
.ZG16              ANOP  ,                                              00073800
&ZTLC              SETC 'SESS_NETWORK'                                  00073900
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG17               00074000
&XRESOURCE         SETC  'SESS_NETWORK'         SET KEYWORD             00074100
                   AIF   (N'&RESOURCE LE 1).ZG16A  CK NUM               00074200
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00074300
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00074400
&ZMS               SETC  '&ZMS "RESOURCE"'                              00074500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00074600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00074700
.ZG16A             ANOP  ,                                              00074800
.*-------------------------------------------------------------------   00074900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075000
.ZG17              ANOP  ,                                              00075100
&ZTLC              SETC 'SESS_SYSPLEX'                                  00075200
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG18               00075300
&XRESOURCE         SETC  'SESS_SYSPLEX'         SET KEYWORD             00075400
                   AIF   (N'&RESOURCE LE 1).ZG17A  CK NUM               00075500
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00075600
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00075700
&ZMS               SETC  '&ZMS "RESOURCE"'                              00075800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00075900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00076000
.ZG17A             ANOP  ,                                              00076100
.*-------------------------------------------------------------------   00076200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076300
.ZG18              ANOP  ,                                              00076400
&ZTLC              SETC 'TIMER'                                         00076500
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG19               00076600
&XRESOURCE         SETC  'TIMER'     SET KEYWORD                        00076700
                   AIF   (N'&RESOURCE LE 1).ZG18A  CK NUM               00076800
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00076900
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00077000
&ZMS               SETC  '&ZMS "RESOURCE"'                              00077100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00077200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00077300
.ZG18A             ANOP  ,                                              00077400
.*-------------------------------------------------------------------   00077500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077600
.ZG19              ANOP  ,                                              00077700
&ZTLC              SETC 'OTHER_PRODUCT'                                 00077800
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG20               00077900
&XRESOURCE         SETC  'OTHER_PRODUCT'        SET KEYWORD             00078000
                   AIF   (N'&RESOURCE LE 1).ZG19A  CK NUM               00078100
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00078200
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00078300
&ZMS               SETC  '&ZMS "RESOURCE"'                              00078400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00078500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00078600
.ZG19A             ANOP  ,                                              00078700
.*-------------------------------------------------------------------   00078800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00078900
.ZG20              ANOP  ,                                              00079000
&ZTLC              SETC 'MISC'                                          00079100
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG21               00079200
&XRESOURCE         SETC  'MISC'      SET KEYWORD                        00079300
                   AIF   (N'&RESOURCE LE 1).ZG20A  CK NUM               00079400
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00079500
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00079600
&ZMS               SETC  '&ZMS "RESOURCE"'                              00079700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00079800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00079900
.ZG20A             ANOP  ,                                              00080000
.*------------------------------------------------------------------    00080100
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00080200
.ZG21              ANOP  ,                                              00080300
&ZXRESOURCE        SETC  'INPUT'     SET IN/OUTPUT                      00080400
                   AIF   (K'&XRESOURCE GT 0).ZG21E  VALID ARG           00080500
                   AIF   (T'&RESOURCE EQ 'O').ZG21D  OMITTED            00080600
&ZASYSLNDX         SETA  0                                              00080700
.ZG21A             ANOP  ,           POSITIONAL MACRO KEY               00080800
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00080900
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C               00081000
&ZTLC              SETC 'RESOURCE'                                      00081100
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG21A      00081200
.ZG21B             ANOP  ,                                              00081300
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    00081400
&ZMS               SETC  'THE "RESOURCE" KEY'   *KOPTA* MNOTE           00081500
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00081600
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00081700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00081800
                   AGO   .ZG21E                                         00081900
.ZG21C             ANOP  ,                                              00082000
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    00082100
&ZMS               SETC  '"RESOURCE='           *KUKWA* MNOTE           00082200
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00082300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00082400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00082500
&ZMS               SETC  '&ZMS "LATCH",'        VALID KEYWORD           00082600
&ZMS               SETC  '&ZMS "LOCK",'         VALID KEYWORD           00082700
&ZMS               SETC  '&ZMS "IO",'           VALID KEYWORD           00082800
&ZMS               SETC  '&ZMS "CONV",'         VALID KEYWORD           00082900
&ZMS               SETC  '&ZMS "DISTRIB",'      VALID KEYWORD           00083000
&ZMS               SETC  '&ZMS "SESS_LOCALMVS",'  VALID KEYWORD         00083100
&ZMS               SETC  '&ZMS "SESS_NETWORK",'  VALID KEYWORD          00083200
&ZMS               SETC  '&ZMS "SESS_SYSPLEX",'  VALID KEYWORD          00083300
&ZMS               SETC  '&ZMS "TIMER",'        VALID KEYWORD           00083400
&ZMS               SETC  '&ZMS "OTHER_PRODUCT",'  VALID KEYWORD         00083500
&ZMS               SETC  '&ZMS OR "MISC".'      VALID KEYWORD           00083600
                   MNOTE 8,' &ZMS '                                     00083700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00083800
                   AGO   .ZG21E                                         00083900
.ZG21D             ANOP  ,                                              00084000
&XRESOURCE         SETC  'LATCH'     SET DEFAULT KEYWORD                00084100
.ZG21E             ANOP  ,                                              00084200
.*------------------------------------------------------------------    00084300
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084400
                   AIF   (K'&RESOURCE(1) GT 0).ZG21F  PARM              00084500
&XRESOURCE         SETC  ''          ENSURE NULL KEYWORD                00084600
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    00084700
&ZMS               SETC  'THE'                                          00084800
&ZMS               SETC  '&ZMS "RESOURCE" KEY AND ITS ARGUMENT'         00084900
&ZMS               SETC  '&ZMS ARE REQUIRED.'                           00085000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00085100
&ZMS               SETC  '&ZMS "LATCH",'        VALID KEYWORD           00085200
&ZMS               SETC  '&ZMS "LOCK",'         VALID KEYWORD           00085300
&ZMS               SETC  '&ZMS "IO",'           VALID KEYWORD           00085400
&ZMS               SETC  '&ZMS "CONV",'         VALID KEYWORD           00085500
&ZMS               SETC  '&ZMS "DISTRIB",'      VALID KEYWORD           00085600
&ZMS               SETC  '&ZMS "SESS_LOCALMVS",'  VALID KEYWORD         00085700
&ZMS               SETC  '&ZMS "SESS_NETWORK",'  VALID KEYWORD          00085800
&ZMS               SETC  '&ZMS "SESS_SYSPLEX",'  VALID KEYWORD          00085900
&ZMS               SETC  '&ZMS "TIMER",'        VALID KEYWORD           00086000
&ZMS               SETC  '&ZMS "OTHER_PRODUCT",'  VALID KEYWORD         00086100
&ZMS               SETC  '&ZMS OR "MISC".'      VALID KEYWORD           00086200
                   MNOTE 8,' &ZMS '                                     00086300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00086400
.ZG21F             ANOP  ,                                              00086500
.*------------------------------------------------------------------    00086600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00086700
.ZG22              ANOP  ,                                              00086800
&ZXSTATE           SETC  'INPUT'     SET IN/OUTPUT                      00086900
                   AIF   (K'&XSTATE GT 0).ZG22E  VALID ARG              00087000
                   AIF   (T'&STATE EQ 'O').ZG22D  OMITTED               00087100
&ZASYSLNDX         SETA  0                                              00087200
.ZG22A             ANOP  ,           POSITIONAL MACRO KEY               00087300
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00087400
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG22C               00087500
&ZTLC              SETC 'STATE'                                         00087600
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG22A      00087700
.ZG22B             ANOP  ,                                              00087800
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    00087900
&ZMS               SETC  'THE "STATE" KEY'      *KOPTA* MNOTE           00088000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00088100
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00088200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00088300
                   AGO   .ZG22E                                         00088400
.ZG22C             ANOP  ,                                              00088500
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    00088600
&ZMS               SETC  '"STATE='   *KUKWA* MNOTE                      00088700
&ZMS               SETC  '&ZMS.&STATE"'                                 00088800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00088900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00089000
&ZMS               SETC  '&ZMS "FREE",'         VALID KEYWORD           00089100
&ZMS               SETC  '&ZMS "ACTIVE",'       VALID KEYWORD           00089200
&ZMS               SETC  '&ZMS "READY",'        VALID KEYWORD           00089300
&ZMS               SETC  '&ZMS "IDLE",'         VALID KEYWORD           00089400
&ZMS               SETC  '&ZMS OR "WAITING".'   VALID KEYWORD           00089500
                   MNOTE 8,' &ZMS '                                     00089600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00089700
                   AGO   .ZG22E                                         00089800
.ZG22D             ANOP  ,                                              00089900
&XSTATE            SETC  'FREE'      SET DEFAULT KEYWORD                00090000
.ZG22E             ANOP  ,                                              00090100
.*------------------------------------------------------------------    00090200
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090300
                   AIF   (K'&STATE(1) GT 0).ZG22F  PARM                 00090400
&XSTATE            SETC  ''          ENSURE NULL KEYWORD                00090500
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    00090600
&ZMS               SETC  'THE'                                          00090700
&ZMS               SETC  '&ZMS "STATE" KEY AND ITS ARGUMENT'            00090800
&ZMS               SETC  '&ZMS ARE REQUIRED.'                           00090900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00091000
&ZMS               SETC  '&ZMS "FREE",'         VALID KEYWORD           00091100
&ZMS               SETC  '&ZMS "ACTIVE",'       VALID KEYWORD           00091200
&ZMS               SETC  '&ZMS "READY",'        VALID KEYWORD           00091300
&ZMS               SETC  '&ZMS "IDLE",'         VALID KEYWORD           00091400
&ZMS               SETC  '&ZMS OR "WAITING".'   VALID KEYWORD           00091500
                   MNOTE 8,' &ZMS '                                     00091600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00091700
.ZG22F             ANOP  ,                                              00091800
.*----------------------------------------------------------------***   00091900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00092000
                   AIF   (N'&MONTKN LE 1).ZG24A  CK NUM                 00092100
&ZMS               SETC  '"MONTKN='  *KPOSA* MNOTE                      00092200
&ZMS               SETC  '&ZMS.&MONTKN"'                                00092300
&ZMS               SETC  '&ZMS "MONTKN"'                                00092400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00092500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00092600
.ZG24A             ANOP  ,                                              00092700
.*-------------------------------------------------------------------   00092800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00092900
&ZXMONTKN          SETC  'INPUT'     SET IN/OUTPUT                      00093000
&XMONTKN           SETC  '&MONTKN(1)'           SET XVARIABLE           00093100
                   AIF   (N'&MONTKN GT 1).ZG24B  MULTI PARMS            00093200
&XMONTKN           SETC  '&MONTKN'   SET XVARIABLE                      00093300
.ZG24B             AIF   (K'&MONTKN(1) GT 0).ZG24C                      00093400
&ZXMONTKN          SETC  ''          RESET IN/OUTPUT                    00093500
&ZMS               SETC  ' '         *KRQDA*                            00093600
&ZMS               SETC  '&ZMS "MONTKN" KEY AND ITS ARGUMENT'           00093700
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        00093800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00093900
.ZG24C             ANOP  ,                                              00094000
.*-------------------------------------------------------------------   00094100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00094200
                   AIF   (K'&ZXMONTKN LE 0).ZG24R  NOT I/O              00094300
                   AIF   ('&XMONTKN'(1,1) NE '(').ZG24R                 00094400
&ZCGPR             SETC  '&XMONTKN'(2,K'&XMONTKN-2)                     00094500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                   00094600
                   AIF   (K'&ZCGPR GT 2).ZG24Q                          00094700
                   AIF   ('&ZCGPR' EQ '0').ZG24Q                        00094800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00094900
                   AIF   (T'&ZCGPR NE 'N').ZG24Q  INVALID REG NAME      00095000
.ZG24P             ANOP  ,                                              00095100
                   AIF   (T'&ZCGPR NE 'N').ZG24R  NON NUMERIC           00095200
                   AIF   ('&ZCGPR' LT '2').ZG24Q                        00095300
                   AIF   ('&ZCGPR' LE '12').ZG24R                       00095400
.ZG24Q             ANOP  ,                                              00095500
&ZMS               SETC  '"MONTKN='  *KGPRA* MNOTE                      00095600
&ZMS               SETC  '&ZMS.&MONTKN"'                                00095700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00095800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00095900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00096000
.ZG24R             ANOP  ,                                              00096100
.*------------------------------------------------------------------    00096200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096300
&XRUNTIME_VER      SETC  ''          INITIALIZE XVARIABLE               00096400
.*-------------------------------------------------------------------   00096500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096600
.ZG28              ANOP  ,                                              00096700
                   AIF   (K'&RUNTIME_VER(1) LE 0).ZG28A                 00096800
&ZTLC              SETC 'SHORT_FORM'                                    00096900
                   AIF   ('&RUNTIME_VER(1)' NE '&ZTLC').ZG29            00097000
&XRUNTIME_VER      SETC  'SHORT_FORM'           SET KEYWORD             00097100
                   AIF   (N'&RUNTIME_VER LE 1).ZG28A  CK NUM            00097200
&ZMS               SETC  '"RUNTIME_VER='        *KPOSA* MNOTE           00097300
&ZMS               SETC  '&ZMS.&RUNTIME_VER"'                           00097400
&ZMS               SETC  '&ZMS "RUNTIME_VER"'                           00097500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00097600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00097700
.ZG28A             ANOP  ,                                              00097800
.*-------------------------------------------------------------------   00097900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098000
.ZG29              ANOP  ,                                              00098100
&ZTLC              SETC 'MINIMAL'                                       00098200
                   AIF   ('&RUNTIME_VER(1)' NE '&ZTLC').ZG30            00098300
&XRUNTIME_VER      SETC  'MINIMAL'   SET KEYWORD                        00098400
                   AIF   (N'&RUNTIME_VER LE 1).ZG29A  CK NUM            00098500
&ZMS               SETC  '"RUNTIME_VER='        *KPOSA* MNOTE           00098600
&ZMS               SETC  '&ZMS.&RUNTIME_VER"'                           00098700
&ZMS               SETC  '&ZMS "RUNTIME_VER"'                           00098800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00098900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00099000
.ZG29A             ANOP  ,                                              00099100
.*------------------------------------------------------------------    00099200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099300
.ZG30              ANOP  ,                                              00099400
&ZXRUNTIME_VER     SETC  'INPUT'     SET IN/OUTPUT                      00099500
                   AIF   (K'&XRUNTIME_VER GT 0).ZG30E  VALID ARG        00099600
                   AIF   (T'&RUNTIME_VER EQ 'O').ZG30D  OMITTED         00099700
&ZASYSLNDX         SETA  0                                              00099800
.ZG30A             ANOP  ,           POSITIONAL MACRO KEY               00099900
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00100000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C               00100100
&ZTLC              SETC 'RUNTIME_VER'                                   00100200
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG30A      00100300
.ZG30B             ANOP  ,                                              00100400
&ZXRUNTIME_VER     SETC  ''          RESET IN/OUTPUT                    00100500
&ZMS               SETC  'THE "RUNTIME_VER" KEY'  *KOPTA* MNOTE         00100600
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00100700
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00100800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00100900
                   AGO   .ZG30E                                         00101000
.ZG30C             ANOP  ,                                              00101100
&ZXRUNTIME_VER     SETC  ''          RESET IN/OUTPUT                    00101200
&ZMS               SETC  '"RUNTIME_VER='        *KUKWA* MNOTE           00101300
&ZMS               SETC  '&ZMS.&RUNTIME_VER"'                           00101400
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00101500
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00101600
&ZMS               SETC  '&ZMS "SHORT_FORM"'    VALID KEYWORD           00101700
&ZMS               SETC  '&ZMS OR "MINIMAL".'   VALID KEYWORD           00101800
                   MNOTE 8,' &ZMS '                                     00101900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00102000
                   AGO   .ZG30E                                         00102100
.ZG30D             ANOP  ,                                              00102200
&XRUNTIME_VER      SETC  'SHORT_FORM'           SET DEFAULT KEYWORD     00102300
.ZG30E             ANOP  ,                                              00102400
.*------------------------------------------------------------------    00102500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102600
&XCOMPCODE         SETC  ''          INITIALIZE XVARIABLE               00102700
.*-------------------------------------------------------------------   00102800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102900
.ZG33              ANOP  ,                                              00103000
                   AIF   (K'&COMPCODE(1) LE 0).ZG33A                    00103100
&ZTLC              SETC 'YES'                                           00103200
                   AIF   ('&COMPCODE(1)' NE '&ZTLC').ZG34               00103300
&XCOMPCODE         SETC  'YES'       SET KEYWORD                        00103400
                   AIF   (N'&COMPCODE LE 1).ZG33A  CK NUM               00103500
&ZMS               SETC  '"COMPCODE='           *KPOSA* MNOTE           00103600
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00103700
&ZMS               SETC  '&ZMS "COMPCODE"'                              00103800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00103900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00104000
.ZG33A             ANOP  ,                                              00104100
.*-------------------------------------------------------------------   00104200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104300
.ZG34              ANOP  ,                                              00104400
&ZTLC              SETC 'NO'                                            00104500
                   AIF   ('&COMPCODE(1)' NE '&ZTLC').ZG35               00104600
&XCOMPCODE         SETC  'NO'        SET KEYWORD                        00104700
                   AIF   (N'&COMPCODE LE 1).ZG34A  CK NUM               00104800
&ZMS               SETC  '"COMPCODE='           *KPOSA* MNOTE           00104900
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00105000
&ZMS               SETC  '&ZMS "COMPCODE"'                              00105100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00105200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00105300
.ZG34A             ANOP  ,                                              00105400
.*------------------------------------------------------------------    00105500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105600
.ZG35              ANOP  ,                                              00105700
&ZXCOMPCODE        SETC  'INPUT'     SET IN/OUTPUT                      00105800
                   AIF   (K'&XCOMPCODE GT 0).ZG35E  VALID ARG           00105900
                   AIF   (T'&COMPCODE EQ 'O').ZG35D  OMITTED            00106000
&ZASYSLNDX         SETA  0                                              00106100
.ZG35A             ANOP  ,           POSITIONAL MACRO KEY               00106200
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00106300
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG35C               00106400
&ZTLC              SETC 'COMPCODE'                                      00106500
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG35A      00106600
.ZG35B             ANOP  ,                                              00106700
&ZXCOMPCODE        SETC  ''          RESET IN/OUTPUT                    00106800
&ZMS               SETC  'THE "COMPCODE" KEY'   *KOPTA* MNOTE           00106900
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00107000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00107100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00107200
                   AGO   .ZG35E                                         00107300
.ZG35C             ANOP  ,                                              00107400
&ZXCOMPCODE        SETC  ''          RESET IN/OUTPUT                    00107500
&ZMS               SETC  '"COMPCODE='           *KUKWA* MNOTE           00107600
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00107700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00107800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00107900
&ZMS               SETC  '&ZMS "YES"'           VALID KEYWORD           00108000
&ZMS               SETC  '&ZMS OR "NO".'        VALID KEYWORD           00108100
                   MNOTE 8,' &ZMS '                                     00108200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00108300
                   AGO   .ZG35E                                         00108400
.ZG35D             ANOP  ,                                              00108500
&XCOMPCODE         SETC  'YES'       SET DEFAULT KEYWORD                00108600
.ZG35E             ANOP  ,                                              00108700
.*----------------------------------------------------------------***   00108800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00108900
                   AIF   (N'&RETCODE LE 1).ZG37A  CK NUM                00109000
&ZMS               SETC  '"RETCODE='            *KPOSA* MNOTE           00109100
&ZMS               SETC  '&ZMS.&RETCODE"'                               00109200
&ZMS               SETC  '&ZMS "RETCODE"'                               00109300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00109400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00109500
.ZG37A             ANOP  ,                                              00109600
.*-------------------------------------------------------------------   00109700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00109800
                   AIF   (K'&RETCODE(1) LE 0).ZG37C  NO PARM            00109900
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00110000
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00110100
                   AIF   (N'&RETCODE GT 1).ZG37C                        00110200
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00110300
.ZG37C             ANOP  ,                                              00110400
.*-------------------------------------------------------------------   00110500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00110600
                   AIF   (K'&ZXRETCODE LE 0).ZG37R  NOT I/O             00110700
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG37R                00110800
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00110900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                   00111000
                   AIF   (K'&ZCGPR GT 2).ZG37Q                          00111100
                   AIF   ('&ZCGPR' EQ '0').ZG37Q                        00111200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00111300
                   AIF   (T'&ZCGPR NE 'N').ZG37Q  INVALID REG NAME      00111400
.ZG37P             ANOP  ,                                              00111500
                   AIF   (T'&ZCGPR NE 'N').ZG37R  NON NUMERIC           00111600
                   AIF   ('&ZCGPR' LT '2').ZG37Q                        00111700
                   AIF   ('&ZCGPR' LE '12').ZG37R                       00111800
.ZG37Q             ANOP  ,                                              00111900
&ZMS               SETC  '"RETCODE='            *KGPRA* MNOTE           00112000
&ZMS               SETC  '&ZMS.&RETCODE"'                               00112100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00112200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00112300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00112400
.ZG37R             ANOP  ,                                              00112500
.*----------------------------------------------------------------***   00112600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00112700
                   AIF   (N'&RSNCODE LE 1).ZG40A  CK NUM                00112800
&ZMS               SETC  '"RSNCODE='            *KPOSA* MNOTE           00112900
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00113000
&ZMS               SETC  '&ZMS "RSNCODE"'                               00113100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00113200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00113300
.ZG40A             ANOP  ,                                              00113400
.*-------------------------------------------------------------------   00113500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00113600
                   AIF   (K'&RSNCODE(1) LE 0).ZG40C  NO PARM            00113700
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00113800
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00113900
                   AIF   (N'&RSNCODE GT 1).ZG40C                        00114000
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00114100
.ZG40C             ANOP  ,                                              00114200
.*-------------------------------------------------------------------   00114300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00114400
                   AIF   (K'&ZXRSNCODE LE 0).ZG40R  NOT I/O             00114500
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG40R                00114600
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00114700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                   00114800
                   AIF   (K'&ZCGPR GT 2).ZG40Q                          00114900
                   AIF   ('&ZCGPR' EQ '0').ZG40Q                        00115000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00115100
                   AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME      00115200
.ZG40P             ANOP  ,                                              00115300
                   AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC           00115400
                   AIF   ('&ZCGPR' LT '2').ZG40Q                        00115500
                   AIF   ('&ZCGPR' LE '12').ZG40R                       00115600
.ZG40Q             ANOP  ,                                              00115700
&ZMS               SETC  '"RSNCODE='            *KGPRA* MNOTE           00115800
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00115900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00116000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00116100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00116200
.ZG40R             ANOP  ,                                              00116300
.******************************************************************     00116400
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00116500
.******************************************************************     00116600
                   ACTR  10000                                          00116700
.*----------------------------------------------------------------***   00116800
.***AH.P02 EXTRA POSITIONALS                                            00116900
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00117000
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00117100
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00117200
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00117300
.ZGLISTX1          ANOP  ,                                              00117400
&ZCVAL             SETC  ''          ERROR FIELD                        00117500
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00117600
.ZGLIST2           ANOP  ,                                              00117700
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00117800
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00117900
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00118000
                   AGO   .ZGLIST2                                       00118100
.*                                                                      00118200
.ZGLIST3           ANOP  ,                                              00118300
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00118400
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE       00118500
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00118600
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00118700
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00118800
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00118900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00119000
.ZGLISTX           ANOP  ,                                              00119100
&ZASYSLNDX         SETA  0                                              00119200
.*******************************************************************    00119300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00119400
.*******************************************************************    00119500
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00119600
.*******************************************************************    00119700
.***AE.01  START OF IWMMCHST MACRO CODE                                 00119800
.*******************************************************************    00119900
                   LCLC  &M0M0001                 NAME                  00120000
&M0M0001           SETC  '&XLABEL'                SET NAME              00120100
                   AIF   (K'&XLABEL NE 0).XLAB2                         00120200
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00120300
.*                                                                      00120400
.XLAB2             ANOP  ,                                              00120500
&M0M0001 DS    0H                             IWMMCHST-0                00120600
.*******************************************************************    00120700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00120800
.*******************************************************************    00120900
              PUSH  PRINT                                               00121000
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00121100
                   PRINT OFF         ++ PR01                            00121200
                   AGO   .ZPRNTXX                                       00121300
.ZPRINTX           PRINT ON                                             00121400
.ZPRNTXX           ANOP  ,                                              00121500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00121600
         LCLC  &T1,&T2                                                  00121700
         AIF   ('&XCOMPCODE' EQ 'YES').INLINE                           00121800
         AIF   ('&XRETCODE' EQ '').RSNCODECHK                           00121900
&T1      SETC  'RETCODE, RSNCODE MAY NOT BE USED WITH COMPCODE(NO)'     00122000
         MNOTE 8,'&T1'                                                  00122100
         MEXIT                                                          00122200
.RSNCODECHK ANOP                                                        00122300
         AIF   ('&XRSNCODE' EQ '').INLINE                               00122400
&T1      SETC  'RETCODE, RSNCODE MAY NOT BE USED WITH COMPCODE(NO)'     00122500
         MNOTE 8,'&T1'                                                  00122600
         MEXIT                                                          00122700
.*                                                                      00122800
.INLINE  ANOP                                                           00122900
&T1      SETC  '&MONTKN'                                                00123000
         AIF   ('&MONTKN'(1,1) NE '(').MONTKNRS                         00123100
&T1      SETC  '&MONTKN'(2,K'&MONTKN-2)                                 00123200
&T1      SETC  '0(&T1.)'                                                00123300
.MONTKNRS  ANOP                                                         00123400
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                      00123500
         ICM   14,15,&T1               FETCH MONITORING TOKEN           00123600
.* GENERATE CODE WHICH DEPENDS ON HOW COMPCODE WAS SPECIFIED            00123700
         AIF   ('&XCOMPCODE' NE 'YES').NOCOMPCODE1                      00123800
         BNZ   MONENV&SYSNDX           BRANCH WHEN MON ENV IS PRESENT   00123900
         LA    0,IWMRSNCODENOMONENV    SET REASON CODE = NO MON ENV     00124000
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00124100
         B     END&SYSNDX              BRANCH TO END LABEL              00124200
MONENV&SYSNDX DS    0H                 BRANCH LABEL FOR MON ENV PRESENT 00124300
         AIF   ('&XRUNTIME_VER' EQ 'MINIMAL').ENDCOMPCODE1              00124400
         CLC   PB_ID-PB(4,14),=CL4'PB  '                                00124500
         BE    MONENVOK&SYSNDX         BRANCH WHEN MON ENV PASSES       00124600
         LA    0,IWMRSNCODEBADMONENV   SET REASON CODE = BAD MON ENV    00124700
         LA    15,IWMRETCODEINVOCERROR SET INVOCATION ERROR RETURN CODE 00124800
         B     END&SYSNDX              BRANCH TO END LABEL              00124900
MONENVOK&SYSNDX DS    0H               BRANCH LABEL FOR MON ENV OK      00125000
                AGO .ENDCOMPCODE1                                       00125100
.* NOW GENERATE CODE WHEN COMPCODE(NO) WAS SPECIFIED                    00125200
.NOCOMPCODE1    ANOP                                                    00125300
         BZ    END&SYSNDX              BRANCH TO END LABEL              00125400
         AIF   ('&XRUNTIME_VER' EQ 'MINIMAL').ENDCOMPCODE1              00125500
         CLC   PB_ID-PB(4,14),=CL4'PB  '                                00125600
         BNE   END&SYSNDX              BRANCH TO END LABEL              00125700
.ENDCOMPCODE1    ANOP                                                   00125800
         USING PB,14                                                    00125900
         AIF   ('&XSTATE' EQ 'WAITING').WAITING                         00126000
         MVI   PB_STATE,PB_STATE_&XSTATE                                00126100
         AGO  .ENDSTATE                                                 00126200
.WAITING       ANOP                                                     00126300
         MVI   PB_STATE,PB_STATE_WAITING_&XRESOURCE                     00126400
.ENDSTATE      ANOP                                                     00126500
         AIF   ('&XCOMPCODE' NE 'YES').NOCOMPCODE2                      00126600
         LA    15,IWMRETCODEOK           SET RETURN CODE = OK           00126700
.NOCOMPCODE2    ANOP                                                    00126800
*                                                                       00126900
         DROP  14                                                       00127000
END&SYSNDX DS    0H                    END LABEL                        00127100
.*******************************************************************    00127200
.***        RETURN CODE PROCESSING                                      00127300
.*******************************************************************    00127400
         AIF   (N'&RETCODE LE 0).IWMMCHST_ENDRC_EXP                     00127500
         AIF   ('&XRETCODE'(1,1) EQ '(').IWMMCHST_RC_REG                00127600
         AIF   ('&XRETCODE' EQ 'GPR15').IWMMCHST_ENDRC_EXP              00127700
         AIF   ('&XRETCODE' EQ 'REG15').IWMMCHST_ENDRC_EXP              00127800
         AIF   ('&XRETCODE' EQ 'R15').IWMMCHST_ENDRC_EXP                00127900
         AIF   ('&XRETCODE' EQ '15').IWMMCHST_ENDRC_EXP                 00128000
         ST    15,&XRETCODE                                             00128100
            AGO  .IWMMCHST_ENDRC_EXP                                    00128200
.*                                                                      00128300
.IWMMCHST_RC_REG      ANOP  ,                                           00128400
&T1      SETC  '&XRETCODE'(2,K'&XRETCODE-2)                             00128500
         AIF   ('&T1' EQ 'GPR15').IWMMCHST_ENDRC_EXP                    00128600
         AIF   ('&T1' EQ 'REG15').IWMMCHST_ENDRC_EXP                    00128700
         AIF   ('&T1' EQ 'R15').IWMMCHST_ENDRC_EXP                      00128800
         AIF   ('&T1' EQ '15').IWMMCHST_ENDRC_EXP                       00128900
         LR    &T1,15                                                   00129000
.IWMMCHST_ENDRC_EXP   ANOP  ,                                           00129100
.*******************************************************************    00129200
.***        REASON CODE PROCESSING                                      00129300
.*******************************************************************    00129400
         AIF   (N'&RSNCODE LE 0).IWMMCHST_ENDRSN_EXP                    00129500
         AIF   ('&XRSNCODE'(1,1) EQ '(').IWMMCHST_RSN_REG               00129600
         AIF   ('&XRSNCODE' EQ 'GPR0').IWMMCHST_ENDRSN_EXP              00129700
         AIF   ('&XRSNCODE' EQ 'GPR00').IWMMCHST_ENDRSN_EXP             00129800
         AIF   ('&XRSNCODE' EQ 'REG0').IWMMCHST_ENDRSN_EXP              00129900
         AIF   ('&XRSNCODE' EQ 'REG00').IWMMCHST_ENDRSN_EXP             00130000
         AIF   ('&XRSNCODE' EQ 'R0').IWMMCHST_ENDRSN_EXP                00130100
         AIF   ('&XRSNCODE' EQ '0').IWMMCHST_ENDRSN_EXP                 00130200
         AIF   ('&XRSNCODE' EQ '00').IWMMCHST_ENDRSN_EXP                00130300
         ST    0,&XRSNCODE                                              00130400
         AGO   .IWMMCHST_ENDRSN_EXP                                     00130500
.*                                                                      00130600
.IWMMCHST_RSN_REG     ANOP  ,                                           00130700
&T1      SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                             00130800
         AIF   ('&ZCGPR' EQ 'GPR0').IWMMCHST_ENDRSN_EXP                 00130900
         AIF   ('&ZCGPR' EQ 'GPR00').IWMMCHST_ENDRSN_EXP                00131000
         AIF   ('&ZCGPR' EQ 'REG0').IWMMCHST_ENDRSN_EXP                 00131100
         AIF   ('&ZCGPR' EQ 'REG00').IWMMCHST_ENDRSN_EXP                00131200
         AIF   ('&ZCGPR' EQ 'R0').IWMMCHST_ENDRSN_EXP                   00131300
         AIF   ('&ZCGPR' EQ '0').IWMMCHST_ENDRSN_EXP                    00131400
         AIF   ('&ZCGPR' EQ '00').IWMMCHST_ENDRSN_EXP                   00131500
         LR    &T1,0                                                    00131600
.IWMMCHST_ENDRSN_EXP  ANOP  ,                                           00131700
.*******************************************************************    00131800
&ZIWMMCHST            SETC  'YES'          SET IWMMCHST USED            00131900
         POP   PRINT                                                    00132000
*                                            IWMMCHST END               00132100
         SPACE 1                                                        00132200
         MEXIT                                                          00132300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00132400
.********************************************************************   00132500
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    00132600
.********************************************************************   00132700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00132800
                      LCLA  &ZOPN1         INVOCATION INDEX             00132900
                      LCLC  &ZOPL(4095)    LABEL                        00133000
                      LCLC  &ZOPO(4095)    OPERATION                    00133100
                      LCLC  &ZOPV(4095)    VALUE                        00133200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00133300
.*                                                                      00133400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00133500
.*******************************************************************    00133600
.***AO.X02  RETURN CODE PROCESSING                                      00133700
.*******************************************************************    00133800
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00133900
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00134000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00134100
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00134200
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00134300
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00134400
&ZOPN                 SETA  &ZOPN+1                                     00134500
&ZOPL(&ZOPN)          SETC  ' '                                         00134600
&ZOPO(&ZOPN)          SETC  'ST'                                        00134700
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00134800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00134900
                      AGO   .ZMRETX                                     00135000
.*                                                                      00135100
.ZMRET2               ANOP  ,                                           00135200
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00135300
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00135400
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00135500
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00135600
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00135700
&ZOPN                 SETA  &ZOPN+1                                     00135800
&ZOPL(&ZOPN)          SETC  ' '                                         00135900
&ZOPO(&ZOPN)          SETC  'LR'                                        00136000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00136100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00136200
.ZMRETX               ANOP  ,                                           00136300
.*******************************************************************    00136400
.***AO.X03  REASON CODE PROCESSING                                      00136500
.*******************************************************************    00136600
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00136700
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00136800
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00136900
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00137000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00137100
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00137200
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00137300
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00137400
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00137500
&ZOPN                 SETA  &ZOPN+1                                     00137600
&ZOPL(&ZOPN)          SETC  ' '                                         00137700
&ZOPO(&ZOPN)          SETC  'ST'                                        00137800
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00137900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00138000
                      AGO   .ZMRSNX                                     00138100
.*                                                                      00138200
.ZMRSN2               ANOP  ,                                           00138300
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00138400
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00138500
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00138600
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00138700
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00138800
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00138900
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00139000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00139100
&ZOPN                 SETA  &ZOPN+1                                     00139200
&ZOPL(&ZOPN)          SETC  ' '                                         00139300
&ZOPO(&ZOPN)          SETC  'LR'                                        00139400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00139500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00139600
.ZMRSNX               ANOP  ,                                           00139700
.*******************************************************************    00139800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00139900
.*******************************************************************    00140000
                      ACTR  10000                                       00140100
.*                                                                      00140200
                      LCLA  &ZLC           COLUMN POSITION              00140300
                      LCLA  &ZOPX          LIST TABLE INDEX             00140400
                      LCLC  &ZLL           LABEL                        00140500
                      LCLC  &ZLOP          OPERATION                    00140600
                      LCLC  &ZLV           VALUE                        00140700
                      LCLC  &ZLD           DESCRIPTION                  00140800
.*                                                                      00140900
&ZOPX                 SETA  1                                           00141000
.*******************************************************************    00141100
.***AP.X01  FORMAT GENERATED CODE                                       00141200
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00141300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00141400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00141500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00141600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00141700
                      AIF   (K'&ZLD LE 0).ZL51                          00141800
&ZLC                  SETA  35             COMMENT COLUMN               00141900
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00142000
&ZLC                  SETA  33             COMMENT COLUMN               00142100
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00142200
&ZLV                  SETC  '&ZLV'.' '                                  00142300
                      AGO   .ZL31                                       00142400
.*                                                                      00142500
.ZL41                 ANOP  ,                                           00142600
&ZLV                  SETC  '&ZLV'.' '                                  00142700
.ZL51                 ANOP  ,                                           00142800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00142900
.*                                                                      00143000
&ZLL     &ZLOP &ZLV                                                     00143100
.*                                                                      00143200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00143300
                      AGO   .ZL21          CONTINUE LOOPING             00143400
.*                                                                      00143500
.ZLX1                 ANOP  ,                                           00143600
.*******************************************************************    00143700
.***AP.X02  END OF IWMMCHST MACRO                                       00143800
&ZIWMMCHST            SETC  'YES'          SET IWMMCHST USED            00143900
         POP   PRINT                                                    00144000
*                                            IWMMCHST-0                 00144100
         SPACE 1                                                        00144200
.ZLX2                 ANOP  ,                                           00144300
         MEND                                                           00144400
**********************************************************************/ 00144500
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00144600
*%IWMMCHST: MACRO KEYS(STATE,RESOURCE,MONTKN,RUNTIME_VER,COMPCODE,      00144700
*                 RETCODE,RSNCODE);                                     00144800
*  ANS('?'||MACLABEL||' '||'IWMMCHSP '||MACLIST||                       00144900
*         ' '||MACKEYS||';') COL(MACLMAR);                              00145000
*%END IWMMCHST;                                                         00145100
