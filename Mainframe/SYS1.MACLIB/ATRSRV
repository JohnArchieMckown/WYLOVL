*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  ATRSRV                                -98/11/20-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Manipulate Units of Recovery                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5647-A01 (C) COPYRIGHT IBM CORP. 1997, 1999                     * 00001300
*                                                                     * 00001400
* STATUS= HBB6608                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      DESCRIPTION                                                    * 00002200
*                                                                     * 00002300
*      The ATRSRV macro allows authorized callers to:                 * 00002400
*                                                                     * 00002500
*                                                                     * 00002600
*      o   Remove a resource manager's interests in a UR.             * 00002700
*                                                                     * 00002800
*      o   Resolve a UR state from IN-DOUBT to IN-COMMIT.             * 00002900
*                                                                     * 00003000
*      o   Resolve a UR state from IN-DOUBT to IN-BACKOUT.            * 00003100
*                                                                     * 00003200
*                                                                     * 00003300
*                                                                     * 00003400
*      URs on other systems in a SYSPLEX and/or in other RRS logging  * 00003500
*      groups can be processed.                                       * 00003600
*                                                                     * 00003700
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003800
*                                                                     * 00003900
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004000
*                                                                     * 00004100
*01* ENVIRONMENT:                                                     * 00004200
*                                                                     * 00004300
*                                                                     * 00004400
*      Dispatchable unit mode: Task mode.                             * 00004500
*                                                                     * 00004600
*      Minimum authorization: Supervisor state.  System PSW key.      * 00004700
*                                                                     * 00004800
*                        If your installation uses the RACF component * 00004900
*                        of the OS/390 Security Server to control     * 00005000
*                        access to RRS/MVS information, ATRSRV        * 00005100
*                        requires ALTER access to the                 * 00005200
*                        MVSADMIN.RRS.COMMANDS resource in the        * 00005300
*                        FACILITY class.  To process URs on other     * 00005400
*                        systems, the ATRSRV requires ALTER access to * 00005500
*                        the MVSADMIN.RRS.COMMANDS.gname.sysname on   * 00005600
*                        the originating system, where gname is the   * 00005700
*                        target RRS logging group name and sysname is * 00005800
*                        the target system name.                      * 00005900
*                                                                     * 00006000
*      AMODE:            31-bit.                                      * 00006100
*                                                                     * 00006200
*      ASC mode:         Primary.                                     * 00006300
*                                                                     * 00006400
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00006500
*                                                                     * 00006600
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006700
*                                                                     * 00006800
*      Locks:            No locks held.                               * 00006900
*                                                                     * 00007000
*      Control parameters: Control parameters must be in the primary  * 00007100
*                        address space.                               * 00007200
*                                                                     * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*01* PROGRAMMING REQUIREMENTS:                                        * 00007600
*                                                                     * 00007700
*    ATRSRV callers must include the following mapping macros:        * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*    o   ATRFZSRV                                                     * 00008100
*                                                                     * 00008200
*    o   CVT                                                          * 00008300
*                                                                     * 00008400
*    o   IHAECVT                                                      * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*01* RESTRICTIONS:                                                    * 00008900
*    None.                                                            * 00009000
*                                                                     * 00009100
*01* INPUT REGISTER INFORMATION:                                      * 00009200
*                                                                     * 00009300
*    Before issuing the ATRSRV macro, the caller does not have to     * 00009400
*    place any information into any register unless using it in       * 00009500
*    register notation for a particular parameter, or using it as a   * 00009600
*    base register.                                                   * 00009700
*                                                                     * 00009800
*01* OUTPUT REGISTER INFORMATION:                                     * 00009900
*                                                                     * 00010000
*    When control returns to the caller, the GPRs contain:            * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*    REGISTER  CONTENTS                                               * 00010400
*                                                                     * 00010500
*    0         Contains the reason code                               * 00010600
*                                                                     * 00010700
*    1-13      Unchanged                                              * 00010800
*                                                                     * 00010900
*    14        Used as a work register by the system.                 * 00011000
*                                                                     * 00011100
*    15        Contains the return code                               * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*    Some callers depend on register contents remaining the same      * 00011600
*    before and after issuing a service.  If the system changes the   * 00011700
*    contents of registers on which the caller depends, the caller    * 00011800
*    must save them before issuing the service, and restore them      * 00011900
*    after the system returns control.                                * 00012000
*                                                                     * 00012100
*01* PERFORMANCE IMPLICATIONS:                                        * 00012200
*                                                                     * 00012300
*    None.                                                            * 00012400
*                                                                     * 00012500
*01* SYNTAX:                                                          * 00012600
*                                                                     * 00012700
*[xlabel]  ATRSRV    REQUEST=REMOVINT                                * 00012800
*                  |    [,RMNAME=xrmname|0]                         * 00012900
*                  |    [,URID=xurid|0]                             * 00013000
*                   ,REQUEST=COMMIT                                  * 00013100
*                  |     ,URID=xurid                                  * 00013200
*                   ,REQUEST=BACKOUT                                 * 00013300
*                        ,URID=xurid                                  * 00013400
*                   [,GNAME=xgname|CURRENT_GNAME]                   * 00013500
*                   [,SYSNAME=xsysname|CURRENT_SYSNAME]             * 00013600
*                   [,RCTABLE=xrctable|0                            * 00013700
*                        ,RCNUM=xrcnum]                               * 00013800
*                   [,RETCODE=xretcode]                               * 00013900
*                   [,RSNCODE=xrsncode]                               * 00014000
*                   [,PLISTVER=xplistver|IMPLIED_VERSION]           * 00014100
*                  [,MF=S]                                           * 00014200
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 00014300
*                  [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]              * 00014400
*                  [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]              * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*      Where:                                                         * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*      [xlabel]                                                       * 00015100
*          is an optional symbol, starting in column 1, that is the   * 00015200
*          name on the ATRSRV macro invocation.  The name must        * 00015300
*          conform to the rules for an ordinary assembler language    * 00015400
*          symbol.                                                    * 00015500
*          DEFAULT: No name.                                          * 00015600
*                                                                     * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*      REQUEST=REMOVINT|COMMIT|BACKOUT                              * 00016100
*          is a required keyword input that specifies the requested   * 00016200
*          function.                                                  * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*          REQUEST=REMOVINT                                           * 00016600
*              Remove a resource manager's interests in a UR.         * 00016700
*                                                                     * 00016800
*              NOTE:  The resource manager must not be currently      * 00016900
*              active with RRS.  That is, the resource manager cannot * 00017000
*              have exits set with RRS.                               * 00017100
*                                                                     * 00017200
*              You can provide:                                       * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*              o   Only the resource manager name                     * 00017600
*                                                                     * 00017700
*                  In this case, the resource manager's interests     * 00017800
*                  will be removed from all URs that the resource     * 00017900
*                  manager has expressed interest in.                 * 00018000
*                                                                     * 00018100
*              o   Only the UR identifier                             * 00018200
*                                                                     * 00018300
*                  In this case, all resource manager interests will  * 00018400
*                  be removed from the specified UR.                  * 00018500
*                                                                     * 00018600
*              o   Both the resource manager name and the UR          * 00018700
*                  identifier                                         * 00018800
*                                                                     * 00018900
*                  In this case, the resource manager's interests     * 00019000
*                  will be removed from the specified UR.             * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*              [RMNAME=xrmname|0]                                   * 00019600
*                  is the name (RS-type), or address in register      * 00019700
*                  (2)-(12), of an optional 32 character input that   * 00019800
*                  contains the resource manager name.                * 00019900
*                                                                     * 00020000
*                  If the resource manager name you provide is a      * 00020100
*                  distributed sync-point resource manager (DSRM),    * 00020200
*                  you cannot remove an interest from any UR with a   * 00020300
*                  state of IN-DOUBT, unless you remove all resource  * 00020400
*                  manager interests from the UR (specify only the UR * 00020500
*                  identifier).                                       * 00020600
*                  DEFAULT: 0                                         * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*              [URID=xurid|0]                                       * 00021200
*                  is the name (RS-type), or address in register      * 00021300
*                  (2)-(12), of an optional 16 character input that   * 00021400
*                  contains the UR identifier                         * 00021500
*                  DEFAULT: 0                                         * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*          REQUEST=COMMIT                                             * 00022000
*              Resolve an IN-DOUBT UR to IN-COMMIT.                   * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*              URID=xurid                                             * 00022400
*                  is the name (RS-type), or address in register      * 00022500
*                  (2)-(12), of a required 16 character input that    * 00022600
*                  contains the UR identifier                         * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*          REQUEST=BACKOUT                                            * 00023100
*              Resolve an IN-DOUBT UR to IN-BACKOUT.                  * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*              URID=xurid                                             * 00023500
*                  is the name (RS-type), or address in register      * 00023600
*                  (2)-(12), of a required 16 character input that    * 00023700
*                  contains the UR identifier                         * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*      [GNAME=xgname|CURRENT_GNAME]                                 * 00024700
*          is the name (RS-type), or address in register (2)-(12), of * 00024800
*          an optional 8 character input that contains the name of    * 00024900
*          the target RRS logging group containing the specified      * 00025000
*          resource manager or URID.  If you specify GNAME, you must  * 00025100
*          also specify SYSNAME.                                      * 00025200
*          DEFAULT: CURRENT_GNAME Current RRS logging group           * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*      [SYSNAME=xsysname|CURRENT_SYSNAME]                           * 00025800
*          is the name (RS-type), or address in register (2)-(12), of * 00025900
*          an optional 8 character input that contains the name of    * 00026000
*          the target system containing the specified resource        * 00026100
*          manager or URID.  If you specify SYSNAME, you must also    * 00026200
*          specify GNAME.                                             * 00026300
*          DEFAULT: CURRENT_SYSNAME Current system's system name      * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*      [RCTABLE=xrctable|0                                          * 00026900
*          is the name (RS-type), or address in register (2)-(12), of * 00027000
*          an optional 4 byte input that contains the address of a    * 00027100
*          char(36) area to contain the return/reason code from the   * 00027200
*          System and Logging Group processing the request.  The area * 00027300
*          consists of up to 1 36-byte entry.  The entry is mapped by * 00027400
*          ATRFZRCA in the ATRFZQRY mapping macro.  The number of     * 00027500
*          entries will be returned in the RCNUM parameter.  The      * 00027600
*          table will only contain valid information if the reason    * 00027700
*          code returned to you is ATRSRV_REMOTE_WARNING or           * 00027800
*          ATRSRV_REMOTE_ERROR.                                       * 00027900
*          DEFAULT: 0 No return code table is desired.                * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*          RCNUM=xrcnum]                                              * 00028300
*              is the name (RS-type), or address in register          * 00028400
*              (2)-(12), of a required fullword output that will      * 00028500
*              contain the number of entries in the RCTABLE area.     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*      [RETCODE=xretcode]                                             * 00029300
*          is the name (RS-type) of an optional fullword output       * 00029400
*          variable, or register (2)-(12), into which the return code * 00029500
*          is to be copied from GPR 15.                               * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*      [RSNCODE=xrsncode]                                             * 00030100
*          is the name (RS-type) of an optional fullword output       * 00030200
*          variable, or register (2)-(12), into which the reason code * 00030300
*          is to be copied from GPR 0.                                * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00030900
*          is an optional byte input decimal value in the "1-2" range * 00031000
*          that specifies the macro version.  PLISTVER is the only    * 00031100
*          key allowed on the list form of MF and determines which    * 00031200
*          parameter list is generated (see Macro USAGE NOTE 2).  The * 00031300
*          macro keys associated with each supported version of the   * 00031400
*          macro are listed in MACRO USAGE NOTE 3.  Note that MAX may * 00031500
*          be specified instead of a number, and the parameter list   * 00031600
*          will be of the largest size currently supported. This size * 00031700
*          may grow from release to release (thus possibly affecting  * 00031800
*          the amount of storage needed by your program).  If your    * 00031900
*          program can tolerate this, IBM recommends that you always  * 00032000
*          specify MAX when creating the list form parameter list as  * 00032100
*          that will ensure that the list form parameter list is      * 00032200
*          always long enough to hold whatever parameters might be    * 00032300
*          specified on the execute form.                             * 00032400
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00032500
*          default is the lowest version which allows all of the      * 00032600
*          parameters specified on the invocation to be processed.    * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*      [MF=S|L|M|E]                                                 * 00033200
*          is an optional keyword input which specifies the macro     * 00033300
*          form.                                                      * 00033400
*          DEFAULT: S                                                 * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*          [MF=S]                                                     * 00033800
*              specifies the standard form of the macro.  The "S"     * 00033900
*              form generates code to put the parameters into an      * 00034000
*              in-line parameter list and invoke the desired service. * 00034100
*              Full checking for required macro keys is done along    * 00034200
*              with supplying defaults for omitted optional           * 00034300
*              parameters.                                            * 00034400
*                                                                     * 00034500
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00034600
*              specifies the list form of the macro.  The "L" form    * 00034700
*              defines an area to be used for the parameter list.     * 00034800
*              Only the PLISTVER key may be specified on the          * 00034900
*              invocation.  All other macro parameters are flagged as * 00035000
*              errors.  If PLISTVER is not specified, the original    * 00035100
*              parameter list definition is used.                     * 00035200
*                                                                     * 00035300
*            ,xmfctrl                                                 * 00035400
*              is a required input.  It is the name of a storage area * 00035500
*              for the parameter list.                                * 00035600
*                                                                     * 00035700
*            ,xmfattr|0D                                            * 00035800
*              is an optional 60 character input string that varies   * 00035900
*              from 1 to 60 characters. Use it to force boundary      * 00036000
*              alignment of the parameter list. Use only 0F or 0D.    * 00036100
*              DEFAULT: 0D which forces the parameter list to a       * 00036200
*              doubleword boundary.                                   * 00036300
*                                                                     * 00036400
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00036500
*              specifies the modify form of the macro.  The "M" form  * 00036600
*              generates code to put the parameters into the          * 00036700
*              parameter list specified by xmfctrl.                   * 00036800
*                                                                     * 00036900
*            ,xmfctrl                                                 * 00037000
*              is a required input.  It is the name (RS-type), or     * 00037100
*              address in register (1)-(12), of a storage area for    * 00037200
*              the parameter list.                                    * 00037300
*                                                                     * 00037400
*            ,COMPLETE|NOCHECK]                                     * 00037500
*              is an optional keyword input which specifies the       * 00037600
*              degree of macro parameter syntax checking.             * 00037700
*              DEFAULT: COMPLETE                                      * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*              COMPLETE                                               * 00038100
*                  Checking for required macro keys is done and       * 00038200
*                  defaults are supplied for omitted optional         * 00038300
*                  parameters.  (See Macro Usage Note 2).             * 00038400
*                                                                     * 00038500
*              NOCHECK                                                * 00038600
*                  Checking for required macro keys is not done nor   * 00038700
*                  are defaults supplied for omitted optional         * 00038800
*                  parameters.                                        * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00039300
*              specifies the execute form of the macro.  The "E" form * 00039400
*              generates code to put the parameters into the          * 00039500
*              parameter list specified by xmfctrl and invoke the     * 00039600
*              desired service.                                       * 00039700
*                                                                     * 00039800
*            ,xmfctrl                                                 * 00039900
*              is a required input.  It is the name (RS-type), or     * 00040000
*              address in register (1)-(12), of a storage area for    * 00040100
*              the parameter list.                                    * 00040200
*                                                                     * 00040300
*            ,COMPLETE|NOCHECK                                      * 00040400
*              is an optional keyword input which specifies the       * 00040500
*              degree of macro parameter syntax checking.             * 00040600
*              DEFAULT: COMPLETE                                      * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*              COMPLETE                                               * 00041000
*                  Checking for required macro keys is done and       * 00041100
*                  defaults are supplied for omitted optional         * 00041200
*                  parameters.  (See Macro Usage Note 2).             * 00041300
*                                                                     * 00041400
*              NOCHECK                                                * 00041500
*                  Checking for required macro keys is not done nor   * 00041600
*                  are defaults supplied for omitted optional         * 00041700
*                  parameters.                                        * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*01* ABEND CODES:  None.                                              * 00042600
*                                                                     * 00042700
*01* RETURN CODES:                                                    * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*            0    ATRSRV_SUCCESS - Request completed successfully.    * 00043100
*                                                                     * 00043200
*            4    ATRSRV_WARNING - Request completed with a warning   * 00043300
*                 condition.                                          * 00043400
*                                                                     * 00043500
*            8    ATRSRV_FAILURE - Request failed.                    * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*01* REASON CODES:                                                    * 00044000
*                                                                     * 00044100
*       REASON    RETURN                                              * 00044200
*       CODE      CODE      DESCRIPTION                               * 00044300
*                                          * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*              1  8         EQUATE SYMBOL: ATRSRV_UR_NOT_IN_DOUBT     * 00044700
*                                                                     * 00044800
*                           MEANING: The UR state is not IN-DOUBT.    * 00044900
*                                                                     * 00045000
*                           ACTION:  Specify the correct UR and retry * 00045100
*                           the request.                              * 00045200
*                                                                     * 00045300
*              2  8         EQUATE SYMBOL: ATRSRV_RM_IS_ACTIVE        * 00045400
*                                                                     * 00045500
*                           MEANING: You specified REMOVINT but named * 00045600
*                           a  resource  manager  that  is  currently * 00045700
*                           active with RRS.                          * 00045800
*                                                                     * 00045900
*                           ACTION:  Verify  that  you  specified the * 00046000
*                           correct resource manager.  You might need * 00046100
*                           to  stop the resource manager, or make it * 00046200
*                           inactive with RRS/MVS.  When the resource * 00046300
*                           manager is inactive, retry the request.   * 00046400
*                                                                     * 00046500
*              3  8         EQUATE SYMBOL: ATRSRV_RRS_NOT_ACTIVE      * 00046600
*                                                                     * 00046700
*                           MEANING:   The   ATRSRV  service  is  not * 00046800
*                           available.  RRS/MVS is not active on this * 00046900
*                           system.                                   * 00047000
*                                                                     * 00047100
*                           ACTION: Retry the request when RRS/MVS is * 00047200
*                           active.                                   * 00047300
*                                                                     * 00047400
*              4  8         EQUATE SYMBOL: ATRSRV_UR_HAS_DSRM         * 00047500
*                                                                     * 00047600
*                           MEANING: You specified REMOVINT and named * 00047700
*                           a distributed sync-point resource manager * 00047800
*                           (DSRM),  but  the  state  of  the  UR you * 00047900
*                           specified is IN-DOUBT.                    * 00048000
*                                                                     * 00048100
*                           ACTION:   Before   you   can  remove  the * 00048200
*                           interest  for the DSRM, the UR state must * 00048300
*                           be   resolved  or  you  must  remove  all * 00048400
*                           resource   manager   interests   for  the * 00048500
*                           IN-DOUBT UR.                              * 00048600
*                                                                     * 00048700
*              5  8         EQUATE SYMBOL: ATRSRV_BAD_REMOVINT_PARM   * 00048800
*                                                                     * 00048900
*                           MEANING:  You  specified REMOVINT but did * 00049000
*                           not specify either RMNAME or URID.        * 00049100
*                                                                     * 00049200
*                           ACTION:   Specify  one  or  both  of  the * 00049300
*                           missing keywords and retry the request.   * 00049400
*                                                                     * 00049500
*              6  8         EQUATE SYMBOL: ATRSRV_URID_NOT_VALID      * 00049600
*                                                                     * 00049700
*                           MEANING:  You  specified  a UR identifier * 00049800
*                           that   is   either   not   valid  or  the * 00049900
*                           associated UR no longer exists.           * 00050000
*                                                                     * 00050100
*                           ACTION:  Verify  that  you  specified the * 00050200
*                           correct  UR  identifer.    If you did not * 00050300
*                           specify  the correct UR identifier, do so * 00050400
*                           and  retry  the  request.    If  you  did * 00050500
*                           specify the correct UR identifier, the UR * 00050600
*                           has completed.  Do not retry the request. * 00050700
*                                                                     * 00050800
*              7  8         EQUATE SYMBOL: ATRSRV_RID_NOT_SUPPORTED   * 00050900
*                                                                     * 00051000
*                           MEANING:  You specified the UR identifier * 00051100
*                           for an In-Doubt UR that the system cannot * 00051200
*                           resolve to In-Commit or In-Backout.       * 00051300
*                                                                     * 00051400
*                           ACTION:  You  must  wait  for the DSRM to * 00051500
*                           resolve the In-Doubt condition.           * 00051600
*                                                                     * 00051700
*              8  8         EQUATE SYMBOL: ATRSRV_URID_NOT_FOUND      * 00051800
*                                                                     * 00051900
*                           MEANING:  You  specified  a UR identifier * 00052000
*                           that  the  system is unable to find.  The * 00052100
*                           UR  may  still exist but RRS is unable to * 00052200
*                           find the UR.                              * 00052300
*                                                                     * 00052400
*                           ACTION:  Verify  that  you  specified the * 00052500
*                           correct  UR  identifer.    If you did not * 00052600
*                           specify  the correct UR identifier, do so * 00052700
*                           and  retry  the  request.    If  you  did * 00052800
*                           specify  the correct UR identifier, retry * 00052900
*                           the request later.                        * 00053000
*                                                                     * 00053100
*              9  8         EQUATE SYMBOL: ATRSRV_NO_UR_FOR_RM        * 00053200
*                                                                     * 00053300
*                           MEANING: You specified URINFO and named a * 00053400
*                           resource  manager  that does not have any * 00053500
*                           interests in any URs.                     * 00053600
*                                                                     * 00053700
*                           ACTION:  Verify  that  you  provided  the * 00053800
*                           correct resource manager.  If you did not * 00053900
*                           specify  the correct resource manager, do * 00054000
*                           so   and  retry  the  request.    If  you * 00054100
*                           expected  URs to be returned, you need to * 00054200
*                           determine  why the named resource manager * 00054300
*                           has  no interests in any URs.  Otherwise, * 00054400
*                           do nothing.                               * 00054500
*                                                                     * 00054600
*             10  8         EQUATE SYMBOL: ATRSRV_NOT_AUTH            * 00054700
*                                                                     * 00054800
*                           MEANING:  You  are  not supervisor state, * 00054900
*                           system  key and the RACF component of the * 00055000
*                           OS/390 Security Server is not active.     * 00055100
*                                                                     * 00055200
*                           ACTION:  Either request activation of the * 00055300
*                           RACF  component  of  the  OS/390 Security * 00055400
*                           Server   and   obtain   ALTER  access  to * 00055500
*                           MVSADMIN.RRS.COMMANDS.gname.sysname    or * 00055600
*                           recode your application to run supervisor * 00055700
*                           state, system key.                        * 00055800
*                                                                     * 00055900
*             11  8         EQUATE SYMBOL: ATRSRV_NOT_SAF_AUTH        * 00056000
*                                                                     * 00056100
*                           MEANING:  You do not have ALTER access to * 00056200
*                           the proper resource for the target system * 00056300
*                           and RRS logging group name.               * 00056400
*                                                                     * 00056500
*                           ACTION:    Obtain    ALTER    access   to * 00056600
*                           MVSADMIN.RRS.COMMANDS.gname.sysname       * 00056700
*                                                                     * 00056800
*             12  8         EQUATE SYMBOL: ATRSRV_RRS_DOWNLEVEL       * 00056900
*                                                                     * 00057000
*                           MEANING:  The  unit  of recovery that was * 00057100
*                           specified to process contains information * 00057200
*                           that  is  not understood by this level of * 00057300
*                           RRS.  This level of RRS is downlevel.     * 00057400
*                                                                     * 00057500
*                           ACTION:  The attempt to process this unit * 00057600
*                           of  recovery  must be made from a version * 00057700
*                           of  RRS  that  can  process  this unit of * 00057800
*                           recovery.                                 * 00057900
*                                                                     * 00058000
*             15  8         EQUATE SYMBOL: ATRSRV_GNAME_INVALID       * 00058100
*                                                                     * 00058200
*                           MEANING:  The  value  specified  for  the * 00058300
*                           GNAME parameter is not valid.             * 00058400
*                                                                     * 00058500
*                           ACTION: Correct the GNAME value and retry * 00058600
*                           the request.                              * 00058700
*                                                                     * 00058800
*             16  8         EQUATE SYMBOL: ATRSRV_SYSNAME_INVALID     * 00058900
*                                                                     * 00059000
*                           MEANING:  The  value  specified  for  the * 00059100
*                           SYSNAME parameter is not valid.           * 00059200
*                                                                     * 00059300
*                           ACTION:  Correct  the  SYSNAME  value and * 00059400
*                           retry the request.                        * 00059500
*                                                                     * 00059600
*             22  8         EQUATE SYMBOL: ATRSRV_INSTANCE_FAILURE    * 00059700
*                                                                     * 00059800
*                           MEANING:  An  error occurred processing a * 00059900
*                           remote request. Your RCTABLE will contain * 00060000
*                           the  failing  service  identifer,  return * 00060100
*                           code and reason code.                     * 00060200
*                                                                     * 00060300
*                           Service identifers:                       * 00060400
*                                                                     * 00060500
*                                                                     * 00060600
*                           o   1 - IXCMSGO macro interface           * 00060700
*                                                                     * 00060800
*                           o   2 - IXCMSGI macro interface           * 00060900
*                                                                     * 00061000
*                                                                     * 00061100
*                           Any  other value is an internal error and * 00061200
*                           should  be  reported  to  the IBM Support * 00061300
*                           center.                                   * 00061400
*                                                                     * 00061500
*                           ACTION:  Fix  the  error(s)  noted in the * 00061600
*                           RCTABLE and retry the request.            * 00061700
*                                                                     * 00061800
*             23  4         EQUATE SYMBOL: ATRSRV_REMOTE_WARNING      * 00061900
*                                                                     * 00062000
*                           MEANING:    An   error   occurred   while * 00062100
*                           processing  a remote request that did not * 00062200
*                           effect  the  processing  of  the request. * 00062300
*                           Your  RCTABLE,  if one was provided, will * 00062400
*                           contain detailed error information.       * 00062500
*                                                                     * 00062600
*                           ACTION:  Fix  the  error(s)  noted in the * 00062700
*                           RCTABLE and retry the request.            * 00062800
*                                                                     * 00062900
*             24  8         EQUATE SYMBOL: ATRSRV_REMOTE_ERROR        * 00063000
*                                                                     * 00063100
*                           MEANING:    An   error   occurred   while * 00063200
*                           processing a remote request.  The request * 00063300
*                           was  not performed.  Your RCTABLE, if one * 00063400
*                           was provided, will contain detailed error * 00063500
*                           information.                              * 00063600
*                                                                     * 00063700
*                           ACTION:  Fix  the  error(s)  noted in the * 00063800
*                           RCTABLE and retry the request.            * 00063900
*                                                                     * 00064000
*             25  8         EQUATE SYMBOL: ATRSRV_RESP_NOT_RECEIVED   * 00064100
*                                                                     * 00064200
*                           MEANING:  Response  not received from the * 00064300
*                           remote   system.     No  information  was * 00064400
*                           returned.                                 * 00064500
*                                                                     * 00064600
*                           ACTION: Retry the request.                * 00064700
*                                                                     * 00064800
*             26  8         EQUATE SYMBOL: ATRSRV_REMOTE_NOT_ACTIVE   * 00064900
*                                                                     * 00065000
*                           MEANING: The remote system is not active. * 00065100
*                           No information was returned.              * 00065200
*                                                                     * 00065300
*                           ACTION: Retry the request once the remote * 00065400
*                           system is available.                      * 00065500
*                                                                     * 00065600
*           4095  8         EQUATE SYMBOL: ATRSRV_UNEXPECTED_ERROR    * 00065700
*                                                                     * 00065800
*                           MEANING:  An  unexpected  error  occurred * 00065900
*                           while processing the request.             * 00066000
*                                                                     * 00066100
*                           ACTION: Contact your system support.      * 00066200
*                                                                     * 00066300
*                                                                     * 00066400
*                                                                     * 00066500
*01* MODULE TYPE:  ASSEM MACRO                                        * 00066600
*                                                                     * 00066700
*02*   PROCESSOR:  ASSEM                                              * 00066800
*                                                                     * 00066900
*01* COMPONENT:  SCRRS                                                * 00067000
*                                                                     * 00067100
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00067200
*                                                                     * 00067300
*01* EXAMPLES:                                                        * 00067400
*    EXAMPLE 1                                                        * 00067500
*                                                                     * 00067600
*    OPERATION: Commit an In-Doubt UR                                 * 00067700
*                                                                     * 00067800
*               ATRSRV   REQUEST=COMMIT,URID=MYURID                   * 00067900
*      *                                                              * 00068000
*      * INPUT VALUES                                                 * 00068100
*      *                                                              * 00068200
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00068300
*      FIER                                                           * 00068400
*      *                                                              * 00068500
*      * REQUIRED MAPPINGS                                            * 00068600
*      *                                                              * 00068700
*               CVT DSECT=YES                                         * 00068800
*               IHAECVT                                               * 00068900
*               ATRFZSRV                                              * 00069000
*                                                                     * 00069100
*    EXAMPLE 2                                                        * 00069200
*                                                                     * 00069300
*    OPERATION: Backout an In-Doubt UR                                * 00069400
*                                                                     * 00069500
*               ATRSRV   REQUEST=COMMIT,URID=MYURID                   * 00069600
*      *                                                              * 00069700
*      * INPUT VALUES                                                 * 00069800
*      *                                                              * 00069900
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00070000
*      FIER                                                           * 00070100
*      *                                                              * 00070200
*      * REQUIRED MAPPINGS                                            * 00070300
*      *                                                              * 00070400
*               CVT DSECT=YES                                         * 00070500
*               IHAECVT                                               * 00070600
*               ATRFZSRV                                              * 00070700
*                                                                     * 00070800
*    EXAMPLE 3                                                        * 00070900
*                                                                     * 00071000
*    OPERATION: Remove all resource manager interests                 * 00071100
*    in a UR                                                          * 00071200
*                                                                     * 00071300
*               ATRSRV   REQUEST=REMOVINT,URID=MYURID                 * 00071400
*      *                                                              * 00071500
*      * INPUT VALUES                                                 * 00071600
*      *                                                              * 00071700
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00071800
*      FIER                                                           * 00071900
*      *                                                              * 00072000
*      * REQUIRED MAPPINGS                                            * 00072100
*      *                                                              * 00072200
*               CVT DSECT=YES                                         * 00072300
*               IHAECVT                                               * 00072400
*               ATRFZSRV                                              * 00072500
*                                                                     * 00072600
*    EXAMPLE 4                                                        * 00072700
*                                                                     * 00072800
*    OPERATION: Remove resource manager UTRICK interests              * 00072900
*    in a UR                                                          * 00073000
*                                                                     * 00073100
*               ATRSRV   REQUEST=REMOVINT,URID=MYURID,RMNAME=MYRM     * 00073200
*      *                                                              * 00073300
*      * INPUT VALUES                                                 * 00073400
*      *                                                              * 00073500
*      MYRM     DC     CL32'UTRICK'             RESOURCE MANAGER NAME * 00073600
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00073700
*      FIER                                                           * 00073800
*      *                                                              * 00073900
*      * REQUIRED MAPPINGS                                            * 00074000
*      *                                                              * 00074100
*               CVT DSECT=YES                                         * 00074200
*               IHAECVT                                               * 00074300
*               ATRFZSRV                                              * 00074400
*                                                                     * 00074500
*    EXAMPLE 5                                                        * 00074600
*                                                                     * 00074700
*    OPERATION: Remove resource manager UTRICK interests              * 00074800
*    in all URs                                                       * 00074900
*                                                                     * 00075000
*               ATRSRV   REQUEST=REMOVINT,RMNAME=MYRM                 * 00075100
*      *                                                              * 00075200
*      * INPUT VALUES                                                 * 00075300
*      *                                                              * 00075400
*      MYRM     DC     CL32'UTRICK'                 RESOURCE MANAGER  * 00075500
*      NAME                                                           * 00075600
*      *                                                              * 00075700
*      * REQUIRED MAPPINGS                                            * 00075800
*      *                                                              * 00075900
*               CVT DSECT=YES                                         * 00076000
*               IHAECVT                                               * 00076100
*               ATRFZSRV                                              * 00076200
*                                                                     * 00076300
*                                                                     * 00076400
*01* MACRO USAGE NOTES:                                               * 00076500
*                                                                     * 00076600
*                                                                     * 00076700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00076800
*        global macro variable.  Any value other than 'NO' will       * 00076900
*        result in the macro expansion being printed.  The default is * 00077000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00077100
*        variable should be set.                                      * 00077200
*                                                                     * 00077300
*                    GBLC &ZPRINT                                     * 00077400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00077500
*                                                                     * 00077600
*                                                                     * 00077700
*    2.  When using the NOCHECK option in conjunction with the Modify * 00077800
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00077900
*        Modify   or  Execute  form  invocation  which  specifies  or * 00078000
*        defaults  to  the  COMPLETE  option.   This insures that the * 00078100
*        parameter  list  is  initialized completely.   The parameter * 00078200
*        list  field which identifies the version number of the macro * 00078300
*        is only set when the Standard form or the Complete option of * 00078400
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00078500
*        explicitly  specified.  Be sure that the resulting parameter * 00078600
*        list version number covers all the keys that you use.        * 00078700
*                                                                     * 00078800
*                                                                     * 00078900
*    3.  The  ATRSRV  macro supports multiple versions. The macro key * 00079000
*        list  below  contains the version level in which the key was * 00079100
*        first  introduced.  Positionals  are  identified by the word * 00079200
*        'Positional'  followed by the numeric value of its position. * 00079300
*        Nested  positionals  are  preceded  by their outer key.  The * 00079400
*        lowest value represents the original version and the highest * 00079500
*        value  represents  the  most  recent  version  of the ATRSRV * 00079600
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00079700
*        least  as high as the highest version number of all the keys * 00079800
*        being used.                                                  * 00079900
*                                                                     * 00080000
*        VERSION   KEY                                                * 00080100
*                                                                     * 00080200
*              1      REQUEST                                         * 00080300
*                     RMNAME                                          * 00080400
*                     URID                                            * 00080500
*              2      GNAME                                           * 00080600
*                     RCNUM                                           * 00080700
*                     RCTABLE                                         * 00080800
*                     SYSNAME                                         * 00080900
*                                                                     * 00081000
*                                                                     * 00081100
*                                                                     * 00081200
*01* CHANGE ACTIVITY:                                                 * 00081300
*                                                                     * 00081400
*   Flag LineItem  FMID    Date   ID    Comment                       * 00081500
*                                                                     * 00081600
*    $L0=RRSCS    HBB6603 960229 PD00EV:  RRS Initial Release         * 00081700
*    $P1=PQC2896  HBB6603 961118 PD00EV:  Fix ASM interface and       * 00081800
*                                         update documentation        * 00081900
*    $L1=RRSSM    HBB6608 981001 PDEV:  RRS Sysplex Systems           * 00082000
*                                         Management                  * 00082100
*    $L2=RRSSM    HBB6608 981101 PDEV:  RRS Sysplex Systems           * 00082200
*                                         Management                  * 00082300
*    $L3=RRSSM    HBB6608 981120 PDEV:  RRS Sysplex Systems           * 00082400
*                                         Management                  * 00082500
*    $P2=PWK0869  HBB6608 990326 PDEV:  Fix reason code documentation * 00082600
****** END OF SPECIFICATIONS *****************************************/ 00082700
*/* TLINE 1 *********************************************************** 00082800
         MACRO                                                          00082900
&XLABEL  ATRSRV &REQUEST=,&RMNAME=,&URID=,&GNAME=,&SYSNAME=,&RCTABLE=, *00083000
               &RCNUM=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=              00083100
.*                                                                      00083200
*              MACDATE -98/11/20-<2>                                    00083300
.*                                                                      00083400
.*******************************************************************    00083500
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00083600
.*******************************************************************    00083700
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00083800
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00083900
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00084000
.*                                                                      00084100
              GBLC  &ZATRSRV    YES=MACRO USED AT LEAST ONCE            00084200
.*******************************************************************    00084300
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00084400
.*******************************************************************    00084500
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00084600
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00084700
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00084800
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00084900
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00085000
              LCLA  &ZAWRK      USED AS A WORK AREA                     00085100
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00085200
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00085300
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00085400
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00085500
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00085600
              LCLA  &ZMACRET    MACRO RETURN CODE                       00085700
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00085800
.*                                                                      00085900
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00086000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00086100
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00086200
              LCLC  &ZENDBASEPL                 End of base PL          00086300
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00086400
.*******************************************************************    00086500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00086600
.*******************************************************************    00086700
              LCLA  &ZI         INDEX FOR ARRAY                         00086800
              LCLA  &ZJ         INDEX FOR PARMS                         00086900
              LCLA  &ZK         INDEX FOR PARSE                         00087000
              LCLA  &ZLO        LOW RANGE VALUE                         00087100
              LCLA  &ZHI        HIGH RANGE VALUE                        00087200
              LCLC  &ZW         WORK AREA FOR PARM                      00087300
.********************************************************************   00087400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00087500
.********************************************************************   00087600
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00087700
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00087800
.*                                                                      00087900
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00088000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00088100
              SPLEVEL  TEST                                             00088200
.ZSYS2        ANOP  ,                                                   00088300
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00088400
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00088500
              SYSSTATE TEST                                             00088600
              AGO   .ZSYS4                                              00088700
.ZSYS3        ANOP  ,                                                   00088800
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00088900
.ZSYS4        ANOP  ,                                                   00089000
.*******************************************************************    00089100
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00089200
.*******************************************************************    00089300
              LCLC  &XREQUEST   ++ VALUE                                00089400
              LCLC  &XRMNAME    ++ NAME                                 00089500
              LCLC  &XURID      ++ NAME                                 00089600
              LCLC  &XGNAME     ++ NAME                                 00089700
              LCLC  &XSYSNAME   ++ NAME                                 00089800
              LCLC  &XRCTABLE   ++ NAME                                 00089900
              LCLC  &XRCNUM     ++ NAME                                 00090000
              LCLC  &XRETCODE   ++ NAME                                 00090100
              LCLC  &XRSNCODE   ++ NAME                                 00090200
              LCLA  &XPLISTVER  ++ VALUE                                00090300
              LCLC  &XMF        ++ VALUE                                00090400
              LCLC  &XMFCTRL    ++ NAME                                 00090500
              LCLC  &XMFATTR    ++ VALUE                                00090600
              LCLC  &XMFSCK     ++ VALUE                                00090700
.*******************************************************************    00090800
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00090900
.*******************************************************************    00091000
              LCLC  &ZXREQUEST  ++ INPUT VALUE                          00091100
              LCLC  &ZXRMNAME   ++ INPUT NAME                           00091200
              LCLC  &ZXURID     ++ INPUT NAME                           00091300
              LCLC  &ZXGNAME    ++ INPUT NAME                           00091400
              LCLC  &ZXSYSNAME  ++ INPUT NAME                           00091500
              LCLC  &ZXRCTABLE  ++ INPUT NAME                           00091600
              LCLC  &ZXRCNUM    ++ OUTPUT NAME                          00091700
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00091800
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00091900
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00092000
              LCLC  &ZXMF       ++ INPUT VALUE                          00092100
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00092200
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00092300
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00092400
.********************************************************************   00092500
.***AC.PLV01  PROCESS PLISTVER                                      *   00092600
.********************************************************************   00092700
&XPLISTVER      SETA  1                                                 00092800
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00092900
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00093000
&XPLISTVER      SETA  2                                                 00093100
.ZPLV0          ANOP  ,                                                 00093200
.*                                                                      00093300
                AIF   ('&GNAME' EQ '').ZPLV1E                           00093400
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00093500
&XPLISTVER      SETA  2                                                 00093600
.ZPLV1E         ANOP  ,                                                 00093700
.*                                                                      00093800
                AIF   ('&SYSNAME' EQ '').ZPLV2E                         00093900
                AIF   (&XPLISTVER GE 2).ZPLV2E                          00094000
&XPLISTVER      SETA  2                                                 00094100
.ZPLV2E         ANOP  ,                                                 00094200
.*                                                                      00094300
                AIF   ('&RCTABLE' EQ '').ZPLV3E                         00094400
                AIF   (&XPLISTVER GE 2).ZPLV3E                          00094500
&XPLISTVER      SETA  2                                                 00094600
.ZPLV3E         ANOP  ,                                                 00094700
.*                                                                      00094800
                AIF   ('&RCNUM' EQ '').ZPLV4E                           00094900
                AIF   (&XPLISTVER GE 2).ZPLV4E                          00095000
&XPLISTVER      SETA  2                                                 00095100
.ZPLV4E         ANOP  ,                                                 00095200
.*                                                                      00095300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00095400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00095500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00095600
.*-------------------------------------------------------------------   00095700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00095800
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00095900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00096000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00096100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00096200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00096300
                AGO   .ZPVCK2                                           00096400
.ZPVCK3         ANOP  ,                                                 00096500
.*-------------------------------------------------------------------   00096600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00096700
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00096800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00096900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00097000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00097100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00097200
                AGO   .ZPVCKE                                           00097300
.ZPVCK2         ANOP  ,                                                 00097400
.*-------------------------------------------------------------------   00097500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00097600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00097700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00097800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00097900
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00098000
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00098100
.ZPVCK6         ANOP  ,                                                 00098200
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00098300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00098400
&ZMS            SETC  '&ZMS THE RANGE IS "1-2"'                         00098500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00098600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00098700
&XPLISTVER      SETA  2                                                 00098800
                AGO   .ZPVCKE                                           00098900
.*-------------------------------------------------------------------   00099000
.ZPVCK4A        ANOP  ,                                                 00099100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00099200
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00099300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00099400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00099500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00099600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00099700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00099800
                AGO   .ZPVCK5                                           00099900
.ZPVCK4         ANOP  ,                                                 00100000
&XPLISTVER      SETA  &PLISTVER(1)                                      00100100
.ZPVCK5         ANOP  ,                                                 00100200
.ZPVCKE         ANOP  ,                                                 00100300
.********************************************************************   00100400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00100500
.********************************************************************   00100600
              ACTR  10000                                               00100700
.*------------------------------------------------------------------    00100800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100900
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00101000
.*-------------------------------------------------------------------   00101100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00101200
.ZG42         ANOP  ,                                                   00101300
&ZTLC         SETC 'S'                                                  00101400
              AIF   ('&MF(1)' NE '&ZTLC').ZG43                          00101500
&XMF          SETC  'S'         SET KEYWORD                             00101600
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00101700
              AIF   (N'&MF LE 1).ZG42A          CK NUM                  00101800
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00101900
&ZMS          SETC  '&ZMS.&MF"'                                         00102000
&ZMS          SETC  '&ZMS "MF"'                                         00102100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00102200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102300
.ZG42A        ANOP  ,                                                   00102400
.*-------------------------------------------------------------------   00102500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102600
.ZG43         ANOP  ,                                                   00102700
&ZTLC         SETC 'L'                                                  00102800
              AIF   ('&MF(1)' NE '&ZTLC').ZG50                          00102900
&XMF          SETC  'L'         SET KEYWORD                             00103000
              AIF   (N'&MF LE 3).ZG43A          CK NUM                  00103100
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00103200
&ZMS          SETC  '&ZMS.&MF"'                                         00103300
&ZMS          SETC  '&ZMS "MF"'                                         00103400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00103500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00103600
.ZG43A        ANOP  ,                                                   00103700
.*-------------------------------------------------------------------   00103800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00103900
              AIF   (N'&SYSLIST NE 0).ZG43B     POSITIONALS?            00104000
              AIF   ('&REQUEST' NE '').ZG43B    KEYS?                   00104100
              AIF   ('&RMNAME' NE '').ZG43B     KEYS?                   00104200
              AIF   ('&URID' NE '').ZG43B       KEYS?                   00104300
              AIF   ('&GNAME' NE '').ZG43B      KEYS?                   00104400
              AIF   ('&SYSNAME' NE '').ZG43B    KEYS?                   00104500
              AIF   ('&RCTABLE' NE '').ZG43B    KEYS?                   00104600
              AIF   ('&RCNUM' NE '').ZG43B      KEYS?                   00104700
              AIF   ('&RETCODE' NE '').ZG43B    KEYS?                   00104800
              AIF   ('&RSNCODE' NE '').ZG43B    KEYS?                   00104900
              AGO    .ZG43C     INVOCATION OKAY                         00105000
.ZG43B        ANOP  ,                                                   00105100
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            00105200
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00105300
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00105400
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00105500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00105600
.ZG43C        ANOP  ,                                                   00105700
.*-------------------------------------------------------------------   00105800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00105900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00106000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00106100
              AIF   (N'&MF(2) GT 1).ZG45B       MULTI PARMS             00106200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00106300
.ZG45B        AIF   (K'&MF(2) GT 0).ZG45C                               00106400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00106500
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00106600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00106700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00106800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00106900
.ZG45C        ANOP  ,                                                   00107000
.*-------------------------------------------------------------------   00107100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00107200
              AIF   (K'&ZXMFCTRL LE 0).ZG45P    NOT I/O                 00107300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG45P                      00107400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00107500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00107600
&ZMS          SETC  '&ZMS.&MF"'                                         00107700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00107800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00107900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00108000
.ZG45P        ANOP  ,                                                   00108100
.*-------------------------------------------------------------------   00108200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00108300
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00108400
&XMFATTR      SETC  '0D'                                                00108500
              AIF   (K'&MF(3) LE 0).ZG48B       PARM                    00108600
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00108700
              AIF   (N'&MF(3) GT 1).ZG48B       MULTI PARMS             00108800
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00108900
.ZG48B        ANOP  ,                                                   00109000
.*-------------------------------------------------------------------   00109100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00109200
              AIF   (K'&ZXMFATTR LE 0).ZG48P    NOT I/O                 00109300
              AIF   ('&XMFATTR'(1,1) NE '(').ZG48P                      00109400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00109500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00109600
&ZMS          SETC  '&ZMS.&MF"'                                         00109700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00109800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00109900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110000
.ZG48P        ANOP  ,                                                   00110100
.*-------------------------------------------------------------------   00110200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00110300
              AIF   (K'&ZXMFATTR LE 0).ZG48S    NOT I/O                 00110400
              AIF   (K'&XMFATTR LE 60).ZG48S    LNG OK                  00110500
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00110600
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00110700
&ZMS          SETC  '&ZMS.&MF"'                                         00110800
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00110900
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00111000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00111100
.ZG48S        ANOP  ,                                                   00111200
.*-------------------------------------------------------------------   00111300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00111400
.ZG50         ANOP  ,                                                   00111500
&ZTLC         SETC 'M'                                                  00111600
              AIF   ('&MF(1)' NE '&ZTLC').ZG59                          00111700
&XMF          SETC  'M'         SET KEYWORD                             00111800
              AIF   (N'&MF LE 3).ZG50A          CK NUM                  00111900
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00112000
&ZMS          SETC  '&ZMS.&MF"'                                         00112100
&ZMS          SETC  '&ZMS "MF"'                                         00112200
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00112300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00112400
.ZG50A        ANOP  ,                                                   00112500
.*-------------------------------------------------------------------   00112600
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00112700
              AIF   ('&RCNUM' NE '').ZG50B      OUTPUT SPECIFIED?       00112800
              AGO    .ZG50C     INVOCATION OKAY                         00112900
.ZG50B        ANOP  ,                                                   00113000
&ZMS          SETC  'THE "M" FORM OF "MF" CANNOT'  *MFMOA* MNOTE        00113100
&ZMS          SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'             00113200
&ZMS          SETC  '&ZMS SPECIFIED ON THE INVOCATION:'                 00113300
&ZMS          SETC  '&ZMS "RCNUM"'                                      00113400
              MNOTE 8,' &ZMS '                                          00113500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00113600
.ZG50C        ANOP  ,                                                   00113700
.*-------------------------------------------------------------------   00113800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00113900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00114000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00114100
              AIF   (N'&MF(2) GT 1).ZG52B       MULTI PARMS             00114200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00114300
.ZG52B        AIF   (K'&MF(2) GT 0).ZG52C                               00114400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00114500
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 00114600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00114700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00114800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114900
.ZG52C        ANOP  ,                                                   00115000
.*-------------------------------------------------------------------   00115100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00115200
              AIF   (K'&ZXMFCTRL LE 0).ZG52R    NOT I/O                 00115300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG52R                      00115400
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00115500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG52P                        00115600
              AIF   (K'&ZCGPR GT 2).ZG52Q                               00115700
              AIF   ('&ZCGPR' EQ '0').ZG52Q                             00115800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00115900
              AIF   (T'&ZCGPR NE 'N').ZG52Q     INVALID REG NAME        00116000
.ZG52P        ANOP  ,                                                   00116100
              AIF   (T'&ZCGPR NE 'N').ZG52R     NON NUMERIC             00116200
              AIF   ('&ZCGPR' LT '1').ZG52Q                             00116300
              AIF   ('&ZCGPR' LE '12').ZG52R                            00116400
.ZG52Q        ANOP  ,                                                   00116500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00116600
&ZMS          SETC  '&ZMS.&MF"'                                         00116700
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00116800
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00116900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00117000
.ZG52R        ANOP  ,                                                   00117100
.*-------------------------------------------------------------------   00117200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117300
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00117400
.ZG56A   AIF   ('&MF(3)' NE 'COMPLETE').ZG57A                           00117500
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00117600
.*-------------------------------------------------------------------   00117700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117800
.ZG57A   AIF   ('&MF(3)' NE 'NOCHECK').ZG58A                            00117900
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00118000
.*-------------------------------------------------------------------   00118100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00118200
.ZG58A        AIF   (K'&XMFSCK GT 0).ZG58C      KEYWORD                 00118300
              AIF   (K'&MF(3) LE 0).ZG58B                               00118400
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00118500
&ZMS          SETC  '&ZMS.&MF"'                                         00118600
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00118700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00118800
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00118900
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00119000
              MNOTE 8,' &ZMS '                                          00119100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119200
.ZG58B        ANOP  ,                                                   00119300
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00119400
.ZG58C        ANOP  ,                                                   00119500
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00119600
.*-------------------------------------------------------------------   00119700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119800
.ZG59         ANOP  ,                                                   00119900
&ZTLC         SETC 'E'                                                  00120000
              AIF   ('&MF(1)' NE '&ZTLC').ZG68                          00120100
&XMF          SETC  'E'         SET KEYWORD                             00120200
              AIF   (N'&MF LE 3).ZG59A          CK NUM                  00120300
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00120400
&ZMS          SETC  '&ZMS.&MF"'                                         00120500
&ZMS          SETC  '&ZMS "MF"'                                         00120600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00120700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00120800
.ZG59A        ANOP  ,                                                   00120900
.*-------------------------------------------------------------------   00121000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00121100
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00121200
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00121300
              AIF   (N'&MF(2) GT 1).ZG61B       MULTI PARMS             00121400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00121500
.ZG61B        AIF   (K'&MF(2) GT 0).ZG61C                               00121600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00121700
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00121800
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00121900
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00122000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122100
.ZG61C        ANOP  ,                                                   00122200
.*-------------------------------------------------------------------   00122300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00122400
              AIF   (K'&ZXMFCTRL LE 0).ZG61R    NOT I/O                 00122500
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG61R                      00122600
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00122700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                        00122800
              AIF   (K'&ZCGPR GT 2).ZG61Q                               00122900
              AIF   ('&ZCGPR' EQ '0').ZG61Q                             00123000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00123100
              AIF   (T'&ZCGPR NE 'N').ZG61Q     INVALID REG NAME        00123200
.ZG61P        ANOP  ,                                                   00123300
              AIF   (T'&ZCGPR NE 'N').ZG61R     NON NUMERIC             00123400
              AIF   ('&ZCGPR' LT '1').ZG61Q                             00123500
              AIF   ('&ZCGPR' LE '12').ZG61R                            00123600
.ZG61Q        ANOP  ,                                                   00123700
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00123800
&ZMS          SETC  '&ZMS.&MF"'                                         00123900
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00124000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00124100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124200
.ZG61R        ANOP  ,                                                   00124300
.*-------------------------------------------------------------------   00124400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00124500
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00124600
.ZG65A   AIF   ('&MF(3)' NE 'COMPLETE').ZG66A                           00124700
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00124800
.*-------------------------------------------------------------------   00124900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00125000
.ZG66A   AIF   ('&MF(3)' NE 'NOCHECK').ZG67A                            00125100
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00125200
.*-------------------------------------------------------------------   00125300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00125400
.ZG67A        AIF   (K'&XMFSCK GT 0).ZG67C      KEYWORD                 00125500
              AIF   (K'&MF(3) LE 0).ZG67B                               00125600
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00125700
&ZMS          SETC  '&ZMS.&MF"'                                         00125800
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00125900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00126000
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00126100
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00126200
              MNOTE 8,' &ZMS '                                          00126300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126400
.ZG67B        ANOP  ,                                                   00126500
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00126600
.ZG67C        ANOP  ,                                                   00126700
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00126800
.*------------------------------------------------------------------    00126900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127000
.ZG68         ANOP  ,                                                   00127100
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00127200
              AIF   (K'&XMF GT 0).ZG68E         VALID ARG               00127300
              AIF   (T'&MF EQ 'O').ZG68D        OMITTED                 00127400
&ZASYSLNDX    SETA  0                                                   00127500
.ZG68A        ANOP  ,           POSITIONAL MACRO KEY                    00127600
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00127700
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG68C                    00127800
&ZTLC         SETC 'MF'                                                 00127900
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG68A           00128000
.ZG68B        ANOP  ,                                                   00128100
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00128200
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00128300
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00128400
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00128500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128600
              AGO   .ZG68E                                              00128700
.ZG68C        ANOP  ,                                                   00128800
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00128900
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00129000
&ZMS          SETC  '&ZMS.&MF"'                                         00129100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00129200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00129300
&ZMS          SETC  '&ZMS "S",'                                         00129400
&ZMS          SETC  '&ZMS "L",'                                         00129500
&ZMS          SETC  '&ZMS "M",'                                         00129600
&ZMS          SETC  '&ZMS OR "E".'                                      00129700
              MNOTE 8,' &ZMS '                                          00129800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00129900
              AGO   .ZG68E                                              00130000
.ZG68D        ANOP  ,                                                   00130100
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00130200
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00130300
.ZG68E        ANOP  ,                                                   00130400
.********************************************************************   00130500
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00130600
.********************************************************************   00130700
              ACTR  10000                                               00130800
.*-------------------------------------------------------------------   00130900
.***AG.MF03 MF=(SLME)                                                   00131000
              AIF   ('&XMF' EQ 'L').ZGMFX                               00131100
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00131200
.*------------------------------------------------------------------    00131300
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00131400
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00131500
.*-------------------------------------------------------------------   00131600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00131700
.ZG3          ANOP  ,                                                   00131800
              AIF   (K'&REQUEST(1) LE 0).ZG3A                           00131900
&ZTLC         SETC 'REMOVINT'                                           00132000
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG10                     00132100
&XREQUEST     SETC  'REMOVINT'  SET KEYWORD                             00132200
              AIF   (N'&REQUEST LE 1).ZG3A      CK NUM                  00132300
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00132400
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00132500
&ZMS          SETC  '&ZMS "REQUEST"'                                    00132600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00132700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00132800
.ZG3A         ANOP  ,                                                   00132900
.*----------------------------------------------------------------***   00133000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00133100
              AIF   (N'&RMNAME LE 1).ZG5A       CK NUM                  00133200
&ZMS          SETC  '"RMNAME='  *KPOSA* MNOTE                           00133300
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00133400
&ZMS          SETC  '&ZMS "RMNAME"'                                     00133500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00133600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133700
.ZG5A         ANOP  ,                                                   00133800
.*-------------------------------------------------------------------   00133900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00134000
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00134100
&XRMNAME      SETC  '0'                                                 00134200
              AIF   (K'&RMNAME(1) LE 0).ZG5B    PARM                    00134300
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00134400
              AIF   (N'&RMNAME GT 1).ZG5B       MULTI PARMS             00134500
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00134600
.ZG5B         ANOP  ,                                                   00134700
.*-------------------------------------------------------------------   00134800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00134900
              AIF   (K'&ZXRMNAME LE 0).ZG5R     NOT I/O                 00135000
              AIF   ('&XRMNAME'(1,1) NE '(').ZG5R                       00135100
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00135200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00135300
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00135400
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00135500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00135600
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00135700
.ZG5P         ANOP  ,                                                   00135800
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00135900
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00136000
              AIF   ('&ZCGPR' LE '12').ZG5R                             00136100
.ZG5Q         ANOP  ,                                                   00136200
&ZMS          SETC  '"RMNAME='  *KGPRA* MNOTE                           00136300
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00136400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00136500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00136600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136700
.ZG5R         ANOP  ,                                                   00136800
.*----------------------------------------------------------------***   00136900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00137000
              AIF   (N'&URID LE 1).ZG8A         CK NUM                  00137100
&ZMS          SETC  '"URID='    *KPOSA* MNOTE                           00137200
&ZMS          SETC  '&ZMS.&URID"'                                       00137300
&ZMS          SETC  '&ZMS "URID"'                                       00137400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00137500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00137600
.ZG8A         ANOP  ,                                                   00137700
.*-------------------------------------------------------------------   00137800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00137900
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00138000
&XURID        SETC  '0'                                                 00138100
              AIF   (K'&URID(1) LE 0).ZG8B      PARM                    00138200
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00138300
              AIF   (N'&URID GT 1).ZG8B         MULTI PARMS             00138400
&XURID        SETC  '&URID'     SET XVARIABLE                           00138500
.ZG8B         ANOP  ,                                                   00138600
.*-------------------------------------------------------------------   00138700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00138800
              AIF   (K'&ZXURID LE 0).ZG8R       NOT I/O                 00138900
              AIF   ('&XURID'(1,1) NE '(').ZG8R                         00139000
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00139100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         00139200
              AIF   (K'&ZCGPR GT 2).ZG8Q                                00139300
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              00139400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00139500
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        00139600
.ZG8P         ANOP  ,                                                   00139700
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             00139800
              AIF   ('&ZCGPR' LT '2').ZG8Q                              00139900
              AIF   ('&ZCGPR' LE '12').ZG8R                             00140000
.ZG8Q         ANOP  ,                                                   00140100
&ZMS          SETC  '"URID='    *KGPRA* MNOTE                           00140200
&ZMS          SETC  '&ZMS.&URID"'                                       00140300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00140400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00140500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140600
.ZG8R         ANOP  ,                                                   00140700
.*-------------------------------------------------------------------   00140800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140900
.ZG10         ANOP  ,                                                   00141000
&ZTLC         SETC 'COMMIT'                                             00141100
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG14                     00141200
&XREQUEST     SETC  'COMMIT'    SET KEYWORD                             00141300
              AIF   (N'&REQUEST LE 1).ZG10A     CK NUM                  00141400
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00141500
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00141600
&ZMS          SETC  '&ZMS "REQUEST"'                                    00141700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00141800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141900
.ZG10A        ANOP  ,                                                   00142000
.*------------------------------------------------------------------    00142100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142200
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00142300
.ZG10A0       AIF   (K'&RMNAME LE 0).ZG10A1     OK                      00142400
&ZCVAL        SETC '&ZCVAL RMNAME'              INCORRECT KEY USED      00142500
.ZG10A1       AIF   (K'&ZCVAL LE 0).ZG10A2      OK                      00142600
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00142700
&ZMS          SETC  '"REQUEST'  *KMEIA* MNOTE                           00142800
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00142900
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00143000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00143100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00143200
.ZG10A2       ANOP  ,                                                   00143300
.*----------------------------------------------------------------***   00143400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00143500
              AIF   (N'&URID LE 1).ZG12A        CK NUM                  00143600
&ZMS          SETC  '"URID='    *KPOSA* MNOTE                           00143700
&ZMS          SETC  '&ZMS.&URID"'                                       00143800
&ZMS          SETC  '&ZMS "URID"'                                       00143900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00144000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00144100
.ZG12A        ANOP  ,                                                   00144200
.*-------------------------------------------------------------------   00144300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00144400
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00144500
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00144600
              AIF   (N'&URID GT 1).ZG12B        MULTI PARMS             00144700
&XURID        SETC  '&URID'     SET XVARIABLE                           00144800
.ZG12B        AIF   (K'&URID(1) GT 0).ZG12C                             00144900
&ZXURID       SETC  ''          RESET IN/OUTPUT                         00145000
&ZMS          SETC  ' '         *KRQDA*                                 00145100
&ZMS          SETC  '&ZMS "URID" KEY AND ITS'                           00145200
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00145300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145400
.ZG12C        ANOP  ,                                                   00145500
.*-------------------------------------------------------------------   00145600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00145700
              AIF   (K'&ZXURID LE 0).ZG12R      NOT I/O                 00145800
              AIF   ('&XURID'(1,1) NE '(').ZG12R                        00145900
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00146000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                        00146100
              AIF   (K'&ZCGPR GT 2).ZG12Q                               00146200
              AIF   ('&ZCGPR' EQ '0').ZG12Q                             00146300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00146400
              AIF   (T'&ZCGPR NE 'N').ZG12Q     INVALID REG NAME        00146500
.ZG12P        ANOP  ,                                                   00146600
              AIF   (T'&ZCGPR NE 'N').ZG12R     NON NUMERIC             00146700
              AIF   ('&ZCGPR' LT '2').ZG12Q                             00146800
              AIF   ('&ZCGPR' LE '12').ZG12R                            00146900
.ZG12Q        ANOP  ,                                                   00147000
&ZMS          SETC  '"URID='    *KGPRA* MNOTE                           00147100
&ZMS          SETC  '&ZMS.&URID"'                                       00147200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00147300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00147400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00147500
.ZG12R        ANOP  ,                                                   00147600
.*-------------------------------------------------------------------   00147700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147800
.ZG14         ANOP  ,                                                   00147900
&ZTLC         SETC 'BACKOUT'                                            00148000
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG18                     00148100
&XREQUEST     SETC  'BACKOUT'   SET KEYWORD                             00148200
              AIF   (N'&REQUEST LE 1).ZG14A     CK NUM                  00148300
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00148400
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00148500
&ZMS          SETC  '&ZMS "REQUEST"'                                    00148600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00148700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148800
.ZG14A        ANOP  ,                                                   00148900
.*------------------------------------------------------------------    00149000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149100
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00149200
.ZG14A0       AIF   (K'&RMNAME LE 0).ZG14A1     OK                      00149300
&ZCVAL        SETC '&ZCVAL RMNAME'              INCORRECT KEY USED      00149400
.ZG14A1       AIF   (K'&ZCVAL LE 0).ZG14A2      OK                      00149500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00149600
&ZMS          SETC  '"REQUEST'  *KMEIA* MNOTE                           00149700
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00149800
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00149900
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00150100
.ZG14A2       ANOP  ,                                                   00150200
.*----------------------------------------------------------------***   00150300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00150400
              AIF   (N'&URID LE 1).ZG16A        CK NUM                  00150500
&ZMS          SETC  '"URID='    *KPOSA* MNOTE                           00150600
&ZMS          SETC  '&ZMS.&URID"'                                       00150700
&ZMS          SETC  '&ZMS "URID"'                                       00150800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00150900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151000
.ZG16A        ANOP  ,                                                   00151100
.*-------------------------------------------------------------------   00151200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00151300
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00151400
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00151500
              AIF   (N'&URID GT 1).ZG16B        MULTI PARMS             00151600
&XURID        SETC  '&URID'     SET XVARIABLE                           00151700
.ZG16B        AIF   (K'&URID(1) GT 0).ZG16C                             00151800
&ZXURID       SETC  ''          RESET IN/OUTPUT                         00151900
&ZMS          SETC  ' '         *KRQDA*                                 00152000
&ZMS          SETC  '&ZMS "URID" KEY AND ITS'                           00152100
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00152200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00152300
.ZG16C        ANOP  ,                                                   00152400
.*-------------------------------------------------------------------   00152500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00152600
              AIF   (K'&ZXURID LE 0).ZG16R      NOT I/O                 00152700
              AIF   ('&XURID'(1,1) NE '(').ZG16R                        00152800
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00152900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        00153000
              AIF   (K'&ZCGPR GT 2).ZG16Q                               00153100
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             00153200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00153300
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        00153400
.ZG16P        ANOP  ,                                                   00153500
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             00153600
              AIF   ('&ZCGPR' LT '2').ZG16Q                             00153700
              AIF   ('&ZCGPR' LE '12').ZG16R                            00153800
.ZG16Q        ANOP  ,                                                   00153900
&ZMS          SETC  '"URID='    *KGPRA* MNOTE                           00154000
&ZMS          SETC  '&ZMS.&URID"'                                       00154100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00154200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00154300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00154400
.ZG16R        ANOP  ,                                                   00154500
.*------------------------------------------------------------------    00154600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00154700
.ZG18         ANOP  ,                                                   00154800
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00154900
              AIF   (K'&XREQUEST GT 0).ZG18E    VALID ARG               00155000
              AIF   (T'&REQUEST EQ 'O').ZG18D   OMITTED                 00155100
&ZASYSLNDX    SETA  0                                                   00155200
.ZG18A        ANOP  ,           POSITIONAL MACRO KEY                    00155300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00155400
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG18C                    00155500
&ZTLC         SETC 'REQUEST'                                            00155600
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG18A           00155700
.ZG18B        ANOP  ,                                                   00155800
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00155900
&ZMS          SETC  'THE "REQUEST" KEY'         *KOPTA* MNOTE           00156000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00156100
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00156200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00156300
              AGO   .ZG18E                                              00156400
.ZG18C        ANOP  ,                                                   00156500
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00156600
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           00156700
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00156800
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00156900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00157000
&ZMS          SETC  '&ZMS "REMOVINT",'                                  00157100
&ZMS          SETC  '&ZMS "COMMIT",'                                    00157200
&ZMS          SETC  '&ZMS OR "BACKOUT".'                                00157300
              MNOTE 8,' &ZMS '                                          00157400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157500
              AGO   .ZG18E                                              00157600
.ZG18D        ANOP  ,                                                   00157700
&XREQUEST     SETC  'REMOVINT'  SET DEFAULT KEYWORD                     00157800
.ZG18E        ANOP  ,                                                   00157900
.*------------------------------------------------------------------    00158000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158100
              AIF   (K'&REQUEST(1) GT 0).ZG18F  PARM                    00158200
&XREQUEST     SETC  ''          ENSURE NULL KEYWORD                     00158300
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00158400
&ZMS          SETC  'THE'                                               00158500
&ZMS          SETC  '&ZMS "REQUEST" KEY AND ITS'                        00158600
&ZMS          SETC  '&ZMS ARGUMENT ARE REQUIRED.'                       00158700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00158800
&ZMS          SETC  '&ZMS "REMOVINT",'                                  00158900
&ZMS          SETC  '&ZMS "COMMIT",'                                    00159000
&ZMS          SETC  '&ZMS OR "BACKOUT".'                                00159100
              MNOTE 8,' &ZMS '                                          00159200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00159300
.ZG18F        ANOP  ,                                                   00159400
.*----------------------------------------------------------------***   00159500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00159600
              AIF   (N'&GNAME LE 1).ZG20A       CK NUM                  00159700
&ZMS          SETC  '"GNAME='   *KPOSA* MNOTE                           00159800
&ZMS          SETC  '&ZMS.&GNAME"'                                      00159900
&ZMS          SETC  '&ZMS "GNAME"'                                      00160000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00160100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00160200
.ZG20A        ANOP  ,                                                   00160300
.*-------------------------------------------------------------------   00160400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00160500
&ZXGNAME      SETC  'INPUT'     SET IN/OUTPUT                           00160600
&XGNAME       SETC  'CURRENT_GNAME'                                     00160700
              AIF   (K'&GNAME(1) LE 0).ZG20B    PARM                    00160800
&XGNAME       SETC  '&GNAME(1)'                 SET XVARIABLE           00160900
              AIF   (N'&GNAME GT 1).ZG20B       MULTI PARMS             00161000
&XGNAME       SETC  '&GNAME'    SET XVARIABLE                           00161100
.ZG20B        ANOP  ,                                                   00161200
.*-------------------------------------------------------------------   00161300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00161400
              AIF   (K'&ZXGNAME LE 0).ZG20R     NOT I/O                 00161500
         AIF   ('&XGNAME' EQ 'CURRENT_GNAME').ZG20R                     00161600
              AIF   ('&XGNAME'(1,1) NE '(').ZG20R                       00161700
&ZCGPR        SETC  '&XGNAME'(2,K'&XGNAME-2)                            00161800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                        00161900
              AIF   (K'&ZCGPR GT 2).ZG20Q                               00162000
              AIF   ('&ZCGPR' EQ '0').ZG20Q                             00162100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00162200
              AIF   (T'&ZCGPR NE 'N').ZG20Q     INVALID REG NAME        00162300
.ZG20P        ANOP  ,                                                   00162400
              AIF   (T'&ZCGPR NE 'N').ZG20R     NON NUMERIC             00162500
              AIF   ('&ZCGPR' LT '2').ZG20Q                             00162600
              AIF   ('&ZCGPR' LE '12').ZG20R                            00162700
.ZG20Q        ANOP  ,                                                   00162800
&ZMS          SETC  '"GNAME='   *KGPRA* MNOTE                           00162900
&ZMS          SETC  '&ZMS.&GNAME"'                                      00163000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00163100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00163200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00163300
.ZG20R        ANOP  ,                                                   00163400
.*----------------------------------------------------------------***   00163500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00163600
              AIF   (N'&SYSNAME LE 1).ZG23A     CK NUM                  00163700
&ZMS          SETC  '"SYSNAME='                 *KPOSA* MNOTE           00163800
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00163900
&ZMS          SETC  '&ZMS "SYSNAME"'                                    00164000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00164100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00164200
.ZG23A        ANOP  ,                                                   00164300
.*-------------------------------------------------------------------   00164400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00164500
&ZXSYSNAME    SETC  'INPUT'     SET IN/OUTPUT                           00164600
&XSYSNAME     SETC  'CURRENT_SYSNAME'                                   00164700
              AIF   (K'&SYSNAME(1) LE 0).ZG23B  PARM                    00164800
&XSYSNAME     SETC  '&SYSNAME(1)'               SET XVARIABLE           00164900
              AIF   (N'&SYSNAME GT 1).ZG23B     MULTI PARMS             00165000
&XSYSNAME     SETC  '&SYSNAME'  SET XVARIABLE                           00165100
.ZG23B        ANOP  ,                                                   00165200
.*-------------------------------------------------------------------   00165300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00165400
              AIF   (K'&ZXSYSNAME LE 0).ZG23R   NOT I/O                 00165500
         AIF   ('&XSYSNAME' EQ 'CURRENT_SYSNAME').ZG23R                 00165600
              AIF   ('&XSYSNAME'(1,1) NE '(').ZG23R                     00165700
&ZCGPR        SETC  '&XSYSNAME'(2,K'&XSYSNAME-2)                        00165800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                        00165900
              AIF   (K'&ZCGPR GT 2).ZG23Q                               00166000
              AIF   ('&ZCGPR' EQ '0').ZG23Q                             00166100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00166200
              AIF   (T'&ZCGPR NE 'N').ZG23Q     INVALID REG NAME        00166300
.ZG23P        ANOP  ,                                                   00166400
              AIF   (T'&ZCGPR NE 'N').ZG23R     NON NUMERIC             00166500
              AIF   ('&ZCGPR' LT '2').ZG23Q                             00166600
              AIF   ('&ZCGPR' LE '12').ZG23R                            00166700
.ZG23Q        ANOP  ,                                                   00166800
&ZMS          SETC  '"SYSNAME='                 *KGPRA* MNOTE           00166900
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00167000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00167100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00167200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00167300
.ZG23R        ANOP  ,                                                   00167400
.*----------------------------------------------------------------***   00167500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00167600
              AIF   (N'&RCTABLE LE 1).ZG26A     CK NUM                  00167700
&ZMS          SETC  '"RCTABLE='                 *KPOSA* MNOTE           00167800
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00167900
&ZMS          SETC  '&ZMS "RCTABLE"'                                    00168000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00168100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00168200
.ZG26A        ANOP  ,                                                   00168300
.*-------------------------------------------------------------------   00168400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00168500
&ZXRCTABLE    SETC  'INPUT'     SET IN/OUTPUT                           00168600
&XRCTABLE     SETC  '0'                                                 00168700
              AIF   (K'&RCTABLE(1) LE 0).ZG26B  PARM                    00168800
&XRCTABLE     SETC  '&RCTABLE(1)'               SET XVARIABLE           00168900
              AIF   (N'&RCTABLE GT 1).ZG26B     MULTI PARMS             00169000
&XRCTABLE     SETC  '&RCTABLE'  SET XVARIABLE                           00169100
.ZG26B        ANOP  ,                                                   00169200
.*-------------------------------------------------------------------   00169300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00169400
              AIF   (K'&ZXRCTABLE LE 0).ZG26R   NOT I/O                 00169500
              AIF   ('&XRCTABLE'(1,1) NE '(').ZG26R                     00169600
&ZCGPR        SETC  '&XRCTABLE'(2,K'&XRCTABLE-2)                        00169700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        00169800
              AIF   (K'&ZCGPR GT 2).ZG26Q                               00169900
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             00170000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00170100
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        00170200
.ZG26P        ANOP  ,                                                   00170300
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             00170400
              AIF   ('&ZCGPR' LT '2').ZG26Q                             00170500
              AIF   ('&ZCGPR' LE '12').ZG26R                            00170600
.ZG26Q        ANOP  ,                                                   00170700
&ZMS          SETC  '"RCTABLE='                 *KGPRA* MNOTE           00170800
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00170900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00171000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00171100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00171200
.ZG26R        ANOP  ,                                                   00171300
.*-------------------------------------------------------------------   00171400
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00171500
              AIF   ('&XMF' EQ 'M').ZG29        BYPASS IF MF=M          00171600
.*----------------------------------------------------------------***   00171700
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00171800
              AIF   (N'&RCNUM LE 1).ZG28A       CK NUM                  00171900
&ZMS          SETC  '"RCNUM='   *KPOSA* MNOTE                           00172000
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00172100
&ZMS          SETC  '&ZMS "RCNUM"'                                      00172200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00172300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172400
.ZG28A        ANOP  ,                                                   00172500
.*-------------------------------------------------------------------   00172600
.***AG.KXVAR10 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00172700
              AIF   (K'&RCTABLE(1) GT 0).ZG28B  KEY                     00172800
              AIF   (K'&RCNUM(1) LE 0).ZG28D    NO PRM                  00172900
&ZMS          SETC  '"RCNUM'    *KDEPA* MNOTE                           00173000
&ZMS          SETC  '&ZMS.=&RCNUM"'                                     00173100
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     00173200
&ZMS          SETC  '&ZMS '                                             00173300
&ZMS          SETC  '&ZMS "RCTABLE"'                                    00173400
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        00173500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00173600
              AGO   .ZG28D                                              00173700
.*                                                                      00173800
.ZG28B        ANOP  ,                                                   00173900
              AIF   (K'&RCNUM(1) LE 0).ZG28C    NO PRM                  00174000
&ZXRCNUM      SETC  'OUTPUT'    SET OUTPUT                              00174100
&XRCNUM       SETC  '&RCNUM(1))'                SET XVARIABLE           00174200
              AIF   (N'&RCNUM GT 1).ZG28C                               00174300
&XRCNUM       SETC  '&RCNUM'    SET XVARIABLE                           00174400
              AGO   .ZG28D                                              00174500
.ZG28C        ANOP  ,                                                   00174600
&ZMS          SETC  'WHEN "RCTABLE" IS SPECIFIED'  *KRQDA*              00174700
&ZMS          SETC  '&ZMS , "RCNUM" KEY AND ITS'                        00174800
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00174900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175000
.ZG28D        ANOP  ,                                                   00175100
.*-------------------------------------------------------------------   00175200
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00175300
              AIF   (K'&ZXRCNUM LE 0).ZG28R     NOT I/O                 00175400
              AIF   ('&XRCNUM'(1,1) NE '(').ZG28R                       00175500
&ZCGPR        SETC  '&XRCNUM'(2,K'&XRCNUM-2)                            00175600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                        00175700
              AIF   (K'&ZCGPR GT 2).ZG28Q                               00175800
              AIF   ('&ZCGPR' EQ '0').ZG28Q                             00175900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00176000
              AIF   (T'&ZCGPR NE 'N').ZG28Q     INVALID REG NAME        00176100
.ZG28P        ANOP  ,                                                   00176200
              AIF   (T'&ZCGPR NE 'N').ZG28R     NON NUMERIC             00176300
              AIF   ('&ZCGPR' LT '2').ZG28Q                             00176400
              AIF   ('&ZCGPR' LE '12').ZG28R                            00176500
.ZG28Q        ANOP  ,                                                   00176600
&ZMS          SETC  '"RCNUM='   *KGPRA* MNOTE                           00176700
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00176800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00176900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00177000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00177100
.ZG28R        ANOP  ,                                                   00177200
.*-------------------------------------------------------------------   00177300
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00177400
.ZG29         ANOP  ,           END OF BYPASS CHECK                     00177500
.*----------------------------------------------------------------***   00177600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00177700
              AIF   (N'&RETCODE LE 1).ZG32A     CK NUM                  00177800
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00177900
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00178000
&ZMS          SETC  '&ZMS "RETCODE"'                                    00178100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00178200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00178300
.ZG32A        ANOP  ,                                                   00178400
.*-------------------------------------------------------------------   00178500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00178600
              AIF   (K'&RETCODE(1) LE 0).ZG32C  NO PARM                 00178700
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00178800
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00178900
              AIF   (N'&RETCODE GT 1).ZG32C                             00179000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00179100
.ZG32C        ANOP  ,                                                   00179200
.*-------------------------------------------------------------------   00179300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00179400
              AIF   (K'&ZXRETCODE LE 0).ZG32R   NOT I/O                 00179500
              AIF   ('&XRETCODE'(1,1) NE '(').ZG32R                     00179600
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00179700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                        00179800
              AIF   (K'&ZCGPR GT 2).ZG32Q                               00179900
              AIF   ('&ZCGPR' EQ '0').ZG32Q                             00180000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00180100
              AIF   (T'&ZCGPR NE 'N').ZG32Q     INVALID REG NAME        00180200
.ZG32P        ANOP  ,                                                   00180300
              AIF   (T'&ZCGPR NE 'N').ZG32R     NON NUMERIC             00180400
              AIF   ('&ZCGPR' LT '2').ZG32Q                             00180500
              AIF   ('&ZCGPR' LE '12').ZG32R                            00180600
.ZG32Q        ANOP  ,                                                   00180700
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00180800
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00180900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00181000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00181100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00181200
.ZG32R        ANOP  ,                                                   00181300
.*----------------------------------------------------------------***   00181400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00181500
              AIF   (N'&RSNCODE LE 1).ZG35A     CK NUM                  00181600
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00181700
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00181800
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00181900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00182000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00182100
.ZG35A        ANOP  ,                                                   00182200
.*-------------------------------------------------------------------   00182300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00182400
              AIF   (K'&RSNCODE(1) LE 0).ZG35C  NO PARM                 00182500
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00182600
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00182700
              AIF   (N'&RSNCODE GT 1).ZG35C                             00182800
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00182900
.ZG35C        ANOP  ,                                                   00183000
.*-------------------------------------------------------------------   00183100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00183200
              AIF   (K'&ZXRSNCODE LE 0).ZG35R   NOT I/O                 00183300
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG35R                     00183400
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00183500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                        00183600
              AIF   (K'&ZCGPR GT 2).ZG35Q                               00183700
              AIF   ('&ZCGPR' EQ '0').ZG35Q                             00183800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00183900
              AIF   (T'&ZCGPR NE 'N').ZG35Q     INVALID REG NAME        00184000
.ZG35P        ANOP  ,                                                   00184100
              AIF   (T'&ZCGPR NE 'N').ZG35R     NON NUMERIC             00184200
              AIF   ('&ZCGPR' LT '2').ZG35Q                             00184300
              AIF   ('&ZCGPR' LE '12').ZG35R                            00184400
.ZG35Q        ANOP  ,                                                   00184500
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00184600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00184700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00184800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00184900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00185000
.ZG35R        ANOP  ,                                                   00185100
.******************************************************************     00185200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00185300
.******************************************************************     00185400
              ACTR  10000                                               00185500
.*----------------------------------------------------------------***   00185600
.***AH.P02 EXTRA POSITIONALS                                            00185700
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00185800
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00185900
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00186000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00186100
.ZGLISTX1     ANOP  ,                                                   00186200
&ZCVAL        SETC  ''          ERROR FIELD                             00186300
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00186400
.ZGLIST2      ANOP  ,                                                   00186500
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00186600
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00186700
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00186800
              AGO   .ZGLIST2                                            00186900
.*                                                                      00187000
.ZGLIST3      ANOP  ,                                                   00187100
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00187200
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00187300
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00187400
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00187500
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00187600
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00187700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00187800
.ZGLISTX      ANOP  ,                                                   00187900
&ZASYSLNDX    SETA  0                                                   00188000
.*-------------------------------------------------------------------   00188100
.***AG.MF04 MF=(SLME)                                                   00188200
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00188300
.********************************************************************   00188400
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00188500
.********************************************************************   00188600
              ACTR  10000                                               00188700
.*-------------------------------------------------------------------   00188800
.***AE.MF01 MF=(SLME)                                                   00188900
              AIF   ('&XMF' EQ 'L').ZEMFX                               00189000
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00189100
.********************************************************************   00189200
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00189300
.********************************************************************   00189400
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00189500
.*-------------------------------------------------------------------   00189600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00189700
&ZTLC         SETC 'REMOVINT'                                           00189800
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A                     00189900
&XREQUEST     SETC  'REMOVINT'  SET KEYWORD                             00190000
              AIF   (N'&REQUEST LE 1).ZE3A      CK NUM                  00190100
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00190200
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00190300
&ZMS          SETC  '&ZMS "REQUEST"'                                    00190400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00190500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00190600
.ZE3A         ANOP  ,                                                   00190700
.*----------------------------------------------------------------***   00190800
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00190900
              AIF   (N'&RMNAME LE 1).ZE5A       CK NUM                  00191000
&ZMS          SETC  '"RMNAME='  *KPOSA* MNOTE                           00191100
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00191200
&ZMS          SETC  '&ZMS "RMNAME"'                                     00191300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00191400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00191500
.ZE5A         ANOP  ,                                                   00191600
.*-------------------------------------------------------------------   00191700
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00191800
              AIF   (K'&RMNAME(1) LE 0).ZE5B    NO PRM                  00191900
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00192000
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00192100
              AIF   (N'&RMNAME GT 1).ZE5B                               00192200
.*            ANOP              MULTIPLE PARMS                          00192300
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00192400
.ZE5B         ANOP  ,                                                   00192500
.*-------------------------------------------------------------------   00192600
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00192700
              AIF   (K'&ZXRMNAME LE 0).ZE5R     NOT I/O                 00192800
              AIF   ('&XRMNAME'(1,1) NE '(').ZE5R                       00192900
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00193000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                         00193100
              AIF   (K'&ZCGPR GT 2).ZE5Q                                00193200
              AIF   ('&ZCGPR' EQ '0').ZE5Q                              00193300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00193400
              AIF   (T'&ZCGPR NE 'N').ZE5Q      INVALID REG NAME        00193500
.ZE5P         ANOP  ,                                                   00193600
              AIF   (T'&ZCGPR NE 'N').ZE5R      NON NUMERIC             00193700
              AIF   ('&ZCGPR' LT '2').ZE5Q                              00193800
              AIF   ('&ZCGPR' LE '12').ZE5R                             00193900
.ZE5Q         ANOP  ,                                                   00194000
&ZMS          SETC  '"RMNAME='  *KGPRA* MNOTE                           00194100
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00194200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00194300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00194400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00194500
.ZE5R         ANOP  ,                                                   00194600
.*----------------------------------------------------------------***   00194700
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00194800
              AIF   (N'&URID LE 1).ZE8A         CK NUM                  00194900
&ZMS          SETC  '"URID='    *KPOSA* MNOTE                           00195000
&ZMS          SETC  '&ZMS.&URID"'                                       00195100
&ZMS          SETC  '&ZMS "URID"'                                       00195200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00195300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00195400
.ZE8A         ANOP  ,                                                   00195500
.*-------------------------------------------------------------------   00195600
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00195700
              AIF   (K'&URID(1) LE 0).ZE8B      NO PRM                  00195800
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00195900
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00196000
              AIF   (N'&URID GT 1).ZE8B                                 00196100
.*            ANOP              MULTIPLE PARMS                          00196200
&XURID        SETC  '&URID'     SET XVARIABLE                           00196300
.ZE8B         ANOP  ,                                                   00196400
.*-------------------------------------------------------------------   00196500
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00196600
              AIF   (K'&ZXURID LE 0).ZE8R       NOT I/O                 00196700
              AIF   ('&XURID'(1,1) NE '(').ZE8R                         00196800
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00196900
              AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                         00197000
              AIF   (K'&ZCGPR GT 2).ZE8Q                                00197100
              AIF   ('&ZCGPR' EQ '0').ZE8Q                              00197200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00197300
              AIF   (T'&ZCGPR NE 'N').ZE8Q      INVALID REG NAME        00197400
.ZE8P         ANOP  ,                                                   00197500
              AIF   (T'&ZCGPR NE 'N').ZE8R      NON NUMERIC             00197600
              AIF   ('&ZCGPR' LT '2').ZE8Q                              00197700
              AIF   ('&ZCGPR' LE '12').ZE8R                             00197800
.ZE8Q         ANOP  ,                                                   00197900
&ZMS          SETC  '"URID='    *KGPRA* MNOTE                           00198000
&ZMS          SETC  '&ZMS.&URID"'                                       00198100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00198200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00198300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00198400
.ZE8R         ANOP  ,                                                   00198500
.*-------------------------------------------------------------------   00198600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00198700
&ZTLC         SETC 'COMMIT'                                             00198800
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE10A                    00198900
&XREQUEST     SETC  'COMMIT'    SET KEYWORD                             00199000
              AIF   (N'&REQUEST LE 1).ZE10A     CK NUM                  00199100
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00199200
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00199300
&ZMS          SETC  '&ZMS "REQUEST"'                                    00199400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00199500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00199600
.ZE10A        ANOP  ,                                                   00199700
.*----------------------------------------------------------------***   00199800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00199900
              AIF   (N'&URID LE 1).ZE12A        CK NUM                  00200000
&ZMS          SETC  '"URID='    *KPOSA* MNOTE                           00200100
&ZMS          SETC  '&ZMS.&URID"'                                       00200200
&ZMS          SETC  '&ZMS "URID"'                                       00200300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00200400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00200500
.ZE12A        ANOP  ,                                                   00200600
.*-------------------------------------------------------------------   00200700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00200800
              AIF   (K'&URID(1) LE 0).ZE12B     NO PRM                  00200900
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00201000
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00201100
              AIF   (N'&URID GT 1).ZE12B                                00201200
.*            ANOP              MULTIPLE PARMS                          00201300
&XURID        SETC  '&URID'     SET XVARIABLE                           00201400
.ZE12B        ANOP  ,                                                   00201500
.*-------------------------------------------------------------------   00201600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00201700
              AIF   (K'&ZXURID LE 0).ZE12R      NOT I/O                 00201800
              AIF   ('&XURID'(1,1) NE '(').ZE12R                        00201900
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00202000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE12P                        00202100
              AIF   (K'&ZCGPR GT 2).ZE12Q                               00202200
              AIF   ('&ZCGPR' EQ '0').ZE12Q                             00202300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00202400
              AIF   (T'&ZCGPR NE 'N').ZE12Q     INVALID REG NAME        00202500
.ZE12P        ANOP  ,                                                   00202600
              AIF   (T'&ZCGPR NE 'N').ZE12R     NON NUMERIC             00202700
              AIF   ('&ZCGPR' LT '2').ZE12Q                             00202800
              AIF   ('&ZCGPR' LE '12').ZE12R                            00202900
.ZE12Q        ANOP  ,                                                   00203000
&ZMS          SETC  '"URID='    *KGPRA* MNOTE                           00203100
&ZMS          SETC  '&ZMS.&URID"'                                       00203200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00203300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00203400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00203500
.ZE12R        ANOP  ,                                                   00203600
.*-------------------------------------------------------------------   00203700
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00203800
&ZTLC         SETC 'BACKOUT'                                            00203900
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE14A                    00204000
&XREQUEST     SETC  'BACKOUT'   SET KEYWORD                             00204100
              AIF   (N'&REQUEST LE 1).ZE14A     CK NUM                  00204200
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00204300
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00204400
&ZMS          SETC  '&ZMS "REQUEST"'                                    00204500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00204600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00204700
.ZE14A        ANOP  ,                                                   00204800
.*----------------------------------------------------------------***   00204900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00205000
              AIF   (N'&URID LE 1).ZE16A        CK NUM                  00205100
&ZMS          SETC  '"URID='    *KPOSA* MNOTE                           00205200
&ZMS          SETC  '&ZMS.&URID"'                                       00205300
&ZMS          SETC  '&ZMS "URID"'                                       00205400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00205500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00205600
.ZE16A        ANOP  ,                                                   00205700
.*-------------------------------------------------------------------   00205800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00205900
              AIF   (K'&URID(1) LE 0).ZE16B     NO PRM                  00206000
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00206100
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00206200
              AIF   (N'&URID GT 1).ZE16B                                00206300
.*            ANOP              MULTIPLE PARMS                          00206400
&XURID        SETC  '&URID'     SET XVARIABLE                           00206500
.ZE16B        ANOP  ,                                                   00206600
.*-------------------------------------------------------------------   00206700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00206800
              AIF   (K'&ZXURID LE 0).ZE16R      NOT I/O                 00206900
              AIF   ('&XURID'(1,1) NE '(').ZE16R                        00207000
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00207100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                        00207200
              AIF   (K'&ZCGPR GT 2).ZE16Q                               00207300
              AIF   ('&ZCGPR' EQ '0').ZE16Q                             00207400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00207500
              AIF   (T'&ZCGPR NE 'N').ZE16Q     INVALID REG NAME        00207600
.ZE16P        ANOP  ,                                                   00207700
              AIF   (T'&ZCGPR NE 'N').ZE16R     NON NUMERIC             00207800
              AIF   ('&ZCGPR' LT '2').ZE16Q                             00207900
              AIF   ('&ZCGPR' LE '12').ZE16R                            00208000
.ZE16Q        ANOP  ,                                                   00208100
&ZMS          SETC  '"URID='    *KGPRA* MNOTE                           00208200
&ZMS          SETC  '&ZMS.&URID"'                                       00208300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00208400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00208500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00208600
.ZE16R        ANOP  ,                                                   00208700
.*------------------------------------------------------------------    00208800
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00208900
.ZE18         AIF   (K'&XREQUEST GT 0).ZE18A    VALID                   00209000
              AIF   (K'&REQUEST(1) LE 0).ZE18B                          00209100
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           00209200
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00209300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00209400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00209500
&ZMS          SETC  '&ZMS "REMOVINT",'                                  00209600
&ZMS          SETC  '&ZMS "COMMIT",'                                    00209700
&ZMS          SETC  '&ZMS OR "BACKOUT".'                                00209800
              MNOTE 8,' &ZMS '                                          00209900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00210000
              AGO   .ZE18B                                              00210100
.*                                                                      00210200
.ZE18A        ANOP  ,                                                   00210300
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00210400
.ZE18B        ANOP  ,                                                   00210500
.*----------------------------------------------------------------***   00210600
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00210700
              AIF   (N'&GNAME LE 1).ZE20A       CK NUM                  00210800
&ZMS          SETC  '"GNAME='   *KPOSA* MNOTE                           00210900
&ZMS          SETC  '&ZMS.&GNAME"'                                      00211000
&ZMS          SETC  '&ZMS "GNAME"'                                      00211100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00211200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00211300
.ZE20A        ANOP  ,                                                   00211400
.*-------------------------------------------------------------------   00211500
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00211600
              AIF   (K'&GNAME(1) LE 0).ZE20B    NO PRM                  00211700
&ZXGNAME      SETC  'INPUT'     SET IN/OUTPUT                           00211800
&XGNAME       SETC  '&GNAME(1)'                 SET XVARIABLE           00211900
              AIF   (N'&GNAME GT 1).ZE20B                               00212000
.*            ANOP              MULTIPLE PARMS                          00212100
&XGNAME       SETC  '&GNAME'    SET XVARIABLE                           00212200
.ZE20B        ANOP  ,                                                   00212300
.*-------------------------------------------------------------------   00212400
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00212500
              AIF   (K'&ZXGNAME LE 0).ZE20R     NOT I/O                 00212600
              AIF   ('&XGNAME'(1,1) NE '(').ZE20R                       00212700
&ZCGPR        SETC  '&XGNAME'(2,K'&XGNAME-2)                            00212800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE20P                        00212900
              AIF   (K'&ZCGPR GT 2).ZE20Q                               00213000
              AIF   ('&ZCGPR' EQ '0').ZE20Q                             00213100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00213200
              AIF   (T'&ZCGPR NE 'N').ZE20Q     INVALID REG NAME        00213300
.ZE20P        ANOP  ,                                                   00213400
              AIF   (T'&ZCGPR NE 'N').ZE20R     NON NUMERIC             00213500
              AIF   ('&ZCGPR' LT '2').ZE20Q                             00213600
              AIF   ('&ZCGPR' LE '12').ZE20R                            00213700
.ZE20Q        ANOP  ,                                                   00213800
&ZMS          SETC  '"GNAME='   *KGPRA* MNOTE                           00213900
&ZMS          SETC  '&ZMS.&GNAME"'                                      00214000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00214100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00214200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00214300
.ZE20R        ANOP  ,                                                   00214400
.*----------------------------------------------------------------***   00214500
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00214600
              AIF   (N'&SYSNAME LE 1).ZE23A     CK NUM                  00214700
&ZMS          SETC  '"SYSNAME='                 *KPOSA* MNOTE           00214800
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00214900
&ZMS          SETC  '&ZMS "SYSNAME"'                                    00215000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00215100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00215200
.ZE23A        ANOP  ,                                                   00215300
.*-------------------------------------------------------------------   00215400
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00215500
              AIF   (K'&SYSNAME(1) LE 0).ZE23B  NO PRM                  00215600
&ZXSYSNAME    SETC  'INPUT'     SET IN/OUTPUT                           00215700
&XSYSNAME     SETC  '&SYSNAME(1)'               SET XVARIABLE           00215800
              AIF   (N'&SYSNAME GT 1).ZE23B                             00215900
.*            ANOP              MULTIPLE PARMS                          00216000
&XSYSNAME     SETC  '&SYSNAME'  SET XVARIABLE                           00216100
.ZE23B        ANOP  ,                                                   00216200
.*-------------------------------------------------------------------   00216300
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00216400
              AIF   (K'&ZXSYSNAME LE 0).ZE23R   NOT I/O                 00216500
              AIF   ('&XSYSNAME'(1,1) NE '(').ZE23R                     00216600
&ZCGPR        SETC  '&XSYSNAME'(2,K'&XSYSNAME-2)                        00216700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                        00216800
              AIF   (K'&ZCGPR GT 2).ZE23Q                               00216900
              AIF   ('&ZCGPR' EQ '0').ZE23Q                             00217000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00217100
              AIF   (T'&ZCGPR NE 'N').ZE23Q     INVALID REG NAME        00217200
.ZE23P        ANOP  ,                                                   00217300
              AIF   (T'&ZCGPR NE 'N').ZE23R     NON NUMERIC             00217400
              AIF   ('&ZCGPR' LT '2').ZE23Q                             00217500
              AIF   ('&ZCGPR' LE '12').ZE23R                            00217600
.ZE23Q        ANOP  ,                                                   00217700
&ZMS          SETC  '"SYSNAME='                 *KGPRA* MNOTE           00217800
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00217900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00218000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00218100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00218200
.ZE23R        ANOP  ,                                                   00218300
.*----------------------------------------------------------------***   00218400
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00218500
              AIF   (N'&RCTABLE LE 1).ZE26A     CK NUM                  00218600
&ZMS          SETC  '"RCTABLE='                 *KPOSA* MNOTE           00218700
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00218800
&ZMS          SETC  '&ZMS "RCTABLE"'                                    00218900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00219000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00219100
.ZE26A        ANOP  ,                                                   00219200
.*-------------------------------------------------------------------   00219300
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00219400
              AIF   (K'&RCTABLE(1) LE 0).ZE26B  NO PRM                  00219500
&ZXRCTABLE    SETC  'INPUT'     SET IN/OUTPUT                           00219600
&XRCTABLE     SETC  '&RCTABLE(1)'               SET XVARIABLE           00219700
              AIF   (N'&RCTABLE GT 1).ZE26B                             00219800
.*            ANOP              MULTIPLE PARMS                          00219900
&XRCTABLE     SETC  '&RCTABLE'  SET XVARIABLE                           00220000
.ZE26B        ANOP  ,                                                   00220100
.*-------------------------------------------------------------------   00220200
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00220300
              AIF   (K'&ZXRCTABLE LE 0).ZE26R   NOT I/O                 00220400
              AIF   ('&XRCTABLE'(1,1) NE '(').ZE26R                     00220500
&ZCGPR        SETC  '&XRCTABLE'(2,K'&XRCTABLE-2)                        00220600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                        00220700
              AIF   (K'&ZCGPR GT 2).ZE26Q                               00220800
              AIF   ('&ZCGPR' EQ '0').ZE26Q                             00220900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00221000
              AIF   (T'&ZCGPR NE 'N').ZE26Q     INVALID REG NAME        00221100
.ZE26P        ANOP  ,                                                   00221200
              AIF   (T'&ZCGPR NE 'N').ZE26R     NON NUMERIC             00221300
              AIF   ('&ZCGPR' LT '2').ZE26Q                             00221400
              AIF   ('&ZCGPR' LE '12').ZE26R                            00221500
.ZE26Q        ANOP  ,                                                   00221600
&ZMS          SETC  '"RCTABLE='                 *KGPRA* MNOTE           00221700
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00221800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00221900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00222000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00222100
.ZE26R        ANOP  ,                                                   00222200
.*----------------------------------------------------------------***   00222300
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00222400
              AIF   (N'&RCNUM LE 1).ZE28A       CK NUM                  00222500
&ZMS          SETC  '"RCNUM='   *KPOSA* MNOTE                           00222600
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00222700
&ZMS          SETC  '&ZMS "RCNUM"'                                      00222800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00222900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00223000
.ZE28A        ANOP  ,                                                   00223100
.*-------------------------------------------------------------------   00223200
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00223300
              AIF   (K'&RCNUM(1) LE 0).ZE28B    NO PRM                  00223400
&ZXRCNUM      SETC  'OUTPUT'    SET IN/OUTPUT                           00223500
&XRCNUM       SETC  '&RCNUM(1)'                 SET XVARIABLE           00223600
              AIF   (N'&RCNUM GT 1).ZE28B                               00223700
.*            ANOP              MULTIPLE PARMS                          00223800
&XRCNUM       SETC  '&RCNUM'    SET XVARIABLE                           00223900
.ZE28B        ANOP  ,                                                   00224000
.*-------------------------------------------------------------------   00224100
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00224200
              AIF   (K'&ZXRCNUM LE 0).ZE28R     NOT I/O                 00224300
              AIF   ('&XRCNUM'(1,1) NE '(').ZE28R                       00224400
&ZCGPR        SETC  '&XRCNUM'(2,K'&XRCNUM-2)                            00224500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE28P                        00224600
              AIF   (K'&ZCGPR GT 2).ZE28Q                               00224700
              AIF   ('&ZCGPR' EQ '0').ZE28Q                             00224800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00224900
              AIF   (T'&ZCGPR NE 'N').ZE28Q     INVALID REG NAME        00225000
.ZE28P        ANOP  ,                                                   00225100
              AIF   (T'&ZCGPR NE 'N').ZE28R     NON NUMERIC             00225200
              AIF   ('&ZCGPR' LT '2').ZE28Q                             00225300
              AIF   ('&ZCGPR' LE '12').ZE28R                            00225400
.ZE28Q        ANOP  ,                                                   00225500
&ZMS          SETC  '"RCNUM='   *KGPRA* MNOTE                           00225600
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00225700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00225800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00225900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00226000
.ZE28R        ANOP  ,                                                   00226100
.*----------------------------------------------------------------***   00226200
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00226300
              AIF   (N'&RETCODE LE 1).ZE32A     CK NUM                  00226400
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00226500
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00226600
&ZMS          SETC  '&ZMS "RETCODE"'                                    00226700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00226800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00226900
.ZE32A        ANOP  ,                                                   00227000
.*-------------------------------------------------------------------   00227100
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00227200
              AIF   (K'&RETCODE(1) LE 0).ZE32B  NO PRM                  00227300
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00227400
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00227500
              AIF   (N'&RETCODE GT 1).ZE32B                             00227600
.*            ANOP              MULTIPLE PARMS                          00227700
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00227800
.ZE32B        ANOP  ,                                                   00227900
.*-------------------------------------------------------------------   00228000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00228100
              AIF   (K'&ZXRETCODE LE 0).ZE32R   NOT I/O                 00228200
              AIF   ('&XRETCODE'(1,1) NE '(').ZE32R                     00228300
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00228400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE32P                        00228500
              AIF   (K'&ZCGPR GT 2).ZE32Q                               00228600
              AIF   ('&ZCGPR' EQ '0').ZE32Q                             00228700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00228800
              AIF   (T'&ZCGPR NE 'N').ZE32Q     INVALID REG NAME        00228900
.ZE32P        ANOP  ,                                                   00229000
              AIF   (T'&ZCGPR NE 'N').ZE32R     NON NUMERIC             00229100
              AIF   ('&ZCGPR' LT '2').ZE32Q                             00229200
              AIF   ('&ZCGPR' LE '12').ZE32R                            00229300
.ZE32Q        ANOP  ,                                                   00229400
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00229500
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00229600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00229700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00229800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00229900
.ZE32R        ANOP  ,                                                   00230000
.*----------------------------------------------------------------***   00230100
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00230200
              AIF   (N'&RSNCODE LE 1).ZE35A     CK NUM                  00230300
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00230400
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00230500
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00230600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00230700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00230800
.ZE35A        ANOP  ,                                                   00230900
.*-------------------------------------------------------------------   00231000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00231100
              AIF   (K'&RSNCODE(1) LE 0).ZE35B  NO PRM                  00231200
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00231300
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00231400
              AIF   (N'&RSNCODE GT 1).ZE35B                             00231500
.*            ANOP              MULTIPLE PARMS                          00231600
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00231700
.ZE35B        ANOP  ,                                                   00231800
.*-------------------------------------------------------------------   00231900
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00232000
              AIF   (K'&ZXRSNCODE LE 0).ZE35R   NOT I/O                 00232100
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE35R                     00232200
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00232300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE35P                        00232400
              AIF   (K'&ZCGPR GT 2).ZE35Q                               00232500
              AIF   ('&ZCGPR' EQ '0').ZE35Q                             00232600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00232700
              AIF   (T'&ZCGPR NE 'N').ZE35Q     INVALID REG NAME        00232800
.ZE35P        ANOP  ,                                                   00232900
              AIF   (T'&ZCGPR NE 'N').ZE35R     NON NUMERIC             00233000
              AIF   ('&ZCGPR' LT '2').ZE35Q                             00233100
              AIF   ('&ZCGPR' LE '12').ZE35R                            00233200
.ZE35Q        ANOP  ,                                                   00233300
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00233400
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00233500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00233600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00233700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00233800
.ZE35R        ANOP  ,                                                   00233900
.******************************************************************     00234000
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00234100
.******************************************************************     00234200
              ACTR  10000                                               00234300
.*----------------------------------------------------------------***   00234400
.***AF.P02 EXTRA POSITIONALS                                            00234500
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00234600
&ZCVAL        SETC  ''          ERROR FIELD                             00234700
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00234800
.ZELIST2      ANOP  ,                                                   00234900
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00235000
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00235100
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00235200
              AGO   .ZELIST2                                            00235300
.*                                                                      00235400
.ZELIST3      ANOP  ,                                                   00235500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00235600
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00235700
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00235800
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00235900
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00236000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00236100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00236200
.ZELISTX      ANOP  ,                                                   00236300
&ZASYSLNDX    SETA  0                                                   00236400
.*-------------------------------------------------------------------   00236500
.***AE.MF02 MF=(SLME)                                                   00236600
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00236700
.*******************************************************************    00236800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00236900
.*******************************************************************    00237000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00237100
.*******************************************************************    00237200
.***AE.01  START OF ATRSRV MACRO CODE                                   00237300
.*******************************************************************    00237400
              LCLC  &M0M0001                 NAME                       00237500
&M0M0001      SETC  '&XLABEL'                SET NAME                   00237600
              AIF   (K'&XLABEL NE 0).XLAB2                              00237700
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00237800
.*                                                                      00237900
.XLAB2        ANOP  ,                                                   00238000
              AIF   ('&XMF' EQ 'L').XLAB3                               00238100
&M0M0001 DS    0H                             ATRSRV-2                  00238200
.XLAB3        ANOP  ,                                                   00238300
.*******************************************************************    00238400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00238500
.*******************************************************************    00238600
              PUSH  PRINT                                               00238700
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00238800
              PRINT OFF         ++ PR01                                 00238900
              AGO   .ZPRNTXX                                            00239000
.ZPRINTX      PRINT ON                                                  00239100
.ZPRNTXX      ANOP  ,                                                   00239200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00239300
              AIF   ('&GNAME' NE '' AND '&SYSNAME' EQ '').SRVA          00239400
              AGO    .SRVB INVOCATION OKAY                              00239500
.SRVA         ANOP  ,                                                   00239600
&ZMS          SETC  'THE "SYSNAME" KEY'                                 00239700
&ZMS          SETC  '&ZMS MUST BE SPECIFIED'                            00239800
              MNOTE 8,'&ZMS IF THE "GNAME" KEY IS SPECIFIED'            00239900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00240000
.SRVB         ANOP  ,                                                   00240100
              AIF   ('&SYSNAME' NE '' AND '&GNAME' EQ '').SRVC          00240200
              AGO    .SRVD INVOCATION OKAY                              00240300
.SRVC         ANOP  ,                                                   00240400
&ZMS          SETC  'THE "GNAME" KEY'                                   00240500
&ZMS          SETC  '&ZMS MUST BE SPECIFIED'                            00240600
              MNOTE 8,'&ZMS IF THE "SYSNAME" KEY IS SPECIFIED'          00240700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00240800
.SRVD         ANOP  ,                                                   00240900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00241000
.********************************************************************   00241100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00241200
.********************************************************************   00241300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00241400
                      LCLA  &ZOPN1         INVOCATION INDEX             00241500
                      LCLC  &ZOPL(4095)    LABEL                        00241600
                      LCLC  &ZOPO(4095)    OPERATION                    00241700
                      LCLC  &ZOPV(4095)    VALUE                        00241800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00241900
.*                                                                      00242000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00242100
.******************************************************************     00242200
.***AL.L10 ATRSRV FMT=LIST MF=S|L PARAMETERS                            00242300
.******************************************************************     00242400
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00242500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00242600
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00242700
&XMFATTR              SETC  '0D'                                        00242800
.*                                                                      00242900
&ZOPN                 SETA  &ZOPN+1                                     00243000
&ZOPL(&ZOPN)          SETC  ' '                                         00243100
&ZOPO(&ZOPN)          SETC  'B'                                         00243200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00243300
&ZOPD(&ZOPN)          SETC  '++ ATRSRV ARG PARMS'                       00243400
.*                                                                      00243500
&ZOPN                 SETA  &ZOPN+1                                     00243600
&ZOPL(&ZOPN)          SETC  ' '                                         00243700
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00243800
&ZOPV(&ZOPN)          SETC  '1'                                         00243900
&ZOPD(&ZOPN)          SETC  ' '                                         00244000
.*                                                                      00244100
.ZLMFSL2              ANOP  ,                                           00244200
.*-------------------------------------------------------------------   00244300
.***AM.L00  ATRSRV FMT=LIST name                                        00244400
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00244500
&ZOPN                 SETA &ZOPN+1                                      00244600
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00244700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00244800
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00244900
&ZOPD(&ZOPN)          SETC '++ ATRSRV NAME'                             00245000
.ZLMFSL2M             ANOP  ,                                           00245100
.*-------------------------------------------------------------------   00245200
.***AM.L01  ATRSRV FMT=LIST PARAMETERS                                  00245300
&ZOPN                 SETA &ZOPN+1                                      00245400
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00245500
&ZOPO(&ZOPN)          SETC 'DS'                                         00245600
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00245700
&ZOPD(&ZOPN)          SETC '++ ATRSRV PARM LIST'                        00245800
.*-------------------------------------------------------------------   00245900
.***AM.L09  XID CL8                                                     00246000
&ZOPN                 SETA &ZOPN+1                                      00246100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XID'                              00246200
&ZOPO(&ZOPN)          SETC 'DS'                                         00246300
&ZOPV(&ZOPN)          SETC 'CL8'                                        00246400
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XID'                           00246500
.*-------------------------------------------------------------------   00246600
.***AM.L02 XVERSION XL1                                                 00246700
&ZOPN                 SETA &ZOPN+1                                      00246800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00246900
&ZOPO(&ZOPN)          SETC 'DS'                                         00247000
&ZOPV(&ZOPN)          SETC 'XL1'                                        00247100
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00247200
.*-------------------------------------------------------------------   00247300
.***AM.L03 XFLAGS BL.16                                                 00247400
&ZOPN                 SETA &ZOPN+1                                      00247500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00247600
&ZOPO(&ZOPN)          SETC 'DS'                                         00247700
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00247800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00247900
.*                                                                      00248000
&ZOPN                 SETA  &ZOPN+1                                     00248100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_COMMIT'                 00248200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00248300
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00248400
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00248500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMMIT'                       00248600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00248700
.*                                                                      00248800
&ZOPN                 SETA  &ZOPN+1                                     00248900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_BACKOUT'                00249000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00249100
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00249200
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00249300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).BACKOUT'                      00249400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00249500
.*                                                                      00249600
&ZOPN                 SETA  &ZOPN+1                                     00249700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_REMOVINT'               00249800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00249900
&ZOPV(&ZOPN)          SETC  'B''0010000000000000'''                     00250000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00250100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REMOVINT'                     00250200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00250300
.*                                                                      00250400
&ZOPN                 SETA  &ZOPN+1                                     00250500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_URID'                    00250600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00250700
&ZOPV(&ZOPN)          SETC  'B''0001000000000000'''                     00250800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00250900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).URID'                         00251000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00251100
.*                                                                      00251200
&ZOPN                 SETA  &ZOPN+1                                     00251300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RMNAME'                  00251400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00251500
&ZOPV(&ZOPN)          SETC  'B''0000100000000000'''                     00251600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00251700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RMNAME'                       00251800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00251900
.*                                                                      00252000
&ZOPN                 SETA  &ZOPN+1                                     00252100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_GNAME'                   00252200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00252300
&ZOPV(&ZOPN)          SETC  'B''0000010000000000'''                     00252400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00252500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GNAME'                        00252600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00252700
.*                                                                      00252800
&ZOPN                 SETA  &ZOPN+1                                     00252900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SYSNAME'                 00253000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00253100
&ZOPV(&ZOPN)          SETC  'B''0000001000000000'''                     00253200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00253300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYSNAME'                      00253400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00253500
.*-------------------------------------------------------------------   00253600
.***AM.L09  XRSV00002 CL1                                               00253700
&ZOPN                 SETA &ZOPN+1                                      00253800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV00002'                        00253900
&ZOPO(&ZOPN)          SETC 'DS'                                         00254000
&ZOPV(&ZOPN)          SETC 'CL1'                                        00254100
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV00002'                     00254200
.*-------------------------------------------------------------------   00254300
.***AM.L09  XURID CL16                                                  00254400
&ZOPN                 SETA &ZOPN+1                                      00254500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XURID'                            00254600
&ZOPO(&ZOPN)          SETC 'DS'                                         00254700
&ZOPV(&ZOPN)          SETC 'CL16'                                       00254800
&ZOPD(&ZOPN)          SETC '++ &ZXURID  XURID'                          00254900
.*-------------------------------------------------------------------   00255000
.***AM.L09  XRMNAME CL32                                                00255100
&ZOPN                 SETA &ZOPN+1                                      00255200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRMNAME'                          00255300
&ZOPO(&ZOPN)          SETC 'DS'                                         00255400
&ZOPV(&ZOPN)          SETC 'CL32'                                       00255500
&ZOPD(&ZOPN)          SETC '++ &ZXRMNAME  XRMNAME'                      00255600
.*-------------------------------------------------------------------   00255700
.***AM.MLM2 SAVED LOCATION COUNTER                                      00255800
                      AIF  (&XPLISTVER GE 2).ZL14LA                     00255900
                      AIF  ('&ZENDBASEPL' NE '').ZL14LA                 00256000
&ZENDBASEPL           SETC 'YES'                                        00256100
&ZOPN                 SETA &ZOPN+1                                      00256200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00256300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00256400
&ZOPV(&ZOPN)          SETC '*'                                          00256500
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00256600
.ZL14LA               ANOP  ,                                           00256700
.*-------------------------------------------------------------------   00256800
.***AM.LVER1                                                            00256900
                      AIF  (&XPLISTVER LT 2).ZL14L                      00257000
.*-------------------------------------------------------------------   00257100
.*-------------------------------------------------------------------   00257200
.***AM.L09  XGNAME CL8                                                  00257300
&ZOPN                 SETA &ZOPN+1                                      00257400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGNAME'                           00257500
&ZOPO(&ZOPN)          SETC 'DS'                                         00257600
&ZOPV(&ZOPN)          SETC 'CL8'                                        00257700
&ZOPD(&ZOPN)          SETC '++ &ZXGNAME  XGNAME'                        00257800
.*-------------------------------------------------------------------   00257900
.***AM.LVER2                                                            00258000
.ZL14L                ANOP  ,                                           00258100
.*-------------------------------------------------------------------   00258200
.*-------------------------------------------------------------------   00258300
.***AM.LVER1                                                            00258400
                      AIF  (&XPLISTVER LT 2).ZL15L                      00258500
.*-------------------------------------------------------------------   00258600
.*-------------------------------------------------------------------   00258700
.***AM.L09  XSYSNAME CL8                                                00258800
&ZOPN                 SETA &ZOPN+1                                      00258900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSNAME'                         00259000
&ZOPO(&ZOPN)          SETC 'DS'                                         00259100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00259200
&ZOPD(&ZOPN)          SETC '++ &ZXSYSNAME  XSYSNAME'                    00259300
.*-------------------------------------------------------------------   00259400
.***AM.LVER2                                                            00259500
.ZL15L                ANOP  ,                                           00259600
.*-------------------------------------------------------------------   00259700
.*-------------------------------------------------------------------   00259800
.***AM.LVER1                                                            00259900
                      AIF  (&XPLISTVER LT 2).ZL16L                      00260000
.*-------------------------------------------------------------------   00260100
.*-------------------------------------------------------------------   00260200
.***AM.L09  XRCTABLE A                                                  00260300
&ZOPN                 SETA &ZOPN+1                                      00260400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRCTABLE'                         00260500
&ZOPO(&ZOPN)          SETC 'DS'                                         00260600
&ZOPV(&ZOPN)          SETC 'A'                                          00260700
&ZOPD(&ZOPN)          SETC '++ &ZXRCTABLE  XRCTABLE'                    00260800
.*-------------------------------------------------------------------   00260900
.***AM.LVER2                                                            00261000
.ZL16L                ANOP  ,                                           00261100
.*-------------------------------------------------------------------   00261200
.*-------------------------------------------------------------------   00261300
.***AM.LVER1                                                            00261400
                      AIF  (&XPLISTVER LT 2).ZL17L                      00261500
.*-------------------------------------------------------------------   00261600
.*-------------------------------------------------------------------   00261700
.***AM.L09  XRCNUM F                                                    00261800
&ZOPN                 SETA &ZOPN+1                                      00261900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRCNUM'                           00262000
&ZOPO(&ZOPN)          SETC 'DS'                                         00262100
&ZOPV(&ZOPN)          SETC 'F'                                          00262200
&ZOPD(&ZOPN)          SETC '++ &ZXRCNUM  XRCNUM'                        00262300
.*-------------------------------------------------------------------   00262400
.***AM.LVER2                                                            00262500
.ZL17L                ANOP  ,                                           00262600
.*-------------------------------------------------------------------   00262700
.*-------------------------------------------------------------------   00262800
.***AM.L10 END OF ATRSRV LIST PARAMETERS                                00262900
&ZOPN                 SETA &ZOPN+1                                      00263000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00263100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00263200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00263300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00263400
.*                                                                      00263500
&ZOPN                 SETA &ZOPN+1                                      00263600
&ZOPL(&ZOPN)          SETC ' '                                          00263700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00263800
&ZOPV(&ZOPN)          SETC '1'                                          00263900
&ZOPD(&ZOPN)          SETC ' '                                          00264000
.*-------------------------------------------------------------------   00264100
.***AL.L12 ATRSRV FMT=LIST MF=S|L PARAMETERS                            00264200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00264300
.*                                                                      00264400
&ZOPN                 SETA  &ZOPN+1                                     00264500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00264600
&ZOPO(&ZOPN)          SETC  'DC'                                        00264700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00264800
&ZOPD(&ZOPN)          SETC  '++ ATRSRV ARG PARMS'                       00264900
.*                                                                      00265000
.ZLMFSLX              ANOP  ,                                           00265100
.*-------------------------------------------------------------------   00265200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00265300
&ZPLLEN               SETA 60                                           00265400
.*                                                                      00265500
                      AIF  (&XPLISTVER LT 2).ZLLEN2Z                    00265600
&ZPLLEN               SETA 84                                           00265700
.ZLLEN2Z              ANOP  ,                                           00265800
.*                                                                      00265900
.******************************************************************     00266000
.***AI.L01 ATRSRV FMT=LIST FILL IN PARAMETER AREA                       00266100
.******************************************************************     00266200
                      ACTR  10000                                       00266300
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00266400
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00266500
&ZCVAL                SETC  'LAE'          XAX MODE                     00266600
.ZIMFXA               ANOP ,                                            00266700
.*                                                                      00266800
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00266900
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00267000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00267100
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00267200
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00267300
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00267400
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00267500
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00267600
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00267700
&ZOPN                 SETA  &ZOPN+1                                     00267800
&ZOPL(&ZOPN)          SETC  ' '                                         00267900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00268000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00268100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00268200
                      AGO   .ZIMFNX                                     00268300
.*                                                                      00268400
.ZIMFN2               ANOP ,                                            00268500
&ZOPN                 SETA  &ZOPN+1                                     00268600
&ZOPL(&ZOPN)          SETC  ' '                                         00268700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00268800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00268900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00269000
.ZIMFNX               ANOP ,                                            00269100
.********************************************************************   00269200
.***AI.L02 ATRSRV FMT=LIST INITIALIZE PARAMETER AREA                    00269300
.********************************************************************   00269400
.***AI.L03 MF=(SLME)                                                    00269500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00269600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00269700
.*                                                                      00269800
&ZOPN                 SETA  &ZOPN+1                                     00269900
&ZOPL(&ZOPN)          SETC  ' '                                         00270000
&ZOPO(&ZOPN)          SETC  'XC'                                        00270100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00270200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00270300
.ZIMFLX               ANOP  ,                                           00270400
.*-------------------------------------------------------------------   00270500
.***AI.L60 XID CL8                                                      00270600
&ZOPN                 SETA  &ZOPN+1                                     00270700
&ZOPL(&ZOPN)          SETC  ' '                                         00270800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00270900
&ZOPV(&ZOPN)          SETC  '0(8,1),=CL8''ATRSRV  '''                   00271000
&ZOPD(&ZOPN)          SETC  '++ CL8 CONSTANT'                           00271100
.*-------------------------------------------------------------------   00271200
.***AI.L04B XVERSION XL1                                                00271300
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00271400
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVY            00271500
.ZIMFVX               ANOP  ,                                           00271600
                      AIF   ('&PLISTVER' EQ '').ZIMFVZ                  00271700
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVZ            00271800
.ZIMFVY               ANOP  ,                                           00271900
&ZOPN                 SETA  &ZOPN+1                                     00272000
&ZOPL(&ZOPN)          SETC  ' '                                         00272100
&ZOPO(&ZOPN)          SETC  'MVI'                                       00272200
&ZOPV(&ZOPN)          SETC  '8(1),&XPLISTVER'                           00272300
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00272400
.ZIMFVZ               ANOP  ,                                           00272500
.*-------------------------------------------------------------------   00272600
.***AI.L05 XFLAGS BL2                                                   00272700
&ZW                   SETC  ''                                          00272800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00272900
&ZMS                  SETC  ''                                          00273000
&ZC                   SETC  ''                                          00273100
.*-------------------------------------------------------------------   00273200
.***AI.L08 XFLAGS "COMMIT"                                              00273300
.***      BL2'1XXXXXXXXXXXXXXX'                                         00273400
         AIF   ('&XREQUEST' NE 'COMMIT').ZI4A                           00273500
&ZW                   SETC  '&ZW.1'                                     00273600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00273700
&ZMS                  SETC  '&ZMS.1'                                    00273800
                      AGO   .ZI4C                                       00273900
.*                                                                      00274000
.ZI4A                 ANOP  ,                                           00274100
&ZW                   SETC  '&ZW.0'                                     00274200
         AIF   ('&ZXREQUEST' EQ '').ZI4B                                00274300
&ZMS                  SETC  '&ZMS.0'                                    00274400
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00274500
                      AGO   .ZI4C                                       00274600
.*                                                                      00274700
.ZI4B                 ANOP  ,                                           00274800
&ZMS                  SETC  '&ZMS.1'                                    00274900
.ZI4C                 ANOP  ,                                           00275000
.*-------------------------------------------------------------------   00275100
.***AI.L08 XFLAGS "BACKOUT"                                             00275200
.***      BL2'X1XXXXXXXXXXXXXX'                                         00275300
         AIF   ('&XREQUEST' NE 'BACKOUT').ZI5A                          00275400
&ZW                   SETC  '&ZW.1'                                     00275500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00275600
&ZMS                  SETC  '&ZMS.1'                                    00275700
                      AGO   .ZI5C                                       00275800
.*                                                                      00275900
.ZI5A                 ANOP  ,                                           00276000
&ZW                   SETC  '&ZW.0'                                     00276100
         AIF   ('&ZXREQUEST' EQ '').ZI5B                                00276200
&ZMS                  SETC  '&ZMS.0'                                    00276300
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00276400
                      AGO   .ZI5C                                       00276500
.*                                                                      00276600
.ZI5B                 ANOP  ,                                           00276700
&ZMS                  SETC  '&ZMS.1'                                    00276800
.ZI5C                 ANOP  ,                                           00276900
.*-------------------------------------------------------------------   00277000
.***AI.L08 XFLAGS "REMOVINT"                                            00277100
.***      BL2'XX1XXXXXXXXXXXXX'                                         00277200
         AIF   ('&XREQUEST' NE 'REMOVINT').ZI6A                         00277300
&ZW                   SETC  '&ZW.1'                                     00277400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00277500
&ZMS                  SETC  '&ZMS.1'                                    00277600
                      AGO   .ZI6C                                       00277700
.*                                                                      00277800
.ZI6A                 ANOP  ,                                           00277900
&ZW                   SETC  '&ZW.0'                                     00278000
         AIF   ('&ZXREQUEST' EQ '').ZI6B                                00278100
&ZMS                  SETC  '&ZMS.0'                                    00278200
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00278300
                      AGO   .ZI6C                                       00278400
.*                                                                      00278500
.ZI6B                 ANOP  ,                                           00278600
&ZMS                  SETC  '&ZMS.1'                                    00278700
.ZI6C                 ANOP  ,                                           00278800
.*-------------------------------------------------------------------   00278900
.***AI.L08 XFLAGS "URID"                                                00279000
.***      BL2'XXX1XXXXXXXXXXXX'                                         00279100
         AIF   ('&URID' EQ '').ZI7A                                     00279200
         AIF   ('&URID' EQ '0').ZI7A                                    00279300
&ZW                   SETC  '&ZW.1'                                     00279400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00279500
&ZMS                  SETC  '&ZMS.0'                                    00279600
                      AGO   .ZI7C                                       00279700
.*                                                                      00279800
.ZI7A                 ANOP  ,                                           00279900
&ZW                   SETC  '&ZW.0'                                     00280000
&ZMS                  SETC  '&ZMS.1'                                    00280100
.ZI7C                 ANOP  ,                                           00280200
.*-------------------------------------------------------------------   00280300
.***AI.L08 XFLAGS "RMNAME"                                              00280400
.***      BL2'XXXX1XXXXXXXXXXX'                                         00280500
         AIF   ('&RMNAME' EQ '').ZI8A                                   00280600
         AIF   ('&RMNAME' EQ '0').ZI8A                                  00280700
&ZW                   SETC  '&ZW.1'                                     00280800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00280900
&ZMS                  SETC  '&ZMS.0'                                    00281000
                      AGO   .ZI8C                                       00281100
.*                                                                      00281200
.ZI8A                 ANOP  ,                                           00281300
&ZW                   SETC  '&ZW.0'                                     00281400
&ZMS                  SETC  '&ZMS.1'                                    00281500
.ZI8C                 ANOP  ,                                           00281600
.*-------------------------------------------------------------------   00281700
.***AI.L08 XFLAGS "GNAME"                                               00281800
.***      BL2'XXXXX1XXXXXXXXXX'                                         00281900
         AIF   ('&GNAME' EQ '').ZI9A                                    00282000
         AIF   ('&GNAME' EQ 'CURRENT_GNAME').ZI9A                       00282100
&ZW                   SETC  '&ZW.1'                                     00282200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00282300
&ZMS                  SETC  '&ZMS.0'                                    00282400
                      AGO   .ZI9C                                       00282500
.*                                                                      00282600
.ZI9A                 ANOP  ,                                           00282700
&ZW                   SETC  '&ZW.0'                                     00282800
&ZMS                  SETC  '&ZMS.1'                                    00282900
.ZI9C                 ANOP  ,                                           00283000
.*-------------------------------------------------------------------   00283100
.***AI.L08 XFLAGS "SYSNAME"                                             00283200
.***      BL2'XXXXXX1XXXXXXXXX'                                         00283300
         AIF   ('&SYSNAME' EQ '').ZI10A                                 00283400
         AIF   ('&SYSNAME' EQ 'CURRENT_SYSNAME').ZI10A                  00283500
&ZW                   SETC  '&ZW.1000000000'                            00283600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00283700
&ZMS                  SETC  '&ZMS.0111111111'                           00283800
                      AGO   .ZI10C                                      00283900
.*                                                                      00284000
.ZI10A                ANOP  ,                                           00284100
&ZW                   SETC  '&ZW.0000000000'                            00284200
&ZMS                  SETC  '&ZMS.1111111111'                           00284300
.ZI10C                ANOP  ,                                           00284400
.*-------------------------------------------------------------------   00284500
.***AI.L10 XFLAGS BL2                                                   00284600
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI10D              00284700
                      AIF   ('&ZC' NE 'YES.').ZI10D                     00284800
&ZOPN                 SETA  &ZOPN+1                                     00284900
&ZOPL(&ZOPN)          SETC  ' '                                         00285000
&ZOPO(&ZOPN)          SETC  'NC'                                        00285100
&ZOPV(&ZOPN)          SETC  '9(1),B''&ZMS'''                            00285200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00285300
.ZI10D                ANOP  ,                                           00285400
                      AIF   ('&ZCLNG' NE 'YES').ZI10E  ALL ZERO BITS    00285500
&ZOPN                 SETA  &ZOPN+1                                     00285600
&ZOPL(&ZOPN)          SETC  ' '                                         00285700
&ZOPO(&ZOPN)          SETC  'OC'                                        00285800
&ZOPV(&ZOPN)          SETC  '9(2,1),=BL2''&ZW'''                        00285900
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00286000
.ZI10E                ANOP  ,                                           00286100
.*-------------------------------------------------------------------   00286200
.***AI.L25  XURID CL16                                                  00286300
                      AIF   ('&ZXURID' EQ '').ZI12E                     00286400
                      AIF   ('&ZXURID' EQ 'OUTPUT').ZI12E               00286500
&ZCGPR                SETC  '&XURID'                                    00286600
         AIF   ('&XURID' NE '0').ZI12A                                  00286700
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI12E                          00286800
.*                                                                      00286900
&ZCGPR                SETC  '=XL16''00'''                               00287000
.ZI12A                ANOP  ,                                           00287100
.*                                                                      00287200
                      AIF   ('&XURID'(1,1) NE '(').ZI12B                00287300
&ZCGPR   SETC  '0('.'&XURID'(2,K'&XURID-2).')'                          00287400
                      AGO   .ZI12D                                      00287500
.ZI12B                ANOP  ,                                           00287600
.*                                                                      00287700
                      AIF   ('&URID(1)' EQ '').ZI12I  OMITTED           00287800
&ZC                   SETC  '0'                                         00287900
                      AIF   ('&XURID' NE '&ZC').ZI12C                   00288000
.ZI12I                ANOP  ,                                           00288100
&ZCGPR                SETC  '=CL16''&XURID'''                           00288200
.ZI12C                ANOP  ,                                           00288300
.*                                                                      00288400
.ZI12D                ANOP  ,                                           00288500
.*                                                                      00288600
&ZOPN                 SETA  &ZOPN+1                                     00288700
&ZOPL(&ZOPN)          SETC  ' '                                         00288800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00288900
&ZOPV(&ZOPN)          SETC  '12(16,1),&ZCGPR'                           00289000
&ZOPD(&ZOPN)          SETC  '++ &ZXURID XURID'                          00289100
.*                                                                      00289200
.ZI12E                ANOP  ,                                           00289300
.*-------------------------------------------------------------------   00289400
.***AI.L25  XRMNAME CL32                                                00289500
                      AIF   ('&ZXRMNAME' EQ '').ZI13E                   00289600
                      AIF   ('&ZXRMNAME' EQ 'OUTPUT').ZI13E             00289700
&ZCGPR                SETC  '&XRMNAME'                                  00289800
         AIF   ('&XRMNAME' NE '0').ZI13A                                00289900
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI13E                          00290000
.*                                                                      00290100
&ZCGPR                SETC  '=XL32''00'''                               00290200
.ZI13A                ANOP  ,                                           00290300
.*                                                                      00290400
                      AIF   ('&XRMNAME'(1,1) NE '(').ZI13B              00290500
&ZCGPR   SETC  '0('.'&XRMNAME'(2,K'&XRMNAME-2).')'                      00290600
                      AGO   .ZI13D                                      00290700
.ZI13B                ANOP  ,                                           00290800
.*                                                                      00290900
                      AIF   ('&RMNAME(1)' EQ '').ZI13I  OMITTED         00291000
&ZC                   SETC  '0'                                         00291100
                      AIF   ('&XRMNAME' NE '&ZC').ZI13C                 00291200
.ZI13I                ANOP  ,                                           00291300
&ZCGPR                SETC  '=CL32''&XRMNAME'''                         00291400
.ZI13C                ANOP  ,                                           00291500
.*                                                                      00291600
.ZI13D                ANOP  ,                                           00291700
.*                                                                      00291800
&ZOPN                 SETA  &ZOPN+1                                     00291900
&ZOPL(&ZOPN)          SETC  ' '                                         00292000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00292100
&ZOPV(&ZOPN)          SETC  '28(32,1),&ZCGPR'                           00292200
&ZOPD(&ZOPN)          SETC  '++ &ZXRMNAME XRMNAME'                      00292300
.*                                                                      00292400
.ZI13E                ANOP  ,                                           00292500
.*-------------------------------------------------------------------   00292600
.***AI.LVER01                                                           00292700
                      AIF  (&XPLISTVER LT 2).ZI14Z                      00292800
.*-------------------------------------------------------------------   00292900
.***AI.L18  XGNAME CL8                                                  00293000
         AIF   ('&XGNAME' NE 'CURRENT_GNAME').ZI14                      00293100
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI14  CK *        00293200
&ZXGNAME              SETC  ''             RESET INPUT/OUTPUT           00293300
.ZI14                 ANOP  ,                                           00293400
.*-------------------------------------------------------------------   00293500
.***AI.L25  XGNAME CL8                                                  00293600
                      AIF   ('&ZXGNAME' EQ '').ZI14E                    00293700
                      AIF   ('&ZXGNAME' EQ 'OUTPUT').ZI14E              00293800
&ZCGPR                SETC  '&XGNAME'                                   00293900
         AIF   ('&XGNAME' NE 'CURRENT_GNAME').ZI14A                     00294000
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI14E                          00294100
.*                                                                      00294200
&ZCGPR                SETC  '=XL8''00'''                                00294300
.ZI14A                ANOP  ,                                           00294400
.*                                                                      00294500
                      AIF   ('&XGNAME'(1,1) NE '(').ZI14B               00294600
&ZCGPR   SETC  '0('.'&XGNAME'(2,K'&XGNAME-2).')'                        00294700
.ZI14B                ANOP  ,                                           00294800
.*                                                                      00294900
&ZOPN                 SETA  &ZOPN+1                                     00295000
&ZOPL(&ZOPN)          SETC  ' '                                         00295100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00295200
&ZOPV(&ZOPN)          SETC  '60(8,1),&ZCGPR'                            00295300
&ZOPD(&ZOPN)          SETC  '++ &ZXGNAME XGNAME'                        00295400
.*                                                                      00295500
.ZI14E                ANOP  ,                                           00295600
.*-------------------------------------------------------------------   00295700
.***AI.LVER02                                                           00295800
.ZI14Z                ANOP  ,                                           00295900
.*-------------------------------------------------------------------   00296000
.***AI.LVER01                                                           00296100
                      AIF  (&XPLISTVER LT 2).ZI15Z                      00296200
.*-------------------------------------------------------------------   00296300
.***AI.L18  XSYSNAME CL8                                                00296400
         AIF   ('&XSYSNAME' NE 'CURRENT_SYSNAME').ZI15                  00296500
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI15  CK *        00296600
&ZXSYSNAME            SETC  ''             RESET INPUT/OUTPUT           00296700
.ZI15                 ANOP  ,                                           00296800
.*-------------------------------------------------------------------   00296900
.***AI.L25  XSYSNAME CL8                                                00297000
                      AIF   ('&ZXSYSNAME' EQ '').ZI15E                  00297100
                      AIF   ('&ZXSYSNAME' EQ 'OUTPUT').ZI15E            00297200
&ZCGPR                SETC  '&XSYSNAME'                                 00297300
         AIF   ('&XSYSNAME' NE 'CURRENT_SYSNAME').ZI15A                 00297400
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI15E                          00297500
.*                                                                      00297600
&ZCGPR                SETC  '=XL8''00'''                                00297700
.ZI15A                ANOP  ,                                           00297800
.*                                                                      00297900
                      AIF   ('&XSYSNAME'(1,1) NE '(').ZI15B             00298000
&ZCGPR   SETC  '0('.'&XSYSNAME'(2,K'&XSYSNAME-2).')'                    00298100
.ZI15B                ANOP  ,                                           00298200
.*                                                                      00298300
&ZOPN                 SETA  &ZOPN+1                                     00298400
&ZOPL(&ZOPN)          SETC  ' '                                         00298500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00298600
&ZOPV(&ZOPN)          SETC  '68(8,1),&ZCGPR'                            00298700
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSNAME XSYSNAME'                    00298800
.*                                                                      00298900
.ZI15E                ANOP  ,                                           00299000
.*-------------------------------------------------------------------   00299100
.***AI.LVER02                                                           00299200
.ZI15Z                ANOP  ,                                           00299300
.*-------------------------------------------------------------------   00299400
.***AI.LVER01                                                           00299500
                      AIF  (&XPLISTVER LT 2).ZI16Z                      00299600
.*-------------------------------------------------------------------   00299700
.***AI.L25  XRCTABLE AL4                                                00299800
                      AIF   ('&ZXRCTABLE' EQ '').ZI16E                  00299900
                      AIF   ('&ZXRCTABLE' EQ 'OUTPUT').ZI16E            00300000
&ZCGPR                SETC  '&XRCTABLE'                                 00300100
         AIF   ('&XRCTABLE' NE '0').ZI16A                               00300200
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI16E                          00300300
.*                                                                      00300400
&ZCGPR                SETC  '=XL4''00'''                                00300500
.ZI16A                ANOP  ,                                           00300600
.*                                                                      00300700
                      AIF   ('&XRCTABLE'(1,1) NE '(').ZI16B             00300800
&ZCGPR   SETC  '0('.'&XRCTABLE'(2,K'&XRCTABLE-2).')'                    00300900
                      AGO   .ZI16D                                      00301000
.ZI16B                ANOP  ,                                           00301100
.*                                                                      00301200
&ZC                   SETC  '&XRCTABLE'(1,1)                            00301300
                      AIF   (T'&ZC NE 'N').ZI16D                        00301400
&ZC                   SETC  '&XRCTABLE'                                 00301500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               00301600
&ZCGPR                SETC  '=AL4(&XRCTABLE)'                           00301700
.*                                                                      00301800
.ZI16D                ANOP  ,                                           00301900
.*                                                                      00302000
&ZOPN                 SETA  &ZOPN+1                                     00302100
&ZOPL(&ZOPN)          SETC  ' '                                         00302200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00302300
&ZOPV(&ZOPN)          SETC  '76(4,1),&ZCGPR'                            00302400
&ZOPD(&ZOPN)          SETC  '++ &ZXRCTABLE XRCTABLE'                    00302500
.*                                                                      00302600
.ZI16E                ANOP  ,                                           00302700
.*-------------------------------------------------------------------   00302800
.***AI.LVER02                                                           00302900
.ZI16Z                ANOP  ,                                           00303000
.*-------------------------------------------------------------------   00303100
&ZOPN1                SETA &ZOPN                                        00303200
.*-------------------------------------------------------------------   00303300
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00303400
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00303500
.*******************************************************************    00303600
.***  PROCESS ATRSRV OUTPUT PARAMETERS                                  00303700
.*******************************************************************    00303800
                      ACTR  10000                                       00303900
.*------------------------------------------------------------------    00304000
.***AO.LVER01                                                           00304100
                      AIF  (&XPLISTVER LT 2).ZO17Z  PLVER               00304200
.*------------------------------------------------------------------    00304300
.***AO.L02 XRCNUM F                                                     00304400
         AIF   ('&ZXRCNUM' EQ 'OUTPUT').ZO17A  OUTPUT                   00304500
         AIF   ('&ZXRCNUM' NE 'INOUT').ZO17C  INOUT                     00304600
.ZO17A    AIF   ('&XRCNUM'(1,1) NE '(').ZO17B  ADDR IN GPR              00304700
&ZCGPR   SETC  '&XRCNUM'(2,K'&XRCNUM-2)                                 00304800
&ZOPN                 SETA  &ZOPN+1                                     00304900
&ZOPL(&ZOPN)          SETC  ' '                                         00305000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00305100
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),80(1)'                         00305200
&ZOPD(&ZOPN)          SETC  '++ XRCNUM F'                               00305300
                      AGO   .ZO17C                                      00305400
.*                                                                      00305500
.ZO17B                ANOP  ,                                           00305600
&ZAWRK   SETA  K'&XRCNUM                                                00305700
         AIF   ('&XRCNUM'(&ZAWRK,1) NE ')').ZO17G                       00305800
&ZN      SETA  2                                                        00305900
.ZO17H    ANOP                                                          00306000
         AIF   (&ZN GE &ZAWRK).ZO17G                                    00306100
         AIF   ('&XRCNUM'(&ZN,1) NE '(').ZO17I                          00306200
&ZC      SETC  '&XRCNUM'(1,&ZN).'4'.','                                 00306300
&ZC      SETC  '&ZC'.'&XRCNUM'(&ZN+1,&ZAWRK-&ZN).',80(1)'               00306400
         AGO   .ZO17J                                                   00306500
.ZO17I    ANOP                                                          00306600
&ZN      SETA  &ZN+1                                                    00306700
         AGO   .ZO17H                                                   00306800
.ZO17G    ANOP                                                          00306900
&ZC      SETC  '&XRCNUM.(4),80(1)'                                      00307000
.ZO17J    ANOP                                                          00307100
&ZOPN                 SETA  &ZOPN+1                                     00307200
&ZOPL(&ZOPN)          SETC  ' '                                         00307300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00307400
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00307500
&ZOPD(&ZOPN)          SETC  '++ XRCNUM F'                               00307600
.ZO17C                ANOP  ,                                           00307700
.*------------------------------------------------------------------    00307800
.***AO.LVER02                                                           00307900
.ZO17Z                ANOP  ,                                           00308000
.*******************************************************************    00308100
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00308200
.*******************************************************************    00308300
&ZOPN                 SETA  &ZOPN+1                                     00308400
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               00308500
&ZOPO(&ZOPN)          SETC  'DS'                                        00308600
&ZOPV(&ZOPN)          SETC  '0H'                                        00308700
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      00308800
.*******************************************************************    00308900
.***AO.X02  RETURN CODE PROCESSING                                      00309000
.*******************************************************************    00309100
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00309200
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00309300
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00309400
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00309500
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00309600
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00309700
&ZOPN                 SETA  &ZOPN+1                                     00309800
&ZOPL(&ZOPN)          SETC  ' '                                         00309900
&ZOPO(&ZOPN)          SETC  'ST'                                        00310000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00310100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00310200
                      AGO   .ZMRETX                                     00310300
.*                                                                      00310400
.ZMRET2               ANOP  ,                                           00310500
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00310600
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00310700
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00310800
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00310900
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00311000
&ZOPN                 SETA  &ZOPN+1                                     00311100
&ZOPL(&ZOPN)          SETC  ' '                                         00311200
&ZOPO(&ZOPN)          SETC  'LR'                                        00311300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00311400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00311500
.ZMRETX               ANOP  ,                                           00311600
.*******************************************************************    00311700
.***AO.X03  REASON CODE PROCESSING                                      00311800
.*******************************************************************    00311900
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00312000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00312100
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00312200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00312300
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00312400
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00312500
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00312600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00312700
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00312800
&ZOPN                 SETA  &ZOPN+1                                     00312900
&ZOPL(&ZOPN)          SETC  ' '                                         00313000
&ZOPO(&ZOPN)          SETC  'ST'                                        00313100
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00313200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00313300
                      AGO   .ZMRSNX                                     00313400
.*                                                                      00313500
.ZMRSN2               ANOP  ,                                           00313600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00313700
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00313800
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00313900
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00314000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00314100
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00314200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00314300
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00314400
&ZOPN                 SETA  &ZOPN+1                                     00314500
&ZOPL(&ZOPN)          SETC  ' '                                         00314600
&ZOPO(&ZOPN)          SETC  'LR'                                        00314700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00314800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00314900
.ZMRSNX               ANOP  ,                                           00315000
.*******************************************************************    00315100
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00315200
.*******************************************************************    00315300
.ZMFLX                ANOP  ,              MF=L PROCESSING              00315400
.*******************************************************************    00315500
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00315600
.*******************************************************************    00315700
                      ACTR  10000                                       00315800
.*                                                                      00315900
                      LCLA  &ZLC           COLUMN POSITION              00316000
                      LCLA  &ZOPX          LIST TABLE INDEX             00316100
                      LCLC  &ZLL           LABEL                        00316200
                      LCLC  &ZLOP          OPERATION                    00316300
                      LCLC  &ZLV           VALUE                        00316400
                      LCLC  &ZLD           DESCRIPTION                  00316500
.*                                                                      00316600
&ZOPX                 SETA  1                                           00316700
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00316800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00316900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00317000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00317100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00317200
                      AIF   (K'&ZLD LE 0).ZL5                           00317300
&ZLC                  SETA  35             COMMENT COLUMN               00317400
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00317500
&ZLC                  SETA  33             COMMMENT COLUMN              00317600
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00317700
&ZLV                  SETC  '&ZLV'.' '                                  00317800
                      AGO   .ZL3                                        00317900
.*                                                                      00318000
.ZL4                  ANOP  ,                                           00318100
&ZLV                  SETC  '&ZLV'.' '                                  00318200
.ZL5                  ANOP  ,                                           00318300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00318400
.*                                                                      00318500
&ZLL     &ZLOP &ZLV                                                     00318600
.*                                                                      00318700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00318800
                      AGO   .ZL2           CONTINUE LOOPING             00318900
.*                                                                      00319000
.ZLX                  ANOP  ,                                           00319100
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00319200
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00319300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00319400
         L     14,16(0,0)                                               00319500
         L     14,CVTECVT-CVTMAP(14)                                    00319600
         TM    ECVTRRSW-ECVT(14),B'10000000'                            00319700
         BNZ   NSRV&SYSNDX                                              00319800
         L     14,ECVTRRSW-ECVT(14)                                     00319900
         L     14,280(14)                                               00320000
         PC    0(14)                                                    00320100
         B     DONE&SYSNDX                                              00320200
NSRV&SYSNDX EQU *                                                       00320300
         LA    15,ATRSRV_FAILURE                                        00320400
         LA    0,ATRSRV_RRS_NOT_ACTIVE                                  00320500
DONE&SYSNDX EQU *                                                       00320600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00320700
.ZLINKX               ANOP  ,                                           00320800
.*******************************************************************    00320900
.***AP.X01  FORMAT GENERATED CODE                                       00321000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00321100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00321200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00321300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00321400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00321500
                      AIF   (K'&ZLD LE 0).ZL51                          00321600
&ZLC                  SETA  35             COMMENT COLUMN               00321700
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00321800
&ZLC                  SETA  33             COMMENT COLUMN               00321900
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00322000
&ZLV                  SETC  '&ZLV'.' '                                  00322100
                      AGO   .ZL31                                       00322200
.*                                                                      00322300
.ZL41                 ANOP  ,                                           00322400
&ZLV                  SETC  '&ZLV'.' '                                  00322500
.ZL51                 ANOP  ,                                           00322600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00322700
.*                                                                      00322800
&ZLL     &ZLOP &ZLV                                                     00322900
.*                                                                      00323000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00323100
                      AGO   .ZL21          CONTINUE LOOPING             00323200
.*                                                                      00323300
.ZLX1                 ANOP  ,                                           00323400
.*******************************************************************    00323500
.***AP.X02  END OF ATRSRV MACRO                                         00323600
&ZATRSRV              SETC  'YES'          SET ATRSRV USED              00323700
         POP   PRINT                                                    00323800
*                                            ATRSRV-2                   00323900
         SPACE 1                                                        00324000
.ZLX2                 ANOP  ,                                           00324100
         MEND                                                           00324200
**********************************************************************/ 00324300
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00324400
*%ATRSRV: MACRO KEYS(REQUEST,RMNAME,URID,GNAME,SYSNAME,RCTABLE,RCNUM,   00324500
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00324600
*  ANS('?'||MACLABEL||' '||'ATRSRVP '||MACLIST||                        00324700
*         ' '||MACKEYS||';') COL(MACLMAR);                              00324800
*%END ATRSRV;                                                           00324900
