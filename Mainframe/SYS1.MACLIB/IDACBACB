         MACRO                                                          00050000
         IDACBACB &AM=,&MF=,&CALLER=,                                  C00100000
               &ACBLEN=,&ATRB=,&AVSPAC=,&BUFND=,   *** ACB KEYWORDS ***C00150000
               &BUFNI=,&BUFNO=,&BUFSP=,&CINV=,&DDNAME=,&ENDRBA=,       C00200000
               &ERROR=,&EXLST=,&FS=,&KEYLEN=,&LRECL=,                  C00250000
               &MACRF=,&NCIS=,&NDELR=,&NEXCP=,&NEXT=,&NINSR=,&NIXL=,   C00300000
               &NLOGR=,&NRETR=,&NSSS=,&NUPDR=,&OFLAGS=,&PASSWD=,&RKP=, C00350000
               &BSTRNO=,&CRA=,&OPENOBJ=,&AIXRKP=,               X04SVHSC00400000
               &MAREA=,&MLEN=,&JFCB=,                          @XM01140*00410000
               &USERPTR=,                                      @XM01129*00420000
               &RMODE31=,                                          @LPA*00435000
               &STRNO=,&STMST=,&CATALOG=,&APPLID=,&SHRPOOL=,       @LQC-00443300
               &SUBSYSNM=,&RLSREAD=,&CTRLACB=,                     @EAC-00448800
               &XAVSPAC=,&XENDRBA=,&XHALCRBA=,                     @EAA-00452500
               &CDTASIZE=,&SDTASIZE=                               @EAA 00456200
.*                                                                      00460000
.* $MAC(IDACBACB):                                                      00480000
.*                                                                      00500000
.*PROPRIETARY V3 STATEMENT                                              00500600
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00501200
.*"RESTRICTED MATERIALS OF IBM"                                         00501800
.*5695-DF1                                                              00502400
.*(C) COPYRIGHT 1983,1995  IBM CORP.                                    00503000
.*END PROPRIETARY V3 STATEMENT                                          00504200
.*                                                                      00505400
.* STATUS = DFSMS/MVS RELEASE 1.4.0                                     00506300
.*                                                                      00507200
.* $L3=DFP,JDP1110,,STLJRB: MVS/XA DFP RELEASE 1.1 VSAM 31-BIT     @L3A 00508100
.* $LY=DFP,HDP2230,,STLWBN: MVS/XA DFP RELEASE 2.3 DIV             @LYA 00508500
.* $LP=DFP,HDP2230,,STLJTP: MVS/XA DFP RELEASE 2.1 31/24 BIT       @LPA 00508600
.* APAR TO SHIP 31/24 BIT CODE                                 @YA04964 00508700
.*    $VR=DFP,HDP3330,,STLEES: MVS/XA DFP RELEASE 3.3 VRRDS        @VRA 00508800
.* CHECK ACB KEYWORD VALUES                                    @YA38069 00508900
.* COMPLETE FIX FOR OY38069                                    @YA38451 00509200
.* CHECK VALUES (PE OY38451/OY38069). ALLOW REGISTER NOTATION  @YA41530 00509300
.* FIX PE OY41530                                              @YA42642 00509400
.* OY41854,HDP3330,09/18/91,SJPLTLD: NO EXCL CTL WAIT SPE      @YA41854 00509600
.* $LQ=VSAMRLS,HDZ11C0,930910,SJPLRG: VSAM-RLS CBMM SUPPORT        @LQA 00509700
.* $EA=DFSMS,HDZ11C0,11/04/94,SJPLTLD: VSAM EXTENDED ADDRESSABILITY@EAA 00519700
.* $LT=VSAMRLS,HDZ11C0,930404,SJPLLL: VSAM-RLS CBMM SUPPORT        @LTA 00529700
.* $EA=OW14827,HDZ11C0,08/09/95,SJPLTLD: IDAVALC 17 BITS LONG      @EAA 00534700
.* SYNTAX ERROR FOR CONTINUATION LINE STARTING AT COLUMN 17    @WA22362 00537200
.* $LX=DFSMS,HDZ11D0,09/16/946SJPLJRB: SYSTEM MANAGED BUFFERS      @LXA 00538400
.* REMOVE THE INDRECT OPTION IN THE IDACB3 CALL FOR SUBSYSNM   @WA30993 00539000
.*                                                                      00539700
.* FUNCTION    THIS MACRO ACTS AS A CONTROLLER FOR GENCB, MODCB, AND    00549700
.*             TESTCB FOR PROCESSING AN ACB.                            00560000
.*             IT IS CALLED BY IDACB2 TO BUILD VARIOUS ARRAYS TO BE     00610000
.*             USED BY IDACB2 TO BUILD A PARAMETER LIST OF ARGUMENT     00660000
.*             CONTROL ENTRIES THAT WILL BE PASSED TO THE CONTROL       00710000
.*             BLOCK MANIPULATION MODULE AT EXECUTE TIME.               00760000
.*             FOR NON-BIT KEYWORDS, THIS MACRO CALLS IDACB3 WHICH      00810000
.*             ACTUALLY SETS VALUES INTO ALL THE ARRAYS THAT ARE        00860000
.*             REQUIRED.                                                00910000
.*                                                                      00920000
.*             FOR BIT KEYWORDS, IDACB3 IS CALLED, BUT THIS MACRO       00930000
.*             SETS THE VALUE IN THE &IDAVALC ARRAY.                    00960000
.*             IT ALSO VALIDITY CHECKS BIT OPTIONS AND IF MUTUALLY      01010000
.*             EXCLUSIVE OPTIONS ARE SPECIFIED, AN ERROR MESSAGE IS     01060000
.*             ISSUED.                                                  01110000
.*                                                                      01120000
.*             IT IS ALSO CALLED BY THE ACB DECLARATIVE MACRO TO        01130000
.*             PROCESS THE BIT KEYWORDS MACRF, CATALOG, AND CRA.        01140000
.*             WHEN CALLED BY ACB, DIFFERENT GLOBALS ARE SET THAN       01150000
.*             THOSE USED BY THE CBMM. THESE GLOBALS ARE SET IN SUCH    01160000
.*             A MANNER TO ALLOW THE DECLARATIVE MACRO TO GENERATE      01170000
.*             A 'DC' USING THE GLOBALS DIRECTLY.                       01172000
.* GLOBALS                                                              01180000
         GBLB  &IDACB01                ERROR INDICATOR                  01200000
         GBLA  &IDAENO                 NUMBER OF ELEMENTS               01250000
         GBLA  &IDAELEN(60)            ELEMENT FIELD LENGTH ARRAY  @LQC 01300000
         GBLC  &IDAVALC(60)            ELEMENT CHARACTER VALUE ARR @LQC 01350000
         GBLC  &IDAMAC1,&IDAMAC2,&IDAMAC3                               01400000
.*             MACRF VALUES FOR ACB DECLARATIVE MACRO           X04SVHS 01454000
.*             IDAMAC2 IS ALSO USED FOR CBMM MACROS                @LQA 01455000
         GBLC  &IDAIFL1                 CATALOG/CRA VALUES FOR  X04SVHS 01456000
.*                                      ACB DECLARATIVE MACRO   X04SVHS 01458000
.* LOCALS                                                               01460000
         LCLA  &I,&A,&B,&C                       WORK VARIABLES         01500000
         LCLB  &ESDS,&KSDS,&WCK,&SSWD,&REPL      ATRB CODES             01550000
         LCLB  &RRDS,&SPAN,&UNQ,&LDS,&VRRDS      ATRB CODES        @VRC 01583300
         LCLB  &XADDR,&CMPRS                     ATRB CODES        @EAA 01616600
         LCLB  &PATH,&BASE,&OAIX                 OPENOBJ CODES  X04SVHS 01650000
         LCLB  &SCRA,&UCRA                       CRA CODES      X04SVHS 01700000
         LCLB  &MKEY,&MADR,&MCNV,&MSEQ,&MSKP     MACRF CODES            01750000
         LCLB  &MDIR,&IN,&OUT,&NUB,&UBF          MACRF CODES            01800000
         LCLB  &LOGONF,&NLOGON                   MACRF CODES     X03004 01900000
         LCLB  &NFX,&CFX,&RST,&NRS,&DDN,&DSN     MACRF CODES   @XM01125 01950000
         LCLB  &NRM,&AIX,&NSR,&LSR,&GSR,&RLS     MACRF CODES       @LQC 02000000
         LCLB  &NCI,&ICI,&NDF,&DFR,&NIS,&SIS     MACRF CODES    X04SVHS 02050000
         LCLB  &LEW,&NLW                         MACRF CODES   @YA41854 02055000
         LCLB  &OPEN                             OFLAGS CODE    X04SVHS 02060000
         LCLB  &VSAM,&VTAM                       AM CODES        X03004 02100000
         LCLB  &YES,&NO                          CATALOG CODES  X04SVHS 02110000
         LCLB  &AMODE31                          ADDRESSING MODE   @L3A 02130000
         LCLB  &R31B,&R31C,&R31E                 RMODE31 FLAGS     @LPA 02140000
         LCLC  &Z16                     UNUSED PORTION OF BIT STRING    02150000
         LCLB  &NRI,&CR,&NORD           POSSIBLE RLSREAD VALUES    @LQA 02155000
.* INITIALIZATION                                                       02160000
&Z16     SETC  '0000000000000000'       SET TO 16 ZEROES                02170000
.* SCAN ACB KEYWORDS ************************************************** 02200000
.*                                      BUFND                           02220000
         AIF    ('&BUFND' EQ '').A000020                       @YA38069 02223700
         AIF   (T'&BUFND NE 'N').A000020  NOT NUMERIC          @YA38451 02226400
         AIF   ('&BUFND'(1,1) EQ '(').A000020   REG NOTATION   @YA41530 02227700
         AIF   ((&BUFND LT 0) OR (&BUFND GT 65535)).A000010    @YA38069 02229100
         AGO   .A000020                                        @YA38069 02231800
.A000010 IDAERMAC 3,BUFND,&BUFND           ISSUE ERROR MSG     @YA38069 02234800
&IDACB01 SETB  1                          SET ERROR SWITCH     @YA38069 02238500
         AGO   .A000030                                        @YA38069 02242200
.A000020 ANOP                                                  @YA38069 02245900
         IDACB3 ARG=&BUFND,ARGNAME=BUFND,KWTC=X'04',MF=&MF      X04SVHS 02250000
.A000030 ANOP                                                  @YA38069 02255000
.********************************************************************** 02260000
.*                                      BUFNI                   X04SVHS 02300000
         AIF   ('&BUFNI' EQ '').A000050                        @YA38069 02310000
         AIF   (T'&BUFNI NE 'N').A000050  NOT NUMERIC          @YA38451 02320000
         AIF   ('&BUFNI'(1,1) EQ '(').A000050   REG NOTATION   @YA41530 02325000
         AIF   ((&BUFNI LT 0) OR (&BUFNI GT 65535)).A000040    @YA38069 02330000
         AGO   .A000050                                        @YA38069 02340000
.A000040 IDAERMAC 3,BUFNI,&BUFNI           ISSUE ERROR MSG     @YA38069 02424800
&IDACB01 SETB  1                          SET ERROR SWITCH     @YA38069 02456000
         AGO   .A000060                                        @YA38069 02487200
.A000050 ANOP                                                  @YA38069 02518400
         IDACB3 ARG=&BUFNI,ARGNAME=BUFNI,KWTC=X'05',MF=&MF      X04SVHS 02550000
.A000060 ANOP                                                  @YA38451 02555000
.********************************************************************** 02560000
.*                                      BUFSP                   X04SVHS 02600000
         IDACB3 ARG=&BUFSP,ARGNAME=BUFSP,KWTC=X'07',MF=&MF      X04SVHS 02850000
.********************************************************************** 02860000
.*                                      DDNAME                          02900000
         AIF   ('&DDNAME' EQ '').A000300  *** DDNAME ***                03150000
         AIF   ('&CTRLACB' NE 'YES').A000070                       @LQA 03200000
         IDAERMAC 19,CTRLACB,DDNAME                                @LQA 03250000
&IDACB01 SETB  1                        SET ERROR SWITCH           @LQA 03300000
.A000070 AIF   ('&DDNAME(1)' EQ '*').A000200                       @LQC 03350000
.*             IF INDIRECT ADDRESS SPECIFIED, BYPASS VALIDITY CHECKS    03400000
         AIF   (K'&DDNAME GT 8).A000100                        @ZA38002 03800000
         AIF   (('&DDNAME'(1,1) LT 'A' OR '&DDNAME'(1,1) GT 'Z') AND   C03820000
               ('&DDNAME'(1,1) NE '#' AND '&DDNAME'(1,1) NE '@' AND    C03840000
               '&DDNAME'(1,1) NE '$')).A000100                 @ZA38002 03860000
.*             DDNAME MUST BE 8 OR FEWER CHARS, AND FIRST CHAR MUST     03880000
.*                             BE ALPHABETIC OR NATIONAL       @ZA38002 03900000
         AGO   .A000200                                                 04000000
.A000100 IDAERMAC 3,DDNAME,&DDNAME      ISSUE ERROR MESSAGE             04050000
&IDACB01 SETB  1                        SET ERROR SWITCH                04100000
         AGO   .A000300                 SKIP PROCESSING                 04102000
.A000200 ANOP                                                           04110000
         IDACB3 ARG=&DDNAME,ARGNAME=DDNAME,KWTC=X'09',MF=&MF,          *04120000
               INDRECT=YES                                      X04SVHS 04130000
&IDAELEN(&IDAENO) SETA 8                ELEMENT LENGTH IS 8 BYTES       04140000
.********************************************************************** 04140400
.A000300 ANOP                                                           04142000
.*                                      EXLST                           04144000
         IDACB3 ARG=&EXLST,ARGNAME=EXLST,KWTC=X'0C',MF=&MF      X04SVHS 04150000
.********************************************************************** 04152000
.*                                      JFCB                   @XM01140 04156000
         IDACB3 ARG=&JFCB,ARGNAME=JFCB,KWTC=X'8D',MF=&MF       @XM01140 04158000
.********************************************************************** 04160000
.*                                      CATALOG                         04200000
         AIF   ('&CATALOG' EQ '').A000500 *** CATALOG ***               04450000
         IDACB3 ARG=&CATALOG,ARGNAME=CATALOG,KWTC=X'22',MF=&MF,        *04600000
               INDRECT=YES,BIT=YES                              X04SVHS 04650000
         AIF   ('&CATALOG(1)' EQ '*').A000500                   X04SVHS 04660000
.*             IF INDIRECT ADDRESS SPECIFIED, VALUE ARRAY(&IDAVALC)     04670000
.*                                      WAS SET IN IDACB3               04680000
&YES     SETB  ('&CATALOG' EQ 'YES')                            X04SVHS 04700000
&NO      SETB  ('&CATALOG' EQ 'NO')                             X04SVHS 04750000
         AIF   (&YES OR &NO).A000400                            X04SVHS 04800000
         IDAERMAC 3,CATALOG,&CATALOG  ISSUE ERROR MESSAGE       X04SVHS 04850000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 04860000
.A000400 ANOP                                                   X04SVHS 04880000
         AIF   ('&CALLER' EQ 'ACB').A000500                     X04SVHS 04890000
.*             IF CALLER IS ACB, VALUE WILL BE SET IN CRA RTN   X04SVHS 04892000
&IDAVALC(&IDAENO) SETC '&YES&NO.00000000000000&Z16'             X04SVHS 04900000
.********************************************************************** 04910000
.*                                      SHRPOOL                @YA38069 04925500
.A000500 AIF   ('&SHRPOOL' EQ '').A000530                      @YA38069 04941000
         AIF   (T'&SHRPOOL NE 'N').A000520 NOT NUMERIC         @YA38451 04951000
         AIF   ('&SHRPOOL'(1,1) EQ '(').A000520  REG NOTATION  @YA41530 04956000
         AIF   ((&SHRPOOL LT 0) OR (&SHRPOOL GT 255)).A000510      @LXA 04963500
         AGO   .A000520                                        @YA38069 04971000
.A000510 IDAERMAC 3,SHRPOOL,&SHRPOOL       ISSUE ERROR MSG     @YA38069 04987500
&IDACB01 SETB  1                          SET ERROR SWITCH     @YA38069 05003000
         AGO   .A000530                                        @YA38069 05018500
.A000520 ANOP                                                  @YA38069 05034000
         IDACB3 ARG=&SHRPOOL,ARGNAME=SHRPOOL,KWTC=X'26',MF+&MF     @L3A 05050000
.*                                      MACRF                           05100000
.A000530 AIF   ('&MACRF' EQ '').A001750   *** MACRF ***            @L3C 05150000
         IDACB3 ARG=&MACRF,ARGNAME=MACRF,KWTC=X'12',MF=&MF,BIT=YES,    *05550000
               INDRECT=YES                                      X04SVHS 05600000
         AIF   ('&MACRF(1)' EQ '*').A001800                             05650000
.*             IF INDIRECT ADDRESS SPECIFIED, VALUE ARRAY(&IDAVALC)     05700000
.*                                      WAS SET IN IDACB3               05750000
&I       SETA  0                        CLEAR                   X04SVHS 06200000
&A       SETA  0                        WORK                    X04SVHS 06210000
&B       SETA  0                        VARIABLES               X04SVHS 06220000
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 06270000
.A000600 ANOP                                                           06322200
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 06336100
         AIF   (&I GT N'&MACRF).A000800 HAVE ALL OPTIONS BEEN CHECKED   06350000
&MKEY    SETB  ('&MACRF(&I)' EQ 'KEY' OR &MKEY)                 X04SVHS 06400000
&MADR    SETB  ('&MACRF(&I)' EQ 'ADR' OR &MADR)                 X04SVHS 06450000
&MCNV    SETB  ('&MACRF(&I)' EQ 'CNV' OR &MCNV)                 X04SVHS 06500000
&MSEQ    SETB  ('&MACRF(&I)' EQ 'SEQ' OR &MSEQ)                 X04SVHS 06550000
&MSKP    SETB  ('&MACRF(&I)' EQ 'SKP' OR &MSKP)                 X04SVHS 06600000
&MDIR    SETB  ('&MACRF(&I)' EQ 'DIR' OR &MDIR)                 X04SVHS 06650000
&OUT     SETB  ('&MACRF(&I)' EQ 'OUT' OR &OUT)                  X04SVHS 06700000
&IN      SETB  ('&MACRF(&I)' EQ 'IN' OR &IN)                    X04SVHS 06750000
&NUB     SETB  ('&MACRF(&I)' EQ 'NUB' OR &NUB)                  X04SVHS 06800000
&UBF     SETB  ('&MACRF(&I)' EQ 'UBF' OR &UBF)                  X04SVHS 06850000
&NFX     SETB  ('&MACRF(&I)' EQ 'NFX' OR &NFX)                  X04SVHS 06900000
&CFX     SETB  ('&MACRF(&I)' EQ 'CFX' OR &CFX)                  X04SVHS 06950000
&DDN     SETB  ('&MACRF(&I)' EQ 'DDN' OR &DDN)                  X04SVHS 07050000
&DSN     SETB  ('&MACRF(&I)' EQ 'DSN' OR &DSN)                  X04SVHS 07100000
&NRM     SETB  ('&MACRF(&I)' EQ 'NRM' OR &NRM)                  X04SVHS 07150000
&AIX     SETB  ('&MACRF(&I)' EQ 'AIX' OR &AIX)                  X04SVHS 07200000
&NSR     SETB  ('&MACRF(&I)' EQ 'NSR' OR &NSR)                  X04SVHS 07250000
&LSR     SETB  ('&MACRF(&I)' EQ 'LSR' OR &LSR)                  X04SVHS 07300000
&GSR     SETB  ('&MACRF(&I)' EQ 'GSR' OR &GSR)                  X04SVHS 07350000
&RLS     SETB  ('&MACRF(&I)' EQ 'RLS' OR &RLS)                     @LQA 07375000
&NCI     SETB  ('&MACRF(&I)' EQ 'NCI' OR &NCI)                  X04SVHS 07400000
&ICI     SETB  ('&MACRF(&I)' EQ 'ICI' OR &ICI)                  X04SVHS 07450000
&NDF     SETB  ('&MACRF(&I)' EQ 'NDF' OR &NDF)                  X04SVHS 07500000
&DFR     SETB  ('&MACRF(&I)' EQ 'DFR' OR &DFR)                  X04SVHS 07550000
&NIS     SETB  ('&MACRF(&I)' EQ 'NIS' OR &NIS)                  X04SVHS 07600000
&SIS     SETB  ('&MACRF(&I)' EQ 'SIS' OR &SIS)                  X04SVHS 07650000
&RST     SETB  ('&MACRF(&I)' EQ 'RST' OR &RST)                 @XM01125 07652000
&NRS     SETB  ('&MACRF(&I)' EQ 'NRS' OR &NRS)                 @XM01125 07654000
&LEW     SETB  ('&MACRF(&I)' EQ 'LEW' OR &LEW)                 @YA41854 07654400
&NLW     SETB  ('&MACRF(&I)' EQ 'NLW' OR &NLW)                 @YA41854 07654800
&AMODE31 SETB  (('&MACRF(&I)' EQ 'AMODE31' OR &AMODE31) AND            X07655200
               (T'&RMODE31 EQ 'O'))                                @LPA 07656400
&R31E    SETB  (('&MACRF(&I)' EQ 'AMODE31' OR &R31E) AND               X07657600
               ('&RMODE31' NE ''))                                 @LPA 07658800
&A       SETA  &MKEY+&MADR+&MCNV+&MSEQ+&MSKP+&MDIR+&OUT+&IN+&NUB+&UBF+&*07660000
               NFX+&CFX+&DDN+&DSN+&NRM+&AIX+&NSR+&LSR+&GSR+&NCI+&ICI+&N*07670000
               DF+&DFR+&NIS+&SIS+&RST+&NRS+&LEW+&NLW+&AMODE31+&R31E     07674000
.*                                                             @YA41854 07678000
&A       SETA  &A+&RLS                                             @LQA 07680000
.*             &A CONTAINS THE NUMBER OF VSAM OPTIONS SPECIFIED         07682000
.*             &B CONTAINS THE NUMBER OF VTAM OPTIONS SPECIFIED         07684000
.*             &C CONTAINS THE NUMBER OF ERRORS                         07684400
.*             IF THEY EQUAL &I AT THIS POINT, THEN THE LAST            07686000
.*             OPTION SPECIFIED WAS A VALID VSAM OPTION                 07688000
         AIF   (&A+&B+&C EQ &I).A000600 IF NEW VSAM BIT SET CHK X04SVHS 07690000
.*                                      NEXT SUBPARAMETER               07692000
.*                                      ELSE CHECK VTAM OPTIONS X04SVHS 07694000
&LOGONF  SETB  ('&MACRF(&I)' EQ 'LOGON' OR &LOGONF)              X03004 07700000
&NLOGON  SETB  ('&MACRF(&I)' EQ 'NLOGON' OR &NLOGON)             X03004 07750000
&B       SETA  &LOGONF+&NLOGON                                  X04SVHS 07760000
         AIF   (&A+&B+&C EQ &I).A000700 IF NEW VTAM BIT SET CHK X04SVHS 07770000
.*                                      FOR AM=VTAM             X04SVHS 07780000
.*             IF &A + &B + &C DO NOT EQUAL &I AT THIS POINT, THEN THE  07790000
.*             LAST OPTION CHECKED WAS INVALID OR DUPLICATED A          07792000
.*             PREVIOUSLY CHECKED OPTION                                07794000
         IDAERMAC 5,MACRF,&MACRF(&I)    ISSUE ERROR MESSAGE     X04SVHS 07800000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 07850000
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 07860000
         AGO   .A000600                                                 07900000
.*                                                                 @LPA 07950000
.A000700 AIF   ('&AM' EQ 'VTAM').A000600 IF VTAM NOT SPECIFIED,         08200000
         IDAERMAC 20,&MACRF(&I),MACRF    ISSUE ERROR MESSAGE     X03004 08250000
&IDACB01 SETB  1                         SET ERROR SWITCH        X03004 08300000
         AGO   .A000600                  CHECK NEXT OPTION      X04SVHS 08350000
.*                                                                      08360000
.*             THE FOLLOWING CODE CHECKS FOR MUTUALLY EXCLUSIVE         08370000
.*             OPTIONS SPECIFIED,AND IF ANY ARE FOUND, AN ERROR         08380000
.*             MESSAGE IS ISSUED AND THE ERROR SWITCH IS SET            08390000
.A000800 AIF   (NOT(&UBF AND &NUB)).A000900                     X04SVHS 08400000
         IDAERMAC 8,MACRF,UBF,NUB                                       08450000
&IDACB01 SETB  1                                                        08500000
.A000900 AIF   (NOT(&LOGONF AND &NLOGON)).A001000               X04SVHS 08550000
         IDAERMAC 8,MACRF,LOGON,NLOGON                           X03004 08600000
&IDACB01 SETB  1                                                 X03004 08650000
.A000950 AIF   (NOT(&RST AND &NRS)).A001000                    @XM01125 08660000
         IDAERMAC 8,MACRF,RST,NRS                              @XM01125 08670000
&IDACB01 SETB  1                        SET ERR SWITCH         @XM01125 08680000
.A001000 AIF   (NOT(&NFX AND &CFX)).A001100                     X04SVHS 08700000
         IDAERMAC 8,MACRF,NFX,CFX                               X04SVHS 08750000
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 08800000
.A001100 AIF   (NOT(&DDN AND &DSN)).A001200                     X04SVHS 08850000
         IDAERMAC 8,MACRF,DDN,DSN                               X04SVHS 08900000
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 08950000
.A001200 AIF   (NOT(&NRM AND &AIX)).A001300                     X04SVHS 09000000
         IDAERMAC 8,MACRF,NRM,AIX                               X04SVHS 09050000
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09100000
.******** CHECK THAT GSR, LSR, NSR, AND RLS ARE MUTUALLY EXCLUSIVE @LQA 09108300
.A001300 AIF   (NOT(&NSR AND &GSR)).A001310                        @LQC 09116600
         IDAERMAC 8,MACRF,NSR,GSR                                  @LQA 09124900
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09133200
.A001310 AIF   (NOT(&NSR AND &LSR)).A001320                        @LQA 09141500
         IDAERMAC 8,MACRF,NSR,LSR                                  @LQA 09149800
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09158100
.A001320 AIF   (NOT(&NSR AND &RLS)).A001330                        @LQA 09166400
         IDAERMAC 8,MACRF,NSR,RLS                                  @LQA 09174700
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09183000
.A001330 AIF   (NOT(&GSR AND &LSR)).A001340                        @LQA 09191300
         IDAERMAC 8,MACRF,GSR,LSR                                  @LQA 09199600
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09207900
.A001340 AIF   (NOT(&GSR AND &RLS)).A001350                        @LQA 09216200
         IDAERMAC 8,MACRF,GSR,RLS                                  @LQA 09224500
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09232800
.A001350 AIF   (NOT(&LSR AND &RLS)).A001400                        @LQA 09241100
         IDAERMAC 8,MACRF,LSR,RLS                                  @LQA 09249400
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09257700
.******** CHECK THE OTHER MACRF SUBPARMS THAT ARE INVALID WITH RLS @LQA 09266000
.A001400 AIF   (NOT(&RLS AND &MCNV)).A001420                       @LQA 09274300
         IDAERMAC 8,MACRF,RLS,CNV                                  @LQA 09282600
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09290900
.*NOTE: RLS AND ADR ARE COMPATIBLE FOR ESDS                        @LQA 09299200
.A001420 AIF   (NOT(&RLS AND &ICI)).A001430                        @LQA 09307500
         IDAERMAC 8,MACRF,RLS,ICI                                  @LQA 09315800
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09324100
.A001430 AIF   (NOT(&RLS AND &AIX)).A001440                        @LQA 09332400
         IDAERMAC 8,MACRF,RLS,AIX                                  @LQA 09340700
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09349000
.A001440 AIF   (NOT(&RLS AND &UBF)).A001450                        @LQA 09357300
         IDAERMAC 8,MACRF,RLS,UBF                                  @LQA 09365600
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09373900
.******** END OF CHECKING MACRF PARMS MUTUALLY EXCLUSIVE WITH RLS  @LQA 09382200
.A001450 AIF   (NOT(&NCI AND &ICI)).A001500                        @LQC 09390500
         IDAERMAC 8,MACRF,NCI,ICI                               X04SVHS 09400000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 09450000
.A001500 AIF   (NOT(&NDF AND &DFR)).A001600                     X04SVHS 09500000
         IDAERMAC 8,MACRF,NDF,DFR                               X04SVHS 09550000
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09600000
.A001600 AIF   (NOT(&NIS AND &SIS)).A001700                     X04SVHS 09650000
         IDAERMAC 8,MACRF,NIS,SIS                               X04SVHS 09700000
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09750000
.A001700 AIF   (NOT(&LEW AND &NLW)).A001710                    @YA41854 09760000
         IDAERMAC 8,MACRF,LEW,NLW                              @YA41854 09770000
&IDACB01 SETB  1                        SET ERR SWITCH         @YA41854 09780000
.*                                                             @YA41854 09790000
.A001710 ANOP                                                  @YA41854 09800000
         AIF   ('&CALLER' EQ 'ACB').A001750                     X04SVHS 09810000
.*             IF CALLED BY DECLARATIVE, BYPASS CBMM PROCESSING         09820000
.*                                                                      09830000
&IDAVALC(&IDAENO) SETC '&MKEY&MADR&MCNV&MSEQ&MSKP&MDIR&IN&OUT&NUB&UBF&L*09850000
               OGONF&NLOGON&AMODE31&DDN&DSN&NRM&AIX&NSR&LSR&GSR&NCI&ICI*09900000
               &NDF&DFR&NIS&SIS&NFX&CFX&RST&NRS&LEW&NLW'       @YA41854 09950000
&IDAMAC2 SETC  '&RLS.000000000000000&Z16'                          @LQA 09950600
&IDAELEN(&IDAENO) SETA 8                                           @LQA 09951200
.*             SET GLOBAL ARRAY TO BE USED BY IDACB2 TO BUILD           09952000
.*             PARAMETER LIST                                           09954000
         AGO   .A001760                 BYPASS DECLARATIVE PROC    @LQC 09958000
.A001750 ANOP                                                   X04SVHS 09962000
         AIF   ('&CALLER' NE 'ACB').A001760                        @LQC 09962200
.*             THE FOLLOWING CODE SETS DEFAULT VALUES FOR ACB           09962400
.*             DECLARATIVE.  THE DEFAULTS FOR CBM WILL BE SET AT        09962800
.*             EXECUTE TIME.                                            09963200
.*                                                                      09963600
&MKEY    SETB  (NOT(&MADR OR &MCNV) OR &MKEY)                   X04SVHS 09963700
.*             MKEY IS DEFAULT IF MADR OR MCNV ARE NOT SPECIFIED        09963800
&MSEQ    SETB  (NOT(&MSKP OR &MDIR) OR &MSEQ)                   X04SVHS 09963900
.*             MSEQ IS DEFAULT IF MSKP OR MDIR ARE NOT SPECIFIED        09965900
&IN      SETB  (NOT(&OUT) OR &IN)                               X04SVHS 09967900
.*             IN IS DEFAULT IF OUT IS NOT SPECIFIED            X04SVHS 09968000
.*                                                                      09968300
.*             SET MACRF VALUES IN GLOBALS FOR ACB DECLARATIVE  X04SVHS 09968400
&IDAMAC1 SETC  '&MKEY&MADR&MCNV&MSEQ&MDIR&IN&OUT&UBF'           X04SVHS 09970000
&IDAMAC2 SETC  '000&MSKP&NLOGON&RST&DSN&AIX'                    X04SVHS 09972000
&IDAMAC3 SETC  '&NLW&LSR&GSR&ICI&DFR&SIS&CFX.0'                @YA41854 09974000
         AGO   .A002200                 PROCESS CRA             X04SVHS 09976000
.******************************************************************@LQA 09976500
.A001760 ANOP                                                      @LQA 09977000
.*                                      CTRLACB                    @LQA 09977500
         AIF   ('&CTRLACB' EQ '').A001770                          @LQA 09978000
         IDACB3 ARG=&CTRLACB,ARGNAME=CTRLACB,KWTC=X'75',MF=&MF,    @LQA-09978500
               INDRECT=YES,BIT=YES                                 @LQA 09979000
         AIF   ('&CTRLACB(1)' EQ '*').A001770                      @LQA 09979500
.*             IF INDIRECT ADDR SPECIFIED, VALUE ARRAY(&IDAVALC)   @LQA 09980000
.*                                      WAS SET IN IDACB3          @LQA 09980500
&YES     SETB  ('&CTRLACB' EQ 'YES')                               @LQA 09981000
&NO      SETB  ('&CTRLACB' EQ 'NO')                                @LQA 09981500
         AIF   (&YES OR &NO).A001765                               @LQA 09982000
         IDAERMAC 3,CTRLACB,&CTRLACB  ISSUE ERROR MESSAGE          @LQA 09982500
&IDACB01 SETB  1                        SET ERROR SWITCH           @LQA 09983000
.A001765 ANOP                                                      @LQA 09983500
&IDAVALC(&IDAENO) SETC '&YES&NO.00000000000000&Z16'                @LQA 09984000
.******************************************************************@LQA 09984500
.A001770 ANOP                                                      @LQA 09985000
.*                                      SUBSYSNM                   @LQA 09985500
         AIF   ('&SUBSYSNM' EQ '').A001780                         @LQA 09986000
         IDACB3 ARG=&SUBSYSNM,ARGNAME=SUBSYSNM,KWTC=X'76',MF=&MF        09986500
.*                                                             @WA30993 09987000
.******************************************************************@LQA 09987500
.A001780 ANOP                                                      @LQA 09988000
.*                                      RLSREAD                    @LQA 09988500
         AIF   ('&RLSREAD' EQ '').A001800                          @LQA 09989000
         IDACB3 ARG=&RLSREAD,ARGNAME=RLSREAD,KWTC=X'77',MF=&MF,    @LQA-09989500
               INDRECT=YES,BIT=YES                                 @LQA 09990000
         AIF   ('&RLSREAD(1)' EQ '*').A001800                      @LQA 09990500
.*             IF INDIRECT ADDR SPECIFIED, VALUE ARRAY(&IDAVALC)   @LQA 09991000
.*                                      WAS SET IN IDACB3          @LQA 09991500
&NRI     SETB  ('&RLSREAD' EQ 'NRI')                               @LQA 09992000
&CR      SETB  ('&RLSREAD' EQ 'CR')                                @LQA 09992500
&NORD    SETB  ('&RLSREAD' EQ 'NORD')                              @LQA 09993000
         AIF   (&NRI OR &CR OR &NORD).A001785                      @LQA 09993500
         IDAERMAC 3,RLSREAD,&RLSREAD  ISSUE ERROR MESSAGE          @LQA 09994000
&IDACB01 SETB  1                        SET ERROR SWITCH           @LQA 09994500
.A001785 ANOP                                                      @LQA 09995000
&IDAVALC(&IDAENO) SETC '&NRI&CR&NORD.0000000000000&Z16'            @LQA 09995500
.********************************************************************** 09996000
.A001800 ANOP                                                   X04SVHS 09996500
.*                                      PASSWD                          09997000
         IDACB3 ARG=&PASSWD,ARGNAME=PASSWD,KWTC=X'1E',MF=&MF    X04SVHS 10000000
.********************************************************************** 10010000
.*                                      STRNO                           10050000
         AIF   ('&STRNO' EQ '').A001815                        @YA38069 10054900
         AIF   (T'&STRNO NE 'N').A001815   NOT NUMERIC         @YA38451 10059800
         AIF   ('&STRNO'(1,1) EQ '(').A001815   REG NOTATION   @YA41530 10062200
         AIF   (&STRNO LT 1).A001805  REMOVE TEST FOR >255 BECAUSE @LTC 10064600
.*                                    RLS HAS LIMIT OF 1024        @LTA 10067000
         AGO   .A001815                                        @YA38069 10069600
.A001805 IDAERMAC 3,STRNO,&STRNO           ISSUE ERROR MSG     @YA38069 10074800
&IDACB01 SETB  1                          SET ERROR SWITCH     @YA38069 10081000
         AGO   .A001820                                        @YA38069 10087200
.A001815 ANOP                                                  @YA38069 10093400
         IDACB3 ARG=&STRNO,ARGNAME=STRNO,KWTC=X'20',MF=&MF      X04SVHS 10100000
.A001820 ANOP                                                  @YA38451 10125000
.********************************************************************** 10150000
.*                                      USERPTR                @XM01129 10200000
         AIF ('&USERPTR' EQ '' OR '&USERPTR' EQ '0').A001850   @XM01129 10220000
         IDACB3 ARG=&USERPTR,ARGNAME=USERPTR,KWTC=X'8C',MF=&MF @XM01129 10230000
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '').A001825       @XM01129 10240000
.*                                   IF AM NOT VSAM OR NULL, ERROR      10250000
         AGO   .A001850                                        @XM01129 10260000
.A001825 IDAERMAC 24,USERPTR                                   @XM01129 10270000
&IDACB01 SETB  1                                               @XM01129 10290000
.********************************************************************** 10300000
.A001850  ANOP                                                          10310000
.*                                      APPLID                          10350000
         IDACB3 ARG=&APPLID,ARGNAME=APPLID,KWTC=X'41',MF=&MF,          *10400000
               CHKAM=VTAM,AM=&AM                                X04SVHS 10450000
.********************************************************************** 10452000
.*                                      RMODE31                    @LPA 10459500
         AIF   ('&RMODE31' EQ '').A001875     NO RMODE31 SPECIFIED @LPA 10467000
         IDACB3 ARG=&RMODE31,ARGNAME=RMODE31,KWTC=X'47',BIT=YES    @LPA 10474500
.*              INDRECT=YES,BIT=YES                                @LPA 10482000
&R31B    SETB  (('&RMODE31' EQ 'BUFF') OR ('&RMODE31' EQ 'ALL'))   @LPA 10489500
&R31C    SETB  ('&RMODE31' EQ 'CB' OR '&RMODE31' EQ 'ALL')         @LPA 10497000
&IDAVALC(&IDAENO) SETC '&R31B&R31C.00000000000000&Z16'             @LPA 10504500
         AIF   (NOT &R31E).A001875                                 @LPA 10512000
         IDAERMAC  26,AMODE31                                      @LPA 10519500
.********************************************************************** 10527000
.*                                       AM                             10534500
.A001875 AIF   ('&AM' EQ '' OR '&CALLER' NE 'GEN').A002000         @LPC 10542000
.*             ARGUMENT CONTROL ENTRY IS ONLY BUILT FOR GENCB FOR AM    10550000
         IDACB3 ARG=&AM,ARGNAME=AM,KWTC=X'40',BIT=YES           X04SVHS 10750000
&VSAM    SETB  ('&AM' EQ 'VSAM')                                X04SVHS 10800000
&VTAM    SETB  ('&AM' EQ 'VTAM')                                X04SVHS 10850000
         AIF   (&VSAM OR &VTAM).A001900                         X04SVHS 10900000
.*             CHECK FOR VALID OPTION                           X04SVHS 10910000
         IDAERMAC 5,AM,&AM                                      X04SVHS 10950000
&IDACB01 SETB  1                         SET ERROR SWITCH       X04SVHS 11000000
.A001900    ANOP                                                X04SVHS 11050000
&IDAVALC(&IDAENO) SETC '&VSAM&VTAM.00000000000000&Z16'          X04SVHS 11100000
.********************************************************************** 11110000
.A002000 ANOP                                                   X04SVHS 11150000
.*                                      MAREA                           11660000
         IDACB3 ARG=&MAREA,ARGNAME=MAREA,KWTC=X'0E',MF=&MF      X04SVHS 11750000
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '' AND '&MAREA' NE        *12000000
               '').A002050                                      X04SVHS 12010000
.*                                      IF AM NOT VSAM OR NULL  X04SVHS 12050000
.*                                      ERROR                   X04SVHS 12100000
         AGO   .A002100                                         X04SVHS 12110000
.A002050 ANOP                                                   X04SVHS 12120000
         IDAERMAC 24,MAREA                                      X04SVHS 12150000
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 12200000
.********************************************************************** 12210000
.A002100 ANOP                                                   X04SVHS 12250000
.*                                        MLEN                  X04SVHS 12260000
         IDACB3 ARG=&MLEN,ARGNAME=MLEN,KWTC=X'0F',MF=&MF        X04SVHS 12350000
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '' AND '&MLEN' NE         *12600000
               '').A002150                                      X04SVHS 12610000
.*                                      IF AM NOT EQUAL TO VSAM X04SVHS 12650000
.*                                      OR NULL, ERROR          X04SVHS 12700000
         AGO   .A002200                                         X04SVHS 12710000
.A002150 ANOP                                                   X04SVHS 12720000
         IDAERMAC 24,MLEN                                       X04SVHS 12750000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 12800000
.********************************************************************** 12810000
.A002200 ANOP                                                   X04SVHS 12850000
.*                                      CRA                             13200000
         AIF   ('&CRA' EQ '').A002350 *** CRA ***               X04SVHS 13250000
.*             IF CRA IS NULL, CHECK FOR CALLER = ACB           X04SVHS 13260000
&SCRA    SETB  ('&CRA' EQ 'SCRA')                              @XM07755 13300000
&UCRA    SETB  ('&CRA' EQ 'UCRA')                              @XM07755 13350000
         AIF   (&SCRA OR &UCRA).A002300 CHK FOR VALID OPTION    X04SVHS 13400000
         IDAERMAC 5,CRA,&CRA            ISSUE ERROR MESSAGE     X04SVHS 13450000
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 13500000
         AGO   .A002400                 BYPASSING PROCESSING KEYWORD    13550000
.*                                                              X04SVHS 13560000
.A002300 ANOP                                                   X04SVHS 13600000
         AIF   ('&CALLER' EQ 'ACB').A002375                     X04SVHS 13610000
.*             IF CALLER IS ACB BYPASS CBM PROCESSING           X04SVHS 13620000
         IDACB3 ARG=&CRA,KWTC=X'59',BIT=YES                     X04SVHS 13650000
&IDAVALC(&IDAENO) SETC '&SCRA&UCRA.00000000000000&Z16'          X04SVHS 13800000
         AGO   .A002400                 BYPASS DECLARATIVE PROC X04SVHS 13810000
.A002350 ANOP                                                   X04SVHS 13820000
.*             AT THIS POINT, EITHER CRA IS NOT SPECIFIED, OR   X04SVHS 13830000
.*             CALLER = ACB                                     X04SVHS 13840000
         AIF   ('&CALLER' NE 'ACB').A002400                     X04SVHS 13842000
.*             IF CALLER NOT ACB, BYPASS DECLARATIVE PROCESSING X04SVHS 13844000
.A002375 ANOP                                                   X04SVHS 13844400
&IDAIFL1 SETC  '000&YES&SCRA&UCRA.00'   SET ACB INFLGS BYTE 1   X04SVHS 13846000
.*             ALL BIT KEYWORDS HAVE BEEN PROCESSED FOR DECLARATIVE     13848000
         MEXIT                                                  X04SVHS 13848400
.********************************************************************** 13848800
.A002400 ANOP                                                   X04SVHS 13850000
.*                                      BSTRNO                          13860000
         AIF   ('&BSTRNO' EQ '').A002420                       @YA38069 13864000
         AIF   (T'&BSTRNO NE 'N').A002420   NOT NUMERIC        @YA38451 13868000
         AIF   ('&BSTRNO'(1,1) EQ '(').A002420  REG NOTATION   @YA41530 13870000
         AIF   ((&BSTRNO LT 0) OR (&BSTRNO GT 255)).A002410    @YA38069 13872000
         AGO   .A002420                                        @YA38069 13876000
.A002410 IDAERMAC 3,BSTRNO,&BSTRNO         ISSUE ERROR MSG     @YA38069 13880000
&IDACB01 SETB  1                          SET ERROR SWITCH     @YA38069 13885000
         AGO   .A002430                                        @YA38069 13890000
.A002420 ANOP                                                  @YA38069 13895000
         IDACB3 ARG=&BSTRNO,ARGNAME=BSTRNO,KWTC=X'24',MF=&MF    X04SVHS 13900000
.*   DELETE AIF ERRONEOUSLY ADDED BY OY41530                   @YA42642 13910000
.A002430 ANOP                                                  @YA38069 13925000
.********************************************************************** 13950000
.*                                                                      14200000
         AIF   ('&CALLER' NE 'TEST').A003800                            14250000
.*                                                                      14252000
.*             THE FOLLOWING KEYWORDS ARE VALID FOR TESTCB ONLY         14260000
.*                                                                      14262000
.********************************************************************** 14264000
.*                                      ATRB                            14270000
         AIF   ('&ATRB' EQ '').A002800    *** ATRB ***                  14300000
         IDACB3 ARG=&ATRB,ARGNAME=ATRB,KWTC=X'01',MF=&MF,INDRECT=YES,  *14350000
               BIT=YES                                          X04SVHS 14400000
         AIF   ('&ATRB(1)' EQ '*').A002800                      X04SVHS 14450000
.*             IF INDIRECT ADDRESS WAS SPECIFIED, VALUE ARRAY(&IDAVALC) 14500000
.*             WAS SET IN IDACB3                                        14550000
&I       SETA  0                        ZERO INDEX INTO LIST            15000000
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 15010000
.A002500 ANOP                                                           15050000
&I       SETA  &I+1                     BUMP INDEX INTO LIST            15100000
         AIF   (&I GT N'&ATRB).A002600  HAVE ALL OPTIONS BEEN CHECKED   15150000
&ESDS    SETB  ('&ATRB(&I)' EQ 'ESDS' OR &ESDS)                 X04SVHS 15200000
&KSDS    SETB  ('&ATRB(&I)' EQ 'KSDS' OR &KSDS)                 X04SVHS 15250000
&WCK     SETB  ('&ATRB(&I)' EQ 'WCK' OR &WCK)                   X04SVHS 15300000
&SSWD    SETB  ('&ATRB(&I)' EQ 'SSWD' OR &SSWD)                 X04SVHS 15350000
&REPL    SETB  ('&ATRB(&I)' EQ 'REPL' OR &REPL)                 X04SVHS 15400000
&RRDS    SETB  ('&ATRB(&I)' EQ 'RRDS' OR &RRDS)                 X04SVHS 15450000
&SPAN    SETB  ('&ATRB(&I)' EQ 'SPAN' OR &SPAN)                 X04SVHS 15500000
&UNQ     SETB  ('&ATRB(&I)' EQ 'UNQ' OR &UNQ)                   X04SVHS 15550000
&LDS     SETB  ('&ATRB(&I)' EQ 'LDS' OR &LDS)                      @LYA 15557500
&VRRDS   SETB  ('&ATRB(&I)' EQ 'VRRDS' OR &VRRDS)                  @VRA 15563100
&XADDR   SETB  ('&ATRB(&I)' EQ 'XADDR' OR &XADDR)                  @EAA 15564900
&CMPRS   SETB  ('&ATRB(&I)' EQ 'COMPRESS' OR &CMPRS)               @EAA 15566800
         AIF   (&ESDS+&KSDS+&WCK+&SSWD+&REPL+&RRDS+&SPAN+&UNQ+&LDS+&VRR*15568700
               DS+&XADDR+&CMPRS+&C EQ &I).A002500 CHK-VALID OPTION @VRC 15574300
.*             IF A NEW BIT WAS NOT SET, THEN LAST OPTION CHECKED       15580000
.*             IS INVALID OR DUPLICATES A PREVIOUSLY SPEC OPTION        15590000
         IDAERMAC 5,ATRB,&ATRB(&I)      ISSUE ERROR MESSAGE     X04SVHS 15600000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 15650000
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 15660000
         AGO   .A002500                                         X04SVHS 15700000
.A002600 AIF   (NOT(&ESDS AND &KSDS)).A002700                           15750000
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     15760000
         IDAERMAC 8,ATRB,ESDS,KSDS      ISSUE ERROR MESSAGE             15800000
&IDACB01 SETB  1                        SET ERROR SWITCH                15850000
.A002700 ANOP                                                           15900000
&IDAVALC(&IDAENO) SETC '&KSDS&ESDS&WCK&SSWD&REPL&RRDS&SPAN&UNQ&LDS&VRRD*15950000
               S&XADDR&CMPRS.0000&Z16'                             @EAC 15950400
.********************************************************************** 15950800
.A002800 ANOP                                                           15952000
.*                                      AVSPAC                          15960000
         IDACB3 ARG=&AVSPAC,ARGNAME=AVSPAC,KWTC=X'02',MF=&MF    X04SVHS 16000000
.********************************************************************** 16010000
.*                                      XAVSPAC                    @EAA 16020000
         IDACB3 ARG=&XAVSPAC,ARGNAME=XAVSPAC,KWTC=X'48'            @EAA 16030000
.********************************************************************** 16040000
.*                                      BUFNO                           16050000
         IDACB3 ARG=&BUFNO,ARGNAME=BUFNO,KWTC=X'06',MF=&MF      X04SVHS 16300000
.********************************************************************** 16310000
.*                                      CINV                            16350000
         IDACB3 ARG=&CINV,ARGNAME=CINV,KWTC=X'08',MF=&MF        X04SVHS 16600000
.********************************************************************** 16610000
.*                                      ENDRBA                          16650000
         IDACB3 ARG=&ENDRBA,ARGNAME=ENDRBA,KWTC=X'0A',MF=&MF    X04SVHS 16900000
.********************************************************************** 16902500
.*                                      XENDRBA                    @EAA 16905000
         IDACB3 ARG=&XENDRBA,ARGNAME=XENDRBA,KWTC=X'64',MF=&MF     @EAA 16907500
.********************************************************************** 16910000
.*                                      XHALCRBA                   @EAA 16914000
         IDACB3 ARG=&XHALCRBA,ARGNAME=XHALCRBA,KWTC=X'7B',MF=&MF   @EAA 16918000
.********************************************************************** 16922000
.*                                      CDTASIZE                   @EAA 16926000
         IDACB3 ARG=&CDTASIZE,ARGNAME=CDTASIZE,KWTC=X'97',MF=&MF   @EAA 16930000
.********************************************************************** 16934000
.*                                      SDTASIZE                   @EAA 16938000
         IDACB3 ARG=&SDTASIZE,ARGNAME=SDTASIZE,KWTC=X'98',MF=&MF   @EAA 16942000
.********************************************************************** 16946000
.*                                      ERROR                           16950000
         IDACB3 ARG=&ERROR,ARGNAME=ERROR,KWTC=X'0B',MF=&MF      X04SVHS 17200000
.********************************************************************** 17210000
.*                                      FS                              17250000
         IDACB3 ARG=&FS,ARGNAME=FS,KWTC=X'0D',MF=&MF            X04SVHS 17500000
.********************************************************************** 17510000
.*                                      KEYLEN                          17550000
         IDACB3 ARG=&KEYLEN,ARGNAME=KEYLEN,KWTC=X'10',MF=&MF    X04SVHS 17800000
.********************************************************************** 17810000
.*                                      LRECL                           17850000
         IDACB3 ARG=&LRECL,ARGNAME=LRECL,KWTC=X'11',MF=&MF      X04SVHS 18100000
.********************************************************************** 18110000
.*                                      NCIS                            18150000
         IDACB3 ARG=&NCIS,ARGNAME=NCIS,KWTC=X'13',MF=&MF        X04SVHS 18400000
.********************************************************************** 18410000
.*                                      NDELR                           18450000
         IDACB3 ARG=&NDELR,ARGNAME=NDELR,KWTC=X'14',MF=&MF      X04SVHS 18700000
.********************************************************************** 18710000
.*                                      NEXCP                           18750000
         IDACB3 ARG=&NEXCP,ARGNAME=NEXCP,KWTC=X'15',MF=&MF      X04SVHS 19000000
.********************************************************************** 19010000
.*                                      NEXT                            19050000
         IDACB3 ARG=&NEXT,ARGNAME=NEXT,KWTC=X'16',MF=&MF        X04SVHS 19300000
.********************************************************************** 19310000
.*                                      NINSR                           19350000
         IDACB3 ARG=&NINSR,ARGNAME=NINSR,KWTC=X'17',MF=&MF      X04SVHS 19600000
.********************************************************************** 19610000
.*                                      NIXL                            19650000
         IDACB3 ARG=&NIXL,ARGNAME=NIXL,KWTC=X'18',MF=&MF        X04SVHS 19900000
.********************************************************************** 19910000
.*                                      &NLOGR                          19950000
         IDACB3 ARG=&NLOGR,ARGNAME=NLOGR,KWTC=X'19',MF=&MF      X04SVHS 20200000
.********************************************************************** 20210000
.*                                      NRETR                           20250000
         IDACB3 ARG=&NRETR,ARGNAME=NRETR,KWTC=X'1A',MF=&MF      X04SVHS 20300000
.********************************************************************** 20350000
.*                                      NSSS                            20500000
         IDACB3 ARG=&NSSS,ARGNAME=NSSS,KWTC=X'1B',MF=&MF        X04SVHS 20800000
.********************************************************************** 20810000
.*                                      NUPDR                           20850000
         IDACB3 ARG=&NUPDR,ARGNAME=NUPDR,KWTC=X'1C',MF=&MF      X04SVHS 21100000
.********************************************************************** 21110000
.*                                                                      21150000
         AIF   ('&OFLAGS' EQ '').A003000 *** OFLAGS ***                 21400000
         IDACB3 ARG=&OFLAGS,ARGNAME=OFLAGS,KWTC=X'1D',MF=&MF,BIT=YES,  *21450000
               INDRECT=YES                                      X04SVHS 21500000
         AIF   ('&OFLAGS(1)' EQ '*').A003000                            21550000
.*             IF INDIRECT ADDRESS WAS SPECIFIED, VALUE ARRAY(&IDAVALC) 21600000
.*             WAS SET IN IDACB3                                        21650000
&OPEN    SETB  ('&OFLAGS' EQ 'OPEN')                            X04SVHS 22000000
         AIF   (&OPEN).A002900                                  X04SVHS 22010000
.*             CHECK FOR VALID OPTION SPECIFIED                         22020000
         IDAERMAC 3,OFLAGS,&OFLAGS                                      22050000
&IDACB01 SETB  1                                                        22100000
.A002900 ANOP                                                           22200000
&IDAVALC(&IDAENO) SETC '&OPEN.000000000000000&Z16'              X04SVHS 22300000
.********************************************************************** 22300400
.A003000 ANOP                                                   X04SVHS 22302000
.*                                      RKP                             22310000
         IDACB3 ARG=&RKP,ARGNAME=RKP,KWTC=X'1F',MF=&MF          X04SVHS 22350000
.********************************************************************** 22360000
.*                                      AIXRKP                          22400000
         IDACB3 ARG=&AIXRKP,ARGNAME=AIXRKP,KWTC=X'3C',MF=&MF    X04SVHS 22650000
.********************************************************************** 22700000
.*                                      STMST                           22750000
         AIF   ('&STMST' EQ '').A003300  *** STMST ***                  22950000
         AIF   ('&STMST(1)' EQ '*').A003100                             23050000
.*                                      STMST MUST BE INDIRECT ADDRESS  23060000
         IDAERMAC 3,STMST,&STMST        ELSE, ISSUE ERROR MESSAGE       23100000
         AGO   .A003300                                                 23150000
.A003100 ANOP                                                           23160000
         IDACB3 ARG=&STMST,ARGNAME=STMST,KWTC=X'23',MF=&MF,INDRECT=YES  23200000
.*                                                              X04SVHS 23250000
&IDAELEN(&IDAENO) SETA 8                                        X04SVHS 23500000
.********************************************************************** 23550000
.*                                      OPENOBJ                         23600000
.A003300 ANOP                                                   X04SVHS 23850000
         AIF   ('&OPENOBJ' EQ '').A003800 *** OPENOBJ ***       X04SVHS 23900000
&I       SETA  0                        CLEAR SUBPARM CTR       X04SVHS 23950000
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 23960000
.A003400 ANOP                                                   X04SVHS 24000000
&I       SETA  &I+1                     BUMP SUBPARM CTR        X04SVHS 24050000
         AIF   (&I GT N'&OPENOBJ).A003500 CHK FOR END OF LIST   X04SVHS 24100000
&PATH    SETB  ('&OPENOBJ(&I)' EQ 'PATH' OR &PATH)              X04SVHS 24150000
&BASE    SETB  ('&OPENOBJ(&I)' EQ 'BASE' OR &BASE)              X04SVHS 24200000
&AIX     SETB  ('&OPENOBJ(&I)' EQ 'AIX' OR &AIX)                X04SVHS 24250000
         AIF   (&PATH+&BASE+&AIX+&C EQ &I).A003400              X04SVHS 24300000
.*                                      CHK FOR NEW BIT SET     X04SVHS 24350000
         IDAERMAC 5,OPENOBJ,&OPENOBJ(&I)                        X04SVHS 24400000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 24450000
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 24460000
         AGO   .A003400                                         X04SVHS 24500000
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS             X04SVHS 24510000
.A003500 AIF   (NOT(&PATH AND &BASE)).A003600                   X04SVHS 24550000
         IDAERMAC 8,OPENOBJ,PATH,BASE                           X04SVHS 24600000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 24650000
.A003600 AIF   (NOT(&PATH AND &AIX)).A003700                    X04SVHS 24700000
         IDAERMAC 8,OPENOBJ,PATH,AIX                            X04SVHS 24750000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 24800000
.A003700 ANOP                                                   X04SVHS 24850000
         IDACB3 ARG=&OPENOBJ,KWTC=X'21',BIT=YES                 X04SVHS 24900000
&IDAVALC(&IDAENO) SETC '&AIX&PATH&BASE.0000000000000&Z16'      @XM07772 25050000
.********************************************************************** 25060000
.A003800 ANOP                                                   X04SVHS 25100000
         MEND                                                           25700000
