*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXZXIXSM                              -93/05/10-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Send a message to a mailbox                   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1996, 1997                     * 00001300
*                                                                     * 00001400
* STATUS= HBB6603                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      Purpose:  The IXZXIXSM service will send messages between JES  * 00002200
*      subcomponents on the same or different members of the JESPlex. * 00002300
*      Messages can be sent from any JES environment, but can only be * 00002400
*      received in a JES address space (JES or FSS). This structure   * 00002500
*      allows for communications to occur in one of two ways:         * 00002600
*                                                                     * 00002700
*                                                                     * 00002800
*      1.  JES Dispatchable Unit (JDU's) can communicate information  * 00002900
*          between members.                                           * 00003000
*                                                                     * 00003100
*      2.  JES code in a user's address space can make requests of    * 00003200
*          the JES address space (REQTYPE=SYNC) for service.          * 00003300
*                                                                     * 00003400
*      3.  JES code in a user's address space can forward information * 00003500
*          to the JES address space for processing. For example, the  * 00003600
*          JES3 Subsystem interface routines get control in the       * 00003700
*          user's address sapce when a WTO is issued, JES3 will use   * 00003800
*          this service to send a copy of the WTO to the JES3 Global  * 00003900
*          address space for inclusion in the SYSLOG.                 * 00004000
*                                                                     * 00004100
*                                                                     * 00004200
*                                                                     * 00004300
*      IBM use of the interface:  IBM will use this service for all   * 00004400
*      of the functions listed above.                                 * 00004500
*                                                                     * 00004600
*      Customer use of the interface:  Those installations making     * 00004700
*      modifications (via JES installation exits and/or JES3 DSPs)    * 00004800
*      can use this service to perform the same functions described   * 00004900
*      above. The service provided is limited to the JES environment, * 00005000
*      so this is not a set of services that can be used in           * 00005100
*      applications, or other MVS environments.                       * 00005200
*                                                                     * 00005300
*      CDPI Implications:                                             * 00005400
*                                                                     * 00005500
*      This macro is a General Use Programming Interface.  It is      * 00005600
*      intended to be used as part of JES exits and JES3 dynamic      * 00005700
*      support programs. The macro is only used in JES environments.  * 00005800
*                                                                     * 00005900
*      EEC Implications:                                              * 00006000
*                                                                     * 00006100
*      This macro is not an EEC interface.                            * 00006200
*                                                                     * 00006300
*      Related Macros:                                                * 00006400
*                                                                     * 00006500
*      The following macros are required in order to use this macro   * 00006600
*      service:                                                       * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*      o   JES2:                                                      * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*          -   $MODULE - must be included in the module and must have * 00007300
*              been invoked before the IXZXIXSM macro service.        * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*      o   JES3:                                                      * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*          -   IATYMOD - must be included in the module and must have * 00008100
*              been invoked before the IXZXIXSM macro service.        * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*      The following macros are used with this macro to manage the    * 00008800
*      transport of data and monitoring of system events:             * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*      o   IXZXIXMB - Build a mailbox                                 * 00009200
*                                                                     * 00009300
*      o   IXZXIXMC - Clear a mailbox                                 * 00009400
*                                                                     * 00009500
*      o   IXZXIXMD - Delete XCF Mailbox                              * 00009600
*                                                                     * 00009700
*      o   IXZXIXRM - Receive a message from a mailbox                * 00009800
*                                                                     * 00009900
*      o   IXZXIXAC - Acknowledge receive of a message                * 00010000
*                                                                     * 00010100
*      o   IXZXIXIF - Obtain member information                       * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*      Requirements                                                   * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*      o   Authorization: Supervisor state - key 0 or 1               * 00010900
*                                                                     * 00011000
*      o   Dispatchable unit mode: Task                               * 00011100
*                                                                     * 00011200
*      o   Cross memory mode: PASN = HASN = SASN                      * 00011300
*                                                                     * 00011400
*      o   AMODE: 31                                                  * 00011500
*                                                                     * 00011600
*      o   ASC mode: Primary                                          * 00011700
*                                                                     * 00011800
*      o   Serialization: Enabled for interrupts                      * 00011900
*                                                                     * 00012000
*      o   Locks:  This service assumes no locks are held by the      * 00012100
*          user.                                                      * 00012200
*                                                                     * 00012300
*      o   Control Parameters:  None                                  * 00012400
*                                                                     * 00012500
*      o   JES Environments:                                          * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*          -   JES2 Main Task                                         * 00012900
*                                                                     * 00013000
*          -   JES3 Main Task                                         * 00013100
*                                                                     * 00013200
*          -   JES2 Subtask                                           * 00013300
*                                                                     * 00013400
*          -   JES3 Subtask                                           * 00013500
*                                                                     * 00013600
*          -   JES3 FSS                                               * 00013700
*                                                                     * 00013800
*          -   User Address Space                                     * 00013900
*                                                                     * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*      Register Information                                           * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*      o   Input registers                                            * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*          -   R0-R15 - Undefined                                     * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*      o   Output registers                                           * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*          -   R0 - Reason code                                       * 00015800
*                                                                     * 00015900
*          -   R1 - Unpredictable                                     * 00016000
*                                                                     * 00016100
*          -   R2-R13 - Unchanged                                     * 00016200
*                                                                     * 00016300
*          -   R14 - Unpredictable                                    * 00016400
*                                                                     * 00016500
*          -   R15 - Return code                                      * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*      Programming Notes/Requirements                                 * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*      1.  The programmer must supply a mailbox name. A mailbox name  * 00017500
*          is a 1 to 16 byte identifier that is used to indicate      * 00017600
*          where the data is to be sent. This identifier is used to   * 00017700
*          inform the JES XCF common subcomponent where to deliver    * 00017800
*          messages and whom to notify of the delivery.  The IXZXIXMB * 00017900
*          macro service can be used by the installation to create a  * 00018000
*          mailbox into which they can place messages.                * 00018100
*                                                                     * 00018200
*      2.  The programmer must supply the member name to which the    * 00018300
*          message is to be delivered. The member information can be  * 00018400
*          obtained by using the IXZXIXIF service to obtain member    * 00018500
*          information.                                               * 00018600
*                                                                     * 00018700
*      3.  If a synchronous message that requires acknowledgement is  * 00018800
*          sent the processor of the message can return a single      * 00018900
*          segment of information to the caller. This segment is      * 00019000
*          return via the RESPDATA= parameter.  The message buffer    * 00019100
*          returned should by handled like message returned by the    * 00019200
*          IXZXIXRM service. The response segment must be             * 00019300
*          acknowledged with the IXZXIXAC macro like all messages.    * 00019400
*                                                                     * 00019500
*      4.  Asynchronous message that require acknowledgement will     * 00019600
*          receive response messages packaged with the                * 00019700
*          acknowledgment.                                            * 00019800
*                                                                     * 00019900
*      5.  Synchronous message (REQTYPE=SYNC) should not be issued    * 00020000
*          while in the JES2 or JES3 main task environments.          * 00020100
*          Synchronous message issued in the JES2 or JES3 main task   * 00020200
*          environments will have an adverse effect on system         * 00020300
*          performance.                                               * 00020400
*                                                                     * 00020500
*      6.  When issing synchronous messages (REQTYPE=SYNC) care must  * 00020600
*          be taken to ensure that the receiver will in fact be able  * 00020700
*          to process the message. The sender of the message will     * 00020800
*          wait until the receiver has acknowledged the message.      * 00020900
*                                                                     * 00021000
*      7.  Information on multi-segmented messages:                   * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*          a.  A multi-segmented message is not considered completed  * 00021400
*              until a LAST segment has been sent. A multi-segmented  * 00021500
*              message can be started and multiple intervening single * 00021600
*              lines can be sent before the end line is sent. In this * 00021700
*              case all the single line messages will be delivered    * 00021800
*              before the multi-segmented message.                    * 00021900
*                                                                     * 00022000
*          b.  Multiple multi-segmented messages can be active a      * 00022100
*              time. The order of delivery will be order that the     * 00022200
*              LAST segment is received.                              * 00022300
*                                                                     * 00022400
*          c.  A multi-segmented message can be aborted               * 00022500
*              (SEGTYPE=ABORT). This causes the multi-segmented       * 00022600
*              message to be ended, with the first and last segment   * 00022700
*              of the message containing an indicator that the        * 00022800
*              message was aborted. The message will be delivered to  * 00022900
*              the mailbox with this indicator on.                    * 00023000
*                                                                     * 00023100
*          d.  If a multi-segmented message requires an               * 00023200
*              acknowledgment to flow to the sending system           * 00023300
*              (REQTYPE=(SYNC|ASYNC|ASYNCACK)). This acknowledgement  * 00023400
*              message will be built and sent when the LAST line is   * 00023500
*              acknowledged.                                          * 00023600
*                                                                     * 00023700
* Internal information  * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*          e.  The EXIT= and ECB= are optional ways of having the     * 00024100
*              send message service routine notify the caller when an * 00024200
*              acknowledgement to the message they sent is complete.  * 00024300
*              The data returned is copied into a buffer provided by  * 00024400
*              the caller using the RESPDATA= parameter.  Data upto   * 00024500
*              the length specified on the RESPDLEN= parameter will   * 00024600
*              be copied into the buffer.                             * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*              1)  For EXIT= an address of a SRB routine is given.    * 00025000
*                  The send message service routine will schedule a   * 00025100
*                  local SRB in the IXZXIXSM callers address space to * 00025200
*                  cause the exit routine to run.  The address of the * 00025300
*                  buffer specified on the RESPDATA= parameter is     * 00025400
*                  passed as a parameter to SRB.                      * 00025500
*                                                                     * 00025600
*              2)  For ECB= an ECB address is passed to the service   * 00025700
*                  routine. This ECB will be posted when processing   * 00025800
*                  is complete and the acknowledgement data has been  * 00025900
*                  passed to the caller via the RESPDATA= parameter.  * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
* End of Internal information  * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*      Restrictions                                                   * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*      o   Can not be issued until JES initialization has both        * 00027400
*          attached and initialized the JES XCF common subcomponent   * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*      Performance Implications:                                      * 00027900
*                                                                     * 00028000
*      This macro has no performance impact.                          * 00028100
*                                                                     * 00028200
*01* EXTERNAL CLASSIFICATION:   GUPI                                  * 00028300
*                                                                     * 00028400
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00028500
*                                                                     * 00028600
*01* SYNTAX:                                                          * 00028700
*                                                                     * 00028800
*[xlabel]  IXZXIXSM     MBOXNAME=xmboxname                            * 00028900
*                      ,MEMBER=xmember                                * 00029000
*                      ,DATA=xdata                                    * 00029100
*                         [,DATAALET=xdataalet|0]                   * 00029200
*                          ,DATALEN=xdatalen                          * 00029300
*                     [,REQTYPE=COMM|ASYNCACK|ASYNC|SYNC]           * 00029400
*                     [,SEGTYPE=SINGLE|FIRST|MIDDLE|LAST|ABORT]     * 00029500
*                     [,CONNECT=xconnect|0]                         * 00029600
*                      ,GROUPTOKEN=xgrouptoken                        * 00029700
*                     [,RESPDATA=xrespdata|0                        * 00029800
*                         [,RESPDLEN=xrespdlen|0                    * 00029900
*                             [,RESPDALT=xrespdalt|0]]]             * 00030000
*                     [,REQMBOX=xreqmbox|!None!                     * 00030100
*                         [,REQTOKEN=xreqtoken]]                      * 00030200
*                     [,EXIT=xexit|NONE]                            * 00030300
*                     [,ECB=xecb|NONE]                              * 00030400
*                     [,MSGTOKEN=xmsgtoken]                           * 00030500
*                     [,USERRC=xuserrc]                               * 00030600
*                     [,MSGATTR=NONE|J3CONNECT|EXPRESS]             * 00030700
*                     [,RTNCODE=xrtncode]                             * 00030800
*                     [,RSNCODE=xrsncode]                             * 00030900
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00031000
*                    [,MF=S]                                         * 00031100
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00031200
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*      Where:                                                         * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*      [xlabel]                                                       * 00031900
*          is an optional symbol, starting in column 1, that is the   * 00032000
*          name on the IXZXIXSM macro invocation.  The name must      * 00032100
*          conform to the rules for an ordinary assembler language    * 00032200
*          symbol.                                                    * 00032300
*          DEFAULT: No name.                                          * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*      MBOXNAME=xmboxname                                             * 00032900
*          is the name (RS-type), or address in register (2)-(12), of * 00033000
*          a required 16 character input containing the mailbox name. * 00033100
*          This mailbox name is the location the JES XCF common       * 00033200
*          subcomponent will use to place messages so that another    * 00033300
*          JDU can process them.                                      * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*      MEMBER=xmember                                                 * 00033900
*          is the name (RS-type), or address in register (2)-(12), of * 00034000
*          a required 16 character input containing the name of the   * 00034100
*          member to which the message should be forwarded. it can be * 00034200
*          any member in the XCF group, including the sending system. * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*      DATA=xdata                                                     * 00034800
*          is the name (RS-type), or address in register (2)-(12), of * 00034900
*          a required 4 byte input that contains the address of the   * 00035000
*          message data to be sent.                                   * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*          [DATAALET=xdataalet|0]                                   * 00035400
*              is the name (RS-type), or address in register          * 00035500
*              (2)-(12), of an optional fullword input that specifies * 00035600
*              the alet to be used to access the data to be sent to   * 00035700
*              the receiver.  This is an internal parameter and is    * 00035800
*              not part of the General Use Programming Interface.     * 00035900
*              DEFAULT: 0 The service assumes that the data is in the * 00036000
*              callers address space.                                 * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*          DATALEN=xdatalen                                           * 00036600
*              is the name (RS-type), or address in register          * 00036700
*              (2)-(12), of a required fullword input that contains   * 00036800
*              the length of the message data to be sent.             * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*      [REQTYPE=COMM|ASYNCACK|ASYNC|SYNC]                           * 00037600
*          is an optional keyword input that specifies how            * 00037700
*          acknowledgement processing will be handled.                * 00037800
*          DEFAULT: COMM                                              * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*          REQTYPE=COMM                                               * 00038200
*              Process the message asynchronously. No recovery action * 00038300
*              will be taken if either the sending or receiving       * 00038400
*              system fail before the message has been processed.     * 00038500
*                                                                     * 00038600
*          REQTYPE=ASYNCACK                                           * 00038700
*              Processing the message asynchronously. The sender of   * 00038800
*              the message will receive an acknowledgement message    * 00038900
*              from the receiver of the message.  This allows for a   * 00039000
*              two-phase commit for updates. This allows for recovery * 00039100
*              of failures, and keeps the sender involved in          * 00039200
*              potential recovery scenarios.                          * 00039300
*                                                                     * 00039400
*          REQTYPE=ASYNC                                              * 00039500
*              Process the message asynchronously. An acknowledgement * 00039600
*              message will not be sent to the sender of the message. * 00039700
*              The JES XCF common subcomponent will handle recovery   * 00039800
*              scenarios for this message.                            * 00039900
*                                                                     * 00040000
*          REQTYPE=SYNC                                               * 00040100
*              Processing the message synchronously, wait until the   * 00040200
*              message has been acknowledged by the receiver before   * 00040300
*              allowing the caller to continue processing.            * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*      [SEGTYPE=SINGLE|FIRST|MIDDLE|LAST|ABORT]                     * 00041100
*          is an optional keyword input that specifies the type of    * 00041200
*          message that is being processed (Single line message,      * 00041300
*          First line of a multiple line message, Middle line, or     * 00041400
*          last line of a multiple line message.                      * 00041500
*          DEFAULT: SINGLE                                            * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*          SEGTYPE=SINGLE                                             * 00041900
*              The message being processed is a single line message.  * 00042000
*                                                                     * 00042100
*          SEGTYPE=FIRST                                              * 00042200
*              The message is the first line of a multiple line       * 00042300
*              message. A token is returned via the CONNECT parameter * 00042400
*              and must be passed as input on all subsequent lines of * 00042500
*              the message                                            * 00042600
*                                                                     * 00042700
*          SEGTYPE=MIDDLE                                             * 00042800
*              The message is a middle line of a multiple line        * 00042900
*              message.                                               * 00043000
*                                                                     * 00043100
*          SEGTYPE=LAST                                               * 00043200
*              The message is the last line of a multiple line        * 00043300
*              message.                                               * 00043400
*                                                                     * 00043500
*          SEGTYPE=ABORT                                              * 00043600
*              This causes the multiple segment message to be ended,  * 00043700
*              and the message delivered to the receiver with an      * 00043800
*              indication that the message was aborted. This          * 00043900
*              indicator is located in the first and last message     * 00044000
*              segment, the flag is ABORT_SEGMENT in the IXZYIXEN     * 00044100
*              envelope mapping.                                      * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*      [CONNECT=xconnect|0]                                         * 00044900
*          is the name (RS-type), or address in register (2)-(12), of * 00045000
*          an optional 64 bit input/output containing a token that is * 00045100
*          used to match the lines of a multiple line message. The    * 00045200
*          token is returned on the MSGTYPE=FIRST and is passed as    * 00045300
*          input on MSGTYPE=MIDDLE and MSGTYPE=LAST. CONNECT is not   * 00045400
*          used on MSGTYPE=SINGLE.                                    * 00045500
*          DEFAULT: 0 No connect id used, the message must be a       * 00045600
*          single segment message.                                    * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*      GROUPTOKEN=xgrouptoken                                         * 00046200
*          is the name (RS-type), or address in register (2)-(12), of * 00046300
*          a required fullword input that contains the JES XCF group  * 00046400
*          token.                                                     * 00046500
*                                                                     * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*      [RESPDATA=xrespdata|0                                        * 00047000
*          is the name (RS-type), or address in register (2)-(12), of * 00047100
*          an optional fullword input/output Address of the response  * 00047200
*          data received from a REQTYPE=SYNC message.  Or, if ECB= or * 00047300
*          EXIT= are specified this parameter is used to pass the     * 00047400
*          address of the message buffer, into which the response     * 00047500
*          will be placed                                             * 00047600
*          DEFAULT: 0                                                 * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*          [RESPDLEN=xrespdlen|0                                    * 00048000
*              is the name (RS-type), or address in register          * 00048100
*              (2)-(12), of an optional fullword input/output Length  * 00048200
*              of the data returned to a REQTYPE=SYNC message.  Or,   * 00048300
*              if ECB= or EXIT= are specified this parameter is used  * 00048400
*              to pass the length of the message buffer, into which   * 00048500
*              the response will be placed.                           * 00048600
*              DEFAULT: 0                                             * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*              [RESPDALT=xrespdalt|0]]]                             * 00049000
*                  is the name (RS-type), or address in register      * 00049100
*                  (2)-(12), of an optional fullword input Alet used  * 00049200
*                  to qualify the RESPDATA= keyword when used as      * 00049300
*                  input.  This is an internal parameter and is not   * 00049400
*                  part of the General Use Programming Interface.     * 00049500
*                  DEFAULT: 0                                         * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*                                                                     * 00049900
*                                                                     * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*      [REQMBOX=xreqmbox|!None!                                     * 00050500
*          is the name (RS-type), or address in register (2)-(12), of * 00050600
*          an optional 16 character input containing the name of the  * 00050700
*          mailbox into which the acknowledgment message will be      * 00050800
*          returned. The keyword is required for invocations that     * 00050900
*          specify (REQTYPE=ASYNCACK).                                * 00051000
*          DEFAULT: 'None'                                            * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*          [REQTOKEN=xreqtoken]]                                      * 00051400
*              is the name (RS-type), or address in register          * 00051500
*              (2)-(12), of an optional 64 bit output containing a    * 00051600
*              token that can be used to match an acknowledgement     * 00051700
*              with an issuance of the IXZXIXSM macro. REQTOKEN is    * 00051800
*              only returned if the TYPE=ASYNCACK parameter is        * 00051900
*              specified; otherwise, binary zero is returned.         * 00052000
*                                                                     * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*      [EXIT=xexit|NONE]                                            * 00052700
*          is the name (RS-type), or address in register (2)-(12), of * 00052800
*          an optional fullword input Specifies the address of a      * 00052900
*          routine that will receive control under a SRB in the       * 00053000
*          callers address space. This routine will notify the issuer * 00053100
*          of a message that acknowledgement data have been returned  * 00053200
*          via RESPDATA parameter. This internal parameter is not     * 00053300
*          part of the General Use Programming Interface.             * 00053400
*          DEFAULT: NONE                                              * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*      [ECB=xecb|NONE]                                              * 00054000
*          is the name (RS-type), or address in register (2)-(12), of * 00054100
*          an optional fullword input Specifies an ECB that will be   * 00054200
*          posted when the message has been processed and             * 00054300
*          acknowledgement data has been returned to the caller via   * 00054400
*          the RESPDATA parameter.  This is an internal parameter an  * 00054500
*          is not part of the General Use Programming Interface.      * 00054600
*          DEFAULT: NONE                                              * 00054700
*                                                                     * 00054800
*                                                                     * 00054900
*                                                                     * 00055000
*                                                                     * 00055100
*      [MSGTOKEN=xmsgtoken]                                           * 00055200
*          is the name (RS-type), or address in register (2)-(12), of * 00055300
*          an optional 64 bit output that contains a token that       * 00055400
*          represents the response message. The token is returned to  * 00055500
*          the XCF Subtask via the IXZXIXAC macro service once the    * 00055600
*          message has been processed. The IXZXIXAC macro will return * 00055700
*          any resources held by the message and will perform the     * 00055800
*          required acknowledgment processing.                        * 00055900
*                                                                     * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*                                                                     * 00056300
*      [USERRC=xuserrc]                                               * 00056400
*          is the name (RS-type), or address in register (2)-(12), of * 00056500
*          an optional fullword output that returns the processing    * 00056600
*          results as specified by the receiver of the message. The   * 00056700
*          USERRC is only used used by synchronous messages (REQTYPE= * 00056800
*          SYNC). The return information is returned in the           * 00056900
*          acknowledgement message for asynchronous messages that     * 00057000
*          require an acknowledgement, USERRC returns binary zero in  * 00057100
*          this case.  Asynchronous messages that do not require an   * 00057200
*          acknowledgment do not return processing results, USERRC    * 00057300
*          returns binary zero.                                       * 00057400
*                                                                     * 00057500
*                                                                     * 00057600
*                                                                     * 00057700
*                                                                     * 00057800
*      [MSGATTR=NONE|J3CONNECT|EXPRESS]                             * 00057900
*          is an optional keyword input that assigns special          * 00058000
*          attributes to a message that is being sent. This is an     * 00058100
*          internal parameter and is not part of the general use      * 00058200
*          programming interface.                                     * 00058300
*          DEFAULT: NONE                                              * 00058400
*                                                                     * 00058500
*                                                                     * 00058600
*          MSGATTR=NONE                                               * 00058700
*              This message has no special message attributes.  This  * 00058800
*              is an internal parameter and is not part of the        * 00058900
*              general use programming interface.                     * 00059000
*                                                                     * 00059100
*          MSGATTR=J3CONNECT                                          * 00059200
*              This is a JES3 connect message. It should should be    * 00059300
*              sent to the receiver before JES3 connect processing    * 00059400
*              has completed and should be sent even if a slow down   * 00059500
*              is in progress. This is an internal parameter and is   * 00059600
*              not part of the general use programming interface.     * 00059700
*                                                                     * 00059800
*          MSGATTR=EXPRESS                                            * 00059900
*              This message should be sent, even in a buffer          * 00060000
*              constraint situation.  This is an internal parameter   * 00060100
*              and is not part of the general use programming         * 00060200
*              interface.                                             * 00060300
*                                                                     * 00060400
*                                                                     * 00060500
*                                                                     * 00060600
*                                                                     * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*      [RTNCODE=xrtncode]                                             * 00061000
*          is the name (RS-type) of an optional fullword output       * 00061100
*          variable, or register (2)-(12), into which the return code * 00061200
*          is to be copied from GPR 15.                               * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*      [RSNCODE=xrsncode]                                             * 00061800
*          is the name (RS-type) of an optional fullword output       * 00061900
*          variable, or register (2)-(12), into which the reason code * 00062000
*          is to be copied from GPR 0.                                * 00062100
*                                                                     * 00062200
*                                                                     * 00062300
*                                                                     * 00062400
*                                                                     * 00062500
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00062600
*          is an optional byte input decimal value in the "1-1" range * 00062700
*          that specifies the macro version.  PLISTVER is the only    * 00062800
*          key allowed on the list form of MF and determines which    * 00062900
*          parameter list is generated.  Note that MAX may be         * 00063000
*          specified instead of a number, and the parameter list will * 00063100
*          be of the largest size currently supported. This size may  * 00063200
*          grow from release to release (thus possibly affecting the  * 00063300
*          amount of storage needed by your program).  If your        * 00063400
*          program can tolerate this, IBM recommends that you always  * 00063500
*          specify MAX when creating the list form parameter list as  * 00063600
*          that will ensure that the list form parameter list is      * 00063700
*          always long enough to hold whatever parameters might be    * 00063800
*          specified on the execute form.                             * 00063900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00064000
*          default is the lowest version which allows all of the      * 00064100
*          parameters specified on the invocation to be processed.    * 00064200
*                                                                     * 00064300
*                                                                     * 00064400
*                                                                     * 00064500
*                                                                     * 00064600
*      [MF=S|L|E]                                                   * 00064700
*          is an optional keyword input which specifies the macro     * 00064800
*          form.                                                      * 00064900
*          DEFAULT: S                                                 * 00065000
*                                                                     * 00065100
*                                                                     * 00065200
*          [MF=S]                                                     * 00065300
*              specifies the standard form of the macro.  The "S"     * 00065400
*              form generates code to put the parameters into an      * 00065500
*              in-line parameter list and invoke the desired service. * 00065600
*              Full checking for required macro keys is done along    * 00065700
*              with supplying defaults for omitted optional           * 00065800
*              parameters.                                            * 00065900
*                                                                     * 00066000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00066100
*              specifies the list form of the macro.  The "L" form    * 00066200
*              defines an area to be used for the parameter list.     * 00066300
*              Only the PLISTVER key may be specified on the          * 00066400
*              invocation.  All other macro parameters are flagged as * 00066500
*              errors.  If PLISTVER is not specified, the original    * 00066600
*              parameter list definition is used.                     * 00066700
*                                                                     * 00066800
*            ,xmfctrl                                                 * 00066900
*              is a required input.  It is the name of a storage area * 00067000
*              for the parameter list.                                * 00067100
*                                                                     * 00067200
*            ,xmfattr|0D                                            * 00067300
*              is an optional 60 character input string that varies   * 00067400
*              from 1 to 60 characters. It can contain any value that * 00067500
*              is valid on an assembler DS pseudo-op. You can use     * 00067600
*              this parameter to force boundary alignment of the      * 00067700
*              parameter list.                                        * 00067800
*              DEFAULT: 0D which forces the parameter list to a       * 00067900
*              doubleword boundary.                                   * 00068000
*                                                                     * 00068100
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00068200
*              specifies the execute form of the macro.  The "E" form * 00068300
*              generates code to put the parameters into the          * 00068400
*              parameter list specified by xmfctrl and provides full  * 00068500
*              syntax checking with default setting.                  * 00068600
*                                                                     * 00068700
*            ,xmfctrl                                                 * 00068800
*              is a required input.  It is the name (RS-type), or     * 00068900
*              address in register (1)-(12), of a storage area for    * 00069000
*              the parameter list.                                    * 00069100
*                                                                     * 00069200
*            ,COMPLETE                                              * 00069300
*              is an optional keyword input which specifies the       * 00069400
*              degree of macro parameter syntax checking.             * 00069500
*              DEFAULT: COMPLETE                                      * 00069600
*                                                                     * 00069700
*                                                                     * 00069800
*              COMPLETE                                               * 00069900
*                  Checking for required macro keys is done and       * 00070000
*                  defaults are supplied for omitted optional         * 00070100
*                  parameters.                                        * 00070200
*                                                                     * 00070300
*                                                                     * 00070400
*                                                                     * 00070500
*                                                                     * 00070600
*                                                                     * 00070700
*                                                                     * 00070800
*                                                                     * 00070900
*01* RETURN CODES:                                                    * 00071000
*                                                                     * 00071100
*                                                                     * 00071200
*            0    Processing was sucessful, a message was passed to   * 00071300
*                 the JES XCF coupling support.                       * 00071400
*                                                                     * 00071500
*            4    Invalid user input was received, the message was    * 00071600
*                 not sent.                                           * 00071700
*                                                                     * 00071800
*            8    A system error occurred while processing the        * 00071900
*                 request.  The message was not sent.                 * 00072000
*                                                                     * 00072100
*            C    A system abend occurred while processing the        * 00072200
*                 request.  The message was not sent.                 * 00072300
*                                                                     * 00072400
*                                                                     * 00072500
*                                                                     * 00072600
*01* REASON CODES:                                                    * 00072700
*                                                                     * 00072800
*       REASON    RETURN                                              * 00072900
*       CODE      CODE      DESCRIPTION                               * 00073000
*                                          * 00073100
*                                                                     * 00073200
*                                                                     * 00073300
*              0  0         The  processing  requested was performed. * 00073400
*                           If  the call was asynchronous the message * 00073500
*                           was  queue  to  be  sent. If the call was * 00073600
*                           synchronous  the message was delivered to * 00073700
*                           the receiver and acknowledged.            * 00073800
*                                                                     * 00073900
*              4  4         Processing  failed  because the parameter * 00074000
*                           list   passed  to  the  IXZXIXSM  service * 00074100
*                           routine does not have a valid eyecatcher. * 00074200
*                                                                     * 00074300
*              8  4         Processing  failed because, the parameter * 00074400
*                           list   passed  to  the  IXZXIXSM  service * 00074500
*                           routine had an invalid version indicator. * 00074600
*                           The caller may need to be recompiled.     * 00074700
*                                                                     * 00074800
*              C  4         Processing failed because, the grouptoken * 00074900
*                           passed  to  the  IXZXIXSM service routine * 00075000
*                           was not valid.                            * 00075100
*                                                                     * 00075200
*             10  4         Processing  failed because, the parameter * 00075300
*                           list   passed  to  the  IXZXIXSM  service * 00075400
*                           routine had an invalid member name.  Only * 00075500
*                           A-Z, 0-9 and $ @ # are valid and imbedded * 00075600
*                           blanks are not allowed.                   * 00075700
*                                                                     * 00075800
*             14  4         The MBOXNAME passed in the parameter list * 00075900
*                           to  the  IXZXIXSM  macro service contains * 00076000
*                           characters  that  are  not  valid.    The * 00076100
*                           request is rejected.                      * 00076200
*                                                                     * 00076300
*             18  4         The  REQMBOX passed in the parameter list * 00076400
*                           to  the  IXZXIXSM  macro service contains * 00076500
*                           characters  that  are  not  valid.    The * 00076600
*                           request is rejected.                      * 00076700
*                                                                     * 00076800
*             24  4         CONNECT   was   not   specified   in  the * 00076900
*                           parameter  list  passed  to  the  IXZIXSM * 00077000
*                           macro  service.    When SEGTYPE is first, * 00077100
*                           middle,   last,   or  abort,  CONNECT  is * 00077200
*                           required.                                 * 00077300
*                                                                     * 00077400
*             28  4         MSGTOKEN   was   not   specified  in  the * 00077500
*                           parameter  list  passed  to  the  IXZIXSM * 00077600
*                           macro  service.    When  REQTYPE is sync, * 00077700
*                           MSGTOKEN is required.                     * 00077800
*                                                                     * 00077900
*             34  4         The   Connect   id   is  invalid  in  the * 00078000
*                           parameter  list  passed  to  the  IXZIXSM * 00078100
*                           macro service.  A SEGTYPE of middle, last * 00078200
*                           or  abort  was  specified  but, the first * 00078300
*                           seqment was not found or the last segment * 00078400
*                           was already sent.                         * 00078500
*                                                                     * 00078600
*             38  4         The  DATALEN  is invalid in the parameter * 00078700
*                           list passed to the IXZIXSM macro service. * 00078800
*                           The DATALEN must be a positive number and * 00078900
*                           less than 60 Kbytes (decimal).            * 00079000
*                                                                     * 00079100
*             3C  4         RESPDATA  and RESPDLEN were not specified * 00079200
*                           parameters  when EXIT= or ECB= parameters * 00079300
*                           were specified.                           * 00079400
*                                                                     * 00079500
*                                                                     * 00079600
*                                                                     * 00079700
*01* MODULE TYPE:  ASSEM MACRO                                        * 00079800
*                                                                     * 00079900
*02*   PROCESSOR:  ASSEM                                              * 00080000
*                                                                     * 00080100
*01* COMPONENT:  SCJSC                                                * 00080200
*                                                                     * 00080300
*01* MACRO USAGE NOTES:                                               * 00080400
*                                                                     * 00080500
*                                                                     * 00080600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00080700
*        global macro variable.  Any value other than 'NO' will       * 00080800
*        result in the macro expansion being printed.  The default is * 00080900
*        'YES'.  The following examples illustrate how the ZPRINT     * 00081000
*        variable should be set.                                      * 00081100
*                                                                     * 00081200
*                    GBLC &ZPRINT                                     * 00081300
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00081400
*                                                                     * 00081500
*                                                                     * 00081600
*    2.  All   keys   currently   contained  in  the  IXZXIXSM  macro * 00081700
*        correspond  to  version  1.   If you specify PLISTVER, use a * 00081800
*        value of 1 or MAX.                                           * 00081900
*                                                                     * 00082000
*                                                                     * 00082100
*                                                                     * 00082200
*                                                                     * 00082300
*01* CHANGE ACTIVITY:                                                 * 00082400
*                                                                     * 00082500
*   Flag LineItem  FMID    Date   ID    Comment                       * 00082600
*                                                                     * 00082700
*    $N0=JESXCF   HBB5510 921201 PD0AL:                               * 00082800
*    $N0=PIG2008  HBB5510 930624 PD0AL:                               * 00082900
*    $N0=J3XCF    HBB5510 930811 PD0AL:                               * 00083000
****** END OF SPECIFICATIONS *****************************************/ 00083100
*/********************************************************************* 00083200
         MACRO                                                          00083300
&XLABEL  IXZXIXSM &MBOXNAME=,&MEMBER=,&DATA=,&DATAALET=,&DATALEN=,     *00083400
               &REQTYPE=,&SEGTYPE=,&CONNECT=,&GROUPTOKEN=,&RESPDATA=,  *00083500
               &RESPDLEN=,&RESPDALT=,&REQMBOX=,&REQTOKEN=,&EXIT=,&ECB=,*00083600
               &MSGTOKEN=,&USERRC=,&MSGATTR=,&RTNCODE=,&RSNCODE=,      *00083700
               &PLISTVER=,&MF=                                          00083800
.*                                                                      00083900
*                MACDATE -93/05/10-<1>                                  00084000
.*                                                                      00084100
.*******************************************************************    00084200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00084300
.*******************************************************************    00084400
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00084500
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00084600
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00084700
.*                                                                      00084800
                GBLC  &ZIXZXIXSM  YES=MACRO USED AT LEAST ONCE          00084900
.*******************************************************************    00085000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00085100
.*******************************************************************    00085200
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00085300
                LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS          00085400
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00085500
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00085600
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00085700
                LCLA  &ZAWRK      USED AS A WORK AREA                   00085800
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00085900
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00086000
                LCLC  &ZC         CHARACTER WORK VARIABLE               00086100
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00086200
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00086300
                LCLA  &ZMACRET    MACRO RETURN CODE                     00086400
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00086500
.*                                                                      00086600
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00086700
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00086800
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00086900
                LCLC  &ZENDBASEPL               End of base PL          00087000
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00087100
.*******************************************************************    00087200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00087300
.*******************************************************************    00087400
                LCLA  &ZI         INDEX FOR ARRAY                       00087500
                LCLA  &ZJ         INDEX FOR PARMS                       00087600
                LCLA  &ZK         INDEX FOR PARSE                       00087700
                LCLA  &ZLO        LOW RANGE VALUE                       00087800
                LCLA  &ZHI        HIGH RANGE VALUE                      00087900
                LCLC  &ZW         WORK AREA FOR PARM                    00088000
.********************************************************************   00088100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00088200
.********************************************************************   00088300
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00088400
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00088500
.*                                                                      00088600
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00088700
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00088800
                SPLEVEL  TEST                                           00088900
.ZSYS2          ANOP  ,                                                 00089000
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00089100
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00089200
                SYSSTATE TEST                                           00089300
                AGO   .ZSYS4                                            00089400
.ZSYS3          ANOP  ,                                                 00089500
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00089600
.ZSYS4          ANOP  ,                                                 00089700
.*******************************************************************    00089800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00089900
.*******************************************************************    00090000
                LCLC  &XMBOXNAME  ++ NAME                               00090100
                LCLC  &XMEMBER    ++ NAME                               00090200
                LCLC  &XDATA      ++ NAME                               00090300
                LCLC  &XDATAALET  ++ NAME                               00090400
                LCLC  &XDATALEN   ++ NAME                               00090500
                LCLC  &XREQTYPE   ++ VALUE                              00090600
                LCLC  &XSEGTYPE   ++ VALUE                              00090700
                LCLC  &XCONNECT   ++ NAME                               00090800
                LCLC  &XGROUPTOKEN              ++ NAME                 00090900
                LCLC  &XRESPDATA  ++ NAME                               00091000
                LCLC  &XRESPDLEN  ++ NAME                               00091100
                LCLC  &XRESPDALT  ++ NAME                               00091200
                LCLC  &XREQMBOX   ++ NAME                               00091300
                LCLC  &XREQTOKEN  ++ NAME                               00091400
                LCLC  &XEXIT      ++ NAME                               00091500
                LCLC  &XECB       ++ NAME                               00091600
                LCLC  &XMSGTOKEN  ++ NAME                               00091700
                LCLC  &XUSERRC    ++ NAME                               00091800
                LCLC  &XMSGATTR   ++ VALUE                              00091900
                LCLC  &XRTNCODE   ++ NAME                               00092000
                LCLC  &XRSNCODE   ++ NAME                               00092100
                LCLA  &XPLISTVER  ++ VALUE                              00092200
                LCLC  &XMF        ++ VALUE                              00092300
                LCLC  &XMFCTRL    ++ NAME                               00092400
                LCLC  &XMFATTR    ++ VALUE                              00092500
                LCLC  &XMFSCK     ++ VALUE                              00092600
.*******************************************************************    00092700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00092800
.*******************************************************************    00092900
                LCLC  &ZXMBOXNAME               ++ INPUT NAME           00093000
                LCLC  &ZXMEMBER   ++ INPUT NAME                         00093100
                LCLC  &ZXDATA     ++ INPUT NAME                         00093200
                LCLC  &ZXDATAALET               ++ INPUT NAME           00093300
                LCLC  &ZXDATALEN  ++ INPUT NAME                         00093400
                LCLC  &ZXREQTYPE  ++ INPUT VALUE                        00093500
                LCLC  &ZXSEGTYPE  ++ INPUT VALUE                        00093600
                LCLC  &ZXCONNECT  ++ INOUT NAME                         00093700
                LCLC  &ZXGROUPTOKEN             ++ INPUT NAME           00093800
                LCLC  &ZXRESPDATA               ++ INOUT NAME           00093900
                LCLC  &ZXRESPDLEN               ++ INOUT NAME           00094000
                LCLC  &ZXRESPDALT               ++ INPUT NAME           00094100
                LCLC  &ZXREQMBOX  ++ INPUT NAME                         00094200
                LCLC  &ZXREQTOKEN               ++ OUTPUT NAME          00094300
                LCLC  &ZXEXIT     ++ INPUT NAME                         00094400
                LCLC  &ZXECB      ++ INPUT NAME                         00094500
                LCLC  &ZXMSGTOKEN               ++ OUTPUT NAME          00094600
                LCLC  &ZXUSERRC   ++ OUTPUT NAME                        00094700
                LCLC  &ZXMSGATTR  ++ INPUT VALUE                        00094800
                LCLC  &ZXRTNCODE  ++ OUTPUT NAME                        00094900
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00095000
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00095100
                LCLC  &ZXMF       ++ INPUT VALUE                        00095200
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00095300
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00095400
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00095500
.********************************************************************   00095600
.***AC.PLV01  PROCESS PLISTVER                                      *   00095700
.********************************************************************   00095800
&XPLISTVER      SETA  1                                                 00095900
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00096000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00096100
&XPLISTVER      SETA  1                                                 00096200
.ZPLV0          ANOP  ,                                                 00096300
.*                                                                      00096400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00096500
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00096600
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00096700
.*-------------------------------------------------------------------   00096800
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00096900
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00097000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00097100
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00097200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00097300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00097400
                AGO   .ZPVCK2                                           00097500
.ZPVCK3         ANOP  ,                                                 00097600
.*-------------------------------------------------------------------   00097700
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00097800
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00097900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00098000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00098100
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00098200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00098300
                AGO   .ZPVCKE                                           00098400
.ZPVCK2         ANOP  ,                                                 00098500
.*-------------------------------------------------------------------   00098600
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00098700
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00098800
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00098900
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00099000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00099100
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00099200
                MNOTE 8,' &ZMS IS REQUIRED.'                            00099300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00099400
                AGO   .ZPVCK5                                           00099500
.ZPVCK4         ANOP  ,                                                 00099600
&XPLISTVER      SETA  &PLISTVER(1)                                      00099700
.ZPVCK5         ANOP  ,                                                 00099800
.*-------------------------------------------------------------------   00099900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00100000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00100100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00100200
                AIF   (&XPLISTVER LT 1).ZPVCK6  TOO LOW                 00100300
                AIF   (&XPLISTVER LE 1).ZPVCKE  NOT HIGH                00100400
.ZPVCK6         ANOP   ,                                                00100500
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00100600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00100700
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00100800
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00100900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00101000
.ZPVCKE         ANOP   ,                                                00101100
.********************************************************************   00101200
.***AG.MF01 PROCESS MF MACRO FORMS                                      00101300
.********************************************************************   00101400
                ACTR  10000                                             00101500
.*------------------------------------------------------------------    00101600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00101700
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00101800
.*-------------------------------------------------------------------   00101900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102000
.ZG81           ANOP  ,                                                 00102100
&ZTLC           SETC 'S'                                                00102200
                AIF   ('&MF(1)' NE '&ZTLC').ZG82                        00102300
&XMF            SETC  'S'         SET KEYWORD                           00102400
                AIF   (N'&MF LE 1).ZG81A        CK NUM                  00102500
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00102600
&ZMS            SETC  '&ZMS.&MF"'                                       00102700
&ZMS            SETC  '&ZMS "MF"'                                       00102800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00102900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00103000
.ZG81A          ANOP  ,                                                 00103100
.*-------------------------------------------------------------------   00103200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00103300
.ZG82           ANOP  ,                                                 00103400
&ZTLC           SETC 'L'                                                00103500
                AIF   ('&MF(1)' NE '&ZTLC').ZG89                        00103600
&XMF            SETC  'L'         SET KEYWORD                           00103700
                AIF   (N'&MF LE 3).ZG82A        CK NUM                  00103800
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00103900
&ZMS            SETC  '&ZMS.&MF"'                                       00104000
&ZMS            SETC  '&ZMS "MF"'                                       00104100
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00104200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00104300
.ZG82A          ANOP  ,                                                 00104400
.*-------------------------------------------------------------------   00104500
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00104600
                AIF   (N'&SYSLIST NE 0).ZG82B   POSITIONALS?            00104700
                AIF   ('&MBOXNAME' NE '').ZG82B  KEYS?                  00104800
                AIF   ('&MEMBER' NE '').ZG82B   KEYS?                   00104900
                AIF   ('&DATA' NE '').ZG82B     KEYS?                   00105000
                AIF   ('&DATAALET' NE '').ZG82B  KEYS?                  00105100
                AIF   ('&DATALEN' NE '').ZG82B  KEYS?                   00105200
                AIF   ('&REQTYPE' NE '').ZG82B  KEYS?                   00105300
                AIF   ('&SEGTYPE' NE '').ZG82B  KEYS?                   00105400
                AIF   ('&CONNECT' NE '').ZG82B  KEYS?                   00105500
                AIF   ('&GROUPTOKEN' NE '').ZG82B  KEYS?                00105600
                AIF   ('&RESPDATA' NE '').ZG82B  KEYS?                  00105700
                AIF   ('&RESPDLEN' NE '').ZG82B  KEYS?                  00105800
                AIF   ('&RESPDALT' NE '').ZG82B  KEYS?                  00105900
                AIF   ('&REQMBOX' NE '').ZG82B  KEYS?                   00106000
                AIF   ('&REQTOKEN' NE '').ZG82B  KEYS?                  00106100
                AIF   ('&EXIT' NE '').ZG82B     KEYS?                   00106200
                AIF   ('&ECB' NE '').ZG82B      KEYS?                   00106300
                AIF   ('&MSGTOKEN' NE '').ZG82B  KEYS?                  00106400
                AIF   ('&USERRC' NE '').ZG82B   KEYS?                   00106500
                AIF   ('&MSGATTR' NE '').ZG82B  KEYS?                   00106600
                AIF   ('&RTNCODE' NE '').ZG82B  KEYS?                   00106700
                AIF   ('&RSNCODE' NE '').ZG82B  KEYS?                   00106800
                AGO    .ZG82C     INVOCATION OKAY                       00106900
.ZG82B          ANOP  ,                                                 00107000
&ZMS            SETC  'THE "L" FORM OF "MF"'    *MFLA* MNOTE            00107100
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00107200
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00107300
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00107400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00107500
.ZG82C          ANOP  ,                                                 00107600
.*-------------------------------------------------------------------   00107700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00107800
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00107900
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00108000
                AIF   (N'&MF(2) GT 1).ZG84B     MULTI PARMS             00108100
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00108200
.ZG84B          AIF   (K'&MF(2) GT 0).ZG84C                             00108300
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00108400
&ZMS            SETC  'WHEN "L" IS SPECIFIED'   *KRQDA*                 00108500
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00108600
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00108700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00108800
.ZG84C          ANOP  ,                                                 00108900
.*-------------------------------------------------------------------   00109000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00109100
                AIF   (K'&ZXMFCTRL LE 0).ZG84P  NOT I/O                 00109200
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG84P                    00109300
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00109400
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00109500
&ZMS            SETC  '&ZMS.&MF"'                                       00109600
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00109700
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00109800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00109900
.ZG84P          ANOP  ,                                                 00110000
.*-------------------------------------------------------------------   00110100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00110200
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00110300
&XMFATTR        SETC  '0D'                                              00110400
                AIF   (K'&MF(3) LE 0).ZG87B     PARM                    00110500
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00110600
                AIF   (N'&MF(3) GT 1).ZG87B     MULTI PARMS             00110700
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00110800
.ZG87B          ANOP  ,                                                 00110900
.*-------------------------------------------------------------------   00111000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00111100
                AIF   (K'&ZXMFATTR LE 0).ZG87P  NOT I/O                 00111200
                AIF   ('&XMFATTR'(1,1) NE '(').ZG87P                    00111300
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00111400
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00111500
&ZMS            SETC  '&ZMS.&MF"'                                       00111600
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00111700
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00111800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00111900
.ZG87P          ANOP  ,                                                 00112000
.*-------------------------------------------------------------------   00112100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00112200
                AIF   (K'&ZXMFATTR LE 0).ZG87S  NOT I/O                 00112300
                AIF   (K'&XMFATTR LE 60).ZG87S  LNG OK                  00112400
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00112500
&ZMS            SETC  '"MF='      *KLNGA* MNOTE                         00112600
&ZMS            SETC  '&ZMS.&MF"'                                       00112700
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00112800
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00112900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00113000
.ZG87S          ANOP  ,                                                 00113100
.*-------------------------------------------------------------------   00113200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00113300
.ZG89           ANOP  ,                                                 00113400
&ZTLC           SETC 'E'                                                00113500
                AIF   ('&MF(1)' NE '&ZTLC').ZG97                        00113600
&XMF            SETC  'E'         SET KEYWORD                           00113700
                AIF   (N'&MF LE 3).ZG89A        CK NUM                  00113800
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00113900
&ZMS            SETC  '&ZMS.&MF"'                                       00114000
&ZMS            SETC  '&ZMS "MF"'                                       00114100
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00114200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00114300
.ZG89A          ANOP  ,                                                 00114400
.*-------------------------------------------------------------------   00114500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00114600
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00114700
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00114800
                AIF   (N'&MF(2) GT 1).ZG91B     MULTI PARMS             00114900
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00115000
.ZG91B          AIF   (K'&MF(2) GT 0).ZG91C                             00115100
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00115200
&ZMS            SETC  'WHEN "E" IS SPECIFIED'   *KRQDA*                 00115300
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00115400
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00115500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00115600
.ZG91C          ANOP  ,                                                 00115700
.*-------------------------------------------------------------------   00115800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00115900
                AIF   (K'&ZXMFCTRL LE 0).ZG91R  NOT I/O                 00116000
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG91R                    00116100
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00116200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG91P                      00116300
                AIF   (K'&ZCGPR GT 2).ZG91Q                             00116400
                AIF   ('&ZCGPR' EQ '0').ZG91Q                           00116500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00116600
                AIF   (T'&ZCGPR NE 'N').ZG91Q   INVALID REG NAME        00116700
.ZG91P          ANOP  ,                                                 00116800
                AIF   (T'&ZCGPR NE 'N').ZG91R   NON NUMERIC             00116900
                AIF   ('&ZCGPR' LT '1').ZG91Q                           00117000
                AIF   ('&ZCGPR' LE '12').ZG91R                          00117100
.ZG91Q          ANOP  ,                                                 00117200
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00117300
&ZMS            SETC  '&ZMS.&MF"'                                       00117400
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00117500
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00117600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00117700
.ZG91R          ANOP  ,                                                 00117800
.*-------------------------------------------------------------------   00117900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00118000
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00118100
.ZG95A   AIF   ('&MF(3)' NE 'COMPLETE').ZG96A                           00118200
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00118300
.*-------------------------------------------------------------------   00118400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00118500
.ZG96A          AIF   (K'&XMFSCK GT 0).ZG96C    KEYWORD                 00118600
                AIF   (K'&MF(3) LE 0).ZG96B                             00118700
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00118800
&ZMS            SETC  '&ZMS.&MF"'                                       00118900
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00119000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00119100
&ZMS            SETC  '&ZMS "COMPLETE".'        VALID KEYWORD           00119200
                MNOTE 8,' &ZMS '                                        00119300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00119400
.ZG96B          ANOP  ,                                                 00119500
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00119600
.ZG96C          ANOP  ,                                                 00119700
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00119800
.*------------------------------------------------------------------    00119900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120000
.ZG97           ANOP  ,                                                 00120100
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00120200
                AIF   (K'&XMF GT 0).ZG97E       VALID ARG               00120300
                AIF   (T'&MF EQ 'O').ZG97D      OMITTED                 00120400
&ZASYSLNDX      SETA  0                                                 00120500
.ZG97A          ANOP  ,           POSITIONAL MACRO KEY                  00120600
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00120700
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG97C                  00120800
&ZTLC           SETC 'MF'                                               00120900
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG97A         00121000
.ZG97B          ANOP  ,                                                 00121100
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00121200
&ZMS            SETC  'THE "MF" KEY'            *KOPTA* MNOTE           00121300
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00121400
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00121500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00121600
                AGO   .ZG97E                                            00121700
.ZG97C          ANOP  ,                                                 00121800
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00121900
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00122000
&ZMS            SETC  '&ZMS.&MF"'                                       00122100
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00122200
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00122300
&ZMS            SETC  '&ZMS "S",'               VALID KEYWORD           00122400
&ZMS            SETC  '&ZMS "L",'               VALID KEYWORD           00122500
&ZMS            SETC  '&ZMS OR "E".'            VALID KEYWORD           00122600
                MNOTE 8,' &ZMS '                                        00122700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00122800
                AGO   .ZG97E                                            00122900
.ZG97D          ANOP  ,                                                 00123000
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00123100
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00123200
.ZG97E          ANOP  ,                                                 00123300
.********************************************************************   00123400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00123500
.********************************************************************   00123600
                ACTR  10000                                             00123700
.*-------------------------------------------------------------------   00123800
.***AG.MF03 MF=(SLE)                                                    00123900
                AIF   ('&XMF' EQ 'L').ZGMFX                             00124000
.*----------------------------------------------------------------***   00124100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00124200
                AIF   (N'&MBOXNAME LE 1).ZG2A   CK NUM                  00124300
&ZMS            SETC  '"MBOXNAME='              *KPOSA* MNOTE           00124400
&ZMS            SETC  '&ZMS.&MBOXNAME"'                                 00124500
&ZMS            SETC  '&ZMS "MBOXNAME"'                                 00124600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00124700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00124800
.ZG2A           ANOP  ,                                                 00124900
.*-------------------------------------------------------------------   00125000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00125100
&ZXMBOXNAME     SETC  'INPUT'     SET IN/OUTPUT                         00125200
&XMBOXNAME      SETC  '&MBOXNAME(1)'            SET XVARIABLE           00125300
                AIF   (N'&MBOXNAME GT 1).ZG2B   MULTI PARMS             00125400
&XMBOXNAME      SETC  '&MBOXNAME'               SET XVARIABLE           00125500
.ZG2B           AIF   (K'&MBOXNAME(1) GT 0).ZG2C                        00125600
&ZXMBOXNAME     SETC  ''          RESET IN/OUTPUT                       00125700
&ZMS            SETC  ' '         *KRQDA*                               00125800
&ZMS            SETC  '&ZMS "MBOXNAME" KEY AND ITS ARGUMENT'            00125900
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00126000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00126100
.ZG2C           ANOP  ,                                                 00126200
.*-------------------------------------------------------------------   00126300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00126400
                AIF   (K'&ZXMBOXNAME LE 0).ZG2R  NOT I/O                00126500
                AIF   ('&XMBOXNAME'(1,1) NE '(').ZG2R                   00126600
&ZCGPR          SETC  '&XMBOXNAME'(2,K'&XMBOXNAME-2)                    00126700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                       00126800
                AIF   (K'&ZCGPR GT 2).ZG2Q                              00126900
                AIF   ('&ZCGPR' EQ '0').ZG2Q                            00127000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00127100
                AIF   (T'&ZCGPR NE 'N').ZG2Q    INVALID REG NAME        00127200
.ZG2P           ANOP  ,                                                 00127300
                AIF   (T'&ZCGPR NE 'N').ZG2R    NON NUMERIC             00127400
                AIF   ('&ZCGPR' LT '2').ZG2Q                            00127500
                AIF   ('&ZCGPR' LE '12').ZG2R                           00127600
.ZG2Q           ANOP  ,                                                 00127700
&ZMS            SETC  '"MBOXNAME='              *KGPRA* MNOTE           00127800
&ZMS            SETC  '&ZMS.&MBOXNAME"'                                 00127900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00128000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00128100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00128200
.ZG2R           ANOP  ,                                                 00128300
.*----------------------------------------------------------------***   00128400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00128500
                AIF   (N'&MEMBER LE 1).ZG5A     CK NUM                  00128600
&ZMS            SETC  '"MEMBER='  *KPOSA* MNOTE                         00128700
&ZMS            SETC  '&ZMS.&MEMBER"'                                   00128800
&ZMS            SETC  '&ZMS "MEMBER"'                                   00128900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00129000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00129100
.ZG5A           ANOP  ,                                                 00129200
.*-------------------------------------------------------------------   00129300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00129400
&ZXMEMBER       SETC  'INPUT'     SET IN/OUTPUT                         00129500
&XMEMBER        SETC  '&MEMBER(1)'              SET XVARIABLE           00129600
                AIF   (N'&MEMBER GT 1).ZG5B     MULTI PARMS             00129700
&XMEMBER        SETC  '&MEMBER'   SET XVARIABLE                         00129800
.ZG5B           AIF   (K'&MEMBER(1) GT 0).ZG5C                          00129900
&ZXMEMBER       SETC  ''          RESET IN/OUTPUT                       00130000
&ZMS            SETC  ' '         *KRQDA*                               00130100
&ZMS            SETC  '&ZMS "MEMBER" KEY AND ITS ARGUMENT'              00130200
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00130300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00130400
.ZG5C           ANOP  ,                                                 00130500
.*-------------------------------------------------------------------   00130600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00130700
                AIF   (K'&ZXMEMBER LE 0).ZG5R   NOT I/O                 00130800
                AIF   ('&XMEMBER'(1,1) NE '(').ZG5R                     00130900
&ZCGPR          SETC  '&XMEMBER'(2,K'&XMEMBER-2)                        00131000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                       00131100
                AIF   (K'&ZCGPR GT 2).ZG5Q                              00131200
                AIF   ('&ZCGPR' EQ '0').ZG5Q                            00131300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00131400
                AIF   (T'&ZCGPR NE 'N').ZG5Q    INVALID REG NAME        00131500
.ZG5P           ANOP  ,                                                 00131600
                AIF   (T'&ZCGPR NE 'N').ZG5R    NON NUMERIC             00131700
                AIF   ('&ZCGPR' LT '2').ZG5Q                            00131800
                AIF   ('&ZCGPR' LE '12').ZG5R                           00131900
.ZG5Q           ANOP  ,                                                 00132000
&ZMS            SETC  '"MEMBER='  *KGPRA* MNOTE                         00132100
&ZMS            SETC  '&ZMS.&MEMBER"'                                   00132200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00132300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00132400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00132500
.ZG5R           ANOP  ,                                                 00132600
.*----------------------------------------------------------------***   00132700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00132800
                AIF   (N'&DATA LE 1).ZG8A       CK NUM                  00132900
&ZMS            SETC  '"DATA='    *KPOSA* MNOTE                         00133000
&ZMS            SETC  '&ZMS.&DATA"'                                     00133100
&ZMS            SETC  '&ZMS "DATA"'                                     00133200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00133300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00133400
.ZG8A           ANOP  ,                                                 00133500
.*-------------------------------------------------------------------   00133600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00133700
&ZXDATA         SETC  'INPUT'     SET IN/OUTPUT                         00133800
&XDATA          SETC  '&DATA(1)'  SET XVARIABLE                         00133900
                AIF   (N'&DATA GT 1).ZG8B       MULTI PARMS             00134000
&XDATA          SETC  '&DATA'     SET XVARIABLE                         00134100
.ZG8B           AIF   (K'&DATA(1) GT 0).ZG8C                            00134200
&ZXDATA         SETC  ''          RESET IN/OUTPUT                       00134300
&ZMS            SETC  ' '         *KRQDA*                               00134400
&ZMS            SETC  '&ZMS "DATA" KEY AND ITS ARGUMENT'                00134500
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00134600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00134700
.ZG8C           ANOP  ,                                                 00134800
.*-------------------------------------------------------------------   00134900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00135000
                AIF   (K'&ZXDATA LE 0).ZG8R     NOT I/O                 00135100
                AIF   ('&XDATA'(1,1) NE '(').ZG8R                       00135200
&ZCGPR          SETC  '&XDATA'(2,K'&XDATA-2)                            00135300
                AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                       00135400
                AIF   (K'&ZCGPR GT 2).ZG8Q                              00135500
                AIF   ('&ZCGPR' EQ '0').ZG8Q                            00135600
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00135700
                AIF   (T'&ZCGPR NE 'N').ZG8Q    INVALID REG NAME        00135800
.ZG8P           ANOP  ,                                                 00135900
                AIF   (T'&ZCGPR NE 'N').ZG8R    NON NUMERIC             00136000
                AIF   ('&ZCGPR' LT '2').ZG8Q                            00136100
                AIF   ('&ZCGPR' LE '12').ZG8R                           00136200
.ZG8Q           ANOP  ,                                                 00136300
&ZMS            SETC  '"DATA='    *KGPRA* MNOTE                         00136400
&ZMS            SETC  '&ZMS.&DATA"'                                     00136500
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00136600
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00136700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00136800
.ZG8R           ANOP  ,                                                 00136900
.*----------------------------------------------------------------***   00137000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00137100
                AIF   (N'&DATAALET LE 1).ZG10A  CK NUM                  00137200
&ZMS            SETC  '"DATAALET='              *KPOSA* MNOTE           00137300
&ZMS            SETC  '&ZMS.&DATAALET"'                                 00137400
&ZMS            SETC  '&ZMS "DATAALET"'                                 00137500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00137600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00137700
.ZG10A          ANOP  ,                                                 00137800
.*-------------------------------------------------------------------   00137900
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00138000
&XDATAALET      SETC  '0'         SET DEFAULT                           00138100
                AIF   (K'&DATAALET(1) LE 0).ZG10C  PARM                 00138200
&XDATAALET      SETC  '&DATAALET(1)'            SET XVARIABLE           00138300
                AIF   (N'&DATAALET GT 1).ZG10B  MULTI PARMS             00138400
&XDATAALET      SETC  '&DATAALET'               SET XVARIABLE           00138500
.ZG10B          AIF   (K'&DATA(1) GT 0).ZG10C   KEY                     00138600
&ZMS            SETC  '"DATAALET'               *KDEPA* MNOTE           00138700
&ZMS            SETC  '&ZMS.=&DATAALET"'                                00138800
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00138900
&ZMS            SETC  '&ZMS '                                           00139000
&ZMS            SETC  '&ZMS "DATA"'                                     00139100
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00139200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00139300
.ZG10C          ANOP  ,                                                 00139400
&ZXDATAALET     SETC  'INPUT'     SET IN/OUTPUT                         00139500
.*-------------------------------------------------------------------   00139600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00139700
                AIF   (K'&ZXDATAALET LE 0).ZG10R  NOT I/O               00139800
                AIF   ('&XDATAALET'(1,1) NE '(').ZG10R                  00139900
&ZCGPR          SETC  '&XDATAALET'(2,K'&XDATAALET-2)                    00140000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                      00140100
                AIF   (K'&ZCGPR GT 2).ZG10Q                             00140200
                AIF   ('&ZCGPR' EQ '0').ZG10Q                           00140300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00140400
                AIF   (T'&ZCGPR NE 'N').ZG10Q   INVALID REG NAME        00140500
.ZG10P          ANOP  ,                                                 00140600
                AIF   (T'&ZCGPR NE 'N').ZG10R   NON NUMERIC             00140700
                AIF   ('&ZCGPR' LT '2').ZG10Q                           00140800
                AIF   ('&ZCGPR' LE '12').ZG10R                          00140900
.ZG10Q          ANOP  ,                                                 00141000
&ZMS            SETC  '"DATAALET='              *KGPRA* MNOTE           00141100
&ZMS            SETC  '&ZMS.&DATAALET"'                                 00141200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00141300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00141400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00141500
.ZG10R          ANOP  ,                                                 00141600
.*----------------------------------------------------------------***   00141700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00141800
                AIF   (N'&DATALEN LE 1).ZG13A   CK NUM                  00141900
&ZMS            SETC  '"DATALEN='               *KPOSA* MNOTE           00142000
&ZMS            SETC  '&ZMS.&DATALEN"'                                  00142100
&ZMS            SETC  '&ZMS "DATALEN"'                                  00142200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00142300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00142400
.ZG13A          ANOP  ,                                                 00142500
.*-------------------------------------------------------------------   00142600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00142700
&ZXDATALEN      SETC  'INPUT'     SET IN/OUTPUT                         00142800
&XDATALEN       SETC  '&DATALEN(1)'             SET XVARIABLE           00142900
                AIF   (N'&DATALEN GT 1).ZG13B   MULTI PARMS             00143000
&XDATALEN       SETC  '&DATALEN'  SET XVARIABLE                         00143100
.ZG13B          AIF   (K'&DATALEN(1) GT 0).ZG13C                        00143200
&ZXDATALEN      SETC  ''          RESET IN/OUTPUT                       00143300
&ZMS            SETC  ' '         *KRQDA*                               00143400
&ZMS            SETC  '&ZMS "DATALEN" KEY AND ITS ARGUMENT'             00143500
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00143600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00143700
.ZG13C          ANOP  ,                                                 00143800
.*-------------------------------------------------------------------   00143900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00144000
                AIF   (K'&ZXDATALEN LE 0).ZG13R  NOT I/O                00144100
                AIF   ('&XDATALEN'(1,1) NE '(').ZG13R                   00144200
&ZCGPR          SETC  '&XDATALEN'(2,K'&XDATALEN-2)                      00144300
                AIF   ('&ZCGPR'(1,1) NE '0').ZG13P                      00144400
                AIF   (K'&ZCGPR GT 2).ZG13Q                             00144500
                AIF   ('&ZCGPR' EQ '0').ZG13Q                           00144600
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00144700
                AIF   (T'&ZCGPR NE 'N').ZG13Q   INVALID REG NAME        00144800
.ZG13P          ANOP  ,                                                 00144900
                AIF   (T'&ZCGPR NE 'N').ZG13R   NON NUMERIC             00145000
                AIF   ('&ZCGPR' LT '2').ZG13Q                           00145100
                AIF   ('&ZCGPR' LE '12').ZG13R                          00145200
.ZG13Q          ANOP  ,                                                 00145300
&ZMS            SETC  '"DATALEN='               *KGPRA* MNOTE           00145400
&ZMS            SETC  '&ZMS.&DATALEN"'                                  00145500
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00145600
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00145700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00145800
.ZG13R          ANOP  ,                                                 00145900
.*----------------------------------------------------------------***   00146000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146100
                AIF   (N'&REQTYPE LE 1).ZG17A   CK NUM                  00146200
&ZMS            SETC  '"REQTYPE='               *KPOSA* MNOTE           00146300
&ZMS            SETC  '&ZMS.&REQTYPE"'                                  00146400
&ZMS            SETC  '&ZMS "REQTYPE"'                                  00146500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00146600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00146700
.ZG17A          ANOP  ,                                                 00146800
.*-------------------------------------------------------------------   00146900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147000
&XREQTYPE       SETC  ''          INITIALIZE XVARIABLE                  00147100
.ZG18A   AIF   ('&REQTYPE(1)' NE 'COMM').ZG19A                          00147200
&XREQTYPE       SETC  'COMM'      SET KEYWORD                           00147300
.*-------------------------------------------------------------------   00147400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147500
.ZG19A   AIF   ('&REQTYPE(1)' NE 'ASYNCACK').ZG20A                      00147600
&XREQTYPE       SETC  'ASYNCACK'  SET KEYWORD                           00147700
.*-------------------------------------------------------------------   00147800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147900
.ZG20A   AIF   ('&REQTYPE(1)' NE 'ASYNC').ZG21A                         00148000
&XREQTYPE       SETC  'ASYNC'     SET KEYWORD                           00148100
.*-------------------------------------------------------------------   00148200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00148300
.ZG21A   AIF   ('&REQTYPE(1)' NE 'SYNC').ZG22A                          00148400
&XREQTYPE       SETC  'SYNC'      SET KEYWORD                           00148500
.*-------------------------------------------------------------------   00148600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00148700
.ZG22A          AIF   (K'&XREQTYPE GT 0).ZG22C  KEYWORD                 00148800
                AIF   (K'&REQTYPE(1) LE 0).ZG22B                        00148900
&ZMS            SETC  '"REQTYPE='               *KUKWA* MNOTE           00149000
&ZMS            SETC  '&ZMS.&REQTYPE"'                                  00149100
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00149200
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00149300
&ZMS            SETC  '&ZMS "COMM",'            VALID KEYWORD           00149400
&ZMS            SETC  '&ZMS "ASYNCACK",'        VALID KEYWORD           00149500
&ZMS            SETC  '&ZMS "ASYNC",'           VALID KEYWORD           00149600
&ZMS            SETC  '&ZMS OR "SYNC".'         VALID KEYWORD           00149700
                MNOTE 8,' &ZMS '                                        00149800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00149900
.ZG22B          ANOP  ,                                                 00150000
&XREQTYPE       SETC  'COMM'      SET DEFAULT KEYWORD                   00150100
.ZG22C          ANOP  ,                                                 00150200
&ZXREQTYPE      SETC  'INPUT'     SET IN/OUTPUT                         00150300
.*----------------------------------------------------------------***   00150400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00150500
                AIF   (N'&SEGTYPE LE 1).ZG24A   CK NUM                  00150600
&ZMS            SETC  '"SEGTYPE='               *KPOSA* MNOTE           00150700
&ZMS            SETC  '&ZMS.&SEGTYPE"'                                  00150800
&ZMS            SETC  '&ZMS "SEGTYPE"'                                  00150900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00151000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00151100
.ZG24A          ANOP  ,                                                 00151200
.*-------------------------------------------------------------------   00151300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00151400
&XSEGTYPE       SETC  ''          INITIALIZE XVARIABLE                  00151500
.ZG25A   AIF   ('&SEGTYPE(1)' NE 'SINGLE').ZG26A                        00151600
&XSEGTYPE       SETC  'SINGLE'    SET KEYWORD                           00151700
.*-------------------------------------------------------------------   00151800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00151900
.ZG26A   AIF   ('&SEGTYPE(1)' NE 'FIRST').ZG27A                         00152000
&XSEGTYPE       SETC  'FIRST'     SET KEYWORD                           00152100
.*-------------------------------------------------------------------   00152200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00152300
.ZG27A   AIF   ('&SEGTYPE(1)' NE 'MIDDLE').ZG28A                        00152400
&XSEGTYPE       SETC  'MIDDLE'    SET KEYWORD                           00152500
.*-------------------------------------------------------------------   00152600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00152700
.ZG28A   AIF   ('&SEGTYPE(1)' NE 'LAST').ZG29A                          00152800
&XSEGTYPE       SETC  'LAST'      SET KEYWORD                           00152900
.*-------------------------------------------------------------------   00153000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153100
.ZG29A   AIF   ('&SEGTYPE(1)' NE 'ABORT').ZG30A                         00153200
&XSEGTYPE       SETC  'ABORT'     SET KEYWORD                           00153300
.*-------------------------------------------------------------------   00153400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153500
.ZG30A          AIF   (K'&XSEGTYPE GT 0).ZG30C  KEYWORD                 00153600
                AIF   (K'&SEGTYPE(1) LE 0).ZG30B                        00153700
&ZMS            SETC  '"SEGTYPE='               *KUKWA* MNOTE           00153800
&ZMS            SETC  '&ZMS.&SEGTYPE"'                                  00153900
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00154000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00154100
&ZMS            SETC  '&ZMS "SINGLE",'          VALID KEYWORD           00154200
&ZMS            SETC  '&ZMS "FIRST",'           VALID KEYWORD           00154300
&ZMS            SETC  '&ZMS "MIDDLE",'          VALID KEYWORD           00154400
&ZMS            SETC  '&ZMS "LAST",'            VALID KEYWORD           00154500
&ZMS            SETC  '&ZMS OR "ABORT".'        VALID KEYWORD           00154600
                MNOTE 8,' &ZMS '                                        00154700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00154800
.ZG30B          ANOP  ,                                                 00154900
&XSEGTYPE       SETC  'SINGLE'    SET DEFAULT KEYWORD                   00155000
.ZG30C          ANOP  ,                                                 00155100
&ZXSEGTYPE      SETC  'INPUT'     SET IN/OUTPUT                         00155200
.*----------------------------------------------------------------***   00155300
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00155400
                AIF   (N'&CONNECT LE 1).ZG32A   CK NUM                  00155500
&ZMS            SETC  '"CONNECT='               *KPOSA* MNOTE           00155600
&ZMS            SETC  '&ZMS.&CONNECT"'                                  00155700
&ZMS            SETC  '&ZMS "CONNECT"'                                  00155800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00155900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00156000
.ZG32A          ANOP  ,                                                 00156100
.*-------------------------------------------------------------------   00156200
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         00156300
&ZXCONNECT      SETC  'INOUT'     SET IN/OUTPUT                         00156400
&XCONNECT       SETC  '0'                                               00156500
                AIF   (K'&CONNECT(1) LE 0).ZG32B  PARM                  00156600
&XCONNECT       SETC  '&CONNECT(1)'             SET XVARIABLE           00156700
                AIF   (N'&CONNECT GT 1).ZG32B   MULTI PARMS             00156800
&XCONNECT       SETC  '&CONNECT'  SET XVARIABLE                         00156900
.ZG32B          ANOP  ,                                                 00157000
.*-------------------------------------------------------------------   00157100
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00157200
                AIF   (K'&ZXCONNECT LE 0).ZG32R  NOT I/O                00157300
                AIF   ('&XCONNECT'(1,1) NE '(').ZG32R                   00157400
&ZCGPR          SETC  '&XCONNECT'(2,K'&XCONNECT-2)                      00157500
                AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                      00157600
                AIF   (K'&ZCGPR GT 2).ZG32Q                             00157700
                AIF   ('&ZCGPR' EQ '0').ZG32Q                           00157800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00157900
                AIF   (T'&ZCGPR NE 'N').ZG32Q   INVALID REG NAME        00158000
.ZG32P          ANOP  ,                                                 00158100
                AIF   (T'&ZCGPR NE 'N').ZG32R   NON NUMERIC             00158200
                AIF   ('&ZCGPR' LT '2').ZG32Q                           00158300
                AIF   ('&ZCGPR' LE '12').ZG32R                          00158400
.ZG32Q          ANOP  ,                                                 00158500
&ZMS            SETC  '"CONNECT='               *KGPRA* MNOTE           00158600
&ZMS            SETC  '&ZMS.&CONNECT"'                                  00158700
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00158800
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00158900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00159000
.ZG32R          ANOP  ,                                                 00159100
.*----------------------------------------------------------------***   00159200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00159300
                AIF   (N'&GROUPTOKEN LE 1).ZG35A  CK NUM                00159400
&ZMS            SETC  '"GROUPTOKEN='            *KPOSA* MNOTE           00159500
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00159600
&ZMS            SETC  '&ZMS "GROUPTOKEN"'                               00159700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00159800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00159900
.ZG35A          ANOP  ,                                                 00160000
.*-------------------------------------------------------------------   00160100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00160200
&ZXGROUPTOKEN   SETC  'INPUT'     SET IN/OUTPUT                         00160300
&XGROUPTOKEN    SETC  '&GROUPTOKEN(1)'          SET XVARIABLE           00160400
                AIF   (N'&GROUPTOKEN GT 1).ZG35B  MULTI PARMS           00160500
&XGROUPTOKEN    SETC  '&GROUPTOKEN'             SET XVARIABLE           00160600
.ZG35B          AIF   (K'&GROUPTOKEN(1) GT 0).ZG35C                     00160700
&ZXGROUPTOKEN   SETC  ''          RESET IN/OUTPUT                       00160800
&ZMS            SETC  ' '         *KRQDA*                               00160900
&ZMS            SETC  '&ZMS "GROUPTOKEN" KEY AND ITS ARGUMENT'          00161000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00161100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00161200
.ZG35C          ANOP  ,                                                 00161300
.*-------------------------------------------------------------------   00161400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00161500
                AIF   (K'&ZXGROUPTOKEN LE 0).ZG35R  NOT I/O             00161600
                AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZG35R                00161700
&ZCGPR          SETC  '&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2)                00161800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                      00161900
                AIF   (K'&ZCGPR GT 2).ZG35Q                             00162000
                AIF   ('&ZCGPR' EQ '0').ZG35Q                           00162100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00162200
                AIF   (T'&ZCGPR NE 'N').ZG35Q   INVALID REG NAME        00162300
.ZG35P          ANOP  ,                                                 00162400
                AIF   (T'&ZCGPR NE 'N').ZG35R   NON NUMERIC             00162500
                AIF   ('&ZCGPR' LT '2').ZG35Q                           00162600
                AIF   ('&ZCGPR' LE '12').ZG35R                          00162700
.ZG35Q          ANOP  ,                                                 00162800
&ZMS            SETC  '"GROUPTOKEN='            *KGPRA* MNOTE           00162900
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00163000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00163100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00163200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00163300
.ZG35R          ANOP  ,                                                 00163400
.*----------------------------------------------------------------***   00163500
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00163600
                AIF   (N'&RESPDATA LE 1).ZG38A  CK NUM                  00163700
&ZMS            SETC  '"RESPDATA='              *KPOSA* MNOTE           00163800
&ZMS            SETC  '&ZMS.&RESPDATA"'                                 00163900
&ZMS            SETC  '&ZMS "RESPDATA"'                                 00164000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00164100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00164200
.ZG38A          ANOP  ,                                                 00164300
.*-------------------------------------------------------------------   00164400
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         00164500
&ZXRESPDATA     SETC  'INOUT'     SET IN/OUTPUT                         00164600
&XRESPDATA      SETC  '0'                                               00164700
                AIF   (K'&RESPDATA(1) LE 0).ZG38B  PARM                 00164800
&XRESPDATA      SETC  '&RESPDATA(1)'            SET XVARIABLE           00164900
                AIF   (N'&RESPDATA GT 1).ZG38B  MULTI PARMS             00165000
&XRESPDATA      SETC  '&RESPDATA'               SET XVARIABLE           00165100
.ZG38B          ANOP  ,                                                 00165200
.*-------------------------------------------------------------------   00165300
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00165400
                AIF   (K'&ZXRESPDATA LE 0).ZG38R  NOT I/O               00165500
                AIF   ('&XRESPDATA'(1,1) NE '(').ZG38R                  00165600
&ZCGPR          SETC  '&XRESPDATA'(2,K'&XRESPDATA-2)                    00165700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                      00165800
                AIF   (K'&ZCGPR GT 2).ZG38Q                             00165900
                AIF   ('&ZCGPR' EQ '0').ZG38Q                           00166000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00166100
                AIF   (T'&ZCGPR NE 'N').ZG38Q   INVALID REG NAME        00166200
.ZG38P          ANOP  ,                                                 00166300
                AIF   (T'&ZCGPR NE 'N').ZG38R   NON NUMERIC             00166400
                AIF   ('&ZCGPR' LT '2').ZG38Q                           00166500
                AIF   ('&ZCGPR' LE '12').ZG38R                          00166600
.ZG38Q          ANOP  ,                                                 00166700
&ZMS            SETC  '"RESPDATA='              *KGPRA* MNOTE           00166800
&ZMS            SETC  '&ZMS.&RESPDATA"'                                 00166900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00167000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00167100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00167200
.ZG38R          ANOP  ,                                                 00167300
.*----------------------------------------------------------------***   00167400
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00167500
                AIF   (N'&RESPDLEN LE 1).ZG40A  CK NUM                  00167600
&ZMS            SETC  '"RESPDLEN='              *KPOSA* MNOTE           00167700
&ZMS            SETC  '&ZMS.&RESPDLEN"'                                 00167800
&ZMS            SETC  '&ZMS "RESPDLEN"'                                 00167900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00168000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00168100
.ZG40A          ANOP  ,                                                 00168200
.*-------------------------------------------------------------------   00168300
.***AG.KXVAR17 NAME, OPT INOUT, KEYS -XVARIABLE                         00168400
&XRESPDLEN      SETC  '0'         SET DEFAULT                           00168500
                AIF   (K'&RESPDLEN(1) LE 0).ZG40C  PARM                 00168600
&XRESPDLEN      SETC  '&RESPDLEN(1)'            SET XVARIABLE           00168700
                AIF   (N'&RESPDLEN GT 1).ZG40B  MULTI PARMS             00168800
&XRESPDLEN      SETC  '&RESPDLEN'               SET XVARIABLE           00168900
.ZG40B          AIF   (K'&RESPDATA(1) GT 0).ZG40C  KEY                  00169000
&ZMS            SETC  '"RESPDLEN'               *KDEPA* MNOTE           00169100
&ZMS            SETC  '&ZMS.=&RESPDLEN"'                                00169200
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00169300
&ZMS            SETC  '&ZMS '                                           00169400
&ZMS            SETC  '&ZMS "RESPDATA"'                                 00169500
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00169600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00169700
.ZG40C          ANOP  ,                                                 00169800
&ZXRESPDLEN     SETC  'INOUT'     SET IN/OUTPUT                         00169900
.*-------------------------------------------------------------------   00170000
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00170100
                AIF   (K'&ZXRESPDLEN LE 0).ZG40R  NOT I/O               00170200
                AIF   ('&XRESPDLEN'(1,1) NE '(').ZG40R                  00170300
&ZCGPR          SETC  '&XRESPDLEN'(2,K'&XRESPDLEN-2)                    00170400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                      00170500
                AIF   (K'&ZCGPR GT 2).ZG40Q                             00170600
                AIF   ('&ZCGPR' EQ '0').ZG40Q                           00170700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00170800
                AIF   (T'&ZCGPR NE 'N').ZG40Q   INVALID REG NAME        00170900
.ZG40P          ANOP  ,                                                 00171000
                AIF   (T'&ZCGPR NE 'N').ZG40R   NON NUMERIC             00171100
                AIF   ('&ZCGPR' LT '2').ZG40Q                           00171200
                AIF   ('&ZCGPR' LE '12').ZG40R                          00171300
.ZG40Q          ANOP  ,                                                 00171400
&ZMS            SETC  '"RESPDLEN='              *KGPRA* MNOTE           00171500
&ZMS            SETC  '&ZMS.&RESPDLEN"'                                 00171600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00171700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00171800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00171900
.ZG40R          ANOP  ,                                                 00172000
.*----------------------------------------------------------------***   00172100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00172200
                AIF   (N'&RESPDALT LE 1).ZG42A  CK NUM                  00172300
&ZMS            SETC  '"RESPDALT='              *KPOSA* MNOTE           00172400
&ZMS            SETC  '&ZMS.&RESPDALT"'                                 00172500
&ZMS            SETC  '&ZMS "RESPDALT"'                                 00172600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00172700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00172800
.ZG42A          ANOP  ,                                                 00172900
.*-------------------------------------------------------------------   00173000
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00173100
&XRESPDALT      SETC  '0'         SET DEFAULT                           00173200
                AIF   (K'&RESPDALT(1) LE 0).ZG42C  PARM                 00173300
&XRESPDALT      SETC  '&RESPDALT(1)'            SET XVARIABLE           00173400
                AIF   (N'&RESPDALT GT 1).ZG42B  MULTI PARMS             00173500
&XRESPDALT      SETC  '&RESPDALT'               SET XVARIABLE           00173600
.ZG42B          AIF   (K'&RESPDLEN(1) GT 0).ZG42C  KEY                  00173700
&ZMS            SETC  '"RESPDALT'               *KDEPA* MNOTE           00173800
&ZMS            SETC  '&ZMS.=&RESPDALT"'                                00173900
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00174000
&ZMS            SETC  '&ZMS '                                           00174100
&ZMS            SETC  '&ZMS "RESPDLEN"'                                 00174200
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00174300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00174400
.ZG42C          ANOP  ,                                                 00174500
&ZXRESPDALT     SETC  'INPUT'     SET IN/OUTPUT                         00174600
.*-------------------------------------------------------------------   00174700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00174800
                AIF   (K'&ZXRESPDALT LE 0).ZG42R  NOT I/O               00174900
                AIF   ('&XRESPDALT'(1,1) NE '(').ZG42R                  00175000
&ZCGPR          SETC  '&XRESPDALT'(2,K'&XRESPDALT-2)                    00175100
                AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                      00175200
                AIF   (K'&ZCGPR GT 2).ZG42Q                             00175300
                AIF   ('&ZCGPR' EQ '0').ZG42Q                           00175400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00175500
                AIF   (T'&ZCGPR NE 'N').ZG42Q   INVALID REG NAME        00175600
.ZG42P          ANOP  ,                                                 00175700
                AIF   (T'&ZCGPR NE 'N').ZG42R   NON NUMERIC             00175800
                AIF   ('&ZCGPR' LT '2').ZG42Q                           00175900
                AIF   ('&ZCGPR' LE '12').ZG42R                          00176000
.ZG42Q          ANOP  ,                                                 00176100
&ZMS            SETC  '"RESPDALT='              *KGPRA* MNOTE           00176200
&ZMS            SETC  '&ZMS.&RESPDALT"'                                 00176300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00176400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00176500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00176600
.ZG42R          ANOP  ,                                                 00176700
.*----------------------------------------------------------------***   00176800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00176900
                AIF   (N'&REQMBOX LE 1).ZG47A   CK NUM                  00177000
&ZMS            SETC  '"REQMBOX='               *KPOSA* MNOTE           00177100
&ZMS            SETC  '&ZMS.&REQMBOX"'                                  00177200
&ZMS            SETC  '&ZMS "REQMBOX"'                                  00177300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00177400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00177500
.ZG47A          ANOP  ,                                                 00177600
.*-------------------------------------------------------------------   00177700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00177800
&ZXREQMBOX      SETC  'INPUT'     SET IN/OUTPUT                         00177900
&XREQMBOX       SETC  '!NONE!'                                          00178000
                AIF   (K'&REQMBOX(1) LE 0).ZG47B  PARM                  00178100
&XREQMBOX       SETC  '&REQMBOX(1)'             SET XVARIABLE           00178200
                AIF   (N'&REQMBOX GT 1).ZG47B   MULTI PARMS             00178300
&XREQMBOX       SETC  '&REQMBOX'  SET XVARIABLE                         00178400
.ZG47B          ANOP  ,                                                 00178500
.*-------------------------------------------------------------------   00178600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00178700
                AIF   (K'&ZXREQMBOX LE 0).ZG47R  NOT I/O                00178800
                AIF   ('&XREQMBOX'(1,1) NE '(').ZG47R                   00178900
&ZCGPR          SETC  '&XREQMBOX'(2,K'&XREQMBOX-2)                      00179000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                      00179100
                AIF   (K'&ZCGPR GT 2).ZG47Q                             00179200
                AIF   ('&ZCGPR' EQ '0').ZG47Q                           00179300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00179400
                AIF   (T'&ZCGPR NE 'N').ZG47Q   INVALID REG NAME        00179500
.ZG47P          ANOP  ,                                                 00179600
                AIF   (T'&ZCGPR NE 'N').ZG47R   NON NUMERIC             00179700
                AIF   ('&ZCGPR' LT '2').ZG47Q                           00179800
                AIF   ('&ZCGPR' LE '12').ZG47R                          00179900
.ZG47Q          ANOP  ,                                                 00180000
&ZMS            SETC  '"REQMBOX='               *KGPRA* MNOTE           00180100
&ZMS            SETC  '&ZMS.&REQMBOX"'                                  00180200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00180300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00180400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00180500
.ZG47R          ANOP  ,                                                 00180600
.*----------------------------------------------------------------***   00180700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00180800
                AIF   (N'&REQTOKEN LE 1).ZG49A  CK NUM                  00180900
&ZMS            SETC  '"REQTOKEN='              *KPOSA* MNOTE           00181000
&ZMS            SETC  '&ZMS.&REQTOKEN"'                                 00181100
&ZMS            SETC  '&ZMS "REQTOKEN"'                                 00181200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00181300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00181400
.ZG49A          ANOP  ,                                                 00181500
.*-------------------------------------------------------------------   00181600
.***AG.KXVAR18 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00181700
                AIF   (K'&REQTOKEN(1) LE 0).ZG49C  PARM                 00181800
&ZXREQTOKEN     SETC  'OUTPUT'    SET OUTPUT                            00181900
&XREQTOKEN      SETC  '&REQTOKEN(1)'            SET XVARIABLE           00182000
                AIF   (N'&REQTOKEN GT 1).ZG49B  MULTIPLE PARMS          00182100
&XREQTOKEN      SETC  '&REQTOKEN'               SET XVARIABLE           00182200
.ZG49B          AIF   (K'&REQMBOX(1) GT 0).ZG49C  KEY                   00182300
&ZMS            SETC  '"REQTOKEN'               *KDEPA* MNOTE           00182400
&ZMS            SETC  '&ZMS.=&REQTOKEN"'                                00182500
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00182600
&ZMS            SETC  '&ZMS '                                           00182700
&ZMS            SETC  '&ZMS "REQMBOX"'                                  00182800
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00182900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00183000
.ZG49C          ANOP  ,                                                 00183100
.*-------------------------------------------------------------------   00183200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00183300
                AIF   (K'&ZXREQTOKEN LE 0).ZG49R  NOT I/O               00183400
                AIF   ('&XREQTOKEN'(1,1) NE '(').ZG49R                  00183500
&ZCGPR          SETC  '&XREQTOKEN'(2,K'&XREQTOKEN-2)                    00183600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                      00183700
                AIF   (K'&ZCGPR GT 2).ZG49Q                             00183800
                AIF   ('&ZCGPR' EQ '0').ZG49Q                           00183900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00184000
                AIF   (T'&ZCGPR NE 'N').ZG49Q   INVALID REG NAME        00184100
.ZG49P          ANOP  ,                                                 00184200
                AIF   (T'&ZCGPR NE 'N').ZG49R   NON NUMERIC             00184300
                AIF   ('&ZCGPR' LT '2').ZG49Q                           00184400
                AIF   ('&ZCGPR' LE '12').ZG49R                          00184500
.ZG49Q          ANOP  ,                                                 00184600
&ZMS            SETC  '"REQTOKEN='              *KGPRA* MNOTE           00184700
&ZMS            SETC  '&ZMS.&REQTOKEN"'                                 00184800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00184900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00185000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00185100
.ZG49R          ANOP  ,                                                 00185200
.*----------------------------------------------------------------***   00185300
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00185400
                AIF   (N'&EXIT LE 1).ZG53A      CK NUM                  00185500
&ZMS            SETC  '"EXIT='    *KPOSA* MNOTE                         00185600
&ZMS            SETC  '&ZMS.&EXIT"'                                     00185700
&ZMS            SETC  '&ZMS "EXIT"'                                     00185800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00185900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00186000
.ZG53A          ANOP  ,                                                 00186100
.*-------------------------------------------------------------------   00186200
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00186300
&ZXEXIT         SETC  'INPUT'     SET IN/OUTPUT                         00186400
&XEXIT          SETC  'NONE'                                            00186500
                AIF   (K'&EXIT(1) LE 0).ZG53B   PARM                    00186600
&XEXIT          SETC  '&EXIT(1)'  SET XVARIABLE                         00186700
                AIF   (N'&EXIT GT 1).ZG53B      MULTI PARMS             00186800
&XEXIT          SETC  '&EXIT'     SET XVARIABLE                         00186900
.ZG53B          ANOP  ,                                                 00187000
.*-------------------------------------------------------------------   00187100
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00187200
                AIF   (K'&ZXEXIT LE 0).ZG53R    NOT I/O                 00187300
                AIF   ('&XEXIT' EQ 'NONE').ZG53R                        00187400
                AIF   ('&XEXIT'(1,1) NE '(').ZG53R                      00187500
&ZCGPR          SETC  '&XEXIT'(2,K'&XEXIT-2)                            00187600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG53P                      00187700
                AIF   (K'&ZCGPR GT 2).ZG53Q                             00187800
                AIF   ('&ZCGPR' EQ '0').ZG53Q                           00187900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00188000
                AIF   (T'&ZCGPR NE 'N').ZG53Q   INVALID REG NAME        00188100
.ZG53P          ANOP  ,                                                 00188200
                AIF   (T'&ZCGPR NE 'N').ZG53R   NON NUMERIC             00188300
                AIF   ('&ZCGPR' LT '2').ZG53Q                           00188400
                AIF   ('&ZCGPR' LE '12').ZG53R                          00188500
.ZG53Q          ANOP  ,                                                 00188600
&ZMS            SETC  '"EXIT='    *KGPRA* MNOTE                         00188700
&ZMS            SETC  '&ZMS.&EXIT"'                                     00188800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00188900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00189000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00189100
.ZG53R          ANOP  ,                                                 00189200
.*----------------------------------------------------------------***   00189300
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00189400
                AIF   (N'&ECB LE 1).ZG56A       CK NUM                  00189500
&ZMS            SETC  '"ECB='     *KPOSA* MNOTE                         00189600
&ZMS            SETC  '&ZMS.&ECB"'                                      00189700
&ZMS            SETC  '&ZMS "ECB"'                                      00189800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00189900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00190000
.ZG56A          ANOP  ,                                                 00190100
.*-------------------------------------------------------------------   00190200
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00190300
&ZXECB          SETC  'INPUT'     SET IN/OUTPUT                         00190400
&XECB           SETC  'NONE'                                            00190500
                AIF   (K'&ECB(1) LE 0).ZG56B    PARM                    00190600
&XECB           SETC  '&ECB(1)'   SET XVARIABLE                         00190700
                AIF   (N'&ECB GT 1).ZG56B       MULTI PARMS             00190800
&XECB           SETC  '&ECB'      SET XVARIABLE                         00190900
.ZG56B          ANOP  ,                                                 00191000
.*-------------------------------------------------------------------   00191100
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00191200
                AIF   (K'&ZXECB LE 0).ZG56R     NOT I/O                 00191300
                AIF   ('&XECB' EQ 'NONE').ZG56R                         00191400
                AIF   ('&XECB'(1,1) NE '(').ZG56R                       00191500
&ZCGPR          SETC  '&XECB'(2,K'&XECB-2)                              00191600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG56P                      00191700
                AIF   (K'&ZCGPR GT 2).ZG56Q                             00191800
                AIF   ('&ZCGPR' EQ '0').ZG56Q                           00191900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00192000
                AIF   (T'&ZCGPR NE 'N').ZG56Q   INVALID REG NAME        00192100
.ZG56P          ANOP  ,                                                 00192200
                AIF   (T'&ZCGPR NE 'N').ZG56R   NON NUMERIC             00192300
                AIF   ('&ZCGPR' LT '2').ZG56Q                           00192400
                AIF   ('&ZCGPR' LE '12').ZG56R                          00192500
.ZG56Q          ANOP  ,                                                 00192600
&ZMS            SETC  '"ECB='     *KGPRA* MNOTE                         00192700
&ZMS            SETC  '&ZMS.&ECB"'                                      00192800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00192900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00193000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00193100
.ZG56R          ANOP  ,                                                 00193200
.*----------------------------------------------------------------***   00193300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00193400
                AIF   (N'&MSGTOKEN LE 1).ZG59A  CK NUM                  00193500
&ZMS            SETC  '"MSGTOKEN='              *KPOSA* MNOTE           00193600
&ZMS            SETC  '&ZMS.&MSGTOKEN"'                                 00193700
&ZMS            SETC  '&ZMS "MSGTOKEN"'                                 00193800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00193900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00194000
.ZG59A          ANOP  ,                                                 00194100
.*-------------------------------------------------------------------   00194200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00194300
                AIF   (K'&MSGTOKEN(1) LE 0).ZG59C  NO PARM              00194400
&ZXMSGTOKEN     SETC  'OUTPUT'    SET OUTPUT                            00194500
&XMSGTOKEN      SETC  '&MSGTOKEN(1)'            SET XVARIABLE           00194600
                AIF   (N'&MSGTOKEN GT 1).ZG59C                          00194700
&XMSGTOKEN      SETC  '&MSGTOKEN'               SET XVARIABLE           00194800
.ZG59C          ANOP  ,                                                 00194900
.*-------------------------------------------------------------------   00195000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00195100
                AIF   (K'&ZXMSGTOKEN LE 0).ZG59R  NOT I/O               00195200
                AIF   ('&XMSGTOKEN'(1,1) NE '(').ZG59R                  00195300
&ZCGPR          SETC  '&XMSGTOKEN'(2,K'&XMSGTOKEN-2)                    00195400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                      00195500
                AIF   (K'&ZCGPR GT 2).ZG59Q                             00195600
                AIF   ('&ZCGPR' EQ '0').ZG59Q                           00195700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00195800
                AIF   (T'&ZCGPR NE 'N').ZG59Q   INVALID REG NAME        00195900
.ZG59P          ANOP  ,                                                 00196000
                AIF   (T'&ZCGPR NE 'N').ZG59R   NON NUMERIC             00196100
                AIF   ('&ZCGPR' LT '2').ZG59Q                           00196200
                AIF   ('&ZCGPR' LE '12').ZG59R                          00196300
.ZG59Q          ANOP  ,                                                 00196400
&ZMS            SETC  '"MSGTOKEN='              *KGPRA* MNOTE           00196500
&ZMS            SETC  '&ZMS.&MSGTOKEN"'                                 00196600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00196700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00196800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00196900
.ZG59R          ANOP  ,                                                 00197000
.*----------------------------------------------------------------***   00197100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00197200
                AIF   (N'&USERRC LE 1).ZG62A    CK NUM                  00197300
&ZMS            SETC  '"USERRC='  *KPOSA* MNOTE                         00197400
&ZMS            SETC  '&ZMS.&USERRC"'                                   00197500
&ZMS            SETC  '&ZMS "USERRC"'                                   00197600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00197700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00197800
.ZG62A          ANOP  ,                                                 00197900
.*-------------------------------------------------------------------   00198000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00198100
                AIF   (K'&USERRC(1) LE 0).ZG62C  NO PARM                00198200
&ZXUSERRC       SETC  'OUTPUT'    SET OUTPUT                            00198300
&XUSERRC        SETC  '&USERRC(1)'              SET XVARIABLE           00198400
                AIF   (N'&USERRC GT 1).ZG62C                            00198500
&XUSERRC        SETC  '&USERRC'   SET XVARIABLE                         00198600
.ZG62C          ANOP  ,                                                 00198700
.*-------------------------------------------------------------------   00198800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00198900
                AIF   (K'&ZXUSERRC LE 0).ZG62R  NOT I/O                 00199000
                AIF   ('&XUSERRC'(1,1) NE '(').ZG62R                    00199100
&ZCGPR          SETC  '&XUSERRC'(2,K'&XUSERRC-2)                        00199200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG62P                      00199300
                AIF   (K'&ZCGPR GT 2).ZG62Q                             00199400
                AIF   ('&ZCGPR' EQ '0').ZG62Q                           00199500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00199600
                AIF   (T'&ZCGPR NE 'N').ZG62Q   INVALID REG NAME        00199700
.ZG62P          ANOP  ,                                                 00199800
                AIF   (T'&ZCGPR NE 'N').ZG62R   NON NUMERIC             00199900
                AIF   ('&ZCGPR' LT '2').ZG62Q                           00200000
                AIF   ('&ZCGPR' LE '12').ZG62R                          00200100
.ZG62Q          ANOP  ,                                                 00200200
&ZMS            SETC  '"USERRC='  *KGPRA* MNOTE                         00200300
&ZMS            SETC  '&ZMS.&USERRC"'                                   00200400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00200500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00200600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00200700
.ZG62R          ANOP  ,                                                 00200800
.*----------------------------------------------------------------***   00200900
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00201000
                AIF   (N'&MSGATTR LE 1).ZG65A   CK NUM                  00201100
&ZMS            SETC  '"MSGATTR='               *KPOSA* MNOTE           00201200
&ZMS            SETC  '&ZMS.&MSGATTR"'                                  00201300
&ZMS            SETC  '&ZMS "MSGATTR"'                                  00201400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00201500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00201600
.ZG65A          ANOP  ,                                                 00201700
.*-------------------------------------------------------------------   00201800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00201900
&XMSGATTR       SETC  ''          INITIALIZE XVARIABLE                  00202000
.ZG66A   AIF   ('&MSGATTR(1)' NE 'NONE').ZG67A                          00202100
&XMSGATTR       SETC  'NONE'      SET KEYWORD                           00202200
.*-------------------------------------------------------------------   00202300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00202400
.ZG67A   AIF   ('&MSGATTR(1)' NE 'J3CONNECT').ZG68A                     00202500
&XMSGATTR       SETC  'J3CONNECT'               SET KEYWORD             00202600
.*-------------------------------------------------------------------   00202700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00202800
.ZG68A   AIF   ('&MSGATTR(1)' NE 'EXPRESS').ZG69A                       00202900
&XMSGATTR       SETC  'EXPRESS'   SET KEYWORD                           00203000
.*-------------------------------------------------------------------   00203100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00203200
.ZG69A          AIF   (K'&XMSGATTR GT 0).ZG69C  KEYWORD                 00203300
                AIF   (K'&MSGATTR(1) LE 0).ZG69B                        00203400
&ZMS            SETC  '"MSGATTR='               *KUKWA* MNOTE           00203500
&ZMS            SETC  '&ZMS.&MSGATTR"'                                  00203600
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00203700
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00203800
&ZMS            SETC  '&ZMS "NONE",'            VALID KEYWORD           00203900
&ZMS            SETC  '&ZMS "J3CONNECT",'       VALID KEYWORD           00204000
&ZMS            SETC  '&ZMS OR "EXPRESS".'      VALID KEYWORD           00204100
                MNOTE 8,' &ZMS '                                        00204200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00204300
.ZG69B          ANOP  ,                                                 00204400
&XMSGATTR       SETC  'NONE'      SET DEFAULT KEYWORD                   00204500
.ZG69C          ANOP  ,                                                 00204600
&ZXMSGATTR      SETC  'INPUT'     SET IN/OUTPUT                         00204700
.*----------------------------------------------------------------***   00204800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00204900
                AIF   (N'&RTNCODE LE 1).ZG71A   CK NUM                  00205000
&ZMS            SETC  '"RTNCODE='               *KPOSA* MNOTE           00205100
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00205200
&ZMS            SETC  '&ZMS "RTNCODE"'                                  00205300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00205400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00205500
.ZG71A          ANOP  ,                                                 00205600
.*-------------------------------------------------------------------   00205700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00205800
                AIF   (K'&RTNCODE(1) LE 0).ZG71C  NO PARM               00205900
&ZXRTNCODE      SETC  'OUTPUT'    SET OUTPUT                            00206000
&XRTNCODE       SETC  '&RTNCODE(1)'             SET XVARIABLE           00206100
                AIF   (N'&RTNCODE GT 1).ZG71C                           00206200
&XRTNCODE       SETC  '&RTNCODE'  SET XVARIABLE                         00206300
.ZG71C          ANOP  ,                                                 00206400
.*-------------------------------------------------------------------   00206500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00206600
                AIF   (K'&ZXRTNCODE LE 0).ZG71R  NOT I/O                00206700
                AIF   ('&XRTNCODE'(1,1) NE '(').ZG71R                   00206800
&ZCGPR          SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                      00206900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG71P                      00207000
                AIF   (K'&ZCGPR GT 2).ZG71Q                             00207100
                AIF   ('&ZCGPR' EQ '0').ZG71Q                           00207200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00207300
                AIF   (T'&ZCGPR NE 'N').ZG71Q   INVALID REG NAME        00207400
.ZG71P          ANOP  ,                                                 00207500
                AIF   (T'&ZCGPR NE 'N').ZG71R   NON NUMERIC             00207600
                AIF   ('&ZCGPR' LT '2').ZG71Q                           00207700
                AIF   ('&ZCGPR' LE '12').ZG71R                          00207800
.ZG71Q          ANOP  ,                                                 00207900
&ZMS            SETC  '"RTNCODE='               *KGPRA* MNOTE           00208000
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00208100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00208200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00208300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00208400
.ZG71R          ANOP  ,                                                 00208500
.*----------------------------------------------------------------***   00208600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00208700
                AIF   (N'&RSNCODE LE 1).ZG74A   CK NUM                  00208800
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           00208900
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00209000
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00209100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00209200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00209300
.ZG74A          ANOP  ,                                                 00209400
.*-------------------------------------------------------------------   00209500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00209600
                AIF   (K'&RSNCODE(1) LE 0).ZG74C  NO PARM               00209700
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00209800
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00209900
                AIF   (N'&RSNCODE GT 1).ZG74C                           00210000
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00210100
.ZG74C          ANOP  ,                                                 00210200
.*-------------------------------------------------------------------   00210300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00210400
                AIF   (K'&ZXRSNCODE LE 0).ZG74R  NOT I/O                00210500
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG74R                   00210600
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00210700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG74P                      00210800
                AIF   (K'&ZCGPR GT 2).ZG74Q                             00210900
                AIF   ('&ZCGPR' EQ '0').ZG74Q                           00211000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00211100
                AIF   (T'&ZCGPR NE 'N').ZG74Q   INVALID REG NAME        00211200
.ZG74P          ANOP  ,                                                 00211300
                AIF   (T'&ZCGPR NE 'N').ZG74R   NON NUMERIC             00211400
                AIF   ('&ZCGPR' LT '2').ZG74Q                           00211500
                AIF   ('&ZCGPR' LE '12').ZG74R                          00211600
.ZG74Q          ANOP  ,                                                 00211700
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           00211800
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00211900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00212000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00212100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00212200
.ZG74R          ANOP  ,                                                 00212300
.******************************************************************     00212400
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00212500
.******************************************************************     00212600
                ACTR  10000                                             00212700
.*----------------------------------------------------------------***   00212800
.***AH.P02 EXTRA POSITIONALS                                            00212900
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00213000
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00213100
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00213200
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00213300
.ZGLISTX1       ANOP  ,                                                 00213400
&ZCVAL          SETC  ''          ERROR FIELD                           00213500
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00213600
.ZGLIST2        ANOP  ,                                                 00213700
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00213800
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00213900
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00214000
                AGO   .ZGLIST2                                          00214100
.*                                                                      00214200
.ZGLIST3        ANOP  ,                                                 00214300
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00214400
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          00214500
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00214600
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00214700
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00214800
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00214900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00215000
.ZGLISTX        ANOP  ,                                                 00215100
&ZASYSLNDX      SETA  0                                                 00215200
.*-------------------------------------------------------------------   00215300
.***AG.MF04 MF=(SLE)                                                    00215400
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00215500
.*******************************************************************    00215600
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00215700
.*******************************************************************    00215800
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00215900
.*******************************************************************    00216000
.***AE.01  START OF IXZXIXSM MACRO CODE                                 00216100
.*******************************************************************    00216200
                LCLC  &M0M0001                 NAME                     00216300
&M0M0001        SETC  '&XLABEL'                SET NAME                 00216400
                AIF   (K'&XLABEL NE 0).XLAB2                            00216500
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00216600
.*                                                                      00216700
.XLAB2          ANOP  ,                                                 00216800
&M0M0001 DS    0H                             IXZXIXSM-1                00216900
.*******************************************************************    00217000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00217100
.*******************************************************************    00217200
              PUSH  PRINT                                               00217300
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00217400
                PRINT OFF         ++ PR01                               00217500
                AGO   .ZPRNTXX                                          00217600
.ZPRINTX        PRINT ON                                                00217700
.ZPRNTXX        ANOP  ,                                                 00217800
.********************************************************************   00217900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00218000
.********************************************************************   00218100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00218200
                      LCLA  &ZOPN1         INVOCATION INDEX             00218300
                      LCLC  &ZOPL(4095)    LABEL                        00218400
                      LCLC  &ZOPO(4095)    OPERATION                    00218500
                      LCLC  &ZOPV(4095)    VALUE                        00218600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00218700
.*                                                                      00218800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00218900
.******************************************************************     00219000
.***AL.L10 IXZXIXSM FMT=LIST MF=S|L PARAMETERS                          00219100
.******************************************************************     00219200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00219300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00219400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00219500
&XMFATTR              SETC  '0D'                                        00219600
.*                                                                      00219700
&ZOPN                 SETA  &ZOPN+1                                     00219800
&ZOPL(&ZOPN)          SETC  ' '                                         00219900
&ZOPO(&ZOPN)          SETC  'B'                                         00220000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00220100
&ZOPD(&ZOPN)          SETC  '++ IXZXIXSM ARG PARMS'                     00220200
.*                                                                      00220300
&ZOPN                 SETA  &ZOPN+1                                     00220400
&ZOPL(&ZOPN)          SETC  ' '                                         00220500
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00220600
&ZOPV(&ZOPN)          SETC  '1'                                         00220700
&ZOPD(&ZOPN)          SETC  ' '                                         00220800
.*                                                                      00220900
.ZLMFSL2              ANOP  ,                                           00221000
.*-------------------------------------------------------------------   00221100
.***AM.L01  IXZXIXSM FMT=LIST PARAMETERS                                00221200
&ZOPN                 SETA &ZOPN+1                                      00221300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00221400
&ZOPO(&ZOPN)          SETC 'DS'                                         00221500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00221600
&ZOPD(&ZOPN)          SETC '++ IXZXIXSM PARM LIST'                      00221700
.*-------------------------------------------------------------------   00221800
.***AM.L02 XVERSION XL1                                                 00221900
&ZOPN                 SETA &ZOPN+1                                      00222000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00222100
&ZOPO(&ZOPN)          SETC 'DS'                                         00222200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00222300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00222400
.*-------------------------------------------------------------------   00222500
.***AM.L09  XEYECATCH CL6                                               00222600
&ZOPN                 SETA &ZOPN+1                                      00222700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYECATCH'                        00222800
&ZOPO(&ZOPN)          SETC 'DS'                                         00222900
&ZOPV(&ZOPN)          SETC 'CL6'                                        00223000
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XEYECATCH'                     00223100
.*-------------------------------------------------------------------   00223200
.***AM.L03 XMSGATTR BL.8                                                00223300
&ZOPN                 SETA &ZOPN+1                                      00223400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSGATTR'                         00223500
&ZOPO(&ZOPN)          SETC 'DS'                                         00223600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00223700
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00223800
.*                                                                      00223900
&ZOPN                 SETA  &ZOPN+1                                     00224000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSGATTR_J3CONNECT'              00224100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00224200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00224300
&ZOPD(&ZOPN)          SETC  '++ XMSGATTR.'                              00224400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).J3CONNECT'                    00224500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00224600
.*                                                                      00224700
&ZOPN                 SETA  &ZOPN+1                                     00224800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSGATTR_EXPRESS'                00224900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00225000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00225100
&ZOPD(&ZOPN)          SETC  '++ XMSGATTR.'                              00225200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXPRESS'                      00225300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00225400
.*-------------------------------------------------------------------   00225500
.***AM.L09  XMBOXNAME CL16                                              00225600
&ZOPN                 SETA &ZOPN+1                                      00225700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMBOXNAME'                        00225800
&ZOPO(&ZOPN)          SETC 'DS'                                         00225900
&ZOPV(&ZOPN)          SETC 'CL16'                                       00226000
&ZOPD(&ZOPN)          SETC '++ &ZXMBOXNAME  XMBOXNAME'                  00226100
.*-------------------------------------------------------------------   00226200
.***AM.L09  XMEMBER CL16                                                00226300
&ZOPN                 SETA &ZOPN+1                                      00226400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMEMBER'                          00226500
&ZOPO(&ZOPN)          SETC 'DS'                                         00226600
&ZOPV(&ZOPN)          SETC 'CL16'                                       00226700
&ZOPD(&ZOPN)          SETC '++ &ZXMEMBER  XMEMBER'                      00226800
.*-------------------------------------------------------------------   00226900
.***AM.L09  XDATA A                                                     00227000
&ZOPN                 SETA &ZOPN+1                                      00227100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATA'                            00227200
&ZOPO(&ZOPN)          SETC 'DS'                                         00227300
&ZOPV(&ZOPN)          SETC 'A'                                          00227400
&ZOPD(&ZOPN)          SETC '++ &ZXDATA  XDATA'                          00227500
.*-------------------------------------------------------------------   00227600
.***AM.L09  XDATALEN F                                                  00227700
&ZOPN                 SETA &ZOPN+1                                      00227800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATALEN'                         00227900
&ZOPO(&ZOPN)          SETC 'DS'                                         00228000
&ZOPV(&ZOPN)          SETC 'F'                                          00228100
&ZOPD(&ZOPN)          SETC '++ &ZXDATALEN  XDATALEN'                    00228200
.*-------------------------------------------------------------------   00228300
.***AM.L09  XREQTOKEN BL.64                                             00228400
&ZOPN                 SETA &ZOPN+1                                      00228500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQTOKEN'                        00228600
&ZOPO(&ZOPN)          SETC 'DS'                                         00228700
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00228800
&ZOPD(&ZOPN)          SETC '++ &ZXREQTOKEN  XREQTOKEN'                  00228900
.*-------------------------------------------------------------------   00229000
.***AM.L09  XREQMBOX CL16                                               00229100
&ZOPN                 SETA &ZOPN+1                                      00229200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQMBOX'                         00229300
&ZOPO(&ZOPN)          SETC 'DS'                                         00229400
&ZOPV(&ZOPN)          SETC 'CL16'                                       00229500
&ZOPD(&ZOPN)          SETC '++ &ZXREQMBOX  XREQMBOX'                    00229600
.*-------------------------------------------------------------------   00229700
.***AM.L09  XDATAALET F                                                 00229800
&ZOPN                 SETA &ZOPN+1                                      00229900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATAALET'                        00230000
&ZOPO(&ZOPN)          SETC 'DS'                                         00230100
&ZOPV(&ZOPN)          SETC 'F'                                          00230200
&ZOPD(&ZOPN)          SETC '++ &ZXDATAALET  XDATAALET'                  00230300
.*-------------------------------------------------------------------   00230400
.***AM.L09  XRESPDALT F                                                 00230500
&ZOPN                 SETA &ZOPN+1                                      00230600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESPDALT'                        00230700
&ZOPO(&ZOPN)          SETC 'DS'                                         00230800
&ZOPV(&ZOPN)          SETC 'F'                                          00230900
&ZOPD(&ZOPN)          SETC '++ &ZXRESPDALT  XRESPDALT'                  00231000
.*-------------------------------------------------------------------   00231100
.***AM.L09  XECB F                                                      00231200
&ZOPN                 SETA &ZOPN+1                                      00231300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XECB'                             00231400
&ZOPO(&ZOPN)          SETC 'DS'                                         00231500
&ZOPV(&ZOPN)          SETC 'F'                                          00231600
&ZOPD(&ZOPN)          SETC '++ &ZXECB  XECB'                            00231700
.*-------------------------------------------------------------------   00231800
.***AM.L09  XEXIT F                                                     00231900
&ZOPN                 SETA &ZOPN+1                                      00232000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEXIT'                            00232100
&ZOPO(&ZOPN)          SETC 'DS'                                         00232200
&ZOPV(&ZOPN)          SETC 'F'                                          00232300
&ZOPD(&ZOPN)          SETC '++ &ZXEXIT  XEXIT'                          00232400
.*-------------------------------------------------------------------   00232500
.***AM.L09  XCONNECT BL.64                                              00232600
&ZOPN                 SETA &ZOPN+1                                      00232700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNECT'                         00232800
&ZOPO(&ZOPN)          SETC 'DS'                                         00232900
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00233000
&ZOPD(&ZOPN)          SETC '++ &ZXCONNECT  XCONNECT'                    00233100
.*-------------------------------------------------------------------   00233200
.***AM.L09  XGROUPTOKEN F                                               00233300
&ZOPN                 SETA &ZOPN+1                                      00233400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGROUPTOKEN'                      00233500
&ZOPO(&ZOPN)          SETC 'DS'                                         00233600
&ZOPV(&ZOPN)          SETC 'F'                                          00233700
&ZOPD(&ZOPN)          SETC '++ &ZXGROUPTOKEN  XGROUPTOKEN'              00233800
.*-------------------------------------------------------------------   00233900
.***AM.L09  XUSERRC F                                                   00234000
&ZOPN                 SETA &ZOPN+1                                      00234100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERRC'                          00234200
&ZOPO(&ZOPN)          SETC 'DS'                                         00234300
&ZOPV(&ZOPN)          SETC 'F'                                          00234400
&ZOPD(&ZOPN)          SETC '++ &ZXUSERRC  XUSERRC'                      00234500
.*-------------------------------------------------------------------   00234600
.***AM.L09  XRESPDATA F                                                 00234700
&ZOPN                 SETA &ZOPN+1                                      00234800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESPDATA'                        00234900
&ZOPO(&ZOPN)          SETC 'DS'                                         00235000
&ZOPV(&ZOPN)          SETC 'F'                                          00235100
&ZOPD(&ZOPN)          SETC '++ &ZXRESPDATA  XRESPDATA'                  00235200
.*-------------------------------------------------------------------   00235300
.***AM.L09  XRESPDLEN F                                                 00235400
&ZOPN                 SETA &ZOPN+1                                      00235500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESPDLEN'                        00235600
&ZOPO(&ZOPN)          SETC 'DS'                                         00235700
&ZOPV(&ZOPN)          SETC 'F'                                          00235800
&ZOPD(&ZOPN)          SETC '++ &ZXRESPDLEN  XRESPDLEN'                  00235900
.*-------------------------------------------------------------------   00236000
.***AM.L09  XRSV00001 CL4                                               00236100
&ZOPN                 SETA &ZOPN+1                                      00236200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV00001'                        00236300
&ZOPO(&ZOPN)          SETC 'DS'                                         00236400
&ZOPV(&ZOPN)          SETC 'CL4'                                        00236500
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV00001'                     00236600
.*-------------------------------------------------------------------   00236700
.***AM.L09  XMSGTOKEN BL.64                                             00236800
&ZOPN                 SETA &ZOPN+1                                      00236900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSGTOKEN'                        00237000
&ZOPO(&ZOPN)          SETC 'DS'                                         00237100
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00237200
&ZOPD(&ZOPN)          SETC '++ &ZXMSGTOKEN  XMSGTOKEN'                  00237300
.*-------------------------------------------------------------------   00237400
.***AM.L09  XSYNCECB F                                                  00237500
&ZOPN                 SETA &ZOPN+1                                      00237600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYNCECB'                         00237700
&ZOPO(&ZOPN)          SETC 'DS'                                         00237800
&ZOPV(&ZOPN)          SETC 'F'                                          00237900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XSYNCECB'                   00238000
.*-------------------------------------------------------------------   00238100
.***AM.L03 XREQTYPE BL.8                                                00238200
&ZOPN                 SETA &ZOPN+1                                      00238300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQTYPE'                         00238400
&ZOPO(&ZOPN)          SETC 'DS'                                         00238500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00238600
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00238700
.*                                                                      00238800
&ZOPN                 SETA  &ZOPN+1                                     00238900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_ASYNC'                  00239000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00239100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00239200
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00239300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ASYNC'                        00239400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239500
.*                                                                      00239600
&ZOPN                 SETA  &ZOPN+1                                     00239700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_SYNC'                   00239800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00239900
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00240000
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00240100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYNC'                         00240200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00240300
.*                                                                      00240400
&ZOPN                 SETA  &ZOPN+1                                     00240500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_ASYNCACK'               00240600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00240700
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00240800
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00240900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ASYNCACK'                     00241000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00241100
.*                                                                      00241200
&ZOPN                 SETA  &ZOPN+1                                     00241300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_COMM'                   00241400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00241500
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00241600
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00241700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMM'                         00241800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00241900
.*-------------------------------------------------------------------   00242000
.***AM.L03 XSEGTYPE BL.8                                                00242100
&ZOPN                 SETA &ZOPN+1                                      00242200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSEGTYPE'                         00242300
&ZOPO(&ZOPN)          SETC 'DS'                                         00242400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00242500
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00242600
.*                                                                      00242700
&ZOPN                 SETA  &ZOPN+1                                     00242800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSEGTYPE_SINGLE'                 00242900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00243000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00243100
&ZOPD(&ZOPN)          SETC  '++ XSEGTYPE.'                              00243200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SINGLE'                       00243300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00243400
.*                                                                      00243500
&ZOPN                 SETA  &ZOPN+1                                     00243600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSEGTYPE_FIRST'                  00243700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00243800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00243900
&ZOPD(&ZOPN)          SETC  '++ XSEGTYPE.'                              00244000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).FIRST'                        00244100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00244200
.*                                                                      00244300
&ZOPN                 SETA  &ZOPN+1                                     00244400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSEGTYPE_MIDDLE'                 00244500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00244600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00244700
&ZOPD(&ZOPN)          SETC  '++ XSEGTYPE.'                              00244800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MIDDLE'                       00244900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00245000
.*                                                                      00245100
&ZOPN                 SETA  &ZOPN+1                                     00245200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSEGTYPE_LAST'                   00245300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00245400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00245500
&ZOPD(&ZOPN)          SETC  '++ XSEGTYPE.'                              00245600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LAST'                         00245700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00245800
.*                                                                      00245900
&ZOPN                 SETA  &ZOPN+1                                     00246000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSEGTYPE_ABORT'                  00246100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00246200
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00246300
&ZOPD(&ZOPN)          SETC  '++ XSEGTYPE.'                              00246400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ABORT'                        00246500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00246600
.*-------------------------------------------------------------------   00246700
.***AM.L03 XKEYS BL.8                                                   00246800
&ZOPN                 SETA &ZOPN+1                                      00246900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYS'                            00247000
&ZOPO(&ZOPN)          SETC 'DS'                                         00247100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00247200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00247300
.*                                                                      00247400
&ZOPN                 SETA  &ZOPN+1                                     00247500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_REQTYPE'                 00247600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00247700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00247800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00247900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REQTYPE'                      00248000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00248100
.*                                                                      00248200
&ZOPN                 SETA  &ZOPN+1                                     00248300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_REQTOKEN'                00248400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00248500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00248600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00248700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REQTOKEN'                     00248800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00248900
.*                                                                      00249000
&ZOPN                 SETA  &ZOPN+1                                     00249100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_REQMBOX'                 00249200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00249300
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00249400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00249500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REQMBOX'                      00249600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00249700
.*                                                                      00249800
&ZOPN                 SETA  &ZOPN+1                                     00249900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_EXIT'                    00250000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00250100
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00250200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00250300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXIT'                         00250400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00250500
.*                                                                      00250600
&ZOPN                 SETA  &ZOPN+1                                     00250700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SEGTYPE'                 00250800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00250900
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00251000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00251100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SEGTYPE'                      00251200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00251300
.*                                                                      00251400
&ZOPN                 SETA  &ZOPN+1                                     00251500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CONNECT'                 00251600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00251700
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00251800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00251900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CONNECT'                      00252000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00252100
.*                                                                      00252200
&ZOPN                 SETA  &ZOPN+1                                     00252300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MSGTOKEN'                00252400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00252500
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00252600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00252700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MSGTOKEN'                     00252800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00252900
.*                                                                      00253000
&ZOPN                 SETA  &ZOPN+1                                     00253100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MSGATTR'                 00253200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00253300
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00253400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00253500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MSGATTR'                      00253600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00253700
.*-------------------------------------------------------------------   00253800
.***AM.L03 XKEYS1 BL.8                                                  00253900
&ZOPN                 SETA &ZOPN+1                                      00254000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYS1'                           00254100
&ZOPO(&ZOPN)          SETC 'DS'                                         00254200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00254300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00254400
.*                                                                      00254500
&ZOPN                 SETA  &ZOPN+1                                     00254600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ECB'                     00254700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00254800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00254900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00255000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ECB'                          00255100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00255200
.*                                                                      00255300
&ZOPN                 SETA  &ZOPN+1                                     00255400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DATAALET'                00255500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00255600
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00255700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00255800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DATAALET'                     00255900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00256000
.*-------------------------------------------------------------------   00256100
.***AM.L10 END OF IXZXIXSM LIST PARAMETERS                              00256200
&ZOPN                 SETA &ZOPN+1                                      00256300
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00256400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00256500
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00256600
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00256700
.*                                                                      00256800
&ZOPN                 SETA &ZOPN+1                                      00256900
&ZOPL(&ZOPN)          SETC ' '                                          00257000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00257100
&ZOPV(&ZOPN)          SETC '1'                                          00257200
&ZOPD(&ZOPN)          SETC ' '                                          00257300
.*-------------------------------------------------------------------   00257400
.***AL.L12 IXZXIXSM FMT=LIST MF=S|L PARAMETERS                          00257500
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00257600
.*                                                                      00257700
&ZOPN                 SETA  &ZOPN+1                                     00257800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00257900
&ZOPO(&ZOPN)          SETC  'DC'                                        00258000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00258100
&ZOPD(&ZOPN)          SETC  '++ IXZXIXSM ARG PARMS'                     00258200
.*                                                                      00258300
.ZLMFSLX              ANOP  ,                                           00258400
.*-------------------------------------------------------------------   00258500
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00258600
&ZPLLEN               SETA 132                                          00258700
.*                                                                      00258800
.******************************************************************     00258900
.***AI.L01 IXZXIXSM FMT=LIST FILL IN PARAMETER AREA                     00259000
.******************************************************************     00259100
                      ACTR  10000                                       00259200
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00259300
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00259400
&ZCVAL                SETC  'LAE'          XAX MODE                     00259500
.ZIMFXA               ANOP ,                                            00259600
.*                                                                      00259700
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00259800
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00259900
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00260000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00260100
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00260200
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00260300
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00260400
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00260500
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00260600
&ZOPN                 SETA  &ZOPN+1                                     00260700
&ZOPL(&ZOPN)          SETC  ' '                                         00260800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00260900
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00261000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00261100
                      AGO   .ZIMFNX                                     00261200
.*                                                                      00261300
.ZIMFN2               ANOP ,                                            00261400
&ZOPN                 SETA  &ZOPN+1                                     00261500
&ZOPL(&ZOPN)          SETC  ' '                                         00261600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00261700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00261800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00261900
.ZIMFNX               ANOP ,                                            00262000
.********************************************************************   00262100
.***AI.L02 IXZXIXSM FMT=LIST INITIALIZE PARAMETER AREA                  00262200
.********************************************************************   00262300
.***AI.L03 MF=(SLE)                                                     00262400
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00262500
.*                                                                      00262600
&ZOPN                 SETA  &ZOPN+1                                     00262700
&ZOPL(&ZOPN)          SETC  ' '                                         00262800
&ZOPO(&ZOPN)          SETC  'XC'                                        00262900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00263000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00263100
.ZIMFLX               ANOP  ,                                           00263200
.*-------------------------------------------------------------------   00263300
.***AI.L04B XVERSION XL1                                                00263400
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00263500
&ZOPN                 SETA  &ZOPN+1                                     00263600
&ZOPL(&ZOPN)          SETC  ' '                                         00263700
&ZOPO(&ZOPN)          SETC  'MVI'                                       00263800
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00263900
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00264000
.ZIMFVX               ANOP  ,                                           00264100
.*-------------------------------------------------------------------   00264200
.***AI.L60 XEYECATCH CL6                                                00264300
&ZOPN                 SETA  &ZOPN+1                                     00264400
&ZOPL(&ZOPN)          SETC  ' '                                         00264500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00264600
&ZOPV(&ZOPN)          SETC  '1(6,1),=CL6''YIXSM '''                     00264700
&ZOPD(&ZOPN)          SETC  '++ CL6 CONSTANT'                           00264800
.*-------------------------------------------------------------------   00264900
.***AI.L05 XMSGATTR BL1                                                 00265000
&ZW                   SETC  ''                                          00265100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00265200
.*-------------------------------------------------------------------   00265300
.***AI.L08 XMSGATTR "J3CONNECT"                                         00265400
.***      BL1'1XXXXXXX'                                                 00265500
         AIF   ('&XMSGATTR' NE 'J3CONNECT').ZI4A                        00265600
&ZW                   SETC  '&ZW.1'                                     00265700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00265800
                      AGO   .ZI4C                                       00265900
.*                                                                      00266000
.ZI4A                 ANOP  ,                                           00266100
&ZW                   SETC  '&ZW.0'                                     00266200
.ZI4C                 ANOP  ,                                           00266300
.*-------------------------------------------------------------------   00266400
.***AI.L08 XMSGATTR "EXPRESS"                                           00266500
.***      BL1'X1XXXXXX'                                                 00266600
         AIF   ('&XMSGATTR' NE 'EXPRESS').ZI5A                          00266700
&ZW                   SETC  '&ZW.1000000'                               00266800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00266900
                      AGO   .ZI5C                                       00267000
.*                                                                      00267100
.ZI5A                 ANOP  ,                                           00267200
&ZW                   SETC  '&ZW.0000000'                               00267300
.ZI5C                 ANOP  ,                                           00267400
.*-------------------------------------------------------------------   00267500
.***AI.L11 XMSGATTR BL1                                                 00267600
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00267700
&ZOPN                 SETA  &ZOPN+1                                     00267800
&ZOPL(&ZOPN)          SETC  ' '                                         00267900
&ZOPO(&ZOPN)          SETC  'OI'                                        00268000
&ZOPV(&ZOPN)          SETC  '7(1),B''&ZW'''                             00268100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00268200
.ZI5E                 ANOP  ,                                           00268300
.*-------------------------------------------------------------------   00268400
.***AI.L25  XMBOXNAME CL16                                              00268500
                      AIF   ('&ZXMBOXNAME' EQ '').ZI6E                  00268600
                      AIF   ('&ZXMBOXNAME' EQ 'OUTPUT').ZI6E            00268700
&ZCGPR                SETC  '&XMBOXNAME'                                00268800
.*                                                                      00268900
                      AIF   ('&XMBOXNAME'(1,1) NE '(').ZI6B             00269000
&ZCGPR   SETC  '0('.'&XMBOXNAME'(2,K'&XMBOXNAME-2).')'                  00269100
.ZI6B                 ANOP  ,                                           00269200
.*                                                                      00269300
&ZOPN                 SETA  &ZOPN+1                                     00269400
&ZOPL(&ZOPN)          SETC  ' '                                         00269500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00269600
&ZOPV(&ZOPN)          SETC  '8(16,1),&ZCGPR'                            00269700
&ZOPD(&ZOPN)          SETC  '++ &ZXMBOXNAME XMBOXNAME'                  00269800
.*                                                                      00269900
.ZI6E                 ANOP  ,                                           00270000
.*-------------------------------------------------------------------   00270100
.***AI.L25  XMEMBER CL16                                                00270200
                      AIF   ('&ZXMEMBER' EQ '').ZI7E                    00270300
                      AIF   ('&ZXMEMBER' EQ 'OUTPUT').ZI7E              00270400
&ZCGPR                SETC  '&XMEMBER'                                  00270500
.*                                                                      00270600
                      AIF   ('&XMEMBER'(1,1) NE '(').ZI7B               00270700
&ZCGPR   SETC  '0('.'&XMEMBER'(2,K'&XMEMBER-2).')'                      00270800
.ZI7B                 ANOP  ,                                           00270900
.*                                                                      00271000
&ZOPN                 SETA  &ZOPN+1                                     00271100
&ZOPL(&ZOPN)          SETC  ' '                                         00271200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00271300
&ZOPV(&ZOPN)          SETC  '24(16,1),&ZCGPR'                           00271400
&ZOPD(&ZOPN)          SETC  '++ &ZXMEMBER XMEMBER'                      00271500
.*                                                                      00271600
.ZI7E                 ANOP  ,                                           00271700
.*-------------------------------------------------------------------   00271800
.***AI.L25  XDATA AL4                                                   00271900
                      AIF   ('&ZXDATA' EQ '').ZI8E                      00272000
                      AIF   ('&ZXDATA' EQ 'OUTPUT').ZI8E                00272100
&ZCGPR                SETC  '&XDATA'                                    00272200
.*                                                                      00272300
                      AIF   ('&XDATA'(1,1) NE '(').ZI8B                 00272400
&ZCGPR   SETC  '0('.'&XDATA'(2,K'&XDATA-2).')'                          00272500
                      AGO   .ZI8D                                       00272600
.ZI8B                 ANOP  ,                                           00272700
.*                                                                      00272800
&ZC                   SETC  '&XDATA'(1,1)                               00272900
                      AIF   (T'&ZC NE 'N').ZI8D                         00273000
&ZC                   SETC  '&XDATA'                                    00273100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00273200
&ZCGPR                SETC  '=AL4(&XDATA)'                              00273300
.*                                                                      00273400
.ZI8D                 ANOP  ,                                           00273500
.*                                                                      00273600
&ZOPN                 SETA  &ZOPN+1                                     00273700
&ZOPL(&ZOPN)          SETC  ' '                                         00273800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00273900
&ZOPV(&ZOPN)          SETC  '40(4,1),&ZCGPR'                            00274000
&ZOPD(&ZOPN)          SETC  '++ &ZXDATA XDATA'                          00274100
.*                                                                      00274200
.ZI8E                 ANOP  ,                                           00274300
.*-------------------------------------------------------------------   00274400
.***AI.L25  XDATALEN F                                                  00274500
                      AIF   ('&ZXDATALEN' EQ '').ZI9E                   00274600
                      AIF   ('&ZXDATALEN' EQ 'OUTPUT').ZI9E             00274700
&ZCGPR                SETC  '&XDATALEN'                                 00274800
.*                                                                      00274900
                      AIF   ('&XDATALEN'(1,1) NE '(').ZI9B              00275000
&ZCGPR   SETC  '0('.'&XDATALEN'(2,K'&XDATALEN-2).')'                    00275100
                      AGO   .ZI9D                                       00275200
.ZI9B                 ANOP  ,                                           00275300
.*                                                                      00275400
&ZC                   SETC  '&XDATALEN'(1,1)                            00275500
                      AIF   (T'&ZC NE 'N').ZI9D                         00275600
&ZC                   SETC  '&XDATALEN'                                 00275700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00275800
&ZCGPR                SETC  '=FL4''&XDATALEN'''                         00275900
.*                                                                      00276000
.ZI9D                 ANOP  ,                                           00276100
.*                                                                      00276200
&ZOPN                 SETA  &ZOPN+1                                     00276300
&ZOPL(&ZOPN)          SETC  ' '                                         00276400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00276500
&ZOPV(&ZOPN)          SETC  '44(4,1),&ZCGPR'                            00276600
&ZOPD(&ZOPN)          SETC  '++ &ZXDATALEN XDATALEN'                    00276700
.*                                                                      00276800
.ZI9E                 ANOP  ,                                           00276900
.*-------------------------------------------------------------------   00277000
.***AI.L25  XREQMBOX CL16                                               00277100
                      AIF   ('&ZXREQMBOX' EQ '').ZI11E                  00277200
                      AIF   ('&ZXREQMBOX' EQ 'OUTPUT').ZI11E            00277300
&ZCGPR                SETC  '&XREQMBOX'                                 00277400
.*                                                                      00277500
                      AIF   ('&XREQMBOX'(1,1) NE '(').ZI11B             00277600
&ZCGPR   SETC  '0('.'&XREQMBOX'(2,K'&XREQMBOX-2).')'                    00277700
                      AGO   .ZI11D                                      00277800
.ZI11B                ANOP  ,                                           00277900
.*                                                                      00278000
                      AIF   ('&REQMBOX(1)' EQ '').ZI11I  OMITTED        00278100
&ZC                   SETC  '!NONE!'                                    00278200
                      AIF   ('&XREQMBOX' NE '&ZC').ZI11C                00278300
.ZI11I                ANOP  ,                                           00278400
&ZCGPR                SETC  '=CL16''&XREQMBOX'''                        00278500
.ZI11C                ANOP  ,                                           00278600
.*                                                                      00278700
.ZI11D                ANOP  ,                                           00278800
.*                                                                      00278900
&ZOPN                 SETA  &ZOPN+1                                     00279000
&ZOPL(&ZOPN)          SETC  ' '                                         00279100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00279200
&ZOPV(&ZOPN)          SETC  '56(16,1),&ZCGPR'                           00279300
&ZOPD(&ZOPN)          SETC  '++ &ZXREQMBOX XREQMBOX'                    00279400
.*                                                                      00279500
.ZI11E                ANOP  ,                                           00279600
.*-------------------------------------------------------------------   00279700
.***AI.L25  XDATAALET F                                                 00279800
                      AIF   ('&ZXDATAALET' EQ '').ZI12E                 00279900
                      AIF   ('&ZXDATAALET' EQ 'OUTPUT').ZI12E           00280000
&ZCGPR                SETC  '&XDATAALET'                                00280100
         AIF   ('&XDATAALET' EQ '0').ZI12E                              00280200
.*                                                                      00280300
                      AIF   ('&XDATAALET'(1,1) NE '(').ZI12B            00280400
&ZCGPR   SETC  '0('.'&XDATAALET'(2,K'&XDATAALET-2).')'                  00280500
                      AGO   .ZI12D                                      00280600
.ZI12B                ANOP  ,                                           00280700
.*                                                                      00280800
&ZC                   SETC  '&XDATAALET'(1,1)                           00280900
                      AIF   (T'&ZC NE 'N').ZI12D                        00281000
&ZC                   SETC  '&XDATAALET'                                00281100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00281200
&ZCGPR                SETC  '=FL4''&XDATAALET'''                        00281300
.*                                                                      00281400
.ZI12D                ANOP  ,                                           00281500
.*                                                                      00281600
&ZOPN                 SETA  &ZOPN+1                                     00281700
&ZOPL(&ZOPN)          SETC  ' '                                         00281800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00281900
&ZOPV(&ZOPN)          SETC  '72(4,1),&ZCGPR'                            00282000
&ZOPD(&ZOPN)          SETC  '++ &ZXDATAALET XDATAALET'                  00282100
.*                                                                      00282200
.ZI12E                ANOP  ,                                           00282300
.*-------------------------------------------------------------------   00282400
.***AI.L25  XRESPDALT F                                                 00282500
                      AIF   ('&ZXRESPDALT' EQ '').ZI13E                 00282600
                      AIF   ('&ZXRESPDALT' EQ 'OUTPUT').ZI13E           00282700
&ZCGPR                SETC  '&XRESPDALT'                                00282800
         AIF   ('&XRESPDALT' EQ '0').ZI13E                              00282900
.*                                                                      00283000
                      AIF   ('&XRESPDALT'(1,1) NE '(').ZI13B            00283100
&ZCGPR   SETC  '0('.'&XRESPDALT'(2,K'&XRESPDALT-2).')'                  00283200
                      AGO   .ZI13D                                      00283300
.ZI13B                ANOP  ,                                           00283400
.*                                                                      00283500
&ZC                   SETC  '&XRESPDALT'(1,1)                           00283600
                      AIF   (T'&ZC NE 'N').ZI13D                        00283700
&ZC                   SETC  '&XRESPDALT'                                00283800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00283900
&ZCGPR                SETC  '=FL4''&XRESPDALT'''                        00284000
.*                                                                      00284100
.ZI13D                ANOP  ,                                           00284200
.*                                                                      00284300
&ZOPN                 SETA  &ZOPN+1                                     00284400
&ZOPL(&ZOPN)          SETC  ' '                                         00284500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00284600
&ZOPV(&ZOPN)          SETC  '76(4,1),&ZCGPR'                            00284700
&ZOPD(&ZOPN)          SETC  '++ &ZXRESPDALT XRESPDALT'                  00284800
.*                                                                      00284900
.ZI13E                ANOP  ,                                           00285000
.*-------------------------------------------------------------------   00285100
.***AI.L18  XECB F                                                      00285200
         AIF   ('&XECB' NE 'NONE').ZI14                                 00285300
&ZXECB                SETC  ''             RESET INPUT/OUTPUT           00285400
.ZI14                 ANOP  ,                                           00285500
.*-------------------------------------------------------------------   00285600
.***AI.L25  XECB F                                                      00285700
                      AIF   ('&ZXECB' EQ '').ZI14E                      00285800
                      AIF   ('&ZXECB' EQ 'OUTPUT').ZI14E                00285900
&ZCGPR                SETC  '&XECB'                                     00286000
.*                                                                      00286100
                      AIF   ('&XECB'(1,1) NE '(').ZI14B                 00286200
&ZCGPR   SETC  '0('.'&XECB'(2,K'&XECB-2).')'                            00286300
                      AGO   .ZI14D                                      00286400
.ZI14B                ANOP  ,                                           00286500
.*                                                                      00286600
&ZC                   SETC  '&XECB'(1,1)                                00286700
                      AIF   (T'&ZC NE 'N').ZI14D                        00286800
&ZC                   SETC  '&XECB'                                     00286900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI14D               00287000
&ZCGPR                SETC  '=FL4''&XECB'''                             00287100
.*                                                                      00287200
.ZI14D                ANOP  ,                                           00287300
.*                                                                      00287400
&ZOPN                 SETA  &ZOPN+1                                     00287500
&ZOPL(&ZOPN)          SETC  ' '                                         00287600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00287700
&ZOPV(&ZOPN)          SETC  '80(4,1),&ZCGPR'                            00287800
&ZOPD(&ZOPN)          SETC  '++ &ZXECB XECB'                            00287900
.*                                                                      00288000
.ZI14E                ANOP  ,                                           00288100
.*-------------------------------------------------------------------   00288200
.***AI.L18  XEXIT F                                                     00288300
         AIF   ('&XEXIT' NE 'NONE').ZI15                                00288400
&ZXEXIT               SETC  ''             RESET INPUT/OUTPUT           00288500
.ZI15                 ANOP  ,                                           00288600
.*-------------------------------------------------------------------   00288700
.***AI.L25  XEXIT F                                                     00288800
                      AIF   ('&ZXEXIT' EQ '').ZI15E                     00288900
                      AIF   ('&ZXEXIT' EQ 'OUTPUT').ZI15E               00289000
&ZCGPR                SETC  '&XEXIT'                                    00289100
.*                                                                      00289200
                      AIF   ('&XEXIT'(1,1) NE '(').ZI15B                00289300
&ZCGPR   SETC  '0('.'&XEXIT'(2,K'&XEXIT-2).')'                          00289400
                      AGO   .ZI15D                                      00289500
.ZI15B                ANOP  ,                                           00289600
.*                                                                      00289700
&ZC                   SETC  '&XEXIT'(1,1)                               00289800
                      AIF   (T'&ZC NE 'N').ZI15D                        00289900
&ZC                   SETC  '&XEXIT'                                    00290000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               00290100
&ZCGPR                SETC  '=FL4''&XEXIT'''                            00290200
.*                                                                      00290300
.ZI15D                ANOP  ,                                           00290400
.*                                                                      00290500
&ZOPN                 SETA  &ZOPN+1                                     00290600
&ZOPL(&ZOPN)          SETC  ' '                                         00290700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00290800
&ZOPV(&ZOPN)          SETC  '84(4,1),&ZCGPR'                            00290900
&ZOPD(&ZOPN)          SETC  '++ &ZXEXIT XEXIT'                          00291000
.*                                                                      00291100
.ZI15E                ANOP  ,                                           00291200
.*-------------------------------------------------------------------   00291300
.***AI.L25  XCONNECT XL8                                                00291400
                      AIF   ('&ZXCONNECT' EQ '').ZI16E                  00291500
                      AIF   ('&ZXCONNECT' EQ 'OUTPUT').ZI16E            00291600
&ZCGPR                SETC  '&XCONNECT'                                 00291700
         AIF   ('&XCONNECT' EQ '0').ZI16E                               00291800
.*                                                                      00291900
                      AIF   ('&XCONNECT'(1,1) NE '(').ZI16B             00292000
&ZCGPR   SETC  '0('.'&XCONNECT'(2,K'&XCONNECT-2).')'                    00292100
                      AGO   .ZI16D                                      00292200
.ZI16B                ANOP  ,                                           00292300
.*                                                                      00292400
&ZC                   SETC  '&XCONNECT'(1,1)                            00292500
                      AIF   (T'&ZC NE 'N').ZI16D                        00292600
&ZC                   SETC  '&XCONNECT'                                 00292700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               00292800
&ZCGPR                SETC  '=BL8''&XCONNECT'''                         00292900
.*                                                                      00293000
.ZI16D                ANOP  ,                                           00293100
.*                                                                      00293200
&ZOPN                 SETA  &ZOPN+1                                     00293300
&ZOPL(&ZOPN)          SETC  ' '                                         00293400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00293500
&ZOPV(&ZOPN)          SETC  '88(8,1),&ZCGPR'                            00293600
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNECT XCONNECT'                    00293700
.*                                                                      00293800
.ZI16E                ANOP  ,                                           00293900
.*-------------------------------------------------------------------   00294000
.***AI.L25  XGROUPTOKEN F                                               00294100
                      AIF   ('&ZXGROUPTOKEN' EQ '').ZI17E               00294200
                      AIF   ('&ZXGROUPTOKEN' EQ 'OUTPUT').ZI17E         00294300
&ZCGPR                SETC  '&XGROUPTOKEN'                              00294400
.*                                                                      00294500
                      AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZI17B          00294600
&ZCGPR   SETC  '0('.'&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2).')'              00294700
                      AGO   .ZI17D                                      00294800
.ZI17B                ANOP  ,                                           00294900
.*                                                                      00295000
&ZC                   SETC  '&XGROUPTOKEN'(1,1)                         00295100
                      AIF   (T'&ZC NE 'N').ZI17D                        00295200
&ZC                   SETC  '&XGROUPTOKEN'                              00295300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI17D               00295400
&ZCGPR                SETC  '=FL4''&XGROUPTOKEN'''                      00295500
.*                                                                      00295600
.ZI17D                ANOP  ,                                           00295700
.*                                                                      00295800
&ZOPN                 SETA  &ZOPN+1                                     00295900
&ZOPL(&ZOPN)          SETC  ' '                                         00296000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00296100
&ZOPV(&ZOPN)          SETC  '96(4,1),&ZCGPR'                            00296200
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPTOKEN XGROUPTOKEN'              00296300
.*                                                                      00296400
.ZI17E                ANOP  ,                                           00296500
.*-------------------------------------------------------------------   00296600
.***AI.L25  XRESPDATA F                                                 00296700
                      AIF   ('&ZXRESPDATA' EQ '').ZI19E                 00296800
                      AIF   ('&ZXRESPDATA' EQ 'OUTPUT').ZI19E           00296900
&ZCGPR                SETC  '&XRESPDATA'                                00297000
         AIF   ('&XRESPDATA' EQ '0').ZI19E                              00297100
.*                                                                      00297200
                      AIF   ('&XRESPDATA'(1,1) NE '(').ZI19B            00297300
&ZCGPR   SETC  '0('.'&XRESPDATA'(2,K'&XRESPDATA-2).')'                  00297400
                      AGO   .ZI19D                                      00297500
.ZI19B                ANOP  ,                                           00297600
.*                                                                      00297700
&ZC                   SETC  '&XRESPDATA'(1,1)                           00297800
                      AIF   (T'&ZC NE 'N').ZI19D                        00297900
&ZC                   SETC  '&XRESPDATA'                                00298000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00298100
&ZCGPR                SETC  '=FL4''&XRESPDATA'''                        00298200
.*                                                                      00298300
.ZI19D                ANOP  ,                                           00298400
.*                                                                      00298500
&ZOPN                 SETA  &ZOPN+1                                     00298600
&ZOPL(&ZOPN)          SETC  ' '                                         00298700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00298800
&ZOPV(&ZOPN)          SETC  '104(4,1),&ZCGPR'                           00298900
&ZOPD(&ZOPN)          SETC  '++ &ZXRESPDATA XRESPDATA'                  00299000
.*                                                                      00299100
.ZI19E                ANOP  ,                                           00299200
.*-------------------------------------------------------------------   00299300
.***AI.L25  XRESPDLEN F                                                 00299400
                      AIF   ('&ZXRESPDLEN' EQ '').ZI20E                 00299500
                      AIF   ('&ZXRESPDLEN' EQ 'OUTPUT').ZI20E           00299600
&ZCGPR                SETC  '&XRESPDLEN'                                00299700
         AIF   ('&XRESPDLEN' EQ '0').ZI20E                              00299800
.*                                                                      00299900
                      AIF   ('&XRESPDLEN'(1,1) NE '(').ZI20B            00300000
&ZCGPR   SETC  '0('.'&XRESPDLEN'(2,K'&XRESPDLEN-2).')'                  00300100
                      AGO   .ZI20D                                      00300200
.ZI20B                ANOP  ,                                           00300300
.*                                                                      00300400
&ZC                   SETC  '&XRESPDLEN'(1,1)                           00300500
                      AIF   (T'&ZC NE 'N').ZI20D                        00300600
&ZC                   SETC  '&XRESPDLEN'                                00300700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI20D               00300800
&ZCGPR                SETC  '=FL4''&XRESPDLEN'''                        00300900
.*                                                                      00301000
.ZI20D                ANOP  ,                                           00301100
.*                                                                      00301200
&ZOPN                 SETA  &ZOPN+1                                     00301300
&ZOPL(&ZOPN)          SETC  ' '                                         00301400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00301500
&ZOPV(&ZOPN)          SETC  '108(4,1),&ZCGPR'                           00301600
&ZOPD(&ZOPN)          SETC  '++ &ZXRESPDLEN XRESPDLEN'                  00301700
.*                                                                      00301800
.ZI20E                ANOP  ,                                           00301900
.*-------------------------------------------------------------------   00302000
.***AI.L05 XREQTYPE BL1                                                 00302100
&ZW                   SETC  ''                                          00302200
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00302300
.*-------------------------------------------------------------------   00302400
.***AI.L08 XREQTYPE "ASYNC"                                             00302500
.***      BL1'1XXXXXXX'                                                 00302600
         AIF   ('&XREQTYPE' NE 'ASYNC').ZI25A                           00302700
&ZW                   SETC  '&ZW.1'                                     00302800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00302900
                      AGO   .ZI25C                                      00303000
.*                                                                      00303100
.ZI25A                ANOP  ,                                           00303200
&ZW                   SETC  '&ZW.0'                                     00303300
.ZI25C                ANOP  ,                                           00303400
.*-------------------------------------------------------------------   00303500
.***AI.L08 XREQTYPE "SYNC"                                              00303600
.***      BL1'X1XXXXXX'                                                 00303700
         AIF   ('&XREQTYPE' NE 'SYNC').ZI26A                            00303800
&ZW                   SETC  '&ZW.1'                                     00303900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00304000
                      AGO   .ZI26C                                      00304100
.*                                                                      00304200
.ZI26A                ANOP  ,                                           00304300
&ZW                   SETC  '&ZW.0'                                     00304400
.ZI26C                ANOP  ,                                           00304500
.*-------------------------------------------------------------------   00304600
.***AI.L08 XREQTYPE "ASYNCACK"                                          00304700
.***      BL1'XX1XXXXX'                                                 00304800
         AIF   ('&XREQTYPE' NE 'ASYNCACK').ZI27A                        00304900
&ZW                   SETC  '&ZW.1'                                     00305000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00305100
                      AGO   .ZI27C                                      00305200
.*                                                                      00305300
.ZI27A                ANOP  ,                                           00305400
&ZW                   SETC  '&ZW.0'                                     00305500
.ZI27C                ANOP  ,                                           00305600
.*-------------------------------------------------------------------   00305700
.***AI.L08 XREQTYPE "COMM"                                              00305800
.***      BL1'XXX1XXXX'                                                 00305900
         AIF   ('&XREQTYPE' NE 'COMM').ZI28A                            00306000
&ZW                   SETC  '&ZW.10000'                                 00306100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00306200
                      AGO   .ZI28C                                      00306300
.*                                                                      00306400
.ZI28A                ANOP  ,                                           00306500
&ZW                   SETC  '&ZW.00000'                                 00306600
.ZI28C                ANOP  ,                                           00306700
.*-------------------------------------------------------------------   00306800
.***AI.L11 XREQTYPE BL1                                                 00306900
                      AIF   ('&ZCLNG' NE 'YES').ZI28E  ALL ZERO BITS    00307000
&ZOPN                 SETA  &ZOPN+1                                     00307100
&ZOPL(&ZOPN)          SETC  ' '                                         00307200
&ZOPO(&ZOPN)          SETC  'OI'                                        00307300
&ZOPV(&ZOPN)          SETC  '128(1),B''&ZW'''                           00307400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00307500
.ZI28E                ANOP  ,                                           00307600
.*-------------------------------------------------------------------   00307700
.***AI.L05 XSEGTYPE BL1                                                 00307800
&ZW                   SETC  ''                                          00307900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00308000
.*-------------------------------------------------------------------   00308100
.***AI.L08 XSEGTYPE "SINGLE"                                            00308200
.***      BL1'1XXXXXXX'                                                 00308300
         AIF   ('&XSEGTYPE' NE 'SINGLE').ZI30A                          00308400
&ZW                   SETC  '&ZW.1'                                     00308500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00308600
                      AGO   .ZI30C                                      00308700
.*                                                                      00308800
.ZI30A                ANOP  ,                                           00308900
&ZW                   SETC  '&ZW.0'                                     00309000
.ZI30C                ANOP  ,                                           00309100
.*-------------------------------------------------------------------   00309200
.***AI.L08 XSEGTYPE "FIRST"                                             00309300
.***      BL1'X1XXXXXX'                                                 00309400
         AIF   ('&XSEGTYPE' NE 'FIRST').ZI31A                           00309500
&ZW                   SETC  '&ZW.1'                                     00309600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00309700
                      AGO   .ZI31C                                      00309800
.*                                                                      00309900
.ZI31A                ANOP  ,                                           00310000
&ZW                   SETC  '&ZW.0'                                     00310100
.ZI31C                ANOP  ,                                           00310200
.*-------------------------------------------------------------------   00310300
.***AI.L08 XSEGTYPE "MIDDLE"                                            00310400
.***      BL1'XX1XXXXX'                                                 00310500
         AIF   ('&XSEGTYPE' NE 'MIDDLE').ZI32A                          00310600
&ZW                   SETC  '&ZW.1'                                     00310700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00310800
                      AGO   .ZI32C                                      00310900
.*                                                                      00311000
.ZI32A                ANOP  ,                                           00311100
&ZW                   SETC  '&ZW.0'                                     00311200
.ZI32C                ANOP  ,                                           00311300
.*-------------------------------------------------------------------   00311400
.***AI.L08 XSEGTYPE "LAST"                                              00311500
.***      BL1'XXX1XXXX'                                                 00311600
         AIF   ('&XSEGTYPE' NE 'LAST').ZI33A                            00311700
&ZW                   SETC  '&ZW.1'                                     00311800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00311900
                      AGO   .ZI33C                                      00312000
.*                                                                      00312100
.ZI33A                ANOP  ,                                           00312200
&ZW                   SETC  '&ZW.0'                                     00312300
.ZI33C                ANOP  ,                                           00312400
.*-------------------------------------------------------------------   00312500
.***AI.L08 XSEGTYPE "ABORT"                                             00312600
.***      BL1'XXXX1XXX'                                                 00312700
         AIF   ('&XSEGTYPE' NE 'ABORT').ZI34A                           00312800
&ZW                   SETC  '&ZW.1000'                                  00312900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00313000
                      AGO   .ZI34C                                      00313100
.*                                                                      00313200
.ZI34A                ANOP  ,                                           00313300
&ZW                   SETC  '&ZW.0000'                                  00313400
.ZI34C                ANOP  ,                                           00313500
.*-------------------------------------------------------------------   00313600
.***AI.L11 XSEGTYPE BL1                                                 00313700
                      AIF   ('&ZCLNG' NE 'YES').ZI34E  ALL ZERO BITS    00313800
&ZOPN                 SETA  &ZOPN+1                                     00313900
&ZOPL(&ZOPN)          SETC  ' '                                         00314000
&ZOPO(&ZOPN)          SETC  'OI'                                        00314100
&ZOPV(&ZOPN)          SETC  '129(1),B''&ZW'''                           00314200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00314300
.ZI34E                ANOP  ,                                           00314400
.*-------------------------------------------------------------------   00314500
.***AI.L05 XKEYS BL1                                                    00314600
&ZW                   SETC  ''                                          00314700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00314800
.*-------------------------------------------------------------------   00314900
.***AI.L08 XKEYS "REQTYPE"                                              00315000
.***      BL1'1XXXXXXX'                                                 00315100
         AIF   ('&REQTYPE' EQ '').ZI36A                                 00315200
&ZW                   SETC  '&ZW.1'                                     00315300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00315400
                      AGO   .ZI36C                                      00315500
.*                                                                      00315600
.ZI36A                ANOP  ,                                           00315700
&ZW                   SETC  '&ZW.0'                                     00315800
.ZI36C                ANOP  ,                                           00315900
.*-------------------------------------------------------------------   00316000
.***AI.L08 XKEYS "REQTOKEN"                                             00316100
.***      BL1'X1XXXXXX'                                                 00316200
         AIF   ('&REQTOKEN' EQ '').ZI37A                                00316300
&ZW                   SETC  '&ZW.1'                                     00316400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00316500
                      AGO   .ZI37C                                      00316600
.*                                                                      00316700
.ZI37A                ANOP  ,                                           00316800
&ZW                   SETC  '&ZW.0'                                     00316900
.ZI37C                ANOP  ,                                           00317000
.*-------------------------------------------------------------------   00317100
.***AI.L08 XKEYS "REQMBOX"                                              00317200
.***      BL1'XX1XXXXX'                                                 00317300
         AIF   ('&REQMBOX' EQ '').ZI38A                                 00317400
&ZW                   SETC  '&ZW.1'                                     00317500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00317600
                      AGO   .ZI38C                                      00317700
.*                                                                      00317800
.ZI38A                ANOP  ,                                           00317900
&ZW                   SETC  '&ZW.0'                                     00318000
.ZI38C                ANOP  ,                                           00318100
.*-------------------------------------------------------------------   00318200
.***AI.L08 XKEYS "EXIT"                                                 00318300
.***      BL1'XXX1XXXX'                                                 00318400
         AIF   ('&EXIT' EQ '').ZI39A                                    00318500
         AIF   ('&EXIT' EQ 'NONE').ZI39A                                00318600
&ZW                   SETC  '&ZW.1'                                     00318700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00318800
                      AGO   .ZI39C                                      00318900
.*                                                                      00319000
.ZI39A                ANOP  ,                                           00319100
&ZW                   SETC  '&ZW.0'                                     00319200
.ZI39C                ANOP  ,                                           00319300
.*-------------------------------------------------------------------   00319400
.***AI.L08 XKEYS "SEGTYPE"                                              00319500
.***      BL1'XXXX1XXX'                                                 00319600
         AIF   ('&SEGTYPE' EQ '').ZI40A                                 00319700
&ZW                   SETC  '&ZW.1'                                     00319800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00319900
                      AGO   .ZI40C                                      00320000
.*                                                                      00320100
.ZI40A                ANOP  ,                                           00320200
&ZW                   SETC  '&ZW.0'                                     00320300
.ZI40C                ANOP  ,                                           00320400
.*-------------------------------------------------------------------   00320500
.***AI.L08 XKEYS "CONNECT"                                              00320600
.***      BL1'XXXXX1XX'                                                 00320700
         AIF   ('&CONNECT' EQ '').ZI41A                                 00320800
&ZW                   SETC  '&ZW.1'                                     00320900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00321000
                      AGO   .ZI41C                                      00321100
.*                                                                      00321200
.ZI41A                ANOP  ,                                           00321300
&ZW                   SETC  '&ZW.0'                                     00321400
.ZI41C                ANOP  ,                                           00321500
.*-------------------------------------------------------------------   00321600
.***AI.L08 XKEYS "MSGTOKEN"                                             00321700
.***      BL1'XXXXXX1X'                                                 00321800
         AIF   ('&MSGTOKEN' EQ '').ZI42A                                00321900
&ZW                   SETC  '&ZW.1'                                     00322000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00322100
                      AGO   .ZI42C                                      00322200
.*                                                                      00322300
.ZI42A                ANOP  ,                                           00322400
&ZW                   SETC  '&ZW.0'                                     00322500
.ZI42C                ANOP  ,                                           00322600
.*-------------------------------------------------------------------   00322700
.***AI.L08 XKEYS "MSGATTR"                                              00322800
.***      BL1'XXXXXXX1'                                                 00322900
         AIF   ('&MSGATTR' EQ '').ZI43A                                 00323000
&ZW                   SETC  '&ZW.1'                                     00323100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00323200
                      AGO   .ZI43C                                      00323300
.*                                                                      00323400
.ZI43A                ANOP  ,                                           00323500
&ZW                   SETC  '&ZW.0'                                     00323600
.ZI43C                ANOP  ,                                           00323700
.*-------------------------------------------------------------------   00323800
.***AI.L11 XKEYS BL1                                                    00323900
                      AIF   ('&ZCLNG' NE 'YES').ZI43E  ALL ZERO BITS    00324000
&ZOPN                 SETA  &ZOPN+1                                     00324100
&ZOPL(&ZOPN)          SETC  ' '                                         00324200
&ZOPO(&ZOPN)          SETC  'OI'                                        00324300
&ZOPV(&ZOPN)          SETC  '130(1),B''&ZW'''                           00324400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00324500
.ZI43E                ANOP  ,                                           00324600
.*-------------------------------------------------------------------   00324700
.***AI.L05 XKEYS1 BL1                                                   00324800
&ZW                   SETC  ''                                          00324900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00325000
.*-------------------------------------------------------------------   00325100
.***AI.L08 XKEYS1 "ECB"                                                 00325200
.***      BL1'1XXXXXXX'                                                 00325300
         AIF   ('&ECB' EQ '').ZI45A                                     00325400
         AIF   ('&ECB' EQ 'NONE').ZI45A                                 00325500
&ZW                   SETC  '&ZW.1'                                     00325600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00325700
                      AGO   .ZI45C                                      00325800
.*                                                                      00325900
.ZI45A                ANOP  ,                                           00326000
&ZW                   SETC  '&ZW.0'                                     00326100
.ZI45C                ANOP  ,                                           00326200
.*-------------------------------------------------------------------   00326300
.***AI.L08 XKEYS1 "DATAALET"                                            00326400
.***      BL1'X1XXXXXX'                                                 00326500
         AIF   ('&DATAALET' EQ '').ZI46A                                00326600
&ZW                   SETC  '&ZW.1000000'                               00326700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00326800
                      AGO   .ZI46C                                      00326900
.*                                                                      00327000
.ZI46A                ANOP  ,                                           00327100
&ZW                   SETC  '&ZW.0000000'                               00327200
.ZI46C                ANOP  ,                                           00327300
.*-------------------------------------------------------------------   00327400
.***AI.L11 XKEYS1 BL1                                                   00327500
                      AIF   ('&ZCLNG' NE 'YES').ZI46E  ALL ZERO BITS    00327600
&ZOPN                 SETA  &ZOPN+1                                     00327700
&ZOPL(&ZOPN)          SETC  ' '                                         00327800
&ZOPO(&ZOPN)          SETC  'OI'                                        00327900
&ZOPV(&ZOPN)          SETC  '131(1),B''&ZW'''                           00328000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00328100
.ZI46E                ANOP  ,                                           00328200
.*-------------------------------------------------------------------   00328300
&ZOPN1                SETA &ZOPN                                        00328400
.*******************************************************************    00328500
.***  PROCESS IXZXIXSM OUTPUT PARAMETERS                                00328600
.*******************************************************************    00328700
                      ACTR  10000                                       00328800
.*------------------------------------------------------------------    00328900
.***AO.LVER01                                                           00329000
                      AIF  (&XPLISTVER LT 1).ZO10Z  PLVER               00329100
.*------------------------------------------------------------------    00329200
.***AO.L02 XREQTOKEN XL8                                                00329300
         AIF   ('&ZXREQTOKEN' EQ 'OUTPUT').ZO10A  OUTPUT                00329400
         AIF   ('&ZXREQTOKEN' NE 'INOUT').ZO10C  INOUT                  00329500
.ZO10A    AIF   ('&XREQTOKEN'(1,1) NE '(').ZO10B  ADDR IN GPR           00329600
&ZCGPR   SETC  '&XREQTOKEN'(2,K'&XREQTOKEN-2)                           00329700
&ZOPN                 SETA  &ZOPN+1                                     00329800
&ZOPL(&ZOPN)          SETC  ' '                                         00329900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00330000
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),48(1)'                         00330100
&ZOPD(&ZOPN)          SETC  '++ XREQTOKEN XL8'                          00330200
                      AGO   .ZO10C                                      00330300
.*                                                                      00330400
.ZO10B                ANOP  ,                                           00330500
&ZAWRK   SETA  K'&XREQTOKEN                                             00330600
         AIF   ('&XREQTOKEN'(&ZAWRK,1) NE ')').ZO10G                    00330700
&ZN      SETA  2                                                        00330800
.ZO10H    ANOP                                                          00330900
         AIF   (&ZN GE &ZAWRK).ZO10G                                    00331000
         AIF   ('&XREQTOKEN'(&ZN,1) NE '(').ZO10I                       00331100
&ZC      SETC  '&XREQTOKEN'(1,&ZN).'8'.','                              00331200
&ZC      SETC  '&ZC'.'&XREQTOKEN'(&ZN+1,&ZAWRK-&ZN).',48(1)'            00331300
         AGO   .ZO10J                                                   00331400
.ZO10I    ANOP                                                          00331500
&ZN      SETA  &ZN+1                                                    00331600
         AGO   .ZO10H                                                   00331700
.ZO10G    ANOP                                                          00331800
&ZC      SETC  '&XREQTOKEN.(8),48(1)'                                   00331900
.ZO10J    ANOP                                                          00332000
&ZOPN                 SETA  &ZOPN+1                                     00332100
&ZOPL(&ZOPN)          SETC  ' '                                         00332200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00332300
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00332400
&ZOPD(&ZOPN)          SETC  '++ XREQTOKEN XL8'                          00332500
.ZO10C                ANOP  ,                                           00332600
.*------------------------------------------------------------------    00332700
.***AO.LVER02                                                           00332800
.ZO10Z                ANOP  ,                                           00332900
.*------------------------------------------------------------------    00333000
.***AO.LVER01                                                           00333100
                      AIF  (&XPLISTVER LT 1).ZO16Z  PLVER               00333200
.*------------------------------------------------------------------    00333300
.***AO.L02 XCONNECT XL8                                                 00333400
         AIF   ('&XCONNECT' NE '0').ZO16D  CK DEF                       00333500
         AIF   ('&ZXCONNECT' NE 'OUTPUT').ZO16C  CK DEF                 00333600
.ZO16D                ANOP  ,                                           00333700
         AIF   ('&ZXCONNECT' EQ 'OUTPUT').ZO16A  OUTPUT                 00333800
         AIF   ('&ZXCONNECT' NE 'INOUT').ZO16C  INOUT                   00333900
.ZO16A    AIF   ('&XCONNECT'(1,1) NE '(').ZO16B  ADDR IN GPR            00334000
&ZCGPR   SETC  '&XCONNECT'(2,K'&XCONNECT-2)                             00334100
&ZOPN                 SETA  &ZOPN+1                                     00334200
&ZOPL(&ZOPN)          SETC  ' '                                         00334300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00334400
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),88(1)'                         00334500
&ZOPD(&ZOPN)          SETC  '++ XCONNECT XL8'                           00334600
                      AGO   .ZO16C                                      00334700
.*                                                                      00334800
.ZO16B                ANOP  ,                                           00334900
&ZAWRK   SETA  K'&XCONNECT                                              00335000
         AIF   ('&XCONNECT'(&ZAWRK,1) NE ')').ZO16G                     00335100
&ZN      SETA  2                                                        00335200
.ZO16H    ANOP                                                          00335300
         AIF   (&ZN GE &ZAWRK).ZO16G                                    00335400
         AIF   ('&XCONNECT'(&ZN,1) NE '(').ZO16I                        00335500
&ZC      SETC  '&XCONNECT'(1,&ZN).'8'.','                               00335600
&ZC      SETC  '&ZC'.'&XCONNECT'(&ZN+1,&ZAWRK-&ZN).',88(1)'             00335700
         AGO   .ZO16J                                                   00335800
.ZO16I    ANOP                                                          00335900
&ZN      SETA  &ZN+1                                                    00336000
         AGO   .ZO16H                                                   00336100
.ZO16G    ANOP                                                          00336200
&ZC      SETC  '&XCONNECT.(8),88(1)'                                    00336300
.ZO16J    ANOP                                                          00336400
&ZOPN                 SETA  &ZOPN+1                                     00336500
&ZOPL(&ZOPN)          SETC  ' '                                         00336600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00336700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00336800
&ZOPD(&ZOPN)          SETC  '++ XCONNECT XL8'                           00336900
.ZO16C                ANOP  ,                                           00337000
.*------------------------------------------------------------------    00337100
.***AO.LVER02                                                           00337200
.ZO16Z                ANOP  ,                                           00337300
.*------------------------------------------------------------------    00337400
.***AO.LVER01                                                           00337500
                      AIF  (&XPLISTVER LT 1).ZO18Z  PLVER               00337600
.*------------------------------------------------------------------    00337700
.***AO.L02 XUSERRC F                                                    00337800
         AIF   ('&ZXUSERRC' EQ 'OUTPUT').ZO18A  OUTPUT                  00337900
         AIF   ('&ZXUSERRC' NE 'INOUT').ZO18C  INOUT                    00338000
.ZO18A    AIF   ('&XUSERRC'(1,1) NE '(').ZO18B  ADDR IN GPR             00338100
&ZCGPR   SETC  '&XUSERRC'(2,K'&XUSERRC-2)                               00338200
&ZOPN                 SETA  &ZOPN+1                                     00338300
&ZOPL(&ZOPN)          SETC  ' '                                         00338400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00338500
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),100(1)'                        00338600
&ZOPD(&ZOPN)          SETC  '++ XUSERRC F'                              00338700
                      AGO   .ZO18C                                      00338800
.*                                                                      00338900
.ZO18B                ANOP  ,                                           00339000
&ZAWRK   SETA  K'&XUSERRC                                               00339100
         AIF   ('&XUSERRC'(&ZAWRK,1) NE ')').ZO18G                      00339200
&ZN      SETA  2                                                        00339300
.ZO18H    ANOP                                                          00339400
         AIF   (&ZN GE &ZAWRK).ZO18G                                    00339500
         AIF   ('&XUSERRC'(&ZN,1) NE '(').ZO18I                         00339600
&ZC      SETC  '&XUSERRC'(1,&ZN).'4'.','                                00339700
&ZC      SETC  '&ZC'.'&XUSERRC'(&ZN+1,&ZAWRK-&ZN).',100(1)'             00339800
         AGO   .ZO18J                                                   00339900
.ZO18I    ANOP                                                          00340000
&ZN      SETA  &ZN+1                                                    00340100
         AGO   .ZO18H                                                   00340200
.ZO18G    ANOP                                                          00340300
&ZC      SETC  '&XUSERRC.(4),100(1)'                                    00340400
.ZO18J    ANOP                                                          00340500
&ZOPN                 SETA  &ZOPN+1                                     00340600
&ZOPL(&ZOPN)          SETC  ' '                                         00340700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00340800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00340900
&ZOPD(&ZOPN)          SETC  '++ XUSERRC F'                              00341000
.ZO18C                ANOP  ,                                           00341100
.*------------------------------------------------------------------    00341200
.***AO.LVER02                                                           00341300
.ZO18Z                ANOP  ,                                           00341400
.*------------------------------------------------------------------    00341500
.***AO.LVER01                                                           00341600
                      AIF  (&XPLISTVER LT 1).ZO19Z  PLVER               00341700
.*------------------------------------------------------------------    00341800
.***AO.L02 XRESPDATA F                                                  00341900
         AIF   ('&XRESPDATA' NE '0').ZO19D  CK DEF                      00342000
         AIF   ('&ZXRESPDATA' NE 'OUTPUT').ZO19C  CK DEF                00342100
.ZO19D                ANOP  ,                                           00342200
         AIF   ('&ZXRESPDATA' EQ 'OUTPUT').ZO19A  OUTPUT                00342300
         AIF   ('&ZXRESPDATA' NE 'INOUT').ZO19C  INOUT                  00342400
.ZO19A    AIF   ('&XRESPDATA'(1,1) NE '(').ZO19B  ADDR IN GPR           00342500
&ZCGPR   SETC  '&XRESPDATA'(2,K'&XRESPDATA-2)                           00342600
&ZOPN                 SETA  &ZOPN+1                                     00342700
&ZOPL(&ZOPN)          SETC  ' '                                         00342800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00342900
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),104(1)'                        00343000
&ZOPD(&ZOPN)          SETC  '++ XRESPDATA F'                            00343100
                      AGO   .ZO19C                                      00343200
.*                                                                      00343300
.ZO19B                ANOP  ,                                           00343400
&ZAWRK   SETA  K'&XRESPDATA                                             00343500
         AIF   ('&XRESPDATA'(&ZAWRK,1) NE ')').ZO19G                    00343600
&ZN      SETA  2                                                        00343700
.ZO19H    ANOP                                                          00343800
         AIF   (&ZN GE &ZAWRK).ZO19G                                    00343900
         AIF   ('&XRESPDATA'(&ZN,1) NE '(').ZO19I                       00344000
&ZC      SETC  '&XRESPDATA'(1,&ZN).'4'.','                              00344100
&ZC      SETC  '&ZC'.'&XRESPDATA'(&ZN+1,&ZAWRK-&ZN).',104(1)'           00344200
         AGO   .ZO19J                                                   00344300
.ZO19I    ANOP                                                          00344400
&ZN      SETA  &ZN+1                                                    00344500
         AGO   .ZO19H                                                   00344600
.ZO19G    ANOP                                                          00344700
&ZC      SETC  '&XRESPDATA.(4),104(1)'                                  00344800
.ZO19J    ANOP                                                          00344900
&ZOPN                 SETA  &ZOPN+1                                     00345000
&ZOPL(&ZOPN)          SETC  ' '                                         00345100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00345200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00345300
&ZOPD(&ZOPN)          SETC  '++ XRESPDATA F'                            00345400
.ZO19C                ANOP  ,                                           00345500
.*------------------------------------------------------------------    00345600
.***AO.LVER02                                                           00345700
.ZO19Z                ANOP  ,                                           00345800
.*------------------------------------------------------------------    00345900
.***AO.LVER01                                                           00346000
                      AIF  (&XPLISTVER LT 1).ZO20Z  PLVER               00346100
.*------------------------------------------------------------------    00346200
.***AO.L02 XRESPDLEN F                                                  00346300
         AIF   ('&XRESPDLEN' NE '0').ZO20D  CK DEF                      00346400
         AIF   ('&ZXRESPDLEN' NE 'OUTPUT').ZO20C  CK DEF                00346500
.ZO20D                ANOP  ,                                           00346600
         AIF   ('&ZXRESPDLEN' EQ 'OUTPUT').ZO20A  OUTPUT                00346700
         AIF   ('&ZXRESPDLEN' NE 'INOUT').ZO20C  INOUT                  00346800
.ZO20A    AIF   ('&XRESPDLEN'(1,1) NE '(').ZO20B  ADDR IN GPR           00346900
&ZCGPR   SETC  '&XRESPDLEN'(2,K'&XRESPDLEN-2)                           00347000
&ZOPN                 SETA  &ZOPN+1                                     00347100
&ZOPL(&ZOPN)          SETC  ' '                                         00347200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00347300
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),108(1)'                        00347400
&ZOPD(&ZOPN)          SETC  '++ XRESPDLEN F'                            00347500
                      AGO   .ZO20C                                      00347600
.*                                                                      00347700
.ZO20B                ANOP  ,                                           00347800
&ZAWRK   SETA  K'&XRESPDLEN                                             00347900
         AIF   ('&XRESPDLEN'(&ZAWRK,1) NE ')').ZO20G                    00348000
&ZN      SETA  2                                                        00348100
.ZO20H    ANOP                                                          00348200
         AIF   (&ZN GE &ZAWRK).ZO20G                                    00348300
         AIF   ('&XRESPDLEN'(&ZN,1) NE '(').ZO20I                       00348400
&ZC      SETC  '&XRESPDLEN'(1,&ZN).'4'.','                              00348500
&ZC      SETC  '&ZC'.'&XRESPDLEN'(&ZN+1,&ZAWRK-&ZN).',108(1)'           00348600
         AGO   .ZO20J                                                   00348700
.ZO20I    ANOP                                                          00348800
&ZN      SETA  &ZN+1                                                    00348900
         AGO   .ZO20H                                                   00349000
.ZO20G    ANOP                                                          00349100
&ZC      SETC  '&XRESPDLEN.(4),108(1)'                                  00349200
.ZO20J    ANOP                                                          00349300
&ZOPN                 SETA  &ZOPN+1                                     00349400
&ZOPL(&ZOPN)          SETC  ' '                                         00349500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00349600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00349700
&ZOPD(&ZOPN)          SETC  '++ XRESPDLEN F'                            00349800
.ZO20C                ANOP  ,                                           00349900
.*------------------------------------------------------------------    00350000
.***AO.LVER02                                                           00350100
.ZO20Z                ANOP  ,                                           00350200
.*------------------------------------------------------------------    00350300
.***AO.LVER01                                                           00350400
                      AIF  (&XPLISTVER LT 1).ZO22Z  PLVER               00350500
.*------------------------------------------------------------------    00350600
.***AO.L02 XMSGTOKEN XL8                                                00350700
         AIF   ('&ZXMSGTOKEN' EQ 'OUTPUT').ZO22A  OUTPUT                00350800
         AIF   ('&ZXMSGTOKEN' NE 'INOUT').ZO22C  INOUT                  00350900
.ZO22A    AIF   ('&XMSGTOKEN'(1,1) NE '(').ZO22B  ADDR IN GPR           00351000
&ZCGPR   SETC  '&XMSGTOKEN'(2,K'&XMSGTOKEN-2)                           00351100
&ZOPN                 SETA  &ZOPN+1                                     00351200
&ZOPL(&ZOPN)          SETC  ' '                                         00351300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00351400
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),116(1)'                        00351500
&ZOPD(&ZOPN)          SETC  '++ XMSGTOKEN XL8'                          00351600
                      AGO   .ZO22C                                      00351700
.*                                                                      00351800
.ZO22B                ANOP  ,                                           00351900
&ZAWRK   SETA  K'&XMSGTOKEN                                             00352000
         AIF   ('&XMSGTOKEN'(&ZAWRK,1) NE ')').ZO22G                    00352100
&ZN      SETA  2                                                        00352200
.ZO22H    ANOP                                                          00352300
         AIF   (&ZN GE &ZAWRK).ZO22G                                    00352400
         AIF   ('&XMSGTOKEN'(&ZN,1) NE '(').ZO22I                       00352500
&ZC      SETC  '&XMSGTOKEN'(1,&ZN).'8'.','                              00352600
&ZC      SETC  '&ZC'.'&XMSGTOKEN'(&ZN+1,&ZAWRK-&ZN).',116(1)'           00352700
         AGO   .ZO22J                                                   00352800
.ZO22I    ANOP                                                          00352900
&ZN      SETA  &ZN+1                                                    00353000
         AGO   .ZO22H                                                   00353100
.ZO22G    ANOP                                                          00353200
&ZC      SETC  '&XMSGTOKEN.(8),116(1)'                                  00353300
.ZO22J    ANOP                                                          00353400
&ZOPN                 SETA  &ZOPN+1                                     00353500
&ZOPL(&ZOPN)          SETC  ' '                                         00353600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00353700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00353800
&ZOPD(&ZOPN)          SETC  '++ XMSGTOKEN XL8'                          00353900
.ZO22C                ANOP  ,                                           00354000
.*------------------------------------------------------------------    00354100
.***AO.LVER02                                                           00354200
.ZO22Z                ANOP  ,                                           00354300
.*******************************************************************    00354400
.***AO.X02  RETURN CODE PROCESSING                                      00354500
.*******************************************************************    00354600
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00354700
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00354800
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00354900
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00355000
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00355100
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00355200
&ZOPN                 SETA  &ZOPN+1                                     00355300
&ZOPL(&ZOPN)          SETC  ' '                                         00355400
&ZOPO(&ZOPN)          SETC  'ST'                                        00355500
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00355600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00355700
                      AGO   .ZMRETX                                     00355800
.*                                                                      00355900
.ZMRET2               ANOP  ,                                           00356000
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00356100
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00356200
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00356300
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00356400
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00356500
&ZOPN                 SETA  &ZOPN+1                                     00356600
&ZOPL(&ZOPN)          SETC  ' '                                         00356700
&ZOPO(&ZOPN)          SETC  'LR'                                        00356800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00356900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00357000
.ZMRETX               ANOP  ,                                           00357100
.*******************************************************************    00357200
.***AO.X03  REASON CODE PROCESSING                                      00357300
.*******************************************************************    00357400
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00357500
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00357600
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00357700
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00357800
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00357900
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00358000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00358100
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00358200
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00358300
&ZOPN                 SETA  &ZOPN+1                                     00358400
&ZOPL(&ZOPN)          SETC  ' '                                         00358500
&ZOPO(&ZOPN)          SETC  'ST'                                        00358600
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00358700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00358800
                      AGO   .ZMRSNX                                     00358900
.*                                                                      00359000
.ZMRSN2               ANOP  ,                                           00359100
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00359200
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00359300
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00359400
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00359500
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00359600
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00359700
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00359800
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00359900
&ZOPN                 SETA  &ZOPN+1                                     00360000
&ZOPL(&ZOPN)          SETC  ' '                                         00360100
&ZOPO(&ZOPN)          SETC  'LR'                                        00360200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00360300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00360400
.ZMRSNX               ANOP  ,                                           00360500
.*******************************************************************    00360600
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00360700
.*******************************************************************    00360800
.ZMFLX                ANOP  ,              MF=L PROCESSING              00360900
.*******************************************************************    00361000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00361100
.*******************************************************************    00361200
                      ACTR  10000                                       00361300
.*                                                                      00361400
                      LCLA  &ZLC           COLUMN POSITION              00361500
                      LCLA  &ZOPX          LIST TABLE INDEX             00361600
                      LCLC  &ZLL           LABEL                        00361700
                      LCLC  &ZLOP          OPERATION                    00361800
                      LCLC  &ZLV           VALUE                        00361900
                      LCLC  &ZLD           DESCRIPTION                  00362000
.*                                                                      00362100
&ZOPX                 SETA  1                                           00362200
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00362300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00362400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00362500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00362600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00362700
                      AIF   (K'&ZLD LE 0).ZL5                           00362800
&ZLC                  SETA  35             COMMENT COLUMN               00362900
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00363000
&ZLC                  SETA  33             COMMMENT COLUMN              00363100
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00363200
&ZLV                  SETC  '&ZLV'.' '                                  00363300
                      AGO   .ZL3                                        00363400
.*                                                                      00363500
.ZL4                  ANOP  ,                                           00363600
&ZLV                  SETC  '&ZLV'.' '                                  00363700
.ZL5                  ANOP  ,                                           00363800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00363900
.*                                                                      00364000
&ZLL     &ZLOP &ZLV                                                     00364100
.*                                                                      00364200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00364300
                      AGO   .ZL2           CONTINUE LOOPING             00364400
.*                                                                      00364500
.ZLX                  ANOP  ,                                           00364600
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00364700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00364800
         GBLC  &ANVIRON           JES2 environment variable             00364900
         GBLB  &J3MN              JES3 Main Task environment            00365000
         GBLB  &J3ST              JES3 Subtask environment              00365100
         GBLB  &J3FSS             JES3 FSS environment                  00365200
         GBLB  &J3USR             JES3 User environment                 00365300
         GBLB  &JSXCF             JESXCF environment                    00365400
         AIF   ('&ANVIRON' EQ 'JES2').IXSM050 JES2 Main Task            00365500
         AIF   ('&ANVIRON' EQ 'SUBTASK').IXSM050 JES2 Subtask           00365600
         AIF   ('&ANVIRON' EQ 'FSS').IXSM050 JES2 FSS                   00365700
         AIF   ('&ANVIRON' EQ 'USER').IXSM050  JES2 User                00365800
         AIF   (&J3MN).IXSM050    Are we running under JES3 Main task   00365900
         AIF   (&J3ST).IXSM050    Are we running under JES3 Sub task    00366000
         AIF   (&J3FSS).IXSM050   Are we running under JES3 FSS         00366100
         AIF   (&J3USR).IXSM050   Are we running under JES3 User        00366200
         AIF   (&JSXCF).IXSM050   Are we running under JESXCF           00366300
         MNOTE 8,'IXZ0001 Running in an invalid environment'            00366400
.IXSM050 ANOP                                                           00366500
         AIF   ('&GROUPTOKEN'(1,1) NE '(').IXSM100                      00366600
         LR    14,&GROUPTOKEN     Load the address of the group token   00366700
         L     14,0(14)           Load the group token                  00366800
         AGO   .IXSM150                                                 00366900
.IXSM100 ANOP                                                           00367000
         L     14,&GROUPTOKEN     Load the group token                  00367100
.IXSM150 ANOP                                                           00367200
         L     14,52(14)          Load the PC number of the             00367300
*                                 routine to be called                  00367400
         PC    0(14)              Call the send message routine         00367500
         AIF   ('&XMFCTRL'(1,1) NE '(').IXSM200                         00367600
         LR    1,&XMFCTRL         Restore the parameter list address    00367700
         AGO   .IXSM250                                                 00367800
.IXSM200 ANOP                                                           00367900
         LA    1,&XMFCTRL         Restore the parameter list address    00368000
.IXSM250 ANOP                                                           00368100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00368200
.ZLINKX               ANOP  ,                                           00368300
.*******************************************************************    00368400
.***AP.X01  FORMAT GENERATED CODE                                       00368500
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00368600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00368700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00368800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00368900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00369000
                      AIF   (K'&ZLD LE 0).ZL51                          00369100
&ZLC                  SETA  35             COMMENT COLUMN               00369200
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00369300
&ZLC                  SETA  33             COMMENT COLUMN               00369400
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00369500
&ZLV                  SETC  '&ZLV'.' '                                  00369600
                      AGO   .ZL31                                       00369700
.*                                                                      00369800
.ZL41                 ANOP  ,                                           00369900
&ZLV                  SETC  '&ZLV'.' '                                  00370000
.ZL51                 ANOP  ,                                           00370100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00370200
.*                                                                      00370300
&ZLL     &ZLOP &ZLV                                                     00370400
.*                                                                      00370500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00370600
                      AGO   .ZL21          CONTINUE LOOPING             00370700
.*                                                                      00370800
.ZLX1                 ANOP  ,                                           00370900
.*******************************************************************    00371000
.***AP.X02  END OF IXZXIXSM MACRO                                       00371100
&ZIXZXIXSM            SETC  'YES'          SET IXZXIXSM USED            00371200
         POP   PRINT                                                    00371300
*                                            IXZXIXSM-1                 00371400
         SPACE 1                                                        00371500
.ZLX2                 ANOP  ,                                           00371600
         MEND                                                           00371700
**********************************************************************/ 00371800
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00371900
*%IXZXIXSM: MACRO KEYS(MBOXNAME,MEMBER,DATA,DATAALET,DATALEN,REQTYPE,   00372000
*                 SEGTYPE,CONNECT,GROUPTOKEN,RESPDATA,RESPDLEN,         00372100
*                 RESPDALT,REQMBOX,REQTOKEN,EXIT,ECB,MSGTOKEN,USERRC,   00372200
*                 MSGATTR,RTNCODE,RSNCODE,PLISTVER,MF);                 00372300
*  ANS('?'||MACLABEL||' '||'IXZPIXSM '||MACLIST||                       00372400
*         ' '||MACKEYS||';') COL(MACLMAR);                              00372500
*%END IXZXIXSM;                                                         00372600
