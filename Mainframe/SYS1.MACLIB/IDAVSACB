         MACRO                                                          00050000
         IDAVSACB &AM=,&MF=,&CALLER=,                          @ZA34940C00100000
               &ACBLEN=,&ATRB=,&AVSPAC=,&BUFND=,   *** ACB KEYWORDS ***C00150000
               &BUFNI=,&BUFNO=,&BUFSP=,&CINV=,&DDNAME=,&ENDRBA=,       C00200000
               &ERROR=,&EXLST=,&FS=,&KEYLEN=,&LRECL=,                  C00250000
               &MACRF=,&NCIS=,&NDELR=,&NEXCP=,&NEXT=,&NINSR=,&NIXL=,   C00300000
               &NLOGR=,&NRETR=,&NSSS=,&NUPDR=,&OFLAGS=,&PASSWD=,&RKP=, C00350000
               &BSTRNO=,&CRA=,&OPENOBJ=,&AIXRKP=,               X04SVHSC00400000
               &MAREA=,&MLEN=,&JFCB=,                          @XM01140*00450000
               &USERPTR=,                                      @XM01129*00500000
               &RMODE31=,                                          @LPA*00525000
               &STRNO=,&STMST=,&CATALOG=,&APPLID=                       00550000
.*                                                                      00600000
.* $MAC(IDAVSACB) COMP(SC1DE):                                          00600100
.*                                                                      00600200
.*PROPRIETARY V3 STATEMENT                                              00602000
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00603800
.*"RESTRICTED MATERIALS OF IBM"                                         00605600
.*5695-DF1                                                              00607400
.*(C) COPYRIGHT 1983,1995  IBM CORP.                                    00609200
.*END PROPRIETARY V3 STATEMENT                                          00611900
.*                                                                      00614600
.*                                                                      00616400
.* STATUS = MVS/XA DFP RELEASE 2.3                                      00618200
.*                                                                      00620000
.* FUNCTION    THIS MACRO ACTS AS A CONTROLLER FOR PROCESSING AN   @L1C 00621800
.*             ACB. IT PROCESSES THE BIT KEYWORDS MACRF, CATALOG,  @L1C 00623600
.*             AND CRA.  IT IS CALLED BY ACBVS TO BUILD VARIOUS    @L1M 00625400
.*             ARRAYS TO BE USED BY ACBVS TO BUILD AN ACB.         @L1C 00627200
.*                                                                      00629000
.*             FOR NON-BIT KEYWORDS, THIS MACRO CALLS IDAVSCB3 @ZA34940 00630800
.*             WHICH ACTUALLY SETS VALUES INTO ALL THE ARRAYS  @ZA34940 00632600
.*             THAT ARE REQUIRED.                              @ZA34940 00634400
.*                                                                      00636200
.*             FOR BIT KEYWORDS, IDAVSCB3 IS CALLED, BUT THIS  @ZA34940 00638000
.*             MACRO SETS THE VALUE IN &IDAVALC ARRAY.         @ZA34940 00639800
.*             IT ALSO VALIDITY CHECKS BIT OPTIONS AND IF MUTUALLY      00641600
.*             EXCLUSIVE OPTIONS ARE SPECIFIED, AN ERROR MESSAGE IS     00643400
.*             ISSUED.                                                  00645200
.*                                                             @ZA34940 00647000
.* $L1=DFP,JDP1110,,STLJRB: MVS/XA DFP RELEASE 1.1 VSAM 31-BIT     @L1A 00648800
.* $L9=DFP,HDP2230,,STLJRB: MVS/XA DFP RELEASE 2.3 VSAM 31-BIT     @L9A 00652800
.* $LP=DFP,HDP2230,,STLJTP: MVS/XA DFP RELEASE 2.3 31/24 BIT       @LPA 00669400
.* APAR TO SHIP 31/24 BIT CODE                                 @YA04964 00686000
.*                                                                      00702800
.*      CBMM SPLIT SUPPORT                                     @ZA34940 00752800
.*                                                             @ZA34940 00802800
.* OY41854,HDP3330,09/18/91,SJPLTLD: NO LSR EXCL CTL WAIT SPE  @YA41854 00827800
.* $LQ=DFSMS,HDZ11C0,043093,SJPLRG: VSAM RLS                       @LQA 00836100
.******************************************************************@LQA 00844400
.* GLOBALS                                                              00852800
         GBLB  &IDACB01                ERROR INDICATOR                  00902800
         GBLA  &IDAENO                 NUMBER OF ELEMENTS               00952800
         GBLA  &IDAELEN(50)            ELEMENT FIELD LENGTH ARRAY       01002800
         GBLC  &IDAVALC(50)            ELEMENT CHARACTER VALUE ARRAY    01052800
         GBLC  &IDAMAC1,&IDAMAC2,&IDAMAC3,&IDAMAC4                 @LQC 01102800
.*             MACRF VALUES FOR ACB DECLARATIVE MACRO           X04SVHS 01152800
         GBLB  &IDARLS                 MACRF=RLS SPECIFIED         @LQA 01177800
         GBLC  &IDAIFL1                 CATALOG/CRA VALUES FOR  X04SVHS 01202800
.*                                      ACB DECLARATIVE MACRO   X04SVHS 01252800
.* LOCALS                                                               01302800
         LCLA  &I,&A,&B,&C                       WORK VARIABLES         01352800
         LCLB  &ESDS,&KSDS,&WCK,&SSWD,&REPL      ATRB CODES             01402800
         LCLB  &RRDS,&SPAN,&UNQ                  ATRB CODES     X04SVHS 01452800
         LCLB  &PATH,&BASE,&OAIX                 OPENOBJ CODES  X04SVHS 01502800
         LCLB  &SCRA,&UCRA                       CRA CODES      X04SVHS 01552800
         LCLB  &MKEY,&MADR,&MCNV,&MSEQ,&MSKP     MACRF CODES            01602800
         LCLB  &MDIR,&IN,&OUT,&NUB,&UBF,&RLS     MACRF CODES       @LQC 01652800
         LCLB  &LOGONF,&NLOGON                   MACRF CODES     X03004 01702800
         LCLB  &NFX,&CFX,&RST,&NRS,&DDN,&DSN     MACRF CODES   @XM01125 01752800
         LCLB  &NRM,&AIX,&NSR,&LSR,&GSR          MACRF CODES    X04SVHS 01802800
         LCLB  &NCI,&ICI,&NDF,&DFR,&NIS,&SIS     MACRF CODES    X04SVHS 01852800
         LCLB  &LEW,&NLW                         MACRF CODES   @YA41854 01877800
         LCLB  &OPEN                             OFLAGS CODE    X04SVHS 01902800
         LCLB  &VSAM,&VTAM                       AM CODES        X03004 01952800
         LCLB  &YES,&NO                          CATALOG CODES  X04SVHS 02002800
         LCLB  &R31B,&R31C,&R31E                 RMODE31 FLAGS     @LPA 02036100
         LCLB  &AMODE31                MACRF INDICATOR             @L1A 02069400
         LCLC  &Z16                     UNUSED PORTION OF BIT STRING    02102800
.* INITIALIZATION                                                       02152800
&Z16     SETC  '0000000000000000'       SET TO 16 ZEROES                02202800
.* SCAN ACB KEYWORDS ************************************************** 02252800
.*                                      BUFND                           02302800
         IDAVSCB3 ARG=&BUFND,ARGNAME=BUFND,KWTC=X'04',MF=&MF   @ZA34940 02352800
.********************************************************************** 02402800
.*                                      BUFNI                   X04SVHS 02452800
         IDAVSCB3 ARG=&BUFNI,ARGNAME=BUFNI,KWTC=X'05',MF=&MF   @ZA34940 02502800
.********************************************************************** 02552800
.*                                      BUFSP                   X04SVHS 02602800
         IDAVSCB3 ARG=&BUFSP,ARGNAME=BUFSP,KWTC=X'07',MF=&MF   @ZA34940 02652800
.********************************************************************** 02702800
.*                                      DDNAME                          02752800
         AIF   ('&DDNAME' EQ '').A000300  *** DDNAME ***                02802800
         AIF   ('&DDNAME(1)' EQ '*').A000200                            02852800
.*             IF INDIRECT ADDRESS SPECIFIED, BYPASS VALIDITY CHECKS    02902800
         AIF   (K'&DDNAME GT 8).A000100                                 02952800
         AIF   (('&DDNAME'(1,1) LT 'A' OR '&DDNAME'(1,1) GT 'Z') AND   C03002800
               ('&DDNAME'(1,1) NE '#' AND '&DDNAME'(1,1) NE '@' AND    C03052800
               '&DDNAME'(1,1) NE '$')).A000100                 @ZA37504 03102800
.*             DDNAME MUST BE 8 OR FEWER CHARS, AND FIRST CHAR MUST     03152800
.*                                   BE ALPHABETIC OR NATIONAL@ZA37504  03202800
         AGO   .A000200                                                 03252800
.A000100 IDAERMAC 3,DDNAME,&DDNAME      ISSUE ERROR MESSAGE        @L9C 03302800
&IDACB01 SETB  1                        SET ERROR SWITCH                03352800
         AGO   .A000300                 SKIP PROCESSING                 03402800
.A000200 ANOP                                                           03452800
         IDAVSCB3 ARG=&DDNAME,ARGNAME=DDNAME,KWTC=X'09',       @ZA34940*03502800
               MF=&MF,INDRECT=YES                              @ZA34940 03552800
&IDAELEN(&IDAENO) SETA 8                ELEMENT LENGTH IS 8 BYTES       03602800
.********************************************************************** 03652800
.A000300 ANOP                                                           03702800
.*                                      EXLST                           03752800
         IDAVSCB3 ARG=&EXLST,ARGNAME=EXLST,KWTC=X'0C',MF=&MF   @ZA34940 03802800
.********************************************************************** 03852800
.*                                      JFCB                   @XM01140 03902800
         IDAVSCB3 ARG=&JFCB,ARGNAME=JFCB,KWTC=X'8D',MF=&MF     @ZA34940 03952800
.********************************************************************** 04002800
.*                                      CATALOG                         04052800
         AIF   ('&CATALOG' EQ '').A000500 *** CATALOG ***               04102800
         IDAVSCB3 ARG=&CATALOG,ARGNAME=CATALOG,KWTC=X'22',     @ZA34940*04152800
               MF=&MF,INDRECT=YES,BIT=YES                      @ZA34940 04202800
         AIF   ('&CATALOG(1)' EQ '*').A000500                   X04SVHS 04252800
.*             IF INDIRECT ADDRESS SPECIFIED, VALUE ARRAY(&IDAVALC)     04302800
.*                                      WAS SET IN IDAVSCB3    @ZA34940 04352800
&YES     SETB  ('&CATALOG' EQ 'YES')                            X04SVHS 04402800
&NO      SETB  ('&CATALOG' EQ 'NO')                             X04SVHS 04452800
         AIF   (&YES OR &NO).A000400                            X04SVHS 04502800
         IDAERMAC 3,CATALOG,&CATALOG  ISSUE ERROR MESSAGE          @L9C 04552800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 04602800
.A000400 ANOP                                                   X04SVHS 04652800
         AIF   ('&CALLER' EQ 'ACB').A000500                     X04SVHS 04702800
.*             IF CALLER IS ACB, VALUE WILL BE SET IN CRA RTN   X04SVHS 04752800
&IDAVALC(&IDAENO) SETC '&YES&NO.00000000000000&Z16'             X04SVHS 04802800
.********************************************************************** 04852800
.*                                      MACRF                           04902800
.A000500 AIF   ('&MACRF' EQ '').A001750   *** MACRF ***         X04SVHS 04952800
         IDAVSCB3 ARG=&MACRF,ARGNAME=MACRF,KWTC=X'12',MF=&MF,  @ZA34940*05002800
               BIT=YES,INDRECT=YES                             @ZA34940 05052800
         AIF   ('&MACRF(1)' EQ '*').A001800                             05102800
.*             IF INDIRECT ADDRESS SPECIFIED, VALUE ARRAY(&IDAVALC)     05152800
.*                                      WAS SET IN IDAVSCB3    @ZA34940 05202800
&I       SETA  0                        CLEAR                   X04SVHS 05252800
&A       SETA  0                        WORK                    X04SVHS 05302800
&B       SETA  0                        VARIABLES               X04SVHS 05352800
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 05402800
.A000600 ANOP                                                           05452800
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 05502800
         AIF   (&I GT N'&MACRF).A000800 HAVE ALL OPTIONS BEEN CHECKED   05552800
&MKEY    SETB  ('&MACRF(&I)' EQ 'KEY' OR &MKEY)                 X04SVHS 05602800
&MADR    SETB  ('&MACRF(&I)' EQ 'ADR' OR &MADR)                 X04SVHS 05652800
&MCNV    SETB  ('&MACRF(&I)' EQ 'CNV' OR &MCNV)                 X04SVHS 05702800
&MSEQ    SETB  ('&MACRF(&I)' EQ 'SEQ' OR &MSEQ)                 X04SVHS 05752800
&MSKP    SETB  ('&MACRF(&I)' EQ 'SKP' OR &MSKP)                 X04SVHS 05802800
&MDIR    SETB  ('&MACRF(&I)' EQ 'DIR' OR &MDIR)                 X04SVHS 05852800
&OUT     SETB  ('&MACRF(&I)' EQ 'OUT' OR &OUT)                  X04SVHS 05902800
&IN      SETB  ('&MACRF(&I)' EQ 'IN' OR &IN)                    X04SVHS 05952800
&NUB     SETB  ('&MACRF(&I)' EQ 'NUB' OR &NUB)                  X04SVHS 06002800
&UBF     SETB  ('&MACRF(&I)' EQ 'UBF' OR &UBF)                  X04SVHS 06052800
&NFX     SETB  ('&MACRF(&I)' EQ 'NFX' OR &NFX)                  X04SVHS 06102800
&CFX     SETB  ('&MACRF(&I)' EQ 'CFX' OR &CFX)                  X04SVHS 06152800
&DDN     SETB  ('&MACRF(&I)' EQ 'DDN' OR &DDN)                  X04SVHS 06202800
&DSN     SETB  ('&MACRF(&I)' EQ 'DSN' OR &DSN)                  X04SVHS 06252800
&NRM     SETB  ('&MACRF(&I)' EQ 'NRM' OR &NRM)                  X04SVHS 06302800
&AIX     SETB  ('&MACRF(&I)' EQ 'AIX' OR &AIX)                  X04SVHS 06352800
&NSR     SETB  ('&MACRF(&I)' EQ 'NSR' OR &NSR)                  X04SVHS 06402800
&LSR     SETB  ('&MACRF(&I)' EQ 'LSR' OR &LSR)                  X04SVHS 06452800
&GSR     SETB  ('&MACRF(&I)' EQ 'GSR' OR &GSR)                  X04SVHS 06502800
&RLS     SETB  ('&MACRF(&I)' EQ 'RLS' OR &RLS)                     @LQA 06527800
&NCI     SETB  ('&MACRF(&I)' EQ 'NCI' OR &NCI)                  X04SVHS 06552800
&ICI     SETB  ('&MACRF(&I)' EQ 'ICI' OR &ICI)                  X04SVHS 06602800
&NDF     SETB  ('&MACRF(&I)' EQ 'NDF' OR &NDF)                  X04SVHS 06652800
&DFR     SETB  ('&MACRF(&I)' EQ 'DFR' OR &DFR)                  X04SVHS 06702800
&NIS     SETB  ('&MACRF(&I)' EQ 'NIS' OR &NIS)                  X04SVHS 06752800
&SIS     SETB  ('&MACRF(&I)' EQ 'SIS' OR &SIS)                  X04SVHS 06802800
&RST     SETB  ('&MACRF(&I)' EQ 'RST' OR &RST)                 @XM01125 06852800
&NRS     SETB  ('&MACRF(&I)' EQ 'NRS' OR &NRS)                 @XM01125 06902800
&LEW     SETB  ('&MACRF(&I)' EQ 'LEW' OR &LEW)                 @YA41854 06909400
&NLW     SETB  ('&MACRF(&I)' EQ 'NLW' OR &NLW)                 @YA41854 06916000
&AMODE31 SETB  (('&MACRF(&I)' EQ 'AMODE31' OR &AMODE31) AND            X06922800
               (T'&RMODE31 EQ 'O'))                                @LPC 06942800
&R31E    SETB  (('&MACRF(&I)' EQ 'AMODE31' OR &R31E) AND               X06962800
               ('&RMODE31' NE ''))                                 @LPA 06982800
&A       SETA  &MKEY+&MADR+&MCNV+&MSEQ+&MSKP+&MDIR+&OUT+&IN+&NUB+&UBF+&*07002800
               NFX+&CFX+&DDN+&DSN+&NRM+&AIX+&NSR+&LSR+&GSR+&NCI+&ICI+&N*07052800
               DF+&DFR+&NIS+&SIS+&RST+&NRS+&LEW+&NLW+&AMODE31+&R31E     07086100
&A       SETA  &A+&RLS                                             @LQA 07102700
.*                                                             @YA41854 07119400
.*             &A CONTAINS THE NUMBER OF VSAM OPTIONS SPECIFIED         07152800
.*             &B CONTAINS THE NUMBER OF VTAM OPTIONS SPECIFIED         07202800
.*             &C CONTAINS THE NUMBER OF ERRORS                         07252800
.*             IF THEY EQUAL &I AT THIS POINT, THEN THE LAST            07302800
.*             OPTION SPECIFIED WAS A VALID VSAM OPTION                 07352800
         AIF   (&A+&B+&C EQ &I).A000600 IF NEW VSAM BIT SET CHK X04SVHS 07402800
.*                                      NEXT SUBPARAMETER               07452800
.*                                      ELSE CHECK VTAM OPTIONS X04SVHS 07502800
&LOGONF  SETB  ('&MACRF(&I)' EQ 'LOGON' OR &LOGONF)              X03004 07552800
&NLOGON  SETB  ('&MACRF(&I)' EQ 'NLOGON' OR &NLOGON)             X03004 07602800
&B       SETA  &LOGONF+&NLOGON                                  X04SVHS 07652800
         AIF   (&A+&B+&C EQ &I).A000700 IF NEW VTAM BIT SET CHK X04SVHS 07702800
.*                                      FOR AM=VTAM             X04SVHS 07752800
.*             IF &A + &B + &C DO NOT EQUAL &I AT THIS POINT, THEN THE  07802800
.*             LAST OPTION CHECKED WAS INVALID OR DUPLICATED A          07852800
.*             PREVIOUSLY CHECKED OPTION                                07902800
         IDAERMAC 5,MACRF,&MACRF(&I)    ISSUE ERROR MESSAGE        @L9C 07952800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 08002800
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 08052800
         AGO   .A000600                                                 08102800
.A000700 AIF   ('&AM' EQ 'VTAM').A000600 IF VTAM NOT SPECIFIED,         08152800
         IDAERMAC 20,&MACRF(&I),MACRF    ISSUE ERROR MESSAGE       @L9C 08202800
&IDACB01 SETB  1                         SET ERROR SWITCH        X03004 08252800
         AGO   .A000600                  CHECK NEXT OPTION      X04SVHS 08302800
.*                                                                      08352800
.*             THE FOLLOWING CODE CHECKS FOR MUTUALLY EXCLUSIVE         08402800
.*             OPTIONS SPECIFIED,AND IF ANY ARE FOUND, AN ERROR         08452800
.*             MESSAGE IS ISSUED AND THE ERROR SWITCH IS SET            08502800
.A000800 AIF   (NOT(&UBF AND &NUB)).A000900                     X04SVHS 08552800
         IDAERMAC 8,MACRF,UBF,NUB                                  @L9C 08602800
&IDACB01 SETB  1                                                        08652800
.A000900 AIF   (NOT(&LOGONF AND &NLOGON)).A001000               X04SVHS 08702800
         IDAERMAC 8,MACRF,LOGON,NLOGON                             @L9C 08752800
&IDACB01 SETB  1                                                 X03004 08802800
.A000950 AIF   (NOT(&RST AND &NRS)).A001000                    @XM01125 08852800
         IDAERMAC 8,MACRF,RST,NRS                                  @L9C 08902800
&IDACB01 SETB  1                        SET ERR SWITCH         @XM01125 08952800
.A001000 AIF   (NOT(&NFX AND &CFX)).A001100                     X04SVHS 09002800
         IDAERMAC 8,MACRF,NFX,CFX                                  @L9C 09052800
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09102800
.A001100 AIF   (NOT(&DDN AND &DSN)).A001200                     X04SVHS 09152800
         IDAERMAC 8,MACRF,DDN,DSN                                  @L9C 09202800
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09252800
.A001200 AIF   (NOT(&NRM AND &AIX)).A001300                     X04SVHS 09302800
         IDAERMAC 8,MACRF,NRM,AIX                                  @L9C 09352800
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09402800
.******** CHECK THAT GSR, LSR, NSR, AND RLS ARE MUTUALLY EXCLUSIVE @LQA 09410600
.A001300 AIF   (NOT(&NSR AND &GSR)).A001310                        @LQC 09418400
         IDAERMAC 8,MACRF,NSR,GSR                                  @LQA 09426200
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09434000
.A001310 AIF   (NOT(&NSR AND &LSR)).A001320                        @LQA 09441800
         IDAERMAC 8,MACRF,NSR,LSR                                  @LQA 09449600
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09457400
.A001320 AIF   (NOT(&NSR AND &RLS)).A001330                        @LQA 09465200
         IDAERMAC 8,MACRF,NSR,RLS                                  @LQA 09473000
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09480800
.A001330 AIF   (NOT(&GSR AND &LSR)).A001340                        @LQA 09488600
         IDAERMAC 8,MACRF,GSR,LSR                                  @LQA 09496400
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09504200
.A001340 AIF   (NOT(&GSR AND &RLS)).A001350                        @LQA 09512000
         IDAERMAC 8,MACRF,GSR,RLS                                  @LQA 09519800
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09527600
.A001350 AIF   (NOT(&LSR AND &RLS)).A001400                        @LQA 09535400
         IDAERMAC 8,MACRF,LSR,RLS                                  @LQA 09543200
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09551000
.******** CHECK THE OTHER MACRF SUBPARMS THAT ARE INVALID WITH RLS @LQA 09558800
.A001400 AIF   (NOT(&RLS AND &MCNV)).A001420                       @LQA 09578300
         IDAERMAC 8,MACRF,RLS,CNV                                  @LQA 09597800
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09605600
.*NOTE: RLS AND ADR ARE COMPATIBLE FOR ESDS                        @LQA 09609500
.A001420 AIF   (NOT(&RLS AND &ICI)).A001430                        @LQA 09613400
         IDAERMAC 8,MACRF,RLS,ICI                                  @LQA 09621200
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09629000
.A001430 AIF   (NOT(&RLS AND &AIX)).A001440                        @LQA 09636800
         IDAERMAC 8,MACRF,RLS,AIX                                  @LQA 09644600
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09652400
.A001440 AIF   (NOT(&RLS AND &UBF)).A001450                        @LQA 09660200
         IDAERMAC 8,MACRF,RLS,UBF                                  @LQA 09668000
&IDACB01 SETB  1                        SET ERR SWITCH             @LQA 09675800
.******** END OF CHECKING MACRF PARMS MUTUALLY EXCLUSIVE WITH RLS  @LQA 09683600
.A001450 AIF   (NOT(&NCI AND &ICI)).A001500                        @LQC 09691400
         IDAERMAC 8,MACRF,NCI,ICI                                  @L9C 09702800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 09752800
.A001500 AIF   (NOT(&NDF AND &DFR)).A001600                     X04SVHS 09802800
         IDAERMAC 8,MACRF,NDF,DFR                                  @L9C 09852800
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 09902800
.A001600 AIF   (NOT(&NIS AND &SIS)).A001700                     X04SVHS 09952800
         IDAERMAC 8,MACRF,NIS,SIS                                  @L9C 10002800
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 10052800
.*                                                                 @LPA 10077800
.A001700 AIF   (NOT(&LEW AND &NLW)).A001710                    @YA41854 10086100
         IDAERMAC 8,MACRF,LEW,NLW                              @YA41854 10094400
&IDACB01 SETB  1                        SET ERR SWITCH         @YA41854 10102700
.*                                                             @YA41854 10111000
.A001710 AIF   (NOT(&R31E)).A001725                            @YA41854 10119300
         IDAERMAC 26,AMODE31                                       @LPA 10127800
.*                                                                 @LPA 10152800
.A001725 AIF   ('&CALLER' EQ 'ACB').A001750                        @LPC 10177800
.*             IF CALLED BY DECLARATIVE, BYPASS CBMM PROCESSING         10202800
.*                                                                      10252800
&IDAVALC(&IDAENO) SETC '&MKEY&MADR&MCNV&MSEQ&MSKP&MDIR&IN&OUT&NUB&UBF&L*10302800
               OGONF&NLOGON.0&DDN&DSN&NRM&AIX&NSR&LSR&GSR&NCI&ICI&NDF&D*10352800
               FR&NIS&SIS&NFX&CFX&RST&NRS&LEW&NLW'             @YA41854 10402800
.*             SET GLOBAL ARRAY TO BE USED BY IDACB2 TO BUILD           10452800
.*             PARAMETER LIST                                           10502800
         AGO   .A001800                 BYPASS DECLARATIVE PROC X04SVHS 10552800
.A001750 ANOP                                                   X04SVHS 10602800
         AIF   ('&CALLER' NE 'ACB').A001800                     X04SVHS 10652800
.*             THE FOLLOWING CODE SETS DEFAULT VALUES FOR ACB           10702800
.*             DECLARATIVE.  THE DEFAULTS FOR CBM WILL BE SET AT        10752800
.*             EXECUTE TIME.                                            10802800
.*                                                                      10852800
&MKEY    SETB  (NOT(&MADR OR &MCNV) OR &MKEY)                   X04SVHS 10902800
.*             MKEY IS DEFAULT IF MADR OR MCNV ARE NOT SPECIFIED        10952800
&MSEQ    SETB  (NOT(&MSKP OR &MDIR) OR &MSEQ)                   X04SVHS 11002800
.*             MSEQ IS DEFAULT IF MSKP OR MDIR ARE NOT SPECIFIED        11052800
&IN      SETB  (NOT(&OUT) OR &IN)                               X04SVHS 11102800
.*             IN IS DEFAULT IF OUT IS NOT SPECIFIED            X04SVHS 11152800
&CFX     SETB  ((NOT &RLS) AND &CFX)                               @LQA 11169400
.*             IF RLS IS SPECIFIED, NFX IS ASSUMED                 @LQA 11186000
.*                                                                      11202800
.*             SET MACRF VALUES IN GLOBALS FOR ACB DECLARATIVE  X04SVHS 11252800
&IDAMAC1 SETC  '&MKEY&MADR&MCNV&MSEQ&MDIR&IN&OUT&UBF'           X04SVHS 11302800
&IDAMAC2 SETC  '000&MSKP&NLOGON&RST&DSN&AIX'                    X04SVHS 11352800
&IDAMAC3 SETC  '&NLW&LSR&GSR&ICI&DFR&SIS&CFX&AMODE31'          @YA41854 11402800
&IDAMAC4 SETC  '&RLS.0000000'                                      @LQA 11419400
&IDARLS  SETB  (&RLS EQ 1)              SET GLOBAL MACRF=RLS FLG   @LQA 11436000
         AGO   .A002200                 PROCESS CRA             X04SVHS 11452800
.********************************************************************** 11502800
.A001800 ANOP                                                   X04SVHS 11552800
.*                                      PASSWD                          11602800
         IDAVSCB3 ARG=&PASSWD,ARGNAME=PASSWD,KWTC=X'1E',MF=&MF @ZA34940 11652800
.********************************************************************** 11702800
.*                                      STRNO                           11752800
         IDAVSCB3 ARG=&STRNO,ARGNAME=STRNO,KWTC=X'20',MF=&MF   @ZA34940 11802800
.********************************************************************** 11852800
.*                                      USERPTR                @XM01129 11902800
         AIF ('&USERPTR' EQ '' OR '&USERPTR' EQ '0').A001850   @XM01129 11952800
         IDAVSCB3 ARG=&USERPTR,ARGNAME=USERPTR,KWTC=X'8C',     @ZA34940X12002800
               MF=&MF                                          @ZA34940 12052800
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '').A001825       @XM01129 12102800
.*                                   IF AM NOT VSAM OR NULL, ERROR      12152800
         AGO   .A001850                                        @XM01129 12202800
.A001825 IDAERMAC 24,USERPTR                                       @L9C 12252800
&IDACB01 SETB  1                                               @XM01129 12302800
.********************************************************************** 12352800
.A001850  ANOP                                                          12402800
.*                                      APPLID                          12452800
         IDAVSCB3 ARG=&APPLID,ARGNAME=APPLID,KWTC=X'41',       @ZA34940*12502800
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 12552800
.********************************************************************** 12602800
.*                                      RMODE31                    @LPA 12616400
         AIF   ('&RMODE31' EQ '').A001875     NO RMODE31 SPECIFIED @LPA 12630000
         IDACB3 ARG=&RMODE31,ARGNAME=RMODE31,KWTC=X'47',BIT=YES    @LPA 12643600
.*              INDRECT=YES,BIT=YES                                @LPA 12657200
&R31B    SETB  (('&RMODE31' EQ 'BUFF') OR ('&RMODE31' EQ 'ALL'))   @LPA 12670800
&R31C    SETB  ('&RMODE31' EQ 'CB' OR '&RMODE31' EQ 'ALL')         @LPA 12684400
&IDAVALC(&IDAENO) SETC '&R31B&R31C.00000000000000&Z16'             @LPA 12698000
.********************************************************************** 12711600
.*                                       AM                             12725200
.A001875 AIF   ('&AM' EQ '' OR '&CALLER' NE 'GEN').A002000         @LPC 12738800
.*             ARGUMENT CONTROL ENTRY IS ONLY BUILT FOR GENCB FOR AM    12752800
         IDAVSCB3 ARG=&AM,ARGNAME=AM,KWTC=X'40',BIT=YES        @ZA34940 12802800
&VSAM    SETB  ('&AM' EQ 'VSAM')                                X04SVHS 12852800
&VTAM    SETB  ('&AM' EQ 'VTAM')                                X04SVHS 12902800
         AIF   (&VSAM OR &VTAM).A001900                         X04SVHS 12952800
.*             CHECK FOR VALID OPTION                           X04SVHS 13002800
         IDAERMAC 5,AM,&AM                                         @L9C 13052800
&IDACB01 SETB  1                         SET ERROR SWITCH       X04SVHS 13102800
.A001900    ANOP                                                X04SVHS 13152800
&IDAVALC(&IDAENO) SETC '&VSAM&VTAM.00000000000000&Z16'          X04SVHS 13202800
.********************************************************************** 13252800
.A002000 ANOP                                                   X04SVHS 13302800
.*                                      MAREA                           13352800
         IDAVSCB3 ARG=&MAREA,ARGNAME=MAREA,KWTC=X'0E',MF=&MF   @ZA34940 13402800
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '' AND '&MAREA' NE        *13452800
               '').A002050                                      X04SVHS 13502800
.*                                      IF AM NOT VSAM OR NULL  X04SVHS 13552800
.*                                      ERROR                   X04SVHS 13602800
         AGO   .A002100                                         X04SVHS 13652800
.A002050 ANOP                                                   X04SVHS 13702800
         IDAERMAC 24,MAREA                                         @L9C 13752800
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 13802800
.********************************************************************** 13852800
.A002100 ANOP                                                   X04SVHS 13902800
.*                                        MLEN                  X04SVHS 13952800
         IDAVSCB3 ARG=&MLEN,ARGNAME=MLEN,KWTC=X'0F',MF=&MF     @ZA34940 14002800
         AIF   ('&AM' NE 'VSAM' AND '&AM' NE '' AND '&MLEN' NE         *14052800
               '').A002150                                      X04SVHS 14102800
.*                                      IF AM NOT EQUAL TO VSAM X04SVHS 14152800
.*                                      OR NULL, ERROR          X04SVHS 14202800
         AGO   .A002200                                         X04SVHS 14252800
.A002150 ANOP                                                   X04SVHS 14302800
         IDAERMAC 24,MLEN                                          @L9C 14352800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 14402800
.********************************************************************** 14452800
.A002200 ANOP                                                   X04SVHS 14502800
.*                                      CRA                             14552800
         AIF   ('&CRA' EQ '').A002350 *** CRA ***               X04SVHS 14602800
.*             IF CRA IS NULL, CHECK FOR CALLER = ACB           X04SVHS 14652800
&SCRA    SETB  ('&CRA' EQ 'SCRA')                              @XM07755 14702800
&UCRA    SETB  ('&CRA' EQ 'UCRA')                              @XM07755 14752800
         AIF   (&SCRA OR &UCRA).A002300 CHK FOR VALID OPTION    X04SVHS 14802800
         IDAERMAC 5,CRA,&CRA            ISSUE ERROR MESSAGE        @L9C 14852800
&IDACB01 SETB  1                        SET ERR SWITCH          X04SVHS 14902800
         AGO   .A002400                 BYPASSING PROCESSING KEYWORD    14952800
.*                                                              X04SVHS 15002800
.A002300 ANOP                                                   X04SVHS 15052800
         AIF   ('&CALLER' EQ 'ACB').A002375                     X04SVHS 15102800
.*             IF CALLER IS ACB BYPASS CBM PROCESSING           X04SVHS 15152800
         IDAVSCB3 ARG=&CRA,KWTC=X'59',BIT=YES                  @ZA34940 15202800
&IDAVALC(&IDAENO) SETC '&SCRA&UCRA.00000000000000&Z16'          X04SVHS 15252800
         AGO   .A002400                 BYPASS DECLARATIVE PROC X04SVHS 15302800
.A002350 ANOP                                                   X04SVHS 15352800
.*             AT THIS POINT, EITHER CRA IS NOT SPECIFIED, OR   X04SVHS 15402800
.*             CALLER = ACB                                     X04SVHS 15452800
         AIF   ('&CALLER' NE 'ACB').A002400                     X04SVHS 15502800
.*             IF CALLER NOT ACB, BYPASS DECLARATIVE PROCESSING X04SVHS 15552800
.A002375 ANOP                                                   X04SVHS 15602800
&IDAIFL1 SETC  '000&YES&SCRA&UCRA.00'   SET ACB INFLGS BYTE 1   X04SVHS 15652800
.*             ALL BIT KEYWORDS HAVE BEEN PROCESSED FOR DECLARATIVE     15702800
         MEXIT                                                  X04SVHS 15752800
.********************************************************************** 15802800
.A002400 ANOP                                                   X04SVHS 15852800
.*                                      BSTRNO                          15902800
         IDAVSCB3 ARG=&BSTRNO,ARGNAME=BSTRNO,KWTC=X'24',MF=&MF @ZA34940 15952800
.********************************************************************** 16002800
.*                                                                      16052800
         AIF   ('&CALLER' NE 'TEST').A003800                            16102800
.*                                                                      16152800
.*             THE FOLLOWING KEYWORDS ARE VALID FOR TESTCB ONLY         16202800
.*                                                                      16252800
.********************************************************************** 16302800
.*                                      ATRB                            16352800
         AIF   ('&ATRB' EQ '').A002800    *** ATRB ***                  16402800
         IDAVSCB3 ARG=&ATRB,ARGNAME=ATRB,KWTC=X'01',MF=&MF,    @ZA34940*16452800
               INDRECT=YES,BIT=YES                             @ZA34940 16502800
         AIF   ('&ATRB(1)' EQ '*').A002800                      X04SVHS 16552800
.*             IF INDIRECT ADDRESS WAS SPECIFIED, VALUE ARRAY(&IDAVALC) 16602800
.*             WAS SET IN IDAVSCB3                             @ZA34940 16652800
&I       SETA  0                        ZERO INDEX INTO LIST            16702800
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 16752800
.A002500 ANOP                                                           16802800
&I       SETA  &I+1                     BUMP INDEX INTO LIST            16852800
         AIF   (&I GT N'&ATRB).A002600  HAVE ALL OPTIONS BEEN CHECKED   16902800
&ESDS    SETB  ('&ATRB(&I)' EQ 'ESDS' OR &ESDS)                 X04SVHS 16952800
&KSDS    SETB  ('&ATRB(&I)' EQ 'KSDS' OR &KSDS)                 X04SVHS 17002800
&WCK     SETB  ('&ATRB(&I)' EQ 'WCK' OR &WCK)                   X04SVHS 17052800
&SSWD    SETB  ('&ATRB(&I)' EQ 'SSWD' OR &SSWD)                 X04SVHS 17102800
&REPL    SETB  ('&ATRB(&I)' EQ 'REPL' OR &REPL)                 X04SVHS 17152800
&RRDS    SETB  ('&ATRB(&I)' EQ 'RRDS' OR &RRDS)                 X04SVHS 17202800
&SPAN    SETB  ('&ATRB(&I)' EQ 'SPAN' OR &SPAN)                 X04SVHS 17252800
&UNQ     SETB  ('&ATRB(&I)' EQ 'UNQ' OR &UNQ)                   X04SVHS 17302800
         AIF   (&ESDS+&KSDS+&WCK+&SSWD+&REPL+&RRDS+&SPAN+&UNQ+&C EQ &I)*17352800
               .A002500                 CHK FOR VALID OPTION    X04SVHS 17402800
.*             IF A NEW BIT WAS NOT SET, THEN LAST OPTION CHECKED       17452800
.*             IS INVALID OR DUPLICATES A PREVIOUSLY SPEC OPTION        17502800
         IDAERMAC 5,ATRB,&ATRB(&I)      ISSUE ERROR MESSAGE        @L9C 17552800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 17602800
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 17652800
         AGO   .A002500                                         X04SVHS 17702800
.A002600 AIF   (NOT(&ESDS AND &KSDS)).A002700                           17752800
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     17802800
         IDAERMAC 8,ATRB,ESDS,KSDS      ISSUE ERROR MESSAGE        @L9C 17852800
&IDACB01 SETB  1                        SET ERROR SWITCH                17902800
.A002700 ANOP                                                           17952800
&IDAVALC(&IDAENO) SETC '&KSDS&ESDS&WCK&SSWD&REPL&RRDS&SPAN&UNQ.00000000*18002800
               &Z16'                                                    18052800
.********************************************************************** 18102800
.A002800 ANOP                                                           18152800
.*                                      AVSPAC                          18202800
         IDAVSCB3 ARG=&AVSPAC,ARGNAME=AVSPAC,KWTC=X'02',MF=&MF @ZA34940 18252800
.********************************************************************** 18302800
.*                                      BUFNO                           18352800
         IDAVSCB3 ARG=&BUFNO,ARGNAME=BUFNO,KWTC=X'06',MF=&MF   @ZA34940 18402800
.********************************************************************** 18452800
.*                                      CINV                            18502800
         IDAVSCB3 ARG=&CINV,ARGNAME=CINV,KWTC=X'08',MF=&MF     @ZA34940 18552800
.********************************************************************** 18602800
.*                                      ENDRBA                          18652800
         IDAVSCB3 ARG=&ENDRBA,ARGNAME=ENDRBA,KWTC=X'0A',MF=&MF @ZA34940 18702800
.********************************************************************** 18752800
.*                                      ERROR                           18802800
         IDAVSCB3 ARG=&ERROR,ARGNAME=ERROR,KWTC=X'0B',MF=&MF   @ZA34940 18852800
.********************************************************************** 18902800
.*                                      FS                              18952800
         IDAVSCB3 ARG=&FS,ARGNAME=FS,KWTC=X'0D',MF=&MF         @ZA34940 19002800
.********************************************************************** 19052800
.*                                      KEYLEN                          19102800
         IDAVSCB3 ARG=&KEYLEN,ARGNAME=KEYLEN,KWTC=X'10',MF=&MF @ZA34940 19152800
.********************************************************************** 19202800
.*                                      LRECL                           19252800
         IDAVSCB3 ARG=&LRECL,ARGNAME=LRECL,KWTC=X'11',MF=&MF   @ZA34940 19302800
.********************************************************************** 19352800
.*                                      NCIS                            19402800
         IDAVSCB3 ARG=&NCIS,ARGNAME=NCIS,KWTC=X'13',MF=&MF     @ZA34940 19452800
.********************************************************************** 19502800
.*                                      NDELR                           19552800
         IDAVSCB3 ARG=&NDELR,ARGNAME=NDELR,KWTC=X'14',MF=&MF   @ZA34940 19602800
.********************************************************************** 19652800
.*                                      NEXCP                           19702800
         IDAVSCB3 ARG=&NEXCP,ARGNAME=NEXCP,KWTC=X'15',MF=&MF   @ZA34940 19752800
.********************************************************************** 19802800
.*                                      NEXT                            19852800
         IDAVSCB3 ARG=&NEXT,ARGNAME=NEXT,KWTC=X'16',MF=&MF     @ZA34940 19902800
.********************************************************************** 19952800
.*                                      NINSR                           20002800
         IDAVSCB3 ARG=&NINSR,ARGNAME=NINSR,KWTC=X'17',MF=&MF   @ZA34940 20052800
.********************************************************************** 20102800
.*                                      NIXL                            20152800
         IDAVSCB3 ARG=&NIXL,ARGNAME=NIXL,KWTC=X'18',MF=&MF     @ZA34940 20202800
.********************************************************************** 20252800
.*                                      &NLOGR                          20302800
         IDAVSCB3 ARG=&NLOGR,ARGNAME=NLOGR,KWTC=X'19',MF=&MF   @ZA34940 20352800
.********************************************************************** 20402800
.*                                      NRETR                           20452800
         IDAVSCB3 ARG=&NRETR,ARGNAME=NRETR,KWTC=X'1A',MF=&MF   @ZA34940 20502800
.********************************************************************** 20552800
.*                                      NSSS                            20602800
         IDAVSCB3 ARG=&NSSS,ARGNAME=NSSS,KWTC=X'1B',MF=&MF     @ZA34940 20652800
.********************************************************************** 20702800
.*                                      NUPDR                           20752800
         IDAVSCB3 ARG=&NUPDR,ARGNAME=NUPDR,KWTC=X'1C',MF=&MF   @ZA34940 20802800
.********************************************************************** 20852800
.*                                                                      20902800
         AIF   ('&OFLAGS' EQ '').A003000 *** OFLAGS ***                 20952800
         IDAVSCB3 ARG=&OFLAGS,ARGNAME=OFLAGS,KWTC=X'1D',       @ZA34940*21002800
               MF=&MF,BIT=YES,INDRECT=YES                      @ZA34940 21052800
         AIF   ('&OFLAGS(1)' EQ '*').A003000                            21102800
.*             IF INDIRECT ADDRESS WAS SPECIFIED, VALUE ARRAY(&IDAVALC) 21152800
.*             WAS SET IN IDAVSCB3                             @ZA34940 21202800
&OPEN    SETB  ('&OFLAGS' EQ 'OPEN')                            X04SVHS 21252800
         AIF   (&OPEN).A002900                                  X04SVHS 21302800
.*             CHECK FOR VALID OPTION SPECIFIED                         21352800
         IDAERMAC 3,OFLAGS,&OFLAGS                                 @L9C 21402800
&IDACB01 SETB  1                                                        21452800
.A002900 ANOP                                                           21502800
&IDAVALC(&IDAENO) SETC '&OPEN.000000000000000&Z16'              X04SVHS 21552800
.********************************************************************** 21602800
.A003000 ANOP                                                   X04SVHS 21652800
.*                                      RKP                             21702800
         IDAVSCB3 ARG=&RKP,ARGNAME=RKP,KWTC=X'1F',MF=&MF       @ZA34940 21752800
.********************************************************************** 21802800
.*                                      AIXRKP                          21852800
         IDAVSCB3 ARG=&AIXRKP,ARGNAME=AIXRKP,KWTC=X'3C',MF=&MF @ZA34940 21902800
.********************************************************************** 21952800
.*                                      STMST                           22002800
         AIF   ('&STMST' EQ '').A003300  *** STMST ***                  22052800
         AIF   ('&STMST(1)' EQ '*').A003100                             22102800
.*                                      STMST MUST BE INDIRECT ADDRESS  22152800
         IDAERMAC 3,STMST,&STMST        ELSE, ISSUE ERROR MSG      @L9C 22202800
         AGO   .A003300                                                 22252800
.A003100 ANOP                                                           22302800
         IDAVSCB3 ARG=&STMST,ARGNAME=STMST,KWTC=X'23',MF=&MF, @ZA34940 *22352800
               INDRECT=YES                                    @ZA34940  22402800
.*                                                              X04SVHS 22452800
&IDAELEN(&IDAENO) SETA 8                                        X04SVHS 22502800
.********************************************************************** 22552800
.*                                      OPENOBJ                         22602800
.A003300 ANOP                                                   X04SVHS 22652800
         AIF   ('&OPENOBJ' EQ '').A003800 *** OPENOBJ ***       X04SVHS 22702800
&I       SETA  0                        CLEAR SUBPARM CTR       X04SVHS 22752800
&C       SETA  0                        ZERO ERROR COUNTER      X04SVHS 22802800
.A003400 ANOP                                                   X04SVHS 22852800
&I       SETA  &I+1                     BUMP SUBPARM CTR        X04SVHS 22902800
         AIF   (&I GT N'&OPENOBJ).A003500 CHK FOR END OF LIST   X04SVHS 22952800
&PATH    SETB  ('&OPENOBJ(&I)' EQ 'PATH' OR &PATH)              X04SVHS 23002800
&BASE    SETB  ('&OPENOBJ(&I)' EQ 'BASE' OR &BASE)              X04SVHS 23052800
&AIX     SETB  ('&OPENOBJ(&I)' EQ 'AIX' OR &AIX)                X04SVHS 23102800
         AIF   (&PATH+&BASE+&AIX+&C EQ &I).A003400              X04SVHS 23152800
.*                                      CHK FOR NEW BIT SET     X04SVHS 23202800
         IDAERMAC 5,OPENOBJ,&OPENOBJ(&I)                           @L9C 23252800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 23302800
&C       SETA  &C+1                     BUMP ERROR COUNTER      X04SVHS 23352800
         AGO   .A003400                                         X04SVHS 23402800
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS             X04SVHS 23452800
.A003500 AIF   (NOT(&PATH AND &BASE)).A003600                   X04SVHS 23502800
         IDAERMAC 8,OPENOBJ,PATH,BASE                              @L9C 23552800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 23602800
.A003600 AIF   (NOT(&PATH AND &AIX)).A003700                    X04SVHS 23652800
         IDAERMAC 8,OPENOBJ,PATH,AIX                               @L9C 23702800
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 23752800
.A003700 ANOP                                                   X04SVHS 23802800
         IDAVSCB3 ARG=&OPENOBJ,KWTC=X'21',BIT=YES              @ZA34940 23852800
&IDAVALC(&IDAENO) SETC '&AIX&PATH&BASE.0000000000000&Z16'      @XM07772 23902800
.********************************************************************** 23952800
.A003800 ANOP                                                   X04SVHS 24002800
         MEND                                                           24052800
