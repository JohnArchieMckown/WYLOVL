*/**** START OF SPECIFICATIONS **************************************** 00001000
*                                                                     * 00002000
*                                                                     * 00003000
*01* MACRO NAME:  IXCARM                                -03/30/00-<1> * 00004000
*                                                                     * 00005000
*                                                                     * 00006000
*01* DESCRIPTIVE NAME:  Automatic Restart Manager Services            * 00007000
*                                                                     * 00008000
*01* PROPRIETARY STATEMENT:                                           * 00009000
*                                                                     * 00010000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00011000
*     5647-A01 (C) COPYRIGHT IBM CORP. 1994, 2000                     * 00013000
*                                                                     * 00015000
* STATUS= JBB6609                                                     * 00016000
*                                                                     * 00017000
*                                                                     * 00018000
*                                                                     * 00019000
*01* FUNCTION:                                                        * 00020000
*                                                                     * 00021000
*                                                                     * 00022000
*      The Automatic Restart Manager service routine is given control * 00023000
*      from the IXCARM macro to:                                      * 00024000
*                                                                     * 00025000
*                                                                     * 00026000
*      o   Register a user of Automatic Restart Manager Services      * 00027000
*                                                                     * 00028000
*      o   Wait until predecessor elements have been restarted, if    * 00029000
*          applicable                                                 * 00030000
*                                                                     * 00031000
*      o   Mark a user of Automatic Restart Manager Services as READY * 00032000
*          to accept work                                             * 00033000
*                                                                     * 00034000
*      o   Deregister a user of Automatic Restart Manager Services    * 00035000
*                                                                     * 00036000
*      o   Associate a user of Automatic Restart Manager Services     * 00037000
*          with another user, for takeover/restart purposes.          * 00038000
*                                                                     * 00039000
*                                                                     * 00040000
*                                                                     * 00041000
*      The IXCARM macro will complete the parameter list with caller  * 00042000
*      provided data and generate a stacking, space switching,        * 00043000
*      program call to the IXCARM service routine.                    * 00044000
*                                                                     * 00045000
*      The IXCARM macro is provided in list, execute, and standard    * 00046000
*      form.  The list form accepts no variable parameters and is     * 00047000
*      used only to reserve space for the IXCARM parameter list.  The * 00048000
*      standard form is provided for use with routines which do not   * 00049000
*      require reentrant code.  The execute form is provided for use  * 00050000
*      with the list format for reentrant routines.  The IXCARM macro * 00051000
*      is provided in PL/X and assembler formats.                     * 00052000
*                                                                     * 00053000
*      The parameter list and the data to which it points must be in  * 00053700
*      the caller's primary address space or be addressable by a      * 00054400
*      public entry in caller's dispatchable unit access list.        * 00055100
*                                                                     * 00055200
*      Only one IXCARM request at a time can be in process from a     * 00055300
*      given address space. IXCARM requests received while an earlier * 00055400
*      one is still in process will be rejected.                      * 00055500
*                                                                     * 00056000
*      This service is classified as a General Use Programming        * 00057000
*      Interface (GUPI).                                              * 00058000
*                                                                     * 00059000
*                                                                     * 00060000
*                                                                     * 00061000
*      INPUT REGISTERS:                                               * 00062000
*                                                                     * 00063000
*                                                                     * 00064000
*                          GR0-GR1     reserved                       * 00065000
*                                                                     * 00066000
*                          GR2-GR13    undefined                      * 00067000
*                                                                     * 00068000
*                          GR14-GR15   reserved                       * 00069000
*                                                                     * 00070000
*                          AR0-AR1     reserved                       * 00071000
*                                                                     * 00072000
*                          AR2-AR13    undefined                      * 00073000
*                                                                     * 00074000
*                          AR14-AR15   reserved                       * 00075000
*                                                                     * 00076000
*                                                                     * 00077000
*                                                                     * 00078000
*      OUTPUT ENVIRONMENT: Same as on entry                           * 00079000
*                                                                     * 00080000
*      OUTPUT REGISTERS:                                              * 00081000
*                                                                     * 00082000
*                                                                     * 00083000
*                          GR0         unpredictable if GR15 = 0, or  * 00084000
*                                      reason code based on GR15      * 00085000
*                                                                     * 00086000
*                          GR1         unpredictable                  * 00087000
*                                                                     * 00088000
*                          GR2-GR14    unchanged                      * 00090000
*                                                                     * 00092000
*                          GR15        return code                    * 00093000
*                                                                     * 00094000
*                          AR0-AR1     unpredictable                  * 00095000
*                                                                     * 00096000
*                          AR2-AR14    unchanged                      * 00097000
*                                                                     * 00098000
*                          AR15        unpredictable                  * 00098500
*                                                                     * 00099000
*                                                                     * 00099500
*                                                                     * 00100000
*                                                                     * 00101000
*                                                                     * 00101200
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00101400
*                                                                     * 00101600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00101800
*                                                                     * 00102000
*01* ENVIRONMENT:                                                     * 00105000
*                                                                     * 00106000
*                                                                     * 00107000
*      Dispatchable unit mode: Task mode.                             * 00108000
*                                                                     * 00108200
*                        This macro must be issued from an address    * 00108400
*                        space for either a started task or batch     * 00108600
*                        job.                                         * 00108800
*                                                                     * 00109000
*      Minimum authorization:                                         * 00109100
*                                                                     * 00109200
*                                                                     * 00109300
*                        o   Supervisor state or PKM allowing keys    * 00109400
*                            0-7.                                     * 00109500
*                                                                     * 00109600
*                        o   If the caller has SAF authority, Problem * 00109700
*                            state and non-PKM system key is          * 00109800
*                            supported for all request types.  SAF    * 00109900
*                            authorized to the entity                 * 00110000
*                            IXCARM.elemtype.elementname is required. * 00110100
*                            If ELEMTYPE is not specified, then the   * 00110200
*                            entity defaults to                       * 00110300
*                            IXCARM.DEFAULT.elementname.              * 00110400
*                                                                     * 00110500
*                                                                     * 00110600
*                                                                     * 00112000
*      AMODE:            31-bit.                                      * 00113000
*                                                                     * 00114000
*      ASC mode:         Primary or Access Register.                  * 00115000
*                                                                     * 00116000
*                        If in Access Register ASC mode, specify      * 00117000
*                        SYSSTATE ASCENV=AR before invoking this      * 00118000
*                        macro.                                       * 00119000
*                                                                     * 00120000
*                        Primary address space is not necessarily     * 00121000
*                        equal to the home address space.  There is   * 00122000
*                        no restriction on the secondary address      * 00123000
*                        space.                                       * 00124000
*                                                                     * 00125000
*                        The primary address space can be either      * 00126000
*                        swappable or non-swappable.                  * 00127000
*                                                                     * 00128000
*      Serialization:                                                 * 00129000
*                                                                     * 00130000
*                        Enabled for I/O and external interrupts      * 00131000
*                                                                     * 00132000
*                        No locks held                                * 00133000
*                                                                     * 00134000
*                        No EUT FRR set                               * 00135000
*                                                                     * 00136000
*                                                                     * 00137000
*                                                                     * 00138000
*01* SYNTAX:                                                          * 00139000
*                                                                     * 00140000
*[xlabel]  IXCARM    REQUEST=REGISTER                                * 00140900
*                  |     ,ELEMENT=xelement                            * 00141800
*                  |    [,EVENTEXIT=xeventexit|NO_EVENTEXIT         * 00142600
*                  |        [,EVENTEXITPL                             * 00143400
*                  |                      =xeventexitpl|NO_EVENTEXIT * 00144200
*                  |                      PL                         * 00145000
*                  |             ,EXITPLLEN=xexitpllen]]              * 00145800
*                  |    [,STARTTXT=xstarttxt|NO_STARTTXT            * 00146600
*                  |         ,STARTTXTLEN=xstarttxtlen]               * 00147400
*                  |    [,ELEMTYPE=xelemtype|NO_ELEMTYPE]           * 00148200
*                  |    [,TERMTYPE=ALLTERM|ELEMTERM|SYSTERM]        * 00148400
*                  |   [,ELEMBIND=CURJOB                             * 00148600
*                  |   |    [,RMTOKEN=xrmtoken|NO_RMTOKEN]]         * 00148800
*                  |   [,ELEMBIND=CURSYS                             * 00149000
*                  |         ,RMTOKEN=xrmtoken]                       * 00149200
*                  |    [,RESTARTTIMEOUT=NORM|LONG]                 * 00149800
*                  |    [,ANSAREA=xansarea]                           * 00150600
*                   ,REQUEST=WAITPRED                                * 00152000
*                  |    [,RMTOKEN=xrmtoken|NO_RMTOKEN]              * 00152500
*                   ,REQUEST=READY                                   * 00153000
*                  |    [,RMTOKEN=xrmtoken|NO_RMTOKEN]              * 00153500
*                   ,REQUEST=DEREGISTER                              * 00154000
*                  |    [,RMTOKEN=xrmtoken|NO_RMTOKEN]              * 00154500
*                   ,REQUEST=ASSOCIATE                               * 00155000
*                       [,RMTOKEN=xrmtoken|NO_RMTOKEN]              * 00155500
*                        ,TELEMENT=xtelement                          * 00156000
*                   [,RETCODE=xretcode]                               * 00157000
*                   [,RSNCODE=xrsncode]                               * 00158000
*                   [,PLISTVER=xplistver|IMPLIED_VERSION]           * 00158500
*                  [,MF=S]                                           * 00159000
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 00160000
*                  [,MF=(E,xmfctrl,COMPLETE)]                      * 00161500
*                                                                     * 00163000
*                                                                     * 00164000
*      Where:                                                         * 00165000
*                                                                     * 00166000
*                                                                     * 00167000
*      [xlabel]                                                       * 00168000
*          is an optional symbol, starting in column 1, that is the   * 00169000
*          name on the IXCARM macro invocation.  The name must        * 00170000
*          conform to the rules for an ordinary assembler language    * 00171000
*          symbol.                                                    * 00172000
*          DEFAULT: No name.                                          * 00173000
*                                                                     * 00173100
*                                                                     * 00173200
*                                                                     * 00173300
*                                                                     * 00173400
*      REQUEST=REGISTER|WAITPRED|READY|DEREGISTER|ASSOCIATE         * 00178000
*          is a required keyword input that indicates the requested   * 00179000
*          function to be performed.                                  * 00180000
*                                                                     * 00181000
*                                                                     * 00182000
*          REQUEST=REGISTER                                           * 00183000
*              requests registration (or re-registration) of a user.  * 00184000
*                                                                     * 00185000
*                                                                     * 00186000
*              ELEMENT=xelement                                       * 00187000
*                  is the name (RS-type), or address in register      * 00188000
*                  (2)-(12), of a required 16 character input that    * 00189000
*                  contains the Element Name of the Automatic Restart * 00190000
*                  Manager user being registered.  The element name   * 00191000
*                  can be made up of only the 26 upper-case           * 00192000
*                  alphabetic characters, the numbers 0 through 9,    * 00193000
*                  the three national characters (dollar sign, pound  * 00193500
*                  sign, and at sign) and an underscore.  The first   * 00194000
*                  character must be either alphabetic or a national  * 00194500
*                  character.  The element name must be 16 characters * 00195000
*                  long, padded on the right with blanks if           * 00195500
*                  necessary.                                         * 00196000
*                                                                     * 00196600
*                  An element name must be unique across the sysplex. * 00197200
*                                                                     * 00197800
*                                                                     * 00199000
*                                                                     * 00200000
*                                                                     * 00201000
*              [EVENTEXIT=xeventexit|NO_EVENTEXIT                   * 00203000
*                  is the name (RS-type), or address in register      * 00204000
*                  (2)-(12), of an optional 8 character input that    * 00205000
*                  contains the name of the Event Exit routine to be  * 00206000
*                  given control when certain events occur to the     * 00207000
*                  element.  The Event Exit may be used to perform    * 00208000
*                  specialized processing for the element.            * 00209000
*                                                                     * 00210000
*                  The Event Exit must be contained in the authorized * 00211000
*                  Linklib concatenation or LPA (not Steplib or       * 00212000
*                  Tasklib) of both the system where the REGISTER     * 00213000
*                  service was invoked and any potential target       * 00214000
*                  restart systems. The Event Exit will be invoked    * 00215000
*                  via a BALR/BAKR sequence of instructions.          * 00216000
*                                                                     * 00217000
*                  The Event-Exit name must be 8 characters long,     * 00218000
*                  padded on the right with blanks if necessary.      * 00219000
*                  DEFAULT: NO_EVENTEXIT                              * 00220000
*                                                                     * 00221000
*                                                                     * 00222000
*                  [EVENTEXITPL=xeventexitpl|NO_EVENTEXITPL         * 00223000
*                      is the name (RS-type), or address in register  * 00224000
*                      (2)-(12), of an optional character input field * 00225000
*                      that is the Event Exit (EVENTEXIT) parameter   * 00226000
*                      list.  If the IXCARM invocation is in AR ASC   * 00226500
*                      mode, this parameter list can be in either the * 00227000
*                      primary address space or in an address/data    * 00227500
*                      space that is addressable through a public     * 00228000
*                      entry on the caller's DU-AL.                   * 00228500
*                                                                     * 00229000
*                      This parameter list contains data that will be * 00229500
*                      passed to the Event-Exit routine whenever it   * 00230000
*                      runs.  It should not contain data that is      * 00230500
*                      MVS-image dependent (such as addresses)        * 00231000
*                      because the exit may run on another MVS image  * 00231500
*                      (since ARM may restart the element on another  * 00232000
*                      image).                                        * 00232500
*                      DEFAULT: NO_EVENTEXITPL                        * 00234000
*                                                                     * 00235000
*                                                                     * 00236000
*                      EXITPLLEN=xexitpllen]]                         * 00237000
*                          is the name (RS-type), or address in       * 00238000
*                          register (2)-(12), of a required fullword  * 00239000
*                          input variable that contains the length of * 00240000
*                          the Event Exit (EVENTEXIT) parameter list. * 00241000
*                          The parameter list may be 0 to 255 bytes   * 00242000
*                          in length.                                 * 00243000
*                                                                     * 00247000
*                                                                     * 00248000
*                                                                     * 00249000
*                                                                     * 00250000
*                                                                     * 00251000
*                                                                     * 00251200
*                                                                     * 00251400
*                                                                     * 00251600
*              [STARTTXT=xstarttxt|NO_STARTTXT                      * 00252000
*                  is the name (RS-type), or address in register      * 00253000
*                  (2)-(12), of an optional character input variable  * 00254000
*                  that contains the text of the command to be used   * 00255000
*                  to restart this element.  If the IXCARM invocation * 00255400
*                  is in AR ASC mode, this variable can be in either  * 00255800
*                  the primary address space or in an address/data    * 00256200
*                  space that is addressable through a public entry   * 00256600
*                  on the caller's DU-AL.                             * 00257000
*                                                                     * 00257400
*                  If this parameter is specified, it will take       * 00257800
*                  precedence over the Automatic Restart Manager's    * 00258100
*                  reuse of the Start command that most recently      * 00258400
*                  started this element, which is referred to as      * 00258700
*                  persistent restart text.  A command specified via  * 00259000
*                  the STARTTXT parameter can be overridden by a      * 00259300
*                  RESTART_METHOD specified for the element in the    * 00259600
*                  active ARM policy, unless the RESTART_METHOD       * 00259900
*                  defaults to or specifies PERSIST.  If the STARTTXT * 00260200
*                  parameter is specified, the length of the text     * 00260500
*                  must be specified via the STARTTXTLEN parameter.   * 00260800
*                                                                     * 00261400
*                  The STARTTXT parameter is valid only for started   * 00261800
*                  tasks. If specified with a Register request from a * 00262200
*                  batch job, the registration request will be        * 00262600
*                  rejected.                                          * 00263000
*                                                                     * 00263400
*                  A command provided via the STARTTXT parameter      * 00263800
*                  cannot contain symbolic-substitution parameters    * 00264200
*                  (such as &SYSNAME).                                * 00264600
*                  DEFAULT: NO_STARTTXT                               * 00266000
*                                                                     * 00267000
*                                                                     * 00268000
*                  STARTTXTLEN=xstarttxtlen]                          * 00269000
*                      is the name (RS-type), or address in register  * 00270000
*                      (2)-(12), of a required fullword input         * 00271200
*                      variable that contains the length of the       * 00272400
*                      command specified in the STARTTXT parameter.   * 00273600
*                      This command may be 1 to 126 bytes in length.  * 00274800
*                      If the length is 0, the STARTTXT will be       * 00276000
*                      ignored. This parameter is ignored if STARTTXT * 00277200
*                      is not specified.  The default value of 0 is   * 00277600
*                      used only when STARTTXT(NO_STARTTXT) is        * 00278000
*                      specified or when the STARTTXT parameter       * 00278400
*                      defaults to NO_STARTTXT.                       * 00278800
*                      DEFAULT: 0                                     * 00279200
*                                                                     * 00280000
*                                                                     * 00281000
*                                                                     * 00282000
*                                                                     * 00283000
*                                                                     * 00283300
*                                                                     * 00283600
*              [ELEMTYPE=xelemtype|NO_ELEMTYPE]                     * 00284000
*                  is the name (RS-type), or address in register      * 00285000
*                  (2)-(12), of an optional 8 character input         * 00286000
*                  variable that contains the element-type name to be * 00287000
*                  associated with this user. The element type name   * 00288000
*                  must be 8 characters long, padded on the right     * 00289000
*                  with blanks if necessary.  The element type name   * 00289200
*                  can be made up of only the 26 upper-case           * 00289400
*                  alphabetic characters, the numbers 0 through 9,    * 00289600
*                  and the three national characters (dollar sign,    * 00289800
*                  pound sign, and at sign). The first character must * 00290000
*                  be either alphabetic or a national character.      * 00290200
*                                                                     * 00290400
*                  Multiple elements can register with the same       * 00290600
*                  element type.                                      * 00290800
*                                                                     * 00291000
*                  The element type has two purposes:  a) to          * 00291800
*                  facilitate the assigning of a "level" which is     * 00292600
*                  used to sequence the restarts of multiple elements * 00293400
*                  during ARM restarts after a system termination;    * 00294200
*                  and b) to communicate the element type to          * 00295000
*                  listeners of the ARM ENF Code 38 for events that   * 00295800
*                  pertain to this element (e.g., the element has     * 00296600
*                  started).                                          * 00297400
*                                                                     * 00299000
*                  IBM reserves the use of ELEMTYPEs starting with    * 00300000
*                  the characters A through I and with "SYS" for IBM  * 00301000
*                  use.  The following ELEMTYPE values are assigned:  * 00302000
*                                                                     * 00303000
*                                                                     * 00304000
*                  SYSLVL0   Elements to be restarted in level 0.     * 00304100
*                                                                     * 00304200
*                  SYSIRLM   IRLM related elements to be restarted in * 00304300
*                            level 0.                                 * 00304400
*                                                                     * 00304500
*                  SYSLVL1   Elements to be restarted in level 1.     * 00304600
*                                                                     * 00304700
*                  SYSDB2    DB2 related elements to be restarted in  * 00305000
*                            level 1.                                 * 00306000
*                                                                     * 00307000
*                  SYSIMS    IMS related elements to be restarted in  * 00308000
*                            level 1.                                 * 00309000
*                                                                     * 00310000
*                  SYSTCPIP  TCPIP related elements to be restarted   * 00310200
*                            in level 1.                              * 00310400
*                                                                     * 00310600
*                  SYSVTAM   VTAM related elements to be restarted in * 00311000
*                            level 1.                                 * 00312000
*                                                                     * 00313000
*                  SYSLVL2   Elements to be restarted in level 2.     * 00316500
*                                                                     * 00316600
*                  SYSCICS   CICS related elements to be restarted in * 00316700
*                            level 2.                                 * 00316800
*                                                                     * 00316900
*                  SYSMQCH   MQ Series channel initiator related      * 00317300
*                            elements to be restarted in level 2.     * 00317400
*                                                                     * 00317500
*                  SYSMQMGR  MQ Series queue manager related elements * 00317600
*                            to be restarted in level 2.              * 00317700
*                                                                     * 00317800
*                  SYSLVL3   Elements to be restarted in level 3.     * 00317900
*                                                                     * 00318000
*                  SYSCB     Component Broker related elements to be  * 00318100
*                            restarted in level 3.                    * 00318200
*                                                                     * 00318300
*                                                                     * 00319000
*                                                                     * 00319500
*                  The elements will be restarted in the specified    * 00320000
*                  level unless overridden by the RESTART_ORDER       * 00321000
*                  specified in the active Automatic Restart Manager  * 00322000
*                  policy.                                            * 00323000
*                  DEFAULT: NO_ELEMTYPE                               * 00324000
*                                                                     * 00325000
*                                                                     * 00326000
*                                                                     * 00327000
*                                                                     * 00328000
*              [TERMTYPE=ALLTERM|ELEMTERM|SYSTERM]                  * 00329000
*                  is an optional keyword input variable that         * 00330000
*                  specifies the type of termination for which this   * 00330700
*                  element may be restarted. A specification of       * 00331400
*                  TERMTYPE for this element in the active ARM policy * 00332100
*                  will override this keyword except in those cases   * 00332800
*                  where the policy override is ignored.  A policy    * 00333500
*                  specification of TERMTYPE=ELEMTERM will be ignored * 00334200
*                  when the IXCARM macro specifies ELEMBIND=CURSYS.   * 00334900
*                  DEFAULT: ALLTERM                                   * 00336000
*                                                                     * 00337000
*                                                                     * 00338000
*                  TERMTYPE=ALLTERM                                   * 00338900
*                      indicates that the Automatic Restart manager   * 00339800
*                      is to restart this element for all unexpected  * 00342000
*                      failures as appropriate.  The ELEMBIND keyword * 00344200
*                      determines which types of failures are         * 00346400
*                      appropriate to restart the element.            * 00348600
*                                                                     * 00351000
*                  TERMTYPE=ELEMTERM                                  * 00352000
*                      indicates that the Automatic Restart manager   * 00352100
*                      is to restart this element when the element    * 00352200
*                      fails but not when the system on which the     * 00352300
*                      element is registered is removed from the      * 00352400
*                      sysplex or unexpectedly terminates.            * 00352500
*                      TERMTYPE=ELEMTERM cannot be specified with     * 00352600
*                      ELEMBIND=CURSYS.                               * 00352700
*                                                                     * 00352800
*                  TERMTYPE=SYSTERM                                   * 00352900
*                      indicates that the Automatic Restart manager   * 00353000
*                      is to restart this element when the system on  * 00353100
*                      which the element is registered is removed     * 00353200
*                      from the sysplex or unexpectedly terminates,   * 00353300
*                      but not when the element unexpectedly          * 00353400
*                      terminates.                                    * 00353500
*                                                                     * 00353600
*                                                                     * 00353700
*                                                                     * 00353800
*                                                                     * 00353900
*                                                                     * 00354000
*                                                                     * 00354100
*              [ELEMBIND=CURJOB|CURSYS]                             * 00354200
*                  is an optional keyword input variable that         * 00354300
*                  specifies the relationship between the element and * 00354400
*                  the system.  The element bind specifies the        * 00354500
*                  minimum bind that must be broken for ARM take      * 00354600
*                  action for the element.  The ELEMBIND keyword      * 00354700
*                  indicates the type of resource the element         * 00354800
*                  represents.                                        * 00354900
*                  DEFAULT: CURJOB                                    * 00355000
*                                                                     * 00355100
*                                                                     * 00355200
*                  [ELEMBIND=CURJOB                                   * 00355300
*                      indicates that the element has a minimum bind  * 00355400
*                      to the batch job or started task under which   * 00355500
*                      the element is registering.  The element       * 00355600
*                      represents a batch job or started task.        * 00355700
*                      ELEMBIND=CURJOB should be specified if the     * 00355800
*                      batch job or started task represented by the   * 00355900
*                      element needs to be restarted if it fails.     * 00356000
*                      The IXCARM request must be issued under a      * 00356100
*                      batch job or started task.  There can only be  * 00356200
*                      one ARM element registered with                * 00356300
*                      ELEMBIND=CURJOB per batch job or started task. * 00356400
*                                                                     * 00356500
*                                                                     * 00356600
*                      [RMTOKEN=xrmtoken|NO_RMTOKEN]]               * 00356700
*                          is the name (RS-type), or address in       * 00356800
*                          register (2)-(12), of an optional 16       * 00356900
*                          character input/output field that is to    * 00357000
*                          contain a Restart Manager token returned   * 00357100
*                          by the REGISTER request.  The contents of  * 00357200
*                          a returned RMTOKEN must not be modified by * 00357300
*                          the application registering this element.  * 00357400
*                          The IXCARM caller must be in supervisor    * 00357500
*                          state or system key.                       * 00357600
*                                                                     * 00357700
*                          Applications that register with IXCARM     * 00357800
*                          REQUEST=REGISTER ELEMBIND=CURJOB may       * 00357900
*                          specify this token as input on subsequent  * 00358000
*                          DEREGISTER requests issued from the master * 00358100
*                          address space.  RMTOKEN is not allowed on  * 00358200
*                          READY, WAITPRED, ASSOCIATE or DEREGISTER   * 00358300
*                          requests from the address space where the  * 00358400
*                          element was registered.                    * 00358500
*                                                                     * 00358600
*                          If the IXCARM invocation is in AR ASC      * 00358700
*                          mode, this area can be in either the       * 00358800
*                          primary address space or in an             * 00358900
*                          address/data space that is addressable     * 00359000
*                          through a public entry on the caller's     * 00359100
*                          DU-AL.                                     * 00359200
*                          DEFAULT: NO_RMTOKEN                        * 00359300
*                                                                     * 00359400
*                                                                     * 00359500
*                                                                     * 00359600
*                  [ELEMBIND=CURSYS                                   * 00359700
*                      indicates that the element has a minimum bind  * 00359800
*                      to the system on which the element is          * 00359900
*                      registering.  The element represents an        * 00360000
*                      abstract resource.  An abstract resource is a  * 00360100
*                      program or a set of programs that is only      * 00360200
*                      associated with (or has a bind to) the system  * 00360300
*                      on which it is running.  ELEMBIND=CURSYS       * 00360400
*                      should be specified if the application         * 00360500
*                      registering with ARM needs to be restarted     * 00360600
*                      only when the system fails. No address space,  * 00360700
*                      batch job, or started task failure will cause  * 00360800
*                      the element to be restarted.  A register       * 00360900
*                      request that specifies ELEMBIND=CURSYS can be  * 00361000
*                      issued from any address space.                 * 00361100
*                                                                     * 00361200
*                      There can be more than one ARM element         * 00361300
*                      registered with ELEMBIND=CURSYS per batch job, * 00361400
*                      started task, or address space because the     * 00361500
*                      element is not associated with any of these    * 00361600
*                      units of work.  There is no persistent restart * 00361700
*                      text to restart the element. Therefore, the    * 00361800
*                      text of the command to restart this element    * 00361900
*                      must be specified either by the application    * 00362000
*                      when it registers, in the ARM policy, or by an * 00362100
*                      installation-written element restart exit.  If * 00362200
*                      the system fails and restart command text is   * 00362300
*                      not provided, the element will be              * 00362400
*                      deregistered.                                  * 00362500
*                                                                     * 00362600
*                      ELEMBIND=CURSYS cannot be specified with       * 00362700
*                      TERMTYPE=ELEMTERM.                             * 00362800
*                                                                     * 00362900
*                                                                     * 00363000
*                      RMTOKEN=xrmtoken]                              * 00363100
*                          is the name (RS-type), or address in       * 00363200
*                          register (2)-(12), of a required 16        * 00363300
*                          character output field that is to contain  * 00363400
*                          a Restart Manager token returned by the    * 00363500
*                          REGISTER request.  The contents of a       * 00363600
*                          returned RMTOKEN must not be modified by   * 00363700
*                          the application registering this element.  * 00363800
*                          The IXCARM caller must be in supervisor    * 00363900
*                          state or system key.                       * 00364000
*                                                                     * 00364100
*                          In order to identify the element,          * 00364200
*                          applications that register with IXCARM     * 00364300
*                          REQUEST=REGISTER ELEMBIND=CURSYS must      * 00364400
*                          specify this token as input on subsequent  * 00364500
*                          WAITPRED, READY, ASSOCIATE, and DEREGISTER * 00364600
*                          requests otherwise a return code IXCARMRC8 * 00364700
*                          with a reason code of IXCARMNotREG ('14'x) * 00364800
*                          will be returned indicating that either    * 00364900
*                          the requestor is not registered with ARM   * 00365000
*                          or the requestor registered with           * 00365100
*                          ELEMBIND=CURSYS and either did not specify * 00365200
*                          RMTOKEN or specified an incorrect value    * 00365300
*                          for RMTOKEN on a READY, WAITPRED,          * 00365400
*                          ASSOCIATE, or DEREGISTER request.          * 00365500
*                          Applications that register with IXCARM     * 00365600
*                          REQUEST=REGISTER ELEMBIND=CURSYS can use   * 00365700
*                          the RMTOKEN and specify the READY,         * 00365800
*                          WAITPRED, ASSOCIATE, and DEREGISTER        * 00365900
*                          requests from any address space.           * 00366000
*                                                                     * 00366100
*                          If the IXCARM invocation is in AR ASC      * 00366200
*                          mode, this area can be in either the       * 00366300
*                          primary address space or in an             * 00366400
*                          address/data space that is addressable     * 00366500
*                          through a public entry on the caller's     * 00366600
*                          DU-AL.                                     * 00366700
*                                                                     * 00366800
*                                                                     * 00366900
*                                                                     * 00367000
*                                                                     * 00367100
*                                                                     * 00367200
*                                                                     * 00367300
*                                                                     * 00367400
*                                                                     * 00367500
*              [RESTARTTIMEOUT=NORM|LONG]                           * 00367600
*                  is an optional keyword input variable that         * 00367700
*                  indicates whether this element should be subject   * 00367800
*                  to ARM's normal restart timeout or its "long"      * 00367900
*                  default restart timeout after being restarted by   * 00368000
*                  ARM. This parameter is applicable only when the    * 00368100
*                  element's restart timeout is determined by ARM's   * 00368200
*                  default value. If the installation's active policy * 00368300
*                  specifies a RESTART_TIMEOUT value for this         * 00368400
*                  element, this specification in the register macro  * 00368500
*                  is ignored.                                        * 00368600
*                  DEFAULT: NORM                                      * 00368700
*                                                                     * 00368800
*                                                                     * 00368900
*                  RESTARTTIMEOUT=NORM                                * 00369000
*                      indicates that, in the absence of an explicit  * 00369200
*                      RESTART_TIMEOUT value for this element in the  * 00369400
*                      active policy, ARM is to apply its normal      * 00369600
*                      default restart-timeout value (i.e., five      * 00369800
*                      minutes) to restarts of this element.          * 00370000
*                                                                     * 00370200
*                  RESTARTTIMEOUT=LONG                                * 00370400
*                      indicates that, in the absence of an explicit  * 00370600
*                      RESTART_TIMEOUT value for this element in the  * 00370800
*                      active policy, ARM is to apply its long        * 00371000
*                      default restart-timeout value (i.e., six       * 00371200
*                      hours) to restarts of this element.            * 00371400
*                                                                     * 00371600
*                                                                     * 00371800
*                                                                     * 00372000
*                                                                     * 00372200
*                                                                     * 00372300
*                                                                     * 00372400
*              [ANSAREA=xansarea]                                     * 00372500
*                  is the name (RS-type), or address in register      * 00372600
*                  (2)-(12), of an optional character output variable * 00372800
*                  specifying an area to contain data returned by the * 00373000
*                  IXCARM REGISTER macro. This area must be 32 bytes  * 00373200
*                  long. Its format is described in the IXCYARAA      * 00373300
*                  mapping macro.  If the IXCARM invocation is in AR  * 00373400
*                  ASC mode, this area can be in either the primary   * 00373500
*                  address space or in an address/data space that is  * 00373800
*                  addressable through a public entry on the caller's * 00374000
*                  DU-AL.                                             * 00374200
*                                                                     * 00374300
*                  When a register request succeeds, the answer       * 00374400
*                  area's validity flag will indicate whether the     * 00374500
*                  data in the area is valid. When a register request * 00374600
*                  fails, the contents of the answer area should be   * 00374700
*                  assumed to be invalid (no matter what the validity * 00374800
*                  flag indicates).                                   * 00374900
*                                                                     * 00375000
*                                                                     * 00375100
*                                                                     * 00375200
*          REQUEST=WAITPRED                                           * 00375300
*              requests that the Automatic Restart Manager suspend    * 00375400
*              the processing of the issuing program until any        * 00375500
*              predecessor elements that are also being restarted     * 00375600
*              have indicated that they are ready.  The predecessors  * 00375700
*              to the element that has issued this WAITPRED request   * 00375800
*              are identified from "level" specifications in the      * 00376000
*              active Automatic Restart Manager policy .  The Wait    * 00376200
*              Predecessor service must be issued from the same       * 00376400
*              address space that issued the Register request.        * 00376600
*                                                                     * 00378000
*                                                                     * 00378100
*              [RMTOKEN=xrmtoken|NO_RMTOKEN]                        * 00378200
*                  is the name (RS-type), or address in register      * 00378300
*                  (2)-(12), of an optional 16 character input        * 00378400
*                  variable specifying an area containing a Restart   * 00378500
*                  Manager token returned by the IXCARM REGISTER      * 00378600
*                  macro.  The IXCARM caller must be in supervisor    * 00378700
*                  state or system key.  For elements registered with * 00378800
*                  ELEMBIND=CURSYS, the same token must be supplied   * 00378900
*                  on subsequent WAITPRED, READY, ASSOCIATE and       * 00379000
*                  DEREGISTER requests to identify the element. Not   * 00379100
*                  allowed for ELEMBIND=CURJOB.                       * 00379200
*                                                                     * 00379300
*                  If the IXCARM invocation is in AR ASC mode, this   * 00379400
*                  area can be in either the primary address space or * 00379500
*                  in an address/data space that is addressable       * 00379600
*                  through a public entry on the caller's DU-AL.      * 00379700
*                  DEFAULT: NO_RMTOKEN                                * 00379800
*                                                                     * 00379900
*                                                                     * 00380000
*                                                                     * 00380100
*          REQUEST=READY                                              * 00380200
*              requests that ARM mark a registered user as READY to   * 00380300
*              accept work.  If a WAITPRED request has not previously * 00381000
*              been issued by the user, the READY request will        * 00382000
*              perform an implicit WAITPRED to wait for predecessor   * 00383000
*              elements to initialize.  The Ready service must be     * 00384000
*              issued from the same address space that issued the     * 00385000
*              Register request.                                      * 00386000
*                                                                     * 00387000
*                                                                     * 00387100
*              [RMTOKEN=xrmtoken|NO_RMTOKEN]                        * 00387200
*                  is the name (RS-type), or address in register      * 00387300
*                  (2)-(12), of an optional 16 character input        * 00387400
*                  variable specifying an area containing a Restart   * 00387500
*                  Manager token returned by the IXCARM REGISTER      * 00387600
*                  macro.  The IXCARM caller must be in supervisor    * 00387700
*                  state or system key.  For elements registered with * 00387800
*                  ELEMBIND=CURSYS, the same token must be supplied   * 00387900
*                  on subsequent WAITPRED, READY, ASSOCIATE and       * 00388000
*                  DEREGISTER requests to identify the element. Not   * 00388100
*                  allowed for ELEMBIND=CURJOB.                       * 00388200
*                                                                     * 00388300
*                  If the IXCARM invocation is in AR ASC mode, this   * 00388400
*                  area can be in either the primary address space or * 00388500
*                  in an address/data space that is addressable       * 00388600
*                  through a public entry on the caller's DU-AL.      * 00388700
*                  DEFAULT: NO_RMTOKEN                                * 00388800
*                                                                     * 00388900
*                                                                     * 00389000
*                                                                     * 00389100
*          REQUEST=DEREGISTER                                         * 00389200
*              requests deregistration of a registered user.  The     * 00389300
*              Deregister service must be issued from the same        * 00390000
*              address space that issued the Register request, with   * 00390100
*              the following exceptions:  1) If the REGISTER request  * 00390200
*              specified ELEMBIND=CURSYS, the DEREGISTER may be done  * 00390300
*              from any address space.  2) Any element may be         * 00390400
*              DEREGISTERed from an address space termination         * 00390500
*              resource manager running in the MASTER address space,  * 00390600
*              if the RMTOKEN returned on the REGISTER is supplied.   * 00390700
*              The application should only issue this request from    * 00390800
*              master's address space while running under a resource  * 00390900
*              manager. If the address space under which the register * 00391000
*              request was issued is not terminating and the          * 00391100
*              application issues any IXCARM requests from that       * 00391200
*              address space after a deregister from master's address * 00391300
*              space, results are unpredictable.                      * 00391400
*                                                                     * 00391500
*                                                                     * 00391600
*              [RMTOKEN=xrmtoken|NO_RMTOKEN]                        * 00391700
*                  is the name (RS-type), or address in register      * 00391800
*                  (2)-(12), of an optional 16 character input        * 00391900
*                  variable specifying an area containing a Restart   * 00392000
*                  Manager token returned by the IXCARM REGISTER      * 00392100
*                  macro.  The IXCARM caller must be in supervisor    * 00392200
*                  state or system key.  For elements registered with * 00392300
*                  ELEMBIND=CURSYS, the same token must be supplied   * 00392400
*                  on subsequent WAITPRED, READY, ASSOCIATE and       * 00392500
*                  DEREGISTER requests to identify the element.  For  * 00392600
*                  elements registered with ELEMBIND=CURJOB, RMTOKEN  * 00392700
*                  must be supplied when issuing a DEREGISTER request * 00392800
*                  from the master address space. It is not allowed   * 00392900
*                  when deregistering from the same address space     * 00393000
*                  that the element registered from.                  * 00393100
*                                                                     * 00393200
*                  If the IXCARM invocation is in AR ASC mode, this   * 00393300
*                  area can be in either the primary address space or * 00393400
*                  in an address/data space that is addressable       * 00393500
*                  through a public entry on the caller's DU-AL.      * 00393600
*                  DEFAULT: NO_RMTOKEN                                * 00393700
*                                                                     * 00393800
*                                                                     * 00393900
*                                                                     * 00394000
*          REQUEST=ASSOCIATE                                          * 00394100
*              requests that a registered user be associated with     * 00394200
*              another element for takeover/restart processing        * 00394900
*              purposes. This "association" suppresses all ARM        * 00395800
*              restarts of the element identified in the TELEMENT     * 00396700
*              parameter of this macro.  The element issuing          * 00397300
*              Associate must be in the "available" state (i.e., have * 00397900
*              issued the IXCARM-Ready macro).                        * 00398500
*                                                                     * 00399100
*              If the issuer of this Associate request terminates or  * 00399700
*              deregisters from ARM, then the association is broken   * 00400300
*              and the element specifed in TELEMENT again becomes     * 00400900
*              eligible for ARM restarts.  For elements registered    * 00401300
*              with ELEMBIND=CURJOB, the Associate service must be    * 00401700
*              issued from the same address space that issued the     * 00402100
*              Register request.                                      * 00402700
*                                                                     * 00402800
*                                                                     * 00402900
*              [RMTOKEN=xrmtoken|NO_RMTOKEN]                        * 00403000
*                  is the name (RS-type), or address in register      * 00403100
*                  (2)-(12), of an optional 16 character input        * 00403200
*                  variable specifying an area containing a Restart   * 00403300
*                  Manager token returned by the IXCARM REGISTER      * 00403400
*                  macro. This area must be 16 bytes long.  The       * 00403500
*                  IXCARM caller must be in supervisor state or       * 00403600
*                  system key.  For elements registered with          * 00403700
*                  ELEMBIND=CURSYS, the same token must be supplied   * 00403800
*                  on subsequent WAITPRED, READY, ASSOCIATE and       * 00403900
*                  DEREGISTER requests to identify the element.  It   * 00404000
*                  is not allowed for ELEMBIND=CURJOB.  If the IXCARM * 00404100
*                  invocation is in AR ASC mode, this area can be in  * 00404200
*                  either the primary address space or in an          * 00404300
*                  address/data space that is addressable through a   * 00404400
*                  public entry on the caller's DU-AL.                * 00404500
*                  DEFAULT: NO_RMTOKEN                                * 00404600
*                                                                     * 00404700
*                                                                     * 00404800
*                                                                     * 00404900
*                                                                     * 00405000
*              TELEMENT=xtelement                                     * 00406000
*                  is the name (RS-type), or address in register      * 00407000
*                  (2)-(12), of a required 16 character input         * 00408400
*                  variable that contains the name of the ARM element * 00409800
*                  with which the requestor wishes to become          * 00411200
*                  associated.  The element name must be 16           * 00412600
*                  characters long, padded on the right with blanks   * 00414000
*                  if necessary.                                      * 00415400
*                                                                     * 00415800
*                                                                     * 00416200
*                                                                     * 00416600
*                                                                     * 00417000
*                                                                     * 00418000
*                                                                     * 00419000
*                                                                     * 00420000
*                                                                     * 00421000
*      [RETCODE=xretcode]                                             * 00422000
*          is the name (RS-type) of an optional fullword output       * 00423200
*          variable, or register (2)-(12), into which the return code * 00424400
*          is to be copied from GPR 15.                               * 00425600
*                                                                     * 00427000
*                                                                     * 00428000
*                                                                     * 00429000
*                                                                     * 00429500
*      [RSNCODE=xrsncode]                                             * 00430000
*          is the name (RS-type) of an optional fullword output       * 00431200
*          variable, or register (2)-(12), into which the reason code * 00432400
*          is to be copied from GPR 0.                                * 00433600
*                                                                     * 00435000
*                                                                     * 00436000
*                                                                     * 00437000
*                                                                     * 00437500
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00437600
*          is an optional byte input decimal value in the "1-1" range * 00437700
*          that specifies the macro version.  PLISTVER is the only    * 00437800
*          key allowed on the list form of MF and determines which    * 00437900
*          parameter list is generated.  Note that MAX may be         * 00438000
*          specified instead of a number, and the parameter list will * 00438100
*          be of the largest size currently supported. This size may  * 00438200
*          grow from release to release (thus possibly affecting the  * 00438300
*          amount of storage needed by your program).  If your        * 00438400
*          program can tolerate this, IBM recommends that you always  * 00438500
*          specify MAX when creating the list form parameter list as  * 00438600
*          that will ensure that the list form parameter list is      * 00438700
*          always long enough to hold whatever parameters might be    * 00438800
*          specified on the execute form.                             * 00438900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00439000
*          default is the lowest version which allows all of the      * 00439100
*          parameters specified on the invocation to be processed.    * 00439200
*                                                                     * 00439300
*                                                                     * 00439400
*                                                                     * 00439500
*                                                                     * 00439600
*      [MF=S|L|E]                                                   * 00439700
*          is an optional keyword input which specifies the macro     * 00439800
*          form.                                                      * 00440000
*          DEFAULT: S                                                 * 00441000
*                                                                     * 00442000
*                                                                     * 00443000
*          [MF=S]                                                     * 00444000
*              specifies the standard form of the macro.  The "S"     * 00445000
*              form generates code to put the parameters into an      * 00446000
*              in-line parameter list and invoke the desired service. * 00447000
*              Full checking for required macro keys is done along    * 00448000
*              with supplying defaults for omitted optional           * 00449000
*              parameters.                                            * 00450000
*                                                                     * 00451000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00452000
*              specifies the list form of the macro.  The "L" form    * 00453000
*              defines an area to be used for the parameter list.     * 00454000
*              Only the PLISTVER key may be specified on the          * 00454400
*              invocation.  All other macro parameters are flagged as * 00454800
*              errors.  If PLISTVER is not specified, the original    * 00455200
*              parameter list definition is used.                     * 00455600
*                                                                     * 00456000
*            ,xmfctrl                                                 * 00457000
*              is a required input.  It is the name of a storage area * 00458000
*              for the parameter list.                                * 00459000
*                                                                     * 00460000
*            ,xmfattr|0D                                            * 00461000
*              is an optional 60 character input string that varies   * 00462000
*              from 1 to 60 characters. Use it to force boundary      * 00463600
*              alignment of the parameter list. Use only 0F or 0D.    * 00465200
*              DEFAULT: 0D which forces the parameter list to a       * 00467000
*              doubleword boundary.                                   * 00468000
*                                                                     * 00469000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00470000
*              specifies the execute form of the macro.  The "E" form * 00471000
*              generates code to put the parameters into the          * 00472000
*              parameter list specified by xmfctrl and provides full  * 00472600
*              syntax checking with default setting.                  * 00473200
*                                                                     * 00474000
*            ,xmfctrl                                                 * 00475000
*              is a required input.  It is the name (RS-type), or     * 00476000
*              address in register (1)-(12), of a storage area for    * 00477000
*              the parameter list.                                    * 00478000
*                                                                     * 00479000
*            ,COMPLETE                                              * 00480000
*              is an optional keyword input which specifies the       * 00481000
*              degree of macro parameter syntax checking.             * 00482000
*              DEFAULT: COMPLETE                                      * 00483000
*                                                                     * 00484000
*                                                                     * 00485000
*              COMPLETE                                               * 00493000
*                  Checking for required macro keys is done and       * 00501000
*                  defaults are supplied for omitted optional         * 00509000
*                  parameters.                                        * 00517000
*                                                                     * 00525000
*                                                                     * 00526000
*                                                                     * 00527000
*                                                                     * 00528000
*                                                                     * 00530000
*                                                                     * 00531000
*                                                                     * 00531100
*01* RETURN CODES:                                                    * 00531200
*                                                                     * 00531300
*                                                                     * 00531400
*                                                                     * 00531500
*       -         The IXCARM return codes are hexadecimal numbers     * 00531600
*                 returned in register 15. They indicate whether or   * 00531700
*                 not the requested function was successfully         * 00531800
*                 performed.                                          * 00531900
*                                                                     * 00532000
*                                                                     * 00532100
*       -         The IXCARM reason codes are hexadecimal numbers     * 00532200
*                 returned in register 0. They indicate either the    * 00532300
*                 reason for the failure of an IXCARM request or a    * 00532400
*                 special condition associated with a successful      * 00532500
*                 IXCARM request.                                     * 00532600
*                                                                     * 00532700
*                 A unique reason code will be returned whenever the  * 00532800
*                 return code indicates that IXCARM processing failed * 00532900
*                 or completed successfully with some special         * 00533000
*                 condition  (i.e., is greater than 0).               * 00533100
*                                                                     * 00533200
*                 The data definitions for the names of the return    * 00533300
*                 and reason codes for the IXCARM macro are in the    * 00533400
*                 IXCYARM mapping macro.                              * 00534000
*                                                                     * 00535000
*                                                                     * 00536000
*       INTERNAL REASON CODES                                         * 00536100
*                                                                     * 00536200
*                  If an IXCARM macro fails because of an internal    * 00536300
*                 error, IXCARM will return a unique internal reason  * 00536400
*                 code (with the appropriate "failure" return code)   * 00536500
*                 to the issuer. The names and descriptions of these  * 00536600
*                 internal reason codes will not be documented        * 00536700
*                 externally.                                         * 00536800
*                                                                     * 00536900
*                 The values of the internal reason codes will range  * 00537000
*                 from xA0 to xFF, where x is the value of 0 through  * 00537100
*                 5 which identifies the  IXCARM function(s) to which * 00537200
*                 the reason code applies (from the numbering         * 00537300
*                 convention described above).                        * 00537400
*                                                                     * 00538000
*                                                                     * 00539000
*       RETURN AND REASON CODE DEFINITIONS                            * 00546000
*                                                                     * 00553000
*                                                                     * 00554000
*       0         IXCARMRC0:  Successful completion.  On a REGISTER   * 00556000
*                 request, the issuing program was initially          * 00556500
*                 registered with ARM. (That is, the registering      * 00557000
*                 program was not running as the result of an ARM     * 00557500
*                 restart, or the program had been restarted by ARM   * 00558000
*                 but had experienced a "restart timeout".)           * 00558500
*                                                                     * 00559000
*                 On a DEREGISTER request, the request was either     * 00559100
*                 performed successfully, or the caller attempted to  * 00559200
*                 deregister an element that was either invalid or no * 00559300
*                 longer registered.                                  * 00559400
*                                                                     * 00559500
*                 On any other request type, the request was          * 00559600
*                 performed successfully.  Return code 0 has no       * 00560000
*                 reason codes associated with it.                    * 00560500
*                                                                     * 00561000
*                                                                     * 00562000
*       4         IXCARMRC4:  Successful completion of IXCARM macro   * 00562800
*                 issued after an ARM restart of the issuing program. * 00563600
*                 Special conditions are indicated by a hexadecimal   * 00564400
*                 reason code in register 0 (and the RSNCODE variable * 00565200
*                 if specified).                                      * 00566000
*                                                                     * 00567000
*                 REASON      MEANING                                 * 00568000
*                 CODE                                                * 00569000
*                                                                     * 00570000
*                                                                     * 00571600
*                 104         IXCARMPerJCL:  Registration was         * 00572000
*                             requested by an ARM user that is being  * 00573000
*                             restarted with the same JCL or          * 00574000
*                             command-text that was used for the      * 00575000
*                             previous startup (i.e., persistent      * 00576000
*                             restart text).                          * 00577000
*                                                                     * 00578000
*                 108         IXCARMNewJCL:  Registration was         * 00579000
*                             requested by an ARM user that is being  * 00580000
*                             restarted with JCL or command-text that * 00581000
*                             was provided by an ARM exit or ARM      * 00582000
*                             policy, or by the application.          * 00587000
*                                                                     * 00592000
*                 204         IXCARMPredTimeout:  Predecessor element * 00593000
*                             didn't become READY within its          * 00594000
*                             specified interval                      * 00595000
*                                                                     * 00596000
*                 304         IXCARMReadyTimeout:  READY request      * 00597100
*                             completed but a predecessor element to  * 00598200
*                             the issuer of this request has timed    * 00599300
*                             out. (This reason code would only occur * 00600400
*                             when the issuer of this READY request   * 00601500
*                             has not issued a previous WAITPRED but  * 00602600
*                             had predecessor elements being          * 00603700
*                             restarted by ARM.)                      * 00604800
*                                                                     * 00606000
*                                                                     * 00607000
*                                                                     * 00608000
*                                                                     * 00608500
*       8         IXCARMRC8:  IXCARM request failed because of        * 00609000
*                 invalid parameters or because of some problem in    * 00609800
*                 the invoker's environment.  One of the following    * 00610600
*                 reason codes is in register 0 (and in the RSNCODE   * 00611400
*                 variable if specified).                             * 00612200
*                                                                     * 00613000
*                 REASON      MEANING                                 * 00614000
*                 CODE                                                * 00615000
*                                                                     * 00616000
*                                                                     * 00617000
*                 014         IXCARMNotReg:  Program error. Either    * 00617200
*                             the caller is not a registered element  * 00617400
*                             of the automatic restart manager or the * 00617600
*                             element represents an abstract resource * 00617800
*                             (the element registered with            * 00618000
*                             ELEMBIND=CURSYS) and did not specify a  * 00618200
*                             valid RMTOKEN on an IXCARM READY,       * 00618400
*                             WAITPRED, ASSOCIATE, or DEREGISTER      * 00618600
*                             request.  Note that for elements that   * 00618800
*                             represent jobs or started tasks (the    * 00619000
*                             element registered with                 * 00619200
*                             ELEMBIND=CURJOB), specifying RMTOKEN on * 00619400
*                             a READY, WAITPRED, and ASSOCIATE        * 00619600
*                             request is not allowed and results in   * 00619800
*                             this reason code and specifying RMTOKEN * 00620000
*                             on a deregister request is not allowed  * 00620200
*                             and results in this reason code unless  * 00620400
*                             the request is issued from the master   * 00620600
*                             address space.                          * 00620800
*                                                                     * 00621000
*                 018         IXCARMInvAnsAddr:  The answer area      * 00621800
*                             provided with this request cannot be    * 00622600
*                             accessed.  The element was successfully * 00623000
*                             registered, but the answer data could   * 00623400
*                             not be returned.                        * 00623800
*                                                                     * 00624200
*                 01C         IXCARMInvAnsALET:  The ALET that        * 00625400
*                             qualifies the address of the answer     * 00629800
*                             area is not associated with a valid     * 00634200
*                             DU-AL entry.                            * 00638600
*                                                                     * 00650100
*                 020         IXCARMInvRmtAddr:  Program or           * 00650200
*                             environmental error. The system cannot  * 00650300
*                             access the RMTOKEN value.               * 00650400
*                                                                     * 00650500
*                 024         IXCARMInvRmtALET:  Program or           * 00650600
*                             environmental error.  The ALET that     * 00650700
*                             qualifies the address of the RMtoken is * 00650800
*                             not associated with a valid entry on    * 00650900
*                             the DU-AL.                              * 00651000
*                                                                     * 00651100
*                 02C         IXCARMInvElemName:  REGISTER or         * 00651200
*                             ASSOCIATE request specified an invalid  * 00651300
*                             element name.                           * 00651400
*                                                                     * 00651500
*                 030         IXCARMRequestOverlap: Program error.    * 00651600
*                             An IXCARM request for an element        * 00651700
*                             registered with or defaulted to         * 00651800
*                             ELEMBIND=CURJOB is already being        * 00651900
*                             processed for this address space.  The  * 00652000
*                             IXCARM request cannot be issued until a * 00652100
*                             previous IXCARM request from this       * 00652200
*                             address space has been completed.       * 00652300
*                                                                     * 00652400
*                 034         IXCARMAMODE24:  IXCARM macro issued in  * 00652500
*                             24-bit addressing mode.                 * 00652600
*                                                                     * 00652700
*                 040         IXCARMRsvNot0:  A reserved field is not * 00652800
*                             zero. Your program may have             * 00653000
*                             inadvertently written over an area in   * 00653900
*                             the parameter list.                     * 00654800
*                                                                     * 00656000
*                 0A0         IXCARMInvR0:  Register 0 has an invalid * 00656200
*                             value.                                  * 00656400
*                                                                     * 00656600
*                 0A4         IXCARMR0TypeConfl:  Register 0 value    * 00656800
*                             and the request type conflict.          * 00657000
*                                                                     * 00657200
*                 100         IXCARMInvPlistALET:  The ALET that      * 00657400
*                             qualifies the address of the parameter  * 00657600
*                             list is not associated with a valid     * 00657800
*                             DU-AL entry.                            * 00658000
*                                                                     * 00658200
*                 104         IXCARMBadVersion:  The version number   * 00658400
*                             specified in the IXCARM parameter list  * 00658600
*                             is not 1.                               * 00658800
*                                                                     * 00659000
*                 108         IXCARMBadRequest:  The function         * 00659200
*                             specified in the REQUEST parameter of   * 00659400
*                             the IXCARM macro is invalid.            * 00659600
*                                                                     * 00661000
*                 10C         IXCARMParmErr:  Error accessing         * 00662000
*                             parameter list.                         * 00663000
*                                                                     * 00664000
*                 110         IXCARMStartErr:  Error fetching         * 00665000
*                             STARTTXT parameter                      * 00666000
*                                                                     * 00667000
*                 114         IXCARMStartLen:  Invalid STARTTXTLEN    * 00668000
*                             (not between 1 and 126)                 * 00669000
*                                                                     * 00670000
*                 118         IXCARMNotTaskMode:  IXCARM issuer is    * 00671000
*                             not in task mode                        * 00672000
*                                                                     * 00673000
*                 11C         IXCARMNotEnabled:  IXCARM issuer is not * 00674300
*                             enabled.                                * 00675600
*                                                                     * 00677000
*                 120         IXCARMHasLock:  IXCARM issuer holds an  * 00679000
*                             enabled lock (such as the local lock).  * 00681000
*                                                                     * 00683000
*                 124         IXCARMHasEUTFRR:  IXCARM issuer is      * 00684300
*                             running under an EUT FRR                * 00685600
*                                                                     * 00685900
*                 128         IXCARMJESErr:  REGISTER request failed  * 00686200
*                             because of an error in JES              * 00686500
*                                                                     * 00687000
*                 12C         IXCARMJournal:  The caller is a         * 00687200
*                             candidate for either a                  * 00687400
*                             Checkpoint/Restart or a step restart    * 00687600
*                             (i.e., journalling) and is therefore    * 00687800
*                             not eligible to be restarted by ARM.    * 00688000
*                                                                     * 00688200
*                 130         IXCARMInvElemType:  The name specified  * 00688400
*                             for the element type was invalid.       * 00689000
*                                                                     * 00690000
*                 134         IXCARMWrongCallerType:  Program error.  * 00690300
*                             An IXCARM request specified or          * 00690600
*                             defaulted to ELEMBIND=CURJOB and the    * 00690900
*                             application is neither a started task   * 00691200
*                             nor a batch job.                        * 00691500
*                                                                     * 00692100
*                 138         IXCARMCancelled; A CANCEL or FORCE      * 00692200
*                             command without the ARMRESTART          * 00692300
*                             parameter has been issued against the   * 00692400
*                             caller of IXCARM-Register.              * 00692500
*                                                                     * 00693000
*                 13C         IXCARMRACRFail; The RACROUTE invocation * 00693100
*                             for the security token of               * 00693200
*                             IXCARM-Register's caller failed.        * 00693300
*                                                                     * 00693400
*                 140         IXCARMInvTERMTYPE:  TERMTYPE value on a * 00693500
*                             Register request is invalid.            * 00693600
*                                                                     * 00693700
*                 144         IXCARMInvRestTimeOut:  RESTARTTIMEOUT   * 00693800
*                             value on a Register request is invalid. * 00693900
*                                                                     * 00694000
*                 148         IXCARMSaveFail:  Register request       * 00694100
*                             prohibited by JES.                      * 00694200
*                                                                     * 00694400
*                 14C         IXCARMBatchSTARTTXT:  Program error. An * 00694500
*                             element registering under a batch job   * 00694600
*                             with a bind to the job specified        * 00694700
*                             STARTTXT with its Register request.     * 00694800
*                                                                     * 00694900
*                 150         IXCARMELemNameInUse:  Element name      * 00695000
*                             specified on REGISTER request is        * 00695100
*                             already registered.                     * 00695200
*                                                                     * 00695400
*                 154         IXCARMAddrSpaceDup:  Program error. An  * 00695500
*                             element with a bind to the batch job or * 00695600
*                             started task is already registered with * 00695700
*                             ARM. Only one element per batch job or  * 00695800
*                             started task can register with a bind   * 00695900
*                             specification of CURJOB.                * 00696000
*                                                                     * 00696100
*                 158         IXCARMExitParm:  Error fetching         * 00696200
*                             EVENTEXIT parameter list                * 00696300
*                                                                     * 00696400
*                 15C         IXCARMExitLen:  EVENTEXIT parameter     * 00696500
*                             list has exceeded the maximum length    * 00696600
*                             (limited to 255 bytes).                 * 00696700
*                                                                     * 00696800
*                 160         IXCARMExitName:  Error trying to        * 00696900
*                             acquire the Event-Exit routine name.    * 00697000
*                                                                     * 00697100
*                 164         IXCARMInvEventExit:  The name specified * 00697200
*                             for the Event-Exit routine is not a     * 00697300
*                             valid MVS load module name.             * 00697400
*                                                                     * 00697500
*                 168         IXCARMInvAsyncreq:  Request requiring   * 00697600
*                             asynchronous processing is invalid in   * 00697700
*                             issuer's address space.                 * 00697800
*                                                                     * 00697900
*                 16C         IXCARMInvELEMBIND:  Program error. The  * 00698000
*                             ELEMBIND value specified is not valid,  * 00698100
*                             or ELEMBIND=CURSYS was specified with   * 00698200
*                             TERMTYPE=ELEMTERM.                      * 00698300
*                                                                     * 00698400
*                 1A8         IXCARMRsvREGFds:  REGISTER request but  * 00698500
*                             fields not applying to REGISTER were    * 00698600
*                             not zero                                * 00698700
*                                                                     * 00698800
*                 204         IXCARMBadWaitPred:  WAITPRED request    * 00698900
*                             issued when the element was in the      * 00699000
*                             wrong state (e.g., after the element    * 00699100
*                             became ready).                          * 00699200
*                                                                     * 00699300
*                 2A8         IXCARMRsvWTPFds:  WAITPRED request but  * 00699400
*                             fields not applying to WAITPRED were    * 00699500
*                             not zero.                               * 00699600
*                                                                     * 00699700
*                 304         IXCARMBadReady:  READY request issued   * 00699800
*                             when the element was in the wrong state * 00700000
*                             (e.g., while running after a previous   * 00701000
*                             ready)                                  * 00702000
*                                                                     * 00703000
*                 3A8         IXCARMRsvRDYFds:  Required fields were  * 00703500
*                             not zero on a Ready request             * 00704000
*                                                                     * 00704500
*                 404         IXCARMDupAssoc1:  on an ASSOCIATE       * 00705000
*                             request, the issuer was already         * 00705500
*                             associated with an element.             * 00706000
*                                                                     * 00707000
*                 408         IXCARMBadTargetElem:  on an ASSOCIATE   * 00708000
*                             request, the TELEMENT parameter does    * 00708100
*                             not specify the name of a registered    * 00708200
*                             ARM element.                            * 00708300
*                                                                     * 00708400
*                 40C         IXCARMDupAssoc2:  On an ASSOCIATE       * 00708500
*                             request, the element specified in the   * 00708600
*                             TELEMENT parameter is already           * 00708700
*                             associated with an element other than   * 00708800
*                             the issuer of this IXCARM macro.        * 00708900
*                                                                     * 00709000
*                 414         IXCARMSelfAssoc:  The issuer of an      * 00709400
*                             ASSOCIATE request specified itself as   * 00709500
*                             the TELEMENT.                           * 00709600
*                                                                     * 00709700
*                 4A8         IXCARMRsvASSFds:  ASSOCIATE request but * 00709800
*                             fields not applying to ASSOCIATE were   * 00709900
*                             not zero.                               * 00710000
*                                                                     * 00710100
*                 5A8         IXCARMRsvDRGFds DEREGISTER request but  * 00710200
*                             fields not applying to DEREGISTER were  * 00710300
*                             not zero.                               * 00710400
*                                                                     * 00710500
*                 5B0         IXCARMWrongElemOnReReg The element that * 00710600
*                             has attempted to register has done so   * 00710700
*                             in an address space that was created    * 00710800
*                             for the restart of another element.     * 00710900
*                             Only the restarted element can          * 00711000
*                             re-register in the current address      * 00711100
*                             space.                                  * 00711200
*                                                                     * 00711300
*                 5B4         IXCARMWrongAddrOnReReg The element that * 00711400
*                             has attempted to re-register has done   * 00711500
*                             so in an address space other than the   * 00711600
*                             one that was created for the            * 00711700
*                             re-registering element. The element can * 00711800
*                             only re-register in the address space   * 00711900
*                             that the override restart start text    * 00712000
*                             was issued in.                          * 00712100
*                                                                     * 00712200
*                 5B8         IXCARMReRegAfterTimOut The element that * 00712300
*                             has attempted to register has done so   * 00712400
*                             in an address space that was created    * 00712500
*                             for the restart of another element.     * 00712600
*                             However, the element that the address   * 00712700
*                             space was initially created for is no   * 00712800
*                             longer known to ARM. This is probably   * 00712900
*                             due to the restart of the element       * 00713000
*                             having timed out.                       * 00713100
*                                                                     * 00713200
*                 5BC         IXCARMUNAUTHEVENTEXIT:  Users who are   * 00713300
*                             both in problem state and problem key   * 00713400
*                             can not specify an event exit on        * 00713500
*                             registration.                           * 00713600
*                                                                     * 00713700
*                 5C0         IXCARMUNAUTHSTARTTXT:  Users who are    * 00713800
*                             both in problem state and problem key   * 00713900
*                             can not specify restart start text on   * 00714000
*                             registration.                           * 00714100
*                                                                     * 00714200
*                 5C4         IXCARMUNAUTHRMTOKEN:  Users who are     * 00714300
*                             both in problem state and problem key   * 00714400
*                             can not specify an RMTOKEN on any       * 00714500
*                             request.                                * 00714600
*                                                                     * 00714700
*                                                                     * 00714800
*                                                                     * 00714900
*                                                                     * 00715000
*       C         IXCARMRC12:  The IXCARM request failed because of   * 00716000
*                 an environmental error. One of the following reason * 00717000
*                 codes is in register 0 (and in the RSNCODE variable * 00718000
*                 if specified).                                      * 00719000
*                                                                     * 00720000
*                 REASON      MEANING                                 * 00721000
*                 CODE                                                * 00722000
*                                                                     * 00723000
*                                                                     * 00724000
*                 004         IXCARMNoARM:  The MVS system on which   * 00725800
*                             this macro was issued is at an MVS or   * 00727600
*                             JES release level that does not support * 00729400
*                             the Automatic Restart Manager function. * 00731200
*                                                                     * 00733000
*                 00C         IXCARMNoESTAE:  The Automatic Restart   * 00734000
*                             Manager was unable to establish an      * 00735000
*                             ESTAE routine for IXCARM processing.    * 00736000
*                                                                     * 00744000
*                 0C0         IXCARMFDSErr1:  Internal error while    * 00744100
*                             trying to access ARM's couple data set  * 00744200
*                                                                     * 00744400
*                 0C4         IXCARMFDSErr2:  Internal error with     * 00744500
*                             ARM's couple data set.  (Bad Ename)     * 00744600
*                                                                     * 00744700
*                 0C8         IXCARMFDSErr3:  Internal error with     * 00744800
*                             ARM's couple data set (Bad slot)        * 00744900
*                                                                     * 00745000
*                 0CC         IXCARMBadTESTART:  Internal error, call * 00745100
*                             to TESTART failed                       * 00745200
*                                                                     * 00745300
*                 104         IXCARMMaxUsers:  Maximum number of      * 00745400
*                             Automatic Restart Manager users already * 00746000
*                             exist (i.e., the ARM couple data set is * 00747000
*                             full).                                  * 00748000
*                                                                     * 00749000
*                 160         IXCARMNoCDS:  The system on which this  * 00749100
*                             macro was issued does not have access   * 00749200
*                             to a Couple Data Set (CDS) for the      * 00749300
*                             Automatic Restart Manager.              * 00749400
*                                                                     * 00749500
*                 164         IXCARMBADJOB:  Environmental error, JES * 00749600
*                             could not support ARM requests for this * 00749700
*                             job.  A unit of work other than a batch * 00749800
*                             job or started task has attempted to    * 00749900
*                             register with ARM without specifying    * 00750000
*                             ELEMBIND=CURSYS. The registration was   * 00750100
*                             rejected.                               * 00750200
*                                                                     * 00750300
*                 168         IXCARMSAFNOTDEFINED:  Problem state and * 00750400
*                             problem key users can not use IXCARM    * 00750500
*                             without having a security profile in    * 00750600
*                             place for the facility IXCARM.          * 00750700
*                                                                     * 00750800
*                 16C         IXCARMNOSAFAUTH:  The installed         * 00750900
*                             security product indicated that the     * 00751000
*                             user does not have authorized access to * 00751100
*                             the IXCARM facility or the secure       * 00751200
*                             entity. The entity is made up of the    * 00751300
*                             application name (IXCARM) followed by   * 00751400
*                             the element type followed by the        * 00751500
*                             element name.                           * 00751600
*                                                                     * 00751700
*                                                                     * 00751800
*                                                                     * 00751900
*                                                                     * 00752000
*       10        IXCARMRC16:  Failure in ARM processing.  The reason * 00753000
*                 code is in register 0 (and the RSNCODE variable if  * 00754000
*                 specified).                                         * 00755000
*                                                                     * 00756000
*                 REASON      MEANING                                 * 00757000
*                 CODE                                                * 00758000
*                                                                     * 00759000
*                                                                     * 00760000
*                 004         IXCARMARMErr:  The Automatic Restart    * 00761000
*                             Manager experienced an unexpected error * 00762000
*                             while processing the request. The       * 00763000
*                             request is rejected.  The Automatic     * 00764000
*                             Restart Manager recovery will           * 00765000
*                             automatically deregister the issuer.    * 00766000
*                                                                     * 00767000
*                 008         IXCARMUnkErr:  The Automatic Restart    * 00768000
*                             Manager experienced an unexpected error * 00769000
*                             while processing the request. The       * 00770000
*                             request is rejected.  The issuer's      * 00770300
*                             registration status with the Automatic  * 00770600
*                             Restart Manager will remain unchanged.  * 00770900
*                                                                     * 00771200
*                 0A0         IXCARMPCCError:  Unknown Error in       * 00771500
*                             IXCA3PCC routine                        * 00771800
*                                                                     * 00772100
*                                                                     * 00773000
*                                                                     * 00774000
*                                                                     * 00775000
*                                                                     * 00776000
*01* REASON CODES:                                                    * 00779000
*                                                                     * 00780000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00784000
*                                                                     * 00785000
*02*   PROCESSOR:  ASSEM                                              * 00786000
*                                                                     * 00787000
*01* COMPONENT:  SCXCF                                                * 00788000
*                                                                     * 00789000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00790000
*                                                                     * 00791000
*01* MACRO USAGE NOTES:                                               * 00792000
*                                                                     * 00793000
*                                                                     * 00794000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00795000
*        global macro variable.  Any value other than 'NO' will       * 00796000
*        result in the macro expansion being printed.  The default is * 00797000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00798000
*        variable should be set.                                      * 00799000
*                                                                     * 00800000
*                    GBLC &ZPRINT                                     * 00801000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00802000
*                                                                     * 00810000
*                                                                     * 00811000
*    2.  All  keys currently contained in the IXCARM macro correspond * 00811700
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00812400
*        MAX.                                                         * 00812500
*                                                                     * 00812600
*                                                                     * 00812700
*                                                                     * 00812800
*                                                                     * 00812900
*01* CHANGE ACTIVITY:                                                 * 00813000
*                                                                     * 00814000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00815000
*                                                                     * 00816000
*    $L0=ARM      HBB5520 930514 PDNM:  Automatic Restart Manager     * 00816600
*    $D1=DN70019  HBB5520 930310 PDNM:  Removed modify form           * 00817300
*    $P1=PN70522  HBB5520 940920 PDCJ:  Do not allow                  * 00817400
*                                         STARTTXT(NO_STARTTXT) and   * 00817500
*                                         STARTTXTLEN(^0)             * 00817600
*    $D2=JES3D03  HBB5520 941017 PDCJ:                                * 00817800
*                                           Added RC=C RSN=164        * 00818000
*                                         (IXCARMBADJOB) for JES3     * 00818200
*                                         registration restriction    * 00818400
*    $P2=PN72081  HBB5520 941230 PDCJ:  Added reason codes            * 00818500
*                                         IXCARMWRONGELEMONREREG,     * 00818600
*                                         IXCARMWRONGADDRONREREG, and * 00818700
*                                         IXCARMREREGAFTERTIMOUT      * 00818800
*    $O1=OW13654  HBB5520 950613 PDCJ:                                * 00818900
*                                           Added SYSCICS as a        * 00819000
*                                         predefined element type     * 00819100
*                                           and support for element   * 00819200
*                                         names with underscores.     * 00819300
*    $O2=OW28526  HBB5520 970707 PDCJ:                                * 00819400
*                                           Added SYSIRLM and SYSLVL0 * 00819500
*                                         as a predefined element     * 00819600
*                                         types                       * 00819700
*    $03=OW32480  HBB5520 980410 PDCJ:                                * 00819800
*                                           Added reason codes for    * 00819900
*                                         non-authorized support      * 00820000
*    $04=OW36844  HBB6603 980331 PDXM:                                * 00820100
*                                           Added SYSMQMGR and        * 00820200
*                                         SYSMQCH predefined element  * 00820300
*                                         types                       * 00820400
*    $P2=PWK0624  HBB6608 990126 PDXM:                                * 00820500
*                                           Added SYSTCPIP predefined * 00820600
*                                         element type                * 00820700
*    $L1=ARMTV    JBB6609 990126 PDRB:                                * 00820800
*                                           Added TERMTYPE=SYSTERM,   * 00820900
*                                         ELEMBIND and RMTOKEN        * 00821000
*                                         keywords                    * 00821100
*    $P3=PWY0833  JBB6609 990908 PDRB:                                * 00821200
*                                           Added reason code for     * 00821300
*                                         unauthorized user of        * 00821400
*                                         RMTOKEN                     * 00821500
*    $05=OW39921  HBB6606 000115 PDXM:                                * 00821700
*                                           Added SYSCB and SYSLVL3   * 00821900
*                                         predefined element types    * 00822100
****** END OF SPECIFICATIONS *****************************************/ 00822300
*/* TLINE 1 *********************************************************** 00822500
         MACRO                                                          00822700
&XLABEL  IXCARM &REQUEST=,&ELEMENT=,&EVENTEXIT=,&EVENTEXITPL=,         *00822900
               &EXITPLLEN=,&STARTTXT=,&STARTTXTLEN=,&ELEMTYPE=,        *00823100
               &TERMTYPE=,&ELEMBIND=,&RMTOKEN=,&RESTARTTIMEOUT=,       *00823300
               &ANSAREA=,&TELEMENT=,&RETCODE=,&RSNCODE=,&PLISTVER=,    *00823500
               &MF=                                                     00823700
.*                                                                      00824000
*                    MACDATE -03/30/00-<1>                              00825000
.*                                                                      00826000
.*******************************************************************    00827000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00828000
.*******************************************************************    00829000
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00830000
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00831000
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00832000
.*                                                                      00833000
                    GBLC  &ZIXCARM    YES=MACRO USED AT LEAST ONCE      00834000
.*******************************************************************    00835000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00836000
.*******************************************************************    00837000
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00838000
                    LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS      00839000
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00840000
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00841000
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00842000
                    LCLA  &ZAWRK      USED AS A WORK AREA               00843000
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00844000
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00845000
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00846000
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00847000
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00848000
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00849000
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00850000
.*                                                                      00851000
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00852000
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00853000
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00854000
                    LCLC  &ZENDBASEPL           End of base PL          00854100
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00854200
.*******************************************************************    00854300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00854400
.*******************************************************************    00854500
                    LCLA  &ZI         INDEX FOR ARRAY                   00854600
                    LCLA  &ZJ         INDEX FOR PARMS                   00854700
                    LCLA  &ZK         INDEX FOR PARSE                   00854800
                    LCLA  &ZLO        LOW RANGE VALUE                   00854900
                    LCLA  &ZHI        HIGH RANGE VALUE                  00855000
                    LCLC  &ZW         WORK AREA FOR PARM                00855100
.********************************************************************   00855200
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00856000
.********************************************************************   00857000
                    GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL           00858000
                    GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE    00859000
                    GBLA  &SYSALVL    SYSSTATE ARCHLVL                  00859500
.*                                                                      00860000
                    AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED    00861000
                    AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED     00862000
                    SPLEVEL  TEST                                       00863000
.ZSYS2              ANOP  ,                                             00864000
                    AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1         00865000
                    AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1         00866000
                    SYSSTATE TEST                                       00867000
                    AGO   .ZSYS4                                        00868000
.ZSYS3              ANOP  ,                                             00869000
&SYSASCE            SETC  'P'         ASSUME SYSSTATE PRIMARY           00870000
.ZSYS4              ANOP  ,                                             00871000
.*******************************************************************    00872000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00873000
.*******************************************************************    00874000
                    LCLC  &XREQUEST   ++ VALUE                          00874800
                    LCLC  &XELEMENT   ++ NAME                           00875600
                    LCLC  &XEVENTEXIT           ++ NAME                 00876400
                    LCLC  &XEVENTEXITPL         ++ NAME                 00877200
                    LCLC  &XEXITPLLEN           ++ NAME                 00878000
                    LCLC  &XSTARTTXT  ++ NAME                           00878800
                    LCLC  &XSTARTTXTLEN         ++ NAME                 00879600
                    LCLC  &XELEMTYPE  ++ NAME                           00880400
                    LCLC  &XTERMTYPE  ++ VALUE                          00881200
                    LCLC  &XELEMBIND  ++ VALUE                          00881400
                    LCLC  &XRMTOKEN   ++ NAME                           00881600
                    LCLC  &XRESTARTTIMEOUT      ++ VALUE                00882000
                    LCLC  &XANSAREA   ++ NAME                           00882800
                    LCLC  &XTELEMENT  ++ NAME                           00883600
                    LCLC  &XRETCODE   ++ NAME                           00884400
                    LCLC  &XRSNCODE   ++ NAME                           00885200
                    LCLA  &XPLISTVER  ++ VALUE                          00885600
                    LCLC  &XMF        ++ VALUE                          00886000
                    LCLC  &XMFCTRL    ++ NAME                           00886800
                    LCLC  &XMFATTR    ++ VALUE                          00887600
                    LCLC  &XMFSCK     ++ VALUE                          00888400
.*******************************************************************    00891000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00892000
.*******************************************************************    00893000
                    LCLC  &ZXREQUEST  ++ INPUT VALUE                    00893800
                    LCLC  &ZXELEMENT  ++ INPUT NAME                     00894600
                    LCLC  &ZXEVENTEXIT          ++ INPUT NAME           00895400
                    LCLC  &ZXEVENTEXITPL        ++ INPUT NAME           00896200
                    LCLC  &ZXEXITPLLEN          ++ INPUT NAME           00897000
                    LCLC  &ZXSTARTTXT           ++ INPUT NAME           00897800
                    LCLC  &ZXSTARTTXTLEN        ++ INPUT NAME           00898600
                    LCLC  &ZXELEMTYPE           ++ INPUT NAME           00899400
                    LCLC  &ZXTERMTYPE           ++ INPUT VALUE          00900200
                    LCLC  &ZXELEMBIND           ++ INPUT VALUE          00900400
                    LCLC  &ZXRMTOKEN  ++ INOUT NAME                     00900600
                    LCLC  &ZXRESTARTTIMEOUT     ++ INPUT VALUE          00901000
                    LCLC  &ZXANSAREA  ++ OUTPUT NAME                    00901800
                    LCLC  &ZXTELEMENT           ++ INPUT NAME           00902600
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00903400
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00904200
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00904600
                    LCLC  &ZXMF       ++ INPUT VALUE                    00905000
                    LCLC  &ZXMFCTRL   ++ INPUT NAME                     00905800
                    LCLC  &ZXMFATTR   ++ INPUT VALUE                    00906600
                    LCLC  &ZXMFSCK    ++ INPUT VALUE                    00907400
.********************************************************************   00910000
.***AC.PLV01  PROCESS PLISTVER                                      *   00910100
.********************************************************************   00910200
&XPLISTVER      SETA  1                                                 00910300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00910400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00910500
&XPLISTVER      SETA  1                                                 00910600
.ZPLV0          ANOP  ,                                                 00910700
.*                                                                      00910800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00910900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00911000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00911100
.*-------------------------------------------------------------------   00911200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00911300
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00911400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00911500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00911600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00911700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00911800
                AGO   .ZPVCK2                                           00911900
.ZPVCK3         ANOP  ,                                                 00912000
.*-------------------------------------------------------------------   00912100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00912200
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00912300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00912400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00912500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00912600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00912700
                AGO   .ZPVCKE                                           00912800
.ZPVCK2         ANOP  ,                                                 00912900
.*-------------------------------------------------------------------   00913000
&ZCVAL          SETC  '&PLISTVER(1)'                                    00913100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00913200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00913300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00913400
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00913500
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00913600
.ZPVCK6         ANOP  ,                                                 00913700
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00913800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00913900
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00914000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00914100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00914200
&XPLISTVER      SETA  1                                                 00914300
                AGO   .ZPVCKE                                           00914400
.*-------------------------------------------------------------------   00914500
.ZPVCK4A        ANOP  ,                                                 00914600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00914700
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00914800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00914900
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00915000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00915100
                MNOTE 8,' &ZMS IS REQUIRED.'                            00915200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00915300
                AGO   .ZPVCK5                                           00915400
.ZPVCK4         ANOP  ,                                                 00915500
&XPLISTVER      SETA  &PLISTVER(1)                                      00915600
.ZPVCK5         ANOP  ,                                                 00915700
.ZPVCKE         ANOP  ,                                                 00915800
.********************************************************************   00915900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00916000
.********************************************************************   00916100
                    ACTR  10000                                         00916200
.*------------------------------------------------------------------    00916300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00916400
&XMF                SETC  ''          INITIALIZE XVARIABLE              00916500
.*-------------------------------------------------------------------   00917000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00918000
.ZG81               ANOP  ,                                             00919000
&ZTLC               SETC 'S'                                            00920000
                    AIF   ('&MF(1)' NE '&ZTLC').ZG82                    00921000
&XMF                SETC  'S'         SET KEYWORD                       00922000
                    AIF   (N'&MF LE 1).ZG81A    CK NUM                  00923500
&ZMS                SETC  '"MF='      *KPOSA* MNOTE                     00925000
&ZMS                SETC  '&ZMS.&MF"'                                   00926000
&ZMS                SETC  '&ZMS "MF"'                                   00927000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00928000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00929000
.ZG81A              ANOP  ,                                             00930000
.*-------------------------------------------------------------------   00931000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00932000
.ZG82               ANOP  ,                                             00933000
&ZTLC               SETC 'L'                                            00934000
                    AIF   ('&MF(1)' NE '&ZTLC').ZG89                    00935000
&XMF                SETC  'L'         SET KEYWORD                       00936000
                    AIF   (N'&MF LE 3).ZG82A    CK NUM                  00937000
&ZMS                SETC  '"MF='      *KPOSA* MNOTE                     00938000
&ZMS                SETC  '&ZMS.&MF"'                                   00939000
&ZMS                SETC  '&ZMS "MF"'                                   00940000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00941000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00942000
.ZG82A              ANOP  ,                                             00943000
.*-------------------------------------------------------------------   00944000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00945000
                    AIF   (N'&SYSLIST NE 0).ZG82B  POSITIONALS?         00945800
                    AIF   ('&REQUEST' NE '').ZG82B  KEYS?               00946600
                    AIF   ('&ELEMENT' NE '').ZG82B  KEYS?               00947400
                    AIF   ('&EVENTEXIT' NE '').ZG82B  KEYS?             00948200
                    AIF   ('&EVENTEXITPL' NE '').ZG82B  KEYS?           00949000
                    AIF   ('&EXITPLLEN' NE '').ZG82B  KEYS?             00949800
                    AIF   ('&STARTTXT' NE '').ZG82B  KEYS?              00950600
                    AIF   ('&STARTTXTLEN' NE '').ZG82B  KEYS?           00951400
                    AIF   ('&ELEMTYPE' NE '').ZG82B  KEYS?              00952200
                    AIF   ('&TERMTYPE' NE '').ZG82B  KEYS?              00953000
                    AIF   ('&ELEMBIND' NE '').ZG82B  KEYS?              00953800
                    AIF   ('&RMTOKEN' NE '').ZG82B  KEYS?               00954600
                    AIF   ('&RESTARTTIMEOUT' NE '').ZG82B  KEYS?        00955400
                    AIF   ('&ANSAREA' NE '').ZG82B  KEYS?               00956200
                    AIF   ('&TELEMENT' NE '').ZG82B  KEYS?              00957000
                    AIF   ('&RETCODE' NE '').ZG82B  KEYS?               00957800
                    AIF   ('&RSNCODE' NE '').ZG82B  KEYS?               00958600
                    AGO    .ZG82C     INVOCATION OKAY                   00959400
.ZG82B              ANOP  ,                                             00960200
&ZMS                SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE          00961200
&ZMS                SETC  '&ZMS CAN ONLY HAVE'                          00962100
&ZMS                SETC  '&ZMS THE "PLISTVER" KEY'                     00963000
                    MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'        00963900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00964800
.ZG82C              ANOP  ,                                             00965900
.*-------------------------------------------------------------------   00967000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00968000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00969000
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00970000
                    AIF   (N'&MF(2) GT 1).ZG84B  MULTI PARMS            00971000
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00972000
.ZG84B              AIF   (K'&MF(2) GT 0).ZG84C                         00973000
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00974000
&ZMS                SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*              00975000
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00976000
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00977000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00978000
.ZG84C              ANOP  ,                                             00979000
.*-------------------------------------------------------------------   00980000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00981000
                    AIF   (K'&ZXMFCTRL LE 0).ZG84P  NOT I/O             00982000
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG84P                00983000
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00984000
&ZMS                SETC  '"MF='      *KGPRA* MNOTE                     00985000
&ZMS                SETC  '&ZMS.&MF"'                                   00986000
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00987000
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'             00988000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00989000
.ZG84P              ANOP  ,                                             00990000
.*-------------------------------------------------------------------   00991000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00992000
&ZXMFATTR           SETC  'INPUT'     SET IN/OUTPUT                     00993000
&XMFATTR            SETC  '0D'                                          00994000
                    AIF   (K'&MF(3) LE 0).ZG87B  PARM                   00995000
&XMFATTR            SETC  '&MF(3,1)'  SET XVARIABLE                     00996000
                    AIF   (N'&MF(3) GT 1).ZG87B  MULTI PARMS            00997000
&XMFATTR            SETC  '&MF(3)'    SET XVARIABLE                     00998000
.ZG87B              ANOP  ,                                             00999000
.*-------------------------------------------------------------------   01000000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  01001000
                    AIF   (K'&ZXMFATTR LE 0).ZG87P  NOT I/O             01002000
                    AIF   ('&XMFATTR'(1,1) NE '(').ZG87P                01003000
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   01004000
&ZMS                SETC  '"MF='      *KGPRA* MNOTE                     01005000
&ZMS                SETC  '&ZMS.&MF"'                                   01006000
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     01007000
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'             01008000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01009000
.ZG87P              ANOP  ,                                             01010000
.*-------------------------------------------------------------------   01011000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 01012000
                    AIF   (K'&ZXMFATTR LE 0).ZG87S  NOT I/O             01013000
                    AIF   (K'&XMFATTR LE 60).ZG87S  LNG OK              01014000
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   01015000
&ZMS                SETC  '"MF='      *KLNGA* MNOTE                     01016000
&ZMS                SETC  '&ZMS.&MF"'                                   01017000
&ZMS                SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'         01018000
                    MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'            01019000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01020000
.ZG87S              ANOP  ,                                             01021000
.*-------------------------------------------------------------------   01022000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01023000
.ZG89               ANOP  ,                                             01024000
&ZTLC               SETC 'E'                                            01025000
                    AIF   ('&MF(1)' NE '&ZTLC').ZG97                    01026000
&XMF                SETC  'E'         SET KEYWORD                       01027000
                    AIF   (N'&MF LE 3).ZG89A    CK NUM                  01028000
&ZMS                SETC  '"MF='      *KPOSA* MNOTE                     01029000
&ZMS                SETC  '&ZMS.&MF"'                                   01030000
&ZMS                SETC  '&ZMS "MF"'                                   01031000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          01032000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01033000
.ZG89A              ANOP  ,                                             01034000
.*-------------------------------------------------------------------   01035000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   01036000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     01037000
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     01038000
                    AIF   (N'&MF(2) GT 1).ZG91B  MULTI PARMS            01039000
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     01040000
.ZG91B              AIF   (K'&MF(2) GT 0).ZG91C                         01041000
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   01042000
&ZMS                SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*              01043000
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           01044000
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  01045000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01046000
.ZG91C              ANOP  ,                                             01047000
.*-------------------------------------------------------------------   01048000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              01049000
                    AIF   (K'&ZXMFCTRL LE 0).ZG91R  NOT I/O             01050000
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG91R                01051000
&ZCGPR              SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                    01052000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG91P                  01053000
                    AIF   (K'&ZCGPR GT 2).ZG91Q                         01054000
                    AIF   ('&ZCGPR' EQ '0').ZG91Q                       01055000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01056000
                    AIF   (T'&ZCGPR NE 'N').ZG91Q  INVALID REG NAME     01057000
.ZG91P              ANOP  ,                                             01058000
                    AIF   (T'&ZCGPR NE 'N').ZG91R  NON NUMERIC          01059000
                    AIF   ('&ZCGPR' LT '1').ZG91Q                       01060000
                    AIF   ('&ZCGPR' LE '12').ZG91R                      01061000
.ZG91Q              ANOP  ,                                             01062000
&ZMS                SETC  '"MF='      *KGPRA* MNOTE                     01063000
&ZMS                SETC  '&ZMS.&MF"'                                   01064000
&ZMS                SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'     01065000
                    MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'              01066000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01067000
.ZG91R              ANOP  ,                                             01068000
.*-------------------------------------------------------------------   01069000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01070000
&XMFSCK             SETC  ''          INITIALIZE XVARIABLE              01071000
.ZG95A   AIF   ('&MF(3)' NE 'COMPLETE').ZG96A                           01072000
&XMFSCK             SETC  'COMPLETE'  SET KEYWORD                       01073000
.*-------------------------------------------------------------------   01074000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01079000
.ZG96A              AIF   (K'&XMFSCK GT 0).ZG96C  KEYWORD               01080000
                    AIF   (K'&MF(3) LE 0).ZG96B                         01081000
&ZMS                SETC  '"MF='      *KUKWA* MNOTE                     01082000
&ZMS                SETC  '&ZMS.&MF"'                                   01083000
&ZMS                SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '     01084000
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           01085000
&ZMS                SETC  '&ZMS "COMPLETE".'                            01086500
                    MNOTE 8,' &ZMS '                                    01088000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01089000
.ZG96B              ANOP  ,                                             01090000
&XMFSCK             SETC  'COMPLETE'  SET DEFAULT KEYWORD               01091000
.ZG96C              ANOP  ,                                             01128000
&ZXMFSCK            SETC  'INPUT'     SET IN/OUTPUT                     01165000
.*------------------------------------------------------------------    01166000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01167000
.ZG97               ANOP  ,                                             01168000
&ZXMF               SETC  'INPUT'     SET IN/OUTPUT                     01169000
                    AIF   (K'&XMF GT 0).ZG97E   VALID ARG               01170000
                    AIF   (T'&MF EQ 'O').ZG97D  OMITTED                 01171000
&ZASYSLNDX          SETA  0                                             01172000
.ZG97A              ANOP  ,           POSITIONAL MACRO KEY              01173000
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  01174000
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG97C              01175000
&ZTLC               SETC 'MF'                                           01176000
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG97A     01177000
.ZG97B              ANOP  ,                                             01178000
&ZXMF               SETC  ''          RESET IN/OUTPUT                   01179000
&ZMS                SETC  'THE "MF" KEY'        *KOPTA* MNOTE           01180000
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       01181000
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              01182000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01183000
                    AGO   .ZG97E                                        01184000
.ZG97C              ANOP  ,                                             01185000
&ZXMF               SETC  ''          RESET IN/OUTPUT                   01186000
&ZMS                SETC  '"MF='      *KUKWA* MNOTE                     01187000
&ZMS                SETC  '&ZMS.&MF"'                                   01188000
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     01189000
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           01190000
&ZMS                SETC  '&ZMS "S",'                                   01191200
&ZMS                SETC  '&ZMS "L",'                                   01192400
&ZMS                SETC  '&ZMS OR "E".'                                01193600
                    MNOTE 8,' &ZMS '                                    01195000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01196000
                    AGO   .ZG97E                                        01197000
.ZG97D              ANOP  ,                                             01198000
&XMF                SETC  'S'         SET DEFAULT KEYWORD               01199000
&XMFSCK             SETC  'COMPLETE'  COMPLETE CHECKING                 01200000
.ZG97E              ANOP  ,                                             01201000
.********************************************************************   01202000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 01203000
.********************************************************************   01204000
                    ACTR  10000                                         01205000
.*-------------------------------------------------------------------   01206000
.***AG.MF03 MF=(SLE)                                                    01207000
                    AIF   ('&XMF' EQ 'L').ZGMFX                         01208000
.*------------------------------------------------------------------    01210000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01211000
&XREQUEST           SETC  ''          INITIALIZE XVARIABLE              01212000
.*-------------------------------------------------------------------   01213000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01214000
.ZG3                ANOP  ,                                             01215000
                    AIF   (K'&REQUEST(1) LE 0).ZG3A                     01216000
&ZTLC               SETC 'REGISTER'                                     01217000
                    AIF   ('&REQUEST(1)' NE '&ZTLC').ZG50               01218000
&XREQUEST           SETC  'REGISTER'  SET KEYWORD                       01219000
                    AIF   (N'&REQUEST LE 1).ZG3A  CK NUM                01220000
&ZMS                SETC  '"REQUEST='           *KPOSA* MNOTE           01221000
&ZMS                SETC  '&ZMS.&REQUEST"'                              01222000
&ZMS                SETC  '&ZMS "REQUEST"'                              01223000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01224000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01225000
.ZG3A               ANOP  ,                                             01226000
.*------------------------------------------------------------------    01227000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01228000
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       01229000
.ZG3A0              AIF   (K'&TELEMENT LE 0).ZG3A1  OK                  01230000
&ZCVAL              SETC '&ZCVAL TELEMENT'      INCORRECT KEY USED      01231000
.ZG3A1              AIF   (K'&ZCVAL LE 0).ZG3A2  OK                     01232000
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         01233000
&ZMS                SETC  '"REQUEST'  *KMEIA* MNOTE                     01234000
&ZMS                SETC  '&ZMS.=&REQUEST"'                             01235000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          01236000
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          01237000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01238000
.ZG3A2              ANOP  ,                                             01239000
.*----------------------------------------------------------------***   01240000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01241000
                    AIF   (N'&ELEMENT LE 1).ZG5A  CK NUM                01242000
&ZMS                SETC  '"ELEMENT='           *KPOSA* MNOTE           01243000
&ZMS                SETC  '&ZMS.&ELEMENT"'                              01244000
&ZMS                SETC  '&ZMS "ELEMENT"'                              01245000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01246000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01247000
.ZG5A               ANOP  ,                                             01248000
.*-------------------------------------------------------------------   01249000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01250000
&ZXELEMENT          SETC  'INPUT'     SET IN/OUTPUT                     01251000
&XELEMENT           SETC  '&ELEMENT(1)'         SET XVARIABLE           01252000
                    AIF   (N'&ELEMENT GT 1).ZG5B  MULTI PARMS           01253000
&XELEMENT           SETC  '&ELEMENT'  SET XVARIABLE                     01254000
.ZG5B               AIF   (K'&ELEMENT(1) GT 0).ZG5C                     01255000
&ZXELEMENT          SETC  ''          RESET IN/OUTPUT                   01256000
&ZMS                SETC  ' '         *KRQDA*                           01257000
&ZMS                SETC  '&ZMS "ELEMENT" KEY AND ITS'                  01258000
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              01259000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01260000
.ZG5C               ANOP  ,                                             01261000
.*-------------------------------------------------------------------   01262000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01263000
                    AIF   (K'&ZXELEMENT LE 0).ZG5R  NOT I/O             01264000
                    AIF   ('&XELEMENT'(1,1) NE '(').ZG5R                01265000
&ZCGPR              SETC  '&XELEMENT'(2,K'&XELEMENT-2)                  01266000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                   01267000
                    AIF   (K'&ZCGPR GT 2).ZG5Q                          01268000
                    AIF   ('&ZCGPR' EQ '0').ZG5Q                        01269000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01270000
                    AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME      01271000
.ZG5P               ANOP  ,                                             01272000
                    AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC           01273000
                    AIF   ('&ZCGPR' LT '2').ZG5Q                        01274000
                    AIF   ('&ZCGPR' LE '12').ZG5R                       01275000
.ZG5Q               ANOP  ,                                             01276000
&ZMS                SETC  '"ELEMENT='           *KGPRA* MNOTE           01277000
&ZMS                SETC  '&ZMS.&ELEMENT"'                              01278000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01279000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01280000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01281000
.ZG5R               ANOP  ,                                             01282000
.*----------------------------------------------------------------***   01283000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01284000
                    AIF   (N'&EVENTEXIT LE 1).ZG8A  CK NUM              01285000
&ZMS                SETC  '"EVENTEXIT='         *KPOSA* MNOTE           01286000
&ZMS                SETC  '&ZMS.&EVENTEXIT"'                            01287000
&ZMS                SETC  '&ZMS "EVENTEXIT"'                            01288000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01289000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01290000
.ZG8A               ANOP  ,                                             01291000
.*-------------------------------------------------------------------   01292000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01293000
&ZXEVENTEXIT        SETC  'INPUT'     SET IN/OUTPUT                     01294000
&XEVENTEXIT         SETC  'NO_EVENTEXIT'                                01295000
                    AIF   (K'&EVENTEXIT(1) LE 0).ZG8B  PARM             01296000
&XEVENTEXIT         SETC  '&EVENTEXIT(1)'       SET XVARIABLE           01297000
                    AIF   (N'&EVENTEXIT GT 1).ZG8B  MULTI PARMS         01298000
&XEVENTEXIT         SETC  '&EVENTEXIT'          SET XVARIABLE           01299000
.ZG8B               ANOP  ,                                             01300000
.*-------------------------------------------------------------------   01301000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01302000
                    AIF   (K'&ZXEVENTEXIT LE 0).ZG8R  NOT I/O           01303000
         AIF   ('&XEVENTEXIT' EQ 'NO_EVENTEXIT').ZG8R                   01304000
                    AIF   ('&XEVENTEXIT'(1,1) NE '(').ZG8R              01305000
&ZCGPR              SETC  '&XEVENTEXIT'(2,K'&XEVENTEXIT-2)              01306000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                   01307000
                    AIF   (K'&ZCGPR GT 2).ZG8Q                          01308000
                    AIF   ('&ZCGPR' EQ '0').ZG8Q                        01309000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01310000
                    AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME      01311000
.ZG8P               ANOP  ,                                             01312000
                    AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC           01313000
                    AIF   ('&ZCGPR' LT '2').ZG8Q                        01314000
                    AIF   ('&ZCGPR' LE '12').ZG8R                       01315000
.ZG8Q               ANOP  ,                                             01316000
&ZMS                SETC  '"EVENTEXIT='         *KGPRA* MNOTE           01317000
&ZMS                SETC  '&ZMS.&EVENTEXIT"'                            01318000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01319000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01320000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01321000
.ZG8R               ANOP  ,                                             01322000
.*----------------------------------------------------------------***   01323000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01324000
                    AIF   (N'&EVENTEXITPL LE 1).ZG10A  CK NUM           01326100
&ZMS                SETC  '"EVENTEXITPL='       *KPOSA* MNOTE           01328200
&ZMS                SETC  '&ZMS.&EVENTEXITPL"'                          01328300
&ZMS                SETC  '&ZMS "EVENTEXITPL"'                          01328400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01329000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01330000
.ZG10A              ANOP  ,                                             01331000
.*-------------------------------------------------------------------   01332000
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         01333000
&XEVENTEXITPL       SETC  'NO_EVENTEXITPL'      SET DEFAULT             01334000
                    AIF   (K'&EVENTEXITPL(1) LE 0).ZG10C  PARM          01335000
&XEVENTEXITPL       SETC  '&EVENTEXITPL(1)'     SET XVARIABLE           01336000
                    AIF   (N'&EVENTEXITPL GT 1).ZG10B  MULTI PARMS      01337000
&XEVENTEXITPL       SETC  '&EVENTEXITPL'        SET XVARIABLE           01338000
.ZG10B              AIF   (K'&EVENTEXIT(1) GT 0).ZG10C  KEY             01339000
&ZMS                SETC  '"EVENTEXITPL'        *KDEPA* MNOTE           01340000
&ZMS                SETC  '&ZMS.=&EVENTEXITPL"'                         01341000
&ZMS                SETC  '&ZMS CAN ONLY BE SPECIFIED IF'               01342000
&ZMS                SETC  '&ZMS '                                       01343000
&ZMS                SETC  '&ZMS "EVENTEXIT"'                            01344000
                    MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                  01345000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01346000
.ZG10C              ANOP  ,                                             01347000
&ZXEVENTEXITPL      SETC  'INPUT'     SET IN/OUTPUT                     01348000
.*-------------------------------------------------------------------   01349000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01350000
                    AIF   (K'&ZXEVENTEXITPL LE 0).ZG10R  NOT I/O        01351000
         AIF   ('&XEVENTEXITPL' EQ 'NO_EVENTEXITPL').ZG10R              01352000
                    AIF   ('&XEVENTEXITPL'(1,1) NE '(').ZG10R           01353000
&ZCGPR              SETC  '&XEVENTEXITPL'(2,K'&XEVENTEXITPL-2)          01354000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                  01355000
                    AIF   (K'&ZCGPR GT 2).ZG10Q                         01356000
                    AIF   ('&ZCGPR' EQ '0').ZG10Q                       01357000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01358000
                    AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME     01359000
.ZG10P              ANOP  ,                                             01360000
                    AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC          01361000
                    AIF   ('&ZCGPR' LT '2').ZG10Q                       01362000
                    AIF   ('&ZCGPR' LE '12').ZG10R                      01363000
.ZG10Q              ANOP  ,                                             01364000
&ZMS                SETC  '"EVENTEXITPL='       *KGPRA* MNOTE           01365000
&ZMS                SETC  '&ZMS.&EVENTEXITPL"'                          01366000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01367000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01368000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01369000
.ZG10R              ANOP  ,                                             01370000
.*----------------------------------------------------------------***   01371000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 01372000
                    AIF   (N'&EXITPLLEN LE 1).ZG12A  CK NUM             01373000
&ZMS                SETC  '"EXITPLLEN='         *KPOSA* MNOTE           01374000
&ZMS                SETC  '&ZMS.&EXITPLLEN"'                            01375000
&ZMS                SETC  '&ZMS "EXITPLLEN"'                            01376000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01377000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01378000
.ZG12A              ANOP  ,                                             01379000
.*-------------------------------------------------------------------   01380000
.***AG.KXVAR09 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     01381000
&ZXEXITPLLEN        SETC  'INPUT'     SET IN/OUTPUT                     01382000
&XEXITPLLEN         SETC  '&EXITPLLEN(1)'       SET XVARIABLE           01383000
                    AIF   (N'&EXITPLLEN GT 1).ZG12B  MULTI PARMS        01384000
&XEXITPLLEN         SETC  '&EXITPLLEN'          SET XVARIABLE           01385000
.ZG12B              AIF   (K'&EVENTEXITPL(1) GT 0).ZG12C  KEY           01386000
                    AIF   (K'&EXITPLLEN(1) LE 0).ZG12D  PARM            01387000
&ZMS                SETC  '"EXITPLLEN'          *KDEPA* MNOTE           01388000
&ZMS                SETC  '&ZMS.=&EXITPLLEN"'                           01389000
&ZMS                SETC  '&ZMS CAN ONLY BE SPECIFIED IF'               01390000
&ZMS                SETC  '&ZMS '                                       01391000
&ZMS                SETC  '&ZMS "EVENTEXITPL"'                          01392000
                    MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                  01393000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01394000
                    AGO   .ZG12E                                        01395000
.*                                                                      01396000
.ZG12C              AIF   (K'&EXITPLLEN(1) GT 0).ZG12E  PARM            01397000
&ZXEXITPLLEN        SETC  ''          RESET IN/OUTPUT                   01398000
&ZMS                SETC  'WHEN "EVENTEXITPL" IS SPECIFIED'  *KRQDA*    01399000
&ZMS                SETC  '&ZMS , "EXITPLLEN" KEY AND ITS'              01400000
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              01401000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01402000
.ZG12D              ANOP  ,                                             01403000
&XEXITPLLEN         SETC  '0'         SET DEFAULT                       01404000
.ZG12E              ANOP  ,                                             01405000
.*-------------------------------------------------------------------   01406000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                01407000
                    AIF   (K'&ZXEXITPLLEN LE 0).ZG12R  NOT I/O          01408000
                    AIF   ('&XEXITPLLEN'(1,1) NE '(').ZG12R             01409000
&ZCGPR              SETC  '&XEXITPLLEN'(2,K'&XEXITPLLEN-2)              01410000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                  01411000
                    AIF   (K'&ZCGPR GT 2).ZG12Q                         01412000
                    AIF   ('&ZCGPR' EQ '0').ZG12Q                       01413000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01414000
                    AIF   (T'&ZCGPR NE 'N').ZG12Q  INVALID REG NAME     01415000
.ZG12P              ANOP  ,                                             01416000
                    AIF   (T'&ZCGPR NE 'N').ZG12R  NON NUMERIC          01417000
                    AIF   ('&ZCGPR' LT '2').ZG12Q                       01418000
                    AIF   ('&ZCGPR' LE '12').ZG12R                      01419000
.ZG12Q              ANOP  ,                                             01420000
&ZMS                SETC  '"EXITPLLEN='         *KGPRA* MNOTE           01421000
&ZMS                SETC  '&ZMS.&EXITPLLEN"'                            01422000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01423000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01424000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01425000
.ZG12R              ANOP  ,                                             01426000
.*----------------------------------------------------------------***   01427000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01428000
                    AIF   (N'&STARTTXT LE 1).ZG17A  CK NUM              01429000
&ZMS                SETC  '"STARTTXT='          *KPOSA* MNOTE           01430000
&ZMS                SETC  '&ZMS.&STARTTXT"'                             01431000
&ZMS                SETC  '&ZMS "STARTTXT"'                             01432000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01433000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01434000
.ZG17A              ANOP  ,                                             01435000
.*-------------------------------------------------------------------   01436000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01437000
&ZXSTARTTXT         SETC  'INPUT'     SET IN/OUTPUT                     01438000
&XSTARTTXT          SETC  'NO_STARTTXT'                                 01439000
                    AIF   (K'&STARTTXT(1) LE 0).ZG17B  PARM             01440000
&XSTARTTXT          SETC  '&STARTTXT(1)'        SET XVARIABLE           01441000
                    AIF   (N'&STARTTXT GT 1).ZG17B  MULTI PARMS         01442000
&XSTARTTXT          SETC  '&STARTTXT'           SET XVARIABLE           01443000
.ZG17B              ANOP  ,                                             01444000
.*-------------------------------------------------------------------   01445000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01446000
                    AIF   (K'&ZXSTARTTXT LE 0).ZG17R  NOT I/O           01447000
         AIF   ('&XSTARTTXT' EQ 'NO_STARTTXT').ZG17R                    01448000
                    AIF   ('&XSTARTTXT'(1,1) NE '(').ZG17R              01449000
&ZCGPR              SETC  '&XSTARTTXT'(2,K'&XSTARTTXT-2)                01450000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                  01451000
                    AIF   (K'&ZCGPR GT 2).ZG17Q                         01452000
                    AIF   ('&ZCGPR' EQ '0').ZG17Q                       01453000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01454000
                    AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME     01455000
.ZG17P              ANOP  ,                                             01456000
                    AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC          01457000
                    AIF   ('&ZCGPR' LT '2').ZG17Q                       01458000
                    AIF   ('&ZCGPR' LE '12').ZG17R                      01459000
.ZG17Q              ANOP  ,                                             01460000
&ZMS                SETC  '"STARTTXT='          *KGPRA* MNOTE           01461000
&ZMS                SETC  '&ZMS.&STARTTXT"'                             01462000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01463000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01464000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01465000
.ZG17R              ANOP  ,                                             01466000
.*----------------------------------------------------------------***   01467000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 01468000
                    AIF   (N'&STARTTXTLEN LE 1).ZG19A  CK NUM           01469000
&ZMS                SETC  '"STARTTXTLEN='       *KPOSA* MNOTE           01470000
&ZMS                SETC  '&ZMS.&STARTTXTLEN"'                          01471000
&ZMS                SETC  '&ZMS "STARTTXTLEN"'                          01472000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01473000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01474000
.ZG19A              ANOP  ,                                             01475000
.*-------------------------------------------------------------------   01476000
.***AG.KXVAR09 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     01477000
&ZXSTARTTXTLEN      SETC  'INPUT'     SET IN/OUTPUT                     01478000
&XSTARTTXTLEN       SETC  '&STARTTXTLEN(1)'     SET XVARIABLE           01479000
                    AIF   (N'&STARTTXTLEN GT 1).ZG19B  MULTI PARMS      01480000
&XSTARTTXTLEN       SETC  '&STARTTXTLEN'        SET XVARIABLE           01481000
.ZG19B              AIF   (K'&STARTTXT(1) GT 0).ZG19C  KEY              01482000
                    AIF   (K'&STARTTXTLEN(1) LE 0).ZG19D  PARM          01483000
&ZMS                SETC  '"STARTTXTLEN'        *KDEPA* MNOTE           01484000
&ZMS                SETC  '&ZMS.=&STARTTXTLEN"'                         01485000
&ZMS                SETC  '&ZMS CAN ONLY BE SPECIFIED IF'               01486000
&ZMS                SETC  '&ZMS '                                       01487000
&ZMS                SETC  '&ZMS "STARTTXT"'                             01488000
                    MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                  01489000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01490000
                    AGO   .ZG19E                                        01491000
.*                                                                      01492000
.ZG19C              AIF   (K'&STARTTXTLEN(1) GT 0).ZG19E  PARM          01493000
&ZXSTARTTXTLEN      SETC  ''          RESET IN/OUTPUT                   01494000
&ZMS                SETC  'WHEN "STARTTXT" IS SPECIFIED'  *KRQDA*       01495000
&ZMS                SETC  '&ZMS , "STARTTXTLEN" KEY AND ITS'            01496000
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              01497000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01498000
.ZG19D              ANOP  ,                                             01499000
&XSTARTTXTLEN       SETC  '0'         SET DEFAULT                       01500000
.ZG19E              ANOP  ,                                             01501000
.*-------------------------------------------------------------------   01502000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                01503000
                    AIF   (K'&ZXSTARTTXTLEN LE 0).ZG19R  NOT I/O        01504000
                    AIF   ('&XSTARTTXTLEN'(1,1) NE '(').ZG19R           01505000
&ZCGPR              SETC  '&XSTARTTXTLEN'(2,K'&XSTARTTXTLEN-2)          01506000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                  01507000
                    AIF   (K'&ZCGPR GT 2).ZG19Q                         01508000
                    AIF   ('&ZCGPR' EQ '0').ZG19Q                       01509000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01510000
                    AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME     01511000
.ZG19P              ANOP  ,                                             01512000
                    AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC          01513000
                    AIF   ('&ZCGPR' LT '2').ZG19Q                       01514000
                    AIF   ('&ZCGPR' LE '12').ZG19R                      01515000
.ZG19Q              ANOP  ,                                             01516000
&ZMS                SETC  '"STARTTXTLEN='       *KGPRA* MNOTE           01517000
&ZMS                SETC  '&ZMS.&STARTTXTLEN"'                          01518000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01519000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01520000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01521000
.ZG19R              ANOP  ,                                             01522000
.*----------------------------------------------------------------***   01523000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01524000
                    AIF   (N'&ELEMTYPE LE 1).ZG23A  CK NUM              01525000
&ZMS                SETC  '"ELEMTYPE='          *KPOSA* MNOTE           01526000
&ZMS                SETC  '&ZMS.&ELEMTYPE"'                             01527000
&ZMS                SETC  '&ZMS "ELEMTYPE"'                             01528000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01529000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01530000
.ZG23A              ANOP  ,                                             01531000
.*-------------------------------------------------------------------   01532000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01533000
&ZXELEMTYPE         SETC  'INPUT'     SET IN/OUTPUT                     01534000
&XELEMTYPE          SETC  'NO_ELEMTYPE'                                 01535000
                    AIF   (K'&ELEMTYPE(1) LE 0).ZG23B  PARM             01536000
&XELEMTYPE          SETC  '&ELEMTYPE(1)'        SET XVARIABLE           01537000
                    AIF   (N'&ELEMTYPE GT 1).ZG23B  MULTI PARMS         01538000
&XELEMTYPE          SETC  '&ELEMTYPE'           SET XVARIABLE           01539000
.ZG23B              ANOP  ,                                             01540000
.*-------------------------------------------------------------------   01541000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01542000
                    AIF   (K'&ZXELEMTYPE LE 0).ZG23R  NOT I/O           01543000
         AIF   ('&XELEMTYPE' EQ 'NO_ELEMTYPE').ZG23R                    01544000
                    AIF   ('&XELEMTYPE'(1,1) NE '(').ZG23R              01545000
&ZCGPR              SETC  '&XELEMTYPE'(2,K'&XELEMTYPE-2)                01546000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                  01547000
                    AIF   (K'&ZCGPR GT 2).ZG23Q                         01548000
                    AIF   ('&ZCGPR' EQ '0').ZG23Q                       01549000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01550000
                    AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME     01551000
.ZG23P              ANOP  ,                                             01552000
                    AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC          01553000
                    AIF   ('&ZCGPR' LT '2').ZG23Q                       01554000
                    AIF   ('&ZCGPR' LE '12').ZG23R                      01555000
.ZG23Q              ANOP  ,                                             01556000
&ZMS                SETC  '"ELEMTYPE='          *KGPRA* MNOTE           01557000
&ZMS                SETC  '&ZMS.&ELEMTYPE"'                             01558000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01559000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01560000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01561000
.ZG23R              ANOP  ,                                             01562000
.*----------------------------------------------------------------***   01563000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01564000
                    AIF   (N'&TERMTYPE LE 1).ZG26A  CK NUM              01565000
&ZMS                SETC  '"TERMTYPE='          *KPOSA* MNOTE           01566000
&ZMS                SETC  '&ZMS.&TERMTYPE"'                             01567000
&ZMS                SETC  '&ZMS "TERMTYPE"'                             01568000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01569000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01570000
.ZG26A              ANOP  ,                                             01571000
.*-------------------------------------------------------------------   01572000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01573000
&XTERMTYPE          SETC  ''          INITIALIZE XVARIABLE              01574000
.ZG27A   AIF   ('&TERMTYPE(1)' NE 'ALLTERM').ZG28A                      01575000
&XTERMTYPE          SETC  'ALLTERM'   SET KEYWORD                       01576000
.*-------------------------------------------------------------------   01577000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01578000
.ZG28A   AIF   ('&TERMTYPE(1)' NE 'ELEMTERM').ZG29A                     01579000
&XTERMTYPE          SETC  'ELEMTERM'  SET KEYWORD                       01580000
.*-------------------------------------------------------------------   01581000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01581200
.ZG29A   AIF   ('&TERMTYPE(1)' NE 'SYSTERM').ZG30A                      01581400
&XTERMTYPE          SETC  'SYSTERM'   SET KEYWORD                       01581600
.*-------------------------------------------------------------------   01581800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01582000
.ZG30A              AIF   (K'&XTERMTYPE GT 0).ZG30C  KEYWORD            01582100
                    AIF   (K'&TERMTYPE(1) LE 0).ZG30B                   01582200
&ZMS                SETC  '"TERMTYPE='          *KUKWA* MNOTE           01582300
&ZMS                SETC  '&ZMS.&TERMTYPE"'                             01582400
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     01582500
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           01582600
&ZMS                SETC  '&ZMS "ALLTERM",'                             01582700
&ZMS                SETC  '&ZMS "ELEMTERM",'                            01582800
&ZMS                SETC  '&ZMS OR "SYSTERM".'                          01582900
                    MNOTE 8,' &ZMS '                                    01583000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01583100
.ZG30B              ANOP  ,                                             01583200
&XTERMTYPE          SETC  'ALLTERM'   SET DEFAULT KEYWORD               01583300
.ZG30C              ANOP  ,                                             01583400
&ZXTERMTYPE         SETC  'INPUT'     SET IN/OUTPUT                     01583500
.*------------------------------------------------------------------    01583600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01583700
&XELEMBIND          SETC  ''          INITIALIZE XVARIABLE              01583800
.*-------------------------------------------------------------------   01583900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01584000
.ZG33               ANOP  ,                                             01584100
                    AIF   (K'&ELEMBIND(1) LE 0).ZG33A                   01584200
&ZTLC               SETC 'CURJOB'                                       01584300
                    AIF   ('&ELEMBIND(1)' NE '&ZTLC').ZG37              01584400
&XELEMBIND          SETC  'CURJOB'    SET KEYWORD                       01584500
                    AIF   (N'&ELEMBIND LE 1).ZG33A  CK NUM              01584600
&ZMS                SETC  '"ELEMBIND='          *KPOSA* MNOTE           01584700
&ZMS                SETC  '&ZMS.&ELEMBIND"'                             01584800
&ZMS                SETC  '&ZMS "ELEMBIND"'                             01584900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01585000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01585100
.ZG33A              ANOP  ,                                             01585200
.*----------------------------------------------------------------***   01585300
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     01585400
                    AIF   (N'&RMTOKEN LE 1).ZG35A  CK NUM               01585500
&ZMS                SETC  '"RMTOKEN='           *KPOSA* MNOTE           01585600
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01585700
&ZMS                SETC  '&ZMS "RMTOKEN"'                              01585800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01585900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01586000
.ZG35A              ANOP  ,                                             01586100
.*-------------------------------------------------------------------   01586200
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         01586300
&ZXRMTOKEN          SETC  'INOUT'     SET IN/OUTPUT                     01586400
&XRMTOKEN           SETC  'NO_RMTOKEN'                                  01586500
                    AIF   (K'&RMTOKEN(1) LE 0).ZG35B  PARM              01586600
&XRMTOKEN           SETC  '&RMTOKEN(1)'         SET XVARIABLE           01586700
                    AIF   (N'&RMTOKEN GT 1).ZG35B  MULTI PARMS          01586800
&XRMTOKEN           SETC  '&RMTOKEN'  SET XVARIABLE                     01586900
.ZG35B              ANOP  ,                                             01587000
.*-------------------------------------------------------------------   01587100
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    01587200
                    AIF   (K'&ZXRMTOKEN LE 0).ZG35R  NOT I/O            01587300
         AIF   ('&XRMTOKEN' EQ 'NO_RMTOKEN').ZG35R                      01587400
                    AIF   ('&XRMTOKEN'(1,1) NE '(').ZG35R               01587500
&ZCGPR              SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                  01587600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                  01587700
                    AIF   (K'&ZCGPR GT 2).ZG35Q                         01587800
                    AIF   ('&ZCGPR' EQ '0').ZG35Q                       01587900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01588000
                    AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME     01588100
.ZG35P              ANOP  ,                                             01588200
                    AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC          01588300
                    AIF   ('&ZCGPR' LT '2').ZG35Q                       01588400
                    AIF   ('&ZCGPR' LE '12').ZG35R                      01588500
.ZG35Q              ANOP  ,                                             01588600
&ZMS                SETC  '"RMTOKEN='           *KGPRA* MNOTE           01588700
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01588800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01588900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01589000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01589100
.ZG35R              ANOP  ,                                             01589200
.*-------------------------------------------------------------------   01589300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01589400
.ZG37               ANOP  ,                                             01589500
&ZTLC               SETC 'CURSYS'                                       01589600
                    AIF   ('&ELEMBIND(1)' NE '&ZTLC').ZG41              01589700
&XELEMBIND          SETC  'CURSYS'    SET KEYWORD                       01589800
                    AIF   (N'&ELEMBIND LE 1).ZG37A  CK NUM              01589900
&ZMS                SETC  '"ELEMBIND='          *KPOSA* MNOTE           01590000
&ZMS                SETC  '&ZMS.&ELEMBIND"'                             01590100
&ZMS                SETC  '&ZMS "ELEMBIND"'                             01590200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01590300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01590400
.ZG37A              ANOP  ,                                             01590500
.*----------------------------------------------------------------***   01590600
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                01590700
                    AIF   (N'&RMTOKEN LE 1).ZG39A  CK NUM               01590800
&ZMS                SETC  '"RMTOKEN='           *KPOSA* MNOTE           01590900
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01591000
&ZMS                SETC  '&ZMS "RMTOKEN"'                              01591100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01591200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01591300
.ZG39A              ANOP  ,                                             01591400
.*-------------------------------------------------------------------   01591500
.***AG.KXVAR06 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    01591600
&ZXRMTOKEN          SETC  'OUTPUT'    SET IN/OUTPUT                     01591700
&XRMTOKEN           SETC  '&RMTOKEN(1)'         SET XVARIABLE           01591800
                    AIF   (N'&RMTOKEN GT 1).ZG39B  MULTI PARMS          01591900
&XRMTOKEN           SETC  '&RMTOKEN'  SET XVARIABLE                     01592000
.ZG39B              AIF   (K'&RMTOKEN(1) GT 0).ZG39C                    01592100
&ZXRMTOKEN          SETC  ''          RESET IN/OUTPUT                   01592200
&ZMS                SETC  'WHEN "CURSYS" IS SPECIFIED'  *KRQDA*         01592300
&ZMS                SETC  '&ZMS , "RMTOKEN" KEY AND ITS'                01592400
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              01592500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01592600
.ZG39C              ANOP  ,                                             01592700
.*-------------------------------------------------------------------   01592800
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               01592900
                    AIF   (K'&ZXRMTOKEN LE 0).ZG39R  NOT I/O            01593000
                    AIF   ('&XRMTOKEN'(1,1) NE '(').ZG39R               01593100
&ZCGPR              SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                  01593200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG39P                  01593300
                    AIF   (K'&ZCGPR GT 2).ZG39Q                         01593400
                    AIF   ('&ZCGPR' EQ '0').ZG39Q                       01593500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01593600
                    AIF   (T'&ZCGPR NE 'N').ZG39Q  INVALID REG NAME     01593700
.ZG39P              ANOP  ,                                             01593800
                    AIF   (T'&ZCGPR NE 'N').ZG39R  NON NUMERIC          01593900
                    AIF   ('&ZCGPR' LT '2').ZG39Q                       01594000
                    AIF   ('&ZCGPR' LE '12').ZG39R                      01594100
.ZG39Q              ANOP  ,                                             01594200
&ZMS                SETC  '"RMTOKEN='           *KGPRA* MNOTE           01594300
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01594400
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01594500
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01594600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01594700
.ZG39R              ANOP  ,                                             01594800
.*------------------------------------------------------------------    01594900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           01595000
.ZG41               ANOP  ,                                             01595100
&ZXELEMBIND         SETC  'INPUT'     SET IN/OUTPUT                     01595200
                    AIF   (K'&XELEMBIND GT 0).ZG41E  VALID ARG          01595300
                    AIF   (T'&ELEMBIND EQ 'O').ZG41D  OMITTED           01595400
&ZASYSLNDX          SETA  0                                             01595500
.ZG41A              ANOP  ,           POSITIONAL MACRO KEY              01595600
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  01595700
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG41C              01595800
&ZTLC               SETC 'ELEMBIND'                                     01595900
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG41A     01596000
.ZG41B              ANOP  ,                                             01596100
&ZXELEMBIND         SETC  ''          RESET IN/OUTPUT                   01596200
&ZMS                SETC  'THE "ELEMBIND" KEY'  *KOPTA* MNOTE           01596300
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       01596400
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              01596500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01596600
                    AGO   .ZG41E                                        01596700
.ZG41C              ANOP  ,                                             01596800
&ZXELEMBIND         SETC  ''          RESET IN/OUTPUT                   01596900
&ZMS                SETC  '"ELEMBIND='          *KUKWA* MNOTE           01597000
&ZMS                SETC  '&ZMS.&ELEMBIND"'                             01597100
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     01597200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           01597300
&ZMS                SETC  '&ZMS "CURJOB"'                               01597400
&ZMS                SETC  '&ZMS OR "CURSYS".'                           01597500
                    MNOTE 8,' &ZMS '                                    01597600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01597700
                    AGO   .ZG41E                                        01597800
.ZG41D              ANOP  ,                                             01597900
&XELEMBIND          SETC  'CURJOB'    SET DEFAULT KEYWORD               01598000
.ZG41E              ANOP  ,                                             01598100
.*----------------------------------------------------------------***   01598200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01598300
                    AIF   (N'&RESTARTTIMEOUT LE 1).ZG43A  CK NUM        01598400
&ZMS                SETC  '"RESTARTTIMEOUT='    *KPOSA* MNOTE           01598500
&ZMS                SETC  '&ZMS.&RESTARTTIMEOUT"'                       01598600
&ZMS                SETC  '&ZMS "RESTARTTIMEOUT"'                       01598700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01598800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01598900
.ZG43A              ANOP  ,                                             01599000
.*-------------------------------------------------------------------   01599100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01599200
&XRESTARTTIMEOUT    SETC  ''          INITIALIZE XVARIABLE              01599300
.ZG44A   AIF   ('&RESTARTTIMEOUT(1)' NE 'NORM').ZG45A                   01599400
&XRESTARTTIMEOUT    SETC  'NORM'      SET KEYWORD                       01599500
.*-------------------------------------------------------------------   01599600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01599700
.ZG45A   AIF   ('&RESTARTTIMEOUT(1)' NE 'LONG').ZG46A                   01599800
&XRESTARTTIMEOUT    SETC  'LONG'      SET KEYWORD                       01599900
.*-------------------------------------------------------------------   01600000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01600100
.ZG46A              AIF   (K'&XRESTARTTIMEOUT GT 0).ZG46C  KEYWORD      01600200
                    AIF   (K'&RESTARTTIMEOUT(1) LE 0).ZG46B             01600300
&ZMS                SETC  '"RESTARTTIMEOUT='    *KUKWA* MNOTE           01600400
&ZMS                SETC  '&ZMS.&RESTARTTIMEOUT"'                       01600500
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     01600600
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           01600700
&ZMS                SETC  '&ZMS "NORM"'                                 01600800
&ZMS                SETC  '&ZMS OR "LONG".'                             01600900
                    MNOTE 8,' &ZMS '                                    01601000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01601100
.ZG46B              ANOP  ,                                             01601200
&XRESTARTTIMEOUT    SETC  'NORM'      SET DEFAULT KEYWORD               01601300
.ZG46C              ANOP  ,                                             01601400
&ZXRESTARTTIMEOUT   SETC  'INPUT'     SET IN/OUTPUT                     01601500
.*----------------------------------------------------------------***   01601600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01601700
                    AIF   (N'&ANSAREA LE 1).ZG48A  CK NUM               01601800
&ZMS                SETC  '"ANSAREA='           *KPOSA* MNOTE           01601900
&ZMS                SETC  '&ZMS.&ANSAREA"'                              01602000
&ZMS                SETC  '&ZMS "ANSAREA"'                              01602100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01602200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01602300
.ZG48A              ANOP  ,                                             01602400
.*-------------------------------------------------------------------   01602500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01602600
                    AIF   (K'&ANSAREA(1) LE 0).ZG48C  NO PARM           01602700
&ZXANSAREA          SETC  'OUTPUT'    SET OUTPUT                        01602800
&XANSAREA           SETC  '&ANSAREA(1)'         SET XVARIABLE           01602900
                    AIF   (N'&ANSAREA GT 1).ZG48C                       01603000
&XANSAREA           SETC  '&ANSAREA'  SET XVARIABLE                     01603100
.ZG48C              ANOP  ,                                             01603200
.*-------------------------------------------------------------------   01603300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01603400
                    AIF   (K'&ZXANSAREA LE 0).ZG48R  NOT I/O            01603500
                    AIF   ('&XANSAREA'(1,1) NE '(').ZG48R               01603600
&ZCGPR              SETC  '&XANSAREA'(2,K'&XANSAREA-2)                  01603700
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG48P                  01603800
                    AIF   (K'&ZCGPR GT 2).ZG48Q                         01603900
                    AIF   ('&ZCGPR' EQ '0').ZG48Q                       01604000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01604100
                    AIF   (T'&ZCGPR NE 'N').ZG48Q  INVALID REG NAME     01604200
.ZG48P              ANOP  ,                                             01604300
                    AIF   (T'&ZCGPR NE 'N').ZG48R  NON NUMERIC          01604400
                    AIF   ('&ZCGPR' LT '2').ZG48Q                       01604500
                    AIF   ('&ZCGPR' LE '12').ZG48R                      01604600
.ZG48Q              ANOP  ,                                             01604700
&ZMS                SETC  '"ANSAREA='           *KGPRA* MNOTE           01604800
&ZMS                SETC  '&ZMS.&ANSAREA"'                              01604900
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01605000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01605100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01605200
.ZG48R              ANOP  ,                                             01605300
.*-------------------------------------------------------------------   01605400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01605500
.ZG50               ANOP  ,                                             01605600
&ZTLC               SETC 'WAITPRED'                                     01605700
                    AIF   ('&REQUEST(1)' NE '&ZTLC').ZG54               01605800
&XREQUEST           SETC  'WAITPRED'  SET KEYWORD                       01605900
                    AIF   (N'&REQUEST LE 1).ZG50A  CK NUM               01606000
&ZMS                SETC  '"REQUEST='           *KPOSA* MNOTE           01606100
&ZMS                SETC  '&ZMS.&REQUEST"'                              01606200
&ZMS                SETC  '&ZMS "REQUEST"'                              01606300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01606400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01606500
.ZG50A              ANOP  ,                                             01606600
.*------------------------------------------------------------------    01606700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01606800
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       01606900
.ZG50A0             AIF   (K'&ELEMENT LE 0).ZG50A1  OK                  01607200
&ZCVAL              SETC '&ZCVAL ELEMENT'       INCORRECT KEY USED      01607600
.ZG50A1             AIF   (K'&EVENTEXIT LE 0).ZG50A2  OK                01608500
&ZCVAL              SETC '&ZCVAL EVENTEXIT'     INCORRECT KEY USED      01609400
.ZG50A2             AIF   (K'&EVENTEXITPL LE 0).ZG50A3  OK              01610300
&ZCVAL              SETC '&ZCVAL EVENTEXITPL'   INCORRECT KEY USED      01611200
.ZG50A3             AIF   (K'&EXITPLLEN LE 0).ZG50A4  OK                01612100
&ZCVAL              SETC '&ZCVAL EXITPLLEN'     INCORRECT KEY USED      01613000
.ZG50A4             AIF   (K'&STARTTXT LE 0).ZG50A5  OK                 01613900
&ZCVAL              SETC '&ZCVAL STARTTXT'      INCORRECT KEY USED      01614800
.ZG50A5             AIF   (K'&STARTTXTLEN LE 0).ZG50A6  OK              01615700
&ZCVAL              SETC '&ZCVAL STARTTXTLEN'   INCORRECT KEY USED      01616600
.ZG50A6             AIF   (K'&ELEMTYPE LE 0).ZG50A7  OK                 01617500
&ZCVAL              SETC '&ZCVAL ELEMTYPE'      INCORRECT KEY USED      01618400
.ZG50A7             AIF   (K'&TERMTYPE LE 0).ZG50A8  OK                 01619300
&ZCVAL              SETC '&ZCVAL TERMTYPE'      INCORRECT KEY USED      01620200
.ZG50A8             AIF   (K'&ELEMBIND LE 0).ZG50A9  OK                 01620600
&ZCVAL              SETC '&ZCVAL ELEMBIND'      INCORRECT KEY USED      01621000
.ZG50A9             AIF   (K'&RESTARTTIMEOUT LE 0).ZG50A10  OK          01621400
&ZCVAL              SETC '&ZCVAL RESTARTTIMEOUT'  INCORRECT KEY USED    01622000
.ZG50A10            AIF   (K'&ANSAREA LE 0).ZG50A11  OK                 01622900
&ZCVAL              SETC '&ZCVAL ANSAREA'       INCORRECT KEY USED      01623800
.ZG50A11            AIF   (K'&TELEMENT LE 0).ZG50A12  OK                01624700
&ZCVAL              SETC '&ZCVAL TELEMENT'      INCORRECT KEY USED      01625600
.ZG50A12            AIF   (K'&ZCVAL LE 0).ZG50A13  OK                   01626500
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         01627400
&ZMS                SETC  '"REQUEST'  *KMEIA* MNOTE                     01628300
&ZMS                SETC  '&ZMS.=&REQUEST"'                             01629200
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          01630100
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          01631000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01631900
.ZG50A13            ANOP  ,                                             01632000
.*----------------------------------------------------------------***   01632100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01632200
                    AIF   (N'&RMTOKEN LE 1).ZG52A  CK NUM               01632300
&ZMS                SETC  '"RMTOKEN='           *KPOSA* MNOTE           01632400
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01632500
&ZMS                SETC  '&ZMS "RMTOKEN"'                              01632600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01632700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01632800
.ZG52A              ANOP  ,                                             01632900
.*-------------------------------------------------------------------   01633000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01633100
&ZXRMTOKEN          SETC  'INPUT'     SET IN/OUTPUT                     01633200
&XRMTOKEN           SETC  'NO_RMTOKEN'                                  01633300
                    AIF   (K'&RMTOKEN(1) LE 0).ZG52B  PARM              01633400
&XRMTOKEN           SETC  '&RMTOKEN(1)'         SET XVARIABLE           01633500
                    AIF   (N'&RMTOKEN GT 1).ZG52B  MULTI PARMS          01633600
&XRMTOKEN           SETC  '&RMTOKEN'  SET XVARIABLE                     01633700
.ZG52B              ANOP  ,                                             01633800
.*-------------------------------------------------------------------   01633900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01634000
                    AIF   (K'&ZXRMTOKEN LE 0).ZG52R  NOT I/O            01634100
         AIF   ('&XRMTOKEN' EQ 'NO_RMTOKEN').ZG52R                      01634200
                    AIF   ('&XRMTOKEN'(1,1) NE '(').ZG52R               01634300
&ZCGPR              SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                  01634400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG52P                  01634500
                    AIF   (K'&ZCGPR GT 2).ZG52Q                         01634600
                    AIF   ('&ZCGPR' EQ '0').ZG52Q                       01634700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01634800
                    AIF   (T'&ZCGPR NE 'N').ZG52Q  INVALID REG NAME     01634900
.ZG52P              ANOP  ,                                             01635000
                    AIF   (T'&ZCGPR NE 'N').ZG52R  NON NUMERIC          01635100
                    AIF   ('&ZCGPR' LT '2').ZG52Q                       01635200
                    AIF   ('&ZCGPR' LE '12').ZG52R                      01635300
.ZG52Q              ANOP  ,                                             01635400
&ZMS                SETC  '"RMTOKEN='           *KGPRA* MNOTE           01635500
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01635600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01635700
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01635800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01635900
.ZG52R              ANOP  ,                                             01636000
.*-------------------------------------------------------------------   01636100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01636200
.ZG54               ANOP  ,                                             01636300
&ZTLC               SETC 'READY'                                        01636400
                    AIF   ('&REQUEST(1)' NE '&ZTLC').ZG58               01637300
&XREQUEST           SETC  'READY'     SET KEYWORD                       01638200
                    AIF   (N'&REQUEST LE 1).ZG54A  CK NUM               01639100
&ZMS                SETC  '"REQUEST='           *KPOSA* MNOTE           01640000
&ZMS                SETC  '&ZMS.&REQUEST"'                              01640900
&ZMS                SETC  '&ZMS "REQUEST"'                              01641800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01642700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01643600
.ZG54A              ANOP  ,                                             01644500
.*------------------------------------------------------------------    01645400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01646300
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       01647200
.ZG54A0             AIF   (K'&ELEMENT LE 0).ZG54A1  OK                  01648100
&ZCVAL              SETC '&ZCVAL ELEMENT'       INCORRECT KEY USED      01649000
.ZG54A1             AIF   (K'&EVENTEXIT LE 0).ZG54A2  OK                01649900
&ZCVAL              SETC '&ZCVAL EVENTEXIT'     INCORRECT KEY USED      01650800
.ZG54A2             AIF   (K'&EVENTEXITPL LE 0).ZG54A3  OK              01651700
&ZCVAL              SETC '&ZCVAL EVENTEXITPL'   INCORRECT KEY USED      01652600
.ZG54A3             AIF   (K'&EXITPLLEN LE 0).ZG54A4  OK                01653500
&ZCVAL              SETC '&ZCVAL EXITPLLEN'     INCORRECT KEY USED      01654400
.ZG54A4             AIF   (K'&STARTTXT LE 0).ZG54A5  OK                 01655300
&ZCVAL              SETC '&ZCVAL STARTTXT'      INCORRECT KEY USED      01656200
.ZG54A5             AIF   (K'&STARTTXTLEN LE 0).ZG54A6  OK              01657100
&ZCVAL              SETC '&ZCVAL STARTTXTLEN'   INCORRECT KEY USED      01658000
.ZG54A6             AIF   (K'&ELEMTYPE LE 0).ZG54A7  OK                 01658900
&ZCVAL              SETC '&ZCVAL ELEMTYPE'      INCORRECT KEY USED      01659800
.ZG54A7             AIF   (K'&TERMTYPE LE 0).ZG54A8  OK                 01660700
&ZCVAL              SETC '&ZCVAL TERMTYPE'      INCORRECT KEY USED      01661600
.ZG54A8             AIF   (K'&ELEMBIND LE 0).ZG54A9  OK                 01662000
&ZCVAL              SETC '&ZCVAL ELEMBIND'      INCORRECT KEY USED      01662400
.ZG54A9             AIF   (K'&RESTARTTIMEOUT LE 0).ZG54A10  OK          01662800
&ZCVAL              SETC '&ZCVAL RESTARTTIMEOUT'  INCORRECT KEY USED    01663400
.ZG54A10            AIF   (K'&ANSAREA LE 0).ZG54A11  OK                 01664300
&ZCVAL              SETC '&ZCVAL ANSAREA'       INCORRECT KEY USED      01665200
.ZG54A11            AIF   (K'&TELEMENT LE 0).ZG54A12  OK                01666100
&ZCVAL              SETC '&ZCVAL TELEMENT'      INCORRECT KEY USED      01667000
.ZG54A12            AIF   (K'&ZCVAL LE 0).ZG54A13  OK                   01667900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         01668800
&ZMS                SETC  '"REQUEST'  *KMEIA* MNOTE                     01669700
&ZMS                SETC  '&ZMS.=&REQUEST"'                             01670600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          01671500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          01672400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01673300
.ZG54A13            ANOP  ,                                             01673400
.*----------------------------------------------------------------***   01673500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01673600
                    AIF   (N'&RMTOKEN LE 1).ZG56A  CK NUM               01673700
&ZMS                SETC  '"RMTOKEN='           *KPOSA* MNOTE           01673800
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01673900
&ZMS                SETC  '&ZMS "RMTOKEN"'                              01674000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01674100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01674200
.ZG56A              ANOP  ,                                             01674300
.*-------------------------------------------------------------------   01674400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01674500
&ZXRMTOKEN          SETC  'INPUT'     SET IN/OUTPUT                     01674600
&XRMTOKEN           SETC  'NO_RMTOKEN'                                  01674700
                    AIF   (K'&RMTOKEN(1) LE 0).ZG56B  PARM              01674800
&XRMTOKEN           SETC  '&RMTOKEN(1)'         SET XVARIABLE           01674900
                    AIF   (N'&RMTOKEN GT 1).ZG56B  MULTI PARMS          01675000
&XRMTOKEN           SETC  '&RMTOKEN'  SET XVARIABLE                     01675100
.ZG56B              ANOP  ,                                             01675200
.*-------------------------------------------------------------------   01675300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01675400
                    AIF   (K'&ZXRMTOKEN LE 0).ZG56R  NOT I/O            01675500
         AIF   ('&XRMTOKEN' EQ 'NO_RMTOKEN').ZG56R                      01675600
                    AIF   ('&XRMTOKEN'(1,1) NE '(').ZG56R               01675700
&ZCGPR              SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                  01675800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG56P                  01675900
                    AIF   (K'&ZCGPR GT 2).ZG56Q                         01676000
                    AIF   ('&ZCGPR' EQ '0').ZG56Q                       01676100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01676200
                    AIF   (T'&ZCGPR NE 'N').ZG56Q  INVALID REG NAME     01676300
.ZG56P              ANOP  ,                                             01676400
                    AIF   (T'&ZCGPR NE 'N').ZG56R  NON NUMERIC          01676500
                    AIF   ('&ZCGPR' LT '2').ZG56Q                       01676600
                    AIF   ('&ZCGPR' LE '12').ZG56R                      01676700
.ZG56Q              ANOP  ,                                             01676800
&ZMS                SETC  '"RMTOKEN='           *KGPRA* MNOTE           01676900
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01677000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01677100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01677200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01677300
.ZG56R              ANOP  ,                                             01677400
.*-------------------------------------------------------------------   01677500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01677600
.ZG58               ANOP  ,                                             01677700
&ZTLC               SETC 'DEREGISTER'                                   01677800
                    AIF   ('&REQUEST(1)' NE '&ZTLC').ZG62               01678700
&XREQUEST           SETC  'DEREGISTER'          SET KEYWORD             01679600
                    AIF   (N'&REQUEST LE 1).ZG58A  CK NUM               01680500
&ZMS                SETC  '"REQUEST='           *KPOSA* MNOTE           01681400
&ZMS                SETC  '&ZMS.&REQUEST"'                              01682300
&ZMS                SETC  '&ZMS "REQUEST"'                              01683200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01684100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01685000
.ZG58A              ANOP  ,                                             01685900
.*------------------------------------------------------------------    01686800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01687700
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       01688600
.ZG58A0             AIF   (K'&ELEMENT LE 0).ZG58A1  OK                  01689500
&ZCVAL              SETC '&ZCVAL ELEMENT'       INCORRECT KEY USED      01690400
.ZG58A1             AIF   (K'&EVENTEXIT LE 0).ZG58A2  OK                01691300
&ZCVAL              SETC '&ZCVAL EVENTEXIT'     INCORRECT KEY USED      01692200
.ZG58A2             AIF   (K'&EVENTEXITPL LE 0).ZG58A3  OK              01693100
&ZCVAL              SETC '&ZCVAL EVENTEXITPL'   INCORRECT KEY USED      01694000
.ZG58A3             AIF   (K'&EXITPLLEN LE 0).ZG58A4  OK                01694900
&ZCVAL              SETC '&ZCVAL EXITPLLEN'     INCORRECT KEY USED      01695800
.ZG58A4             AIF   (K'&STARTTXT LE 0).ZG58A5  OK                 01696700
&ZCVAL              SETC '&ZCVAL STARTTXT'      INCORRECT KEY USED      01697600
.ZG58A5             AIF   (K'&STARTTXTLEN LE 0).ZG58A6  OK              01698500
&ZCVAL              SETC '&ZCVAL STARTTXTLEN'   INCORRECT KEY USED      01699400
.ZG58A6             AIF   (K'&ELEMTYPE LE 0).ZG58A7  OK                 01700300
&ZCVAL              SETC '&ZCVAL ELEMTYPE'      INCORRECT KEY USED      01701200
.ZG58A7             AIF   (K'&TERMTYPE LE 0).ZG58A8  OK                 01702100
&ZCVAL              SETC '&ZCVAL TERMTYPE'      INCORRECT KEY USED      01703000
.ZG58A8             AIF   (K'&ELEMBIND LE 0).ZG58A9  OK                 01703400
&ZCVAL              SETC '&ZCVAL ELEMBIND'      INCORRECT KEY USED      01703800
.ZG58A9             AIF   (K'&RESTARTTIMEOUT LE 0).ZG58A10  OK          01704200
&ZCVAL              SETC '&ZCVAL RESTARTTIMEOUT'  INCORRECT KEY USED    01704800
.ZG58A10            AIF   (K'&ANSAREA LE 0).ZG58A11  OK                 01705700
&ZCVAL              SETC '&ZCVAL ANSAREA'       INCORRECT KEY USED      01706600
.ZG58A11            AIF   (K'&TELEMENT LE 0).ZG58A12  OK                01707500
&ZCVAL              SETC '&ZCVAL TELEMENT'      INCORRECT KEY USED      01708400
.ZG58A12            AIF   (K'&ZCVAL LE 0).ZG58A13  OK                   01709300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         01710200
&ZMS                SETC  '"REQUEST'  *KMEIA* MNOTE                     01711100
&ZMS                SETC  '&ZMS.=&REQUEST"'                             01712000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          01712900
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          01713800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01714700
.ZG58A13            ANOP  ,                                             01714900
.*----------------------------------------------------------------***   01715100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01715300
                    AIF   (N'&RMTOKEN LE 1).ZG60A  CK NUM               01715500
&ZMS                SETC  '"RMTOKEN='           *KPOSA* MNOTE           01715700
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01715900
&ZMS                SETC  '&ZMS "RMTOKEN"'                              01716100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01716300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01716500
.ZG60A              ANOP  ,                                             01716700
.*-------------------------------------------------------------------   01716900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01717100
&ZXRMTOKEN          SETC  'INPUT'     SET IN/OUTPUT                     01717300
&XRMTOKEN           SETC  'NO_RMTOKEN'                                  01717500
                    AIF   (K'&RMTOKEN(1) LE 0).ZG60B  PARM              01717700
&XRMTOKEN           SETC  '&RMTOKEN(1)'         SET XVARIABLE           01717900
                    AIF   (N'&RMTOKEN GT 1).ZG60B  MULTI PARMS          01718100
&XRMTOKEN           SETC  '&RMTOKEN'  SET XVARIABLE                     01718300
.ZG60B              ANOP  ,                                             01718500
.*-------------------------------------------------------------------   01718700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01718900
                    AIF   (K'&ZXRMTOKEN LE 0).ZG60R  NOT I/O            01719100
         AIF   ('&XRMTOKEN' EQ 'NO_RMTOKEN').ZG60R                      01719300
                    AIF   ('&XRMTOKEN'(1,1) NE '(').ZG60R               01719500
&ZCGPR              SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                  01719700
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG60P                  01719900
                    AIF   (K'&ZCGPR GT 2).ZG60Q                         01720100
                    AIF   ('&ZCGPR' EQ '0').ZG60Q                       01720300
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01720500
                    AIF   (T'&ZCGPR NE 'N').ZG60Q  INVALID REG NAME     01720700
.ZG60P              ANOP  ,                                             01720900
                    AIF   (T'&ZCGPR NE 'N').ZG60R  NON NUMERIC          01721100
                    AIF   ('&ZCGPR' LT '2').ZG60Q                       01721300
                    AIF   ('&ZCGPR' LE '12').ZG60R                      01721500
.ZG60Q              ANOP  ,                                             01721700
&ZMS                SETC  '"RMTOKEN='           *KGPRA* MNOTE           01721900
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01722100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01722300
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01722500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01722700
.ZG60R              ANOP  ,                                             01722900
.*-------------------------------------------------------------------   01723100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01724000
.ZG62               ANOP  ,                                             01725000
&ZTLC               SETC 'ASSOCIATE'                                    01726000
                    AIF   ('&REQUEST(1)' NE '&ZTLC').ZG69               01727000
&XREQUEST           SETC  'ASSOCIATE'           SET KEYWORD             01728000
                    AIF   (N'&REQUEST LE 1).ZG62A  CK NUM               01729000
&ZMS                SETC  '"REQUEST='           *KPOSA* MNOTE           01730000
&ZMS                SETC  '&ZMS.&REQUEST"'                              01731000
&ZMS                SETC  '&ZMS "REQUEST"'                              01732000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01733000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01734000
.ZG62A              ANOP  ,                                             01735000
.*------------------------------------------------------------------    01736000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01737000
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       01737800
.ZG62A0             AIF   (K'&ELEMENT LE 0).ZG62A1  OK                  01738600
&ZCVAL              SETC '&ZCVAL ELEMENT'       INCORRECT KEY USED      01739400
.ZG62A1             AIF   (K'&EVENTEXIT LE 0).ZG62A2  OK                01740200
&ZCVAL              SETC '&ZCVAL EVENTEXIT'     INCORRECT KEY USED      01741000
.ZG62A2             AIF   (K'&EVENTEXITPL LE 0).ZG62A3  OK              01741800
&ZCVAL              SETC '&ZCVAL EVENTEXITPL'   INCORRECT KEY USED      01742600
.ZG62A3             AIF   (K'&EXITPLLEN LE 0).ZG62A4  OK                01743400
&ZCVAL              SETC '&ZCVAL EXITPLLEN'     INCORRECT KEY USED      01744200
.ZG62A4             AIF   (K'&STARTTXT LE 0).ZG62A5  OK                 01745000
&ZCVAL              SETC '&ZCVAL STARTTXT'      INCORRECT KEY USED      01745800
.ZG62A5             AIF   (K'&STARTTXTLEN LE 0).ZG62A6  OK              01746600
&ZCVAL              SETC '&ZCVAL STARTTXTLEN'   INCORRECT KEY USED      01747400
.ZG62A6             AIF   (K'&ELEMTYPE LE 0).ZG62A7  OK                 01748200
&ZCVAL              SETC '&ZCVAL ELEMTYPE'      INCORRECT KEY USED      01749000
.ZG62A7             AIF   (K'&TERMTYPE LE 0).ZG62A8  OK                 01749800
&ZCVAL              SETC '&ZCVAL TERMTYPE'      INCORRECT KEY USED      01750600
.ZG62A8             AIF   (K'&ELEMBIND LE 0).ZG62A9  OK                 01751000
&ZCVAL              SETC '&ZCVAL ELEMBIND'      INCORRECT KEY USED      01751400
.ZG62A9             AIF   (K'&RESTARTTIMEOUT LE 0).ZG62A10  OK          01751800
&ZCVAL              SETC '&ZCVAL RESTARTTIMEOUT'  INCORRECT KEY USED    01752200
.ZG62A10            AIF   (K'&ANSAREA LE 0).ZG62A11  OK                 01753000
&ZCVAL              SETC '&ZCVAL ANSAREA'       INCORRECT KEY USED      01753800
.ZG62A11            AIF   (K'&ZCVAL LE 0).ZG62A12  OK                   01754600
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         01755400
&ZMS                SETC  '"REQUEST'  *KMEIA* MNOTE                     01756200
&ZMS                SETC  '&ZMS.=&REQUEST"'                             01757000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          01757800
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          01758600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01759400
.ZG62A12            ANOP  ,                                             01759700
.*----------------------------------------------------------------***   01760000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01760300
                    AIF   (N'&RMTOKEN LE 1).ZG64A  CK NUM               01760600
&ZMS                SETC  '"RMTOKEN='           *KPOSA* MNOTE           01760900
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01761200
&ZMS                SETC  '&ZMS "RMTOKEN"'                              01761500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01761800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01762100
.ZG64A              ANOP  ,                                             01762400
.*-------------------------------------------------------------------   01762700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01763000
&ZXRMTOKEN          SETC  'INPUT'     SET IN/OUTPUT                     01763300
&XRMTOKEN           SETC  'NO_RMTOKEN'                                  01763600
                    AIF   (K'&RMTOKEN(1) LE 0).ZG64B  PARM              01763900
&XRMTOKEN           SETC  '&RMTOKEN(1)'         SET XVARIABLE           01764200
                    AIF   (N'&RMTOKEN GT 1).ZG64B  MULTI PARMS          01764500
&XRMTOKEN           SETC  '&RMTOKEN'  SET XVARIABLE                     01764800
.ZG64B              ANOP  ,                                             01765100
.*-------------------------------------------------------------------   01765400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01765700
                    AIF   (K'&ZXRMTOKEN LE 0).ZG64R  NOT I/O            01766000
         AIF   ('&XRMTOKEN' EQ 'NO_RMTOKEN').ZG64R                      01766300
                    AIF   ('&XRMTOKEN'(1,1) NE '(').ZG64R               01766600
&ZCGPR              SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                  01766900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG64P                  01767200
                    AIF   (K'&ZCGPR GT 2).ZG64Q                         01767500
                    AIF   ('&ZCGPR' EQ '0').ZG64Q                       01767800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01768100
                    AIF   (T'&ZCGPR NE 'N').ZG64Q  INVALID REG NAME     01768400
.ZG64P              ANOP  ,                                             01768700
                    AIF   (T'&ZCGPR NE 'N').ZG64R  NON NUMERIC          01769000
                    AIF   ('&ZCGPR' LT '2').ZG64Q                       01769300
                    AIF   ('&ZCGPR' LE '12').ZG64R                      01769600
.ZG64Q              ANOP  ,                                             01769900
&ZMS                SETC  '"RMTOKEN='           *KGPRA* MNOTE           01770200
&ZMS                SETC  '&ZMS.&RMTOKEN"'                              01770500
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01770800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01771100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01771400
.ZG64R              ANOP  ,                                             01771700
.*----------------------------------------------------------------***   01773200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01773300
                    AIF   (N'&TELEMENT LE 1).ZG67A  CK NUM              01773400
&ZMS                SETC  '"TELEMENT='          *KPOSA* MNOTE           01773500
&ZMS                SETC  '&ZMS.&TELEMENT"'                             01773600
&ZMS                SETC  '&ZMS "TELEMENT"'                             01773700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01773800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01773900
.ZG67A              ANOP  ,                                             01774000
.*-------------------------------------------------------------------   01774100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01774200
&ZXTELEMENT         SETC  'INPUT'     SET IN/OUTPUT                     01774300
&XTELEMENT          SETC  '&TELEMENT(1)'        SET XVARIABLE           01775000
                    AIF   (N'&TELEMENT GT 1).ZG67B  MULTI PARMS         01776000
&XTELEMENT          SETC  '&TELEMENT'           SET XVARIABLE           01777000
.ZG67B              AIF   (K'&TELEMENT(1) GT 0).ZG67C                   01778000
&ZXTELEMENT         SETC  ''          RESET IN/OUTPUT                   01779000
&ZMS                SETC  ' '         *KRQDA*                           01780000
&ZMS                SETC  '&ZMS "TELEMENT" KEY AND ITS'                 01781000
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              01782000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01783000
.ZG67C              ANOP  ,                                             01784000
.*-------------------------------------------------------------------   01785000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01786000
                    AIF   (K'&ZXTELEMENT LE 0).ZG67R  NOT I/O           01787000
                    AIF   ('&XTELEMENT'(1,1) NE '(').ZG67R              01788000
&ZCGPR              SETC  '&XTELEMENT'(2,K'&XTELEMENT-2)                01789000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG67P                  01790000
                    AIF   (K'&ZCGPR GT 2).ZG67Q                         01791000
                    AIF   ('&ZCGPR' EQ '0').ZG67Q                       01792000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01793000
                    AIF   (T'&ZCGPR NE 'N').ZG67Q  INVALID REG NAME     01794000
.ZG67P              ANOP  ,                                             01795000
                    AIF   (T'&ZCGPR NE 'N').ZG67R  NON NUMERIC          01796000
                    AIF   ('&ZCGPR' LT '2').ZG67Q                       01797000
                    AIF   ('&ZCGPR' LE '12').ZG67R                      01798000
.ZG67Q              ANOP  ,                                             01799000
&ZMS                SETC  '"TELEMENT='          *KGPRA* MNOTE           01800000
&ZMS                SETC  '&ZMS.&TELEMENT"'                             01801000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01802000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01803000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01804000
.ZG67R              ANOP  ,                                             01805000
.*------------------------------------------------------------------    01806000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01807000
.ZG69               ANOP  ,                                             01808000
&ZXREQUEST          SETC  'INPUT'     SET IN/OUTPUT                     01809000
                    AIF   (K'&XREQUEST GT 0).ZG69E  VALID ARG           01810000
                    AIF   (T'&REQUEST EQ 'O').ZG69D  OMITTED            01811000
&ZASYSLNDX          SETA  0                                             01812000
.ZG69A              ANOP  ,           POSITIONAL MACRO KEY              01813000
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  01814000
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG69C              01815000
&ZTLC               SETC 'REQUEST'                                      01816000
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG69A     01817000
.ZG69B              ANOP  ,                                             01818000
&ZXREQUEST          SETC  ''          RESET IN/OUTPUT                   01819000
&ZMS                SETC  'THE "REQUEST" KEY'   *KOPTA* MNOTE           01820000
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       01821000
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              01822000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01823000
                    AGO   .ZG69E                                        01824000
.ZG69C              ANOP  ,                                             01825000
&ZXREQUEST          SETC  ''          RESET IN/OUTPUT                   01826000
&ZMS                SETC  '"REQUEST='           *KUKWA* MNOTE           01827000
&ZMS                SETC  '&ZMS.&REQUEST"'                              01828000
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     01829000
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           01830000
&ZMS                SETC  '&ZMS "REGISTER",'                            01831000
&ZMS                SETC  '&ZMS "WAITPRED",'                            01832000
&ZMS                SETC  '&ZMS "READY",'                               01833000
&ZMS                SETC  '&ZMS "DEREGISTER",'                          01834000
&ZMS                SETC  '&ZMS OR "ASSOCIATE".'                        01835000
                    MNOTE 8,' &ZMS '                                    01836000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01837000
                    AGO   .ZG69E                                        01838000
.ZG69D              ANOP  ,                                             01839000
&XREQUEST           SETC  'REGISTER'  SET DEFAULT KEYWORD               01840000
.ZG69E              ANOP  ,                                             01841000
.*------------------------------------------------------------------    01842000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01843000
                    AIF   (K'&REQUEST(1) GT 0).ZG69F  PARM              01844000
&XREQUEST           SETC  ''          ENSURE NULL KEYWORD               01845000
&ZXREQUEST          SETC  ''          RESET IN/OUTPUT                   01846000
&ZMS                SETC  'THE'                                         01847000
&ZMS                SETC  '&ZMS "REQUEST" KEY AND ITS'                  01848000
&ZMS                SETC  '&ZMS ARGUMENT ARE REQUIRED.'                 01849000
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           01850000
&ZMS                SETC  '&ZMS "REGISTER",'                            01851000
&ZMS                SETC  '&ZMS "WAITPRED",'                            01852000
&ZMS                SETC  '&ZMS "READY",'                               01853000
&ZMS                SETC  '&ZMS "DEREGISTER",'                          01854000
&ZMS                SETC  '&ZMS OR "ASSOCIATE".'                        01855000
                    MNOTE 8,' &ZMS '                                    01856000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01857000
.ZG69F              ANOP  ,                                             01858000
.*----------------------------------------------------------------***   01859000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01860000
                    AIF   (N'&RETCODE LE 1).ZG71A  CK NUM               01861000
&ZMS                SETC  '"RETCODE='           *KPOSA* MNOTE           01862000
&ZMS                SETC  '&ZMS.&RETCODE"'                              01863000
&ZMS                SETC  '&ZMS "RETCODE"'                              01864000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01865000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01866000
.ZG71A              ANOP  ,                                             01886000
.*-------------------------------------------------------------------   01906000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01907000
                    AIF   (K'&RETCODE(1) LE 0).ZG71C  NO PARM           01908000
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        01909000
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           01910000
                    AIF   (N'&RETCODE GT 1).ZG71C                       01911000
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     01912000
.ZG71C              ANOP  ,                                             01912100
.*-------------------------------------------------------------------   01912200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01912300
                    AIF   (K'&ZXRETCODE LE 0).ZG71R  NOT I/O            01912400
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG71R               01912500
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  01912600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG71P                  01912700
                    AIF   (K'&ZCGPR GT 2).ZG71Q                         01912800
                    AIF   ('&ZCGPR' EQ '0').ZG71Q                       01912900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01913000
                    AIF   (T'&ZCGPR NE 'N').ZG71Q  INVALID REG NAME     01913100
.ZG71P              ANOP  ,                                             01913200
                    AIF   (T'&ZCGPR NE 'N').ZG71R  NON NUMERIC          01913300
                    AIF   ('&ZCGPR' LT '2').ZG71Q                       01913400
                    AIF   ('&ZCGPR' LE '12').ZG71R                      01913500
.ZG71Q              ANOP  ,                                             01913600
&ZMS                SETC  '"RETCODE='           *KGPRA* MNOTE           01913700
&ZMS                SETC  '&ZMS.&RETCODE"'                              01913800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01913900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01914000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01914100
.ZG71R              ANOP  ,                                             01914200
.*----------------------------------------------------------------***   01914300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01914400
                    AIF   (N'&RSNCODE LE 1).ZG74A  CK NUM               01914500
&ZMS                SETC  '"RSNCODE='           *KPOSA* MNOTE           01914600
&ZMS                SETC  '&ZMS.&RSNCODE"'                              01914700
&ZMS                SETC  '&ZMS "RSNCODE"'                              01914800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           01914900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01915000
.ZG74A              ANOP  ,                                             01915100
.*-------------------------------------------------------------------   01915200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01915300
                    AIF   (K'&RSNCODE(1) LE 0).ZG74C  NO PARM           01915400
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        01915500
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           01915600
                    AIF   (N'&RSNCODE GT 1).ZG74C                       01915700
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     01915800
.ZG74C              ANOP  ,                                             01915900
.*-------------------------------------------------------------------   01916000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01916100
                    AIF   (K'&ZXRSNCODE LE 0).ZG74R  NOT I/O            01916200
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG74R               01916300
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  01916400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG74P                  01917800
                    AIF   (K'&ZCGPR GT 2).ZG74Q                         01919200
                    AIF   ('&ZCGPR' EQ '0').ZG74Q                       01920600
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 01922000
                    AIF   (T'&ZCGPR NE 'N').ZG74Q  INVALID REG NAME     01923400
.ZG74P              ANOP  ,                                             01924800
                    AIF   (T'&ZCGPR NE 'N').ZG74R  NON NUMERIC          01926200
                    AIF   ('&ZCGPR' LT '2').ZG74Q                       01927600
                    AIF   ('&ZCGPR' LE '12').ZG74R                      01929000
.ZG74Q              ANOP  ,                                             01930400
&ZMS                SETC  '"RSNCODE='           *KGPRA* MNOTE           01931900
&ZMS                SETC  '&ZMS.&RSNCODE"'                              01932000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     01932100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              01932200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01933000
.ZG74R              ANOP  ,                                             01934000
.******************************************************************     01935000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        01936000
.******************************************************************     01937000
                    ACTR  10000                                         01938000
.*----------------------------------------------------------------***   01939000
.***AH.P02 EXTRA POSITIONALS                                            01940000
                    AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS          01941000
                    AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL          01941200
                    AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL      01941400
                    AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL       01941600
.ZGLISTX1           ANOP  ,                                             01941800
&ZCVAL              SETC  ''          ERROR FIELD                       01942000
&ZAWRK              SETA  0           POSITIONAL NUMBER                 01943000
.ZGLIST2            ANOP  ,                                             01944000
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   01945000
                    AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE          01946000
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA               01947000
                    AGO   .ZGLIST2                                      01948000
.*                                                                      01949000
.ZGLIST3            ANOP  ,                                             01950000
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            01951000
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE      01952000
&ZMS                SETC  '&ZMS "&ZCVAL"'                               01953000
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        01954000
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                01955000
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        01956000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       01957000
.ZGLISTX            ANOP  ,                                             01958000
&ZASYSLNDX          SETA  0                                             01959000
.*-------------------------------------------------------------------   01960000
.***AG.MF04 MF=(SLE)                                                    01961000
.ZGMFX              ANOP  ,           END OF FULL SYNTAX CHECK          01962000
.*******************************************************************    02508000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       02509000
.*******************************************************************    02510000
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          02511000
.*******************************************************************    02512000
.***AE.01  START OF IXCARM MACRO CODE                                   02513000
.*******************************************************************    02514000
                    LCLC  &M0M0001                 NAME                 02515000
&M0M0001            SETC  '&XLABEL'                SET NAME             02516000
                    AIF   (K'&XLABEL NE 0).XLAB2                        02517000
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         02518000
.*                                                                      02519000
.XLAB2              ANOP  ,                                             02520000
                    AIF   ('&XMF' EQ 'L').XLAB3                         02520500
&M0M0001 DS    0H                             IXCARM-1                  02521000
.XLAB3              ANOP  ,                                             02521500
.*******************************************************************    02522000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              02523000
.*******************************************************************    02524000
              PUSH  PRINT                                               02525000
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    02526000
                    PRINT OFF         ++ PR01                           02527000
                    AGO   .ZPRNTXX                                      02528000
.ZPRINTX            PRINT ON                                            02529000
.ZPRNTXX            ANOP  ,                                             02530000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  02531000
              AIF ('&XSTARTTXT'  NE 'NO_STARTTXT').STARTTXTOK     @P1A  02531100
              AIF ('&XSTARTTXTLEN' EQ '0').STARTTXTOK             @P1A  02531200
&ZMS        SETC  '"STARTTXT IS NO_STARTTXT BUT STARTTXTLEN IS'   @P1A  02531300
&ZMS        SETC  '&ZMS NOT 0. STARTTXTLEN MUST BE 0 WHEN'        @P1A  02531400
&ZMS        SETC  '&ZMS NO START TEXT IS SPECIFIED.'              @P1A  02531500
            MNOTE 8,' &ZMS'                                       @P1A  02531600
&ZMACRET    SETA  8      SET MACRO ERROR RETURN CODE              @P1A  02531700
.STARTTXTOK ANOP  ,                                               @P1A  02531800
              AIF ('&XELEMBIND'  NE 'CURSYS').ELEMBINDOK          @L1A  02531900
              AIF ('&XTERMTYPE' NE 'ELEMTERM').ELEMBINDOK         @L1A  02532000
&ZMS        SETC  'ELEMBIND=CURSYS IS NOT VALID WITH '            @L1A  02532100
&ZMS        SETC  '&ZMS TERMTYPE=ELEMTERM.'                       @L1A  02532200
            MNOTE 8,' &ZMS'                                       @L1A  02532300
&ZMACRET    SETA  8      SET MACRO ERROR RETURN CODE              @L1A  02532400
.ELEMBINDOK ANOP  ,                                               @L1A  02532500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  02532600
.********************************************************************   02533000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     02534000
.********************************************************************   02535000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       02536000
                      LCLA  &ZOPN1         INVOCATION INDEX             02537000
                      LCLC  &ZOPL(4095)    LABEL                        02538000
                      LCLC  &ZOPO(4095)    OPERATION                    02539000
                      LCLC  &ZOPV(4095)    VALUE                        02540000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  02541000
.*                                                                      02542000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     02543000
.******************************************************************     02544000
.***AL.L10 IXCARM FMT=LIST MF=S|L PARAMETERS                            02545000
.******************************************************************     02546000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     02547000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     02548000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     02549000
&XMFATTR              SETC  '0D'                                        02550000
.*                                                                      02551000
&ZOPN                 SETA  &ZOPN+1                                     02552000
&ZOPL(&ZOPN)          SETC  ' '                                         02553000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     02553500
&ZOPO(&ZOPN)          SETC  'B'                                         02554000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                02555000
                      AGO   .ZALVL6B                                    02555100
.ZALVL6A              ANOP                                              02555200
&ZOPO(&ZOPN)          SETC  'BRAS'                                      02555300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              02555400
.ZALVL6B              ANOP                                              02555500
&ZOPD(&ZOPN)          SETC  '++ IXCARM ARG PARMS'                       02556000
.*                                                                      02557000
&ZOPN                 SETA  &ZOPN+1                                     02558000
&ZOPL(&ZOPN)          SETC  ' '                                         02559000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     02560000
&ZOPV(&ZOPN)          SETC  '1'                                         02561000
&ZOPD(&ZOPN)          SETC  ' '                                         02562000
.*                                                                      02563000
.ZLMFSL2              ANOP  ,                                           02564000
.*-------------------------------------------------------------------   02564100
.***AM.L00  IXCARM FMT=LIST name                                        02564200
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    02564300
&ZOPN                 SETA &ZOPN+1                                      02564400
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   02564500
&ZOPO(&ZOPN)          SETC 'EQU'                                        02564600
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   02564700
&ZOPD(&ZOPN)          SETC '++ IXCARM NAME'                             02564800
.ZLMFSL2M             ANOP  ,                                           02564900
.*-------------------------------------------------------------------   02565000
.***AM.L01  IXCARM FMT=LIST PARAMETERS                                  02566000
&ZOPN                 SETA &ZOPN+1                                      02567000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   02568000
&ZOPO(&ZOPN)          SETC 'DS'                                         02569000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   02570000
&ZOPD(&ZOPN)          SETC '++ IXCARM PARM LIST'                        02571000
.*-------------------------------------------------------------------   02572000
.***AM.L02 XVERSION XL1                                                 02573000
&ZOPN                 SETA &ZOPN+1                                      02574000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         02575000
&ZOPO(&ZOPN)          SETC 'DS'                                         02576000
&ZOPV(&ZOPN)          SETC 'XL1'                                        02577000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          02578000
.*-------------------------------------------------------------------   02579000
.***AM.L05 XREQUEST XL1                                                 02580000
&ZOPN                 SETA &ZOPN+1                                      02581000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         02582000
&ZOPO(&ZOPN)          SETC 'DS'                                         02583000
&ZOPV(&ZOPN)          SETC 'XL1'                                        02584000
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     02585000
.*                                                                      02586000
&ZOPN                 SETA  &ZOPN+1                                     02587000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_REGISTER'               02588000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02589000
&ZOPV(&ZOPN)          SETC  '1'                                         02590000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              02591000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REGISTER'                     02592000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02593000
.*                                                                      02594000
&ZOPN                 SETA  &ZOPN+1                                     02595000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_WAITPRED'               02596000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02597000
&ZOPV(&ZOPN)          SETC  '2'                                         02598000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              02599000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).WAITPRED'                     02600000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02601000
.*                                                                      02602000
&ZOPN                 SETA  &ZOPN+1                                     02603000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_READY'                  02604000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02605000
&ZOPV(&ZOPN)          SETC  '3'                                         02606000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              02607000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).READY'                        02608000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02609000
.*                                                                      02610000
&ZOPN                 SETA  &ZOPN+1                                     02611000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_DEREGISTER'             02612000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02613000
&ZOPV(&ZOPN)          SETC  '4'                                         02614000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              02615000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEREGISTER'                   02616000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02617000
.*                                                                      02618000
&ZOPN                 SETA  &ZOPN+1                                     02619000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_ASSOCIATE'              02620000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02621000
&ZOPV(&ZOPN)          SETC  '5'                                         02622000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              02623000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ASSOCIATE'                    02624000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02625000
.*-------------------------------------------------------------------   02626000
.***AM.L09  XRSV0001 CL2                                                02627000
&ZOPN                 SETA &ZOPN+1                                      02628000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         02629000
&ZOPO(&ZOPN)          SETC 'DS'                                         02630000
&ZOPV(&ZOPN)          SETC 'CL2'                                        02631000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      02632000
.*-------------------------------------------------------------------   02633000
.***AM.L09  XELEMENT CL16                                               02634000
&ZOPN                 SETA &ZOPN+1                                      02635000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XELEMENT'                         02636000
&ZOPO(&ZOPN)          SETC 'DS'                                         02637000
&ZOPV(&ZOPN)          SETC 'CL16'                                       02638000
&ZOPD(&ZOPN)          SETC '++ &ZXELEMENT  XELEMENT'                    02639000
.*-------------------------------------------------------------------   02640000
.***AM.L09  XEVENTEXIT CL8                                              02641000
&ZOPN                 SETA &ZOPN+1                                      02642000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEVENTEXIT'                       02643000
&ZOPO(&ZOPN)          SETC 'DS'                                         02644000
&ZOPV(&ZOPN)          SETC 'CL8'                                        02645000
&ZOPD(&ZOPN)          SETC '++ &ZXEVENTEXIT  XEVENTEXIT'                02646000
.*-------------------------------------------------------------------   02647000
.***AM.L09 ADDR XEVENTEXITPL A                                          02648000
&ZOPN                 SETA &ZOPN+1                                      02649000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEVENTEXITPL_ADDR'                02650000
&ZOPO(&ZOPN)          SETC 'DS'                                         02651000
&ZOPV(&ZOPN)          SETC 'A'                                          02652000
&ZOPD(&ZOPN)          SETC '++ &ZXEVENTEXITPL ADDR XEVENTEXITPL'        02653000
.*-------------------------------------------------------------------   02654000
.***AM.L09 ALET XEVENTEXITPL F                                          02655000
&ZOPN                 SETA &ZOPN+1                                      02656000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEVENTEXITPL_ALET'                02657000
&ZOPO(&ZOPN)          SETC 'DS'                                         02658000
&ZOPV(&ZOPN)          SETC 'F'                                          02659000
&ZOPD(&ZOPN)          SETC '++ &ZXEVENTEXITPL ALET XEVENTEXITPL'        02660000
.*-------------------------------------------------------------------   02661000
.***AM.L09  XEXITPLLEN F                                                02662000
&ZOPN                 SETA &ZOPN+1                                      02663000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEXITPLLEN'                       02664000
&ZOPO(&ZOPN)          SETC 'DS'                                         02665000
&ZOPV(&ZOPN)          SETC 'F'                                          02666000
&ZOPD(&ZOPN)          SETC '++ &ZXEXITPLLEN  XEXITPLLEN'                02667000
.*-------------------------------------------------------------------   02668000
.***AM.L09 ADDR XSTARTTXT A                                             02669000
&ZOPN                 SETA &ZOPN+1                                      02670000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTARTTXT_ADDR'                   02671000
&ZOPO(&ZOPN)          SETC 'DS'                                         02672000
&ZOPV(&ZOPN)          SETC 'A'                                          02673000
&ZOPD(&ZOPN)          SETC '++ &ZXSTARTTXT ADDR XSTARTTXT'              02674000
.*-------------------------------------------------------------------   02675000
.***AM.L09 ALET XSTARTTXT F                                             02676000
&ZOPN                 SETA &ZOPN+1                                      02677000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTARTTXT_ALET'                   02678000
&ZOPO(&ZOPN)          SETC 'DS'                                         02679000
&ZOPV(&ZOPN)          SETC 'F'                                          02680000
&ZOPD(&ZOPN)          SETC '++ &ZXSTARTTXT ALET XSTARTTXT'              02681000
.*-------------------------------------------------------------------   02682000
.***AM.L09  XSTARTTXTLEN F                                              02683000
&ZOPN                 SETA &ZOPN+1                                      02684000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTARTTXTLEN'                     02685000
&ZOPO(&ZOPN)          SETC 'DS'                                         02686000
&ZOPV(&ZOPN)          SETC 'F'                                          02687000
&ZOPD(&ZOPN)          SETC '++ &ZXSTARTTXTLEN  XSTARTTXTLEN'            02688000
.*-------------------------------------------------------------------   02689000
.***AM.L09  XELEMTYPE CL8                                               02690000
&ZOPN                 SETA &ZOPN+1                                      02691000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XELEMTYPE'                        02692000
&ZOPO(&ZOPN)          SETC 'DS'                                         02693000
&ZOPV(&ZOPN)          SETC 'CL8'                                        02694000
&ZOPD(&ZOPN)          SETC '++ &ZXELEMTYPE  XELEMTYPE'                  02695000
.*-------------------------------------------------------------------   02696000
.***AM.L05 XTERMTYPE XL1                                                02697000
&ZOPN                 SETA &ZOPN+1                                      02698000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTERMTYPE'                        02699000
&ZOPO(&ZOPN)          SETC 'DS'                                         02700000
&ZOPV(&ZOPN)          SETC 'XL1'                                        02701000
&ZOPD(&ZOPN)          SETC '++ &ZXTERMTYPE XTERMTYPE'                   02702000
.*                                                                      02703000
&ZOPN                 SETA  &ZOPN+1                                     02704000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTERMTYPE_ALLTERM'               02705000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02706000
&ZOPV(&ZOPN)          SETC  '1'                                         02707000
&ZOPD(&ZOPN)          SETC  '++ XTERMTYPE.'                             02708000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ALLTERM'                      02709000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02710000
.*                                                                      02711000
&ZOPN                 SETA  &ZOPN+1                                     02712000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTERMTYPE_ELEMTERM'              02713000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02714000
&ZOPV(&ZOPN)          SETC  '2'                                         02715000
&ZOPD(&ZOPN)          SETC  '++ XTERMTYPE.'                             02716000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ELEMTERM'                     02717000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02718000
.*                                                                      02718100
&ZOPN                 SETA  &ZOPN+1                                     02718200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTERMTYPE_SYSTERM'               02718300
&ZOPO(&ZOPN)          SETC  'EQU'                                       02718400
&ZOPV(&ZOPN)          SETC  '3'                                         02718500
&ZOPD(&ZOPN)          SETC  '++ XTERMTYPE.'                             02718600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYSTERM'                      02718700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02718800
.*-------------------------------------------------------------------   02719000
.***AM.L05 XRESTARTTIMEOUT XL1                                          02719100
&ZOPN                 SETA &ZOPN+1                                      02719200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESTARTTIMEOUT'                  02719300
&ZOPO(&ZOPN)          SETC 'DS'                                         02719400
&ZOPV(&ZOPN)          SETC 'XL1'                                        02719500
&ZOPD(&ZOPN)          SETC '++ &ZXRESTARTTIMEOUT XRESTARTTIMEOUT'       02719600
.*                                                                      02719700
&ZOPN                 SETA  &ZOPN+1                                     02719800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRESTARTTIMEOUT_NORM'            02719900
&ZOPO(&ZOPN)          SETC  'EQU'                                       02720000
&ZOPV(&ZOPN)          SETC  '1'                                         02720100
&ZOPD(&ZOPN)          SETC  '++ XRESTARTTIMEOUT.'                       02720200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NORM'                         02720300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02720400
.*                                                                      02720500
&ZOPN                 SETA  &ZOPN+1                                     02720600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRESTARTTIMEOUT_LONG'            02720700
&ZOPO(&ZOPN)          SETC  'EQU'                                       02720800
&ZOPV(&ZOPN)          SETC  '2'                                         02720900
&ZOPD(&ZOPN)          SETC  '++ XRESTARTTIMEOUT.'                       02721000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LONG'                         02721100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02721200
.*-------------------------------------------------------------------   02721300
.***AM.L05 XELEMBIND XL1                                                02721400
&ZOPN                 SETA &ZOPN+1                                      02721500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XELEMBIND'                        02721600
&ZOPO(&ZOPN)          SETC 'DS'                                         02721700
&ZOPV(&ZOPN)          SETC 'XL1'                                        02721800
&ZOPD(&ZOPN)          SETC '++ &ZXELEMBIND XELEMBIND'                   02721900
.*                                                                      02722000
&ZOPN                 SETA  &ZOPN+1                                     02722100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XELEMBIND_CURJOB'                02722200
&ZOPO(&ZOPN)          SETC  'EQU'                                       02722300
&ZOPV(&ZOPN)          SETC  '0'                                         02722400
&ZOPD(&ZOPN)          SETC  '++ XELEMBIND.'                             02722500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CURJOB'                       02722600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02722700
.*                                                                      02722800
&ZOPN                 SETA  &ZOPN+1                                     02722900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XELEMBIND_CURSYS'                02723000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02723100
&ZOPV(&ZOPN)          SETC  '2'                                         02723200
&ZOPD(&ZOPN)          SETC  '++ XELEMBIND.'                             02723300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CURSYS'                       02723400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02723500
.*-------------------------------------------------------------------   02723600
.***AM.L09  XRSV0002 CL1                                                02723700
&ZOPN                 SETA &ZOPN+1                                      02723800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         02723900
&ZOPO(&ZOPN)          SETC 'DS'                                         02724000
&ZOPV(&ZOPN)          SETC 'CL1'                                        02724500
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      02725000
.*-------------------------------------------------------------------   02725100
.***AM.L09 ADDR XANSAREA A                                              02725200
&ZOPN                 SETA &ZOPN+1                                      02725300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ADDR'                    02725400
&ZOPO(&ZOPN)          SETC 'DS'                                         02725500
&ZOPV(&ZOPN)          SETC 'A'                                          02725600
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ADDR XANSAREA'                02725700
.*-------------------------------------------------------------------   02725800
.***AM.L09 ALET XANSAREA F                                              02725900
&ZOPN                 SETA &ZOPN+1                                      02726000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ALET'                    02726100
&ZOPO(&ZOPN)          SETC 'DS'                                         02726200
&ZOPV(&ZOPN)          SETC 'F'                                          02726300
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ALET XANSAREA'                02726400
.*-------------------------------------------------------------------   02726500
.***AM.L09  XTELEMENT CL16                                              02727000
&ZOPN                 SETA &ZOPN+1                                      02728000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTELEMENT'                        02729000
&ZOPO(&ZOPN)          SETC 'DS'                                         02730000
&ZOPV(&ZOPN)          SETC 'CL16'                                       02731000
&ZOPD(&ZOPN)          SETC '++ &ZXTELEMENT  XTELEMENT'                  02732000
.*-------------------------------------------------------------------   02733000
.***AM.L09 ADDR XRMTOKEN A                                              02733100
&ZOPN                 SETA &ZOPN+1                                      02733200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRMTOKEN_ADDR'                    02733300
&ZOPO(&ZOPN)          SETC 'DS'                                         02733400
&ZOPV(&ZOPN)          SETC 'A'                                          02733500
&ZOPD(&ZOPN)          SETC '++ &ZXRMTOKEN ADDR XRMTOKEN'                02733600
.*-------------------------------------------------------------------   02733700
.***AM.L09 ALET XRMTOKEN F                                              02733800
&ZOPN                 SETA &ZOPN+1                                      02733900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRMTOKEN_ALET'                    02734000
&ZOPO(&ZOPN)          SETC 'DS'                                         02734100
&ZOPV(&ZOPN)          SETC 'F'                                          02734200
&ZOPD(&ZOPN)          SETC '++ &ZXRMTOKEN ALET XRMTOKEN'                02734300
.*-------------------------------------------------------------------   02734400
.***AM.L09  XRSV0003 CL32                                               02734500
&ZOPN                 SETA &ZOPN+1                                      02735000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         02736000
&ZOPO(&ZOPN)          SETC 'DS'                                         02737000
&ZOPV(&ZOPN)          SETC 'CL32'                                       02738000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0003'                      02739000
.*-------------------------------------------------------------------   02740000
.***AM.L10 END OF IXCARM LIST PARAMETERS                                02741000
&ZOPN                 SETA &ZOPN+1                                      02742000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 02743000
&ZOPO(&ZOPN)          SETC 'EQU'                                        02744000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 02745000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         02746000
.*                                                                      02747000
&ZOPN                 SETA &ZOPN+1                                      02748000
&ZOPL(&ZOPN)          SETC ' '                                          02749000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      02750000
&ZOPV(&ZOPN)          SETC '1'                                          02751000
&ZOPD(&ZOPN)          SETC ' '                                          02752000
.*-------------------------------------------------------------------   02753000
.***AL.L12 IXCARM FMT=LIST MF=S|L PARAMETERS                            02754000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         02755000
.*                                                                      02756000
&ZOPN                 SETA  &ZOPN+1                                     02757000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                02758000
&ZOPO(&ZOPN)          SETC  'DC'                                        02759000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   02760000
&ZOPD(&ZOPN)          SETC  '++ IXCARM ARG PARMS'                       02761000
.*                                                                      02762000
.ZLMFSLX              ANOP  ,                                           02763000
.*-------------------------------------------------------------------   02764000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          02765000
&ZPLLEN               SETA 128                                          02766000
.*                                                                      02767000
.******************************************************************     02768000
.***AI.L01 IXCARM FMT=LIST FILL IN PARAMETER AREA                       02769000
.******************************************************************     02770000
                      ACTR  10000                                       02771000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               02772000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    02773000
&ZCVAL                SETC  'LAE'          XAX MODE                     02774000
.ZIMFXA               ANOP ,                                            02775000
.*                                                                      02776000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    02777000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         02778000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 02779000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                02780000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 02781000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                02782000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   02783000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    02784000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   02785000
&ZOPN                 SETA  &ZOPN+1                                     02786000
&ZOPL(&ZOPN)          SETC  ' '                                         02787000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    02788000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              02789000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       02790000
                      AGO   .ZIMFNX                                     02791000
.*                                                                      02792000
.ZIMFN2               ANOP ,                                            02793000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     02793100
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     02793200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  02793300
&ZOPN                 SETA  &ZOPN+1                                     02793400
&ZOPL(&ZOPN)          SETC  ' '                                         02793500
&ZOPO(&ZOPN)          SETC  'LAE'                                       02793600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  02793700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       02793800
                      AGO   .ZIMFNX                                     02793900
.ZIMFNX1              ANOP ,                                            02794000
&ZOPN                 SETA  &ZOPN+1                                     02794100
&ZOPL(&ZOPN)          SETC  ' '                                         02795000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    02796000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                02797000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       02798000
.ZIMFNX               ANOP ,                                            02799000
.********************************************************************   02800000
.***AI.L02 IXCARM FMT=LIST INITIALIZE PARAMETER AREA                    02801000
.********************************************************************   02802000
.***AI.L03 MF=(SLE)                                                     02803000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      02804000
.*                                                                      02806000
&ZOPN                 SETA  &ZOPN+1                                     02807000
&ZOPL(&ZOPN)          SETC  ' '                                         02808000
&ZOPO(&ZOPN)          SETC  'XC'                                        02809000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         02810000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             02811000
.ZIMFLX               ANOP  ,                                           02812000
.*-------------------------------------------------------------------   02813000
.***AI.L04A XVERSION XL1                                                02814000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    02814400
&ZOPN                 SETA  &ZOPN+1                                     02816000
&ZOPL(&ZOPN)          SETC  ' '                                         02817000
&ZOPO(&ZOPN)          SETC  'MVI'                                       02818000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           02819000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     02820000
.ZIMFVW               ANOP  ,                                           02821000
.*-------------------------------------------------------------------   02822000
.***AI.L07 XREQUEST AL1                                                 02823000
&ZW                   SETC  ''                                          02824000
.*-------------------------------------------------------------------   02825000
.***AI.L15 XREQUEST "REGISTER" AL1                                      02826000
         AIF   ('&XREQUEST' NE 'REGISTER').ZI3A                         02827000
&ZW                   SETC  '1'                                         02828000
.ZI3A                 ANOP  ,                                           02829000
.*-------------------------------------------------------------------   02830000
.***AI.L15 XREQUEST "WAITPRED" AL1                                      02831000
         AIF   ('&XREQUEST' NE 'WAITPRED').ZI4A                         02832000
&ZW                   SETC  '2'                                         02833000
.ZI4A                 ANOP  ,                                           02834000
.*-------------------------------------------------------------------   02835000
.***AI.L15 XREQUEST "READY" AL1                                         02836000
         AIF   ('&XREQUEST' NE 'READY').ZI5A                            02837000
&ZW                   SETC  '3'                                         02838000
.ZI5A                 ANOP  ,                                           02839000
.*-------------------------------------------------------------------   02840000
.***AI.L15 XREQUEST "DEREGISTER" AL1                                    02841000
         AIF   ('&XREQUEST' NE 'DEREGISTER').ZI6A                       02842000
&ZW                   SETC  '4'                                         02843000
.ZI6A                 ANOP  ,                                           02844000
.*-------------------------------------------------------------------   02845000
.***AI.L15 XREQUEST "ASSOCIATE" AL1                                     02846000
         AIF   ('&XREQUEST' NE 'ASSOCIATE').ZI7A                        02847000
&ZW                   SETC  '5'                                         02848000
.ZI7A                 ANOP  ,                                           02849000
.*-------------------------------------------------------------------   02850000
.***AI.L17 XREQUEST AL1                                                 02851000
                      AIF   ('&ZW' EQ '0').ZI7B                         02853000
                      AIF   ('&ZW' EQ '').ZI7B                          02855000
.*                                                                      02856000
&ZOPN                 SETA  &ZOPN+1                                     02857000
&ZOPL(&ZOPN)          SETC  ' '                                         02858000
&ZOPO(&ZOPN)          SETC  'MVI'                                       02859000
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  02860000
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    02861000
.ZI7B                 ANOP  ,                                           02862000
.*-------------------------------------------------------------------   02863000
.***AI.L25  XELEMENT CL16                                               02864000
                      AIF   ('&ZXELEMENT' EQ '').ZI9E                   02865000
                      AIF   ('&ZXELEMENT' EQ 'OUTPUT').ZI9E             02866000
&ZCGPR                SETC  '&XELEMENT'                                 02867000
.*                                                                      02868000
                      AIF   ('&XELEMENT'(1,1) NE '(').ZI9B              02869000
&ZCGPR   SETC  '0('.'&XELEMENT'(2,K'&XELEMENT-2).')'                    02870000
.ZI9B                 ANOP  ,                                           02871000
.*                                                                      02872000
&ZOPN                 SETA  &ZOPN+1                                     02873000
&ZOPL(&ZOPN)          SETC  ' '                                         02874000
&ZOPO(&ZOPN)          SETC  'MVC'                                       02875000
&ZOPV(&ZOPN)          SETC  '4(16,1),&ZCGPR'                            02876000
&ZOPD(&ZOPN)          SETC  '++ &ZXELEMENT XELEMENT'                    02877000
.*                                                                      02878000
.ZI9E                 ANOP  ,                                           02879000
.*-------------------------------------------------------------------   02880000
.***AI.L18  XEVENTEXIT CL8                                              02881000
         AIF   ('&XEVENTEXIT' NE 'NO_EVENTEXIT').ZI10                   02882500
&ZXEVENTEXIT          SETC  ''             RESET INPUT/OUTPUT           02884000
.ZI10                 ANOP  ,                                           02885000
.*-------------------------------------------------------------------   02886000
.***AI.L25  XEVENTEXIT CL8                                              02887200
                      AIF   ('&ZXEVENTEXIT' EQ '').ZI10E                02888400
                      AIF   ('&ZXEVENTEXIT' EQ 'OUTPUT').ZI10E          02889600
&ZCGPR                SETC  '&XEVENTEXIT'                               02890800
.*                                                                      02896500
                      AIF   ('&XEVENTEXIT'(1,1) NE '(').ZI10B           02896600
&ZCGPR   SETC  '0('.'&XEVENTEXIT'(2,K'&XEVENTEXIT-2).')'                02896700
.ZI10B                ANOP  ,                                           02896800
.*                                                                      02897000
&ZOPN                 SETA  &ZOPN+1                                     02898000
&ZOPL(&ZOPN)          SETC  ' '                                         02899000
&ZOPO(&ZOPN)          SETC  'MVC'                                       02900000
&ZOPV(&ZOPN)          SETC  '20(8,1),&ZCGPR'                            02901000
&ZOPD(&ZOPN)          SETC  '++ &ZXEVENTEXIT XEVENTEXIT'                02902000
.*                                                                      02903000
.ZI10E                ANOP  ,                                           02910500
.*-------------------------------------------------------------------   02918000
.***AI.L18 ADDR XEVENTEXITPL A                                          02919000
         AIF   ('&XEVENTEXITPL' NE 'NO_EVENTEXITPL').ZI11               02920500
&ZXEVENTEXITPL        SETC  ''             RESET INPUT/OUTPUT           02922000
.ZI11                 ANOP  ,                                           02923000
.*-------------------------------------------------------------------   02924000
.***AI.L19 ADDR XEVENTEXITPL A                                          02925000
                      AIF   ('&ZXEVENTEXITPL' EQ '').ZI11H              02926000
&ZCLNG                SETC  '&XEVENTEXITPL'                             02927000
&ZCGPR                SETC  '14'                                        02928000
         AIF   ('&XEVENTEXITPL'(1,1) EQ '(').ZI11F  IN GPR              02929000
.*                                                                      02935000
&ZOPN                 SETA  &ZOPN+1                                     02936000
&ZOPL(&ZOPN)          SETC  ' '                                         02937000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    02938000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             02939000
&ZOPD(&ZOPN)          SETC  '++ &ZXEVENTEXITPL XEVENTEXITPL'            02940000
.*                                                                      02941000
                      AGO   .ZI11G                                      02942000
.*                                                                      02943000
.ZI11F                ANOP  ,                                           02944000
&ZCGPR   SETC  '&XEVENTEXITPL'(2,K'&XEVENTEXITPL-2)                     02945000
.*                                                                      02946000
.ZI11G                ANOP  ,                                           02947000
.*                                                                      02948000
&ZOPN                 SETA  &ZOPN+1                                     02949000
&ZOPL(&ZOPN)          SETC  ' '                                         02950000
&ZOPO(&ZOPN)          SETC  'ST'                                        02951000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,28(,1)'                             02952000
&ZOPD(&ZOPN)          SETC  '++ &ZXEVENTEXITPL XEVENTEXITPL'            02953000
.*                                                                      02954000
.ZI11H                ANOP  ,                                           02955000
.*-------------------------------------------------------------------   02956000
.***AI.L18 ALET XEVENTEXITPL F                                          02957000
         AIF   ('&XEVENTEXITPL' NE 'NO_EVENTEXITPL').ZI12               02958500
&ZXEVENTEXITPL        SETC  ''             RESET INPUT/OUTPUT           02960000
.ZI12                 ANOP  ,                                           02961000
.*-------------------------------------------------------------------   02962000
.***AI.L23 ALET XEVENTEXITPL F                                          02963000
         AIF   ('&ZXEVENTEXITPL' EQ '').ZI12G                           02964000
         AIF   ('&SYSASCE' EQ 'P').ZI12G   SYSSTATE PRIMARY             02965000
&ZCLNG                SETC  '&XEVENTEXITPL'                             02966000
         AIF   ('&XEVENTEXITPL'(1,1) EQ '(').ZI12E  IN AR               02967000
.*                                                                      02974000
&ZCGPR                SETC  '14'                                        02975000
                      AGO   .ZI12F                                      02976000
.*                                                                      02977000
.ZI12E                ANOP  ,                                           02978000
&ZCGPR   SETC  '&XEVENTEXITPL'(2,K'&XEVENTEXITPL-2)                     02979000
.*                                                                      02980000
.ZI12F                ANOP  ,                                           02981000
.*                                                                      02982000
&ZOPN                 SETA  &ZOPN+1                                     02983000
&ZOPL(&ZOPN)          SETC  ' '                                         02984000
&ZOPO(&ZOPN)          SETC  'STAM'                                      02985000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,32(1)'                       02986000
&ZOPD(&ZOPN)          SETC  '++ &ZXEVENTEXITPL XEVENTEXITPL'            02987000
.*                                                                      02988000
.ZI12G                ANOP  ,                                           02989000
.*-------------------------------------------------------------------   02990000
.***AI.L25  XEXITPLLEN F                                                02991000
                      AIF   ('&ZXEXITPLLEN' EQ '').ZI13E                02992000
                      AIF   ('&ZXEXITPLLEN' EQ 'OUTPUT').ZI13E          02993000
&ZCGPR                SETC  '&XEXITPLLEN'                               02994000
.*                                                                      02995000
                      AIF   ('&XEXITPLLEN'(1,1) NE '(').ZI13B           02996000
&ZCGPR   SETC  '0('.'&XEXITPLLEN'(2,K'&XEXITPLLEN-2).')'                02997000
                      AGO   .ZI13D                                      02998000
.ZI13B                ANOP  ,                                           02999000
.*                                                                      03000000
&ZC                   SETC  '&XEXITPLLEN'(1,1)                          03001000
                      AIF   (T'&ZC NE 'N').ZI13D                        03002000
&ZC                   SETC  '&XEXITPLLEN'                               03003000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               03004000
&ZCGPR                SETC  '=AL4(&XEXITPLLEN)'                         03005000
.*                                                                      03006000
.ZI13D                ANOP  ,                                           03007000
.*                                                                      03008000
&ZOPN                 SETA  &ZOPN+1                                     03009000
&ZOPL(&ZOPN)          SETC  ' '                                         03010000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03011000
&ZOPV(&ZOPN)          SETC  '36(4,1),&ZCGPR'                            03012000
&ZOPD(&ZOPN)          SETC  '++ &ZXEXITPLLEN XEXITPLLEN'                03013000
.*                                                                      03014000
.ZI13E                ANOP  ,                                           03015000
.*-------------------------------------------------------------------   03016000
.***AI.L18 ADDR XSTARTTXT A                                             03017000
         AIF   ('&XSTARTTXT' NE 'NO_STARTTXT').ZI14                     03018500
&ZXSTARTTXT           SETC  ''             RESET INPUT/OUTPUT           03020000
.ZI14                 ANOP  ,                                           03021000
.*-------------------------------------------------------------------   03022000
.***AI.L19 ADDR XSTARTTXT A                                             03023000
                      AIF   ('&ZXSTARTTXT' EQ '').ZI14H                 03024000
&ZCLNG                SETC  '&XSTARTTXT'                                03025000
&ZCGPR                SETC  '14'                                        03026000
         AIF   ('&XSTARTTXT'(1,1) EQ '(').ZI14F  IN GPR                 03027000
.*                                                                      03033000
&ZOPN                 SETA  &ZOPN+1                                     03034000
&ZOPL(&ZOPN)          SETC  ' '                                         03035000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    03036000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             03037000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTARTTXT XSTARTTXT'                  03038000
.*                                                                      03039000
                      AGO   .ZI14G                                      03040000
.*                                                                      03041000
.ZI14F                ANOP  ,                                           03042000
&ZCGPR   SETC  '&XSTARTTXT'(2,K'&XSTARTTXT-2)                           03043000
.*                                                                      03044000
.ZI14G                ANOP  ,                                           03045000
.*                                                                      03046000
&ZOPN                 SETA  &ZOPN+1                                     03047000
&ZOPL(&ZOPN)          SETC  ' '                                         03048000
&ZOPO(&ZOPN)          SETC  'ST'                                        03049000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,40(,1)'                             03050000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTARTTXT XSTARTTXT'                  03051000
.*                                                                      03052000
.ZI14H                ANOP  ,                                           03053000
.*-------------------------------------------------------------------   03054000
.***AI.L18 ALET XSTARTTXT F                                             03055000
         AIF   ('&XSTARTTXT' NE 'NO_STARTTXT').ZI15                     03056500
&ZXSTARTTXT           SETC  ''             RESET INPUT/OUTPUT           03058000
.ZI15                 ANOP  ,                                           03059000
.*-------------------------------------------------------------------   03060000
.***AI.L23 ALET XSTARTTXT F                                             03061000
         AIF   ('&ZXSTARTTXT' EQ '').ZI15G                              03062000
         AIF   ('&SYSASCE' EQ 'P').ZI15G   SYSSTATE PRIMARY             03063000
&ZCLNG                SETC  '&XSTARTTXT'                                03064000
         AIF   ('&XSTARTTXT'(1,1) EQ '(').ZI15E  IN AR                  03065000
.*                                                                      03072000
&ZCGPR                SETC  '14'                                        03073000
                      AGO   .ZI15F                                      03074000
.*                                                                      03075000
.ZI15E                ANOP  ,                                           03076000
&ZCGPR   SETC  '&XSTARTTXT'(2,K'&XSTARTTXT-2)                           03077000
.*                                                                      03078000
.ZI15F                ANOP  ,                                           03079000
.*                                                                      03080000
&ZOPN                 SETA  &ZOPN+1                                     03081000
&ZOPL(&ZOPN)          SETC  ' '                                         03082000
&ZOPO(&ZOPN)          SETC  'STAM'                                      03083000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,44(1)'                       03084000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTARTTXT XSTARTTXT'                  03085000
.*                                                                      03086000
.ZI15G                ANOP  ,                                           03087000
.*-------------------------------------------------------------------   03088000
.***AI.L25  XSTARTTXTLEN F                                              03089000
                      AIF   ('&ZXSTARTTXTLEN' EQ '').ZI16E              03090000
                      AIF   ('&ZXSTARTTXTLEN' EQ 'OUTPUT').ZI16E        03091000
&ZCGPR                SETC  '&XSTARTTXTLEN'                             03092000
         AIF   ('&XSTARTTXTLEN' EQ '0').ZI16E                           03092500
         AIF   ('&XSTARTTXTLEN' EQ '0').ZI16E                           03092700
.*                                                                      03093000
                      AIF   ('&XSTARTTXTLEN'(1,1) NE '(').ZI16B         03094000
&ZCGPR   SETC  '0('.'&XSTARTTXTLEN'(2,K'&XSTARTTXTLEN-2).')'            03095000
                      AGO   .ZI16D                                      03096000
.ZI16B                ANOP  ,                                           03097000
.*                                                                      03098000
&ZC                   SETC  '&XSTARTTXTLEN'(1,1)                        03099000
                      AIF   (T'&ZC NE 'N').ZI16D                        03100000
&ZC                   SETC  '&XSTARTTXTLEN'                             03101000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               03102000
&ZCGPR                SETC  '=AL4(&XSTARTTXTLEN)'                       03103000
.*                                                                      03104000
.ZI16D                ANOP  ,                                           03105000
.*                                                                      03106000
&ZOPN                 SETA  &ZOPN+1                                     03107000
&ZOPL(&ZOPN)          SETC  ' '                                         03108000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03109000
&ZOPV(&ZOPN)          SETC  '48(4,1),&ZCGPR'                            03110000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTARTTXTLEN XSTARTTXTLEN'            03111000
.*                                                                      03112000
.ZI16E                ANOP  ,                                           03113000
.*-------------------------------------------------------------------   03114000
.***AI.L18  XELEMTYPE CL8                                               03115000
         AIF   ('&XELEMTYPE' NE 'NO_ELEMTYPE').ZI17                     03116500
&ZXELEMTYPE           SETC  ''             RESET INPUT/OUTPUT           03118000
.ZI17                 ANOP  ,                                           03119000
.*-------------------------------------------------------------------   03120000
.***AI.L25  XELEMTYPE CL8                                               03121000
                      AIF   ('&ZXELEMTYPE' EQ '').ZI17E                 03122000
                      AIF   ('&ZXELEMTYPE' EQ 'OUTPUT').ZI17E           03123000
&ZCGPR                SETC  '&XELEMTYPE'                                03124000
.*                                                                      03130000
                      AIF   ('&XELEMTYPE'(1,1) NE '(').ZI17B            03131000
&ZCGPR   SETC  '0('.'&XELEMTYPE'(2,K'&XELEMTYPE-2).')'                  03132000
.ZI17B                ANOP  ,                                           03133000
.*                                                                      03134000
&ZOPN                 SETA  &ZOPN+1                                     03135000
&ZOPL(&ZOPN)          SETC  ' '                                         03136000
&ZOPO(&ZOPN)          SETC  'MVC'                                       03137000
&ZOPV(&ZOPN)          SETC  '52(8,1),&ZCGPR'                            03138000
&ZOPD(&ZOPN)          SETC  '++ &ZXELEMTYPE XELEMTYPE'                  03139000
.*                                                                      03140000
.ZI17E                ANOP  ,                                           03141000
.*-------------------------------------------------------------------   03142000
.***AI.L07 XTERMTYPE AL1                                                03143000
&ZW                   SETC  ''                                          03144000
.*-------------------------------------------------------------------   03145000
.***AI.L15 XTERMTYPE "ALLTERM" AL1                                      03146000
         AIF   ('&XTERMTYPE' NE 'ALLTERM').ZI19A                        03147000
&ZW                   SETC  '1'                                         03148000
.ZI19A                ANOP  ,                                           03149000
.*-------------------------------------------------------------------   03150000
.***AI.L15 XTERMTYPE "ELEMTERM" AL1                                     03151000
         AIF   ('&XTERMTYPE' NE 'ELEMTERM').ZI20A                       03152000
&ZW                   SETC  '2'                                         03153000
.ZI20A                ANOP  ,                                           03154000
.*-------------------------------------------------------------------   03155000
.***AI.L15 XTERMTYPE "SYSTERM" AL1                                      03155100
         AIF   ('&XTERMTYPE' NE 'SYSTERM').ZI21A                        03155200
&ZW                   SETC  '3'                                         03155300
.ZI21A                ANOP  ,                                           03155400
.*-------------------------------------------------------------------   03155500
.***AI.L17 XTERMTYPE AL1                                                03156000
                      AIF   ('&ZW' EQ '0').ZI21B                        03157600
                      AIF   ('&ZW' EQ '').ZI21B                         03159200
.*                                                                      03161000
&ZOPN                 SETA  &ZOPN+1                                     03162000
&ZOPL(&ZOPN)          SETC  ' '                                         03163000
&ZOPO(&ZOPN)          SETC  'MVI'                                       03164000
&ZOPV(&ZOPN)          SETC  '60(1),&ZW'                                 03165000
&ZOPD(&ZOPN)          SETC  '++ &ZXTERMTYPE XTERMTYPE'                  03166000
.ZI21B                ANOP  ,                                           03167000
.*-------------------------------------------------------------------   03168000
.***AI.L07 XRESTARTTIMEOUT AL1                                          03168100
&ZW                   SETC  ''                                          03168200
.*-------------------------------------------------------------------   03168300
.***AI.L15 XRESTARTTIMEOUT "NORM" AL1                                   03168400
         AIF   ('&XRESTARTTIMEOUT' NE 'NORM').ZI23A                     03168500
&ZW                   SETC  '1'                                         03168600
.ZI23A                ANOP  ,                                           03169700
.*-------------------------------------------------------------------   03169800
.***AI.L15 XRESTARTTIMEOUT "LONG" AL1                                   03169900
         AIF   ('&XRESTARTTIMEOUT' NE 'LONG').ZI24A                     03170000
&ZW                   SETC  '2'                                         03170100
.ZI24A                ANOP  ,                                           03170200
.*-------------------------------------------------------------------   03170300
.***AI.L17 XRESTARTTIMEOUT AL1                                          03170400
                      AIF   ('&ZW' EQ '0').ZI24B                        03170500
                      AIF   ('&ZW' EQ '').ZI24B                         03170600
.*                                                                      03170700
&ZOPN                 SETA  &ZOPN+1                                     03170800
&ZOPL(&ZOPN)          SETC  ' '                                         03170900
&ZOPO(&ZOPN)          SETC  'MVI'                                       03171000
&ZOPV(&ZOPN)          SETC  '61(1),&ZW'                                 03171100
&ZOPD(&ZOPN)          SETC  '++ &ZXRESTARTTIMEOUT XRESTARTTIMEOUT'      03171200
.ZI24B                ANOP  ,                                           03171300
.*-------------------------------------------------------------------   03171400
.***AI.L07 XELEMBIND AL1                                                03171500
&ZW                   SETC  ''                                          03171600
.*-------------------------------------------------------------------   03171700
.***AI.L15 XELEMBIND "CURJOB" AL1                                       03171800
         AIF   ('&XELEMBIND' NE 'CURJOB').ZI26A                         03171900
&ZW                   SETC  '0'                                         03172000
.ZI26A                ANOP  ,                                           03172100
.*-------------------------------------------------------------------   03172200
.***AI.L15 XELEMBIND "CURSYS" AL1                                       03172300
         AIF   ('&XELEMBIND' NE 'CURSYS').ZI27A                         03172400
&ZW                   SETC  '2'                                         03172500
.ZI27A                ANOP  ,                                           03172600
.*-------------------------------------------------------------------   03172700
.***AI.L17 XELEMBIND AL1                                                03172800
                      AIF   ('&ZW' EQ '0').ZI27B                        03172900
                      AIF   ('&ZW' EQ '').ZI27B                         03173000
.*                                                                      03173100
&ZOPN                 SETA  &ZOPN+1                                     03173200
&ZOPL(&ZOPN)          SETC  ' '                                         03173300
&ZOPO(&ZOPN)          SETC  'MVI'                                       03173400
&ZOPV(&ZOPN)          SETC  '62(1),&ZW'                                 03173500
&ZOPD(&ZOPN)          SETC  '++ &ZXELEMBIND XELEMBIND'                  03173600
.ZI27B                ANOP  ,                                           03173700
.*-------------------------------------------------------------------   03173800
.***AI.L19 ADDR XANSAREA A                                              03173900
                      AIF   ('&ZXANSAREA' EQ '').ZI29H                  03174000
&ZCLNG                SETC  '&XANSAREA'                                 03174100
&ZCGPR                SETC  '14'                                        03174200
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI29F  IN GPR                  03174300
.*                                                                      03174400
&ZOPN                 SETA  &ZOPN+1                                     03174500
&ZOPL(&ZOPN)          SETC  ' '                                         03174600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    03174700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             03174800
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    03174900
.*                                                                      03175000
                      AGO   .ZI29G                                      03175100
.*                                                                      03175200
.ZI29F                ANOP  ,                                           03175300
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             03175400
.*                                                                      03175500
.ZI29G                ANOP  ,                                           03175600
.*                                                                      03175700
&ZOPN                 SETA  &ZOPN+1                                     03175800
&ZOPL(&ZOPN)          SETC  ' '                                         03175900
&ZOPO(&ZOPN)          SETC  'ST'                                        03176000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,64(,1)'                             03176100
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    03176200
.*                                                                      03176300
.ZI29H                ANOP  ,                                           03176400
.*-------------------------------------------------------------------   03176500
.***AI.L23 ALET XANSAREA F                                              03176600
         AIF   ('&ZXANSAREA' EQ '').ZI30G                               03176700
         AIF   ('&SYSASCE' EQ 'P').ZI30G   SYSSTATE PRIMARY             03176800
&ZCLNG                SETC  '&XANSAREA'                                 03176900
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI30E  IN AR                   03177000
.*                                                                      03177100
&ZCGPR                SETC  '14'                                        03177200
                      AGO   .ZI30F                                      03177300
.*                                                                      03177400
.ZI30E                ANOP  ,                                           03177500
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             03177600
.*                                                                      03177700
.ZI30F                ANOP  ,                                           03177800
.*                                                                      03177900
&ZOPN                 SETA  &ZOPN+1                                     03178000
&ZOPL(&ZOPN)          SETC  ' '                                         03178100
&ZOPO(&ZOPN)          SETC  'STAM'                                      03178200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,68(1)'                       03178300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    03178400
.*                                                                      03178500
.ZI30G                ANOP  ,                                           03178600
.*-------------------------------------------------------------------   03178700
.***AI.L25  XTELEMENT CL16                                              03178800
                      AIF   ('&ZXTELEMENT' EQ '').ZI31E                 03178900
                      AIF   ('&ZXTELEMENT' EQ 'OUTPUT').ZI31E           03179000
&ZCGPR                SETC  '&XTELEMENT'                                03179100
.*                                                                      03179200
                      AIF   ('&XTELEMENT'(1,1) NE '(').ZI31B            03179300
&ZCGPR   SETC  '0('.'&XTELEMENT'(2,K'&XTELEMENT-2).')'                  03179400
.ZI31B                ANOP  ,                                           03179500
.*                                                                      03179600
&ZOPN                 SETA  &ZOPN+1                                     03179700
&ZOPL(&ZOPN)          SETC  ' '                                         03179800
&ZOPO(&ZOPN)          SETC  'MVC'                                       03180000
&ZOPV(&ZOPN)          SETC  '72(16,1),&ZCGPR'                           03181000
&ZOPD(&ZOPN)          SETC  '++ &ZXTELEMENT XTELEMENT'                  03182000
.*                                                                      03183000
.ZI31E                ANOP  ,                                           03183100
.*-------------------------------------------------------------------   03183200
.***AI.L18 ADDR XRMTOKEN A                                              03183300
         AIF   ('&XRMTOKEN' NE 'NO_RMTOKEN').ZI32                       03183400
&ZXRMTOKEN            SETC  ''             RESET INPUT/OUTPUT           03183500
.ZI32                 ANOP  ,                                           03183600
.*-------------------------------------------------------------------   03183700
.***AI.L19 ADDR XRMTOKEN A                                              03183800
                      AIF   ('&ZXRMTOKEN' EQ '').ZI32H                  03183900
&ZCLNG                SETC  '&XRMTOKEN'                                 03184000
&ZCGPR                SETC  '14'                                        03184100
         AIF   ('&XRMTOKEN'(1,1) EQ '(').ZI32F  IN GPR                  03184200
.*                                                                      03184300
&ZOPN                 SETA  &ZOPN+1                                     03184400
&ZOPL(&ZOPN)          SETC  ' '                                         03184500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    03184600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             03184700
&ZOPD(&ZOPN)          SETC  '++ &ZXRMTOKEN XRMTOKEN'                    03184800
.*                                                                      03184900
                      AGO   .ZI32G                                      03185000
.*                                                                      03185100
.ZI32F                ANOP  ,                                           03185200
&ZCGPR   SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                             03185300
.*                                                                      03185400
.ZI32G                ANOP  ,                                           03185500
.*                                                                      03185600
&ZOPN                 SETA  &ZOPN+1                                     03185700
&ZOPL(&ZOPN)          SETC  ' '                                         03185800
&ZOPO(&ZOPN)          SETC  'ST'                                        03185900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,88(,1)'                             03186000
&ZOPD(&ZOPN)          SETC  '++ &ZXRMTOKEN XRMTOKEN'                    03186100
.*                                                                      03186200
.ZI32H                ANOP  ,                                           03186300
.*-------------------------------------------------------------------   03186400
.***AI.L18 ALET XRMTOKEN F                                              03186500
         AIF   ('&XRMTOKEN' NE 'NO_RMTOKEN').ZI33                       03186600
&ZXRMTOKEN            SETC  ''             RESET INPUT/OUTPUT           03186700
.ZI33                 ANOP  ,                                           03186800
.*-------------------------------------------------------------------   03186900
.***AI.L23 ALET XRMTOKEN F                                              03187000
         AIF   ('&ZXRMTOKEN' EQ '').ZI33G                               03187100
         AIF   ('&SYSASCE' EQ 'P').ZI33G   SYSSTATE PRIMARY             03187200
&ZCLNG                SETC  '&XRMTOKEN'                                 03187300
         AIF   ('&XRMTOKEN'(1,1) EQ '(').ZI33E  IN AR                   03187400
.*                                                                      03187500
&ZCGPR                SETC  '14'                                        03187600
                      AGO   .ZI33F                                      03187700
.*                                                                      03187800
.ZI33E                ANOP  ,                                           03187900
&ZCGPR   SETC  '&XRMTOKEN'(2,K'&XRMTOKEN-2)                             03188000
.*                                                                      03188100
.ZI33F                ANOP  ,                                           03188200
.*                                                                      03188300
&ZOPN                 SETA  &ZOPN+1                                     03188400
&ZOPL(&ZOPN)          SETC  ' '                                         03188500
&ZOPO(&ZOPN)          SETC  'STAM'                                      03188600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,92(1)'                       03188700
&ZOPD(&ZOPN)          SETC  '++ &ZXRMTOKEN XRMTOKEN'                    03188800
.*                                                                      03188900
.ZI33G                ANOP  ,                                           03189000
.*-------------------------------------------------------------------   03189100
&ZOPN1                SETA &ZOPN                                        03189200
.*******************************************************************    03190000
.***  PROCESS IXCARM OUTPUT PARAMETERS                                  03191000
.*******************************************************************    03192000
                      ACTR  10000                                       03193000
.*******************************************************************    03194000
.***AO.X02  RETURN CODE PROCESSING                                      03195000
.*******************************************************************    03196000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    03197000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            03198000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             03199000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             03200000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               03201000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                03202000
&ZOPN                 SETA  &ZOPN+1                                     03203000
&ZOPL(&ZOPN)          SETC  ' '                                         03204000
&ZOPO(&ZOPN)          SETC  'ST'                                        03205000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              03206000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        03207000
                      AGO   .ZMRETX                                     03208000
.*                                                                      03209000
.ZMRET2               ANOP  ,                                           03210000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                03211000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                03212000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                03213000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  03214000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   03215000
&ZOPN                 SETA  &ZOPN+1                                     03216000
&ZOPL(&ZOPN)          SETC  ' '                                         03217000
&ZOPO(&ZOPN)          SETC  'LR'                                        03218000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 03219000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        03220000
.ZMRETX               ANOP  ,                                           03221000
.*******************************************************************    03222000
.***AO.X03  REASON CODE PROCESSING                                      03223000
.*******************************************************************    03224000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    03225000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            03226000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              03227000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             03228000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              03229000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             03230000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                03231000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 03232000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                03233000
&ZOPN                 SETA  &ZOPN+1                                     03234000
&ZOPL(&ZOPN)          SETC  ' '                                         03235000
&ZOPO(&ZOPN)          SETC  'ST'                                        03236000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               03237000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        03238000
                      AGO   .ZMRSNX                                     03239000
.*                                                                      03240000
.ZMRSN2               ANOP  ,                                           03241000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                03242000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 03243000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                03244000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 03245000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                03246000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   03247000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    03248000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   03249000
&ZOPN                 SETA  &ZOPN+1                                     03250000
&ZOPL(&ZOPN)          SETC  ' '                                         03251000
&ZOPO(&ZOPN)          SETC  'LR'                                        03252000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  03253000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        03254000
.ZMRSNX               ANOP  ,                                           03255000
.*******************************************************************    03256000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   03257000
.*******************************************************************    03258000
.ZMFLX                ANOP  ,              MF=L PROCESSING              03259000
.*******************************************************************    03260000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               03261000
.*******************************************************************    03262000
                      ACTR  10000                                       03263000
.*                                                                      03264000
                      LCLA  &ZLC           COLUMN POSITION              03265000
                      LCLA  &ZOPX          LIST TABLE INDEX             03266000
                      LCLC  &ZLL           LABEL                        03267000
                      LCLC  &ZLOP          OPERATION                    03268000
                      LCLC  &ZLV           VALUE                        03269000
                      LCLC  &ZLD           DESCRIPTION                  03270000
.*                                                                      03271000
&ZOPX                 SETA  1                                           03272000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            03273000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              03274000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              03275000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              03276000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              03277000
                      AIF   (K'&ZLD LE 0).ZL5                           03278000
&ZLC                  SETA  35             COMMENT COLUMN               03279000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    03280000
&ZLC                  SETA  33             COMMMENT COLUMN              03281000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   03282000
&ZLV                  SETC  '&ZLV'.' '                                  03283000
                      AGO   .ZL3                                        03284000
.*                                                                      03285000
.ZL4                  ANOP  ,                                           03286000
&ZLV                  SETC  '&ZLV'.' '                                  03287000
.ZL5                  ANOP  ,                                           03288000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               03289000
.*                                                                      03290000
&ZLL     &ZLOP &ZLV                                                     03291000
.*                                                                      03292000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               03293000
                      AGO   .ZL2           CONTINUE LOOPING             03294000
.*                                                                      03295000
.ZLX                  ANOP  ,                                           03296000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                03297000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  03299000
         L     14,16(0,0)              GET CVT ADDRESS INTO REG 14      03300000
         TM    116(14),B'00001000'     TEST IF RELEASE BITS ARE IN CVT  03300300
         BZ    ARM1&SYSNDX             IF NOT, EXIT MACRO               03300600
         TM    1265(14),B'00010000'    TEST RELEASE BIT IN CVT          03301000
         BNZ   ARM2&SYSNDX             SYSTEM HAS FUNCTION.  CONTINUE   03301600
ARM1&SYSNDX DS 0H                                                       03302200
         LA    15,12                   PUT RETURN CODE 12 IN REG 15     03303000
         LA    0,4                     PUT REASON CODE 4 IN REG 0       03304000
         B     ARM3&SYSNDX             EXIT MACRO                       03305000
ARM2&SYSNDX DS 0H                                                       03306000
         L     14,16(0,0)              GET CVT ADDRESS                  03307000
         L     14,772(14,0)            GET SFT ADDRESS                  03308000
         L     14,220(14,0)            GET LX FOR SERVICE ROUTINE       03309000
         LA    15,48                   GET EX FOR SERVICE ROUTINE       03310000
         OR    14,15                   GET PC NUMBER                    03311000
         LCLC  &IXCR0VAL0              local macro variable             03311200
&IXCR0VAL0 SETC '0'                    set value                        03311400
         LA    0,&IXCR0VAL0.(0,0)      indicate IXCARM call             03311600
         PC    0(14)                   INVOKE PCT ROUTINE               03312300
ARM3&SYSNDX DS 0H                                                       03313000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  03314000
.ZLINKX               ANOP  ,                                           03315000
.*******************************************************************    03316000
.***AP.X01  FORMAT GENERATED CODE                                       03317000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            03318000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              03319000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              03320000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              03321000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              03322000
                      AIF   (K'&ZLD LE 0).ZL51                          03323000
&ZLC                  SETA  35             COMMENT COLUMN               03324000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   03325000
&ZLC                  SETA  33             COMMENT COLUMN               03326000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  03327000
&ZLV                  SETC  '&ZLV'.' '                                  03328000
                      AGO   .ZL31                                       03329000
.*                                                                      03330000
.ZL41                 ANOP  ,                                           03331000
&ZLV                  SETC  '&ZLV'.' '                                  03332000
.ZL51                 ANOP  ,                                           03333000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               03334000
.*                                                                      03335000
&ZLL     &ZLOP &ZLV                                                     03336000
.*                                                                      03337000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               03338000
                      AGO   .ZL21          CONTINUE LOOPING             03339000
.*                                                                      03340000
.ZLX1                 ANOP  ,                                           03341000
.*******************************************************************    03342000
.***AP.X02  END OF IXCARM MACRO                                         03343000
&ZIXCARM              SETC  'YES'          SET IXCARM USED              03344000
         POP   PRINT                                                    03345000
*                                            IXCARM-1                   03346000
         SPACE 1                                                        03347000
.ZLX2                 ANOP  ,                                           03348000
         MEND                                                           03349000
**********************************************************************/ 03350000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  03351000
*%IXCARM: MACRO KEYS(REQUEST,ELEMENT,EVENTEXIT,EVENTEXITPL,EXITPLLEN,   03351800
*                 STARTTXT,STARTTXTLEN,ELEMTYPE,TERMTYPE,ELEMBIND,      03352600
*                 RMTOKEN,RESTARTTIMEOUT,ANSAREA,TELEMENT,RETCODE,      03353400
*                 RSNCODE,PLISTVER,MF);                                 03354200
*  ANS('?'||MACLABEL||' '||'IXCARMP '||MACLIST||                        03355000
*         ' '||MACKEYS||';') COL(MACLMAR);                              03356000
*%END IXCARM;                                                           03357000
