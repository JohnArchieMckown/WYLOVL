*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  REFPAT                                -06/20/91-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Reference Pattern Information                 * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     5695-047                                                        * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     (C) COPYRIGHT IBM CORP. 1990                                    * 00001300
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001400
*                                                                     * 00001500
* STATUS= HBB4410                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*                                                                     * 00001900
*01* FUNCTION:                                                        * 00002000
*                                                                     * 00002100
*                                                                     * 00002200
*      REFPAT is the new macro interface for the communication of     * 00002300
*      page reference patterns to RSM. RSM will use the reference     * 00002400
*      patterns as input into the paging algorithms.                  * 00002500
*                                                                     * 00002600
*      Installing a reference pattern                                 * 00002700
*                                                                     * 00002800
*      A user may install a reference pattern by invoking the REFPAT  * 00002900
*      macro with the INSTALL option. The user will specify the       * 00003000
*      STOKEN for the data space, or zero if the pattern is for the   * 00003100
*      address space. The user will supply starting and ending        * 00003200
*      addresses for which the reference pattern will apply. The user * 00003300
*      will also convey the reference pattern which the user is       * 00003400
*      expected to use.                                               * 00003500
*                                                                     * 00003600
*      The reference pattern consists of three pieces of information: * 00003700
*      UnitSize, Gap, and Units. UnitSize and Gap are specified in    * 00003800
*      terms of bytes.  UnitSize indicates the number of contiguous   * 00003900
*      bytes to treat as a "paging unit".  Gap indicates the number   * 00004000
*      of contiguous bytes to skip to bring in the next "paging       * 00004100
*      unit".  Units refers to the number of "paging units" that the  * 00004200
*      user expects to need together at one time.  If not specified,  * 00004300
*      Gap will default to 0 and Units will default to 1.             * 00004400
*                                                                     * 00004500
*      Example: UNITSIZE=4096, GAP=0, UNITS=1 is (roughly) normal     * 00004600
*      paging.  Each time a fault is taken on a page (size 4096),     * 00004700
*      that amount is paged in (one page) and only one page is paged  * 00004800
*      in (UNITS=1). (One assumption here, for simplicity, is that    * 00004900
*      the translation exception address (TEA) is on a page boundary. * 00005000
*      Were that not the case, the size 4096 would span more than one * 00005100
*      page, so two pages would actually be paged in).                * 00005200
*                                                                     * 00005300
*      Example: UNITSIZE=4096, GAP=0, UNITS=10 might be used to       * 00005400
*      denote a sequential reference pattern. Each time a fault is    * 00005500
*      taken on a page, one page is paged in (4096 bytes), and 9      * 00005600
*      additional pages (10-1) directly following (GAP=0) the faulted * 00005700
*      on page are also brought in (subject to resource               * 00005800
*      availability).                                                 * 00005900
*                                                                     * 00006000
*      Example: UNITSIZE=8192, GAP=4096, UNITS=4 would be used to     * 00006100
*      denote a more complicated reference pattern. Here, the user    * 00006200
*      expects to reference 8192 bytes, then skip 4096 bytes, then    * 00006300
*      reference 8192 bytes, etcetera.  The UNITS=4 tells us that the * 00006400
*      user would like to get 4 units of 8192 bytes (each separated   * 00006500
*      by 4096 bytes) paged in at a time.                             * 00006600
*                                                                     * 00006700
*      Removing a reference pattern                                   * 00006800
*                                                                     * 00006900
*      A user may remove a previously intalled reference pattern by   * 00007000
*      invoking the REFPAT macro with the REMOVE option. A portion of * 00007100
*      a reference pattern cannot be specified. The Stoken and Start  * 00007200
*      and End addresses must correspond exactly to the Stoken Start  * 00007300
*      and End addresses specified on a previous INSTALL invocation.  * 00007400
*                                                                     * 00007500
*      The pattern should not be specified on the REMOVE invocation.  * 00007600
*                                                                     * 00007700
*      REGISTER USAGE                                                 * 00007800
*                                                                     * 00007900
*      GPRs 2 through 13 and ARs 2 through 13 are preserved.  GPRs 14 * 00008000
*      through 1 and ARs 14 through 1 are unpredictable.              * 00008100
*                                                                     * 00008200
*01* INVOCATION REQUIREMENTS:                                         * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*      Execution Mode:   Task mode.                                   * 00008600
*                                                                     * 00008700
*      Authorization:    Problem or Supervisor state.  Any PSW key.   * 00008800
*                                                                     * 00008900
*      Addressing Mode:  31 bit addressing mode.                      * 00009000
*                                                                     * 00009100
*      ASC mode:         Primary or Access Register ASC mode.         * 00009200
*                                                                     * 00009300
*      Serialization:                                                 * 00009400
*                                                                     * 00009500
*                        REFPAT invokers must be enabled and          * 00009600
*                        unlocked.                                    * 00009700
*                                                                     * 00009800
*      Restrictions:                                                  * 00009900
*                                                                     * 00010000
*                        Primary=Home=Secondary                       * 00010100
*                                                                     * 00010200
*                        If an STOKEN is specified for a data space   * 00010300
*                        (ie. nonzero), the data space must be owned  * 00010400
*                        by the calling address space.                * 00010500
*                                                                     * 00010600
*                                                                     * 00010700
*01* INVOCATION FORMAT:                                               * 00010800
*                                                                     * 00010900
*          REFPAT    INSTALL                                         * 00011000
*                      [,STOKEN=xstoken|0]                         * 00011100
*                       ,PSTART=xpstart                              * 00011200
*                       ,PEND=xpend                                  * 00011300
*                       ,UNITSIZE=xunitsize                          * 00011400
*                      [,GAP=xgap|0]                               * 00011500
*                      [,UNITS=xunits|1]                           * 00011600
*                   ,REMOVE                                          * 00011700
*                       [,STOKEN=xstoken|0]                         * 00011800
*                        ,PSTART=xpstart                              * 00011900
*                        ,PEND=xpend                                  * 00012000
*                  [,MF=S]                                           * 00012100
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 00012200
*                  [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]              * 00012300
*                  [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]              * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*      Where:                                                         * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*      The following is a set of mutually exclusive keys.  This set   * 00013000
*      is required; only one key must be specified.                   * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*      INSTALL                                                        * 00013400
*          is used to indicate a reference pattern is to be           * 00013500
*          installed.                                                 * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*          [STOKEN=xstoken|0]                                       * 00013900
*              is the name (RX-type), or address in register          * 00014000
*              (2)-(12), of an optional 8 character input variable    * 00014100
*              that contains the stoken denoting the data space for   * 00014200
*              which the pattern applies, or 0 if the pattern applies * 00014300
*              to an address space.                                   * 00014400
*                                                                     * 00014500
*              DEFAULT: 0                                             * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*          PSTART=xpstart                                             * 00015000
*              is the name (RX-type), or address in register          * 00015100
*              (2)-(12), of a required 4 byte input that contains the * 00015200
*              address denoting the start of the virtual storage      * 00015300
*              range for which the reference pattern applies.         * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*          PEND=xpend                                                 * 00015800
*              is the name (RX-type), or address in register          * 00015900
*              (2)-(12), of a required 4 byte input that contains the * 00016000
*              address denoting the end of the virtual storage range  * 00016100
*              for which the reference pattern applies.               * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*          UNITSIZE=xunitsize                                         * 00016600
*              is the name (RX-type), or address in register          * 00016700
*              (2)-(12), of a required fullword input variable that   * 00016800
*              contains the UNITSIZE, in bytes, of the reference      * 00016900
*              pattern.                                               * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*          [GAP=xgap|0]                                             * 00017400
*              is the name (RX-type), or address in register          * 00017500
*              (2)-(12), of an optional fullword input variable that  * 00017600
*              contains the GAP, in bytes, of the reference pattern.  * 00017700
*                                                                     * 00017800
*              DEFAULT: 0.                                            * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*          [UNITS=xunits|1]                                         * 00018300
*              is the name (RX-type), or address in register          * 00018400
*              (2)-(12), of an optional fullword input variable that  * 00018500
*              contains the advised number of units to be paged in at * 00018600
*              once.                                                  * 00018700
*                                                                     * 00018800
*              DEFAULT: 1.                                            * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*      REMOVE                                                         * 00019200
*          is used to indicate a reference pattern is to be removed.  * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*          [STOKEN=xstoken|0]                                       * 00019600
*              is the name (RX-type), or address in register          * 00019700
*              (2)-(12), of an optional 8 character input variable    * 00019800
*              that contains the stoken denoting the data space for   * 00019900
*              which the pattern applies.                             * 00020000
*                                                                     * 00020100
*              DEFAULT: 0                                             * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*          PSTART=xpstart                                             * 00020600
*              is the name (RX-type), or address in register          * 00020700
*              (2)-(12), of a required 4 byte input that contains the * 00020800
*              address variable that contains the address denoting    * 00020900
*              the start of the virtual storage range for which the   * 00021000
*              reference pattern applies.                             * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*          PEND=xpend                                                 * 00021500
*              is the name (RX-type), or address in register          * 00021600
*              (2)-(12), of a required 4 byte input that contains the * 00021700
*              address variable that contains the address denoting    * 00021800
*              the end of the virtual storage range for which the     * 00021900
*              reference pattern applies.                             * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*      End of a set of mutually exclusive required keys.              * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*      [MF=S|L|M|E]                                                 * 00022800
*          is an optional keyword input which specifies the macro     * 00022900
*          form.                                                      * 00023000
*          DEFAULT: S                                                 * 00023100
*                                                                     * 00023200
*                                                                     * 00023300
*          [MF=S]                                                     * 00023400
*              specifies the standard form of the macro.  The "S"     * 00023500
*              form generates code to put the parameters into an      * 00023600
*              in-line parameter list and invoke the desired service. * 00023700
*              Full checking for required macro keys is done along    * 00023800
*              with supplying defaults for optional parameters that   * 00023900
*              are not specified.                                     * 00024000
*                                                                     * 00024100
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00024200
*              specifies the list form of the macro.  The "L" form    * 00024300
*              defines an area to be used for the parameter list.     * 00024400
*              Any other macro parameters are flagged as errors.      * 00024500
*                                                                     * 00024600
*            ,xmfctrl                                                 * 00024700
*              is a required input.  It is the name of a storage area * 00024800
*              for the parameter list.                                * 00024900
*                                                                     * 00025000
*            ,xmfattr|0D                                            * 00025100
*              is an optional 60 character input string that varies   * 00025200
*              from 1 to 60 characters. It can contain any value that * 00025300
*              is valid on an assembler DS pseudo-op. You can use     * 00025400
*              this parameter to force boundary alignment of the      * 00025500
*              parameter list.                                        * 00025600
*              DEFAULT: 0D which forces the parameter list to a       * 00025700
*              doubleword boundary.                                   * 00025800
*                                                                     * 00025900
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00026000
*              specifies the modify form of the macro.  The "M" form  * 00026100
*              generates code to put the parameters into the          * 00026200
*              parameter list specified by xmfctrl.                   * 00026300
*                                                                     * 00026400
*            ,xmfctrl                                                 * 00026500
*              is a required input.  It is the name (RX-type), or     * 00026600
*              address in register (2)-(12), of a storage area for    * 00026700
*              the parameter list.                                    * 00026800
*                                                                     * 00026900
*            ,COMPLETE|NOCHECK]                                     * 00027000
*              is an optional keyword input which specifies the       * 00027100
*              degree of macro parameter syntax checking.             * 00027200
*              DEFAULT: COMPLETE                                      * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*              COMPLETE   Checking for required macro keys is done    * 00027600
*                        and defaults are supplied for optional       * 00027700
*                        parameters that were not specified (See      * 00027800
*                        Macro Usage Note 2).                         * 00027900
*                                                                     * 00028000
*              NOCHECK   Checking for required macro keys is not done * 00028100
*                        nor are defaults supplied for optional       * 00028200
*                        parameters that were not specified.          * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00028600
*              specifies the execute form of the macro.  The "E" form * 00028700
*              generates code to put the parameters into the          * 00028800
*              parameter list specified by xmfctrl and invoke the     * 00028900
*              desired service.                                       * 00029000
*                                                                     * 00029100
*            ,xmfctrl                                                 * 00029200
*              is a required input.  It is the name (RX-type), or     * 00029300
*              address in register (2)-(12), of a storage area for    * 00029400
*              the parameter list.                                    * 00029500
*                                                                     * 00029600
*            ,COMPLETE|NOCHECK                                      * 00029700
*              is an optional keyword input which specifies the       * 00029800
*              degree of macro parameter syntax checking.             * 00029900
*              DEFAULT: COMPLETE                                      * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*              COMPLETE   Checking for required macro keys is done    * 00030300
*                        and defaults are supplied for optional       * 00030400
*                        parameters that were not specified (See      * 00030500
*                        Macro Usage Note 2).                         * 00030600
*                                                                     * 00030700
*              NOCHECK   Checking for required macro keys is not done * 00030800
*                        nor are defaults supplied for optional       * 00030900
*                        parameters that were not specified.          * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*01* RETURN CODES:                                                    * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*            00   Successful completion                               * 00031800
*                                                                     * 00031900
*            04   Successful completion, but reference pattern        * 00032000
*                 information not retained.  This might happen if MVS * 00032100
*                 determines that the information specified would not * 00032200
*                 help in the paging algorithms. For example, if the  * 00032300
*                 user specified unitsize=20, units=3, the total      * 00032400
*                 amount would be less than the size of a page, and   * 00032500
*                 hence would create more overhead than it would be   * 00032600
*                 worth.                                              * 00032700
*                                                                     * 00032800
*            08   Unsuccessful completion, reference pattern          * 00032900
*                 information not retained.                           * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*01* REASON CODES:                                                    * 00033300
*                                                                     * 00033400
*       REASON    RETURN                                              * 00033500
*       CODE      CODE      DESCRIPTION                               * 00033600
*                                          * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*       xx0001xx  04        Reference   pattern   specified  was  not * 00034000
*                           retained  because  it was deemed that the * 00034100
*                           paging algorithms would do better without * 00034200
*                           it.                                       * 00034300
*                                                                     * 00034400
*       xx0002xx  08        Range  specified  on  INSTALL  invocation * 00034500
*                           overlaps   the  range  for  a  previously * 00034600
*                           installed pattern.                        * 00034700
*                                                                     * 00034800
*       xx0003xx  08        Limit  on  number  of  ranges allowed was * 00034900
*                           exceeded. INSTALL not accepted.           * 00035000
*                                                                     * 00035100
*       xx0004xx  08        Storage  not  obtained  for  RPH  and  or * 00035200
*                           RPI.INSTALL not accepted.                 * 00035300
*                                                                     * 00035400
*       xx0101xx  08        REMOVE  request  was  not successful - no * 00035500
*                           pattern  was  installed  for the range of * 00035600
*                           virtual  storage  specified. This may not * 00035700
*                           be   an  error,  as  a  previous  INSTALL * 00035800
*                           request  may simply have been rejected as * 00035900
*                           less than efficient.                      * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*01* ABEND CODES:                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*       xxx       REFPAT service failed for non-environmental error.  * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*01* ABEND REASON CODES:                                              * 00036900
*                                                                     * 00037000
*       REASON    ABEND                                               * 00037100
*       CODE      CODE      DESCRIPTION                               * 00037200
*                                          * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*       xxFF01xx  6C7       Caller was in cross memory mode           * 00037600
*                                                                     * 00037700
*       xxFF02xx  6C7       Locks held on entry                       * 00037800
*                                                                     * 00037900
*       xxFF03xx  6C7       Protection  exception  taken on parameter * 00038000
*                           list                                      * 00038100
*                                                                     * 00038200
*       xxFF04xx  6C7       Nonzero  reserved  fields  found  in  the * 00038300
*                           parameter list                            * 00038400
*                                                                     * 00038500
*       xxFF05xx  6C7       Caller requested unknown service          * 00038600
*                                                                     * 00038700
*       xxFF06xx  6C7       Caller was in 24-bit mode                 * 00038800
*                                                                     * 00038900
*       xxFF07xx  6C7       SRB mode caller                           * 00039000
*                                                                     * 00039100
*       xxFF08xx  6C7       Start and end VSAs straddle COMMON area   * 00039200
*                                                                     * 00039300
*       xx0005xx  6C7       Data space not owned by caller            * 00039400
*                                                                     * 00039500
*       xx0006xx  6C7       Stoken  does  not denote an existing data * 00039600
*                           space                                     * 00039700
*                                                                     * 00039800
*       xx0102xx  6C7       Data space not owned by caller            * 00039900
*                                                                     * 00040000
*       xx0103xx  6C7       Stoken  does  not denote an existing data * 00040100
*                           space                                     * 00040200
*                                                                     * 00040300
*                           zz  depends on the service being invoked. * 00040400
*                           "zz"  will  be 00 for INSTALL, and 01 for * 00040500
*                           REMOVE                                    * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00040900
*                                                                     * 00041000
*02*   PROCESSOR:  ASSEM                                              * 00041100
*                                                                     * 00041200
*01* COMPONENT:  SC1CR                                                * 00041300
*                                                                     * 00041400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00041500
*                                                                     * 00041600
*01* MACRO USAGE NOTES:                                               * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00042000
*        global macro variable.  Any value other than 'NO' will       * 00042100
*        result in the macro expansion being printed.  The default is * 00042200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00042300
*        variable should be set.                                      * 00042400
*                                                                     * 00042500
*                    GBLC &ZPRINT                                     * 00042600
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*    2.  When using the NOCHECK option in conjunction with the Modify * 00043000
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00043100
*        Modify   or  Execute  form  invocation  which  specifies  or * 00043200
*        defaults  to  the  COMPLETE  option.   This insures that the * 00043300
*        parameter list is initialized completely.                    * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*01* CHANGE ACTIVITY:                                                 * 00043700
*                                                                     * 00043800
*   Flag LineItem  FMID    Date   ID    Comment                       * 00043900
*                                                                     * 00044000
*    $L0=BPAGE    HBB4410 891101 PDDU:  Explicit block paging         * 00044100
*                                         support.                    * 00044200
*    $P1=PIW5283  HBB4410 891101 PDDU:  Add modify form to refpat     * 00044300
*                                         macro.                      * 00044400
****** END OF SPECIFICATIONS *****************************************/ 00044500
*/********************************************************************* 00044600
         MACRO                                                          00044700
&XLABEL  REFPAT &STOKEN=,&PSTART=,&PEND=,&UNITSIZE=,&GAP=,&UNITS=,&MF=  00044800
.*                                                                      00044900
*              MACDATE -06/20/91-<0>                                    00045000
.*                                                                      00045100
.*******************************************************************    00045200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00045300
.*******************************************************************    00045400
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00045500
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00045600
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00045700
.*                                                                      00045800
              GBLC  &ZREFPAT    YES=MACRO USED AT LEAST ONCE            00045900
.*******************************************************************    00046000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00046100
.*******************************************************************    00046200
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00046300
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00046400
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00046500
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00046600
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00046700
              LCLA  &ZAWRK      USED AS A WORK AREA                     00046800
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00046900
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00047000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00047100
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00047200
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00047300
              LCLA  &ZMACRET    MACRO RETURN CODE                       00047400
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00047500
.*                                                                      00047600
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00047700
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00047800
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00047900
.********************************************************************   00048000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00048100
.********************************************************************   00048200
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00048300
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00048400
.*                                                                      00048500
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00048600
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00048700
              SPLEVEL  TEST                                             00048800
.ZSYS2        ANOP  ,                                                   00048900
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00049000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00049100
              SYSSTATE TEST                                             00049200
              AGO   .ZSYS4                                              00049300
.ZSYS3        ANOP  ,                                                   00049400
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00049500
.ZSYS4        ANOP  ,                                                   00049600
.*******************************************************************    00049700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00049800
.*******************************************************************    00049900
              LCLC  &XSERVICE   ++ VALUE                                00050000
              LCLC  &XINSTALL   ++ VALUE                                00050100
              LCLC  &XSTOKEN    ++ NAME                                 00050200
              LCLC  &XPSTART    ++ NAME                                 00050300
              LCLC  &XPEND      ++ NAME                                 00050400
              LCLC  &XUNITSIZE  ++ NAME                                 00050500
              LCLC  &XGAP       ++ NAME                                 00050600
              LCLC  &XUNITS     ++ NAME                                 00050700
              LCLC  &XREMOVE    ++ VALUE                                00050800
              LCLC  &XMF        ++ VALUE                                00050900
              LCLC  &XMFCTRL    ++ NAME                                 00051000
              LCLC  &XMFATTR    ++ VALUE                                00051100
              LCLC  &XMFSCK     ++ VALUE                                00051200
.*******************************************************************    00051300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00051400
.*******************************************************************    00051500
              LCLC  &ZXSERVICE  ++ INPUT VALUE                          00051600
              LCLC  &ZXINSTALL  ++ INPUT VALUE                          00051700
              LCLC  &ZXSTOKEN   ++ INPUT NAME                           00051800
              LCLC  &ZXPSTART   ++ INPUT NAME                           00051900
              LCLC  &ZXPEND     ++ INPUT NAME                           00052000
              LCLC  &ZXUNITSIZE                 ++ INPUT NAME           00052100
              LCLC  &ZXGAP      ++ INPUT NAME                           00052200
              LCLC  &ZXUNITS    ++ INPUT NAME                           00052300
              LCLC  &ZXREMOVE   ++ INPUT VALUE                          00052400
              LCLC  &ZXMF       ++ INPUT VALUE                          00052500
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00052600
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00052700
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00052800
.********************************************************************   00052900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00053000
.********************************************************************   00053100
              ACTR  10000                                               00053200
.*------------------------------------------------------------------    00053300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053400
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00053500
.*-------------------------------------------------------------------   00053600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053700
.ZG40         ANOP  ,                                                   00053800
&ZTLC         SETC 'S'                                                  00053900
              AIF   ('&MF(1)' NE '&ZTLC').ZG41                          00054000
&XMF          SETC  'S'         SET KEYWORD                             00054100
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00054200
              AIF   (N'&MF LE 1).ZG40A          CK NUM                  00054300
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00054400
&ZMS          SETC  '&ZMS.&MF"'                                         00054500
&ZMS          SETC  '&ZMS "MF"'                                         00054600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00054700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00054800
.ZG40A        ANOP  ,                                                   00054900
.*-------------------------------------------------------------------   00055000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00055100
.ZG41         ANOP  ,                                                   00055200
&ZTLC         SETC 'L'                                                  00055300
              AIF   ('&MF(1)' NE '&ZTLC').ZG48                          00055400
&XMF          SETC  'L'         SET KEYWORD                             00055500
              AIF   (N'&MF LE 3).ZG41A          CK NUM                  00055600
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00055700
&ZMS          SETC  '&ZMS.&MF"'                                         00055800
&ZMS          SETC  '&ZMS "MF"'                                         00055900
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00056000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00056100
.ZG41A        ANOP  ,                                                   00056200
.*-------------------------------------------------------------------   00056300
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00056400
              AIF   (N'&SYSLIST NE 0).ZG41B     POSITIONALS?            00056500
              AIF   ('&STOKEN' NE '').ZG41B     KEYS?                   00056600
              AIF   ('&PSTART' NE '').ZG41B     KEYS?                   00056700
              AIF   ('&PEND' NE '').ZG41B       KEYS?                   00056800
              AIF   ('&UNITSIZE' NE '').ZG41B   KEYS?                   00056900
              AIF   ('&GAP' NE '').ZG41B        KEYS?                   00057000
              AIF   ('&UNITS' NE '').ZG41B      KEYS?                   00057100
              AGO    .ZG41C     INVOCATION OKAY                         00057200
.ZG41B        ANOP  ,                                                   00057300
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         00057400
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   00057500
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              00057600
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        00057700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00057800
.ZG41C        ANOP  ,                                                   00057900
.*-------------------------------------------------------------------   00058000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00058100
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00058200
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00058300
              AIF   (N'&MF(2) GT 1).ZG43B       MULTI PARMS             00058400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00058500
.ZG43B        AIF   (K'&MF(2) GT 0).ZG43C                               00058600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00058700
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00058800
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00058900
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00059000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00059100
.ZG43C        ANOP  ,                                                   00059200
.*-------------------------------------------------------------------   00059300
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00059400
              AIF   (K'&ZXMFCTRL LE 0).ZG43P    NOT I/O                 00059500
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG43P                      00059600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00059700
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00059800
&ZMS          SETC  '&ZMS.&MF"'                                         00059900
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00060000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00060100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00060200
.ZG43P        ANOP  ,                                                   00060300
.*-------------------------------------------------------------------   00060400
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00060500
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00060600
&XMFATTR      SETC  '0D'                                                00060700
              AIF   (K'&MF(3) LE 0).ZG46B       PARM                    00060800
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00060900
              AIF   (N'&MF(3) GT 1).ZG46B       MULTI PARMS             00061000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00061100
.ZG46B        ANOP  ,                                                   00061200
.*-------------------------------------------------------------------   00061300
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00061400
              AIF   (K'&ZXMFATTR LE 0).ZG46P    NOT I/O                 00061500
              AIF   ('&XMFATTR'(1,1) NE '(').ZG46P                      00061600
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00061700
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00061800
&ZMS          SETC  '&ZMS.&MF"'                                         00061900
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00062000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00062100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00062200
.ZG46P        ANOP  ,                                                   00062300
.*-------------------------------------------------------------------   00062400
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00062500
              AIF   (K'&ZXMFATTR LE 0).ZG46S    NOT I/O                 00062600
              AIF   (K'&XMFATTR LE 60).ZG46S    LNG OK                  00062700
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00062800
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00062900
&ZMS          SETC  '&ZMS.&MF"'                                         00063000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00063100
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00063200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00063300
.ZG46S        ANOP  ,                                                   00063400
.*-------------------------------------------------------------------   00063500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00063600
.ZG48         ANOP  ,                                                   00063700
&ZTLC         SETC 'M'                                                  00063800
              AIF   ('&MF(1)' NE '&ZTLC').ZG57                          00063900
&XMF          SETC  'M'         SET KEYWORD                             00064000
              AIF   (N'&MF LE 3).ZG48A          CK NUM                  00064100
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00064200
&ZMS          SETC  '&ZMS.&MF"'                                         00064300
&ZMS          SETC  '&ZMS "MF"'                                         00064400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00064500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00064600
.ZG48A        ANOP  ,                                                   00064700
.*-------------------------------------------------------------------   00064800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00064900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00065000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00065100
              AIF   (N'&MF(2) GT 1).ZG50B       MULTI PARMS             00065200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00065300
.ZG50B        AIF   (K'&MF(2) GT 0).ZG50C                               00065400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00065500
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 00065600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00065700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00065800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00065900
.ZG50C        ANOP  ,                                                   00066000
.*-------------------------------------------------------------------   00066100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00066200
              AIF   (K'&ZXMFCTRL LE 0).ZG50R    NOT I/O                 00066300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG50R                      00066400
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00066500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG50P                        00066600
              AIF   (K'&ZCGPR GT 2).ZG50Q                               00066700
              AIF   ('&ZCGPR' EQ '0').ZG50Q                             00066800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00066900
              AIF   (T'&ZCGPR NE 'N').ZG50Q     INVALID REG NAME        00067000
.ZG50P        ANOP  ,                                                   00067100
              AIF   (T'&ZCGPR NE 'N').ZG50R     NON NUMERIC             00067200
              AIF   ('&ZCGPR' LT '2').ZG50Q                             00067300
              AIF   ('&ZCGPR' LE '12').ZG50R                            00067400
.ZG50Q        ANOP  ,                                                   00067500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00067600
&ZMS          SETC  '&ZMS.&MF"'                                         00067700
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00067800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00067900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00068000
.ZG50R        ANOP  ,                                                   00068100
.*-------------------------------------------------------------------   00068200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00068300
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00068400
.ZG54A   AIF   ('&MF(3)' NE 'COMPLETE').ZG55A                           00068500
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00068600
.*-------------------------------------------------------------------   00068700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00068800
.ZG55A   AIF   ('&MF(3)' NE 'NOCHECK').ZG56A                            00068900
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00069000
.*-------------------------------------------------------------------   00069100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00069200
.ZG56A        AIF   (K'&XMFSCK GT 0).ZG56C      KEYWORD                 00069300
              AIF   (K'&MF(3) LE 0).ZG56B                               00069400
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00069500
&ZMS          SETC  '&ZMS.&MF"'                                         00069600
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00069700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00069800
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00069900
              MNOTE 8,' &ZMS OR "NOCHECK".'                             00070000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00070100
.ZG56B        ANOP  ,                                                   00070200
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00070300
.ZG56C        ANOP  ,                                                   00070400
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00070500
.*-------------------------------------------------------------------   00070600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00070700
.ZG57         ANOP  ,                                                   00070800
&ZTLC         SETC 'E'                                                  00070900
              AIF   ('&MF(1)' NE '&ZTLC').ZG66                          00071000
&XMF          SETC  'E'         SET KEYWORD                             00071100
              AIF   (N'&MF LE 3).ZG57A          CK NUM                  00071200
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00071300
&ZMS          SETC  '&ZMS.&MF"'                                         00071400
&ZMS          SETC  '&ZMS "MF"'                                         00071500
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00071600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00071700
.ZG57A        ANOP  ,                                                   00071800
.*-------------------------------------------------------------------   00071900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00072000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00072100
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00072200
              AIF   (N'&MF(2) GT 1).ZG59B       MULTI PARMS             00072300
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00072400
.ZG59B        AIF   (K'&MF(2) GT 0).ZG59C                               00072500
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00072600
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00072700
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00072800
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00072900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00073000
.ZG59C        ANOP  ,                                                   00073100
.*-------------------------------------------------------------------   00073200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00073300
              AIF   (K'&ZXMFCTRL LE 0).ZG59R    NOT I/O                 00073400
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG59R                      00073500
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00073600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                        00073700
              AIF   (K'&ZCGPR GT 2).ZG59Q                               00073800
              AIF   ('&ZCGPR' EQ '0').ZG59Q                             00073900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00074000
              AIF   (T'&ZCGPR NE 'N').ZG59Q     INVALID REG NAME        00074100
.ZG59P        ANOP  ,                                                   00074200
              AIF   (T'&ZCGPR NE 'N').ZG59R     NON NUMERIC             00074300
              AIF   ('&ZCGPR' LT '2').ZG59Q                             00074400
              AIF   ('&ZCGPR' LE '12').ZG59R                            00074500
.ZG59Q        ANOP  ,                                                   00074600
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00074700
&ZMS          SETC  '&ZMS.&MF"'                                         00074800
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00074900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00075000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00075100
.ZG59R        ANOP  ,                                                   00075200
.*-------------------------------------------------------------------   00075300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00075400
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00075500
.ZG63A   AIF   ('&MF(3)' NE 'COMPLETE').ZG64A                           00075600
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00075700
.*-------------------------------------------------------------------   00075800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00075900
.ZG64A   AIF   ('&MF(3)' NE 'NOCHECK').ZG65A                            00076000
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00076100
.*-------------------------------------------------------------------   00076200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00076300
.ZG65A        AIF   (K'&XMFSCK GT 0).ZG65C      KEYWORD                 00076400
              AIF   (K'&MF(3) LE 0).ZG65B                               00076500
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00076600
&ZMS          SETC  '&ZMS.&MF"'                                         00076700
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00076800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00076900
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00077000
              MNOTE 8,' &ZMS OR "NOCHECK".'                             00077100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00077200
.ZG65B        ANOP  ,                                                   00077300
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00077400
.ZG65C        ANOP  ,                                                   00077500
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00077600
.*------------------------------------------------------------------    00077700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077800
.ZG66         ANOP  ,                                                   00077900
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00078000
              AIF   (K'&XMF GT 0).ZG66E         VALID ARG               00078100
              AIF   (T'&MF EQ 'O').ZG66D        OMITTED                 00078200
&ZASYSLNDX    SETA  0                                                   00078300
.ZG66A        ANOP  ,           POSITIONAL MACRO KEY                    00078400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00078500
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG66C                    00078600
&ZTLC         SETC 'MF'                                                 00078700
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG66A           00078800
.ZG66B        ANOP  ,                                                   00078900
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00079000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00079100
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00079200
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00079300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00079400
              AGO   .ZG66E                                              00079500
.ZG66C        ANOP  ,                                                   00079600
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00079700
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00079800
&ZMS          SETC  '&ZMS.&MF"'                                         00079900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00080000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00080100
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00080200
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00080300
&ZMS          SETC  '&ZMS "M",'                 VALID KEYWORD           00080400
              MNOTE 8,' &ZMS OR "E".'                                   00080500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00080600
              AGO   .ZG66E                                              00080700
.ZG66D        ANOP  ,                                                   00080800
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00080900
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00081000
.ZG66E        ANOP  ,                                                   00081100
.********************************************************************   00081200
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00081300
.********************************************************************   00081400
              ACTR  10000                                               00081500
.*-------------------------------------------------------------------   00081600
.***AG.MF03 MF=(SLME)                                                   00081700
              AIF   ('&XMF' EQ 'L').ZGMFX                               00081800
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00081900
.*-------------------------------------------------------------------   00082000
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00082100
&XSERVICE     SETC  ''          INITIALIZE XVARIABLE                    00082200
&ZASYSLNDX    SETA  0                                                   00082300
.ZG2A         ANOP  ,           POSITIONAL KEY SEARCH                   00082400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00082500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00082600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00082700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'INSTALL').ZG2A               00082800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00082900
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00083000
&XSERVICE     SETC  'INSTALL'   SET XVARIABLE                           00083100
&ZXINSTALL    SETC  'INPUT'     SET IN/OUTPUT                           00083200
&XINSTALL     SETC  'INSTALL'   SET XVARIABLE PARM                      00083300
.ZG2B         ANOP  ,                                                   00083400
.*-------------------------------------------------------------------   00083500
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00083600
&ZASYSLNDX    SETA  0                                                   00083700
.ZG21A        ANOP  ,           POSITIONAL KEY SEARCH                   00083800
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00083900
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C  DONE                   00084000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG21A            00084100
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'REMOVE').ZG21A               00084200
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00084300
              AIF   (K'&XSERVICE LE 0).ZG21B    VALID                   00084400
&ZMS          SETC  '"REMOVE'   *KMEKA* MNOTE                           00084500
&ZMS          SETC  '&ZMS."'                                            00084600
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00084700
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00084800
              MNOTE 8,' &ZMS KEY.'                                      00084900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00085000
              AGO   .ZG21C                                              00085100
.*                                                                      00085200
.ZG21B        ANOP  ,                                                   00085300
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00085400
&XSERVICE     SETC  'REMOVE'    SET XVARIABLE                           00085500
&ZXREMOVE     SETC  'INPUT'     SET IN/OUTPUT                           00085600
&XREMOVE      SETC  'REMOVE'    SET XVARIABLE PARM                      00085700
.ZG21C        ANOP  ,                                                   00085800
.*------------------------------------------------------------------    00085900
.***AG.KMEKY09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00086000
              AIF   (K'&XSERVICE GT 0).ZG31B                            00086100
&ZXSERVICE    SETC  ''          RESET IN/OUTPUT                         00086200
&ZXINSTALL    SETC  ''          RESET IN/OUTPUT                         00086300
&XSERVICE     SETC  ''          ENSURE NULL                             00086400
&XINSTALL     SETC  ''          ENSURE NULL                             00086500
&ZMS          SETC  'ONE OF THE FOLLOWING'      *KMERA* MNOTE           00086600
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 00086700
&ZMS          SETC  '&ZMS REQUIRED:'                                    00086800
&ZMS          SETC  '&ZMS "INSTALL"'            VALID ME KEY            00086900
              MNOTE 8,' &ZMS OR "REMOVE".'                              00087000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00087100
.ZG31B        ANOP  ,                                                   00087200
.*-------------------------------------------------------------------   00087300
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00087400
.ZG2          AIF   ('&XSERVICE' NE 'INSTALL').ZG21                     00087500
.*-------------------------------------------------------------------   00087600
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00087700
              AIF   (K'&ZXINSTALL LE 0).ZG2R    NOT I/O                 00087800
              AIF   ('&XINSTALL'(1,1) NE '(').ZG2R                      00087900
&ZCGPR        SETC  '&XINSTALL'(2,K'&XINSTALL-2)                        00088000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         00088100
              AIF   (K'&ZCGPR GT 2).ZG2Q                                00088200
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              00088300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00088400
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        00088500
.ZG2P         ANOP  ,                                                   00088600
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             00088700
              AIF   ('&ZCGPR' LT '2').ZG2Q                              00088800
              AIF   ('&ZCGPR' LE '12').ZG2R                             00088900
.ZG2Q         ANOP  ,                                                   00089000
&ZMS          SETC  '"INSTALL='                 *KGPRA* MNOTE           00089100
&ZMS          SETC  '&ZMS.&INSTALL"'                                    00089200
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00089300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00089400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00089500
.ZG2R         ANOP  ,                                                   00089600
.*----------------------------------------------------------------***   00089700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00089800
              AIF   (N'&STOKEN LE 1).ZG4A       CK NUM                  00089900
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00090000
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00090100
&ZMS          SETC  '&ZMS "STOKEN"'                                     00090200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00090300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090400
.ZG4A         ANOP  ,                                                   00090500
.*-------------------------------------------------------------------   00090600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00090700
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00090800
&XSTOKEN      SETC  '0'                                                 00090900
              AIF   (K'&STOKEN(1) LE 0).ZG4B    PARM                    00091000
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00091100
              AIF   (N'&STOKEN GT 1).ZG4B       MULTI PARMS             00091200
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00091300
.ZG4B         ANOP  ,                                                   00091400
.*-------------------------------------------------------------------   00091500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00091600
              AIF   (K'&ZXSTOKEN LE 0).ZG4R     NOT I/O                 00091700
              AIF   ('&XSTOKEN' EQ '0').ZG4R                            00091800
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG4R                       00091900
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00092000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         00092100
              AIF   (K'&ZCGPR GT 2).ZG4Q                                00092200
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              00092300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00092400
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        00092500
.ZG4P         ANOP  ,                                                   00092600
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             00092700
              AIF   ('&ZCGPR' LT '2').ZG4Q                              00092800
              AIF   ('&ZCGPR' LE '12').ZG4R                             00092900
.ZG4Q         ANOP  ,                                                   00093000
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00093100
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00093200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00093300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00093400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093500
.ZG4R         ANOP  ,                                                   00093600
.*----------------------------------------------------------------***   00093700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00093800
              AIF   (N'&PSTART LE 1).ZG7A       CK NUM                  00093900
&ZMS          SETC  '"PSTART='  *KPOSA* MNOTE                           00094000
&ZMS          SETC  '&ZMS.&PSTART"'                                     00094100
&ZMS          SETC  '&ZMS "PSTART"'                                     00094200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00094300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094400
.ZG7A         ANOP  ,                                                   00094500
.*-------------------------------------------------------------------   00094600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00094700
&ZXPSTART     SETC  'INPUT'     SET IN/OUTPUT                           00094800
&XPSTART      SETC  '&PSTART(1)'                SET XVARIABLE           00094900
              AIF   (N'&PSTART GT 1).ZG7B       MULTI PARMS             00095000
&XPSTART      SETC  '&PSTART'   SET XVARIABLE                           00095100
.ZG7B         AIF   (K'&PSTART(1) GT 0).ZG7C                            00095200
&ZXPSTART     SETC  ''          RESET IN/OUTPUT                         00095300
&ZMS          SETC  ' '         *KRQDA*                                 00095400
&ZMS          SETC  '&ZMS "PSTART" KEY AND ITS ARGUMENT'                00095500
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00095600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095700
.ZG7C         ANOP  ,                                                   00095800
.*-------------------------------------------------------------------   00095900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00096000
              AIF   (K'&ZXPSTART LE 0).ZG7R     NOT I/O                 00096100
              AIF   ('&XPSTART'(1,1) NE '(').ZG7R                       00096200
&ZCGPR        SETC  '&XPSTART'(2,K'&XPSTART-2)                          00096300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                         00096400
              AIF   (K'&ZCGPR GT 2).ZG7Q                                00096500
              AIF   ('&ZCGPR' EQ '0').ZG7Q                              00096600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00096700
              AIF   (T'&ZCGPR NE 'N').ZG7Q      INVALID REG NAME        00096800
.ZG7P         ANOP  ,                                                   00096900
              AIF   (T'&ZCGPR NE 'N').ZG7R      NON NUMERIC             00097000
              AIF   ('&ZCGPR' LT '2').ZG7Q                              00097100
              AIF   ('&ZCGPR' LE '12').ZG7R                             00097200
.ZG7Q         ANOP  ,                                                   00097300
&ZMS          SETC  '"PSTART='  *KGPRA* MNOTE                           00097400
&ZMS          SETC  '&ZMS.&PSTART"'                                     00097500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00097600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00097700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00097800
.ZG7R         ANOP  ,                                                   00097900
.*----------------------------------------------------------------***   00098000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00098100
              AIF   (N'&PEND LE 1).ZG10A        CK NUM                  00098200
&ZMS          SETC  '"PEND='    *KPOSA* MNOTE                           00098300
&ZMS          SETC  '&ZMS.&PEND"'                                       00098400
&ZMS          SETC  '&ZMS "PEND"'                                       00098500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00098600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098700
.ZG10A        ANOP  ,                                                   00098800
.*-------------------------------------------------------------------   00098900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00099000
&ZXPEND       SETC  'INPUT'     SET IN/OUTPUT                           00099100
&XPEND        SETC  '&PEND(1)'  SET XVARIABLE                           00099200
              AIF   (N'&PEND GT 1).ZG10B        MULTI PARMS             00099300
&XPEND        SETC  '&PEND'     SET XVARIABLE                           00099400
.ZG10B        AIF   (K'&PEND(1) GT 0).ZG10C                             00099500
&ZXPEND       SETC  ''          RESET IN/OUTPUT                         00099600
&ZMS          SETC  ' '         *KRQDA*                                 00099700
&ZMS          SETC  '&ZMS "PEND" KEY AND ITS ARGUMENT'                  00099800
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00099900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00100000
.ZG10C        ANOP  ,                                                   00100100
.*-------------------------------------------------------------------   00100200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00100300
              AIF   (K'&ZXPEND LE 0).ZG10R      NOT I/O                 00100400
              AIF   ('&XPEND'(1,1) NE '(').ZG10R                        00100500
&ZCGPR        SETC  '&XPEND'(2,K'&XPEND-2)                              00100600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00100700
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00100800
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00100900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00101000
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00101100
.ZG10P        ANOP  ,                                                   00101200
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00101300
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00101400
              AIF   ('&ZCGPR' LE '12').ZG10R                            00101500
.ZG10Q        ANOP  ,                                                   00101600
&ZMS          SETC  '"PEND='    *KGPRA* MNOTE                           00101700
&ZMS          SETC  '&ZMS.&PEND"'                                       00101800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00101900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00102000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102100
.ZG10R        ANOP  ,                                                   00102200
.*----------------------------------------------------------------***   00102300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00102400
              AIF   (N'&UNITSIZE LE 1).ZG13A    CK NUM                  00102500
&ZMS          SETC  '"UNITSIZE='                *KPOSA* MNOTE           00102600
&ZMS          SETC  '&ZMS.&UNITSIZE"'                                   00102700
&ZMS          SETC  '&ZMS "UNITSIZE"'                                   00102800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00102900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00103000
.ZG13A        ANOP  ,                                                   00103100
.*-------------------------------------------------------------------   00103200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00103300
&ZXUNITSIZE   SETC  'INPUT'     SET IN/OUTPUT                           00103400
&XUNITSIZE    SETC  '&UNITSIZE(1)'              SET XVARIABLE           00103500
              AIF   (N'&UNITSIZE GT 1).ZG13B    MULTI PARMS             00103600
&XUNITSIZE    SETC  '&UNITSIZE'                 SET XVARIABLE           00103700
.ZG13B        AIF   (K'&UNITSIZE(1) GT 0).ZG13C                         00103800
&ZXUNITSIZE   SETC  ''          RESET IN/OUTPUT                         00103900
&ZMS          SETC  ' '         *KRQDA*                                 00104000
&ZMS          SETC  '&ZMS "UNITSIZE" KEY AND ITS ARGUMENT'              00104100
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00104200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104300
.ZG13C        ANOP  ,                                                   00104400
.*-------------------------------------------------------------------   00104500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00104600
              AIF   (K'&ZXUNITSIZE LE 0).ZG13R  NOT I/O                 00104700
              AIF   ('&XUNITSIZE'(1,1) NE '(').ZG13R                    00104800
&ZCGPR        SETC  '&XUNITSIZE'(2,K'&XUNITSIZE-2)                      00104900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG13P                        00105000
              AIF   (K'&ZCGPR GT 2).ZG13Q                               00105100
              AIF   ('&ZCGPR' EQ '0').ZG13Q                             00105200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00105300
              AIF   (T'&ZCGPR NE 'N').ZG13Q     INVALID REG NAME        00105400
.ZG13P        ANOP  ,                                                   00105500
              AIF   (T'&ZCGPR NE 'N').ZG13R     NON NUMERIC             00105600
              AIF   ('&ZCGPR' LT '2').ZG13Q                             00105700
              AIF   ('&ZCGPR' LE '12').ZG13R                            00105800
.ZG13Q        ANOP  ,                                                   00105900
&ZMS          SETC  '"UNITSIZE='                *KGPRA* MNOTE           00106000
&ZMS          SETC  '&ZMS.&UNITSIZE"'                                   00106100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00106200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00106300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00106400
.ZG13R        ANOP  ,                                                   00106500
.*----------------------------------------------------------------***   00106600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00106700
              AIF   (N'&GAP LE 1).ZG16A         CK NUM                  00106800
&ZMS          SETC  '"GAP='     *KPOSA* MNOTE                           00106900
&ZMS          SETC  '&ZMS.&GAP"'                                        00107000
&ZMS          SETC  '&ZMS "GAP"'                                        00107100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00107200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107300
.ZG16A        ANOP  ,                                                   00107400
.*-------------------------------------------------------------------   00107500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00107600
&ZXGAP        SETC  'INPUT'     SET IN/OUTPUT                           00107700
&XGAP         SETC  '0'                                                 00107800
              AIF   (K'&GAP(1) LE 0).ZG16B      PARM                    00107900
&XGAP         SETC  '&GAP(1)'   SET XVARIABLE                           00108000
              AIF   (N'&GAP GT 1).ZG16B         MULTI PARMS             00108100
&XGAP         SETC  '&GAP'      SET XVARIABLE                           00108200
.ZG16B        ANOP  ,                                                   00108300
.*-------------------------------------------------------------------   00108400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00108500
              AIF   (K'&ZXGAP LE 0).ZG16R       NOT I/O                 00108600
              AIF   ('&XGAP'(1,1) NE '(').ZG16R                         00108700
&ZCGPR        SETC  '&XGAP'(2,K'&XGAP-2)                                00108800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        00108900
              AIF   (K'&ZCGPR GT 2).ZG16Q                               00109000
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             00109100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00109200
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        00109300
.ZG16P        ANOP  ,                                                   00109400
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             00109500
              AIF   ('&ZCGPR' LT '2').ZG16Q                             00109600
              AIF   ('&ZCGPR' LE '12').ZG16R                            00109700
.ZG16Q        ANOP  ,                                                   00109800
&ZMS          SETC  '"GAP='     *KGPRA* MNOTE                           00109900
&ZMS          SETC  '&ZMS.&GAP"'                                        00110000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00110100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00110200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110300
.ZG16R        ANOP  ,                                                   00110400
.*----------------------------------------------------------------***   00110500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00110600
              AIF   (N'&UNITS LE 1).ZG19A       CK NUM                  00110700
&ZMS          SETC  '"UNITS='   *KPOSA* MNOTE                           00110800
&ZMS          SETC  '&ZMS.&UNITS"'                                      00110900
&ZMS          SETC  '&ZMS "UNITS"'                                      00111000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00111100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00111200
.ZG19A        ANOP  ,                                                   00111300
.*-------------------------------------------------------------------   00111400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00111500
&ZXUNITS      SETC  'INPUT'     SET IN/OUTPUT                           00111600
&XUNITS       SETC  '1'                                                 00111700
              AIF   (K'&UNITS(1) LE 0).ZG19B    PARM                    00111800
&XUNITS       SETC  '&UNITS(1)'                 SET XVARIABLE           00111900
              AIF   (N'&UNITS GT 1).ZG19B       MULTI PARMS             00112000
&XUNITS       SETC  '&UNITS'    SET XVARIABLE                           00112100
.ZG19B        ANOP  ,                                                   00112200
.*-------------------------------------------------------------------   00112300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00112400
              AIF   (K'&ZXUNITS LE 0).ZG19R     NOT I/O                 00112500
              AIF   ('&XUNITS'(1,1) NE '(').ZG19R                       00112600
&ZCGPR        SETC  '&XUNITS'(2,K'&XUNITS-2)                            00112700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        00112800
              AIF   (K'&ZCGPR GT 2).ZG19Q                               00112900
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             00113000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00113100
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        00113200
.ZG19P        ANOP  ,                                                   00113300
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             00113400
              AIF   ('&ZCGPR' LT '2').ZG19Q                             00113500
              AIF   ('&ZCGPR' LE '12').ZG19R                            00113600
.ZG19Q        ANOP  ,                                                   00113700
&ZMS          SETC  '"UNITS='   *KGPRA* MNOTE                           00113800
&ZMS          SETC  '&ZMS.&UNITS"'                                      00113900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00114000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00114100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114200
.ZG19R        ANOP  ,                                                   00114300
.*-------------------------------------------------------------------   00114400
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00114500
.ZG21         AIF   ('&XSERVICE' NE 'REMOVE').ZG31                      00114600
.*-------------------------------------------------------------------   00114700
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00114800
&ZCVAL        SETC ''           ERROR KEY FIELD                         00114900
.ZG21I0       AIF   (K'&UNITSIZE LE 0).ZG21I1                           00115000
&ZCVAL        SETC '&ZCVAL UNITSIZE'            DISALLOWED KEY          00115100
.ZG21I1       AIF   (K'&GAP LE 0).ZG21I2                                00115200
&ZCVAL        SETC '&ZCVAL GAP'                 DISALLOWED KEY          00115300
.ZG21I2       AIF   (K'&UNITS LE 0).ZG21I3                              00115400
&ZCVAL        SETC '&ZCVAL UNITS'               DISALLOWED KEY          00115500
.ZG21I3       AIF   (K'&ZCVAL LE 0).ZG21J       KEY                     00115600
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00115700
&ZMS          SETC  '"REMOVE'   *KMEIA* MNOTE                           00115800
&ZMS          SETC  '&ZMS."'                                            00115900
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00116000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00116100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116200
.ZG21J        ANOP  ,                                                   00116300
.*-------------------------------------------------------------------   00116400
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00116500
              AIF   (K'&ZXREMOVE LE 0).ZG21R    NOT I/O                 00116600
              AIF   ('&XREMOVE'(1,1) NE '(').ZG21R                      00116700
&ZCGPR        SETC  '&XREMOVE'(2,K'&XREMOVE-2)                          00116800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                        00116900
              AIF   (K'&ZCGPR GT 2).ZG21Q                               00117000
              AIF   ('&ZCGPR' EQ '0').ZG21Q                             00117100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00117200
              AIF   (T'&ZCGPR NE 'N').ZG21Q     INVALID REG NAME        00117300
.ZG21P        ANOP  ,                                                   00117400
              AIF   (T'&ZCGPR NE 'N').ZG21R     NON NUMERIC             00117500
              AIF   ('&ZCGPR' LT '2').ZG21Q                             00117600
              AIF   ('&ZCGPR' LE '12').ZG21R                            00117700
.ZG21Q        ANOP  ,                                                   00117800
&ZMS          SETC  '"REMOVE='  *KGPRA* MNOTE                           00117900
&ZMS          SETC  '&ZMS.&REMOVE"'                                     00118000
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00118100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00118200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00118300
.ZG21R        ANOP  ,                                                   00118400
.*----------------------------------------------------------------***   00118500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00118600
              AIF   (N'&STOKEN LE 1).ZG23A      CK NUM                  00118700
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00118800
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00118900
&ZMS          SETC  '&ZMS "STOKEN"'                                     00119000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00119100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119200
.ZG23A        ANOP  ,                                                   00119300
.*-------------------------------------------------------------------   00119400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00119500
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00119600
&XSTOKEN      SETC  '0'                                                 00119700
              AIF   (K'&STOKEN(1) LE 0).ZG23B   PARM                    00119800
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00119900
              AIF   (N'&STOKEN GT 1).ZG23B      MULTI PARMS             00120000
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00120100
.ZG23B        ANOP  ,                                                   00120200
.*-------------------------------------------------------------------   00120300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00120400
              AIF   (K'&ZXSTOKEN LE 0).ZG23R    NOT I/O                 00120500
              AIF   ('&XSTOKEN' EQ '0').ZG23R                           00120600
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG23R                      00120700
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00120800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                        00120900
              AIF   (K'&ZCGPR GT 2).ZG23Q                               00121000
              AIF   ('&ZCGPR' EQ '0').ZG23Q                             00121100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00121200
              AIF   (T'&ZCGPR NE 'N').ZG23Q     INVALID REG NAME        00121300
.ZG23P        ANOP  ,                                                   00121400
              AIF   (T'&ZCGPR NE 'N').ZG23R     NON NUMERIC             00121500
              AIF   ('&ZCGPR' LT '2').ZG23Q                             00121600
              AIF   ('&ZCGPR' LE '12').ZG23R                            00121700
.ZG23Q        ANOP  ,                                                   00121800
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00121900
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00122000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00122100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00122200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122300
.ZG23R        ANOP  ,                                                   00122400
.*----------------------------------------------------------------***   00122500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00122600
              AIF   (N'&PSTART LE 1).ZG26A      CK NUM                  00122700
&ZMS          SETC  '"PSTART='  *KPOSA* MNOTE                           00122800
&ZMS          SETC  '&ZMS.&PSTART"'                                     00122900
&ZMS          SETC  '&ZMS "PSTART"'                                     00123000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00123100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123200
.ZG26A        ANOP  ,                                                   00123300
.*-------------------------------------------------------------------   00123400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00123500
&ZXPSTART     SETC  'INPUT'     SET IN/OUTPUT                           00123600
&XPSTART      SETC  '&PSTART(1)'                SET XVARIABLE           00123700
              AIF   (N'&PSTART GT 1).ZG26B      MULTI PARMS             00123800
&XPSTART      SETC  '&PSTART'   SET XVARIABLE                           00123900
.ZG26B        AIF   (K'&PSTART(1) GT 0).ZG26C                           00124000
&ZXPSTART     SETC  ''          RESET IN/OUTPUT                         00124100
&ZMS          SETC  ' '         *KRQDA*                                 00124200
&ZMS          SETC  '&ZMS "PSTART" KEY AND ITS ARGUMENT'                00124300
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00124400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124500
.ZG26C        ANOP  ,                                                   00124600
.*-------------------------------------------------------------------   00124700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00124800
              AIF   (K'&ZXPSTART LE 0).ZG26R    NOT I/O                 00124900
              AIF   ('&XPSTART'(1,1) NE '(').ZG26R                      00125000
&ZCGPR        SETC  '&XPSTART'(2,K'&XPSTART-2)                          00125100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        00125200
              AIF   (K'&ZCGPR GT 2).ZG26Q                               00125300
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             00125400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00125500
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        00125600
.ZG26P        ANOP  ,                                                   00125700
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             00125800
              AIF   ('&ZCGPR' LT '2').ZG26Q                             00125900
              AIF   ('&ZCGPR' LE '12').ZG26R                            00126000
.ZG26Q        ANOP  ,                                                   00126100
&ZMS          SETC  '"PSTART='  *KGPRA* MNOTE                           00126200
&ZMS          SETC  '&ZMS.&PSTART"'                                     00126300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00126400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00126500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126600
.ZG26R        ANOP  ,                                                   00126700
.*----------------------------------------------------------------***   00126800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00126900
              AIF   (N'&PEND LE 1).ZG29A        CK NUM                  00127000
&ZMS          SETC  '"PEND='    *KPOSA* MNOTE                           00127100
&ZMS          SETC  '&ZMS.&PEND"'                                       00127200
&ZMS          SETC  '&ZMS "PEND"'                                       00127300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00127400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00127500
.ZG29A        ANOP  ,                                                   00127600
.*-------------------------------------------------------------------   00127700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00127800
&ZXPEND       SETC  'INPUT'     SET IN/OUTPUT                           00127900
&XPEND        SETC  '&PEND(1)'  SET XVARIABLE                           00128000
              AIF   (N'&PEND GT 1).ZG29B        MULTI PARMS             00128100
&XPEND        SETC  '&PEND'     SET XVARIABLE                           00128200
.ZG29B        AIF   (K'&PEND(1) GT 0).ZG29C                             00128300
&ZXPEND       SETC  ''          RESET IN/OUTPUT                         00128400
&ZMS          SETC  ' '         *KRQDA*                                 00128500
&ZMS          SETC  '&ZMS "PEND" KEY AND ITS ARGUMENT'                  00128600
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00128700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128800
.ZG29C        ANOP  ,                                                   00128900
.*-------------------------------------------------------------------   00129000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00129100
              AIF   (K'&ZXPEND LE 0).ZG29R      NOT I/O                 00129200
              AIF   ('&XPEND'(1,1) NE '(').ZG29R                        00129300
&ZCGPR        SETC  '&XPEND'(2,K'&XPEND-2)                              00129400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                        00129500
              AIF   (K'&ZCGPR GT 2).ZG29Q                               00129600
              AIF   ('&ZCGPR' EQ '0').ZG29Q                             00129700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00129800
              AIF   (T'&ZCGPR NE 'N').ZG29Q     INVALID REG NAME        00129900
.ZG29P        ANOP  ,                                                   00130000
              AIF   (T'&ZCGPR NE 'N').ZG29R     NON NUMERIC             00130100
              AIF   ('&ZCGPR' LT '2').ZG29Q                             00130200
              AIF   ('&ZCGPR' LE '12').ZG29R                            00130300
.ZG29Q        ANOP  ,                                                   00130400
&ZMS          SETC  '"PEND='    *KGPRA* MNOTE                           00130500
&ZMS          SETC  '&ZMS.&PEND"'                                       00130600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00130700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00130800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00130900
.ZG29R        ANOP  ,                                                   00131000
.*-------------------------------------------------------------------   00131100
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00131200
.ZG31         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00131300
.******************************************************************     00131400
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00131500
.******************************************************************     00131600
              ACTR  10000                                               00131700
.*-------------------------------------------------------------------   00131800
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00131900
&ZCVAL        SETC  ''          ERROR FIELD                             00132000
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00132100
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00132200
.ZGLIST2      ANOP  ,                                                   00132300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00132400
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00132500
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00132600
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00132700
              AIF   (&ZAWRK LE 0).ZGLIST2                               00132800
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00132900
              AGO   .ZGLIST2                                            00133000
.*                                                                      00133100
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00133200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00133300
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00133400
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00133500
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00133600
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00133700
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00133800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133900
.ZGLISTX      ANOP  ,                                                   00134000
&ZASYSLNDX    SETA  0                                                   00134100
.*-------------------------------------------------------------------   00134200
.***AG.MF04 MF=(SLME)                                                   00134300
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00134400
.********************************************************************   00134500
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00134600
.********************************************************************   00134700
              ACTR  10000                                               00134800
.*-------------------------------------------------------------------   00134900
.***AE.MF01 MF=(SLME)                                                   00135000
              AIF   ('&XMF' EQ 'L').ZEMFX                               00135100
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00135200
.********************************************************************   00135300
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00135400
.********************************************************************   00135500
.*-------------------------------------------------------------------   00135600
.***AE.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00135700
&XSERVICE     SETC  ''          INITIALIZE XVARIABLE                    00135800
&ZASYSLNDX    SETA  0                                                   00135900
.ZE2A         ANOP  ,           POSITIONAL KEY SEARCH                   00136000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00136100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE2B  DONE                    00136200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE2A             00136300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'INSTALL').ZE2A               00136400
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00136500
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00136600
&XSERVICE     SETC  'INSTALL'   SET XVARIABLE                           00136700
&ZXINSTALL    SETC  'INPUT'     SET IN/OUTPUT                           00136800
&XINSTALL     SETC  'INSTALL'   SET XVARIABLE                           00136900
.ZE2B         ANOP  ,                                                   00137000
.*-------------------------------------------------------------------   00137100
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00137200
&ZASYSLNDX    SETA  0                                                   00137300
.ZE21A        ANOP  ,           POSITIONAL KEY SEARCH                   00137400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00137500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE21C  DONE                   00137600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE21A            00137700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'REMOVE').ZE21A               00137800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00137900
              AIF   (K'&XSERVICE LE 0).ZE21B    VALID                   00138000
&ZMS          SETC  '"REMOVE'   *KMEKA* MNOTE                           00138100
&ZMS          SETC  '&ZMS."'                                            00138200
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00138300
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00138400
              MNOTE 8,' &ZMS KEY.'                                      00138500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00138600
              AGO   .ZE21C                                              00138700
.*                                                                      00138800
.ZE21B        ANOP  ,                                                   00138900
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00139000
&XSERVICE     SETC  'REMOVE'    SET XVARIABLE                           00139100
&ZXREMOVE     SETC  'INPUT'     SET IN/OUTPUT                           00139200
&XREMOVE      SETC  'REMOVE'    SET XVARIABLE                           00139300
.ZE21C        ANOP  ,                                                   00139400
.*------------------------------------------------------------------    00139500
.***AE.KMEKY07 VALUE, RQD INPUT, ME KEYS -CHECK IF ENTERED              00139600
              AIF   (K'&XSERVICE GT 0).ZE31B                            00139700
&ZXSERVICE    SETC  ''          RESET IN/OUTPUT                         00139800
&XSERVICE     SETC  ''          SET NULL                                00139900
&ZXINSTALL    SETC  ''          RESET OUTPUT                            00140000
&XINSTALL     SETC  ''          SET NULL PARM                           00140100
.ZE31B        ANOP  ,                                                   00140200
.*-------------------------------------------------------------------   00140300
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00140400
.ZE2     AIF   ('&XSERVICE' NE 'INSTALL').ZE21                          00140500
.*-------------------------------------------------------------------   00140600
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00140700
              AIF   (K'&ZXINSTALL LE 0).ZE2R    NOT I/O                 00140800
              AIF   ('&XINSTALL'(1,1) NE '(').ZE2R                      00140900
&ZCGPR        SETC  '&XINSTALL'(2,K'&XINSTALL-2)                        00141000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                         00141100
              AIF   (K'&ZCGPR GT 2).ZE2Q                                00141200
              AIF   ('&ZCGPR' EQ '0').ZE2Q                              00141300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00141400
              AIF   (T'&ZCGPR NE 'N').ZE2Q      INVALID REG NAME        00141500
.ZE2P         ANOP  ,                                                   00141600
              AIF   (T'&ZCGPR NE 'N').ZE2R      NON NUMERIC             00141700
              AIF   ('&ZCGPR' LT '2').ZE2Q                              00141800
              AIF   ('&ZCGPR' LE '12').ZE2R                             00141900
.ZE2Q         ANOP  ,                                                   00142000
&ZMS          SETC  '"INSTALL='                 *KGPRA* MNOTE           00142100
&ZMS          SETC  '&ZMS.&INSTALL"'                                    00142200
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00142300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00142400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00142500
.ZE2R         ANOP  ,                                                   00142600
.*----------------------------------------------------------------***   00142700
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00142800
              AIF   (N'&STOKEN LE 1).ZE4A       CK NUM                  00142900
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00143000
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00143100
&ZMS          SETC  '&ZMS "STOKEN"'                                     00143200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00143300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00143400
.ZE4A         ANOP  ,                                                   00143500
.*-------------------------------------------------------------------   00143600
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00143700
              AIF   (K'&STOKEN(1) LE 0).ZE4B    NO PRM                  00143800
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00143900
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00144000
              AIF   (N'&STOKEN GT 1).ZE4B                               00144100
.*            ANOP              MULTIPLE PARMS                          00144200
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00144300
.ZE4B         ANOP  ,                                                   00144400
.*-------------------------------------------------------------------   00144500
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00144600
              AIF   (K'&ZXSTOKEN LE 0).ZE4R     NOT I/O                 00144700
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE4R                       00144800
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00144900
              AIF   ('&ZCGPR'(1,1) NE '0').ZE4P                         00145000
              AIF   (K'&ZCGPR GT 2).ZE4Q                                00145100
              AIF   ('&ZCGPR' EQ '0').ZE4Q                              00145200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00145300
              AIF   (T'&ZCGPR NE 'N').ZE4Q      INVALID REG NAME        00145400
.ZE4P         ANOP  ,                                                   00145500
              AIF   (T'&ZCGPR NE 'N').ZE4R      NON NUMERIC             00145600
              AIF   ('&ZCGPR' LT '2').ZE4Q                              00145700
              AIF   ('&ZCGPR' LE '12').ZE4R                             00145800
.ZE4Q         ANOP  ,                                                   00145900
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00146000
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00146100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00146200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00146300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00146400
.ZE4R         ANOP  ,                                                   00146500
.*----------------------------------------------------------------***   00146600
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00146700
              AIF   (N'&PSTART LE 1).ZE7A       CK NUM                  00146800
&ZMS          SETC  '"PSTART='  *KPOSA* MNOTE                           00146900
&ZMS          SETC  '&ZMS.&PSTART"'                                     00147000
&ZMS          SETC  '&ZMS "PSTART"'                                     00147100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00147200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00147300
.ZE7A         ANOP  ,                                                   00147400
.*-------------------------------------------------------------------   00147500
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00147600
              AIF   (K'&PSTART(1) LE 0).ZE7B    NO PRM                  00147700
&ZXPSTART     SETC  'INPUT'     SET IN/OUTPUT                           00147800
&XPSTART      SETC  '&PSTART(1)'                SET XVARIABLE           00147900
              AIF   (N'&PSTART GT 1).ZE7B                               00148000
.*            ANOP              MULTIPLE PARMS                          00148100
&XPSTART      SETC  '&PSTART'   SET XVARIABLE                           00148200
.ZE7B         ANOP  ,                                                   00148300
.*-------------------------------------------------------------------   00148400
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00148500
              AIF   (K'&ZXPSTART LE 0).ZE7R     NOT I/O                 00148600
              AIF   ('&XPSTART'(1,1) NE '(').ZE7R                       00148700
&ZCGPR        SETC  '&XPSTART'(2,K'&XPSTART-2)                          00148800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE7P                         00148900
              AIF   (K'&ZCGPR GT 2).ZE7Q                                00149000
              AIF   ('&ZCGPR' EQ '0').ZE7Q                              00149100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00149200
              AIF   (T'&ZCGPR NE 'N').ZE7Q      INVALID REG NAME        00149300
.ZE7P         ANOP  ,                                                   00149400
              AIF   (T'&ZCGPR NE 'N').ZE7R      NON NUMERIC             00149500
              AIF   ('&ZCGPR' LT '2').ZE7Q                              00149600
              AIF   ('&ZCGPR' LE '12').ZE7R                             00149700
.ZE7Q         ANOP  ,                                                   00149800
&ZMS          SETC  '"PSTART='  *KGPRA* MNOTE                           00149900
&ZMS          SETC  '&ZMS.&PSTART"'                                     00150000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00150100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00150200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00150300
.ZE7R         ANOP  ,                                                   00150400
.*----------------------------------------------------------------***   00150500
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00150600
              AIF   (N'&PEND LE 1).ZE10A        CK NUM                  00150700
&ZMS          SETC  '"PEND='    *KPOSA* MNOTE                           00150800
&ZMS          SETC  '&ZMS.&PEND"'                                       00150900
&ZMS          SETC  '&ZMS "PEND"'                                       00151000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00151100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151200
.ZE10A        ANOP  ,                                                   00151300
.*-------------------------------------------------------------------   00151400
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00151500
              AIF   (K'&PEND(1) LE 0).ZE10B     NO PRM                  00151600
&ZXPEND       SETC  'INPUT'     SET IN/OUTPUT                           00151700
&XPEND        SETC  '&PEND(1)'  SET XVARIABLE                           00151800
              AIF   (N'&PEND GT 1).ZE10B                                00151900
.*            ANOP              MULTIPLE PARMS                          00152000
&XPEND        SETC  '&PEND'     SET XVARIABLE                           00152100
.ZE10B        ANOP  ,                                                   00152200
.*-------------------------------------------------------------------   00152300
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00152400
              AIF   (K'&ZXPEND LE 0).ZE10R      NOT I/O                 00152500
              AIF   ('&XPEND'(1,1) NE '(').ZE10R                        00152600
&ZCGPR        SETC  '&XPEND'(2,K'&XPEND-2)                              00152700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        00152800
              AIF   (K'&ZCGPR GT 2).ZE10Q                               00152900
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             00153000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00153100
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        00153200
.ZE10P        ANOP  ,                                                   00153300
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             00153400
              AIF   ('&ZCGPR' LT '2').ZE10Q                             00153500
              AIF   ('&ZCGPR' LE '12').ZE10R                            00153600
.ZE10Q        ANOP  ,                                                   00153700
&ZMS          SETC  '"PEND='    *KGPRA* MNOTE                           00153800
&ZMS          SETC  '&ZMS.&PEND"'                                       00153900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00154000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00154100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00154200
.ZE10R        ANOP  ,                                                   00154300
.*----------------------------------------------------------------***   00154400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00154500
              AIF   (N'&UNITSIZE LE 1).ZE13A    CK NUM                  00154600
&ZMS          SETC  '"UNITSIZE='                *KPOSA* MNOTE           00154700
&ZMS          SETC  '&ZMS.&UNITSIZE"'                                   00154800
&ZMS          SETC  '&ZMS "UNITSIZE"'                                   00154900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00155000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155100
.ZE13A        ANOP  ,                                                   00155200
.*-------------------------------------------------------------------   00155300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00155400
              AIF   (K'&UNITSIZE(1) LE 0).ZE13B NO PRM                  00155500
&ZXUNITSIZE   SETC  'INPUT'     SET IN/OUTPUT                           00155600
&XUNITSIZE    SETC  '&UNITSIZE(1)'              SET XVARIABLE           00155700
              AIF   (N'&UNITSIZE GT 1).ZE13B                            00155800
.*            ANOP              MULTIPLE PARMS                          00155900
&XUNITSIZE    SETC  '&UNITSIZE'                 SET XVARIABLE           00156000
.ZE13B        ANOP  ,                                                   00156100
.*-------------------------------------------------------------------   00156200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00156300
              AIF   (K'&ZXUNITSIZE LE 0).ZE13R  NOT I/O                 00156400
              AIF   ('&XUNITSIZE'(1,1) NE '(').ZE13R                    00156500
&ZCGPR        SETC  '&XUNITSIZE'(2,K'&XUNITSIZE-2)                      00156600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE13P                        00156700
              AIF   (K'&ZCGPR GT 2).ZE13Q                               00156800
              AIF   ('&ZCGPR' EQ '0').ZE13Q                             00156900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00157000
              AIF   (T'&ZCGPR NE 'N').ZE13Q     INVALID REG NAME        00157100
.ZE13P        ANOP  ,                                                   00157200
              AIF   (T'&ZCGPR NE 'N').ZE13R     NON NUMERIC             00157300
              AIF   ('&ZCGPR' LT '2').ZE13Q                             00157400
              AIF   ('&ZCGPR' LE '12').ZE13R                            00157500
.ZE13Q        ANOP  ,                                                   00157600
&ZMS          SETC  '"UNITSIZE='                *KGPRA* MNOTE           00157700
&ZMS          SETC  '&ZMS.&UNITSIZE"'                                   00157800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00157900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00158000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158100
.ZE13R        ANOP  ,                                                   00158200
.*----------------------------------------------------------------***   00158300
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00158400
              AIF   (N'&GAP LE 1).ZE16A         CK NUM                  00158500
&ZMS          SETC  '"GAP='     *KPOSA* MNOTE                           00158600
&ZMS          SETC  '&ZMS.&GAP"'                                        00158700
&ZMS          SETC  '&ZMS "GAP"'                                        00158800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00158900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00159000
.ZE16A        ANOP  ,                                                   00159100
.*-------------------------------------------------------------------   00159200
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00159300
              AIF   (K'&GAP(1) LE 0).ZE16B      NO PRM                  00159400
&ZXGAP        SETC  'INPUT'     SET IN/OUTPUT                           00159500
&XGAP         SETC  '&GAP(1)'   SET XVARIABLE                           00159600
              AIF   (N'&GAP GT 1).ZE16B                                 00159700
.*            ANOP              MULTIPLE PARMS                          00159800
&XGAP         SETC  '&GAP'      SET XVARIABLE                           00159900
.ZE16B        ANOP  ,                                                   00160000
.*-------------------------------------------------------------------   00160100
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00160200
              AIF   (K'&ZXGAP LE 0).ZE16R       NOT I/O                 00160300
              AIF   ('&XGAP'(1,1) NE '(').ZE16R                         00160400
&ZCGPR        SETC  '&XGAP'(2,K'&XGAP-2)                                00160500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                        00160600
              AIF   (K'&ZCGPR GT 2).ZE16Q                               00160700
              AIF   ('&ZCGPR' EQ '0').ZE16Q                             00160800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00160900
              AIF   (T'&ZCGPR NE 'N').ZE16Q     INVALID REG NAME        00161000
.ZE16P        ANOP  ,                                                   00161100
              AIF   (T'&ZCGPR NE 'N').ZE16R     NON NUMERIC             00161200
              AIF   ('&ZCGPR' LT '2').ZE16Q                             00161300
              AIF   ('&ZCGPR' LE '12').ZE16R                            00161400
.ZE16Q        ANOP  ,                                                   00161500
&ZMS          SETC  '"GAP='     *KGPRA* MNOTE                           00161600
&ZMS          SETC  '&ZMS.&GAP"'                                        00161700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00161800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00161900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162000
.ZE16R        ANOP  ,                                                   00162100
.*----------------------------------------------------------------***   00162200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00162300
              AIF   (N'&UNITS LE 1).ZE19A       CK NUM                  00162400
&ZMS          SETC  '"UNITS='   *KPOSA* MNOTE                           00162500
&ZMS          SETC  '&ZMS.&UNITS"'                                      00162600
&ZMS          SETC  '&ZMS "UNITS"'                                      00162700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00162800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162900
.ZE19A        ANOP  ,                                                   00163000
.*-------------------------------------------------------------------   00163100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00163200
              AIF   (K'&UNITS(1) LE 0).ZE19B    NO PRM                  00163300
&ZXUNITS      SETC  'INPUT'     SET IN/OUTPUT                           00163400
&XUNITS       SETC  '&UNITS(1)'                 SET XVARIABLE           00163500
              AIF   (N'&UNITS GT 1).ZE19B                               00163600
.*            ANOP              MULTIPLE PARMS                          00163700
&XUNITS       SETC  '&UNITS'    SET XVARIABLE                           00163800
.ZE19B        ANOP  ,                                                   00163900
.*-------------------------------------------------------------------   00164000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00164100
              AIF   (K'&ZXUNITS LE 0).ZE19R     NOT I/O                 00164200
              AIF   ('&XUNITS'(1,1) NE '(').ZE19R                       00164300
&ZCGPR        SETC  '&XUNITS'(2,K'&XUNITS-2)                            00164400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE19P                        00164500
              AIF   (K'&ZCGPR GT 2).ZE19Q                               00164600
              AIF   ('&ZCGPR' EQ '0').ZE19Q                             00164700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00164800
              AIF   (T'&ZCGPR NE 'N').ZE19Q     INVALID REG NAME        00164900
.ZE19P        ANOP  ,                                                   00165000
              AIF   (T'&ZCGPR NE 'N').ZE19R     NON NUMERIC             00165100
              AIF   ('&ZCGPR' LT '2').ZE19Q                             00165200
              AIF   ('&ZCGPR' LE '12').ZE19R                            00165300
.ZE19Q        ANOP  ,                                                   00165400
&ZMS          SETC  '"UNITS='   *KGPRA* MNOTE                           00165500
&ZMS          SETC  '&ZMS.&UNITS"'                                      00165600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00165700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00165800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00165900
.ZE19R        ANOP  ,                                                   00166000
.*-------------------------------------------------------------------   00166100
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00166200
.ZE21     AIF   ('&XSERVICE' NE 'REMOVE').ZE31                          00166300
.*-------------------------------------------------------------------   00166400
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00166500
              AIF   (K'&ZXREMOVE LE 0).ZE21R    NOT I/O                 00166600
              AIF   ('&XREMOVE'(1,1) NE '(').ZE21R                      00166700
&ZCGPR        SETC  '&XREMOVE'(2,K'&XREMOVE-2)                          00166800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE21P                        00166900
              AIF   (K'&ZCGPR GT 2).ZE21Q                               00167000
              AIF   ('&ZCGPR' EQ '0').ZE21Q                             00167100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00167200
              AIF   (T'&ZCGPR NE 'N').ZE21Q     INVALID REG NAME        00167300
.ZE21P        ANOP  ,                                                   00167400
              AIF   (T'&ZCGPR NE 'N').ZE21R     NON NUMERIC             00167500
              AIF   ('&ZCGPR' LT '2').ZE21Q                             00167600
              AIF   ('&ZCGPR' LE '12').ZE21R                            00167700
.ZE21Q        ANOP  ,                                                   00167800
&ZMS          SETC  '"REMOVE='  *KGPRA* MNOTE                           00167900
&ZMS          SETC  '&ZMS.&REMOVE"'                                     00168000
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00168100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00168200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00168300
.ZE21R        ANOP  ,                                                   00168400
.*----------------------------------------------------------------***   00168500
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00168600
              AIF   (N'&STOKEN LE 1).ZE23A      CK NUM                  00168700
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00168800
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00168900
&ZMS          SETC  '&ZMS "STOKEN"'                                     00169000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00169100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00169200
.ZE23A        ANOP  ,                                                   00169300
.*-------------------------------------------------------------------   00169400
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00169500
              AIF   (K'&STOKEN(1) LE 0).ZE23B   NO PRM                  00169600
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00169700
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00169800
              AIF   (N'&STOKEN GT 1).ZE23B                              00169900
.*            ANOP              MULTIPLE PARMS                          00170000
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00170100
.ZE23B        ANOP  ,                                                   00170200
.*-------------------------------------------------------------------   00170300
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00170400
              AIF   (K'&ZXSTOKEN LE 0).ZE23R    NOT I/O                 00170500
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE23R                      00170600
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00170700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                        00170800
              AIF   (K'&ZCGPR GT 2).ZE23Q                               00170900
              AIF   ('&ZCGPR' EQ '0').ZE23Q                             00171000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00171100
              AIF   (T'&ZCGPR NE 'N').ZE23Q     INVALID REG NAME        00171200
.ZE23P        ANOP  ,                                                   00171300
              AIF   (T'&ZCGPR NE 'N').ZE23R     NON NUMERIC             00171400
              AIF   ('&ZCGPR' LT '2').ZE23Q                             00171500
              AIF   ('&ZCGPR' LE '12').ZE23R                            00171600
.ZE23Q        ANOP  ,                                                   00171700
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00171800
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00171900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00172000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00172100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172200
.ZE23R        ANOP  ,                                                   00172300
.*----------------------------------------------------------------***   00172400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00172500
              AIF   (N'&PSTART LE 1).ZE26A      CK NUM                  00172600
&ZMS          SETC  '"PSTART='  *KPOSA* MNOTE                           00172700
&ZMS          SETC  '&ZMS.&PSTART"'                                     00172800
&ZMS          SETC  '&ZMS "PSTART"'                                     00172900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00173000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00173100
.ZE26A        ANOP  ,                                                   00173200
.*-------------------------------------------------------------------   00173300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00173400
              AIF   (K'&PSTART(1) LE 0).ZE26B   NO PRM                  00173500
&ZXPSTART     SETC  'INPUT'     SET IN/OUTPUT                           00173600
&XPSTART      SETC  '&PSTART(1)'                SET XVARIABLE           00173700
              AIF   (N'&PSTART GT 1).ZE26B                              00173800
.*            ANOP              MULTIPLE PARMS                          00173900
&XPSTART      SETC  '&PSTART'   SET XVARIABLE                           00174000
.ZE26B        ANOP  ,                                                   00174100
.*-------------------------------------------------------------------   00174200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00174300
              AIF   (K'&ZXPSTART LE 0).ZE26R    NOT I/O                 00174400
              AIF   ('&XPSTART'(1,1) NE '(').ZE26R                      00174500
&ZCGPR        SETC  '&XPSTART'(2,K'&XPSTART-2)                          00174600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                        00174700
              AIF   (K'&ZCGPR GT 2).ZE26Q                               00174800
              AIF   ('&ZCGPR' EQ '0').ZE26Q                             00174900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00175000
              AIF   (T'&ZCGPR NE 'N').ZE26Q     INVALID REG NAME        00175100
.ZE26P        ANOP  ,                                                   00175200
              AIF   (T'&ZCGPR NE 'N').ZE26R     NON NUMERIC             00175300
              AIF   ('&ZCGPR' LT '2').ZE26Q                             00175400
              AIF   ('&ZCGPR' LE '12').ZE26R                            00175500
.ZE26Q        ANOP  ,                                                   00175600
&ZMS          SETC  '"PSTART='  *KGPRA* MNOTE                           00175700
&ZMS          SETC  '&ZMS.&PSTART"'                                     00175800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00175900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00176000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00176100
.ZE26R        ANOP  ,                                                   00176200
.*----------------------------------------------------------------***   00176300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00176400
              AIF   (N'&PEND LE 1).ZE29A        CK NUM                  00176500
&ZMS          SETC  '"PEND='    *KPOSA* MNOTE                           00176600
&ZMS          SETC  '&ZMS.&PEND"'                                       00176700
&ZMS          SETC  '&ZMS "PEND"'                                       00176800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00176900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00177000
.ZE29A        ANOP  ,                                                   00177100
.*-------------------------------------------------------------------   00177200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00177300
              AIF   (K'&PEND(1) LE 0).ZE29B     NO PRM                  00177400
&ZXPEND       SETC  'INPUT'     SET IN/OUTPUT                           00177500
&XPEND        SETC  '&PEND(1)'  SET XVARIABLE                           00177600
              AIF   (N'&PEND GT 1).ZE29B                                00177700
.*            ANOP              MULTIPLE PARMS                          00177800
&XPEND        SETC  '&PEND'     SET XVARIABLE                           00177900
.ZE29B        ANOP  ,                                                   00178000
.*-------------------------------------------------------------------   00178100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00178200
              AIF   (K'&ZXPEND LE 0).ZE29R      NOT I/O                 00178300
              AIF   ('&XPEND'(1,1) NE '(').ZE29R                        00178400
&ZCGPR        SETC  '&XPEND'(2,K'&XPEND-2)                              00178500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                        00178600
              AIF   (K'&ZCGPR GT 2).ZE29Q                               00178700
              AIF   ('&ZCGPR' EQ '0').ZE29Q                             00178800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00178900
              AIF   (T'&ZCGPR NE 'N').ZE29Q     INVALID REG NAME        00179000
.ZE29P        ANOP  ,                                                   00179100
              AIF   (T'&ZCGPR NE 'N').ZE29R     NON NUMERIC             00179200
              AIF   ('&ZCGPR' LT '2').ZE29Q                             00179300
              AIF   ('&ZCGPR' LE '12').ZE29R                            00179400
.ZE29Q        ANOP  ,                                                   00179500
&ZMS          SETC  '"PEND='    *KGPRA* MNOTE                           00179600
&ZMS          SETC  '&ZMS.&PEND"'                                       00179700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00179800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00179900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00180000
.ZE29R        ANOP  ,                                                   00180100
.*-------------------------------------------------------------------   00180200
.***AE.KMEKY09 VALUE, RQD INPUT, ME KEYS -END                           00180300
.ZE31         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00180400
.******************************************************************     00180500
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00180600
.******************************************************************     00180700
              ACTR  10000                                               00180800
.*-------------------------------------------------------------------   00180900
.***AF.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00181000
&ZCVAL        SETC  ''          ERROR FIELD                             00181100
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00181200
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00181300
.ZELIST2      ANOP  ,                                                   00181400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00181500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZELIST3  DONE                 00181600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZELIST2          00181700
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00181800
              AIF   (&ZAWRK LE 0).ZELIST2                               00181900
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00182000
              AGO   .ZELIST2                                            00182100
.*                                                                      00182200
.ZELIST3  AIF  (K'&ZCVAL LE 0).ZELISTX                                  00182300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00182400
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00182500
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00182600
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00182700
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00182800
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00182900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00183000
.ZELISTX      ANOP  ,                                                   00183100
&ZASYSLNDX    SETA  0                                                   00183200
.*-------------------------------------------------------------------   00183300
.***AE.MF02 MF=(SLME)                                                   00183400
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00183500
.*******************************************************************    00183600
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00183700
.*******************************************************************    00183800
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00183900
.*******************************************************************    00184000
.***AE.01  START OF REFPAT MACRO CODE                                   00184100
.*******************************************************************    00184200
              LCLC  &M0M0001                 LABEL NAME                 00184300
&M0M0001      SETC  '&XLABEL'                SET LABEL                  00184400
              AIF   (K'&XLABEL NE 0).XLAB2                              00184500
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT LABEL              00184600
.*                                                                      00184700
.XLAB2        ANOP  ,                                                   00184800
&M0M0001 DS    0H                             REFPAT-0                  00184900
.*******************************************************************    00185000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00185100
.*******************************************************************    00185200
              PUSH  PRINT                                               00185300
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00185400
              PRINT OFF         ++ PR01                                 00185500
              AGO   .ZPRNTXX                                            00185600
.ZPRINTX      PRINT ON                                                  00185700
.ZPRNTXX      ANOP  ,                                                   00185800
.********************************************************************   00185900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00186000
.********************************************************************   00186100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00186200
                      LCLA  &ZOPN1         INVOCATION INDEX             00186300
                      LCLC  &ZOPL(4095)    LABEL                        00186400
                      LCLC  &ZOPO(4095)    OPERATION                    00186500
                      LCLC  &ZOPV(4095)    VALUE                        00186600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00186700
.*                                                                      00186800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00186900
.******************************************************************     00187000
.***AL.L10 REFPAT FMT=LIST MF=S|L PARAMETERS                            00187100
.******************************************************************     00187200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00187300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00187400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(2,3).'A'                     00187500
&XMFATTR              SETC  '0D'                                        00187600
.*                                                                      00187700
&ZOPN                 SETA  &ZOPN+1                                     00187800
&ZOPL(&ZOPN)          SETC  ' '                                         00187900
&ZOPO(&ZOPN)          SETC  'B'                                         00188000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00188100
&ZOPD(&ZOPN)          SETC  '++ REFPAT ARG PARMS'                       00188200
.*                                                                      00188300
&ZOPN                 SETA  &ZOPN+1                                     00188400
&ZOPL(&ZOPN)          SETC  ' '                                         00188500
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00188600
&ZOPV(&ZOPN)          SETC  '1'                                         00188700
&ZOPD(&ZOPN)          SETC  ' '                                         00188800
.*                                                                      00188900
.ZLMFSL2              ANOP  ,                                           00189000
.*-------------------------------------------------------------------   00189100
.***AM.L01  REFPAT FMT=LIST PARAMETERS                                  00189200
&ZOPN                 SETA &ZOPN+1                                      00189300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00189400
&ZOPO(&ZOPN)          SETC 'DS'                                         00189500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00189600
&ZOPD(&ZOPN)          SETC '++ REFPAT PARM LIST'                        00189700
.*-------------------------------------------------------------------   00189800
.***AM.L02 XVERSION XL1                                                 00189900
&ZOPN                 SETA &ZOPN+1                                      00190000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00190100
&ZOPO(&ZOPN)          SETC 'DS'                                         00190200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00190300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00190400
.*-------------------------------------------------------------------   00190500
.***AM.L05 XSERVICE XL1                                                 00190600
&ZOPN                 SETA &ZOPN+1                                      00190700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVICE'                         00190800
&ZOPO(&ZOPN)          SETC 'DS'                                         00190900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00191000
&ZOPD(&ZOPN)          SETC '++ &ZXSERVICE XSERVICE'                     00191100
.*                                                                      00191200
&ZOPN                 SETA  &ZOPN+1                                     00191300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._INSTALL'                         00191400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00191500
&ZOPV(&ZOPN)          SETC  '0'                                         00191600
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00191700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INSTALL'                      00191800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00191900
.*                                                                      00192000
&ZOPN                 SETA  &ZOPN+1                                     00192100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._REMOVE'                          00192200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00192300
&ZOPV(&ZOPN)          SETC  '1'                                         00192400
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00192500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REMOVE'                       00192600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00192700
.*-------------------------------------------------------------------   00192800
.***AM.L09  XRESERVED CL2                                               00192900
&ZOPN                 SETA &ZOPN+1                                      00193000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED'                        00193100
&ZOPO(&ZOPN)          SETC 'DS'                                         00193200
&ZOPV(&ZOPN)          SETC 'CL2'                                        00193300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED'                  00193400
.*-------------------------------------------------------------------   00193500
.***AM.L09  XSTOKEN CL8                                                 00193600
&ZOPN                 SETA &ZOPN+1                                      00193700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTOKEN'                          00193800
&ZOPO(&ZOPN)          SETC 'DS'                                         00193900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00194000
&ZOPD(&ZOPN)          SETC '++ &ZXSTOKEN  XSTOKEN'                      00194100
.*-------------------------------------------------------------------   00194200
.***AM.L09  XPSTART A                                                   00194300
&ZOPN                 SETA &ZOPN+1                                      00194400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPSTART'                          00194500
&ZOPO(&ZOPN)          SETC 'DS'                                         00194600
&ZOPV(&ZOPN)          SETC 'A'                                          00194700
&ZOPD(&ZOPN)          SETC '++ &ZXPSTART  XPSTART'                      00194800
.*-------------------------------------------------------------------   00194900
.***AM.L09  XPEND A                                                     00195000
&ZOPN                 SETA &ZOPN+1                                      00195100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPEND'                            00195200
&ZOPO(&ZOPN)          SETC 'DS'                                         00195300
&ZOPV(&ZOPN)          SETC 'A'                                          00195400
&ZOPD(&ZOPN)          SETC '++ &ZXPEND  XPEND'                          00195500
.*-------------------------------------------------------------------   00195600
.***AM.L09  XUNITS F                                                    00195700
&ZOPN                 SETA &ZOPN+1                                      00195800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUNITS'                           00195900
&ZOPO(&ZOPN)          SETC 'DS'                                         00196000
&ZOPV(&ZOPN)          SETC 'F'                                          00196100
&ZOPD(&ZOPN)          SETC '++ &ZXUNITS  XUNITS'                        00196200
.*-------------------------------------------------------------------   00196300
.***AM.L09  XUNITSIZE F                                                 00196400
&ZOPN                 SETA &ZOPN+1                                      00196500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUNITSIZE'                        00196600
&ZOPO(&ZOPN)          SETC 'DS'                                         00196700
&ZOPV(&ZOPN)          SETC 'F'                                          00196800
&ZOPD(&ZOPN)          SETC '++ &ZXUNITSIZE  XUNITSIZE'                  00196900
.*-------------------------------------------------------------------   00197000
.***AM.L09  XGAP F                                                      00197100
&ZOPN                 SETA &ZOPN+1                                      00197200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGAP'                             00197300
&ZOPO(&ZOPN)          SETC 'DS'                                         00197400
&ZOPV(&ZOPN)          SETC 'F'                                          00197500
&ZOPD(&ZOPN)          SETC '++ &ZXGAP  XGAP'                            00197600
.*-------------------------------------------------------------------   00197700
.***AM.L10 END OF REFPAT LIST PARAMETERS                                00197800
&ZOPN                 SETA &ZOPN+1                                      00197900
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00198000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00198100
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00198200
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00198300
.*                                                                      00198400
&ZOPN                 SETA &ZOPN+1                                      00198500
&ZOPL(&ZOPN)          SETC ' '                                          00198600
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00198700
&ZOPV(&ZOPN)          SETC '1'                                          00198800
&ZOPD(&ZOPN)          SETC ' '                                          00198900
.*-------------------------------------------------------------------   00199000
.***AL.L12 REFPAT FMT=LIST MF=S|L PARAMETERS                            00199100
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00199200
.*                                                                      00199300
&ZOPN                 SETA  &ZOPN+1                                     00199400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00199500
&ZOPO(&ZOPN)          SETC  'DC'                                        00199600
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00199700
&ZOPD(&ZOPN)          SETC  '++ REFPAT ARG PARMS'                       00199800
.*                                                                      00199900
.ZLMFSLX              ANOP  ,                                           00200000
.*-------------------------------------------------------------------   00200100
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00200200
&ZPLLEN               SETA 32                                           00200300
.*                                                                      00200400
.******************************************************************     00200500
.***AI.L01 REFPAT FMT=LIST FILL IN PARAMETER AREA                       00200600
.******************************************************************     00200700
                      ACTR  10000                                       00200800
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00200900
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00201000
&ZCVAL                SETC  'LAE'          XAX MODE                     00201100
.ZIMFXA               ANOP ,                                            00201200
.*                                                                      00201300
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00201400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00201500
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00201600
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00201700
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00201800
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00201900
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00202000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00202100
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00202200
&ZOPN                 SETA  &ZOPN+1                                     00202300
&ZOPL(&ZOPN)          SETC  ' '                                         00202400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00202500
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00202600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00202700
                      AGO   .ZIMFNX                                     00202800
.*                                                                      00202900
.ZIMFN2               ANOP ,                                            00203000
&ZOPN                 SETA  &ZOPN+1                                     00203100
&ZOPL(&ZOPN)          SETC  ' '                                         00203200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00203300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00203400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00203500
.ZIMFNX               ANOP ,                                            00203600
.********************************************************************   00203700
.***AI.L02 REFPAT FMT=LIST INITIALIZE PARAMETER AREA                    00203800
.********************************************************************   00203900
.***AI.L03 MF=(SLME)                                                    00204000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00204100
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00204200
.*                                                                      00204300
&ZOPN                 SETA  &ZOPN+1                                     00204400
&ZOPL(&ZOPN)          SETC  ' '                                         00204500
&ZOPO(&ZOPN)          SETC  'XC'                                        00204600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00204700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00204800
.ZIMFLX               ANOP  ,                                           00204900
.*-------------------------------------------------------------------   00205000
.***AI.L07 XSERVICE AL1                                                 00205100
&ZW                   SETC  ''                                          00205200
.*-------------------------------------------------------------------   00205300
.***AI.L15 XSERVICE "INSTALL" AL1                                       00205400
         AIF   ('&XSERVICE' NE 'INSTALL').ZI3A                          00205500
&ZW                   SETC  '0'                                         00205600
.ZI3A                 ANOP  ,                                           00205700
.*-------------------------------------------------------------------   00205800
.***AI.L15 XSERVICE "REMOVE" AL1                                        00205900
         AIF   ('&XSERVICE' NE 'REMOVE').ZI4A                           00206000
&ZW                   SETC  '1'                                         00206100
.ZI4A                 ANOP  ,                                           00206200
.*-------------------------------------------------------------------   00206300
.***AI.L17 XSERVICE AL1                                                 00206400
                      AIF   ('&ZW' NE '0').ZI4C                         00206500
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI4B              00206600
.ZI4C                 ANOP  ,                                           00206700
                      AIF   ('&ZW' EQ '').ZI4B                          00206800
.*                                                                      00206900
&ZOPN                 SETA  &ZOPN+1                                     00207000
&ZOPL(&ZOPN)          SETC  ' '                                         00207100
&ZOPO(&ZOPN)          SETC  'MVI'                                       00207200
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  00207300
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVICE XSERVICE AL1'                00207400
.ZI4B                 ANOP  ,                                           00207500
.*-------------------------------------------------------------------   00207600
.***AI.L18  XSTOKEN CL8                                                 00207700
                      AIF   ('&XSTOKEN' NE '0').ZI6                     00207800
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI6  CK *         00207900
&ZXSTOKEN             SETC  ''             RESET INPUT/OUTPUT           00208000
.ZI6                  ANOP  ,                                           00208100
.*-------------------------------------------------------------------   00208200
.***AI.L25  XSTOKEN CL8                                                 00208300
                      AIF   ('&ZXSTOKEN' EQ '').ZI6E  NOT USED          00208400
                      AIF   ('&ZXSTOKEN' EQ 'OUTPUT').ZI6E              00208500
&ZCGPR                SETC  '&XSTOKEN'                                  00208600
                      AIF   ('&XSTOKEN' NE '0').ZI6A                    00208700
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI6E              00208800
.*                                                                      00208900
&ZCGPR                SETC  '=XL8''00'''                                00209000
.ZI6A                 ANOP  ,                                           00209100
.*                                                                      00209200
                      AIF   ('&XSTOKEN'(1,1) NE '(').ZI6B               00209300
&ZCGPR   SETC  '0('.'&XSTOKEN'(2,K'&XSTOKEN-2).')'                      00209400
.ZI6B                 ANOP  ,                                           00209500
.*                                                                      00209600
&ZOPN                 SETA  &ZOPN+1                                     00209700
&ZOPL(&ZOPN)          SETC  ' '                                         00209800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00209900
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             00210000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTOKEN XSTOKEN CL8'                  00210100
.*                                                                      00210200
.ZI6E                 ANOP  ,                                           00210300
.*-------------------------------------------------------------------   00210400
.***AI.L25  XPSTART AL4                                                 00210500
                      AIF   ('&ZXPSTART' EQ '').ZI7E  NOT USED          00210600
                      AIF   ('&ZXPSTART' EQ 'OUTPUT').ZI7E              00210700
&ZCGPR                SETC  '&XPSTART'                                  00210800
.*                                                                      00210900
                      AIF   ('&XPSTART'(1,1) NE '(').ZI7B               00211000
&ZCGPR   SETC  '0('.'&XPSTART'(2,K'&XPSTART-2).')'                      00211100
                      AGO   .ZI7D                                       00211200
.ZI7B                 ANOP  ,                                           00211300
.*                                                                      00211400
&ZC                   SETC  '&XPSTART'(1,1)                             00211500
                      AIF   (T'&ZC NE 'N').ZI7D                         00211600
&ZC                   SETC  '&XPSTART'                                  00211700
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI7D            00211800
&ZCGPR                SETC  '=AL4(&XPSTART)'                            00211900
.*                                                                      00212000
.ZI7D                 ANOP  ,                                           00212100
.*                                                                      00212200
&ZOPN                 SETA  &ZOPN+1                                     00212300
&ZOPL(&ZOPN)          SETC  ' '                                         00212400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00212500
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00212600
&ZOPD(&ZOPN)          SETC  '++ &ZXPSTART XPSTART AL4'                  00212700
.*                                                                      00212800
.ZI7E                 ANOP  ,                                           00212900
.*-------------------------------------------------------------------   00213000
.***AI.L25  XPEND AL4                                                   00213100
                      AIF   ('&ZXPEND' EQ '').ZI8E  NOT USED            00213200
                      AIF   ('&ZXPEND' EQ 'OUTPUT').ZI8E                00213300
&ZCGPR                SETC  '&XPEND'                                    00213400
.*                                                                      00213500
                      AIF   ('&XPEND'(1,1) NE '(').ZI8B                 00213600
&ZCGPR   SETC  '0('.'&XPEND'(2,K'&XPEND-2).')'                          00213700
                      AGO   .ZI8D                                       00213800
.ZI8B                 ANOP  ,                                           00213900
.*                                                                      00214000
&ZC                   SETC  '&XPEND'(1,1)                               00214100
                      AIF   (T'&ZC NE 'N').ZI8D                         00214200
&ZC                   SETC  '&XPEND'                                    00214300
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI8D            00214400
&ZCGPR                SETC  '=AL4(&XPEND)'                              00214500
.*                                                                      00214600
.ZI8D                 ANOP  ,                                           00214700
.*                                                                      00214800
&ZOPN                 SETA  &ZOPN+1                                     00214900
&ZOPL(&ZOPN)          SETC  ' '                                         00215000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00215100
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00215200
&ZOPD(&ZOPN)          SETC  '++ &ZXPEND XPEND AL4'                      00215300
.*                                                                      00215400
.ZI8E                 ANOP  ,                                           00215500
.*-------------------------------------------------------------------   00215600
.***AI.L25  XUNITS F                                                    00215700
                      AIF   ('&ZXUNITS' EQ '').ZI9E  NOT USED           00215800
                      AIF   ('&ZXUNITS' EQ 'OUTPUT').ZI9E               00215900
&ZCGPR                SETC  '&XUNITS'                                   00216000
.*                                                                      00216100
                      AIF   ('&XUNITS'(1,1) NE '(').ZI9B                00216200
&ZCGPR   SETC  '0('.'&XUNITS'(2,K'&XUNITS-2).')'                        00216300
                      AGO   .ZI9D                                       00216400
.ZI9B                 ANOP  ,                                           00216500
.*                                                                      00216600
&ZC                   SETC  '&XUNITS'(1,1)                              00216700
                      AIF   (T'&ZC NE 'N').ZI9D                         00216800
&ZC                   SETC  '&XUNITS'                                   00216900
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI9D            00217000
&ZCGPR                SETC  '=FL4''&XUNITS'''                           00217100
.*                                                                      00217200
.ZI9D                 ANOP  ,                                           00217300
.*                                                                      00217400
&ZOPN                 SETA  &ZOPN+1                                     00217500
&ZOPL(&ZOPN)          SETC  ' '                                         00217600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00217700
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00217800
&ZOPD(&ZOPN)          SETC  '++ &ZXUNITS XUNITS F'                      00217900
.*                                                                      00218000
.ZI9E                 ANOP  ,                                           00218100
.*-------------------------------------------------------------------   00218200
.***AI.L25  XUNITSIZE F                                                 00218300
                      AIF   ('&ZXUNITSIZE' EQ '').ZI10E  NOT USED       00218400
                      AIF   ('&ZXUNITSIZE' EQ 'OUTPUT').ZI10E           00218500
&ZCGPR                SETC  '&XUNITSIZE'                                00218600
.*                                                                      00218700
                      AIF   ('&XUNITSIZE'(1,1) NE '(').ZI10B            00218800
&ZCGPR   SETC  '0('.'&XUNITSIZE'(2,K'&XUNITSIZE-2).')'                  00218900
                      AGO   .ZI10D                                      00219000
.ZI10B                ANOP  ,                                           00219100
.*                                                                      00219200
&ZC                   SETC  '&XUNITSIZE'(1,1)                           00219300
                      AIF   (T'&ZC NE 'N').ZI10D                        00219400
&ZC                   SETC  '&XUNITSIZE'                                00219500
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI10D           00219600
&ZCGPR                SETC  '=FL4''&XUNITSIZE'''                        00219700
.*                                                                      00219800
.ZI10D                ANOP  ,                                           00219900
.*                                                                      00220000
&ZOPN                 SETA  &ZOPN+1                                     00220100
&ZOPL(&ZOPN)          SETC  ' '                                         00220200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00220300
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00220400
&ZOPD(&ZOPN)          SETC  '++ &ZXUNITSIZE XUNITSIZE F'                00220500
.*                                                                      00220600
.ZI10E                ANOP  ,                                           00220700
.*-------------------------------------------------------------------   00220800
.***AI.L25  XGAP F                                                      00220900
                      AIF   ('&ZXGAP' EQ '').ZI11E  NOT USED            00221000
                      AIF   ('&ZXGAP' EQ 'OUTPUT').ZI11E                00221100
&ZCGPR                SETC  '&XGAP'                                     00221200
                      AIF   ('&XGAP' NE '0').ZI11A                      00221300
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI11E             00221400
.*                                                                      00221500
&ZCGPR                SETC  '=XL4''00'''                                00221600
.ZI11A                ANOP  ,                                           00221700
.*                                                                      00221800
                      AIF   ('&XGAP'(1,1) NE '(').ZI11B                 00221900
&ZCGPR   SETC  '0('.'&XGAP'(2,K'&XGAP-2).')'                            00222000
                      AGO   .ZI11D                                      00222100
.ZI11B                ANOP  ,                                           00222200
.*                                                                      00222300
&ZC                   SETC  '&XGAP'(1,1)                                00222400
                      AIF   (T'&ZC NE 'N').ZI11D                        00222500
&ZC                   SETC  '&XGAP'                                     00222600
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI11D           00222700
&ZCGPR                SETC  '=FL4''&XGAP'''                             00222800
.*                                                                      00222900
.ZI11D                ANOP  ,                                           00223000
.*                                                                      00223100
&ZOPN                 SETA  &ZOPN+1                                     00223200
&ZOPL(&ZOPN)          SETC  ' '                                         00223300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00223400
&ZOPV(&ZOPN)          SETC  '28(4,1),&ZCGPR'                            00223500
&ZOPD(&ZOPN)          SETC  '++ &ZXGAP XGAP F'                          00223600
.*                                                                      00223700
.ZI11E                ANOP  ,                                           00223800
.*-------------------------------------------------------------------   00223900
&ZOPN1                SETA &ZOPN                                        00224000
.*-------------------------------------------------------------------   00224100
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00224200
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00224300
.*******************************************************************    00224400
.***  PROCESS REFPAT OUTPUT PARAMETERS                                  00224500
.*******************************************************************    00224600
                      ACTR  10000                                       00224700
.*******************************************************************    00224800
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00224900
.*******************************************************************    00225000
.ZMFLX                ANOP  ,              MF=L PROCESSING              00225100
.*******************************************************************    00225200
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00225300
.*******************************************************************    00225400
                      ACTR  10000                                       00225500
.*                                                                      00225600
                      LCLA  &ZLC           COLUMN POSITION              00225700
                      LCLA  &ZOPX          LIST TABLE INDEX             00225800
                      LCLC  &ZLL           LABEL                        00225900
                      LCLC  &ZLOP          OPERATION                    00226000
                      LCLC  &ZLV           VALUE                        00226100
                      LCLC  &ZLD           DESCRIPTION                  00226200
.*                                                                      00226300
&ZOPX                 SETA  1                                           00226400
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00226500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00226600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00226700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00226800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00226900
                      AIF   (K'&ZLD LE 0).ZL5                           00227000
&ZLC                  SETA  35             COMMENT COLUMN               00227100
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00227200
&ZLC                  SETA  33             COMMMENT COLUMN              00227300
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00227400
&ZLV                  SETC  '&ZLV'.' '                                  00227500
                      AGO   .ZL3                                        00227600
.*                                                                      00227700
.ZL4                  ANOP  ,                                           00227800
&ZLV                  SETC  '&ZLV'.' '                                  00227900
.ZL5                  ANOP  ,                                           00228000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00228100
.*                                                                      00228200
&ZLL     &ZLOP &ZLV                                                     00228300
.*                                                                      00228400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00228500
                      AGO   .ZL2           CONTINUE LOOPING             00228600
.*                                                                      00228700
.ZLX                  ANOP  ,                                           00228800
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00228900
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00229000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00229100
         L     14,16(0,0)        GET CVT ADDRESS                        00229200
         L     14,772(14,0)      GET SYSTEM FUNCTION TABLE ADDRESS      00229300
         L     14,208(14,0)      GET LX/EX FOR SERVICE ROUTINE          00229400
         LA    15,8              GET EX FOR SERVICE ROUTINE             00229500
         OR    14,15             GET LX/EX FOR SERVICE ROUTINE          00229600
         PC    0(14)             PC TO REFPAT SERVICE                   00229700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00229800
.ZLINKX               ANOP  ,                                           00229900
.*******************************************************************    00230000
.***AP.X01  FORMAT GENERATED CODE                                       00230100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00230200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00230300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00230400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00230500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00230600
                      AIF   (K'&ZLD LE 0).ZL51                          00230700
&ZLC                  SETA  35             COMMENT COLUMN               00230800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00230900
&ZLC                  SETA  33             COMMENT COLUMN               00231000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00231100
&ZLV                  SETC  '&ZLV'.' '                                  00231200
                      AGO   .ZL31                                       00231300
.*                                                                      00231400
.ZL41                 ANOP  ,                                           00231500
&ZLV                  SETC  '&ZLV'.' '                                  00231600
.ZL51                 ANOP  ,                                           00231700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00231800
.*                                                                      00231900
&ZLL     &ZLOP &ZLV                                                     00232000
.*                                                                      00232100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00232200
                      AGO   .ZL21          CONTINUE LOOPING             00232300
.*                                                                      00232400
.ZLX1                 ANOP  ,                                           00232500
.*******************************************************************    00232600
.***AP.X02  END OF REFPAT MACRO                                         00232700
&ZREFPAT              SETC  'YES'          SET REFPAT USED              00232800
         POP   PRINT                                                    00232900
*                                            REFPAT-0                   00233000
         SPACE 1                                                        00233100
.ZLX2                 ANOP  ,                                           00233200
         MEND                                                           00233300
**********************************************************************/ 00233400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00233500
*%REFPAT: MACRO KEYS(INSTALL,STOKEN,PSTART,PEND,UNITSIZE,GAP,UNITS,     00233600
*                 REMOVE,RETCODE,RSNCODE,MF);                           00233700
*  ANS('?'||MACLABEL||' '||'REFPATP '||MACLIST||                        00233800
*         ' '||MACKEYS||';') COL(MACLMAR);                              00233900
*%END REFPAT;                                                           00234000
