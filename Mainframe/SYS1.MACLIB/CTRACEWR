*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00683300
*                                                                     * 00694400
*01* MACRO NAME:  CTRACEWR                              -96/03/28-<0> * 00705500
*                                                                     * 00716600
*                                                                     * 00722100
*01* DESCRIPTIVE NAME:  Component Trace Write Macro                   * 00727700
*                                                                     * 00728700
*01* PROPRIETARY STATEMENT:                                           * 00729700
*                                                                     * 00730700
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00731700
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00732700
*     5645-001 (C) COPYRIGHT IBM CORP. 1997                           * 00734200
*                                                                     * 00735700
* STATUS= HBB6603                                                     * 00736700
*                                                                     * 00737700
*                                                                     * 00738800
*                                                                     * 00750000
*01* FUNCTION:                                                        * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*      CTRACEWR macro provides the interface to the Component Trace   * 00950000
*      Writer service routine.                                        * 01000000
*                                                                     * 01050000
*      Register Usage                                                 * 01100000
*                                                                     * 01150000
*                                                                     * 01200000
*      o   AR/GPRs 0,1,14,15 are not preserved.                       * 01250000
*                                                                     * 01300000
*      o   AR/GPRs 2-13 are preserved.                                * 01350000
*                                                                     * 01400000
*      o   Upon return GPR 15 contains a return code.                 * 01450000
*                                                                     * 01500000
*      o   Upon return GPR 0 will contain a reason code if GPR 15 is  * 01550000
*          non-zero.                                                  * 01600000
*                                                                     * 01650000
*                                                                     * 01700000
*                                                                     * 01725000
*02*   OPERATION:                                                     * 01750000
*                                                                     * 01800000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 01825000
*                                                                     * 01850000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01900000
*                                                                     * 02100000
*                                                                     * 02200000
*he CTRACEWR macro performs syntax checking to validate the user      * 02250000
*pecified request. If an error is detected, macro phase error         * 02300000
*essages are issued and a macro phase return code of 8 is set.        * 02350000
*                                                                     * 02400000
*he parameter list is defined.                                        * 02416600
*                                                                     * 02433200
*he parameter list is initialized and the linkage code is generated   * 02449800
*o perform a non-space switch PC to the service routine for the       * 02466400
*trace external writer.                                               * 02483000
*                                                                     * 02499600
*he CTRACEWR macro cannot be invoked in an environment where it is    * 02516200
*ot possible to obtain the VSMFIX lock.                               * 02532800
*                                                                     * 02550000
*01* ENVIRONMENT:                                                     * 02600000
*                                                                     * 02650000
*                                                                     * 02700000
*      Dispatchable unit mode: Task or SRB mode.                      * 02750000
*                                                                     * 02800000
*      Minimum authorization: Supervisor state.  Zero PSW key.        * 02850000
*                                                                     * 02950000
*      AMODE:            31-bit.                                      * 03000000
*                                                                     * 03050000
*      ASC mode:         Primary or Access Register.                  * 03100000
*                                                                     * 03150000
*                        Any cross memory mode is supported.  The     * 03200000
*                        CTRACEWR macro cannot be invoked in an       * 03250000
*                        environment where it is not possible to      * 03450000
*                        obtain the VSMFIX lock.                      * 03500000
*                                                                     * 03550000
*                                                                     * 03600000
*                                                                     * 03625000
*01* SYNTAX:                                                          * 03650000
*                                                                     * 03700000
*[xlabel]  CTRACEWR     BUFFADDR=xbuffaddr                            * 03750000
*                         [,BUFFALET=xbuffalet|NOBUFFALET]          * 03800000
*                      ,BUFFLEN=xbufflen                              * 03850000
*                      ,TOKEN=xtoken                                  * 03900000
*                      ,TBWCADDR=xtbwcaddr                            * 03950000
*                         [,TBWCALET=xtbwcalet|NOTBWCALET]          * 04000000
*                         [,SYNCH=NO|YES]                           * 04025000
*                     [,RC=xrc]                                       * 04050000
*                     [,RSNCODE=xrsncode]                             * 04100000
*                     [,COM=xcom|NULL]                              * 04150000
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 04175000
*                    [,MF=S]                                         * 04200000
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 04250000
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 04300000
*                                                                     * 04350000
*                                                                     * 04400000
*      Where:                                                         * 04450000
*                                                                     * 04500000
*                                                                     * 04550000
*      [xlabel]                                                       * 04600000
*          is an optional symbol, starting in column 1, that is the   * 04641600
*          name on the CTRACEWR macro invocation.  The name must      * 04683200
*          conform to the rules for an ordinary assembler language    * 04724800
*          symbol.                                                    * 04766400
*          DEFAULT: No name.                                          * 04808000
*                                                                     * 04850000
*                                                                     * 04900000
*                                                                     * 04950000
*                                                                     * 04975000
*      BUFFADDR=xbuffaddr                                             * 05000000
*          is the name (RS-type), or address in register (2)-(12), of * 05050000
*          a required 4 byte input that contains the address of the   * 05100000
*          buffer to be written externally.                           * 05150000
*                                                                     * 05200000
*                                                                     * 05250000
*          [BUFFALET=xbuffalet|NOBUFFALET]                          * 05300000
*              is the name (RS-type), or address in register          * 05350000
*              (2)-(12), of an optional 4 character input variable    * 05400000
*              that contains the PASN ALET that identifies the        * 05450000
*              address/data space where the buffer resides.  This     * 05500000
*              keyword is only appropriate when the buffer to be      * 05550000
*              written externally resides in either a data space or   * 05600000
*              an address space that is different from the current    * 05650000
*              primary address space.  NOTE: the BUFFALET and         * 05700000
*              TBWCALET must both be addressable in the same space;   * 05750000
*              that is, they both must be addressable via HOME (if a  * 05800000
*              HOME ALET is specified) or via SECONDARY (if a         * 05850000
*              SECONDARY ALET is specified) or via PRIMARY (is a      * 05900000
*              PRIMARY ALET or data space PASN ALET or no ALET is     * 05950000
*              specified).                                            * 06000000
*              DEFAULT: NOBUFFALET                                    * 06050000
*                                                                     * 06100000
*                                                                     * 06150000
*                                                                     * 06200000
*                                                                     * 06250000
*                                                                     * 06266600
*                                                                     * 06283200
*      BUFFLEN=xbufflen                                               * 06300000
*          is the name (RS-type), or address in register (2)-(12), of * 06350000
*          a required fullword input variable that provides the       * 06400000
*          length (in number of bytes) of the buffer that is to be    * 06450000
*          written externally.  For better processing time, and more  * 06500000
*          efficient use of space, it is preferable to pass large     * 06550000
*          buffers to Ctrace for writing.  For this reason, it is     * 06600000
*          recommended that the buffer size be at LEAST 4K bytes.     * 06650000
*          Ctrace will split buffers that are too large to fit into a * 06700000
*          single block, so there is no upper limit on the buffer     * 06750000
*          length, aside from needing to fit into a fixed(31) field   * 06800000
*          and Ctrace being able to obtain sufficient storage to      * 06850000
*          process the request.                                       * 06900000
*                                                                     * 06950000
*                                                                     * 07000000
*                                                                     * 07050000
*                                                                     * 07075000
*      TOKEN=xtoken                                                   * 07100000
*          is the name (RS-type), or address in register (2)-(12), of * 07150000
*          a required 8 character input variable that contains the    * 07200000
*          token that was passed to the component start/stop exit     * 07250000
*          when it was requested to start tracing externally.         * 07300000
*                                                                     * 07350000
*                                                                     * 07400000
*                                                                     * 07450000
*                                                                     * 07475000
*      TBWCADDR=xtbwcaddr                                             * 07500000
*          is the name (RS-type), or address in register (2)-(12), of * 07550000
*          a required 4 byte input that contains the address of       * 07600000
*          storage that is obtained by the component and mapped by    * 07650000
*          ITTTBWC.  This storage is used to provide communication    * 07700000
*          between the component tracing routine and the CTRACE code  * 07750000
*          that is capturing the trace buffer asynchronously.  The    * 07800000
*          CTRACECS macro should be used to manipulate control        * 07850000
*          information that is mapped by ITTTBWC.                     * 07900000
*                                                                     * 07950000
*                                                                     * 08000000
*          [TBWCALET=xtbwcalet|NOTBWCALET]                          * 08050000
*              is the name (RS-type), or address in register          * 08100000
*              (2)-(12), of an optional 4 character input variable    * 08150000
*              that contains the PASN ALET that identifies the        * 08200000
*              address/data space where the control area (storage     * 08250000
*              mapped by ITTTBWC) resides.  This keyword is only      * 08300000
*              appropriate when the control area resides in either a  * 08350000
*              data space or an address space that is different from  * 08400000
*              the current primary address space.  NOTE: the BUFFALET * 08450000
*              and TBWCALET must both be addressable in the same      * 08500000
*              space; that is, they both must be addressable via HOME * 08550000
*              (if a HOME ALET is specified) or via SECONDARY (if a   * 08600000
*              SECONDARY ALET is specified) or via PRIMARY (is a      * 08650000
*              PRIMARY ALET or data space PASN ALET or no ALET is     * 08700000
*              specified).                                            * 08750000
*              DEFAULT: NOTBWCALET                                    * 08800000
*                                                                     * 08850000
*                                                                     * 08900000
*                                                                     * 08950000
*                                                                     * 09000000
*          [SYNCH=NO|YES]                                           * 09002700
*              is an optional keyword input is an optional keyword    * 09005400
*              input used to indicate whether the CTRACEWR function   * 09008100
*              should be completed asynchronously or synchronously.   * 09010800
*              DEFAULT: NO                                            * 09013500
*                                                                     * 09016600
*                                                                     * 09017600
*              SYNCH=NO                                               * 09018600
*                  specifies that the CTRACEWR function should be     * 09019600
*                  executed asynchronously.                           * 09020600
*                                                                     * 09021600
*              SYNCH=YES                                              * 09022600
*                  specifies that the CTRACEWR function should be     * 09023600
*                  executed synchronously.                            * 09024600
*                                                                     * 09025600
*                                                                     * 09026600
*                                                                     * 09027600
*                                                                     * 09028600
*                                                                     * 09029600
*                                                                     * 09030600
*                                                                     * 09031600
*                                                                     * 09033200
*      [RC=xrc]                                                       * 09050000
*          is the name (RS-type) of an optional fullword output       * 09100000
*          variable, or register (2)-(12), into which the return code * 09150000
*          is to be copied from GPR 15.                               * 09200000
*                                                                     * 09250000
*                                                                     * 09300000
*                                                                     * 09350000
*                                                                     * 09375000
*      [RSNCODE=xrsncode]                                             * 09400000
*          is the name (RS-type) of an optional fullword output       * 09450000
*          variable, or register (2)-(12), into which the reason code * 09500000
*          is to be copied from GPR 0.                                * 09550000
*                                                                     * 09600000
*                                                                     * 09650000
*                                                                     * 09700000
*                                                                     * 09725000
*      [COM=xcom|NULL]                                              * 09750000
*          is an optional character input  that will appear in the    * 09800000
*          block comment before the macro invocation echo. It can be  * 09850000
*          used to comment the macro invocation.  The comment string  * 09900000
*          must be enclosed in quotes if it contains any lower case   * 09950000
*          characters.                                                * 10000000
*          DEFAULT: NULL                                              * 10050000
*                                                                     * 10100000
*                                                                     * 10150000
*                                                                     * 10200000
*                                                                     * 10225000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 10226100
*          is an optional byte input decimal value in the "0-0" range * 10227200
*          that specifies the macro version.  PLISTVER is the only    * 10228300
*          key allowed on the list form of MF and determines which    * 10229400
*          parameter list is generated.  Note that MAX may be         * 10230500
*          specified instead of a number, and the parameter list will * 10231600
*          be of the largest size currently supported. This size may  * 10232700
*          grow from release to release (thus possibly affecting the  * 10233800
*          amount of storage needed by your program).  If your        * 10234900
*          program can tolerate this, IBM recommends that you always  * 10236000
*          specify MAX when creating the list form parameter list as  * 10237100
*          that will ensure that the list form parameter list is      * 10238200
*          always long enough to hold whatever parameters might be    * 10239300
*          specified on the execute form.                             * 10240400
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 10241500
*          default is the lowest version which allows all of the      * 10242600
*          parameters specified on the invocation to be processed.    * 10243700
*                                                                     * 10244800
*                                                                     * 10245900
*                                                                     * 10247000
*                                                                     * 10248100
*      [MF=S|L|E]                                                   * 10250000
*          is an optional keyword input which specifies the macro     * 10300000
*          form.                                                      * 10350000
*          DEFAULT: S                                                 * 10400000
*                                                                     * 10450000
*                                                                     * 10500000
*          [MF=S]                                                     * 10550000
*              specifies the standard form of the macro.  The "S"     * 10600000
*              form generates code to put the parameters into an      * 10650000
*              in-line parameter list and invoke the desired service. * 10700000
*              Full checking for required macro keys is done along    * 10750000
*              with supplying defaults for omitted optional           * 10800000
*              parameters.                                            * 10850000
*                                                                     * 10900000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 10950000
*              specifies the list form of the macro.  The "L" form    * 11000000
*              defines an area to be used for the parameter list.     * 11050000
*              Only the PLISTVER key may be specified on the          * 11070000
*              invocation.  All other macro parameters are flagged as * 11090000
*              errors.  If PLISTVER is not specified, the original    * 11110000
*              parameter list definition is used.                     * 11130000
*                                                                     * 11150000
*            ,xmfctrl                                                 * 11200000
*              is a required input.  It is the name of a storage area * 11250000
*              for the parameter list.                                * 11300000
*                                                                     * 11350000
*            ,xmfattr|0D                                            * 11400000
*              is an optional 60 character input string that varies   * 11437500
*              from 1 to 60 characters. It can contain any value that * 11475000
*              is valid on an assembler DS pseudo-op. You can use     * 11512500
*              this parameter to force boundary alignment of the      * 11550000
*              parameter list.                                        * 11587500
*              DEFAULT: 0D which forces the parameter list to a       * 11625000
*              doubleword boundary.                                   * 11662500
*                                                                     * 11700000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 11750000
*              specifies the execute form of the macro.  The "E" form * 11800000
*              generates code to put the parameters into the          * 11850000
*              parameter list specified by xmfctrl and provides full  * 11900000
*              syntax checking with default setting.                  * 11950000
*                                                                     * 12000000
*            ,xmfctrl                                                 * 12050000
*              is a required input.  It is the name (RS-type), or     * 12100000
*              address in register (1)-(12), of a storage area for    * 12150000
*              the parameter list.                                    * 12200000
*                                                                     * 12250000
*            ,COMPLETE                                              * 12300000
*              is an optional keyword input which specifies the       * 12350000
*              degree of macro parameter syntax checking.             * 12400000
*              DEFAULT: COMPLETE                                      * 12450000
*                                                                     * 12500000
*                                                                     * 12550000
*              COMPLETE                                               * 12590000
*                  Checking for required macro keys is done and       * 12630000
*                  defaults are supplied for omitted optional         * 12670000
*                  parameters.                                        * 12710000
*                                                                     * 12750000
*                                                                     * 12800000
*                                                                     * 12850000
*                                                                     * 12900000
*                                                                     * 12912500
*                                                                     * 12925000
*                                                                     * 12937500
*01* RETURN CODES:                                                    * 12950000
*                                                                     * 13000000
*                                                                     * 13050000
*                                                                     * 13100000
*                      00   Successful - CTRACE has initiated the     * 13133300
*                           process of capturing the trace data.      * 13166600
*                                                                     * 13200000
*                      04   Unsuccessful - No data was captured since * 13250000
*                           the trace is not connected to an active   * 13300000
*                           writer.                                   * 13350000
*                                                                     * 13400000
*                      08   Unsuccessful due to environmental         * 13450000
*                           circumstances, reason code in register    * 13500000
*                           zero.                                     * 13550000
*                                                                     * 13600000
*                      12 (C) Unsuccessful due to invalid input,      * 13650000
*                           reason code in register zero.             * 13700000
*                                                                     * 13750000
*                                                                     * 13800000
*                                                                     * 13850000
*                                                                     * 13866600
*                                                                     * 13883200
*01* REASON CODES:                                                    * 13900000
*                                                                     * 13950000
*       The format for reason codes is xxxxyyxx where yy is the       * 14000000
*       hexadecimal reason code.                                      * 14050000
*                                                                     * 14100000
*                                                                     * 14150000
*       RETURN   REASON                                               * 14200000
*       CODE     CODE                                                 * 14250000
*                                                                     * 14300000
*                                                                     * 14350000
*       08       01 - Storage required to perform the CTRACE Write    * 14400000
*                operation could not be obtained.                     * 14435700
*                                                                     * 14471400
*                02 - Unable to schedule SRB to process this request. * 14507100
*                                                                     * 14542800
*                03 - The control information (TBWC) has already been * 14578500
*                reused by the component.                             * 14614200
*                                                                     * 14650000
*       12 (C)   01 - Could not process request since caller is       * 14700000
*                holding locks which require CTRACE to process.       * 14716600
*                                                                     * 14733200
*                02 - Invalid input token.                            * 14749800
*                                                                     * 14766400
*                03 - Input TBWC is invalid (not in real storage or   * 14783000
*                sequence number is the same as the previous write    * 14799600
*                request).                                            * 14816200
*                                                                     * 14832800
*                                                                     * 14850000
*                                                                     * 14900000
*01* ABEND CODES:                                                     * 14950000
*                                                                     * 15000000
*                                                                     * 15050000
*       00D       Component Trace service request failed.             * 15100000
*                                                                     * 15150000
*                                                                     * 15200000
*                                                                     * 15225000
*01* ABEND REASON CODES:                                              * 15250000
*                                                                     * 15300000
*       The format for reason codes is xxyyyyxx where yyyy is the     * 15350000
*       reason code.  The reason codes are in hexadecimal.            * 15400000
*                                                                     * 15450000
*                                                                     * 15500000
*       ABEND    REASON                                               * 15550000
*       CODE     CODE                                                 * 15600000
*                                                                     * 15650000
*                                                                     * 15700000
*       00D      0101 - Incompatible level of the CTRACEWR parameter  * 15750000
*                list used with the service routine.                  * 15800000
*                                                                     * 15850000
*       00D      0102 - Non zero values in the reserved fields or     * 15900000
*                fields unused for the requested service in the       * 15950000
*                CTRACEWR parameter list.                             * 16000000
*                                                                     * 16200000
*                                                                     * 16250000
*                                                                     * 16275000
*01* MODULE TYPE:  ASSEM MACRO                                        * 16300000
*                                                                     * 16350000
*02*   PROCESSOR:  ASSEM                                              * 16400000
*                                                                     * 16450000
*01* COMPONENT:  SCTRC                                                * 16500000
*                                                                     * 16550000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 16600000
*                                                                     * 16650000
*01* MACRO USAGE NOTES:                                               * 16700000
*                                                                     * 16750000
*                                                                     * 16800000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 16850000
*        global macro variable.  Any value other than 'NO' will       * 16900000
*        result in the macro expansion being printed.  The default is * 16950000
*        'YES'.  The following examples illustrate how the ZPRINT     * 17000000
*        variable should be set.                                      * 17050000
*                                                                     * 17100000
*                    GBLC &ZPRINT                                     * 17125000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 17150000
*                                                                     * 17157100
*                                                                     * 17164200
*    2.  All   keys   currently   contained  in  the  CTRACEWR  macro * 17171300
*        correspond  to  version  0.   If you specify PLISTVER, use a * 17178400
*        value of 0 or MAX.                                           * 17185500
*                                                                     * 17192600
*        None                                                         * 17200000
*                                                                     * 17250000
*                                                                     * 17300000
*                                                                     * 17325000
*01* CHANGE ACTIVITY:                                                 * 17350000
*                                                                     * 17400000
*   Flag LineItem  FMID    Date   ID    Comment                       * 17450000
*                                                                     * 17500000
*    $L0=CTWTR    HBB4420 071290 PD34G1:  Ctrace writer support.      * 17550000
*    $P1=PH31404  HBB4420 091790 PD34G1:  Fix copyright.              * 17600000
*    $L1=IOSCT    HBB6603 032996 PDXM:  Add SYNCH keyword.            * 17625000
****** END OF SPECIFICATIONS *****************************************/ 17650000
*/********************************************************************* 17700000
         MACRO                                                          17750000
&XLABEL  CTRACEWR &BUFFADDR=,&BUFFALET=,&BUFFLEN=,&TOKEN=,&TBWCADDR=,  *17800000
               &TBWCALET=,&SYNCH=,&RC=,&RSNCODE=,&COM=,&PLISTVER=,&MF=  17850000
.*                                                                      17900000
*              MACDATE -96/03/28-<0>                                    17950000
.*                                                                      18000000
.*******************************************************************    18050000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        18100000
.*******************************************************************    18150000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   18200000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     18250000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             18300000
.*                                                                      18350000
              GBLC  &ZCTRACEWR  YES=MACRO USED AT LEAST ONCE            18400000
.*******************************************************************    18450000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          18500000
.*******************************************************************    18550000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 18600000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            18650000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              18700000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             18750000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             18800000
              LCLA  &ZAWRK      USED AS A WORK AREA                     18850000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  18900000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   18950000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 19000000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             19016600
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 19033200
              LCLA  &ZMACRET    MACRO RETURN CODE                       19050000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        19100000
.*                                                                      19150000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      19200000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              19250000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   19300000
              LCLC  &ZENDBASEPL                 End of base PL          19304100
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   19308200
.*******************************************************************    19312300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             19316400
.*******************************************************************    19320500
              LCLA  &ZI         INDEX FOR ARRAY                         19324600
              LCLA  &ZJ         INDEX FOR PARMS                         19328700
              LCLA  &ZK         INDEX FOR PARSE                         19332800
              LCLA  &ZLO        LOW RANGE VALUE                         19336900
              LCLA  &ZHI        HIGH RANGE VALUE                        19341000
              LCLC  &ZW         WORK AREA FOR PARM                      19345100
.********************************************************************   19350000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 19400000
.********************************************************************   19450000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 19500000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          19550000
.*                                                                      19600000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       19650000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        19700000
              SPLEVEL  TEST                                             19750000
.ZSYS2        ANOP  ,                                                   19800000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              19850000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              19900000
              SYSSTATE TEST                                             19950000
              AGO   .ZSYS4                                              20000000
.ZSYS3        ANOP  ,                                                   20050000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 20100000
.ZSYS4        ANOP  ,                                                   20150000
.*******************************************************************    20200000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   20250000
.*******************************************************************    20300000
              LCLC  &XBUFFADDR  ++ NAME                                 20350000
              LCLC  &XBUFFALET  ++ NAME                                 20400000
              LCLC  &XBUFFLEN   ++ NAME                                 20450000
              LCLC  &XTOKEN     ++ NAME                                 20500000
              LCLC  &XTBWCADDR  ++ NAME                                 20550000
              LCLC  &XTBWCALET  ++ NAME                                 20600000
              LCLC  &XSYNCH     ++ VALUE                                20625000
              LCLC  &XRC        ++ NAME                                 20650000
              LCLC  &XRSNCODE   ++ NAME                                 20700000
              LCLC  &XCOM       ++ VALUE                                20750000
              LCLA  &XPLISTVER  ++ VALUE                                20775000
              LCLC  &XMF        ++ VALUE                                20800000
              LCLC  &XMFCTRL    ++ NAME                                 20850000
              LCLC  &XMFATTR    ++ VALUE                                20900000
              LCLC  &XMFSCK     ++ VALUE                                20950000
.*******************************************************************    21000000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           21050000
.*******************************************************************    21100000
              LCLC  &ZXBUFFADDR                 ++ INPUT NAME           21150000
              LCLC  &ZXBUFFALET                 ++ INPUT NAME           21200000
              LCLC  &ZXBUFFLEN  ++ INPUT NAME                           21250000
              LCLC  &ZXTOKEN    ++ INPUT NAME                           21300000
              LCLC  &ZXTBWCADDR                 ++ INPUT NAME           21350000
              LCLC  &ZXTBWCALET                 ++ INPUT NAME           21400000
              LCLC  &ZXSYNCH    ++ INPUT VALUE                          21425000
              LCLC  &ZXRC       ++ OUTPUT NAME                          21450000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          21500000
              LCLC  &ZXCOM      ++ INPUT VALUE                          21550000
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          21575000
              LCLC  &ZXMF       ++ INPUT VALUE                          21600000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           21650000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          21700000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          21750000
.********************************************************************   21750800
.***AC.PLV01  PROCESS PLISTVER                                      *   21751600
.********************************************************************   21752400
&XPLISTVER      SETA  0                                                 21753200
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       21754000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   21754800
&XPLISTVER      SETA  0                                                 21755600
.ZPLV0          ANOP  ,                                                 21756400
.*                                                                      21757200
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      21758000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      21758800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  21759600
.*-------------------------------------------------------------------   21760400
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 21761200
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                21762000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 21762800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 21763600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               21764400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21765200
                AGO   .ZPVCK2                                           21766000
.ZPVCK3         ANOP  ,                                                 21766800
.*-------------------------------------------------------------------   21767600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  21768400
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                21769200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 21770000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         21770800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 21771600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21772400
                AGO   .ZPVCKE                                           21773200
.ZPVCK2         ANOP  ,                                                 21774000
.*-------------------------------------------------------------------   21774800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        21775600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        21776400
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                21777200
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               21778000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          21778800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 21779600
                MNOTE 8,' &ZMS IS REQUIRED.'                            21780400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21781200
                AGO   .ZPVCK5                                           21782000
.ZPVCK4         ANOP  ,                                                 21782800
&XPLISTVER      SETA  &PLISTVER(1)                                      21783600
.ZPVCK5         ANOP  ,                                                 21784400
.*-------------------------------------------------------------------   21785200
&ZCVAL          SETC  '&PLISTVER(1)'                                    21786000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             21786800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             21787600
                AIF   (&XPLISTVER LT 0).ZPVCK6  TOO LOW                 21788400
                AIF   (&XPLISTVER LE 0).ZPVCKE  NOT HIGH                21789200
.ZPVCK6         ANOP   ,                                                21790000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                21790800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 21791600
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         21792400
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         21793200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                21794000
.ZPVCKE         ANOP   ,                                                21794800
.********************************************************************   21800000
.***AG.MF01 PROCESS MF MACRO FORMS                                      21850000
.********************************************************************   21900000
              ACTR  10000                                               21950000
.*------------------------------------------------------------------    22000000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           22050000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    22100000
.*-------------------------------------------------------------------   22150000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           22200000
.ZG38         ANOP  ,                                                   22241600
&ZTLC         SETC 'S'                                                  22283300
              AIF   ('&MF(1)' NE '&ZTLC').ZG39                          22316600
&XMF          SETC  'S'         SET KEYWORD                             22350000
              AIF   (N'&MF LE 1).ZG38A          CK NUM                  22400000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           22450000
&ZMS          SETC  '&ZMS.&MF"'                                         22500000
&ZMS          SETC  '&ZMS "MF"'                                         22550000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 22600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22650000
.ZG38A        ANOP  ,                                                   22700000
.*-------------------------------------------------------------------   22750000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           22800000
.ZG39         ANOP  ,                                                   22841600
&ZTLC         SETC 'L'                                                  22883300
              AIF   ('&MF(1)' NE '&ZTLC').ZG46                          22916600
&XMF          SETC  'L'         SET KEYWORD                             22950000
              AIF   (N'&MF LE 3).ZG39A          CK NUM                  23000000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           23050000
&ZMS          SETC  '&ZMS.&MF"'                                         23100000
&ZMS          SETC  '&ZMS "MF"'                                         23150000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                23200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23250000
.ZG39A        ANOP  ,                                                   23300000
.*-------------------------------------------------------------------   23350000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     23400000
              AIF   (N'&SYSLIST NE 0).ZG39B     POSITIONALS?            23447200
              AIF   ('&BUFFADDR' NE '').ZG39B   KEYS?                   23494400
              AIF   ('&BUFFALET' NE '').ZG39B   KEYS?                   23541600
              AIF   ('&BUFFLEN' NE '').ZG39B    KEYS?                   23588800
              AIF   ('&TOKEN' NE '').ZG39B      KEYS?                   23636000
              AIF   ('&TBWCADDR' NE '').ZG39B   KEYS?                   23683200
              AIF   ('&TBWCALET' NE '').ZG39B   KEYS?                   23730400
              AIF   ('&SYNCH' NE '').ZG39B      KEYS?                   23777600
              AIF   ('&RC' NE '').ZG39B         KEYS?                   23824800
              AIF   ('&RSNCODE' NE '').ZG39B    KEYS?                   23872000
              AIF   ('&COM' NE '').ZG39B        KEYS?                   23919200
              AGO    .ZG39C     INVOCATION OKAY                         23966400
.ZG39B        ANOP  ,                                                   24013600
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            24060800
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                24108000
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           24155200
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              24202400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24250000
.ZG39C        ANOP  ,                                                   24300000
.*-------------------------------------------------------------------   24350000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   24400000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           24450000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           24500000
              AIF   (N'&MF(2) GT 1).ZG41B       MULTI PARMS             24550000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           24600000
.ZG41B        AIF   (K'&MF(2) GT 0).ZG41C                               24650000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         24700000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 24750000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 24800000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        24850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24900000
.ZG41C        ANOP  ,                                                   24950000
.*-------------------------------------------------------------------   25000000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               25050000
              AIF   (K'&ZXMFCTRL LE 0).ZG41P    NOT I/O                 25100000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG41P                      25150000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         25200000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           25250000
&ZMS          SETC  '&ZMS.&MF"'                                         25300000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           25350000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   25400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25450000
.ZG41P        ANOP  ,                                                   25500000
.*-------------------------------------------------------------------   25550000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      25600000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           25650000
&XMFATTR      SETC  '0D'                                                25700000
              AIF   (K'&MF(3) LE 0).ZG44B       PARM                    25750000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           25800000
              AIF   (N'&MF(3) GT 1).ZG44B       MULTI PARMS             25850000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           25900000
.ZG44B        ANOP  ,                                                   25950000
.*-------------------------------------------------------------------   26000000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  26050000
              AIF   (K'&ZXMFATTR LE 0).ZG44P    NOT I/O                 26100000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG44P                      26150000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         26200000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           26250000
&ZMS          SETC  '&ZMS.&MF"'                                         26300000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           26350000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   26400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26450000
.ZG44P        ANOP  ,                                                   26500000
.*-------------------------------------------------------------------   26550000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 26600000
              AIF   (K'&ZXMFATTR LE 0).ZG44S    NOT I/O                 26650000
              AIF   (K'&XMFATTR LE 60).ZG44S    LNG OK                  26700000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         26750000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           26800000
&ZMS          SETC  '&ZMS.&MF"'                                         26850000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               26900000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  26950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27000000
.ZG44S        ANOP  ,                                                   27050000
.*-------------------------------------------------------------------   27100000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           27150000
.ZG46         ANOP  ,                                                   27191600
&ZTLC         SETC 'E'                                                  27233300
              AIF   ('&MF(1)' NE '&ZTLC').ZG54                          27266600
&XMF          SETC  'E'         SET KEYWORD                             27300000
              AIF   (N'&MF LE 3).ZG46A          CK NUM                  27350000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           27400000
&ZMS          SETC  '&ZMS.&MF"'                                         27450000
&ZMS          SETC  '&ZMS "MF"'                                         27500000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                27550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27600000
.ZG46A        ANOP  ,                                                   27650000
.*-------------------------------------------------------------------   27700000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   27750000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           27800000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           27850000
              AIF   (N'&MF(2) GT 1).ZG48B       MULTI PARMS             27900000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           27950000
.ZG48B        AIF   (K'&MF(2) GT 0).ZG48C                               28000000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         28050000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 28100000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 28150000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        28200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28250000
.ZG48C        ANOP  ,                                                   28300000
.*-------------------------------------------------------------------   28350000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              28400000
              AIF   (K'&ZXMFCTRL LE 0).ZG48R    NOT I/O                 28450000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG48R                      28500000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          28550000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG48P                        28600000
              AIF   (K'&ZCGPR GT 2).ZG48Q                               28650000
              AIF   ('&ZCGPR' EQ '0').ZG48Q                             28700000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       28750000
              AIF   (T'&ZCGPR NE 'N').ZG48Q     INVALID REG NAME        28800000
.ZG48P        ANOP  ,                                                   28850000
              AIF   (T'&ZCGPR NE 'N').ZG48R     NON NUMERIC             28900000
              AIF   ('&ZCGPR' LT '1').ZG48Q                             28950000
              AIF   ('&ZCGPR' LE '12').ZG48R                            29000000
.ZG48Q        ANOP  ,                                                   29050000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           29100000
&ZMS          SETC  '&ZMS.&MF"'                                         29150000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           29200000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    29250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             29300000
.ZG48R        ANOP  ,                                                   29350000
.*-------------------------------------------------------------------   29400000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             29450000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    29500000
.ZG52A   AIF   ('&MF(3)' NE 'COMPLETE').ZG53A                           29550000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             29600000
.*-------------------------------------------------------------------   29650000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             29700000
.ZG53A        AIF   (K'&XMFSCK GT 0).ZG53C      KEYWORD                 29750000
              AIF   (K'&MF(3) LE 0).ZG53B                               29800000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           29850000
&ZMS          SETC  '&ZMS.&MF"'                                         29900000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           29950000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 30000000
&ZMS          SETC  '&ZMS "COMPLETE".'          VALID KEYWORD           30033300
              MNOTE 8,' &ZMS '                                          30066600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30100000
.ZG53B        ANOP  ,                                                   30150000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     30200000
.ZG53C        ANOP  ,                                                   30250000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           30300000
.*------------------------------------------------------------------    30350000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           30400000
.ZG54         ANOP  ,                                                   30450000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           30500000
              AIF   (K'&XMF GT 0).ZG54E         VALID ARG               30550000
              AIF   (T'&MF EQ 'O').ZG54D        OMITTED                 30600000
&ZASYSLNDX    SETA  0                                                   30650000
.ZG54A        ANOP  ,           POSITIONAL MACRO KEY                    30700000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        30750000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG54C                    30791600
&ZTLC         SETC 'MF'                                                 30833300
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG54A           30872200
.ZG54B        ANOP  ,                                                   30911100
&ZXMF         SETC  ''          RESET IN/OUTPUT                         30950000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           31000000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             31050000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    31100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             31150000
              AGO   .ZG54E                                              31200000
.ZG54C        ANOP  ,                                                   31250000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         31300000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           31350000
&ZMS          SETC  '&ZMS.&MF"'                                         31400000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           31450000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 31500000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           31550000
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           31600000
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           31633300
              MNOTE 8,' &ZMS '                                          31666600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             31700000
              AGO   .ZG54E                                              31750000
.ZG54D        ANOP  ,                                                   31800000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     31850000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       31900000
.ZG54E        ANOP  ,                                                   31950000
.********************************************************************   32000000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 32050000
.********************************************************************   32100000
              ACTR  10000                                               32150000
.*-------------------------------------------------------------------   32200000
.***AG.MF03 MF=(SLE)                                                    32250000
              AIF   ('&XMF' EQ 'L').ZGMFX                               32300000
.*----------------------------------------------------------------***   32350000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     32400000
              AIF   (N'&BUFFADDR LE 1).ZG2A     CK NUM                  32450000
&ZMS          SETC  '"BUFFADDR='                *KPOSA* MNOTE           32500000
&ZMS          SETC  '&ZMS.&BUFFADDR"'                                   32550000
&ZMS          SETC  '&ZMS "BUFFADDR"'                                   32600000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 32650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             32700000
.ZG2A         ANOP  ,                                                   32750000
.*-------------------------------------------------------------------   32800000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         32850000
&ZXBUFFADDR   SETC  'INPUT'     SET IN/OUTPUT                           32900000
&XBUFFADDR    SETC  '&BUFFADDR(1)'              SET XVARIABLE           32950000
              AIF   (N'&BUFFADDR GT 1).ZG2B     MULTI PARMS             33000000
&XBUFFADDR    SETC  '&BUFFADDR'                 SET XVARIABLE           33050000
.ZG2B         AIF   (K'&BUFFADDR(1) GT 0).ZG2C                          33100000
&ZXBUFFADDR   SETC  ''          RESET IN/OUTPUT                         33150000
&ZMS          SETC  ' '         *KRQDA*                                 33200000
&ZMS          SETC  '&ZMS "BUFFADDR" KEY AND ITS ARGUMENT'              33250000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             33300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33350000
.ZG2C         ANOP  ,                                                   33400000
.*-------------------------------------------------------------------   33450000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    33500000
              AIF   (K'&ZXBUFFADDR LE 0).ZG2R   NOT I/O                 33550000
              AIF   ('&XBUFFADDR'(1,1) NE '(').ZG2R                     33600000
&ZCGPR        SETC  '&XBUFFADDR'(2,K'&XBUFFADDR-2)                      33650000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         33700000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                33750000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              33800000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       33850000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        33900000
.ZG2P         ANOP  ,                                                   33950000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             34000000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              34050000
              AIF   ('&ZCGPR' LE '12').ZG2R                             34100000
.ZG2Q         ANOP  ,                                                   34150000
&ZMS          SETC  '"BUFFADDR='                *KGPRA* MNOTE           34200000
&ZMS          SETC  '&ZMS.&BUFFADDR"'                                   34250000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           34300000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    34350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34400000
.ZG2R         ANOP  ,                                                   34450000
.*----------------------------------------------------------------***   34500000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     34550000
              AIF   (N'&BUFFALET LE 1).ZG4A     CK NUM                  34600000
&ZMS          SETC  '"BUFFALET='                *KPOSA* MNOTE           34650000
&ZMS          SETC  '&ZMS.&BUFFALET"'                                   34700000
&ZMS          SETC  '&ZMS "BUFFALET"'                                   34750000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 34800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34850000
.ZG4A         ANOP  ,                                                   34900000
.*-------------------------------------------------------------------   34950000
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         35000000
&XBUFFALET    SETC  'NOBUFFALET'                SET DEFAULT             35050000
              AIF   (K'&BUFFALET(1) LE 0).ZG4C  PARM                    35100000
&XBUFFALET    SETC  '&BUFFALET(1)'              SET XVARIABLE           35150000
              AIF   (N'&BUFFALET GT 1).ZG4B     MULTI PARMS             35200000
&XBUFFALET    SETC  '&BUFFALET'                 SET XVARIABLE           35250000
.ZG4B         AIF   (K'&BUFFADDR(1) GT 0).ZG4C  KEY                     35300000
&ZMS          SETC  '"BUFFALET'                 *KDEPA* MNOTE           35350000
&ZMS          SETC  '&ZMS.=&BUFFALET"'                                  35400000
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     35450000
&ZMS          SETC  '&ZMS '                                             35500000
&ZMS          SETC  '&ZMS "BUFFADDR"'                                   35550000
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        35600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             35650000
.ZG4C         ANOP  ,                                                   35700000
&ZXBUFFALET   SETC  'INPUT'     SET IN/OUTPUT                           35750000
.*-------------------------------------------------------------------   35800000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    35850000
              AIF   (K'&ZXBUFFALET LE 0).ZG4R   NOT I/O                 35900000
              AIF   ('&XBUFFALET' EQ 'NOBUFFALET').ZG4R                 35950000
              AIF   ('&XBUFFALET'(1,1) NE '(').ZG4R                     36000000
&ZCGPR        SETC  '&XBUFFALET'(2,K'&XBUFFALET-2)                      36050000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         36100000
              AIF   (K'&ZCGPR GT 2).ZG4Q                                36150000
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              36200000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       36250000
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        36300000
.ZG4P         ANOP  ,                                                   36350000
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             36400000
              AIF   ('&ZCGPR' LT '2').ZG4Q                              36450000
              AIF   ('&ZCGPR' LE '12').ZG4R                             36500000
.ZG4Q         ANOP  ,                                                   36550000
&ZMS          SETC  '"BUFFALET='                *KGPRA* MNOTE           36600000
&ZMS          SETC  '&ZMS.&BUFFALET"'                                   36650000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           36700000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    36750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36800000
.ZG4R         ANOP  ,                                                   36850000
.*----------------------------------------------------------------***   36900000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     36950000
              AIF   (N'&BUFFLEN LE 1).ZG8A      CK NUM                  37000000
&ZMS          SETC  '"BUFFLEN='                 *KPOSA* MNOTE           37050000
&ZMS          SETC  '&ZMS.&BUFFLEN"'                                    37100000
&ZMS          SETC  '&ZMS "BUFFLEN"'                                    37150000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 37200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37250000
.ZG8A         ANOP  ,                                                   37300000
.*-------------------------------------------------------------------   37350000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         37400000
&ZXBUFFLEN    SETC  'INPUT'     SET IN/OUTPUT                           37450000
&XBUFFLEN     SETC  '&BUFFLEN(1)'               SET XVARIABLE           37500000
              AIF   (N'&BUFFLEN GT 1).ZG8B      MULTI PARMS             37550000
&XBUFFLEN     SETC  '&BUFFLEN'  SET XVARIABLE                           37600000
.ZG8B         AIF   (K'&BUFFLEN(1) GT 0).ZG8C                           37650000
&ZXBUFFLEN    SETC  ''          RESET IN/OUTPUT                         37700000
&ZMS          SETC  ' '         *KRQDA*                                 37750000
&ZMS          SETC  '&ZMS "BUFFLEN" KEY AND ITS ARGUMENT'               37800000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             37850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37900000
.ZG8C         ANOP  ,                                                   37950000
.*-------------------------------------------------------------------   38000000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    38050000
              AIF   (K'&ZXBUFFLEN LE 0).ZG8R    NOT I/O                 38100000
              AIF   ('&XBUFFLEN'(1,1) NE '(').ZG8R                      38150000
&ZCGPR        SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                        38200000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         38250000
              AIF   (K'&ZCGPR GT 2).ZG8Q                                38300000
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              38350000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       38400000
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        38450000
.ZG8P         ANOP  ,                                                   38500000
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             38550000
              AIF   ('&ZCGPR' LT '2').ZG8Q                              38600000
              AIF   ('&ZCGPR' LE '12').ZG8R                             38650000
.ZG8Q         ANOP  ,                                                   38700000
&ZMS          SETC  '"BUFFLEN='                 *KGPRA* MNOTE           38750000
&ZMS          SETC  '&ZMS.&BUFFLEN"'                                    38800000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           38850000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    38900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             38950000
.ZG8R         ANOP  ,                                                   39000000
.*----------------------------------------------------------------***   39050000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     39100000
              AIF   (N'&TOKEN LE 1).ZG11A       CK NUM                  39150000
&ZMS          SETC  '"TOKEN='   *KPOSA* MNOTE                           39200000
&ZMS          SETC  '&ZMS.&TOKEN"'                                      39250000
&ZMS          SETC  '&ZMS "TOKEN"'                                      39300000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 39350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39400000
.ZG11A        ANOP  ,                                                   39450000
.*-------------------------------------------------------------------   39500000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         39550000
&ZXTOKEN      SETC  'INPUT'     SET IN/OUTPUT                           39600000
&XTOKEN       SETC  '&TOKEN(1)'                 SET XVARIABLE           39650000
              AIF   (N'&TOKEN GT 1).ZG11B       MULTI PARMS             39700000
&XTOKEN       SETC  '&TOKEN'    SET XVARIABLE                           39750000
.ZG11B        AIF   (K'&TOKEN(1) GT 0).ZG11C                            39800000
&ZXTOKEN      SETC  ''          RESET IN/OUTPUT                         39850000
&ZMS          SETC  ' '         *KRQDA*                                 39900000
&ZMS          SETC  '&ZMS "TOKEN" KEY AND ITS ARGUMENT'                 39950000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             40000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40050000
.ZG11C        ANOP  ,                                                   40100000
.*-------------------------------------------------------------------   40150000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    40200000
              AIF   (K'&ZXTOKEN LE 0).ZG11R     NOT I/O                 40250000
              AIF   ('&XTOKEN'(1,1) NE '(').ZG11R                       40300000
&ZCGPR        SETC  '&XTOKEN'(2,K'&XTOKEN-2)                            40350000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                        40400000
              AIF   (K'&ZCGPR GT 2).ZG11Q                               40450000
              AIF   ('&ZCGPR' EQ '0').ZG11Q                             40500000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       40550000
              AIF   (T'&ZCGPR NE 'N').ZG11Q     INVALID REG NAME        40600000
.ZG11P        ANOP  ,                                                   40650000
              AIF   (T'&ZCGPR NE 'N').ZG11R     NON NUMERIC             40700000
              AIF   ('&ZCGPR' LT '2').ZG11Q                             40750000
              AIF   ('&ZCGPR' LE '12').ZG11R                            40800000
.ZG11Q        ANOP  ,                                                   40850000
&ZMS          SETC  '"TOKEN='   *KGPRA* MNOTE                           40900000
&ZMS          SETC  '&ZMS.&TOKEN"'                                      40950000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           41000000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    41050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41100000
.ZG11R        ANOP  ,                                                   41150000
.*----------------------------------------------------------------***   41200000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     41250000
              AIF   (N'&TBWCADDR LE 1).ZG14A    CK NUM                  41300000
&ZMS          SETC  '"TBWCADDR='                *KPOSA* MNOTE           41350000
&ZMS          SETC  '&ZMS.&TBWCADDR"'                                   41400000
&ZMS          SETC  '&ZMS "TBWCADDR"'                                   41450000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 41500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41550000
.ZG14A        ANOP  ,                                                   41600000
.*-------------------------------------------------------------------   41650000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         41700000
&ZXTBWCADDR   SETC  'INPUT'     SET IN/OUTPUT                           41750000
&XTBWCADDR    SETC  '&TBWCADDR(1)'              SET XVARIABLE           41800000
              AIF   (N'&TBWCADDR GT 1).ZG14B    MULTI PARMS             41850000
&XTBWCADDR    SETC  '&TBWCADDR'                 SET XVARIABLE           41900000
.ZG14B        AIF   (K'&TBWCADDR(1) GT 0).ZG14C                         41950000
&ZXTBWCADDR   SETC  ''          RESET IN/OUTPUT                         42000000
&ZMS          SETC  ' '         *KRQDA*                                 42050000
&ZMS          SETC  '&ZMS "TBWCADDR" KEY AND ITS ARGUMENT'              42100000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             42150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             42200000
.ZG14C        ANOP  ,                                                   42250000
.*-------------------------------------------------------------------   42300000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    42350000
              AIF   (K'&ZXTBWCADDR LE 0).ZG14R  NOT I/O                 42400000
              AIF   ('&XTBWCADDR'(1,1) NE '(').ZG14R                    42450000
&ZCGPR        SETC  '&XTBWCADDR'(2,K'&XTBWCADDR-2)                      42500000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                        42550000
              AIF   (K'&ZCGPR GT 2).ZG14Q                               42600000
              AIF   ('&ZCGPR' EQ '0').ZG14Q                             42650000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       42700000
              AIF   (T'&ZCGPR NE 'N').ZG14Q     INVALID REG NAME        42750000
.ZG14P        ANOP  ,                                                   42800000
              AIF   (T'&ZCGPR NE 'N').ZG14R     NON NUMERIC             42850000
              AIF   ('&ZCGPR' LT '2').ZG14Q                             42900000
              AIF   ('&ZCGPR' LE '12').ZG14R                            42950000
.ZG14Q        ANOP  ,                                                   43000000
&ZMS          SETC  '"TBWCADDR='                *KGPRA* MNOTE           43050000
&ZMS          SETC  '&ZMS.&TBWCADDR"'                                   43100000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           43150000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    43200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             43250000
.ZG14R        ANOP  ,                                                   43300000
.*----------------------------------------------------------------***   43350000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     43400000
              AIF   (N'&TBWCALET LE 1).ZG16A    CK NUM                  43450000
&ZMS          SETC  '"TBWCALET='                *KPOSA* MNOTE           43500000
&ZMS          SETC  '&ZMS.&TBWCALET"'                                   43550000
&ZMS          SETC  '&ZMS "TBWCALET"'                                   43600000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 43650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             43700000
.ZG16A        ANOP  ,                                                   43750000
.*-------------------------------------------------------------------   43800000
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         43850000
&XTBWCALET    SETC  'NOTBWCALET'                SET DEFAULT             43900000
              AIF   (K'&TBWCALET(1) LE 0).ZG16C  PARM                   43950000
&XTBWCALET    SETC  '&TBWCALET(1)'              SET XVARIABLE           44000000
              AIF   (N'&TBWCALET GT 1).ZG16B    MULTI PARMS             44050000
&XTBWCALET    SETC  '&TBWCALET'                 SET XVARIABLE           44100000
.ZG16B        AIF   (K'&TBWCADDR(1) GT 0).ZG16C  KEY                    44150000
&ZMS          SETC  '"TBWCALET'                 *KDEPA* MNOTE           44200000
&ZMS          SETC  '&ZMS.=&TBWCALET"'                                  44250000
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     44300000
&ZMS          SETC  '&ZMS '                                             44350000
&ZMS          SETC  '&ZMS "TBWCADDR"'                                   44400000
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        44450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44500000
.ZG16C        ANOP  ,                                                   44550000
&ZXTBWCALET   SETC  'INPUT'     SET IN/OUTPUT                           44600000
.*-------------------------------------------------------------------   44650000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    44700000
              AIF   (K'&ZXTBWCALET LE 0).ZG16R  NOT I/O                 44750000
              AIF   ('&XTBWCALET' EQ 'NOTBWCALET').ZG16R                44800000
              AIF   ('&XTBWCALET'(1,1) NE '(').ZG16R                    44850000
&ZCGPR        SETC  '&XTBWCALET'(2,K'&XTBWCALET-2)                      44900000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        44950000
              AIF   (K'&ZCGPR GT 2).ZG16Q                               45000000
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             45050000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       45100000
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        45150000
.ZG16P        ANOP  ,                                                   45200000
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             45250000
              AIF   ('&ZCGPR' LT '2').ZG16Q                             45300000
              AIF   ('&ZCGPR' LE '12').ZG16R                            45350000
.ZG16Q        ANOP  ,                                                   45400000
&ZMS          SETC  '"TBWCALET='                *KGPRA* MNOTE           45450000
&ZMS          SETC  '&ZMS.&TBWCALET"'                                   45500000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           45550000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    45600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45650000
.ZG16R        ANOP  ,                                                   45700000
.*----------------------------------------------------------------***   45750000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             45751000
              AIF   (N'&SYNCH LE 1).ZG19A       CK NUM                  45752000
&ZMS          SETC  '"SYNCH='   *KPOSA* MNOTE                           45753000
&ZMS          SETC  '&ZMS.&SYNCH"'                                      45754000
&ZMS          SETC  '&ZMS "SYNCH"'                                      45755000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 45756000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45757000
.ZG19A        ANOP  ,                                                   45758000
.*-------------------------------------------------------------------   45759000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             45760000
&XSYNCH       SETC  ''          INITIALIZE XVARIABLE                    45761000
.ZG20A   AIF   ('&SYNCH(1)' NE 'NO').ZG21A                              45762000
&XSYNCH       SETC  'NO'        SET KEYWORD                             45763000
.*-------------------------------------------------------------------   45764000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             45765000
.ZG21A   AIF   ('&SYNCH(1)' NE 'YES').ZG22A                             45766000
&XSYNCH       SETC  'YES'       SET KEYWORD                             45767000
.*-------------------------------------------------------------------   45768000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             45769000
.ZG22A        AIF   (K'&XSYNCH GT 0).ZG22C      KEYWORD                 45770000
              AIF   (K'&SYNCH(1) LE 0).ZG22B                            45771000
&ZMS          SETC  '"SYNCH='   *KUKWA* MNOTE                           45772000
&ZMS          SETC  '&ZMS.&SYNCH"'                                      45773000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           45774000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 45775000
&ZMS          SETC  '&ZMS "NO"'                 VALID KEYWORD           45776000
&ZMS          SETC  '&ZMS OR "YES".'            VALID KEYWORD           45777000
              MNOTE 8,' &ZMS '                                          45778000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45779000
.ZG22B        ANOP  ,                                                   45780000
&XSYNCH       SETC  'NO'        SET DEFAULT KEYWORD                     45781000
.ZG22C        ANOP  ,                                                   45782000
&ZXSYNCH      SETC  'INPUT'     SET IN/OUTPUT                           45783000
.*-------------------------------------------------------------------   45784000
.***AG.KKWRD06 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             45785000
              AIF   (K'&TBWCADDR(1) GT 0).ZG22D  KEY                    45786000
              AIF   (K'&SYNCH(1) LE 0).ZG22D    PARM                    45787000
&ZMS          SETC  '"SYNCH'    *KDEPA* MNOTE                           45788000
&ZMS          SETC  '&ZMS.=&SYNCH"'                                     45789000
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     45790000
&ZMS          SETC  '&ZMS '                                             45791000
&ZMS          SETC  '&ZMS "TBWCADDR"'                                   45792000
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        45793000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45794000
.ZG22D        ANOP  ,                                                   45795000
.*----------------------------------------------------------------***   45796000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    45800000
              AIF   (N'&RC LE 1).ZG25A          CK NUM                  45850000
&ZMS          SETC  '"RC='      *KPOSA* MNOTE                           45900000
&ZMS          SETC  '&ZMS.&RC"'                                         45950000
&ZMS          SETC  '&ZMS "RC"'                                         46000000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 46050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46100000
.ZG25A        ANOP  ,                                                   46150000
.*-------------------------------------------------------------------   46200000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        46250000
              AIF   (K'&RC(1) LE 0).ZG25C       NO PARM                 46300000
&ZXRC         SETC  'OUTPUT'    SET OUTPUT                              46350000
&XRC          SETC  '&RC(1)'    SET XVARIABLE                           46400000
              AIF   (N'&RC GT 1).ZG25C                                  46450000
&XRC          SETC  '&RC'       SET XVARIABLE                           46500000
.ZG25C        ANOP  ,                                                   46550000
.*-------------------------------------------------------------------   46600000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   46650000
              AIF   (K'&ZXRC LE 0).ZG25R        NOT I/O                 46700000
              AIF   ('&XRC'(1,1) NE '(').ZG25R                          46750000
&ZCGPR        SETC  '&XRC'(2,K'&XRC-2)                                  46800000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                        46850000
              AIF   (K'&ZCGPR GT 2).ZG25Q                               46900000
              AIF   ('&ZCGPR' EQ '0').ZG25Q                             46950000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       47000000
              AIF   (T'&ZCGPR NE 'N').ZG25Q     INVALID REG NAME        47050000
.ZG25P        ANOP  ,                                                   47100000
              AIF   (T'&ZCGPR NE 'N').ZG25R     NON NUMERIC             47150000
              AIF   ('&ZCGPR' LT '2').ZG25Q                             47200000
              AIF   ('&ZCGPR' LE '12').ZG25R                            47250000
.ZG25Q        ANOP  ,                                                   47300000
&ZMS          SETC  '"RC='      *KGPRA* MNOTE                           47350000
&ZMS          SETC  '&ZMS.&RC"'                                         47400000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           47450000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    47500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47550000
.ZG25R        ANOP  ,                                                   47600000
.*----------------------------------------------------------------***   47650000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    47700000
              AIF   (N'&RSNCODE LE 1).ZG28A     CK NUM                  47750000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           47800000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    47850000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    47900000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 47950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             48000000
.ZG28A        ANOP  ,                                                   48050000
.*-------------------------------------------------------------------   48100000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        48150000
              AIF   (K'&RSNCODE(1) LE 0).ZG28C  NO PARM                 48200000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              48250000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           48300000
              AIF   (N'&RSNCODE GT 1).ZG28C                             48350000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           48400000
.ZG28C        ANOP  ,                                                   48450000
.*-------------------------------------------------------------------   48500000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   48550000
              AIF   (K'&ZXRSNCODE LE 0).ZG28R   NOT I/O                 48600000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG28R                     48650000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        48700000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                        48750000
              AIF   (K'&ZCGPR GT 2).ZG28Q                               48800000
              AIF   ('&ZCGPR' EQ '0').ZG28Q                             48850000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       48900000
              AIF   (T'&ZCGPR NE 'N').ZG28Q     INVALID REG NAME        48950000
.ZG28P        ANOP  ,                                                   49000000
              AIF   (T'&ZCGPR NE 'N').ZG28R     NON NUMERIC             49050000
              AIF   ('&ZCGPR' LT '2').ZG28Q                             49100000
              AIF   ('&ZCGPR' LE '12').ZG28R                            49150000
.ZG28Q        ANOP  ,                                                   49200000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           49250000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    49300000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           49350000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    49400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49450000
.ZG28R        ANOP  ,                                                   49500000
.*----------------------------------------------------------------***   49550000
.***AG.KXVAR05 VALUE, OPT INPUT, KEYS -XVARIABLE KEY                    49600000
              AIF   (N'&COM LE 1).ZG31A         CK NUM                  49650000
&ZMS          SETC  '"COM='     *KPOSA* MNOTE                           49700000
&ZMS          SETC  '&ZMS.&COM"'                                        49750000
&ZMS          SETC  '&ZMS "COM"'                                        49800000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 49850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49900000
.ZG31A        ANOP  ,                                                   49950000
.*-------------------------------------------------------------------   50000000
.***AG.KXVAR13 VALUE, OPT INPUT, KEYS -XVARIABLE                        50050000
&ZXCOM        SETC  'INPUT'     SET IN/OUTPUT                           50100000
&XCOM         SETC  'NULL'                                              50150000
              AIF   (K'&COM(1) LE 0).ZG31B      PARM                    50200000
&XCOM         SETC  '&COM(1)'   SET XVARIABLE                           50250000
              AIF   (N'&COM GT 1).ZG31B         MULTI PARMS             50300000
&XCOM         SETC  '&COM'      SET XVARIABLE                           50350000
.ZG31B        ANOP  ,                                                   50400000
.*-------------------------------------------------------------------   50450000
.***AG.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    50500000
              AIF   (K'&ZXCOM LE 0).ZG31P       NOT I/O                 50550000
              AIF   ('&XCOM' EQ 'NULL').ZG31P                           50600000
              AIF   ('&XCOM'(1,1) NE '(').ZG31P                         50650000
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         50700000
&ZMS          SETC  '"COM='     *KGPRA* MNOTE                           50750000
&ZMS          SETC  '&ZMS.&COM"'                                        50800000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           50850000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   50900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50950000
.ZG31P        ANOP  ,                                                   51000000
.*-------------------------------------------------------------------   51050000
.***AG.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   51100000
              AIF   (K'&ZXCOM LE 0).ZG31S       NOT I/O                 51150000
              AIF   ('&XCOM' EQ 'NULL').ZG31S                           51200000
              AIF   (K'&XCOM LE 256).ZG31S      LNG OK                  51250000
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         51300000
&ZMS          SETC  '"COM='     *KLNGA* MNOTE                           51350000
&ZMS          SETC  '&ZMS.&COM"'                                        51400000
&ZMS          SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'               51450000
              MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'                 51500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51550000
.ZG31S        ANOP  ,                                                   51600000
.******************************************************************     51650000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        51700000
.******************************************************************     51750000
              ACTR  10000                                               51800000
.*----------------------------------------------------------------***   51850000
.***AH.P02 EXTRA POSITIONALS                                            51900000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               51950000
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                51960000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            51970000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             51980000
.ZGLISTX1     ANOP  ,                                                   51990000
&ZCVAL        SETC  ''          ERROR FIELD                             52000000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       52050000
.ZGLIST2      ANOP  ,                                                   52100000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         52150000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                52200000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   52250000
              AGO   .ZGLIST2                                            52300000
.*                                                                      52350000
.ZGLIST3      ANOP  ,                                                   52400000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             52450000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           52500000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     52550000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              52600000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      52650000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              52700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             52750000
.ZGLISTX      ANOP  ,                                                   52800000
&ZASYSLNDX    SETA  0                                                   52850000
.*-------------------------------------------------------------------   52900000
.***AG.MF04 MF=(SLE)                                                    52950000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                53000000
.*******************************************************************    53050000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       53100000
.*******************************************************************    53150000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          53200000
.*******************************************************************    53250000
.***AE.01  START OF CTRACEWR MACRO CODE                                 53300000
.*******************************************************************    53350000
              LCLC  &M0M0001                 NAME                       53400000
&M0M0001      SETC  '&XLABEL'                SET NAME                   53450000
              AIF   (K'&XLABEL NE 0).XLAB2                              53500000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               53550000
.*                                                                      53600000
.XLAB2        ANOP  ,                                                   53650000
&M0M0001 DS    0H                             CTRACEWR-0                53700000
.*******************************************************************    53750000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              53800000
.*******************************************************************    53850000
              PUSH  PRINT                                               53900000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          53950000
              PRINT OFF         ++ PR01                                 54000000
              AGO   .ZPRNTXX                                            54050000
.ZPRINTX      PRINT ON                                                  54100000
.ZPRNTXX      ANOP  ,                                                   54150000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  54200000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  54250000
.********************************************************************   54300000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     54350000
.********************************************************************   54400000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       54450000
                      LCLA  &ZOPN1         INVOCATION INDEX             54500000
                      LCLC  &ZOPL(4095)    LABEL                        54550000
                      LCLC  &ZOPO(4095)    OPERATION                    54600000
                      LCLC  &ZOPV(4095)    VALUE                        54650000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  54700000
.*                                                                      54750000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     54800000
.******************************************************************     54850000
.***AL.L10 CTRACEWR FMT=LIST MF=S|L PARAMETERS                          54900000
.******************************************************************     54950000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     55000000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     55050000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     55100000
&XMFATTR              SETC  '0D'                                        55150000
.*                                                                      55200000
&ZOPN                 SETA  &ZOPN+1                                     55250000
&ZOPL(&ZOPN)          SETC  ' '                                         55300000
&ZOPO(&ZOPN)          SETC  'B'                                         55350000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                55400000
&ZOPD(&ZOPN)          SETC  '++ CTRACEWR ARG PARMS'                     55450000
.*                                                                      55500000
&ZOPN                 SETA  &ZOPN+1                                     55550000
&ZOPL(&ZOPN)          SETC  ' '                                         55600000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     55650000
&ZOPV(&ZOPN)          SETC  '1'                                         55700000
&ZOPD(&ZOPN)          SETC  ' '                                         55750000
.*                                                                      55800000
.ZLMFSL2              ANOP  ,                                           55850000
.*-------------------------------------------------------------------   55900000
.***AM.L01  CTRACEWR FMT=LIST PARAMETERS                                55950000
&ZOPN                 SETA &ZOPN+1                                      56000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   56050000
&ZOPO(&ZOPN)          SETC 'DS'                                         56100000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   56150000
&ZOPD(&ZOPN)          SETC '++ CTRACEWR PARM LIST'                      56200000
.*-------------------------------------------------------------------   56250000
.***AM.L02 XVERSION XL1                                                 56300000
&ZOPN                 SETA &ZOPN+1                                      56350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         56400000
&ZOPO(&ZOPN)          SETC 'DS'                                         56450000
&ZOPV(&ZOPN)          SETC 'XL1'                                        56500000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          56550000
.*-------------------------------------------------------------------   56600000
.***AM.L03 XFLAGS BL.8                                                  56605800
&ZOPN                 SETA &ZOPN+1                                      56611600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           56617400
&ZOPO(&ZOPN)          SETC 'DS'                                         56623200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       56629000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             56634800
.*                                                                      56640600
&ZOPN                 SETA  &ZOPN+1                                     56646400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSYNCH_YES'                      56652200
&ZOPO(&ZOPN)          SETC  'EQU'                                       56658000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             56663800
&ZOPD(&ZOPN)          SETC  '++ XSYNCH.'                                56669600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          56675400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      56681200
.*-------------------------------------------------------------------   56687000
.***AM.L09  XRSV0000 CL2                                                56692800
&ZOPN                 SETA &ZOPN+1                                      56700000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0000'                         56750000
&ZOPO(&ZOPN)          SETC 'DS'                                         56800000
&ZOPV(&ZOPN)          SETC 'CL2'                                        56850000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0000'                      56900000
.*-------------------------------------------------------------------   56950000
.***AM.L09  XBUFFADDR A                                                 57000000
&ZOPN                 SETA &ZOPN+1                                      57050000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFADDR'                        57100000
&ZOPO(&ZOPN)          SETC 'DS'                                         57150000
&ZOPV(&ZOPN)          SETC 'A'                                          57200000
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFADDR  XBUFFADDR'                  57250000
.*-------------------------------------------------------------------   57300000
.***AM.L09  XBUFFALET CL4                                               57350000
&ZOPN                 SETA &ZOPN+1                                      57400000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFALET'                        57450000
&ZOPO(&ZOPN)          SETC 'DS'                                         57500000
&ZOPV(&ZOPN)          SETC 'CL4'                                        57550000
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFALET  XBUFFALET'                  57600000
.*-------------------------------------------------------------------   57650000
.***AM.L09  XBUFFLEN F                                                  57700000
&ZOPN                 SETA &ZOPN+1                                      57750000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFLEN'                         57800000
&ZOPO(&ZOPN)          SETC 'DS'                                         57850000
&ZOPV(&ZOPN)          SETC 'F'                                          57900000
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFLEN  XBUFFLEN'                    57950000
.*-------------------------------------------------------------------   58000000
.***AM.L09  XTOKEN CL8                                                  58050000
&ZOPN                 SETA &ZOPN+1                                      58100000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTOKEN'                           58150000
&ZOPO(&ZOPN)          SETC 'DS'                                         58200000
&ZOPV(&ZOPN)          SETC 'CL8'                                        58250000
&ZOPD(&ZOPN)          SETC '++ &ZXTOKEN  XTOKEN'                        58300000
.*-------------------------------------------------------------------   58350000
.***AM.L09  XTBWCADDR A                                                 58400000
&ZOPN                 SETA &ZOPN+1                                      58450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTBWCADDR'                        58500000
&ZOPO(&ZOPN)          SETC 'DS'                                         58550000
&ZOPV(&ZOPN)          SETC 'A'                                          58600000
&ZOPD(&ZOPN)          SETC '++ &ZXTBWCADDR  XTBWCADDR'                  58650000
.*-------------------------------------------------------------------   58700000
.***AM.L09  XTBWCALET CL4                                               58750000
&ZOPN                 SETA &ZOPN+1                                      58800000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTBWCALET'                        58850000
&ZOPO(&ZOPN)          SETC 'DS'                                         58900000
&ZOPV(&ZOPN)          SETC 'CL4'                                        58950000
&ZOPD(&ZOPN)          SETC '++ &ZXTBWCALET  XTBWCALET'                  59000000
.*-------------------------------------------------------------------   59050000
.***AM.L09  XRSV0001 CL8                                                59100000
&ZOPN                 SETA &ZOPN+1                                      59150000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         59200000
&ZOPO(&ZOPN)          SETC 'DS'                                         59250000
&ZOPV(&ZOPN)          SETC 'CL8'                                        59300000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      59350000
.*-------------------------------------------------------------------   59400000
.***AM.L10 END OF CTRACEWR LIST PARAMETERS                              59450000
&ZOPN                 SETA &ZOPN+1                                      59500000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 59550000
&ZOPO(&ZOPN)          SETC 'EQU'                                        59600000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 59650000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         59700000
.*                                                                      59750000
&ZOPN                 SETA &ZOPN+1                                      59800000
&ZOPL(&ZOPN)          SETC ' '                                          59850000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      59900000
&ZOPV(&ZOPN)          SETC '1'                                          59950000
&ZOPD(&ZOPN)          SETC ' '                                          60000000
.*-------------------------------------------------------------------   60050000
.***AL.L12 CTRACEWR FMT=LIST MF=S|L PARAMETERS                          60100000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         60150000
.*                                                                      60200000
&ZOPN                 SETA  &ZOPN+1                                     60250000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                60300000
&ZOPO(&ZOPN)          SETC  'DC'                                        60350000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   60400000
&ZOPD(&ZOPN)          SETC  '++ CTRACEWR ARG PARMS'                     60450000
.*                                                                      60500000
.ZLMFSLX              ANOP  ,                                           60550000
.*-------------------------------------------------------------------   60600000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          60650000
&ZPLLEN               SETA 40                                           60700000
.*                                                                      60750000
.******************************************************************     60800000
.***AI.L01 CTRACEWR FMT=LIST FILL IN PARAMETER AREA                     60850000
.******************************************************************     60900000
                      ACTR  10000                                       60950000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               61000000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    61050000
&ZCVAL                SETC  'LAE'          XAX MODE                     61100000
.ZIMFXA               ANOP ,                                            61150000
.*                                                                      61200000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    61250000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         61300000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 61350000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                61400000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 61450000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                61500000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   61550000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    61600000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   61650000
&ZOPN                 SETA  &ZOPN+1                                     61700000
&ZOPL(&ZOPN)          SETC  ' '                                         61750000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    61800000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              61850000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       61900000
                      AGO   .ZIMFNX                                     61950000
.*                                                                      62000000
.ZIMFN2               ANOP ,                                            62050000
&ZOPN                 SETA  &ZOPN+1                                     62100000
&ZOPL(&ZOPN)          SETC  ' '                                         62150000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    62200000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                62250000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       62300000
.ZIMFNX               ANOP ,                                            62350000
.********************************************************************   62400000
.***AI.L02 CTRACEWR FMT=LIST INITIALIZE PARAMETER AREA                  62450000
.********************************************************************   62500000
.***AI.L03 MF=(SLE)                                                     62550000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      62600000
.*                                                                      62650000
&ZOPN                 SETA  &ZOPN+1                                     62700000
&ZOPL(&ZOPN)          SETC  ' '                                         62750000
&ZOPO(&ZOPN)          SETC  'XC'                                        62800000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         62850000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             62900000
.ZIMFLX               ANOP  ,                                           62950000
.*-------------------------------------------------------------------   63000000
.***AI.L05 XFLAGS BL1                                                   63022700
&ZW                   SETC  ''                                          63045400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            63068100
.*-------------------------------------------------------------------   63090800
.***AI.L08 XFLAGS "YES"                                                 63113500
.***      BL1'1XXXXXXX'                                                 63136200
         AIF   ('&XSYNCH' NE 'YES').ZI3A                                63158900
&ZW                   SETC  '&ZW.10000000'                              63181600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              63204300
                      AGO   .ZI3C                                       63227000
.*                                                                      63250000
.ZI3A                 ANOP  ,                                           63300000
&ZW                   SETC  '&ZW.00000000'                              63350000
.ZI3C                 ANOP  ,                                           63400000
.*-------------------------------------------------------------------   63450000
.***AI.L11 XFLAGS BL1                                                   63500000
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     63550000
&ZOPN                 SETA  &ZOPN+1                                     63850000
&ZOPL(&ZOPN)          SETC  ' '                                         63900000
&ZOPO(&ZOPN)          SETC  'OI'                                        63950000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             64000000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              64050000
.ZI3E                 ANOP  ,                                           64150000
.*-------------------------------------------------------------------   64200000
.***AI.L25  XBUFFADDR AL4                                               64250000
                      AIF   ('&ZXBUFFADDR' EQ '').ZI5E                  64300000
                      AIF   ('&ZXBUFFADDR' EQ 'OUTPUT').ZI5E            64350000
&ZCGPR                SETC  '&XBUFFADDR'                                64400000
.*                                                                      64700000
                      AIF   ('&XBUFFADDR'(1,1) NE '(').ZI5B             64750000
&ZCGPR   SETC  '0('.'&XBUFFADDR'(2,K'&XBUFFADDR-2).')'                  64800000
                      AGO   .ZI5D                                       65700000
.ZI5B                 ANOP  ,                                           65750000
.*                                                                      65800000
&ZC                   SETC  '&XBUFFADDR'(1,1)                           65850000
                      AIF   (T'&ZC NE 'N').ZI5D                         65900000
&ZC                   SETC  '&XBUFFADDR'                                65925000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                65950000
&ZCGPR                SETC  '=AL4(&XBUFFADDR)'                          65975000
.*                                                                      66000000
.ZI5D                 ANOP  ,                                           66050000
.*                                                                      66100000
&ZOPN                 SETA  &ZOPN+1                                     66150000
&ZOPL(&ZOPN)          SETC  ' '                                         66200000
&ZOPO(&ZOPN)          SETC  'MVC'                                       66250000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             66300000
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFADDR XBUFFADDR'                  66350000
.*                                                                      66400000
.ZI5E                 ANOP  ,                                           66450000
.*-------------------------------------------------------------------   66500000
.***AI.L18  XBUFFALET CL4                                               66525000
         AIF   ('&XBUFFALET' NE 'NOBUFFALET').ZI6                       66550000
&ZXBUFFALET           SETC  ''             RESET INPUT/OUTPUT           66575000
.ZI6                  ANOP  ,                                           66600000
.*-------------------------------------------------------------------   66625000
.***AI.L25  XBUFFALET CL4                                               66650000
                      AIF   ('&ZXBUFFALET' EQ '').ZI6E                  66675000
                      AIF   ('&ZXBUFFALET' EQ 'OUTPUT').ZI6E            66700000
&ZCGPR                SETC  '&XBUFFALET'                                66725000
.*                                                                      66750000
                      AIF   ('&XBUFFALET'(1,1) NE '(').ZI6B             66800000
&ZCGPR   SETC  '0('.'&XBUFFALET'(2,K'&XBUFFALET-2).')'                  66850000
.ZI6B                 ANOP  ,                                           66900000
.*                                                                      66950000
&ZOPN                 SETA  &ZOPN+1                                     67000000
&ZOPL(&ZOPN)          SETC  ' '                                         67050000
&ZOPO(&ZOPN)          SETC  'MVC'                                       67100000
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             67150000
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFALET XBUFFALET'                  67200000
.*                                                                      67250000
.ZI6E                 ANOP  ,                                           67300000
.*-------------------------------------------------------------------   67350000
.***AI.L25  XBUFFLEN F                                                  67400000
                      AIF   ('&ZXBUFFLEN' EQ '').ZI7E                   67450000
                      AIF   ('&ZXBUFFLEN' EQ 'OUTPUT').ZI7E             67500000
&ZCGPR                SETC  '&XBUFFLEN'                                 67550000
.*                                                                      67600000
                      AIF   ('&XBUFFLEN'(1,1) NE '(').ZI7B              67650000
&ZCGPR   SETC  '0('.'&XBUFFLEN'(2,K'&XBUFFLEN-2).')'                    67700000
                      AGO   .ZI7D                                       67750000
.ZI7B                 ANOP  ,                                           67800000
.*                                                                      67850000
&ZC                   SETC  '&XBUFFLEN'(1,1)                            67900000
                      AIF   (T'&ZC NE 'N').ZI7D                         67950000
&ZC                   SETC  '&XBUFFLEN'                                 67975000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                68000000
&ZCGPR                SETC  '=FL4''&XBUFFLEN'''                         68025000
.*                                                                      68050000
.ZI7D                 ANOP  ,                                           68100000
.*                                                                      68150000
&ZOPN                 SETA  &ZOPN+1                                     68200000
&ZOPL(&ZOPN)          SETC  ' '                                         68250000
&ZOPO(&ZOPN)          SETC  'MVC'                                       68300000
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            68350000
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFLEN XBUFFLEN'                    68400000
.*                                                                      68450000
.ZI7E                 ANOP  ,                                           68500000
.*-------------------------------------------------------------------   68550000
.***AI.L25  XTOKEN CL8                                                  68600000
                      AIF   ('&ZXTOKEN' EQ '').ZI8E                     68650000
                      AIF   ('&ZXTOKEN' EQ 'OUTPUT').ZI8E               68700000
&ZCGPR                SETC  '&XTOKEN'                                   68750000
.*                                                                      69050000
                      AIF   ('&XTOKEN'(1,1) NE '(').ZI8B                69100000
&ZCGPR   SETC  '0('.'&XTOKEN'(2,K'&XTOKEN-2).')'                        69150000
.ZI8B                 ANOP  ,                                           69200000
.*                                                                      69250000
&ZOPN                 SETA  &ZOPN+1                                     69300000
&ZOPL(&ZOPN)          SETC  ' '                                         69350000
&ZOPO(&ZOPN)          SETC  'MVC'                                       69400000
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            69450000
&ZOPD(&ZOPN)          SETC  '++ &ZXTOKEN XTOKEN'                        69500000
.*                                                                      69550000
.ZI8E                 ANOP  ,                                           69600000
.*-------------------------------------------------------------------   69601000
.***AI.L25  XTBWCADDR AL4                                               69602000
                      AIF   ('&ZXTBWCADDR' EQ '').ZI9E                  69603000
                      AIF   ('&ZXTBWCADDR' EQ 'OUTPUT').ZI9E            69604000
&ZCGPR                SETC  '&XTBWCADDR'                                69605000
.*                                                                      69606000
                      AIF   ('&XTBWCADDR'(1,1) NE '(').ZI9B             69607000
&ZCGPR   SETC  '0('.'&XTBWCADDR'(2,K'&XTBWCADDR-2).')'                  69608000
                      AGO   .ZI9D                                       69609000
.ZI9B                 ANOP  ,                                           69610000
.*                                                                      69611000
&ZC                   SETC  '&XTBWCADDR'(1,1)                           69612000
                      AIF   (T'&ZC NE 'N').ZI9D                         69613000
&ZC                   SETC  '&XTBWCADDR'                                69614000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                69615000
&ZCGPR                SETC  '=AL4(&XTBWCADDR)'                          69616000
.*                                                                      69617000
.ZI9D                 ANOP  ,                                           69618000
.*                                                                      69619000
&ZOPN                 SETA  &ZOPN+1                                     69620000
&ZOPL(&ZOPN)          SETC  ' '                                         69621000
&ZOPO(&ZOPN)          SETC  'MVC'                                       69622000
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            69623000
&ZOPD(&ZOPN)          SETC  '++ &ZXTBWCADDR XTBWCADDR'                  69624000
.*                                                                      69625000
.ZI9E                 ANOP  ,                                           69626000
.*-------------------------------------------------------------------   69627000
.***AI.L18  XTBWCALET CL4                                               69628000
         AIF   ('&XTBWCALET' NE 'NOTBWCALET').ZI10                      69629000
&ZXTBWCALET           SETC  ''             RESET INPUT/OUTPUT           69630000
.ZI10                 ANOP  ,                                           69631000
.*-------------------------------------------------------------------   69632000
.***AI.L25  XTBWCALET CL4                                               69633000
                      AIF   ('&ZXTBWCALET' EQ '').ZI10E                 69634000
                      AIF   ('&ZXTBWCALET' EQ 'OUTPUT').ZI10E           69635000
&ZCGPR                SETC  '&XTBWCALET'                                69636000
.*                                                                      69637000
                      AIF   ('&XTBWCALET'(1,1) NE '(').ZI10B            69638000
&ZCGPR   SETC  '0('.'&XTBWCALET'(2,K'&XTBWCALET-2).')'                  69639000
.ZI10B                ANOP  ,                                           69640000
.*                                                                      69641000
&ZOPN                 SETA  &ZOPN+1                                     69642000
&ZOPL(&ZOPN)          SETC  ' '                                         69643000
&ZOPO(&ZOPN)          SETC  'MVC'                                       69644000
&ZOPV(&ZOPN)          SETC  '28(4,1),&ZCGPR'                            69645000
&ZOPD(&ZOPN)          SETC  '++ &ZXTBWCALET XTBWCALET'                  69646000
.*                                                                      69647000
.ZI10E                ANOP  ,                                           69648000
.*-------------------------------------------------------------------   69650000
&ZOPN1                SETA &ZOPN                                        69700000
.*******************************************************************    69750000
.***  PROCESS CTRACEWR OUTPUT PARAMETERS                                69800000
.*******************************************************************    69850000
                      ACTR  10000                                       69900000
.*******************************************************************    69950000
.***AO.X02  RETURN CODE PROCESSING                                      70000000
.*******************************************************************    70050000
                      AIF   (N'&RC LE 0).ZMRETX                         70100000
                      AIF   ('&XRC'(1,1) EQ '(').ZMRET2                 70150000
                      AIF   ('&XRC' EQ 'GPR15').ZMRETX                  70200000
                      AIF   ('&XRC' EQ 'REG15').ZMRETX                  70250000
                      AIF   ('&XRC' EQ 'R15').ZMRETX                    70300000
                      AIF   ('&XRC' EQ '15').ZMRETX                     70350000
&ZOPN                 SETA  &ZOPN+1                                     70400000
&ZOPL(&ZOPN)          SETC  ' '                                         70450000
&ZOPO(&ZOPN)          SETC  'ST'                                        70500000
&ZOPV(&ZOPN)          SETC  '15,&XRC'                                   70550000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        70600000
                      AGO   .ZMRETX                                     70650000
.*                                                                      70700000
.ZMRET2               ANOP  ,                                           70750000
&ZCGPR                SETC  '&XRC'(2,K'&XRC-2)                          70800000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                70850000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                70900000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  70950000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   71000000
&ZOPN                 SETA  &ZOPN+1                                     71050000
&ZOPL(&ZOPN)          SETC  ' '                                         71100000
&ZOPO(&ZOPN)          SETC  'LR'                                        71150000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 71200000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        71250000
.ZMRETX               ANOP  ,                                           71300000
.*******************************************************************    71350000
.***AO.X03  REASON CODE PROCESSING                                      71400000
.*******************************************************************    71450000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    71500000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            71550000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              71600000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             71650000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              71700000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             71750000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                71800000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 71850000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                71900000
&ZOPN                 SETA  &ZOPN+1                                     71950000
&ZOPL(&ZOPN)          SETC  ' '                                         72000000
&ZOPO(&ZOPN)          SETC  'ST'                                        72050000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               72100000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        72150000
                      AGO   .ZMRSNX                                     72200000
.*                                                                      72250000
.ZMRSN2               ANOP  ,                                           72300000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                72350000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 72400000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                72450000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 72500000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                72550000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   72600000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    72650000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   72700000
&ZOPN                 SETA  &ZOPN+1                                     72750000
&ZOPL(&ZOPN)          SETC  ' '                                         72800000
&ZOPO(&ZOPN)          SETC  'LR'                                        72850000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  72900000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        72950000
.ZMRSNX               ANOP  ,                                           73000000
.*******************************************************************    73050000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   73100000
.*******************************************************************    73150000
.ZMFLX                ANOP  ,              MF=L PROCESSING              73200000
.*******************************************************************    73250000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               73300000
.*******************************************************************    73350000
                      ACTR  10000                                       73400000
.*                                                                      73450000
                      LCLA  &ZLC           COLUMN POSITION              73500000
                      LCLA  &ZOPX          LIST TABLE INDEX             73550000
                      LCLC  &ZLL           LABEL                        73600000
                      LCLC  &ZLOP          OPERATION                    73650000
                      LCLC  &ZLV           VALUE                        73700000
                      LCLC  &ZLD           DESCRIPTION                  73750000
.*                                                                      73800000
&ZOPX                 SETA  1                                           73850000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            73900000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              73950000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              74000000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              74050000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              74100000
                      AIF   (K'&ZLD LE 0).ZL5                           74150000
&ZLC                  SETA  35             COMMENT COLUMN               74200000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    74250000
&ZLC                  SETA  33             COMMMENT COLUMN              74300000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   74350000
&ZLV                  SETC  '&ZLV'.' '                                  74400000
                      AGO   .ZL3                                        74450000
.*                                                                      74500000
.ZL4                  ANOP  ,                                           74550000
&ZLV                  SETC  '&ZLV'.' '                                  74600000
.ZL5                  ANOP  ,                                           74650000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               74700000
.*                                                                      74750000
&ZLL     &ZLOP &ZLV                                                     74800000
.*                                                                      74850000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               74900000
                      AGO   .ZL2           CONTINUE LOOPING             74950000
.*                                                                      75000000
.ZLX                  ANOP  ,                                           75050000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                75100000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  75150000
         L    14,16(0,0)            GET CVT ADDRESS                     75200000
         L    14,772(14,0)          GET SFT ADDRESS                     75250000
         L    14,296(14,0)          GET LX/EX (PC NUMBER)               75300000
         PC   0(14)                 PC TO CTRACE WRITER SERVICE         75350000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  75400000
.ZLINKX               ANOP  ,                                           75450000
.*******************************************************************    75500000
.***AP.X01  FORMAT GENERATED CODE                                       75550000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            75600000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              75650000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              75700000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              75750000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              75800000
                      AIF   (K'&ZLD LE 0).ZL51                          75850000
&ZLC                  SETA  35             COMMENT COLUMN               75900000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   75950000
&ZLC                  SETA  33             COMMENT COLUMN               76000000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  76050000
&ZLV                  SETC  '&ZLV'.' '                                  76100000
                      AGO   .ZL31                                       76150000
.*                                                                      76200000
.ZL41                 ANOP  ,                                           76250000
&ZLV                  SETC  '&ZLV'.' '                                  76300000
.ZL51                 ANOP  ,                                           76350000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               76400000
.*                                                                      76450000
&ZLL     &ZLOP &ZLV                                                     76500000
.*                                                                      76550000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               76600000
                      AGO   .ZL21          CONTINUE LOOPING             76650000
.*                                                                      76700000
.ZLX1                 ANOP  ,                                           76750000
.*******************************************************************    76800000
.***AP.X02  END OF CTRACEWR MACRO                                       76850000
&ZCTRACEWR            SETC  'YES'          SET CTRACEWR USED            76900000
         POP   PRINT                                                    76950000
*                                            CTRACEWR-0                 77000000
         SPACE 1                                                        77050000
.ZLX2                 ANOP  ,                                           77100000
         MEND                                                           77150000
**********************************************************************/ 77200000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  77250000
*%CTRACEWR: MACRO KEYS(BUFFADDR,BUFFALET,BUFFLEN,TOKEN,TBWCADDR,        77300000
*                 TBWCALET,SYNCH,RC,RSNCODE,COM,PLISTVER,MF);           77350000
*  ANS('?'||MACLABEL||' '||'CTRACEWP '||MACLIST||                       77400000
*         ' '||MACKEYS||';') COL(MACLMAR);                              77450000
*%END CTRACEWR;                                                         77500000
