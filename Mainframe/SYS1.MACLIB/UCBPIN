*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  UCBPIN                                -12/13/99-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  UCB Pin/Unpin                                 * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5695-047 (C) COPYRIGHT IBM CORP. 1990                           * 00001200
*                                                                     * 00001300
* STATUS= HBB4410                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      UCBPIN provides a capability for authorized programs which     * 00002100
*      obtain UCB addresses (either via UCB services or other means)  * 00002200
*      to "pin" a UCB to prevent its deletion by the Dynamic I/O      * 00002300
*      configuration function.                                        * 00002400
*                                                                     * 00002500
*      The PIN function will prevent a UCB from being dynamically     * 00002600
*      deleted while it is subject to processing.                     * 00002700
*                                                                     * 00002800
*      The PINPATHS parameter will prevent the paths to the device    * 00002900
*      from being dynamically deleted.                                * 00003000
*                                                                     * 00003100
*      Programs which perform a "pin" are responsible for performing  * 00003200
*      a corresponding "unpin".  The UNPIN function should be used    * 00003300
*      when the program is no longer using the UCB.                   * 00003400
*                                                                     * 00003500
*      The MOVEPIN function will move pin related information from    * 00003600
*      one Parallel Access Volume (PAV) to another.  Note: The        * 00003700
*      MOVEPIN function is intended for IOS use only.                 * 00003800
*                                                                     * 00003900
*      The contents of registers 14-1 are altered by the macro        * 00004000
*      expansion.                                                     * 00004100
*                                                                     * 00004200
*      The parameter list must be in the caller's primary address     * 00004300
*      space or be addressable by the dispatchable unit access list.  * 00004400
*                                                                     * 00004500
*      The LINKAGE=BRANCH option is intended for performance          * 00004600
*      sensitive invokers or programs which require this function     * 00004700
*      during NIP before a PC can be issued.                          * 00004800
*                                                                     * 00004900
*01* ENVIRONMENT:                                                     * 00005000
*                                                                     * 00005100
*                                                                     * 00005200
*      Dispatchable unit mode: Task or SRB mode.                      * 00005300
*                                                                     * 00005400
*      Minimum authorization: Supervisor State or program key mask    * 00005500
*                        (PKM) allowing keys 0-7.                     * 00005600
*                                                                     * 00005700
*      AMODE:            24- or 31-bit.                               * 00005800
*                                                                     * 00005900
*      ASC mode:         Primary or Access Register.                  * 00006000
*                                                                     * 00006100
*      Serialization:    Enabled or Disabled.                         * 00006200
*                                                                     * 00006300
*      Restrictions:                                                  * 00006400
*                                                                     * 00006500
*                        The invoker may not hold any lock higher     * 00006600
*                        then the IOSULUT lock.                       * 00006700
*                                                                     * 00006800
*                        The LINKAGE=BRANCH option is limited to      * 00006900
*                        callers which meet the following criteria:   * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*                        o   supervisor state key 0                   * 00007300
*                                                                     * 00007400
*                        o   31 bit addressing mode                   * 00007500
*                                                                     * 00007600
*                        o   primary ASC mode                         * 00007700
*                                                                     * 00007800
*                        o   the parameter list (including any data   * 00007900
*                            areas pointed to by the parameter list)  * 00008000
*                            resides in fixed or DREF storage         * 00008100
*                                                                     * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00008700
*                                                                     * 00008800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00008900
*                                                                     * 00009000
*01* SYNTAX:                                                          * 00009100
*                                                                     * 00009200
*[xlabel]  UCBPIN    PIN                                             * 00009300
*                  |     ,UCBPTR=xucbptr                              * 00009400
*                  |     ,TEXT=xtext                                  * 00009500
*                  |     ,PTOKEN=xptoken                              * 00009600
*                  |    [,COMPID=xcompid|NONE]                      * 00009700
*                  |    [,HELP=xhelp|NONE]                          * 00009800
*                  |    [,LASTING]                                    * 00009900
*                  |    [,PINPATHS]                                   * 00010000
*                  |    [,NOVAL]                                      * 00010100
*                  |    [,IOCTOKEN=xioctoken|NONE]                  * 00010200
*                   ,UNPIN                                           * 00010300
*                  |     ,PTOKEN=xptoken                              * 00010400
*                   ,MOVEPIN                                         * 00010500
*                        ,TO=xto                                      * 00010600
*                        ,FROM=xfrom                                  * 00010700
*                   [,LINKAGE=SYSTEM|BRANCH]                        * 00010800
*                   [,RETCODE=xretcode]                               * 00010900
*                   [,RSNCODE=xrsncode]                               * 00011000
*                  [,MF=S]                                           * 00011100
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 00011200
*                  [,MF=(E,xmfctrl,COMPLETE)]                      * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*      Where:                                                         * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*      [xlabel]                                                       * 00011900
*          is an optional symbol, starting in column 1, that is the   * 00012000
*          name on the UCBPIN macro invocation.  The name must        * 00012100
*          conform to the rules for an ordinary assembler language    * 00012200
*          symbol.                                                    * 00012300
*          DEFAULT: No name.                                          * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*      The following is a set of mutually exclusive keys.  This set   * 00012900
*      is required; only one key must be specified.                   * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*      PIN                                                            * 00013300
*          Pin the UCB.                                               * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*          UCBPTR=xucbptr                                             * 00013700
*              is the name (RS-type), or address in register          * 00013800
*              (2)-(12), of a required 4 byte input that contains the * 00013900
*              address of the UCB common segment for the UCB that is  * 00014000
*              to be pinned.                                          * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*          TEXT=xtext                                                 * 00014600
*              is the name (RS-type) of a required 58 character input * 00014700
*              which specifies the descriptive text documenting the   * 00014800
*              reason for the PIN request.  This text will be         * 00014900
*              displayed on a message identifying the reason for a    * 00015000
*              configuration change failure if this pin request       * 00015100
*              remains outstanding during a configuration change.     * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*          PTOKEN=xptoken                                             * 00015700
*              is the name (RS-type), or address in register          * 00015800
*              (2)-(12), of a required 8 character output which is to * 00015900
*              receive the pin token. The caller must use this pin    * 00016000
*              token when unpinning the device via UCBPIN UNPIN.      * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*          [COMPID=xcompid|NONE]                                    * 00016600
*              is the name (RS-type) of an optional 5 character input * 00016700
*              which specifies the component ID of the component      * 00016800
*              requesting the pin.                                    * 00016900
*              DEFAULT: NONE                                          * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*          [HELP=xhelp|NONE]                                        * 00017500
*              is the name (RS-type), or address in register          * 00017600
*              (2)-(12), of an optional 8 character input which       * 00017700
*              specifies the help panel ID in SYS1.LINKLIB which      * 00017800
*              provides help information on why the device was pinned * 00017900
*              and/or how to un-pin the device.                       * 00018000
*              DEFAULT: NONE                                          * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*          [LASTING]                                                  * 00018600
*              KEYWORD that indicates that the pin request should not * 00018700
*              be automatically cleaned up (i.e. unpinned) by IOS     * 00018800
*              during end-of-task or end-of-memory termination.       * 00018900
*              DEFAULT: NONE                                          * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*          [PINPATHS]                                                 * 00019500
*              KEYWORD that indicates to pin all paths to the device  * 00019600
*              (in addition to pinning the device)                    * 00019700
*              DEFAULT: NONE                                          * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*          [NOVAL]                                                    * 00020300
*              KEYWORD that indicates to bypass validity checking on  * 00020400
*              the input UCB address. If NOVAL is specified, then     * 00020500
*              IOCTOKEN is ignored.  (The NOVAL keyword is intended   * 00020600
*              for IOS use only.)                                     * 00020700
*              DEFAULT: NONE                                          * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*          [IOCTOKEN=xioctoken|NONE]                                * 00021300
*              is the name (RS-type), or address in register          * 00021400
*              (2)-(12), of an optional 48 character input/output     * 00021500
*              which specifies the I/O configuration token.  If the   * 00021600
*              current I/O configuration token does not match the     * 00021700
*              token supplied as input, the caller will be notified   * 00021800
*              via a return code.                                     * 00021900
*                                                                     * 00022000
*              If the input IOCTOKEN is set to binary zeroes, then    * 00022100
*              this service will set IOCTOKEN to the current I/O      * 00022200
*              configuration token.                                   * 00022300
*              DEFAULT: NONE                                          * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*      UNPIN                                                          * 00022800
*          Unpin the UCB.  The UNPIN function will undo the pin       * 00022900
*          request associated with the specified pin token.           * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*          PTOKEN=xptoken                                             * 00023300
*              is the name (RS-type), or address in register          * 00023400
*              (2)-(12), of a required 8 character input/output which * 00023500
*              contains the pin token representing the UCB that is to * 00023600
*              be unpinned.  PTOKEN must match the pin token which    * 00023700
*              was returned on the corresponding pin request.  PTOKEN * 00023800
*              will be reset to binary zeroes if the UNPIN function   * 00023900
*              is successful.                                         * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*      MOVEPIN                                                        * 00024400
*          Move the pin related information from one Parallel Access  * 00024500
*          Volume (PAV) to another.  The FROM and TO UCBs are checked * 00024600
*          to insure that one is an active PAV-base and the other is  * 00024700
*          a PAV-alias bound to that base.  (Note: The MOVEPIN        * 00024800
*          function is intended for IOS use only).                    * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*          TO=xto                                                     * 00025200
*              is the name (RS-type), or address in register          * 00025300
*              (2)-(12), of a required 4 byte input that contains the * 00025400
*              address of the UCB common segment of the device that   * 00025500
*              the pin information is being moved to.                 * 00025600
*                                                                     * 00025700
*          FROM=xfrom                                                 * 00025800
*              is the name (RS-type), or address in register          * 00025900
*              (2)-(12), of a required 4 byte input that contains the * 00026000
*              address of the UCB common segment of the device that   * 00026100
*              the pin information is being moved from.               * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*      End of a set of mutually exclusive required keys.              * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*      [LINKAGE=SYSTEM|BRANCH]                                      * 00027200
*          is an optional keyword input that indicates whether a      * 00027300
*          branch-entry linkage should be generated or a Program Call * 00027400
*          should be issued for the routine invocation.               * 00027500
*          DEFAULT: SYSTEM                                            * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*          LINKAGE=SYSTEM                                             * 00027900
*              requests Program Call invocation.                      * 00028000
*                                                                     * 00028100
*          LINKAGE=BRANCH                                             * 00028200
*              requests branch-entry invocation.  See INVOCATION      * 00028300
*              REQUIREMENTS for the restrictions on branch-entry      * 00028400
*              invocation.                                            * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*      [RETCODE=xretcode]                                             * 00029200
*          is the name (RS-type) of an optional fullword output       * 00029300
*          variable, or register (2)-(12), into which the return code * 00029400
*          is to be copied from GPR 15.                               * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*      [RSNCODE=xrsncode]                                             * 00030000
*          is the name (RS-type) of an optional fullword output       * 00030100
*          variable, or register (2)-(12), into which the reason code * 00030200
*          is to be copied from GPR 0.                                * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*      [MF=S|L|E]                                                   * 00030800
*          is an optional keyword input which specifies the macro     * 00030900
*          form.                                                      * 00031000
*          DEFAULT: S                                                 * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*          [MF=S]                                                     * 00031400
*              specifies the standard form of the macro.  The "S"     * 00031500
*              form generates code to put the parameters into an      * 00031600
*              in-line parameter list and invoke the desired service. * 00031700
*              Full checking for required macro keys is done along    * 00031800
*              with supplying defaults for omitted optional           * 00031900
*              parameters.                                            * 00032000
*                                                                     * 00032100
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00032200
*              specifies the list form of the macro.  The "L" form    * 00032300
*              defines an area to be used for the parameter list.     * 00032400
*              Any other macro parameters are flagged as errors.      * 00032500
*                                                                     * 00032600
*            ,xmfctrl                                                 * 00032700
*              is a required input.  It is the name of a storage area * 00032800
*              for the parameter list.                                * 00032900
*                                                                     * 00033000
*            ,xmfattr|0D                                            * 00033100
*              is an optional 60 character input string that varies   * 00033200
*              from 1 to 60 characters. Use it to force boundary      * 00033300
*              alignment of the parameter list. Use only 0F or 0D.    * 00033400
*              DEFAULT: 0D which forces the parameter list to a       * 00033500
*              doubleword boundary.                                   * 00033600
*                                                                     * 00033700
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00033800
*              specifies the execute form of the macro.  The "E" form * 00033900
*              generates code to put the parameters into the          * 00034000
*              parameter list specified by xmfctrl and provides full  * 00034100
*              syntax checking with default setting.                  * 00034200
*                                                                     * 00034300
*            ,xmfctrl                                                 * 00034400
*              is a required input.  It is the name (RS-type), or     * 00034500
*              address in register (1)-(12), of a storage area for    * 00034600
*              the parameter list.                                    * 00034700
*                                                                     * 00034800
*            ,COMPLETE                                              * 00034900
*              is an optional keyword input which specifies the       * 00035000
*              degree of macro parameter syntax checking.             * 00035100
*              DEFAULT: COMPLETE                                      * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*              COMPLETE                                               * 00035500
*                  Checking for required macro keys is done and       * 00035600
*                  defaults are supplied for omitted optional         * 00035700
*                  parameters.                                        * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*01* RETURN CODES:                                                    * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                 X'00'     Successful execution. For PIN requests,   * 00037000
*                           the UCB has been pinned and the pin token * 00037100
*                           has been returned in PTOKEN.  For UNPIN   * 00037200
*                           requests, the UCB has been unpinned and   * 00037300
*                           PTOKEN has been reset to binary zeroes.   * 00037400
*                                                                     * 00037500
*                 X'08'     Error in caller's parameters              * 00037600
*                                                                     * 00037700
*                           Reason codes                              * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                           X'01'     The caller specified an invalid * 00038100
*                                     ALET.                           * 00038200
*                                                                     * 00038300
*                           X'02'     An error occurred in accessing  * 00038400
*                                     the caller's parameter list.    * 00038500
*                                                                     * 00038600
*                           X'03'     The UCB address provided by the * 00038700
*                                     caller does not represent a     * 00038800
*                                     valid UCB.                      * 00038900
*                                                                     * 00039000
*                           X'04'     The PTOKEN supplied as input on * 00039100
*                                     an UNPIN request does not       * 00039200
*                                     represent a valid PIN token.    * 00039300
*                                                                     * 00039400
*                           X'05'     An error occurred referencing   * 00039500
*                                     the user-supplied work area for * 00039600
*                                     the IOCTOKEN (IOCTOKEN).  (This * 00039700
*                                     reason code is valid only for   * 00039800
*                                     callers using the IOCTOKEN      * 00039900
*                                     keyword.)                       * 00040000
*                                                                     * 00040100
*                           X'0A'     An error occurred referencing   * 00040200
*                                     the user-supplied area for the  * 00040300
*                                     pin reason text (TEXT).  (This  * 00040400
*                                     reason code is valid only for   * 00040500
*                                     callers using the TEXT          * 00040600
*                                     keyword.)                       * 00040700
*                                                                     * 00040800
*                           X'0B'     MOVEPIN was requested, however  * 00040900
*                                     the FROM and TO devices did not * 00041000
*                                     represent an active PAV-base    * 00041100
*                                     and a bound PAV-alias on that   * 00041200
*                                     base.  The request is rejected. * 00041300
*                                     (This reason code is valid only * 00041400
*                                     for callers using the MOVEPIN   * 00041500
*                                     function.)                      * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*                 X'0C'     The UCB definition is not consistent with * 00042000
*                           the input configuration token.  (This     * 00042100
*                           return code is valid only for callers     * 00042200
*                           using the IOCTOKEN keyword.)              * 00042300
*                                                                     * 00042400
*                 X'10'     The UCB was pinned, but the paths could   * 00042500
*                           not be pinned.  (This return code is      * 00042600
*                           valid only for callers using the PINPATHS * 00042700
*                           keyword.)                                 * 00042800
*                                                                     * 00042900
*                 X'20'     An unexpected error occurred.             * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*01* REASON CODES:                                                    * 00043600
*                                                                     * 00043700
*       See return codes section.                                     * 00043800
*                                                                     * 00043900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00044000
*                                                                     * 00044100
*02*   PROCESSOR:  ASSEM                                              * 00044200
*                                                                     * 00044300
*01* COMPONENT:  SC1C3                                                * 00044400
*                                                                     * 00044500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00044600
*                                                                     * 00044700
*01* MACRO USAGE NOTES:                                               * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00045100
*        global macro variable.  Any value other than 'NO' will       * 00045200
*        result in the macro expansion being printed.  The default is * 00045300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00045400
*        variable should be set.                                      * 00045500
*                                                                     * 00045600
*                    GBLC &ZPRINT                                     * 00045700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*01* CHANGE ACTIVITY:                                                 * 00046200
*                                                                     * 00046300
*   Flag LineItem  FMID    Date   ID    Comment                       * 00046400
*                                                                     * 00046500
*    $L0=USERV    HBB4410 890815 PDLK:  Dynamic I/O Configuration     * 00046600
*    $P1=PEO3586  HBB4410 900226 PDLK:  Use macdefs=no to get around  * 00046700
*                                         AMG problem                 * 00046800
*    $01=OW17864  HBB4430 960710 PDMC:  Indicate PTOKEN is updated on * 00046900
*                                         branch-entered calls.       * 00047000
*    $02=OW37980  HBB6603 990531 PDNO:  Dynamic PAV Support.          * 00047100
****** END OF SPECIFICATIONS *****************************************/ 00047200
*/* TLINE 1 *********************************************************** 00047300
         MACRO                                                          00047400
&XLABEL  UCBPIN &UCBPTR=,&TEXT=,&PTOKEN=,&COMPID=,&HELP=,&IOCTOKEN=,   *00047500
               &TO=,&FROM=,&LINKAGE=,&RETCODE=,&RSNCODE=,&MF=           00047600
.*                                                                      00047700
*              MACDATE -12/13/99-<1>                                    00047800
.*                                                                      00047900
.*******************************************************************    00048000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00048100
.*******************************************************************    00048200
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00048300
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00048400
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00048500
.*                                                                      00048600
              GBLC  &ZUCBPIN    YES=MACRO USED AT LEAST ONCE            00048700
.*******************************************************************    00048800
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00048900
.*******************************************************************    00049000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00049100
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00049200
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00049300
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00049400
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00049500
              LCLA  &ZAWRK      USED AS A WORK AREA                     00049600
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00049700
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00049800
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00049900
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00050000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00050100
              LCLA  &ZMACRET    MACRO RETURN CODE                       00050200
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00050300
.*                                                                      00050400
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00050500
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00050600
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00050700
              LCLC  &ZENDBASEPL                 End of base PL          00050800
.********************************************************************   00050900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00051000
.********************************************************************   00051100
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00051200
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00051300
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00051400
.*                                                                      00051500
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00051600
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00051700
              SPLEVEL  TEST                                             00051800
.ZSYS2        ANOP  ,                                                   00051900
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00052000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00052100
              SYSSTATE TEST                                             00052200
              AGO   .ZSYS4                                              00052300
.ZSYS3        ANOP  ,                                                   00052400
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00052500
.ZSYS4        ANOP  ,                                                   00052600
.*******************************************************************    00052700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00052800
.*******************************************************************    00052900
              LCLC  &XFUNC      ++ VALUE                                00053000
              LCLC  &XPIN       ++ VALUE                                00053100
              LCLC  &XUCBPTR    ++ NAME                                 00053200
              LCLC  &XTEXT      ++ NAME                                 00053300
              LCLC  &XPTOKEN    ++ NAME                                 00053400
              LCLC  &XCOMPID    ++ NAME                                 00053500
              LCLC  &XHELP      ++ NAME                                 00053600
              LCLC  &XLASTING   ++ VALUE                                00053700
              LCLC  &XPINPATHS  ++ VALUE                                00053800
              LCLC  &XNOVAL     ++ VALUE                                00053900
              LCLC  &XIOCTOKEN  ++ NAME                                 00054000
              LCLC  &XUNPIN     ++ VALUE                                00054100
              LCLC  &XMOVEPIN   ++ VALUE                                00054200
              LCLC  &XTO        ++ NAME                                 00054300
              LCLC  &XFROM      ++ NAME                                 00054400
              LCLC  &XLINKAGE   ++ VALUE                                00054500
              LCLC  &XRETCODE   ++ NAME                                 00054600
              LCLC  &XRSNCODE   ++ NAME                                 00054700
              LCLC  &XMF        ++ VALUE                                00054800
              LCLC  &XMFCTRL    ++ NAME                                 00054900
              LCLC  &XMFATTR    ++ VALUE                                00055000
              LCLC  &XMFSCK     ++ VALUE                                00055100
.*******************************************************************    00055200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00055300
.*******************************************************************    00055400
              LCLC  &ZXFUNC     ++ INPUT VALUE                          00055500
              LCLC  &ZXPIN      ++ INPUT VALUE                          00055600
              LCLC  &ZXUCBPTR   ++ INPUT NAME                           00055700
              LCLC  &ZXTEXT     ++ INPUT NAME                           00055800
              LCLC  &ZXPTOKEN   ++ OUTPUT NAME                          00055900
              LCLC  &ZXCOMPID   ++ INPUT NAME                           00056000
              LCLC  &ZXHELP     ++ INPUT NAME                           00056100
              LCLC  &ZXLASTING  ++ INPUT VALUE                          00056200
              LCLC  &ZXPINPATHS                 ++ INPUT VALUE          00056300
              LCLC  &ZXNOVAL    ++ INPUT VALUE                          00056400
              LCLC  &ZXIOCTOKEN                 ++ INOUT NAME           00056500
              LCLC  &ZXUNPIN    ++ INPUT VALUE                          00056600
              LCLC  &ZXMOVEPIN  ++ INPUT VALUE                          00056700
              LCLC  &ZXTO       ++ INPUT NAME                           00056800
              LCLC  &ZXFROM     ++ INPUT NAME                           00056900
              LCLC  &ZXLINKAGE  ++ INPUT VALUE                          00057000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00057100
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00057200
              LCLC  &ZXMF       ++ INPUT VALUE                          00057300
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00057400
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00057500
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00057600
.********************************************************************   00057700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00057800
.********************************************************************   00057900
              ACTR  10000                                               00058000
.*------------------------------------------------------------------    00058100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00058200
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00058300
.*-------------------------------------------------------------------   00058400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00058500
.ZG53         ANOP  ,                                                   00058600
&ZTLC         SETC 'S'                                                  00058700
              AIF   ('&MF(1)' NE '&ZTLC').ZG54                          00058800
&XMF          SETC  'S'         SET KEYWORD                             00058900
              AIF   (N'&MF LE 1).ZG53A          CK NUM                  00059000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00059100
&ZMS          SETC  '&ZMS.&MF"'                                         00059200
&ZMS          SETC  '&ZMS "MF"'                                         00059300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00059400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00059500
.ZG53A        ANOP  ,                                                   00059600
.*-------------------------------------------------------------------   00059700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00059800
.ZG54         ANOP  ,                                                   00059900
&ZTLC         SETC 'L'                                                  00060000
              AIF   ('&MF(1)' NE '&ZTLC').ZG61                          00060100
&XMF          SETC  'L'         SET KEYWORD                             00060200
              AIF   (N'&MF LE 3).ZG54A          CK NUM                  00060300
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00060400
&ZMS          SETC  '&ZMS.&MF"'                                         00060500
&ZMS          SETC  '&ZMS "MF"'                                         00060600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00060700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00060800
.ZG54A        ANOP  ,                                                   00060900
.*-------------------------------------------------------------------   00061000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00061100
              AIF   (N'&SYSLIST NE 0).ZG54B     POSITIONALS?            00061200
              AIF   ('&UCBPTR' NE '').ZG54B     KEYS?                   00061300
              AIF   ('&TEXT' NE '').ZG54B       KEYS?                   00061400
              AIF   ('&PTOKEN' NE '').ZG54B     KEYS?                   00061500
              AIF   ('&COMPID' NE '').ZG54B     KEYS?                   00061600
              AIF   ('&HELP' NE '').ZG54B       KEYS?                   00061700
              AIF   ('&IOCTOKEN' NE '').ZG54B   KEYS?                   00061800
              AIF   ('&TO' NE '').ZG54B         KEYS?                   00061900
              AIF   ('&FROM' NE '').ZG54B       KEYS?                   00062000
              AIF   ('&LINKAGE' NE '').ZG54B    KEYS?                   00062100
              AIF   ('&RETCODE' NE '').ZG54B    KEYS?                   00062200
              AIF   ('&RSNCODE' NE '').ZG54B    KEYS?                   00062300
              AGO    .ZG54C     INVOCATION OKAY                         00062400
.ZG54B        ANOP  ,                                                   00062500
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         00062600
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   00062700
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              00062800
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        00062900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00063000
.ZG54C        ANOP  ,                                                   00063100
.*-------------------------------------------------------------------   00063200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00063300
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00063400
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00063500
              AIF   (N'&MF(2) GT 1).ZG56B       MULTI PARMS             00063600
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00063700
.ZG56B        AIF   (K'&MF(2) GT 0).ZG56C                               00063800
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00063900
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00064000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00064100
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00064200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00064300
.ZG56C        ANOP  ,                                                   00064400
.*-------------------------------------------------------------------   00064500
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00064600
              AIF   (K'&ZXMFCTRL LE 0).ZG56P    NOT I/O                 00064700
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG56P                      00064800
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00064900
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00065000
&ZMS          SETC  '&ZMS.&MF"'                                         00065100
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00065200
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00065300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00065400
.ZG56P        ANOP  ,                                                   00065500
.*-------------------------------------------------------------------   00065600
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00065700
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00065800
&XMFATTR      SETC  '0D'                                                00065900
              AIF   (K'&MF(3) LE 0).ZG59B       PARM                    00066000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00066100
              AIF   (N'&MF(3) GT 1).ZG59B       MULTI PARMS             00066200
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00066300
.ZG59B        ANOP  ,                                                   00066400
.*-------------------------------------------------------------------   00066500
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00066600
              AIF   (K'&ZXMFATTR LE 0).ZG59P    NOT I/O                 00066700
              AIF   ('&XMFATTR'(1,1) NE '(').ZG59P                      00066800
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00066900
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00067000
&ZMS          SETC  '&ZMS.&MF"'                                         00067100
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00067200
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00067300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00067400
.ZG59P        ANOP  ,                                                   00067500
.*-------------------------------------------------------------------   00067600
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00067700
              AIF   (K'&ZXMFATTR LE 0).ZG59S    NOT I/O                 00067800
              AIF   (K'&XMFATTR LE 60).ZG59S    LNG OK                  00067900
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00068000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00068100
&ZMS          SETC  '&ZMS.&MF"'                                         00068200
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00068300
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00068400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00068500
.ZG59S        ANOP  ,                                                   00068600
.*-------------------------------------------------------------------   00068700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068800
.ZG61         ANOP  ,                                                   00068900
&ZTLC         SETC 'E'                                                  00069000
              AIF   ('&MF(1)' NE '&ZTLC').ZG69                          00069100
&XMF          SETC  'E'         SET KEYWORD                             00069200
              AIF   (N'&MF LE 3).ZG61A          CK NUM                  00069300
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00069400
&ZMS          SETC  '&ZMS.&MF"'                                         00069500
&ZMS          SETC  '&ZMS "MF"'                                         00069600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00069700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00069800
.ZG61A        ANOP  ,                                                   00069900
.*-------------------------------------------------------------------   00070000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00070100
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00070200
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00070300
              AIF   (N'&MF(2) GT 1).ZG63B       MULTI PARMS             00070400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00070500
.ZG63B        AIF   (K'&MF(2) GT 0).ZG63C                               00070600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00070700
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00070800
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00070900
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00071000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00071100
.ZG63C        ANOP  ,                                                   00071200
.*-------------------------------------------------------------------   00071300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00071400
              AIF   (K'&ZXMFCTRL LE 0).ZG63R    NOT I/O                 00071500
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG63R                      00071600
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00071700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG63P                        00071800
              AIF   (K'&ZCGPR GT 2).ZG63Q                               00071900
              AIF   ('&ZCGPR' EQ '0').ZG63Q                             00072000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00072100
              AIF   (T'&ZCGPR NE 'N').ZG63Q     INVALID REG NAME        00072200
.ZG63P        ANOP  ,                                                   00072300
              AIF   (T'&ZCGPR NE 'N').ZG63R     NON NUMERIC             00072400
              AIF   ('&ZCGPR' LT '1').ZG63Q                             00072500
              AIF   ('&ZCGPR' LE '12').ZG63R                            00072600
.ZG63Q        ANOP  ,                                                   00072700
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00072800
&ZMS          SETC  '&ZMS.&MF"'                                         00072900
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00073000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00073100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00073200
.ZG63R        ANOP  ,                                                   00073300
.*-------------------------------------------------------------------   00073400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00073500
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00073600
.ZG67A   AIF   ('&MF(3)' NE 'COMPLETE').ZG68A                           00073700
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00073800
.*-------------------------------------------------------------------   00073900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00074000
.ZG68A        AIF   (K'&XMFSCK GT 0).ZG68C      KEYWORD                 00074100
              AIF   (K'&MF(3) LE 0).ZG68B                               00074200
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00074300
&ZMS          SETC  '&ZMS.&MF"'                                         00074400
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00074500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00074600
&ZMS          SETC  '&ZMS "COMPLETE".'                                  00074700
              MNOTE 8,' &ZMS '                                          00074800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00074900
.ZG68B        ANOP  ,                                                   00075000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00075100
.ZG68C        ANOP  ,                                                   00075200
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00075300
.*------------------------------------------------------------------    00075400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075500
.ZG69         ANOP  ,                                                   00075600
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00075700
              AIF   (K'&XMF GT 0).ZG69E         VALID ARG               00075800
              AIF   (T'&MF EQ 'O').ZG69D        OMITTED                 00075900
&ZASYSLNDX    SETA  0                                                   00076000
.ZG69A        ANOP  ,           POSITIONAL MACRO KEY                    00076100
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00076200
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG69C                    00076300
&ZTLC         SETC 'MF'                                                 00076400
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG69A           00076500
.ZG69B        ANOP  ,                                                   00076600
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00076700
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00076800
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00076900
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00077000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00077100
              AGO   .ZG69E                                              00077200
.ZG69C        ANOP  ,                                                   00077300
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00077400
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00077500
&ZMS          SETC  '&ZMS.&MF"'                                         00077600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00077700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00077800
&ZMS          SETC  '&ZMS "S",'                                         00077900
&ZMS          SETC  '&ZMS "L",'                                         00078000
&ZMS          SETC  '&ZMS OR "E".'                                      00078100
              MNOTE 8,' &ZMS '                                          00078200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00078300
              AGO   .ZG69E                                              00078400
.ZG69D        ANOP  ,                                                   00078500
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00078600
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00078700
.ZG69E        ANOP  ,                                                   00078800
.********************************************************************   00078900
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00079000
.********************************************************************   00079100
              ACTR  10000                                               00079200
.*-------------------------------------------------------------------   00079300
.***AG.MF03 MF=(SLE)                                                    00079400
              AIF   ('&XMF' EQ 'L').ZGMFX                               00079500
.*-------------------------------------------------------------------   00079600
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00079700
&XFUNC        SETC  ''          INITIALIZE XVARIABLE                    00079800
&ZASYSLNDX    SETA  0                                                   00079900
.ZG2A         ANOP  ,           POSITIONAL KEY SEARCH                   00080000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00080100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00080200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00080300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'PIN').ZG2A                   00080400
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00080500
&ZXFUNC       SETC  'INPUT'     SET IN/OUTPUT                           00080600
&XFUNC        SETC  'PIN'       SET XVARIABLE                           00080700
&ZXPIN        SETC  'INPUT'     SET IN/OUTPUT                           00080800
&XPIN         SETC  'PIN'       SET XVARIABLE PARM                      00080900
.ZG2B         ANOP  ,                                                   00081000
.*-------------------------------------------------------------------   00081100
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00081200
&ZASYSLNDX    SETA  0                                                   00081300
.ZG30A        ANOP  ,           POSITIONAL KEY SEARCH                   00081400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00081500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C  DONE                   00081600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG30A            00081700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'UNPIN').ZG30A                00081800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00081900
              AIF   (K'&XFUNC LE 0).ZG30B       VALID                   00082000
&ZMS          SETC  '"UNPIN'    *KMEKA* MNOTE                           00082100
&ZMS          SETC  '&ZMS."'                                            00082200
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00082300
&ZMS          SETC  '&ZMS "&XFUNC"'                                     00082400
              MNOTE 8,' &ZMS KEY.'                                      00082500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00082600
              AGO   .ZG30C                                              00082700
.*                                                                      00082800
.ZG30B        ANOP  ,                                                   00082900
&ZXFUNC       SETC  'INPUT'     SET IN/OUTPUT                           00083000
&XFUNC        SETC  'UNPIN'     SET XVARIABLE                           00083100
&ZXUNPIN      SETC  'INPUT'     SET IN/OUTPUT                           00083200
&XUNPIN       SETC  'UNPIN'     SET XVARIABLE PARM                      00083300
.ZG30C        ANOP  ,                                                   00083400
.*-------------------------------------------------------------------   00083500
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00083600
&ZASYSLNDX    SETA  0                                                   00083700
.ZG34A        ANOP  ,           POSITIONAL KEY SEARCH                   00083800
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00083900
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG34C  DONE                   00084000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG34A            00084100
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'MOVEPIN').ZG34A              00084200
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00084300
              AIF   (K'&XFUNC LE 0).ZG34B       VALID                   00084400
&ZMS          SETC  '"MOVEPIN'  *KMEKA* MNOTE                           00084500
&ZMS          SETC  '&ZMS."'                                            00084600
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00084700
&ZMS          SETC  '&ZMS "&XFUNC"'                                     00084800
              MNOTE 8,' &ZMS KEY.'                                      00084900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00085000
              AGO   .ZG34C                                              00085100
.*                                                                      00085200
.ZG34B        ANOP  ,                                                   00085300
&ZXFUNC       SETC  'INPUT'     SET IN/OUTPUT                           00085400
&XFUNC        SETC  'MOVEPIN'   SET XVARIABLE                           00085500
&ZXMOVEPIN    SETC  'INPUT'     SET IN/OUTPUT                           00085600
&XMOVEPIN     SETC  'MOVEPIN'   SET XVARIABLE PARM                      00085700
.ZG34C        ANOP  ,                                                   00085800
.*------------------------------------------------------------------    00085900
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00086000
              AIF   (K'&XFUNC GT 0).ZG39B                               00086100
&ZXFUNC       SETC  ''          RESET IN/OUTPUT                         00086200
&ZXPIN        SETC  ''          RESET IN/OUTPUT                         00086300
&XFUNC        SETC  ''          ENSURE NULL                             00086400
&XPIN         SETC  ''          ENSURE NULL                             00086500
&ZMS          SETC  'ONE OF THE FOLLOWING'      *KMERA* MNOTE           00086600
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 00086700
&ZMS          SETC  '&ZMS REQUIRED:'                                    00086800
&ZMS          SETC  '&ZMS "PIN",'               VALID ME KEY            00086900
&ZMS          SETC  '&ZMS "UNPIN",'             VALID ME KEY            00087000
&ZMS          SETC  '&ZMS OR "MOVEPIN".'        VALID ME KEY            00087100
              MNOTE 8,' &ZMS '                                          00087200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00087300
.ZG39B        ANOP  ,                                                   00087400
.*-------------------------------------------------------------------   00087500
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00087600
.ZG2          AIF   ('&XFUNC' NE 'PIN').ZG30                            00087700
.*-------------------------------------------------------------------   00087800
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00087900
&ZCVAL        SETC ''           ERROR KEY FIELD                         00088000
.ZG2I0        AIF   (K'&TO LE 0).ZG2I1                                  00088100
&ZCVAL        SETC '&ZCVAL TO'  DISALLOWED KEY                          00088200
.ZG2I1        AIF   (K'&FROM LE 0).ZG2I2                                00088300
&ZCVAL        SETC '&ZCVAL FROM'                DISALLOWED KEY          00088400
.ZG2I2        AIF   (K'&ZCVAL LE 0).ZG2J        KEY                     00088500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00088600
&ZMS          SETC  '"PIN'      *KMEIA* MNOTE                           00088700
&ZMS          SETC  '&ZMS."'                                            00088800
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00088900
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00089000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00089100
.ZG2J         ANOP  ,                                                   00089200
.*----------------------------------------------------------------***   00089300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00089400
              AIF   (N'&UCBPTR LE 1).ZG4A       CK NUM                  00089500
&ZMS          SETC  '"UCBPTR='  *KPOSA* MNOTE                           00089600
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     00089700
&ZMS          SETC  '&ZMS "UCBPTR"'                                     00089800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00089900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090000
.ZG4A         ANOP  ,                                                   00090100
.*-------------------------------------------------------------------   00090200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00090300
&ZXUCBPTR     SETC  'INPUT'     SET IN/OUTPUT                           00090400
&XUCBPTR      SETC  '&UCBPTR(1)'                SET XVARIABLE           00090500
              AIF   (N'&UCBPTR GT 1).ZG4B       MULTI PARMS             00090600
&XUCBPTR      SETC  '&UCBPTR'   SET XVARIABLE                           00090700
.ZG4B         AIF   (K'&UCBPTR(1) GT 0).ZG4C                            00090800
&ZXUCBPTR     SETC  ''          RESET IN/OUTPUT                         00090900
&ZMS          SETC  ' '         *KRQDA*                                 00091000
&ZMS          SETC  '&ZMS "UCBPTR" KEY AND ITS'                         00091100
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00091200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00091300
.ZG4C         ANOP  ,                                                   00091400
.*-------------------------------------------------------------------   00091500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00091600
              AIF   (K'&ZXUCBPTR LE 0).ZG4R     NOT I/O                 00091700
              AIF   ('&XUCBPTR'(1,1) NE '(').ZG4R                       00091800
&ZCGPR        SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                          00091900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         00092000
              AIF   (K'&ZCGPR GT 2).ZG4Q                                00092100
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              00092200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00092300
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        00092400
.ZG4P         ANOP  ,                                                   00092500
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             00092600
              AIF   ('&ZCGPR' LT '2').ZG4Q                              00092700
              AIF   ('&ZCGPR' LE '12').ZG4R                             00092800
.ZG4Q         ANOP  ,                                                   00092900
&ZMS          SETC  '"UCBPTR='  *KGPRA* MNOTE                           00093000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     00093100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00093200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00093300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093400
.ZG4R         ANOP  ,                                                   00093500
.*----------------------------------------------------------------***   00093600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00093700
              AIF   (N'&TEXT LE 1).ZG7A         CK NUM                  00093800
&ZMS          SETC  '"TEXT='    *KPOSA* MNOTE                           00093900
&ZMS          SETC  '&ZMS.&TEXT"'                                       00094000
&ZMS          SETC  '&ZMS "TEXT"'                                       00094100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00094200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094300
.ZG7A         ANOP  ,                                                   00094400
.*-------------------------------------------------------------------   00094500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00094600
&ZXTEXT       SETC  'INPUT'     SET IN/OUTPUT                           00094700
&XTEXT        SETC  '&TEXT(1)'  SET XVARIABLE                           00094800
              AIF   (N'&TEXT GT 1).ZG7B         MULTI PARMS             00094900
&XTEXT        SETC  '&TEXT'     SET XVARIABLE                           00095000
.ZG7B         AIF   (K'&TEXT(1) GT 0).ZG7C                              00095100
&ZXTEXT       SETC  ''          RESET IN/OUTPUT                         00095200
&ZMS          SETC  ' '         *KRQDA*                                 00095300
&ZMS          SETC  '&ZMS "TEXT" KEY AND ITS'                           00095400
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00095500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095600
.ZG7C         ANOP  ,                                                   00095700
.*-------------------------------------------------------------------   00095800
.***AG.KCK01 NAME, RQD INPUT, KEYS -GPR NOT ALLOWED                     00095900
              AIF   (K'&ZXTEXT LE 0).ZG7P       NOT I/O                 00096000
              AIF   ('&XTEXT'(1,1) NE '(').ZG7P                         00096100
&ZXTEXT       SETC  ''          RESET IN/OUTPUT                         00096200
&ZMS          SETC  '"TEXT='    *KGPRA* MNOTE                           00096300
&ZMS          SETC  '&ZMS.&TEXT"'                                       00096400
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00096500
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00096600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00096700
.ZG7P         ANOP  ,                                                   00096800
.*----------------------------------------------------------------***   00096900
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00097000
              AIF   (N'&PTOKEN LE 1).ZG10A      CK NUM                  00097100
&ZMS          SETC  '"PTOKEN='  *KPOSA* MNOTE                           00097200
&ZMS          SETC  '&ZMS.&PTOKEN"'                                     00097300
&ZMS          SETC  '&ZMS "PTOKEN"'                                     00097400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00097500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00097600
.ZG10A        ANOP  ,                                                   00097700
.*-------------------------------------------------------------------   00097800
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00097900
&ZXPTOKEN     SETC  'OUTPUT'    SET IN/OUTPUT                           00098000
&XPTOKEN      SETC  '&PTOKEN(1)'                SET XVARIABLE           00098100
              AIF   (N'&PTOKEN GT 1).ZG10B      MULTI PARMS             00098200
&XPTOKEN      SETC  '&PTOKEN'   SET XVARIABLE                           00098300
.ZG10B        AIF   (K'&PTOKEN(1) GT 0).ZG10C                           00098400
&ZXPTOKEN     SETC  ''          RESET IN/OUTPUT                         00098500
&ZMS          SETC  ' '         *KRQDA*                                 00098600
&ZMS          SETC  '&ZMS "PTOKEN" KEY AND ITS'                         00098700
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00098800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098900
.ZG10C        ANOP  ,                                                   00099000
.*-------------------------------------------------------------------   00099100
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00099200
              AIF   (K'&ZXPTOKEN LE 0).ZG10R    NOT I/O                 00099300
              AIF   ('&XPTOKEN'(1,1) NE '(').ZG10R                      00099400
&ZCGPR        SETC  '&XPTOKEN'(2,K'&XPTOKEN-2)                          00099500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00099600
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00099700
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00099800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00099900
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00100000
.ZG10P        ANOP  ,                                                   00100100
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00100200
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00100300
              AIF   ('&ZCGPR' LE '12').ZG10R                            00100400
.ZG10Q        ANOP  ,                                                   00100500
&ZMS          SETC  '"PTOKEN='  *KGPRA* MNOTE                           00100600
&ZMS          SETC  '&ZMS.&PTOKEN"'                                     00100700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00100800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00100900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101000
.ZG10R        ANOP  ,                                                   00101100
.*----------------------------------------------------------------***   00101200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00101300
              AIF   (N'&COMPID LE 1).ZG13A      CK NUM                  00101400
&ZMS          SETC  '"COMPID='  *KPOSA* MNOTE                           00101500
&ZMS          SETC  '&ZMS.&COMPID"'                                     00101600
&ZMS          SETC  '&ZMS "COMPID"'                                     00101700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00101800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101900
.ZG13A        ANOP  ,                                                   00102000
.*-------------------------------------------------------------------   00102100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00102200
&ZXCOMPID     SETC  'INPUT'     SET IN/OUTPUT                           00102300
&XCOMPID      SETC  'NONE'                                              00102400
              AIF   (K'&COMPID(1) LE 0).ZG13B   PARM                    00102500
&XCOMPID      SETC  '&COMPID(1)'                SET XVARIABLE           00102600
              AIF   (N'&COMPID GT 1).ZG13B      MULTI PARMS             00102700
&XCOMPID      SETC  '&COMPID'   SET XVARIABLE                           00102800
.ZG13B        ANOP  ,                                                   00102900
.*-------------------------------------------------------------------   00103000
.***AG.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     00103100
              AIF   (K'&ZXCOMPID LE 0).ZG13P    NOT I/O                 00103200
              AIF   ('&XCOMPID' EQ 'NONE').ZG13P                        00103300
              AIF   ('&XCOMPID'(1,1) NE '(').ZG13P                      00103400
&ZXCOMPID     SETC  ''          RESET IN/OUTPUT                         00103500
&ZMS          SETC  '"COMPID='  *KGPRA* MNOTE                           00103600
&ZMS          SETC  '&ZMS.&COMPID"'                                     00103700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00103800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00103900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104000
.ZG13P        ANOP  ,                                                   00104100
.*----------------------------------------------------------------***   00104200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00104300
              AIF   (N'&HELP LE 1).ZG16A        CK NUM                  00104400
&ZMS          SETC  '"HELP='    *KPOSA* MNOTE                           00104500
&ZMS          SETC  '&ZMS.&HELP"'                                       00104600
&ZMS          SETC  '&ZMS "HELP"'                                       00104700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00104800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104900
.ZG16A        ANOP  ,                                                   00105000
.*-------------------------------------------------------------------   00105100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00105200
&ZXHELP       SETC  'INPUT'     SET IN/OUTPUT                           00105300
&XHELP        SETC  'NONE'                                              00105400
              AIF   (K'&HELP(1) LE 0).ZG16B     PARM                    00105500
&XHELP        SETC  '&HELP(1)'  SET XVARIABLE                           00105600
              AIF   (N'&HELP GT 1).ZG16B        MULTI PARMS             00105700
&XHELP        SETC  '&HELP'     SET XVARIABLE                           00105800
.ZG16B        ANOP  ,                                                   00105900
.*-------------------------------------------------------------------   00106000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00106100
              AIF   (K'&ZXHELP LE 0).ZG16R      NOT I/O                 00106200
         AIF   ('&XHELP' EQ 'NONE').ZG16R                               00106300
              AIF   ('&XHELP'(1,1) NE '(').ZG16R                        00106400
&ZCGPR        SETC  '&XHELP'(2,K'&XHELP-2)                              00106500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        00106600
              AIF   (K'&ZCGPR GT 2).ZG16Q                               00106700
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             00106800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00106900
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        00107000
.ZG16P        ANOP  ,                                                   00107100
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             00107200
              AIF   ('&ZCGPR' LT '2').ZG16Q                             00107300
              AIF   ('&ZCGPR' LE '12').ZG16R                            00107400
.ZG16Q        ANOP  ,                                                   00107500
&ZMS          SETC  '"HELP='    *KGPRA* MNOTE                           00107600
&ZMS          SETC  '&ZMS.&HELP"'                                       00107700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00107800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00107900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00108000
.ZG16R        ANOP  ,                                                   00108100
.*----------------------------------------------------------------***   00108200
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00108300
&XLASTING     SETC  ''          RESET XVARIABLE                         00108400
&ZXLASTING    SETC  ''          RESET IN/OUTPUT                         00108500
&ZASYSLNDX    SETA  0                                                   00108600
.ZG19A        ANOP  ,           POSITIONAL MACRO KEY                    00108700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00108800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG19B                         00108900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG19A            00109000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'LASTING').ZG19A              00109100
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00109200
&XLASTING     SETC  'LASTING'   MACRO KEY FOUND                         00109300
&ZXLASTING    SETC  'INPUT'     SET IN/OUTPUT                           00109400
.ZG19B        ANOP  ,                                                   00109500
.*-------------------------------------------------------------------   00109600
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00109700
              AIF   (K'&XLASTING GT 0).ZG19C    KEY ENTERED             00109800
&ZXLASTING    SETC  'INPUT'     SET IN/OUTPUT                           00109900
&XLASTING     SETC  'NONE'      SET DEFAULT                             00110000
.ZG19C        ANOP  ,                                                   00110100
.*----------------------------------------------------------------***   00110200
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00110300
&XPINPATHS    SETC  ''          RESET XVARIABLE                         00110400
&ZXPINPATHS   SETC  ''          RESET IN/OUTPUT                         00110500
&ZASYSLNDX    SETA  0                                                   00110600
.ZG22A        ANOP  ,           POSITIONAL MACRO KEY                    00110700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00110800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG22B                         00110900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG22A            00111000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'PINPATHS').ZG22A             00111100
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00111200
&XPINPATHS    SETC  'PINPATHS'  MACRO KEY FOUND                         00111300
&ZXPINPATHS   SETC  'INPUT'     SET IN/OUTPUT                           00111400
.ZG22B        ANOP  ,                                                   00111500
.*-------------------------------------------------------------------   00111600
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00111700
              AIF   (K'&XPINPATHS GT 0).ZG22C   KEY ENTERED             00111800
&ZXPINPATHS   SETC  'INPUT'     SET IN/OUTPUT                           00111900
&XPINPATHS    SETC  'NONE'      SET DEFAULT                             00112000
.ZG22C        ANOP  ,                                                   00112100
.*----------------------------------------------------------------***   00112200
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00112300
&XNOVAL       SETC  ''          RESET XVARIABLE                         00112400
&ZXNOVAL      SETC  ''          RESET IN/OUTPUT                         00112500
&ZASYSLNDX    SETA  0                                                   00112600
.ZG25A        ANOP  ,           POSITIONAL MACRO KEY                    00112700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00112800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25B                         00112900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG25A            00113000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'NOVAL').ZG25A                00113100
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00113200
&XNOVAL       SETC  'NOVAL'     MACRO KEY FOUND                         00113300
&ZXNOVAL      SETC  'INPUT'     SET IN/OUTPUT                           00113400
.ZG25B        ANOP  ,                                                   00113500
.*-------------------------------------------------------------------   00113600
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00113700
              AIF   (K'&XNOVAL GT 0).ZG25C      KEY ENTERED             00113800
&ZXNOVAL      SETC  'INPUT'     SET IN/OUTPUT                           00113900
&XNOVAL       SETC  'NONE'      SET DEFAULT                             00114000
.ZG25C        ANOP  ,                                                   00114100
.*----------------------------------------------------------------***   00114200
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00114300
              AIF   (N'&IOCTOKEN LE 1).ZG28A    CK NUM                  00114400
&ZMS          SETC  '"IOCTOKEN='                *KPOSA* MNOTE           00114500
&ZMS          SETC  '&ZMS.&IOCTOKEN"'                                   00114600
&ZMS          SETC  '&ZMS "IOCTOKEN"'                                   00114700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00114800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114900
.ZG28A        ANOP  ,                                                   00115000
.*-------------------------------------------------------------------   00115100
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         00115200
&ZXIOCTOKEN   SETC  'INOUT'     SET IN/OUTPUT                           00115300
&XIOCTOKEN    SETC  'NONE'                                              00115400
              AIF   (K'&IOCTOKEN(1) LE 0).ZG28B  PARM                   00115500
&XIOCTOKEN    SETC  '&IOCTOKEN(1)'              SET XVARIABLE           00115600
              AIF   (N'&IOCTOKEN GT 1).ZG28B    MULTI PARMS             00115700
&XIOCTOKEN    SETC  '&IOCTOKEN'                 SET XVARIABLE           00115800
.ZG28B        ANOP  ,                                                   00115900
.*-------------------------------------------------------------------   00116000
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00116100
              AIF   (K'&ZXIOCTOKEN LE 0).ZG28R  NOT I/O                 00116200
         AIF   ('&XIOCTOKEN' EQ 'NONE').ZG28R                           00116300
              AIF   ('&XIOCTOKEN'(1,1) NE '(').ZG28R                    00116400
&ZCGPR        SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                      00116500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                        00116600
              AIF   (K'&ZCGPR GT 2).ZG28Q                               00116700
              AIF   ('&ZCGPR' EQ '0').ZG28Q                             00116800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00116900
              AIF   (T'&ZCGPR NE 'N').ZG28Q     INVALID REG NAME        00117000
.ZG28P        ANOP  ,                                                   00117100
              AIF   (T'&ZCGPR NE 'N').ZG28R     NON NUMERIC             00117200
              AIF   ('&ZCGPR' LT '2').ZG28Q                             00117300
              AIF   ('&ZCGPR' LE '12').ZG28R                            00117400
.ZG28Q        ANOP  ,                                                   00117500
&ZMS          SETC  '"IOCTOKEN='                *KGPRA* MNOTE           00117600
&ZMS          SETC  '&ZMS.&IOCTOKEN"'                                   00117700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00117800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00117900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00118000
.ZG28R        ANOP  ,                                                   00118100
.*-------------------------------------------------------------------   00118200
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00118300
.ZG30         AIF   ('&XFUNC' NE 'UNPIN').ZG34                          00118400
.*-------------------------------------------------------------------   00118500
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00118600
&ZCVAL        SETC ''           ERROR KEY FIELD                         00118700
.ZG30I0       AIF   (K'&UCBPTR LE 0).ZG30I1                             00118800
&ZCVAL        SETC '&ZCVAL UCBPTR'              DISALLOWED KEY          00118900
.ZG30I1       AIF   (K'&TEXT LE 0).ZG30I2                               00119000
&ZCVAL        SETC '&ZCVAL TEXT'                DISALLOWED KEY          00119100
.ZG30I2       AIF   (K'&COMPID LE 0).ZG30I3                             00119200
&ZCVAL        SETC '&ZCVAL COMPID'              DISALLOWED KEY          00119300
.ZG30I3       AIF   (K'&HELP LE 0).ZG30I4                               00119400
&ZCVAL        SETC '&ZCVAL HELP'                DISALLOWED KEY          00119500
.ZG30I4       AIF   (K'&XLASTING LE 0).ZG30I5                           00119600
&ZCVAL        SETC '&ZCVAL XLASTING'            DISALLOWED KEY          00119700
.ZG30I5       AIF   (K'&XPINPATHS LE 0).ZG30I6                          00119800
&ZCVAL        SETC '&ZCVAL XPINPATHS'           DISALLOWED KEY          00119900
.ZG30I6       AIF   (K'&XNOVAL LE 0).ZG30I7                             00120000
&ZCVAL        SETC '&ZCVAL XNOVAL'              DISALLOWED KEY          00120100
.ZG30I7       AIF   (K'&IOCTOKEN LE 0).ZG30I8                           00120200
&ZCVAL        SETC '&ZCVAL IOCTOKEN'            DISALLOWED KEY          00120300
.ZG30I8       AIF   (K'&TO LE 0).ZG30I9                                 00120400
&ZCVAL        SETC '&ZCVAL TO'  DISALLOWED KEY                          00120500
.ZG30I9       AIF   (K'&FROM LE 0).ZG30I10                              00120600
&ZCVAL        SETC '&ZCVAL FROM'                DISALLOWED KEY          00120700
.ZG30I10      AIF   (K'&ZCVAL LE 0).ZG30J       KEY                     00120800
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00120900
&ZMS          SETC  '"UNPIN'    *KMEIA* MNOTE                           00121000
&ZMS          SETC  '&ZMS."'                                            00121100
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00121200
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00121300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00121400
.ZG30J        ANOP  ,                                                   00121500
.*----------------------------------------------------------------***   00121600
.***AG.KXVAR05 NAME, RQD INOUT, KEYS -XVARIABLE KEY                     00121700
              AIF   (N'&PTOKEN LE 1).ZG32A      CK NUM                  00121800
&ZMS          SETC  '"PTOKEN='  *KPOSA* MNOTE                           00121900
&ZMS          SETC  '&ZMS.&PTOKEN"'                                     00122000
&ZMS          SETC  '&ZMS "PTOKEN"'                                     00122100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00122200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122300
.ZG32A        ANOP  ,                                                   00122400
.*-------------------------------------------------------------------   00122500
.***AG.KXVAR06 NAME, RQD INOUT, KEYS -XVARIABLE                         00122600
&ZXPTOKEN     SETC  'INOUT'     SET IN/OUTPUT                           00122700
&XPTOKEN      SETC  '&PTOKEN(1)'                SET XVARIABLE           00122800
              AIF   (N'&PTOKEN GT 1).ZG32B      MULTI PARMS             00122900
&XPTOKEN      SETC  '&PTOKEN'   SET XVARIABLE                           00123000
.ZG32B        AIF   (K'&PTOKEN(1) GT 0).ZG32C                           00123100
&ZXPTOKEN     SETC  ''          RESET IN/OUTPUT                         00123200
&ZMS          SETC  ' '         *KRQDA*                                 00123300
&ZMS          SETC  '&ZMS "PTOKEN" KEY AND ITS'                         00123400
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00123500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123600
.ZG32C        ANOP  ,                                                   00123700
.*-------------------------------------------------------------------   00123800
.***AG.KCK02 NAME, RQD INOUT, KEYS -GPR OUT OF RANGE                    00123900
              AIF   (K'&ZXPTOKEN LE 0).ZG32R    NOT I/O                 00124000
              AIF   ('&XPTOKEN'(1,1) NE '(').ZG32R                      00124100
&ZCGPR        SETC  '&XPTOKEN'(2,K'&XPTOKEN-2)                          00124200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                        00124300
              AIF   (K'&ZCGPR GT 2).ZG32Q                               00124400
              AIF   ('&ZCGPR' EQ '0').ZG32Q                             00124500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00124600
              AIF   (T'&ZCGPR NE 'N').ZG32Q     INVALID REG NAME        00124700
.ZG32P        ANOP  ,                                                   00124800
              AIF   (T'&ZCGPR NE 'N').ZG32R     NON NUMERIC             00124900
              AIF   ('&ZCGPR' LT '2').ZG32Q                             00125000
              AIF   ('&ZCGPR' LE '12').ZG32R                            00125100
.ZG32Q        ANOP  ,                                                   00125200
&ZMS          SETC  '"PTOKEN='  *KGPRA* MNOTE                           00125300
&ZMS          SETC  '&ZMS.&PTOKEN"'                                     00125400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00125500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00125600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125700
.ZG32R        ANOP  ,                                                   00125800
.*-------------------------------------------------------------------   00125900
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00126000
.ZG34         AIF   ('&XFUNC' NE 'MOVEPIN').ZG39                        00126100
.*-------------------------------------------------------------------   00126200
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00126300
&ZCVAL        SETC ''           ERROR KEY FIELD                         00126400
.ZG34I0       AIF   (K'&UCBPTR LE 0).ZG34I1                             00126500
&ZCVAL        SETC '&ZCVAL UCBPTR'              DISALLOWED KEY          00126600
.ZG34I1       AIF   (K'&TEXT LE 0).ZG34I2                               00126700
&ZCVAL        SETC '&ZCVAL TEXT'                DISALLOWED KEY          00126800
.ZG34I2       AIF   (K'&PTOKEN LE 0).ZG34I3                             00126900
&ZCVAL        SETC '&ZCVAL PTOKEN'              DISALLOWED KEY          00127000
.ZG34I3       AIF   (K'&COMPID LE 0).ZG34I4                             00127100
&ZCVAL        SETC '&ZCVAL COMPID'              DISALLOWED KEY          00127200
.ZG34I4       AIF   (K'&HELP LE 0).ZG34I5                               00127300
&ZCVAL        SETC '&ZCVAL HELP'                DISALLOWED KEY          00127400
.ZG34I5       AIF   (K'&XLASTING LE 0).ZG34I6                           00127500
&ZCVAL        SETC '&ZCVAL XLASTING'            DISALLOWED KEY          00127600
.ZG34I6       AIF   (K'&XPINPATHS LE 0).ZG34I7                          00127700
&ZCVAL        SETC '&ZCVAL XPINPATHS'           DISALLOWED KEY          00127800
.ZG34I7       AIF   (K'&XNOVAL LE 0).ZG34I8                             00127900
&ZCVAL        SETC '&ZCVAL XNOVAL'              DISALLOWED KEY          00128000
.ZG34I8       AIF   (K'&IOCTOKEN LE 0).ZG34I9                           00128100
&ZCVAL        SETC '&ZCVAL IOCTOKEN'            DISALLOWED KEY          00128200
.ZG34I9       AIF   (K'&ZCVAL LE 0).ZG34J       KEY                     00128300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00128400
&ZMS          SETC  '"MOVEPIN'  *KMEIA* MNOTE                           00128500
&ZMS          SETC  '&ZMS."'                                            00128600
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00128700
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00128800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128900
.ZG34J        ANOP  ,                                                   00129000
.*----------------------------------------------------------------***   00129100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00129200
              AIF   (N'&TO LE 1).ZG36A          CK NUM                  00129300
&ZMS          SETC  '"TO='      *KPOSA* MNOTE                           00129400
&ZMS          SETC  '&ZMS.&TO"'                                         00129500
&ZMS          SETC  '&ZMS "TO"'                                         00129600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00129700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00129800
.ZG36A        ANOP  ,                                                   00129900
.*-------------------------------------------------------------------   00130000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00130100
&ZXTO         SETC  'INPUT'     SET IN/OUTPUT                           00130200
&XTO          SETC  '&TO(1)'    SET XVARIABLE                           00130300
              AIF   (N'&TO GT 1).ZG36B          MULTI PARMS             00130400
&XTO          SETC  '&TO'       SET XVARIABLE                           00130500
.ZG36B        AIF   (K'&TO(1) GT 0).ZG36C                               00130600
&ZXTO         SETC  ''          RESET IN/OUTPUT                         00130700
&ZMS          SETC  ' '         *KRQDA*                                 00130800
&ZMS          SETC  '&ZMS "TO" KEY AND ITS'                             00130900
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00131000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131100
.ZG36C        ANOP  ,                                                   00131200
.*-------------------------------------------------------------------   00131300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00131400
              AIF   (K'&ZXTO LE 0).ZG36R        NOT I/O                 00131500
              AIF   ('&XTO'(1,1) NE '(').ZG36R                          00131600
&ZCGPR        SETC  '&XTO'(2,K'&XTO-2)                                  00131700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG36P                        00131800
              AIF   (K'&ZCGPR GT 2).ZG36Q                               00131900
              AIF   ('&ZCGPR' EQ '0').ZG36Q                             00132000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00132100
              AIF   (T'&ZCGPR NE 'N').ZG36Q     INVALID REG NAME        00132200
.ZG36P        ANOP  ,                                                   00132300
              AIF   (T'&ZCGPR NE 'N').ZG36R     NON NUMERIC             00132400
              AIF   ('&ZCGPR' LT '2').ZG36Q                             00132500
              AIF   ('&ZCGPR' LE '12').ZG36R                            00132600
.ZG36Q        ANOP  ,                                                   00132700
&ZMS          SETC  '"TO='      *KGPRA* MNOTE                           00132800
&ZMS          SETC  '&ZMS.&TO"'                                         00132900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00133000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00133100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133200
.ZG36R        ANOP  ,                                                   00133300
.*----------------------------------------------------------------***   00133400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00133500
              AIF   (N'&FROM LE 1).ZG37A        CK NUM                  00133600
&ZMS          SETC  '"FROM='    *KPOSA* MNOTE                           00133700
&ZMS          SETC  '&ZMS.&FROM"'                                       00133800
&ZMS          SETC  '&ZMS "FROM"'                                       00133900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00134000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134100
.ZG37A        ANOP  ,                                                   00134200
.*-------------------------------------------------------------------   00134300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00134400
&ZXFROM       SETC  'INPUT'     SET IN/OUTPUT                           00134500
&XFROM        SETC  '&FROM(1)'  SET XVARIABLE                           00134600
              AIF   (N'&FROM GT 1).ZG37B        MULTI PARMS             00134700
&XFROM        SETC  '&FROM'     SET XVARIABLE                           00134800
.ZG37B        AIF   (K'&FROM(1) GT 0).ZG37C                             00134900
&ZXFROM       SETC  ''          RESET IN/OUTPUT                         00135000
&ZMS          SETC  ' '         *KRQDA*                                 00135100
&ZMS          SETC  '&ZMS "FROM" KEY AND ITS'                           00135200
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00135300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00135400
.ZG37C        ANOP  ,                                                   00135500
.*-------------------------------------------------------------------   00135600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00135700
              AIF   (K'&ZXFROM LE 0).ZG37R      NOT I/O                 00135800
              AIF   ('&XFROM'(1,1) NE '(').ZG37R                        00135900
&ZCGPR        SETC  '&XFROM'(2,K'&XFROM-2)                              00136000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                        00136100
              AIF   (K'&ZCGPR GT 2).ZG37Q                               00136200
              AIF   ('&ZCGPR' EQ '0').ZG37Q                             00136300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00136400
              AIF   (T'&ZCGPR NE 'N').ZG37Q     INVALID REG NAME        00136500
.ZG37P        ANOP  ,                                                   00136600
              AIF   (T'&ZCGPR NE 'N').ZG37R     NON NUMERIC             00136700
              AIF   ('&ZCGPR' LT '2').ZG37Q                             00136800
              AIF   ('&ZCGPR' LE '12').ZG37R                            00136900
.ZG37Q        ANOP  ,                                                   00137000
&ZMS          SETC  '"FROM='    *KGPRA* MNOTE                           00137100
&ZMS          SETC  '&ZMS.&FROM"'                                       00137200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00137300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00137400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00137500
.ZG37R        ANOP  ,                                                   00137600
.*-------------------------------------------------------------------   00137700
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00137800
.ZG39         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00137900
.*----------------------------------------------------------------***   00138000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00138100
              AIF   (N'&LINKAGE LE 1).ZG41A     CK NUM                  00138200
&ZMS          SETC  '"LINKAGE='                 *KPOSA* MNOTE           00138300
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    00138400
&ZMS          SETC  '&ZMS "LINKAGE"'                                    00138500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00138600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00138700
.ZG41A        ANOP  ,                                                   00138800
.*-------------------------------------------------------------------   00138900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00139000
&XLINKAGE     SETC  ''          INITIALIZE XVARIABLE                    00139100
.ZG42A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG43A                        00139200
&XLINKAGE     SETC  'SYSTEM'    SET KEYWORD                             00139300
.*-------------------------------------------------------------------   00139400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00139500
.ZG43A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG44A                        00139600
&XLINKAGE     SETC  'BRANCH'    SET KEYWORD                             00139700
.*-------------------------------------------------------------------   00139800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00139900
.ZG44A        AIF   (K'&XLINKAGE GT 0).ZG44C    KEYWORD                 00140000
              AIF   (K'&LINKAGE(1) LE 0).ZG44B                          00140100
&ZMS          SETC  '"LINKAGE='                 *KUKWA* MNOTE           00140200
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    00140300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00140400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00140500
&ZMS          SETC  '&ZMS "SYSTEM"'                                     00140600
&ZMS          SETC  '&ZMS OR "BRANCH".'                                 00140700
              MNOTE 8,' &ZMS '                                          00140800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140900
.ZG44B        ANOP  ,                                                   00141000
&XLINKAGE     SETC  'SYSTEM'    SET DEFAULT KEYWORD                     00141100
.ZG44C        ANOP  ,                                                   00141200
&ZXLINKAGE    SETC  'INPUT'     SET IN/OUTPUT                           00141300
.*----------------------------------------------------------------***   00141400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00141500
              AIF   (N'&RETCODE LE 1).ZG46A     CK NUM                  00141600
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00141700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00141800
&ZMS          SETC  '&ZMS "RETCODE"'                                    00141900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00142000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00142100
.ZG46A        ANOP  ,                                                   00142200
.*-------------------------------------------------------------------   00142300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00142400
              AIF   (K'&RETCODE(1) LE 0).ZG46C  NO PARM                 00142500
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00142600
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00142700
              AIF   (N'&RETCODE GT 1).ZG46C                             00142800
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00142900
.ZG46C        ANOP  ,                                                   00143000
.*-------------------------------------------------------------------   00143100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00143200
              AIF   (K'&ZXRETCODE LE 0).ZG46R   NOT I/O                 00143300
              AIF   ('&XRETCODE'(1,1) NE '(').ZG46R                     00143400
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00143500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                        00143600
              AIF   (K'&ZCGPR GT 2).ZG46Q                               00143700
              AIF   ('&ZCGPR' EQ '0').ZG46Q                             00143800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00143900
              AIF   (T'&ZCGPR NE 'N').ZG46Q     INVALID REG NAME        00144000
.ZG46P        ANOP  ,                                                   00144100
              AIF   (T'&ZCGPR NE 'N').ZG46R     NON NUMERIC             00144200
              AIF   ('&ZCGPR' LT '2').ZG46Q                             00144300
              AIF   ('&ZCGPR' LE '12').ZG46R                            00144400
.ZG46Q        ANOP  ,                                                   00144500
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00144600
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00144700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00144800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00144900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145000
.ZG46R        ANOP  ,                                                   00145100
.*----------------------------------------------------------------***   00145200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00145300
              AIF   (N'&RSNCODE LE 1).ZG49A     CK NUM                  00145400
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00145500
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00145600
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00145700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00145800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145900
.ZG49A        ANOP  ,                                                   00146000
.*-------------------------------------------------------------------   00146100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00146200
              AIF   (K'&RSNCODE(1) LE 0).ZG49C  NO PARM                 00146300
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00146400
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00146500
              AIF   (N'&RSNCODE GT 1).ZG49C                             00146600
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00146700
.ZG49C        ANOP  ,                                                   00146800
.*-------------------------------------------------------------------   00146900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00147000
              AIF   (K'&ZXRSNCODE LE 0).ZG49R   NOT I/O                 00147100
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG49R                     00147200
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00147300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                        00147400
              AIF   (K'&ZCGPR GT 2).ZG49Q                               00147500
              AIF   ('&ZCGPR' EQ '0').ZG49Q                             00147600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00147700
              AIF   (T'&ZCGPR NE 'N').ZG49Q     INVALID REG NAME        00147800
.ZG49P        ANOP  ,                                                   00147900
              AIF   (T'&ZCGPR NE 'N').ZG49R     NON NUMERIC             00148000
              AIF   ('&ZCGPR' LT '2').ZG49Q                             00148100
              AIF   ('&ZCGPR' LE '12').ZG49R                            00148200
.ZG49Q        ANOP  ,                                                   00148300
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00148400
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00148500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00148600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00148700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148800
.ZG49R        ANOP  ,                                                   00148900
.******************************************************************     00149000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00149100
.******************************************************************     00149200
              ACTR  10000                                               00149300
.*-------------------------------------------------------------------   00149400
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00149500
&ZCVAL        SETC  ''          ERROR FIELD                             00149600
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00149700
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00149800
.ZGLIST2      ANOP  ,                                                   00149900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00150000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00150100
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00150200
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00150300
              AIF   (&ZAWRK LE 0).ZGLIST2                               00150400
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00150500
              AGO   .ZGLIST2                                            00150600
.*                                                                      00150700
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00150800
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00150900
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00151000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00151100
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00151200
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00151300
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00151400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151500
.ZGLISTX      ANOP  ,                                                   00151600
&ZASYSLNDX    SETA  0                                                   00151700
.*-------------------------------------------------------------------   00151800
.***AG.MF04 MF=(SLE)                                                    00151900
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00152000
.*******************************************************************    00152100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00152200
.*******************************************************************    00152300
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00152400
.*******************************************************************    00152500
.***AE.01  START OF UCBPIN MACRO CODE                                   00152600
.*******************************************************************    00152700
              LCLC  &M0M0001                 NAME                       00152800
&M0M0001      SETC  '&XLABEL'                SET NAME                   00152900
              AIF   (K'&XLABEL NE 0).XLAB2                              00153000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00153100
.*                                                                      00153200
.XLAB2        ANOP  ,                                                   00153300
              AIF   ('&XMF' EQ 'L').XLAB3                               00153400
&M0M0001 DS    0H                             UCBPIN-1                  00153500
.XLAB3        ANOP  ,                                                   00153600
.*******************************************************************    00153700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00153800
.*******************************************************************    00153900
              PUSH  PRINT                                               00154000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00154100
              PRINT OFF         ++ PR01                                 00154200
              AGO   .ZPRNTXX                                            00154300
.ZPRINTX      PRINT ON                                                  00154400
.ZPRNTXX      ANOP  ,                                                   00154500
.********************************************************************   00154600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00154700
.********************************************************************   00154800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00154900
                      LCLA  &ZOPN1         INVOCATION INDEX             00155000
                      LCLC  &ZOPL(4095)    LABEL                        00155100
                      LCLC  &ZOPO(4095)    OPERATION                    00155200
                      LCLC  &ZOPV(4095)    VALUE                        00155300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00155400
.*                                                                      00155500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00155600
.******************************************************************     00155700
.***AL.L10 UCBPIN FMT=LIST MF=S|L PARAMETERS                            00155800
.******************************************************************     00155900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00156000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00156100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00156200
&XMFATTR              SETC  '0D'                                        00156300
.*                                                                      00156400
&ZOPN                 SETA  &ZOPN+1                                     00156500
&ZOPL(&ZOPN)          SETC  ' '                                         00156600
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00156700
&ZOPO(&ZOPN)          SETC  'B'                                         00156800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00156900
                      AGO   .ZALVL6B                                    00157000
.ZALVL6A              ANOP                                              00157100
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00157200
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00157300
.ZALVL6B              ANOP                                              00157400
&ZOPD(&ZOPN)          SETC  '++ UCBPIN ARG PARMS'                       00157500
.*                                                                      00157600
&ZOPN                 SETA  &ZOPN+1                                     00157700
&ZOPL(&ZOPN)          SETC  ' '                                         00157800
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00157900
&ZOPV(&ZOPN)          SETC  '1'                                         00158000
&ZOPD(&ZOPN)          SETC  ' '                                         00158100
.*                                                                      00158200
.ZLMFSL2              ANOP  ,                                           00158300
.*-------------------------------------------------------------------   00158400
.***AM.L00  UCBPIN FMT=LIST name                                        00158500
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00158600
&ZOPN                 SETA &ZOPN+1                                      00158700
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00158800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00158900
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00159000
&ZOPD(&ZOPN)          SETC '++ UCBPIN NAME'                             00159100
.ZLMFSL2M             ANOP  ,                                           00159200
.*-------------------------------------------------------------------   00159300
.***AM.L01  UCBPIN FMT=LIST PARAMETERS                                  00159400
&ZOPN                 SETA &ZOPN+1                                      00159500
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00159600
&ZOPO(&ZOPN)          SETC 'DS'                                         00159700
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00159800
&ZOPD(&ZOPN)          SETC '++ UCBPIN PARM LIST'                        00159900
.*-------------------------------------------------------------------   00160000
.***AM.L02 XVERSION XL1                                                 00160100
&ZOPN                 SETA &ZOPN+1                                      00160200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00160300
&ZOPO(&ZOPN)          SETC 'DS'                                         00160400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00160500
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00160600
.*-------------------------------------------------------------------   00160700
.***AM.L03 XFLAGS BL.8                                                  00160800
&ZOPN                 SETA &ZOPN+1                                      00160900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00161000
&ZOPO(&ZOPN)          SETC 'DS'                                         00161100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00161200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00161300
.*                                                                      00161400
&ZOPN                 SETA  &ZOPN+1                                     00161500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PIN'                     00161600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00161700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00161800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00161900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PIN'                          00162000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00162100
.*                                                                      00162200
&ZOPN                 SETA  &ZOPN+1                                     00162300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UNPIN'                   00162400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00162500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00162600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00162700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UNPIN'                        00162800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00162900
.*                                                                      00163000
&ZOPN                 SETA  &ZOPN+1                                     00163100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_LASTING'                 00163200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00163300
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00163400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00163500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LASTING'                      00163600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00163700
.*                                                                      00163800
&ZOPN                 SETA  &ZOPN+1                                     00163900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_COMPID'                  00164000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00164100
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00164200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00164300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMPID'                       00164400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00164500
.*                                                                      00164600
&ZOPN                 SETA  &ZOPN+1                                     00164700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_HELP'                    00164800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00164900
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00165000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00165100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).HELP'                         00165200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00165300
.*                                                                      00165400
&ZOPN                 SETA  &ZOPN+1                                     00165500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PINPATHS'                00165600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00165700
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00165800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00165900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PINPATHS'                     00166000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00166100
.*                                                                      00166200
&ZOPN                 SETA  &ZOPN+1                                     00166300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_NOVAL'                   00166400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00166500
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00166600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00166700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NOVAL'                        00166800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00166900
.*                                                                      00167000
&ZOPN                 SETA  &ZOPN+1                                     00167100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MOVEPIN'                 00167200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00167300
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00167400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00167500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MOVEPIN'                      00167600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00167700
.*-------------------------------------------------------------------   00167800
.***AM.L09  XCOMPID CL5                                                 00167900
&ZOPN                 SETA &ZOPN+1                                      00168000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPID'                          00168100
&ZOPO(&ZOPN)          SETC 'DS'                                         00168200
&ZOPV(&ZOPN)          SETC 'CL5'                                        00168300
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPID  XCOMPID'                      00168400
.*-------------------------------------------------------------------   00168500
.***AM.L09  XRESERVED1 CL1                                              00168600
&ZOPN                 SETA &ZOPN+1                                      00168700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00168800
&ZOPO(&ZOPN)          SETC 'DS'                                         00168900
&ZOPV(&ZOPN)          SETC 'CL1'                                        00169000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 00169100
.*-------------------------------------------------------------------   00169200
.***AM.L09  XUCBPTR A                                                   00169300
&ZOPN                 SETA &ZOPN+1                                      00169400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPTR'                          00169500
&ZOPO(&ZOPN)          SETC 'DS'                                         00169600
&ZOPV(&ZOPN)          SETC 'A'                                          00169700
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPTR  XUCBPTR'                      00169800
.*-------------------------------------------------------------------   00169900
.***AM.L09  XAREA1 CL42                                                 00170000
&ZOPN                 SETA &ZOPN+1                                      00170100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAREA1'                           00170200
&ZOPO(&ZOPN)          SETC 'DS'                                         00170300
&ZOPV(&ZOPN)          SETC 'CL42'                                       00170400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XAREA1'                     00170500
.*-------------------------------------------------------------------   00170600
.***AM.MLM1 SAVED LOCATION COUNTER                                      00170700
                      AIF  ('&ZENDBASEPL' NE '').ZL15LB                 00170800
&ZENDBASEPL           SETC 'YES'                                        00170900
&ZOPN                 SETA &ZOPN+1                                      00171000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00171100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00171200
&ZOPV(&ZOPN)          SETC '*'                                          00171300
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00171400
.ZL15LB               ANOP  ,                                           00171500
.*-------------------------------------------------------------------   00171600
.***AM.PJR1 DEFINED ON XAREA1                                           00171700
&ZOPN                 SETA &ZOPN+1                                      00171800
&ZOPL(&ZOPN)          SETC ' '                                          00171900
&ZOPO(&ZOPN)          SETC 'ORG'                                        00172000
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+12'                               00172100
&ZOPD(&ZOPN)          SETC ' '                                          00172200
.*-------------------------------------------------------------------   00172300
.***AM.L09 ADDR XTEXT A                                                 00172400
&ZOPN                 SETA &ZOPN+1                                      00172500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTEXT_ADDR'                       00172600
&ZOPO(&ZOPN)          SETC 'DS'                                         00172700
&ZOPV(&ZOPN)          SETC 'A'                                          00172800
&ZOPD(&ZOPN)          SETC '++ &ZXTEXT ADDR XTEXT'                      00172900
.*-------------------------------------------------------------------   00173000
.***AM.L09 ALET XTEXT F                                                 00173100
&ZOPN                 SETA &ZOPN+1                                      00173200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTEXT_ALET'                       00173300
&ZOPO(&ZOPN)          SETC 'DS'                                         00173400
&ZOPV(&ZOPN)          SETC 'F'                                          00173500
&ZOPD(&ZOPN)          SETC '++ &ZXTEXT ALET XTEXT'                      00173600
.*-------------------------------------------------------------------   00173700
.***AM.L09  XPTOKEN CL8                                                 00173800
&ZOPN                 SETA &ZOPN+1                                      00173900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPTOKEN'                          00174000
&ZOPO(&ZOPN)          SETC 'DS'                                         00174100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00174200
&ZOPD(&ZOPN)          SETC '++ &ZXPTOKEN  XPTOKEN'                      00174300
.*-------------------------------------------------------------------   00174400
.***AM.L09  XHELP CL8                                                   00174500
&ZOPN                 SETA &ZOPN+1                                      00174600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XHELP'                            00174700
&ZOPO(&ZOPN)          SETC 'DS'                                         00174800
&ZOPV(&ZOPN)          SETC 'CL8'                                        00174900
&ZOPD(&ZOPN)          SETC '++ &ZXHELP  XHELP'                          00175000
.*-------------------------------------------------------------------   00175100
.***AM.L09 ADDR XIOCTOKEN A                                             00175200
&ZOPN                 SETA &ZOPN+1                                      00175300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ADDR'                   00175400
&ZOPO(&ZOPN)          SETC 'DS'                                         00175500
&ZOPV(&ZOPN)          SETC 'A'                                          00175600
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ADDR XIOCTOKEN'              00175700
.*-------------------------------------------------------------------   00175800
.***AM.L09 ALET XIOCTOKEN F                                             00175900
&ZOPN                 SETA &ZOPN+1                                      00176000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ALET'                   00176100
&ZOPO(&ZOPN)          SETC 'DS'                                         00176200
&ZOPV(&ZOPN)          SETC 'F'                                          00176300
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ALET XIOCTOKEN'              00176400
.*-------------------------------------------------------------------   00176500
.***AM.L09  XRESERVED3 CL8                                              00176600
&ZOPN                 SETA &ZOPN+1                                      00176700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED3'                       00176800
&ZOPO(&ZOPN)          SETC 'DS'                                         00176900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00177000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED3'                 00177100
.*-------------------------------------------------------------------   00177200
.***AM.PJR1 DEFINED ON XAREA1                                           00177300
&ZOPN                 SETA &ZOPN+1                                      00177400
&ZOPL(&ZOPN)          SETC ' '                                          00177500
&ZOPO(&ZOPN)          SETC 'ORG'                                        00177600
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+12'                               00177700
&ZOPD(&ZOPN)          SETC ' '                                          00177800
.*-------------------------------------------------------------------   00177900
.***AM.L09  XFROM A                                                     00178000
&ZOPN                 SETA &ZOPN+1                                      00178100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFROM'                            00178200
&ZOPO(&ZOPN)          SETC 'DS'                                         00178300
&ZOPV(&ZOPN)          SETC 'A'                                          00178400
&ZOPD(&ZOPN)          SETC '++ &ZXFROM  XFROM'                          00178500
.*-------------------------------------------------------------------   00178600
.***AM.L09  XTO A                                                       00178700
&ZOPN                 SETA &ZOPN+1                                      00178800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTO'                              00178900
&ZOPO(&ZOPN)          SETC 'DS'                                         00179000
&ZOPV(&ZOPN)          SETC 'A'                                          00179100
&ZOPD(&ZOPN)          SETC '++ &ZXTO  XTO'                              00179200
.*-------------------------------------------------------------------   00179300
.***AM.L09  XRESERVED4 CL32                                             00179400
&ZOPN                 SETA &ZOPN+1                                      00179500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED4'                       00179600
&ZOPO(&ZOPN)          SETC 'DS'                                         00179700
&ZOPV(&ZOPN)          SETC 'CL32'                                       00179800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED4'                 00179900
&ZOPN                 SETA &ZOPN+1                                      00180000
&ZOPL(&ZOPN)          SETC ' '                                          00180100
&ZOPO(&ZOPN)          SETC 'ORG'                                        00180200
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00180300
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00180400
.*-------------------------------------------------------------------   00180500
.***AM.L10 END OF UCBPIN LIST PARAMETERS                                00180600
&ZOPN                 SETA &ZOPN+1                                      00180700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00180800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00180900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00181000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00181100
.*                                                                      00181200
&ZOPN                 SETA &ZOPN+1                                      00181300
&ZOPL(&ZOPN)          SETC ' '                                          00181400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00181500
&ZOPV(&ZOPN)          SETC '1'                                          00181600
&ZOPD(&ZOPN)          SETC ' '                                          00181700
.*-------------------------------------------------------------------   00181800
.***AL.L12 UCBPIN FMT=LIST MF=S|L PARAMETERS                            00181900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00182000
.*                                                                      00182100
&ZOPN                 SETA  &ZOPN+1                                     00182200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00182300
&ZOPO(&ZOPN)          SETC  'DC'                                        00182400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00182500
&ZOPD(&ZOPN)          SETC  '++ UCBPIN ARG PARMS'                       00182600
.*                                                                      00182700
.ZLMFSLX              ANOP  ,                                           00182800
.*-------------------------------------------------------------------   00182900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00183000
&ZPLLEN               SETA 54                                           00183100
.*                                                                      00183200
.******************************************************************     00183300
.***AI.L01 UCBPIN FMT=LIST FILL IN PARAMETER AREA                       00183400
.******************************************************************     00183500
                      ACTR  10000                                       00183600
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00183700
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00183800
&ZCVAL                SETC  'LAE'          XAX MODE                     00183900
.ZIMFXA               ANOP ,                                            00184000
.*                                                                      00184100
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00184200
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00184300
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00184400
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00184500
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00184600
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00184700
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00184800
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00184900
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00185000
&ZOPN                 SETA  &ZOPN+1                                     00185100
&ZOPL(&ZOPN)          SETC  ' '                                         00185200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00185300
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00185400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00185500
                      AGO   .ZIMFNX                                     00185600
.*                                                                      00185700
.ZIMFN2               ANOP ,                                            00185800
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00185900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00186000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00186100
&ZOPN                 SETA  &ZOPN+1                                     00186200
&ZOPL(&ZOPN)          SETC  ' '                                         00186300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00186400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00186500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00186600
                      AGO   .ZIMFNX                                     00186700
.ZIMFNX1              ANOP ,                                            00186800
&ZOPN                 SETA  &ZOPN+1                                     00186900
&ZOPL(&ZOPN)          SETC  ' '                                         00187000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00187100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00187200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00187300
.ZIMFNX               ANOP ,                                            00187400
.********************************************************************   00187500
.***AI.L02 UCBPIN FMT=LIST INITIALIZE PARAMETER AREA                    00187600
.********************************************************************   00187700
.***AI.L03 MF=(SLE)                                                     00187800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00187900
.*                                                                      00188000
&ZOPN                 SETA  &ZOPN+1                                     00188100
&ZOPL(&ZOPN)          SETC  ' '                                         00188200
&ZOPO(&ZOPN)          SETC  'XC'                                        00188300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00188400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00188500
.ZIMFLX               ANOP  ,                                           00188600
.*-------------------------------------------------------------------   00188700
.***AI.L04B XVERSION XL1                                                00188800
&ZOPN                 SETA  &ZOPN+1                                     00188900
&ZOPL(&ZOPN)          SETC  ' '                                         00189000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00189100
&ZOPV(&ZOPN)          SETC  '0(1),1'                                    00189200
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00189300
.*-------------------------------------------------------------------   00189400
.***AI.L05 XFLAGS BL1                                                   00189500
&ZW                   SETC  ''                                          00189600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00189700
.*-------------------------------------------------------------------   00189800
.***AI.L08 XFLAGS "PIN"                                                 00189900
.***      BL1'1XXXXXXX'                                                 00190000
         AIF   ('&XPIN' EQ '').ZI3A                                     00190100
         AIF   ('&XPIN' EQ '').ZI3A                                     00190200
&ZW                   SETC  '&ZW.1'                                     00190300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00190400
                      AGO   .ZI3C                                       00190500
.*                                                                      00190600
.ZI3A                 ANOP  ,                                           00190700
&ZW                   SETC  '&ZW.0'                                     00190800
.ZI3C                 ANOP  ,                                           00190900
.*-------------------------------------------------------------------   00191000
.***AI.L08 XFLAGS "UNPIN"                                               00191100
.***      BL1'X1XXXXXX'                                                 00191200
         AIF   ('&XUNPIN' EQ '').ZI4A                                   00191300
         AIF   ('&XUNPIN' EQ '').ZI4A                                   00191400
&ZW                   SETC  '&ZW.1'                                     00191500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00191600
                      AGO   .ZI4C                                       00191700
.*                                                                      00191800
.ZI4A                 ANOP  ,                                           00191900
&ZW                   SETC  '&ZW.0'                                     00192000
.ZI4C                 ANOP  ,                                           00192100
.*-------------------------------------------------------------------   00192200
.***AI.L08 XFLAGS "LASTING"                                             00192300
.***      BL1'XX1XXXXX'                                                 00192400
         AIF   ('&XLASTING' EQ '').ZI5A                                 00192500
         AIF   ('&XLASTING' EQ 'NONE').ZI5A                             00192600
&ZW                   SETC  '&ZW.1'                                     00192700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00192800
                      AGO   .ZI5C                                       00192900
.*                                                                      00193000
.ZI5A                 ANOP  ,                                           00193100
&ZW                   SETC  '&ZW.0'                                     00193200
.ZI5C                 ANOP  ,                                           00193300
.*-------------------------------------------------------------------   00193400
.***AI.L08 XFLAGS "COMPID"                                              00193500
.***      BL1'XXX1XXXX'                                                 00193600
         AIF   ('&COMPID' EQ '').ZI6A                                   00193700
         AIF   ('&COMPID' EQ 'NONE').ZI6A                               00193800
&ZW                   SETC  '&ZW.1'                                     00193900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00194000
                      AGO   .ZI6C                                       00194100
.*                                                                      00194200
.ZI6A                 ANOP  ,                                           00194300
&ZW                   SETC  '&ZW.0'                                     00194400
.ZI6C                 ANOP  ,                                           00194500
.*-------------------------------------------------------------------   00194600
.***AI.L08 XFLAGS "HELP"                                                00194700
.***      BL1'XXXX1XXX'                                                 00194800
         AIF   ('&HELP' EQ '').ZI7A                                     00194900
         AIF   ('&HELP' EQ 'NONE').ZI7A                                 00195000
&ZW                   SETC  '&ZW.1'                                     00195100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00195200
                      AGO   .ZI7C                                       00195300
.*                                                                      00195400
.ZI7A                 ANOP  ,                                           00195500
&ZW                   SETC  '&ZW.0'                                     00195600
.ZI7C                 ANOP  ,                                           00195700
.*-------------------------------------------------------------------   00195800
.***AI.L08 XFLAGS "PINPATHS"                                            00195900
.***      BL1'XXXXX1XX'                                                 00196000
         AIF   ('&XPINPATHS' EQ '').ZI8A                                00196100
         AIF   ('&XPINPATHS' EQ 'NONE').ZI8A                            00196200
&ZW                   SETC  '&ZW.1'                                     00196300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00196400
                      AGO   .ZI8C                                       00196500
.*                                                                      00196600
.ZI8A                 ANOP  ,                                           00196700
&ZW                   SETC  '&ZW.0'                                     00196800
.ZI8C                 ANOP  ,                                           00196900
.*-------------------------------------------------------------------   00197000
.***AI.L08 XFLAGS "NOVAL"                                               00197100
.***      BL1'XXXXXX1X'                                                 00197200
         AIF   ('&XNOVAL' EQ '').ZI9A                                   00197300
         AIF   ('&XNOVAL' EQ 'NONE').ZI9A                               00197400
&ZW                   SETC  '&ZW.1'                                     00197500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00197600
                      AGO   .ZI9C                                       00197700
.*                                                                      00197800
.ZI9A                 ANOP  ,                                           00197900
&ZW                   SETC  '&ZW.0'                                     00198000
.ZI9C                 ANOP  ,                                           00198100
.*-------------------------------------------------------------------   00198200
.***AI.L08 XFLAGS "MOVEPIN"                                             00198300
.***      BL1'XXXXXXX1'                                                 00198400
         AIF   ('&XMOVEPIN' EQ '').ZI10A                                00198500
         AIF   ('&XMOVEPIN' EQ 'NONE').ZI10A                            00198600
&ZW                   SETC  '&ZW.1'                                     00198700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00198800
                      AGO   .ZI10C                                      00198900
.*                                                                      00199000
.ZI10A                ANOP  ,                                           00199100
&ZW                   SETC  '&ZW.0'                                     00199200
.ZI10C                ANOP  ,                                           00199300
.*-------------------------------------------------------------------   00199400
.***AI.L11 XFLAGS BL1                                                   00199500
                      AIF   ('&ZCLNG' NE 'YES').ZI10E  ALL ZERO BITS    00199600
&ZOPN                 SETA  &ZOPN+1                                     00199700
&ZOPL(&ZOPN)          SETC  ' '                                         00199800
&ZOPO(&ZOPN)          SETC  'OI'                                        00199900
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00200000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00200100
.ZI10E                ANOP  ,                                           00200200
.*-------------------------------------------------------------------   00200300
.***AI.L18  XCOMPID CL5                                                 00200400
         AIF   ('&XCOMPID' NE 'NONE').ZI11                              00200500
&ZXCOMPID             SETC  ''             RESET INPUT/OUTPUT           00200600
.ZI11                 ANOP  ,                                           00200700
.*-------------------------------------------------------------------   00200800
.***AI.L25  XCOMPID CL5                                                 00200900
                      AIF   ('&ZXCOMPID' EQ '').ZI11E                   00201000
                      AIF   ('&ZXCOMPID' EQ 'OUTPUT').ZI11E             00201100
&ZCGPR                SETC  '&XCOMPID'                                  00201200
.*                                                                      00201300
&ZOPN                 SETA  &ZOPN+1                                     00201400
&ZOPL(&ZOPN)          SETC  ' '                                         00201500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00201600
&ZOPV(&ZOPN)          SETC  '2(5,1),&ZCGPR'                             00201700
&ZOPD(&ZOPN)          SETC  '++ &ZXCOMPID XCOMPID'                      00201800
.*                                                                      00201900
.ZI11E                ANOP  ,                                           00202000
.*-------------------------------------------------------------------   00202100
.***AI.L25  XUCBPTR AL4                                                 00202200
                      AIF   ('&ZXUCBPTR' EQ '').ZI13E                   00202300
                      AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZI13E             00202400
&ZCGPR                SETC  '&XUCBPTR'                                  00202500
.*                                                                      00202600
                      AIF   ('&XUCBPTR'(1,1) NE '(').ZI13B              00202700
&ZCGPR   SETC  '0('.'&XUCBPTR'(2,K'&XUCBPTR-2).')'                      00202800
                      AGO   .ZI13D                                      00202900
.ZI13B                ANOP  ,                                           00203000
.*                                                                      00203100
&ZC                   SETC  '&XUCBPTR'(1,1)                             00203200
                      AIF   (T'&ZC NE 'N').ZI13D                        00203300
&ZC                   SETC  '&XUCBPTR'                                  00203400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00203500
&ZCGPR                SETC  '=AL4(&XUCBPTR)'                            00203600
.*                                                                      00203700
.ZI13D                ANOP  ,                                           00203800
.*                                                                      00203900
&ZOPN                 SETA  &ZOPN+1                                     00204000
&ZOPL(&ZOPN)          SETC  ' '                                         00204100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00204200
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00204300
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPTR XUCBPTR'                      00204400
.*                                                                      00204500
.ZI13E                ANOP  ,                                           00204600
.*-------------------------------------------------------------------   00204700
.***AI.L19 ADDR XTEXT A                                                 00204800
                      AIF   ('&ZXTEXT' EQ '').ZI16H                     00204900
&ZCLNG                SETC  '&XTEXT'                                    00205000
&ZCGPR                SETC  '14'                                        00205100
.*                                                                      00205200
&ZOPN                 SETA  &ZOPN+1                                     00205300
&ZOPL(&ZOPN)          SETC  ' '                                         00205400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00205500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00205600
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00205700
.*                                                                      00205800
&ZOPN                 SETA  &ZOPN+1                                     00205900
&ZOPL(&ZOPN)          SETC  ' '                                         00206000
&ZOPO(&ZOPN)          SETC  'ST'                                        00206100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00206200
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00206300
.*                                                                      00206400
.ZI16H                ANOP  ,                                           00206500
.*-------------------------------------------------------------------   00206600
.***AI.L24 ALET XTEXT F                                                 00206700
         AIF   ('&ZXTEXT' EQ '').ZI17G                                  00206800
         AIF   ('&SYSASCE' EQ 'P').ZI17G   SYSSTATE PRIMARY             00206900
&ZCLNG                SETC  '&XTEXT'                                    00207000
.*                                                                      00207100
&ZCGPR                SETC  '14'                                        00207200
.*                                                                      00207300
&ZOPN                 SETA  &ZOPN+1                                     00207400
&ZOPL(&ZOPN)          SETC  ' '                                         00207500
&ZOPO(&ZOPN)          SETC  'STAM'                                      00207600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,16(1)'                       00207700
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00207800
.*                                                                      00207900
.ZI17G                ANOP  ,                                           00208000
.*-------------------------------------------------------------------   00208100
.***AI.L25  XPTOKEN CL8                                                 00208200
                      AIF   ('&ZXPTOKEN' EQ '').ZI18E                   00208300
                      AIF   ('&ZXPTOKEN' EQ 'OUTPUT').ZI18E             00208400
&ZCGPR                SETC  '&XPTOKEN'                                  00208500
.*                                                                      00208600
                      AIF   ('&XPTOKEN'(1,1) NE '(').ZI18B              00208700
&ZCGPR   SETC  '0('.'&XPTOKEN'(2,K'&XPTOKEN-2).')'                      00208800
.ZI18B                ANOP  ,                                           00208900
.*                                                                      00209000
&ZOPN                 SETA  &ZOPN+1                                     00209100
&ZOPL(&ZOPN)          SETC  ' '                                         00209200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00209300
&ZOPV(&ZOPN)          SETC  '20(8,1),&ZCGPR'                            00209400
&ZOPD(&ZOPN)          SETC  '++ &ZXPTOKEN XPTOKEN'                      00209500
.*                                                                      00209600
.ZI18E                ANOP  ,                                           00209700
.*-------------------------------------------------------------------   00209800
.***AI.L18  XHELP CL8                                                   00209900
         AIF   ('&XHELP' NE 'NONE').ZI19                                00210000
&ZXHELP               SETC  ''             RESET INPUT/OUTPUT           00210100
.ZI19                 ANOP  ,                                           00210200
.*-------------------------------------------------------------------   00210300
.***AI.L25  XHELP CL8                                                   00210400
                      AIF   ('&ZXHELP' EQ '').ZI19E                     00210500
                      AIF   ('&ZXHELP' EQ 'OUTPUT').ZI19E               00210600
&ZCGPR                SETC  '&XHELP'                                    00210700
.*                                                                      00210800
                      AIF   ('&XHELP'(1,1) NE '(').ZI19B                00210900
&ZCGPR   SETC  '0('.'&XHELP'(2,K'&XHELP-2).')'                          00211000
.ZI19B                ANOP  ,                                           00211100
.*                                                                      00211200
&ZOPN                 SETA  &ZOPN+1                                     00211300
&ZOPL(&ZOPN)          SETC  ' '                                         00211400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00211500
&ZOPV(&ZOPN)          SETC  '28(8,1),&ZCGPR'                            00211600
&ZOPD(&ZOPN)          SETC  '++ &ZXHELP XHELP'                          00211700
.*                                                                      00211800
.ZI19E                ANOP  ,                                           00211900
.*-------------------------------------------------------------------   00212000
.***AI.L18 ADDR XIOCTOKEN A                                             00212100
         AIF   ('&XIOCTOKEN' NE 'NONE').ZI20                            00212200
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           00212300
.ZI20                 ANOP  ,                                           00212400
.*-------------------------------------------------------------------   00212500
.***AI.L19 ADDR XIOCTOKEN A                                             00212600
                      AIF   ('&ZXIOCTOKEN' EQ '').ZI20H                 00212700
&ZCLNG                SETC  '&XIOCTOKEN'                                00212800
&ZCGPR                SETC  '14'                                        00212900
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI20F  IN GPR                 00213000
.*                                                                      00213100
&ZOPN                 SETA  &ZOPN+1                                     00213200
&ZOPL(&ZOPN)          SETC  ' '                                         00213300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00213400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00213500
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00213600
.*                                                                      00213700
                      AGO   .ZI20G                                      00213800
.*                                                                      00213900
.ZI20F                ANOP  ,                                           00214000
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           00214100
.*                                                                      00214200
.ZI20G                ANOP  ,                                           00214300
.*                                                                      00214400
&ZOPN                 SETA  &ZOPN+1                                     00214500
&ZOPL(&ZOPN)          SETC  ' '                                         00214600
&ZOPO(&ZOPN)          SETC  'ST'                                        00214700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,36(,1)'                             00214800
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00214900
.*                                                                      00215000
.ZI20H                ANOP  ,                                           00215100
.*-------------------------------------------------------------------   00215200
.***AI.L18 ALET XIOCTOKEN F                                             00215300
         AIF   ('&XIOCTOKEN' NE 'NONE').ZI21                            00215400
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           00215500
.ZI21                 ANOP  ,                                           00215600
.*-------------------------------------------------------------------   00215700
.***AI.L23 ALET XIOCTOKEN F                                             00215800
         AIF   ('&ZXIOCTOKEN' EQ '').ZI21G                              00215900
         AIF   ('&SYSASCE' EQ 'P').ZI21G   SYSSTATE PRIMARY             00216000
&ZCLNG                SETC  '&XIOCTOKEN'                                00216100
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI21E  IN AR                  00216200
.*                                                                      00216300
&ZCGPR                SETC  '14'                                        00216400
                      AGO   .ZI21F                                      00216500
.*                                                                      00216600
.ZI21E                ANOP  ,                                           00216700
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           00216800
.*                                                                      00216900
.ZI21F                ANOP  ,                                           00217000
.*                                                                      00217100
&ZOPN                 SETA  &ZOPN+1                                     00217200
&ZOPL(&ZOPN)          SETC  ' '                                         00217300
&ZOPO(&ZOPN)          SETC  'STAM'                                      00217400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,40(1)'                       00217500
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00217600
.*                                                                      00217700
.ZI21G                ANOP  ,                                           00217800
.*-------------------------------------------------------------------   00217900
.***AI.L25  XFROM AL4                                                   00218000
                      AIF   ('&ZXFROM' EQ '').ZI24E                     00218100
                      AIF   ('&ZXFROM' EQ 'OUTPUT').ZI24E               00218200
&ZCGPR                SETC  '&XFROM'                                    00218300
.*                                                                      00218400
                      AIF   ('&XFROM'(1,1) NE '(').ZI24B                00218500
&ZCGPR   SETC  '0('.'&XFROM'(2,K'&XFROM-2).')'                          00218600
                      AGO   .ZI24D                                      00218700
.ZI24B                ANOP  ,                                           00218800
.*                                                                      00218900
&ZC                   SETC  '&XFROM'(1,1)                               00219000
                      AIF   (T'&ZC NE 'N').ZI24D                        00219100
&ZC                   SETC  '&XFROM'                                    00219200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI24D               00219300
&ZCGPR                SETC  '=AL4(&XFROM)'                              00219400
.*                                                                      00219500
.ZI24D                ANOP  ,                                           00219600
.*                                                                      00219700
&ZOPN                 SETA  &ZOPN+1                                     00219800
&ZOPL(&ZOPN)          SETC  ' '                                         00219900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00220000
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00220100
&ZOPD(&ZOPN)          SETC  '++ &ZXFROM XFROM'                          00220200
.*                                                                      00220300
.ZI24E                ANOP  ,                                           00220400
.*-------------------------------------------------------------------   00220500
.***AI.L25  XTO AL4                                                     00220600
                      AIF   ('&ZXTO' EQ '').ZI25E                       00220700
                      AIF   ('&ZXTO' EQ 'OUTPUT').ZI25E                 00220800
&ZCGPR                SETC  '&XTO'                                      00220900
.*                                                                      00221000
                      AIF   ('&XTO'(1,1) NE '(').ZI25B                  00221100
&ZCGPR   SETC  '0('.'&XTO'(2,K'&XTO-2).')'                              00221200
                      AGO   .ZI25D                                      00221300
.ZI25B                ANOP  ,                                           00221400
.*                                                                      00221500
&ZC                   SETC  '&XTO'(1,1)                                 00221600
                      AIF   (T'&ZC NE 'N').ZI25D                        00221700
&ZC                   SETC  '&XTO'                                      00221800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI25D               00221900
&ZCGPR                SETC  '=AL4(&XTO)'                                00222000
.*                                                                      00222100
.ZI25D                ANOP  ,                                           00222200
.*                                                                      00222300
&ZOPN                 SETA  &ZOPN+1                                     00222400
&ZOPL(&ZOPN)          SETC  ' '                                         00222500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00222600
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00222700
&ZOPD(&ZOPN)          SETC  '++ &ZXTO XTO'                              00222800
.*                                                                      00222900
.ZI25E                ANOP  ,                                           00223000
.*-------------------------------------------------------------------   00223100
&ZOPN1                SETA &ZOPN                                        00223200
.*******************************************************************    00223300
.***  PROCESS UCBPIN OUTPUT PARAMETERS                                  00223400
.*******************************************************************    00223500
                      ACTR  10000                                       00223600
.*------------------------------------------------------------------    00223700
.***AO.L02 XPTOKEN CL8                                                  00223800
         AIF   ('&ZXPTOKEN' EQ 'OUTPUT').ZO18A  OUTPUT                  00223900
         AIF   ('&ZXPTOKEN' NE 'INOUT').ZO18C  INOUT                    00224000
.ZO18A    AIF   ('&XPTOKEN'(1,1) NE '(').ZO18B  ADDR IN GPR             00224100
&ZCGPR   SETC  '&XPTOKEN'(2,K'&XPTOKEN-2)                               00224200
&ZOPN                 SETA  &ZOPN+1                                     00224300
&ZOPL(&ZOPN)          SETC  ' '                                         00224400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00224500
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),20(1)'                         00224600
&ZOPD(&ZOPN)          SETC  '++ XPTOKEN CL8'                            00224700
                      AGO   .ZO18C                                      00224800
.*                                                                      00224900
.ZO18B                ANOP  ,                                           00225000
&ZAWRK   SETA  K'&XPTOKEN                                               00225100
         AIF   ('&XPTOKEN'(&ZAWRK,1) NE ')').ZO18G                      00225200
&ZN      SETA  2                                                        00225300
.ZO18H    ANOP                                                          00225400
         AIF   (&ZN GE &ZAWRK).ZO18G                                    00225500
         AIF   ('&XPTOKEN'(&ZN,1) NE '(').ZO18I                         00225600
&ZC      SETC  '&XPTOKEN'(1,&ZN).'8'.','                                00225700
&ZC      SETC  '&ZC'.'&XPTOKEN'(&ZN+1,&ZAWRK-&ZN).',20(1)'              00225800
         AGO   .ZO18J                                                   00225900
.ZO18I    ANOP                                                          00226000
&ZN      SETA  &ZN+1                                                    00226100
         AGO   .ZO18H                                                   00226200
.ZO18G    ANOP                                                          00226300
&ZC      SETC  '&XPTOKEN.(8),20(1)'                                     00226400
.ZO18J    ANOP                                                          00226500
&ZOPN                 SETA  &ZOPN+1                                     00226600
&ZOPL(&ZOPN)          SETC  ' '                                         00226700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00226800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00226900
&ZOPD(&ZOPN)          SETC  '++ XPTOKEN CL8'                            00227000
.ZO18C                ANOP  ,                                           00227100
.*******************************************************************    00227200
.***AO.X02  RETURN CODE PROCESSING                                      00227300
.*******************************************************************    00227400
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00227500
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00227600
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00227700
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00227800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00227900
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00228000
&ZOPN                 SETA  &ZOPN+1                                     00228100
&ZOPL(&ZOPN)          SETC  ' '                                         00228200
&ZOPO(&ZOPN)          SETC  'ST'                                        00228300
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00228400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00228500
                      AGO   .ZMRETX                                     00228600
.*                                                                      00228700
.ZMRET2               ANOP  ,                                           00228800
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00228900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00229000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00229100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00229200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00229300
&ZOPN                 SETA  &ZOPN+1                                     00229400
&ZOPL(&ZOPN)          SETC  ' '                                         00229500
&ZOPO(&ZOPN)          SETC  'LR'                                        00229600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00229700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00229800
.ZMRETX               ANOP  ,                                           00229900
.*******************************************************************    00230000
.***AO.X03  REASON CODE PROCESSING                                      00230100
.*******************************************************************    00230200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00230300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00230400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00230500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00230600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00230700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00230800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00230900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00231000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00231100
&ZOPN                 SETA  &ZOPN+1                                     00231200
&ZOPL(&ZOPN)          SETC  ' '                                         00231300
&ZOPO(&ZOPN)          SETC  'ST'                                        00231400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00231500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00231600
                      AGO   .ZMRSNX                                     00231700
.*                                                                      00231800
.ZMRSN2               ANOP  ,                                           00231900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00232000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00232100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00232200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00232300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00232400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00232500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00232600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00232700
&ZOPN                 SETA  &ZOPN+1                                     00232800
&ZOPL(&ZOPN)          SETC  ' '                                         00232900
&ZOPO(&ZOPN)          SETC  'LR'                                        00233000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00233100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00233200
.ZMRSNX               ANOP  ,                                           00233300
.*******************************************************************    00233400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00233500
.*******************************************************************    00233600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00233700
.*******************************************************************    00233800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00233900
.*******************************************************************    00234000
                      ACTR  10000                                       00234100
.*                                                                      00234200
                      LCLA  &ZLC           COLUMN POSITION              00234300
                      LCLA  &ZOPX          LIST TABLE INDEX             00234400
                      LCLC  &ZLL           LABEL                        00234500
                      LCLC  &ZLOP          OPERATION                    00234600
                      LCLC  &ZLV           VALUE                        00234700
                      LCLC  &ZLD           DESCRIPTION                  00234800
.*                                                                      00234900
&ZOPX                 SETA  1                                           00235000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00235100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00235200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00235300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00235400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00235500
                      AIF   (K'&ZLD LE 0).ZL5                           00235600
&ZLC                  SETA  35             COMMENT COLUMN               00235700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00235800
&ZLC                  SETA  33             COMMMENT COLUMN              00235900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00236000
&ZLV                  SETC  '&ZLV'.' '                                  00236100
                      AGO   .ZL3                                        00236200
.*                                                                      00236300
.ZL4                  ANOP  ,                                           00236400
&ZLV                  SETC  '&ZLV'.' '                                  00236500
.ZL5                  ANOP  ,                                           00236600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00236700
.*                                                                      00236800
&ZLL     &ZLOP &ZLV                                                     00236900
.*                                                                      00237000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00237100
                      AGO   .ZL2           CONTINUE LOOPING             00237200
.*                                                                      00237300
.ZLX                  ANOP  ,                                           00237400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00237500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00237600
.*-----------BAL invocation code-------------                           00237700
         LA    0,6                ++ SET UCBPIN FUNCTION CODE           00237800
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        00237900
.*********************************************************************  00238000
.*                                                                   *  00238100
.*  Get addressability to CVT                                        *  00238200
.*                                                                   *  00238300
.*********************************************************************  00238400
         L     15,16(0,0)                                               00238500
.*********************************************************************  00238600
.*                                                                   *  00238700
.*  Get addressability to IOCOM                                      *  00238800
.*                                                                   *  00238900
.*********************************************************************  00239000
         L     15,124(15,0)                                             00239100
.*********************************************************************  00239200
.*                                                                   *  00239300
.*  Get addressability to IOVT                                       *  00239400
.*                                                                   *  00239500
.*********************************************************************  00239600
         L     15,208(15,0)                                             00239700
         L     15,12(15,0)        ++ SET ADDR OF UCB SERVICES           00239800
         BALR  14,15              ++ BRANCH TO UCB SERVICES             00239900
         AGO   .DONE1                                                   00240000
.LNKPC1  ANOP                                                           00240100
         L     14,16(0,0)         ++ GET CVT ADDRESS                    00240200
         L     14,772(14,0)       ++ GET SFT ADDRESS                    00240300
.*********************************************************************  00240400
.*                                                                   *  00240500
.*  Get LX/EX for UCB Services                                       *  00240600
.*                                                                   *  00240700
.*  Note: LX/EX is calculated by multiplying the PC number (78)      *  00240800
.*        times the length of a PC/AUTH table entry (4) and          *  00240900
.*        then subtracting 4.                                        *  00241000
.*                                                                   *  00241100
.*********************************************************************  00241200
         L     14,308(14,0)       ++ GET LX/EX FOR UCB SERVICES         00241300
         PC    0(14)              ++ PC TO UCB SERVICES                 00241400
.DONE1   ANOP                                                           00241500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00241600
.ZLINKX               ANOP  ,                                           00241700
.*******************************************************************    00241800
.***AP.X01  FORMAT GENERATED CODE                                       00241900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00242000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00242100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00242200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00242300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00242400
                      AIF   (K'&ZLD LE 0).ZL51                          00242500
&ZLC                  SETA  35             COMMENT COLUMN               00242600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00242700
&ZLC                  SETA  33             COMMENT COLUMN               00242800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00242900
&ZLV                  SETC  '&ZLV'.' '                                  00243000
                      AGO   .ZL31                                       00243100
.*                                                                      00243200
.ZL41                 ANOP  ,                                           00243300
&ZLV                  SETC  '&ZLV'.' '                                  00243400
.ZL51                 ANOP  ,                                           00243500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00243600
.*                                                                      00243700
&ZLL     &ZLOP &ZLV                                                     00243800
.*                                                                      00243900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00244000
                      AGO   .ZL21          CONTINUE LOOPING             00244100
.*                                                                      00244200
.ZLX1                 ANOP  ,                                           00244300
.*******************************************************************    00244400
.***AP.X02  END OF UCBPIN MACRO                                         00244500
&ZUCBPIN              SETC  'YES'          SET UCBPIN USED              00244600
         POP   PRINT                                                    00244700
*                                            UCBPIN-1                   00244800
         SPACE 1                                                        00244900
.ZLX2                 ANOP  ,                                           00245000
         MEND                                                           00245100
**********************************************************************/ 00245200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00245300
*%UCBPIN: MACRO KEYS(PIN,UCBPTR,TEXT,PTOKEN,COMPID,HELP,LASTING,        00245400
*                 PINPATHS,NOVAL,IOCTOKEN,UNPIN,MOVEPIN,TO,FROM,        00245500
*                 LINKAGE,RETCODE,RSNCODE,MF);                          00245600
*  ANS('?'||MACLABEL||' '||'UCBPINP '||MACLIST||                        00245700
*         ' '||MACKEYS||';') COL(MACLMAR);                              00245800
*%END UCBPIN;                                                           00245900
