*/*  START OF SPECIFICATIONS ****************************************** 00050000
*                                                                       00100000
*01*  MACRO NAME: ALESERV                                               00150000
*                                                                       00200000
*01* PROPRIETARY STATEMENT =                                            00250000
*      LICENSED MATERIALS - PROPERTY OF IBM                             00500000
*      THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      00550000
*      5645-001 (C) COPYRIGHT IBM CORP. 1990, 1997                      00600000
*                                                                       00650000
*01* STATUS = HBB6603                                              @D1C 00657600
*                                                                       00665200
*01* EXTERNAL CLASSIFICATION:                                           00672800
*02*         GUPI:BASE                                                  00680400
*02*         NONE:KEYWORDS                                              00688000
*                  DUALPOOLCREATE                                       00695600
*                  DUALPOOLDELETE                                       00703200
*                  DUALPOOLTOKEN                                        00710800
*                  DUALPOOLSIZE                                         00718400
*                                                                       00726000
*01* END OF EXTERNAL CLASSIFICATION:                                    00733600
*                                                                       00741200
*                                                                       00750000
*01*  FUNCTION:                                                         00800000
*        Provide the interface to the Access list services routines     00850000
*        (IEAVXALA, IEAVXALD, IEAVXALE, IEAVXALS, IEAVXADP)             00900000
*                                                                       00951000
*01* SYNTAX:                                                            00952000
*        ALESERV ADD|ADDPASN|DELETE|EXTRACT|SEARCH|EXTRACTH |           00952600
*                DUALPOOLCREATE|DUALPOOLDELETE                          00953200
*                  <,STOKEN=rx-address>                                 00954000
*                  <,ACCESS=PUBLIC|PRIVATE>                             00955000
*                  <,AL=WORKUNIT|PASN>                                  00956000
*                  <,ALET=rx-address|(2)-(12)>                          00957000
*                  <,MF=L|(E,rx-address)|(E,(2)-(12)>                   00958000
*                  <,CHKEAX=YES|NO>                                @L1A 00958500
*                  <,CHKPT=FAIL|IGNORE>                            @L2A 00958700
*                  <,DUALPOOLTOKEN=rx-address|(2)-(12)>            @D1A 00958800
*                  <,DUALPOOLSIZE=rx-address|(2)-(12)>             @D1A 00958900
*                  <,RELATED=any-comment>                               00959000
*                                                                       00960000
*                                                                       00961000
*        Defaults for keywords:                                         00962000
*             ACCESS=PUBLIC                                             00963000
*             AL=WORKUNIT                                               00964000
*             CHKEAX=YES                                           @L1A 00964500
*             CHKPT=FAIL                                           @L2A 00964700
*                                                                       00965000
*                                                                       00966000
*   |          | S | A | A | A | M | C | C | D | D | R |                00966600
*   |          | T | C | L | L | F | H | H | U | U | E |                00967200
*   |          | O | C |   | E |   | K | K | A | A | L |                00967800
*   |          | K | E |   | T |   | E | P | L | L | A |                00968400
*   |          | E | S |   |   |   | A | T | P | P | T |                00969000
*   |          | N | S |   |   |   | X |   | O | O | E |                00969600
*   |          |   |   |   |   |   |   |   | O | O | D |                00970200
*   |          |   |   |   |   |   |   |   | L | L |   |                00970800
*   |          |   |   |   |   |   |   |   | T | S |   |                00971400
*   |          |   |   |   |   |   |   |   | O | I |   |                00972000
*   |          |   |   |   |   |   |   |   | K | Z |   |                00972600
*   |          |   |   |   |   |   |   |   | E | E |   |                00973200
*   |Option    |   |   |   |   |   |   |   | N |   |   |                00973800
*   |__________|___|___|___|___|___|___|___|___|___|___|                00974400
*   |ADD       | R | O | O | R | O | O | O | E | E | O |                00975000
*   |__________|___|___|___|___|___|___|___|___|___|___|                00975600
*   |ADDPASN   | E | E | E | R | O | E | O | E | E | O |                00976200
*   |__________|___|___|___|___|___|___|___|___|___|___|                00976800
*   |DELETE    | E | E | E | R | O | O | E | E | E | O |                00977400
*   |__________|___|___|___|___|___|___|___|___|___|___|                00978000
*   |EXTRACT   | R | E | E | R | O | E | E | E | E | O |                00978600
*   |__________|___|___|___|___|___|___|___|___|___|___|                00979200
*   |SEARCH    | R | E | O | R | O | E | E | E | E | O |                00979800
*   |__________|___|___|___|___|___|___|___|___|___|___|                00980400
*   |EXTRACTH  | R | E | E | E | O | E | E | E | E | O |                00981000
*   |__________|___|___|___|___|___|___|___|___|___|___|                00981600
*   |DUALPOOL  | E | E | E | E | O | E | E | R | O | O |                00982200
*   |___CREATE_|___|___|___|___|___|___|___|___|___|___|                00982800
*   |DUALPOOL  | E | E | E | E | O | E | E | R | E | O |                00983400
*   |___DELETE_|___|___|___|___|___|___|___|___|___|___|                00984000
*   |MF=L      | E | E | E | E |---| E | E | E | E | O |                00984600
*   |__________|___|___|___|___|___|___|___|___|___|___|                00985200
*                                                                       00989000
*              E = Error if specified                                   00990000
*              O = Optional                                             00991000
*              R = Required                                             00992000
*                                                                       00993000
*                                                                       00994000
*                                                                       00995000
*01*  COMPONENT: SCXMS (PC/AUTH)                                        01000000
*                                                                       01050000
*01*  MACLIB: AMACLIB                                                   01100000
*                                                                       01150000
*01*  CHANGE ACTIVITY:                                                  01200000
*   $L0=AR       HBB3310  850730  PD16H4: Access register support       01250000
*   $L1=ALESV    JBB3311  880201  PD16BN: CHKEAX Option                 01275000
*   $L2=DIMCR    HBB4430  920207  PY21DL: CHKPT Option                  01287500
*   $D1=DQC0011  HBB6603  960613  B7HGEJ: DU-AL Pools                   01293700
*                                                                       01300000
**** END OF SPECIFICATIONS ******************************************/  01350000
*                                                                       01400000
*/*                                                                     01450000
         MACRO                                                          01500000
&LABL    ALESERV &OPTION,    ADD/ADDPASN/DELETE/EXTRACT/EXTRACTH/SEARCHX01550000
               &STOKEN=,   1 ADD                EXTRACT EXTRACTH SEARCHX01600000
               &ACCESS=,   2 ADD                                       X01650000
               &AL=,       3 ADD                                 SEARCHX01700000
               &ALET=,     4 ADD ADDPASN DELETE EXTRACT          SEARCHX01750000
               &MF=,       5                                           X01800000
               &CHKEAX=,   6 ADD DELETE                                X01825000
               &CHKPT=,    7 ADD ADDPASN                           @L2AX01837500
               &DUALPOOLTOKEN=,  8  DUALPOOLCREATE/DUALPOOLTOKEN   @D1AX01841600
               &DUALPOOLSIZE=,   9  DUALPOOLCREATE                 @D1AX01845700
               &RELATED=     OPTIONAL VALUE FOR DOCUMENTATION           01850000
.*                                                                      01900000
.********************************************************************** 01950000
.*       Each keyword has an associated index. These indices are      * 02000000
.*       used to reference the desired keyword values in arrays       * 02050000
.*       declared below. The index for each keyword is shown in the   * 02100000
.*       macro prototype statement to the right of the associated     * 02150000
.*       keyword.                                                     * 02200000
.********************************************************************** 02250000
.*                                                                      02300000
.*                                                                      02350000
.*                                                                      02400000
.********************************************************************** 02450000
.*       DECLARE ARITHMETIC VARIABLES                                 * 02500000
.********************************************************************** 02550000
.*                                                                      02600000
         LCLA  &A          General usage local arithmetic variable      02650000
.*                                                                      02700000
         LCLA  &OPMVI      Mask for MVI of options byte                 02750000
&OPMVI   SETA  0           Initialize for no options                    02800000
.*                                                                      02850000
.********************************************************************** 02900000
.*       DECLARE BIT VARIABLES                                        * 02950000
.********************************************************************** 03000000
.*                                                                      03050000
         LCLB  &B(8)       Options bits used to construct option        03100000
.*                         byte in the parameter list                   03150000
&B(1)    SETB  0           Bits 1-4 are reserved and must be zero       03200000
&B(2)    SETB  0                                                        03250000
&B(3)    SETB  0                                                        03300000
&B(4)    SETB  0                                                        03350000
&B(5)    SETB  0           CHKPT=FAIL (if 0) CHKPT=IGNORE (if 1)   @L2C 03400000
&B(6)    SETB  0           CHKEAX=YES (if 0) CHKEAX=NO (if 1)      @L1C 03450000
&B(7)    SETB  0           AL=WORKUNIT (if 0) AL=PASN (if 1)            03500000
&B(8)    SETB  0           ACCESS=PUBLIC (if 0) ACCESS=PRIVATE (if 1)   03550000
.*                                                                      03600000
.*  DUALPOOL requests are noted in a different set of bits, since       03606200
.*  DUALPOOL requests are processed by a different service routine      03612400
.*  than the other keywords of this module.                             03618600
.*                                                                      03624800
         LCLB  &DP(8)      Options bits used to construct option   @D1A 03631000
.*                         byte in the parameter list for DUALPOOL      03637200
.*                         requests.                                    03643400
&DP(1)    SETB  0          POOL Request 0-Create, 1-Delete         @D1A 03649600
&DP(2)    SETB  0          Bit 2 is reserved                       @D1A 03655800
&DP(3)    SETB  0          Bit 3 is reserved                       @D1A 03662000
&DP(4)    SETB  0          Bit 4 is reserved                       @D1A 03668200
&DP(5)    SETB  0          Bit 5 is reserved                       @D1A 03674400
&DP(6)    SETB  0          Bit 6 is reserved                       @D1A 03680600
&DP(7)    SETB  0          Bit 7 is reserved                       @D1A 03686800
&DP(8)    SETB  0          Bit 8 is reserved                       @D1A 03693000
.*                                                                      03699200
.*  The &S and &KW arrays are used for validation.  &S is used to       03705400
.*  indicate whether the keyword was specified, and &KW is used to      03711600
.*  indicate the name of the keyword that is coincident with the &S     03717800
.*  array.                                                              03724000
.*                                                                      03730200
         LCLB  &S(9)       Bits used to indicate the keywords that      03736400
.*                         were specified by the user              @D1C 03742600
&S(1)    SETB  0           Initialize STOKEN not specified              03750000
&S(2)    SETB  0           Initialize ACCESS not specified              03800000
&S(3)    SETB  0           Initialize AL     not specified              03850000
&S(4)    SETB  0           Initialize ALET   not specified              03900000
&S(5)    SETB  0           Bit unused for MF keyword                    03950000
&S(6)    SETB  0           Initialize CHKEAX not specified         @L1C 04000000
&S(7)    SETB  0           Initialize CHKPT  not specified         @L2C 04050000
&S(8)    SETB  0           Initialize DUALPOOLTOKEN not specified  @D1C 04057100
&S(9)    SETB  0           Initialize DUALPOOLSIZE not specified   @L2C 04064200
.*                                                                      04071300
         LCLC  &KW(9)      Array used to hold the keyword names    @D1C 04078400
&KW(1)   SETC  'STOKEN'                                                 04085500
&KW(2)   SETC  'ACCESS'                                                 04092600
&KW(3)   SETC  'AL'                                                     04099700
&KW(4)   SETC  'ALET'                                                   04106800
&KW(5)   SETC  'MF'                                                     04113900
&KW(6)   SETC  'CHKEAX'                                            @L1A 04121000
&KW(7)   SETC  'CHKPT'                                             @L2A 04128100
&KW(8)   SETC  'DUALPOOLTOKEN'                                     @D1A 04135200
&KW(9)   SETC  'DUALPOOLSIZE'                                      @D1A 04142300
.*                                                                      04150000
         LCLB  &KILL       Error bit used to stop macro generation      04200000
&KILL    SETB  0           Initialize to no errors                      04250000
.*                                                                      04300000
.********************************************************************** 04350000
.*       DECLARE CHARACTER VARIABLES                                  * 04400000
.********************************************************************** 04450000
.*                                                                      04500000
         LCLC  &ALETV      Value of ALET    keyword                     04550000
         LCLC  &EPLV       Value of the parameter address in the        04600000
.*                         MF=(E,parmaddr) keyword                      04650000
.*                                                                      04700000
         LCLC  &BOPTS      Options byte initialization string for       04750000
.*                         the standard form                            04800000
.*                                                                      04850000
         LCLC  &GNAME1     Label for standard form parameter list       04900000
         LCLC  &GNAME2     Branch label for the standard form           04950000
.*                                                                      05050000
.*                                                                      05400000
         LCLC  &LT4        Load type 4 (register or address) for        05450000
.*                         ALET keyword                                 05500000
.*                              'R' =  Register type                    05550000
.*                              'A' =  RX address type                  05600000
.*                                                                      05650000
         LCLC  &LTE        Load type (register or address) for          05700000
.*                         execute form parameter list                  05750000
.*                              'R' =  Register type                    05800000
.*                              'A' =  RX address type                  05850000
.*                                                                      05900000
         LCLC  &LTDPTOKEN  Load type (register or address) for     @D1A 05908300
.*                         DUALPOOLTOKEN keyword                        05916600
.*                              'R' =  Register type                    05924900
.*                              'A' =  RX address type                  05933200
.*                                                                      05941500
         LCLC  &LTDPSIZE   Load type (register or address) for     @D1A 05949800
.*                         DUALPOOLSIZE keyword                         05958100
.*                              'R' =  Register type                    05966400
.*                              'A' =  RX address type                  05974700
.*                                                                      05983000
         LCLC  &M(12)      Array of character strings used in      @D1C 05991300
.*                         error messages                               06000000
&M(1)    SETC  'ADD'                                                    06050000
&M(2)    SETC  'ADDPASN'                                                06100000
&M(3)    SETC  'DELETE'                                                 06150000
&M(4)    SETC  'EXTRACT'                                                06200000
&M(5)    SETC  'SEARCH'                                                 06250000
&M(6)    SETC  'MF=L'                                                   06300000
&M(7)    SETC  'AL'                                                     06350000
&M(8)    SETC  'WORKUNIT'                                               06400000
&M(9)    SETC  'PASN'                                                   06450000
&M(10)   SETC  'EXTRACTH'                                               06500000
&M(11)   SETC  'DUALPOOLCREATE'                                    @D1A 06516600
&M(12)   SETC  'DUALPOOLDELETE'                                    @D1A 06533200
.*                                                                      06550000
         LCLC  &OSFT       Offset into the SFT                          06566600
.*                                                                      06583200
         LCLC  &OTYPE      ALESERV option type byte for parm list       06600000
&OTYPE   SETC  '0'         Initialize ALS@TYPE = (invalid)              06650000
.*                                                                      06700000
         LCLC  &MFTYPE     MF keyword type - S, L, OR E                 06750000
.*                              'S' =  Standard form                    06800000
.*                              'L' =  List form                        06850000
.*                              'E' =  Execute form                     06900000
.*                                                                      06950000
.*                                                                      07000000
.*                                                                      07050000
.*                                                                      07100000
.********************************************************************** 07150000
.*       PUT OUT BAL MACDATE COMMENT LINE REGARDLESS OF ERRORS.       * 07200000
.********************************************************************** 07250000
.*                                                                      07300000
.*                                                                      07350000
.*                                                                      07400000
*              MACDATE = 06/13/1996                                @D1A 07450000
.*                                                                      07500000
.*                                                                      07550000
.*                                                                      07600000
.********************************************************************** 07650000
.*       VALIDATE STOKEN   KEYWORD IF PRESENT                         * 07700000
.********************************************************************** 07750000
.*                                                                      07800000
.*                                                                      07850000
         AIF   (T'&STOKEN EQ 'O').OK01X If omitted, exit STOKEN         07900000
.*                                      validation                      07950000
&S(1)    SETB  1                        Indicate STOKEN was specified   08000000
.*                                                                      08050000
         AIF   (T'&STOKEN EQ 'N').BAD1  Make sure STOKEN is not a self  08100000
.*                                      defining term                   08150000
.*                                                                      08200000
         AIF   ('&STOKEN'(1,1) NE '(').OK01X  Put out error message     08250000
.*                                      if STOKEN is a register         08300000
.*                                                                      08350000
.BAD1    ANOP                                                           08400000
.*       MNOTE 12,'IHB002 INVALID STOKEN OPERAND SPECIFIED-&STOKEN.'    08450000
         IHBERMAC 1001,&KW(1),&STOKEN                                   08500000
&KILL    SETB  1                        Set error indicator             08550000
.*                                                                      08600000
.OK01X   ANOP                                                           08650000
.*                                                                      08700000
.*                                                                      08750000
.*                                                                      08800000
.*                                                                      08850000
.*                                                                      08900000
.********************************************************************** 08950000
.*       VALIDATE ACCESS   KEYWORD IF PRESENT                         * 09000000
.********************************************************************** 09050000
.*                                                                      09100000
.*                                                                      09150000
         AIF   (T'&ACCESS EQ 'O').OK02X If ACCESS is omitted, use       09200000
.*                                      default. ACCESS=PUBLIC          09250000
.*                                                                      09300000
&S(2)    SETB  1                        Indicate ACCESS was specified   09350000
.*                                                                      09400000
         AIF   ('&ACCESS' EQ 'PUBLIC').OK02X  Validate ACCESS keyword   09450000
         AIF   ('&ACCESS' EQ 'PRIVATE').OK02C                           09500000
.*                                                                      09550000
.*       MNOTE 12,'IHB002 INVALID ACCESS OPERAND SPECIFIED-&ACCESS.'    09600000
         IHBERMAC 1001,&KW(2),&ACCESS                                   09650000
&KILL    SETB  1                                                        09700000
         AGO   .OK02X                                                   09750000
.*                                                                      09800000
.OK02C   ANOP                                                           09850000
&B(8)    SETB  1                        Indicate PRIVATE access         09900000
.*                                      in options byte                 09950000
.*                                                                      10000000
.OK02X   ANOP                                                           10050000
.*                                                                      10100000
.*                                                                      10150000
.*                                                                      10200000
.*                                                                      10250000
.*                                                                      10300000
.********************************************************************** 10350000
.*       VALIDATE AL        KEYWORD IF PRESENT                        * 10400000
.********************************************************************** 10450000
.*                                                                      10500000
.*                                                                      10550000
         AIF   (T'&AL EQ 'O').OK03X     If AL is omitted, use default   10600000
.*                                      (AL=WORKUNIT)                   10650000
&S(3)    SETB  1                        Indicate AL was specified       10700000
.*                                                                      10750000
         AIF   ('&AL' EQ 'WORKUNIT').OK03X  Validate AL keyword         10800000
         AIF   ('&AL' EQ 'PASN').OK03C                                  10850000
.*                                                                      10900000
.*       MNOTE 12,'IHB002 INVALID AL OPERAND SPECIFIED-&AL.'            10950000
         IHBERMAC 1001,&KW(3),&AL                                       11000000
&KILL    SETB  1                        Indicate error occured          11050000
         AGO   .OK03X                   Exit AL validation              11100000
.*                                                                      11150000
.OK03C   ANOP                                                           11200000
&B(7)    SETB  1                        Indicate PASN access list       11250000
.*                                      in options byte                 11300000
.*                                                                      11350000
.OK03X   ANOP                                                           11400000
.*                                                                      11450000
.*                                                                      11500000
.*                                                                      11550000
.*                                                                      11600000
.*                                                                      11650000
.********************************************************************** 11700000
.*       VALIDATE ALET     KEYWORD IF PRESENT                         * 11750000
.********************************************************************** 11800000
.*                                                                      11850000
.*                                                                      11900000
         AIF   (T'&ALET EQ 'O').OK04X   Omitted, exit ALET validation   11950000
.*                                                                      12000000
&S(4)    SETB  1                        Indicate ALET was specified     12050000
.*                                                                      12100000
         AIF   ('&ALET'(1,1) EQ '(').OK04B   Branch to process register 12150000
.*                                      type of ALET                    12200000
.*                                                                      12250000
&LT4     SETC  'A'                      Indicate ALET is an RX address  12300000
&ALETV   SETC  '&ALET'                  Set ALET value for use in       12350000
.*                                      LAE instruction                 12400000
.*                                                                      12450000
         AIF   (T'&ALET EQ 'N').BAD4    Make sure ALET is not a self    12500000
.*                                      defining term                   12550000
.*                                                                      12600000
         AGO   .OK04X                   Exit ALET validation            12650000
.*                                                                      12700000
.OK04B   ANOP                           Process register ALET           12750000
&LT4     SETC  'R'                      Indicate ALET is in a register  12800000
&ALETV   SETC  '&ALET(1)'               Extract the register name       12850000
.*                                                                      12900000
         AIF   (N'&ALET NE 1).BAD4      Put out error message if more   12950000
.*                                      than one register was specified 13000000
.*                                                                      13050000
         AIF   (T'&ALET NE 'N').OK04X   If the register name is not     13100000
.*                                      a self defining number, exit    13150000
.*                                      ALET validation. We must have   13200000
.*                                      faith that a register 2-12      13250000
.*                                      was specified.                  13300000
.*                                                                      13350000
&A       SETA  &ALET(1)                 Get the register number         13400000
         AIF   (&A LT 2).BAD4           Error if register not 2-12      13450000
         AIF   (&A GT 12).BAD4          Error if register not 2-12      13500000
         AGO   .OK04X                   Register is ok, exit ALET       13550000
.*                                      validation                      13600000
.*                                                                      13650000
.BAD4    ANOP                                                           13700000
.*       MNOTE 12,'IHB002 INVALID ALET OPERAND SPECIFIED-&ALET.'        13750000
         IHBERMAC 1001,&KW(4),&ALET                                     13800000
&KILL    SETB  1                        Set error indication            13850000
.*                                                                      13900000
.OK04X   ANOP                                                           13950000
.*                                                                      14000000
.*                                                                      14050000
.*                                                                      14100000
.*                                                                      14150000
.*                                                                      14200000
.********************************************************************** 14250000
.*       VALIDATE MF KEYWORD IF PRESENT                               * 14300000
.********************************************************************** 14350000
.*                                                                      14400000
.*                                                                      14450000
&MFTYPE  SETC  'S'                      Set MF type to standard         14500000
         AIF   (T'&MF EQ 'O').OK05X     If MF omitted, exit MF          14550000
.*                                      validation.                     14600000
.*                                                                      14650000
&MFTYPE  SETC  'L'                      Set MF type to list             14700000
         AIF   ('&MF' EQ 'L').OK05X     MF=L, Exit MF validation        14750000
.*                                                                      14800000
&MFTYPE  SETC  'E'                      Set MF type to execute form     14850000
         AIF   (N'&MF EQ 2).OK05A       Make sure 'E' and a parameter   14900000
.*                                      list was specified              14950000
.*                                                                      15000000
.*       MNOTE 12,'IHB002 INVALID MF OPERAND SPECIFIED-&MF.'            15050000
         IHBERMAC 1001,&KW(5),&MF                                       15100000
&KILL    SETB  1                        Set error indication            15150000
         AGO   .OK05X                   Exit MF validation              15200000
.*                                                                      15250000
.OK05A   ANOP                                                           15300000
         AIF   ('&MF(1)' EQ 'E').OK05B  Make sure 'E' was specified     15350000
.*                                                                      15400000
.*       MNOTE 12,'IHB002 INVALID MF OPERAND SPECIFIED-&MF.'            15450000
         IHBERMAC 1001,&KW(5),&MF                                       15500000
&KILL    SETB  1                        Set error indication            15550000
         AGO   .OK05X                   Exit MF validation              15600000
.*                                                                      15650000
.OK05B   ANOP                                                           15700000
         AIF   ('&MF(2)' NE '').OK05C   Make sure a non null parameter  15750000
.*                                      address was specified           15800000
.*                                                                      15850000
.*       MNOTE 12,'IHB002 INVALID MF OPERAND SPECIFIED-&MF.'            15900000
         IHBERMAC 1001,&KW(5),&MF                                       15950000
&KILL    SETB  1                        Set error indication            16000000
         AGO   .OK05X                   Exit MF validation              16050000
.*                                                                      16100000
.OK05C   ANOP                                                           16150000
         AIF   ('&MF(2)'(1,1) EQ '(').OK05D  Branch to process register 16200000
.*                                      type of parameter list address  16250000
.*                                                                      16300000
&LTE     SETC  'A'                      Indicate RX address type of     16350000
.*                                      parm list                       16400000
&EPLV    SETC  '&MF(2)'                 Get parm list value to use in   16450000
.*                                      the LAE instruction             16500000
.*                                                                      16550000
         AIF   (T'&MF(2) NE 'N').OK05X  Make sure the parameter list    16600000
.*                                      address is not a self defining  16650000
.*                                      term                            16700000
.*                                                                      16750000
.*       MNOTE 12,'IHB002 INVALID MF OPERAND SPECIFIED-&MF.'            16800000
         IHBERMAC 1001,&KW(5),&MF                                       16850000
&KILL    SETB  1                        Set error indication            16900000
         AGO   .OK05X                   Exit MF validation              16950000
.*                                                                      17000000
.OK05D   ANOP                           Process register type parm list 17050000
&LTE     SETC  'R'                      Indicate register type          17100000
&EPLV    SETC  '&MF(2)'(2,K'&MF(2)-2)   Extract the register name for   17150000
.*                                      use in the LAE instruction      17200000
.*                                                                      17250000
         AIF   (N'&MF(2) NE 1).BADE     Put out error message if more   17300000
.*                                      than one register was specified 17350000
.*                                                                      17400000
         AIF   (T'&MF(2) NE 'N').OK05X  If the register name is not     17450000
.*                                      a self defining number, exit    17500000
.*                                      MF validation. We must have     17550000
.*                                      faith that a register 2-12      17600000
.*                                      was specified.                  17650000
.*                                                                      17700000
&A       SETA  &EPLV                    Get the register number         17750000
         AIF   (&A LT 2).BADE           Error if register not 2-12      17800000
         AIF   (&A GT 12).BADE          Error if register not 2-12      17850000
         AGO   .OK05X                   Exit MF validation              17900000
.*                                                                      17950000
.BADE    ANOP                                                           18000000
.*       MNOTE 12,'IHB002 INVALID MF OPERAND SPECIFIED-&MF.'            18050000
         IHBERMAC 1001,&KW(5),&MF                                       18100000
&KILL    SETB  1                        Set error indication            18150000
.*                                                                      18200000
.OK05X   ANOP                                                           18250000
.*                                                                      18300000
.*                                                                      18350000
.*                                                                      18400000
.*                                                                      18450000
.*                                                                      18500000
.********************************************************************** 18550000
.*       VALIDATE CHKEAX KEYWORD IF PRESENT                     @L1A  * 18551600
.********************************************************************** 18553200
.*                                                                      18554800
.*                                                                      18556400
         AIF   (T'&CHKEAX EQ 'O').OK06X If CHKEAX is omitted, use @L1A  18558000
.*                                      default (CHKEAX=YES)            18559600
&S(6)    SETB  1                       Indicate CHKEAX was         @L1A 18561200
.*                                     specified.                       18562800
.*                                                                      18564400
         AIF   ('&CHKEAX' EQ 'YES').OK06X Validate CHKEAX keyword  @L1A 18566000
         AIF   ('&CHKEAX' EQ 'NO').OK06C                           @L1A 18567600
.*                                                                      18569200
.*       MNOTE 12,'IHB002 INVALID CHKEAX OPERAND SPECIFIED-&CHKEAX.'    18570800
.*                                                                 @L1A 18572400
         IHBERMAC 1001,&KW(6),&CHKEAX                              @L1A 18574000
&KILL    SETB  1                        Indicate error occurred    @L1A 18575600
         AGO   .OK06X                   Exit CHKEAX validation     @L1A 18577200
.*                                                                      18578800
.OK06C   ANOP                                                      @L1A 18580400
&B(6)    SETB  1                        Indicate CHKEAX=NO in      @L1A 18582000
.*                                      options byte                    18583600
.*                                                                      18585200
.OK06X   ANOP                                                      @L1A 18586800
.*                                                                      18588400
.********************************************************************** 18588800
.*       VALIDATE CHKPT KEYWORD IF PRESENT                      @L2A  * 18589200
.********************************************************************** 18589600
.*                                                                      18590000
.*                                                                      18590100
         AIF   (T'&CHKPT EQ 'O').OK07X If CHKPT is omitted, use    @L2A 18590200
.*                                      default (CHKPT=FAIL)            18590300
&S(7)    SETB  1                       Indicate CHKPT was          @L2A 18590400
.*                                     specified.                       18590500
.*                                                                      18590600
         AIF   ('&CHKPT' EQ 'IGNORE').OK07C Validate CHKPT keyword @L2A 18590700
         AIF   ('&CHKPT' EQ 'FAIL').OK07X                          @L2A 18590800
.*                                                                      18590900
.*       MNOTE 12,'IHB002 INVALID CHKPT OPERAND SPECIFIED-&CHKPT.'      18591000
.*                                                                 @L2A 18591100
         IHBERMAC 1001,&KW(7),&CHKPT                               @L2A 18591200
&KILL    SETB  1                        Indicate error occurred    @L2A 18591300
         AGO   .OK07X                   Exit CHKPT validation      @L2A 18591400
.*                                                                      18591500
.OK07C   ANOP                                                      @L2A 18591600
&B(5)    SETB  1                        Indicate CHKPT=IGNORE in   @L2A 18591700
.*                                      options byte                    18591800
.*                                                                      18591900
.OK07X   ANOP                                                      @L2A 18592000
.*                                                                      18592100
.*                                                                      18592200
.********************************************************************** 18592400
.*       VALIDATE DUALPOOLTOKEN KEYWORD IF PRESENT              @D1A  * 18592600
.********************************************************************** 18592800
.*                                                                      18593200
.*                                                                      18593600
         AIF   (T'&DUALPOOLTOKEN EQ 'O').OK08X If DUALPOOLTOKEN is @D1A 18594000
.*                                     not specified, then skip         18594400
.*                                     validation.                      18594800
&S(8)    SETB  1                       Indicate DUALPOOLTOKEN was  @D1A 18595200
.*                                     specified.                       18595600
.*                                                                      18596000
         AIF   ('&DUALPOOLTOKEN'(1,1) EQ '(').OK08B   Branch to    @D1A 18596400
.*                                      process register type of        18596800
.*                                      DUALPOOLTOKEN request.          18597200
&LTDPTOKEN  SETC 'A'                    Indicate DUALPOOLTOKEN is  @D1A 18597600
.*                                      an RX-type.                     18598000
&DUALPOOLTOKENV  SETC  '&DUALPOOLTOKEN'  Set DUALPOOLTOKEN value   @D1A 18598400
.*                                      for use on the LAE instruction  18598800
.*                                                                      18599200
         AIF   (T'&DUALPOOLTOKEN EQ 'N').BAD8    Make sure         @D1A 18599600
.*                                      DUALPOOLTOKEN is not a self-    18600000
.*                                      -defining term                  18600400
.*                                                                      18600800
         AGO   .OK08X                   Exit DUALPOOLTOKEN         @D1A 18601200
.*                                      validation                      18601600
.*                                                                      18602000
.OK08B   ANOP ,                         Process register           @D1A 18602400
.*                                      DUALPOOLTOKEN                   18602800
&LTDPTOKEN  SETC 'R'                    Indicate DUALPOOLTOKEN is  @D1A 18603200
.*                                      a register.                     18603600
&DUALPOOLTOKENV  SETC '&DUALPOOLTOKEN(1)' Set DUALPOOLTOKEN value  @D1A 18604000
.*                                      for use on the LAE instruction  18604400
.*                                                                      18604800
         AIF   (N'&DUALPOOLTOKEN NE 1).BAD8  Put out error message @D1A 18605200
.*                                      if more than one register was   18605600
.*                                      was specified                   18606000
.*                                                                      18606400
         AIF   (T'&DUALPOOLTOKEN NE 'N').OK08X  If the register    @D1A 18606800
.*                                      name is not a self-defining     18607200
.*                                      number, exit DUALPOOLTOKEN      18607600
.*                                      validation. We must have        18608000
.*                                      faith that a register 2-12      18608400
.*                                      was specified.                  18608800
.*                                                                      18609200
&A       SETA  &DUALPOOLTOKEN(1)        Get the register number    @D1A 18609600
         AIF   (&A LT 2).BAD8           Error if register not 2-12 @D1A 18610000
         AIF   (&A GT 12).BAD8          Error if register not 2-12 @D1A 18610400
         AGO   .OK08X                   Register is ok, exit       @D1A 18610800
.*                                      DUALPOOLTOKEN validation        18611200
.*                                                                      18611600
.BAD8    ANOP ,                                                    @D1A 18612000
.*   MNOTE 12,'IHB002 INVALID ALET OPERAND SPECIFIED-&DUALPOOLTOKEN.'   18612400
         IHBERMAC 1001,&KW(8),&DUALPOOLTOKEN                       @D1A 18612800
&KILL    SETB  1                        Set error indication       @D1A 18613200
.*                                                                      18613600
.OK08X   ANOP ,                                                    @L2A 18614000
.*                                                                      18614400
.*                                                                      18614800
.********************************************************************** 18615200
.*       VALIDATE DUALPOOLSIZE KEYWORD IF PRESENT               @D1A  * 18615600
.********************************************************************** 18616000
.*                                                                      18616400
.*                                                                      18616800
         AIF   (T'&DUALPOOLSIZE EQ 'O').OK09X If DUALPOOLSIZE is   @D1A 18617200
.*                                     not specified, then skip         18617600
.*                                     validation.                      18618000
&S(9)    SETB  1                       Indicate DUALPOOLSIZE was   @D1A 18618400
.*                                     specified.                       18618800
.*                                                                      18619200
         AIF   ('&DUALPOOLSIZE'(1,1) EQ '(').OK09B   Branch to     @D1A 18619600
.*                                      process register type of        18620000
.*                                      DUALPOOLSIZE request.           18620400
&LTDPSIZE  SETC 'A'                     Indicate DUALPOOLSIZE is   @D1A 18620800
.*                                      an RX-type.                     18621200
&DUALPOOLSIZEV  SETC  '&DUALPOOLSIZE'   Set DUALPOOLSIZE value for @D1A 18621600
.*                                      use on the LAE instruction      18622000
.*                                                                      18622400
         AIF   (T'&DUALPOOLSIZE EQ 'N').BAD9    Make sure          @D1A 18622800
.*                                      DUALPOOLSIZE is not a self-     18623200
.*                                      -defining term                  18623600
.*                                                                      18624000
         AGO   .OK09X                   Exit DUALPOOLSIZE          @D1A 18624400
.*                                      validation                      18624800
.*                                                                      18625200
.OK09B   ANOP ,                         Process register           @D1A 18625600
.*                                      DUALPOOLSIZE                    18626000
&LTDPSIZE  SETC 'R'                     Indicate DUALPOOLSIZE is   @D1A 18626400
.*                                      a register.                     18626800
&DUALPOOLSIZEV  SETC  '&DUALPOOLSIZE(1)'  Set DUALPOOLSIZE value   @D1A 18627200
.*                                      for use on the LAE instruction  18627600
.*                                                                      18628000
         AIF   (N'&DUALPOOLSIZE NE 1).BAD9   Put out error message @D1A 18628400
.*                                      if more than one register was   18628800
.*                                      was specified                   18629200
.*                                                                      18629600
         AIF   (T'&DUALPOOLSIZE NE 'N').OK09X  If the register     @D1A 18630000
.*                                      name is not a self-defining     18630400
.*                                      number, exit DUALPOOLSIZE       18630800
.*                                      validation. We must have        18631200
.*                                      faith that a register 2-12      18631600
.*                                      was specified.                  18632000
.*                                                                      18632400
&A       SETA  &DUALPOOLSIZE(1)         Get the register number    @D1A 18632800
         AIF   (&A LT 2).BAD9           Error if register not 2-12 @D1A 18633200
         AIF   (&A GT 12).BAD9          Error if register not 2-12 @D1A 18633600
         AGO   .OK09X                   Register is ok, exit       @D1A 18634000
.*                                      DUALPOOLTOKEN validation        18634400
.*                                                                      18634800
.BAD9    ANOP ,                                                    @D1A 18635200
.*   MNOTE 12,'IHB002 INVALID ALET OPERAND SPECIFIED-&DUALPOOLSIZE.'    18635600
         IHBERMAC 1001,&KW(9),&DUALPOOLSIZE                        @D1A 18636000
&KILL    SETB  1                        Set error indication       @D1A 18636400
.*                                                                      18636800
.OK09X   ANOP ,                                                    @D1A 18637200
.*                                                                      18637600
.*                                                                      18638000
.*                                                                      18638400
.*                                                                      18638800
.********************************************************************** 18639200
.*       VALIDITY CHECK THE POSITIONAL KEYWORD                        * 18639600
.********************************************************************** 18650000
.*                                                                      18700000
         AIF   ('&MFTYPE' EQ 'L').CKMFL1  If MF=L, go process list form 18750000
.*                                                                      18800000
         AIF   (N'&SYSLIST LT 2).OKPOSA Make sure no more than one      18850000
.*                                      positional parameter was        18900000
.*                                      specified                       18950000
.*                                                                      19000000
.*       MNOTE 12,'IHB027 EXCESSIVE POSITIONAL PARAMETERS SPECIFIED.'   19050000
         IHBERMAC 238                                                   19100000
         MEXIT                                                          19150000
.*                                                                      19200000
.OKPOSA  ANOP                                                           19250000
         AIF   (N'&SYSLIST EQ 1).OKPOSB Make sure one OPTION was        19300000
.*                                      specified                       19350000
.*                                                                      19400000
.*       MNOTE 12,'IHB308 REQUIRED POSITIONAL PARAMETER NOT SPECIFIED   19450000
         IHBERMAC 1308                                                  19500000
         MEXIT                                                          19550000
.*                                                                      19600000
.OKPOSB  ANOP                                                           19650000
         AIF   ('&OPTION' EQ 'ADD').CHKPOS  Validate the OPTION         19700000
         AIF   ('&OPTION' EQ 'ADDPASN').CHKPOS                          19750000
         AIF   ('&OPTION' EQ 'DELETE').CHKPOS                           19800000
         AIF   ('&OPTION' EQ 'EXTRACT').CHKPOS                          19850000
         AIF   ('&OPTION' EQ 'EXTRACTH').CHKPOS                         19900000
         AIF   ('&OPTION' EQ 'SEARCH').CHKPOS                           19950000
         AIF   ('&OPTION' EQ 'DUALPOOLCREATE').CHKPOS              @D1A 19966600
         AIF   ('&OPTION' EQ 'DUALPOOLDELETE').CHKPOS              @D1A 19983200
.*                                                                      20000000
.*       MNOTE 12,'IHB300 INVALID POSITIONAL PARAMETER -&OPTION'        20050000
         IHBERMAC 1300,&OPTION                                          20100000
         MEXIT                                                          20150000
.*                                                                      20200000
.*                                                                      20250000
.*                                                                      20300000
.*                                                                      20350000
.*                                                                      20400000
.********************************************************************** 20450000
.*       MF=L REQUEST                                                 * 20500000
.********************************************************************** 20550000
.*                                                                      20600000
.CKMFL1  ANOP                                                           20650000
         AIF   (N'&SYSLIST EQ 0).OKMFL1 Make sure no positional         20700000
.*                                      parameters were specified       20750000
.*                                                                      20800000
.*       MNOTE 12,'IHB301 - ''&OPTION'' INVALID WITH MF=L REQUEST.'     20850000
         IHBERMAC 1301,&OPTION,&M(6)                                    20900000
&KILL    SETB  1                        Set error indication            20950000
.*                                                                      21000000
.OKMFL1  ANOP                           Make sure STOKEN, ALET, ACCESS, 21050000
&A       SETA  1                        and AL were not specified       21100000
.*                                                                      21150000
.MFL1    ANOP                                                           21200000
         AIF   (&S(&A) EQ 0).MFL2       Branch around error message     21250000
.*                                      if keyword was not specified    21300000
.*                                                                      21350000
.*       MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH MF=L REQUEST.'     21400000
         IHBERMAC 1301,&KW(&A),&M(6)                                    21450000
&KILL    SETB  1                        Set error indication            21500000
.*                                                                      21550000
.MFL2    ANOP                                                           21600000
&A       SETA  &A+1                     Increment index to examine      21650000
.*                                      the next keyword                21700000
         AIF   (&A EQ 5).MFL2           Skip MF= keyword           @D1C 21750000
.*                                                                      21850000
         AIF   (&A GT 9).CHKKILL        If done, see if any errors @D1C 21860000
.*                                      were encountered.               21870000
         AGO   .MFL1                    Go check next keyword.     @D1C 21880000
.CHKKILL ANOP ,                                                    @D1C 21890000
         AIF   (&KILL EQ 0).GENLIST     If no errors, go generate the   21900000
.*                                      parameter list                  21950000
         MEXIT                                                          22000000
.*                                                                      22008300
.*  NOTE:  The generated parameter list below is the parameter list     22016600
.*         as it looks for non Dual Pool requests.  The parameter list  22024900
.*         generated for Dual Pool requests uses the same size          22033200
.*         parameter list but it is mapped differently.                 22041500
.*                                                                      22050000
.GENLIST ANOP                                                           22100000
&LABL    DS    0F                   .ALESERV PC PARAMETER LIST          22150000
         DC    XL1'00'              .SERVICE TYPE CODE                  22200000
         DC    XL1'00'              .OPTIONS FLAG BYTE                  22250000
         DC    AL2(0)               .RESERVED                           22300000
         DC    A(0)                 .ALET                               22350000
         DC    XL8'0'               .STOKEN (SPACE TOKEN)               22400000
         MEXIT                                                          22450000
.*                                                                      22500000
.*                                                                      22550000
.*                                                                      22600000
.*                                                                      22650000
.*                                                                      22700000
.*                                                                      22750000
.*                                                                      22800000
.********************************************************************** 22850000
.*       DETERMINE WHICH POSITIONAL PARAMETER WAS SPECIFIED           * 22900000
.********************************************************************** 22950000
.*                                                                      23000000
.CHKPOS  ANOP                                                           23050000
         AIF   ('&OPTION' EQ 'ADD').ADD                                 23100000
         AIF   ('&OPTION' EQ 'ADDPASN').ADDPASN                         23150000
         AIF   ('&OPTION' EQ 'DELETE').DELETE                           23200000
         AIF   ('&OPTION' EQ 'EXTRACT').EXTRACT                         23250000
         AIF   ('&OPTION' EQ 'EXTRACTH').EXTRACTH                       23300000
         AIF   ('&OPTION' EQ 'SEARCH').SEARCH                           23350000
         AIF   ('&OPTION' EQ 'DUALPOOLCREATE').DUALPOOLCREATE      @D1A 23366600
         AIF   ('&OPTION' EQ 'DUALPOOLDELETE').DUALPOOLDELETE      @D1A 23383200
.*                                                                      23400000
.*                                                                      23450000
.*                                                                      23500000
.********************************************************************** 23550000
.*       (ADD) REQUEST                                                * 23600000
.********************************************************************** 23650000
.*                                                                      23700000
.ADD     ANOP                                                           23750000
         AIF   (&S(1) EQ 1).AD03        Make sure STOKEN was specified  23800000
.*                                                                      23850000
.*       MNOTE 12,'IHB309 - ''STOKEN'' IS REQUIRED WITH ADD OPTION.'    23900000
         IHBERMAC 1309,&KW(1),&M(1)                                     23950000
&KILL    SETB  1                        Set error indication            24000000
.*                                                                      24050000
.AD03    ANOP                                                           24100000
         AIF   (&S(4) EQ 1).AD04        Make sure ALET was specified    24150000
.*                                                                      24200000
.*       MNOTE 12,'IHB309 - ''ALET'' IS REQUIRED WITH ADD OPTION.'      24250000
         IHBERMAC 1309,&KW(4),&M(1)                                     24300000
&KILL    SETB  1                        Set error indication            24350000
.*                                                                      24400000
.AD04    ANOP ,                                                         24404000
&A       SETA  8                        Make sure DUALPOOLTOKEN    @D1A 24408000
.*                                      and DUALPOOLSIZE were not       24412000
.*                                      specified                       24416000
         AIF   (&S(&A) EQ 0).AD05       Branch around error        @D1A 24420000
.*                                      message if keyword was not      24424000
.*                                      specified                       24428000
.*       MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH ADD REQUEST.'      24432000
         IHBERMAC 1301,&KW(&A),&M(1)                               @D1A 24436000
&KILL    SETB  1                        Set error indicator        @D1A 24440000
.*                                                                      24444000
.AD05    ANOP ,                                                    @D1A 24448000
&A       SETA  9                        Make sure DUALPOOLTOKEN    @D1A 24452000
.*                                      DELETE was not specified        24456000
         AIF   (&S(&A) EQ 0).AD06       Branch around error        @D1A 24460000
.*                                      message if keyword was not      24464000
.*                                      specified                       24468000
.*       MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH ADD REQUEST.'      24472000
         IHBERMAC 1301,&KW(&A),&M(1)                               @D1A 24476000
&KILL    SETB  1                        Set error indicator        @D1A 24480000
.*                                                                      24484000
.AD06    ANOP ,                                                    @D1A 24488000
.*                                      check.                          24492000
.*                                                                      24496000
&OTYPE   SETC  '01'                     Indicate ADD request for        24500000
.*                                      parameter list                  24550000
&OSFT    SETC  '188'                    Set up SFT offset for ADD       24575000
         AGO   .COMMON                  Go generate code                24600000
.*                                                                      24650000
.*                                                                      24700000
.*                                                                      24750000
.*                                                                      24800000
.********************************************************************** 24850000
.*       (ADDPASN) REQUEST                                            * 24900000
.********************************************************************** 24950000
.*                                                                      25000000
.ADDPASN ANOP                                                           25050000
&A       SETA  1                        Make sure STOKEN, ACCESS, and   25100000
.*                                      AL were not specified           25150000
.*                                                                      25200000
.ADP1    ANOP                                                           25250000
         AIF   (&S(&A) EQ 0).ADP2       Branch around error message     25300000
.*                                      if keyword was not specified    25350000
.*                                                                      25400000
.*       MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH ADDPASN REQUEST.'  25450000
         IHBERMAC 1301,&KW(&A),&M(2)                                    25500000
&KILL    SETB  1                        Set error indicator             25550000
.*                                                                      25600000
.ADP2    ANOP                                                           25650000
&A       SETA  &A+1                     Increment keyword index         25700000
.*                                      to examine next keyword         25750000
         AIF   (&A EQ 4).ADP2           Skip ALET keyword          @D1C 25764200
         AIF   (&A EQ 5).ADP2           Skip MF keyword            @D1A 25778400
         AIF   (&A EQ 7).ADP2           CHKPT keyword              @D1A 25792600
         AIF   (&A GT 9).ADP3           All done, then continue    @D1A 25806800
.*                                      checks.                         25821000
         AGO   .ADP1                    Check current keyword      @D1A 25835200
.*                                                                      25850000
.ADP3    ANOP ,                                                    @L1A 25897700
.*                                                                      25945400
         AIF   (&S(4) EQ 1).ADP4        Make sure ALET was specified    25950000
.*                                                                      26000000
.*       MNOTE 12,'IHB309 - ''ALET'' IS REQUIRED WITH ADDPASN OPTION.'  26050000
         IHBERMAC 1309,&KW(4),&M(2)                                     26100000
&KILL    SETB  1                        Set error indicator             26150000
.*                                                                      26200000
.ADP4    ANOP                                                           26250000
&OTYPE   SETC  '02'                     Set ADDPASN option byte         26300000
.*                                      for parameter list              26350000
&OSFT    SETC  '188'                    Set up SFT offset for ADDPASN   26375000
         AGO   .COMMON                  Go generate code                26400000
.*                                                                      26450000
.*                                                                      26500000
.*                                                                      26550000
.*                                                                      26600000
.*                                                                      26650000
.********************************************************************** 26700000
.*       (DELETE) REQUEST                                             * 26750000
.********************************************************************** 26800000
.*                                                                      26850000
.DELETE  ANOP                                                           26900000
&A       SETA  1                        Make sure STOKEN, ACCESS, and   26950000
.*                                      AL were not specified           27000000
.*                                                                      27050000
.DE01    ANOP                                                           27100000
         AIF   (&S(&A) EQ 0).DE02       Branch around error message     27150000
.*                                      if keyword was not specified    27200000
.*                                                                      27250000
.*       MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH DELETE REQUEST.'   27300000
         IHBERMAC 1301,&KW(&A),&M(3)                                    27350000
&KILL    SETB  1                        Set error indicator             27400000
.*                                                                      27450000
.DE02    ANOP  ,                                                        27500000
&A       SETA  &A+1                     Increment the index to          27550000
.*                                      examine the next keyword        27600000
.*                                      to examine next keyword         27622200
         AIF   (&A EQ 4).DE02           Skip ALET keyword          @D1C 27644400
         AIF   (&A EQ 5).DE02           Skip MF keyword            @D1A 27666600
         AIF   (&A EQ 6).DE02           CHKEAX keyword             @D1A 27688800
         AIF   (&A GT 9).DE03           All done, then continue    @D1A 27711000
.*                                      checks.                         27733200
         AGO   .DE01                    Check current keyword      @D1A 27755400
.DE03    ANOP  ,                                                   @L2A 27777600
.*                                                                      27800000
         AIF   (&S(4) EQ 1).DE04        Make sure ALET was specified    27850000
.*                                                                      27900000
.*       MNOTE 12,'IHB309 - ''ALET'' IS REQUIRED WITH DELETE.'          27950000
         IHBERMAC 1309,&KW(4),&M(3)                                     28000000
&KILL    SETB  1                        Set error indicator             28050000
.*                                                                      28100000
.DE04    ANOP                                                           28150000
&OTYPE   SETC  '03'                     Indicate DELETE option for      28200000
.*                                      parameter list                  28250000
&OSFT    SETC  '192'                    Set up SFT offset for DELETE    28275000
         AGO   .COMMON                  Go generate code                28300000
.*                                                                      28350000
.*                                                                      28400000
.*                                                                      28450000
.********************************************************************** 28600000
.*       (EXTRACT) REQUEST                                            * 28650000
.********************************************************************** 28700000
.*                                                                      28750000
.EXTRACT ANOP                                                           28800000
&A       SETA  2                        Skip STOKEN keyword        @D1C 28850000
.*                                                                      28950000
.EX01    ANOP ,                                                    @D1C 28975000
         AIF   (&S(&A) EQ 0).EX02       Branch around error        @D1C 29000000
.*                                      message if keyword was not      29025000
.*                                      specified.                      29050000
.*       MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH EXTRACT REQUEST.'  29075000
         IHBERMAC 1301,&KW(&A),&M(4)                                    29100000
&KILL    SETB  1                        Set error indicator             29125000
.*                                                                      29150000
.EX02    ANOP  ,                                                        29197400
&A       SETA  &A+1                     Increment the index to     @D1A 29244800
.*                                      examine the next keyword        29292200
.*                                      to examine next keyword         29339600
         AIF   (&A EQ 4).EX02           Skip ALET keyword          @D1C 29387000
         AIF   (&A EQ 5).EX02           Skip MF keyword            @D1A 29434400
         AIF   (&A GT 9).EX03           All done, then continue    @D1A 29481800
.*                                      checks.                         29529200
         AGO   .EX01                    Check current keyword      @D1A 29576600
.EX03    ANOP ,                                                    @D1C 29624000
         AIF   (&S(4) EQ 1).EX04       Make sure ALET was specified     29672400
.*                                                                      29686000
.*       MNOTE 12,'IHB309 - ''ALET'' IS REQUIRED WITH EXTRACT.'         29700000
         IHBERMAC 1309,&KW(4),&M(4)                                     29750000
&KILL    SETB  1                       Set error indicator              29800000
.*                                                                      29850000
.EX04    ANOP                                                           29900000
         AIF   (&S(1) EQ 1).EX05       Make sure STOKEN was specified   29950000
.*                                                                      30000000
.*       MNOTE 12,'IHB309 - ''STOKEN'' IS REQUIRED WITH EXTRACT.'       30050000
         IHBERMAC 1309,&KW(1),&M(4)                                     30100000
&KILL    SETB  1                       Set error indicator              30150000
.*                                                                      30200000
.EX05    ANOP                                                           30250000
&OTYPE   SETC  '04'                     Indicate EXTRACT option for     30300000
.*                                      parameter list                  30350000
&OSFT    SETC  '196'                    Set up SFT offset for EXTRACT   30375000
         AGO   .COMMON                  Go generate code                30400000
.*                                                                      30450000
.*                                                                      30500000
.*                                                                      30550000
.*                                                                      30600000
.*                                                                      30650000
.********************************************************************** 30700000
.*       (EXTRACTH) REQUEST                                           * 30750000
.********************************************************************** 30800000
.*                                                                      30850000
.EXTRACTH ANOP                                                          30900000
&A       SETA  2                        Skip STOKEN keyword        @D1A 30950000
.*                                                                      31000000
.*                                                                      31050000
.EH01    ANOP                                                           31100000
         AIF   (&S(&A) EQ 0).EH02       Branch around error message     31150000
.*                                      if keyword was not specified    31200000
.*                                                                      31250000
.*       MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH EXTRACTH REQUEST.' 31300000
         IHBERMAC 1301,&KW(&A),&M(10)                                   31350000
&KILL    SETB  1                        Set error indicator             31400000
.*                                                                      31450000
.EH02    ANOP                                                           31500000
&A       SETA  &A+1                     Increment the index to          31550000
.*                                      examine the next keyword        31600000
         AIF   (&A EQ 5).EH02           Skip MF keyword            @D1A 31641600
         AIF   (&A GT 9).EH03           All done, then continue    @D1A 31683200
.*                                      checks.                         31724800
         AGO   .EH01                    Check current keyword      @D1A 31766400
.EH03    ANOP ,                                                    @D1A 31808000
         AIF   (&S(1) EQ 1).EH04        Make sure STOKEN was specified  31850000
.*                                                                      31900000
.*       MNOTE 12,'IHB309 - ''STOKEN'' IS REQUIRED WITH EXTRACTH.'      31950000
         IHBERMAC 1309,&KW(1),&M(10)                                    32000000
&KILL    SETB  1                        Set error indicator             32050000
.*                                                                      32100000
.EH04    ANOP                                                           32150000
&OTYPE   SETC  '06'                     Indicate EXTRACTH option for    32200000
.*                                      parameter list                  32250000
&OSFT    SETC  '196'                    Set up SFT offset for EXTRACTH  32275000
         AGO   .COMMON                  Go generate code                32300000
.*                                                                      32350000
.*                                                                      32400000
.*                                                                      32450000
.*                                                                      32500000
.*                                                                      32550000
.********************************************************************** 32600000
.*       (SEARCH) REQUEST                                             * 32650000
.********************************************************************** 32700000
.*                                                                      32750000
.SEARCH  ANOP                                                           32800000
         AIF   (&S(2) EQ 0).SR02       Make sure ACCESS was not         32850000
.*                                     specified                        32900000
.*                                                                      32950000
.*       MNOTE 12,'IHB301 - ''ACCESS'' INVALID WITH SEARCH REQUEST.'    33000000
         IHBERMAC 1301,&KW(2),&M(5)                                     33050000
&KILL    SETB  1                       Set error indicator              33100000
.*                                                                      33150000
.SR02    ANOP                                                           33200000
         AIF   (&S(6) EQ 0).SR03       Make sure CHKEAX was not    @L1A 33214200
.*                                     specified                        33228400
.*       MNOTE 12,'IHB301 - ''CHKEAX'' INVALID WITH SEARCH REQUEST.'    33242600
.*                                                                 @L1A 33256800
         IHBERMAC 1301,&KW(6),&M(5)                                @L1A 33271000
&KILL    SETB  1                       Set error indicator         @L1A 33285200
.*                                                                      33300000
.SR03    ANOP                                                           33312500
         AIF   (&S(7) EQ 0).SR06       Make sure CHKPT was not     @L2A 33313800
.*                                     specified                        33315100
.*       MNOTE 12,'IHB301 - ''CHKPT'' INVALID WITH SEARCH REQUEST.'     33316400
.*                                                                 @L2A 33317700
         IHBERMAC 1301,&KW(7),&M(5)                                @L2A 33319000
&KILL    SETB  1                       Set error indicator         @L2A 33320300
.*                                                                      33321600
.SR06    ANOP                                                      @L2A 33322900
         AIF   (&S(1) EQ 1).SR04       Make sure STOKEN was specified   33325000
.*                                                                      33337500
.*       MNOTE 12,'IHB309 - ''STOKEN'' IS REQUIRED WITH SEARCH OPTION.' 33350000
         IHBERMAC 1309,&KW(1),&M(5)                                     33400000
&KILL    SETB  1                       Set error indicator              33450000
.*                                                                      33500000
.SR04    ANOP                                                           33550000
         AIF   (&S(4) EQ 1).SR05       Make sure ALET was specified     33600000
.*                                                                      33650000
.*       MNOTE 12,'IHB309 - ''ALET'' IS REQUIRED WITH SEARCH OPTION.'   33700000
         IHBERMAC 1309,&KW(4),&M(5)                                     33750000
&KILL    SETB  1                       Set error indicator              33800000
.*                                                                      33850000
.SR05    ANOP                                                           33900000
&OTYPE   SETC  '05'                     Indicate SEARCH option for      33950000
.*                                      parameter list                  34000000
&OSFT    SETC  '200'                    Set up SFT offset for SEARCH    34025000
         AGO   .COMMON                  Go generate code                34050000
.*                                                                      34050500
.*                                                                      34051000
.*                                                                      34051500
.*                                                                      34052000
.*                                                                      34052500
.********************************************************************** 34053000
.*       (DUALPOOLCREATE) REQUEST                                     * 34053500
.********************************************************************** 34054000
.*                                                                      34054500
.DUALPOOLCREATE  ANOP  ,                                           @D1A 34055000
.*                                                                      34055500
&A       SETA  1                                                   @D1A 34056000
.*                                                                      34056500
.DC01    ANOP ,                                                    @D1A 34057000
         AIF   (&S(&A) EQ 0).DC02       Branch around error        @D1A 34057500
.*                                      message if keyword was not      34058000
.*                                      specified.                      34058500
.* MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH DUALPOOLCREATE REQUEST.' 34059000
         IHBERMAC 1301,&KW(&A),&M(11)                              @D1A 34059500
&KILL    SETB  1                        Set error indicator        @D1A 34060000
.*                                                                      34060500
.DC02    ANOP  ,                                                   @D1A 34061000
&A       SETA  &A+1                     Increment the index to     @D1A 34061500
.*                                      examine the next keyword        34062000
.*                                      to examine next keyword         34062500
         AIF   (&A EQ 5).DC02           Skip MF keyword            @D1A 34063000
         AIF   (&A GT 7).DC03           All done, then continue    @D1A 34063500
.*                                      checks.                         34064000
         AGO   .DC01                    Check current keyword      @D1A 34064500
.DC03    ANOP ,                                                    @D1A 34065000
         AIF   (&S(8) EQ 1).DC04       Make sure DUALPOOLTOKEN was @D1A 34065500
.*                                     specified                        34066000
.*                                                                      34066500
.*MNOTE 12,'IHB309 - ''DUALPOOLTOKEN'' IS REQUIRED WITH DUALPOOLCREATE. 34067000
         IHBERMAC 1309,&KW(8),&M(11)                               @D1A 34067500
&KILL    SETB  1                       Set error indicator         @D1A 34068000
.*                                                                      34068500
.DC04    ANOP ,                                                    @D1A 34069000
&DP(1)   SETB  0                        Indicate DUALPOOLCREATE    @D1A 34069500
.*                                      option for parameter list       34070000
.*                                      parameter list                  34070500
&OSFT    SETC  '472'                    Set up SFT offset for      @D1A 34071000
.*                                      DUALPOOL service routine.       34071500
         AGO   .COMMON                  Go generate code           @D1A 34072000
.*                                                                      34072500
.*                                                                      34073000
.********************************************************************** 34073500
.*       (DUALPOOLDELETE) REQUEST                                     * 34074000
.********************************************************************** 34074500
.*                                                                      34075000
.DUALPOOLDELETE  ANOP  ,                                           @D1A 34075500
.*                                                                      34076000
&A       SETA  1                                                   @D1A 34076500
.*                                                                      34077000
.DP01    ANOP ,                                                    @D1A 34077500
         AIF   (&S(&A) EQ 0).DP02       Branch around error        @D1A 34078000
.*                                      message if keyword was not      34078500
.*                                      specified.                      34079000
.* MNOTE 12,'IHB301 - ''&KW(&A)'' INVALID WITH DUALPOOLDELETE REQUEST.' 34079500
         IHBERMAC 1301,&KW(&A),&M(11)                              @D1A 34080000
&KILL    SETB  1                        Set error indicator        @D1A 34080500
.*                                                                      34081000
.DP02    ANOP  ,                                                   @D1A 34081500
&A       SETA  &A+1                     Increment the index to     @D1A 34082000
.*                                      examine the next keyword        34082500
.*                                      to examine next keyword         34083000
         AIF   (&A EQ 5).DP02           Skip MF keyword            @D1A 34083500
         AIF   (&A EQ 8).DP02           Skip DUALPOOLTOKEN keyword @D1A 34084000
         AIF   (&A GT 9).DP03           All done, then continue    @D1A 34084500
.*                                      checks.                         34085000
         AGO   .DP01                    Check current keyword      @D1A 34085500
.DP03    ANOP ,                                                    @D1A 34086000
         AIF   (&S(8) EQ 1).DP04       Make sure DUALPOOLTOKEN was @D1A 34086500
.*                                     specified                        34087000
.*                                                                      34087500
.*MNOTE 12,'IHB309 - ''DUALPOOLTOKEN'' IS REQUIRED WITH DUALPOOLDELETE. 34088000
         IHBERMAC 1309,&KW(8),&M(12)                               @D1A 34088500
&KILL    SETB  1                       Set error indicator         @D1A 34089000
.*                                                                      34089500
.DP04    ANOP ,                                                    @D1A 34090000
&DP(1)   SETB  1                        Indicate DUALPOOLDELETE    @D1A 34090500
.*                                      option for parameter list       34091000
.*                                      parameter list                  34091500
&OSFT    SETC  '472'                    Set up SFT offset for      @D1A 34092000
.*                                      DUALPOOL service routine.       34092500
         AGO   .COMMON                  Go generate code           @D1A 34093000
.*                                                                      34100000
.*                                                                      34150000
.*                                                                      34200000
.********************************************************************** 34250000
.*       COMMON CODE GENERATION SEQUENCE                              * 34300000
.********************************************************************** 34350000
.*                                                                      34400000
.*                                                                      34450000
.COMMON  ANOP                                                           34500000
         AIF   (&KILL EQ 0).GENIT       Generate code only if no errors 34550000
         MEXIT                                                          34600000
.*                                                                      34650000
.*                                                                      34700000
.*                                                                      34750000
.GENIT   ANOP                                                           34800000
.*                                                                      34850000
.********************************************************************** 34900000
.*       DETERMINE TYPE OF REQUEST                                    * 34950000
.********************************************************************** 35000000
.*                                                                      35050000
         AIF   ('&MFTYPE' EQ 'E').GENMFE  Go generate execute form      35100000
.*                                      if MF type is 'E'               35150000
.*                                                                      35200000
.*                                                                      35250000
.********************************************************************** 35300000
.*       STANDARD FORM SPECIFIED                                      * 35350000
.********************************************************************** 35400000
.*                                                                      35450000
&BOPTS   SETC  '&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'  Set up       35500000
.*                                      options byte for inline         35550000
.*                                      parameter list                  35600000
&GNAME1  SETC  'IHB'.'&SYSNDX'.'J'      Set up label names for inline   35650000
.*                                      parameter list                  35700000
&GNAME2  SETC  'IHB'.'&SYSNDX'.'F'                                      35750000
.*                                                                      35850000
.*                                                                      35900000
&LABL    DS    0H                   .ALESERV SERVICE ROUTINE CALL       35950000
         LAE   1,0(0,0)             .ZERO ACCESS REGISTER 1             35966600
         LA    1,&GNAME1            .POINT REG1 TO PARM LIST            35983200
.*                                                                      36000000
.********************************************************************** 36050000
.*       Move the STOKEN to the inline parameter list if the ADD      * 36450000
.*       or SEARCH options were specified.                            * 36500000
.********************************************************************** 36550000
.*                                                                      36600000
         AIF   ('&OPTION' EQ 'DUALPOOLCREATE').GENDUALPOOL        @D1A  36608300
         AIF   ('&OPTION' EQ 'DUALPOOLDELETE').GENDUALPOOL        @D1A  36616600
         AIF   ('&OPTION' EQ 'ADDPASN').CM1   Branch if ADDPASN option  36625000
         AIF   ('&OPTION' EQ 'DELETE').CM1 Branch if DELETE option      36650000
         AIF   ('&OPTION' EQ 'EXTRACTH').CM1 Branch if EXTRACTH option  36700000
         AIF   ('&OPTION' EQ 'EXTRACT').CM1 Branch if EXTRACT option    36750000
         AIF   ('&OPTION' EQ 'EXTRACT').CM1 Branch if EXTRACT option    36775000
.*                                                                      36800000
         LAE   14,&STOKEN           .GET AR MODE S-TYPE STOKEN ADDRESS  36850000
         MVC   8(8,1),0(14)         .STORE STOKEN INTO THE PARM LIST    36900000
.*                                                                      36950000
.********************************************************************** 37000000
.*       Move the ALET value to the inline parameter list if DELETE,  * 37050000
.*       EXTRACT, OR SEARCH options were specified.                   * 37100000
.********************************************************************** 37150000
.*                                                                      37200000
.CM1     ANOP                                                           37250000
         AIF   ('&OPTION' EQ 'ADD').CM3      Branch if ADD option       37300000
         AIF   ('&OPTION' EQ 'ADDPASN').CM3   Branch if ADDPASN option  37325000
         AIF   ('&OPTION' EQ 'EXTRACTH').CM3 Branch if EXTRACTH option  37350000
.*                                                                      37400000
         AIF   ('&LT4' EQ 'R').CM2      Branch if ALET is in register   37450000
.*                                                                      37500000
         LAE   14,&ALETV            .GET AR MODE S-TYPE ALET ADDRESS    37550000
         MVC   4(4,1),0(14)         .STORE ALET INTO THE PARM LIST      37600000
         AGO   .CM3                                                     37650000
.*                                                                      37700000
.CM2     ANOP                           ALET is in a register           37750000
         ST    &ALETV,4(0,1)        .STORE ALET INTO THE PARM LIST      37800000
         AGO   .CM3                 Return to common path.         @D1A 37800800
.*                                                                      37801600
.********************************************************************** 37802400
.*       Generate Dual Pool                                           * 37803200
.********************************************************************** 37804000
.*                                                                      37804800
.GENDUALPOOL  ANOP  ,                                              @D1A 37805600
&OTYPE   SETC  '00'                     Set reserved fields in     @D1A 37806400
.*                                      Dual Pool Service Parameter     37807200
.*                                      List                       @D1A 37808000
&BOPTS   SETC  '&DP(1)&DP(2)&DP(3)&DP(4)&DP(5)&DP(6)&DP(7)&DP(8)'  @D1A 37808800
.*                                      Set options byte for inline     37809600
.*                                      parameter list                  37810400
.*                                                                      37811200
.*   Move in DualPoolToken Address and Possibly DualPoolSize            37812000
.*  See if DUALPOOLSIZE was specified.                                  37812800
.*                                                                      37813600
         AIF   ('&S(9)' EQ '0').GENDPTOKEN  If DUALPOOLSIZE was    @D1A 37814400
.*                                  not specified, then go add          37815200
.*                                  DUALPOOLTOKEN address to the        37816000
.*                                  parameter list.                     37816800
.*                                                                      37817600
.*   Determine if the DualPoolSize Address in a register or             37818400
.*   is an rx-register notation.                                        37819200
.*                                                                      37820000
.*                                                                      37820800
         AIF   ('&LTDPSIZE' EQ 'R').GENDPSIZEREG  Branch if        @D1A 37821600
.*                                  DUALPOOLTOKEN is in a register      37822400
.*                                                                      37823200
         LAE   14,&DUALPOOLSIZEV    .GET AR MODE S-TYPE ALET       @D1AX37824000
                                    .ADDRESS                            37824800
         MVC   4(4,1),0(14)         .SIZE VALUE INTO PARM LIST     @D1A 37825600
         AGO   .GENDPSKPSIZEREG                                         37826400
.*                                                                      37827200
.GENDPSIZEREG ANOP  ,                Store user specified register @D1A 37828000
.*                                   into the parameter list.           37828800
         MVC   4(4,1),0(&DUALPOOLSIZV) . PUT DUALPOOLSIZE VALUE    @D1AX37829600
                                    .INTO THE PARAMETER LIST            37830400
.GENDPSKPSIZEREG  ANOP  ,            Store user specified register @D1A 37831200
.*                                                                      37832000
.*                                                                      37832800
.*   Determine if the DualPoolToken Address in a register or            37833600
.*   is an rx-register notation.                                        37834400
.*                                                                      37835200
.*                                                                      37836000
.GENDPTOKEN  ANOP  ,                 Store user specified register @D1A 37836800
         AIF   ('&LTDPTOKEN' EQ 'R').GENDPTOKENREG  Branch if      @D1A 37837600
.*                                  DUALPOOLTOKEN is in a register      37838400
.*                                                                      37839200
         LAE   14,&DUALPOOLTOKENV   .GET AR MODE S-TYPE ALET       @D1AX37840000
                                    .ADDRESS                            37840800
         ST    14,8(0,1)            .PUT DUALPOOLTOKEN ADDRESS     @D1AX37841600
                                    .INTO THE PARAMETER LIST            37842400
         AGO   .CM3                  Rejoin common processing      @D1A 37843200
.*                                                                      37844000
.GENDPTOKENREG ANOP  ,               Store user specified register @D1A 37844800
.*                                   into the parameter list.           37845600
         ST    &DUALPOOLTOKENV,8(0,1)  .PUT DUALPOOLTOKEN ADDRESS  @D1AX37846400
                                    .INTO THE PARAMETER LIST            37847200
.*                                                                      37850000
.********************************************************************** 37900000
.*       Generate common code                                         * 37950000
.********************************************************************** 38000000
.*                                                                      38050000
.CM3     ANOP                                                           38100000
         B     &GNAME2              .BRANCH AROUND PARM LIST            38125000
         CNOP  0,4                  .FORCE PARM LIST TO WORD BOUNDARY   38150000
&GNAME1  DC    XL1'&OTYPE'          .SERVICE TYPE CODE                  38200000
         DC    BL1'&BOPTS'          .OPTIONS BYTE                       38350000
         DC    AL2(0)               .RESERVED BYTES                     38400000
         DC    A(0)                 .ALET                               38416600
         DC    XL8'0'               .STOKEN (SPACE TOKEN)               38433200
.*                                                                      38450000
.********************************************************************** 38500000
.*       Generate PC linkage to ALESERV service routine               * 38537500
.*       Note - R14 is used as an index register to avoid             * 38575000
.*              setting AR14 to zero                                  * 38612500
.********************************************************************** 38650000
.*                                                                      38700000
.CM7     ANOP                                                           38750000
&GNAME2  L     14,16(0,0)           .GET ADDR OF CVT                    38800000
         L     14,772(14,0)         .GET ADDR OF SYSTEM FUNCTION TABLE  40250000
         L     14,&OSFT.(14,0)      .GET LX/EX FOR SERVICE ROUTINE      40300000
         PC    0(14)                .PC TO ALESERV SERVICE              40350000
.*                                                                      40400000
.********************************************************************** 40450000
.*       Exit if DELETE, DUALPOOLCREATE, DUALPOOLDELETE has           * 40471400
.*       output parameter list fields.                                * 40492800
.*                                                                    * 40514200
.*       NOTE:  The DUALPOOLCREATE updates the 16 byte DUALPOOLTOKEN  * 40535600
.*              area that is addressed by the DUALPOOLTOKEN keyword.  * 40557000
.*                                                                    * 40578400
.********************************************************************** 40600000
.*                                                                      40650000
         AIF   ('&OPTION' EQ 'DELETE').CM10  Branch if DELETE option    40700000
         AIF   ('&OPTION' EQ 'DUALPOOLCREATE').CM10  Branch if    @D1A  40710000
.*                                  DUALPOOLCREATE option.              40720000
         AIF   ('&OPTION' EQ 'DUALPOOLDELETE').CM10  Branch if    @D1A  40730000
.*                                  DUALPOOLDELETE option.              40740000
.*                                                                      40750000
.********************************************************************** 40800000
.*       Store the STOKEN into user's area if EXTRACT or              * 40850000
.*       EXTRACTH options were specified.                             * 40900000
.********************************************************************** 40950000
.*                                                                      41000000
         AIF   ('&OPTION' EQ 'ADD').CM8     Branch if ADD option        41050000
         AIF   ('&OPTION' EQ 'ADDPASN').CM8 Branch if ADDPASN option    41100000
         AIF   ('&OPTION' EQ 'SEARCH').CM8  Branch if SEARCH option     41150000
.*                                                                      41200000
         LAE   14,&STOKEN           .GET AR MODE S-TYPE STOKEN ADDRESS  41250000
         MVC   0(8,14),8(1)         .STORE STOKEN FROM THE PARM LIST    41300000
.*                                                                      41350000
.********************************************************************** 41400000
.*       Store the ALET in the user's area if ADD, ADDPASN, or        * 41450000
.*       SEARCH options were specified.                               * 41500000
.********************************************************************** 41550000
.*                                                                      41600000
         AGO   .CM10                                                    41650000
.*                                                                      41700000
.CM8     ANOP                                                           41750000
         AIF   ('&LT4' EQ 'R').CM9      Branch if ALET should be        41800000
.*                                      placed in a register            41850000
.*                                                                      41900000
         LAE   14,&ALETV            .GET AR MODE S-TYPE ALET ADDRESS    41950000
         MVC   0(4,14),4(1)         .STORE ALET FROM THE PARM LIST      42000000
         AGO   .CM10                                                    42050000
.*                                                                      42100000
.CM9     ANOP                           Load user specified register    42150000
.*                                      with the ALET                   42200000
         L     &ALETV,4(0,1)        .LOAD ALET FROM THE PARM LIST       42250000
.*                                                                      42300000
.CM10    ANOP                                                           42350000
         MEXIT                                                          42400000
.*                                                                      42450000
.*                                                                      42500000
.*                                                                      42550000
.*                                                                      42600000
.*                                                                      42650000
.*                                                                      42700000
.********************************************************************** 42750000
.*       MF=E  (EXECUTE FORM SPECIFIED)                               * 42800000
.*                                                                    * 42850000
.*       NOTE THAT ALL OPTIONS REQUIRED ON THE STANDARD FORM OF THE   * 42900000
.*       MACRO ARE ALSO REQUIRED ON THE EXECUTE FORM!                 * 42950000
.*                                                                    * 43000000
.********************************************************************** 43050000
.*                                                                      43100000
.GENMFE  ANOP                                                           43150000
         AIF   ('&OPTION' EQ 'DUALPOOLCREATE').GENMFEDPSETUP      @D1A  43166600
         AIF   ('&OPTION' EQ 'DUALPOOLDELETE').GENMFEDPSETUP      @D1A  43183200
&OPMVI   SETA  128*&B(1)+64*&B(2)+32*&B(3)+16*&B(4)+8*&B(5)+4*&B(6)+2*&X43200000
               B(7)+&B(8)               Set up flag byte for MVI        43250000
         AGO .GENMFELABEL                                         @D1A  43275000
.*                                                                      43300000
.GENMFEDPSETUP  ANOP  ,                                           @D1A  43308300
&OPMVI   SETA  128*&DP(1)+64*&DP(2)+32*&DP(3)+16*&DP(4)+8*&DP(5)+4*&DP(X43316600
               6)+2*&DP(7)+&DP(8)    Set up flag byte for MVI     @D1A  43324900
.*                                                                      43333200
.GENMFELABEL   ANOP  ,                                            @D1A  43341500
&LABL    DS    0H                   .ALESERV SERVICE ROUTINE CALL       43350000
.*                                                                      43400000
.********************************************************************** 43450000
.*       Place parameter list address in AR/GPR 1                     * 43500000
.********************************************************************** 43550000
.*                                                                      43600000
         AIF   ('&LTE' EQ 'R').CMX1     Branch if address is in         43650000
.*                                      a register                      43700000
.*                                                                      43750000
         LAE   1,&EPLV              .ALESERV PARAMETER LIST ADDRESS     43800000
         AGO   .CMX2                    Go continue execute form        43850000
.*                                                                      43900000
.CMX1    ANOP                                                           43950000
         LAE   1,0(0,&EPLV)         .ALESERV PARAMETER LIST ADDRESS     44000000
.*                                                                      44050000
.*                                                                      44100000
.********************************************************************** 44150000
.*       Place type code and flags byte in the parameter list         * 44200000
.********************************************************************** 44250000
.*                                                                      44300000
.CMX2    ANOP                                                           44350000
         MVI   0(1),X'&OTYPE'       .SET SERVICE TYPE CODE BYTE         44400000
         MVI   1(1),&OPMVI          .SET OPTIONS IN OPTIONS BYTE        44450000
.*                                                                      44500000
.********************************************************************** 44550000
.*       Move the STOKEN to the parameter list if the ADD             * 44950000
.*       or SEARCH options were specified.                            * 45000000
.********************************************************************** 45050000
.*                                                                      45100000
         AIF   ('&OPTION' EQ 'DUALPOOLCREATE').GENMFEDUALPOOL     @D1A  45108300
         AIF   ('&OPTION' EQ 'DUALPOOLDELETE').GENMFEDUALPOOL     @D1A  45116600
         AIF   ('&OPTION' EQ 'ADDPASN').CMX3 Branch if ADDPASN option   45125000
         AIF   ('&OPTION' EQ 'DELETE').CMX3 Branch if DELETE option     45150000
         AIF   ('&OPTION' EQ 'EXTRACTH').CMX3 Branch if EXTRACTH option 45200000
         AIF   ('&OPTION' EQ 'EXTRACT').CMX3 Branch if EXTRACT option   45250000
.*                                                                      45300000
         LAE   14,&STOKEN           .GET AR MODE S-TYPE STOKEN ADDRESS  45350000
         MVC   8(8,1),0(14)         .STORE STOKEN INTO THE PARM LIST    45400000
.*                                                                      45450000
.*                                                                      45500000
.********************************************************************** 45550000
.*       Move the ALET value to the parameter list if DELETE,         * 45600000
.*       EXTRACT, OR SEARCH options were specified.                   * 45650000
.********************************************************************** 45700000
.*                                                                      45750000
.GENMFEDUALPOOL ANOP   ,                                          @D1A  45775000
.CMX3    ANOP                                                           45800000
         AIF   ('&OPTION' EQ 'ADD').CMX5      Branch if ADD option      45850000
         AIF   ('&OPTION' EQ 'ADDPASN').CMX5 Branch if ADDPASN option   45875000
         AIF   ('&OPTION' EQ 'EXTRACTH').CMX5 Branch if EXTRACTH option 45900000
.*                                                                      45950000
         AIF   ('&LT4' EQ 'R').CMX4     Branch if ALET is in a register 46000000
.*                                                                      46050000
         LAE   14,&ALETV            .GET AR MODE S-TYPE ALET ADDRESS    46100000
         MVC   4(4,1),0(14)         .STORE ALET INTO THE PARM LIST      46150000
         AGO   .CMX5                                                    46200000
.*                                                                      46250000
.CMX4    ANOP                                                           46300000
         ST    &ALETV,4(0,1)        .STORE ALET INTO THE PARM LIST      46350000
         AGO   .CMX5                 Go join common processing     @D1A 46351000
.*                                                                      46352000
.*   Move in DualPoolToken Address and Possibly DualPoolSize            46353000
.*  See if DUALPOOLSIZE was specified.                                  46354000
.*                                                                      46355000
         AIF   ('&S(9)' EQ '0').GENMFEDPTOKEN  If DUALPOOLSIZE was @D1A 46356000
.*                                  not specified, then go add          46357000
.*                                  DUALPOOLTOKEN address to the        46358000
.*                                  parameter list.                     46359000
.*                                                                      46360000
.*   Determine if the DualPoolSize Address in a register or             46361000
.*   is an rx-register notation.                                        46362000
.*                                                                      46363000
.*                                                                      46364000
         AIF   ('&LTDPSIZE' EQ 'R').GENMFEDPSIZEREG  Branch if     @D1A 46365000
.*                                  DUALPOOLTOKEN is in a register      46366000
.*                                                                      46367000
         LAE   14,&DUALPOOLSIZEV    .GET AR MODE S-TYPE ALET       @D1AX46368000
                                    .ADDRESS                            46369000
         MVC   4(4,1),0(14)         .SIZE VALUE INTO PARM LIST     @D1A 46370000
         AGO   .GENDPMFESKPSIZEREG                                 @D1A 46371000
.*                                                                      46372000
.GENMFEDPSIZEREG ANOP  ,             Store user specified register @D1A 46373000
.*                                   into the parameter list.           46374000
         MVC   4(4,1),0(&DUALPOOLSIZV) . PUT DUALPOOLSIZE VALUE    @D1AX46375000
                                    .INTO THE PARAMETER LIST            46376000
.GENMFEDPSKPSIZEREG  ANOP  ,         Store user specified register @D1A 46377000
.*                                                                      46378000
.*                                                                      46379000
.*   Determine if the DualPoolToken Address in a register or            46380000
.*   is an rx-register notation.                                        46381000
.*                                                                      46382000
.*                                                                      46383000
.GENMFEDPTOKEN  ANOP  ,              Store user specified register @D1A 46384000
         AIF   ('&LTDPTOKEN' EQ 'R').GENMFEDPTOKENREG  Branch if   @D1A 46385000
.*                                  DUALPOOLTOKEN is in a register      46386000
.*                                                                      46387000
         LAE   14,&DUALPOOLTOKENV   .GET AR MODE S-TYPE ALET       @D1AX46388000
                                    .ADDRESS                            46389000
         ST    14,8(0,1)            .PUT DUALPOOLTOKEN ADDRESS     @D1AX46390000
                                    .INTO THE PARAMETER LIST            46391000
         AGO   .GENMFEDPSKPTOKENREG                                @D1A 46392000
.*                                                                      46393000
.GENDMFEPTOKENREG ANOP  ,            Store user specified register @D1A 46394000
.*                                   into the parameter list.           46395000
         ST    &DUALPOOLTOKENV,8(0,1)  .PUT DUALPOOLTOKEN ADDRESS  @D1AX46396000
                                    .INTO THE PARAMETER LIST            46397000
.*                                                                      46398000
.GENMFEDPSKPTOKENREG  ANOP  ,                                      @D1A 46399000
.*                                                                      46400000
.********************************************************************** 46450000
.*       Generate PC linkage to ALESERV service routine               * 46500000
.*       Note - R14 is used as an index register to avoid             * 46516600
.*              setting AR14 to zero                                  * 46533200
.********************************************************************** 46550000
.*                                                                      46600000
.CMX5    ANOP                                                           46650000
         L     14,16(0,0)           .GET ADDR OF CVT                    46700000
         L     14,772(14,0)         .GET ADDR OF SYSTEM FUNCTION TABLE  46750000
         L     14,&OSFT.(14,0)      .GET LX/EX FOR SERVICE ROUTINE      46800000
         PC    0(14)                .PC TO ALESERV SERVICE              46850000
.*                                                                      46900000
.********************************************************************** 46950000
.*       Exit if DELETE, DUALPOOLCREATE, DUALPOOLDELETE has           * 46971400
.*       output parameter list fields.                                * 46992800
.*                                                                    * 47014200
.*       NOTE:  The DUALPOOLCREATE updates the 16 byte DUALPOOLTOKEN  * 47035600
.*              area that is addressed by the DUALPOOLTOKEN keyword.  * 47057000
.*                                                                    * 47078400
.********************************************************************** 47100000
.*                                                                      47150000
         AIF   ('&OPTION' EQ 'DELETE').CMX8                             47200000
         AIF   ('&OPTION' EQ 'DUALPOOLCREATE').CMX8                @D1A 47216600
         AIF   ('&OPTION' EQ 'DUALPOOLDELETE').CMX8                @D1A 47233200
.*                                                                      47250000
.********************************************************************** 47300000
.*       Store the STOKEN into user's area if EXTRACT or              * 47350000
.*       EXTRACTH options were specified.                             * 47400000
.********************************************************************** 47450000
.*                                                                      47500000
         AIF   ('&OPTION' EQ 'ADD').CMX6     Branch if ADD option       47550000
         AIF   ('&OPTION' EQ 'ADDPASN').CMX6 Branch if ADDPASN option   47600000
         AIF   ('&OPTION' EQ 'SEARCH').CMX6  Branch if SEARCH option    47650000
.*                                                                      47700000
         LAE   14,&STOKEN           .GET AR MODE S-TYPE STOKEN ADDRESS  47750000
         MVC   0(8,14),8(1)         .STORE STOKEN FROM THE PARM LIST    47800000
.*                                                                      47850000
.********************************************************************** 47900000
.*       Store the ALET in the user's area if ADD, ADDPASN, or        * 47950000
.*       SEARCH options were specified.                               * 48000000
.********************************************************************** 48050000
.*                                                                      48100000
         AGO   .CMX8                                                    48150000
.*                                                                      48200000
.CMX6    ANOP                                                           48250000
         AIF   ('&LT4' EQ 'R').CMX7     Branch if ALET should be        48300000
.*                                      placed in a register            48350000
.*                                                                      48400000
         LAE   14,&ALETV            .GET AR MODE S-TYPE ALET ADDRESS    48450000
         MVC   0(4,14),4(1)         .STORE ALET FROM THE PARM LIST      48500000
         AGO   .CMX8                                                    48550000
.*                                                                      48600000
.CMX7    ANOP                           Place the ALET in the user      48650000
.*                                      specified register              48700000
         L     &ALETV,4(0,1)        .LOAD ALET FROM THE PARM LIST       48750000
.*                                                                      48800000
.CMX8    ANOP                                                           48850000
         MEXIT                                                          48900000
         MEND                                                           48950000
*                                                                    */ 49000000
*%ALESERV:                                                              49050000
*   MACRO KEYS(ACCESS,AL,ALET,STOKEN,MF,CHKEAX,CHKPT,                   49100000
*              DUALPOOLTOKEN,DUALPOOLSIZE,                              49133300
*              NOVIAONDCL,RELATED);                          /*  @D1C*/ 49166600
*   ANS ('?'||MACLABEL||'ALESERVP '||MACLIST||MACKEYS||';');            49200000
*   %END ALESERV;                                                       49250000
