*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IOSCHPD                               -10/20/99-<1> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  IOS CHPID Description Service                 * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     5647-A01 (C) COPYRIGHT IBM CORP. 1997, 2000                     * 00600000
*                                                                     * 00700000
* STATUS= HBB7703                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      The IOSCHPD macro returns the acronym and/or description of a  * 01100000
*      channel path (CHP) type.                                       * 01150000
*                                                                     * 01200000
*                                                                     * 01250000
*                                                                     * 01300000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 01350000
*                                                                     * 01400000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01450000
*                                                                     * 01500000
*01* ENVIRONMENT:                                                     * 01550000
*                                                                     * 01600000
*                                                                     * 01650000
*                        LINKAGE=SYSTEM callers must meet the         * 01700000
*                        following criteria:                          * 01750000
*                                                                     * 01800000
*      Dispatchable unit mode: Task or SRB mode.                      * 01850000
*                                                                     * 01900000
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 01950000
*                        key.                                         * 02000000
*                                                                     * 02050000
*      AMODE:            24- or 31-bit.                               * 02100000
*                                                                     * 02150000
*      ASC mode:         Primary or Access Register.                  * 02200000
*                                                                     * 02250000
*      Interrupt status: Enabled or disabled for I/O and external     * 02300000
*                        interrupts.                                  * 02350000
*                                                                     * 02400000
*      Locks:            No locks held.                               * 02450000
*                                                                     * 02500000
*                                                                     * 02550000
*                                                                     * 02600000
*01* PROGRAMMING REQUIREMENTS:                                        * 02650000
*                                                                     * 02700000
*    None                                                             * 02750000
*                                                                     * 02800000
*01* RESTRICTIONS:                                                    * 02850000
*                                                                     * 02900000
*    The parameter list must be in the caller's primary address space * 02950000
*    or be addressable via the dispatchable unit access list.         * 03000000
*                                                                     * 03050000
*    The LINKAGE=BRANCH option is limited to callers which meet the   * 03100000
*    following criteria:                                              * 03150000
*                                                                     * 03200000
*                                                                     * 03250000
*    o   supervisor state and key 0                                   * 03300000
*                                                                     * 03350000
*    o   31 bit addressing mode                                       * 03400000
*                                                                     * 03450000
*    o   primary ASC mode                                             * 03500000
*                                                                     * 03550000
*    o   the parameter list resides in fixed or DREF storage          * 03600000
*                                                                     * 03650000
*                                                                     * 03700000
*                                                                     * 03750000
*01* PERFORMANCE IMPLICATIONS:                                        * 03800000
*                                                                     * 03850000
*    None.                                                            * 03900000
*                                                                     * 03950000
*01* MACRO USAGE NOTES:                                               * 04000000
*                                                                     * 04050000
*                                                                     * 04100000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 04150000
*        global macro variable.  Any value other than 'NO' will       * 04200000
*        result in the macro expansion being printed.  The default is * 04250000
*        'YES'.  The following examples illustrate how the ZPRINT     * 04300000
*        variable should be set.                                      * 04350000
*                                                                     * 04400000
*                    GBLC &ZPRINT                                     * 04450000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 04500000
*                                                                     * 04550000
*                                                                     * 04600000
*    2.  All keys currently contained in the IOSCHPD macro correspond * 04650000
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 04700000
*        MAX.                                                         * 04750000
*                                                                     * 04800000
*                                                                     * 04850000
*                                                                     * 04900000
*                                                                     * 04950000
*01* INPUT REGISTER INFORMATION:                                      * 05000000
*                                                                     * 05050000
*    Before  issuing  the  IOSCHPD macro, the caller does not have to * 05100000
*    place  any  information  into  any  register  unless using it in * 05150000
*    register  notation  for a particular parameter, or using it as a * 05200000
*    base register                                                    * 05250000
*                                                                     * 05300000
*01* OUTPUT REGISTER INFORMATION:                                     * 05350000
*                                                                     * 05400000
*    The  contents  of  registers  14  through  1  are altered during * 05450000
*    processing.                                                      * 05500000
*                                                                     * 05550000
*    When control returns to the caller, the GPRs contain:            * 05600000
*                                                                     * 05650000
*                                                                     * 05700000
*    REGISTER  CONTENTS                                               * 05750000
*                                                                     * 05800000
*    0         Reason Code                                            * 05850000
*                                                                     * 05900000
*    1         Unpredictable (Used as a work register by the system)  * 05950000
*                                                                     * 06000000
*    2-13      Unchanged                                              * 06050000
*                                                                     * 06100000
*    14        Unpredictable (Used as a work register by the system)  * 06150000
*                                                                     * 06200000
*    15        Return Code                                            * 06250000
*                                                                     * 06300000
*                                                                     * 06350000
*                                                                     * 06400000
*    When control returns to the caller, the ARs contain:             * 06450000
*                                                                     * 06500000
*                                                                     * 06550000
*    REGISTER  CONTENTS                                               * 06600000
*                                                                     * 06650000
*    0-1       Unpredictable (Used as work registers by the system)   * 06700000
*                                                                     * 06750000
*    2-13      Unchanged                                              * 06800000
*                                                                     * 06850000
*    14-15     Unpredictable (Used as work registers by the system)   * 06900000
*                                                                     * 06950000
*                                                                     * 07000000
*                                                                     * 07050000
*01* SYNTAX:                                                          * 07100000
*                                                                     * 07150000
*[xlabel]  IOSCHPD    CHPID=xchpid                                   * 07200000
*                    ,CHP_TYPE=xchp_type                             * 07250000
*                        [,CHP_PARM=xchp_parm|0]                    * 07275000
*                    ,ACRONYM=[xacronym]                             * 07300000
*                    ,DESC=[xdesc]                                   * 07350000
*                    [,LINKAGE=SYSTEM|BRANCH]                       * 07400000
*                    [,RETCODE=xretcode]                              * 07450000
*                    [,RSNCODE=xrsncode]                              * 07500000
*                    [,PLISTVER=xplistver|IMPLIED_VERSION]          * 07550000
*                   [,MF=S]                                          * 07600000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 07650000
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 07700000
*                                                                     * 07750000
*                                                                     * 07800000
*      Where:                                                         * 07850000
*                                                                     * 07900000
*                                                                     * 07950000
*      [xlabel]                                                       * 08000000
*          is an optional symbol, starting in column 1, that is the   * 08050000
*          name on the IOSCHPD macro invocation.  The name must       * 08100000
*          conform to the rules for an ordinary assembler language    * 08150000
*          symbol.                                                    * 08200000
*          DEFAULT: No name.                                          * 08250000
*                                                                     * 08300000
*                                                                     * 08350000
*                                                                     * 08400000
*                                                                     * 08450000
*      The following is a set of mutually exclusive keys.  This set   * 08500000
*      is required; only one key must be specified.                   * 08550000
*                                                                     * 08600000
*                                                                     * 08650000
*      CHPID=xchpid                                                   * 08700000
*          belongs to a set of mutually exclusive keys. It is the     * 08750000
*          name (RS-type), or address in register (2)-(12), of a      * 08800000
*          halfword input which specifies the CHPID number for which  * 08850000
*          to retrieve the acronym and/or description.                * 08900000
*                                                                     * 08950000
*      CHP_TYPE=xchp_type                                             * 09000000
*          belongs to a set of mutually exclusive keys. It is the     * 09050000
*          name (RS-type), or address in register (2)-(12), of a byte * 09100000
*          input which specifies the channel path type for which to   * 09150000
*          retrieve the acronym and/or description.  The channel path * 09200000
*          type can be obtained by invoking the ?UCBINFO PATHINFO     * 09250000
*          macro and mapping the results with the IOSDPATH mapping    * 09300000
*          macro.  (The interface type is in the field called         * 09350000
*          PathIntType).                                              * 09400000
*                                                                     * 09450000
*                                                                     * 09500000
*          [CHP_PARM=xchp_parm|0]                                   * 09505000
*              is the name (RS-type), or address in register          * 09510000
*              (2)-(12), of an optional byte input which specifies    * 09515000
*              the Channel Path Parameter. If managed option is       * 09520000
*              specified with this keyword and if the  CHP Type  is   * 09525000
*              managed, the description and acronym returned  will    * 09530000
*              indicate that the CHP Type is managed. 1 corresponds   * 09535000
*              to the managed option and 0 corresponds to the non     * 09540000
*              managed option.                                        * 09545000
*                                                                     * 09550000
*              NOTE:  If no CHP_PARM is specified, information        * 09555500
*              returned for default non managed option                * 09561000
*              DEFAULT: 0.                                            * 09566500
*                                                                     * 09572000
*                                                                     * 09577500
*                                                                     * 09583000
*                                                                     * 09588500
*                                                                     * 09594000
*      End of a set of mutually exclusive required keys.              * 09600000
*                                                                     * 09650000
*                                                                     * 09700000
*                                                                     * 09750000
*      The following is a group of keys.  At least one must be        * 09800000
*      specified.                                                     * 09850000
*                                                                     * 09900000
*                                                                     * 09950000
*      ACRONYM=[xacronym]                                             * 10000000
*          is the name (RS-type), or address in register (2)-(12), of * 10050000
*          a 5 character output area which is to receive the acronym. * 10100000
*                                                                     * 10150000
*      DESC=[xdesc]                                                   * 10200000
*          is the name (RS-type), or address in register (2)-(12), of * 10250000
*          a 32 character output area which is to receive the         * 10300000
*          description.                                               * 10350000
*                                                                     * 10400000
*                                                                     * 10450000
*                                                                     * 10500000
*      End of group of keys.                                          * 10550000
*                                                                     * 10600000
*                                                                     * 10650000
*                                                                     * 10700000
*      [LINKAGE=SYSTEM|BRANCH]                                      * 10750000
*          is an optional keyword input that indicates whether a      * 10800000
*          branch-entry linkage should be generated or a Program Call * 10850000
*          should be issued for the routine invocation.               * 10900000
*          DEFAULT: SYSTEM                                            * 10950000
*                                                                     * 11000000
*                                                                     * 11050000
*          LINKAGE=SYSTEM                                             * 11100000
*              requests Program Call invocation.                      * 11150000
*                                                                     * 11200000
*          LINKAGE=BRANCH                                             * 11250000
*              requests branch-entry invocation.  The LINKAGE=BRANCH  * 11300000
*              option is intended for performance-sensitive invokers  * 11350000
*              or programs which require this function during NIP     * 11400000
*              before a PC can be issued.  See RESTRICTIONS for the   * 11450000
*              restrictions on branch-entry invocation.               * 11500000
*                                                                     * 11550000
*                                                                     * 11600000
*                                                                     * 11650000
*                                                                     * 11700000
*                                                                     * 11750000
*                                                                     * 11800000
*      [RETCODE=xretcode]                                             * 11850000
*          is the name (RS-type) of an optional fullword output       * 11900000
*          variable, or register (2)-(12), into which the return code * 11950000
*          is to be copied from GPR 15.                               * 12000000
*                                                                     * 12050000
*                                                                     * 12100000
*                                                                     * 12150000
*                                                                     * 12200000
*      [RSNCODE=xrsncode]                                             * 12250000
*          is the name (RS-type) of an optional fullword output       * 12300000
*          variable, or register (2)-(12), into which the reason code * 12350000
*          is to be copied from GPR 0.                                * 12400000
*                                                                     * 12450000
*                                                                     * 12500000
*                                                                     * 12550000
*                                                                     * 12600000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 12650000
*          is an optional byte input decimal value in the "1-1" range * 12700000
*          that specifies the macro version.  PLISTVER is the only    * 12750000
*          key allowed on the list form of MF and determines which    * 12800000
*          parameter list is generated.  Note that MAX may be         * 12850000
*          specified instead of a number, and the parameter list will * 12900000
*          be of the largest size currently supported. This size may  * 12950000
*          grow from release to release (thus possibly affecting the  * 13000000
*          amount of storage needed by your program).  If your        * 13050000
*          program can tolerate this, IBM recommends that you always  * 13100000
*          specify MAX when creating the list form parameter list as  * 13150000
*          that will ensure that the list form parameter list is      * 13200000
*          always long enough to hold whatever parameters might be    * 13250000
*          specified on the execute form.                             * 13300000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 13350000
*          default is the lowest version which allows all of the      * 13400000
*          parameters specified on the invocation to be processed.    * 13450000
*                                                                     * 13500000
*                                                                     * 13550000
*                                                                     * 13600000
*                                                                     * 13650000
*      [MF=S|L|E]                                                   * 13700000
*          is an optional keyword input which specifies the macro     * 13750000
*          form.                                                      * 13800000
*          DEFAULT: S                                                 * 13850000
*                                                                     * 13900000
*                                                                     * 13950000
*          [MF=S]                                                     * 14000000
*              specifies the standard form of the macro.  The "S"     * 14050000
*              form generates code to put the parameters into an      * 14100000
*              in-line parameter list and invoke the desired service. * 14150000
*              Full checking for required macro keys is done along    * 14200000
*              with supplying defaults for omitted optional           * 14250000
*              parameters.                                            * 14300000
*                                                                     * 14350000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 14400000
*              specifies the list form of the macro.  The "L" form    * 14450000
*              defines an area to be used for the parameter list.     * 14500000
*              Only the PLISTVER key may be specified on the          * 14550000
*              invocation.  All other macro parameters are flagged as * 14600000
*              errors.  If PLISTVER is not specified, the original    * 14650000
*              parameter list definition is used.                     * 14700000
*                                                                     * 14750000
*            ,xmfctrl                                                 * 14800000
*              is a required input.  It is the name of a storage area * 14850000
*              for the parameter list.                                * 14900000
*                                                                     * 14950000
*            ,xmfattr|0D                                            * 15000000
*              is an optional 60 character input string that varies   * 15050000
*              from 1 to 60 characters. Use it to force boundary      * 15100000
*              alignment of the parameter list. Use only 0F or 0D.    * 15150000
*              DEFAULT: 0D which forces the parameter list to a       * 15200000
*              doubleword boundary.                                   * 15250000
*                                                                     * 15300000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 15350000
*              specifies the execute form of the macro.  The "E" form * 15400000
*              generates code to put the parameters into the          * 15450000
*              parameter list specified by xmfctrl and provides full  * 15500000
*              syntax checking with default setting.                  * 15550000
*                                                                     * 15600000
*            ,xmfctrl                                                 * 15650000
*              is a required input.  It is the name (RS-type), or     * 15700000
*              address in register (1)-(12), of a storage area for    * 15750000
*              the parameter list.                                    * 15800000
*                                                                     * 15850000
*            ,COMPLETE                                              * 15900000
*              is an optional keyword input which specifies the       * 15950000
*              degree of macro parameter syntax checking.             * 16000000
*              DEFAULT: COMPLETE                                      * 16050000
*                                                                     * 16100000
*                                                                     * 16150000
*              COMPLETE                                               * 16200000
*                  Checking for required macro keys is done and       * 16250000
*                  defaults are supplied for omitted optional         * 16300000
*                  parameters.                                        * 16350000
*                                                                     * 16400000
*                                                                     * 16450000
*                                                                     * 16500000
*                                                                     * 16550000
*                                                                     * 16600000
*                                                                     * 16650000
*                                                                     * 16700000
*01* RETURN CODES:                                                    * 16750000
*                                                                     * 16800000
*                                                                     * 16850000
*                                                                     * 16900000
*                 X'00'     The acronym and/or description has been   * 16950000
*                           returned.                                 * 17000000
*                                                                     * 17050000
*                 X'04'     For all reasons except noted the acronym  * 17100000
*                           and/or description have not been returned * 17150000
*                           (the acronym and description output areas * 17200000
*                           have been set to zereos).                 * 17250000
*                                                                     * 17300000
*                           Reason Codes                              * 17350000
*                                                                     * 17400000
*                                                                     * 17450000
*                           X'00'     The system could not determine  * 17500000
*                                     the CHP type from the input     * 17550000
*                                     CHPID.                          * 17600000
*                                                                     * 17650000
*                           X'01'     The input CHPID is not          * 17700000
*                                     configured.                     * 17750000
*                                                                     * 17800000
*                           X'02'     The CHP type obtained from the  * 17850000
*                                     input CHPID is not valid.       * 17900000
*                                                                     * 17950000
*                           X'03'     The input CHP type is invalid.  * 18000000
*                                                                     * 18005500
*                           X'04'     The input CHP_PARM is invalid.  * 18011000
*                                                                     * 18016500
*                           X'05'     The managed option(1) was       * 18022000
*                                     specified with CHP_PARM.However * 18027500
*                                     CHP Type is not managed. The    * 18033000
*                                     default acronym and/or          * 18038500
*                                     description is returned.        * 18044000
*                                                                     * 18050000
*                                                                     * 18100000
*                                                                     * 18150000
*                 X'08'     Error in caller's parameters.             * 18200000
*                                                                     * 18250000
*                           Reason codes                              * 18300000
*                                                                     * 18350000
*                                                                     * 18400000
*                           X'01'     The caller specified an invalid * 18450000
*                                     ALET.                           * 18500000
*                                                                     * 18550000
*                           X'02'     An error occurred in accessing  * 18600000
*                                     the caller's parameter list.    * 18650000
*                                                                     * 18700000
*                                                                     * 18750000
*                                                                     * 18800000
*                 X'C'      Recovery was entered.                     * 18850000
*                                                                     * 18900000
*                 X'20'     Recovery was entered.                     * 18950000
*                                                                     * 19000000
*                                                                     * 19050000
*                                                                     * 19100000
*                                                                     * 19150000
*                                                                     * 19200000
*01* REASON CODES:                                                    * 19250000
*                                                                     * 19300000
*       See return codes section.                                     * 19350000
*                                                                     * 19400000
*01* MODULE TYPE:  ASSEM MACRO                                        * 19450000
*                                                                     * 19500000
*02*   PROCESSOR:  ASSEM                                              * 19550000
*                                                                     * 19600000
*01* COMPONENT:  SC1C3                                                * 19650000
*                                                                     * 19700000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 19750000
*                                                                     * 19800000
*01* CHANGE ACTIVITY:                                                 * 19850000
*                                                                     * 19900000
*   Flag LineItem  FMID    Date   ID    Comment                       * 19950000
*                                                                     * 20000000
*    $L0=HERC     HBB6605 970423 PDHC:  Hercules support              * 20025000
*    $L1=DYCHM    HBB7703 991022 PDUU:  Dynamic CHPID Management      * 20033300
*                                         Support                     * 20041600
*    $P1=PUX0381  HBB6605 970819 PDHC:  Remove Hercules support - no  * 20050000
*                                         code change                 * 20075000
*    $01=OW33706  HBB6603 980630 PDLE:  No code changes. Reship to    * 20083300
*                                         complete OW33706            * 20091600
*    $02=OW37043  HBB6603 990730 MXN:  Correct function code set when * 20093700
*                                         invoking IOSCHPD from       * 20095800
*                                         assembler program.          * 20097900
****** END OF SPECIFICATIONS *****************************************/ 20100000
*/* TLINE 1 *********************************************************** 20150000
         MACRO                                                          20200000
&XLABEL  IOSCHPD &CHPID=,&CHP_TYPE=,&CHP_PARM=,&ACRONYM=,&DESC=,       *20250000
               &LINKAGE=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=            20300000
.*                                                                      20350000
*              MACDATE -10/20/99-<1>                                    20400000
.*                                                                      20450000
.*******************************************************************    20500000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        20550000
.*******************************************************************    20600000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   20650000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     20700000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             20750000
.*                                                                      20800000
              GBLC  &ZIOSCHPD   YES=MACRO USED AT LEAST ONCE            20850000
.*******************************************************************    20900000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          20950000
.*******************************************************************    21000000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 21050000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            21100000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              21150000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             21200000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             21250000
              LCLA  &ZAWRK      USED AS A WORK AREA                     21300000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  21350000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   21400000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 21450000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             21500000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 21550000
              LCLA  &ZMACRET    MACRO RETURN CODE                       21600000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        21650000
.*                                                                      21700000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      21750000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              21800000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   21850000
              LCLC  &ZENDBASEPL                 End of base PL          21900000
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   21950000
.*******************************************************************    22000000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             22050000
.*******************************************************************    22100000
              LCLA  &ZI         INDEX FOR ARRAY                         22150000
              LCLA  &ZJ         INDEX FOR PARMS                         22200000
              LCLA  &ZK         INDEX FOR PARSE                         22250000
              LCLA  &ZLO        LOW RANGE VALUE                         22300000
              LCLA  &ZHI        HIGH RANGE VALUE                        22350000
              LCLC  &ZW         WORK AREA FOR PARM                      22400000
.********************************************************************   22450000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 22500000
.********************************************************************   22550000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 22600000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          22650000
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        22675000
.*                                                                      22700000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       22750000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        22800000
              SPLEVEL  TEST                                             22850000
.ZSYS2        ANOP  ,                                                   22900000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              22950000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              23000000
              SYSSTATE TEST                                             23050000
              AGO   .ZSYS4                                              23100000
.ZSYS3        ANOP  ,                                                   23150000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 23200000
.ZSYS4        ANOP  ,                                                   23250000
.*******************************************************************    23300000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   23350000
.*******************************************************************    23400000
              LCLC  &XCHPIDVAR1                 ++ NAME                 23450000
              LCLC  &XCHPID     ++ NAME                                 23500000
              LCLC  &XCHP_TYPE  ++ NAME                                 23550000
              LCLC  &XCHP_PARM  ++ NAME                                 23575000
              LCLC  &XACRONYM   ++ NAME                                 23600000
              LCLC  &XDESC      ++ NAME                                 23650000
              LCLC  &XLINKAGE   ++ VALUE                                23700000
              LCLC  &XRETCODE   ++ NAME                                 23750000
              LCLC  &XRSNCODE   ++ NAME                                 23800000
              LCLA  &XPLISTVER  ++ VALUE                                23850000
              LCLC  &XMF        ++ VALUE                                23900000
              LCLC  &XMFCTRL    ++ NAME                                 23950000
              LCLC  &XMFATTR    ++ VALUE                                24000000
              LCLC  &XMFSCK     ++ VALUE                                24050000
.*******************************************************************    24100000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           24150000
.*******************************************************************    24200000
              LCLC  &ZXCHPIDVAR1                ++ INPUT NAME           24250000
              LCLC  &ZXCHPID    ++ INPUT NAME                           24300000
              LCLC  &ZXCHP_TYPE                 ++ INPUT NAME           24350000
              LCLC  &ZXCHP_PARM                 ++ INPUT NAME           24375000
              LCLC  &ZXACRONYM  ++ OUTPUT NAME                          24400000
              LCLC  &ZXDESC     ++ OUTPUT NAME                          24450000
              LCLC  &ZXLINKAGE  ++ INPUT VALUE                          24500000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          24550000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          24600000
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          24650000
              LCLC  &ZXMF       ++ INPUT VALUE                          24700000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           24750000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          24800000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          24850000
.********************************************************************   24900000
.***AC.PLV01  PROCESS PLISTVER                                      *   24950000
.********************************************************************   25000000
&XPLISTVER      SETA  1                                                 25050000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       25100000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   25150000
&XPLISTVER      SETA  1                                                 25200000
.ZPLV0          ANOP  ,                                                 25250000
.*                                                                      25300000
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      25350000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      25400000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  25450000
.*-------------------------------------------------------------------   25500000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 25550000
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                25600000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 25650000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 25700000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               25750000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                25800000
                AGO   .ZPVCK2                                           25850000
.ZPVCK3         ANOP  ,                                                 25900000
.*-------------------------------------------------------------------   25950000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  26000000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                26050000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 26100000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         26150000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 26200000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                26250000
                AGO   .ZPVCKE                                           26300000
.ZPVCK2         ANOP  ,                                                 26350000
.*-------------------------------------------------------------------   26400000
&ZCVAL          SETC  '&PLISTVER(1)'                                    26450000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             26500000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             26550000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        26600000
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      26650000
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     26700000
.ZPVCK6         ANOP  ,                                                 26750000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                26800000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 26850000
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         26900000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         26950000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                27000000
&XPLISTVER      SETA  1                                                 27050000
                AGO   .ZPVCKE                                           27100000
.*-------------------------------------------------------------------   27150000
.ZPVCK4A        ANOP  ,                                                 27200000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        27250000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                27300000
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               27350000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          27400000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 27450000
                MNOTE 8,' &ZMS IS REQUIRED.'                            27500000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                27550000
                AGO   .ZPVCK5                                           27600000
.ZPVCK4         ANOP  ,                                                 27650000
&XPLISTVER      SETA  &PLISTVER(1)                                      27700000
.ZPVCK5         ANOP  ,                                                 27750000
.ZPVCKE         ANOP  ,                                                 27800000
.********************************************************************   27850000
.***AG.MF01 PROCESS MF MACRO FORMS                                      27900000
.********************************************************************   27950000
              ACTR  10000                                               28000000
.*------------------------------------------------------------------    28050000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           28100000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    28150000
.*-------------------------------------------------------------------   28200000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           28250000
.ZG28         ANOP  ,                                                   28300000
&ZTLC         SETC 'S'                                                  28350000
              AIF   ('&MF(1)' NE '&ZTLC').ZG29                          28400000
&XMF          SETC  'S'         SET KEYWORD                             28450000
              AIF   (N'&MF LE 1).ZG28A          CK NUM                  28500000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           28550000
&ZMS          SETC  '&ZMS.&MF"'                                         28600000
&ZMS          SETC  '&ZMS "MF"'                                         28650000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 28700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28750000
.ZG28A        ANOP  ,                                                   28800000
.*-------------------------------------------------------------------   28850000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           28900000
.ZG29         ANOP  ,                                                   28950000
&ZTLC         SETC 'L'                                                  29000000
              AIF   ('&MF(1)' NE '&ZTLC').ZG36                          29050000
&XMF          SETC  'L'         SET KEYWORD                             29100000
              AIF   (N'&MF LE 3).ZG29A          CK NUM                  29150000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           29200000
&ZMS          SETC  '&ZMS.&MF"'                                         29250000
&ZMS          SETC  '&ZMS "MF"'                                         29300000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                29350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             29400000
.ZG29A        ANOP  ,                                                   29450000
.*-------------------------------------------------------------------   29500000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     29550000
              AIF   (N'&SYSLIST NE 0).ZG29B     POSITIONALS?            29595800
              AIF   ('&CHPID' NE '').ZG29B      KEYS?                   29641600
              AIF   ('&CHP_TYPE' NE '').ZG29B   KEYS?                   29687400
              AIF   ('&CHP_PARM' NE '').ZG29B   KEYS?                   29733200
              AIF   ('&ACRONYM' NE '').ZG29B    KEYS?                   29779000
              AIF   ('&DESC' NE '').ZG29B       KEYS?                   29824800
              AIF   ('&LINKAGE' NE '').ZG29B    KEYS?                   29870600
              AIF   ('&RETCODE' NE '').ZG29B    KEYS?                   29916400
              AIF   ('&RSNCODE' NE '').ZG29B    KEYS?                   29962200
              AGO    .ZG29C     INVOCATION OKAY                         30008000
.ZG29B        ANOP  ,                                                   30053800
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            30100000
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                30150000
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           30200000
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              30250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30300000
.ZG29C        ANOP  ,                                                   30350000
.*-------------------------------------------------------------------   30400000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   30450000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           30500000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           30550000
              AIF   (N'&MF(2) GT 1).ZG31B       MULTI PARMS             30600000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           30650000
.ZG31B        AIF   (K'&MF(2) GT 0).ZG31C                               30700000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         30750000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 30800000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 30850000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        30900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30950000
.ZG31C        ANOP  ,                                                   31000000
.*-------------------------------------------------------------------   31050000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               31100000
              AIF   (K'&ZXMFCTRL LE 0).ZG31P    NOT I/O                 31150000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG31P                      31200000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         31250000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           31300000
&ZMS          SETC  '&ZMS.&MF"'                                         31350000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           31400000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   31450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             31500000
.ZG31P        ANOP  ,                                                   31550000
.*-------------------------------------------------------------------   31600000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      31650000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           31700000
&XMFATTR      SETC  '0D'                                                31750000
              AIF   (K'&MF(3) LE 0).ZG34B       PARM                    31800000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           31850000
              AIF   (N'&MF(3) GT 1).ZG34B       MULTI PARMS             31900000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           31950000
.ZG34B        ANOP  ,                                                   32000000
.*-------------------------------------------------------------------   32050000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  32100000
              AIF   (K'&ZXMFATTR LE 0).ZG34P    NOT I/O                 32150000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG34P                      32200000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         32250000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           32300000
&ZMS          SETC  '&ZMS.&MF"'                                         32350000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           32400000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   32450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             32500000
.ZG34P        ANOP  ,                                                   32550000
.*-------------------------------------------------------------------   32600000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 32650000
              AIF   (K'&ZXMFATTR LE 0).ZG34S    NOT I/O                 32700000
              AIF   (K'&XMFATTR LE 60).ZG34S    LNG OK                  32750000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         32800000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           32850000
&ZMS          SETC  '&ZMS.&MF"'                                         32900000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               32950000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  33000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33050000
.ZG34S        ANOP  ,                                                   33100000
.*-------------------------------------------------------------------   33150000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           33200000
.ZG36         ANOP  ,                                                   33250000
&ZTLC         SETC 'E'                                                  33300000
              AIF   ('&MF(1)' NE '&ZTLC').ZG44                          33350000
&XMF          SETC  'E'         SET KEYWORD                             33400000
              AIF   (N'&MF LE 3).ZG36A          CK NUM                  33450000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           33500000
&ZMS          SETC  '&ZMS.&MF"'                                         33550000
&ZMS          SETC  '&ZMS "MF"'                                         33600000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                33650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33700000
.ZG36A        ANOP  ,                                                   33750000
.*-------------------------------------------------------------------   33800000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   33850000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           33900000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           33950000
              AIF   (N'&MF(2) GT 1).ZG38B       MULTI PARMS             34000000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           34050000
.ZG38B        AIF   (K'&MF(2) GT 0).ZG38C                               34100000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         34150000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 34200000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 34250000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        34300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34350000
.ZG38C        ANOP  ,                                                   34400000
.*-------------------------------------------------------------------   34450000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              34500000
              AIF   (K'&ZXMFCTRL LE 0).ZG38R    NOT I/O                 34550000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG38R                      34600000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          34650000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                        34700000
              AIF   (K'&ZCGPR GT 2).ZG38Q                               34750000
              AIF   ('&ZCGPR' EQ '0').ZG38Q                             34800000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       34850000
              AIF   (T'&ZCGPR NE 'N').ZG38Q     INVALID REG NAME        34900000
.ZG38P        ANOP  ,                                                   34950000
              AIF   (T'&ZCGPR NE 'N').ZG38R     NON NUMERIC             35000000
              AIF   ('&ZCGPR' LT '1').ZG38Q                             35050000
              AIF   ('&ZCGPR' LE '12').ZG38R                            35100000
.ZG38Q        ANOP  ,                                                   35150000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           35200000
&ZMS          SETC  '&ZMS.&MF"'                                         35250000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           35300000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    35350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             35400000
.ZG38R        ANOP  ,                                                   35450000
.*-------------------------------------------------------------------   35500000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             35550000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    35600000
.ZG42A   AIF   ('&MF(3)' NE 'COMPLETE').ZG43A                           35650000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             35700000
.*-------------------------------------------------------------------   35750000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             35800000
.ZG43A        AIF   (K'&XMFSCK GT 0).ZG43C      KEYWORD                 35850000
              AIF   (K'&MF(3) LE 0).ZG43B                               35900000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           35950000
&ZMS          SETC  '&ZMS.&MF"'                                         36000000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           36050000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 36100000
&ZMS          SETC  '&ZMS "COMPLETE".'                                  36150000
              MNOTE 8,' &ZMS '                                          36200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36250000
.ZG43B        ANOP  ,                                                   36300000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     36350000
.ZG43C        ANOP  ,                                                   36400000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           36450000
.*------------------------------------------------------------------    36500000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36550000
.ZG44         ANOP  ,                                                   36600000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           36650000
              AIF   (K'&XMF GT 0).ZG44E         VALID ARG               36700000
              AIF   (T'&MF EQ 'O').ZG44D        OMITTED                 36750000
&ZASYSLNDX    SETA  0                                                   36800000
.ZG44A        ANOP  ,           POSITIONAL MACRO KEY                    36850000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        36900000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG44C                    36950000
&ZTLC         SETC 'MF'                                                 37000000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG44A           37050000
.ZG44B        ANOP  ,                                                   37100000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         37150000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           37200000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             37250000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    37300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37350000
              AGO   .ZG44E                                              37400000
.ZG44C        ANOP  ,                                                   37450000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         37500000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           37550000
&ZMS          SETC  '&ZMS.&MF"'                                         37600000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           37650000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 37700000
&ZMS          SETC  '&ZMS "S",'                                         37750000
&ZMS          SETC  '&ZMS "L",'                                         37800000
&ZMS          SETC  '&ZMS OR "E".'                                      37850000
              MNOTE 8,' &ZMS '                                          37900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37950000
              AGO   .ZG44E                                              38000000
.ZG44D        ANOP  ,                                                   38050000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     38100000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       38150000
.ZG44E        ANOP  ,                                                   38200000
.********************************************************************   38250000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 38300000
.********************************************************************   38350000
              ACTR  10000                                               38400000
.*-------------------------------------------------------------------   38450000
.***AG.MF03 MF=(SLE)                                                    38500000
              AIF   ('&XMF' EQ 'L').ZGMFX                               38550000
.*----------------------------------------------------------------***   38600000
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      38650000
&XCHPIDVAR1   SETC  ''          INITIALIZE XVARIABLE                    38700000
              AIF   (K'&CHPID LE 0).ZG2C                                38750000
&ZXCHPIDVAR1  SETC  'INPUT'     SET IN/OUTPUT                           38800000
&XCHPIDVAR1   SETC  'CHPID'     SET XVARIABLE                           38850000
&ZXCHPID      SETC  'INPUT'     SET IN/OUTPUT                           38900000
&XCHPID       SETC  '&CHPID(1)'                 SET XVARIABLE PARM      38950000
              AIF   (N'&CHPID GT 1).ZG2A                                39000000
&XCHPID       SETC  '&CHPID'    SET XVARIABLE PARM                      39050000
.ZG2A         AIF   (N'&CHPID LE 1).ZG2B        CK NUM                  39100000
&ZMS          SETC  '"CHPID='   *KPOSA* MNOTE                           39150000
&ZMS          SETC  '&ZMS.&CHPID"'                                      39200000
&ZMS          SETC  '&ZMS "CHPID"'                                      39250000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 39300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39350000
.ZG2B         AIF   (K'&XCHPID GT 0).ZG2C       ONE PARM                39400000
&ZXCHPIDVAR1  SETC  ''          RESET IN/OUTPUT                         39450000
&ZXCHPID      SETC  ''          RESET IN/OUTPUT                         39500000
&ZMS          SETC  ' '         *KRQDA*                                 39550000
&ZMS          SETC  '&ZMS "CHPID" KEY AND ITS'                          39600000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    39650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39700000
.ZG2C         ANOP  ,                                                   39750000
.*----------------------------------------------------------------***   39800000
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      39850000
              AIF   (K'&CHP_TYPE LE 0).ZG3D     NO ME KEY               39900000
              AIF   (N'&CHP_TYPE LE 1).ZG3A     CK NUM                  39950000
&ZMS          SETC  '"CHP_TYPE='                *KPOSA* MNOTE           40000000
&ZMS          SETC  '&ZMS.&CHP_TYPE"'                                   40050000
&ZMS          SETC  '&ZMS "CHP_TYPE"'                                   40100000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 40150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40200000
.ZG3A         AIF   (K'&XCHPIDVAR1 LE 0).ZG3B                           40250000
&ZMS          SETC  '"CHP_TYPE'                 *KMEKA* MNOTE           40300000
&ZMS          SETC  '&ZMS.=&CHP_TYPE"'                                  40350000
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               40400000
&ZMS          SETC  '&ZMS "&XCHPIDVAR1"'                                40450000
              MNOTE 8,' &ZMS KEY.'                                      40500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40550000
              AGO   .ZG3D                                               40600000
.*                                                                      40650000
.ZG3B         ANOP  ,                                                   40700000
&ZXCHPIDVAR1  SETC  'INPUT'     SET IN/OUTPUT                           40750000
&XCHPIDVAR1   SETC  'CHP_TYPE'  SET XVARIABLE                           40800000
&ZXCHP_TYPE   SETC  'INPUT'     SET IN/OUTPUT                           40850000
&XCHP_TYPE    SETC  '&CHP_TYPE(1)'              SET XVARIABLE PARM      40900000
              AIF   (N'&CHP_TYPE GT 1).ZG3C                             40950000
&XCHP_TYPE    SETC  '&CHP_TYPE'                 SET XVARIABLE PARM      41000000
.ZG3C         AIF   (K'&XCHP_TYPE GT 0).ZG3D    ONE PARM                41050000
&ZXCHPIDVAR1  SETC  ''          RESET IN/OUTPUT                         41100000
&ZXCHP_TYPE   SETC  ''          RESET IN/OUTPUT                         41150000
&ZMS          SETC  ' '         *KRQDA*                                 41200000
&ZMS          SETC  '&ZMS "CHP_TYPE" KEY AND ITS'                       41250000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    41300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41350000
.ZG3D         ANOP  ,                                                   41400000
.*------------------------------------------------------------------    41450000
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           41500000
              AIF   (K'&XCHPIDVAR1 GT 0).ZG7B                           41550000
&ZXCHPIDVAR1  SETC  ''          RESET IN/OUTPUT                         41600000
&ZXCHPID      SETC  ''          RESET IN/OUTPUT                         41650000
&XCHPIDVAR1   SETC  ''          ENSURE NULL                             41700000
&XCHPID       SETC  ''          ENSURE NULL                             41750000
&ZMS          SETC  'ONE OF THE FOLLOWING'      *KMERA* MNOTE           41800000
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 41850000
&ZMS          SETC  '&ZMS REQUIRED:'                                    41900000
&ZMS          SETC  '&ZMS "CHPID"'              VALID ME KEY            41950000
&ZMS          SETC  '&ZMS OR "CHP_TYPE".'       VALID ME KEY            42000000
              MNOTE 8,' &ZMS '                                          42050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             42100000
.ZG7B         ANOP  ,                                                   42150000
.*-------------------------------------------------------------------   42200000
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           42250000
.ZG2          AIF   ('&XCHPIDVAR1' NE 'CHPID').ZG3                      42300000
.*-------------------------------------------------------------------   42350000
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                42353500
&ZCVAL        SETC ''           ERROR KEY FIELD                         42357000
.ZG2I0        AIF   (K'&CHP_PARM LE 0).ZG2I1                            42360500
&ZCVAL        SETC '&ZCVAL CHP_PARM'            DISALLOWED KEY          42364000
.ZG2I1        AIF   (K'&ZCVAL LE 0).ZG2J        KEY                     42367500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               42371000
&ZMS          SETC  '"CHPID'    *KMEIA* MNOTE                           42374500
&ZMS          SETC  '&ZMS.=&CHPID"'                                     42378000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                42381500
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                42385000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             42388500
.ZG2J         ANOP  ,                                                   42392000
.*-------------------------------------------------------------------   42395500
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 42400000
              AIF   (K'&ZXCHPID LE 0).ZG2R      NOT I/O                 42450000
              AIF   ('&XCHPID'(1,1) NE '(').ZG2R                        42500000
&ZCGPR        SETC  '&XCHPID'(2,K'&XCHPID-2)                            42550000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         42600000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                42650000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              42700000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       42750000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        42800000
.ZG2P         ANOP  ,                                                   42850000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             42900000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              42950000
              AIF   ('&ZCGPR' LE '12').ZG2R                             43000000
.ZG2Q         ANOP  ,                                                   43050000
&ZMS          SETC  '"CHPID='   *KGPRA* MNOTE                           43100000
&ZMS          SETC  '&ZMS.&CHPID"'                                      43150000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           43200000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    43250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             43300000
.ZG2R         ANOP  ,                                                   43350000
.*-------------------------------------------------------------------   43400000
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           43450000
.ZG3          AIF   ('&XCHPIDVAR1' NE 'CHP_TYPE').ZG7                   43500000
.*-------------------------------------------------------------------   43550000
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 43600000
              AIF   (K'&ZXCHP_TYPE LE 0).ZG3R   NOT I/O                 43650000
              AIF   ('&XCHP_TYPE'(1,1) NE '(').ZG3R                     43700000
&ZCGPR        SETC  '&XCHP_TYPE'(2,K'&XCHP_TYPE-2)                      43750000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                         43800000
              AIF   (K'&ZCGPR GT 2).ZG3Q                                43850000
              AIF   ('&ZCGPR' EQ '0').ZG3Q                              43900000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       43950000
              AIF   (T'&ZCGPR NE 'N').ZG3Q      INVALID REG NAME        44000000
.ZG3P         ANOP  ,                                                   44050000
              AIF   (T'&ZCGPR NE 'N').ZG3R      NON NUMERIC             44100000
              AIF   ('&ZCGPR' LT '2').ZG3Q                              44150000
              AIF   ('&ZCGPR' LE '12').ZG3R                             44200000
.ZG3Q         ANOP  ,                                                   44250000
&ZMS          SETC  '"CHP_TYPE='                *KGPRA* MNOTE           44300000
&ZMS          SETC  '&ZMS.&CHP_TYPE"'                                   44350000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           44400000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    44450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44500000
.ZG3R         ANOP  ,                                                   44550000
.*----------------------------------------------------------------***   44555000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     44560000
              AIF   (N'&CHP_PARM LE 1).ZG5A     CK NUM                  44565000
&ZMS          SETC  '"CHP_PARM='                *KPOSA* MNOTE           44570000
&ZMS          SETC  '&ZMS.&CHP_PARM"'                                   44575000
&ZMS          SETC  '&ZMS "CHP_PARM"'                                   44580000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 44585000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44590000
.ZG5A         ANOP  ,                                                   44595000
.*-------------------------------------------------------------------   44600000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         44616600
&ZXCHP_PARM   SETC  'INPUT'     SET IN/OUTPUT                           44633200
&XCHP_PARM    SETC  '0'                                                 44649800
              AIF   (K'&CHP_PARM(1) LE 0).ZG5B  PARM                    44666400
&XCHP_PARM    SETC  '&CHP_PARM(1)'              SET XVARIABLE           44683000
              AIF   (N'&CHP_PARM GT 1).ZG5B     MULTI PARMS             44699600
&XCHP_PARM    SETC  '&CHP_PARM'                 SET XVARIABLE           44716200
.ZG5B         ANOP  ,                                                   44732800
.*-------------------------------------------------------------------   44750000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    44800000
              AIF   (K'&ZXCHP_PARM LE 0).ZG5R   NOT I/O                 44850000
              AIF   ('&XCHP_PARM'(1,1) NE '(').ZG5R                     44900000
&ZCGPR        SETC  '&XCHP_PARM'(2,K'&XCHP_PARM-2)                      44950000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         45000000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                45050000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              45100000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       45150000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        45200000
.ZG5P         ANOP  ,                                                   45250000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             45300000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              45350000
              AIF   ('&ZCGPR' LE '12').ZG5R                             45400000
.ZG5Q         ANOP  ,                                                   45450000
&ZMS          SETC  '"CHP_PARM='                *KGPRA* MNOTE           45500000
&ZMS          SETC  '&ZMS.&CHP_PARM"'                                   45550000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           47550000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    47600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47650000
.ZG5R         ANOP  ,                                                   47700000
.*-------------------------------------------------------------------   48200000
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            48250000
.ZG7          ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             48300000
.*-------------------------------------------------------------------   48650000
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  48700000
              AIF   (K'&ZXCHP_PARM LE 0).ZG8R   NOT I/O                 48750000
              AIF   ('&XCHP_PARM'(1,1) NE '(').ZG8R                     48800000
&ZCGPR        SETC  '&XCHP_PARM'(2,K'&XCHP_PARM-2)                      48850000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         50700000
              AIF   (K'&ZCGPR GT 2).ZG8Q                                50750000
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              50800000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       50850000
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        50900000
.ZG8P         ANOP  ,                                                   50950000
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             51000000
              AIF   ('&ZCGPR' LT '2').ZG8Q                              51050000
              AIF   ('&ZCGPR' LE '12').ZG8R                             51100000
.ZG8Q         ANOP  ,                                                   51150000
&ZMS          SETC  '"CHP_PARM='                *KGPRA* MNOTE           51150600
&ZMS          SETC  '&ZMS.&CHP_PARM"'                                   51151200
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           51151800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    51152400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51153000
.ZG8R         ANOP  ,                                                   51153600
.*----------------------------------------------------------------***   51154200
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   51154800
              AIF   (N'&ACRONYM LE 1).ZG9A      CK NUM                  51155400
&ZMS          SETC  '"ACRONYM='                 *KPOSA* MNOTE           51156000
&ZMS          SETC  '&ZMS.&ACRONYM"'                                    51156600
&ZMS          SETC  '&ZMS "ACRONYM"'                                    51157200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 51157800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51158400
.ZG9A         ANOP  ,                                                   51159000
.*-------------------------------------------------------------------   51159600
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       51160200
&ZXACRONYM    SETC  'OUTPUT'    SET IN/OUTPUT                           51160800
&XACRONYM     SETC  '&ACRONYM(1)'               SET XVARIABLE           51161400
              AIF   (N'&ACRONYM GT 1).ZG9B      MULTIPLE PARMS          51162000
&XACRONYM     SETC  '&ACRONYM'  SET XVARIABLE                           51162600
.ZG9B         AIF   (K'&ACRONYM(1) GT 0).ZG9C                           51163200
&ZXACRONYM    SETC  ''          RESET IN/OUTPUT                         51163800
.ZG9C         ANOP  ,                                                   51164400
.*-------------------------------------------------------------------   51165000
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  51165600
              AIF   (K'&ZXACRONYM LE 0).ZG9R    NOT I/O                 51166200
              AIF   ('&XACRONYM'(1,1) NE '(').ZG9R                      51166800
&ZCGPR        SETC  '&XACRONYM'(2,K'&XACRONYM-2)                        51167400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                         51168000
              AIF   (K'&ZCGPR GT 2).ZG9Q                                51168600
              AIF   ('&ZCGPR' EQ '0').ZG9Q                              51169200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       51169800
              AIF   (T'&ZCGPR NE 'N').ZG9Q      INVALID REG NAME        51170400
.ZG9P         ANOP  ,                                                   51171000
              AIF   (T'&ZCGPR NE 'N').ZG9R      NON NUMERIC             51171600
              AIF   ('&ZCGPR' LT '2').ZG9Q                              51172200
              AIF   ('&ZCGPR' LE '12').ZG9R                             51172800
.ZG9Q         ANOP  ,                                                   51173400
&ZMS          SETC  '"ACRONYM='                 *KGPRA* MNOTE           51174000
&ZMS          SETC  '&ZMS.&ACRONYM"'                                    51174600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           51175200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    51175800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51176400
.ZG9R         ANOP  ,                                                   51177000
.*----------------------------------------------------------------***   51177600
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   51178200
              AIF   (N'&DESC LE 1).ZG10A        CK NUM                  51178800
&ZMS          SETC  '"DESC='    *KPOSA* MNOTE                           51179400
&ZMS          SETC  '&ZMS.&DESC"'                                       51180000
&ZMS          SETC  '&ZMS "DESC"'                                       51180600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 51181200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51181800
.ZG10A        ANOP  ,                                                   51182400
.*-------------------------------------------------------------------   51183000
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       51183600
&ZXDESC       SETC  'OUTPUT'    SET IN/OUTPUT                           51184200
&XDESC        SETC  '&DESC(1)'  SET XVARIABLE                           51184800
              AIF   (N'&DESC GT 1).ZG10B        MULTIPLE PARMS          51185400
&XDESC        SETC  '&DESC'     SET XVARIABLE                           51186000
.ZG10B        AIF   (K'&DESC(1) GT 0).ZG10C                             51186600
&ZXDESC       SETC  ''          RESET IN/OUTPUT                         51187200
.ZG10C        ANOP  ,                                                   51187800
.*-------------------------------------------------------------------   51188400
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  51189000
              AIF   (K'&ZXDESC LE 0).ZG10R      NOT I/O                 51189600
              AIF   ('&XDESC'(1,1) NE '(').ZG10R                        51190200
&ZCGPR        SETC  '&XDESC'(2,K'&XDESC-2)                              51190800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        51191400
              AIF   (K'&ZCGPR GT 2).ZG10Q                               51192000
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             51192600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       51193200
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        51193800
.ZG10P        ANOP  ,                                                   51194400
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             51195000
              AIF   ('&ZCGPR' LT '2').ZG10Q                             51195600
              AIF   ('&ZCGPR' LE '12').ZG10R                            51196200
.ZG10Q        ANOP  ,                                                   51196800
&ZMS          SETC  '"DESC='    *KGPRA* MNOTE                           51200000
&ZMS          SETC  '&ZMS.&DESC"'                                       51250000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           51300000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    51350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51400000
.ZG10R        ANOP  ,                                                   51402600
.*-------------------------------------------------------------------   51405200
.***AG.KMGRP11 NAME,  OUTPUT, ME GROUP -AT LEAST ONE SPECIFIED          51407800
&ZCVAL        SETC ''           ERROR KEY FIELD                         51410400
              AIF   (K'&XACRONYM GT 0).ZG11J                            51413000
&ZCVAL        SETC '&ZCVAL,ACRONYM'             NOT USED KEY            51415600
              AIF   (K'&XDESC GT 0).ZG11J                               51418200
&ZCVAL        SETC '&ZCVAL,DESC'                NOT USED KEY            51420800
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               51423400
&ZMS          SETC  'ONE OR MORE OF THE'        *MGRPA* MNOTE           51426000
&ZMS          SETC  '&ZMS FOLLOWING KEY(S) IS REQUIRED: '               51428600
&ZMS          SETC  '&ZMS "ACRONYM",'                                   51431200
              MNOTE 8,' &ZMS " DESC".'                                  51433800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51436400
.ZG11J        ANOP  ,                                                   51439000
.ZG11K        ANOP  ,                                                   51441600
.*-------------------------------------------------------------------   51444200
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  51446800
              AIF   (K'&ZXDESC LE 0).ZG11R      NOT I/O                 51449400
              AIF   ('&XDESC'(1,1) NE '(').ZG11R                        51452000
&ZCGPR        SETC  '&XDESC'(2,K'&XDESC-2)                              51454600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                        51457200
              AIF   (K'&ZCGPR GT 2).ZG11Q                               51459800
              AIF   ('&ZCGPR' EQ '0').ZG11Q                             51462400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       51465000
              AIF   (T'&ZCGPR NE 'N').ZG11Q     INVALID REG NAME        51467600
.ZG11P        ANOP  ,                                                   51470200
              AIF   (T'&ZCGPR NE 'N').ZG11R     NON NUMERIC             51472800
              AIF   ('&ZCGPR' LT '2').ZG11Q                             51475400
              AIF   ('&ZCGPR' LE '12').ZG11R                            51478000
.ZG11Q        ANOP  ,                                                   51480600
&ZMS          SETC  '"DESC='    *KGPRA* MNOTE                           51483200
&ZMS          SETC  '&ZMS.&DESC"'                                       51485800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           51488400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    51491000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51493600
.ZG11R        ANOP  ,                                                   51496200
.*----------------------------------------------------------------***   51500000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             51550000
              AIF   (N'&LINKAGE LE 1).ZG13A     CK NUM                  51600000
&ZMS          SETC  '"LINKAGE='                 *KPOSA* MNOTE           51650000
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    51700000
&ZMS          SETC  '&ZMS "LINKAGE"'                                    51750000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 51800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51850000
.ZG13A        ANOP  ,                                                   51900000
.*-------------------------------------------------------------------   51950000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             52000000
&XLINKAGE     SETC  ''          INITIALIZE XVARIABLE                    52050000
.ZG14A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG15A                        52100000
&XLINKAGE     SETC  'SYSTEM'    SET KEYWORD                             52150000
.*-------------------------------------------------------------------   52200000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             52250000
.ZG15A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG16A                        52300000
&XLINKAGE     SETC  'BRANCH'    SET KEYWORD                             52350000
.*-------------------------------------------------------------------   52400000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             52450000
.ZG16A        AIF   (K'&XLINKAGE GT 0).ZG16C    KEYWORD                 52500000
              AIF   (K'&LINKAGE(1) LE 0).ZG16B                          52550000
&ZMS          SETC  '"LINKAGE='                 *KUKWA* MNOTE           52600000
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    52650000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           52700000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 52750000
&ZMS          SETC  '&ZMS "SYSTEM"'                                     52800000
&ZMS          SETC  '&ZMS OR "BRANCH".'                                 52850000
              MNOTE 8,' &ZMS '                                          52900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             52950000
.ZG16B        ANOP  ,                                                   53000000
&XLINKAGE     SETC  'SYSTEM'    SET DEFAULT KEYWORD                     53050000
.ZG16C        ANOP  ,                                                   53100000
&ZXLINKAGE    SETC  'INPUT'     SET IN/OUTPUT                           53150000
.*----------------------------------------------------------------***   53200000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    53250000
              AIF   (N'&RETCODE LE 1).ZG18A     CK NUM                  53300000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           53350000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    53400000
&ZMS          SETC  '&ZMS "RETCODE"'                                    53450000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 53500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             53550000
.ZG18A        ANOP  ,                                                   55500000
.*-------------------------------------------------------------------   55550000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        55600000
              AIF   (K'&RETCODE(1) LE 0).ZG18C  NO PARM                 55650000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              55700000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           55750000
              AIF   (N'&RETCODE GT 1).ZG18C                             55800000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           55850000
.ZG18C        ANOP  ,                                                   55900000
.*-------------------------------------------------------------------   55950000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   56000000
              AIF   (K'&ZXRETCODE LE 0).ZG18R   NOT I/O                 56050000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG18R                     56100000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        56150000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                        56200000
              AIF   (K'&ZCGPR GT 2).ZG18Q                               56250000
              AIF   ('&ZCGPR' EQ '0').ZG18Q                             56300000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       56350000
              AIF   (T'&ZCGPR NE 'N').ZG18Q     INVALID REG NAME        56400000
.ZG18P        ANOP  ,                                                   56450000
              AIF   (T'&ZCGPR NE 'N').ZG18R     NON NUMERIC             56500000
              AIF   ('&ZCGPR' LT '2').ZG18Q                             56550000
              AIF   ('&ZCGPR' LE '12').ZG18R                            56600000
.ZG18Q        ANOP  ,                                                   56650000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           56651200
&ZMS          SETC  '&ZMS.&RETCODE"'                                    56652400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           56653600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    56654800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56656000
.ZG18R        ANOP  ,                                                   56657200
.*----------------------------------------------------------------***   56658400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    56659600
              AIF   (N'&RSNCODE LE 1).ZG21A     CK NUM                  56660800
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           56662000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    56663200
&ZMS          SETC  '&ZMS "RSNCODE"'                                    56664400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 56665600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56666800
.ZG21A        ANOP  ,                                                   56668000
.*-------------------------------------------------------------------   56669200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        56670400
              AIF   (K'&RSNCODE(1) LE 0).ZG21C  NO PARM                 56671600
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              56672800
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           56674000
              AIF   (N'&RSNCODE GT 1).ZG21C                             56675200
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           56676400
.ZG21C        ANOP  ,                                                   56677600
.*-------------------------------------------------------------------   56678800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   56680000
              AIF   (K'&ZXRSNCODE LE 0).ZG21R   NOT I/O                 56681200
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG21R                     56682400
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        56683600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                        56684800
              AIF   (K'&ZCGPR GT 2).ZG21Q                               56686000
              AIF   ('&ZCGPR' EQ '0').ZG21Q                             56687200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       56688400
              AIF   (T'&ZCGPR NE 'N').ZG21Q     INVALID REG NAME        56689600
.ZG21P        ANOP  ,                                                   56690800
              AIF   (T'&ZCGPR NE 'N').ZG21R     NON NUMERIC             56692000
              AIF   ('&ZCGPR' LT '2').ZG21Q                             56693200
              AIF   ('&ZCGPR' LE '12').ZG21R                            56694400
.ZG21Q        ANOP  ,                                                   56695600
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           56700000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    56750000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           56800000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    56850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56900000
.ZG21R        ANOP  ,                                                   56950000
.******************************************************************     57000000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        57050000
.******************************************************************     57100000
              ACTR  10000                                               57150000
.*----------------------------------------------------------------***   57200000
.***AH.P02 EXTRA POSITIONALS                                            57250000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               57300000
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                57350000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            57400000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             57450000
.ZGLISTX1     ANOP  ,                                                   57500000
&ZCVAL        SETC  ''          ERROR FIELD                             57550000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       57600000
.ZGLIST2      ANOP  ,                                                   57650000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         57700000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                57750000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   57800000
              AGO   .ZGLIST2                                            57850000
.*                                                                      57900000
.ZGLIST3      ANOP  ,                                                   57950000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             58000000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           58050000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     58100000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              58150000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      58200000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              58250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             58300000
.ZGLISTX      ANOP  ,                                                   58350000
&ZASYSLNDX    SETA  0                                                   58400000
.*-------------------------------------------------------------------   58450000
.***AG.MF04 MF=(SLE)                                                    58500000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                58550000
.*******************************************************************    58600000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       58650000
.*******************************************************************    58700000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          58750000
.*******************************************************************    58800000
.***AE.01  START OF IOSCHPD MACRO CODE                                  58850000
.*******************************************************************    58900000
              LCLC  &M0M0001                 NAME                       58950000
&M0M0001      SETC  '&XLABEL'                SET NAME                   59000000
              AIF   (K'&XLABEL NE 0).XLAB2                              59050000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               59100000
.*                                                                      59150000
.XLAB2        ANOP  ,                                                   59200000
              AIF   ('&XMF' EQ 'L').XLAB3                               59250000
&M0M0001 DS    0H                             IOSCHPD-1                 59300000
.XLAB3        ANOP  ,                                                   59350000
.*******************************************************************    59400000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              59450000
.*******************************************************************    59500000
              PUSH  PRINT                                               59550000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          59600000
              PRINT OFF         ++ PR01                                 59650000
              AGO   .ZPRNTXX                                            59700000
.ZPRINTX      PRINT ON                                                  59750000
.ZPRNTXX      ANOP  ,                                                   59800000
.********************************************************************   59850000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     59900000
.********************************************************************   59950000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       60000000
                      LCLA  &ZOPN1         INVOCATION INDEX             60050000
                      LCLC  &ZOPL(4095)    LABEL                        60100000
                      LCLC  &ZOPO(4095)    OPERATION                    60150000
                      LCLC  &ZOPV(4095)    VALUE                        60200000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  60250000
.*                                                                      60300000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     60350000
.******************************************************************     60400000
.***AL.L10 IOSCHPD FMT=LIST MF=S|L PARAMETERS                           60450000
.******************************************************************     60500000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     60550000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     60600000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     60650000
&XMFATTR              SETC  '0D'                                        60700000
.*                                                                      60750000
&ZOPN                 SETA  &ZOPN+1                                     60800000
&ZOPL(&ZOPN)          SETC  ' '                                         60850000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     60875000
&ZOPO(&ZOPN)          SETC  'B'                                         60900000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                60950000
                      AGO   .ZALVL6B                                    60958300
.ZALVL6A              ANOP                                              60966600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      60974900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              60983200
.ZALVL6B              ANOP                                              60991500
&ZOPD(&ZOPN)          SETC  '++ IOSCHPD ARG PARMS'                      61000000
.*                                                                      61050000
&ZOPN                 SETA  &ZOPN+1                                     61100000
&ZOPL(&ZOPN)          SETC  ' '                                         61150000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     61200000
&ZOPV(&ZOPN)          SETC  '1'                                         61250000
&ZOPD(&ZOPN)          SETC  ' '                                         61300000
.*                                                                      61350000
.ZLMFSL2              ANOP  ,                                           61400000
.*-------------------------------------------------------------------   61450000
.***AM.L00  IOSCHPD FMT=LIST name                                       61500000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    61550000
&ZOPN                 SETA &ZOPN+1                                      61600000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   61650000
&ZOPO(&ZOPN)          SETC 'EQU'                                        61700000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   61750000
&ZOPD(&ZOPN)          SETC '++ IOSCHPD NAME'                            61800000
.ZLMFSL2M             ANOP  ,                                           61850000
.*-------------------------------------------------------------------   61900000
.***AM.L01  IOSCHPD FMT=LIST PARAMETERS                                 61950000
&ZOPN                 SETA &ZOPN+1                                      62000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   62050000
&ZOPO(&ZOPN)          SETC 'DS'                                         62100000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   62150000
&ZOPD(&ZOPN)          SETC '++ IOSCHPD PARM LIST'                       62200000
.*-------------------------------------------------------------------   62250000
.***AM.L02 XVERSION XL1                                                 62300000
&ZOPN                 SETA &ZOPN+1                                      62350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         62400000
&ZOPO(&ZOPN)          SETC 'DS'                                         62450000
&ZOPV(&ZOPN)          SETC 'XL1'                                        62500000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          62550000
.*-------------------------------------------------------------------   62600000
.***AM.L03 XFLAGS BL.8                                                  62650000
&ZOPN                 SETA &ZOPN+1                                      62700000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           62750000
&ZOPO(&ZOPN)          SETC 'DS'                                         62800000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       62850000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             62900000
.*                                                                      62950000
&ZOPN                 SETA  &ZOPN+1                                     63000000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CHPID'                   63050000
&ZOPO(&ZOPN)          SETC  'EQU'                                       63100000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             63150000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               63200000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CHPID'                        63250000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      63300000
.*                                                                      63350000
&ZOPN                 SETA  &ZOPN+1                                     63400000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CHP_TYPE'                63450000
&ZOPO(&ZOPN)          SETC  'EQU'                                       63500000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             63550000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               63600000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CHP_TYPE'                     63650000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      63700000
.*                                                                      63750000
&ZOPN                 SETA  &ZOPN+1                                     63800000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ACRONYM'                 63850000
&ZOPO(&ZOPN)          SETC  'EQU'                                       63900000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             63950000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               64000000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ACRONYM'                      64050000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      64100000
.*                                                                      64150000
&ZOPN                 SETA  &ZOPN+1                                     64200000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DESC'                    64250000
&ZOPO(&ZOPN)          SETC  'EQU'                                       64300000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             64350000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               64400000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DESC'                         64450000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      64500000
.*                                                                      64505500
&ZOPN                 SETA  &ZOPN+1                                     64511000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CHP_PARM'                64516500
&ZOPO(&ZOPN)          SETC  'EQU'                                       64522000
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             64527500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               64533000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CHP_PARM'                     64538500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      64544000
.*-------------------------------------------------------------------   64550000
.***AM.L09  XRESERVED1 CL4                                              64600000
&ZOPN                 SETA &ZOPN+1                                      64650000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       64700000
&ZOPO(&ZOPN)          SETC 'DS'                                         64750000
&ZOPV(&ZOPN)          SETC 'CL4'                                        64800000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 64850000
.*-------------------------------------------------------------------   64900000
.***AM.L09  XCHPID XL2                                                  64950000
&ZOPN                 SETA &ZOPN+1                                      65000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHPID'                           65050000
&ZOPO(&ZOPN)          SETC 'DS'                                         65100000
&ZOPV(&ZOPN)          SETC 'XL2'                                        65150000
&ZOPD(&ZOPN)          SETC '++ &ZXCHPID  XCHPID'                        65200000
.*-------------------------------------------------------------------   65250000
.***AM.L09  XCHP_TYPE XL1                                               65300000
&ZOPN                 SETA &ZOPN+1                                      65350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHP_TYPE'                        65400000
&ZOPO(&ZOPN)          SETC 'DS'                                         65450000
&ZOPV(&ZOPN)          SETC 'XL1'                                        65500000
&ZOPD(&ZOPN)          SETC '++ &ZXCHP_TYPE  XCHP_TYPE'                  65550000
.*-------------------------------------------------------------------   65600000
.***AM.L09  XACRONYM CL5                                                65650000
&ZOPN                 SETA &ZOPN+1                                      65700000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRONYM'                         65750000
&ZOPO(&ZOPN)          SETC 'DS'                                         65800000
&ZOPV(&ZOPN)          SETC 'CL5'                                        65850000
&ZOPD(&ZOPN)          SETC '++ &ZXACRONYM  XACRONYM'                    65900000
.*-------------------------------------------------------------------   65950000
.***AM.L09  XDESC CL32                                                  66000000
&ZOPN                 SETA &ZOPN+1                                      66050000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDESC'                            66100000
&ZOPO(&ZOPN)          SETC 'DS'                                         66150000
&ZOPV(&ZOPN)          SETC 'CL32'                                       66200000
&ZOPD(&ZOPN)          SETC '++ &ZXDESC  XDESC'                          66250000
.*-------------------------------------------------------------------   66300000
.***AM.L09  XCHP_PARM XL1                                               66311100
&ZOPN                 SETA &ZOPN+1                                      66322200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHP_PARM'                        66333300
&ZOPO(&ZOPN)          SETC 'DS'                                         66344400
&ZOPV(&ZOPN)          SETC 'XL1'                                        66355500
&ZOPD(&ZOPN)          SETC '++ &ZXCHP_PARM  XCHP_PARM'                  66366600
.*-------------------------------------------------------------------   66377700
.***AM.L09  XRESERVED2 CL13                                             66388800
&ZOPN                 SETA &ZOPN+1                                      66400000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       66450000
&ZOPO(&ZOPN)          SETC 'DS'                                         66500000
&ZOPV(&ZOPN)          SETC 'CL13'                                       66550000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED2'                 66600000
.*-------------------------------------------------------------------   66650000
.***AM.L10 END OF IOSCHPD LIST PARAMETERS                               66700000
&ZOPN                 SETA &ZOPN+1                                      66750000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 66800000
&ZOPO(&ZOPN)          SETC 'EQU'                                        66850000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 66900000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         66950000
.*                                                                      67000000
&ZOPN                 SETA &ZOPN+1                                      67050000
&ZOPL(&ZOPN)          SETC ' '                                          67100000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      67150000
&ZOPV(&ZOPN)          SETC '1'                                          67200000
&ZOPD(&ZOPN)          SETC ' '                                          67250000
.*-------------------------------------------------------------------   67300000
.***AL.L12 IOSCHPD FMT=LIST MF=S|L PARAMETERS                           67350000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         67400000
.*                                                                      67450000
&ZOPN                 SETA  &ZOPN+1                                     67500000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                67550000
&ZOPO(&ZOPN)          SETC  'DC'                                        67600000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   67650000
&ZOPD(&ZOPN)          SETC  '++ IOSCHPD ARG PARMS'                      67700000
.*                                                                      67750000
.ZLMFSLX              ANOP  ,                                           67800000
.*-------------------------------------------------------------------   67850000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          67900000
&ZPLLEN               SETA 60                                           67950000
.*                                                                      68000000
.******************************************************************     68050000
.***AI.L01 IOSCHPD FMT=LIST FILL IN PARAMETER AREA                      68100000
.******************************************************************     68150000
                      ACTR  10000                                       68200000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               68250000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    68300000
&ZCVAL                SETC  'LAE'          XAX MODE                     68350000
.ZIMFXA               ANOP ,                                            68400000
.*                                                                      68450000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    68500000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         68550000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 68600000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                68650000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 68700000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                68750000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   68800000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    68850000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   68900000
&ZOPN                 SETA  &ZOPN+1                                     68950000
&ZOPL(&ZOPN)          SETC  ' '                                         69000000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    69050000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              69100000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       69150000
                      AGO   .ZIMFNX                                     69200000
.*                                                                      69250000
.ZIMFN2               ANOP ,                                            69300000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     69304500
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     69309000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  69313500
&ZOPN                 SETA  &ZOPN+1                                     69318000
&ZOPL(&ZOPN)          SETC  ' '                                         69322500
&ZOPO(&ZOPN)          SETC  'LAE'                                       69327000
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  69331500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       69336000
                      AGO   .ZIMFNX                                     69340500
.ZIMFNX1              ANOP ,                                            69345000
&ZOPN                 SETA  &ZOPN+1                                     69350000
&ZOPL(&ZOPN)          SETC  ' '                                         69400000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    69450000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                69500000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       69550000
.ZIMFNX               ANOP ,                                            69600000
.********************************************************************   69650000
.***AI.L02 IOSCHPD FMT=LIST INITIALIZE PARAMETER AREA                   69700000
.********************************************************************   69750000
.***AI.L03 MF=(SLE)                                                     69800000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      69850000
.*                                                                      69900000
&ZOPN                 SETA  &ZOPN+1                                     69950000
&ZOPL(&ZOPN)          SETC  ' '                                         70000000
&ZOPO(&ZOPN)          SETC  'XC'                                        70050000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         70100000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             70150000
.ZIMFLX               ANOP  ,                                           70200000
.*-------------------------------------------------------------------   70250000
.***AI.L04A XVERSION XL1                                                70300000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    70350000
&ZOPN                 SETA  &ZOPN+1                                     70400000
&ZOPL(&ZOPN)          SETC  ' '                                         70450000
&ZOPO(&ZOPN)          SETC  'MVI'                                       70500000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           70550000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     70600000
.ZIMFVW               ANOP  ,                                           70650000
.*-------------------------------------------------------------------   70700000
.***AI.L05 XFLAGS BL1                                                   70750000
&ZW                   SETC  ''                                          70800000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            70850000
.*-------------------------------------------------------------------   70900000
.***AI.L08 XFLAGS "CHPID"                                               70950000
.***      BL1'1XXXXXXX'                                                 71000000
         AIF   ('&CHPID' EQ '').ZI3A                                    71050000
         AIF   ('&CHPID' EQ '').ZI3A                                    71075000
&ZW                   SETC  '&ZW.1'                                     71100000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              71150000
                      AGO   .ZI3C                                       71200000
.*                                                                      71250000
.ZI3A                 ANOP  ,                                           71300000
&ZW                   SETC  '&ZW.0'                                     71350000
.ZI3C                 ANOP  ,                                           71400000
.*-------------------------------------------------------------------   71450000
.***AI.L08 XFLAGS "CHP_TYPE"                                            71500000
.***      BL1'X1XXXXXX'                                                 71550000
         AIF   ('&CHP_TYPE' EQ '').ZI4A                                 71600000
         AIF   ('&CHP_TYPE' EQ '').ZI4A                                 71625000
&ZW                   SETC  '&ZW.1'                                     71650000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              71700000
                      AGO   .ZI4C                                       71750000
.*                                                                      71800000
.ZI4A                 ANOP  ,                                           71850000
&ZW                   SETC  '&ZW.0'                                     71900000
.ZI4C                 ANOP  ,                                           71950000
.*-------------------------------------------------------------------   72000000
.***AI.L08 XFLAGS "ACRONYM"                                             72050000
.***      BL1'XX1XXXXX'                                                 72100000
         AIF   ('&ACRONYM' EQ '').ZI5A                                  72150000
         AIF   ('&ACRONYM' EQ '').ZI5A                                  72175000
&ZW                   SETC  '&ZW.1'                                     72200000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              72250000
                      AGO   .ZI5C                                       72300000
.*                                                                      72350000
.ZI5A                 ANOP  ,                                           72400000
&ZW                   SETC  '&ZW.0'                                     72450000
.ZI5C                 ANOP  ,                                           72500000
.*-------------------------------------------------------------------   72550000
.***AI.L08 XFLAGS "DESC"                                                72600000
.***      BL1'XXX1XXXX'                                                 72650000
         AIF   ('&DESC' EQ '').ZI6A                                     72700000
         AIF   ('&DESC' EQ '').ZI6A                                     72725000
&ZW                   SETC  '&ZW.1'                                     72762500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              72800000
                      AGO   .ZI6C                                       72850000
.*                                                                      72900000
.ZI6A                 ANOP  ,                                           72950000
&ZW                   SETC  '&ZW.0'                                     73000000
.ZI6C                 ANOP  ,                                           73050000
.*-------------------------------------------------------------------   73100000
.***AI.L08 XFLAGS "CHP_PARM"                                            73103800
.***      BL1'XXXX1XXX'                                                 73107600
         AIF   ('&CHP_PARM' EQ '').ZI7A                                 73111400
         AIF   ('&CHP_PARM' EQ '0').ZI7A                                73115200
&ZW                   SETC  '&ZW.1000'                                  73119000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              73122800
                      AGO   .ZI7C                                       73126600
.*                                                                      73130400
.ZI7A                 ANOP  ,                                           73134200
&ZW                   SETC  '&ZW.0000'                                  73138000
.ZI7C                 ANOP  ,                                           73141800
.*-------------------------------------------------------------------   73145600
.***AI.L11 XFLAGS BL1                                                   73150000
                      AIF   ('&ZCLNG' NE 'YES').ZI7E  ALL ZERO BITS     73200000
&ZOPN                 SETA  &ZOPN+1                                     73250000
&ZOPL(&ZOPN)          SETC  ' '                                         73300000
&ZOPO(&ZOPN)          SETC  'OI'                                        73350000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             73400000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              73450000
.ZI7E                 ANOP  ,                                           73500000
.*-------------------------------------------------------------------   73550000
.***AI.L25  XCHPID XL2                                                  73600000
                      AIF   ('&ZXCHPID' EQ '').ZI9E                     73650000
                      AIF   ('&ZXCHPID' EQ 'OUTPUT').ZI9E               73700000
&ZCGPR                SETC  '&XCHPID'                                   73750000
.*                                                                      73800000
                      AIF   ('&XCHPID'(1,1) NE '(').ZI9B                73850000
&ZCGPR   SETC  '0('.'&XCHPID'(2,K'&XCHPID-2).')'                        73900000
.ZI9B                 ANOP  ,                                           73950000
.*                                                                      74000000
&ZC                   SETC  '&XCHPID'(1,1)                              74050000
                      AIF   (T'&ZC NE 'N').ZI9D                         74100000
&ZC                   SETC  '&XCHPID'                                   74150000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                74200000
&ZCGPR                SETC  '=FL2''&XCHPID'''                           74250000
.*                                                                      74300000
.ZI9D                 ANOP  ,                                           74350000
.*                                                                      74400000
&ZOPN                 SETA  &ZOPN+1                                     74450000
&ZOPL(&ZOPN)          SETC  ' '                                         74500000
&ZOPO(&ZOPN)          SETC  'MVC'                                       74550000
&ZOPV(&ZOPN)          SETC  '6(2,1),&ZCGPR'                             74600000
&ZOPD(&ZOPN)          SETC  '++ &ZXCHPID XCHPID'                        74650000
.*                                                                      74700000
.ZI9E                 ANOP  ,                                           74750000
.*-------------------------------------------------------------------   74800000
.***AI.L25  XCHP_TYPE XL1                                               74850000
                      AIF   ('&ZXCHP_TYPE' EQ '').ZI10E                 74900000
                      AIF   ('&ZXCHP_TYPE' EQ 'OUTPUT').ZI10E           74950000
&ZCGPR                SETC  '&XCHP_TYPE'                                75000000
.*                                                                      75050000
                      AIF   ('&XCHP_TYPE'(1,1) NE '(').ZI10B            75100000
&ZCGPR   SETC  '0('.'&XCHP_TYPE'(2,K'&XCHP_TYPE-2).')'                  75150000
                      AGO   .ZI10D                                      75200000
.ZI10B                ANOP  ,                                           75250000
.*                                                                      75300000
&ZC                   SETC  '&XCHP_TYPE'(1,1)                           75350000
                      AIF   (T'&ZC NE 'N').ZI10D                        75400000
&ZC                   SETC  '&XCHP_TYPE'                                75450000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               75500000
&ZCGPR                SETC  '=AL1(&XCHP_TYPE)'                          75550000
.*                                                                      75600000
.ZI10D                ANOP  ,                                           75650000
.*                                                                      75700000
&ZOPN                 SETA  &ZOPN+1                                     75750000
&ZOPL(&ZOPN)          SETC  ' '                                         75800000
&ZOPO(&ZOPN)          SETC  'MVC'                                       75850000
&ZOPV(&ZOPN)          SETC  '8(1,1),&ZCGPR'                             75900000
&ZOPD(&ZOPN)          SETC  '++ &ZXCHP_TYPE XCHP_TYPE'                  75950000
.*                                                                      76000000
.ZI10E                ANOP  ,                                           76003300
.*-------------------------------------------------------------------   76006600
.***AI.L25  XCHP_PARM XL1                                               76009900
                      AIF   ('&ZXCHP_PARM' EQ '').ZI13E                 76013200
                      AIF   ('&ZXCHP_PARM' EQ 'OUTPUT').ZI13E           76016500
&ZCGPR                SETC  '&XCHP_PARM'                                76019800
         AIF   ('&XCHP_PARM' EQ '0').ZI13E                              76023100
         AIF   ('&XCHP_PARM' EQ '0').ZI13E                              76026400
.*                                                                      76029700
                      AIF   ('&XCHP_PARM'(1,1) NE '(').ZI13B            76033000
&ZCGPR   SETC  '0('.'&XCHP_PARM'(2,K'&XCHP_PARM-2).')'                  76036300
                      AGO   .ZI13D                                      76039600
.ZI13B                ANOP  ,                                           76042900
.*                                                                      76046200
&ZC                   SETC  '&XCHP_PARM'(1,1)                           76049500
                      AIF   (T'&ZC NE 'N').ZI13D                        76052800
&ZC                   SETC  '&XCHP_PARM'                                76056100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               76059400
&ZCGPR                SETC  '=AL1(&XCHP_PARM)'                          76062700
.*                                                                      76066000
.ZI13D                ANOP  ,                                           76069300
.*                                                                      76072600
&ZOPN                 SETA  &ZOPN+1                                     76075900
&ZOPL(&ZOPN)          SETC  ' '                                         76079200
&ZOPO(&ZOPN)          SETC  'MVC'                                       76082500
&ZOPV(&ZOPN)          SETC  '46(1,1),&ZCGPR'                            76085800
&ZOPD(&ZOPN)          SETC  '++ &ZXCHP_PARM XCHP_PARM'                  76089100
.*                                                                      76092400
.ZI13E                ANOP  ,                                           76095700
.*-------------------------------------------------------------------   76100000
&ZOPN1                SETA &ZOPN                                        76150000
.*******************************************************************    76200000
.***  PROCESS IOSCHPD OUTPUT PARAMETERS                                 76250000
.*******************************************************************    76300000
                      ACTR  10000                                       76350000
.*------------------------------------------------------------------    76400000
.***AO.L02 XACRONYM CL5                                                 76600000
         AIF   ('&ZXACRONYM' EQ 'OUTPUT').ZO11A  OUTPUT                 76650000
         AIF   ('&ZXACRONYM' NE 'INOUT').ZO11C  INOUT                   76700000
.ZO11A    AIF   ('&XACRONYM'(1,1) NE '(').ZO11B  ADDR IN GPR            76750000
&ZCGPR   SETC  '&XACRONYM'(2,K'&XACRONYM-2)                             76800000
&ZOPN                 SETA  &ZOPN+1                                     76850000
&ZOPL(&ZOPN)          SETC  ' '                                         76900000
&ZOPO(&ZOPN)          SETC  'MVC'                                       76950000
&ZOPV(&ZOPN)          SETC  '0(5,&ZCGPR),9(1)'                          77000000
&ZOPD(&ZOPN)          SETC  '++ XACRONYM CL5'                           77050000
                      AGO   .ZO11C                                      77100000
.*                                                                      77150000
.ZO11B                ANOP  ,                                           77200000
&ZAWRK   SETA  K'&XACRONYM                                              77250000
         AIF   ('&XACRONYM'(&ZAWRK,1) NE ')').ZO11G                     77300000
&ZN      SETA  2                                                        77350000
.ZO11H    ANOP                                                          77400000
         AIF   (&ZN GE &ZAWRK).ZO11G                                    77450000
         AIF   ('&XACRONYM'(&ZN,1) NE '(').ZO11I                        77500000
&ZC      SETC  '&XACRONYM'(1,&ZN).'5'.','                               77550000
&ZC      SETC  '&ZC'.'&XACRONYM'(&ZN+1,&ZAWRK-&ZN).',9(1)'              77600000
         AGO   .ZO11J                                                   77650000
.ZO11I    ANOP                                                          77700000
&ZN      SETA  &ZN+1                                                    77750000
         AGO   .ZO11H                                                   77800000
.ZO11G    ANOP                                                          77850000
&ZC      SETC  '&XACRONYM.(5),9(1)'                                     77900000
.ZO11J    ANOP                                                          77950000
&ZOPN                 SETA  &ZOPN+1                                     78000000
&ZOPL(&ZOPN)          SETC  ' '                                         78050000
&ZOPO(&ZOPN)          SETC  'MVC'                                       78100000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       78150000
&ZOPD(&ZOPN)          SETC  '++ XACRONYM CL5'                           78200000
.ZO11C                ANOP  ,                                           78250000
.*------------------------------------------------------------------    78300000
.***AO.L02 XDESC CL32                                                   78650000
         AIF   ('&ZXDESC' EQ 'OUTPUT').ZO12A  OUTPUT                    78700000
         AIF   ('&ZXDESC' NE 'INOUT').ZO12C  INOUT                      78750000
.ZO12A    AIF   ('&XDESC'(1,1) NE '(').ZO12B  ADDR IN GPR               78800000
&ZCGPR   SETC  '&XDESC'(2,K'&XDESC-2)                                   78850000
&ZOPN                 SETA  &ZOPN+1                                     78900000
&ZOPL(&ZOPN)          SETC  ' '                                         78950000
&ZOPO(&ZOPN)          SETC  'MVC'                                       79000000
&ZOPV(&ZOPN)          SETC  '0(32,&ZCGPR),14(1)'                        79050000
&ZOPD(&ZOPN)          SETC  '++ XDESC CL32'                             79100000
                      AGO   .ZO12C                                      79150000
.*                                                                      79200000
.ZO12B                ANOP  ,                                           79250000
&ZAWRK   SETA  K'&XDESC                                                 79300000
         AIF   ('&XDESC'(&ZAWRK,1) NE ')').ZO12G                        79350000
&ZN      SETA  2                                                        79400000
.ZO12H    ANOP                                                          79450000
         AIF   (&ZN GE &ZAWRK).ZO12G                                    79500000
         AIF   ('&XDESC'(&ZN,1) NE '(').ZO12I                           79550000
&ZC      SETC  '&XDESC'(1,&ZN).'32'.','                                 79600000
&ZC      SETC  '&ZC'.'&XDESC'(&ZN+1,&ZAWRK-&ZN).',14(1)'                79650000
         AGO   .ZO12J                                                   79700000
.ZO12I    ANOP                                                          79750000
&ZN      SETA  &ZN+1                                                    79800000
         AGO   .ZO12H                                                   79850000
.ZO12G    ANOP                                                          79900000
&ZC      SETC  '&XDESC.(32),14(1)'                                      79950000
.ZO12J    ANOP                                                          80000000
&ZOPN                 SETA  &ZOPN+1                                     80050000
&ZOPL(&ZOPN)          SETC  ' '                                         80100000
&ZOPO(&ZOPN)          SETC  'MVC'                                       80150000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       80200000
&ZOPD(&ZOPN)          SETC  '++ XDESC CL32'                             80250000
.ZO12C                ANOP  ,                                           80300000
.*******************************************************************    80500000
.***AO.X02  RETURN CODE PROCESSING                                      80550000
.*******************************************************************    80600000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    80650000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            80700000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             80750000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             80800000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               80850000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                80900000
&ZOPN                 SETA  &ZOPN+1                                     80950000
&ZOPL(&ZOPN)          SETC  ' '                                         81000000
&ZOPO(&ZOPN)          SETC  'ST'                                        81050000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              81100000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        81150000
                      AGO   .ZMRETX                                     81200000
.*                                                                      81250000
.ZMRET2               ANOP  ,                                           81300000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                81350000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                81400000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                81450000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  81500000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   81550000
&ZOPN                 SETA  &ZOPN+1                                     81600000
&ZOPL(&ZOPN)          SETC  ' '                                         81650000
&ZOPO(&ZOPN)          SETC  'LR'                                        81700000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 81750000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        81800000
.ZMRETX               ANOP  ,                                           81850000
.*******************************************************************    81900000
.***AO.X03  REASON CODE PROCESSING                                      81950000
.*******************************************************************    82000000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    82050000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            82100000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              82150000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             82200000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              82250000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             82300000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                82350000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 82400000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                82450000
&ZOPN                 SETA  &ZOPN+1                                     82500000
&ZOPL(&ZOPN)          SETC  ' '                                         82550000
&ZOPO(&ZOPN)          SETC  'ST'                                        82600000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               82650000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        82700000
                      AGO   .ZMRSNX                                     82750000
.*                                                                      82800000
.ZMRSN2               ANOP  ,                                           82850000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                82900000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 82950000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                83000000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 83050000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                83100000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   83150000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    83200000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   83250000
&ZOPN                 SETA  &ZOPN+1                                     83300000
&ZOPL(&ZOPN)          SETC  ' '                                         83350000
&ZOPO(&ZOPN)          SETC  'LR'                                        83400000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  83450000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        83500000
.ZMRSNX               ANOP  ,                                           83550000
.*******************************************************************    83600000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   83650000
.*******************************************************************    83700000
.ZMFLX                ANOP  ,              MF=L PROCESSING              83750000
.*******************************************************************    83800000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               83850000
.*******************************************************************    83900000
                      ACTR  10000                                       83950000
.*                                                                      84000000
                      LCLA  &ZLC           COLUMN POSITION              84050000
                      LCLA  &ZOPX          LIST TABLE INDEX             84100000
                      LCLC  &ZLL           LABEL                        84150000
                      LCLC  &ZLOP          OPERATION                    84200000
                      LCLC  &ZLV           VALUE                        84250000
                      LCLC  &ZLD           DESCRIPTION                  84300000
.*                                                                      84350000
&ZOPX                 SETA  1                                           84400000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            84450000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              84500000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              84550000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              84600000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              84650000
                      AIF   (K'&ZLD LE 0).ZL5                           84700000
&ZLC                  SETA  35             COMMENT COLUMN               84750000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    84800000
&ZLC                  SETA  33             COMMMENT COLUMN              84850000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   84900000
&ZLV                  SETC  '&ZLV'.' '                                  84950000
                      AGO   .ZL3                                        85000000
.*                                                                      85050000
.ZL4                  ANOP  ,                                           85100000
&ZLV                  SETC  '&ZLV'.' '                                  85150000
.ZL5                  ANOP  ,                                           85200000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               85250000
.*                                                                      85300000
&ZLL     &ZLOP &ZLV                                                     85350000
.*                                                                      85400000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               85450000
                      AGO   .ZL2           CONTINUE LOOPING             85500000
.*                                                                      85550000
.ZLX                  ANOP  ,                                           85600000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                85650000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  85700000
.*-----------BAL invocation code-------------                           85750000
.LNKFC3  LA    0,10               ++ SET IOSCHPD FUNCTION CODE          85800000
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        85850000
.*********************************************************************  85900000
.*                                                                   *  85950000
.*  Get addressability to CVT                                        *  86000000
.*                                                                   *  86050000
.*********************************************************************  86100000
         L     15,16(0,0)                                               86150000
.*********************************************************************  86200000
.*                                                                   *  86250000
.*  Get addressability to IOCOM                                      *  86300000
.*                                                                   *  86350000
.*********************************************************************  86400000
         L     15,124(15,0)                                             86450000
.*********************************************************************  86500000
.*                                                                   *  86550000
.*  Get addressability to IOVT                                       *  86600000
.*                                                                   *  86650000
.*********************************************************************  86700000
         L     15,208(15,0)                                             86750000
         L     15,12(15,0)        ++ SET ADDR OF UCB SERVICES           86800000
         BALR  14,15              ++ BRANCH TO UCB SERVICES             86850000
         AGO   .DONE1                                                   86900000
.LNKPC1  ANOP                                                           86950000
         L     14,16(0,0)         ++ GET CVT ADDRESS                    87000000
         L     14,772(14,0)       ++ GET SFT ADDRESS                    87050000
.*********************************************************************  87100000
.*                                                                   *  87150000
.*  Get LX/EX for UCB Services and then PC to UCB services           *  87200000
.*                                                                   *  87250000
.*  Note: LX/EX is calculated by multiplying the PC number (79)      *  87300000
.*        times the length of a PC/AUTH table entry (4) and          *  87350000
.*        then subtracting 4.                                        *  87400000
.*                                                                   *  87450000
.*********************************************************************  87500000
         L     14,312(14,0)       ++ GET LX/EX FOR UCB SERVICES         87550000
         PC    0(14)              ++ PC TO UCB SERVICES                 87600000
.DONE1   ANOP                                                           87650000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  87700000
.ZLINKX               ANOP  ,                                           87750000
.*******************************************************************    87800000
.***AP.X01  FORMAT GENERATED CODE                                       87850000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            87900000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              87950000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              88000000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              88050000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              88100000
                      AIF   (K'&ZLD LE 0).ZL51                          88150000
&ZLC                  SETA  35             COMMENT COLUMN               88200000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   88250000
&ZLC                  SETA  33             COMMENT COLUMN               88300000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  88350000
&ZLV                  SETC  '&ZLV'.' '                                  88400000
                      AGO   .ZL31                                       88450000
.*                                                                      88500000
.ZL41                 ANOP  ,                                           88550000
&ZLV                  SETC  '&ZLV'.' '                                  88600000
.ZL51                 ANOP  ,                                           88650000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               88700000
.*                                                                      88750000
&ZLL     &ZLOP &ZLV                                                     88800000
.*                                                                      88850000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               88900000
                      AGO   .ZL21          CONTINUE LOOPING             88950000
.*                                                                      89000000
.ZLX1                 ANOP  ,                                           89050000
.*******************************************************************    89100000
.***AP.X02  END OF IOSCHPD MACRO                                        89150000
&ZIOSCHPD             SETC  'YES'          SET IOSCHPD USED             89200000
         POP   PRINT                                                    89250000
*                                            IOSCHPD-1                  89300000
         SPACE 1                                                        89350000
.ZLX2                 ANOP  ,                                           89400000
         MEND                                                           89450000
**********************************************************************/ 89500000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  89550000
*%IOSCHPD: MACRO KEYS(CHPID,CHP_TYPE,CHP_PARM,ACRONYM,DESC,LINKAGE,     89600000
*                 RETCODE,RSNCODE,PLISTVER,MF);                         89650000
*  ANS('?'||MACLABEL||' '||'IOSCHPDP '||MACLIST||                       89700000
*         ' '||MACKEYS||';') COL(MACLMAR);                              89750000
*%END IOSCHPD;                                                          89800000
