*                                                                    *  00004600
*  $MAC(RACXTRT) COMP(SC1BN) PROD(RACF):                             *  00005100
*                                                                    *  00005600
*  DESCRIPTIVE NAME:                                                 *  00006100
*    INTERFACE TO RACF EXTRACT FUNCTION                          @M2C*  00006600
*                                                                    *  00007100
* *01* PROPRIETARY STATEMENT=                                         * 00035000
*  **PROPRIETARY_STATEMENT********************************************* 00062900
*                                                                     * 00090800
*                                                                     * 00118700
*   LICENSED MATERIALS - PROPERTY OF IBM                              * 00146600
*   THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                       * 00174500
*   5647-A01 (C) COPYRIGHT IBM CORP. 1976, 2000                       * 00202400
*                                                                     * 00230300
*   STATUS= HBB7703                                                   * 00258200
*                                                                     * 00286100
*  **END_OF_PROPRIETARY_STATEMENT************************************** 00314000
*                                                                    *  00342400
*01* EXTERNAL CLASSIFICATION:                                        *  00345400
*02* GUPI:                                                           *  00348400
*01* END OF EXTERNAL CLASSIFICATION  :                               *  00351400
*                                                                    *  00354600
*                                                                       00537500
*  FUNCTION:                                                            00550000
*    THE RACXTRT MACRO PROVIDES A STANDARD INTERFACE TO                 00562500
*    THE RACF EXTRACT ROUTINE                                           00575000
*    (MODULE NAME - IRRRXT00)                                      @M2C 00587500
*                                                                       00600000
*  INVOCATION:                                                          00650000
*    THE RACF EXTRACT ROUTINE IS INVOKED BY THE RACXTRT                 00700000
*    MACRO VIA SVC 132.                                            @M2C 00750000
*                                                                       00800000
*    REQUIREMENTS FOR USE - 1) USER MUST BE AUTHORIZED                  00850000
*                                                                       00950000
*  MODULE TYPE = MACRO                                                  01100000
*                                                                       01150000
*  CHANGE ACTIVITY:                                                     01176400
*    $L0=HRF1602,RACF/160,830620,CNTDSD:                                01202800
*    UZ90283                                                   @ZA90283 01229200
*    UZ90284                                                   @ZA90284 01255600
*    UZ90285                                                   @ZA90285 01282000
*    $L7=HRF1702,RACF/170,841205,CNTDSD:                           @L7A 01308400
*    OZ93034                                                   @ZA93034 01334800
*    OZ94352                                                   @ZA94352 01361200
*    OY08189                                                   @YA06719 01387600
*    $L8=HRF1802,RACF/180,860820,CNTDSD:                           @L8A 01414000
*    $P1=JRF1812,RACF/181,870902,CNTDSD: PFG0030                   @P1A 01440400
*    OY11600                                                   @YA11600 01466800
*    $M1= SP313   RACF/190 880615 PDPWB1: MVS/SP 3.1.3             @M1A 01493200
*    $P2= PGU0028 RACF/190 880803 PDPWB1: PGU0028,PGU0029,PGU0030 @P2A  01519600
*    OY13874 -$M1 INCORPORATES ONE LINE APAR CHANGE            @YA13874 01546000
*    $M2= VMSFS   RACF/190 881104 PDB_S1: SHARED FILE SYSTEM       @M2A 01572400
*    OY16140 THIS PROBLEM HAS BEEN FIXED IN 1.9 WITH M2 FLAG   @YA16140 01586200
*    $P3= PGP0489 RACF/190 890719 PDPWB1: PGP0489                  @P3A 01589600
*    $P4= PGP0409 RACF/190 890815 PDB_S1: PGP0409                  @P4A 01593000
*    $P5= PGP0611 RACF/190 890920 PDB_S1: PTM PGP0611              @P5A 01596500
*    $P6= PGP0615 RACF/190 890920 PDPWB1: PGP0615                  @P6A 01598200
*    $M3= RELID   RACF/192 900904 PDAHW1: SUPPORT FOR RACF 1.9.2   @M3A 01598800
*    $P7= PJA0029 RACF/192 910524 PDPSB1: PJA0029                  @P7A 01599400
*    $M4= OW04015 RACF/210 930427 PDKAF1: SUPPORT FOR RACF 2.1     @M4A 01599600
*    $M5= OW10709 RACF/220 940510 PDJMV1: SUPPORT FOR RACF 2.2     @M5A 01599800
*    $M6= RELID   RACF/230 960422 PDJMV1: SUPPORT FOR RACF 2.3     @M6A 01599900
*    $P8= PQC1932 RACF/230 960722 PDJMV1: PTM PQC1932 RACF 2.3     @P8C 01602000
*    $M7= RELID   RACF/240 960904 PDJMV1: SUPPORT FOR RACF 2.4     @M7A 01603000
*    $M8= BOSSTA  HBB6605  970627 PDMKL1: TRANSPORTABLE ACEES      @M8A 01603500
*    $01= OW24641 HBB6605  970831 PDAWC1: OW24641                  @01A 01603800
*    $M9= RELID   HRF2608  980624 PDRDS2: SUPPORT FOR HRF2608      @M9A 01603900
*    $MA= RELID  RACF/7703 990415 PDRDS2: SUPPORT FOR   HRF7703    @MAA 01604000
*                                                                       01604100
*  CHANGE DESCRIPTIONS:                                                 01606200
*   A - ADD SUPPORT FOR BRANCH ENTRY EXTRACT                       @M1A 01612400
*   A - FLAG BRANCH AND RELEASE AS INVALID WHEN RELEASE < 1.9      @P2A 01618600
*       INITIALIZE BITS BEFORE SETTING FLAG BYTE ON MF=L           @P2A 01624800
*       ISSUE CORRECT MNOTE FOR INVALID MATCHGN VALUE              @P2A 01631000
*   A - SHARED FILE SYSTEM-LONG NAMES, SUPPORT FOR KEYWORD ENTITYX @M2A 01637200
*   A - INDICATE ENTITYX SPECIFIED WHEN BRANCH NOT SPECIFIED       @P3A 01640300
*   A - SUPPORT THAT THE PARAMETER FIELDS IS SPECIFIED WITH        @P4A 01642700
*       SEGDATA IN THE STANDARD MACRO FORM.                        @P4A 01645100
*   C - '&RELEASE' TO '&RELEASE'(1,3) FOR LOGICAL COMPARISON       @P5A 01645900
*       WITH '1.9'                                                 @P5A 01646700
*   A - DO NOT RESET BRANCH BIT OF BRANCH NOT CODED                @P6A 01647100
*   A - ALLOW RACF RELEASE 1.9.2 TO BE SPECIFIED                   @M3A 01647200
*   C - STATUS TO CORRECTLY CORRESPOND TO MVS LEVEL                @P7A 01647300
*   A - ALLOW RACF RELEASE 2.1 TO BE SPECIFIED                     @M4A 01647400
*   A - ALLOW RACF RELEASE 2.2 TO BE SPECIFIED                     @M5A 01648200
*   A - ALLOW RACF RELEASE 2.3 TO BE SPECIFIED                     @M6A 01648600
*   C - CHANGE PROGRAM NUMBER IN COPYRIGHT STATEMENT               @P8C 01648800
*   A - ALLOW RACF RELEASE 2.4 TO BE SPECIFIED                     @M7A 01648900
*   A - ALLOW RACF RELEASE 2.6 TO BE SPECIFIED AND                 @M8A 01649100
*       ALLOW TYPE=ENVRXTR AND ENVROUT KEYWORD TO BE SPECIFIED     @M8A 01649300
*   A - Add DATEFMT keyword for YR2000 support                     @01A 01649700
*   A - ALLOW RACF RELEASE 2608 TO BE SPECIFIED                    @M9A 01659700
*   A - ALLOW RACF RELEASE 7703 TO BE SPECIFIED                    @MAA 01669700
*                                                                       01679700
********************************************************************    01689700
         MACRO                                                          01700000
&NAME    RACXTRT &ACEE=,                                               *01750000
               &ENCRYPT=,                                              *01800000
               &ENTITY=,                                               *01850000
               &ENTITYX=,                                          @M2A*01875000
               &ENVROUT=,                                          @M8A*01887500
               &FIELDS=,                                               *01900000
               &SUBPOOL=,                                              *01950000
               &TYPE=,                                                 *02000000
               &RELEASE=,                                              *02012500
               &CLASS=,                                            @L8A*02025000
               &SEGMENT=,                                          @L8A*02037500
               &SEGDATA=,                                          @L8A*02050000
               &VOLSER=,                                           @L8A*02062500
               &GENERIC=,                                          @L8A*02075000
               &DERIVE=,                                           @P1A*02087500
               &FLDACC=,                                           @L8A*02100000
               &BRANCH=,                                           @M1A*02112500
               &MATCHGN=,                                          @M1A*02125000
               &DATEFMT=,                                          @01A*02131200
               &MF=S                                                    02137500
.*  DEFINE LOCAL VARIABLES                                              02150000
         LCLA  &FN                 USED TO CONTAIN NUMERIC VALUE        02200000
.*                                 FOR FUNCTION                         02250000
         LCLA  &VERS               USED TO CONTAIN VERSION NUMBER  @L8A 02262500
.*                                 TESTS THAT LIST AND EXECUTE FORMS    02275000
.*                                 HAVE SAME RELEASE NUMBER.            02287500
         LCLA  &ENC                USED TO CONTAIN ADDRESS OF DATA      02300000
.*                                 TO BE ENCRYPTED                      02350000
         LCLA  &DFLTSP             USED TO SET DEFAULT SUBPOOL          02400000
.*                                 WHEN ENTERED AS A STRING             02450000
         LCLC  &SEG000             SEGMENT NAME (ADDRS OR CONST)   @L8A 02455500
         LCLC  &CLS000             SEGMENT NAME (ADDRS OR CONST)   @L8A 02461000
         LCLA  &GENFLG             GENERIC PROCESSING FLAG         @L8A 02466500
         LCLA  &DRVFLG             DFP PROCESSING FLAG             @L8A 02472000
         LCLA  &FLDACF             FLDACC PROCESSING FLAG          @L8A 02477500
         LCLA  &DAT0,&DAT1,&DAT2,&DAT3,&DAT4,&DAT5,&DAT6,&DAT7     @01A 02480200
         LCLA  &BIT0,&BIT1,&BIT2,&BIT3,&BIT4,&BIT5,&BIT6,&BIT7     @L8A 02483000
         LCLA  &BITA0,&BITA1,&BITA2,&BITA3                              02488500
         LCLA  &BITA4,&BITA5,&BITA6,&BITA7                              02494000
         LCLA  &DATA0,&DATA1,&DATA2,&DATA3                         @01A 02496000
         LCLA  &DATA4,&DATA5,&DATA6,&DATA7                         @01A 02498000
         LCLB  &RLVLCHK            USED TO CONTROL RELEASE-CHECK   @L7A 02500000
         LCLC  &METH               USED TO CONTAIN ENCRYPTION METHOD    02550000
         LCLC  &SP                 USED TO CONTAIN SUBPOOL VALUE        02600000
         LCLC  &NX                 USED TO CONTAIN SYSNDX FOR LABELS    02650000
         LCLB  &YCOPENT            0 => ENTITY IS SPECIFIED        @M2A 02660000
.*                                 1 => ENTITYX IS SPECIFIED       @M2A 02670000
         LCLC  &CMENTY             COMMON ENTITY VARIABLE          @M2A 02680000
.*                                                                 @M2A 02690000
.*  DEFINE GLOBAL VARIABLES                                             02700000
         GBLC  &ICHL               USED FOR ADDRESS OF EXTRACT PARM     02750000
         GBLA  &ICHCT              ICHCT - A COUNTER USED TO KEEP       02800000
.*                                 TRACK OF WHERE IN THE PARAMETER      02850000
.*                                 LIST THE PARAMETER IS TO BE          02900000
.*                                 PLACED. ICHCT IS INITIALIZED TO      02950000
.*                                 THE FIRST FULLWORD IN THE LIST       03000000
.*                                 TO BE FILLED IN BY ICHMM,            03050000
.*                                 AND INCREMENTED BY THE INNER         03100000
.*                                 MACRO (ICHMM).                       03150000
         GBLB  &ICHRAC             ICHRAC - A FLAG WHICH IS             03200000
.*                                 INITIALIZED IN THE RACROUTE MACRO    03250000
.*                                 TO COMMUNICATE TO RACXTRT THAT IT    03300000
.*                                 IS BEING INVOKED AS AN INNER MACRO   03350000
.*                                 TO THE RACROUTE MACRO.               03400000
         GBLB  &ICHLIST            ICHLIST - A FLAG WHICH IS SET TO     03450000
.*                                 INDICATE THE FORMAT OF THE MACRO.    03500000
.*                                 FOR LIST FORMAT, ICHLIST IS ON       03550000
.*                                 FOR EXECUTE FORMAT, ICHLIST IS       03600000
.*                                 OFF. FOR STANDARD FORMAT, THERE      03650000
.*                                 ARE TWO PASSES DONE BY THE MACRO     03700000
.*                                 A LIST PASS AND AN EXECUTE PASS.     03750000
.*                                 INITIALLY, FOR STANDARD, THE         03800000
.*                                 FLAG  IS ON - FOR THE LIST PASS.     03850000
.*                                 IT IS THEN TURNED OFF FOR THE        03900000
.*                                 EXECUTE PASS.                        03950000
         GBLB  &ICHNTFY            ICHNTFY - A GLOBAL INDICATOR         04000000
.*                                 WHICH IS USED TO COMMUNICATE WITH    04050000
.*                                 ICHMM - THE INNER MACRO. IF ICHNTFY  04100000
.*                                 IS ON, THE INNER MACRO WILL NOT      04150000
.*                                 ISSUE ITS OWN MNOTE IF IT FINDS AN   04200000
.*                                 ERROR-IT WILL MERELY TURN ON THE     04250000
.*                                 ICHINER FLAG AS NOTIFICATION TO THE  04300000
.*                                 OUTER MACRO, WHICH WILL TAKE THE     04350000
.*                                 APPROPRIATE ACTION.                  04400000
.*                                 IF ICHNTFY IS OFF, THE INNER MACRO   04450000
.*                                 WILL TAKE ACTION ON ITS OWN,         04500000
.*                                 IE. ISSUE AN MNOTE WITH A SEVERITY   04550000
.*                                 CODE OF ITS CHOOSING.                04600000
         GBLB  &ICHINER            ICHINER - A GLOBAL INDICATOR         04650000
.*                                 WHICH IS USED BY ICHMM - AN INNER    04700000
.*                                 MACRO - TO TELL THE OUTER MACRO IF   04750000
.*                                 AN ERROR HAS BEEN DETECTED IN A      04800000
.*                                 PARAMETER.  IF ICHINER IS ON, AN     04850000
.*                                 ERROR HAS BEEN DETECTED.             04900000
         GBLC  &ICHMF              ICHMF - AN INDICATOR OF THE          04950000
.*                                 FORMAT - L, E, S OR M           @M1C 05000000
         GBLC  &ICHRLVL            SYMBOL TO BRANCH TO             @L7A 05050000
.*                                 WHEN INCOMPATIBLE MACRO LEVEL.  @L7A 05100000
.* VALIDATE RELEASE PARAMETER                                      @L7A 05150000
         AIF   (&ICHRAC).RLVL01                                    @L7A 05200000
&ICHRLVL SETC  'ICH&SYSNDX.X'      CREATE LABEL FOR SVC BYPASS     @L7A 05250000
.RLVL01  ANOP                                                      @L7A 05300000
&VERS    SETA  0                   DEFAULT VERSION NUMBER          @L8A 05314200
&YCOPENT SETB  0                   ASSUME THAT THE ENTITY IS       @M2A 05328400
&CMENTY  SETC  '&ENTITY'           SPECIFIED.                      @M2A 05342600
.*                                                                 @M2A 05356800
.* VALIDATE THE RELEASE PARAMETER                                  @M2A 05371000
.*                                                                 @M2A 05385200
         AIF   (N'&RELEASE GT 2).ERLVL1  INVALID RELEASE PARAMETER @L7A 05400000
         AIF   ('&RELEASE(1)' EQ '').VLIDREL                       @M2A 05420500
         AIF   ('&RELEASE(1)' EQ '1.6').VLIDREL                    @M2A 05441000
         AIF   ('&RELEASE(1)' EQ '1.7').VLIDREL                    @M2A 05461500
         AIF   ('&RELEASE(1)' EQ '1.8').VLIDREL                    @M2A 05482000
         AIF   ('&RELEASE(1)' EQ '1.8.1').VLIDREL                  @M2A 05502500
         AIF   ('&RELEASE(1)' EQ '1.9').VLIDREL                    @M2A 05523000
         AIF   ('&RELEASE(1)' EQ '1.9.2').VLIDREL                  @M3A 05533200
         AIF   ('&RELEASE(1)' EQ '2.1').VLIDREL                    @M4A 05538300
         AIF   ('&RELEASE(1)' EQ '2.2').VLIDREL                    @M5A 05540900
         AIF   ('&RELEASE(1)' EQ '2.3').VLIDREL                    @M6A 05542200
         AIF   ('&RELEASE(1)' EQ '2.4').VLIDREL                    @M7A 05542800
         AIF   ('&RELEASE(1)' EQ '2.6').VLIDREL                    @M8A 05543100
         AIF   ('&RELEASE(1)' EQ '2608').VLIDREL                   @M9A 05543300
         AIF   ('&RELEASE(1)' EQ '7703').VLIDREL                   @MAA 05543400
         AGO   .ERLVL1                                             @M2A 05543500
.VLIDREL ANOP                                                      @M2A 05564000
.*                                                                 @M2A 05584500
.* IF SECOND OPERAND IS SPECIFIED TEST THAT IT IS "CHECK" AND THE  @M2A 05605000
.* THE MACRO FORMAT IS 'E'                                         @M2A 05625500
.*                                                                 @M2A 05646000
         AIF   (N'&RELEASE LE 1).NORLVLC     CHECK NOT SPECIFIED   @L7A 05666500
         AIF   ('&RELEASE(2)' NE 'CHECK').ERLVL1   INVALID VALUE   @L7A 05687000
         AIF   ('&MF(1)' NE 'E').ERLVL2     CHECK ONLY WITH MF=E   @L7A 05707500
&RLVLCHK SETB  1                          ACTIVATE RELEASE-CHECK   @L7A 05728000
.ERLVL2R ANOP                                                      @L7A 05750000
.NORLVLC ANOP                                                      @L7A 05800000
.*                                                                 @M2A 05800800
.* TEST INCOMPATABILITY OF NEW KEYWORDS.                           @M2A 05801600
.*                                                                 @M2A 05802400
         AIF   ('&RELEASE(1)' EQ '').RLCHK16                       @P5A 05802900
         AIF   ('&RELEASE(1)'(1,3) GT '1.9').RLCHK92               @01A 05803000
         AIF   ('&RELEASE(1)' GE '1.9.2').RLCHK92                  @01A 05803100
         AIF   ('&RELEASE(1)'(1,3) GE '1.9').RLCHK19               @P5C 05803400
         AIF   ('&RELEASE(1)' GE '1.8.1').RLCHK18                  @M2A 05804000
         AIF   ('&RELEASE(1)' GE '1.8').RLCHK18                    @M2A 05804800
.*                                                                 @M2A 05805600
.* KEYWORDS INTRODUCED IN RELEASE 1.8 ARE NOT SPECIFIED WITH       @M2A 05806400
.* PREVIOUS RELEASES.                                              @M2A 05807200
.*                                                                 @M2A 05808000
.RLCHK16 ANOP                                                      @P5A 05808400
         AIF   ('&SEGMENT&SEGDATA&ACEE&VOLSER&GENERIC&FLDACC&CLASS&DERIX05808800
               VE' NE  '').ERR14                RELEASE IS 1.6/1.7 @M2C 05809600
.ERTN14  ANOP                                                      @M2C 05810400
         AIF   ('&TYPE' NE 'EXTRACT' AND '&TYPE' NE '' AND             X05811200
               '&TYPE' NE 'ENCRYPT').ERR15                         @M2C 05812000
.ERTN15  ANOP                                                      @M2C 05812800
.*                                                                 @M2A 05813600
.* KEYWORDS INTRODUCED IN RELEASE 1.9 ARE NOT SPECIFIED WITH       @M2A 05814400
.* PREVIOUS RELEASES.                                              @M2A 05815200
.*                                                                 @M2A 05816000
.RLCHK18 ANOP                                                      @M2A 05816800
         AIF   ('&BRANCH&MATCHGN' NE '').ERR14X                    @M2C 05817600
.ERTN14X ANOP                                                      @M2A 05818400
         AIF   ('&ENTITYX' NE '').ERR26                            @M2A 05819200
.ERTN26  ANOP                                                      @M2A 05820000
.RLCHK19 ANOP                                                      @M2A 05820800
         AIF   ('&DATEFMT' NE '').ERR29                            @01A 05821000
.ERTN29  ANOP                                                      @01A 05821200
.RLCHK92 ANOP                                                      @01A 05821400
.*                                                                 @M2A 05821600
.* UPWARD COMPATBILITY OF THE CODE.                                @M2A 05822400
.*                                                                 @M2A 05823200
         AIF  ('&RELEASE' LE '1.7').RL17COD                        @M2A 05824000
         AIF  ('&RELEASE' EQ '1.8').RL18COD                        @M2A 05824800
         AIF  ('&RELEASE' EQ '1.8.1').RL18COD                      @M2A 05825600
         AIF   (NOT &ICHRAC).ERR23       NOT CALLED BY RACROUTE    @M2A 05826400
.ERTN23  ANOP                            ISSUE MNOTE.              @M2A 05827200
.************************************************************      @M1A 05828000
.* VALIDITY CHECK BRANCH KEYWORD                                   @M1A 05828800
.************************************************************      @M1A 05829600
         AIF   ('&BRANCH' EQ 'NO' OR '&BRANCH' EQ '').BRCH010      @M1A 05830400
         AIF   ('&BRANCH' NE 'YES').ERR24                          @M1A 05831200
         AIF   ('&TYPE' NE 'EXTRACT' AND                               X05832000
               '&TYPE' NE 'ENVRXTR' AND                                X05832500
               '&TYPE' NE 'ENCRYPT').ERR22                         @M8C 05833000
.ERTN22  ANOP                                                      @M1A 05833600
.BRCH010 ANOP                                                      @M1A 05834400
.*                                                                 @M2A 05835200
.* TEST 1. ENTITY AND ENTITYX ARE MUTUALLY EXCLUSIVE.              @M2A 05836000
.*      2. SET FLAG "YCOPENTY" WHEN ENTITYX IS SPECIFIED.          @M2A 05836800
.*                                                                 @M2A 05837600
         AIF   ('&ENTITY' NE '' AND '&ENTITYX' NE '' ).ERR25       @M2A 05838400
.ERTN25  ANOP                                                      @M2A 05839200
         AIF   ('&ENTITYX' EQ '').NOCOPY                           @M2A 05840000
&YCOPENT SETB  1                  SET FLAG AS ENTITYX IS SPECIFIED @M2A 05840800
&CMENTY  SETC  '&ENTITYX'                                          @M2A 05841600
.NOCOPY  ANOP                                                      @M2A 05842400
.RL18COD ANOP                                                      @M2A 05843200
&VERS    SETA  1                                                   @M2A 05844000
.RL17COD ANOP                                                      @M2A 05844800
         AIF   ('&TYPE' NE 'ENCRYPT' AND T'&ENCRYPT NE 'O').ERR16  @M1C 05845600
.ERLVL1R ANOP                                                      @L7A 05850000
.************************                                               05900000
.*   INITIALIZE VARIABLES                                               05950000
.************************                                               06000000
.INITVAR ANOP                                                      @L8A 06025000
&NX      SETC  '&SYSNDX'                                                06050000
&DFLTSP  SETA  229                 DEFAULT SUBPOOL                      06100000
&ICHNTFY SETB  0                   WANT ICHMM TO ISSUE ERROR MSGS       06150000
&ICHINER SETB  0                   INITIALIZE ICHINER TO 0              06200000
.***********************************                                    06250000
.*   SET UP INDICATORS FOR MF FORMAT                                    06300000
.***********************************                                    06350000
.*  VALIDATE MF PARAMETER                                               06400000
         AIF   ('&MF' NE 'L' AND '&MF' NE 'S' AND '&MF(1)' NE          *06450000
               'E' AND '&MF(1)' NE 'M').ERR01                      @M1C 06500000
&ICHMF   SETC  '&MF(1)'        SET MF TYPE                              06550000
         AIF   ('&MF(1)' NE 'M').MFLSE                             @M1A 06566600
         AIF   (NOT &ICHRAC).ERR01  MF=M ONLY ALLOWED VIA RACROUTE @M1A 06583200
&ICHMF   SETC  'E'             TREAT MF=M SAME AS MF=E             @M1A 06599800
.MFLSE   ANOP                           MF=L, S OR E               @M1A 06616400
         AIF   ('&ICHMF' EQ 'E').EXT0030                           @M1C 06633000
&ICHLIST SETB  1               MF LIST OR STANDARD                      06650000
         AIF   (T'&SEGMENT EQ 'O').SEG000                          @L8A 06652900
         AIF   ('&SEGMENT'(1,1) EQ '''').SEGL000                   @L8A 06655800
.SEG000  ANOP                                                      @L8A 06658700
&SEG000  SETC  '&SEGMENT'                                          @L8A 06661600
         AGO   .SEGL999                                            @L8A 06664500
.SEGL000 ANOP  ,                                                   @L8A 06667400
&SEG000  SETC  'ICH&NX.S'                                          @L8A 06670300
.SEGL999 ANOP  ,                                                   @L8A 06673200
         AIF   (T'&CLASS EQ 'O').CLS000                            @L8A 06676100
         AIF   ('&CLASS'(1,1) EQ '''').CLSL000                     @L8A 06679000
.CLS000  ANOP                                                      @L8A 06681900
&CLS000  SETC  '&CLASS'                                            @L8A 06684800
         AGO   .CLSL999                                            @L8A 06687700
.CLSL000 ANOP  ,                                                   @L8A 06690600
&CLS000  SETC  'ICH&NX.L'                                               06693500
.CLSL999 ANOP  ,                                                        06696400
         AGO   .CONT01                                                  06700000
.EXT0030 ANOP                                                           06750000
         AIF   ('&MF(2)' EQ '' OR N'&MF NE 2).ERR01                     06800000
         AIF   (T'&SEGMENT EQ 'O').SEG001                          @L8A 06805000
         AIF   ('&SEGMENT'(1,1) EQ '''').ERR17                     @L8A 06810000
&SEG000  SETC  '&SEGMENT'                                          @L8A 06815000
.ERTN17  ANOP  ,                                                   @L8A 06820000
.SEG001  AIF   (T'&CLASS EQ 'O').CLS001                            @L8A 06825000
         AIF   ('&CLASS'(1,1) EQ '''').ERR18                       @L8A 06830000
&CLS000  SETC  '&CLASS'                                            @L8A 06835000
.CLS001  ANOP  ,                                                   @L8A 06840000
.ERTN18  ANOP  ,                                                   @L8A 06845000
&ICHLIST SETB  0               MF EXECUTE                               06850000
.****************************************************                   06900000
.*  DETERMINE FUNCTION SUPPLIED                                         06950000
.****************************************************                   07000000
.CONT01  ANOP                                                           07050000
.TYPECK  ANOP                                                      @L8A 07078500
         AIF   ('&TYPE' EQ '').ERR07                               @L8A 07107000
         AIF   ('&TYPE' EQ 'ENCRYPT').EXT0300                      @L8A 07135500
         AIF   ('&TYPE' EQ 'ENVRXTR').EXT0400                      @M8A 07149700
         AIF   ('&TYPE' EQ 'REPLACE').REP0100                      @L8A 07164000
         AIF   ('&TYPE' EQ 'EXTRACTN').EXT0200                     @L8A 07192500
         AIF   ('&TYPE' NE 'EXTRACT').ERR05                        @L8A 07221000
.****************************************************                   07250000
.*   VALIDATE PARAMETERS ALLOWABLE WITH                                 07300000
.*   TYPE=EXTRACT  TYPE=EXTRACTN TYPE=REPLACE                      @L8A 07350000
.****************************************************                   07400000
.EXT0100 ANOP                                                      @L8A 07418100
&FN      SETA  1                         TYPE=EXTRACT              @L8A 07436200
         AIF   ('&ICHMF' NE 'S').EXCONT1                           @L8A 07454300
         AIF   ('&SEGDATA' NE '').ERR03                            @L8A 07472400
         AGO   .EXCONT1                                            @L8A 07490500
.EXT0200 ANOP                                                      @L8A 07508600
&FN      SETA  3                         TYPE=EXTRACTN             @L8A 07526700
         AIF   ('&ICHMF' NE 'S').EXCONT1                           @L8A 07544800
         AIF   ('&SEGDATA' NE '').ERR03                            @L8A 07562900
         AGO   .EXCONT1                                            @L8A 07581000
.REP0100 ANOP                                                      @L8A 07599100
&FN      SETA  4                         TYPE=REPLACE              @L8A 07617200
         AIF   ('&MF' NE 'S').EXCONT1                              @L8A 07635300
         AIF   ('&SEGMENT&SEGDATA' EQ '').ERR19                    @L8A 07653400
         AIF   ('&SEGDATA' NE '' AND '&FIELDS' EQ '').ERR27        @P4A 07659400
.ERTN27  ANOP                                                      @P4A 07665400
.EXCONT1 ANOP                                                      @L8A 07671500
         AIF   ('&ENCRYPT' NE '').ERR03                            @L8A 07689600
         AIF   ('&SUBPOOL' EQ '').CONT01A                          @L8A 07707700
         AIF   (T'&SUBPOOL NE 'N').ERR09  SUBPOOL NON-NUMERIC      @L8A 07725800
         AIF   (&SUBPOOL LT 0 OR &SUBPOOL GT 255).ERR09            @L8A 07743900
&SP      SETC  '&SUBPOOL'       COPY SUBPOOL VALUE TO LOCAL AREA   @L8A 07762000
         AGO   .CONTSP                                             @L8A 07780100
.CONT01A ANOP  ,                                                        07800000
         AIF   ('&ICHMF' EQ 'E').CONTSP                            @L8A 07807500
&SP      SETC  '&DFLTSP'      SET DEFAULT SUBPOOL IN LOCAL AREA    @L8A 07815000
.CONTSP  ANOP  ,                                                        07822500
         AIF   ('&GENERIC' EQ '' ).DFP                                  07830000
         AIF   ('&GENERIC' NE 'ASIS' AND                               X07837500
               '&GENERIC' NE 'YES').ERR11                          @L8A 07845000
.DFP     ANOP  ,                                                   @L8A 07852500
         AIF   ('&DERIVE' EQ '' ).FLDACC                           @P1A 07860000
         AIF   ('&DERIVE' NE 'YES' AND                                 X07867500
               '&DERIVE' NE 'NO').ERR12                            @P1A 07875000
.FLDACC  ANOP  ,                                                   @L8A 07882500
         AIF   ('&FLDACC' EQ '' ).MATCHG                           @M1C 07890000
         AIF   ('&FLDACC' NE 'YES' AND                                 X07897500
                '&FLDACC' NE 'NO').ERR13                           @L8A 07905000
.MATCHG  ANOP  ,                                                   @M1A 07912500
         AIF   ('&MATCHGN' EQ '' ).DATE4                           @01C 07920000
         AIF   ('&MATCHGN' NE 'YES' AND                                X07927500
                '&MATCHGN' NE 'NO').ERR135                         @P2C 07935000
.DATE4   ANOP  ,                                                   @01A 07936500
         AIF   ('&DATEFMT' EQ '' ).NOFLDA                          @01A 07938000
         AIF   ('&DATEFMT' NE 'YYDDDF' AND                             X07939500
                '&DATEFMT' NE 'YYYYDDDF').ERR30                    @01A 07941000
.NOFLDA  ANOP                                                      @L8A 07942500
         AGO   .CONT02                                                  07950000
.****************************************************                   08000000
.*   VALIDATE PARAMETERS ALLOWABLE WITH                                 08050000
.*   TYPE=ENCRYPT                                                       08100000
.****************************************************                   08150000
.EXT0300 ANOP                                                           08200000
&FN      SETA  2                                                        08250000
         AIF   ('&FIELDS&SUBPOOL&DATEFMT' NE '').ERR03             @01A 08300000
         AIF   ('&ENCRYPT' EQ '').ERR10                                 08350000
         AIF   ('&ENCRYPT(2)' NE '' AND '&ENCRYPT(2)' NE 'DES' AND     X08400000
               '&ENCRYPT(2)' NE 'HASH' AND '&ENCRYPT(2)' NE 'STDDES'   X08437500
               AND '&ENCRYPT(2)' NE 'INST').ERR06                  @M1C 08475000
.*                                 INVALID ENCRYPTION METHOD       @M1A 08512500
         AIF   (N'&ENCRYPT GT 2).ERR04  TOO MANY SUBPARAMETERS          08550000
         AIF   ('&ICHMF' NE 'S').CONT02                                 08600000
         AIF   ('&ENCRYPT(1)' EQ '' OR '&ENCRYPT(2)' EQ '').ERR08       08650000
         AGO   .CONT02                                             @M8A 08654500
.****************************************************              @M8A 08659000
.*   VALIDATE PARAMETERS ALLOWABLE WITH                            @M8A 08663500
.*   TYPE=ENVRXTR                                                  @M8A 08668000
.****************************************************              @M8A 08672500
.EXT0400 ANOP                                                      @M8A 08677000
&FN      SETA  5                                                   @M8A 08681500
.* CHECK THE RELEASE                                               @M8A 08686000
         AIF  ('&RELEASE' LT '2.6').ERR28                          @M8A 08690500
.ERTN28  ANOP                                                      @M8A 08695000
.**************************************************************         08700000
.*  BEGIN THE PARAMETER LIST AND ESTABLISH ADDRESSABILITY TO IT         08750000
.**************************************************************         08800000
.CONT02  ANOP                                                           08850000
.* SET BITS FOR FLAG BYTE IN COMMON PART OF PLIST (OFFSET 5)       @M1A 08852000
&BITA0   SETA  1                                                   @M1A 08854000
&BITA1   SETA  1                                                   @P3C 08856000
&BITA2   SETA  1                                                   @M1A 08858000
&BITA3   SETA  1                                                   @M1A 08860000
&BITA4   SETA  1                                                   @M1A 08862000
&BITA5   SETA  1                                                   @M1A 08864000
&BITA6   SETA  1                                                   @M1A 08866000
&BITA7   SETA  1                                                   @M1A 08868000
&BIT0    SETA  0                                                   @M1A 08870000
&BIT1    SETA  0                                                   @P3C 08872000
&BIT2    SETA  0                                                   @M1A 08874000
&BIT3    SETA  0                                                   @M1A 08876000
&BIT4    SETA  0                                                   @M1A 08878000
&BIT5    SETA  0                                                   @M1A 08880000
&BIT6    SETA  0                                                   @M1A 08882000
&BIT7    SETA  0                                                   @M1A 08884000
         AIF   ('&TYPE' EQ 'ENVRXTR').CONT023                      @M8A 08884500
         AIF   ('&BRANCH' EQ '').CONT026   DON'T SET BRANCH BIT    @P6A 08885000
         AIF   ('&BRANCH' EQ 'YES').CONT023                        @M1A 08886000
&BITA0   SETA  0                           TURN OFF BRANCH BIT     @M1A 08888000
         AGO   .CONT026                    CONTINUE                @M1A 08890000
.CONT023 ANOP                              BRANCH=YES SPECIFIED    @M1A 08892000
&BIT0    SETA  1                           TURN ON BRANCH BIT      @M1A 08894000
.CONT026 ANOP                                                      @M1A 08896000
         AIF   ('&ENTITYX' EQ '').CONT027  ENTITYX SPECIFIED?      @P3A 08896500
&BIT1    SETA  1                           YES, INDICATE ENTITYX   @P3A 08897000
         AGO   .CONT028                    CONTINUE                @P3A 08897500
.CONT027 ANOP                                                      @P3A 08898000
         AIF   ('&ENTITY' EQ '').CONT028   ENTITY SPECIFIED?       @P3A 08898500
&BITA1   SETA  0                           YES, INDICATE ENTITY    @P3A 08899000
.CONT028 ANOP                                                      @P3A 08899500
         AIF   ('&ICHMF' NE 'E').EXT0215                                08900000
.* MF=E                                                                 08950000
         AIF   (&ICHRAC).EXT0212                                        09000000
&NAME    IHBINNRA &MF(2)          POINT R1 AT PARAMETER LIST            09050000
         AGO   .EXT0214                                                 09100000
.EXT0212 ANOP                                                           09150000
&NAME    A     1,36(1)            POINT R1 AT PARAMETER LIST            09200000
.* IF REQUESTED, CHECK TYPE PARAMETER IN L- VS. E-FORM             @L7A 09250000
.EXT0214 ANOP                                                      @L7A 09300000
         AIF   (NOT &RLVLCHK).RLVLX20                              @L7A 09350000
         AIF   (&FN NE 2).EXT0216                                  @L8A 09375000
         CLI   3(1),2                                              @L8A 09400000
         BNE   *+12                                                @L8A 09425000
         CLI   4(1),&VERS          VERSION SAME FOR L AND E FORM ? @L8A 09450000
         BE    *+12                YES                             @L8A 09475000
         LA    15,100              SET INCOMPATIBLE MACROS R.C.    @L7A 09500000
         B     &ICHRLVL                                            @L7A 09550000
.EXT0216 AIF   (&FN EQ 2).RLVLX20                                  @L8A 09556200
         CLI   3(1),2                                              @L8A 09562400
         BE    *+12                                                @L8A 09568600
         CLI   4(1),&VERS          VERSION SAME FOR L AND E FORM ? @L8A 09574800
         BE    *+12                YES                             @L8A 09581000
         LA    15,100              SET INCOMPATIBLE MACROS R.C.    @L7A 09587200
         B     &ICHRLVL                                            @L7A 09593400
.RLVLX20 ANOP                                                      @L7A 09600000
         AGO   .CONT03                                                  09650000
.EXT0215 ANOP                                                           09700000
.* MF=L/S                                                               09750000
         AIF   ('&MF' EQ 'S').EXT0222                          @YA08189 09800000
&NAME    DS    0F                                              @YA08189 09850000
         AIF   ('&MF' EQ 'L').EXT0223                          @ZA94352 09950000
.* MF=S                                                                 10000000
.EXT0222 ANOP                                                  @YA08189 10025000
         CNOP  0,4                                                      10050000
&NAME    BAL   1,ICH&NX.D         POINT R1 AT PARAMETER LIST   @YA11600 10100000
.EXT0223 ANOP                                                  @ZA94352 10150000
         AIF   (NOT &ICHRAC).EXT0224  INVOKER NOT RACROUTE     @ZA94352 10200000
&ICHL    DS    0F                                              @YA08189 10250000
.EXT0224 ANOP                                                           10300000
.* MF=L/S                                                               10350000
ICH&NX.A DS    0F                                              @YA08189 10400000
         DC    AL2(ICH&NX.C-ICH&NX.A) LENGTH OF LIST IN BYTES           10450000
         DC    XL1'82'            FUNCTION CODE FOR ICHRSV00            10500000
         DC    AL1(&FN)           REQUEST TYPE                          10550000
         DC    AL1(&VERS)         VERSION NUMBER                   @L8A 10600000
         DC    B'&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7'         @M1A 10650000
         DC    AL2(ICH&NX.B-ICH&NX.A) OFFSET TO VARIABLE PART OF LIST   10700000
.CONT03  ANOP                                                           10750000
         AIF   ('&ICHMF' NE 'E').EXT0230                           @L8A 10753300
         MVI   3(1),&FN            REQUEST TYPE                         10756600
         AIF   ('&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7' EQ          X10766500
               '00000000').CONT13                                  @M1A 10769800
.*                                 TURN ON BITS IN FLAG BYTE       @M1A 10773100
         OI    5(1),B'&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7'    @M1A 10776400
.CONT13  ANOP  ,                                                   @M1A 10779700
         AIF   ('&BITA0&BITA1&BITA2&BITA3&BITA4&BITA5&BITA6&BITA7' EQ  X10783000
               '11111111').EXT0230                                 @M1A 10786300
.*                                 TURN OFF BITS IN FLAG BYTE      @M1A 10789600
         NI    5(1),B'&BITA0&BITA1&BITA2&BITA3&BITA4&BITA5&BITA6&BITA7' 10792900
.EXT0230 ANOP  ,                                                   @L8A 10796200
&ICHCT   SETA  2               INITIALIZE PARAMETER COUNTER             10800000
         ICHMM &CMENTY                                            @M2C  10850000
         AIF   (NOT &ICHLIST).EXT0231                                   10900000
ICH&NX.B EQU   *                  END OF FIXED PART                     10950000
.EXT0231 ANOP  ,                                                        11000000
         AIF   (&FN EQ 2).EXT0310   REQUEST IS ENCRYPT                  11050000
         AIF   (&FN EQ 5).EXT0350   REQUEST IS ENVRXTR             @M8A 11075000
.***************************                                            11100000
.* GENERATE LIST FOR                                                    11150000
.* TYPE=EXTRACT, TYPE=EXTRACTN OR TYPE=REPLACE                     @L8A 11200000
.***************************                                       @L8A 11250000
         ICHMM &CLS000         ADDRESS OF CLASS                         11300000
         ICHMM &SP             SUBPOOL NUMBER                           11350000
         ICHMM &FIELDS         ADDRESS OF VARIABLE FIELDS          @L8A 11351500
.EXTSL   ANOP                                                           11353000
         AIF   (&VERS LT 1 ).CONT04                                @L8A 11354500
         ICHMM &SEG000         ADDRESS OF SEGMENT                  @L8A 11356000
         ICHMM &SEGDATA        ADDRESS OF VARIABLE SEGDATA FIELDS  @L8A 11357500
         ICHMM &ACEE           ADDRESS OF ACEE                     @L8A 11359000
         ICHMM &VOLSER         ADDRESS OF VOLSER                   @L8A 11360500
.* INITIALIZE BITS SET VARIABLES                                        11362000
&BITA0   SETA  1                                                   @L8A 11363500
&BITA1   SETA  1                                                   @L8A 11365000
&BITA2   SETA  1                                                   @L8A 11366500
&BITA3   SETA  1                                                   @L8A 11368000
&BITA4   SETA  1                                                   @L8A 11369500
&BITA5   SETA  1                                                   @L8A 11371000
&BITA6   SETA  1                                                   @L8A 11372500
&BITA7   SETA  1                                                   @L8A 11374000
&BIT0    SETA  0                                                   @L8A 11375500
&BIT1    SETA  0                                                   @L8A 11377000
&BIT2    SETA  0                                                   @L8A 11378500
&BIT3    SETA  0                                                   @L8A 11380000
&BIT4    SETA  0                                                   @L8A 11381500
&BIT5    SETA  0                                                   @L8A 11383000
&BIT6    SETA  0                                                   @L8A 11384500
&BIT7    SETA  0                                                   @L8A 11386000
&DATA0   SETA  1                                                   @01A 11386100
&DATA1   SETA  1                                                   @01A 11386200
&DATA2   SETA  1                                                   @01A 11386300
&DATA3   SETA  1                                                   @01A 11386400
&DATA4   SETA  1                                                   @01A 11386500
&DATA5   SETA  1                                                   @01A 11386600
&DATA6   SETA  1                                                   @01A 11386700
&DATA7   SETA  1                                                   @01A 11386800
&DAT0    SETA  0                                                   @01A 11386900
&DAT1    SETA  0                                                   @01A 11387000
&DAT2    SETA  0                                                   @01A 11387100
&DAT3    SETA  0                                                   @01A 11387200
&DAT4    SETA  0                                                   @01A 11387300
&DAT5    SETA  0                                                   @01A 11387400
&DAT6    SETA  0                                                   @01A 11387500
&DAT7    SETA  0                                                   @01A 11387600
         AIF   ('&ICHMF' NE 'E').XTRFL10                           @P2M 11387700
         AIF   ('&DATEFMT' NE 'YYDDDF').XTRMCHG                    @01A 11387800
&DATA7   SETA  0                                                   @01A 11387900
.XTRMCHG ANOP  ,                                                   @01A 11388000
         AIF   ('&MATCHGN' NE 'NO').XTRGEN                         @M1A 11389000
&BITA4   SETA  0                                                   @M1A 11390500
.XTRGEN  ANOP                                                      @M1A 11392000
         AIF   ('&GENERIC' NE 'ASIS').XTRDFP                       @L8A 11393500
&BITA5   SETA  0                                                   @L8A 11395000
.XTRDFP  ANOP                                                      @L8A 11396500
         AIF   ('&DERIVE' NE 'NO').XTRFLDA                         @P1A 11398000
&BITA6   SETA  0                                                   @L8A 11399500
.XTRFLDA ANOP                                                      @L8A 11401000
         AIF   ('&FLDACC' NE 'NO').XTRFLGS                         @L8A 11402500
&BITA7   SETA  0                                                   @L8A 11404000
.XTRFLGS ANOP                                                      @L8A 11405500
         AIF   ('&BITA0&BITA1&BITA2&BITA3&BITA4&BITA5&BITA6&BITA7' EQ  X11407000
               '11111111').DATFLGS                                 @01C 11408500
         NI   43(1),B'&BITA0&BITA1&BITA2&BITA3&BITA4&BITA5&BITA6&BITA7' 11410000
.*  ADD BITA0 TO ABOVE BIT STRING                                  @M1C 11411500
.DATFLGS AIF   ('&DATA0&DATA1&DATA2&DATA3&DATA4&DATA5&DATA6&DATA7' EQ  X11411800
               '11111111').XTRFL10                                 @01A 11412100
         NI   42(1),B'&DATA0&DATA1&DATA2&DATA3&DATA4&DATA5&DATA6&DATA7' 11412400
.XTRFL10 ANOP                                                      @L8A 11413000
         AIF   ('&DATEFMT' NE 'YYYYDDDF').XORMCHG                  @01A 11413300
&DAT7    SETA  1                                                   @01A 11413600
.XORMCHG ANOP                                                      @01A 11413900
         AIF   ('&MATCHGN' NE 'YES').XTRT050                       @M1A 11414500
&BIT4    SETA  1                                                   @M1A 11416000
.XTRT050 ANOP                                                      @M1A 11417500
         AIF   ('&GENERIC' NE 'YES').XTRT100                       @L8A 11419000
&BIT5    SETA  1                                                   @L8A 11420500
.XTRT100 ANOP                                                      @L8A 11422000
         AIF   ('&DERIVE' NE 'YES').XTRT200                        @P1A 11423500
&BIT6    SETA  1                                                   @L8A 11425000
.XTRT200 ANOP                                                      @L8A 11426500
         AIF   ('&FLDACC' NE 'YES').XTRT300                        @L8A 11428000
&BIT7    SETA  1                                                   @L8A 11429500
.XTRT300 ANOP                                                      @L8A 11431000
         AIF   ('&ICHMF' NE 'E').CONTFLG                           @L8A 11432500
         AIF   ('&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7' EQ          X11434000
               '00000000').DATFLG                                  @01C 11435500
         OI    43(1),B'&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7'   @L8A 11437000
.DATFLG  AIF   ('&DAT0&DAT1&DAT2&DAT3&DAT4&DAT5&DAT6&DAT7' EQ          X11437300
               '00000000').CONTFLG                                 @01A 11437600
         OI    42(1),B'&DAT0&DAT1&DAT2&DAT3&DAT4&DAT5&DAT6&DAT7'   @01A 11437900
         AGO   .CONT04                                             @L8A 11438500
.CONTFLG ANOP  ,                                                   @L8A 11440000
         AIF   (NOT &ICHLIST).CONT04                               @L8A 11441500
.LISTFLG DC    AL2(0)          RESERVED                            @01C 11442500
         DC    B'&DAT0&DAT1&DAT2&DAT3&DAT4&DAT5&DAT6&DAT7'         @01A 11443500
         DC    B'&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7'         @L8A 11444500
         AGO   .CONT04                                                  11450000
.************************************                                   11500000
.* GENERATE LIST FOR                                                    11550000
.* TYPE=ENCRYPT                                                         11600000
.************************************                                   11650000
.EXT0310 ANOP                                                           11700000
         ICHMM &ENCRYPT(1)   ADDRESS OF DATA TO BE ENCRYPTED            11750000
         AIF   ('&ENCRYPT(2)' EQ '').EXT0340                            11800000
         AIF   ('&ENCRYPT(2)' NE 'DES').EXT0330                         11850000
&METH    SETC  '1'           DES ENCRYPTION METHOD                      11900000
         AGO   .EXT0340                                                 11950000
.EXT0330 ANOP  ,                                                        12000000
         AIF   ('&ENCRYPT(2)' NE 'HASH').EXT0334                        12050000
&METH    SETC  '2'           HASHING ENCRYPTION METHOD                  12100000
         AGO   .EXT0340                                                 12150000
.EXT0334 ANOP  ,                                                        12200000
         AIF   ('&ENCRYPT(2)' NE 'INST').EXT0336                   @M1A 12225000
&METH    SETC  '3'           INSTALLATION-DEFINED METHOD                12250000
         AGO   .EXT0340                                            @M1A 12262500
.EXT0336 ANOP  ,                                                   @M1A 12275000
&METH    SETC  '4'           STANDARD DES ENCRYPTION METHOD        @M1A 12287500
.EXT0340 ANOP  ,                                                        12300000
         ICHMM  &METH        ENCRYPTION METHOD                          12350000
         AGO   .CONT04                                             @M8A 12355500
.************************************                              @M8A 12361000
.* GENERATE LIST FOR                                               @M8A 12366500
.* TYPE=ENVRXTR                                                    @M8A 12372000
.************************************                              @M8A 12377500
.EXT0350 ANOP                                                      @M8A 12383000
         ICHMM &ENVROUT      ADDRESS OF ENVROUT                    @M8A 12388500
         ICHMM &ACEE         ADDRESS OF ACEE                       @M8A 12394000
.***************************************************************        12400000
.*  AT THIS POINT, THE LIST AND EXECUTE FORMS ARE COMPLETED.  IF        12450000
.*  THE LIST PASS OF THE STANDARD FORM HAS JUST BEEN COMPLETED,         12500000
.*  RETURN FOR AN EXECUTE PASS.                                         12550000
.***************************************************************        12600000
.CONT04  ANOP                                                           12650000
         AIF   (NOT &ICHLIST).CONT05  SKIP END-OF-LIST LABEL            12700000
ICH&NX.C DS    0H                 END OF PARAMETER LIST                 12709000
         AIF   (T'&SEGMENT EQ 'O').SEGM999                         @L8A 12718000
         AIF   ('&SEGMENT'(1,1) NE '''').SEGM999                   @L8A 12727000
&SEG000  DC    CL8&SEGMENT                                         @L8A 12736000
.SEGM999 ANOP  ,                                                        12745000
         AIF   (T'&CLASS EQ 'O').CLSM999                           @L8A 12754000
         AIF   ('&CLASS'(1,1) NE '''').CLSM999                     @L8A 12763000
&CLS000  DC    CL8&CLASS                                                12772000
.CLSM999 ANOP  ,                                                        12781000
ICH&NX.D DS    0H                                                       12790000
.CONT05  ANOP                                                           12800000
         AIF   ('&ICHMF' NE 'S' OR NOT &ICHLIST).CONT06                 12850000
&ICHLIST SETB  0                                                        12900000
         AGO   .CONT03           DO EXECUTE PATH OF STANDARD FORM       12950000
.*****************************************************                  13000000
.*  THE SVC INSTRUCTION IS GENERATED IF RACXTRT IS                      13050000
.*  NOT INVOKED FROM THE RACROUTE MACRO OR IF THIS                      13100000
.*  IS NOT A LIST PASS.                                                 13150000
.*****************************************************                  13200000
.CONT06  ANOP                                                           13250000
         AIF   (&ICHRAC OR &ICHLIST).EROUTE                             13300000
         SVC   132                INVOKE EXTRACT ROUTINE                13350000
         AIF   (NOT &RLVLCHK).RLVLX40                              @L7A 13400000
&ICHRLVL DS    0H                                                  @L7A 13450000
.RLVLX40 ANOP                                                      @L7A 13500000
         AGO   .EROUTE                                                  13550000
.*****************                                                      13600000
.*  ERROR MESSAGES                                                      13650000
.*****************                                                      13700000
.ERR01   ANOP                                                           13750000
         MNOTE 12,'*** INVALID VALUE FOR ''MF'' PARAMETER'              13800000
         AGO   .EROUTE                                                  13850000
.ERR03   ANOP                                                           13900000
         MNOTE 12,'*** EXTRANEOUS PARAMETERS SPECIFIED FOR ''TYPE=&TYPEX13950000
               '''                                                      14000000
         AGO   .EROUTE                                                  14050000
.ERR04   ANOP                                                           14100000
         MNOTE 12,'*** TOO MANY PARAMETERS SPECIFIED FOR ''ENCRYPT'' PAX14150000
               RAMETER'                                                 14200000
         AGO   .EROUTE                                                  14250000
.ERR05   ANOP                                                           14300000
         MNOTE 12,'*** INVALID VALUE FOR ''TYPE'' PARAMETER'            14350000
         AGO   .EROUTE                                                  14400000
.ERR06   ANOP                                                           14450000
         MNOTE 12,'*** INVALID METHOD SPECIFIED FOR ''ENCRYPT'' PARAMETX14500000
               ER'                                                      14550000
         AGO   .EROUTE                                                  14600000
.ERR07   ANOP                                                           14650000
         MNOTE 12,'*** REQUIRED PARAMETER ''TYPE'' NOT SPECIFIED'       14700000
         AGO   .EROUTE                                                  14750000
.ERR08   ANOP                                                           14800000
         MNOTE 12,'*** BOTH SUBPARAMETERS MUST BE SPECIFIED FOR ''ENCRYX14850000
               PT'' PARAMETER'                                          14900000
         AGO   .EROUTE                                                  14950000
.ERR09   ANOP                                                           15000000
         MNOTE 12,'*** INVALID VALUE FOR ''SUBPOOL'' PARAMETER'         15050000
         AGO   .EROUTE                                                  15100000
.ERR10   ANOP                                                           15150000
         MNOTE 12,'*** ''ENCRYPT'' PARAMETER REQUIRED WITH ''TYPE=ENCRYX15200000
               PT'''                                                    15250000
         AGO   .EROUTE                                                  15300000
.ERR11   ANOP                                                           15301000
         MNOTE 12,'*** INVALID VALUE FOR '' GENERIC '' PARAMETER ' @L8A 15302000
         AGO   .EROUTE                                                  15303000
.ERR12   ANOP                                                           15304000
         MNOTE 12,'*** INVALID VALUE FOR '' DERIVE '' PARAMETER '  @P1A 15305000
         AGO   .EROUTE                                                  15306000
.ERR13   ANOP                                                           15307000
         MNOTE 12,'*** INVALID VALUE FOR '' FLDACC '' PARAMETER '  @L8A 15308000
         AGO   .EROUTE                                                  15309000
.ERR135  ANOP                                                           15310000
         MNOTE 12,'*** INVALID VALUE FOR '' MATCHGN '' PARAMETER ' @P2A 15311000
         AGO   .EROUTE                                             @P2A 15312000
.ERR14   MNOTE 4,'*** ''RELEASE'' INCOMPATIBLE WITH SPECIFIED KEYWORD(SX15313000
               ) ***'                                              @L8A 15314000
         AGO   .ERTN14                                             @M2C 15315000
.ERR14X  ANOP                                                      @M2A 15316000
         MNOTE 4,'*** ''RELEASE'' INCOMPATIBLE WITH SPECIFIED KEYWORD(SX15317000
               ) ***'                                              @M2A 15318000
         AGO   .ERTN14X                                            @M2A 15319000
.ERR15   ANOP                                                           15320000
         MNOTE 4,'INVALID TYPE FOR SPECIFIED RELEASE   '           @L8A 15321000
         AGO   .ERTN15                                             @M2C 15322000
.ERR16   MNOTE 8,'*** ''ENCRYPT'' ONLY ALLOWED WITH TYPE=ENCRYPT'  @L8A 15323000
         AGO   .EROUTE                                             @L8A 15324000
.ERR17   MNOTE 8,'*** ''SEGMENT'' FORM NOT ALLOWED WITH MF=E '     @L8A 15325000
         AGO   .ERTN17                                             @L8A 15326000
.ERR18   MNOTE 8,'*** ''CLASS'' FORM NOT ALLOWED WITH MF=E       ' @L8A 15327000
         AGO   .ERTN18                                             @L8A 15328000
.ERR19   MNOTE 4,'*** TYPE=REPLACE WAS CODED AND SEGMENT/SEGDATA NOT SPX15329000
               ECIFIED '                                           @L8A 15330000
         AGO   .EXCONT1                                            @L8A 15331000
.ERR22   MNOTE 8,'*** BRANCH=YES ONLY ALLOWED WITH TYPE=EXTRACT OR ENCRX15332000
               YPT ****'                                           @M1A 15333000
         AGO   .ERTN22                                             @M1A 15334000
.ERR23   ANOP                                                      @M2C 15335000
         MNOTE  8,'*** RACXTRT CAN BE INVOKED ONLY THROUGH RACROUTE FORX15336000
                RELEASE 1.9 AND LATER ***'                         @M2A 15337000
         AGO   .ERTN23                                             @M1A 15338000
.ERR24   ANOP                                                      @M1A 15339000
         MNOTE  8,'*** INVALID VALUE FOR '' BRANCH '' PARAMETER '  @M1A 15340000
         AGO   .EROUTE                                             @M1A 15341000
.ERR25   ANOP                                                      @M2A 15342000
         MNOTE  8,'*** ENTITY AND ENTITYX ARE MUTUALLY EXCLUSIVE KEYWORX15343000
               DS ***'                                             @M2A 15344000
         AGO   .ERTN25                                             @M2A 15345000
.ERR26   ANOP                                                      @M2A 15346000
         MNOTE  8,'*** ''ENTITYX'' IS SUPPORTED BY RELEASE 1.9 AND LATEX15347000
               R ONLY, ENTITYX IS IGNORED ***'                     @M2A 15348000
         AGO   .ERTN26                                             @M2A 15349000
.ERR27   ANOP                                                      @P4A 15349200
         MNOTE  8,'*** PARAMETER ''FIELDS'' IS REQUIRED WITH ''SEGDATA'X15349400
               ' ***'                                              @P4A 15349600
         AGO   .ERTN27                                             @P4A 15349800
.ERR28   ANOP                                                      @M8A 15358100
         MNOTE 8,'*** TYPE=ENVRXTR NOT VALID FOR SPECIFIED RELEASE ***'X15366400
                                                                   @M8A 15374700
         AGO   .ERTN28                                             @M8A 15383000
.ERR29   ANOP                                                      @01A 15384000
         MNOTE  8,'*** ''DATEFMT'' IS SUPPORTED BY RELEASE 1.9.2 AND LAX15385000
               TER ***'                                            @01A 15386000
         AGO   .ERTN29                                             @01A 15387000
.ERR30   ANOP                                                           15388000
         MNOTE 12,'*** INVALID VALUE FOR '' DATEFMT '' PARAMETER ' @01A 15389000
         AGO   .EROUTE                                             @01A 15390000
.ERLVL1  MNOTE 8,'*** INCORRECT SPECIFICATION OF ''RELEASE'' ***'  @L7A 15391300
         AGO   .ERLVL1R                                            @L7A 15400000
.ERLVL2  MNOTE 4,'*** ''RELEASE-CHECK'' ONLY VALID WITH ''MF=E'' ***'  X15450000
                                                                   @L7A 15500000
         AGO   .ERLVL2R                                            @L7A 15550000
.EROUTE  ANOP                                                           15600000
.* RESET GLOBALS                                                        15650000
&ICHL    SETC  ''                                                       15700000
         MEND                                                           15750000
