*/********************************************************************/ 00005500
*/*                                                                  */ 00011000
*/* MACRO NAME=       WTOR                                   @G860PSS*/ 00016500
*/*                                                                  */ 00022000
*/* DESCRIPTIVE NAME= WRITE TO OPERATOR WITH REPLY (WTOR)    @G860PSS*/ 00038500
*/*                                                                  */ 00044000
*/*01* PROPRIETARY STATEMENT=                                        */ 00055000
*/***PROPRIETARY_STATEMENT********************************************/ 00066000
*/*                                                                  */ 00077000
*/*                                                                  */ 00078100
*/* LICENSED MATERIALS - PROPERTY OF IBM                             */ 00079200
*/* THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      */ 00080300
*/* 5655-068 (C) COPYRIGHT IBM CORP. 1981, 1993                      */ 00081400
*/* SEE COPYRIGHT INSTRUCTIONS                                       */ 00082500
*/*                                                                  */ 00083600
*/* STATUS= HBB5510                                                  */ 00084700
*/*                                                                  */ 00085800
*/***END_OF_PROPRIETARY_STATEMENT*************************************/ 00086900
*/*                                                                  */ 00088000
*/* METHOD OF ACCESS=                                                */ 00110000
*/*                   BAL  - SPECIFY WTOR                    @G860PSS*/ 00115500
*/*                                                                  */ 00121000
*/* INVOCATION=                                                  @L1A*/ 00127400
*/*              SPECIFY WTOR MESG,RYAD,LENGTH,ECB,              @L1A*/ 00133800
*/*                           DESC=,MSGTYP=,MCSFLAG=,QID=,MF=,   @L1A*/ 00140200
*/*                           CONSID=,JOBID=,KEY=,TOKEN=,        @L1A*/ 00142900
*/*                           SYSNAME=,JOBNAME=,ROUTCDE=,        @01C*/ 00144300
*/*                           CONSNAME=,RPLYISUR=,CART=,         @L4C*/ 00145700
*/*                           LINKAGE=,SYNCH=,                   @L5A*/ 00146400
*/*                           TEXT=(ADDRESS,RYAD,LENGTH,ECB)     @L4A*/ 00147100
*/*                                                                  */ 00148500
*/*                                    OR                        @L1A*/ 00156700
*/*                                                                  */ 00165000
*/*                      WTOR WQEBLK=                            @L1A*/ 00165100
*/*                                                                  */ 00165200
*/*             WHERE:                                           @L1A*/ 00165300
*/*               MESG     THE MESSAGE TEXT FOR A MESSAGE        @L1A*/ 00165400
*/*                        TO BE WRITTEN.                        @L1A*/ 00165500
*/*                                                                  */ 00165600
*/*               RYAD     THE MESSAGE'S REPLY ADDRESS           @L1A*/ 00165700
*/*                                                                  */ 00165800
*/*               LENGTH   THE MESSAGE'S REPLY LENGTH            @L1A*/ 00165900
*/*                                                                  */ 00166000
*/*               ECB      THE MESSAGE'S ECB ADDRESS             @L1A*/ 00166100
*/*                                                                  */ 00166200
*/*                                                                  */ 00166300
*/*               ROUTCDE= ROUTING CODES TO BE ASSIGNED TO THE   @L1A*/ 00166400
*/*                        MESSAGE.                              @L1A*/ 00166500
*/*                                                                  */ 00166600
*/*               DESC=    DESCRIPTOR CODES TO BE ASSIGNED TO    @L1A*/ 00166700
*/*                        THE MESSAGE.                          @L1A*/ 00166800
*/*                                                                  */ 00166900
*/*               MSGTYP=  SPECIFIES HOW THE MESSAGE IS TO BE    @L1A*/ 00167000
*/*                        ROUTED. VALID VALUES ARE:             @L1A*/ 00167100
*/*                          N, Y, SESS, JOBNAMES, STATUS        @L1A*/ 00167200
*/*                                                                  */ 00167300
*/*               MCSFLAG= SPECIFIES ATTRIBUTES OF THE           @L1A*/ 00167400
*/*                        MESSAGE. VALID VALUES ARE:            @L1A*/ 00167500
*/*                          REG0, RESP, REPLY, BRDCST,          @L1A*/ 00167600
*/*                          HRDCPY, QREG0, NOTIME, CMD, NOCPY   @L1A*/ 00167700
*/*                                                                  */ 00167900
*/*               QID=     REMOTE ENTRY SERVICES (RSS) QUEUE     @L1A*/ 00168000
*/*                        ID (OS/VS1 ONLY).                     @L1A*/ 00168100
*/*                                                                  */ 00168200
*/*               MF=      SPECIFIES THE TYPE OF EXPANSION       @L1A*/ 00168300
*/*                        REQUIRED. VALID VALUES ARE:           @L1A*/ 00168400
*/*                             I  -  THIS IS THE DEFAULT        @L1A*/ 00168500
*/*                             (L,<LISTNAME>)                   @L1A*/ 00168600
*/*                             (E,<LISTNAME>)                   @L1A*/ 00168700
*/*                             (E,<LISTNAME>,EXTENDED)          @L1A*/ 00168800
*/*                        THE 'EXTENDED' PARAMETER MUST BE      @L1A*/ 00168900
*/*                        USED IN AN EXECUTE FORM INVOCATION    @L1A*/ 00169000
*/*                        WHERE A WPX EXISTS AND EITHER THE     @L1A*/ 00169100
*/*                        REPLY ADDRESS, REPLY LENGTH, ECB      @L2C*/ 00169200
*/*                        ADDRESS OR REPLY CONSOLE NAME         @L2A*/ 00169300
*/*                        ADDRESS ARE TO BE INSERTED.           @L1A*/ 00169400
*/*                                                                  */ 00169500
*/*               CONSID=  SPECIFIES THE 4-BYTE ID OF THE        @L1A*/ 00169600
*/*                        CONSOLE TO RECEIVE A MESSAGE.         @L1A*/ 00169700
*/*                        IF A REGISTER IS USED, THE REGISTER   @L1A*/ 00169800
*/*                        CONTAINS THE 4-BYTE ID.               @L1A*/ 00169900
*/*                                                                  */ 00170000
*/*              CONSNAME= SPECIFIES THE 2-8 BYTE NAME OF THE    @L2A*/ 00170100
*/*                        CONSOLE TO RECEIVE A MESSAGE.         @L2A*/ 00170200
*/*                        IF A REGISTER IS USED, THE REGISTER   @L2A*/ 00170300
*/*                        CONTAINS THE ADDRESS OF THE 2-8 BYTE  @L2A*/ 00170400
*/*                        CONSOLE NAME                          @L2A*/ 00170500
*/*                                                                  */ 00170600
*/*            RPLYISUR=   THE ADDRESS OF A 12 BYTE AREA         @L2A*/ 00170700
*/*                        WHERE THE REPLYING CONSOLE WILL       @L2A*/ 00170800
*/*                        INSERT ITS 8 BYTE NAME AND 4 BYTE ID  @L2A*/ 00170900
*/*                                                                  */ 00171000
*/*               JOBID=   SPECIFIES THE 8-BYTE ID WITH WHICH    @L1A*/ 00171100
*/*                        THE JES IDENTIFIES THE ISSUER OF      @L1A*/ 00171200
*/*                        THIS WTOR. THE KEYWORD IS FOR USE BY  @L1A*/ 00171300
*/*                        JES2 AND JES3.  IF A REGISTER IS      @L1A*/ 00171400
*/*                        USED, THE REGISTER CONTAINS THE       @L1A*/ 00171500
*/*                        ADDRESS OF THE 8-BYTE ID.             @L1A*/ 00171600
*/*                                                                  */ 00171700
*/*               JOBNAME= SPECIFIES THE 8-BYTE NAME WITH WHICH  @L1A*/ 00171800
*/*                        THE JES IDENTIFIES THE ISSUER OF      @L1A*/ 00171900
*/*                        THIS WTOR. THE KEYWORD IS FOR USE BY  @L1A*/ 00172000
*/*                        JES2 AND JES3.  IF A REGISTER IS      @L1A*/ 00172100
*/*                        USED THE REGISTER CONTAINS THE        @L1A*/ 00172200
*/*                        ADDRESS OF THE 8-BYTE NAME.           @L1A*/ 00172300
*/*                                                                  */ 00172400
*/*               KEY=     SPECIFIES AN 8-BYTE KEY TO BE         @L1A*/ 00172500
*/*                        ASSOCIATED WITH THIS MESSAGE.  IF A   @L1A*/ 00172600
*/*                        REGISTER IS USED, THE REGISTER        @L1A*/ 00172700
*/*                        SPECIFIES THE ADDRESS OF THE 8-BYTE   @L1A*/ 00172800
*/*                        KEY.                                  @L1A*/ 00172900
*/*                                                                  */ 00173000
*/*               TOKEN=   SPECIFIES A 4-BYTE TOKEN TO BE        @L1A*/ 00173100
*/*                        ASSOCIATED WITH THIS MESSAGE.  THE    @L1A*/ 00173200
*/*                        FIELD IS USED TO IDENTIFY A GROUP     @L1A*/ 00173300
*/*                        OF MESSAGES THAT CAN BE DELETED BY    @L1A*/ 00173400
*/*                        TOKEN.  THE TOKEN SHOULD BE UNIQUE    @L1A*/ 00173500
*/*                        WITHIN AN ADDRESS SPACE. IF A         @L1A*/ 00173600
*/*                        REGISTER IS USED, THE REGISTER        @L1A*/ 00173700
*/*                        CONTAINS THE 4-BYTE VALUE.            @L1A*/ 00173800
*/*                                                                  */ 00173900
*/*               SYSNAME= SPECIFIES AN 8-BYTE SYSTEM NAME TO BE @L1A*/ 00174000
*/*                        ASSIGNED TO THIS MESSAGE.  IT IS THE  @L1A*/ 00174100
*/*                        SYSTEM NAME OF WHERE THIS WTOR        @L1A*/ 00174200
*/*                        ORIGINATED.  IF A REGISTER IS         @L1A*/ 00174300
*/*                        USED, THE REGISTER CONTAINS THE       @L1A*/ 00174400
*/*                        ADDRESS OF THE 8-BYTE NAME.           @L1A*/ 00174500
*/*                                                                  */ 00175300
*/*               WQEBLK=  SPECIFIES A WQE CONTROL BLOCK TO BE   @L1A*/ 00175400
*/*                        USED AS INPUT FOR THE WTOR. IF A      @L1A*/ 00175500
*/*                        REGISTER IS USED, THE REGISTER        @L1A*/ 00175600
*/*                        SPECIFIES THE ADDRESS OF THE WQE      @L1A*/ 00175700
*/*                        CONTROL BLOCK TO BE USED AS INPUT TO  @L1A*/ 00175800
*/*                        THE WTOR. THIS KEYWORD IS MUTUALLY    @L1A*/ 00175900
*/*                        EXCLUSIVE WITH ALL OTHER KEYWORDS.    @L1A*/ 00176000
*/*                        THIS KEYWORD IS ONLY VALID ON THE     @L1A*/ 00176100
*/*                        STANDARD FORM (MF=I) OF THE MACRO.    @L1A*/ 00176200
*/*                                                                  */ 00176300
*/*               CART=    SPECIFIES THE 4-BYTE ADDRESS OF THE   @L3A*/ 00176400
*/*                        8 BYTE COMMAND AND RESPONSE TOKEN.    @L3A*/ 00176500
*/*                        THE CART IS USED TO ASSOCIATE A WTO   @L3A*/ 00176600
*/*                        RESPONSE WITH THE ORIGINATING COMMAND.@L3A*/ 00176700
*/*                        IF A REGISTER IS USED, THE REGISTER   @L3A*/ 00176800
*/*                        CONTAINS THE 4-BYTE ADDRESS VALUE.    @L3A*/ 00176900
*/*                        IF AN 8-BYTE FIELD IS USED, THE       @L3A*/ 00177000
*/*                        ADDRESS OF THE FIELD IS STORED IN THE @L3A*/ 00177100
*/*                        WPL.                                  @L3A*/ 00177200
*/*                                                                  */ 00177300
*/*               TEXT=    SPECIFIES A DATA AREA                 @P8A*/ 00177400
*/*                        CONTAINING A 2 BYTE MESSAGE LENGTH    @L4A*/ 00177500
*/*                        FIELD FOLLOWED BY THE ACTUAL MESSAGE  @L4A*/ 00177600
*/*                        TEXT. IF A REGISTER IS USED, THE      @L4A*/ 00177700
*/*                        REGISTER CONTAINS THE ADDRESS OF THE  @L4A*/ 00177800
*/*                        DATA AREA. IF A FIELD IS USED, THE    @L4A*/ 00177900
*/*                        ADDRESS OF THE FIELD IS STORED        @L4A*/ 00178000
*/*                        IN THE WPL. THE TEXT KEYWORD IS       @L4A*/ 00178100
*/*                        MUTUALLY EXCLUSIVE WITH INLINE        @L4A*/ 00178200
*/*                        MESSAGE TEXT. THE TEXT KEYWORD MAY BE @L4A*/ 00178300
*/*                        SPECIFIED ON THE LIST FORM OF THE     @L4A*/ 00178400
*/*                        MACRO WITHOUT A KEYWORD VALUE TO      @L4A*/ 00178500
*/*                        SET UP THE PROPER FORM OF THE WTO     @L4A*/ 00178600
*/*                        PARAMETER LIST.                       @L4A*/ 00178700
*/*                        IF THE TEXT KEYWORD IS USED, THE      @L4A*/ 00178800
*/*                        ADDITIONAL POSITIONAL PARAMETERS,     @L4A*/ 00178900
*/*                        RYAD, LENGTH, ECB ADDRESS, MUST BE    @L4A*/ 00179000
*/*                        SPECIFIED AS THE SECOND, THIRD AND    @L4A*/ 00179100
*/*                        FOURTH POSITIONAL PARAMETERS ON THE   @L4A*/ 00179200
*/*                        TEXT KEYWORD.                         @L4A*/ 00179300
*/*                                                              @L4A*/ 00179400
*/*              LINKAGE=  SPECIFIES HOW CONTROL IS TO PASS TO   @L5A*/ 00179700
*/*                        THE WTOR FUNCTION.  LINKAGE IS NOT    @L5A*/ 00180000
*/*                        VALID IN THE LIST (MF=L) FORM OF THE  @L5A*/ 00180300
*/*                        MACRO.                                @L5A*/ 00180600
*/*                        THE VALID VALUES ARE-                 @L5A*/ 00180900
*/*                             BRANCH                           @L5A*/ 00181200
*/*                             SVC - THIS IS THE DEFAULT        @L5A*/ 00181500
*/*                                                                  */ 00181800
*/*                SYNCH=  SPECIFIES WHETHER THE WTOR REQUEST    @L5A*/ 00182100
*/*                        IS TO BE PROCESSED SYNCHRONOUSLY      @L5A*/ 00182400
*/*                        WITH RESPECT TO THE CALLER.           @L5A*/ 00182700
*/*                        THE VALID VALUES ARE-                 @L5A*/ 00183000
*/*                             YES                              @L5A*/ 00183300
*/*                             NO  - THIS IS THE DEFAULT        @L5A*/ 00183600
*/*                                                                  */ 00183900
*/* FUNCTION =                                                   @L1A*/ 00184200
*/*     BUILDS A WTOR PARAMETER LIST (WPL) AND/OR THE CODE       @L1A*/ 00184500
*/*     WHICH WILL INVOKE SVC 35 TO ISSUE THE MESSAGE            @L1A*/ 00184800
*/*                                                                  */ 00185100
*/* OPERATION =                                                  @L1A*/ 00185400
*/*     - IF LIST OR STANDARD FORM IS SPECIFIED, WTOR INVOKES    @L1A*/ 00185700
*/*          THE WTO MACRO TO DETERMINE WHICH KEYWORDS HAVE BEEN @L1A*/ 00186000
*/*          USED.  IF AN EXTENDED FORM OF THE WPL (WPX) IS TO   @L1A*/ 00186300
*/*          BE BUILT, WTO BUILDS IT USING THE INFORMATION       @L1A*/ 00186600
*/*          PASSED BY THIS MACRO.  WTO ALSO HANDLES PARAMETER   @L1A*/ 00186900
*/*          LIST GENERATION IF THIS IS AN INVOCATION WHERE THE  @L1A*/ 00187200
*/*          WQEBLK KEYWORD IS USED. IF AN OLD-FORMAT WPL        @L1A*/ 00187500
*/*          IS TO BE BUILT, HOWEVER, THEN THIS MACRO WILL       @L1A*/ 00187800
*/*          GENERATE THE PARAMETER LIST.                        @L1A*/ 00188100
*/*     - IF EXECUTE FORM IS SPECIFIED, INSERT RUN-TIME KEYWORD  @L1A*/ 00188400
*/*          VALUES INTO THE ALREADY-EXISTING PARAMETER LIST     @L1A*/ 00188700
*/*                                                                  */ 00189000
*/* USAGE =                                                      @L1C*/ 00189300
*/*     ANY PROGRAM MAY USE THIS MACRO TO                    @G860PSS*/ 00189600
*/*     BUILD THE WTOR PARAMETER LIST.  HOWEVER                  @L1C*/ 00189900
*/*     WQEBLK, JOBID, SYSNAME, AND JOBNAME                      @01C*/ 00190200
*/*     ARE FOR CONTROL PROGRAM USE ONLY.                        @L1C*/ 00190500
*/*                                                                  */ 00190800
*/* SUBPOOL AND KEY=                                             @L1A*/ 00191100
*/*     ANY AND ANY. THE PARAMETER LIST MAY RESIDE           @G860PSS*/ 00191400
*/*     ABOVE THE 16M LINE.                                  @G860PSS*/ 00191700
*/*                                                                  */ 00192000
*/* RESTRICTIONS =                                               @PAA*/ 00192100
*/*                                                              @PAA*/ 00192400
*/*   "LINKAGE" SPECIFIED AS OR DEFAULTED TO "SVC" REQUIRES      @PAA*/ 00192500
*/*     THE CALLER TO:                                           @PAA*/ 00192600
*/*     - BE IN TASK MODE                                        @PAA*/ 00192700
*/*     - HOLD NO LOCKS                                          @PAA*/ 00192800
*/*     - BE ENABLED FOR INTERRUPTS                              @PAA*/ 00192900
*/*     - BE IN PRIMARY ASC MODE                                 @PAA*/ 00193000
*/*     - BE IN NON-CROSS-MEMORY MODE                            @PAA*/ 00193100
*/*     - "AUTHORIZED" PARAMETERS REQUIRE SUPERVISOR STATE,      @PAA*/ 00193200
*/*        PROTECT KEY 0-7.                                      @PAA*/ 00193300
*/*                                                              @PAA*/ 00193400
*/*   "LINKAGE=BRANCH" WITH "SYNCH=YES" CAN BE USED              @PAA*/ 00193500
*/*     WHEN IN SRB MODE-                                        @PAA*/ 00193600
*/*       A WTOR ISSUED FROM SRB MODE WILL NOT HAVE A JOBNAME OR @PAA*/ 00193700
*/*       JOBID ASSOCIATED WITH IT.                              @PAA*/ 00193800
*/*       IT WILL NOT BE AUTOMATICALLY DOM'D WHEN THE TASK ENDS. @PAA*/ 00193900
*/*     WHEN DISABLED FOR INTERRUPTS-                            @PAA*/ 00194000
*/*       WTOR PARAMETER LIST AND ALL STORAGE ADDRESSED BY IT    @PAA*/ 00194100
*/*       MUST BE IN FIXED OR DREF STORAGE.                      @PAA*/ 00194200
*/*     WHEN LOCKS HELD                                          @PAA*/ 00194300
*/*     WHEN THE PRIMARY ADDRESS SPACE IS NOT THE SAME AS        @PAA*/ 00194400
*/*     THE HOME ADDRESS SPACE-                                  @PAA*/ 00194500
*/*       CALLER MUST BE IN PRIMARY ASC MODE.                    @PAA*/ 00194600
*/*                                                              @PAA*/ 00194700
*/*   IF "LINKAGE=BRANCH" IS SPECIFIED-                          @PAA*/ 00194800
*/*       WQEBLK KEYWORD CANNOT BE SPECIFIED, ABEND IF ATTEMPTED @PAA*/ 00194900
*/*       MESSAGE TEXT MAY NOT CONTAIN DBCS DATA.                @PAA*/ 00195000
*/*       CALLER MUST BE IN SUPERVISOR STATE, PROTECT KEY 0-7.   @PAA*/ 00195100
*/*       CALLER MUST BE IN PRIMARY ASC MODE.                    @PAA*/ 00195200
*/*                                                              @PAA*/ 00195300
*/*                                                                  */ 00195400
*/* DEPENDENCIES =                                               @L1A*/ 00195500
*/*     - LIST AND EXECUTE FORM MUST REFERENCE THE SAME VERSION  @L1A*/ 00195600
*/*          OF THE PARAMETER LIST (WPL)                         @L1A*/ 00195700
*/*                                                                  */ 00195800
*/* MODULE TYPE = MACRO                                          @L1A*/ 00195900
*/*                                                                  */ 00196000
*/* ENTRY POINT = N/A                                            @L1A*/ 00196100
*/*                                                                  */ 00196200
*/* INPUT = SEE INVOCATION                                       @L1A*/ 00196300
*/*                                                                  */ 00196400
*/* OUTPUT =                                                     @L1A*/ 00196500
*/*     PARAMETER LIST TO ISSUE SVC 35 AND/OR THE                @L1A*/ 00196600
*/*     INSTRUCTIONS REQUIRED TO MODIFY THE PARAMETER            @L1A*/ 00196700
*/*     LIST AND ISSUE SVC 35.                                   @L1A*/ 00196800
*/*                                                                  */ 00196900
*/* EXIT, NORMAL                                                 @L1A*/ 00197000
*/*  CONDITION - NO ERRORS DETECTED BY THE WTOR (OR WTO) MACRO   @L1A*/ 00197100
*/*  OUTPUT    - NO MNOTE ISSUED. SEVERITY CODE = 0              @L1A*/ 00197400
*/*                                                                  */ 00197700
*/* EXIT, NORMAL                                                 @L1A*/ 00198000
*/*  CONDITION - INFORMATIONAL MNOTE CONDITION DETECTED BY THE   @L1A*/ 00198300
*/*                WTOR (OR WTO) MACRO                           @L1A*/ 00198600
*/*  OUTPUT    - MNOTE WITH SEVERITY CODE 0 ISSUED WHEN DATA     @L1A*/ 00198900
*/*                IS SPECIFIED FOR A RUN-TIME KEYWORD ON A      @L1A*/ 00199200
*/*                LIST FORM INVOCATION. THE DATA IS IGNORED.    @L1A*/ 00199500
*/*               .A LINE OF INLINE TEXT IS LONGER THAN THE      @PEM*/ 00199600
*/*                  DOCUMENTED ALLOWED MAXIMUM LENGTH.          @PEM*/ 00199700
*/*                                                                  */ 00199800
*/* EXIT, NORMAL                                                 @L1A*/ 00200100
*/*  CONDITION - WARNING CONDITION DETECTED BY THE WTOR          @L1A*/ 00200400
*/*              (OR WTO) MACRO                                  @L1A*/ 00200700
*/*  OUTPUT    - MNOTE WITH SEVERITY CODE 4 ISSUED WHEN:         @L1A*/ 00201000
*/*               .A RUN-TIME KEYWORD IS SPECIFIED WITHOUT DATA  @L1A*/ 00201300
*/*                  DURING A STANDARD/EXECUTE FORM INVOCATION.  @L1A*/ 00201600
*/*                  THE KEYWORD IS IGNORED.                     @L1A*/ 00201900
*/*               .AN INVALID ROUTING CODE IS SPECIFIED          @L1A*/ 00202200
*/*               .AN INVALID RANGE OF ROUTING CODES IS          @L1A*/ 00202500
*/*                  SPECIFIED                                   @L1A*/ 00202800
*/*               .RESERVED ROUTING CODES (29-40) ARE        @YA10057*/ 00203100
*/*                  SPECIFIED                               @YA10057*/ 00203400
*/*               .AN INVALID DESCRIPTOR CODE IS SPECIFIED       @L1A*/ 00203700
*/*               .INVALID OR MUTUALLY EXCLUSIVE MCSFLAG         @L1A*/ 00204000
*/*                  VALUES ARE SPECIFIED                        @L1A*/ 00204300
*/*               .AN INVALID MSGTYPE VALUE IS SPECIFIED         @L1A*/ 00204600
*/*               .AN INVALID QID VALUE IS SPECIFIED             @L1A*/ 00204900
*/*                                                                  */ 00205200
*/* EXIT, ERROR                                                  @L1A*/ 00205500
*/*  CONDITION - TERMINATING ERROR CONDITION DETECTED BY         @L1A*/ 00205800
*/*                THE WTOR (OR WTO) MACRO                       @L1A*/ 00206100
*/*  OUTPUT    - MNOTE WITH SEVERITY CODE 12 ISSUED WHEN:        @L1A*/ 00206400
*/*               .THE WQEBLK KEYWORD IS SPECIFIED ALONG WITH    @L1A*/ 00206700
*/*                  OTHER KEYWORDS                              @L1A*/ 00207000
*/*               .THE CONSID KEYWORD IS SPECIFIED WITH THE      @L2A*/ 00207300
*/*                   CONSNAME KEYWORD                           @L2A*/ 00207600
*/*               .THE NUMBER OF TEXT LINES REQUESTED IS NOT 1   @L1A*/ 00207900
*/*               .THE TEXT KEYWORD IS SPECIFIED ALONG WITH      @L4A*/ 00208200
*/*                   INLINE MESSAGE TEXT                        @L4A*/ 00208500
*/*               .MORE THAN 14 LINES OF TEXT                    @L5A*/ 00208800
*/*               ."SYNCH=YES" IS SPECIFIED WITHOUT              @L5A*/ 00209100
*/*                   "LINKAGE=BRANCH"                           @L5A*/ 00209400
*/*               ."LINKAGE=BRANCH" IS SPECIFIED WITHOUT         @L5A*/ 00209700
*/*                   "SYNCH=YES"                                @L5A*/ 00210000
*/*               ."SYNCH=YES" IS SPECIFIED WITH THE WQEBLK      @L5A*/ 00210300
*/*                   KEYWORD                                    @L5A*/ 00210600
*/*               ."SYNCH=YES" IS SPECIFIED WITH                 @L5A*/ 00210900
*/*                   "MCSFLAG=HRDCPY"                           @L5A*/ 00211200
*/*                                                                  */ 00211500
*/* EXTERNAL REFERENCES = N/A                                    @L1A*/ 00211800
*/*                                                                  */ 00212100
*/* TABLES = N/A                                                 @L1A*/ 00212400
*/*                                                                  */ 00212700
*/* MACROS =                                                     @L1A*/ 00213000
*/*     THE PARAMETER LIST GENERATED BY THIS MACRO IS MAPPED     @L1A*/ 00213300
*/*     BY THE MACRO IEZWPL. HOWEVER, IEZWPL IS NOT REQUIRED     @L1A*/ 00213600
*/*     TO USE THIS MACRO.                                       @L1A*/ 00213900
*/*                                                                  */ 00214200
*/*                                                                  */ 00214500
*/* CHANGE ACTIVITY = G860PSS                                @G860PSS*/ 00214800
*/*                                                                  */ 00215100
*/* $L1=COEXWTO2, JBB2220, 841128, PDF9: JES3/MCS COEXISTENCE        */ 00215400
*/* $P1=PA21155,  JBB2220, 860910, PDF9: JES3/MCS COEXISTENCE        */ 00215700
*/* $P2=PA21240,  JBB2220, 861008, PDF9: JES3/MCS COEXISTENCE        */ 00216000
*/*                   YA10057                                        */ 00216300
*/*                   YA11509 - NO CODE CHANGES.                     */ 00216600
*/*                   YA17152 - REDEFINE COMMON GLOBAL ACRONYMS      */ 00216900
*/* $L2=CNMG2,    HBB4410, 870424, PDR3: CONSOLE MERGE STAGE II      */ 00217200
*/* $L3=TSOOP,    HBB4410, 870622, PDBU: TSO OPERATOR                */ 00217500
*/* $L4=KNWTO,    HBB4410, 870916, PDCM: KANJI/WTO                   */ 00217800
*/* $P3=PEO0021,  HBB4410, 880120, PDBU: CONSOLE MERGE STAGE II      */ 00218100
*/* $P4=PEO0158,  HBB4410, 880210, PDBU: CONSOLE MERGE STAGE II      */ 00218400
*/* $L5=CNITGDHE, HBB4410, 890313, PDHE: CONSOLE INTEGRATION         */ 00218700
*/* $P5=PH25014,  HBB4410, 890503, PDHD: CONSOLE INTEGRATION         */ 00219000
*/* $P6=PH25015,  HBB4410, 890503, PDHD: CONSOLE INTEGRATION         */ 00219300
*/* $P7=PH25024,  HBB4410, 890503, PDHE: CONSOLE INTEGRATION         */ 00219600
*/* $P8=PEO1712,  HBB4410, 890612, PDCM: TEXT PARAMETER DESCRIPTION  */ 00219900
*/* $D1=DEO0124,  HBB4410, 890612, PDCM: DCR 124                     */ 00220100
*/* $D2=DEO0184,  HBB4410, 890619, PDHE: DCR 184                     */ 00220300
*/* $P9=PEO2841,  HBB4410, 891020, PDHE: INITIALIZE &MLW GLOBAL      */ 00220500
*/* $PA=PEO2883,  HBB4410, 891127, PDHE: RESTRICTIONS IN PROLOG      */ 00220600
*/* $PB=PEO3063,  HBB4410, 900105, PDF9: UPDATE TEXT GENERATE        */ 00220700
*/* $PC=PEO3640,  HBB4410, 900305, PDCY: ALLOW NULL TEXT KEYWORD     */ 00220800
*/*                                      VALUE ON LIST FORM OF MACRO */ 00220900
*/* $PD=PEO3824,  HBB4410, 900330, PDHD: WARNING ABOUT LINE TYPES    */ 00221000
*/*                                      WITH TEXT ON EXEC FORM      */ 00221100
*/* $PE=PEO4290,  HBB4410, 900504, PDHE: CHANGE MNOTE SEVERITY       */ 00221200
*/* $01=OY37350,  HBB4410, 901019, PDHE: PEO4845 REMOVE UNSUPPORTED  */ 00221300
*/*                                      PARAMETER                   */ 00221400
*/* $02=OY52324,  HBB4410, 920327, PDHE: TEXT ADDRESS IN REGISTER    */ 00221500
*/* $PF=PIG4139,  HBB5510, 930415, PDHD: LINE TYPE MNOTE WRONG       */ 00221600
*/* $PG=PIG4141,  HBB5510, 930415, PDHD: ML TEXT IN MF=E             */ 00221700
*/*                                                                  */ 00221800
*/* MESSAGES (MNOTES) =                                          @L1A*/ 00221900
*/*                                                                  */ 00222000
*/*  - SEVERITY 0 MNOTES:                                        @L1A*/ 00222100
*/*     - 'KKKKKKKK' DATA IGNORED ON THE LIST FORM OF WTOR.      @L1A*/ 00222200
*/*           WHERE 'KKKKKKKK' MAY BE KEY, CONSID, JOBID,        @L1A*/ 00222300
*/*           JOBNAME, TOKEN, SYSNAME, CONSNAME,                 @01C*/ 00222600
*/*           RPLYISUR, CART, TEXT, OR LINKAGE                   @L5C*/ 00222900
*/*     - INLINE TEXT EXCEEDS ALLOWED MAXIMUM. TEXT LINE         @PEM*/ 00223000
*/*            (NUMBER N) HAS BEEN TRUNCATED.                    @PEM*/ 00223100
*/*          WHERE 'NUMBER N' APPLIES TO THE LINE NUMBER ON A    @PEM*/ 00223200
*/*          MULTI LINE MESSAGE                                  @PEM*/ 00223300
*/*                                                                  */ 00223400
*/*  - SEVERITY 4 MNOTES:                                        @L1A*/ 00223500
*/*     - RESERVED ROUTING CODE(S) 29-40 IGNORED.            @YA10057*/ 00223800
*/*     - INVALID RANGE OF ROUTING CODES IGNORED.                @L1A*/ 00224100
*/*     - 'KKKKKKKK' KEYWORD IGNORED. NO VALUE SPECIFIED.        @L1A*/ 00224400
*/*           WHERE 'KKKKKKKK' MAY BE WQEBLK, CONSID, JOBID,     @L1A*/ 00224700
*/*           JOBNAME, KEY, TOKEN, SYSNAME, CONSNAME,            @01C*/ 00225000
*/*           CART OR TEXT.                                      @L4A*/ 00225300
*/*     - ROUTCDE  N  IS INVALID ROUTING CODE. IT IS IGNORED.    @L1A*/ 00225600
*/*     - DESC  N  IS INVALID DESCRIPTOR CODE. IT IS IGNORED.    @L1A*/ 00225900
*/*     - MSGTYP FIELD INVALID. N IS ASSUMED                     @L1A*/ 00226200
*/*     - MCSFLAG= &MCSFLAG(&I) IS INVALID. IT IS IGNORED.       @L1A*/ 00226500
*/*     - HRDCPY AND NOCPY MUTUALLY EXCLUSIVE, MCSFLAG=HRDCPY    @L1A*/ 00226800
*/*         ASSUMED                                              @L1A*/ 00227100
*/*     - QID FIELD IS INVALID. ZERO ASSUMED.                    @L1A*/ 00227400
*/*     - LINKAGE IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXX @L5A*/ 00227700
*/*     - SYNCH IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXX @L5A*/ 00228000
*/*                                                                  */ 00228500
*/*  - SEVERITY 12 MNOTES:                                       @L1A*/ 00228600
*/*     - NO TEXT GENERATED. 'WQEBLK' IS MUTUALLY EXCLUSIVE      @L1A*/ 00228900
*/*         WITH ALL OTHER KEYWORDS.                             @L1A*/ 00229200
*/*     - NO TEXT GENERATED. 'CONSID' IS MUTUALLY EXCLUSIVE      @L2A*/ 00229500
*/*         WITH CONSNAME KEYWORDS.                              @L2A*/ 00229800
*/*     - NUMBER OF LINES REQUESTED IS NOT 1 - GENERATION        @L1A*/ 00230100
*/*         TERMINATED                                           @L1A*/ 00230400
*/*     - NO TEXT GENERATED. INLINE TEXT IS MUTUALLY EXCLUSIVE   @L4A*/ 00230700
*/*         WITH 'TEXT'.                                         @L4A*/ 00231000
*/*     - NO TEXT GENERATED.  'SYNCH=YES' REQUIRES               @L5A*/ 00231300
*/*         'LINKAGE=BRANCH'                                     @L5A*/ 00231600
*/*     - NO TEXT GENERATED.  'LINKAGE=BRANCH' REQUIRES          @L5A*/ 00231900
*/*         'SYNCH=YES'                                          @L5A*/ 00232200
*/*     - NO TEXT GENERATED.  'SYNCH=YES' IS MUTUALLY EXCLUSIVE  @L5A*/ 00232500
*/*         WITH THE WQEBLK KEYWORD                              @L5A*/ 00232800
*/*     - NO TEXT GENERATED.  'SYNCH=YES' IS MUTUALLY EXCLUSIVE  @L5A*/ 00233100
*/*         WITH 'MCSFLAG=HRDCPY'                                @L5A*/ 00233400
*/*     - NO TEXT GENERATED.  SPECIFIED LINKAGE VALUE WAS NOT    @L5A*/ 00233700
*/*         SVC OR BRANCH.                                       @L5A*/ 00234000
*/*     - NO TEXT GENERATED.  SPECIFIED SYNCH VALUE WAS NOT      @L5A*/ 00234300
*/*         YES OR NO.                                           @L5A*/ 00234600
*/*     - TOO MANY LINES OF TEXT.  MAX=14 WHEN SYNCH=YES         @L5A*/ 00234900
*/*                                                                  */ 00235200
*/* NOTES     = THE WPL IS GENERATED BY THIS MACRO IN DIFFERENT  @L1A*/ 00235500
*/*             FORMATS DEPENDING ON THE KEYWORDS PROVIDED.      @L1A*/ 00235800
*/*             A STANDARD WPL IS GENERATED IF ONLY THE          @L1A*/ 00236100
*/*             FOLLOWING KEYWORDS ARE SPECIFIED: ROUTCDE(1-16), @L1A*/ 00236400
*/*             DESC, MCSFLAG, MSGTYPE, QID.                     @L1A*/ 00236700
*/*             IF ANY OTHER KEYWORDS ARE SPECIFIED, A DIFFERENT @L1A*/ 00237000
*/*             STRUCTURE (WPX - MAPPED BY IEZWPL) IS BUILT      @L1A*/ 00237300
*/*             FOLLOWING THE MESSAGE TEXT.                      @L1A*/ 00237600
*/*                                                                  */ 00237900
*/*             IN ORDER TO SUPPORT ASSEMBLER F, THIS MACRO      @P2A*/ 00238200
*/*             MUST BE STRUCTURED SUCH THAT THERE ARE NO        @P2A*/ 00238500
*/*             INSTRUCTIONS MORE THAN 3 LINES IN LENGTH.        @P2A*/ 00238800
*/*                                                                  */ 00239100
*/*             IF LINKAGE=BRANCH IS SPECIFIED THE CONTENTS OF   @L5A*/ 00239400
*/*             REGISTER 14 WILL BE DESTROYED.                   @L5A*/ 00239700
*/*                                                                  */ 00240000
*/********************************************************************/ 00240300
*/* C ALLOW THE ISSUER TO PROVIDE 31 BIT POINTERS            @G860PSS*/ 00240600
*/* A PROVIDE MVS/370 FORMAT PARM LIST                       @G860PSS*/ 00240900
*/* A MODIFY THE MACRO TO PROCESS WQEBLK, 128 ROUTING CODES,     @L1A*/ 00241200
*/*   CONSID, JOBID, KEY, TOKEN, SYSNAME, DOMID, JOBNAME AND THE @L1A*/ 00241500
*/*   'EXTENDED' MF PARAMETER.                                   @L1A*/ 00241800
*/* C LIMIT STATEMENT LENGTHS TO 3 LINES MAX TO SUPPORT ASM F    @P1A*/ 00242100
*/* C REFIX PA21155 SO THAT WPX IS ALWAYS CORRECTLY GENERATED    @P2A*/ 00242400
*/* C ALLOW ROUTING CODE 41 TO BE SPECIFIED                  @YA10057*/ 00242700
*/* NO CODE CHANGE. REASSEM FOR PTF PACKAGING PROBLEM ONLY.  @YA11509*/ 00243000
*/* C REDEFINE GLOBAL NAMES  @LEN ,&MCS ,&WTOLEN UNIQUELY    @YA17152*/ 00243300
*/* A MODIFY THE MACRO TO PROCESS CONSNAME AND REPLY CONSOLE     @L2A*/ 00243600
*/*   NAME/ID ADDRESS                                            @L2A*/ 00243900
*/* A MODIFY THE MACRO TO PROCESS CART                           @D1C*/ 00244200
*/* A MODIFY THE MACRO TO PROCESS TEXT KEYWORD                   @L4A*/ 00244500
*/* C FIXED REPLY ADDRESS AND ECB ADDRESS FOR WTOR STANDARD FORM @P3A*/ 00244800
*/* C PUT BACK CODE TO INITIALIZE REPLY/ECB ADDRESSES FOR WTOR   @P4A*/ 00245100
*/* C MODIFY THE MACRO TO PROCESS LINKAGE AND SYNCH KEYWORDS     @L5A*/ 00245400
*/* C ALLOW LINKAGE TO BE NULL IN THE LIST FORM                  @P5A*/ 00245700
*/* C UPDATE SYNCH=NO IN THE EXECUTE FORM                        @P6A*/ 00246000
*/* C TEXT KEYWORD MULTILINE EXECUTE FORM NOT LOADING ADDRESS OF @P7A*/ 00246300
*/*   THE FIRST LINE OF TEXT                                     @P7A*/ 00246600
*/* A INITIALIZE GLOBAL VARIABLE &MLW                            @P9A*/ 00246700
*/* A ADD RESTICTIONS TO PROLOG                                  @PAA*/ 00246800
*/* C UPDATE GENERATE FOR MESSAGE TEXT                           @PBA*/ 00246900
*/* C ALLOW NULL KEYWORD VALUE ON LIST FORM OF MACRO             @PCA*/ 00247000
*/* C WARNING MESSAGE IF LINE TYPE GIVEN ON EXEC FORM            @PDA*/ 00247700
*/* C CHANGE SEVERITY ON TEXT LENGTH MNOTE                       @PEA*/ 00247900
*/* C REMOVE UNSUPPORTED KEYWORD                                 @01A*/ 00248100
*/* C TEXT ADDRESS IN REGISTER                                   @02A*/ 00248200
*/* C CORRECT THE CHECKS FOR NON-NULL LINETYPE IN EXEC FORM      @PFA*/ 00248400
*/* C MOVE STORE OF TEXT ADDR FOR 2ND-NTH LINES                  @PGA*/ 00248600
*/********************************************************************/ 00248800
* /*                                                                    00249100
         MACRO                                                          00250002
&NAME    WTOR  &MESG,&RYAD,&LENGTH,&ECB,&MF=I,&MSGTYP=,&ROUTCDE=,      X00300002
               &DESC=,&MCSFLAG=,&QID=,&WQEBLK=^,&CONSID=^,&JOBID=^,    X00320800
               &KEY=^,&TOKEN=^,&SYSNAME=^,&JOBNAME=^,                  X00334700
               &CONSNAME=^,&RPLYISUR=^,&CART=^,&TEXT=^,&LINKAGE=^,     X00343900
               &SYNCH=^                                            @01C 00353100
.********************************************************************** 00362500
.*       DECLARE THE GLOBAL AND LOCAL VARIABLES                    @L1C 00363100
.********************************************************************** 00363700
         GBLA  &IHBLEN             MESSAGE LENGTH (SET BY WTO) @YA17152 00364000
         GBLB  &IHBWTOR            THIS IS A WTOR                  @L1C 00364100
         GBLB  &IHBMCS             MCS FLAGS (SET BY WTO)      @YA17152 00364200
         GBLB  &SWM                GENERATE MSGTYP FLAGS (WTO)     @L1C 00364300
         GBLB  &WTOERR             WTO ISSUED A TERMINATING MNOTE  @L1C 00364400
         GBLB  &IWPXBIT            A WPX HAS BEEN BUILT            @L1C 00364500
         GBLB  &IWQEBIT            A WQEBLK SETUP HAS OCCURRED     @L1A 00364600
         GBLB  &TEXTKEY            TEXT KEYWORD SPECIFIED          @L4A 00364700
         GBLB  &RAREG              REPLY ADDRESS IN REGISTER IND.  @L1C 00364800
         GBLB  &RLREG              REPLY LENGTH IN REGISTER IND.   @L1C 00364900
         GBLB  &EAREG              ECB ADDRESS IN REGISTER IND.    @L1C 00365000
         GBLB  &RCNREG             REPLY CONSOLE NAME/ID ADDRESS IN    X00365100
                                   REGISTER IND.                   @L2A 00365200
         GBLB  &RCNSPEC            REPLY CONSOLE NAME/ID ADDRESS       X00365300
                                   KEYWORD SPECIFIED               @L2A 00365400
         GBLB  &MLW                MULTI-LINE WTO/R SPECIFIED      @L5A 00365500
         GBLC  &TEXTVAL            TEXT ADDRESS, IF SPECIFIED      @L4A 00365600
         GBLC  &SYSSPLV            SYSTEM PRODUCT LEVEL            @L1C 00365700
         GBLC  &CD(16)             FLAGS SET BY WTO MACRO          @L1A 00365800
         GBLC  &WTORYA             REPLY ADDRESS FOR WTO MACRO     @L1A 00365900
         GBLC  &WTOLENR            REPLY LENGTH FOR WTOR       @YA17152 00366000
         GBLC  &WTOECB             ECB ADDRESS FOR WTO MACRO       @L1A 00366100
         GBLC  &WTORCN             REPLY CONSOLE NAME/ID ADDRESS FOR   X00366200
                                   WTO MACRO                       @L2A 00366300
         GBLC  &GNAME              LABEL AFTER PARAMETER LIST      @L1C 00366400
         GBLC  &ILMEQU             INLINE MESSAGE TEXT VALUE       @L5A 00366500
         LCLA  &K                  LENGTH FIELD                    @L5M 00366600
         LCLA  &H                  PROCESSED MAJOR INDEX           @L5A 00366700
         LCLA  &MAXLINS            MAXIMUM NUMBER OF LINES ALLOWED WHEN+00366800
                                   SYNCH = YES                     @L5A 00366900
         LCLA  &MLINDX             MULTI-LINE OFFSET INDEX         @L5A 00367000
         LCLB  &EMCS(16)           EXTENDED MCSFLAG SAVEAREA       @L4C 00367100
         LCLC  &VALH               TEXT LINE VALUE                 @L5A 00367200
         LCLC  &VALH1              TEXT ADDRESS VALUE              @L5A 00367300
         LCLC  &VALH2              TEXT LINE TYPE VALUE            @PFA 00367400
         LCLB  &LTWARN             LINE TYPE WARNING ISSUED        @PDA 00367500
&MAXLINS SETA  14                  MAXIMUM NUMBER OF LINES ALLOWED WHEN+00367600
                                   SYNCH = YES                     @L5A 00367700
&MLW     SETB  0                   INITIALIZE MULTILINE FLAG       @P9A 00367800
.********************************************************************** 00367900
.*       INVOKE THE SPLEVEL MACRO TO DETERMINE WHICH FORMAT OF @G860PSS 00368000
.*       THE PARAMETER LIST SHOULD BE BUILT. IF THE MVS/370    @G860PSS 00368100
.*       FORMAT IS REQUIRED, INVOKE THE WTOR7 MACRO.           @G860PSS 00368200
.********************************************************************** 00368500
         SPLEVEL TEST                                          @G860PSS 00369100
         AIF   ('&SYSSPLV' NE '1').NOT370 WHICH FORMAT?        @G860PSS 00369700
&NAME    WTOR7 &MESG,&RYAD,&LENGTH,&ECB,MF=&MF,MSGTYP=&MSGTYP,         X00370100
               ROUTCDE=&ROUTCDE,DESC=&DESC,MCSFLAG=&MCSFLAG,QID=&QID   X00370500
                                                               @G860PSS 00370900
         MEXIT                                                 @G860PSS 00371500
.NOT370  ANOP                                                  @G860PSS 00372100
.********************************************************************** 00372700
.*       DEFINE THE LABEL TO BRANCH TO AFTER THE PARAMETER     @G860PSS 00374900
.*       LIST                                                  @G860PSS 00400300
.********************************************************************** 00425700
&GNAME   SETC  'IHB'.'&SYSNDX'                                          00451100
.********************************************************************** 00476500
.*       SYNTAX CHECK THE LINKAGE AND SYNCH KEYWORDS               @L5A 00476800
.*       ISSUE ERROR MESSAGES WHERE APPROPRIATE                    @L5A 00477100
.********************************************************************** 00477400
         AIF   ('&LINKAGE(1)' EQ '^').CHKSYNC    LINKAGE NOT NAMED @L5A 00477700
         AIF   ('&LINKAGE(1)' EQ '' AND '&MF' EQ 'L').CHKSYNC      @P5A 00478000
         AIF   ('&LINKAGE(1)' NE 'SVC' AND                             +00478300
                '&LINKAGE(1)' NE 'BRANCH').ERROR10   ISSUE MESSAGE @L5A 00478600
         AIF   ('&LINKAGE(1)' EQ 'BRANCH' AND                          +00478900
                '&SYNCH(1)' NE 'YES').ERROR16        ISSUE MESSAGE @L5A 00479200
         AIF   (N'&LINKAGE LE 1 AND                                    +00479500
                N'&LINKAGE(1) LE 1).CHKSYNC     MORE THAN ONE OPERAND  +00479800
                                                  SPECIFIED?       @L5A 00480100
         MNOTE 4,'*** ''LINKAGE=&LINKAGE'' IS TOO LONG.  ARGUMENTS ARE +00480400
               IGNORED AFTER ''&LINKAGE(1,1)''.'                   @L5A 00480700
.CHKSYNC ANOP                                                           00481000
         AIF   ('&SYNCH(1)' EQ '^').CHKTXTM        SYNCH NOT NAMED @L5A 00481300
         AIF   ('&SYNCH(1)' NE 'YES' AND                               +00481600
                '&SYNCH(1)' NE 'NO').ERROR12         ISSUE MESSAGE @L5A 00481900
         AIF   ('&SYNCH(1)' EQ 'YES' AND                               +00482200
                '&WQEBLK(1)' NE '^').ERROR13         ISSUE MESSAGE @L5A 00482500
         AIF   ('&SYNCH(1)' EQ 'YES' AND                               +00482800
               '&MF' NE 'L' AND                                        +00483100
                '&LINKAGE(1)' NE 'BRANCH').ERROR15   ISSUE MESSAGE @P5C 00483400
         AIF   (N'&SYNCH LE 1 AND                                      +00483700
                N'&SYNCH(1) LE 1).CHKTXTM       MORE THAN ONE OPERAND  +00484000
                                                  SPECIFIED?       @L5A 00484300
         MNOTE 4,'*** ''SYNCH=&SYNCH'' IS TOO LONG.  ARGUMENTS ARE IGNO+00484600
               RED AFTER ''&SYNCH(1,1)''.'                         @L5A 00484900
.********************************************************************** 00485200
.*       VERIFY THAT INLINE TEXT AND THE TEXT KEYWORD WERE NOT     @L4A 00485600
.*       BOTH SPECIFIED                                            @L4A 00494700
.********************************************************************** 00503800
.CHKTXTM ANOP                                                      @L5A 00503900
         AIF   ('&TEXT' EQ '^' OR  '&MESG' EQ '').TEXTOK  BRANCH IF    X00504000
                                           NOT BOTH                @L4A 00504100
         MNOTE 12,'NO TEXT GENERATED. ''TEXT'' AND INLINE TEXT ARE MUTUX00504200
               ALLY EXCLUSIVE.'                                    @L4A 00504300
         MEXIT                                                     @L4A 00504400
.TEXTOK  ANOP                                                      @L4A 00504500
.********************************************************************** 00504600
.*       FILL IN THE REPLY ADDRESS, REPLY LENGTH, ECB AND          @L1A 00504700
.*       REPLY CONSOLE NAME/ID ADDRESS FOR THE WTO MACRO TO USE    @L2C 00504800
.*       IN CASE IT NEEDS TO BUILD A WPX FOR THIS MACRO.           @L1A 00504900
.********************************************************************** 00505000
&RAREG   SETB  0                           INITIALIZE REPLY ADDRESS    X00505100
                                           IN REGISTER INDICATOR   @L1A 00505200
&RLREG   SETB  0                           INITIALIZE REPLY LENGTH     X00505300
                                           IN REGISTER INDICATOR   @L1A 00505400
&EAREG   SETB  0                           INITIALIZE ECB ADDRESS      X00505500
                                           IN REGISTER INDICATOR   @L1A 00505600
&RCNREG  SETB  0                           INITIALIZE REPLY CONSOLE    X00505700
                                           ADDRESS IN REGISTER IND.@L2A 00505800
&RCNSPEC SETB  0                           INITIALIZE REPLY CONSOLE    X00505900
                                           KEYWORD INDICATOR       @L2A 00506000
&TEXTKEY SETB  ('&TEXT' NE '^' AND '&TEXT' NE '')                  @L4A 00506100
&TEXTVAL SETC  '^'                         INITIALIZE TEXT ADDRESS @L4A 00506200
         AIF   (&TEXTKEY).TXTVALS          BRANCH IF TEXT KEY USED @L4A 00506300
         AIF   (N'&MESG EQ 1).SINGLIN      CHECK IF MULTI-LINE     @L5A 00506400
&K       SETA  K'&MESG                     INLINE MULTI-LINE TEXT      +00506500
                                           LENGTH INCLUDING PARENS @L5A 00506600
.SINGLIN ANOP                                                           00506700
&WTORYA  SETC  '&RYAD'                     FILL IN REPLY ADDRESS FOR   X00506800
                                           WTO MACRO               @L1A 00506900
&WTOLENR SETC  '&LENGTH'                   FILL IN REPLY LENGTH FOR    X00507700
                                           WTO MACRO           @YA17152 00508800
&WTOECB  SETC  '&ECB'                      FILL IN ECB ADDRESS FOR     X00509900
                                           WTO MACRO               @L1A 00511000
         AGO   .REGVAL                     CONTINUE                @L4A 00511100
.TXTVALS ANOP                              TEXT KEYWORD USED       @L4A 00511200
&TEXTVAL SETC  '&TEXT(1)'                  FILL IN TEXT ADDRESS FOR    X00511300
                                           WTO MACRO               @L4A 00511400
&WTORYA  SETC  '&TEXT(2)'                  FILL IN REPLY ADDRESS FOR   X00511500
                                           WTO MACRO               @L4A 00511600
&WTOLENR SETC  '&TEXT(3)'                  FILL IN REPLY LENGTH FOR    X00511700
                                           WTO MACRO           @YA17152 00511800
&WTOECB  SETC  '&TEXT(4)'                  FILL IN ECB ADDRESS FOR     X00511900
                                           WTO MACRO               @L4A 00512000
.REGVAL  ANOP                                                      @L4A 00512100
         AIF   ('&WTORYA' EQ '').RCNWTO  IF NO REPLY ADDRESS, CHECK    X00512200
                                           FOR REPLY CONS/NAME ID  @L4A 00512300
         AIF   ('&WTORYA'(1,1) NE '(').RCNWTO IF REPLY ADDRESS NOT IN  X00512400
                                           REGISTER, LEAVE AS IS   @L4A 00512500
&RAREG   SETB  1                           REPLY ADDR IN REGISTER  @L1A 00512600
         AIF   (&TEXTKEY).RATEXT           BRANCH IF TEXT KEY USED @L4A 00512700
&WTORYA  SETC  '&RYAD(1)'                  FILL IN REG VALUE OF REPLY  X00512800
                                           ADDRESS FOR WTO MACRO   @L1A 00512900
         AGO   .RCNWTO                     GO CHECK REPLY CONSNAME @L4A 00513000
.RATEXT  ANOP                              REGISTER/TEXT KEYWORD   @L4A 00513100
&K       SETA  K'&WTORYA                   SET LENGTH OF VALUE     @L4A 00513200
&WTORYA  SETC  '&WTORYA'(2,&K-2)           EXTRACT REGISTER VALUE  @L4A 00513300
.RCNWTO  ANOP                              CHECK REPLY CONSOLE NAME@L2A 00513400
&WTORCN  SETC  ''                          SET REPLY CONSOLE NAME/ID   X00513500
                                           TO NO VALUE             @L2A 00513600
         AIF   ('&RPLYISUR' EQ '^').RLWTO  IF NO REPLY CONSOLE NAME/ID X00513700
                                           CHECK FOR REPLY LENGTH  @L2A 00513800
&RCNSPEC SETB  1                           REPLY CONSOLE NAME/ID ADDR  X00513900
                                           KEYWORD SPECIFIED       @L2A 00514000
         AIF   ('&RPLYISUR' EQ '').RLWTO   IF NO REPLY CONSOLE NAME/ID X00514100
                                           DATA CHECK FOR REPLY LENGTH X00514200
                                                                   @L2A 00514300
         AIF   ('&RPLYISUR'(1,1) NE '(').NOREG  IF RPLY CNSOLE NAME/ID X00514400
                                           NOT IN REGISTER GO SET VALUEX00514500
                                           IN GLOBAL VARIABLE.     @L2A 00514600
&RCNREG  SETB  1                           REPLY CONSOLE NAME/ID ADDR  X00514700
                                           IN REGISTER INDICATOR   @L2A 00514800
&WTORCN  SETC  '&RPLYISUR(1)'              YES,IN REGISTER SET GLOBAL  X00514900
                                           VARIABLE FOR WTO        @L2A 00515000
         AGO   .RLWTO                      CHECK FOR REPLY LENGTH  @L2A 00515100
.NOREG   ANOP                                                      @L2A 00515200
&WTORCN  SETC  '&RPLYISUR'                 NOT IN REGISTER SET GLOBAL  X00515300
                                           VARIABLE FOR WTO        @L2A 00515400
.RLWTO   ANOP                              CHECK REPLY LENGTH      @L1A 00515500
         AIF   ('&WTOLENR' EQ '').EAWTO    IF NO REPLY LENGTH, CHECK   X00515600
                                           FOR ECB ADDRESS     @YA17152 00515700
         AIF   ('&WTOLENR'(1,1) NE '(').EAWTO IF REPLY LENGTH NOT IN A X00515800
                                           REG, LEAVE AS IS    @YA17152 00515900
&RLREG   SETB  1                           REPLY LEN  IN REGISTER  @L1A 00516000
         AIF   (&TEXTKEY).RLTEXT           BRANCH IF TEXT KEY USED @L4A 00516100
&WTOLENR SETC  '&LENGTH(1)'                FILL IN REG VALUE OF REPLY  X00516200
                                           LENGTH FOR WTO      @YA17152 00516300
         AGO   .EAWTO                      GO CHECK ECB ADDRESS    @L4A 00516400
.RLTEXT  ANOP                              REGISTER/TEXT KEYWORD   @L4A 00516500
&K       SETA  K'&WTOLENR                  SET LENGTH OF VALUE @YA17152 00516600
&WTOLENR SETC  '&WTOLENR'(2,&K-2)          EXTRACT REG VALUE   @YA17152 00516700
.EAWTO   ANOP                              CHECK ECB ADDRESS       @L1A 00516800
         AIF   ('&WTOECB' EQ '').DOWQE     IF NO ECB ADDRESS, CHECK    X00516900
                                           FOR WQEBLK              @L4A 00517000
         AIF   ('&WTOECB'(1,1) NE '(').DOWQE IF ECB ADDRESS NOT IN A   X00517100
                                           REGISTER, LEAVE AS IS   @L4A 00517200
&EAREG   SETB  1                           ECB ADDR IN REGISTER    @L1A 00517300
         AIF   (&TEXTKEY).EATEXT           BRANCH IF TEXT KEY USED @L4A 00517400
&WTOECB  SETC  '&ECB(1)'                   FILL IN REG VALUE OF ECB    X00517500
                                           ADDRESS FOR WTO MACRO   @L1A 00517600
         AGO   .DOWQE                      GO CHECK FOR WQEBLK     @L4A 00517700
.EATEXT  ANOP                              REGISTER/TEXT KEYWORD   @L4A 00517800
&K       SETA  K'&WTOECB                   SET LENGTH OF VALUE     @L4A 00517900
&WTOECB  SETC  '&WTOECB'(2,&K-2)           EXTRACT REGISTER VALUE  @L4A 00518000
.DOWQE   ANOP                              CHECK FOR WQEBLK        @L1A 00518100
.********************************************************************** 00518200
.*       MAKE THE FOLLOWING CHECKS:                            @G860PSS 00518300
.*           WQEBLK         - IF NOT SPECIFIED ALONE, ISSUE ERROR  @L1A 00518700
.*                            MESSAGE.  THE WTO MACRO WILL MAKE    @L1A 00519900
.*                            THE REST OF THE EXCLUSIVITY CHECKS.  @L1A 00521100
.*           CONSNAME AND CONSID HAVE NOT BOTH BEEN SPECIFIED      @L2A 00521800
.*           MLWTOR         - IF SO, ISSUE ERROR MESSAGE       @G860PSS 00522500
.*           INLINE REQUEST - IF SO, GO PROCESS                @G860PSS 00527500
.*           LIST REQUEST   - IF SO, GO PROCESS                @G860PSS 00532500
.********************************************************************** 00537500
         AIF   ('&WQEBLK' NE '^' AND ('&MESG' NE '' OR '&TEXT' NE ''   X00540000
                OR '&RYAD' NE '' OR '&LENGTH' NE '' OR '&RPLYISUR' NE  X00542500
                '^' OR '&ECB' NE '' OR '&MF' NE 'I')).ERROR8       @L2C 00545000
         AIF   ('&CONSNAME' NE '^' AND  '&CONSID' NE '^').ERROR9   @L2A 00547500
.******************************************************************@L5A 00547600
.*       CHECK IF THIS IS A LINKAGE=BRANCH,SYNCH=YES INVOCATION.   @L5A 00547700
.*       MULTI-LINE WTORS ARE ALLOWED ONLY IF SYNCH=YES            @L5A 00547800
.*       OTHERWISE SINGLE-LINE WTORS ONLY.                         @L5A 00547900
.*       IF MULTI-LINE IS ALLOWED CHECK FOR THE MAXIMUM NUMBER OF  @L5A 00548000
.*       LINES ALLOWED AS DEFINED BY VARIABLE &MAXLINS.            @L5A 00548100
.******************************************************************@L5A 00548200
         AIF   ('&SYNCH(1)' NE 'YES').NONSYNC                      @L5A 00548300
         AIF   (N'&SYSLIST(1) GT &MAXLINS).ERROR17    MULTI-LINE ONLY  +00548400
                                           ALLOWED WITH SYNCH=YES  @L5A 00548500
         AIF   (N'&TEXT(1)    GT &MAXLINS).ERROR17    MULTI-LINE ONLY  +00548600
                                           ALLOWED WITH SYNCH=YES  @L5A 00548700
&MLW     SETB  (N'&TEXT(1) GT 1 OR N'&SYSLIST(1) GT 1)  SET MULTI-LINE +00548800
                                           FLAG BIT                @L5A 00548900
         AGO   .CHK4MFI                                            @L5A 00549000
.NONSYNC ANOP                                                      @L5A 00549100
         AIF   (N'&SYSLIST(1) GT 1).ERROR7 ERROR IF MULTI-LINE WTOR     00550000
         AIF   (N'&TEXT(1) GT 1).ERROR7   ERROR IF MULTI-LINE WTOR @L4A 00575000
.CHK4MFI ANOP                                                      @L5A 00587500
         AIF   ('&MF' EQ 'I').IROUT        STANDARD FORM           @L1C 00600000
         AIF   ('&MF' EQ 'L').LROUT        LIST FORM               @L1C 00650000
.********************************************************************** 00660000
.*       CHECK FOR A PARAMETER LIST NAME AND AN EXECUTE FORM.  @G860PSS 00670000
.*       IF NOT VALID, GO ISSUE ERROR MESSAGE                  @G860PSS 00680000
.********************************************************************** 00690000
         AIF   (N'&MF LE 1).ERROR1         ERROR IF BAD MF STRUCTURE    00700000
         AIF   ('&MF(1)' NE 'E').ERROR1    ERROR IF NOT EXECUTE FORM    00750000
.********************************************************************** 00758300
.*                                                             @G860PSS 00766600
.*       EXECUTE FORM                                          @G860PSS 00774900
.*                                                             @G860PSS 00783200
.********************************************************************** 00791500
.********************************************************************** 00791700
.*       SET UP REG1 TO POINT TO THE USER PARM LIST                @L1A 00791900
.********************************************************************** 00792100
&NAME    IHBINNRA &MF(2)                ADDRESS OF PARM LIST INTO R1    00792500
.********************************************************************** 00792600
.*       IF THE THIRD FIELD IN THE MACRO FORMAT KEYWORD IS         @L1A 00792700
.*       BLANK, IT MEANS THAT NO WPX HAS BEEN BUILT SO THE         @L1A 00792800
.*       REPLY ADDRESS, REPLY LENGTH, AND ECB ADDRESS ARE STORED   @L1A 00792900
.*       IN THE WTOR PREFIX IF SPECIFIED.                          @L1A 00793000
.*                                                                      00793100
.*       IF THE THIRD FIELD IN THE MACRO FORMAT KEYWORD IS         @L1A 00793200
.*       'EXTENDED', IT MEANS THAT A WPX HAS BEEN BUILT SO THE     @L1A 00793300
.*       REPLY ADDRESS, REPLY LENGTH, ECB ADDRESS AND OTHER VALID  @L1A 00793400
.*       KEYWORDS ARE STORED INTO THE WPX IF SPECIFIED.            @L1A 00793500
.*                                                                      00793600
.*       IF THE THIRD FIELD IN THE MACRO FORMAT KEYWORD IS         @L1A 00793700
.*       NOT EITHER OF THE ABOVE, AN ERROR MESSAGE IS ISSUED.      @L1A 00793800
.*                                                                 @L4A 00793900
.*       IF THE TEXT KEYWORD HAS BEEN SPECIFIED, ITS VALUE IS      @L4A 00794000
.*       STORED INTO THE PARAMETER LIST INSTEAD OF INLINE TEXT.    @L4A 00794100
.*       IN THIS CASE, THE TEXT KEYWORD IS ASSUMED TO HAVE BEEN    @L4A 00794200
.*       SPECIFIED ON THE LIST FORM OF THE MACRO. THE TEXT         @L4A 00794300
.*       KEYWORD RESULTS IN THE GENERATION OF A WPX.               @L4A 00794400
.********************************************************************** 00794500
         AIF   ('&JOBID'   NE '^' OR '&JOBNAME' NE '^' OR              X00794600
                '&KEY'     NE '^' OR '&TOKEN'   NE '^' OR              X00794700
                '&SYSNAME' NE '^').WPXFILL                         @01C 00794800
         AIF   ('&CONSID'  NE '^' OR '&CART'    NE '^' OR              X00794900
                '&CONSNAME' NE '^' OR '&TEXT' NE '^').WPXFILL      @L4C 00795000
         AIF   ('&RPLYISUR' NE '^').WPXFILL IF ANY RUN-TIME KEYWORDS   X00795100
                                       ARE SPECIFIED, FILL IN THE PRE  X00795200
                                       BUILT WPX                   @L2C 00795300
         AIF   ('&SYNCH'  NE '^').WPXFILL                          @P6A 00795400
         AIF   ('&MF(3)' EQ '').OLDFILL STORE IN PREFIX            @L1A 00795500
         AIF   ('&MF(3)' NE 'EXTENDED').ERROR1 INVALID MF TYPE     @L1A 00795600
.********************************************************************** 00795700
.*       THE FOLLOWING CODE WILL SET UP REG14 TO POINT TO THE      @L1A 00795800
.*       BYTE AFTER THE TEXT IN THE WPX.                           @L1A 00795900
.********************************************************************** 00796000
.WPXFILL ANOP                           WILL INSERT INTO WPX       @L1A 00796100
         LR    14,1                     FIRST BYTE OF PARM LIST    @L1A 00796200
         SR    15,15                    CLEAR REG 15               @L1A 00796500
         AH    15,0(1,0)                ADD LENGTH OF TEXT + 4     @L1A 00797500
         AR    14,15                    ADDR OF BYTE AFTER TEXT    @L1A 00803700
.********************************************************************** 00810000
.*       IF THE TEXT KEYWORD IS SPECIFIED, COPY IT INTO THE        @L3A 00810100
.*       PARAMETER LIST                                            @L3A 00810200
.********************************************************************** 00810300
.CHKTEXT AIF   ('&TEXTVAL' EQ '^').CHEKLEN GO ISSUE SVC            @L4A 00810400
         AIF   ('&TEXTVAL' NE '').TXTDAT VERIFY DATA SPECIFIED     @L4A 00810500
         MNOTE 4,'''TEXT'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   @L4A 00810600
         AGO   .CHEKLEN                 GO CHECK LENGTH            @L4A 00810700
.TXTDAT  ANOP                           DATA SPECIFIED             @L4A 00810800
&EMCS(9) SETB  1                        INDICATE IN EXT MCSFLAGS   @L4A 00810900
         AIF   ('&TEXT(1,1,2)' EQ '').ETEXTL1  LINE TYPE NOT SPEC. @PFC 00811000
         MNOTE 0,'LINE TYPE ON EXECUTE FORM IGNORED.'              @PDA 00811100
&LTWARN  SETB  1                        ISSUE WARNING ONCE ONLY    @PDA 00811200
.ETEXTL1 ANOP                                                      @PDA 00811300
         AIF   (&MLW).CHEKLEN           IF MULTI-LINE WILL MOVE TEXT   +00811400
                                        ADDRESSES LATER            @PGC 00811500
         AIF   ('&TEXTVAL'(1,1) EQ '(').TXTREG  TEXT IN REG        @02C 00811600
         LA    15,&TEXTVAL              LOAD TEXT                  @L4A 00811700
         ST    15,4(1,0)                MOVE TEXT INTO PARM LIST   @L4A 00811800
         AGO   .CHEKLEN                 GO CHECK LENGTH            @L4A 00811900
.TXTREG  ANOP                           TEXT IS IN REGISTER        @L4A 00812000
&K       SETA  K'&TEXTVAL                                               00812100
&TEXTVAL SETC  '&TEXTVAL'(2,&K-2)                                       00812200
         ST    &TEXTVAL,4(1,0)          MOVE TEXT INTO PARM LIST   @L4A 00812300
         AGO   .CHEKLEN                 GO CHECK LENGTH            @L4C 00812400
.********************************************************************** 00817000
.*       IF THE LENGTH IS SPECIFIED, COPY IT INTO THE              @L1A 00817100
.*       PARAMETER LIST                                            @L1A 00817200
.********************************************************************** 00817300
.CHEKLEN AIF   ('&WTOLENR' EQ '').CHEKRPY GO CHECK REPLY ADDR  @YA17152 00817400
         AIF   (&RLREG).LENREG          LENGTH IN REG              @L4C 00817500
         MVI   2(14),&WTOLENR           MOVE LENGTH INTO PARAMETER     X00817600
                                        LIST                   @YA17152 00817700
         AGO   .CHEKRPY                 GO CHECK REPLY ADDRESS     @L1A 00817800
.LENREG  STC   &WTOLENR,2(14,0)         MOVE LENGTH INTO PARAMETER     X00817900
                                        LIST                   @YA17152 00818000
.********************************************************************** 00818100
.*       IF THE REPLY ADDRESS IS SPECIFIED, COPY IT INTO THE       @L1A 00818200
.*       PARAMETER LIST                                            @L1A 00818300
.********************************************************************** 00818400
.CHEKRPY AIF   ('&WTORYA' EQ '').CHEKRCN GO CHECK RPLY CONS NAME   @L4C 00818500
         AIF   (&RAREG).RPYREG          REPLY ADDRESS IN REG       @L4C 00818600
         LA    15,&WTORYA               OBTAIN REPLY ADDRESS       @L4C 00818700
         ST    15,8(14,0)               MOVE REPLY ADDRESS INTO PARM   X00818800
                                        LIST                       @L1A 00818900
         AGO   .CHEKRCN                 GO CHECK REPLY CONSOLE NAME@L2C 00819000
.RPYREG  ST    &WTORYA,8(14,0)          MOVE REPLY ADDRESS INTO PARM   X00819100
                                        LIST                       @L4C 00819200
.********************************************************************** 00819300
.*       IF THE REPLY CONSOLE NAME/ID ADDRESS IS SPECIFIED, THEN   @L2A 00819400
.*       IT INTO THE PARAMETER LIST                                @L2A 00819500
.********************************************************************** 00819600
.CHEKRCN AIF   ('&RPLYISUR' EQ '^').CHEKECB  GO CHECK ECB ADDRESS  @L2A 00819700
         AIF   ('&RPLYISUR' NE '').RCNDAT VERIFY DATA SPECIFIED    @L2A 00819800
         MNOTE 4,'''RPLYISUR'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   X00819900
                                                                   @L2A 00820000
         AGO   .CHEKECB                 GO CHECK ECB ADDRESS       @L2A 00820100
.RCNDAT  ANOP                                                      @L2A 00820200
         AIF   ('&RPLYISUR'(1,1) EQ '(').RCNREG  REPLY CONSOLE NAME/ID X00820300
                                        ADDRESS IN REGISTER        @L2A 00820400
         LA    15,&RPLYISUR             OBTAIN REPLY CONSOLE NAME/ID   X00820500
                                        ADDRESS                    @L2A 00820600
         ST    15,92(14,0)              MOVE REPLY CONSOLE NAME/ID     X00820700
                                        ADDRESS IN PARM LIST       @L2A 00820800
         AGO   .CHEKECB                 GO CHECK ECB ADDRESS       @L2A 00820900
.RCNREG  ST    &RPLYISUR(1),92(14,0)    MOVE REPLY CONSOLE NAME/ID     X00821000
                                        ADDRESS IN PARM LIST       @L2A 00821100
.********************************************************************** 00821200
.*       IF THE ECB ADDRESS IS SPECIFIED, COPY IT INTO THE         @L1A 00821300
.*       PARAMETER LIST                                            @L1A 00821400
.********************************************************************** 00821500
.CHEKECB AIF   ('&WTOECB' EQ '').CHEKCON GO CHECK CONSID           @L4C 00821600
         AIF   (&EAREG).ECBREG          ECB ADDRESS IN REG         @L4C 00821700
         LA    15,&WTOECB               LOAD ECB ADDRESS           @L4C 00821800
         ST    15,12(14,0)              MOVE ECB ADDRESS INTO PARM     X00821900
                                        LIST                       @L1A 00822000
         AGO   .CHEKCON                 GO CHECK CONSID            @L1A 00822100
.ECBREG  ST    &WTOECB,12(14,0)         MOVE ECB ADDRESS INTO PARM     X00822200
                                        LIST                       @L4C 00822300
.********************************************************************** 00822400
.*       IF THE CONSID IS SPECIFIED, COPY IT INTO THE              @L1A 00822500
.*       PARAMETER LIST                                            @L1A 00822600
.********************************************************************** 00822700
.CHEKCON AIF   ('&CONSID' EQ '^').CHKCNNA GO CHECK CONSNAME        @L2C 00822800
         AIF   ('&CONSID' NE '').CONDAT VERIFY DATA SPECIFIED      @L1A 00822900
         MNOTE 4,'''CONSID'' KEYWORD IGNORED. NO VALUE SPECIFIED.' @L1A 00823000
         AGO   .CHKCNNA                 GO CHECK CONSNAME          @L2C 00823100
.CONDAT  ANOP                           DATA SPECIFIED             @L1A 00823200
&EMCS(2) SETB  1                        INDICATE IN EXT MCSFLAGS   @L1A 00823300
         AIF   ('&CONSID'(1,1) EQ '(').CONREG CONSID IN REG        @L1A 00823400
         L     15,&CONSID               LOAD CONSID                @L1A 00823500
         ST    15,72(14,0)              MOVE CONSID INTO PARM LIST @L1A 00823600
         AGO   .CHKCNNA                 GO CHECK CONSNAME          @L2C 00823700
.CONREG  ST    &CONSID(1),72(14,0)      MOVE CONSID INTO PARM LIST @L1A 00823800
.********************************************************************** 00823900
.*       IF THE CONSNAME IS SPECIFIED, COPY IT INTO THE            @L2A 00824000
.*       PARAMETER LIST                                            @L2A 00824100
.********************************************************************** 00824200
.CHKCNNA AIF   ('&CONSNAME' EQ '^').CHEKJOB GO CHECK JOBID         @L2A 00824300
         AIF   ('&CONSNAME' NE '').CNNADT VERIFY DATA SPECIFIED    @L2A 00824400
         MNOTE 4,'''CONSNAME'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   X00824500
                                                                   @L2A 00824600
         AGO   .CHEKJOB                 GO CHECK JOBID             @L2A 00824700
.CNNADT  ANOP                           DATA SPECIFIED             @L2A 00824800
&EMCS(7) SETB  1                        INDICATE IN EXT MCSFLAGS   @L1A 00824900
         AIF   ('&CONSNAME'(1,1) EQ '(').CNNAREG CONSNAME IN REG   @L2A 00825000
         MVC   84(8,14),&CONSNAME(1)     MOVE CONSNAME INTO LIST   @L2A 00825100
         AGO   .CHEKJOB                 GO CHECK JOBID             @L2A 00825200
.CNNAREG MVC   84(8,14),0(&CONSNAME(1))  MOVE CONSNAME INTO LIST   @L2A 00825300
.********************************************************************** 00825400
.*       IF THE JOBID IS SPECIFIED, COPY IT INTO THE               @L1A 00825500
.*       PARAMETER LIST                                            @L1A 00825600
.********************************************************************** 00825700
.CHEKJOB AIF   ('&JOBID' EQ '^').CHKJOB2 GO CHECK JOBNAME          @L1A 00825800
         AIF   ('&JOBID' NE '').JOBDAT  VERIFY DATA SPECIFIED      @L1A 00825900
         MNOTE 4,'''JOBID'' KEYWORD IGNORED. NO VALUE SPECIFIED.'  @L1A 00826000
         AGO   .CHKJOB2                 GO CHECK JOBNAME           @L1A 00826100
.JOBDAT  ANOP                           DATA SPECIFIED             @L1A 00826200
         AIF   ('&JOBID'(1,1) EQ '(').JOBREG JOBID IN REG          @L1A 00826300
         MVC   44(8,14),&JOBID(1)       MOVE JOBID INTO PARM LIST  @L1A 00826400
         AGO   .CHKJOB2                 GO CHECK JOBNAME           @L1A 00826500
.JOBREG  MVC   44(8,14),0(&JOBID(1))    MOVE JOBID INTO PARM LIST  @L1A 00826600
.********************************************************************** 00826700
.*       IF THE JOBNAME IS SPECIFIED, COPY IT INTO THE             @L1A 00826800
.*       PARAMETER LIST                                            @L1A 00826900
.********************************************************************** 00827000
.CHKJOB2 AIF   ('&JOBNAME' EQ '^').CHEKKEY GO CHECK KEY            @L1A 00827100
         AIF   ('&JOBNAME' NE '').JOBDAT2 VERIFY DATA SPECIFIED    @L1A 00827200
         MNOTE 4,'''JOBNAME'' KEYWORD IGNORED. NO VALUE SPECIFIED.'    X00827300
                                                                   @L1A 00827400
         AGO   .CHEKKEY                 GO CHECK KEY               @L1A 00827500
.JOBDAT2 ANOP                           DATA SPECIFIED             @L1A 00827600
         AIF   ('&JOBNAME'(1,1) EQ '(').JOBREG2 JOBNAME IN REG     @L1A 00827700
         MVC   52(8,14),&JOBNAME(1)     MOVE JOBNAME INTO LIST     @L1A 00827800
         AGO   .CHEKKEY                 GO CHECK KEY               @L1A 00827900
.JOBREG2 MVC   52(8,14),0(&JOBNAME(1))  MOVE JOBNAME INTO LIST     @L1A 00828000
.********************************************************************** 00828100
.*       IF THE KEY IS SPECIFIED, COPY IT INTO THE                 @L1A 00828200
.*       PARAMETER LIST                                            @L1A 00828300
.********************************************************************** 00828400
.CHEKKEY AIF   ('&KEY' EQ '^').CHEKTOK  GO CHECK TOKEN             @L1A 00828500
         AIF   ('&KEY' NE '').KEYDAT    VERIFY DATA SPECIFIED      @L1A 00828600
         MNOTE 4,'''KEY'' KEYWORD IGNORED. NO VALUE SPECIFIED.'    @L1A 00828700
         AGO   .CHEKTOK                 GO CHECK TOKEN             @L1A 00828800
.KEYDAT  ANOP                           DATA SPECIFIED             @L1A 00828900
         AIF   ('&KEY'(1,1) EQ '(').KEYREG KEY IN REG              @L1A 00829000
         MVC   60(8,14),&KEY(1)         MOVE KEY INTO PARM LIST    @L1A 00829100
         AGO   .CHEKTOK                 GO ISSUE SVC               @L1A 00829200
.KEYREG  MVC   60(8,14),0(&KEY(1))      MOVE KEY INTO PARM LIST    @L1A 00829300
.********************************************************************** 00829400
.*       IF THE TOKEN IS SPECIFIED, COPY IT INTO THE               @L1A 00829500
.*       PARAMETER LIST                                            @L1A 00829600
.********************************************************************** 00829700
.CHEKTOK AIF   ('&TOKEN' EQ '^').CHEKSYS GO CHECK SYSNAME          @L1A 00829800
         AIF   ('&TOKEN' NE '').TOKDAT  VERIFY DATA SPECIFIED      @L1A 00829900
         MNOTE 4,'''TOKEN'' KEYWORD IGNORED. NO VALUE SPECIFIED.'  @L1A 00830000
         AGO   .CHEKSYS                 GO CHECK SYSNAME           @L1A 00830100
.TOKDAT  ANOP                           DATA SPECIFIED             @L1A 00830200
         AIF   ('&TOKEN'(1,1) EQ '(').TOKREG TOKEN IN REG          @L1A 00830300
         L     15,&TOKEN                LOAD TOKEN                 @L1A 00830400
         ST    15,68(14,0)              MOVE TOKEN INTO PARM LIST  @L1A 00830500
         AGO   .CHEKSYS                 GO CHECK SYSNAME           @L1A 00830600
.TOKREG  ST    &TOKEN(1),68(14,0)       MOVE TOKEN INTO PARM LIST  @L1A 00830700
.********************************************************************** 00830800
.*       IF THE SYSNAME IS SPECIFIED, COPY IT INTO THE             @L1A 00830900
.*       PARAMETER LIST                                            @L1A 00831000
.********************************************************************** 00831100
.CHEKSYS AIF   ('&SYSNAME' EQ '^').CHKCART GO CHECK CART           @01C 00831200
         AIF   ('&SYSNAME' NE '').SYSDAT VERIFY DATA SPECIFIED     @L1A 00831300
         MNOTE 4,'''SYSNAME'' KEYWORD IGNORED. NO VALUE SPECIFIED.'    X00831400
                                                                   @L1A 00831500
         AGO   .CHKCART                  GO CHECK CART             @01C 00831600
.SYSDAT  ANOP                           DATA SPECIFIED             @L1A 00831700
         AIF   ('&SYSNAME'(1,1) EQ '(').SYSREG SYSNAME IN REG      @L1A 00831800
         MVC   76(8,14),&SYSNAME(1)     MOVE SYSNAME INTO PARM LIST@L1A 00831900
         AGO   .CHKCART                 GO CHECK CART              @01C 00832000
.SYSREG  MVC   76(8,14),0(&SYSNAME(1))  MOVE SYSNAME INTO PARM LIST@L1A 00832100
.********************************************************************** 00833700
.*       IF THE CART IS SPECIFIED, COPY IT INTO THE                @L3A 00833800
.*       PARAMETER LIST                                            @L3A 00833900
.********************************************************************** 00834000
.CHKCART AIF   ('&CART' EQ '^').CHKSYN  GO CHECK SYNCH             @P6C 00834100
         AIF   ('&CART' NE '').CRTDAT VERIFY DATA SPECIFIED        @L3A 00834200
         MNOTE 4,'''CART'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   @L3A 00834300
         AGO   .CHKSYN                  GO CHECK SYNCH             @P6C 00834400
.CRTDAT  ANOP                           DATA SPECIFIED             @L3A 00834500
         AIF   ('&CART'(1,1) EQ '(').CRTREG    CART IN REG         @L3A 00834600
         LA    15,&CART                 LOAD CART                  @L3A 00834700
         ST    15,96(14,0)              MOVE CART INTO PARM LIST   @L3A 00834800
         AGO   .CHKSYN                  GO CHECK SYNCH             @P6C 00834900
.CRTREG  ST    &CART(1),96(14,0)        MOVE CART INTO PARM LIST   @L3A 00835000
         AGO   .CHKSYN                  GO CHECK SYNCH             @P6C 00835100
.********************************************************************** 00835200
.*       IF SYNCH=YES IS SPECIFIED, SET THE CORRECT EMCSFLAG       @P6A 00835300
.********************************************************************** 00835400
.CHKSYN  AIF   ('&SYNCH(1)' EQ '^').EMCS GO CHECK EMCS FLAGS       @PGC 00835500
         AIF   ('&SYNCH(1)' NE '').SYNDAT VERIFY DATA SPECIFIED    @P6A 00835600
         MNOTE 4,'''SYNCH'' KEYWORD IGNORED. NO VALUE SPECIFIED.'  @P6A 00835700
         AGO   .EMCS                    GO CHECK EMCS FLAGS        @PGC 00835800
.SYNDAT  ANOP                           DATA SPECIFIED             @P6A 00835900
         AIF   ('&SYNCH(1)' NE 'YES').WPXETXT                      @PGC 00836000
&EMCS(14) SETB  1           SET SYNCH BIT ON IN EMCS               @P6A 00836100
.********************************************************************** 00836300
.*       CHECK TO SEE IF ANY OF THE EXTENDED MCSFLAGS NEEDS TO     @L1C 00836500
.*       BE SET                                                    @L1C 00836700
.********************************************************************** 00836900
.EMCS    ANOP                                                  @G860PSS 00837100
         AIF   (NOT &EMCS(2) AND NOT &EMCS(7) AND NOT &EMCS(9) AND     X00837300
                NOT &EMCS(14)).ESYNC                 IF CONSID OR NAME X00837500
                          OR SYNCH=YES SPECIFIED                   @01C 00837700
.********************************************************************** 00837900
.*       TURN ON THE EXTENDED MCSFLAGS WHICH MAY NEED TO BE        @L1A 00838100
.*       SET IF IT IS THE EXECUTE FORM OF THE MACRO                @L1A 00838300
.********************************************************************** 00838500
         OI    4(14),B'&EMCS(1)&EMCS(2)&EMCS(3)&EMCS(4)&EMCS(5)&EMCS(6)X00838700
               &EMCS(7)&EMCS(8)'        SET EXTENDED MCS FLAGS     @L1A 00838900
         OI    5(14),B'&EMCS(9)&EMCS(10)&EMCS(11)&EMCS(12)&EMCS(13)&EMCX00839100
               S(14)&EMCS(15)&EMCS(16)' SET EXTENDED MCS FLAGS2    @L4A 00839300
.ESYNC   AIF   ('&SYNCH(1)' NE 'NO').WPXETXT IF SYNCH=NO NOT SPECIFIED X00839500
                                        GO CHECK FOR TEXT MULTI         00839700
         NI    5(14),B'11111011'        TURN OFF SYNCH BIT         @P6A 00839900
.********************************************************************** 00840100
.*       IF THIS IS A MULTILINE WITH THE TEXT KEYWORD,             @PGA 00840300
.*       MOVE THE TEXT ADDRESSES INTO THE PARAMETER LIST           @PGM 00840500
.********************************************************************** 00840700
.WPXETXT ANOP                           MULTI-LINE WTOR W/TEXT?    @PGC 00840900
         AIF   (&MLW EQ 0).EXECUTE      NOT MULTILINE, ISSUE WTOR  @PGA 00841100
         AIF   (&TEXTKEY EQ 0).EXECUTE  NOT TEXT KYWD, ISSUE WTOR  @PGA 00841300
         AIF   ('&TEXT(1,1,1)'(1,1) EQ '(').TXTREG2  TEXT IN REG   @PGM 00841500
         LA    15,&TEXT(1,1,1)          LOAD TEXT                  @PGM 00841700
         ST    15,4(1,0)                MOVE TEXT INTO PARM LIST   @PGM 00841900
         AGO   .WPXTXT2                 GO DO SECOND LINE          @PGC 00842100
.TXTREG2 ANOP                           TEXT IS IN REGISTER        @PGM 00842300
&K       SETA  K'&TEXT(1,1,1)           SET LENGTH WITH PARENS     @PGM 00842500
&VALH1   SETC  '&TEXT(1,1,1)'(2,&K-2)   STRIP PARENS               @PGM 00842700
         ST    &VALH1,4(1,0)            MOVE TEXT INTO PARM LIST   @PGM 00842900
.WPXTXT2 ANOP                           SECOND LINE OF TEXT        @PGC 00843100
&MLINDX  SETA  4                        OFFSET TO TEXT ADDRESS     @PGM 00843300
&H       SETA  2                        PROCEED TO SECOND LINE     @PGM 00843500
         AIF   (&H GT N'&TEXT(1)).CHEKLEN LOOP DONE GO CHECK FOR REPLY +00843700
                                        LENGTH SPECIFICATION       @PGM 00843900
         XR    15,15                    CLEAR INDEX FOR INSERTS    @PGM 00844100
         IC    15,3(14)                 SET LENGTH OF WPX          @PGM 00844300
         LA    14,4(15,14)              POINT TO MULTILINE ENTRIES @PGM 00844500
.EMLW00  ANOP                           BEGIN LOOP FOR MINORS      @PGM 00844700
         AIF   (&H GT N'&TEXT(1)).EXECUTE LOOP DONE GO ISSUE WTOR  @PGC 00844900
&VALH    SETC  '&TEXT(1,&H)'            EXTRACT CURRENT VALUE      @PGM 00845100
&VALH1   SETC  '&TEXT(1,&H,1)'          EXTRACT TEXT ADDRESS       @PGM 00845300
&VALH2   SETC  '&TEXT(1,&H,2)'          EXTRACT LINE TYPE          @PGM 00845500
         AIF   ('&VALH2' EQ '').ETEXTL2       LINE TYPE NOT SPEC.  @PGM 00845700
         AIF   (&LTWARN).ETEXTL2        WARNING ALREADY ISSUED     @PGM 00845900
         MNOTE 0,'LINE TYPE ON EXECUTE FORM IGNORED.'              @PGM 00846100
&LTWARN  SETB  1                        ISSUE WARNING ONCE ONLY    @PGM 00846300
.ETEXTL2 ANOP                                                      @PGM 00846500
         AIF   ('&VALH1'  EQ     '').EMLW02 BRANCH IF NULL LINE    @PGM 00846700
         AIF   ('&VALH1'(1,1) EQ '(').EMLW01 BRANCH IF SPECIFIED       +00846900
                                        IN REGISTER                @PGM 00847100
         LA    15,&VALH1                LOAD ADDR OF TEXT FIELD    @PGM 00847300
         ST    15,&MLINDX.(14)          STORE TEXT ADDR INTO PLIST @PGM 00847500
         AGO   .EMLW02                  CONTINUE PROCESSING        @PGM 00847700
.EMLW01  ANOP                           TEXT IN REGISTER           @PGM 00847900
&K       SETA  K'&VALH1                 SET LENGTH OF ARGUMENT     @PGM 00848100
&VALH1   SETC  '&VALH1'(2,&K-2)         STRIP OFF PARENS FROM REG  @PGM 00848300
         ST    &VALH1,&MLINDX.(14)      STORE TEXT ADDRESS         @PGM 00848500
.EMLW02  ANOP                           UPDATE POINTERS            @PGM 00848700
&H       SETA  &H+1                     UPDATE NUMBER OF LINES     @PGM 00848900
&MLINDX  SETA  &MLINDX+8                INDEX TO NEXT PLIST ENTRY  @PGM 00849100
         AGO   .EMLW00                  CONTINUE LOOPING           @PGM 00849300
.********************************************************************** 00849500
.*       NO WPX HAS BEEN BUILT, SO STORE THE REPLY ADDRESS, REPLY  @L1A 00849700
.*       LENGTH, AND ECB ADDRESS IN THE WTOR PREFIX IF THEY ARE    @L1A 00849900
.*       SPECIFIED.                                                @L1A 00850100
.********************************************************************** 00850300
.********************************************************************** 00850500
.*       IF REPLY ADDRESS SPECIFIED, STORE VALUE IN PARAMETER  @G860PSS 00850700
.*       LIST                                                  @G860PSS 00850900
.********************************************************************** 00851100
.OLDFILL AIF   ('&RYAD' EQ '').EECBCK   BR IF NO REPLY ADDR        @L1C 00857500
         AIF   ('&RYAD'(1,1) EQ '(').ERPYREG BR IF REPLY ADDR IN A     X00875000
                                        REG                    @G860PSS 00892500
         LA    15,&RYAD                 LOAD REPLY ADDR        @G860PSS 00910000
         ST    15,0(1,0)                STORE RPLY ADDR        @G860PSS 00927500
         AGO   .EHIGHBT                 GO SET HIGH BIT        @G860PSS 00945000
.********************************************************************** 00962500
.*       REPLY ADDRESS WAS IN A REGISTER                       @G860PSS 01150400
.********************************************************************** 01150600
.ERPYREG ST    &RYAD(1),0(1,0)          STORE REPLY ADDR       @G860PSS 01150800
.********************************************************************** 01151000
.*       SET HIGH BIT IN PARAMETER LIST TO INDICATE A WTOR     @G860PSS 01151200
.********************************************************************** 01151400
.EHIGHBT OI    0(1),X'80'               INDICATE WTOR          @G860PSS 01152100
.********************************************************************** 01152800
.*       IF THE ECB ADDRESS WAS SPECIFIED, PUT IT IN THE       @G860PSS 01152900
.*       PARAMETER LIST                                        @G860PSS 01153000
.********************************************************************** 01153200
.EECBCK  AIF   ('&ECB' EQ '').ELENCK    BR IF NO ECB ADDR      @G860PSS 01153400
         AIF   ('&ECB'(1,1) EQ '(').EECBREG BR IF ECB ADDR IS IN A     X01153600
                                        REG                    @G860PSS 01153800
         LA    14,&ECB                  LOAD ADDRESS OF ECB    @G860PSS 01154000
         ST    14,4(1,0)                STORE ECB ADDRESS      @G860PSS 01154200
         AGO   .ELENCK                  GO CHECK FOR LENGTH    @G860PSS 01154400
.********************************************************************** 01154600
.*       ECB IS IN A REG SO STORE IT IN THE PARAMETER LIST     @G860PSS 01159600
.********************************************************************** 01159800
.EECBREG ST    &ECB(1),4(1,0)           STORE ECB ADDRESS      @G860PSS 01160000
.********************************************************************** 01160200
.*       IF THE LENGTH IS SPECIFIED, COPY IT INTO THE          @G860PSS 01160300
.*       PARAMETER LIST                                        @G860PSS 01160400
.********************************************************************** 01160500
.ELENCK  AIF   ('&LENGTH' EQ '').EQIDCK BR IF NO LENGTH        @G860PSS 01160600
         AIF   ('&LENGTH'(1,1) EQ '(').ELENREG BR IF LENGTH IN A       X01160700
                                        REGISTER               @G860PSS 01160800
         MVI   8(1),&LENGTH             STORE REPLY LENGTH     @G860PSS 01160900
         AGO   .EQIDCK                  GO CHECK THE QID       @G860PSS 01161000
.********************************************************************** 01161100
.*       LENGTH SPECIFIED IN A REGISTER                        @G860PSS 01161200
.********************************************************************** 01161300
.ELENREG STC   &LENGTH(1),8(1,0)        STORE REPLY LENGTH     @G860PSS 01161400
.********************************************************************** 01161500
.*       WAS THE QID SPECIFIED?                                @G860PSS 01161600
.********************************************************************** 01161700
.EQIDCK  ANOP                           QID PROCESSING         @G860PSS 01161800
         AIF   (T'&QID EQ 'O').EXECUTE  BR IF NO QID               @PGC 01161900
         LA    14,8(1,0)                ADDR OF PARM LIST        YM1995 01162000
         SR    15,15                    CLEAR REGISTER         @G860PSS 01162200
         IC    15,9(1,0)                LENGTH OF TEXT + 4     @G860PSS 01162400
         AR    14,15                    ADDR OF BYTE AFTER TEXT        X01162600
                                                               @G860PSS 01162800
         AIF   ('&QID'(1,1) EQ '(').EQIDREG BR IF QID IN REG   @G860PSS 01163000
         MVC   6(2,14),&QID             QID FIELD                X02050 01163600
         AGO   .EXECUTE                 GO ISSUE WTOR              @PGC 01163800
.********************************************************************** 01164000
.*       THE QID IS IN A REGISTER                              @G860PSS 01164200
.********************************************************************** 01164400
.EQIDREG ANOP                                                  @G860PSS 01164600
         MVC   6(2,14),0(&QID(1))       QID FIELD                X02050 01164800
         AGO   .EXECUTE                                            @PGC 01166100
.********************************************************************** 01167400
.*                                                             @G860PSS 01167500
.*       LIST FORM IS REQUESTED                                @G860PSS 01167600
.*                                                             @G860PSS 01167700
.********************************************************************** 01167800
.LROUT   ANOP                                                           01167900
         AIF   ('&MESG' EQ '' AND ('&TEXT' EQ '^' OR                   X01168000
                '&TEXT' EQ '')).ERROR2  ERROR IF                       X01168100
                                      NO MESSAGE TEXT SPECIFIED    @PCC 01168200
         AIF   (&RAREG).ERROR3                  ERROR IF REPLY ADDRESS X01168300
                                      SPECIFIED IN A REGISTER      @L4C 01168400
         AIF   (&EAREG).ERROR3                  ERROR IF REPLY ADDRESS X01168600
                                      SPECIFIED IN A REGISTER      @L4C 01168800
         AIF   (&RLREG).ERROR3                  ERROR IF REPLY ADDRESS X01169000
                                      SPECIFIED IN A REGISTER      @L4C 01169200
&NAME    DS    0F                                                       01169600
.********************************************************************** 01169700
.*                                                                      01169800
.*       INVOKE THE WTO MACRO.  IF THE WTO MACRO DETERMINES        @L1A 01169900
.*       THAT A WPX NEEDS TO BE BUILT, IT WILL GENERATE THE        @L1A 01170000
.*       ENTIRE PARAMETER LIST FOR THE WTOR MACRO AND RETURN.      @L1A 01170100
.*       IN THIS SITUATION, THIS MACRO WILL JUST RETURN SINCE      @L1A 01170200
.*       NO MORE PROCESSING NEEDS TO BE DONE.                      @L1A 01170300
.*                                                                      01170400
.*       IF THE WTO MACRO DETERMINES THAT NO WPX NEEDS TO BE       @L1A 01170500
.*       BUILT, THEN IT WILL NOT GENERATE THE PARAMETER LIST       @L1A 01170600
.*       BUT WILL SET UP THE FIELDS THAT THIS MACRO NEEDS          @L1A 01170700
.*       IN ORDER TO GENERATE THE PARAMETER LIST. IN THIS          @L1A 01170800
.*       SITUATION, WTOR GENERATES THE ENTIRE PARAMETER LIST       @L1A 01170900
.*       STARTING WITH THE WTOR PREFIX.                            @L1A 01171000
.*                                                                      01171100
.********************************************************************** 01171200
&IHBWTOR SETB  1                                                   @L1C 01171300
         WTO   &MESG,MF=&MF,MSGTYP=&MSGTYP,ROUTCDE=&ROUTCDE,DESC=&DESC,X01171400
               MCSFLAG=&MCSFLAG,QID=&QID,WQEBLK=&WQEBLK,CONSID=&CONSID,X01171500
               JOBID=&JOBID,KEY=&KEY,TOKEN=&TOKEN,SYSNAME=&SYSNAME,    X01171600
               JOBNAME=&JOBNAME,                                       X01171700
               CONSNAME=&CONSNAME,CART=&CART,TEXT=&TEXT(1),            +01171800
               LINKAGE=&LINKAGE,SYNCH=&SYNCH                       @01C 01171900
&IHBWTOR SETB  0                                                   @L1C 01172000
         AIF   (&IWPXBIT OR                                            X01172100
                &WTOERR).END          JUST EXIT IF WTO EITHER BUILT A  X01172200
                                      WPX OR ISSUED A SEVERE MNOTE @L1C 01172300
.********************************************************************** 01172400
.*       IF THE REPLY ADDRESS IS NOT SPECIFIED, USE A 0. IF        @P4A 01172500
.*       THE REPLY ADDRESS IS IN A REGISTER, REJECT WITH           @P4A 01172600
.*       ERROR MESSAGE SINCE IT IS NOT ALLOWED FOR THE LIST        @P4A 01172700
.*       FORM                                                      @P4A 01172800
.********************************************************************** 01172900
         AIF   ('&RYAD' EQ '').LRPY0    BR IF NO REPLY ADDR        @P4A 01173000
         DC    A(X'80000000'+&RYAD)     REPLY ADDRESS              @P4A 01173100
         AGO   .LECBCK                  GO CHECK FOR ECB ADDR      @P4A 01173200
.LRPY0   DC    A(0)                     REPLY ADDRESS              @P4A 01173300
.********************************************************************** 01173400
.*       IF THE ECB ADDRESS IS NOT SPECIFIED, USE A 0. IF          @P4A 01173500
.*       THE ECB ADDRESS IS IN A REGISTER, REJECT WITH             @P4A 01173600
.*       ERROR MESSAGE SINCE IT IS NOT ALLOWED FOR THE LIST        @P4A 01173700
.*       FORM                                                           01173800
.********************************************************************** 01173900
.LECBCK  AIF   ('&ECB' EQ '').LECB0     BR IF NO ECB ADDR          @P4A 01174000
         DC    A(&ECB)                  ECB ADDRESS                @P4A 01174100
         AGO   .LLENCK                  GO CHECK FOR LENGTH        @P4A 01174200
.LECB0   DC    A(0)                     ECB ADDRESS                @P4A 01174300
.********************************************************************** 01174400
.*       IF THE LENGTH IS NOT SPECIFIED, USE A 0. IF THE       @G860PSS 01174500
.*       LENGTH IS IN A REGISTER, REJECT WITH ERROR MESSAGE    @G860PSS 01174600
.*       SINCE IT IS NOT ALLOWED FOR THE LIST FORM.            @G860PSS 01174700
.********************************************************************** 01174800
.LLENCK  AIF   ('&LENGTH' EQ '').LLEN0  BR IF NO LENGTH        @G860PSS 01174900
         DC    AL1(&LENGTH)             REPLY LENGTH           @G860PSS 01175000
         AGO   .BUILDIT                 BUILD REST OF PARM LIST    @L1C 01175100
.LLEN0   DC    AL1(0)                   REPLY LENGTH           @G860PSS 01175200
.********************************************************************** 01175300
.*       BUILD THE TEXT LENGTH FIELD                               @L1A 01175400
.********************************************************************** 01175500
.BUILDIT AIF   ('&SYSSPLV' NE '1').ONELEN IF 370, DC FOR 1 BYTE    @L1A 01175700
         DC    AL2(&IHBLEN)             TEXT LENGTH + 4        @YA17152 01175800
         AGO   .GENMCS                  GO BUILD MCS FLAGS         @L1A 01175900
.ONELEN  ANOP                           THIS IS MVS/370            @L1A 01176000
         DC    AL1(&IHBLEN)             TEXT LENGTH + 4        @YA17152 01176100
.********************************************************************** 01176200
.*       BUILD THE MCS FLAGS                                       @L1A 01176300
.********************************************************************** 01176400
.GENMCS  ANOP                                                      @L1A 01176500
         DC    B'&CD(7)&CD(8)'          MCSFLAGS                   @L1A 01176600
         AIF   (&IHBLEN EQ 4).SKIPDC    SKIP DC IF NO TEXT     @YA17152 01176700
.********************************************************************** 01176800
.*       BUILD THE MESSAGE TEXT                                    @L1A 01176900
.********************************************************************** 01177000
         DC    C&ILMEQU                 MESSAGE TEXT               @PBC 01177300
.SKIPDC  AIF   (NOT &IHBMCS).CHECKMF    DONT DECLARE ROUTING/DESC CODE X01177600
                                        IF NONE SPECIFIED      @YA17152 01177700
.********************************************************************** 01177800
.*       BUILD THE DESCRIPTOR CODES                                @L1A 01177900
.********************************************************************** 01178000
         DC    B'&CD(1)&CD(2)'          DESCRIPTOR CODES           @L1A 01178100
.********************************************************************** 01178200
.*       BUILD THE ROUTING CODES                                   @L1A 01178300
.********************************************************************** 01178400
         DC    B'&CD(3)&CD(4)'          ROUTING CODES              @L1A 01178500
         AIF   ('&MSGTYP(1)' NE 'Y' AND NOT &SWM).CHECKMF          @L1A 01178600
.********************************************************************** 01178700
.*       BUILD THE MESSAGE TYPE FIELD                              @L1A 01178800
.********************************************************************** 01178900
         DC    B'&CD(5)&CD(6)'          MESSAGE TYPE               @L1A 01179000
         AIF   (T'&QID EQ 'O' OR '&QID(1)' EQ 'N').CHECKMF         @L1A 01179100
         AIF   (T'&QID EQ 'N').GENDCS1                             @L1A 01179200
         AIF   ('&QID(1)' EQ 'Y').GENDCS0                          @L1A 01179300
         MNOTE 4,'QID FIELD IS INVALID. ZERO ASSUMED.'             @L1A 01179400
.********************************************************************** 01179500
.*       BUILD THE QID FIELD                                       @L1A 01179600
.********************************************************************** 01179700
.GENDCS0 ANOP                           DECLARE QID VALUE OF 0     @L1A 01179800
         DC    AL2(0)                   QID FIELD                  @L1A 01179900
         AGO   .CHECKMF                 CHECK MACRO FORMAT         @L1A 01180000
.GENDCS1 ANOP                           DECLARE QID WITH DATA      @L1A 01180100
         DC    AL2(&QID)                QID FIELD                  @L1A 01180200
.********************************************************************** 01180300
.*       IF AN INLINE REQUEST, CONTINUE GENERATING THE CODE.   @G860PSS 01180400
.********************************************************************** 01180500
.CHECKMF AIF   ('&MF' EQ 'I').IRETURN      IF STANDARD FORM, INSERT    X01180600
                                           ANY REGISTER VALUES     @L1C 01180700
         AGO   .END                        LIST FORM. GO TO END.        01180800
.********************************************************************** 01180900
.*                                                             @G860PSS 01181000
.*       THIS IS AN INLINE REQUEST. THE CNOP AND BAL INSTRUCTIONS  @L1C 01181100
.*       OCCUR FOR ALL WTORS IN THIS MACRO BUT THE DS INSTRUCTION  @L1A 01181200
.*       (AFTER PARAMETER LIST GENERATION) IS DONE HERE ONLY FOR   @L1A 01181300
.*       WTORS WHERE A WPX DOES NOT EXIST AND WQEBLK WAS NOT       @L1A 01181400
.*       SPECIFIED.                                                @L1A 01181500
.*                                                             @G860PSS 01181600
.********************************************************************** 01181700
.IROUT   AIF   ('&WQEBLK' NE '^').WQEB  IF WQEBLK SPECIFIED, LET THE   X01181800
                                        WTO MACRO DO CNOP AND BAL  @P1C 01181900
         AIF   ('&WTORYA' EQ '').ERROR5 ERROR IF NO REPLY ADDRESS  @L4A 01182000
         AIF   ('&WTOECB' EQ '').ERROR6 ERROR IF NO ECB ADDRESS    @L4A 01182100
         AIF   ('&WTOLENR' EQ '').ERROR4 ERROR IF NO REPLY LENGTH      X01182200
                                                               @YA17152 01182300
         CNOP  0,4                                                      01182400
&NAME    BAL   1,&GNAME.A               BRANCH AROUND LIST              01182500
.WQEB    ANOP                           SET UP TO INVOKE WTO MACRO @L1A 01182600
.********************************************************************** 01182700
.*                                                                      01182800
.*       INVOKE THE WTO MACRO.  IF THE WTO MACRO DETERMINES        @L1A 01182900
.*       THAT A WPX NEEDS TO BE BUILT, IT WILL GENERATE THE        @L1A 01183000
.*       ENTIRE PARAMETER LIST, ISSUE THE SVC AND RETURN.          @L1A 01183100
.*       IN THIS SITUATION, THIS MACRO WILL JUST RETURN SINCE      @L1A 01183200
.*       NO MORE PROCESSING NEEDS TO BE DONE.                      @L1A 01183300
.*                                                                      01183400
.*       IF THE WTO MACRO DETERMINES THAT NO WPX NEEDS TO BE       @L1A 01183500
.*       BUILT, THEN IT WILL NOT GENERATE THE PARAMETER LIST       @L1A 01183600
.*       BUT WILL SET UP THE FIELDS THAT THIS MACRO NEEDS IN       @L1A 01183700
.*       ORDER TO GENERATE THE PARAMETER LIST AND ISSUE THE        @L1A 01183800
.*       SVC.  IN THIS SITUATION, WTOR GENERATES THE ENTIRE        @L1A 01183900
.*       PARAMETER LIST STARTING WITH THE WTOR PREFIX.             @L1A 01184000
.*                                                                      01184100
.********************************************************************** 01184200
&IHBWTOR SETB  1                                                   @L1A 01184300
         WTO   &MESG,MF=&MF,MSGTYP=&MSGTYP,ROUTCDE=&ROUTCDE,DESC=&DESC,X01184400
               MCSFLAG=&MCSFLAG,QID=&QID,WQEBLK=&WQEBLK,CONSID=&CONSID,X01184500
               JOBID=&JOBID,KEY=&KEY,TOKEN=&TOKEN,SYSNAME=&SYSNAME,    X01184600
               JOBNAME=&JOBNAME,CONSNAME=&CONSNAME,                    X01184700
               LINKAGE=&LINKAGE,SYNCH=&SYNCH,                          +01184800
               CART=&CART,TEXT=&TEXT(1)                            @01C 01184900
&IHBWTOR SETB  0                                                   @L1A 01185000
         AIF   (&IWPXBIT OR &IWQEBIT OR &WTOERR).END  JUST EXIT IF     X01185100
                                        WQEBLK CALL, OR WTO WITH WPX,  X01185200
                                        OR IF SEVERE ERROR FOUND   @P2C 01185300
.********************************************************************** 01185400
.*       CHECK THE REPLY ADDRESS TO SEE IF IT IS SPECIFIED         @P4A 01185500
.*       AND IF IT IS IN A REGISTER                                @P4A 01185600
.********************************************************************** 01185700
         AIF   ('&RYAD'(1,1) EQ '(').IRPA0 BR IF REG SPECIFIED     @P4A 01185800
         DC    A(X'80000000'+&RYAD)     REPLY ADDRESS              @P4A 01185900
         AGO   .IECBCKA                 GO CHECK FOR ECB           @P4A 01186000
.IRPA0   DC    A(0)                     REPLY ADDRESS              @P4A 01186100
.********************************************************************** 01186200
.*       CHECK THE ECB ADDRESS TO SEE IF IT IS SPECIFIED           @P4A 01186300
.*       AND IF IT IS IN A REGISTER                                @P4A 01186400
.********************************************************************** 01186500
.IECBCKA AIF   ('&ECB'(1,1) EQ '(').IECB0  BR IF REG SPECIFIED     @P4A 01186600
         DC    A(&ECB)                  ECB ADDRESS                @P4A 01186700
         AGO   .ILENCKA                 GO CHECK FOR LENGTH        @P4A 01186800
.IECB0   DC    A(0)                     REPLY ADDRESS              @P4A 01186900
.********************************************************************** 01187000
.*       CHECK THE LENGTH TO SEE IF IT IS SPECIFIED AND IF     @G860PSS 01187100
.*       IT IS IN A REGISTER                                   @G860PSS 01187200
.********************************************************************** 01187300
.ILENCKA AIF   ('&LENGTH'(1,1) EQ '(').ILEN0 BR IF LEN IN REG      @P3C 01187400
         DC    AL1(&LENGTH)             REPLY LENGTH           @G860PSS 01187500
         AGO   .BUILDIT                 BUILD REST OF PARM LIST    @L1A 01187600
.ILEN0   DC    AL1(0)                   REPLY LENGTH           @G860PSS 01187700
.********************************************************************** 01187800
.*       GO BUILD THE REST OF THE PARAMETER LIST                   @L1C 01187900
.********************************************************************** 01188000
         AGO   .BUILDIT                 BUILD REST OF PARM LIST    @L1A 01188100
.********************************************************************** 01188200
.*                                                             @G860PSS 01188300
.*       CONTROL IS RETURNED HERE AFTER THE PARAMETER LIST     @G860PSS 01188400
.*       IS BUILT FOR THE INLINE EXPANSION                     @G860PSS 01188500
.*                                                             @G860PSS 01188600
.********************************************************************** 01188700
.IRETURN ANOP                                                           01188800
.*  THE FOLLOWING INSTRUCTION IS EXECUTED HERE ONLY IF A WPX       @L1A 01188900
.*  DOES NOT EXIST AND WQEBLK WAS NOT SPECIFIED. WHEN A WPX        @L1A 01189000
.*  EXISTS, THE WTO MACRO DOES THIS.                               @L1A 01189100
&GNAME.A DS    0H                                                       01189200
.********************************************************************** 01189300
.*       IF THE REPLY ADDRESS IS IN A REGISTER, STORE IT IN    @G860PSS 01189400
.*       THE PARAMETER LIST                                    @G860PSS 01189500
.********************************************************************** 01189600
         AIF   ('&RYAD'(1,1) NE '(').IECBCKB BR IF NOT IN REG      @P3C 01189700
         ST    &RYAD(1),0(1,0)          STORE REPLY ADDRESS    @G860PSS 01189800
         OI    0(1),X'80'               INDICATE WTOR              @P3C 01189900
.********************************************************************** 01190200
.*       IF ECB ADDRESS IS IN A REGISTER, SAVE ITS ADDRESS IN  @G860PSS 01191000
.*       THE PARAMETER LIST                                    @G860PSS 01191200
.********************************************************************** 01191400
.IECBCKB AIF   ('&ECB'(1,1) NE '(').ILENCKB BR IF NOT IN REG       @P3C 01191500
         ST    &ECB(1),4(1,0)           STORE ECB ADDRESS      @G860PSS 01191600
.********************************************************************** 01191700
.*       IF THE LENGTH IS IN A REGISTER, SAVE ITS ADDRESS IN   @G860PSS 01191800
.*       THE PARAMETER LIST                                    @G860PSS 01191900
.********************************************************************** 01192000
.ILENCKB AIF   ('&LENGTH'(1,1) NE '(').EXECUTE  BR IF NOT IN REG   @L5C 01192100
         STC   &LENGTH(1),8(1,0)        STORE REPLY LENGTH     @G860PSS 01192200
.EXECUTE ANOP                           ISSUE WTOR SVC             @L5C 01192500
         AIF   ('&LINKAGE(1)' EQ 'BRANCH').WTOBALR                 @L5A 01192800
         SVC   35                       ISSUE SVC 35               @L5A 01193100
         AGO   .END                                                @L5A 01193400
.WTOBALR ANOP                           LINKAGE=BRANCH INVOCATION  @L5A 01193700
         L     15,16(0,0)               ADDRESS OF CVT             @L5A 01194000
         L     15,200(0,15)             ADDRESS OF SCVT            @L5A 01194300
         L     15,20(0,15)              WTOR BRANCH ENTRY POINT    @L5A 01194600
         BALR  14,15                    BRANCH TO ENTRY POINT WTOR @L5A 01194900
         AGO   .END                                            @G860PSS 01195200
.********************************************************************** 01195500
.*                                                             @G860PSS 01195800
.*       ERROR MESSAGES                                        @G860PSS 01196100
.*                                                             @G860PSS 01196400
.********************************************************************** 01196700
.********************************************************************** 01197000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 01197300
.* 12,INVALID MF OPERAND SPECIFIED-MF                          @G860PSS 01197600
.********************************************************************** 01197900
.ERROR1  IHBERMAC 35,,&MF                                               01200002
         MEXIT                                                          01250002
.********************************************************************** 01260000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 01270000
.* 12,MESSAGE OPERAND REQ'D-NOT SPECIFIED                      @G860PSS 01280000
.********************************************************************** 01290000
.ERROR2  IHBERMAC 19                                                    01300002
         MEXIT                                                          01350002
.********************************************************************** 01360000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 01370000
.* 12,INVALID REGISTER NOTATION WITH MF=L FORM                 @G860PSS 01380000
.********************************************************************** 01390000
.ERROR3  IHBERMAC 69                                                    01400002
         MEXIT                                                          01450002
.********************************************************************** 01460000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 01470000
.* 12,LENGTH OPERAND REQ'D-NOT SPECIFIED                       @G860PSS 01480000
.********************************************************************** 01490000
.ERROR4  IHBERMAC 14                                                    01500002
         MEXIT                                                          01550002
.********************************************************************** 01560000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 01570000
.* 12,SECOND OPERAND REQ'D-NOT SPECIFIED                       @G860PSS 01580000
.********************************************************************** 01590000
.ERROR5  IHBERMAC 03                                                    01600002
         MEXIT                                                          01650002
.********************************************************************** 01660000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 01670000
.* 12,ECB OPERAND REQ'D-NOT SPECIFIED                          @G860PSS 01680000
.********************************************************************** 01690000
.ERROR6  IHBERMAC 11                                                    01700002
         MEXIT                                                          01750002
.********************************************************************** 01760000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 01770000
.* 12,MLWTO/WTOR MUTUALLY EXCLUSIVE--GENERATION TERMINATED     @G860PSS 01780000
.********************************************************************** 01790000
.ERROR7  IHBERMAC 246                                                   01800002
         MEXIT                                                          01850002
.ERROR8  ANOP                                                      @L1A 01900000
         MNOTE 12,'NO TEXT GENERATED. ''WQEBLK'' IS MUTUALLY EXCLUSIVE X01950000
               WITH ALL OTHER KEYWORDS.'                           @L1A 02000000
         MEXIT                                                     @L1A 02050000
.ERROR9  ANOP                                                      @L2A 02100000
         MNOTE 12,'NO TEXT GENERATED. ''CONSID'' IS MUTUALLY EXCLUSIVE X02150000
               WITH CONSNAME KEYWORD.'                             @L2A 02200000
         MEXIT                                                     @L2A 02250000
.ERROR10 ANOP                                                      @L5A 02251700
         MNOTE 12,'NO TEXT GENERATED. SPECIFIED LINKAGE VALUE WAS NOT  +02253400
               SVC OR BRANCH.'                                     @L5A 02255100
         MEXIT                                                     @L5A 02256800
.ERROR12 ANOP                                                      @L5A 02258500
         MNOTE 12,'NO TEXT GENERATED. SPECIFIED SYNCH VALUE WAS NOT    +02260200
               YES OR NO.'                                         @L5A 02261900
         MEXIT                                                     @L5A 02263600
.ERROR13 ANOP                                                      @L5A 02265300
         MNOTE 12,'NO TEXT GENERATED. ''SYNCH=YES'' IS MUTUALLY        +02267000
               EXCLUSIVE WITH THE WQEBLK KEYWORD.'                 @L5A 02268700
         MEXIT                                                     @L5A 02270400
.ERROR14 ANOP                                                      @L5A 02272100
         MNOTE 12,'NO TEXT GENERATED. ''SYNCH=YES'' IS MUTUALLY        +02273800
               EXCLUSIVE WITH ''MCSFLAG=HRDCPY''.'                 @L5A 02275500
         MEXIT                                                     @L5A 02277200
.ERROR15 ANOP                                                      @L5A 02278900
         MNOTE 12,'NO TEXT GENERATED. ''SYNCH=YES'' REQUIRES           +02280600
               ''LINKAGE=BRANCH''.'                                @L5A 02282300
         MEXIT                                                     @L5A 02284000
.ERROR16 ANOP                                                      @L5A 02285700
         MNOTE 12,'NO TEXT GENERATED. ''LINKAGE=BRANCH'' REQUIRES      +02287400
               ''SYNCH=YES''.'                                     @L5A 02289100
         MEXIT                                                     @L5A 02290800
.ERROR17 ANOP                                                      @L5A 02292500
         MNOTE 12,'TOO MANY LINES OF TEXT. MAX=&MAXLINS WHEN SYNCH=YES'+02294200
                                                                   @L5A 02295900
         MEXIT                                                     @L5A 02297600
.END     MEND                                                      @L2A 02300000
**/                                                                     06200002
*%WTOR: MACRO KEYS(                                                     06600000
*                   ROUTCDE,      /*ROUTING CODES FOR MESSAGE        */ 06700002
*                   DESC,         /*MESSAGE DESCRIPTOR CODES         */ 06800002
*                   MSGTYP,       /*ROUTE TO MESSAGE CONSOLES        */ 06900002
*                   MCSFLAG,      /*MESSAGE ATTRIBUTES               */ 07000002
*                   RTCD,         /*SVC RETURN CODE                  */ 07100002
*                   WQEBLK,       /*ADDRESS OF WQE               @L1C*/ 07112500
*                   CONSID,       /*4 BYTE CONSOLE ID TO GET MSG @L1C*/ 07125000
*                   CONSNAME,     /*NAME OF CONSOLE TO GET MSG   @L2A*/ 07129100
*                   RPLYISUR,     /*CONSOLE NAME/ID FOR MESSAGE  @L3A*/ 07133200
*                   JOBID,        /*JOB ID OF ISSUER FOR JES     @L1C*/ 07137500
*                   JOBNAME,      /*JOB NAME OF ISSUER FOR JES   @L1C*/ 07143700
*                   KEY,          /*KEY ASSOCIATED WITH MSG      @L1C*/ 07150000
*                   TOKEN,        /*TOKEN ASSOCIATED WITH MSG    @L1C*/ 07162500
*                   SYSNAME,      /*SYSTEM NAME OF ISSUER        @L1C*/ 07175000
*                   CART,         /*CART ADDRESS                 @L3A*/ 07187400
*                   TEXT,         /*MESSAGE TEXT ADDRESS         @L4A*/ 07193600
*                   LINKAGE,      /*HOW CONTROL IS PASSED        @L5A*/ 07195200
*                   SYNCH,        /*SYNCHRONOUSLY PROCESSED      @L5A*/ 07196800
*                   CPFLG,        /*CONTROL PROGRAM ONLY FLAGS   @D2A*/ 07198400
*                   MF            /*LIST FORMAT                      */ 07200002
*                          );                                           07300002
* DECLARE SYSSPLV CHARACTER EXTERNAL; /* LEVEL INDICATOR     @G860PSS*/ 07304200
*                                                                       07308400
*/********************************************************************/ 07312600
*/*     DETERMINE WHICH FORMAT OF THE PARAMETER LIST SHOULD  @G860PSS*/ 07316800
*/*     BE BUILT.                                            @G860PSS*/ 07321000
*/********************************************************************/ 07325200
*    ANS('? SPLEVEL (TEST);');  /* DETERMINE LEVEL           @G860PSS*/ 07329400
*    IF SYSSPLV = '1' THEN      /* BUILD MVS/370 FORMAT          @L1C*/ 07334600
*       ANS('?'||MACLABEL||'WTORP7 '||MACLIST||MACKEYS||';');           07339800
*    ELSE                       /* BUILD MVS/XA FORMAT           @L1C*/ 07345000
*       ANS('?'||MACLABEL||'WTORP '||MACLIST||MACKEYS||';'); /*         07350400
*                                                            @G860PSS*/ 07354600
*%END WTOR;                                                             07360002
