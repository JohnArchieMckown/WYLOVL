*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IOSCAPU                               -12/11/00-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  UCB Capture/Uncapture/Translation             * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5655-068 (C) COPYRIGHT IBM CORP. 1994                           * 00001200
*                                                                     * 00001300
* STATUS= HBB5520                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IOSCAPU service should be used by programs that pass UCB   * 00002100
*      addresses or themselves get passed UCB addresses, and need to  * 00002200
*      use 24 bit addresses when accessing the UCB.  The Actual UCB   * 00002300
*      (which may be a 31 bit address) can be captured by invoking    * 00002400
*      the function CAPTUCB. For an above the 16Mb line Actual UCB,   * 00002500
*      this function will create and pass back the address of a       * 00002600
*      Captured UCB (a 24 bit address) that is located below the 16Mb * 00002700
*      line in the PRIVATE area of the current address space, or if   * 00002800
*      CAPTCOM is specified, into COMMON storage.  Actual UCBs        * 00002900
*      captured with this service will need to be explicitly          * 00003000
*      uncaptured by using the UCAPTUCB function. If a program has a  * 00003100
*      Captured UCB, it can use the function CAPTOACT to get the      * 00003200
*      above the 16Mb line Actual UCB address.                        * 00003300
*                                                                     * 00003400
*      The IOSCAPU service provides the following functions:          * 00003500
*                                                                     * 00003600
*                                                                     * 00003700
*      o   CAPTUCB  - The specified Actual UCB will be Captured into  * 00003800
*          the private area of the current address space or if        * 00003900
*          CAPTCOM is specified into COMMON storage, and the Captured * 00004000
*          UCB address returned.  If the UCB already Captured in the  * 00004100
*          current address space or in COMMON storage, that Captured  * 00004200
*          address will be returned. The caller is expected to use    * 00004300
*          the Uncapture function when the Captured UCB is no longer  * 00004400
*          needed.  If the UCB address passed as input is a below the * 00004500
*          16Mb line Actual UCB address, the service will return this * 00004600
*          UCB address as output and issue a warning return code.     * 00004700
*                                                                     * 00004800
*      o   UCAPTUCB - The specified Captured UCB will be uncaptured.  * 00004900
*          If a below the 16Mb line Actual UCB address is passed, no  * 00005000
*          UCB is Uncaptured and this function will return a warning  * 00005100
*          return code If an above 16Mb Actual UCB address is passed, * 00005200
*          no UCB is Uncaptured and this function will return a       * 00005300
*          failing return code.                                       * 00005400
*                                                                     * 00005500
*      o   CAPTOACT - Given a Captured UCB address, this function     * 00005600
*          will return the 31 bit above the 16Mb line Actual UCB      * 00005700
*          address.  If an Actual UCB address is passed as input,     * 00005800
*          this service will return a warning and pass that address   * 00005900
*          as output.  The ASID parameter may optionally be used to   * 00006000
*          allow translation to be performed for a Captured UCB in    * 00006100
*          another address space.                                     * 00006200
*                                                                     * 00006300
*                                                                     * 00006400
*                                                                     * 00006500
*      The LINKAGE=BRANCH option is intended for performance          * 00006600
*      sensitive invokers or programs which require this function     * 00006700
*      during NIP before a PC can be issued.                          * 00006800
*                                                                     * 00006900
*      The PC entry point is specified via LINKAGE(SYSTEM).           * 00007000
*                                                                     * 00007100
*      The entry via PC or Branch will perform full validation of     * 00007200
*      storage areas and parameters.  For example, a PC entered       * 00007300
*      caller can pass the parameter list in a non-zero key and the   * 00007400
*      service will only reference that storage in the caller's key.  * 00007500
*      Use of this feature will allow the caller to protect against   * 00007600
*      accidental corruption of a system storage area as a result of  * 00007700
*      a programming bug.  Both entry points will also provide        * 00007800
*      additional diagnostic information to aid in debugging these    * 00007900
*      problems.                                                      * 00008000
*                                                                     * 00008100
*01* EXTERNAL CLASSIFICATION:                                         * 00008200
*                                                                     * 00008300
*02* GUPI: BASE                                                       * 00008400
*                                                                     * 00008500
*02* NONE: FIELDS                                                     * 00008600
*          MSIFREE                                                    * 00008700
*                                                                     * 00008800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00008900
*                                                                     * 00009000
*01* ENVIRONMENT:                                                     * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*      Dispatchable unit mode: Task or SRB mode.                      * 00009400
*                                                                     * 00009500
*      Cross Memory Mode:                                             * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*                        o   The functions CAPTUCB and UCAPTUCB will  * 00009900
*                            only allow primary = home = secondary    * 00010000
*                            address space.                           * 00010100
*                                                                     * 00010200
*                        o   The function CAPTOACT will allow primary * 00010300
*                            ^= home ^= secondary address space.      * 00010400
*                                                                     * 00010500
*                                                                     * 00010600
*                                                                     * 00010700
*      Minimum authorization:                                         * 00010800
*                                                                     * 00010900
*                                                                     * 00011000
*                        CAPTUCB                                      * 00011100
*                            Supervisor state, or problem state and   * 00011200
*                            PKM 0-7.                                 * 00011300
*                                                                     * 00011400
*                        UCAPTUCB                                     * 00011500
*                            Supervisor state, or problem state and   * 00011600
*                            PKM 0-7.                                 * 00011700
*                                                                     * 00011800
*                        CAPTOACT                                     * 00011900
*                            Supervisor state, or problem state and   * 00012000
*                            PKM 0-7 if ASID is specified. If ASID is * 00012100
*                            not specified, then Supervisor state, or * 00012200
*                            problem state.                           * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*      AMODE:            24- or 31-bit.                               * 00012700
*                                                                     * 00012800
*      ASC mode:         Primary or Access Register.                  * 00012900
*                                                                     * 00013000
*      Interrupt status:                                              * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*                        CAPTUCB CAPTCOM=NO                           * 00013400
*                            Enabled.                                 * 00013500
*                                                                     * 00013600
*                        CAPTUCB CAPTCOM=YES                          * 00013700
*                            Enabled or Disabled.                     * 00013800
*                                                                     * 00013900
*                        CAPTUCB CAPTCOM=NEVER                        * 00014000
*                            Enabled.                                 * 00014100
*                                                                     * 00014200
*                        UCAPTUCB CAPTCOM=NO                          * 00014300
*                            Enabled.                                 * 00014400
*                                                                     * 00014500
*                        UCAPTUCB CAPTCOM=YES                         * 00014600
*                            Enabled or Disabled.                     * 00014700
*                                                                     * 00014800
*                        CAPTOACT                                     * 00014900
*                            Enabled or Disabled.                     * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*      Locks:                                                         * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*                        CAPTUCB  CAPTCOM=NO                          * 00015700
*                            Unlocked.                                * 00015800
*                                                                     * 00015900
*                        CAPTUCB  CAPTCOM=YES                         * 00016000
*                            The invoker must not hold any lock which * 00016100
*                            would prevent the IOSULUT lock from      * 00016200
*                            being obtained shared.                   * 00016300
*                                                                     * 00016400
*                        CAPTUCB  CAPTCOM=NEVER                       * 00016500
*                            Unlocked                                 * 00016600
*                                                                     * 00016700
*                            NOTES:                                   * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                o   When invoking the CAPTUCB        * 00017200
*                                    CAPTCOM=YES function the IOSULUT * 00017300
*                                    lock cannot be held EXCLUSIVELY. * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*                        UCAPTUCB CAPTCOM=NO                          * 00018000
*                            Unlocked.                                * 00018100
*                                                                     * 00018200
*                        UCAPTUCB CAPTCOM=YES                         * 00018300
*                            The invoker must not hold any lock which * 00018400
*                            would prevent the IOSULUT lock from      * 00018500
*                            being obtained shared.                   * 00018600
*                                                                     * 00018700
*                            NOTES:                                   * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                o   When invoking the UCAPTUCB       * 00019200
*                                    CAPTCOM=YES function the IOSULUT * 00019300
*                                    lock cannot be held EXCLUSIVELY. * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*                        CAPTOACT                                     * 00020000
*                            The invoker must not hold any lock       * 00020100
*                            higher than the IOSULUT lock.            * 00020200
*                                                                     * 00020300
*                            NOTES:                                   * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                o   When invoking the CAPTOACT       * 00020800
*                                    function the IOSULUT lock cannot * 00020900
*                                    be held EXCLUSIVELY.             * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*      Restrictions:                                                  * 00021800
*                                                                     * 00021900
*                        The caller's storage must be in FIXED or     * 00022000
*                        DREF storage if the caller is disabled.      * 00022100
*                                                                     * 00022200
*                        The caller must make sure that the UCB is    * 00022300
*                        not dynamically deleted.                     * 00022400
*                                                                     * 00022500
*                        The LINKAGE=BRANCH option is limited to      * 00022600
*                        callers which meet the following criteria:   * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                        o   supervisor state key 0                   * 00023000
*                                                                     * 00023100
*                        o   the parameter list must reside in fixed  * 00023200
*                            or DREF storage when the translate       * 00023300
*                            function is being performed and the      * 00023400
*                            caller is disabled.                      * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*01* INPUT REGISTER INFORMATION:                                      * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*    REGISTER  CONTENTS                                               * 00024400
*                                                                     * 00024500
*    GR0-GR15  Undefined                                              * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*    Before issuing the IOSCAPU the caller does not have to place any * 00025000
*    information into any AR.                                         * 00025100
*                                                                     * 00025200
*01* OUTPUT REGISTER INFORMATION:                                     * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*    REGISTER  CONTENTS                                               * 00025600
*                                                                     * 00025700
*    GR0       Reason code                                            * 00025800
*                                                                     * 00025900
*    GR1       Used by service                                        * 00026000
*                                                                     * 00026100
*    GR2-GR13  Unchanged                                              * 00026200
*                                                                     * 00026300
*    GR14      Used by service                                        * 00026400
*                                                                     * 00026500
*    GR15      Return code                                            * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*    When control returns to the caller, the ARs will contain what    * 00027000
*    they had at entry.                                               * 00027100
*                                                                     * 00027200
*01* SYNTAX:                                                          * 00027300
*                                                                     * 00027400
*[xlabel]  IOSCAPU    CAPTUCB                                        * 00027500
*                   |     ,UCBPTR=xucbptr                             * 00027600
*                   |     ,CAPTPTR=xcaptptr                           * 00027700
*                   |    [,MSIFREE=NO|YES]                          * 00027800
*                   |    [,LASTING=NO|YES]                          * 00027900
*                   |    [,CAPTCOM=NO|YES|NEVER]                    * 00028000
*                    ,UCAPTUCB                                       * 00028100
*                   |     ,CAPTPTR=xcaptptr                           * 00028200
*                   |    [,LASTING=NO|YES]                          * 00028300
*                   |    [,CAPTCOM=NO|YES]                          * 00028400
*                    ,CAPTOACT                                       * 00028500
*                         ,CAPTPTR=xcaptptr                           * 00028600
*                         ,UCBPTR=xucbptr                             * 00028700
*                        [,ASID=xasid|CURRENT]                      * 00028800
*                    [,LINKAGE=SYSTEM|BRANCH]                       * 00028900
*                    [,RETCODE=xretcode]                              * 00029000
*                    [,RSNCODE=xrsncode]                              * 00029100
*                    [,PLISTVER=xplistver|IMPLIED_VERSION]          * 00029200
*                   [,MF=S]                                          * 00029300
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 00029400
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*      Where:                                                         * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*      [xlabel]                                                       * 00030100
*          is an optional symbol, starting in column 1, that is the   * 00030200
*          name on the IOSCAPU macro invocation.  The name must       * 00030300
*          conform to the rules for an ordinary assembler language    * 00030400
*          symbol.                                                    * 00030500
*          DEFAULT: No name.                                          * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*      The following is a set of mutually exclusive keys.  This set   * 00031100
*      is required; only one key must be specified.                   * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*      CAPTUCB                                                        * 00031500
*          Create a Captured UCB in the current address space, and    * 00031600
*          return its address.                                        * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*          UCBPTR=xucbptr                                             * 00032000
*              is the name (RS-type), or address in register          * 00032100
*              (2)-(12), of a required 4 byte input that contains the * 00032200
*              address of the common segment of the Actual UCB to be  * 00032300
*              captured.                                              * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*          CAPTPTR=xcaptptr                                           * 00032900
*              is the name (RS-type), or address in register          * 00033000
*              (2)-(12), of a required 4 byte output that will        * 00033100
*              contain the address of the common segment of the       * 00033200
*              Captured UCB.                                          * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*          [MSIFREE=NO|YES]                                         * 00033800
*              is an optional keyword input that indicates that the   * 00033900
*              captured UCB should be uncaptured during Master        * 00034000
*              Scheduler Initialization.                              * 00034100
*                                                                     * 00034200
*              NOTES:                                                 * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                  o   This keyword is for IBM use only. Users of     * 00034700
*                      this keyword must be NIP callers. It enables   * 00034800
*                      NIP callers to indicate to IOS that the        * 00034900
*                      Captured UCB should be uncaptured during MSI.  * 00035000
*                                                                     * 00035100
*                  o   This keyword if used after NIP processing will * 00035200
*                      generate a return code and reason code. See    * 00035300
*                      the return code section for further            * 00035400
*                      information.                                   * 00035500
*                                                                     * 00035600
*                  o   MSIFREE is mutually exclusive with CAPTCOM and * 00035700
*                      LASTING.                                       * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*              DEFAULT: NO                                            * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*              MSIFREE=NO                                             * 00036600
*                  Do not uncapture the UCB during MSI.               * 00036700
*                                                                     * 00036800
*              MSIFREE=YES                                            * 00036900
*                  Uncapture the UCB during MSI.                      * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*          [LASTING=NO|YES]                                         * 00037700
*              is an optional keyword input that indicates that the   * 00037800
*              captured UCB should not be uncaptured automatically    * 00037900
*              during end of task termination.                        * 00038000
*                                                                     * 00038100
*              NOTES:                                                 * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                  o   The LASTING keyword will have no effect when   * 00038600
*                      capturing is being done on behalf of a caller  * 00038700
*                      in SRB mode.                                   * 00038800
*                                                                     * 00038900
*                  o   Cleanup will not be performed on behalf of     * 00039000
*                      callers in SRB mode that do not uncapture      * 00039100
*                      prior to terminating.                          * 00039200
*                                                                     * 00039300
*                  o   LASTING is mutually exclusive with MSIFREE and * 00039400
*                      CAPTCOM.                                       * 00039500
*                                                                     * 00039600
*                  o   If, and only if, LASTING=YES is specified when * 00039700
*                      capturing a UCB, LASTING=YES should be         * 00039800
*                      specified when releasing the same captured     * 00039900
*                      UCB.                                           * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*              DEFAULT: NO                                            * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*              LASTING=NO                                             * 00040800
*                  Free Captured resources during end of jobstep task * 00040900
*                  termination.  This option will ensure that a given * 00041000
*                  task uncaptures a given page as many times as it   * 00041100
*                  captured that page, regardless of the specific     * 00041200
*                  UCBs on that page involved.  If this is not the    * 00041300
*                  case, IOS will perform the necessary uncaptures to * 00041400
*                  reduce the outstanding page captures of the task   * 00041500
*                  to zero.                                           * 00041600
*                                                                     * 00041700
*              LASTING=YES                                            * 00041800
*                  Do not free Capture resources during jobstep task  * 00041900
*                  termination.                                       * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*          [CAPTCOM=NO|YES|NEVER]                                   * 00042700
*              is an optional keyword input that indicates that the   * 00042800
*              Actual UCB above the 16Mb line should be captured into * 00042900
*              COMMON storage.                                        * 00043000
*                                                                     * 00043100
*              NOTES:                                                 * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                  o   If the Actual UCB above the 16Mb line was      * 00043600
*                      already captured into COMMON storage, this     * 00043700
*                      address will be passed back to the caller.     * 00043800
*                      This will occur even if the default CAPTCOM=NO * 00043900
*                      is specified. CAPTCOM=NEVER could be specified * 00044000
*                      to capture to private unconditionally.         * 00044100
*                                                                     * 00044200
*                  o   When CAPTCOM=YES is specified, its processing  * 00044300
*                      will be analagous to LASTING=YES.              * 00044400
*                                                                     * 00044500
*                  o   CAPTCOM is mutually exclusive with MSIFREE and * 00044600
*                      LASTING.                                       * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*              DEFAULT: NO                                            * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*              CAPTCOM=NO                                             * 00045500
*                  The Capturing of the Actual UCB above the 16Mb     * 00045600
*                  line will occur into PRIVATE storage of the        * 00045700
*                  current address space.                             * 00045800
*                                                                     * 00045900
*              CAPTCOM=YES                                            * 00046000
*                  The capturing of the Actual UCB above the 16Mb     * 00046100
*                  line will occur into COMMON storage.               * 00046200
*                                                                     * 00046300
*              CAPTCOM=NEVER                                          * 00046400
*                  The capturing of the Actual UCB above the 16Mb     * 00046500
*                  line will occur into PRIVATE storage               * 00046600
*                  unconditionally.                                   * 00046700
*                                                                     * 00046800
*                  NOTES:                                             * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*                                                                     * 00047200
*                      o   Since there are reasons why a CAPTCOM=NO   * 00047300
*                          request may still cause a UCB to be        * 00047400
*                          captured to common (i.e., If the UCB is    * 00047500
*                          already captured in common), this keyword  * 00047600
*                          can be used to force IOS to capture the    * 00047700
*                          UCB to private storage.                    * 00047800
*                                                                     * 00047900
*                      o   Specifying CAPTCOM=NEVER may cause         * 00048000
*                          duplicate UCB storage to be allocated in   * 00048100
*                          the case where the UCB is already captured * 00048200
*                          to common.                                 * 00048300
*                                                                     * 00048400
*                      o   Since captures done in MASTERS address     * 00048500
*                          space will always be captured to common    * 00048600
*                          storage, the CAPTCOM=NEVER specification   * 00048700
*                          will be ignored in this case.              * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*                                                                     * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*      UCAPTUCB                                                       * 00049800
*          Uncapture the UCB in the current address space.            * 00049900
*                                                                     * 00050000
*                                                                     * 00050100
*          CAPTPTR=xcaptptr                                           * 00050200
*              is the name (RS-type), or address in register          * 00050300
*              (2)-(12), of a required 4 byte input that contains the * 00050400
*              address of the common segment of the Captured UCB to   * 00050500
*              be uncaptured.                                         * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*                                                                     * 00051000
*          [LASTING=NO|YES]                                         * 00051100
*              is an optional keyword input input that indicates      * 00051200
*              whether or not this UCAPTUCB is being issued to        * 00051300
*              un-capture a UCB that was previously captured using    * 00051400
*              CAPTUCB with LASTING=YES.                              * 00051500
*                                                                     * 00051600
*              NOTES:                                                 * 00051700
*                                                                     * 00051800
*                                                                     * 00051900
*                                                                     * 00052000
*                  o   The LASTING keyword will have no effect when   * 00052100
*                      capturing is being done on behalf of a caller  * 00052200
*                      in SRB mode.                                   * 00052300
*                                                                     * 00052400
*                  o   Cleanup will not be performed on behalf of     * 00052500
*                      callers in SRB mode that do not uncapture      * 00052600
*                      prior to terminating.                          * 00052700
*                                                                     * 00052800
*                  o   LASTING is mutually exclusive with CAPTCOM.    * 00052900
*                                                                     * 00053000
*                  o   If, and only if, LASTING=YES is specified when * 00053100
*                      capturing a UCB, LASTING=YES should be         * 00053200
*                      specified when releasing the same captured     * 00053300
*                      UCB.                                           * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*              DEFAULT: NO                                            * 00053900
*                                                                     * 00054000
*                                                                     * 00054100
*              LASTING=NO                                             * 00054200
*                  This is NOT a UCAPTUCB associated with a previous  * 00054300
*                  CAPTUCB (where LASTING=YES was specified).         * 00054400
*                                                                     * 00054500
*              LASTING=YES                                            * 00054600
*                  This IS a UCAPTUCB associated with a previous      * 00054700
*                  CAPTUCB (where LASTING=YES was specified).         * 00054800
*                                                                     * 00054900
*                                                                     * 00055000
*                                                                     * 00055100
*                                                                     * 00055200
*                                                                     * 00055300
*                                                                     * 00055400
*          [CAPTCOM=NO|YES]                                         * 00055500
*              is an optional keyword input that indicates that the   * 00055600
*              Captured UCB should be uncaptured from COMMON storage. * 00055700
*              DEFAULT: NO                                            * 00055800
*                                                                     * 00055900
*                                                                     * 00056000
*              CAPTCOM=NO                                             * 00056100
*                  The captured UCB will be uncaptured from common    * 00056200
*                  storage when it is a common captured UCB.  The     * 00056300
*                  captured UCB will be uncaptured from private       * 00056400
*                  storage when it is a private captured UCB.         * 00056500
*                                                                     * 00056600
*              CAPTCOM=YES                                            * 00056700
*                  The captured UCB will be uncaptured from common    * 00056800
*                  storage.                                           * 00056900
*                                                                     * 00057000
*                                                                     * 00057100
*                                                                     * 00057200
*                                                                     * 00057300
*                                                                     * 00057400
*      CAPTOACT                                                       * 00057500
*          translate the address of the Captured UCB to the address   * 00057600
*          of the Actual UCB.                                         * 00057700
*                                                                     * 00057800
*          NOTES:                                                     * 00057900
*                                                                     * 00058000
*                                                                     * 00058100
*                                                                     * 00058200
*              o   This function will allow the caller to be in cross * 00058300
*                  memory mode.                                       * 00058400
*                                                                     * 00058500
*              o   The caller and the parameter list must be          * 00058600
*                  executing and getmained respectively in the        * 00058700
*                  primary address space.                             * 00058800
*                                                                     * 00058900
*                                                                     * 00059000
*                                                                     * 00059100
*                                                                     * 00059200
*                                                                     * 00059300
*                                                                     * 00059400
*          CAPTPTR=xcaptptr                                           * 00059500
*              is the name (RS-type), or address in register          * 00059600
*              (2)-(12), of a required 4 byte input that contains the * 00059700
*              address of the common segment of the Captured UCB.     * 00059800
*                                                                     * 00059900
*                                                                     * 00060000
*                                                                     * 00060100
*                                                                     * 00060200
*          UCBPTR=xucbptr                                             * 00060300
*              is the name (RS-type), or address in register          * 00060400
*              (2)-(12), of a required 4 byte output that will        * 00060500
*              contain the address of the Actual UCB (common          * 00060600
*              segment).                                              * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*                                                                     * 00061100
*          [ASID=xasid|CURRENT]                                     * 00061200
*              is the name (RS-type), or address in register          * 00061300
*              (2)-(12), of an optional halfword input indicates the  * 00061400
*              address space in which the Captured UCB was originally * 00061500
*              captured.                                              * 00061600
*                                                                     * 00061700
*              NOTES:                                                 * 00061800
*                                                                     * 00061900
*                                                                     * 00062000
*                                                                     * 00062100
*                  o   The caller must make sure that the ASID        * 00062200
*                      specified represents the desired address       * 00062300
*                      space.                                         * 00062400
*                                                                     * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*                                                                     * 00062800
*              DEFAULT: CURRENT                                       * 00062900
*                                                                     * 00063000
*                                                                     * 00063100
*                                                                     * 00063200
*                                                                     * 00063300
*                                                                     * 00063400
*      End of a set of mutually exclusive required keys.              * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*                                                                     * 00063800
*      [LINKAGE=SYSTEM|BRANCH]                                      * 00063900
*          is an optional keyword input that indicates whether a      * 00064000
*          branch-entry linkage should be generated or a Program Call * 00064100
*          should be issued for the routine invocation.               * 00064200
*          DEFAULT: SYSTEM                                            * 00064300
*                                                                     * 00064400
*                                                                     * 00064500
*          LINKAGE=SYSTEM                                             * 00064600
*              requests Program Call invocation.                      * 00064700
*                                                                     * 00064800
*          LINKAGE=BRANCH                                             * 00064900
*              requests branch-entry invocation.  See ENVIRONMENT for * 00065000
*              the restrictions on branch-entry invocation.           * 00065100
*                                                                     * 00065200
*                                                                     * 00065300
*                                                                     * 00065400
*                                                                     * 00065500
*                                                                     * 00065600
*                                                                     * 00065700
*      [RETCODE=xretcode]                                             * 00065800
*          is the name (RS-type) of an optional fullword output       * 00065900
*          variable, or register (2)-(12), into which the return code * 00066000
*          is to be copied from GPR 15.                               * 00066100
*                                                                     * 00066200
*                                                                     * 00066300
*                                                                     * 00066400
*                                                                     * 00066500
*      [RSNCODE=xrsncode]                                             * 00066600
*          is the name (RS-type) of an optional fullword output       * 00066700
*          variable, or register (2)-(12), into which the reason code * 00066800
*          is to be copied from GPR 0.                                * 00066900
*                                                                     * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*                                                                     * 00067300
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00067400
*          is an optional byte input decimal value in the "1-1" range * 00067500
*          that specifies the macro version.  PLISTVER is the only    * 00067600
*          key allowed on the list form of MF and determines which    * 00067700
*          parameter list is generated.  Note that MAX may be         * 00067800
*          specified instead of a number, and the parameter list will * 00067900
*          be of the largest size currently supported. This size may  * 00068000
*          grow from release to release (thus possibly affecting the  * 00068100
*          amount of storage needed by your program).  If your        * 00068200
*          program can tolerate this, IBM recommends that you always  * 00068300
*          specify MAX when creating the list form parameter list as  * 00068400
*          that will ensure that the list form parameter list is      * 00068500
*          always long enough to hold whatever parameters might be    * 00068600
*          specified on the execute form.                             * 00068700
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00068800
*          default is the lowest version which allows all of the      * 00068900
*          parameters specified on the invocation to be processed.    * 00069000
*                                                                     * 00069100
*                                                                     * 00069200
*                                                                     * 00069300
*                                                                     * 00069400
*      [MF=S|L|E]                                                   * 00069500
*          is an optional keyword input which specifies the macro     * 00069600
*          form.                                                      * 00069700
*          DEFAULT: S                                                 * 00069800
*                                                                     * 00069900
*                                                                     * 00070000
*          [MF=S]                                                     * 00070100
*              specifies the standard form of the macro.  The "S"     * 00070200
*              form generates code to put the parameters into an      * 00070300
*              in-line parameter list and invoke the desired service. * 00070400
*              Full checking for required macro keys is done along    * 00070500
*              with supplying defaults for omitted optional           * 00070600
*              parameters.                                            * 00070700
*                                                                     * 00070800
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00070900
*              specifies the list form of the macro.  The "L" form    * 00071000
*              defines an area to be used for the parameter list.     * 00071100
*              Only the PLISTVER key may be specified on the          * 00071200
*              invocation.  All other macro parameters are flagged as * 00071300
*              errors.  If PLISTVER is not specified, the original    * 00071400
*              parameter list definition is used.                     * 00071500
*                                                                     * 00071600
*            ,xmfctrl                                                 * 00071700
*              is a required input.  It is the name of a storage area * 00071800
*              for the parameter list.                                * 00071900
*                                                                     * 00072000
*            ,xmfattr|0D                                            * 00072100
*              is an optional 60 character input string that varies   * 00072200
*              from 1 to 60 characters. Use it to force boundary      * 00072300
*              alignment of the parameter list. Use only 0F or 0D.    * 00072400
*              DEFAULT: 0D which forces the parameter list to a       * 00072500
*              doubleword boundary.                                   * 00072600
*                                                                     * 00072700
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00072800
*              specifies the execute form of the macro.  The "E" form * 00072900
*              generates code to put the parameters into the          * 00073000
*              parameter list specified by xmfctrl and provides full  * 00073100
*              syntax checking with default setting.                  * 00073200
*                                                                     * 00073300
*            ,xmfctrl                                                 * 00073400
*              is a required input.  It is the name (RS-type), or     * 00073500
*              address in register (1)-(12), of a storage area for    * 00073600
*              the parameter list.                                    * 00073700
*                                                                     * 00073800
*            ,COMPLETE                                              * 00073900
*              is an optional keyword input which specifies the       * 00074000
*              degree of macro parameter syntax checking.             * 00074100
*              DEFAULT: COMPLETE                                      * 00074200
*                                                                     * 00074300
*                                                                     * 00074400
*              COMPLETE                                               * 00074500
*                  Checking for required macro keys is done and       * 00074600
*                  defaults are supplied for omitted optional         * 00074700
*                  parameters.                                        * 00074800
*                                                                     * 00074900
*                                                                     * 00075000
*                                                                     * 00075100
*                                                                     * 00075200
*                                                                     * 00075300
*                                                                     * 00075400
*                                                                     * 00075500
*01* RETURN CODES:                                                    * 00075600
*                                                                     * 00075700
*                                                                     * 00075800
*                                                                     * 00075900
*                 X'00'     The requested function was successfully   * 00076000
*                           executed.                                 * 00076100
*                                                                     * 00076200
*                 X'04'     This return code is a warning, and its    * 00076300
*                           associated reason codes should be used to * 00076400
*                           determine the reason for the warning.     * 00076500
*                                                                     * 00076600
*                           Reason Codes                              * 00076700
*                                                                     * 00076800
*                                                                     * 00076900
*                           X'04'     The Actual UCB was BELOW the    * 00077000
*                                     16Mb line. The address of the   * 00077100
*                                     Actual UCB is returned, and     * 00077200
*                                     capture is not performed.       * 00077300
*                                     (This reason code is for the    * 00077400
*                                     CAPTUCB function)               * 00077500
*                                                                     * 00077600
*                           X'08'     The Actual UCB was BELOW the    * 00077700
*                                     16Mb line, and no uncapture     * 00077800
*                                     will be performed.  (This       * 00077900
*                                     reason code is for the UCAPTUCB * 00078000
*                                     function)                       * 00078100
*                                                                     * 00078200
*                           X'0C'     An Actual UCB was passed as     * 00078300
*                                     input and it will be returned   * 00078400
*                                     as the Actual UCB.  (This       * 00078500
*                                     reason code is for the CAPTOACT * 00078600
*                                     function)                       * 00078700
*                                                                     * 00078800
*                                                                     * 00078900
*                                                                     * 00079000
*                 X'08'     Unable to perform function                * 00079100
*                                                                     * 00079200
*                           Reason Codes                              * 00079300
*                                                                     * 00079400
*                                                                     * 00079500
*                           X'04'     The ASID specified does not     * 00079600
*                                     exist or the address space was  * 00079700
*                                     swapped out.  (This reason code * 00079800
*                                     is for the CAPTOACT function)   * 00079900
*                                                                     * 00080000
*                           X'08'     The specified Captured UCB does * 00080100
*                                     not exist in the current        * 00080200
*                                     address space.  (This reason    * 00080300
*                                     code is for the UCAPTUCB        * 00080400
*                                     function)                       * 00080500
*                                                                     * 00080600
*                           X'0C'     The specified UCB address must  * 00080700
*                                     be an Actual UCB address.       * 00080800
*                                     (This reason code is for the    * 00080900
*                                     CAPTUCB function)               * 00081000
*                                                                     * 00081100
*                           X'10'     The UCB address provided by the * 00081200
*                                     caller does not represent a     * 00081300
*                                     valid UCB.  (This reason code   * 00081400
*                                     is for all functions)           * 00081500
*                                                                     * 00081600
*                           X'14'     The invoker used MSIFREE and is * 00081700
*                                     not capturing during NIP.       * 00081800
*                                     (This reason code is for the    * 00081900
*                                     CAPTUCB function)               * 00082000
*                                                                     * 00082100
*                           X'18'     The invoker tried to uncapture  * 00082200
*                                     an Actual UCB which resides     * 00082300
*                                     above the 16Mb line.  (This     * 00082400
*                                     reason code is for the UCAPTUCB * 00082500
*                                     function)                       * 00082600
*                                                                     * 00082700
*                                                                     * 00082800
*                                                                     * 00082900
*                 X'20'     Unexpected error                          * 00083000
*                                                                     * 00083100
*                                                                     * 00083200
*                                                                     * 00083300
*                                                                     * 00083400
*                                                                     * 00083500
*01* REASON CODES:                                                    * 00083600
*                                                                     * 00083700
*       See return codes section.                                     * 00083800
*                                                                     * 00083900
*01* ABEND CODES:                                                     * 00084000
*                                                                     * 00084100
*                                                                     * 00084200
*       2C6       Failure occurred during validation checking or      * 00084300
*                 while using storage passed by the caller.           * 00084400
*                                                                     * 00084500
*                                                                     * 00084600
*                                                                     * 00084700
*01* ABEND REASON CODES:                                              * 00084800
*                                                                     * 00084900
*       REASON    ABEND                                               * 00085000
*       CODE      CODE      DESCRIPTION                               * 00085100
*                                          * 00085200
*                                                                     * 00085300
*                                                                     * 00085400
*       01000100  2C6       Invalid serialization.  Caller is holding * 00085500
*                           a  lock or is not enabled when requesting * 00085600
*                           the   CAPTUCB   CAPTCOM=NO  and  UCAPTUCB * 00085700
*                           CAPTCOM=NO  functions.  Caller is holding * 00085800
*                           a  lock higher than the IOSULUT lock when * 00085900
*                           requesting  the  CAPTUCB  CAPTCOM=YES  or * 00086000
*                           UCAPTUCB CAPTCOM=YES functions.           * 00086100
*                                                                     * 00086200
*       01000101  2C6       Invalid serialization.  Caller is holding * 00086300
*                           a  lock  higher  than  the ULUT lock when * 00086400
*                           requesting CAPTOACT function.             * 00086500
*                                                                     * 00086600
*       01000102  2C6       Invalid dispatchable unit mode. Caller is * 00086700
*                           in   SRB   mode   during   NIP   and   PC * 00086800
*                           authorization is not available.           * 00086900
*                                                                     * 00087000
*       01000103  2C6       Invalid  cross  memory mode. Caller is in * 00087100
*                           cross  memory mode (PASN ^= SASN ^= HOME) * 00087200
*                           when  requesting the CAPTUCB and UCAPTUCB * 00087300
*                           functions.                                * 00087400
*                                                                     * 00087500
*       01000104  2C6       PKM  invalid.  Caller is in problem state * 00087600
*                           and the PKM is not 0 - 7 while performing * 00087700
*                           the  CAPTUCB, UCAPTUCB, and CAPTOACT with * 00087800
*                           ASID specified functions.                 * 00087900
*                                                                     * 00088000
*       01000200  2C6       Invalid parameter list.  Caller passed an * 00088100
*                           invalid version of the parameter list.    * 00088200
*                                                                     * 00088300
*       01000201  2C6       Invalid  parameter list.   Parameter list * 00088400
*                           integrity compromised.                    * 00088500
*                                                                     * 00088600
*                           NOTES:                                    * 00088700
*                                                                     * 00088800
*                                                                     * 00088900
*                                                                     * 00089000
*                               o   More  than  one  of  the mutually * 00089100
*                                   exclusive keywords was specified. * 00089200
*                                                                     * 00089300
*                               o   A   function  was  not  specified * 00089400
*                                   where one was required.           * 00089500
*                                                                     * 00089600
*                               o   Reserved fields are not zero.     * 00089700
*                                                                     * 00089800
*                               o   The  required keywords associated * 00089900
*                                   with the function are missing.    * 00090000
*                                                                     * 00090100
*                                                                     * 00090200
*                                                                     * 00090300
*                                                                     * 00090400
*                                                                     * 00090500
*       01000202  2C6       Invalid  parameter list. Caller passed an * 00090600
*                           invalid   parameter  list  and  an  error * 00090700
*                           occurred reading the list.                * 00090800
*                                                                     * 00090900
*       01000203  2C6       Invalid  parameter list. Caller passed an * 00091000
*                           invalid   parameter  list  and  an  error * 00091100
*                           occurred updating the list.               * 00091200
*                                                                     * 00091300
*       01000204  2C6       Invalid  Alet.  Caller's  parameter  list * 00091400
*                           alet is invalid.                          * 00091500
*                                                                     * 00091600
*       01000205  2C6       Invalid  Function. The function requested * 00091700
*                           does not exist.                           * 00091800
*                                                                     * 00091900
*       01000300  2C6       Invalid  Uncapture.  The uncapture of the * 00092000
*                           specified  Captured  UCB would exceed the * 00092100
*                           number  of  LASTING,  MSIFREE or SRB mode * 00092200
*                           CAPTCOM=NO captures.                      * 00092300
*                                                                     * 00092400
*                                                                     * 00092500
*                                                                     * 00092600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00092700
*                                                                     * 00092800
*02*   PROCESSOR:  ASSEM                                              * 00092900
*                                                                     * 00093000
*01* COMPONENT:  SC1C3                                                * 00093100
*                                                                     * 00093200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00093300
*                                                                     * 00093400
*01* MACRO USAGE NOTES:                                               * 00093500
*                                                                     * 00093600
*                                                                     * 00093700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00093800
*        global macro variable.  Any value other than 'NO' will       * 00093900
*        result in the macro expansion being printed.  The default is * 00094000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00094100
*        variable should be set.                                      * 00094200
*                                                                     * 00094300
*                    GBLC &ZPRINT                                     * 00094400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00094500
*                                                                     * 00094600
*                                                                     * 00094700
*    2.  All keys currently contained in the IOSCAPU macro correspond * 00094800
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00094900
*        MAX.                                                         * 00095000
*                                                                     * 00095100
*                                                                     * 00095200
*                                                                     * 00095300
*                                                                     * 00095400
*01* CHANGE ACTIVITY:                                                 * 00095500
*                                                                     * 00095600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00095700
*                                                                     * 00095800
*    $L0=UCBVP    HBB5520 940106 PDKB:  UCB VSCR Support - New        * 00095900
*                                         service                     * 00096000
*    $L1=UCBVP    HBB5520 940210 PDKB:  UCB VSCR Support - Make       * 00096100
*                                         MSIFREE, LASTING, and       * 00096200
*                                         CAPTCOM mutually exclusive  * 00096300
*    $L2=UCBVP    HBB5520 940310 PDKB:  UCB VSCR Support - Allow      * 00096400
*                                         cross memory mode for the   * 00096500
*                                         CAPTOACT function           * 00096600
*    $L3=UCBVP    HBB5520 940310 PDKB:  UCB VSCR Support - Add a new  * 00096700
*                                         reason code to ABEND2C6     * 00096800
*    $P1=PN70256  HBB5520 940310 PDKB:  Added note to CAPTOACT that   * 00096900
*                                         the IOSULUT lock cannot be  * 00097000
*                                         held exclusively            * 00097100
*    $P2=PN70822  HBB5520 940728 PDLS:  Add CAPTCOM to UCAPTUCB and   * 00097200
*                                         allow IOSULUT lock and      * 00097300
*                                         lower locks to be held when * 00097400
*                                         CAPTCOM=YES is specified    * 00097500
*    $01=OW12724  HBB5520 950602 PDMC:  Allow macro to be used in     * 00097600
*                                         relocatable code.           * 00097700
*    $02=OW40658  HBB6603 000115 PD00A8:  Add LASTING to UCAPTUCB.    * 00097800
*    $03=OW46651  HBB6608 001215 PD00PS:  Add a new option for        * 00097900
*                                         CAPTCOM for capturing to    * 00098000
*                                         PRIVATE unconditionally.    * 00098100
****** END OF SPECIFICATIONS *****************************************/ 00098200
*/* TLINE 1 *********************************************************** 00098300
         MACRO                                                          00098400
&XLABEL  IOSCAPU &UCBPTR=,&CAPTPTR=,&MSIFREE=,&LASTING=,&CAPTCOM=,     *00098500
               &ASID=,&LINKAGE=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=     00098600
.*                                                                      00098700
*              MACDATE -12/11/00-<1>                                    00098800
.*                                                                      00098900
.*******************************************************************    00099000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00099100
.*******************************************************************    00099200
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00099300
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00099400
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00099500
.*                                                                      00099600
              GBLC  &ZIOSCAPU   YES=MACRO USED AT LEAST ONCE            00099700
.*******************************************************************    00099800
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00099900
.*******************************************************************    00100000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00100100
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00100200
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00100300
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00100400
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00100500
              LCLA  &ZAWRK      USED AS A WORK AREA                     00100600
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00100700
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00100800
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00100900
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00101000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00101100
              LCLA  &ZMACRET    MACRO RETURN CODE                       00101200
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00101300
.*                                                                      00101400
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00101500
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00101600
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00101700
              LCLC  &ZENDBASEPL                 End of base PL          00101800
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00101900
.*******************************************************************    00102000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00102100
.*******************************************************************    00102200
              LCLA  &ZI         INDEX FOR ARRAY                         00102300
              LCLA  &ZJ         INDEX FOR PARMS                         00102400
              LCLA  &ZK         INDEX FOR PARSE                         00102500
              LCLA  &ZLO        LOW RANGE VALUE                         00102600
              LCLA  &ZHI        HIGH RANGE VALUE                        00102700
              LCLC  &ZW         WORK AREA FOR PARM                      00102800
.********************************************************************   00102900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00103000
.********************************************************************   00103100
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00103200
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00103300
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00103400
.*                                                                      00103500
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00103600
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00103700
              SPLEVEL  TEST                                             00103800
.ZSYS2        ANOP  ,                                                   00103900
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00104000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00104100
              SYSSTATE TEST                                             00104200
              AGO   .ZSYS4                                              00104300
.ZSYS3        ANOP  ,                                                   00104400
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00104500
.ZSYS4        ANOP  ,                                                   00104600
.*******************************************************************    00104700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00104800
.*******************************************************************    00104900
              LCLC  &XFUNCTN    ++ VALUE                                00105000
              LCLC  &XCAPTUCB   ++ VALUE                                00105100
              LCLC  &XUCBPTR    ++ NAME                                 00105200
              LCLC  &XCAPTPTR   ++ NAME                                 00105300
              LCLC  &XMSIFREE   ++ VALUE                                00105400
              LCLC  &XLASTING   ++ VALUE                                00105500
              LCLC  &XCAPTCOM   ++ VALUE                                00105600
              LCLC  &XUCAPTUCB  ++ VALUE                                00105700
              LCLC  &XCAPTOACT  ++ VALUE                                00105800
              LCLC  &XASID      ++ NAME                                 00105900
              LCLC  &XLINKAGE   ++ VALUE                                00106000
              LCLC  &XRETCODE   ++ NAME                                 00106100
              LCLC  &XRSNCODE   ++ NAME                                 00106200
              LCLA  &XPLISTVER  ++ VALUE                                00106300
              LCLC  &XMF        ++ VALUE                                00106400
              LCLC  &XMFCTRL    ++ NAME                                 00106500
              LCLC  &XMFATTR    ++ VALUE                                00106600
              LCLC  &XMFSCK     ++ VALUE                                00106700
.*******************************************************************    00106800
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00106900
.*******************************************************************    00107000
              LCLC  &ZXFUNCTN   ++ INPUT VALUE                          00107100
              LCLC  &ZXCAPTUCB  ++ INPUT VALUE                          00107200
              LCLC  &ZXUCBPTR   ++ INPUT NAME                           00107300
              LCLC  &ZXCAPTPTR  ++ OUTPUT NAME                          00107400
              LCLC  &ZXMSIFREE  ++ INPUT VALUE                          00107500
              LCLC  &ZXLASTING  ++ INPUT VALUE                          00107600
              LCLC  &ZXCAPTCOM  ++ INPUT VALUE                          00107700
              LCLC  &ZXUCAPTUCB                 ++ INPUT VALUE          00107800
              LCLC  &ZXCAPTOACT                 ++ INPUT VALUE          00107900
              LCLC  &ZXASID     ++ INPUT NAME                           00108000
              LCLC  &ZXLINKAGE  ++ INPUT VALUE                          00108100
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00108200
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00108300
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00108400
              LCLC  &ZXMF       ++ INPUT VALUE                          00108500
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00108600
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00108700
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00108800
.********************************************************************   00108900
.***AC.PLV01  PROCESS PLISTVER                                      *   00109000
.********************************************************************   00109100
&XPLISTVER      SETA  1                                                 00109200
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00109300
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00109400
&XPLISTVER      SETA  1                                                 00109500
.ZPLV0          ANOP  ,                                                 00109600
.*                                                                      00109700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00109800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00109900
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00110000
.*-------------------------------------------------------------------   00110100
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00110200
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00110300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00110400
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00110500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00110600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00110700
                AGO   .ZPVCK2                                           00110800
.ZPVCK3         ANOP  ,                                                 00110900
.*-------------------------------------------------------------------   00111000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00111100
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00111200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00111300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00111400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00111500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00111600
                AGO   .ZPVCKE                                           00111700
.ZPVCK2         ANOP  ,                                                 00111800
.*-------------------------------------------------------------------   00111900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00112000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00112100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00112200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00112300
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00112400
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00112500
.ZPVCK6         ANOP  ,                                                 00112600
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00112700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00112800
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00112900
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00113000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00113100
&XPLISTVER      SETA  1                                                 00113200
                AGO   .ZPVCKE                                           00113300
.*-------------------------------------------------------------------   00113400
.ZPVCK4A        ANOP  ,                                                 00113500
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00113600
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00113700
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00113800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00113900
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00114000
                MNOTE 8,' &ZMS IS REQUIRED.'                            00114100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00114200
                AGO   .ZPVCK5                                           00114300
.ZPVCK4         ANOP  ,                                                 00114400
&XPLISTVER      SETA  &PLISTVER(1)                                      00114500
.ZPVCK5         ANOP  ,                                                 00114600
.ZPVCKE         ANOP  ,                                                 00114700
.********************************************************************   00114800
.***AG.MF01 PROCESS MF MACRO FORMS                                      00114900
.********************************************************************   00115000
              ACTR  10000                                               00115100
.*------------------------------------------------------------------    00115200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115300
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00115400
.*-------------------------------------------------------------------   00115500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115600
.ZG66         ANOP  ,                                                   00115700
&ZTLC         SETC 'S'                                                  00115800
              AIF   ('&MF(1)' NE '&ZTLC').ZG67                          00115900
&XMF          SETC  'S'         SET KEYWORD                             00116000
              AIF   (N'&MF LE 1).ZG66A          CK NUM                  00116100
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00116200
&ZMS          SETC  '&ZMS.&MF"'                                         00116300
&ZMS          SETC  '&ZMS "MF"'                                         00116400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00116500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116600
.ZG66A        ANOP  ,                                                   00116700
.*-------------------------------------------------------------------   00116800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116900
.ZG67         ANOP  ,                                                   00117000
&ZTLC         SETC 'L'                                                  00117100
              AIF   ('&MF(1)' NE '&ZTLC').ZG74                          00117200
&XMF          SETC  'L'         SET KEYWORD                             00117300
              AIF   (N'&MF LE 3).ZG67A          CK NUM                  00117400
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00117500
&ZMS          SETC  '&ZMS.&MF"'                                         00117600
&ZMS          SETC  '&ZMS "MF"'                                         00117700
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00117800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00117900
.ZG67A        ANOP  ,                                                   00118000
.*-------------------------------------------------------------------   00118100
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00118200
              AIF   (N'&SYSLIST NE 0).ZG67B     POSITIONALS?            00118300
              AIF   ('&UCBPTR' NE '').ZG67B     KEYS?                   00118400
              AIF   ('&CAPTPTR' NE '').ZG67B    KEYS?                   00118500
              AIF   ('&MSIFREE' NE '').ZG67B    KEYS?                   00118600
              AIF   ('&LASTING' NE '').ZG67B    KEYS?                   00118700
              AIF   ('&CAPTCOM' NE '').ZG67B    KEYS?                   00118800
              AIF   ('&ASID' NE '').ZG67B       KEYS?                   00118900
              AIF   ('&LINKAGE' NE '').ZG67B    KEYS?                   00119000
              AIF   ('&RETCODE' NE '').ZG67B    KEYS?                   00119100
              AIF   ('&RSNCODE' NE '').ZG67B    KEYS?                   00119200
              AGO    .ZG67C     INVOCATION OKAY                         00119300
.ZG67B        ANOP  ,                                                   00119400
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            00119500
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00119600
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00119700
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00119800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119900
.ZG67C        ANOP  ,                                                   00120000
.*-------------------------------------------------------------------   00120100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00120200
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00120300
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00120400
              AIF   (N'&MF(2) GT 1).ZG69B       MULTI PARMS             00120500
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00120600
.ZG69B        AIF   (K'&MF(2) GT 0).ZG69C                               00120700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00120800
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00120900
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00121000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00121100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00121200
.ZG69C        ANOP  ,                                                   00121300
.*-------------------------------------------------------------------   00121400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00121500
              AIF   (K'&ZXMFCTRL LE 0).ZG69P    NOT I/O                 00121600
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG69P                      00121700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00121800
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00121900
&ZMS          SETC  '&ZMS.&MF"'                                         00122000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00122100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00122200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122300
.ZG69P        ANOP  ,                                                   00122400
.*-------------------------------------------------------------------   00122500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00122600
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00122700
&XMFATTR      SETC  '0D'                                                00122800
              AIF   (K'&MF(3) LE 0).ZG72B       PARM                    00122900
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00123000
              AIF   (N'&MF(3) GT 1).ZG72B       MULTI PARMS             00123100
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00123200
.ZG72B        ANOP  ,                                                   00123300
.*-------------------------------------------------------------------   00123400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00123500
              AIF   (K'&ZXMFATTR LE 0).ZG72P    NOT I/O                 00123600
              AIF   ('&XMFATTR'(1,1) NE '(').ZG72P                      00123700
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00123800
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00123900
&ZMS          SETC  '&ZMS.&MF"'                                         00124000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00124100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00124200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124300
.ZG72P        ANOP  ,                                                   00124400
.*-------------------------------------------------------------------   00124500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00124600
              AIF   (K'&ZXMFATTR LE 0).ZG72S    NOT I/O                 00124700
              AIF   (K'&XMFATTR LE 60).ZG72S    LNG OK                  00124800
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00124900
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00125000
&ZMS          SETC  '&ZMS.&MF"'                                         00125100
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00125200
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00125300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125400
.ZG72S        ANOP  ,                                                   00125500
.*-------------------------------------------------------------------   00125600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125700
.ZG74         ANOP  ,                                                   00125800
&ZTLC         SETC 'E'                                                  00125900
              AIF   ('&MF(1)' NE '&ZTLC').ZG82                          00126000
&XMF          SETC  'E'         SET KEYWORD                             00126100
              AIF   (N'&MF LE 3).ZG74A          CK NUM                  00126200
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00126300
&ZMS          SETC  '&ZMS.&MF"'                                         00126400
&ZMS          SETC  '&ZMS "MF"'                                         00126500
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00126600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126700
.ZG74A        ANOP  ,                                                   00126800
.*-------------------------------------------------------------------   00126900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00127000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00127100
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00127200
              AIF   (N'&MF(2) GT 1).ZG76B       MULTI PARMS             00127300
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00127400
.ZG76B        AIF   (K'&MF(2) GT 0).ZG76C                               00127500
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00127600
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00127700
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00127800
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00127900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128000
.ZG76C        ANOP  ,                                                   00128100
.*-------------------------------------------------------------------   00128200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00128300
              AIF   (K'&ZXMFCTRL LE 0).ZG76R    NOT I/O                 00128400
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG76R                      00128500
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00128600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG76P                        00128700
              AIF   (K'&ZCGPR GT 2).ZG76Q                               00128800
              AIF   ('&ZCGPR' EQ '0').ZG76Q                             00128900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00129000
              AIF   (T'&ZCGPR NE 'N').ZG76Q     INVALID REG NAME        00129100
.ZG76P        ANOP  ,                                                   00129200
              AIF   (T'&ZCGPR NE 'N').ZG76R     NON NUMERIC             00129300
              AIF   ('&ZCGPR' LT '1').ZG76Q                             00129400
              AIF   ('&ZCGPR' LE '12').ZG76R                            00129500
.ZG76Q        ANOP  ,                                                   00129600
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00129700
&ZMS          SETC  '&ZMS.&MF"'                                         00129800
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00129900
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00130000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00130100
.ZG76R        ANOP  ,                                                   00130200
.*-------------------------------------------------------------------   00130300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00130400
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00130500
.ZG80A   AIF   ('&MF(3)' NE 'COMPLETE').ZG81A                           00130600
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00130700
.*-------------------------------------------------------------------   00130800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00130900
.ZG81A        AIF   (K'&XMFSCK GT 0).ZG81C      KEYWORD                 00131000
              AIF   (K'&MF(3) LE 0).ZG81B                               00131100
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00131200
&ZMS          SETC  '&ZMS.&MF"'                                         00131300
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00131400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00131500
&ZMS          SETC  '&ZMS "COMPLETE".'                                  00131600
              MNOTE 8,' &ZMS '                                          00131700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131800
.ZG81B        ANOP  ,                                                   00131900
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00132000
.ZG81C        ANOP  ,                                                   00132100
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00132200
.*------------------------------------------------------------------    00132300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00132400
.ZG82         ANOP  ,                                                   00132500
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00132600
              AIF   (K'&XMF GT 0).ZG82E         VALID ARG               00132700
              AIF   (T'&MF EQ 'O').ZG82D        OMITTED                 00132800
&ZASYSLNDX    SETA  0                                                   00132900
.ZG82A        ANOP  ,           POSITIONAL MACRO KEY                    00133000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00133100
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG82C                    00133200
&ZTLC         SETC 'MF'                                                 00133300
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG82A           00133400
.ZG82B        ANOP  ,                                                   00133500
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00133600
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00133700
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00133800
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00133900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134000
              AGO   .ZG82E                                              00134100
.ZG82C        ANOP  ,                                                   00134200
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00134300
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00134400
&ZMS          SETC  '&ZMS.&MF"'                                         00134500
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00134600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00134700
&ZMS          SETC  '&ZMS "S",'                                         00134800
&ZMS          SETC  '&ZMS "L",'                                         00134900
&ZMS          SETC  '&ZMS OR "E".'                                      00135000
              MNOTE 8,' &ZMS '                                          00135100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00135200
              AGO   .ZG82E                                              00135300
.ZG82D        ANOP  ,                                                   00135400
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00135500
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00135600
.ZG82E        ANOP  ,                                                   00135700
.********************************************************************   00135800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00135900
.********************************************************************   00136000
              ACTR  10000                                               00136100
.*-------------------------------------------------------------------   00136200
.***AG.MF03 MF=(SLE)                                                    00136300
              AIF   ('&XMF' EQ 'L').ZGMFX                               00136400
.*-------------------------------------------------------------------   00136500
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00136600
&XFUNCTN      SETC  ''          INITIALIZE XVARIABLE                    00136700
&ZASYSLNDX    SETA  0                                                   00136800
.ZG2A         ANOP  ,           POSITIONAL KEY SEARCH                   00136900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00137000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00137100
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00137200
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CAPTUCB').ZG2A               00137300
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00137400
&ZXFUNCTN     SETC  'INPUT'     SET IN/OUTPUT                           00137500
&XFUNCTN      SETC  'CAPTUCB'   SET XVARIABLE                           00137600
&ZXCAPTUCB    SETC  'INPUT'     SET IN/OUTPUT                           00137700
&XCAPTUCB     SETC  'CAPTUCB'   SET XVARIABLE PARM                      00137800
.ZG2B         ANOP  ,                                                   00137900
.*-------------------------------------------------------------------   00138000
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00138100
&ZASYSLNDX    SETA  0                                                   00138200
.ZG25A        ANOP  ,           POSITIONAL KEY SEARCH                   00138300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00138400
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C  DONE                   00138500
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG25A            00138600
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'UCAPTUCB').ZG25A             00138700
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00138800
              AIF   (K'&XFUNCTN LE 0).ZG25B     VALID                   00138900
&ZMS          SETC  '"UCAPTUCB'                 *KMEKA* MNOTE           00139000
&ZMS          SETC  '&ZMS."'                                            00139100
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00139200
&ZMS          SETC  '&ZMS "&XFUNCTN"'                                   00139300
              MNOTE 8,' &ZMS KEY.'                                      00139400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00139500
              AGO   .ZG25C                                              00139600
.*                                                                      00139700
.ZG25B        ANOP  ,                                                   00139800
&ZXFUNCTN     SETC  'INPUT'     SET IN/OUTPUT                           00139900
&XFUNCTN      SETC  'UCAPTUCB'  SET XVARIABLE                           00140000
&ZXUCAPTUCB   SETC  'INPUT'     SET IN/OUTPUT                           00140100
&XUCAPTUCB    SETC  'UCAPTUCB'  SET XVARIABLE PARM                      00140200
.ZG25C        ANOP  ,                                                   00140300
.*-------------------------------------------------------------------   00140400
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00140500
&ZASYSLNDX    SETA  0                                                   00140600
.ZG39A        ANOP  ,           POSITIONAL KEY SEARCH                   00140700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00140800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG39C  DONE                   00140900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG39A            00141000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CAPTOACT').ZG39A             00141100
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00141200
              AIF   (K'&XFUNCTN LE 0).ZG39B     VALID                   00141300
&ZMS          SETC  '"CAPTOACT'                 *KMEKA* MNOTE           00141400
&ZMS          SETC  '&ZMS."'                                            00141500
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00141600
&ZMS          SETC  '&ZMS "&XFUNCTN"'                                   00141700
              MNOTE 8,' &ZMS KEY.'                                      00141800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141900
              AGO   .ZG39C                                              00142000
.*                                                                      00142100
.ZG39B        ANOP  ,                                                   00142200
&ZXFUNCTN     SETC  'INPUT'     SET IN/OUTPUT                           00142300
&XFUNCTN      SETC  'CAPTOACT'  SET XVARIABLE                           00142400
&ZXCAPTOACT   SETC  'INPUT'     SET IN/OUTPUT                           00142500
&XCAPTOACT    SETC  'CAPTOACT'  SET XVARIABLE PARM                      00142600
.ZG39C        ANOP  ,                                                   00142700
.*------------------------------------------------------------------    00142800
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00142900
              AIF   (K'&XFUNCTN GT 0).ZG49B                             00143000
&ZXFUNCTN     SETC  ''          RESET IN/OUTPUT                         00143100
&ZXCAPTUCB    SETC  ''          RESET IN/OUTPUT                         00143200
&XFUNCTN      SETC  ''          ENSURE NULL                             00143300
&XCAPTUCB     SETC  ''          ENSURE NULL                             00143400
&ZMS          SETC  'ONE OF THE FOLLOWING'      *KMERA* MNOTE           00143500
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 00143600
&ZMS          SETC  '&ZMS REQUIRED:'                                    00143700
&ZMS          SETC  '&ZMS "CAPTUCB",'           VALID ME KEY            00143800
&ZMS          SETC  '&ZMS "UCAPTUCB",'          VALID ME KEY            00143900
&ZMS          SETC  '&ZMS OR "CAPTOACT".'       VALID ME KEY            00144000
              MNOTE 8,' &ZMS '                                          00144100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00144200
.ZG49B        ANOP  ,                                                   00144300
.*-------------------------------------------------------------------   00144400
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00144500
.ZG2          AIF   ('&XFUNCTN' NE 'CAPTUCB').ZG25                      00144600
.*-------------------------------------------------------------------   00144700
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00144800
&ZCVAL        SETC ''           ERROR KEY FIELD                         00144900
.ZG2I0        AIF   (K'&ASID LE 0).ZG2I1                                00145000
&ZCVAL        SETC '&ZCVAL ASID'                DISALLOWED KEY          00145100
.ZG2I1        AIF   (K'&ZCVAL LE 0).ZG2J        KEY                     00145200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00145300
&ZMS          SETC  '"CAPTUCB'  *KMEIA* MNOTE                           00145400
&ZMS          SETC  '&ZMS."'                                            00145500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00145600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00145700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145800
.ZG2J         ANOP  ,                                                   00145900
.*----------------------------------------------------------------***   00146000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00146100
              AIF   (N'&UCBPTR LE 1).ZG4A       CK NUM                  00146200
&ZMS          SETC  '"UCBPTR='  *KPOSA* MNOTE                           00146300
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     00146400
&ZMS          SETC  '&ZMS "UCBPTR"'                                     00146500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00146600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00146700
.ZG4A         ANOP  ,                                                   00146800
.*-------------------------------------------------------------------   00146900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00147000
&ZXUCBPTR     SETC  'INPUT'     SET IN/OUTPUT                           00147100
&XUCBPTR      SETC  '&UCBPTR(1)'                SET XVARIABLE           00147200
              AIF   (N'&UCBPTR GT 1).ZG4B       MULTI PARMS             00147300
&XUCBPTR      SETC  '&UCBPTR'   SET XVARIABLE                           00147400
.ZG4B         AIF   (K'&UCBPTR(1) GT 0).ZG4C                            00147500
&ZXUCBPTR     SETC  ''          RESET IN/OUTPUT                         00147600
&ZMS          SETC  ' '         *KRQDA*                                 00147700
&ZMS          SETC  '&ZMS "UCBPTR" KEY AND ITS'                         00147800
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00147900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148000
.ZG4C         ANOP  ,                                                   00148100
.*-------------------------------------------------------------------   00148200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00148300
              AIF   (K'&ZXUCBPTR LE 0).ZG4R     NOT I/O                 00148400
              AIF   ('&XUCBPTR'(1,1) NE '(').ZG4R                       00148500
&ZCGPR        SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                          00148600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         00148700
              AIF   (K'&ZCGPR GT 2).ZG4Q                                00148800
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              00148900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00149000
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        00149100
.ZG4P         ANOP  ,                                                   00149200
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             00149300
              AIF   ('&ZCGPR' LT '2').ZG4Q                              00149400
              AIF   ('&ZCGPR' LE '12').ZG4R                             00149500
.ZG4Q         ANOP  ,                                                   00149600
&ZMS          SETC  '"UCBPTR='  *KGPRA* MNOTE                           00149700
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     00149800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00149900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00150100
.ZG4R         ANOP  ,                                                   00150200
.*----------------------------------------------------------------***   00150300
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00150400
              AIF   (N'&CAPTPTR LE 1).ZG7A      CK NUM                  00150500
&ZMS          SETC  '"CAPTPTR='                 *KPOSA* MNOTE           00150600
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    00150700
&ZMS          SETC  '&ZMS "CAPTPTR"'                                    00150800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00150900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151000
.ZG7A         ANOP  ,                                                   00151100
.*-------------------------------------------------------------------   00151200
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00151300
&ZXCAPTPTR    SETC  'OUTPUT'    SET IN/OUTPUT                           00151400
&XCAPTPTR     SETC  '&CAPTPTR(1)'               SET XVARIABLE           00151500
              AIF   (N'&CAPTPTR GT 1).ZG7B      MULTI PARMS             00151600
&XCAPTPTR     SETC  '&CAPTPTR'  SET XVARIABLE                           00151700
.ZG7B         AIF   (K'&CAPTPTR(1) GT 0).ZG7C                           00151800
&ZXCAPTPTR    SETC  ''          RESET IN/OUTPUT                         00151900
&ZMS          SETC  ' '         *KRQDA*                                 00152000
&ZMS          SETC  '&ZMS "CAPTPTR" KEY AND ITS'                        00152100
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00152200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00152300
.ZG7C         ANOP  ,                                                   00152400
.*-------------------------------------------------------------------   00152500
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00152600
              AIF   (K'&ZXCAPTPTR LE 0).ZG7R    NOT I/O                 00152700
              AIF   ('&XCAPTPTR'(1,1) NE '(').ZG7R                      00152800
&ZCGPR        SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                        00152900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                         00153000
              AIF   (K'&ZCGPR GT 2).ZG7Q                                00153100
              AIF   ('&ZCGPR' EQ '0').ZG7Q                              00153200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00153300
              AIF   (T'&ZCGPR NE 'N').ZG7Q      INVALID REG NAME        00153400
.ZG7P         ANOP  ,                                                   00153500
              AIF   (T'&ZCGPR NE 'N').ZG7R      NON NUMERIC             00153600
              AIF   ('&ZCGPR' LT '2').ZG7Q                              00153700
              AIF   ('&ZCGPR' LE '12').ZG7R                             00153800
.ZG7Q         ANOP  ,                                                   00153900
&ZMS          SETC  '"CAPTPTR='                 *KGPRA* MNOTE           00154000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    00154100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00154200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00154300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00154400
.ZG7R         ANOP  ,                                                   00154500
.*----------------------------------------------------------------***   00154600
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00154700
              AIF   (N'&MSIFREE LE 1).ZG10A     CK NUM                  00154800
&ZMS          SETC  '"MSIFREE='                 *KPOSA* MNOTE           00154900
&ZMS          SETC  '&ZMS.&MSIFREE"'                                    00155000
&ZMS          SETC  '&ZMS "MSIFREE"'                                    00155100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00155200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155300
.ZG10A        ANOP  ,                                                   00155400
.*-------------------------------------------------------------------   00155500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00155600
&XMSIFREE     SETC  ''          INITIALIZE XVARIABLE                    00155700
.ZG11A   AIF   ('&MSIFREE(1)' NE 'NO').ZG12A                            00155800
&XMSIFREE     SETC  'NO'        SET KEYWORD                             00155900
.*-------------------------------------------------------------------   00156000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00156100
.ZG12A   AIF   ('&MSIFREE(1)' NE 'YES').ZG13A                           00156200
&XMSIFREE     SETC  'YES'       SET KEYWORD                             00156300
.*-------------------------------------------------------------------   00156400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00156500
.ZG13A        AIF   (K'&XMSIFREE GT 0).ZG13C    KEYWORD                 00156600
              AIF   (K'&MSIFREE(1) LE 0).ZG13B                          00156700
&ZMS          SETC  '"MSIFREE='                 *KUKWA* MNOTE           00156800
&ZMS          SETC  '&ZMS.&MSIFREE"'                                    00156900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00157000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00157100
&ZMS          SETC  '&ZMS "NO"'                                         00157200
&ZMS          SETC  '&ZMS OR "YES".'                                    00157300
              MNOTE 8,' &ZMS '                                          00157400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157500
.ZG13B        ANOP  ,                                                   00157600
&XMSIFREE     SETC  'NO'        SET DEFAULT KEYWORD                     00157700
.ZG13C        ANOP  ,                                                   00157800
&ZXMSIFREE    SETC  'INPUT'     SET IN/OUTPUT                           00157900
.*----------------------------------------------------------------***   00158000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00158100
              AIF   (N'&LASTING LE 1).ZG15A     CK NUM                  00158200
&ZMS          SETC  '"LASTING='                 *KPOSA* MNOTE           00158300
&ZMS          SETC  '&ZMS.&LASTING"'                                    00158400
&ZMS          SETC  '&ZMS "LASTING"'                                    00158500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00158600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158700
.ZG15A        ANOP  ,                                                   00158800
.*-------------------------------------------------------------------   00158900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159000
&XLASTING     SETC  ''          INITIALIZE XVARIABLE                    00159100
.ZG16A   AIF   ('&LASTING(1)' NE 'NO').ZG17A                            00159200
&XLASTING     SETC  'NO'        SET KEYWORD                             00159300
.*-------------------------------------------------------------------   00159400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159500
.ZG17A   AIF   ('&LASTING(1)' NE 'YES').ZG18A                           00159600
&XLASTING     SETC  'YES'       SET KEYWORD                             00159700
.*-------------------------------------------------------------------   00159800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159900
.ZG18A        AIF   (K'&XLASTING GT 0).ZG18C    KEYWORD                 00160000
              AIF   (K'&LASTING(1) LE 0).ZG18B                          00160100
&ZMS          SETC  '"LASTING='                 *KUKWA* MNOTE           00160200
&ZMS          SETC  '&ZMS.&LASTING"'                                    00160300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00160400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00160500
&ZMS          SETC  '&ZMS "NO"'                                         00160600
&ZMS          SETC  '&ZMS OR "YES".'                                    00160700
              MNOTE 8,' &ZMS '                                          00160800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00160900
.ZG18B        ANOP  ,                                                   00161000
&XLASTING     SETC  'NO'        SET DEFAULT KEYWORD                     00161100
.ZG18C        ANOP  ,                                                   00161200
&ZXLASTING    SETC  'INPUT'     SET IN/OUTPUT                           00161300
.*----------------------------------------------------------------***   00161400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00161500
              AIF   (N'&CAPTCOM LE 1).ZG20A     CK NUM                  00161600
&ZMS          SETC  '"CAPTCOM='                 *KPOSA* MNOTE           00161700
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    00161800
&ZMS          SETC  '&ZMS "CAPTCOM"'                                    00161900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00162000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162100
.ZG20A        ANOP  ,                                                   00162200
.*-------------------------------------------------------------------   00162300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00162400
&XCAPTCOM     SETC  ''          INITIALIZE XVARIABLE                    00162500
.ZG21A   AIF   ('&CAPTCOM(1)' NE 'NO').ZG22A                            00162600
&XCAPTCOM     SETC  'NO'        SET KEYWORD                             00162700
.*-------------------------------------------------------------------   00162800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00162900
.ZG22A   AIF   ('&CAPTCOM(1)' NE 'YES').ZG23A                           00163000
&XCAPTCOM     SETC  'YES'       SET KEYWORD                             00163100
.*-------------------------------------------------------------------   00163200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00163300
.ZG23A   AIF   ('&CAPTCOM(1)' NE 'NEVER').ZG24A                         00163400
&XCAPTCOM     SETC  'NEVER'     SET KEYWORD                             00163500
.*-------------------------------------------------------------------   00163600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00163700
.ZG24A        AIF   (K'&XCAPTCOM GT 0).ZG24C    KEYWORD                 00163800
              AIF   (K'&CAPTCOM(1) LE 0).ZG24B                          00163900
&ZMS          SETC  '"CAPTCOM='                 *KUKWA* MNOTE           00164000
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    00164100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00164200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00164300
&ZMS          SETC  '&ZMS "NO",'                                        00164400
&ZMS          SETC  '&ZMS "YES",'                                       00164500
&ZMS          SETC  '&ZMS OR "NEVER".'                                  00164600
              MNOTE 8,' &ZMS '                                          00164700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00164800
.ZG24B        ANOP  ,                                                   00164900
&XCAPTCOM     SETC  'NO'        SET DEFAULT KEYWORD                     00165000
.ZG24C        ANOP  ,                                                   00165100
&ZXCAPTCOM    SETC  'INPUT'     SET IN/OUTPUT                           00165200
.*-------------------------------------------------------------------   00165300
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00165400
.ZG25         AIF   ('&XFUNCTN' NE 'UCAPTUCB').ZG39                     00165500
.*-------------------------------------------------------------------   00165600
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00165700
&ZCVAL        SETC ''           ERROR KEY FIELD                         00165800
.ZG25I0       AIF   (K'&UCBPTR LE 0).ZG25I1                             00165900
&ZCVAL        SETC '&ZCVAL UCBPTR'              DISALLOWED KEY          00166000
.ZG25I1       AIF   (K'&MSIFREE LE 0).ZG25I2                            00166100
&ZCVAL        SETC '&ZCVAL MSIFREE'             DISALLOWED KEY          00166200
.ZG25I2       AIF   (K'&ASID LE 0).ZG25I3                               00166300
&ZCVAL        SETC '&ZCVAL ASID'                DISALLOWED KEY          00166400
.ZG25I3       AIF   (K'&ZCVAL LE 0).ZG25J       KEY                     00166500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00166600
&ZMS          SETC  '"UCAPTUCB'                 *KMEIA* MNOTE           00166700
&ZMS          SETC  '&ZMS."'                                            00166800
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00166900
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00167000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00167100
.ZG25J        ANOP  ,                                                   00167200
.*----------------------------------------------------------------***   00167300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00167400
              AIF   (N'&CAPTPTR LE 1).ZG27A     CK NUM                  00167500
&ZMS          SETC  '"CAPTPTR='                 *KPOSA* MNOTE           00167600
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    00167700
&ZMS          SETC  '&ZMS "CAPTPTR"'                                    00167800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00167900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00168000
.ZG27A        ANOP  ,                                                   00168100
.*-------------------------------------------------------------------   00168200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00168300
&ZXCAPTPTR    SETC  'INPUT'     SET IN/OUTPUT                           00168400
&XCAPTPTR     SETC  '&CAPTPTR(1)'               SET XVARIABLE           00168500
              AIF   (N'&CAPTPTR GT 1).ZG27B     MULTI PARMS             00168600
&XCAPTPTR     SETC  '&CAPTPTR'  SET XVARIABLE                           00168700
.ZG27B        AIF   (K'&CAPTPTR(1) GT 0).ZG27C                          00168800
&ZXCAPTPTR    SETC  ''          RESET IN/OUTPUT                         00168900
&ZMS          SETC  ' '         *KRQDA*                                 00169000
&ZMS          SETC  '&ZMS "CAPTPTR" KEY AND ITS'                        00169100
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00169200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00169300
.ZG27C        ANOP  ,                                                   00169400
.*-------------------------------------------------------------------   00169500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00169600
              AIF   (K'&ZXCAPTPTR LE 0).ZG27R   NOT I/O                 00169700
              AIF   ('&XCAPTPTR'(1,1) NE '(').ZG27R                     00169800
&ZCGPR        SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                        00169900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                        00170000
              AIF   (K'&ZCGPR GT 2).ZG27Q                               00170100
              AIF   ('&ZCGPR' EQ '0').ZG27Q                             00170200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00170300
              AIF   (T'&ZCGPR NE 'N').ZG27Q     INVALID REG NAME        00170400
.ZG27P        ANOP  ,                                                   00170500
              AIF   (T'&ZCGPR NE 'N').ZG27R     NON NUMERIC             00170600
              AIF   ('&ZCGPR' LT '2').ZG27Q                             00170700
              AIF   ('&ZCGPR' LE '12').ZG27R                            00170800
.ZG27Q        ANOP  ,                                                   00170900
&ZMS          SETC  '"CAPTPTR='                 *KGPRA* MNOTE           00171000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    00171100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00171200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00171300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00171400
.ZG27R        ANOP  ,                                                   00171500
.*----------------------------------------------------------------***   00171600
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00171700
              AIF   (N'&LASTING LE 1).ZG30A     CK NUM                  00171800
&ZMS          SETC  '"LASTING='                 *KPOSA* MNOTE           00171900
&ZMS          SETC  '&ZMS.&LASTING"'                                    00172000
&ZMS          SETC  '&ZMS "LASTING"'                                    00172100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00172200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172300
.ZG30A        ANOP  ,                                                   00172400
.*-------------------------------------------------------------------   00172500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00172600
&XLASTING     SETC  ''          INITIALIZE XVARIABLE                    00172700
.ZG31A   AIF   ('&LASTING(1)' NE 'NO').ZG32A                            00172800
&XLASTING     SETC  'NO'        SET KEYWORD                             00172900
.*-------------------------------------------------------------------   00173000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00173100
.ZG32A   AIF   ('&LASTING(1)' NE 'YES').ZG33A                           00173200
&XLASTING     SETC  'YES'       SET KEYWORD                             00173300
.*-------------------------------------------------------------------   00173400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00173500
.ZG33A        AIF   (K'&XLASTING GT 0).ZG33C    KEYWORD                 00173600
              AIF   (K'&LASTING(1) LE 0).ZG33B                          00173700
&ZMS          SETC  '"LASTING='                 *KUKWA* MNOTE           00173800
&ZMS          SETC  '&ZMS.&LASTING"'                                    00173900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00174000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00174100
&ZMS          SETC  '&ZMS "NO"'                                         00174200
&ZMS          SETC  '&ZMS OR "YES".'                                    00174300
              MNOTE 8,' &ZMS '                                          00174400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00174500
.ZG33B        ANOP  ,                                                   00174600
&XLASTING     SETC  'NO'        SET DEFAULT KEYWORD                     00174700
.ZG33C        ANOP  ,                                                   00174800
&ZXLASTING    SETC  'INPUT'     SET IN/OUTPUT                           00174900
.*----------------------------------------------------------------***   00175000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00175100
              AIF   (N'&CAPTCOM LE 1).ZG35A     CK NUM                  00175200
&ZMS          SETC  '"CAPTCOM='                 *KPOSA* MNOTE           00175300
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    00175400
&ZMS          SETC  '&ZMS "CAPTCOM"'                                    00175500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00175600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175700
.ZG35A        ANOP  ,                                                   00175800
.*-------------------------------------------------------------------   00175900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00176000
&XCAPTCOM     SETC  ''          INITIALIZE XVARIABLE                    00176100
.ZG36A   AIF   ('&CAPTCOM(1)' NE 'NO').ZG37A                            00176200
&XCAPTCOM     SETC  'NO'        SET KEYWORD                             00176300
.*-------------------------------------------------------------------   00176400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00176500
.ZG37A   AIF   ('&CAPTCOM(1)' NE 'YES').ZG38A                           00176600
&XCAPTCOM     SETC  'YES'       SET KEYWORD                             00176700
.*-------------------------------------------------------------------   00176800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00176900
.ZG38A        AIF   (K'&XCAPTCOM GT 0).ZG38C    KEYWORD                 00177000
              AIF   (K'&CAPTCOM(1) LE 0).ZG38B                          00177100
&ZMS          SETC  '"CAPTCOM='                 *KUKWA* MNOTE           00177200
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    00177300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00177400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00177500
&ZMS          SETC  '&ZMS "NO"'                                         00177600
&ZMS          SETC  '&ZMS OR "YES".'                                    00177700
              MNOTE 8,' &ZMS '                                          00177800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00177900
.ZG38B        ANOP  ,                                                   00178000
&XCAPTCOM     SETC  'NO'        SET DEFAULT KEYWORD                     00178100
.ZG38C        ANOP  ,                                                   00178200
&ZXCAPTCOM    SETC  'INPUT'     SET IN/OUTPUT                           00178300
.*-------------------------------------------------------------------   00178400
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00178500
.ZG39         AIF   ('&XFUNCTN' NE 'CAPTOACT').ZG49                     00178600
.*-------------------------------------------------------------------   00178700
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00178800
&ZCVAL        SETC ''           ERROR KEY FIELD                         00178900
.ZG39I0       AIF   (K'&MSIFREE LE 0).ZG39I1                            00179000
&ZCVAL        SETC '&ZCVAL MSIFREE'             DISALLOWED KEY          00179100
.ZG39I1       AIF   (K'&LASTING LE 0).ZG39I2                            00179200
&ZCVAL        SETC '&ZCVAL LASTING'             DISALLOWED KEY          00179300
.ZG39I2       AIF   (K'&CAPTCOM LE 0).ZG39I3                            00179400
&ZCVAL        SETC '&ZCVAL CAPTCOM'             DISALLOWED KEY          00179500
.ZG39I3       AIF   (K'&ZCVAL LE 0).ZG39J       KEY                     00179600
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00179700
&ZMS          SETC  '"CAPTOACT'                 *KMEIA* MNOTE           00179800
&ZMS          SETC  '&ZMS."'                                            00179900
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00180000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00180100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00180200
.ZG39J        ANOP  ,                                                   00180300
.*----------------------------------------------------------------***   00180400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00180500
              AIF   (N'&CAPTPTR LE 1).ZG41A     CK NUM                  00180600
&ZMS          SETC  '"CAPTPTR='                 *KPOSA* MNOTE           00180700
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    00180800
&ZMS          SETC  '&ZMS "CAPTPTR"'                                    00180900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00181000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00181100
.ZG41A        ANOP  ,                                                   00181200
.*-------------------------------------------------------------------   00181300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00181400
&ZXCAPTPTR    SETC  'INPUT'     SET IN/OUTPUT                           00181500
&XCAPTPTR     SETC  '&CAPTPTR(1)'               SET XVARIABLE           00181600
              AIF   (N'&CAPTPTR GT 1).ZG41B     MULTI PARMS             00181700
&XCAPTPTR     SETC  '&CAPTPTR'  SET XVARIABLE                           00181800
.ZG41B        AIF   (K'&CAPTPTR(1) GT 0).ZG41C                          00181900
&ZXCAPTPTR    SETC  ''          RESET IN/OUTPUT                         00182000
&ZMS          SETC  ' '         *KRQDA*                                 00182100
&ZMS          SETC  '&ZMS "CAPTPTR" KEY AND ITS'                        00182200
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00182300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00182400
.ZG41C        ANOP  ,                                                   00182500
.*-------------------------------------------------------------------   00182600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00182700
              AIF   (K'&ZXCAPTPTR LE 0).ZG41R   NOT I/O                 00182800
              AIF   ('&XCAPTPTR'(1,1) NE '(').ZG41R                     00182900
&ZCGPR        SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                        00183000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG41P                        00183100
              AIF   (K'&ZCGPR GT 2).ZG41Q                               00183200
              AIF   ('&ZCGPR' EQ '0').ZG41Q                             00183300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00183400
              AIF   (T'&ZCGPR NE 'N').ZG41Q     INVALID REG NAME        00183500
.ZG41P        ANOP  ,                                                   00183600
              AIF   (T'&ZCGPR NE 'N').ZG41R     NON NUMERIC             00183700
              AIF   ('&ZCGPR' LT '2').ZG41Q                             00183800
              AIF   ('&ZCGPR' LE '12').ZG41R                            00183900
.ZG41Q        ANOP  ,                                                   00184000
&ZMS          SETC  '"CAPTPTR='                 *KGPRA* MNOTE           00184100
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    00184200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00184300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00184400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00184500
.ZG41R        ANOP  ,                                                   00184600
.*----------------------------------------------------------------***   00184700
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00184800
              AIF   (N'&UCBPTR LE 1).ZG44A      CK NUM                  00184900
&ZMS          SETC  '"UCBPTR='  *KPOSA* MNOTE                           00185000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     00185100
&ZMS          SETC  '&ZMS "UCBPTR"'                                     00185200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00185300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00185400
.ZG44A        ANOP  ,                                                   00185500
.*-------------------------------------------------------------------   00185600
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00185700
&ZXUCBPTR     SETC  'OUTPUT'    SET IN/OUTPUT                           00185800
&XUCBPTR      SETC  '&UCBPTR(1)'                SET XVARIABLE           00185900
              AIF   (N'&UCBPTR GT 1).ZG44B      MULTI PARMS             00186000
&XUCBPTR      SETC  '&UCBPTR'   SET XVARIABLE                           00186100
.ZG44B        AIF   (K'&UCBPTR(1) GT 0).ZG44C                           00186200
&ZXUCBPTR     SETC  ''          RESET IN/OUTPUT                         00186300
&ZMS          SETC  ' '         *KRQDA*                                 00186400
&ZMS          SETC  '&ZMS "UCBPTR" KEY AND ITS'                         00186500
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00186600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00186700
.ZG44C        ANOP  ,                                                   00186800
.*-------------------------------------------------------------------   00186900
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00187000
              AIF   (K'&ZXUCBPTR LE 0).ZG44R    NOT I/O                 00187100
              AIF   ('&XUCBPTR'(1,1) NE '(').ZG44R                      00187200
&ZCGPR        SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                          00187300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                        00187400
              AIF   (K'&ZCGPR GT 2).ZG44Q                               00187500
              AIF   ('&ZCGPR' EQ '0').ZG44Q                             00187600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00187700
              AIF   (T'&ZCGPR NE 'N').ZG44Q     INVALID REG NAME        00187800
.ZG44P        ANOP  ,                                                   00187900
              AIF   (T'&ZCGPR NE 'N').ZG44R     NON NUMERIC             00188000
              AIF   ('&ZCGPR' LT '2').ZG44Q                             00188100
              AIF   ('&ZCGPR' LE '12').ZG44R                            00188200
.ZG44Q        ANOP  ,                                                   00188300
&ZMS          SETC  '"UCBPTR='  *KGPRA* MNOTE                           00188400
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     00188500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00188600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00188700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00188800
.ZG44R        ANOP  ,                                                   00188900
.*----------------------------------------------------------------***   00189000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00189100
              AIF   (N'&ASID LE 1).ZG47A        CK NUM                  00189200
&ZMS          SETC  '"ASID='    *KPOSA* MNOTE                           00189300
&ZMS          SETC  '&ZMS.&ASID"'                                       00189400
&ZMS          SETC  '&ZMS "ASID"'                                       00189500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00189600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00189700
.ZG47A        ANOP  ,                                                   00189800
.*-------------------------------------------------------------------   00189900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00190000
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           00190100
&XASID        SETC  'CURRENT'                                           00190200
              AIF   (K'&ASID(1) LE 0).ZG47B     PARM                    00190300
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           00190400
              AIF   (N'&ASID GT 1).ZG47B        MULTI PARMS             00190500
&XASID        SETC  '&ASID'     SET XVARIABLE                           00190600
.ZG47B        ANOP  ,                                                   00190700
.*-------------------------------------------------------------------   00190800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00190900
              AIF   (K'&ZXASID LE 0).ZG47R      NOT I/O                 00191000
         AIF   ('&XASID' EQ 'CURRENT').ZG47R                            00191100
              AIF   ('&XASID'(1,1) NE '(').ZG47R                        00191200
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00191300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                        00191400
              AIF   (K'&ZCGPR GT 2).ZG47Q                               00191500
              AIF   ('&ZCGPR' EQ '0').ZG47Q                             00191600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00191700
              AIF   (T'&ZCGPR NE 'N').ZG47Q     INVALID REG NAME        00191800
.ZG47P        ANOP  ,                                                   00191900
              AIF   (T'&ZCGPR NE 'N').ZG47R     NON NUMERIC             00192000
              AIF   ('&ZCGPR' LT '2').ZG47Q                             00192100
              AIF   ('&ZCGPR' LE '12').ZG47R                            00192200
.ZG47Q        ANOP  ,                                                   00192300
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           00192400
&ZMS          SETC  '&ZMS.&ASID"'                                       00192500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00192600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00192700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00192800
.ZG47R        ANOP  ,                                                   00192900
.*-------------------------------------------------------------------   00193000
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00193100
.ZG49         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00193200
.*----------------------------------------------------------------***   00193300
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00193400
              AIF   (N'&LINKAGE LE 1).ZG51A     CK NUM                  00193500
&ZMS          SETC  '"LINKAGE='                 *KPOSA* MNOTE           00193600
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    00193700
&ZMS          SETC  '&ZMS "LINKAGE"'                                    00193800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00193900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00194000
.ZG51A        ANOP  ,                                                   00194100
.*-------------------------------------------------------------------   00194200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00194300
&XLINKAGE     SETC  ''          INITIALIZE XVARIABLE                    00194400
.ZG52A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG53A                        00194500
&XLINKAGE     SETC  'SYSTEM'    SET KEYWORD                             00194600
.*-------------------------------------------------------------------   00194700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00194800
.ZG53A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG54A                        00194900
&XLINKAGE     SETC  'BRANCH'    SET KEYWORD                             00195000
.*-------------------------------------------------------------------   00195100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00195200
.ZG54A        AIF   (K'&XLINKAGE GT 0).ZG54C    KEYWORD                 00195300
              AIF   (K'&LINKAGE(1) LE 0).ZG54B                          00195400
&ZMS          SETC  '"LINKAGE='                 *KUKWA* MNOTE           00195500
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    00195600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00195700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00195800
&ZMS          SETC  '&ZMS "SYSTEM"'                                     00195900
&ZMS          SETC  '&ZMS OR "BRANCH".'                                 00196000
              MNOTE 8,' &ZMS '                                          00196100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00196200
.ZG54B        ANOP  ,                                                   00196300
&XLINKAGE     SETC  'SYSTEM'    SET DEFAULT KEYWORD                     00196400
.ZG54C        ANOP  ,                                                   00196500
&ZXLINKAGE    SETC  'INPUT'     SET IN/OUTPUT                           00196600
.*----------------------------------------------------------------***   00196700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00196800
              AIF   (N'&RETCODE LE 1).ZG56A     CK NUM                  00196900
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00197000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00197100
&ZMS          SETC  '&ZMS "RETCODE"'                                    00197200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00197300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00197400
.ZG56A        ANOP  ,                                                   00197500
.*-------------------------------------------------------------------   00197600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00197700
              AIF   (K'&RETCODE(1) LE 0).ZG56C  NO PARM                 00197800
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00197900
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00198000
              AIF   (N'&RETCODE GT 1).ZG56C                             00198100
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00198200
.ZG56C        ANOP  ,                                                   00198300
.*-------------------------------------------------------------------   00198400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00198500
              AIF   (K'&ZXRETCODE LE 0).ZG56R   NOT I/O                 00198600
              AIF   ('&XRETCODE'(1,1) NE '(').ZG56R                     00198700
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00198800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG56P                        00198900
              AIF   (K'&ZCGPR GT 2).ZG56Q                               00199000
              AIF   ('&ZCGPR' EQ '0').ZG56Q                             00199100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00199200
              AIF   (T'&ZCGPR NE 'N').ZG56Q     INVALID REG NAME        00199300
.ZG56P        ANOP  ,                                                   00199400
              AIF   (T'&ZCGPR NE 'N').ZG56R     NON NUMERIC             00199500
              AIF   ('&ZCGPR' LT '2').ZG56Q                             00199600
              AIF   ('&ZCGPR' LE '12').ZG56R                            00199700
.ZG56Q        ANOP  ,                                                   00199800
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00199900
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00200000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00200100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00200200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00200300
.ZG56R        ANOP  ,                                                   00200400
.*----------------------------------------------------------------***   00200500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00200600
              AIF   (N'&RSNCODE LE 1).ZG59A     CK NUM                  00200700
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00200800
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00200900
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00201000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00201100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00201200
.ZG59A        ANOP  ,                                                   00201300
.*-------------------------------------------------------------------   00201400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00201500
              AIF   (K'&RSNCODE(1) LE 0).ZG59C  NO PARM                 00201600
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00201700
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00201800
              AIF   (N'&RSNCODE GT 1).ZG59C                             00201900
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00202000
.ZG59C        ANOP  ,                                                   00202100
.*-------------------------------------------------------------------   00202200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00202300
              AIF   (K'&ZXRSNCODE LE 0).ZG59R   NOT I/O                 00202400
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG59R                     00202500
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00202600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                        00202700
              AIF   (K'&ZCGPR GT 2).ZG59Q                               00202800
              AIF   ('&ZCGPR' EQ '0').ZG59Q                             00202900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00203000
              AIF   (T'&ZCGPR NE 'N').ZG59Q     INVALID REG NAME        00203100
.ZG59P        ANOP  ,                                                   00203200
              AIF   (T'&ZCGPR NE 'N').ZG59R     NON NUMERIC             00203300
              AIF   ('&ZCGPR' LT '2').ZG59Q                             00203400
              AIF   ('&ZCGPR' LE '12').ZG59R                            00203500
.ZG59Q        ANOP  ,                                                   00203600
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00203700
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00203800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00203900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00204000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00204100
.ZG59R        ANOP  ,                                                   00204200
.******************************************************************     00204300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00204400
.******************************************************************     00204500
              ACTR  10000                                               00204600
.*-------------------------------------------------------------------   00204700
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00204800
&ZCVAL        SETC  ''          ERROR FIELD                             00204900
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00205000
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00205100
.ZGLIST2      ANOP  ,                                                   00205200
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00205300
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00205400
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00205500
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00205600
              AIF   (&ZAWRK LE 0).ZGLIST2                               00205700
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00205800
              AGO   .ZGLIST2                                            00205900
.*                                                                      00206000
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00206100
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00206200
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00206300
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00206400
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00206500
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00206600
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00206700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00206800
.ZGLISTX      ANOP  ,                                                   00206900
&ZASYSLNDX    SETA  0                                                   00207000
.*-------------------------------------------------------------------   00207100
.***AG.MF04 MF=(SLE)                                                    00207200
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00207300
.*******************************************************************    00207400
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00207500
.*******************************************************************    00207600
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00207700
.*******************************************************************    00207800
.***AE.01  START OF IOSCAPU MACRO CODE                                  00207900
.*******************************************************************    00208000
              LCLC  &M0M0001                 NAME                       00208100
&M0M0001      SETC  '&XLABEL'                SET NAME                   00208200
              AIF   (K'&XLABEL NE 0).XLAB2                              00208300
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00208400
.*                                                                      00208500
.XLAB2        ANOP  ,                                                   00208600
              AIF   ('&XMF' EQ 'L').XLAB3                               00208700
&M0M0001 DS    0H                             IOSCAPU-1                 00208800
.XLAB3        ANOP  ,                                                   00208900
.*******************************************************************    00209000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00209100
.*******************************************************************    00209200
              PUSH  PRINT                                               00209300
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00209400
              PRINT OFF         ++ PR01                                 00209500
              AGO   .ZPRNTXX                                            00209600
.ZPRINTX      PRINT ON                                                  00209700
.ZPRNTXX      ANOP  ,                                                   00209800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00209900
         AIF ('&MSIFREE(1)' EQ 'YES' AND '&LASTING(1)' EQ 'YES').MSG1   00210000
         AIF ('&MSIFREE(1)' EQ 'YES' AND '&CAPTCOM(1)' EQ 'YES').MSG2   00210100
         AIF ('&LASTING(1)' EQ 'YES' AND '&CAPTCOM(1)' EQ 'YES').MSG3   00210200
         AGO .OKAY1                                                     00210300
.MSG1    ANOP                                                           00210400
&ZMS     SETC 'MSIFREE AND LASTING MUTUALLY EXCLUSIVE'                  00210500
         MNOTE 8,'&ZMS'                                                 00210600
         MEXIT                                                          00210700
.MSG2    ANOP                                                           00210800
&ZMS     SETC 'MSIFREE AND CAPTCOM MUTUALLY EXCLUSIVE'                  00210900
         MNOTE 8,'&ZMS'                                                 00211000
         MEXIT                                                          00211100
.MSG3    ANOP                                                           00211200
&ZMS     SETC 'LASTING AND CAPTCOM MUTUALLY EXCLUSIVE'                  00211300
         MNOTE 8,'&ZMS'                                                 00211400
         MEXIT                                                          00211500
.OKAY1   ANOP                                                           00211600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00211700
.********************************************************************   00211800
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00211900
.********************************************************************   00212000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00212100
                      LCLA  &ZOPN1         INVOCATION INDEX             00212200
                      LCLC  &ZOPL(4095)    LABEL                        00212300
                      LCLC  &ZOPO(4095)    OPERATION                    00212400
                      LCLC  &ZOPV(4095)    VALUE                        00212500
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00212600
.*                                                                      00212700
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00212800
.******************************************************************     00212900
.***AL.L10 IOSCAPU FMT=LIST MF=S|L PARAMETERS                           00213000
.******************************************************************     00213100
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00213200
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00213300
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00213400
&XMFATTR              SETC  '0D'                                        00213500
.*                                                                      00213600
&ZOPN                 SETA  &ZOPN+1                                     00213700
&ZOPL(&ZOPN)          SETC  ' '                                         00213800
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00213900
&ZOPO(&ZOPN)          SETC  'B'                                         00214000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00214100
                      AGO   .ZALVL6B                                    00214200
.ZALVL6A              ANOP                                              00214300
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00214400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00214500
.ZALVL6B              ANOP                                              00214600
&ZOPD(&ZOPN)          SETC  '++ IOSCAPU ARG PARMS'                      00214700
.*                                                                      00214800
&ZOPN                 SETA  &ZOPN+1                                     00214900
&ZOPL(&ZOPN)          SETC  ' '                                         00215000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00215100
&ZOPV(&ZOPN)          SETC  '1'                                         00215200
&ZOPD(&ZOPN)          SETC  ' '                                         00215300
.*                                                                      00215400
.ZLMFSL2              ANOP  ,                                           00215500
.*-------------------------------------------------------------------   00215600
.***AM.L00  IOSCAPU FMT=LIST name                                       00215700
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00215800
&ZOPN                 SETA &ZOPN+1                                      00215900
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00216000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00216100
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00216200
&ZOPD(&ZOPN)          SETC '++ IOSCAPU NAME'                            00216300
.ZLMFSL2M             ANOP  ,                                           00216400
.*-------------------------------------------------------------------   00216500
.***AM.L01  IOSCAPU FMT=LIST PARAMETERS                                 00216600
&ZOPN                 SETA &ZOPN+1                                      00216700
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00216800
&ZOPO(&ZOPN)          SETC 'DS'                                         00216900
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00217000
&ZOPD(&ZOPN)          SETC '++ IOSCAPU PARM LIST'                       00217100
.*-------------------------------------------------------------------   00217200
.***AM.L02 XVERSION XL1                                                 00217300
&ZOPN                 SETA &ZOPN+1                                      00217400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00217500
&ZOPO(&ZOPN)          SETC 'DS'                                         00217600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00217700
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00217800
.*-------------------------------------------------------------------   00217900
.***AM.L03 XFLAGS1 BL.8                                                 00218000
&ZOPN                 SETA &ZOPN+1                                      00218100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS1'                          00218200
&ZOPO(&ZOPN)          SETC 'DS'                                         00218300
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00218400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00218500
.*                                                                      00218600
&ZOPN                 SETA  &ZOPN+1                                     00218700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CAPTUCB'                 00218800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00218900
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00219000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00219100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CAPTUCB'                      00219200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00219300
.*                                                                      00219400
&ZOPN                 SETA  &ZOPN+1                                     00219500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCAPTUCB'                00219600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00219700
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00219800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00219900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCAPTUCB'                     00220000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00220100
.*                                                                      00220200
&ZOPN                 SETA  &ZOPN+1                                     00220300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CAPTOACT'                00220400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00220500
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00220600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00220700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CAPTOACT'                     00220800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00220900
.*                                                                      00221000
&ZOPN                 SETA  &ZOPN+1                                     00221100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ASID'                    00221200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00221300
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00221400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00221500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ASID'                         00221600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00221700
.*                                                                      00221800
&ZOPN                 SETA  &ZOPN+1                                     00221900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBPTR'                  00222000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00222100
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00222200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00222300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBPTR'                       00222400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00222500
.*                                                                      00222600
&ZOPN                 SETA  &ZOPN+1                                     00222700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CAPTPTR'                 00222800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00222900
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00223000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00223100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CAPTPTR'                      00223200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00223300
.*-------------------------------------------------------------------   00223400
.***AM.L09  XRESERVED1 CL2                                              00223500
&ZOPN                 SETA &ZOPN+1                                      00223600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00223700
&ZOPO(&ZOPN)          SETC 'DS'                                         00223800
&ZOPV(&ZOPN)          SETC 'CL2'                                        00223900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 00224000
.*-------------------------------------------------------------------   00224100
.***AM.L09  XUCBPTR A                                                   00224200
&ZOPN                 SETA &ZOPN+1                                      00224300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPTR'                          00224400
&ZOPO(&ZOPN)          SETC 'DS'                                         00224500
&ZOPV(&ZOPN)          SETC 'A'                                          00224600
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPTR  XUCBPTR'                      00224700
.*-------------------------------------------------------------------   00224800
.***AM.L09  XCAPTPTR A                                                  00224900
&ZOPN                 SETA &ZOPN+1                                      00225000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCAPTPTR'                         00225100
&ZOPO(&ZOPN)          SETC 'DS'                                         00225200
&ZOPV(&ZOPN)          SETC 'A'                                          00225300
&ZOPD(&ZOPN)          SETC '++ &ZXCAPTPTR  XCAPTPTR'                    00225400
.*-------------------------------------------------------------------   00225500
.***AM.L09  XRESERVED2 CL1                                              00225600
&ZOPN                 SETA &ZOPN+1                                      00225700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00225800
&ZOPO(&ZOPN)          SETC 'DS'                                         00225900
&ZOPV(&ZOPN)          SETC 'CL1'                                        00226000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED2'                 00226100
.*-------------------------------------------------------------------   00226200
.***AM.L03 XMASK BL.8                                                   00226300
&ZOPN                 SETA &ZOPN+1                                      00226400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMASK'                            00226500
&ZOPO(&ZOPN)          SETC 'DS'                                         00226600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00226700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00226800
.*                                                                      00226900
&ZOPN                 SETA  &ZOPN+1                                     00227000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSIFREE_YES'                    00227100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00227200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00227300
&ZOPD(&ZOPN)          SETC  '++ XMSIFREE.'                              00227400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00227500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00227600
.*                                                                      00227700
&ZOPN                 SETA  &ZOPN+1                                     00227800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XLASTING_YES'                    00227900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00228000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00228100
&ZOPD(&ZOPN)          SETC  '++ XLASTING.'                              00228200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00228300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00228400
.*                                                                      00228500
&ZOPN                 SETA  &ZOPN+1                                     00228600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCAPTCOM_YES'                    00228700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00228800
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00228900
&ZOPD(&ZOPN)          SETC  '++ XCAPTCOM.'                              00229000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00229100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00229200
.*                                                                      00229300
&ZOPN                 SETA  &ZOPN+1                                     00229400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCAPTCOM_NEVER'                  00229500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00229600
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00229700
&ZOPD(&ZOPN)          SETC  '++ XCAPTCOM.'                              00229800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NEVER'                        00229900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00230000
.*-------------------------------------------------------------------   00230100
.***AM.L09  XASID XL2                                                   00230200
&ZOPN                 SETA &ZOPN+1                                      00230300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XASID'                            00230400
&ZOPO(&ZOPN)          SETC 'DS'                                         00230500
&ZOPV(&ZOPN)          SETC 'XL2'                                        00230600
&ZOPD(&ZOPN)          SETC '++ &ZXASID  XASID'                          00230700
.*-------------------------------------------------------------------   00230800
.***AM.L09  XRESERVED3 CL16                                             00230900
&ZOPN                 SETA &ZOPN+1                                      00231000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED3'                       00231100
&ZOPO(&ZOPN)          SETC 'DS'                                         00231200
&ZOPV(&ZOPN)          SETC 'CL16'                                       00231300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED3'                 00231400
.*-------------------------------------------------------------------   00231500
.***AM.L10 END OF IOSCAPU LIST PARAMETERS                               00231600
&ZOPN                 SETA &ZOPN+1                                      00231700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00231800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00231900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00232000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00232100
.*                                                                      00232200
&ZOPN                 SETA &ZOPN+1                                      00232300
&ZOPL(&ZOPN)          SETC ' '                                          00232400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00232500
&ZOPV(&ZOPN)          SETC '1'                                          00232600
&ZOPD(&ZOPN)          SETC ' '                                          00232700
.*-------------------------------------------------------------------   00232800
.***AL.L12 IOSCAPU FMT=LIST MF=S|L PARAMETERS                           00232900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00233000
.*                                                                      00233100
&ZOPN                 SETA  &ZOPN+1                                     00233200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00233300
&ZOPO(&ZOPN)          SETC  'DC'                                        00233400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00233500
&ZOPD(&ZOPN)          SETC  '++ IOSCAPU ARG PARMS'                      00233600
.*                                                                      00233700
.ZLMFSLX              ANOP  ,                                           00233800
.*-------------------------------------------------------------------   00233900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00234000
&ZPLLEN               SETA 32                                           00234100
.*                                                                      00234200
.******************************************************************     00234300
.***AI.L01 IOSCAPU FMT=LIST FILL IN PARAMETER AREA                      00234400
.******************************************************************     00234500
                      ACTR  10000                                       00234600
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00234700
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00234800
&ZCVAL                SETC  'LAE'          XAX MODE                     00234900
.ZIMFXA               ANOP ,                                            00235000
.*                                                                      00235100
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00235200
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00235300
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00235400
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00235500
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00235600
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00235700
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00235800
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00235900
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00236000
&ZOPN                 SETA  &ZOPN+1                                     00236100
&ZOPL(&ZOPN)          SETC  ' '                                         00236200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00236300
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00236400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00236500
                      AGO   .ZIMFNX                                     00236600
.*                                                                      00236700
.ZIMFN2               ANOP ,                                            00236800
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00236900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00237000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00237100
&ZOPN                 SETA  &ZOPN+1                                     00237200
&ZOPL(&ZOPN)          SETC  ' '                                         00237300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00237400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00237500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00237600
                      AGO   .ZIMFNX                                     00237700
.ZIMFNX1              ANOP ,                                            00237800
&ZOPN                 SETA  &ZOPN+1                                     00237900
&ZOPL(&ZOPN)          SETC  ' '                                         00238000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00238100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00238200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00238300
.ZIMFNX               ANOP ,                                            00238400
.********************************************************************   00238500
.***AI.L02 IOSCAPU FMT=LIST INITIALIZE PARAMETER AREA                   00238600
.********************************************************************   00238700
.***AI.L03 MF=(SLE)                                                     00238800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00238900
.*                                                                      00239000
&ZOPN                 SETA  &ZOPN+1                                     00239100
&ZOPL(&ZOPN)          SETC  ' '                                         00239200
&ZOPO(&ZOPN)          SETC  'XC'                                        00239300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00239400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00239500
.ZIMFLX               ANOP  ,                                           00239600
.*-------------------------------------------------------------------   00239700
.***AI.L04A XVERSION XL1                                                00239800
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00239900
&ZOPN                 SETA  &ZOPN+1                                     00240000
&ZOPL(&ZOPN)          SETC  ' '                                         00240100
&ZOPO(&ZOPN)          SETC  'MVI'                                       00240200
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00240300
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00240400
.ZIMFVW               ANOP  ,                                           00240500
.*-------------------------------------------------------------------   00240600
.***AI.L05 XFLAGS1 BL1                                                  00240700
&ZW                   SETC  ''                                          00240800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00240900
.*-------------------------------------------------------------------   00241000
.***AI.L08 XFLAGS1 "CAPTUCB"                                            00241100
.***      BL1'1XXXXXXX'                                                 00241200
         AIF   ('&XCAPTUCB' EQ '').ZI3A                                 00241300
&ZW                   SETC  '&ZW.1'                                     00241400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00241500
                      AGO   .ZI3C                                       00241600
.*                                                                      00241700
.ZI3A                 ANOP  ,                                           00241800
&ZW                   SETC  '&ZW.0'                                     00241900
.ZI3C                 ANOP  ,                                           00242000
.*-------------------------------------------------------------------   00242100
.***AI.L08 XFLAGS1 "UCAPTUCB"                                           00242200
.***      BL1'X1XXXXXX'                                                 00242300
         AIF   ('&XUCAPTUCB' EQ '').ZI4A                                00242400
&ZW                   SETC  '&ZW.1'                                     00242500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00242600
                      AGO   .ZI4C                                       00242700
.*                                                                      00242800
.ZI4A                 ANOP  ,                                           00242900
&ZW                   SETC  '&ZW.0'                                     00243000
.ZI4C                 ANOP  ,                                           00243100
.*-------------------------------------------------------------------   00243200
.***AI.L08 XFLAGS1 "CAPTOACT"                                           00243300
.***      BL1'XX1XXXXX'                                                 00243400
         AIF   ('&XCAPTOACT' EQ '').ZI5A                                00243500
&ZW                   SETC  '&ZW.1'                                     00243600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00243700
                      AGO   .ZI5C                                       00243800
.*                                                                      00243900
.ZI5A                 ANOP  ,                                           00244000
&ZW                   SETC  '&ZW.0'                                     00244100
.ZI5C                 ANOP  ,                                           00244200
.*-------------------------------------------------------------------   00244300
.***AI.L08 XFLAGS1 "ASID"                                               00244400
.***      BL1'XXX1XXXX'                                                 00244500
         AIF   ('&ASID' EQ '').ZI6A                                     00244600
&ZW                   SETC  '&ZW.1'                                     00244700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00244800
                      AGO   .ZI6C                                       00244900
.*                                                                      00245000
.ZI6A                 ANOP  ,                                           00245100
&ZW                   SETC  '&ZW.0'                                     00245200
.ZI6C                 ANOP  ,                                           00245300
.*-------------------------------------------------------------------   00245400
.***AI.L08 XFLAGS1 "UCBPTR"                                             00245500
.***      BL1'XXXX1XXX'                                                 00245600
         AIF   ('&UCBPTR' EQ '').ZI7A                                   00245700
&ZW                   SETC  '&ZW.1'                                     00245800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00245900
                      AGO   .ZI7C                                       00246000
.*                                                                      00246100
.ZI7A                 ANOP  ,                                           00246200
&ZW                   SETC  '&ZW.0'                                     00246300
.ZI7C                 ANOP  ,                                           00246400
.*-------------------------------------------------------------------   00246500
.***AI.L08 XFLAGS1 "CAPTPTR"                                            00246600
.***      BL1'XXXXX1XX'                                                 00246700
         AIF   ('&CAPTPTR' EQ '').ZI8A                                  00246800
&ZW                   SETC  '&ZW.100'                                   00246900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00247000
                      AGO   .ZI8C                                       00247100
.*                                                                      00247200
.ZI8A                 ANOP  ,                                           00247300
&ZW                   SETC  '&ZW.000'                                   00247400
.ZI8C                 ANOP  ,                                           00247500
.*-------------------------------------------------------------------   00247600
.***AI.L11 XFLAGS1 BL1                                                  00247700
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     00247800
&ZOPN                 SETA  &ZOPN+1                                     00247900
&ZOPL(&ZOPN)          SETC  ' '                                         00248000
&ZOPO(&ZOPN)          SETC  'OI'                                        00248100
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00248200
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             00248300
.ZI8E                 ANOP  ,                                           00248400
.*-------------------------------------------------------------------   00248500
.***AI.L25  XUCBPTR AL4                                                 00248600
                      AIF   ('&ZXUCBPTR' EQ '').ZI10E                   00248700
                      AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZI10E             00248800
&ZCGPR                SETC  '&XUCBPTR'                                  00248900
.*                                                                      00249000
                      AIF   ('&XUCBPTR'(1,1) NE '(').ZI10B              00249100
&ZCGPR   SETC  '0('.'&XUCBPTR'(2,K'&XUCBPTR-2).')'                      00249200
                      AGO   .ZI10D                                      00249300
.ZI10B                ANOP  ,                                           00249400
.*                                                                      00249500
&ZC                   SETC  '&XUCBPTR'(1,1)                             00249600
                      AIF   (T'&ZC NE 'N').ZI10D                        00249700
&ZC                   SETC  '&XUCBPTR'                                  00249800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00249900
&ZCGPR                SETC  '=AL4(&XUCBPTR)'                            00250000
.*                                                                      00250100
.ZI10D                ANOP  ,                                           00250200
.*                                                                      00250300
&ZOPN                 SETA  &ZOPN+1                                     00250400
&ZOPL(&ZOPN)          SETC  ' '                                         00250500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00250600
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00250700
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPTR XUCBPTR'                      00250800
.*                                                                      00250900
.ZI10E                ANOP  ,                                           00251000
.*-------------------------------------------------------------------   00251100
.***AI.L25  XCAPTPTR AL4                                                00251200
                      AIF   ('&ZXCAPTPTR' EQ '').ZI11E                  00251300
                      AIF   ('&ZXCAPTPTR' EQ 'OUTPUT').ZI11E            00251400
&ZCGPR                SETC  '&XCAPTPTR'                                 00251500
.*                                                                      00251600
                      AIF   ('&XCAPTPTR'(1,1) NE '(').ZI11B             00251700
&ZCGPR   SETC  '0('.'&XCAPTPTR'(2,K'&XCAPTPTR-2).')'                    00251800
                      AGO   .ZI11D                                      00251900
.ZI11B                ANOP  ,                                           00252000
.*                                                                      00252100
&ZC                   SETC  '&XCAPTPTR'(1,1)                            00252200
                      AIF   (T'&ZC NE 'N').ZI11D                        00252300
&ZC                   SETC  '&XCAPTPTR'                                 00252400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00252500
&ZCGPR                SETC  '=AL4(&XCAPTPTR)'                           00252600
.*                                                                      00252700
.ZI11D                ANOP  ,                                           00252800
.*                                                                      00252900
&ZOPN                 SETA  &ZOPN+1                                     00253000
&ZOPL(&ZOPN)          SETC  ' '                                         00253100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00253200
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00253300
&ZOPD(&ZOPN)          SETC  '++ &ZXCAPTPTR XCAPTPTR'                    00253400
.*                                                                      00253500
.ZI11E                ANOP  ,                                           00253600
.*-------------------------------------------------------------------   00253700
.***AI.L05 XMASK BL1                                                    00253800
&ZW                   SETC  ''                                          00253900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00254000
.*-------------------------------------------------------------------   00254100
.***AI.L08 XMASK "YES"                                                  00254200
.***      BL1'1XXXXXXX'                                                 00254300
         AIF   ('&XMSIFREE' NE 'YES').ZI14A                             00254400
&ZW                   SETC  '&ZW.1'                                     00254500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00254600
                      AGO   .ZI14C                                      00254700
.*                                                                      00254800
.ZI14A                ANOP  ,                                           00254900
&ZW                   SETC  '&ZW.0'                                     00255000
.ZI14C                ANOP  ,                                           00255100
.*-------------------------------------------------------------------   00255200
.***AI.L08 XMASK "YES"                                                  00255300
.***      BL1'X1XXXXXX'                                                 00255400
         AIF   ('&XLASTING' NE 'YES').ZI15A                             00255500
&ZW                   SETC  '&ZW.1'                                     00255600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00255700
                      AGO   .ZI15C                                      00255800
.*                                                                      00255900
.ZI15A                ANOP  ,                                           00256000
&ZW                   SETC  '&ZW.0'                                     00256100
.ZI15C                ANOP  ,                                           00256200
.*-------------------------------------------------------------------   00256300
.***AI.L08 XMASK "YES"                                                  00256400
.***      BL1'XX1XXXXX'                                                 00256500
         AIF   ('&XCAPTCOM' NE 'YES').ZI16A                             00256600
&ZW                   SETC  '&ZW.1'                                     00256700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00256800
                      AGO   .ZI16C                                      00256900
.*                                                                      00257000
.ZI16A                ANOP  ,                                           00257100
&ZW                   SETC  '&ZW.0'                                     00257200
.ZI16C                ANOP  ,                                           00257300
.*-------------------------------------------------------------------   00257400
.***AI.L08 XMASK "NEVER"                                                00257500
.***      BL1'XXX1XXXX'                                                 00257600
         AIF   ('&XCAPTCOM' NE 'NEVER').ZI17A                           00257700
&ZW                   SETC  '&ZW.10000'                                 00257800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00257900
                      AGO   .ZI17C                                      00258000
.*                                                                      00258100
.ZI17A                ANOP  ,                                           00258200
&ZW                   SETC  '&ZW.00000'                                 00258300
.ZI17C                ANOP  ,                                           00258400
.*-------------------------------------------------------------------   00258500
.***AI.L11 XMASK BL1                                                    00258600
                      AIF   ('&ZCLNG' NE 'YES').ZI17E  ALL ZERO BITS    00258700
&ZOPN                 SETA  &ZOPN+1                                     00258800
&ZOPL(&ZOPN)          SETC  ' '                                         00258900
&ZOPO(&ZOPN)          SETC  'OI'                                        00259000
&ZOPV(&ZOPN)          SETC  '13(1),B''&ZW'''                            00259100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00259200
.ZI17E                ANOP  ,                                           00259300
.*-------------------------------------------------------------------   00259400
.***AI.L18  XASID XL2                                                   00259500
         AIF   ('&XASID' NE 'CURRENT').ZI18                             00259600
&ZXASID               SETC  ''             RESET INPUT/OUTPUT           00259700
.ZI18                 ANOP  ,                                           00259800
.*-------------------------------------------------------------------   00259900
.***AI.L25  XASID XL2                                                   00260000
                      AIF   ('&ZXASID' EQ '').ZI18E                     00260100
                      AIF   ('&ZXASID' EQ 'OUTPUT').ZI18E               00260200
&ZCGPR                SETC  '&XASID'                                    00260300
.*                                                                      00260400
                      AIF   ('&XASID'(1,1) NE '(').ZI18B                00260500
&ZCGPR   SETC  '0('.'&XASID'(2,K'&XASID-2).')'                          00260600
                      AGO   .ZI18D                                      00260700
.ZI18B                ANOP  ,                                           00260800
.*                                                                      00260900
&ZC                   SETC  '&XASID'(1,1)                               00261000
                      AIF   (T'&ZC NE 'N').ZI18D                        00261100
&ZC                   SETC  '&XASID'                                    00261200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               00261300
&ZCGPR                SETC  '=AL2(&XASID)'                              00261400
.*                                                                      00261500
.ZI18D                ANOP  ,                                           00261600
.*                                                                      00261700
&ZOPN                 SETA  &ZOPN+1                                     00261800
&ZOPL(&ZOPN)          SETC  ' '                                         00261900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00262000
&ZOPV(&ZOPN)          SETC  '14(2,1),&ZCGPR'                            00262100
&ZOPD(&ZOPN)          SETC  '++ &ZXASID XASID'                          00262200
.*                                                                      00262300
.ZI18E                ANOP  ,                                           00262400
.*-------------------------------------------------------------------   00262500
&ZOPN1                SETA &ZOPN                                        00262600
.*******************************************************************    00262700
.***  PROCESS IOSCAPU OUTPUT PARAMETERS                                 00262800
.*******************************************************************    00262900
                      ACTR  10000                                       00263000
.*------------------------------------------------------------------    00263100
.***AO.L02 XUCBPTR A                                                    00263200
         AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZO10A  OUTPUT                  00263300
         AIF   ('&ZXUCBPTR' NE 'INOUT').ZO10C  INOUT                    00263400
.ZO10A    AIF   ('&XUCBPTR'(1,1) NE '(').ZO10B  ADDR IN GPR             00263500
&ZCGPR   SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                               00263600
&ZOPN                 SETA  &ZOPN+1                                     00263700
&ZOPL(&ZOPN)          SETC  ' '                                         00263800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00263900
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),4(1)'                          00264000
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              00264100
                      AGO   .ZO10C                                      00264200
.*                                                                      00264300
.ZO10B                ANOP  ,                                           00264400
&ZAWRK   SETA  K'&XUCBPTR                                               00264500
         AIF   ('&XUCBPTR'(&ZAWRK,1) NE ')').ZO10G                      00264600
&ZN      SETA  2                                                        00264700
.ZO10H    ANOP                                                          00264800
         AIF   (&ZN GE &ZAWRK).ZO10G                                    00264900
         AIF   ('&XUCBPTR'(&ZN,1) NE '(').ZO10I                         00265000
&ZC      SETC  '&XUCBPTR'(1,&ZN).'4'.','                                00265100
&ZC      SETC  '&ZC'.'&XUCBPTR'(&ZN+1,&ZAWRK-&ZN).',4(1)'               00265200
         AGO   .ZO10J                                                   00265300
.ZO10I    ANOP                                                          00265400
&ZN      SETA  &ZN+1                                                    00265500
         AGO   .ZO10H                                                   00265600
.ZO10G    ANOP                                                          00265700
&ZC      SETC  '&XUCBPTR.(4),4(1)'                                      00265800
.ZO10J    ANOP                                                          00265900
&ZOPN                 SETA  &ZOPN+1                                     00266000
&ZOPL(&ZOPN)          SETC  ' '                                         00266100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00266200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00266300
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              00266400
.ZO10C                ANOP  ,                                           00266500
.*------------------------------------------------------------------    00266600
.***AO.L02 XCAPTPTR A                                                   00266700
         AIF   ('&ZXCAPTPTR' EQ 'OUTPUT').ZO11A  OUTPUT                 00266800
         AIF   ('&ZXCAPTPTR' NE 'INOUT').ZO11C  INOUT                   00266900
.ZO11A    AIF   ('&XCAPTPTR'(1,1) NE '(').ZO11B  ADDR IN GPR            00267000
&ZCGPR   SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                             00267100
&ZOPN                 SETA  &ZOPN+1                                     00267200
&ZOPL(&ZOPN)          SETC  ' '                                         00267300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00267400
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),8(1)'                          00267500
&ZOPD(&ZOPN)          SETC  '++ XCAPTPTR A'                             00267600
                      AGO   .ZO11C                                      00267700
.*                                                                      00267800
.ZO11B                ANOP  ,                                           00267900
&ZAWRK   SETA  K'&XCAPTPTR                                              00268000
         AIF   ('&XCAPTPTR'(&ZAWRK,1) NE ')').ZO11G                     00268100
&ZN      SETA  2                                                        00268200
.ZO11H    ANOP                                                          00268300
         AIF   (&ZN GE &ZAWRK).ZO11G                                    00268400
         AIF   ('&XCAPTPTR'(&ZN,1) NE '(').ZO11I                        00268500
&ZC      SETC  '&XCAPTPTR'(1,&ZN).'4'.','                               00268600
&ZC      SETC  '&ZC'.'&XCAPTPTR'(&ZN+1,&ZAWRK-&ZN).',8(1)'              00268700
         AGO   .ZO11J                                                   00268800
.ZO11I    ANOP                                                          00268900
&ZN      SETA  &ZN+1                                                    00269000
         AGO   .ZO11H                                                   00269100
.ZO11G    ANOP                                                          00269200
&ZC      SETC  '&XCAPTPTR.(4),8(1)'                                     00269300
.ZO11J    ANOP                                                          00269400
&ZOPN                 SETA  &ZOPN+1                                     00269500
&ZOPL(&ZOPN)          SETC  ' '                                         00269600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00269700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00269800
&ZOPD(&ZOPN)          SETC  '++ XCAPTPTR A'                             00269900
.ZO11C                ANOP  ,                                           00270000
.*******************************************************************    00270100
.***AO.X02  RETURN CODE PROCESSING                                      00270200
.*******************************************************************    00270300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00270400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00270500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00270600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00270700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00270800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00270900
&ZOPN                 SETA  &ZOPN+1                                     00271000
&ZOPL(&ZOPN)          SETC  ' '                                         00271100
&ZOPO(&ZOPN)          SETC  'ST'                                        00271200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00271300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00271400
                      AGO   .ZMRETX                                     00271500
.*                                                                      00271600
.ZMRET2               ANOP  ,                                           00271700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00271800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00271900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00272000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00272100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00272200
&ZOPN                 SETA  &ZOPN+1                                     00272300
&ZOPL(&ZOPN)          SETC  ' '                                         00272400
&ZOPO(&ZOPN)          SETC  'LR'                                        00272500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00272600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00272700
.ZMRETX               ANOP  ,                                           00272800
.*******************************************************************    00272900
.***AO.X03  REASON CODE PROCESSING                                      00273000
.*******************************************************************    00273100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00273200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00273300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00273400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00273500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00273600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00273700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00273800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00273900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00274000
&ZOPN                 SETA  &ZOPN+1                                     00274100
&ZOPL(&ZOPN)          SETC  ' '                                         00274200
&ZOPO(&ZOPN)          SETC  'ST'                                        00274300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00274400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00274500
                      AGO   .ZMRSNX                                     00274600
.*                                                                      00274700
.ZMRSN2               ANOP  ,                                           00274800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00274900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00275000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00275100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00275200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00275300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00275400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00275500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00275600
&ZOPN                 SETA  &ZOPN+1                                     00275700
&ZOPL(&ZOPN)          SETC  ' '                                         00275800
&ZOPO(&ZOPN)          SETC  'LR'                                        00275900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00276000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00276100
.ZMRSNX               ANOP  ,                                           00276200
.*******************************************************************    00276300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00276400
.*******************************************************************    00276500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00276600
.*******************************************************************    00276700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00276800
.*******************************************************************    00276900
                      ACTR  10000                                       00277000
.*                                                                      00277100
                      LCLA  &ZLC           COLUMN POSITION              00277200
                      LCLA  &ZOPX          LIST TABLE INDEX             00277300
                      LCLC  &ZLL           LABEL                        00277400
                      LCLC  &ZLOP          OPERATION                    00277500
                      LCLC  &ZLV           VALUE                        00277600
                      LCLC  &ZLD           DESCRIPTION                  00277700
.*                                                                      00277800
&ZOPX                 SETA  1                                           00277900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00278000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00278100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00278200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00278300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00278400
                      AIF   (K'&ZLD LE 0).ZL5                           00278500
&ZLC                  SETA  35             COMMENT COLUMN               00278600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00278700
&ZLC                  SETA  33             COMMMENT COLUMN              00278800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00278900
&ZLV                  SETC  '&ZLV'.' '                                  00279000
                      AGO   .ZL3                                        00279100
.*                                                                      00279200
.ZL4                  ANOP  ,                                           00279300
&ZLV                  SETC  '&ZLV'.' '                                  00279400
.ZL5                  ANOP  ,                                           00279500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00279600
.*                                                                      00279700
&ZLL     &ZLOP &ZLV                                                     00279800
.*                                                                      00279900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00280000
                      AGO   .ZL2           CONTINUE LOOPING             00280100
.*                                                                      00280200
.ZLX                  ANOP  ,                                           00280300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00280400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00280500
.*-----------BAL invocation code-------------                           00280600
.*********************************************************************  00280700
.*                                                                   *  00280800
.*  Branch or PC linkage                                             *  00280900
.*                                                                   *  00281000
.*********************************************************************  00281100
         LA    0,1                ++ SET IOSCAPU FUNCTION CODE          00281200
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        00281300
.*********************************************************************  00281400
.*                                                                   *  00281500
.*  Switch to AMODE 31 to access the IOVT.                           *  00281600
.*                                                                   *  00281700
.*********************************************************************  00281800
         LA    14,IOSCAPU_RETADDR_&SYSNDX     SAVE RETURN ADDRESS       00281900
         BSM   14,0                SAVE CALLER AMODE BIT INTO HIGH      00282000
*                                  ORDER BIT OF R14                     00282100
         LA    15,IOSCAPU_NXTADDR_&SYSNDX     GET THE NEXT ADDRESS      00282200
*                                                                 @01C  00282300
         O     15,IOSCAPU_X31_&SYSNDX         SET 31 BIT ADDRESSING     00282400
*                                                                 @01A  00282500
         BSM   0,15                SWITCH TO 31 BITE ADDRESSING MODE    00282600
IOSCAPU_X31_&SYSNDX  DC A(X'80000000')  FOR 31 BIT ADDRESSING     @01C  00282700
IOSCAPU_NXTADDR_&SYSNDX  DS    0H      FOR SWITCHING ADDR MODE.   @01C  00282800
.*********************************************************************  00282900
.*                                                                   *  00283000
.*  Get addressability to CVT                                        *  00283100
.*                                                                   *  00283200
.*********************************************************************  00283300
         L     15,16(0,0)                                               00283400
.*********************************************************************  00283500
.*                                                                   *  00283600
.*  Get addressability to IOCOM                                      *  00283700
.*                                                                   *  00283800
.*********************************************************************  00283900
         L     15,124(15,0)                                             00284000
.*********************************************************************  00284100
.*                                                                   *  00284200
.*  Get addressability to IOVT                                       *  00284300
.*                                                                   *  00284400
.*********************************************************************  00284500
         L     15,208(15,0)                                             00284600
         L     15,140(15,0)       ++ SET ADDR OF IOSVCAPB               00284700
         BR    15                 ++ BRANCH TO IOSVCAPB                 00284800
IOSCAPU_RETADDR_&SYSNDX  DS    0H  FOR SWIT. ADDR MODE                  00284900
         AGO   .DONE1                                                   00285000
.LNKPC1  ANOP                                                           00285100
         L     14,16(0,0)         ++ GET CVT ADDRESS                    00285200
         L     14,772(14,0)       ++ GET SFT ADDRESS                    00285300
.*********************************************************************  00285400
.*                                                                   *  00285500
.*  Get LX/EX for UCB Services                                       *  00285600
.*                                                                   *  00285700
.*  Note: LX/EX is calculated by multiplying the PC number (106)     *  00285800
.*        times the length of a PC/AUTH table entry (4) and          *  00285900
.*        then subtracting 4.                                        *  00286000
.*                                                                   *  00286100
.*********************************************************************  00286200
         L     14,420(14,0)       ++ GET LX/EX FOR Capture Service      00286300
         PC    0(14)              ++ PC TO IOSVCAPU                     00286400
.DONE1   ANOP                                                           00286500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00286600
.ZLINKX               ANOP  ,                                           00286700
.*******************************************************************    00286800
.***AP.X01  FORMAT GENERATED CODE                                       00286900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00287000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00287100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00287200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00287300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00287400
                      AIF   (K'&ZLD LE 0).ZL51                          00287500
&ZLC                  SETA  35             COMMENT COLUMN               00287600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00287700
&ZLC                  SETA  33             COMMENT COLUMN               00287800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00287900
&ZLV                  SETC  '&ZLV'.' '                                  00288000
                      AGO   .ZL31                                       00288100
.*                                                                      00288200
.ZL41                 ANOP  ,                                           00288300
&ZLV                  SETC  '&ZLV'.' '                                  00288400
.ZL51                 ANOP  ,                                           00288500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00288600
.*                                                                      00288700
&ZLL     &ZLOP &ZLV                                                     00288800
.*                                                                      00288900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00289000
                      AGO   .ZL21          CONTINUE LOOPING             00289100
.*                                                                      00289200
.ZLX1                 ANOP  ,                                           00289300
.*******************************************************************    00289400
.***AP.X02  END OF IOSCAPU MACRO                                        00289500
&ZIOSCAPU             SETC  'YES'          SET IOSCAPU USED             00289600
         POP   PRINT                                                    00289700
*                                            IOSCAPU-1                  00289800
         SPACE 1                                                        00289900
.ZLX2                 ANOP  ,                                           00290000
         MEND                                                           00290100
**********************************************************************/ 00290200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00290300
*%IOSCAPU: MACRO KEYS(CAPTUCB,UCBPTR,CAPTPTR,MSIFREE,LASTING,CAPTCOM,   00290400
*                 UCAPTUCB,CAPTOACT,ASID,LINKAGE,RETCODE,RSNCODE,       00290500
*                 PLISTVER,MF);                                         00290600
*  ANS('?'||MACLABEL||' '||'IOSCAPUP '||MACLIST||                       00290700
*         ' '||MACKEYS||';') COL(MACLMAR);                              00290800
*%END IOSCAPU;                                                          00290900
