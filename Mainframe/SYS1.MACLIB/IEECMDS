*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IEECMDS                               -03/29/01-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Query/Remove Attached Commands                * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00001200
*                                                                     * 00001300
* STATUS= HBB7703                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      This macro provides the same function as the CMDS operator     * 00002000
*      command.                                                       * 00002100
*                                                                     * 00002200
*      It can be used to obtain information about MVS commands which  * 00002300
*      are attached, or waiting to be attached, in the *MASTER* or    * 00002400
*      CONSOLE address spaces.                                        * 00002500
*                                                                     * 00002600
*      It can also be used to remove commands which are waiting, but  * 00002700
*      not to cancel commands which are already executing.            * 00002800
*                                                                     * 00002900
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00003000
*                                                                     * 00003100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003200
*                                                                     * 00003300
*01* ENVIRONMENT:                                                     * 00003400
*                                                                     * 00003500
*                                                                     * 00003600
*      Minimum authorization: Supervisor state or  System PSW key.    * 00003700
*                                                                     * 00003800
*      Dispatchable unit mode: Task mode.                             * 00003900
*                                                                     * 00004000
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00004100
*                                                                     * 00004200
*      AMODE:            31-bit.                                      * 00004300
*                                                                     * 00004400
*      ASC mode:         Primary or Access Register.                  * 00004500
*                                                                     * 00004600
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004700
*                                                                     * 00004800
*      Locks:            No locks held.                               * 00004900
*                                                                     * 00005000
*      Control parameters: Control parameters must be in the primary  * 00005100
*                        address space.                               * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*01* PROGRAMMING REQUIREMENTS:                                        * 00005600
*                                                                     * 00005700
*    The calling program may include mapping macro IEEZB889 which can * 00005800
*    be used to map the information which is returned in the buffer   * 00005900
*    specified as BUFFER.                                             * 00006000
*                                                                     * 00006100
*01* RESTRICTIONS:                                                    * 00006200
*                                                                     * 00006300
*    The caller cannot be protected by an FRR.                        * 00006400
*                                                                     * 00006500
*01* PERFORMANCE IMPLICATIONS:                                        * 00006600
*                                                                     * 00006700
*    None.                                                            * 00006800
*                                                                     * 00006900
*01* INPUT REGISTER INFORMATION:                                      * 00007000
*                                                                     * 00007100
*    Before issuing the IEECMDS macro, the caller does not have to    * 00007200
*    place any information into any register unless using it in       * 00007300
*    register notation for a particular parameter, or using it as a   * 00007400
*    base register.                                                   * 00007500
*                                                                     * 00007600
*01* OUTPUT REGISTER INFORMATION:                                     * 00007700
*                                                                     * 00007800
*     When control returns to the caller, the GPRs contain:           * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*    REGISTER  CONTENTS                                               * 00008200
*                                                                     * 00008300
*    0         Reason code                                            * 00008400
*                                                                     * 00008500
*    1         Used as a work register by the system                  * 00008600
*                                                                     * 00008700
*    2-13      Unchanged                                              * 00008800
*                                                                     * 00008900
*    14        Used as a work register by the system                  * 00009000
*                                                                     * 00009100
*    15        Return code                                            * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*     When control returns to the caller, the ARs contain:            * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*    REGISTER  CONTENTS                                               * 00009900
*                                                                     * 00010000
*    0-1       Used as work registers by the system                   * 00010100
*                                                                     * 00010200
*    2-13      Unchanged                                              * 00010300
*                                                                     * 00010400
*    14-15     Used as work registers by the system                   * 00010500
*                                                                     * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*    Some callers depend on register contents remaining the same      * 00010900
*    before and after issuing a service.  If the system changes the   * 00011000
*    contents of registers on which the caller depends, the caller    * 00011100
*    must save them before issuing the service, and restore them      * 00011200
*    after the system returns control.                                * 00011300
*                                                                     * 00011400
*01* SYNTAX:                                                          * 00011500
*                                                                     * 00011600
*[xlabel]  IEECMDS  [ REQUEST=COUNT]                                 * 00011700
*                   [,REQUEST=INFO                                   * 00011800
*                   |     ,BUFFER=xbuffer                             * 00011900
*                   |     ,BUFSIZE=xbufsize]                          * 00012000
*                   [,REQUEST=REMOVE                                 * 00012100
*                         ,BUFFER=xbuffer                             * 00012200
*                         ,BUFSIZE=xbufsize]                          * 00012300
*                    [,CLASS=xclass|ANY_CLASS]                      * 00012400
*                    [,CMD=xcmd|ANY_CMD]                            * 00012500
*                    [,ID=xid|ANY_ID]                               * 00012600
*                    [,JOB=xjob|ANY_JOB]                            * 00012700
*                     ,COUNT=xcount                                   * 00012800
*                    [,RETCODE=xretcode]                              * 00012900
*                    [,RSNCODE=xrsncode]                              * 00013000
*                    [,PLISTVER=xplistver|IMPLIED_VERSION]          * 00013100
*                   [,MF=S]                                          * 00013200
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 00013300
*                   [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]             * 00013400
*                   [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]             * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*      Where:                                                         * 00013800
*                                                                     * 00013900
*                                                                     * 00014000
*      [xlabel]                                                       * 00014100
*          is an optional symbol, starting in column 1, that is the   * 00014200
*          name on the IEECMDS macro invocation.  The name must       * 00014300
*          conform to the rules for an ordinary assembler language    * 00014400
*          symbol.                                                    * 00014500
*          DEFAULT: No name.                                          * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*      [REQUEST=COUNT|INFO|REMOVE]                                  * 00015100
*          is an optional keyword input that indicates the type of    * 00015200
*          request.                                                   * 00015300
*          DEFAULT: COUNT                                             * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*          [REQUEST=COUNT]                                            * 00015700
*              Return only the count of commands which meet the       * 00015800
*              search criteria.                                       * 00015900
*                                                                     * 00016000
*              This count is returned for all values of REQUEST, but  * 00016100
*              if REQUEST= COUNT, no other information is returned.   * 00016200
*                                                                     * 00016300
*          [REQUEST=INFO                                              * 00016400
*              Return information about commands meeting the search   * 00016500
*              criteria.                                              * 00016600
*                                                                     * 00016700
*              The command names, id numbers, "waiting or executing"  * 00016800
*              status, jobname and asid of the command issuer,        * 00016900
*              date/time of issue/execution are returned for each     * 00017000
*              command.                                               * 00017100
*                                                                     * 00017200
*              The count of matching commands is returned.            * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*              BUFFER=xbuffer                                         * 00017600
*                  is the name (RS-type), or address in register      * 00017700
*                  (2)-(12), of a required character input that is to * 00017800
*                  contain the response.  request.                    * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*              BUFSIZE=xbufsize]                                      * 00018400
*                  is the name (RS-type), or address in register      * 00018500
*                  (2)-(12), of a required fullword input that        * 00018600
*                  contains the size of the output storage buffer.    * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*          [REQUEST=REMOVE                                            * 00019100
*              Remove commands from the "waiting for execution"       * 00019200
*              status, if they meet the search criteria.              * 00019300
*                                                                     * 00019400
*              The count of matching commands is returned.            * 00019500
*                                                                     * 00019600
*              The command names, id numbers, "waiting or executing"  * 00019700
*              status, jobname and asid of the command issuer,        * 00019800
*              date/time of issue/execution are returned for each     * 00019900
*              removed command.                                       * 00020000
*                                                                     * 00020100
*              Message IEE065I is issued for each removed command. It * 00020200
*              is directed to the console which issued the command.   * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*              BUFFER=xbuffer                                         * 00020600
*                  is the name (RS-type), or address in register      * 00020700
*                  (2)-(12), of a required character input that is to * 00020800
*                  contain the response.  request.                    * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*              BUFSIZE=xbufsize]                                      * 00021400
*                  is the name (RS-type), or address in register      * 00021500
*                  (2)-(12), of a required fullword input that        * 00021600
*                  contains the size of the output storage buffer.    * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*      [CLASS=xclass|ANY_CLASS]                                     * 00022600
*          is the name (RS-type), or address in register (2)-(12), of * 00022700
*          an optional 4 character input that indicates the class of  * 00022800
*          commands to be processed.                                  * 00022900
*                                                                     * 00023000
*          The currently defined classes are:                         * 00023100
*                                                                     * 00023200
*                                                                     * 00023300
*          1.  Class M1 - commands which are attached in *MASTER*,    * 00023400
*              and may be essential to clearing a backlog of Class M2 * 00023500
*              commands.                                              * 00023600
*                                                                     * 00023700
*          2.  Class M2 - ordinary attached commands which run in the * 00023800
*              *MASTER* address space.                                * 00023900
*                                                                     * 00024000
*          3.  Class C1 - commands which are attached in CONSOLE, and * 00024100
*              may be essential to clearing a backlog of Class C2     * 00024200
*              commands.                                              * 00024300
*                                                                     * 00024400
*          4.  Class C2 - ordinary attached commands which run in the * 00024500
*              CONSOLE address space.                                 * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*          DEFAULT: ANY_CLASS                                         * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*      [CMD=xcmd|ANY_CMD]                                           * 00025400
*          is the name (RS-type), or address in register (2)-(12), of * 00025500
*          an optional 8 character input that indicates the name of   * 00025600
*          the command to be processed.                               * 00025700
*                                                                     * 00025800
*          The command name must be specified as the full name, not   * 00025900
*          an abbreviation. If you have previously executed this      * 00026000
*          macro with a REQUEST of INFO, it has returned the command  * 00026100
*          names in full.                                             * 00026200
*          DEFAULT: ANY_CMD                                           * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*      [ID=xid|ANY_ID]                                              * 00026800
*          is the name (RS-type), or address in register (2)-(12), of * 00026900
*          an optional 4 character input that indicates the ID of a   * 00027000
*          command to be processed. This number was returned on a     * 00027100
*          previous CMDS INFO command.                                * 00027200
*          DEFAULT: ANY_ID                                            * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*      [JOB=xjob|ANY_JOB]                                           * 00027800
*          is the name (RS-type), or address in register (2)-(12), of * 00027900
*          an optional 8 character input that indicates the jobname   * 00028000
*          of the job which issued the commands.                      * 00028100
*          DEFAULT: ANY_JOB                                           * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*      COUNT=xcount                                                   * 00028700
*          is the name (RS-type), or address in register (2)-(12), of * 00028800
*          a required 4 byte input that contains the address area     * 00028900
*          that will contain the number of commands meeting the       * 00029000
*          specified criteria.                                        * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*      [RETCODE=xretcode]                                             * 00029600
*          is the name (RS-type) of an optional fullword output       * 00029700
*          variable, or register (2)-(12), into which the return code * 00029800
*          is to be copied from GPR 15.                               * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*      [RSNCODE=xrsncode]                                             * 00030400
*          is the name (RS-type) of an optional fullword output       * 00030500
*          variable, or register (2)-(12), into which the reason code * 00030600
*          is to be copied from GPR 0.                                * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00031200
*          is an optional byte input decimal value in the "1-1" range * 00031300
*          that specifies the macro version.  PLISTVER is the only    * 00031400
*          key allowed on the list form of MF and determines which    * 00031500
*          parameter list is generated (see Macro USAGE NOTE 2).      * 00031600
*          Note that MAX may be specified instead of a number, and    * 00031700
*          the parameter list will be of the largest size currently   * 00031800
*          supported. This size may grow from release to release      * 00031900
*          (thus possibly affecting the amount of storage needed by   * 00032000
*          your program).  If your program can tolerate this, IBM     * 00032100
*          recommends that you always specify MAX when creating the   * 00032200
*          list form parameter list as that will ensure that the list * 00032300
*          form parameter list is always long enough to hold whatever * 00032400
*          parameters might be specified on the execute form.         * 00032500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00032600
*          default is the lowest version which allows all of the      * 00032700
*          parameters specified on the invocation to be processed.    * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*      [MF=S|L|M|E]                                                 * 00033300
*          is an optional keyword input which specifies the macro     * 00033400
*          form.                                                      * 00033500
*          DEFAULT: S                                                 * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*          [MF=S]                                                     * 00033900
*              specifies the standard form of the macro.  The "S"     * 00034000
*              form generates code to put the parameters into an      * 00034100
*              in-line parameter list and invoke the desired service. * 00034200
*              Full checking for required macro keys is done along    * 00034300
*              with supplying defaults for omitted optional           * 00034400
*              parameters.                                            * 00034500
*                                                                     * 00034600
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00034700
*              specifies the list form of the macro.  The "L" form    * 00034800
*              defines an area to be used for the parameter list.     * 00034900
*              Only the PLISTVER key may be specified on the          * 00035000
*              invocation.  All other macro parameters are flagged as * 00035100
*              errors.  If PLISTVER is not specified, the original    * 00035200
*              parameter list definition is used.                     * 00035300
*                                                                     * 00035400
*            ,xmfctrl                                                 * 00035500
*              is a required input.  It is the name of a storage area * 00035600
*              for the parameter list.                                * 00035700
*                                                                     * 00035800
*            ,xmfattr|0D                                            * 00035900
*              is an optional 60 character input string that varies   * 00036000
*              from 1 to 60 characters. Use it to force boundary      * 00036100
*              alignment of the parameter list. Use only 0F or 0D.    * 00036200
*              DEFAULT: 0D which forces the parameter list to a       * 00036300
*              doubleword boundary.                                   * 00036400
*                                                                     * 00036500
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00036600
*              specifies the modify form of the macro.  The "M" form  * 00036700
*              generates code to put the parameters into the          * 00036800
*              parameter list specified by xmfctrl.                   * 00036900
*                                                                     * 00037000
*            ,xmfctrl                                                 * 00037100
*              is a required input.  It is the name (RS-type), or     * 00037200
*              address in register (1)-(12), of a storage area for    * 00037300
*              the parameter list.                                    * 00037400
*                                                                     * 00037500
*            ,COMPLETE|NOCHECK]                                     * 00037600
*              is an optional keyword input which specifies the       * 00037700
*              degree of macro parameter syntax checking.             * 00037800
*              DEFAULT: COMPLETE                                      * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*              COMPLETE                                               * 00038200
*                  Checking for required macro keys is done and       * 00038300
*                  defaults are supplied for omitted optional         * 00038400
*                  parameters.  (See Macro Usage Note 2).             * 00038500
*                                                                     * 00038600
*              NOCHECK                                                * 00038700
*                  Checking for required macro keys is not done nor   * 00038800
*                  are defaults supplied for omitted optional         * 00038900
*                  parameters.                                        * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00039400
*              specifies the execute form of the macro.  The "E" form * 00039500
*              generates code to put the parameters into the          * 00039600
*              parameter list specified by xmfctrl and invoke the     * 00039700
*              desired service.                                       * 00039800
*                                                                     * 00039900
*            ,xmfctrl                                                 * 00040000
*              is a required input.  It is the name (RS-type), or     * 00040100
*              address in register (1)-(12), of a storage area for    * 00040200
*              the parameter list.                                    * 00040300
*                                                                     * 00040400
*            ,COMPLETE|NOCHECK                                      * 00040500
*              is an optional keyword input which specifies the       * 00040600
*              degree of macro parameter syntax checking.             * 00040700
*              DEFAULT: COMPLETE                                      * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*              COMPLETE                                               * 00041100
*                  Checking for required macro keys is done and       * 00041200
*                  defaults are supplied for omitted optional         * 00041300
*                  parameters.  (See Macro Usage Note 2).             * 00041400
*                                                                     * 00041500
*              NOCHECK                                                * 00041600
*                  Checking for required macro keys is not done nor   * 00041700
*                  are defaults supplied for omitted optional         * 00041800
*                  parameters.                                        * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*01* RETURN CODES:                                                    * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*          X'00'  Name: CMDS_RC_OK                                    * 00043000
*                                                                     * 00043100
*                 Meaning:  Matching commands have been found.  In    * 00043200
*                 the case of a REQUEST type of INFO or REMOVE, the   * 00043300
*                 output buffer was sufficient to hold all of the     * 00043400
*                 information for the commands meeting the search     * 00043500
*                 criteria.                                           * 00043600
*                                                                     * 00043700
*                 Action:  None required.                             * 00043800
*                                                                     * 00043900
*          X'04'  Name: CMDS_RC_NOCMDS                                * 00044000
*                                                                     * 00044100
*                 Meaning:  No commands meet the specified filters.   * 00044200
*                                                                     * 00044300
*                 Action:  None required.                             * 00044400
*                                                                     * 00044500
*          X'08'  Name: CMDS_RC_NOSTOR                                * 00044600
*                                                                     * 00044700
*                 Meaning:  Insufficient return buffer storage to     * 00044800
*                 complete the query operation.                       * 00044900
*                                                                     * 00045000
*                 Action:  Refer to the action provided with the      * 00045100
*                 specific reason code.                               * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*                 HEX REASON  MEANING/ACTION                          * 00045500
*                 CODE                                                * 00045600
*                                                                     * 00045700
*                 X'04'       Name: CMDS_RS_SOMECMDS                  * 00045800
*                                                                     * 00045900
*                             Meaning: The output buffer is too small * 00046000
*                             to contain all requested information,   * 00046100
*                             but does contain the information for    * 00046200
*                             one or more commands.                   * 00046300
*                                                                     * 00046400
*                             If REQUEST=REMOVE, the system has       * 00046500
*                             removed only the commands for which     * 00046600
*                             information is returned.                * 00046700
*                                                                     * 00046800
*                             Action: The count of matching commands  * 00046900
*                             has been returned. Adjust the buffer    * 00047000
*                             size so that it is at least as large as * 00047100
*                             the count multipled by the output size  * 00047200
*                             for each entry, plus the length of the  * 00047300
*                             header, and issue the macro again.      * 00047400
*                                                                     * 00047500
*                             The constant CMDS_HEADER_LENGTH         * 00047600
*                             represents the amount of storage        * 00047700
*                             required for the buffer header.         * 00047800
*                                                                     * 00047900
*                             The constant CMDS_ENTRY_LENGTH          * 00048000
*                             represents the amount of storage        * 00048100
*                             required per command.                   * 00048200
*                                                                     * 00048300
*                             These constants are declared in mapping * 00048400
*                             macro IEEZB889.                         * 00048500
*                                                                     * 00048600
*                 X'08'       Name: CMDS_RS_NOCMDS                    * 00048700
*                                                                     * 00048800
*                             Meaning: The output buffer is too small * 00048900
*                             to contain the information for even one * 00049000
*                             command.                                * 00049100
*                                                                     * 00049200
*                             Action: The count of matching commands  * 00049300
*                             has been returned. Adjust the buffer    * 00049400
*                             size so that it is at least as large as * 00049500
*                             the count multipled by the output size  * 00049600
*                             for each entry, plus the length of the  * 00049700
*                             header, and issue the macro again.      * 00049800
*                                                                     * 00049900
*                             If REQUEST=REMOVE, the system has not   * 00050000
*                             removed any commands.                   * 00050100
*                                                                     * 00050200
*                             The constant CMDS_HEADER_LENGTH         * 00050300
*                             represents the amount of storage        * 00050400
*                             required for the buffer header.         * 00050500
*                                                                     * 00050600
*                             The constant CMDS_ENTRY_LENGTH          * 00050700
*                             represents the amount of storage        * 00050800
*                             required per command.                   * 00050900
*                                                                     * 00051000
*                             These constants are declared in mapping * 00051100
*                             macro IEEZB889.                         * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*          X'10'  Name: CMDS_RC_INVPL                                 * 00051600
*                                                                     * 00051700
*                 Meaning:  Invalid parameter list.                   * 00051800
*                                                                     * 00051900
*                 Action:  Refer to the action provided with the      * 00052000
*                 specific reason code.                               * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*                 HEX REASON  MEANING/ACTION                          * 00052400
*                 CODE                                                * 00052500
*                                                                     * 00052600
*                 X'04'       Name: CMDS_RS_INVACRN                   * 00052700
*                                                                     * 00052800
*                             Meaning:  The acronym in the parameter  * 00052900
*                             list was invalid.                       * 00053000
*                                                                     * 00053100
*                             Action:  Correct the acronym in the     * 00053200
*                             parameter list and issue IEECMDS again. * 00053300
*                                                                     * 00053400
*                 X'08'       Name: CMDS_RS_INVADDR                   * 00053500
*                                                                     * 00053600
*                             Meaning:  An output address is invalid. * 00053700
*                             An ABEND occured while trying to access * 00053800
*                             storage at an address specified in the  * 00053900
*                             parameter list, possibly because that   * 00054000
*                             storage is not accessible by the        * 00054100
*                             caller, or the storage does not exist.  * 00054200
*                                                                     * 00054300
*                             Action:  Correct the invalid address in * 00054400
*                             the parameter list and issue IEECMDS    * 00054500
*                             again.                                  * 00054600
*                                                                     * 00054700
*                 X'0C'       Name: CMDS_RS_INVBUFFER                 * 00054800
*                                                                     * 00054900
*                             Meaning:  The address or length of the  * 00055000
*                             buffer in the parameter list was        * 00055100
*                             invalid.                                * 00055200
*                                                                     * 00055300
*                             Action:  Correct the values of BUFFER   * 00055400
*                             and/or BUFSIZE in the parameter list    * 00055500
*                             and issue IEECMDS again.                * 00055600
*                                                                     * 00055700
*                 X'10'       Name: CMDS_RS_INVLGTH                   * 00055800
*                                                                     * 00055900
*                             Meaning:  The length of the parameter   * 00056000
*                             list is invalid.                        * 00056100
*                                                                     * 00056200
*                             Action:  Correct the length in the      * 00056300
*                             parameter list and issue IEECMDS again. * 00056400
*                                                                     * 00056500
*                 X'14'       Name: CMDS_RS_INVVERS                   * 00056600
*                                                                     * 00056700
*                             Meaning:  The version specified in the  * 00056800
*                             parameter list is invalid.              * 00056900
*                                                                     * 00057000
*                             Action:  Correct the version in the     * 00057100
*                             parameter list and issue IEECMDS again. * 00057200
*                                                                     * 00057300
*                 X'18'       Name: CMDS_RS_INVFUNC                   * 00057400
*                                                                     * 00057500
*                             Meaning:  The REQUEST type specified in * 00057600
*                             the parameter list is not a valid       * 00057700
*                             REQUEST type.                           * 00057800
*                                                                     * 00057900
*                             Action:  Correct the REQUEST type in    * 00058000
*                             the parameter list and issue IEECMDS    * 00058100
*                             again.                                  * 00058200
*                                                                     * 00058300
*                 X'1C'       Name: CMDS_RS_INVCLASS                  * 00058400
*                                                                     * 00058500
*                             Meaning:  The CLASS specified in the    * 00058600
*                             parameter list is not a valid CLASS     * 00058700
*                             name.                                   * 00058800
*                                                                     * 00058900
*                             Action:  Correct the CLASS in the       * 00059000
*                             parameter list and issue IEECMDS again. * 00059100
*                                                                     * 00059200
*                 X'20'       Name: CMDS_RS_INVID                     * 00059300
*                                                                     * 00059400
*                             Meaning:The ID specified in the         * 00059500
*                             parameter list is not a valid ID value. * 00059600
*                             The ID value must be a decimal number   * 00059700
*                             in EBCDIC (printable) characters.       * 00059800
*                                                                     * 00059900
*                             Action:  Correct the ID in the          * 00060000
*                             parameter list and issue IEECMDS again. * 00060100
*                                                                     * 00060200
*                                                                     * 00060300
*                                                                     * 00060400
*       X'40'     Name: CMDS_RC_SYSERR                                * 00060500
*                                                                     * 00060600
*                 Meaning:  System Error.  This return code is for    * 00060700
*                 IBM diagnostic purposes only.                       * 00060800
*                                                                     * 00060900
*                 Action:  Record the return and reason codes and     * 00061000
*                 supply it to the appropriate IBM support personnel. * 00061100
*                                                                     * 00061200
*                                                                     * 00061300
*                 HEX REASON  MEANING/ACTION                          * 00061400
*                 CODE                                                * 00061500
*                                                                     * 00061600
*                 X'04'       Name: CMDS_RS_SYSABEND                  * 00061700
*                                                                     * 00061800
*                             Meaning:  An ABEND occurred during      * 00061900
*                             processing.   This reason code is for   * 00062000
*                             IBM diagnostic purposes only.           * 00062100
*                                                                     * 00062200
*                             Action:  Record the return and reason   * 00062300
*                             codes and supply it to the appropriate  * 00062400
*                             IBM support personnel.                  * 00062500
*                                                                     * 00062600
*                 X'08'       Name: CMDS_RS_SYSERR                    * 00062700
*                                                                     * 00062800
*                             Meaning:  An error occurred during      * 00062900
*                             processing.   This reason code is for   * 00063000
*                             IBM diagnostic purposes only.           * 00063100
*                                                                     * 00063200
*                             Action:  Record the return and reason   * 00063300
*                             codes and supply it to the appropriate  * 00063400
*                             IBM support personnel.                  * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*                                                                     * 00063800
*                                                                     * 00063900
*                                                                     * 00064000
*01* REASON CODES:                                                    * 00064100
*                                                                     * 00064200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00064300
*                                                                     * 00064400
*02*   PROCESSOR:  ASSEM                                              * 00064500
*                                                                     * 00064600
*01* COMPONENT:  SC1B8                                                * 00064700
*                                                                     * 00064800
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00064900
*                                                                     * 00065000
*01* ABEND CODES:  None.                                              * 00065100
*                                                                     * 00065200
*01* MACRO USAGE NOTES:                                               * 00065300
*                                                                     * 00065400
*                                                                     * 00065500
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00065600
*        global macro variable.  Any value other than 'NO' will       * 00065700
*        result in the macro expansion being printed.  The default is * 00065800
*        'YES'.  The following examples illustrate how the ZPRINT     * 00065900
*        variable should be set.                                      * 00066000
*                                                                     * 00066100
*                    GBLC &ZPRINT                                     * 00066200
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00066300
*                                                                     * 00066400
*                                                                     * 00066500
*    2.  When using the NOCHECK option in conjunction with the Modify * 00066600
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00066700
*        Modify   or  Execute  form  invocation  which  specifies  or * 00066800
*        defaults  to  the  COMPLETE  option.   This insures that the * 00066900
*        parameter  list  is  initialized completely.   The parameter * 00067000
*        list  field which identifies the version number of the macro * 00067100
*        is only set when the Standard form or the Complete option of * 00067200
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00067300
*        explicitly  specified.  Be sure that the resulting parameter * 00067400
*        list version number covers all the keys that you use.        * 00067500
*                                                                     * 00067600
*                                                                     * 00067700
*    3.  All keys currently contained in the IEECMDS macro correspond * 00067800
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00067900
*        MAX.                                                         * 00068000
*                                                                     * 00068100
*                                                                     * 00068200
*                                                                     * 00068300
*                                                                     * 00068400
*01* CHANGE ACTIVITY:                                                 * 00068500
*                                                                     * 00068600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00068700
*                                                                     * 00068800
*    $00=OW45398  HBB7703 010330 PDHD:  Command Flooding              * 00068900
****** END OF SPECIFICATIONS *****************************************/ 00069000
*/* TLINE 1 *********************************************************** 00069100
         MACRO                                                          00069200
&XLABEL  IEECMDS &REQUEST=,&BUFFER=,&BUFSIZE=,&CLASS=,&CMD=,&ID=,&JOB=,*00069300
               &COUNT=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=              00069400
.*                                                                      00069500
*              MACDATE -03/29/01-<1>                                    00069600
.*                                                                      00069700
.*******************************************************************    00069800
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00069900
.*******************************************************************    00070000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00070100
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00070200
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00070300
.*                                                                      00070400
              GBLC  &ZIEECMDS   YES=MACRO USED AT LEAST ONCE            00070500
.*******************************************************************    00070600
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00070700
.*******************************************************************    00070800
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00070900
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00071000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00071100
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00071200
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00071300
              LCLA  &ZAWRK      USED AS A WORK AREA                     00071400
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00071500
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00071600
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00071700
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00071800
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00071900
              LCLA  &ZMACRET    MACRO RETURN CODE                       00072000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00072100
.*                                                                      00072200
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00072300
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00072400
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00072500
              LCLC  &ZENDBASEPL                 End of base PL          00072600
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00072700
.*******************************************************************    00072800
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00072900
.*******************************************************************    00073000
              LCLA  &ZI         INDEX FOR ARRAY                         00073100
              LCLA  &ZJ         INDEX FOR PARMS                         00073200
              LCLA  &ZK         INDEX FOR PARSE                         00073300
              LCLA  &ZLO        LOW RANGE VALUE                         00073400
              LCLA  &ZHI        HIGH RANGE VALUE                        00073500
              LCLC  &ZW         WORK AREA FOR PARM                      00073600
.********************************************************************   00073700
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00073800
.********************************************************************   00073900
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00074000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00074100
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00074200
.*                                                                      00074300
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00074400
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00074500
              SPLEVEL  TEST                                             00074600
.ZSYS2        ANOP  ,                                                   00074700
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00074800
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00074900
              SYSSTATE TEST                                             00075000
              AGO   .ZSYS4                                              00075100
.ZSYS3        ANOP  ,                                                   00075200
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00075300
.ZSYS4        ANOP  ,                                                   00075400
.*******************************************************************    00075500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00075600
.*******************************************************************    00075700
              LCLC  &XREQUEST   ++ VALUE                                00075800
              LCLC  &XBUFFER    ++ NAME                                 00075900
              LCLC  &XBUFSIZE   ++ NAME                                 00076000
              LCLC  &XCLASS     ++ NAME                                 00076100
              LCLC  &XCMD       ++ NAME                                 00076200
              LCLC  &XID        ++ NAME                                 00076300
              LCLC  &XJOB       ++ NAME                                 00076400
              LCLC  &XCOUNT     ++ NAME                                 00076500
              LCLC  &XRETCODE   ++ NAME                                 00076600
              LCLC  &XRSNCODE   ++ NAME                                 00076700
              LCLA  &XPLISTVER  ++ VALUE                                00076800
              LCLC  &XMF        ++ VALUE                                00076900
              LCLC  &XMFCTRL    ++ NAME                                 00077000
              LCLC  &XMFATTR    ++ VALUE                                00077100
              LCLC  &XMFSCK     ++ VALUE                                00077200
.*******************************************************************    00077300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00077400
.*******************************************************************    00077500
              LCLC  &ZXREQUEST  ++ INPUT VALUE                          00077600
              LCLC  &ZXBUFFER   ++ INPUT NAME                           00077700
              LCLC  &ZXBUFSIZE  ++ INPUT NAME                           00077800
              LCLC  &ZXCLASS    ++ INPUT NAME                           00077900
              LCLC  &ZXCMD      ++ INPUT NAME                           00078000
              LCLC  &ZXID       ++ INPUT NAME                           00078100
              LCLC  &ZXJOB      ++ INPUT NAME                           00078200
              LCLC  &ZXCOUNT    ++ INPUT NAME                           00078300
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00078400
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00078500
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00078600
              LCLC  &ZXMF       ++ INPUT VALUE                          00078700
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00078800
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00078900
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00079000
.********************************************************************   00079100
.***AC.PLV01  PROCESS PLISTVER                                      *   00079200
.********************************************************************   00079300
&XPLISTVER      SETA  1                                                 00079400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00079500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00079600
&XPLISTVER      SETA  1                                                 00079700
.ZPLV0          ANOP  ,                                                 00079800
.*                                                                      00079900
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00080000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00080100
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00080200
.*-------------------------------------------------------------------   00080300
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00080400
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00080500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00080600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00080700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00080800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00080900
                AGO   .ZPVCK2                                           00081000
.ZPVCK3         ANOP  ,                                                 00081100
.*-------------------------------------------------------------------   00081200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00081300
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00081400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00081500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00081600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00081700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00081800
                AGO   .ZPVCKE                                           00081900
.ZPVCK2         ANOP  ,                                                 00082000
.*-------------------------------------------------------------------   00082100
&ZCVAL          SETC  '&PLISTVER(1)'                                    00082200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00082300
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00082400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00082500
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00082600
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00082700
.ZPVCK6         ANOP  ,                                                 00082800
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00082900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00083000
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00083100
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00083200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00083300
&XPLISTVER      SETA  1                                                 00083400
                AGO   .ZPVCKE                                           00083500
.*-------------------------------------------------------------------   00083600
.ZPVCK4A        ANOP  ,                                                 00083700
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00083800
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00083900
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00084000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00084100
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00084200
                MNOTE 8,' &ZMS IS REQUIRED.'                            00084300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084400
                AGO   .ZPVCK5                                           00084500
.ZPVCK4         ANOP  ,                                                 00084600
&XPLISTVER      SETA  &PLISTVER(1)                                      00084700
.ZPVCK5         ANOP  ,                                                 00084800
.ZPVCKE         ANOP  ,                                                 00084900
.********************************************************************   00085000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00085100
.********************************************************************   00085200
              ACTR  10000                                               00085300
.*------------------------------------------------------------------    00085400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085500
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00085600
.*-------------------------------------------------------------------   00085700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085800
.ZG45         ANOP  ,                                                   00085900
&ZTLC         SETC 'S'                                                  00086000
              AIF   ('&MF(1)' NE '&ZTLC').ZG46                          00086100
&XMF          SETC  'S'         SET KEYWORD                             00086200
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00086300
              AIF   (N'&MF LE 1).ZG45A          CK NUM                  00086400
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00086500
&ZMS          SETC  '&ZMS.&MF"'                                         00086600
&ZMS          SETC  '&ZMS "MF"'                                         00086700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00086800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00086900
.ZG45A        ANOP  ,                                                   00087000
.*-------------------------------------------------------------------   00087100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087200
.ZG46         ANOP  ,                                                   00087300
&ZTLC         SETC 'L'                                                  00087400
              AIF   ('&MF(1)' NE '&ZTLC').ZG53                          00087500
&XMF          SETC  'L'         SET KEYWORD                             00087600
              AIF   (N'&MF LE 3).ZG46A          CK NUM                  00087700
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00087800
&ZMS          SETC  '&ZMS.&MF"'                                         00087900
&ZMS          SETC  '&ZMS "MF"'                                         00088000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00088100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00088200
.ZG46A        ANOP  ,                                                   00088300
.*-------------------------------------------------------------------   00088400
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00088500
              AIF   (N'&SYSLIST NE 0).ZG46B     POSITIONALS?            00088600
              AIF   ('&REQUEST' NE '').ZG46B    KEYS?                   00088700
              AIF   ('&BUFFER' NE '').ZG46B     KEYS?                   00088800
              AIF   ('&BUFSIZE' NE '').ZG46B    KEYS?                   00088900
              AIF   ('&CLASS' NE '').ZG46B      KEYS?                   00089000
              AIF   ('&CMD' NE '').ZG46B        KEYS?                   00089100
              AIF   ('&ID' NE '').ZG46B         KEYS?                   00089200
              AIF   ('&JOB' NE '').ZG46B        KEYS?                   00089300
              AIF   ('&COUNT' NE '').ZG46B      KEYS?                   00089400
              AIF   ('&RETCODE' NE '').ZG46B    KEYS?                   00089500
              AIF   ('&RSNCODE' NE '').ZG46B    KEYS?                   00089600
              AGO    .ZG46C     INVOCATION OKAY                         00089700
.ZG46B        ANOP  ,                                                   00089800
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            00089900
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00090000
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00090100
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00090200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090300
.ZG46C        ANOP  ,                                                   00090400
.*-------------------------------------------------------------------   00090500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00090600
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00090700
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00090800
              AIF   (N'&MF(2) GT 1).ZG48B       MULTI PARMS             00090900
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00091000
.ZG48B        AIF   (K'&MF(2) GT 0).ZG48C                               00091100
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00091200
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00091300
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00091400
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00091500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00091600
.ZG48C        ANOP  ,                                                   00091700
.*-------------------------------------------------------------------   00091800
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00091900
              AIF   (K'&ZXMFCTRL LE 0).ZG48P    NOT I/O                 00092000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG48P                      00092100
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00092200
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00092300
&ZMS          SETC  '&ZMS.&MF"'                                         00092400
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00092500
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00092600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00092700
.ZG48P        ANOP  ,                                                   00092800
.*-------------------------------------------------------------------   00092900
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00093000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00093100
&XMFATTR      SETC  '0D'                                                00093200
              AIF   (K'&MF(3) LE 0).ZG51B       PARM                    00093300
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00093400
              AIF   (N'&MF(3) GT 1).ZG51B       MULTI PARMS             00093500
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00093600
.ZG51B        ANOP  ,                                                   00093700
.*-------------------------------------------------------------------   00093800
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00093900
              AIF   (K'&ZXMFATTR LE 0).ZG51P    NOT I/O                 00094000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG51P                      00094100
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00094200
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00094300
&ZMS          SETC  '&ZMS.&MF"'                                         00094400
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00094500
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00094600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094700
.ZG51P        ANOP  ,                                                   00094800
.*-------------------------------------------------------------------   00094900
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00095000
              AIF   (K'&ZXMFATTR LE 0).ZG51S    NOT I/O                 00095100
              AIF   (K'&XMFATTR LE 60).ZG51S    LNG OK                  00095200
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00095300
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00095400
&ZMS          SETC  '&ZMS.&MF"'                                         00095500
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00095600
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00095700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095800
.ZG51S        ANOP  ,                                                   00095900
.*-------------------------------------------------------------------   00096000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096100
.ZG53         ANOP  ,                                                   00096200
&ZTLC         SETC 'M'                                                  00096300
              AIF   ('&MF(1)' NE '&ZTLC').ZG62                          00096400
&XMF          SETC  'M'         SET KEYWORD                             00096500
              AIF   (N'&MF LE 3).ZG53A          CK NUM                  00096600
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00096700
&ZMS          SETC  '&ZMS.&MF"'                                         00096800
&ZMS          SETC  '&ZMS "MF"'                                         00096900
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00097000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00097100
.ZG53A        ANOP  ,                                                   00097200
.*-------------------------------------------------------------------   00097300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00097400
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00097500
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00097600
              AIF   (N'&MF(2) GT 1).ZG55B       MULTI PARMS             00097700
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00097800
.ZG55B        AIF   (K'&MF(2) GT 0).ZG55C                               00097900
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00098000
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 00098100
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00098200
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00098300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098400
.ZG55C        ANOP  ,                                                   00098500
.*-------------------------------------------------------------------   00098600
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00098700
              AIF   (K'&ZXMFCTRL LE 0).ZG55R    NOT I/O                 00098800
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG55R                      00098900
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00099000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG55P                        00099100
              AIF   (K'&ZCGPR GT 2).ZG55Q                               00099200
              AIF   ('&ZCGPR' EQ '0').ZG55Q                             00099300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00099400
              AIF   (T'&ZCGPR NE 'N').ZG55Q     INVALID REG NAME        00099500
.ZG55P        ANOP  ,                                                   00099600
              AIF   (T'&ZCGPR NE 'N').ZG55R     NON NUMERIC             00099700
              AIF   ('&ZCGPR' LT '1').ZG55Q                             00099800
              AIF   ('&ZCGPR' LE '12').ZG55R                            00099900
.ZG55Q        ANOP  ,                                                   00100000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00100100
&ZMS          SETC  '&ZMS.&MF"'                                         00100200
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00100300
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00100400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00100500
.ZG55R        ANOP  ,                                                   00100600
.*-------------------------------------------------------------------   00100700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00100800
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00100900
.ZG59A   AIF   ('&MF(3)' NE 'COMPLETE').ZG60A                           00101000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00101100
.*-------------------------------------------------------------------   00101200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00101300
.ZG60A   AIF   ('&MF(3)' NE 'NOCHECK').ZG61A                            00101400
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00101500
.*-------------------------------------------------------------------   00101600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00101700
.ZG61A        AIF   (K'&XMFSCK GT 0).ZG61C      KEYWORD                 00101800
              AIF   (K'&MF(3) LE 0).ZG61B                               00101900
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00102000
&ZMS          SETC  '&ZMS.&MF"'                                         00102100
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00102200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00102300
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00102400
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00102500
              MNOTE 8,' &ZMS '                                          00102600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102700
.ZG61B        ANOP  ,                                                   00102800
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00102900
.ZG61C        ANOP  ,                                                   00103000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00103100
.*-------------------------------------------------------------------   00103200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00103300
.ZG62         ANOP  ,                                                   00103400
&ZTLC         SETC 'E'                                                  00103500
              AIF   ('&MF(1)' NE '&ZTLC').ZG71                          00103600
&XMF          SETC  'E'         SET KEYWORD                             00103700
              AIF   (N'&MF LE 3).ZG62A          CK NUM                  00103800
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00103900
&ZMS          SETC  '&ZMS.&MF"'                                         00104000
&ZMS          SETC  '&ZMS "MF"'                                         00104100
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00104200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104300
.ZG62A        ANOP  ,                                                   00104400
.*-------------------------------------------------------------------   00104500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00104600
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00104700
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00104800
              AIF   (N'&MF(2) GT 1).ZG64B       MULTI PARMS             00104900
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00105000
.ZG64B        AIF   (K'&MF(2) GT 0).ZG64C                               00105100
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00105200
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00105300
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00105400
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00105500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00105600
.ZG64C        ANOP  ,                                                   00105700
.*-------------------------------------------------------------------   00105800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00105900
              AIF   (K'&ZXMFCTRL LE 0).ZG64R    NOT I/O                 00106000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG64R                      00106100
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00106200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG64P                        00106300
              AIF   (K'&ZCGPR GT 2).ZG64Q                               00106400
              AIF   ('&ZCGPR' EQ '0').ZG64Q                             00106500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00106600
              AIF   (T'&ZCGPR NE 'N').ZG64Q     INVALID REG NAME        00106700
.ZG64P        ANOP  ,                                                   00106800
              AIF   (T'&ZCGPR NE 'N').ZG64R     NON NUMERIC             00106900
              AIF   ('&ZCGPR' LT '1').ZG64Q                             00107000
              AIF   ('&ZCGPR' LE '12').ZG64R                            00107100
.ZG64Q        ANOP  ,                                                   00107200
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00107300
&ZMS          SETC  '&ZMS.&MF"'                                         00107400
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00107500
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00107600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107700
.ZG64R        ANOP  ,                                                   00107800
.*-------------------------------------------------------------------   00107900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00108000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00108100
.ZG68A   AIF   ('&MF(3)' NE 'COMPLETE').ZG69A                           00108200
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00108300
.*-------------------------------------------------------------------   00108400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00108500
.ZG69A   AIF   ('&MF(3)' NE 'NOCHECK').ZG70A                            00108600
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00108700
.*-------------------------------------------------------------------   00108800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00108900
.ZG70A        AIF   (K'&XMFSCK GT 0).ZG70C      KEYWORD                 00109000
              AIF   (K'&MF(3) LE 0).ZG70B                               00109100
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00109200
&ZMS          SETC  '&ZMS.&MF"'                                         00109300
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00109400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00109500
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00109600
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00109700
              MNOTE 8,' &ZMS '                                          00109800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00109900
.ZG70B        ANOP  ,                                                   00110000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00110100
.ZG70C        ANOP  ,                                                   00110200
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00110300
.*------------------------------------------------------------------    00110400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110500
.ZG71         ANOP  ,                                                   00110600
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00110700
              AIF   (K'&XMF GT 0).ZG71E         VALID ARG               00110800
              AIF   (T'&MF EQ 'O').ZG71D        OMITTED                 00110900
&ZASYSLNDX    SETA  0                                                   00111000
.ZG71A        ANOP  ,           POSITIONAL MACRO KEY                    00111100
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00111200
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG71C                    00111300
&ZTLC         SETC 'MF'                                                 00111400
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG71A           00111500
.ZG71B        ANOP  ,                                                   00111600
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00111700
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00111800
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00111900
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00112000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00112100
              AGO   .ZG71E                                              00112200
.ZG71C        ANOP  ,                                                   00112300
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00112400
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00112500
&ZMS          SETC  '&ZMS.&MF"'                                         00112600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00112700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00112800
&ZMS          SETC  '&ZMS "S",'                                         00112900
&ZMS          SETC  '&ZMS "L",'                                         00113000
&ZMS          SETC  '&ZMS "M",'                                         00113100
&ZMS          SETC  '&ZMS OR "E".'                                      00113200
              MNOTE 8,' &ZMS '                                          00113300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00113400
              AGO   .ZG71E                                              00113500
.ZG71D        ANOP  ,                                                   00113600
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00113700
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00113800
.ZG71E        ANOP  ,                                                   00113900
.********************************************************************   00114000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00114100
.********************************************************************   00114200
              ACTR  10000                                               00114300
.*-------------------------------------------------------------------   00114400
.***AG.MF03 MF=(SLME)                                                   00114500
              AIF   ('&XMF' EQ 'L').ZGMFX                               00114600
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00114700
.*------------------------------------------------------------------    00114800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114900
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00115000
.*-------------------------------------------------------------------   00115100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115200
.ZG3          ANOP  ,                                                   00115300
              AIF   (K'&REQUEST(1) LE 0).ZG3A                           00115400
&ZTLC         SETC 'COUNT'                                              00115500
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG4                      00115600
&XREQUEST     SETC  'COUNT'     SET KEYWORD                             00115700
              AIF   (N'&REQUEST LE 1).ZG3A      CK NUM                  00115800
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00115900
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00116000
&ZMS          SETC  '&ZMS "REQUEST"'                                    00116100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00116200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116300
.ZG3A         ANOP  ,                                                   00116400
.*------------------------------------------------------------------    00116500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116600
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00116700
.ZG3A0        AIF   (K'&BUFFER LE 0).ZG3A1      OK                      00116800
&ZCVAL        SETC '&ZCVAL BUFFER'              INCORRECT KEY USED      00116900
.ZG3A1        AIF   (K'&BUFSIZE LE 0).ZG3A2     OK                      00117000
&ZCVAL        SETC '&ZCVAL BUFSIZE'             INCORRECT KEY USED      00117100
.ZG3A2        AIF   (K'&ZCVAL LE 0).ZG3A3       OK                      00117200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00117300
&ZMS          SETC  '"REQUEST'  *KMEIA* MNOTE                           00117400
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00117500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00117600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00117700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00117800
.ZG3A3        ANOP  ,                                                   00117900
.*-------------------------------------------------------------------   00118000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00118100
.ZG4          ANOP  ,                                                   00118200
&ZTLC         SETC 'INFO'                                               00118300
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG11                     00118400
&XREQUEST     SETC  'INFO'      SET KEYWORD                             00118500
              AIF   (N'&REQUEST LE 1).ZG4A      CK NUM                  00118600
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00118700
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00118800
&ZMS          SETC  '&ZMS "REQUEST"'                                    00118900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00119000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119100
.ZG4A         ANOP  ,                                                   00119200
.*----------------------------------------------------------------***   00119300
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00119400
              AIF   (N'&BUFFER LE 1).ZG6A       CK NUM                  00119500
&ZMS          SETC  '"BUFFER='  *KPOSA* MNOTE                           00119600
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00119700
&ZMS          SETC  '&ZMS "BUFFER"'                                     00119800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00119900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00120000
.ZG6A         ANOP  ,                                                   00120100
.*-------------------------------------------------------------------   00120200
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00120300
&ZXBUFFER     SETC  'INPUT'     SET IN/OUTPUT                           00120400
&XBUFFER      SETC  '&BUFFER(1)'                SET XVARIABLE           00120500
              AIF   (N'&BUFFER GT 1).ZG6B       MULTI PARMS             00120600
&XBUFFER      SETC  '&BUFFER'   SET XVARIABLE                           00120700
.ZG6B         AIF   (K'&BUFFER(1) GT 0).ZG6C                            00120800
&ZXBUFFER     SETC  ''          RESET IN/OUTPUT                         00120900
&ZMS          SETC  'WHEN "INFO" IS SPECIFIED'  *KRQDA*                 00121000
&ZMS          SETC  '&ZMS , "BUFFER" KEY AND ITS'                       00121100
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00121200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00121300
.ZG6C         ANOP  ,                                                   00121400
.*-------------------------------------------------------------------   00121500
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00121600
              AIF   (K'&ZXBUFFER LE 0).ZG6R     NOT I/O                 00121700
              AIF   ('&XBUFFER'(1,1) NE '(').ZG6R                       00121800
&ZCGPR        SETC  '&XBUFFER'(2,K'&XBUFFER-2)                          00121900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                         00122000
              AIF   (K'&ZCGPR GT 2).ZG6Q                                00122100
              AIF   ('&ZCGPR' EQ '0').ZG6Q                              00122200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00122300
              AIF   (T'&ZCGPR NE 'N').ZG6Q      INVALID REG NAME        00122400
.ZG6P         ANOP  ,                                                   00122500
              AIF   (T'&ZCGPR NE 'N').ZG6R      NON NUMERIC             00122600
              AIF   ('&ZCGPR' LT '2').ZG6Q                              00122700
              AIF   ('&ZCGPR' LE '12').ZG6R                             00122800
.ZG6Q         ANOP  ,                                                   00122900
&ZMS          SETC  '"BUFFER='  *KGPRA* MNOTE                           00123000
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00123100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00123200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00123300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123400
.ZG6R         ANOP  ,                                                   00123500
.*----------------------------------------------------------------***   00123600
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00123700
              AIF   (N'&BUFSIZE LE 1).ZG9A      CK NUM                  00123800
&ZMS          SETC  '"BUFSIZE='                 *KPOSA* MNOTE           00123900
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00124000
&ZMS          SETC  '&ZMS "BUFSIZE"'                                    00124100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00124200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124300
.ZG9A         ANOP  ,                                                   00124400
.*-------------------------------------------------------------------   00124500
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00124600
&ZXBUFSIZE    SETC  'INPUT'     SET IN/OUTPUT                           00124700
&XBUFSIZE     SETC  '&BUFSIZE(1)'               SET XVARIABLE           00124800
              AIF   (N'&BUFSIZE GT 1).ZG9B      MULTI PARMS             00124900
&XBUFSIZE     SETC  '&BUFSIZE'  SET XVARIABLE                           00125000
.ZG9B         AIF   (K'&BUFSIZE(1) GT 0).ZG9C                           00125100
&ZXBUFSIZE    SETC  ''          RESET IN/OUTPUT                         00125200
&ZMS          SETC  'WHEN "INFO" IS SPECIFIED'  *KRQDA*                 00125300
&ZMS          SETC  '&ZMS , "BUFSIZE" KEY AND ITS'                      00125400
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00125500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125600
.ZG9C         ANOP  ,                                                   00125700
.*-------------------------------------------------------------------   00125800
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00125900
              AIF   (K'&ZXBUFSIZE LE 0).ZG9R    NOT I/O                 00126000
              AIF   ('&XBUFSIZE'(1,1) NE '(').ZG9R                      00126100
&ZCGPR        SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                        00126200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                         00126300
              AIF   (K'&ZCGPR GT 2).ZG9Q                                00126400
              AIF   ('&ZCGPR' EQ '0').ZG9Q                              00126500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00126600
              AIF   (T'&ZCGPR NE 'N').ZG9Q      INVALID REG NAME        00126700
.ZG9P         ANOP  ,                                                   00126800
              AIF   (T'&ZCGPR NE 'N').ZG9R      NON NUMERIC             00126900
              AIF   ('&ZCGPR' LT '2').ZG9Q                              00127000
              AIF   ('&ZCGPR' LE '12').ZG9R                             00127100
.ZG9Q         ANOP  ,                                                   00127200
&ZMS          SETC  '"BUFSIZE='                 *KGPRA* MNOTE           00127300
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00127400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00127500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00127600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00127700
.ZG9R         ANOP  ,                                                   00127800
.*-------------------------------------------------------------------   00127900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128000
.ZG11         ANOP  ,                                                   00128100
&ZTLC         SETC 'REMOVE'                                             00128200
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG18                     00128300
&XREQUEST     SETC  'REMOVE'    SET KEYWORD                             00128400
              AIF   (N'&REQUEST LE 1).ZG11A     CK NUM                  00128500
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00128600
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00128700
&ZMS          SETC  '&ZMS "REQUEST"'                                    00128800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00128900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00129000
.ZG11A        ANOP  ,                                                   00129100
.*----------------------------------------------------------------***   00129200
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00129300
              AIF   (N'&BUFFER LE 1).ZG13A      CK NUM                  00129400
&ZMS          SETC  '"BUFFER='  *KPOSA* MNOTE                           00129500
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00129600
&ZMS          SETC  '&ZMS "BUFFER"'                                     00129700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00129800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00129900
.ZG13A        ANOP  ,                                                   00130000
.*-------------------------------------------------------------------   00130100
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00130200
&ZXBUFFER     SETC  'INPUT'     SET IN/OUTPUT                           00130300
&XBUFFER      SETC  '&BUFFER(1)'                SET XVARIABLE           00130400
              AIF   (N'&BUFFER GT 1).ZG13B      MULTI PARMS             00130500
&XBUFFER      SETC  '&BUFFER'   SET XVARIABLE                           00130600
.ZG13B        AIF   (K'&BUFFER(1) GT 0).ZG13C                           00130700
&ZXBUFFER     SETC  ''          RESET IN/OUTPUT                         00130800
&ZMS          SETC  'WHEN "REMOVE" IS SPECIFIED'  *KRQDA*               00130900
&ZMS          SETC  '&ZMS , "BUFFER" KEY AND ITS'                       00131000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00131100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131200
.ZG13C        ANOP  ,                                                   00131300
.*-------------------------------------------------------------------   00131400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00131500
              AIF   (K'&ZXBUFFER LE 0).ZG13R    NOT I/O                 00131600
              AIF   ('&XBUFFER'(1,1) NE '(').ZG13R                      00131700
&ZCGPR        SETC  '&XBUFFER'(2,K'&XBUFFER-2)                          00131800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG13P                        00131900
              AIF   (K'&ZCGPR GT 2).ZG13Q                               00132000
              AIF   ('&ZCGPR' EQ '0').ZG13Q                             00132100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00132200
              AIF   (T'&ZCGPR NE 'N').ZG13Q     INVALID REG NAME        00132300
.ZG13P        ANOP  ,                                                   00132400
              AIF   (T'&ZCGPR NE 'N').ZG13R     NON NUMERIC             00132500
              AIF   ('&ZCGPR' LT '2').ZG13Q                             00132600
              AIF   ('&ZCGPR' LE '12').ZG13R                            00132700
.ZG13Q        ANOP  ,                                                   00132800
&ZMS          SETC  '"BUFFER='  *KGPRA* MNOTE                           00132900
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00133000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00133100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00133200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133300
.ZG13R        ANOP  ,                                                   00133400
.*----------------------------------------------------------------***   00133500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00133600
              AIF   (N'&BUFSIZE LE 1).ZG16A     CK NUM                  00133700
&ZMS          SETC  '"BUFSIZE='                 *KPOSA* MNOTE           00133800
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00133900
&ZMS          SETC  '&ZMS "BUFSIZE"'                                    00134000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00134100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134200
.ZG16A        ANOP  ,                                                   00134300
.*-------------------------------------------------------------------   00134400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00134500
&ZXBUFSIZE    SETC  'INPUT'     SET IN/OUTPUT                           00134600
&XBUFSIZE     SETC  '&BUFSIZE(1)'               SET XVARIABLE           00134700
              AIF   (N'&BUFSIZE GT 1).ZG16B     MULTI PARMS             00134800
&XBUFSIZE     SETC  '&BUFSIZE'  SET XVARIABLE                           00134900
.ZG16B        AIF   (K'&BUFSIZE(1) GT 0).ZG16C                          00135000
&ZXBUFSIZE    SETC  ''          RESET IN/OUTPUT                         00135100
&ZMS          SETC  'WHEN "REMOVE" IS SPECIFIED'  *KRQDA*               00135200
&ZMS          SETC  '&ZMS , "BUFSIZE" KEY AND ITS'                      00135300
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00135400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00135500
.ZG16C        ANOP  ,                                                   00135600
.*-------------------------------------------------------------------   00135700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00135800
              AIF   (K'&ZXBUFSIZE LE 0).ZG16R   NOT I/O                 00135900
              AIF   ('&XBUFSIZE'(1,1) NE '(').ZG16R                     00136000
&ZCGPR        SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                        00136100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        00136200
              AIF   (K'&ZCGPR GT 2).ZG16Q                               00136300
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             00136400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00136500
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        00136600
.ZG16P        ANOP  ,                                                   00136700
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             00136800
              AIF   ('&ZCGPR' LT '2').ZG16Q                             00136900
              AIF   ('&ZCGPR' LE '12').ZG16R                            00137000
.ZG16Q        ANOP  ,                                                   00137100
&ZMS          SETC  '"BUFSIZE='                 *KGPRA* MNOTE           00137200
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00137300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00137400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00137500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00137600
.ZG16R        ANOP  ,                                                   00137700
.*------------------------------------------------------------------    00137800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137900
.ZG18         ANOP  ,                                                   00138000
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00138100
              AIF   (K'&XREQUEST GT 0).ZG18E    VALID ARG               00138200
              AIF   (T'&REQUEST EQ 'O').ZG18D   OMITTED                 00138300
&ZASYSLNDX    SETA  0                                                   00138400
.ZG18A        ANOP  ,           POSITIONAL MACRO KEY                    00138500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00138600
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG18C                    00138700
&ZTLC         SETC 'REQUEST'                                            00138800
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG18A           00138900
.ZG18B        ANOP  ,                                                   00139000
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00139100
&ZMS          SETC  'THE "REQUEST" KEY'         *KOPTA* MNOTE           00139200
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00139300
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00139400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00139500
              AGO   .ZG18E                                              00139600
.ZG18C        ANOP  ,                                                   00139700
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00139800
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           00139900
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00140000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00140100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00140200
&ZMS          SETC  '&ZMS "COUNT",'                                     00140300
&ZMS          SETC  '&ZMS "INFO",'                                      00140400
&ZMS          SETC  '&ZMS OR "REMOVE".'                                 00140500
              MNOTE 8,' &ZMS '                                          00140600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140700
              AGO   .ZG18E                                              00140800
.ZG18D        ANOP  ,                                                   00140900
&XREQUEST     SETC  'COUNT'     SET DEFAULT KEYWORD                     00141000
.ZG18E        ANOP  ,                                                   00141100
.*----------------------------------------------------------------***   00141200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00141300
              AIF   (N'&CLASS LE 1).ZG20A       CK NUM                  00141400
&ZMS          SETC  '"CLASS='   *KPOSA* MNOTE                           00141500
&ZMS          SETC  '&ZMS.&CLASS"'                                      00141600
&ZMS          SETC  '&ZMS "CLASS"'                                      00141700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00141800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141900
.ZG20A        ANOP  ,                                                   00142000
.*-------------------------------------------------------------------   00142100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00142200
&ZXCLASS      SETC  'INPUT'     SET IN/OUTPUT                           00142300
&XCLASS       SETC  'ANY_CLASS'                                         00142400
              AIF   (K'&CLASS(1) LE 0).ZG20B    PARM                    00142500
&XCLASS       SETC  '&CLASS(1)'                 SET XVARIABLE           00142600
              AIF   (N'&CLASS GT 1).ZG20B       MULTI PARMS             00142700
&XCLASS       SETC  '&CLASS'    SET XVARIABLE                           00142800
.ZG20B        ANOP  ,                                                   00142900
.*-------------------------------------------------------------------   00143000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00143100
              AIF   (K'&ZXCLASS LE 0).ZG20R     NOT I/O                 00143200
         AIF   ('&XCLASS' EQ 'ANY_CLASS').ZG20R                         00143300
              AIF   ('&XCLASS'(1,1) NE '(').ZG20R                       00143400
&ZCGPR        SETC  '&XCLASS'(2,K'&XCLASS-2)                            00143500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                        00143600
              AIF   (K'&ZCGPR GT 2).ZG20Q                               00143700
              AIF   ('&ZCGPR' EQ '0').ZG20Q                             00143800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00143900
              AIF   (T'&ZCGPR NE 'N').ZG20Q     INVALID REG NAME        00144000
.ZG20P        ANOP  ,                                                   00144100
              AIF   (T'&ZCGPR NE 'N').ZG20R     NON NUMERIC             00144200
              AIF   ('&ZCGPR' LT '2').ZG20Q                             00144300
              AIF   ('&ZCGPR' LE '12').ZG20R                            00144400
.ZG20Q        ANOP  ,                                                   00144500
&ZMS          SETC  '"CLASS='   *KGPRA* MNOTE                           00144600
&ZMS          SETC  '&ZMS.&CLASS"'                                      00144700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00144800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00144900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145000
.ZG20R        ANOP  ,                                                   00145100
.*----------------------------------------------------------------***   00145200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00145300
              AIF   (N'&CMD LE 1).ZG23A         CK NUM                  00145400
&ZMS          SETC  '"CMD='     *KPOSA* MNOTE                           00145500
&ZMS          SETC  '&ZMS.&CMD"'                                        00145600
&ZMS          SETC  '&ZMS "CMD"'                                        00145700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00145800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145900
.ZG23A        ANOP  ,                                                   00146000
.*-------------------------------------------------------------------   00146100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00146200
&ZXCMD        SETC  'INPUT'     SET IN/OUTPUT                           00146300
&XCMD         SETC  'ANY_CMD'                                           00146400
              AIF   (K'&CMD(1) LE 0).ZG23B      PARM                    00146500
&XCMD         SETC  '&CMD(1)'   SET XVARIABLE                           00146600
              AIF   (N'&CMD GT 1).ZG23B         MULTI PARMS             00146700
&XCMD         SETC  '&CMD'      SET XVARIABLE                           00146800
.ZG23B        ANOP  ,                                                   00146900
.*-------------------------------------------------------------------   00147000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00147100
              AIF   (K'&ZXCMD LE 0).ZG23R       NOT I/O                 00147200
         AIF   ('&XCMD' EQ 'ANY_CMD').ZG23R                             00147300
              AIF   ('&XCMD'(1,1) NE '(').ZG23R                         00147400
&ZCGPR        SETC  '&XCMD'(2,K'&XCMD-2)                                00147500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                        00147600
              AIF   (K'&ZCGPR GT 2).ZG23Q                               00147700
              AIF   ('&ZCGPR' EQ '0').ZG23Q                             00147800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00147900
              AIF   (T'&ZCGPR NE 'N').ZG23Q     INVALID REG NAME        00148000
.ZG23P        ANOP  ,                                                   00148100
              AIF   (T'&ZCGPR NE 'N').ZG23R     NON NUMERIC             00148200
              AIF   ('&ZCGPR' LT '2').ZG23Q                             00148300
              AIF   ('&ZCGPR' LE '12').ZG23R                            00148400
.ZG23Q        ANOP  ,                                                   00148500
&ZMS          SETC  '"CMD='     *KGPRA* MNOTE                           00148600
&ZMS          SETC  '&ZMS.&CMD"'                                        00148700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00148800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00148900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149000
.ZG23R        ANOP  ,                                                   00149100
.*----------------------------------------------------------------***   00149200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00149300
              AIF   (N'&ID LE 1).ZG26A          CK NUM                  00149400
&ZMS          SETC  '"ID='      *KPOSA* MNOTE                           00149500
&ZMS          SETC  '&ZMS.&ID"'                                         00149600
&ZMS          SETC  '&ZMS "ID"'                                         00149700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00149800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149900
.ZG26A        ANOP  ,                                                   00150000
.*-------------------------------------------------------------------   00150100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00150200
&ZXID         SETC  'INPUT'     SET IN/OUTPUT                           00150300
&XID          SETC  'ANY_ID'                                            00150400
              AIF   (K'&ID(1) LE 0).ZG26B       PARM                    00150500
&XID          SETC  '&ID(1)'    SET XVARIABLE                           00150600
              AIF   (N'&ID GT 1).ZG26B          MULTI PARMS             00150700
&XID          SETC  '&ID'       SET XVARIABLE                           00150800
.ZG26B        ANOP  ,                                                   00150900
.*-------------------------------------------------------------------   00151000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00151100
              AIF   (K'&ZXID LE 0).ZG26R        NOT I/O                 00151200
         AIF   ('&XID' EQ 'ANY_ID').ZG26R                               00151300
              AIF   ('&XID'(1,1) NE '(').ZG26R                          00151400
&ZCGPR        SETC  '&XID'(2,K'&XID-2)                                  00151500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        00151600
              AIF   (K'&ZCGPR GT 2).ZG26Q                               00151700
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             00151800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00151900
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        00152000
.ZG26P        ANOP  ,                                                   00152100
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             00152200
              AIF   ('&ZCGPR' LT '2').ZG26Q                             00152300
              AIF   ('&ZCGPR' LE '12').ZG26R                            00152400
.ZG26Q        ANOP  ,                                                   00152500
&ZMS          SETC  '"ID='      *KGPRA* MNOTE                           00152600
&ZMS          SETC  '&ZMS.&ID"'                                         00152700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00152800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00152900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00153000
.ZG26R        ANOP  ,                                                   00153100
.*----------------------------------------------------------------***   00153200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00153300
              AIF   (N'&JOB LE 1).ZG29A         CK NUM                  00153400
&ZMS          SETC  '"JOB='     *KPOSA* MNOTE                           00153500
&ZMS          SETC  '&ZMS.&JOB"'                                        00153600
&ZMS          SETC  '&ZMS "JOB"'                                        00153700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00153800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00153900
.ZG29A        ANOP  ,                                                   00154000
.*-------------------------------------------------------------------   00154100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00154200
&ZXJOB        SETC  'INPUT'     SET IN/OUTPUT                           00154300
&XJOB         SETC  'ANY_JOB'                                           00154400
              AIF   (K'&JOB(1) LE 0).ZG29B      PARM                    00154500
&XJOB         SETC  '&JOB(1)'   SET XVARIABLE                           00154600
              AIF   (N'&JOB GT 1).ZG29B         MULTI PARMS             00154700
&XJOB         SETC  '&JOB'      SET XVARIABLE                           00154800
.ZG29B        ANOP  ,                                                   00154900
.*-------------------------------------------------------------------   00155000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00155100
              AIF   (K'&ZXJOB LE 0).ZG29R       NOT I/O                 00155200
         AIF   ('&XJOB' EQ 'ANY_JOB').ZG29R                             00155300
              AIF   ('&XJOB'(1,1) NE '(').ZG29R                         00155400
&ZCGPR        SETC  '&XJOB'(2,K'&XJOB-2)                                00155500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                        00155600
              AIF   (K'&ZCGPR GT 2).ZG29Q                               00155700
              AIF   ('&ZCGPR' EQ '0').ZG29Q                             00155800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00155900
              AIF   (T'&ZCGPR NE 'N').ZG29Q     INVALID REG NAME        00156000
.ZG29P        ANOP  ,                                                   00156100
              AIF   (T'&ZCGPR NE 'N').ZG29R     NON NUMERIC             00156200
              AIF   ('&ZCGPR' LT '2').ZG29Q                             00156300
              AIF   ('&ZCGPR' LE '12').ZG29R                            00156400
.ZG29Q        ANOP  ,                                                   00156500
&ZMS          SETC  '"JOB='     *KGPRA* MNOTE                           00156600
&ZMS          SETC  '&ZMS.&JOB"'                                        00156700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00156800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00156900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157000
.ZG29R        ANOP  ,                                                   00157100
.*----------------------------------------------------------------***   00157200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00157300
              AIF   (N'&COUNT LE 1).ZG32A       CK NUM                  00157400
&ZMS          SETC  '"COUNT='   *KPOSA* MNOTE                           00157500
&ZMS          SETC  '&ZMS.&COUNT"'                                      00157600
&ZMS          SETC  '&ZMS "COUNT"'                                      00157700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00157800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157900
.ZG32A        ANOP  ,                                                   00158000
.*-------------------------------------------------------------------   00158100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00158200
&ZXCOUNT      SETC  'INPUT'     SET IN/OUTPUT                           00158300
&XCOUNT       SETC  '&COUNT(1)'                 SET XVARIABLE           00158400
              AIF   (N'&COUNT GT 1).ZG32B       MULTI PARMS             00158500
&XCOUNT       SETC  '&COUNT'    SET XVARIABLE                           00158600
.ZG32B        AIF   (K'&COUNT(1) GT 0).ZG32C                            00158700
&ZXCOUNT      SETC  ''          RESET IN/OUTPUT                         00158800
&ZMS          SETC  ' '         *KRQDA*                                 00158900
&ZMS          SETC  '&ZMS "COUNT" KEY AND ITS'                          00159000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00159100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00159200
.ZG32C        ANOP  ,                                                   00159300
.*-------------------------------------------------------------------   00159400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00159500
              AIF   (K'&ZXCOUNT LE 0).ZG32R     NOT I/O                 00159600
              AIF   ('&XCOUNT'(1,1) NE '(').ZG32R                       00159700
&ZCGPR        SETC  '&XCOUNT'(2,K'&XCOUNT-2)                            00159800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                        00159900
              AIF   (K'&ZCGPR GT 2).ZG32Q                               00160000
              AIF   ('&ZCGPR' EQ '0').ZG32Q                             00160100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00160200
              AIF   (T'&ZCGPR NE 'N').ZG32Q     INVALID REG NAME        00160300
.ZG32P        ANOP  ,                                                   00160400
              AIF   (T'&ZCGPR NE 'N').ZG32R     NON NUMERIC             00160500
              AIF   ('&ZCGPR' LT '2').ZG32Q                             00160600
              AIF   ('&ZCGPR' LE '12').ZG32R                            00160700
.ZG32Q        ANOP  ,                                                   00160800
&ZMS          SETC  '"COUNT='   *KGPRA* MNOTE                           00160900
&ZMS          SETC  '&ZMS.&COUNT"'                                      00161000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00161100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00161200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00161300
.ZG32R        ANOP  ,                                                   00161400
.*----------------------------------------------------------------***   00161500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00161600
              AIF   (N'&RETCODE LE 1).ZG35A     CK NUM                  00161700
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00161800
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00161900
&ZMS          SETC  '&ZMS "RETCODE"'                                    00162000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00162100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162200
.ZG35A        ANOP  ,                                                   00162300
.*-------------------------------------------------------------------   00162400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00162500
              AIF   (K'&RETCODE(1) LE 0).ZG35C  NO PARM                 00162600
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00162700
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00162800
              AIF   (N'&RETCODE GT 1).ZG35C                             00162900
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00163000
.ZG35C        ANOP  ,                                                   00163100
.*-------------------------------------------------------------------   00163200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00163300
              AIF   (K'&ZXRETCODE LE 0).ZG35R   NOT I/O                 00163400
              AIF   ('&XRETCODE'(1,1) NE '(').ZG35R                     00163500
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00163600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                        00163700
              AIF   (K'&ZCGPR GT 2).ZG35Q                               00163800
              AIF   ('&ZCGPR' EQ '0').ZG35Q                             00163900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00164000
              AIF   (T'&ZCGPR NE 'N').ZG35Q     INVALID REG NAME        00164100
.ZG35P        ANOP  ,                                                   00164200
              AIF   (T'&ZCGPR NE 'N').ZG35R     NON NUMERIC             00164300
              AIF   ('&ZCGPR' LT '2').ZG35Q                             00164400
              AIF   ('&ZCGPR' LE '12').ZG35R                            00164500
.ZG35Q        ANOP  ,                                                   00164600
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00164700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00164800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00164900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00165000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00165100
.ZG35R        ANOP  ,                                                   00165200
.*----------------------------------------------------------------***   00165300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00165400
              AIF   (N'&RSNCODE LE 1).ZG38A     CK NUM                  00165500
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00165600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00165700
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00165800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00165900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00166000
.ZG38A        ANOP  ,                                                   00166100
.*-------------------------------------------------------------------   00166200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00166300
              AIF   (K'&RSNCODE(1) LE 0).ZG38C  NO PARM                 00166400
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00166500
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00166600
              AIF   (N'&RSNCODE GT 1).ZG38C                             00166700
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00166800
.ZG38C        ANOP  ,                                                   00166900
.*-------------------------------------------------------------------   00167000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00167100
              AIF   (K'&ZXRSNCODE LE 0).ZG38R   NOT I/O                 00167200
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG38R                     00167300
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00167400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                        00167500
              AIF   (K'&ZCGPR GT 2).ZG38Q                               00167600
              AIF   ('&ZCGPR' EQ '0').ZG38Q                             00167700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00167800
              AIF   (T'&ZCGPR NE 'N').ZG38Q     INVALID REG NAME        00167900
.ZG38P        ANOP  ,                                                   00168000
              AIF   (T'&ZCGPR NE 'N').ZG38R     NON NUMERIC             00168100
              AIF   ('&ZCGPR' LT '2').ZG38Q                             00168200
              AIF   ('&ZCGPR' LE '12').ZG38R                            00168300
.ZG38Q        ANOP  ,                                                   00168400
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00168500
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00168600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00168700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00168800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00168900
.ZG38R        ANOP  ,                                                   00169000
.******************************************************************     00169100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00169200
.******************************************************************     00169300
              ACTR  10000                                               00169400
.*----------------------------------------------------------------***   00169500
.***AH.P02 EXTRA POSITIONALS                                            00169600
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00169700
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00169800
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00169900
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00170000
.ZGLISTX1     ANOP  ,                                                   00170100
&ZCVAL        SETC  ''          ERROR FIELD                             00170200
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00170300
.ZGLIST2      ANOP  ,                                                   00170400
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00170500
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00170600
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00170700
              AGO   .ZGLIST2                                            00170800
.*                                                                      00170900
.ZGLIST3      ANOP  ,                                                   00171000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00171100
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00171200
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00171300
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00171400
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00171500
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00171600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00171700
.ZGLISTX      ANOP  ,                                                   00171800
&ZASYSLNDX    SETA  0                                                   00171900
.*-------------------------------------------------------------------   00172000
.***AG.MF04 MF=(SLME)                                                   00172100
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00172200
.********************************************************************   00172300
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00172400
.********************************************************************   00172500
              ACTR  10000                                               00172600
.*-------------------------------------------------------------------   00172700
.***AE.MF01 MF=(SLME)                                                   00172800
              AIF   ('&XMF' EQ 'L').ZEMFX                               00172900
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00173000
.********************************************************************   00173100
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00173200
.********************************************************************   00173300
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00173400
.*-------------------------------------------------------------------   00173500
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173600
&ZTLC         SETC 'COUNT'                                              00173700
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A                     00173800
&XREQUEST     SETC  'COUNT'     SET KEYWORD                             00173900
              AIF   (N'&REQUEST LE 1).ZE3A      CK NUM                  00174000
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00174100
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00174200
&ZMS          SETC  '&ZMS "REQUEST"'                                    00174300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00174400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00174500
.ZE3A         ANOP  ,                                                   00174600
.*-------------------------------------------------------------------   00174700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174800
&ZTLC         SETC 'INFO'                                               00174900
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE4A                     00175000
&XREQUEST     SETC  'INFO'      SET KEYWORD                             00175100
              AIF   (N'&REQUEST LE 1).ZE4A      CK NUM                  00175200
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00175300
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00175400
&ZMS          SETC  '&ZMS "REQUEST"'                                    00175500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00175600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175700
.ZE4A         ANOP  ,                                                   00175800
.*----------------------------------------------------------------***   00175900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00176000
              AIF   (N'&BUFFER LE 1).ZE6A       CK NUM                  00176100
&ZMS          SETC  '"BUFFER='  *KPOSA* MNOTE                           00176200
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00176300
&ZMS          SETC  '&ZMS "BUFFER"'                                     00176400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00176500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00176600
.ZE6A         ANOP  ,                                                   00176700
.*-------------------------------------------------------------------   00176800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00176900
              AIF   (K'&BUFFER(1) LE 0).ZE6B    NO PRM                  00177000
&ZXBUFFER     SETC  'INPUT'     SET IN/OUTPUT                           00177100
&XBUFFER      SETC  '&BUFFER(1)'                SET XVARIABLE           00177200
              AIF   (N'&BUFFER GT 1).ZE6B                               00177300
.*            ANOP              MULTIPLE PARMS                          00177400
&XBUFFER      SETC  '&BUFFER'   SET XVARIABLE                           00177500
.ZE6B         ANOP  ,                                                   00177600
.*-------------------------------------------------------------------   00177700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00177800
              AIF   (K'&ZXBUFFER LE 0).ZE6R     NOT I/O                 00177900
              AIF   ('&XBUFFER'(1,1) NE '(').ZE6R                       00178000
&ZCGPR        SETC  '&XBUFFER'(2,K'&XBUFFER-2)                          00178100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE6P                         00178200
              AIF   (K'&ZCGPR GT 2).ZE6Q                                00178300
              AIF   ('&ZCGPR' EQ '0').ZE6Q                              00178400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00178500
              AIF   (T'&ZCGPR NE 'N').ZE6Q      INVALID REG NAME        00178600
.ZE6P         ANOP  ,                                                   00178700
              AIF   (T'&ZCGPR NE 'N').ZE6R      NON NUMERIC             00178800
              AIF   ('&ZCGPR' LT '2').ZE6Q                              00178900
              AIF   ('&ZCGPR' LE '12').ZE6R                             00179000
.ZE6Q         ANOP  ,                                                   00179100
&ZMS          SETC  '"BUFFER='  *KGPRA* MNOTE                           00179200
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00179300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00179400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00179500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00179600
.ZE6R         ANOP  ,                                                   00179700
.*----------------------------------------------------------------***   00179800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00179900
              AIF   (N'&BUFSIZE LE 1).ZE9A      CK NUM                  00180000
&ZMS          SETC  '"BUFSIZE='                 *KPOSA* MNOTE           00180100
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00180200
&ZMS          SETC  '&ZMS "BUFSIZE"'                                    00180300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00180400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00180500
.ZE9A         ANOP  ,                                                   00180600
.*-------------------------------------------------------------------   00180700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00180800
              AIF   (K'&BUFSIZE(1) LE 0).ZE9B   NO PRM                  00180900
&ZXBUFSIZE    SETC  'INPUT'     SET IN/OUTPUT                           00181000
&XBUFSIZE     SETC  '&BUFSIZE(1)'               SET XVARIABLE           00181100
              AIF   (N'&BUFSIZE GT 1).ZE9B                              00181200
.*            ANOP              MULTIPLE PARMS                          00181300
&XBUFSIZE     SETC  '&BUFSIZE'  SET XVARIABLE                           00181400
.ZE9B         ANOP  ,                                                   00181500
.*-------------------------------------------------------------------   00181600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00181700
              AIF   (K'&ZXBUFSIZE LE 0).ZE9R    NOT I/O                 00181800
              AIF   ('&XBUFSIZE'(1,1) NE '(').ZE9R                      00181900
&ZCGPR        SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                        00182000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE9P                         00182100
              AIF   (K'&ZCGPR GT 2).ZE9Q                                00182200
              AIF   ('&ZCGPR' EQ '0').ZE9Q                              00182300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00182400
              AIF   (T'&ZCGPR NE 'N').ZE9Q      INVALID REG NAME        00182500
.ZE9P         ANOP  ,                                                   00182600
              AIF   (T'&ZCGPR NE 'N').ZE9R      NON NUMERIC             00182700
              AIF   ('&ZCGPR' LT '2').ZE9Q                              00182800
              AIF   ('&ZCGPR' LE '12').ZE9R                             00182900
.ZE9Q         ANOP  ,                                                   00183000
&ZMS          SETC  '"BUFSIZE='                 *KGPRA* MNOTE           00183100
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00183200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00183300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00183400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00183500
.ZE9R         ANOP  ,                                                   00183600
.*-------------------------------------------------------------------   00183700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183800
&ZTLC         SETC 'REMOVE'                                             00183900
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE11A                    00184000
&XREQUEST     SETC  'REMOVE'    SET KEYWORD                             00184100
              AIF   (N'&REQUEST LE 1).ZE11A     CK NUM                  00184200
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           00184300
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00184400
&ZMS          SETC  '&ZMS "REQUEST"'                                    00184500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00184600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00184700
.ZE11A        ANOP  ,                                                   00184800
.*----------------------------------------------------------------***   00184900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00185000
              AIF   (N'&BUFFER LE 1).ZE13A      CK NUM                  00185100
&ZMS          SETC  '"BUFFER='  *KPOSA* MNOTE                           00185200
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00185300
&ZMS          SETC  '&ZMS "BUFFER"'                                     00185400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00185500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00185600
.ZE13A        ANOP  ,                                                   00185700
.*-------------------------------------------------------------------   00185800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00185900
              AIF   (K'&BUFFER(1) LE 0).ZE13B   NO PRM                  00186000
&ZXBUFFER     SETC  'INPUT'     SET IN/OUTPUT                           00186100
&XBUFFER      SETC  '&BUFFER(1)'                SET XVARIABLE           00186200
              AIF   (N'&BUFFER GT 1).ZE13B                              00186300
.*            ANOP              MULTIPLE PARMS                          00186400
&XBUFFER      SETC  '&BUFFER'   SET XVARIABLE                           00186500
.ZE13B        ANOP  ,                                                   00186600
.*-------------------------------------------------------------------   00186700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00186800
              AIF   (K'&ZXBUFFER LE 0).ZE13R    NOT I/O                 00186900
              AIF   ('&XBUFFER'(1,1) NE '(').ZE13R                      00187000
&ZCGPR        SETC  '&XBUFFER'(2,K'&XBUFFER-2)                          00187100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE13P                        00187200
              AIF   (K'&ZCGPR GT 2).ZE13Q                               00187300
              AIF   ('&ZCGPR' EQ '0').ZE13Q                             00187400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00187500
              AIF   (T'&ZCGPR NE 'N').ZE13Q     INVALID REG NAME        00187600
.ZE13P        ANOP  ,                                                   00187700
              AIF   (T'&ZCGPR NE 'N').ZE13R     NON NUMERIC             00187800
              AIF   ('&ZCGPR' LT '2').ZE13Q                             00187900
              AIF   ('&ZCGPR' LE '12').ZE13R                            00188000
.ZE13Q        ANOP  ,                                                   00188100
&ZMS          SETC  '"BUFFER='  *KGPRA* MNOTE                           00188200
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00188300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00188400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00188500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00188600
.ZE13R        ANOP  ,                                                   00188700
.*----------------------------------------------------------------***   00188800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00188900
              AIF   (N'&BUFSIZE LE 1).ZE16A     CK NUM                  00189000
&ZMS          SETC  '"BUFSIZE='                 *KPOSA* MNOTE           00189100
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00189200
&ZMS          SETC  '&ZMS "BUFSIZE"'                                    00189300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00189400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00189500
.ZE16A        ANOP  ,                                                   00189600
.*-------------------------------------------------------------------   00189700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00189800
              AIF   (K'&BUFSIZE(1) LE 0).ZE16B  NO PRM                  00189900
&ZXBUFSIZE    SETC  'INPUT'     SET IN/OUTPUT                           00190000
&XBUFSIZE     SETC  '&BUFSIZE(1)'               SET XVARIABLE           00190100
              AIF   (N'&BUFSIZE GT 1).ZE16B                             00190200
.*            ANOP              MULTIPLE PARMS                          00190300
&XBUFSIZE     SETC  '&BUFSIZE'  SET XVARIABLE                           00190400
.ZE16B        ANOP  ,                                                   00190500
.*-------------------------------------------------------------------   00190600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00190700
              AIF   (K'&ZXBUFSIZE LE 0).ZE16R   NOT I/O                 00190800
              AIF   ('&XBUFSIZE'(1,1) NE '(').ZE16R                     00190900
&ZCGPR        SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                        00191000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                        00191100
              AIF   (K'&ZCGPR GT 2).ZE16Q                               00191200
              AIF   ('&ZCGPR' EQ '0').ZE16Q                             00191300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00191400
              AIF   (T'&ZCGPR NE 'N').ZE16Q     INVALID REG NAME        00191500
.ZE16P        ANOP  ,                                                   00191600
              AIF   (T'&ZCGPR NE 'N').ZE16R     NON NUMERIC             00191700
              AIF   ('&ZCGPR' LT '2').ZE16Q                             00191800
              AIF   ('&ZCGPR' LE '12').ZE16R                            00191900
.ZE16Q        ANOP  ,                                                   00192000
&ZMS          SETC  '"BUFSIZE='                 *KGPRA* MNOTE           00192100
&ZMS          SETC  '&ZMS.&BUFSIZE"'                                    00192200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00192300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00192400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00192500
.ZE16R        ANOP  ,                                                   00192600
.*------------------------------------------------------------------    00192700
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00192800
.ZE18         AIF   (K'&XREQUEST GT 0).ZE18A    VALID                   00192900
              AIF   (K'&REQUEST(1) LE 0).ZE18B                          00193000
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           00193100
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00193200
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00193300
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00193400
&ZMS          SETC  '&ZMS "COUNT",'                                     00193500
&ZMS          SETC  '&ZMS "INFO",'                                      00193600
&ZMS          SETC  '&ZMS OR "REMOVE".'                                 00193700
              MNOTE 8,' &ZMS '                                          00193800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00193900
              AGO   .ZE18B                                              00194000
.*                                                                      00194100
.ZE18A        ANOP  ,                                                   00194200
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00194300
.ZE18B        ANOP  ,                                                   00194400
.*----------------------------------------------------------------***   00194500
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00194600
              AIF   (N'&CLASS LE 1).ZE20A       CK NUM                  00194700
&ZMS          SETC  '"CLASS='   *KPOSA* MNOTE                           00194800
&ZMS          SETC  '&ZMS.&CLASS"'                                      00194900
&ZMS          SETC  '&ZMS "CLASS"'                                      00195000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00195100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00195200
.ZE20A        ANOP  ,                                                   00195300
.*-------------------------------------------------------------------   00195400
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00195500
              AIF   (K'&CLASS(1) LE 0).ZE20B    NO PRM                  00195600
&ZXCLASS      SETC  'INPUT'     SET IN/OUTPUT                           00195700
&XCLASS       SETC  '&CLASS(1)'                 SET XVARIABLE           00195800
              AIF   (N'&CLASS GT 1).ZE20B                               00195900
.*            ANOP              MULTIPLE PARMS                          00196000
&XCLASS       SETC  '&CLASS'    SET XVARIABLE                           00196100
.ZE20B        ANOP  ,                                                   00196200
.*-------------------------------------------------------------------   00196300
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00196400
              AIF   (K'&ZXCLASS LE 0).ZE20R     NOT I/O                 00196500
              AIF   ('&XCLASS'(1,1) NE '(').ZE20R                       00196600
&ZCGPR        SETC  '&XCLASS'(2,K'&XCLASS-2)                            00196700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE20P                        00196800
              AIF   (K'&ZCGPR GT 2).ZE20Q                               00196900
              AIF   ('&ZCGPR' EQ '0').ZE20Q                             00197000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00197100
              AIF   (T'&ZCGPR NE 'N').ZE20Q     INVALID REG NAME        00197200
.ZE20P        ANOP  ,                                                   00197300
              AIF   (T'&ZCGPR NE 'N').ZE20R     NON NUMERIC             00197400
              AIF   ('&ZCGPR' LT '2').ZE20Q                             00197500
              AIF   ('&ZCGPR' LE '12').ZE20R                            00197600
.ZE20Q        ANOP  ,                                                   00197700
&ZMS          SETC  '"CLASS='   *KGPRA* MNOTE                           00197800
&ZMS          SETC  '&ZMS.&CLASS"'                                      00197900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00198000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00198100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00198200
.ZE20R        ANOP  ,                                                   00198300
.*----------------------------------------------------------------***   00198400
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00198500
              AIF   (N'&CMD LE 1).ZE23A         CK NUM                  00198600
&ZMS          SETC  '"CMD='     *KPOSA* MNOTE                           00198700
&ZMS          SETC  '&ZMS.&CMD"'                                        00198800
&ZMS          SETC  '&ZMS "CMD"'                                        00198900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00199000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00199100
.ZE23A        ANOP  ,                                                   00199200
.*-------------------------------------------------------------------   00199300
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00199400
              AIF   (K'&CMD(1) LE 0).ZE23B      NO PRM                  00199500
&ZXCMD        SETC  'INPUT'     SET IN/OUTPUT                           00199600
&XCMD         SETC  '&CMD(1)'   SET XVARIABLE                           00199700
              AIF   (N'&CMD GT 1).ZE23B                                 00199800
.*            ANOP              MULTIPLE PARMS                          00199900
&XCMD         SETC  '&CMD'      SET XVARIABLE                           00200000
.ZE23B        ANOP  ,                                                   00200100
.*-------------------------------------------------------------------   00200200
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00200300
              AIF   (K'&ZXCMD LE 0).ZE23R       NOT I/O                 00200400
              AIF   ('&XCMD'(1,1) NE '(').ZE23R                         00200500
&ZCGPR        SETC  '&XCMD'(2,K'&XCMD-2)                                00200600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                        00200700
              AIF   (K'&ZCGPR GT 2).ZE23Q                               00200800
              AIF   ('&ZCGPR' EQ '0').ZE23Q                             00200900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00201000
              AIF   (T'&ZCGPR NE 'N').ZE23Q     INVALID REG NAME        00201100
.ZE23P        ANOP  ,                                                   00201200
              AIF   (T'&ZCGPR NE 'N').ZE23R     NON NUMERIC             00201300
              AIF   ('&ZCGPR' LT '2').ZE23Q                             00201400
              AIF   ('&ZCGPR' LE '12').ZE23R                            00201500
.ZE23Q        ANOP  ,                                                   00201600
&ZMS          SETC  '"CMD='     *KGPRA* MNOTE                           00201700
&ZMS          SETC  '&ZMS.&CMD"'                                        00201800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00201900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00202000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00202100
.ZE23R        ANOP  ,                                                   00202200
.*----------------------------------------------------------------***   00202300
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00202400
              AIF   (N'&ID LE 1).ZE26A          CK NUM                  00202500
&ZMS          SETC  '"ID='      *KPOSA* MNOTE                           00202600
&ZMS          SETC  '&ZMS.&ID"'                                         00202700
&ZMS          SETC  '&ZMS "ID"'                                         00202800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00202900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00203000
.ZE26A        ANOP  ,                                                   00203100
.*-------------------------------------------------------------------   00203200
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00203300
              AIF   (K'&ID(1) LE 0).ZE26B       NO PRM                  00203400
&ZXID         SETC  'INPUT'     SET IN/OUTPUT                           00203500
&XID          SETC  '&ID(1)'    SET XVARIABLE                           00203600
              AIF   (N'&ID GT 1).ZE26B                                  00203700
.*            ANOP              MULTIPLE PARMS                          00203800
&XID          SETC  '&ID'       SET XVARIABLE                           00203900
.ZE26B        ANOP  ,                                                   00204000
.*-------------------------------------------------------------------   00204100
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00204200
              AIF   (K'&ZXID LE 0).ZE26R        NOT I/O                 00204300
              AIF   ('&XID'(1,1) NE '(').ZE26R                          00204400
&ZCGPR        SETC  '&XID'(2,K'&XID-2)                                  00204500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                        00204600
              AIF   (K'&ZCGPR GT 2).ZE26Q                               00204700
              AIF   ('&ZCGPR' EQ '0').ZE26Q                             00204800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00204900
              AIF   (T'&ZCGPR NE 'N').ZE26Q     INVALID REG NAME        00205000
.ZE26P        ANOP  ,                                                   00205100
              AIF   (T'&ZCGPR NE 'N').ZE26R     NON NUMERIC             00205200
              AIF   ('&ZCGPR' LT '2').ZE26Q                             00205300
              AIF   ('&ZCGPR' LE '12').ZE26R                            00205400
.ZE26Q        ANOP  ,                                                   00205500
&ZMS          SETC  '"ID='      *KGPRA* MNOTE                           00205600
&ZMS          SETC  '&ZMS.&ID"'                                         00205700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00205800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00205900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00206000
.ZE26R        ANOP  ,                                                   00206100
.*----------------------------------------------------------------***   00206200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00206300
              AIF   (N'&JOB LE 1).ZE29A         CK NUM                  00206400
&ZMS          SETC  '"JOB='     *KPOSA* MNOTE                           00206500
&ZMS          SETC  '&ZMS.&JOB"'                                        00206600
&ZMS          SETC  '&ZMS "JOB"'                                        00206700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00206800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00206900
.ZE29A        ANOP  ,                                                   00207000
.*-------------------------------------------------------------------   00207100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00207200
              AIF   (K'&JOB(1) LE 0).ZE29B      NO PRM                  00207300
&ZXJOB        SETC  'INPUT'     SET IN/OUTPUT                           00207400
&XJOB         SETC  '&JOB(1)'   SET XVARIABLE                           00207500
              AIF   (N'&JOB GT 1).ZE29B                                 00207600
.*            ANOP              MULTIPLE PARMS                          00207700
&XJOB         SETC  '&JOB'      SET XVARIABLE                           00207800
.ZE29B        ANOP  ,                                                   00207900
.*-------------------------------------------------------------------   00208000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00208100
              AIF   (K'&ZXJOB LE 0).ZE29R       NOT I/O                 00208200
              AIF   ('&XJOB'(1,1) NE '(').ZE29R                         00208300
&ZCGPR        SETC  '&XJOB'(2,K'&XJOB-2)                                00208400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                        00208500
              AIF   (K'&ZCGPR GT 2).ZE29Q                               00208600
              AIF   ('&ZCGPR' EQ '0').ZE29Q                             00208700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00208800
              AIF   (T'&ZCGPR NE 'N').ZE29Q     INVALID REG NAME        00208900
.ZE29P        ANOP  ,                                                   00209000
              AIF   (T'&ZCGPR NE 'N').ZE29R     NON NUMERIC             00209100
              AIF   ('&ZCGPR' LT '2').ZE29Q                             00209200
              AIF   ('&ZCGPR' LE '12').ZE29R                            00209300
.ZE29Q        ANOP  ,                                                   00209400
&ZMS          SETC  '"JOB='     *KGPRA* MNOTE                           00209500
&ZMS          SETC  '&ZMS.&JOB"'                                        00209600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00209700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00209800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00209900
.ZE29R        ANOP  ,                                                   00210000
.*----------------------------------------------------------------***   00210100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00210200
              AIF   (N'&COUNT LE 1).ZE32A       CK NUM                  00210300
&ZMS          SETC  '"COUNT='   *KPOSA* MNOTE                           00210400
&ZMS          SETC  '&ZMS.&COUNT"'                                      00210500
&ZMS          SETC  '&ZMS "COUNT"'                                      00210600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00210700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00210800
.ZE32A        ANOP  ,                                                   00210900
.*-------------------------------------------------------------------   00211000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00211100
              AIF   (K'&COUNT(1) LE 0).ZE32B    NO PRM                  00211200
&ZXCOUNT      SETC  'INPUT'     SET IN/OUTPUT                           00211300
&XCOUNT       SETC  '&COUNT(1)'                 SET XVARIABLE           00211400
              AIF   (N'&COUNT GT 1).ZE32B                               00211500
.*            ANOP              MULTIPLE PARMS                          00211600
&XCOUNT       SETC  '&COUNT'    SET XVARIABLE                           00211700
.ZE32B        ANOP  ,                                                   00211800
.*-------------------------------------------------------------------   00211900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00212000
              AIF   (K'&ZXCOUNT LE 0).ZE32R     NOT I/O                 00212100
              AIF   ('&XCOUNT'(1,1) NE '(').ZE32R                       00212200
&ZCGPR        SETC  '&XCOUNT'(2,K'&XCOUNT-2)                            00212300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE32P                        00212400
              AIF   (K'&ZCGPR GT 2).ZE32Q                               00212500
              AIF   ('&ZCGPR' EQ '0').ZE32Q                             00212600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00212700
              AIF   (T'&ZCGPR NE 'N').ZE32Q     INVALID REG NAME        00212800
.ZE32P        ANOP  ,                                                   00212900
              AIF   (T'&ZCGPR NE 'N').ZE32R     NON NUMERIC             00213000
              AIF   ('&ZCGPR' LT '2').ZE32Q                             00213100
              AIF   ('&ZCGPR' LE '12').ZE32R                            00213200
.ZE32Q        ANOP  ,                                                   00213300
&ZMS          SETC  '"COUNT='   *KGPRA* MNOTE                           00213400
&ZMS          SETC  '&ZMS.&COUNT"'                                      00213500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00213600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00213700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00213800
.ZE32R        ANOP  ,                                                   00213900
.*----------------------------------------------------------------***   00214000
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00214100
              AIF   (N'&RETCODE LE 1).ZE35A     CK NUM                  00214200
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00214300
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00214400
&ZMS          SETC  '&ZMS "RETCODE"'                                    00214500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00214600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00214700
.ZE35A        ANOP  ,                                                   00214800
.*-------------------------------------------------------------------   00214900
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00215000
              AIF   (K'&RETCODE(1) LE 0).ZE35B  NO PRM                  00215100
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00215200
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00215300
              AIF   (N'&RETCODE GT 1).ZE35B                             00215400
.*            ANOP              MULTIPLE PARMS                          00215500
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00215600
.ZE35B        ANOP  ,                                                   00215700
.*-------------------------------------------------------------------   00215800
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00215900
              AIF   (K'&ZXRETCODE LE 0).ZE35R   NOT I/O                 00216000
              AIF   ('&XRETCODE'(1,1) NE '(').ZE35R                     00216100
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00216200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE35P                        00216300
              AIF   (K'&ZCGPR GT 2).ZE35Q                               00216400
              AIF   ('&ZCGPR' EQ '0').ZE35Q                             00216500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00216600
              AIF   (T'&ZCGPR NE 'N').ZE35Q     INVALID REG NAME        00216700
.ZE35P        ANOP  ,                                                   00216800
              AIF   (T'&ZCGPR NE 'N').ZE35R     NON NUMERIC             00216900
              AIF   ('&ZCGPR' LT '2').ZE35Q                             00217000
              AIF   ('&ZCGPR' LE '12').ZE35R                            00217100
.ZE35Q        ANOP  ,                                                   00217200
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00217300
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00217400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00217500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00217600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00217700
.ZE35R        ANOP  ,                                                   00217800
.*----------------------------------------------------------------***   00217900
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00218000
              AIF   (N'&RSNCODE LE 1).ZE38A     CK NUM                  00218100
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00218200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00218300
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00218400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00218500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00218600
.ZE38A        ANOP  ,                                                   00218700
.*-------------------------------------------------------------------   00218800
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00218900
              AIF   (K'&RSNCODE(1) LE 0).ZE38B  NO PRM                  00219000
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00219100
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00219200
              AIF   (N'&RSNCODE GT 1).ZE38B                             00219300
.*            ANOP              MULTIPLE PARMS                          00219400
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00219500
.ZE38B        ANOP  ,                                                   00219600
.*-------------------------------------------------------------------   00219700
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00219800
              AIF   (K'&ZXRSNCODE LE 0).ZE38R   NOT I/O                 00219900
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE38R                     00220000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00220100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE38P                        00220200
              AIF   (K'&ZCGPR GT 2).ZE38Q                               00220300
              AIF   ('&ZCGPR' EQ '0').ZE38Q                             00220400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00220500
              AIF   (T'&ZCGPR NE 'N').ZE38Q     INVALID REG NAME        00220600
.ZE38P        ANOP  ,                                                   00220700
              AIF   (T'&ZCGPR NE 'N').ZE38R     NON NUMERIC             00220800
              AIF   ('&ZCGPR' LT '2').ZE38Q                             00220900
              AIF   ('&ZCGPR' LE '12').ZE38R                            00221000
.ZE38Q        ANOP  ,                                                   00221100
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00221200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00221300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00221400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00221500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00221600
.ZE38R        ANOP  ,                                                   00221700
.******************************************************************     00221800
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00221900
.******************************************************************     00222000
              ACTR  10000                                               00222100
.*----------------------------------------------------------------***   00222200
.***AF.P02 EXTRA POSITIONALS                                            00222300
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00222400
&ZCVAL        SETC  ''          ERROR FIELD                             00222500
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00222600
.ZELIST2      ANOP  ,                                                   00222700
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00222800
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00222900
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00223000
              AGO   .ZELIST2                                            00223100
.*                                                                      00223200
.ZELIST3      ANOP  ,                                                   00223300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00223400
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00223500
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00223600
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00223700
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00223800
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00223900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00224000
.ZELISTX      ANOP  ,                                                   00224100
&ZASYSLNDX    SETA  0                                                   00224200
.*-------------------------------------------------------------------   00224300
.***AE.MF02 MF=(SLME)                                                   00224400
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00224500
.*******************************************************************    00224600
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00224700
.*******************************************************************    00224800
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00224900
.*******************************************************************    00225000
.***AE.01  START OF IEECMDS MACRO CODE                                  00225100
.*******************************************************************    00225200
              LCLC  &M0M0001                 NAME                       00225300
&M0M0001      SETC  '&XLABEL'                SET NAME                   00225400
              AIF   (K'&XLABEL NE 0).XLAB2                              00225500
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00225600
.*                                                                      00225700
.XLAB2        ANOP  ,                                                   00225800
              AIF   ('&XMF' EQ 'L').XLAB3                               00225900
&M0M0001 DS    0H                             IEECMDS-1                 00226000
.XLAB3        ANOP  ,                                                   00226100
.*******************************************************************    00226200
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00226300
.*******************************************************************    00226400
              PUSH  PRINT                                               00226500
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00226600
              PRINT OFF         ++ PR01                                 00226700
              AGO   .ZPRNTXX                                            00226800
.ZPRINTX      PRINT ON                                                  00226900
.ZPRNTXX      ANOP  ,                                                   00227000
.********************************************************************   00227100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00227200
.********************************************************************   00227300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00227400
                      LCLA  &ZOPN1         INVOCATION INDEX             00227500
                      LCLC  &ZOPL(4095)    LABEL                        00227600
                      LCLC  &ZOPO(4095)    OPERATION                    00227700
                      LCLC  &ZOPV(4095)    VALUE                        00227800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00227900
.*                                                                      00228000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00228100
.******************************************************************     00228200
.***AL.L10 IEECMDS FMT=LIST MF=S|L PARAMETERS                           00228300
.******************************************************************     00228400
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00228500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00228600
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00228700
&XMFATTR              SETC  '0D'                                        00228800
.*                                                                      00228900
&ZOPN                 SETA  &ZOPN+1                                     00229000
&ZOPL(&ZOPN)          SETC  ' '                                         00229100
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00229200
&ZOPO(&ZOPN)          SETC  'B'                                         00229300
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00229400
                      AGO   .ZALVL6B                                    00229500
.ZALVL6A              ANOP                                              00229600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00229700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00229800
.ZALVL6B              ANOP                                              00229900
&ZOPD(&ZOPN)          SETC  '++ IEECMDS ARG PARMS'                      00230000
.*                                                                      00230100
&ZOPN                 SETA  &ZOPN+1                                     00230200
&ZOPL(&ZOPN)          SETC  ' '                                         00230300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00230400
&ZOPV(&ZOPN)          SETC  '1'                                         00230500
&ZOPD(&ZOPN)          SETC  ' '                                         00230600
.*                                                                      00230700
.ZLMFSL2              ANOP  ,                                           00230800
.*-------------------------------------------------------------------   00230900
.***AM.L00  IEECMDS FMT=LIST name                                       00231000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00231100
&ZOPN                 SETA &ZOPN+1                                      00231200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00231300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00231400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00231500
&ZOPD(&ZOPN)          SETC '++ IEECMDS NAME'                            00231600
.ZLMFSL2M             ANOP  ,                                           00231700
.*-------------------------------------------------------------------   00231800
.***AM.L01  IEECMDS FMT=LIST PARAMETERS                                 00231900
&ZOPN                 SETA &ZOPN+1                                      00232000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00232100
&ZOPO(&ZOPN)          SETC 'DS'                                         00232200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00232300
&ZOPD(&ZOPN)          SETC '++ IEECMDS PARM LIST'                       00232400
.*-------------------------------------------------------------------   00232500
.***AM.L09  XCSPLACRN CL4                                               00232600
&ZOPN                 SETA &ZOPN+1                                      00232700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCSPLACRN'                        00232800
&ZOPO(&ZOPN)          SETC 'DS'                                         00232900
&ZOPV(&ZOPN)          SETC 'CL4'                                        00233000
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XCSPLACRN'                     00233100
.*-------------------------------------------------------------------   00233200
.***AM.L09  XPLISTLEN XL2                                               00233300
&ZOPN                 SETA &ZOPN+1                                      00233400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00233500
&ZOPO(&ZOPN)          SETC 'DS'                                         00233600
&ZOPV(&ZOPN)          SETC 'XL2'                                        00233700
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        00233800
.*-------------------------------------------------------------------   00233900
.***AM.L02 XVERSION XL1                                                 00234000
&ZOPN                 SETA &ZOPN+1                                      00234100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00234200
&ZOPO(&ZOPN)          SETC 'DS'                                         00234300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00234400
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00234500
.*-------------------------------------------------------------------   00234600
.***AM.L05 XREQUEST XL1                                                 00234700
&ZOPN                 SETA &ZOPN+1                                      00234800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00234900
&ZOPO(&ZOPN)          SETC 'DS'                                         00235000
&ZOPV(&ZOPN)          SETC 'XL1'                                        00235100
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00235200
.*                                                                      00235300
&ZOPN                 SETA  &ZOPN+1                                     00235400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._COUNT'                           00235500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00235600
&ZOPV(&ZOPN)          SETC  '1'                                         00235700
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00235800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COUNT'                        00235900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00236000
.*                                                                      00236100
&ZOPN                 SETA  &ZOPN+1                                     00236200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._INFO'                            00236300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00236400
&ZOPV(&ZOPN)          SETC  '2'                                         00236500
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00236600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INFO'                         00236700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00236800
.*                                                                      00236900
&ZOPN                 SETA  &ZOPN+1                                     00237000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._REMOVE'                          00237100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00237200
&ZOPV(&ZOPN)          SETC  '3'                                         00237300
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00237400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REMOVE'                       00237500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00237600
.*-------------------------------------------------------------------   00237700
.***AM.L03 XFLAG1 BL.8                                                  00237800
&ZOPN                 SETA &ZOPN+1                                      00237900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAG1'                           00238000
&ZOPO(&ZOPN)          SETC 'DS'                                         00238100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00238200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00238300
.*                                                                      00238400
&ZOPN                 SETA  &ZOPN+1                                     00238500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CLASS'                   00238600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00238700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00238800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00238900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CLASS'                        00239000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239100
.*                                                                      00239200
&ZOPN                 SETA  &ZOPN+1                                     00239300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CMD'                     00239400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00239500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00239600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00239700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CMD'                          00239800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239900
.*                                                                      00240000
&ZOPN                 SETA  &ZOPN+1                                     00240100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ID'                      00240200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00240300
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00240400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00240500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ID'                           00240600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00240700
.*                                                                      00240800
&ZOPN                 SETA  &ZOPN+1                                     00240900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_JOB'                     00241000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00241100
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00241200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00241300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).JOB'                          00241400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00241500
.*-------------------------------------------------------------------   00241600
.***AM.L09  XRSV0001 CL3                                                00241700
&ZOPN                 SETA &ZOPN+1                                      00241800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00241900
&ZOPO(&ZOPN)          SETC 'DS'                                         00242000
&ZOPV(&ZOPN)          SETC 'CL3'                                        00242100
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00242200
.*-------------------------------------------------------------------   00242300
.***AM.L09  XCLASS CL4                                                  00242400
&ZOPN                 SETA &ZOPN+1                                      00242500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCLASS'                           00242600
&ZOPO(&ZOPN)          SETC 'DS'                                         00242700
&ZOPV(&ZOPN)          SETC 'CL4'                                        00242800
&ZOPD(&ZOPN)          SETC '++ &ZXCLASS  XCLASS'                        00242900
.*-------------------------------------------------------------------   00243000
.***AM.L09  XCMD CL8                                                    00243100
&ZOPN                 SETA &ZOPN+1                                      00243200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCMD'                             00243300
&ZOPO(&ZOPN)          SETC 'DS'                                         00243400
&ZOPV(&ZOPN)          SETC 'CL8'                                        00243500
&ZOPD(&ZOPN)          SETC '++ &ZXCMD  XCMD'                            00243600
.*-------------------------------------------------------------------   00243700
.***AM.L09  XID CL4                                                     00243800
&ZOPN                 SETA &ZOPN+1                                      00243900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XID'                              00244000
&ZOPO(&ZOPN)          SETC 'DS'                                         00244100
&ZOPV(&ZOPN)          SETC 'CL4'                                        00244200
&ZOPD(&ZOPN)          SETC '++ &ZXID  XID'                              00244300
.*-------------------------------------------------------------------   00244400
.***AM.L09  XJOB CL8                                                    00244500
&ZOPN                 SETA &ZOPN+1                                      00244600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XJOB'                             00244700
&ZOPO(&ZOPN)          SETC 'DS'                                         00244800
&ZOPV(&ZOPN)          SETC 'CL8'                                        00244900
&ZOPD(&ZOPN)          SETC '++ &ZXJOB  XJOB'                            00245000
.*-------------------------------------------------------------------   00245100
.***AM.L09 ADDR XBUFFER A                                               00245200
&ZOPN                 SETA &ZOPN+1                                      00245300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ADDR'                     00245400
&ZOPO(&ZOPN)          SETC 'DS'                                         00245500
&ZOPV(&ZOPN)          SETC 'A'                                          00245600
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ADDR XBUFFER'                  00245700
.*-------------------------------------------------------------------   00245800
.***AM.L09 ALET XBUFFER F                                               00245900
&ZOPN                 SETA &ZOPN+1                                      00246000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ALET'                     00246100
&ZOPO(&ZOPN)          SETC 'DS'                                         00246200
&ZOPV(&ZOPN)          SETC 'F'                                          00246300
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ALET XBUFFER'                  00246400
.*-------------------------------------------------------------------   00246500
.***AM.L09  XBUFSIZE F                                                  00246600
&ZOPN                 SETA &ZOPN+1                                      00246700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFSIZE'                         00246800
&ZOPO(&ZOPN)          SETC 'DS'                                         00246900
&ZOPV(&ZOPN)          SETC 'F'                                          00247000
&ZOPD(&ZOPN)          SETC '++ &ZXBUFSIZE  XBUFSIZE'                    00247100
.*-------------------------------------------------------------------   00247200
.***AM.L09 ADDR XCOUNT A                                                00247300
&ZOPN                 SETA &ZOPN+1                                      00247400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOUNT_ADDR'                      00247500
&ZOPO(&ZOPN)          SETC 'DS'                                         00247600
&ZOPV(&ZOPN)          SETC 'A'                                          00247700
&ZOPD(&ZOPN)          SETC '++ &ZXCOUNT ADDR XCOUNT'                    00247800
.*-------------------------------------------------------------------   00247900
.***AM.L10 END OF IEECMDS LIST PARAMETERS                               00248000
&ZOPN                 SETA &ZOPN+1                                      00248100
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00248200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00248300
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00248400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00248500
.*                                                                      00248600
&ZOPN                 SETA &ZOPN+1                                      00248700
&ZOPL(&ZOPN)          SETC ' '                                          00248800
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00248900
&ZOPV(&ZOPN)          SETC '1'                                          00249000
&ZOPD(&ZOPN)          SETC ' '                                          00249100
.*-------------------------------------------------------------------   00249200
.***AL.L12 IEECMDS FMT=LIST MF=S|L PARAMETERS                           00249300
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00249400
.*                                                                      00249500
&ZOPN                 SETA  &ZOPN+1                                     00249600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00249700
&ZOPO(&ZOPN)          SETC  'DC'                                        00249800
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00249900
&ZOPD(&ZOPN)          SETC  '++ IEECMDS ARG PARMS'                      00250000
.*                                                                      00250100
.ZLMFSLX              ANOP  ,                                           00250200
.*-------------------------------------------------------------------   00250300
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00250400
&ZPLLEN               SETA 52                                           00250500
.*                                                                      00250600
.******************************************************************     00250700
.***AI.L01 IEECMDS FMT=LIST FILL IN PARAMETER AREA                      00250800
.******************************************************************     00250900
                      ACTR  10000                                       00251000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00251100
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00251200
&ZCVAL                SETC  'LAE'          XAX MODE                     00251300
.ZIMFXA               ANOP ,                                            00251400
.*                                                                      00251500
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00251600
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00251700
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00251800
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00251900
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00252000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00252100
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00252200
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00252300
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00252400
&ZOPN                 SETA  &ZOPN+1                                     00252500
&ZOPL(&ZOPN)          SETC  ' '                                         00252600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00252700
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00252800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00252900
                      AGO   .ZIMFNX                                     00253000
.*                                                                      00253100
.ZIMFN2               ANOP ,                                            00253200
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00253300
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00253400
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00253500
&ZOPN                 SETA  &ZOPN+1                                     00253600
&ZOPL(&ZOPN)          SETC  ' '                                         00253700
&ZOPO(&ZOPN)          SETC  'LAE'                                       00253800
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00253900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00254000
                      AGO   .ZIMFNX                                     00254100
.ZIMFNX1              ANOP ,                                            00254200
&ZOPN                 SETA  &ZOPN+1                                     00254300
&ZOPL(&ZOPN)          SETC  ' '                                         00254400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00254500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00254600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00254700
.ZIMFNX               ANOP ,                                            00254800
.********************************************************************   00254900
.***AI.L02 IEECMDS FMT=LIST INITIALIZE PARAMETER AREA                   00255000
.********************************************************************   00255100
.***AI.L03 MF=(SLME)                                                    00255200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00255300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00255400
.*                                                                      00255500
&ZOPN                 SETA  &ZOPN+1                                     00255600
&ZOPL(&ZOPN)          SETC  ' '                                         00255700
&ZOPO(&ZOPN)          SETC  'XC'                                        00255800
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00255900
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00256000
.ZIMFLX               ANOP  ,                                           00256100
.*-------------------------------------------------------------------   00256200
.***AI.L60 XCSPLACRN CL4                                                00256300
&ZOPN                 SETA  &ZOPN+1                                     00256400
&ZOPL(&ZOPN)          SETC  ' '                                         00256500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00256600
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''CSPL'''                       00256700
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           00256800
.*-------------------------------------------------------------------   00256900
.***AI.L04 XPLISTLEN XL2                                                00257000
&ZOPN                 SETA  &ZOPN+1                                     00257100
&ZOPL(&ZOPN)          SETC  ' '                                         00257200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00257300
&ZOPV(&ZOPN)          SETC  '4(2,1),=AL2(&ZPLLEN)'                      00257400
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00257500
.*-------------------------------------------------------------------   00257600
.***AI.L04B XVERSION XL1                                                00257700
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00257800
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVY            00257900
.ZIMFVX               ANOP  ,                                           00258000
                      AIF   ('&PLISTVER' EQ '').ZIMFVZ                  00258100
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVZ            00258200
.ZIMFVY               ANOP  ,                                           00258300
&ZOPN                 SETA  &ZOPN+1                                     00258400
&ZOPL(&ZOPN)          SETC  ' '                                         00258500
&ZOPO(&ZOPN)          SETC  'MVI'                                       00258600
&ZOPV(&ZOPN)          SETC  '6(1),&XPLISTVER'                           00258700
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00258800
.ZIMFVZ               ANOP  ,                                           00258900
.*-------------------------------------------------------------------   00259000
.***AI.L07 XREQUEST AL1                                                 00259100
&ZW                   SETC  ''                                          00259200
.*-------------------------------------------------------------------   00259300
.***AI.L15 XREQUEST "COUNT" AL1                                         00259400
         AIF   ('&XREQUEST' NE 'COUNT').ZI5A                            00259500
&ZW                   SETC  '1'                                         00259600
.ZI5A                 ANOP  ,                                           00259700
.*-------------------------------------------------------------------   00259800
.***AI.L15 XREQUEST "INFO" AL1                                          00259900
         AIF   ('&XREQUEST' NE 'INFO').ZI6A                             00260000
&ZW                   SETC  '2'                                         00260100
.ZI6A                 ANOP  ,                                           00260200
.*-------------------------------------------------------------------   00260300
.***AI.L15 XREQUEST "REMOVE" AL1                                        00260400
         AIF   ('&XREQUEST' NE 'REMOVE').ZI7A                           00260500
&ZW                   SETC  '3'                                         00260600
.ZI7A                 ANOP  ,                                           00260700
.*-------------------------------------------------------------------   00260800
.***AI.L17 XREQUEST AL1                                                 00260900
                      AIF   ('&ZW' NE '0').ZI7C                         00261000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI7B              00261100
.ZI7C                 ANOP  ,                                           00261200
                      AIF   ('&ZW' EQ '').ZI7B                          00261300
.*                                                                      00261400
&ZOPN                 SETA  &ZOPN+1                                     00261500
&ZOPL(&ZOPN)          SETC  ' '                                         00261600
&ZOPO(&ZOPN)          SETC  'MVI'                                       00261700
&ZOPV(&ZOPN)          SETC  '7(1),&ZW'                                  00261800
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00261900
.ZI7B                 ANOP  ,                                           00262000
.*-------------------------------------------------------------------   00262100
.***AI.L05 XFLAG1 BL1                                                   00262200
&ZW                   SETC  ''                                          00262300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00262400
&ZMS                  SETC  ''                                          00262500
&ZC                   SETC  ''                                          00262600
.*-------------------------------------------------------------------   00262700
.***AI.L08 XFLAG1 "CLASS"                                               00262800
.***      BL1'1XXXXXXX'                                                 00262900
         AIF   ('&CLASS' EQ '').ZI9A                                    00263000
         AIF   ('&CLASS' EQ 'ANY_CLASS').ZI9A                           00263100
&ZW                   SETC  '&ZW.1'                                     00263200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00263300
&ZMS                  SETC  '&ZMS.0'                                    00263400
                      AGO   .ZI9C                                       00263500
.*                                                                      00263600
.ZI9A                 ANOP  ,                                           00263700
&ZW                   SETC  '&ZW.0'                                     00263800
&ZMS                  SETC  '&ZMS.1'                                    00263900
.ZI9C                 ANOP  ,                                           00264000
.*-------------------------------------------------------------------   00264100
.***AI.L08 XFLAG1 "CMD"                                                 00264200
.***      BL1'X1XXXXXX'                                                 00264300
         AIF   ('&CMD' EQ '').ZI10A                                     00264400
         AIF   ('&CMD' EQ 'ANY_CMD').ZI10A                              00264500
&ZW                   SETC  '&ZW.1'                                     00264600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00264700
&ZMS                  SETC  '&ZMS.0'                                    00264800
                      AGO   .ZI10C                                      00264900
.*                                                                      00265000
.ZI10A                ANOP  ,                                           00265100
&ZW                   SETC  '&ZW.0'                                     00265200
&ZMS                  SETC  '&ZMS.1'                                    00265300
.ZI10C                ANOP  ,                                           00265400
.*-------------------------------------------------------------------   00265500
.***AI.L08 XFLAG1 "ID"                                                  00265600
.***      BL1'XX1XXXXX'                                                 00265700
         AIF   ('&ID' EQ '').ZI11A                                      00265800
         AIF   ('&ID' EQ 'ANY_ID').ZI11A                                00265900
&ZW                   SETC  '&ZW.1'                                     00266000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00266100
&ZMS                  SETC  '&ZMS.0'                                    00266200
                      AGO   .ZI11C                                      00266300
.*                                                                      00266400
.ZI11A                ANOP  ,                                           00266500
&ZW                   SETC  '&ZW.0'                                     00266600
&ZMS                  SETC  '&ZMS.1'                                    00266700
.ZI11C                ANOP  ,                                           00266800
.*-------------------------------------------------------------------   00266900
.***AI.L08 XFLAG1 "JOB"                                                 00267000
.***      BL1'XXX1XXXX'                                                 00267100
         AIF   ('&JOB' EQ '').ZI12A                                     00267200
         AIF   ('&JOB' EQ 'ANY_JOB').ZI12A                              00267300
&ZW                   SETC  '&ZW.10000'                                 00267400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00267500
&ZMS                  SETC  '&ZMS.01111'                                00267600
                      AGO   .ZI12C                                      00267700
.*                                                                      00267800
.ZI12A                ANOP  ,                                           00267900
&ZW                   SETC  '&ZW.00000'                                 00268000
&ZMS                  SETC  '&ZMS.11111'                                00268100
.ZI12C                ANOP  ,                                           00268200
.*-------------------------------------------------------------------   00268300
.***AI.L11 XFLAG1 BL1                                                   00268400
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI12D              00268500
                      AIF   ('&ZC' NE 'YES').ZI12D                      00268600
&ZOPN                 SETA  &ZOPN+1                                     00268700
&ZOPL(&ZOPN)          SETC  ' '                                         00268800
&ZOPO(&ZOPN)          SETC  'NI'                                        00268900
&ZOPV(&ZOPN)          SETC  '8(1),B''&ZMS'''                            00269000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00269100
.ZI12D                ANOP  ,                                           00269200
                      AIF   ('&ZCLNG' NE 'YES').ZI12E  ALL ZERO BITS    00269300
&ZOPN                 SETA  &ZOPN+1                                     00269400
&ZOPL(&ZOPN)          SETC  ' '                                         00269500
&ZOPO(&ZOPN)          SETC  'OI'                                        00269600
&ZOPV(&ZOPN)          SETC  '8(1),B''&ZW'''                             00269700
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00269800
.ZI12E                ANOP  ,                                           00269900
.*-------------------------------------------------------------------   00270000
.***AI.L18  XCLASS CL4                                                  00270100
         AIF   ('&XCLASS' NE 'ANY_CLASS').ZI14                          00270200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI14  CK *        00270300
&ZXCLASS              SETC  ''             RESET INPUT/OUTPUT           00270400
.ZI14                 ANOP  ,                                           00270500
.*-------------------------------------------------------------------   00270600
.***AI.L25  XCLASS CL4                                                  00270700
                      AIF   ('&ZXCLASS' EQ '').ZI14E                    00270800
                      AIF   ('&ZXCLASS' EQ 'OUTPUT').ZI14E              00270900
&ZCGPR                SETC  '&XCLASS'                                   00271000
         AIF   ('&XCLASS' NE 'ANY_CLASS').ZI14A                         00271100
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI14E                          00271200
.*                                                                      00271300
&ZCGPR                SETC  '=XL4''00'''                                00271400
.ZI14A                ANOP  ,                                           00271500
.*                                                                      00271600
                      AIF   ('&XCLASS'(1,1) NE '(').ZI14B               00271700
&ZCGPR   SETC  '0('.'&XCLASS'(2,K'&XCLASS-2).')'                        00271800
.ZI14B                ANOP  ,                                           00271900
.*                                                                      00272000
&ZOPN                 SETA  &ZOPN+1                                     00272100
&ZOPL(&ZOPN)          SETC  ' '                                         00272200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00272300
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00272400
&ZOPD(&ZOPN)          SETC  '++ &ZXCLASS XCLASS'                        00272500
.*                                                                      00272600
.ZI14E                ANOP  ,                                           00272700
.*-------------------------------------------------------------------   00272800
.***AI.L18  XCMD CL8                                                    00272900
         AIF   ('&XCMD' NE 'ANY_CMD').ZI15                              00273000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI15  CK *        00273100
&ZXCMD                SETC  ''             RESET INPUT/OUTPUT           00273200
.ZI15                 ANOP  ,                                           00273300
.*-------------------------------------------------------------------   00273400
.***AI.L25  XCMD CL8                                                    00273500
                      AIF   ('&ZXCMD' EQ '').ZI15E                      00273600
                      AIF   ('&ZXCMD' EQ 'OUTPUT').ZI15E                00273700
&ZCGPR                SETC  '&XCMD'                                     00273800
         AIF   ('&XCMD' NE 'ANY_CMD').ZI15A                             00273900
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI15E                          00274000
.*                                                                      00274100
&ZCGPR                SETC  '=XL8''00'''                                00274200
.ZI15A                ANOP  ,                                           00274300
.*                                                                      00274400
                      AIF   ('&XCMD'(1,1) NE '(').ZI15B                 00274500
&ZCGPR   SETC  '0('.'&XCMD'(2,K'&XCMD-2).')'                            00274600
.ZI15B                ANOP  ,                                           00274700
.*                                                                      00274800
&ZOPN                 SETA  &ZOPN+1                                     00274900
&ZOPL(&ZOPN)          SETC  ' '                                         00275000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00275100
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00275200
&ZOPD(&ZOPN)          SETC  '++ &ZXCMD XCMD'                            00275300
.*                                                                      00275400
.ZI15E                ANOP  ,                                           00275500
.*-------------------------------------------------------------------   00275600
.***AI.L18  XID CL4                                                     00275700
         AIF   ('&XID' NE 'ANY_ID').ZI16                                00275800
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI16  CK *        00275900
&ZXID                 SETC  ''             RESET INPUT/OUTPUT           00276000
.ZI16                 ANOP  ,                                           00276100
.*-------------------------------------------------------------------   00276200
.***AI.L25  XID CL4                                                     00276300
                      AIF   ('&ZXID' EQ '').ZI16E                       00276400
                      AIF   ('&ZXID' EQ 'OUTPUT').ZI16E                 00276500
&ZCGPR                SETC  '&XID'                                      00276600
         AIF   ('&XID' NE 'ANY_ID').ZI16A                               00276700
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI16E                          00276800
.*                                                                      00276900
&ZCGPR                SETC  '=XL4''00'''                                00277000
.ZI16A                ANOP  ,                                           00277100
.*                                                                      00277200
                      AIF   ('&XID'(1,1) NE '(').ZI16B                  00277300
&ZCGPR   SETC  '0('.'&XID'(2,K'&XID-2).')'                              00277400
.ZI16B                ANOP  ,                                           00277500
.*                                                                      00277600
&ZOPN                 SETA  &ZOPN+1                                     00277700
&ZOPL(&ZOPN)          SETC  ' '                                         00277800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00277900
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00278000
&ZOPD(&ZOPN)          SETC  '++ &ZXID XID'                              00278100
.*                                                                      00278200
.ZI16E                ANOP  ,                                           00278300
.*-------------------------------------------------------------------   00278400
.***AI.L18  XJOB CL8                                                    00278500
         AIF   ('&XJOB' NE 'ANY_JOB').ZI17                              00278600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI17  CK *        00278700
&ZXJOB                SETC  ''             RESET INPUT/OUTPUT           00278800
.ZI17                 ANOP  ,                                           00278900
.*-------------------------------------------------------------------   00279000
.***AI.L25  XJOB CL8                                                    00279100
                      AIF   ('&ZXJOB' EQ '').ZI17E                      00279200
                      AIF   ('&ZXJOB' EQ 'OUTPUT').ZI17E                00279300
&ZCGPR                SETC  '&XJOB'                                     00279400
         AIF   ('&XJOB' NE 'ANY_JOB').ZI17A                             00279500
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI17E                          00279600
.*                                                                      00279700
&ZCGPR                SETC  '=XL8''00'''                                00279800
.ZI17A                ANOP  ,                                           00279900
.*                                                                      00280000
                      AIF   ('&XJOB'(1,1) NE '(').ZI17B                 00280100
&ZCGPR   SETC  '0('.'&XJOB'(2,K'&XJOB-2).')'                            00280200
.ZI17B                ANOP  ,                                           00280300
.*                                                                      00280400
&ZOPN                 SETA  &ZOPN+1                                     00280500
&ZOPL(&ZOPN)          SETC  ' '                                         00280600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00280700
&ZOPV(&ZOPN)          SETC  '28(8,1),&ZCGPR'                            00280800
&ZOPD(&ZOPN)          SETC  '++ &ZXJOB XJOB'                            00280900
.*                                                                      00281000
.ZI17E                ANOP  ,                                           00281100
.*-------------------------------------------------------------------   00281200
.***AI.L19 ADDR XBUFFER A                                               00281300
                      AIF   ('&ZXBUFFER' EQ '').ZI18H                   00281400
&ZCLNG                SETC  '&XBUFFER'                                  00281500
&ZCGPR                SETC  '14'                                        00281600
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI18F  IN GPR                   00281700
.*                                                                      00281800
&ZOPN                 SETA  &ZOPN+1                                     00281900
&ZOPL(&ZOPN)          SETC  ' '                                         00282000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00282100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00282200
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00282300
.*                                                                      00282400
                      AGO   .ZI18G                                      00282500
.*                                                                      00282600
.ZI18F                ANOP  ,                                           00282700
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00282800
.*                                                                      00282900
.ZI18G                ANOP  ,                                           00283000
.*                                                                      00283100
&ZOPN                 SETA  &ZOPN+1                                     00283200
&ZOPL(&ZOPN)          SETC  ' '                                         00283300
&ZOPO(&ZOPN)          SETC  'ST'                                        00283400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,36(,1)'                             00283500
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00283600
.*                                                                      00283700
.ZI18H                ANOP  ,                                           00283800
.*-------------------------------------------------------------------   00283900
.***AI.L23 ALET XBUFFER F                                               00284000
         AIF   ('&ZXBUFFER' EQ '').ZI19G                                00284100
         AIF   ('&SYSASCE' EQ 'P').ZI19G   SYSSTATE PRIMARY             00284200
&ZCLNG                SETC  '&XBUFFER'                                  00284300
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI19E  IN AR                    00284400
.*                                                                      00284500
&ZCGPR                SETC  '14'                                        00284600
                      AGO   .ZI19F                                      00284700
.*                                                                      00284800
.ZI19E                ANOP  ,                                           00284900
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00285000
.*                                                                      00285100
.ZI19F                ANOP  ,                                           00285200
.*                                                                      00285300
&ZOPN                 SETA  &ZOPN+1                                     00285400
&ZOPL(&ZOPN)          SETC  ' '                                         00285500
&ZOPO(&ZOPN)          SETC  'STAM'                                      00285600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,40(1)'                       00285700
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00285800
.*                                                                      00285900
.ZI19G                ANOP  ,                                           00286000
.*-------------------------------------------------------------------   00286100
.***AI.L25  XBUFSIZE F                                                  00286200
                      AIF   ('&ZXBUFSIZE' EQ '').ZI20E                  00286300
                      AIF   ('&ZXBUFSIZE' EQ 'OUTPUT').ZI20E            00286400
&ZCGPR                SETC  '&XBUFSIZE'                                 00286500
.*                                                                      00286600
                      AIF   ('&XBUFSIZE'(1,1) NE '(').ZI20B             00286700
&ZCGPR   SETC  '0('.'&XBUFSIZE'(2,K'&XBUFSIZE-2).')'                    00286800
                      AGO   .ZI20D                                      00286900
.ZI20B                ANOP  ,                                           00287000
.*                                                                      00287100
&ZC                   SETC  '&XBUFSIZE'(1,1)                            00287200
                      AIF   (T'&ZC NE 'N').ZI20D                        00287300
&ZC                   SETC  '&XBUFSIZE'                                 00287400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI20D               00287500
&ZCGPR                SETC  '=FL4''&XBUFSIZE'''                         00287600
.*                                                                      00287700
.ZI20D                ANOP  ,                                           00287800
.*                                                                      00287900
&ZOPN                 SETA  &ZOPN+1                                     00288000
&ZOPL(&ZOPN)          SETC  ' '                                         00288100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00288200
&ZOPV(&ZOPN)          SETC  '44(4,1),&ZCGPR'                            00288300
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFSIZE XBUFSIZE'                    00288400
.*                                                                      00288500
.ZI20E                ANOP  ,                                           00288600
.*-------------------------------------------------------------------   00288700
.***AI.L19 ADDR XCOUNT A                                                00288800
                      AIF   ('&ZXCOUNT' EQ '').ZI21H                    00288900
&ZCLNG                SETC  '&XCOUNT'                                   00289000
&ZCGPR                SETC  '14'                                        00289100
         AIF   ('&XCOUNT'(1,1) EQ '(').ZI21F  IN GPR                    00289200
.*                                                                      00289300
&ZOPN                 SETA  &ZOPN+1                                     00289400
&ZOPL(&ZOPN)          SETC  ' '                                         00289500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00289600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00289700
&ZOPD(&ZOPN)          SETC  '++ &ZXCOUNT XCOUNT'                        00289800
.*                                                                      00289900
                      AGO   .ZI21G                                      00290000
.*                                                                      00290100
.ZI21F                ANOP  ,                                           00290200
&ZCGPR   SETC  '&XCOUNT'(2,K'&XCOUNT-2)                                 00290300
.*                                                                      00290400
.ZI21G                ANOP  ,                                           00290500
.*                                                                      00290600
&ZOPN                 SETA  &ZOPN+1                                     00290700
&ZOPL(&ZOPN)          SETC  ' '                                         00290800
&ZOPO(&ZOPN)          SETC  'ST'                                        00290900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,48(,1)'                             00291000
&ZOPD(&ZOPN)          SETC  '++ &ZXCOUNT XCOUNT'                        00291100
.*                                                                      00291200
.ZI21H                ANOP  ,                                           00291300
.*-------------------------------------------------------------------   00291400
&ZOPN1                SETA &ZOPN                                        00291500
.*-------------------------------------------------------------------   00291600
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00291700
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00291800
.*******************************************************************    00291900
.***  PROCESS IEECMDS OUTPUT PARAMETERS                                 00292000
.*******************************************************************    00292100
                      ACTR  10000                                       00292200
.*******************************************************************    00292300
.***AO.X02  RETURN CODE PROCESSING                                      00292400
.*******************************************************************    00292500
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00292600
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00292700
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00292800
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00292900
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00293000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00293100
&ZOPN                 SETA  &ZOPN+1                                     00293200
&ZOPL(&ZOPN)          SETC  ' '                                         00293300
&ZOPO(&ZOPN)          SETC  'ST'                                        00293400
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00293500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00293600
                      AGO   .ZMRETX                                     00293700
.*                                                                      00293800
.ZMRET2               ANOP  ,                                           00293900
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00294000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00294100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00294200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00294300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00294400
&ZOPN                 SETA  &ZOPN+1                                     00294500
&ZOPL(&ZOPN)          SETC  ' '                                         00294600
&ZOPO(&ZOPN)          SETC  'LR'                                        00294700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00294800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00294900
.ZMRETX               ANOP  ,                                           00295000
.*******************************************************************    00295100
.***AO.X03  REASON CODE PROCESSING                                      00295200
.*******************************************************************    00295300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00295400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00295500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00295600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00295700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00295800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00295900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00296000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00296100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00296200
&ZOPN                 SETA  &ZOPN+1                                     00296300
&ZOPL(&ZOPN)          SETC  ' '                                         00296400
&ZOPO(&ZOPN)          SETC  'ST'                                        00296500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00296600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00296700
                      AGO   .ZMRSNX                                     00296800
.*                                                                      00296900
.ZMRSN2               ANOP  ,                                           00297000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00297100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00297200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00297300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00297400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00297500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00297600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00297700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00297800
&ZOPN                 SETA  &ZOPN+1                                     00297900
&ZOPL(&ZOPN)          SETC  ' '                                         00298000
&ZOPO(&ZOPN)          SETC  'LR'                                        00298100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00298200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00298300
.ZMRSNX               ANOP  ,                                           00298400
.*******************************************************************    00298500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00298600
.*******************************************************************    00298700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00298800
.*******************************************************************    00298900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00299000
.*******************************************************************    00299100
                      ACTR  10000                                       00299200
.*                                                                      00299300
                      LCLA  &ZLC           COLUMN POSITION              00299400
                      LCLA  &ZOPX          LIST TABLE INDEX             00299500
                      LCLC  &ZLL           LABEL                        00299600
                      LCLC  &ZLOP          OPERATION                    00299700
                      LCLC  &ZLV           VALUE                        00299800
                      LCLC  &ZLD           DESCRIPTION                  00299900
.*                                                                      00300000
&ZOPX                 SETA  1                                           00300100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00300200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00300300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00300400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00300500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00300600
                      AIF   (K'&ZLD LE 0).ZL5                           00300700
&ZLC                  SETA  35             COMMENT COLUMN               00300800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00300900
&ZLC                  SETA  33             COMMMENT COLUMN              00301000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00301100
&ZLV                  SETC  '&ZLV'.' '                                  00301200
                      AGO   .ZL3                                        00301300
.*                                                                      00301400
.ZL4                  ANOP  ,                                           00301500
&ZLV                  SETC  '&ZLV'.' '                                  00301600
.ZL5                  ANOP  ,                                           00301700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00301800
.*                                                                      00301900
&ZLL     &ZLOP &ZLV                                                     00302000
.*                                                                      00302100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00302200
                      AGO   .ZL2           CONTINUE LOOPING             00302300
.*                                                                      00302400
.ZLX                  ANOP  ,                                           00302500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00302600
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00302700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00302800
.*-----------BAL invocation code-------------                           00302900
.********************************************************************** 00303000
.*                                                                    * 00303100
.*  Invoke PC for IEECMDS Interface Routine                           * 00303200
.*                                                                    * 00303300
.********************************************************************** 00303400
         L     15,16(0,0)         GET ADDRESS OF CVT FROM PSA           00303500
         L     15,772(,15)        GET ADDRESS OF SFT FROM CVT           00303600
         LA    14,21(0,0)         GET IEECMDS INDEX IN LINKAGE TABLE    00303700
         AL    14,100(,15)        POINT REG14 TO IEECMDS ETD ENTRY      00303800
         PC    0(14)              PC TO IEECMDS SERVICE                 00303900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00304000
.ZLINKX               ANOP  ,                                           00304100
.*******************************************************************    00304200
.***AP.X01  FORMAT GENERATED CODE                                       00304300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00304400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00304500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00304600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00304700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00304800
                      AIF   (K'&ZLD LE 0).ZL51                          00304900
&ZLC                  SETA  35             COMMENT COLUMN               00305000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00305100
&ZLC                  SETA  33             COMMENT COLUMN               00305200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00305300
&ZLV                  SETC  '&ZLV'.' '                                  00305400
                      AGO   .ZL31                                       00305500
.*                                                                      00305600
.ZL41                 ANOP  ,                                           00305700
&ZLV                  SETC  '&ZLV'.' '                                  00305800
.ZL51                 ANOP  ,                                           00305900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00306000
.*                                                                      00306100
&ZLL     &ZLOP &ZLV                                                     00306200
.*                                                                      00306300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00306400
                      AGO   .ZL21          CONTINUE LOOPING             00306500
.*                                                                      00306600
.ZLX1                 ANOP  ,                                           00306700
.*******************************************************************    00306800
.***AP.X02  END OF IEECMDS MACRO                                        00306900
&ZIEECMDS             SETC  'YES'          SET IEECMDS USED             00307000
         POP   PRINT                                                    00307100
*                                            IEECMDS-1                  00307200
         SPACE 1                                                        00307300
.ZLX2                 ANOP  ,                                           00307400
         MEND                                                           00307500
**********************************************************************/ 00307600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00307700
*%IEECMDS: MACRO KEYS(REQUEST,BUFFER,BUFSIZE,CLASS,CMD,ID,JOB,COUNT,    00307800
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00307900
*  ANS('?'||MACLABEL||' '||'IEECMDSP '||MACLIST||                       00308000
*         ' '||MACKEYS||';') COL(MACLMAR);                              00308100
*%END IEECMDS;                                                          00308200
