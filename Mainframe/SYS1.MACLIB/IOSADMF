*/**** START OF SPECIFICATIONS **************************************** 00012200
*                                                                     * 00024400
*                                                                     * 00036600
*01* MACRO NAME:  IOSADMF                               -92/02/17-<1> * 00048800
*                                                                     * 00061000
*                                                                     * 00073200
*01* DESCRIPTIVE NAME:  IOS asynchronous Data Mover Facility service  * 00085400
*                                                                     * 00097600
*01* PROPRIETARY STATEMENT:                                           * 00109800
*                                                                     * 00122000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00134200
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00146400
*     5695-047 (C) COPYRIGHT IBM CORP. 1992                           * 00158600
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00170800
*                                                                     * 00183000
* STATUS= HBB4430                                                     * 00195200
*                                                                     * 00207400
*                                                                     * 00219600
*                                                                     * 00231800
*01* FUNCTION:                                                        * 00244000
*                                                                     * 00256200
*      IOSADMF provides a macro interface for the movement of large   * 00268400
*      amounts of data between between main and expanded storage.     * 00280600
*      Programs using the IOSADMF services must ensure that all       * 00292800
*      address space storage areas which will be the source or        * 00302500
*      destination of the AREAD or AWRITE operation are fixed         * 00312200
*      otherwise the IOSADMF operation will fail with a failing       * 00321900
*      return code.                                                   * 00331600
*                                                                     * 00341600
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00353800
*                                                                     * 00366000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00378200
*                                                                     * 00390400
*01* ENVIRONMENT:                                                     * 00402600
*                                                                     * 00414800
*                                                                     * 00427000
*      Dispatchable unit mode: Task or SRB mode.                      * 00439200
*                                                                     * 00451400
*                        Task or SRB for AREAD, AWRITE, AQUERY.  Task * 00463600
*                        mode, non-cross memory mode, and in a state  * 00475800
*                        which allows SVCs to be issued (Task         * 00488000
*                        mode/Enabled/no EUT FRR) for APURGE.         * 00500200
*                                                                     * 00512400
*      Minimum authorization: Supervisor State or program key mask    * 00524600
*                        (PKM) allowing keys 0-7.                     * 00536800
*                                                                     * 00549000
*      AMODE:            31-bit.                                      * 00561200
*                                                                     * 00573400
*      ASC mode:         Primary.  Primary ASC mode and not           * 00585600
*                        cross-memory (ie, PASN=SASN= HASN).          * 00597800
*                                                                     * 00610000
*      Serialization:    Enabled.  Unlocked.                          * 00622200
*                                                                     * 00634400
*      Restrictions:     Callers parameter list and range list        * 00646600
*                        entries must be in primary address space.    * 00658800
*                                                                     * 00671000
*                        When APURGE is specified, Caller must be     * 00683200
*                        enabled, must not hold any locks, be in task * 00695400
*                        mode, must NOT be in cross memory mode, and  * 00707600
*                        NOT have an EUT FRR.  IOSADMF APURGE         * 00719800
*                        services must be able to issue SVCs.         * 00732000
*                                                                     * 00744200
*                                                                     * 00756400
*                                                                     * 00768600
*01* INPUT REGISTERS:  GR0-GR15    Undefined                          * 00780800
*                                                                     * 00793000
*01* OUTPUT REGISTERS: GR0-GR1     Used by the macro                  * 00805200
*                      GR2-GR13    Restored                           * 00817400
*                      GR14-GR15   Used by the macro                  * 00829600
*                      AR0-AR1     Used by the macro                  * 00841800
*                      AR2-AR13    Restored                           * 00854000
*                      AR14-AR15   Used by the macro                  * 00866200
*                                                                     * 00878400
*01* SYNTAX:                                                          * 00890600
*                                                                     * 00902800
*[xlabel]  IOSADMF    APURGE                                         * 00915000
*                   |     ,ALET=xalet                                 * 00927200
*                    ,AREAD                                          * 00939400
*                   |     ,ALET=xalet                                 * 00951600
*                   |    [,NUMRANGE=xnumrange|1]                    * 00963800
*                   |     ,RANGLIST=xranglist                         * 00976000
*                   |    [,FAILBLKP=xfailblkp]                        * 00988200
*                    ,AWRITE                                         * 01000400
*                   |     ,ALET=xalet                                 * 01012600
*                   |    [,NUMRANGE=xnumrange|1]                    * 01024800
*                   |     ,RANGLIST=xranglist                         * 01037000
*                   |    [,FAILBLKP=xfailblkp]                        * 01049200
*                    ,AQUERY                                         * 01061400
*                        [,CROSSOVER=xcrossover]                      * 01073600
*                    [,RETCODE=xretcode]                              * 01085800
*                    [,RSNCODE=xrsncode]                              * 01098000
*                   [,MF=S]                                          * 01110200
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 01122400
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 01134600
*                                                                     * 01146800
*                                                                     * 01159000
*      Where:                                                         * 01171200
*                                                                     * 01183400
*                                                                     * 01195600
*      [xlabel]                                                       * 01207800
*          is an optional symbol, starting in column 1, that is the   * 01220000
*          name on the IOSADMF macro invocation.  The name must       * 01232200
*          conform to the rules for an ordinary assembler language    * 01244400
*          symbol.                                                    * 01256600
*          DEFAULT: No name.                                          * 01268800
*                                                                     * 01281000
*                                                                     * 01293200
*                                                                     * 01305400
*                                                                     * 01317600
*      The following is a set of mutually exclusive keys.  This set   * 01329800
*      is required; only one key must be specified.                   * 01342000
*                                                                     * 01354200
*                                                                     * 01366400
*      APURGE                                                         * 01378600
*          ADM service is to PURGE any active AREAD or AWRITE         * 01390800
*          operation.                                                 * 01403000
*                                                                     * 01415200
*          NOTE:  RESTRICTION - Caller must be Enabled, must not hold * 01427400
*          any locks, be in task mode, and must not have an EUT FRR   * 01439600
*          when issuing the APURGE option.  IOSADMF APURGE service    * 01451800
*          routines must be able to issue SVCs.                       * 01464000
*                                                                     * 01476200
*                                                                     * 01488400
*          ALET=xalet                                                 * 01500600
*              is the name (RS-type), or address in register          * 01512800
*              (2)-(12), of a required fullword input ALET associated * 01525000
*              with the hiperspace to perform PURGE operation.        * 01537200
*                                                                     * 01549400
*                                                                     * 01561600
*                                                                     * 01573800
*      AREAD                                                          * 01586000
*          ADM service is to perform a read operation.                * 01598200
*                                                                     * 01610400
*                                                                     * 01622600
*          ALET=xalet                                                 * 01634800
*              is the name (RS-type), or address in register          * 01647000
*              (2)-(12), of a required fullword input ALET to be used * 01659200
*              when accessing the callers hiperspace.                 * 01671400
*                                                                     * 01683600
*                                                                     * 01695800
*                                                                     * 01708000
*                                                                     * 01720200
*          [NUMRANGE=xnumrange|1]                                   * 01732400
*              is the name (RS-type), or address in register          * 01744600
*              (2)-(12), of an optional fullword input that specifies * 01756800
*              the number of entries in the supplied range list.  The * 01769000
*              range list is used to specify one or more address      * 01781200
*              space virtual storage ranges which are to be moved.    * 01793400
*              The value specified must be a positive integer between * 01805600
*              1 and 125.                                             * 01817800
*                                                                     * 01830000
*              DEFAULT: 1.                                            * 01842200
*              If NUMRANGE is omitted, then only one range will be    * 01854400
*              moved.                                                 * 01866600
*                                                                     * 01878800
*                                                                     * 01891000
*                                                                     * 01903200
*                                                                     * 01915400
*          RANGLIST=xranglist                                         * 01927600
*              is the name (RS-type), or address in register          * 01939800
*              (2)-(12), of a required 4 byte input that contains the * 01952000
*              address of a range list.  The range list consists of a * 01964200
*              number of entries (as specified by NUMRANGE) where     * 01976400
*              each entry specifies the address of the source to be   * 01988600
*              moved, the destination address, and the number of      * 02000800
*              blocks (4K bytes) to be moved.  All address space      * 02013000
*              storage areas which are specified in the range list    * 02025200
*              entries must be fixed before invoking the ADM service  * 02037400
*              and must remain fixed until the ADM operation is       * 02049600
*              complete.                                              * 02061800
*                                                                     * 02074000
*              More specifically, each entry consists of three words  * 02086200
*              as follows:                                            * 02098400
*                                                                     * 02110600
*                                                                     * 02122800
*                                                                     * 02135000
*                            FIRST WORD    contains the starting      * 02147200
*                                          virtual address in the     * 02159400
*                                          address space into which   * 02171600
*                                          the data is to be read.    * 02183800
*                                          The specified address must * 02196000
*                                          be on a 4k boundary.       * 02208200
*                                          Unless the caller is       * 02220400
*                                          executing with a zero PSW  * 02232600
*                                          key, the access key of the * 02244800
*                                          address space storage must * 02257000
*                                          be the same as the         * 02269200
*                                          caller's PSW key.          * 02281400
*                                                                     * 02293600
*                                          The specified virtual      * 02305800
*                                          storage must be from a     * 02318000
*                                          non-DREF subpool.          * 02330200
*                                                                     * 02342400
*                            SECOND WORD   contains the starting      * 02354600
*                                          virtual address in the     * 02366800
*                                          hiperspace from which the  * 02379000
*                                          AREAD is to be initiated.  * 02391200
*                                          The specified virtual      * 02403400
*                                          address must be on a 4K    * 02415600
*                                          boundary.                  * 02427800
*                                                                     * 02440000
*                            THIRD WORD    contains the number of     * 02452200
*                                          blocks (4K bytes) to be    * 02464400
*                                          read from the hiperspace.  * 02476600
*                                          The maximum number of      * 02488800
*                                          blocks that may be         * 02501000
*                                          specified in this field is * 02513200
*                                          65535.                     * 02525400
*                                                                     * 02537600
*                                          NOTE:  Direction of data   * 02549800
*                                          movement is: Address of    * 02562000
*                                          WORD 2 to Address of WORD  * 02574200
*                                          1.                         * 02586400
*                                                                     * 02598600
*                                                                     * 02610800
*                                                                     * 02623000
*                            The range list must be addressable in    * 02635200
*                            the caller's primary address space.      * 02647400
*                                                                     * 02659600
*                                                                     * 02671800
*                                                                     * 02684000
*                                                                     * 02696200
*              [FAILBLKP=xfailblkp]                                   * 02708400
*                  is the name (RS-type), or address in register      * 02720600
*                  (2)-(12), of an optional 4 byte output that will   * 02732800
*                  contain the address of the RANGLIST entry for      * 02745000
*                  which a failure occurred.                          * 02757200
*                                                                     * 02769400
*                  When a failing return code is specified and this   * 02781600
*                  field contains a value other than ZERO, all        * 02793800
*                  previous list entries have been successfully       * 02806000
*                  processed.  All request blocks from FAILBLKP       * 02818200
*                  forward, were not successfully processed.          * 02830400
*                                                                     * 02842600
*                  NOTE:  This field will be non-zero only when the   * 02854800
*                  failing range list entry is known.  Please see     * 02867000
*                  reason codes to determine when FAILBLKP will be    * 02879200
*                  set.                                               * 02891400
*                                                                     * 02903600
*                                                                     * 02915800
*                                                                     * 02928000
*          AWRITE                                                     * 02940200
*              ADM service is to perform a write operation.           * 02952400
*                                                                     * 02964600
*                                                                     * 02976800
*              ALET=xalet                                             * 02989000
*                  is the name (RS-type), or address in register      * 03001200
*                  (2)-(12), of a required fullword input ALET to be  * 03013400
*                  used when accessing the callers data address       * 03025600
*                  space.  (hiperspace)                               * 03037800
*                                                                     * 03050000
*                                                                     * 03062200
*                                                                     * 03074400
*                                                                     * 03086600
*              [NUMRANGE=xnumrange|1]                               * 03098800
*                  is the name (RS-type), or address in register      * 03111000
*                  (2)-(12), of an optional fullword input that       * 03123200
*                  specifies the number of entries in the supplied    * 03135400
*                  range list.  The range list is used to specify one * 03147600
*                  or more storage ranges which are to be moved.  The * 03159800
*                  value specified must be a positive integer between * 03172000
*                  1 and 125.                                         * 03184200
*                                                                     * 03196400
*                  DEFAULT: 1.                                        * 03208600
*                  If NUMRANGE is omitted, then only one range will   * 03220800
*                  be moved.                                          * 03233000
*                                                                     * 03245200
*                                                                     * 03257400
*                                                                     * 03269600
*                                                                     * 03281800
*              RANGLIST=xranglist                                     * 03294000
*                  is the name (RS-type), or address in register      * 03306200
*                  (2)-(12), of a required 4 byte input that contains * 03318400
*                  the address of a range list.  The range list       * 03330600
*                  consists of a number of entries (as specified by   * 03342800
*                  NUMRANGE) where each entry specifies the address   * 03355000
*                  of the source to be moved, the destination         * 03367200
*                  address, and the number of blocks (4K bytes) to be * 03379400
*                  moved.  All address space storage areas which are  * 03391600
*                  specified in the range list entries must be fixed  * 03403800
*                  before invoking the ADM service and must remain    * 03416000
*                  fixed until the ADM operation is complete.         * 03428200
*                                                                     * 03440400
*                  More specifically, each entry consists of three    * 03452600
*                  words as follows:                                  * 03464800
*                                                                     * 03477000
*                                                                     * 03489200
*                  FIRST WORD    contains the starting virtual        * 03501400
*                                address in the address space from    * 03513600
*                                which the write is to be initiated.  * 03525800
*                                The specified address must be on a   * 03538000
*                                4K boundary.  If the caller's PSW    * 03550200
*                                key is not zero, then the caller's   * 03562400
*                                PSW key must match the access key of * 03574600
*                                the virtual storage.                 * 03586800
*                                                                     * 03599000
*                                The specified virtual storage must   * 03611200
*                                be from a non-DREF subpool.          * 03623400
*                                                                     * 03635600
*                  SECOND WORD   contains the starting virtual        * 03647800
*                                address in the hiperspace into which * 03660000
*                                the data is to be written.  The      * 03672200
*                                specified address must be on a 4K    * 03684400
*                                boundary.                            * 03696600
*                                                                     * 03708800
*                  THIRD WORD    contains the number of blocks (4K    * 03721000
*                                bytes) to be written to the          * 03733200
*                                hiperspace.  The maximum number of   * 03745400
*                                blocks that may be specified in this * 03757600
*                                field is 65535.                      * 03769800
*                                                                     * 03782000
*                                                                     * 03794200
*                                                                     * 03806400
*                  NOTE:  Direction of data movement is: Address of   * 03818600
*                  WORD 1 to Address of WORD 2.                       * 03830800
*                                                                     * 03843000
*                                                                     * 03855200
*                                                                     * 03867400
*              The range list must be addressable in the caller's     * 03879600
*              primary address space.                                 * 03891800
*                                                                     * 03904000
*                                                                     * 03916200
*                                                                     * 03928400
*                                                                     * 03940600
*          [FAILBLKP=xfailblkp]                                       * 03952800
*              is the name (RS-type), or address in register          * 03965000
*              (2)-(12), of an optional 4 byte output that will       * 03977200
*              contain the address of the RANGLIST entry for which a  * 03989400
*              failure occurred.                                      * 04001600
*                                                                     * 04013800
*              When a failing return code is specified and this field * 04026000
*              contains a value other than ZERO, all previous list    * 04038200
*              entries have been successfully processed.  All request * 04050400
*              blocks from FAILBLKP forward, were not successfully    * 04062600
*              processed.                                             * 04074800
*                                                                     * 04087000
*              NOTE:  This field will be non-zero only when the       * 04099200
*              failing range list entry is known.  Please see reason  * 04111400
*              codes to determine when FAILBLKP will be set.          * 04123600
*                                                                     * 04135800
*                                                                     * 04148000
*                                                                     * 04160200
*      AQUERY                                                         * 04172400
*          Detect whether ADM is installed.  A return code of 0 means * 04184600
*          ADM is installed.  If ADM is not installed, see return     * 04196800
*          code 8 and appropriate reason code.                        * 04209000
*                                                                     * 04221200
*                                                                     * 04233400
*          [CROSSOVER=xcrossover]                                     * 04245600
*              is the name (RS-type), or address in register          * 04257800
*              (2)-(12), of an optional fullword output that will     * 04270000
*              receive the system implemented move page crossover     * 04282200
*              value. If an IOSADMF request to move data, requests    * 04294400
*              less pages then specified by the CROSSOVER value, the  * 04306600
*              data will be moved using the CPU instead of using the  * 04318800
*              asynchronous data mover facility.                      * 04331000
*                                                                     * 04343200
*                                                                     * 04355400
*                                                                     * 04367600
*                                                                     * 04379800
*                                                                     * 04392000
*      End of a set of mutually exclusive required keys.              * 04404200
*                                                                     * 04416400
*                                                                     * 04428600
*                                                                     * 04440800
*      [RETCODE=xretcode]                                             * 04453000
*          is the name (RS-type) of an optional fullword output       * 04465200
*          variable, or register (2)-(12), into which the return code * 04477400
*          is to be copied from GPR 15.                               * 04489600
*                                                                     * 04501800
*                                                                     * 04514000
*                                                                     * 04526200
*                                                                     * 04538400
*      [RSNCODE=xrsncode]                                             * 04550600
*          is the name (RS-type) of an optional fullword output       * 04562800
*          variable, or register (2)-(12), into which the reason code * 04575000
*          is to be copied from GPR 0.                                * 04587200
*                                                                     * 04599400
*                                                                     * 04611600
*                                                                     * 04623800
*                                                                     * 04636000
*      [MF=S|L|E]                                                   * 04648200
*          is an optional keyword input which specifies the macro     * 04660400
*          form.                                                      * 04672600
*          DEFAULT: S                                                 * 04684800
*                                                                     * 04697000
*                                                                     * 04709200
*          [MF=S]                                                     * 04721400
*              specifies the standard form of the macro.  The "S"     * 04733600
*              form generates code to put the parameters into an      * 04745800
*              in-line parameter list and invoke the desired service. * 04758000
*              Full checking for required macro keys is done along    * 04770200
*              with supplying defaults for omitted optional           * 04782400
*              parameters.                                            * 04794600
*                                                                     * 04806800
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 04819000
*              specifies the list form of the macro.  The "L" form    * 04831200
*              defines an area to be used for the parameter list.     * 04843400
*              Any other macro parameters are flagged as errors.      * 04855600
*                                                                     * 04867800
*            ,xmfctrl                                                 * 04880000
*              is a required input.  It is the name of a storage area * 04892200
*              for the parameter list.                                * 04904400
*                                                                     * 04916600
*            ,xmfattr|0D                                            * 04928800
*              is an optional 60 character input string that varies   * 04941000
*              from 1 to 60 characters. It can contain any value that * 04953200
*              is valid on an assembler DS pseudo-op. You can use     * 04965400
*              this parameter to force boundary alignment of the      * 04977600
*              parameter list.                                        * 04989800
*              DEFAULT: 0D which forces the parameter list to a       * 05002000
*              doubleword boundary.                                   * 05014200
*                                                                     * 05026400
*          [MF=(E,xmfctrl,COMPLETE)]                                * 05038600
*              specifies the execute form of the macro.  The "E" form * 05050800
*              generates code to put the parameters into the          * 05063000
*              parameter list specified by xmfctrl and provides full  * 05075200
*              syntax checking with default setting.                  * 05087400
*                                                                     * 05099600
*            ,xmfctrl                                                 * 05111800
*              is a required input.  It is the name (RS-type), or     * 05124000
*              address in register (1)-(12), of a storage area for    * 05136200
*              the parameter list.                                    * 05148400
*                                                                     * 05160600
*            ,COMPLETE                                              * 05172800
*              is an optional keyword input which specifies the       * 05185000
*              degree of macro parameter syntax checking.             * 05197200
*              DEFAULT: COMPLETE                                      * 05209400
*                                                                     * 05221600
*                                                                     * 05233800
*              COMPLETE   Checking for required macro keys is done    * 05246000
*                        and defaults are supplied for omitted        * 05258200
*                        optional parameters.                         * 05270400
*                                                                     * 05282600
*                                                                     * 05294800
*                                                                     * 05307000
*                                                                     * 05319200
*                                                                     * 05331400
*                                                                     * 05343600
*                                                                     * 05355800
*01* RETURN CODES:                                                    * 05368000
*                                                                     * 05380200
*                                                                     * 05392400
*            00   The ADM operation was executed successfully         * 05404600
*                                                                     * 05416800
*            04   The ADM operation was only partially successful.    * 05429000
*                 See reason codes for more detail.                   * 05441200
*                                                                     * 05453400
*                 The structure of reason codes for return code 04    * 05465600
*                 provide a method for the user to determine if the   * 05477800
*                 error occurred in the address space area pointed to * 05490000
*                 by WORD 1 of the failing range list entry or in the * 05502200
*                 hiperspace area pointed to by WORD2 of the failing  * 05514400
*                 range list entry.                                   * 05526600
*                                                                     * 05538800
*                 Description of reason code structure                * 05551000
*                                                                     * 05563200
*                 Byte 0 ->xxxxxxxx<- Byte 3                          * 05575400
*                                                                     * 05587600
*                                                                     * 05599800
*                 o   Byte 0 - do not use.  This byte is used by the  * 05612000
*                     system.                                         * 05624200
*                                                                     * 05636400
*                 o   Byte 1 - reason for failure.                    * 05648600
*                                                                     * 05660800
*                 o   Byte 2 - when byte 2 = 01, the failure occurred * 05673000
*                     in the address space area pointed to by word    * 05685200
*                     one of the failing range list entry.            * 05697400
*                                                                     * 05709600
*                     When byte 2 = 02, the failure occurred in the   * 05721800
*                     hiperspace area pointed to by word two of the   * 05734000
*                     of the failing range list entry.                * 05746200
*                                                                     * 05758400
*                 o   Byte 3 - do not use.  This byte is used by the  * 05770600
*                     system.                                         * 05782800
*                                                                     * 05795000
*                                                                     * 05807200
*                                                                     * 05819400
*            08   The ADM operation failed.  See reason codes.        * 05831600
*                                                                     * 05843800
*            0C   An unrecoverable error occurred.  State of storage  * 05856000
*                 unknown.                                            * 05868200
*                                                                     * 05880400
*                                                                     * 05892600
*                                                                     * 05904800
*01* REASON CODES:                                                    * 05917000
*                                                                     * 05929200
*       REASON    RETURN                                              * 05941400
*       CODE      CODE      DESCRIPTION                               * 05953600
*                                          * 05965800
*                                                                     * 05978000
*                                                                     * 05990200
*       xx0101xx  04        ADM    operation    failed   due   to   a * 06000300
*                           communication  error.    The  request was * 06010400
*                           started  but  abnormally  stopped  by the * 06020500
*                           operating  system due to a detected error * 06030600
*                           condition.                                * 06040700
*                                                                     * 06051200
*                           The  failure occurred in the storage area * 06063400
*                           pointed to by the first word of the input * 06075600
*                           range list entry.  FAILBLKP points to the * 06087800
*                           RANGLIST   entry   for  which  a  failure * 06100000
*                           occurred.                                 * 06112200
*                                                                     * 06124400
*                           SUGGESTED   RECOVERY  ACTION  -  Probable * 06136600
*                           hardware   error.      Either  retry  the * 06146300
*                           operation   using   IOSADMF  or  use  the * 06156000
*                           HSPSERV   service.      Contact  hardware * 06165700
*                           support.                                  * 06175400
*                                                                     * 06185400
*       xx0202xx  04        ADM    operation    failed   due   to   a * 06197600
*                           communication  error.    The  request was * 06209800
*                           started  but  abnormally  stopped  by the * 06222000
*                           operating system.                         * 06234200
*                                                                     * 06246400
*                           The  failure occurred in the storage area * 06258600
*                           pointed  to  by  the  second  word of the * 06270800
*                           input  range list entry.  FAILBLKP points * 06283000
*                           to the RANGLIST entry for which a failure * 06295200
*                           occurred.                                 * 06307400
*                                                                     * 06319600
*                           SUGGESTED   RECOVERY  ACTION  -  Probable * 06331800
*                           hardware   error.      Either  retry  the * 06341500
*                           operation   using   IOSADMF  or  use  the * 06351200
*                           HSPSERV   service.      Contact  hardware * 06360900
*                           support.                                  * 06370600
*                                                                     * 06380600
*       xx0301xx  04        An address space address specified points * 06392800
*                           to a storage area which the caller is not * 06405000
*                           authorized  for.   A protection exception * 06417200
*                           was encountered.                          * 06429400
*                                                                     * 06441600
*                           The  failure occurred in the storage area * 06453800
*                           pointed to by the first word of the input * 06466000
*                           range list entry.  FAILBLKP points to the * 06478200
*                           RANGLIST   entry   for  which  a  failure * 06490400
*                           occurred.                                 * 06502600
*                                                                     * 06514800
*                           SUGGESTED RECOVERY ACTION - Probable user * 06527000
*                           software error.  Specify an address space * 06539200
*                           address  which  the user has authority to * 06551400
*                           access  or  obtain  adequate authority to * 06563600
*                           use the specified address.                * 06575800
*                                                                     * 06588000
*       xx0501xx  04        Error     occurred     during     address * 06600200
*                           translation.     The  request  cannot  be * 06612400
*                           completed  at the current time because an * 06624600
*                           address space page was not valid.  Either * 06636800
*                           the  address space area pointed to in the * 06649000
*                           first  word of the input range list entry * 06661200
*                           was incorrect or not backed.              * 06673400
*                                                                     * 06685600
*                           The  failure occurred in the storage area * 06697800
*                           pointed to by the first word of the input * 06710000
*                           range list entry.  FAILBLKP points to the * 06722200
*                           RANGLIST   entry   for  which  a  failure * 06734400
*                           occurred.                                 * 06746600
*                                                                     * 06758800
*                           SUGGESTED  RECOVERY  ACTION  - Ensure all * 06771000
*                           the  pages  that  are to be used are page * 06783200
*                           fixed.                                    * 06795400
*                                                                     * 06807600
*       xx0502xx  04        Error     occurred     during     address * 06818400
*                           translation.     The  request  cannot  be * 06829200
*                           completed  at  the current time because a * 06840000
*                           hiperspace  page  was not valid.   Either * 06850800
*                           the  hiperspace  area  pointed  to in the * 06861600
*                           second word of the input range list entry * 06872400
*                           was  incorrect  or  was  reclaimed by the * 06883200
*                           system.                                   * 06894000
*                                                                     * 06905200
*                           The  failure occurred in the storage area * 06917400
*                           pointed  to  by  the  second  word of the * 06929600
*                           input  range list entry.  FAILBLKP points * 06941800
*                           to the RANGLIST entry for which a failure * 06954000
*                           occurred.                                 * 06966200
*                                                                     * 06978400
*                           SUGGESTED   RECOVERY  ACTION  -  Use  the * 06990600
*                           HSPSERV service to restore the hiperspace * 07002800
*                           page.                                     * 07015000
*                                                                     * 07027200
*       xx0601xx  04        Uncorrectable  storage  error occurred at * 07039400
*                           either  the  source or destination of the * 07051600
*                           move.                                     * 07063800
*                                                                     * 07076000
*                           The  failure occurred in the storage area * 07088200
*                           pointed to by the first word of the input * 07100400
*                           range list entry.  FAILBLKP points to the * 07112600
*                           RANGLIST   entry   for  which  a  failure * 07124800
*                           occurred.                                 * 07137000
*                                                                     * 07149200
*                           SUGGESTED   RECOVERY  ACTION  -  Probable * 07161400
*                           hardware   error.      Either  retry  the * 07171100
*                           operation   using   IOSADMF  or  use  the * 07180800
*                           HSPSERV   service.      Contact  hardware * 07190500
*                           support.                                  * 07200200
*                                                                     * 07210200
*       xx0702xx  04        Uncorrectable  storage  error occurred at * 07222400
*                           either  the  source or destination of the * 07234600
*                           move.                                     * 07246800
*                                                                     * 07259000
*                           The  failure occurred in the storage area * 07271200
*                           pointed  to  by  the  second  word of the * 07283400
*                           input  range list entry.  FAILBLKP points * 07295600
*                           to the RANGLIST entry for which a failure * 07307800
*                           occurred.                                 * 07320000
*                                                                     * 07332200
*                           SUGGESTED   RECOVERY  ACTION  -  Probable * 07344400
*                           hardware   error.      Either  retry  the * 07356600
*                           operation   using   IOSADMF  or  use  the * 07368800
*                           HSPSERV service.                          * 07381000
*                                                                     * 07393200
*       xx0Cxxxx  04        Uncorrectable  storage  error occurred at * 07405400
*                           either  the  source or destination of the * 07417600
*                           move.                                     * 07429800
*                                                                     * 07442000
*                           The  IO  supervisor  could  not determine * 07454200
*                           whether the error occurred in the address * 07466400
*                           space  storage or the hiperspace storage. * 07478600
*                           FAILBLKP points to the RANGLIST entry for * 07490800
*                           which a failure occurred.                 * 07503000
*                                                                     * 07515200
*       xx31xxxx  08        ADM  feature  not  installed  on  current * 07527400
*                           system.    ADM can not be used until both * 07539600
*                           hardware and software have been installed * 07551800
*                           and MVS is IPLed.                         * 07564000
*                                                                     * 07576200
*                           SUGGESTED   RECOVERY  ACTION  -  Hardware * 07588400
*                           and/or  Software not installed on system. * 07600600
*                           Use HSPSERV in place of IOSADMF.  Contact * 07612800
*                           IBM support.                              * 07625000
*                                                                     * 07637200
*       xx32xxxx  08        ADM   not   available.     IO  supervisor * 07649400
*                           detected an unrecoverable error.          * 07661600
*                                                                     * 07673800
*                           SUGGESTED   RECOVERY  ACTION  -  Probable * 07686000
*                           hardware  error.  Stop using IOSADMF. Use * 07698200
*                           HSPSERV  in  place  of IOSADMF.   Contact * 07710400
*                           hardware support.                         * 07722600
*                                                                     * 07734800
*       xx34xxxx  08        Caller  environment  error.    Caller  is * 07747000
*                           disabled,  not  in  primary  ASC mode, in * 07759200
*                           cross-memory  mode,  locked  or in 24-bit * 07771400
*                           addressing mode.                          * 07783600
*                                                                     * 07795800
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 07808000
*                           error.    Ensure  IOSADMF macro issued in * 07820200
*                           the required environment.                 * 07832400
*                                                                     * 07844600
*       xx35xxxx  08        Incorrect  operation requested.   Neither * 07856800
*                           AWRITE,   AREAD,   APURGE,   nor   AQUERY * 07869000
*                           specified,  or  more  than one option was * 07881200
*                           specified.    (eg, the expanded macro was * 07893400
*                           zapped or overlaid).                      * 07905600
*                                                                     * 07917800
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 07930000
*                           error.     Examine  user  software  which * 07942200
*                           invokes IOSADMF.                          * 07954400
*                                                                     * 07966600
*       xx36xxxx  08        ALET  incorrect.  ALET did not designated * 07978800
*                           a  hiperspace,  or  ADMF  never used with * 07991000
*                           hiperspace.     The  latter  pertains  to * 08003200
*                           APURGE only.                              * 08015400
*                                                                     * 08027600
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08039800
*                           error.    Probable  error caused by using * 08052000
*                           IOSADMF  before hiperspace was created or * 08064200
*                           by  using  an  incorrect or uninitialized * 08076400
*                           ALET  as  a parameter to IOSADMF.  If the * 08088600
*                           error  occurred  on  an APURGE operation, * 08100800
*                           IOSADMF was never used on the hiperspace. * 08113000
*                                                                     * 08125200
*       xx37xxxx  08        Range count incorrect. NUMRANGE specified * 08137400
*                           was  either  less  than 1 or greater than * 08149600
*                           125.                                      * 08161800
*                                                                     * 08174000
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08186200
*                           error.  Check user invocation software.   * 08198400
*                                                                     * 08210600
*       xx38xxxx  08        Error  occurred  during  usage  of  input * 08222800
*                           parameters.    Parameter  list error (eg, * 08235000
*                           0C4  in handling the range list entries). * 08247200
*                           Input   parameter   list   could  not  be * 08259400
*                           addressed or error occurred referencing a * 08271600
*                           range list element.                       * 08283800
*                                                                     * 08296000
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08308200
*                           error.    Common causes of this error are * 08320400
*                           an  incorrect  RANGLIST  parameter  or  a * 08332600
*                           NUMRANGE  parameter  which is larger than * 08344800
*                           the range list entry array dimension.     * 08357000
*                                                                     * 08369200
*       xx39xxxx  08        An  error occurred during the translation * 08381400
*                           of  a  RANGLIST entry address.   FAILBLKP * 08393600
*                           contains   the  address  of  the  failing * 08405800
*                           entry.                                    * 08418000
*                                                                     * 08430200
*                           SUGGESTED   RECOVERY  ACTION  -  Probable * 08442400
*                           software   error.     Possible  incorrect * 08454600
*                           address   specified  in  RANGLIST.  Other * 08466800
*                           common   causes  of  this  error  are  an * 08479000
*                           incorrect   RANGLIST   parameter   or   a * 08491200
*                           NUMRANGE  parameter  which is larger than * 08503400
*                           the range list entry array dimension.     * 08515600
*                                                                     * 08527800
*       xx3Axxxx  08        APURGE operation failed.                  * 08540000
*                                                                     * 08552200
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08564400
*                           error.  Contact software support.         * 08576600
*                                                                     * 08588800
*       xx3Bxxxx  08        Caller  issued APURGE and was not in task * 08601000
*                           mode, was not enabled, had an EUT FRR, or * 08613200
*                           was in cross memory mode.                 * 08625400
*                                                                     * 08637600
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08649800
*                           error.    Ensure  IOSADMF macro issued in * 08662000
*                           the required environment.                 * 08674200
*                                                                     * 08686400
*       xx3Cxxxx  08        Incorrect   version   specified.  Current * 08698600
*                           version is 1.                             * 08710800
*                                                                     * 08723000
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08735200
*                           error.  Contact software support.         * 08747400
*                                                                     * 08759600
*       xx3Exxxx  08        Reserved   fields   in   XFLAGS   or   in * 08771800
*                           XRESERVED1  or  in  XRESERVED2  not zero. * 08784000
*                           These  fields  must be set to zero before * 08796200
*                           invoking   the  IOSADMF  service.    (see * 08808400
*                           IOSADMF macro expansion)                  * 08820600
*                                                                     * 08832800
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08845000
*                           error.  Contact software support.         * 08857200
*                                                                     * 08869400
*       xx40xxxx  08        hiperspace being deleted.  The hiperspace * 08881600
*                           associated   with   the   input  ALET  is * 08893800
*                           currently  being deleted.  User attempted * 08906000
*                           to  access a hiperspace using the IOSADMF * 08918200
*                           and  the  hiperspace is in the process of * 08930400
*                           being deleted.  Request is rejected.      * 08942600
*                                                                     * 08954800
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 08967000
*                           error.    Do not use hiperspace specified * 08979200
*                           on IOSADMF macro.                         * 08991400
*                                                                     * 09003600
*       xx41xxxx  08        IO  supervisor  detected an error and was * 09015800
*                           unable  to  initiate request.  Request is * 09028000
*                           rejected.                                 * 09040200
*                                                                     * 09052400
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 09064600
*                           error.  Contact software support.         * 09076800
*                                                                     * 09089000
*       xx42xxxx  08        User  attempted  to  access  a hiperspace * 09101200
*                           using   the   IOSADMF   service  and  the * 09113400
*                           hiperspace  is  owned by an address space * 09125600
*                           other   than   the  users.    Request  is * 09137800
*                           rejected.                                 * 09150000
*                                                                     * 09162200
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 09174400
*                           error.    Only  hiperspaces  in the users * 09186600
*                           primary address space may be used.        * 09198800
*                                                                     * 09211000
*       xx51xxxx  0C        System    error   occurred.      Internal * 09223200
*                           processing error.                         * 09235400
*                                                                     * 09247600
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 09259800
*                           error.  Contact software support.         * 09272000
*                                                                     * 09284200
*       xx52xxxx  0C        Resource  shortage  error.   ADM internal * 09296400
*                           control  blocks  could not be extended to * 09308600
*                           handle  request.  Virtual Storage Manager * 09320800
*                           reported error.  (eg, SQA shortage).      * 09333000
*                                                                     * 09345200
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 09357400
*                           error.  Contact software support.         * 09369600
*                                                                     * 09381800
*       xx53xxxx  0C        Resource  shortage  error.   ADM internal * 09394000
*                           control  blocks  could not be extended to * 09406200
*                           handle   request.  Real  Storage  Manager * 09418400
*                           reported error.  (eg, SQA shortage).      * 09430600
*                                                                     * 09442800
*                           SUGGESTED   RECOVERY  ACTION  -  Software * 09455000
*                           error.  Contact software support.         * 09467200
*                                                                     * 09479400
*                                                                     * 09491600
*                                                                     * 09503800
*01* MODULE TYPE:  ASSEM MACRO                                        * 09516000
*                                                                     * 09528200
*02*   PROCESSOR:  ASSEM                                              * 09540400
*                                                                     * 09552600
*01* COMPONENT:  SC1C3                                                * 09564800
*                                                                     * 09577000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 09589200
*                                                                     * 09601400
*01* MACRO USAGE NOTES:                                               * 09613600
*                                                                     * 09625800
*                                                                     * 09638000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 09650200
*        global macro variable.  Any value other than 'NO' will       * 09662400
*        result in the macro expansion being printed.  The default is * 09674600
*        'YES'.  The following examples illustrate how the ZPRINT     * 09686800
*        variable should be set.                                      * 09699000
*                                                                     * 09711200
*                    GBLC &ZPRINT                                     * 09723400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 09735600
*                                                                     * 09747800
*                                                                     * 09760000
*                                                                     * 09772200
*01* CHANGE ACTIVITY:                                                 * 09784400
*                                                                     * 09796600
*   Flag LineItem  FMID    Date   ID    Comment                       * 09808800
*                                                                     * 09821000
*    $L0=ADM      HBB4430 930601 PDLH:  ADM support                   * 09833200
*    $01=OY64804  HBB4430 930622 PDLH:  ADMF SPE                      * 09845400
****** END OF SPECIFICATIONS *****************************************/ 09857600
*/********************************************************************* 09869800
         MACRO                                                          09882000
&XLABEL  IOSADMF &ALET=,&NUMRANGE=,&RANGLIST=,&FAILBLKP=,&CROSSOVER=,  *09894200
               &RETCODE=,&RSNCODE=,&MF=                                 09906400
.*                                                                      09950000
*               MACDATE -92/02/17-<1>                                   09975000
.*                                                                      10000000
.*******************************************************************    10014200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        10028400
.*******************************************************************    10042600
               GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                  10056800
               GBLC  &ZTEST      YES=TEST NO=NO TEST                    10071000
               GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX            10085200
.*                                                                      10100000
               GBLC  &ZIOSADMF   YES=MACRO USED AT LEAST ONCE           10102700
.*******************************************************************    10105400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          10108100
.*******************************************************************    10110800
               LCLC  &ZMS        ERROR MESSAGE WORK AREA                10113500
               LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS           10116200
               LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED             10118900
               LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR            10121600
               LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE            10124300
               LCLA  &ZAWRK      USED AS A WORK AREA                    10127000
               LCLA  &ZASIZ      USED FOR SIZE OF VALUE                 10129700
               LCLA  &ZN         NUMERIC WORK VARIABLE                  10132400
               LCLC  &ZC         CHARACTER WORK VARIABLE                10135100
               LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE            10137800
               LCLA  &ZTLA       VALUE TOO LONG VARIABLE                10140500
               LCLA  &ZMACRET    MACRO RETURN CODE                      10143200
&ZMACRET       SETA  0           ASSUME NO ERRORS                       10145900
.*                                                                      10150000
               LCLC  &ZCSYSLIST(255)            NONXKEY, POS ARRAY      10172200
               LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()             10194400
               LCLA  &ZPLLEN     PARAMETER LIST LENGTH                  10216600
.********************************************************************   10238800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 10261000
.********************************************************************   10283200
               GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                10305400
               GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE         10327600
.*                                                                      10350000
               AIF   (K'&SYSASCE GT 0).ZSYS4    SYS STATE DEFINED       10350100
               AIF   (K'&SYSSPLV GT 0).ZSYS2    SP LEVEL DEFINED        10350200
               SPLEVEL  TEST                                            10350300
.ZSYS2         ANOP  ,                                                  10350400
               AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1              10350500
               AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1              10350600
               SYSSTATE TEST                                            10350700
               AGO   .ZSYS4                                             10350800
.ZSYS3         ANOP  ,                                                  10350900
&SYSASCE       SETC  'P'         ASSUME SYSSTATE PRIMARY                10351000
.ZSYS4         ANOP  ,                                                  10351100
.*******************************************************************    10351200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   10351300
.*******************************************************************    10351400
               LCLC  &XOUTVAR1   ++ VALUE                               10351500
               LCLC  &XAPURGE    ++ VALUE                               10351600
               LCLC  &XALET      ++ NAME                                10351700
               LCLC  &XAREAD     ++ VALUE                               10351800
               LCLC  &XNUMRANGE  ++ NAME                                10351900
               LCLC  &XRANGLIST  ++ NAME                                10352000
               LCLC  &XFAILBLKP  ++ NAME                                10352100
               LCLC  &XAWRITE    ++ VALUE                               10352200
               LCLC  &XAQUERY    ++ VALUE                               10352300
               LCLC  &XCROSSOVER                ++ NAME                 10352400
               LCLC  &XRETCODE   ++ NAME                                10352500
               LCLC  &XRSNCODE   ++ NAME                                10352600
               LCLC  &XMF        ++ VALUE                               10352700
               LCLC  &XMFCTRL    ++ NAME                                10352800
               LCLC  &XMFATTR    ++ VALUE                               10352900
               LCLC  &XMFSCK     ++ VALUE                               10353000
.*******************************************************************    10353100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           10353200
.*******************************************************************    10353300
               LCLC  &ZXOUTVAR1  ++ INPUT VALUE                         10353400
               LCLC  &ZXAPURGE   ++ INPUT VALUE                         10353500
               LCLC  &ZXALET     ++ INPUT NAME                          10353600
               LCLC  &ZXAREAD    ++ INPUT VALUE                         10353700
               LCLC  &ZXNUMRANGE                ++ INPUT NAME           10353800
               LCLC  &ZXRANGLIST                ++ INPUT NAME           10353900
               LCLC  &ZXFAILBLKP                ++ OUTPUT NAME          10354000
               LCLC  &ZXAWRITE   ++ INPUT VALUE                         10354100
               LCLC  &ZXAQUERY   ++ INPUT VALUE                         10354200
               LCLC  &ZXCROSSOVER               ++ OUTPUT NAME          10354300
               LCLC  &ZXRETCODE  ++ OUTPUT NAME                         10354400
               LCLC  &ZXRSNCODE  ++ OUTPUT NAME                         10354500
               LCLC  &ZXMF       ++ INPUT VALUE                         10354600
               LCLC  &ZXMFCTRL   ++ INPUT NAME                          10354700
               LCLC  &ZXMFATTR   ++ INPUT VALUE                         10354800
               LCLC  &ZXMFSCK    ++ INPUT VALUE                         10354900
.********************************************************************   10355000
.***AG.MF01 PROCESS MF MACRO FORMS                                      10355100
.********************************************************************   10355200
               ACTR  10000                                              10355300
.*------------------------------------------------------------------    10355400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           10355500
&XMF           SETC  ''          INITIALIZE XVARIABLE                   10355600
.*-------------------------------------------------------------------   10355700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           10355800
.ZG45          ANOP  ,                                                  10355900
&ZTLC          SETC 'S'                                                 10356000
               AIF   ('&MF(1)' NE '&ZTLC').ZG46                         10356100
&XMF           SETC  'S'         SET KEYWORD                            10356200
               AIF   (N'&MF LE 1).ZG45A         CK NUM                  10356300
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          10356400
&ZMS           SETC  '&ZMS.&MF"'                                        10356500
&ZMS           SETC  '&ZMS "MF"'                                        10356600
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                10356700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10356800
.ZG45A         ANOP  ,                                                  10356900
.*-------------------------------------------------------------------   10357000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           10357100
.ZG46          ANOP  ,                                                  10357200
&ZTLC          SETC 'L'                                                 10357300
               AIF   ('&MF(1)' NE '&ZTLC').ZG53                         10357400
&XMF           SETC  'L'         SET KEYWORD                            10357500
               AIF   (N'&MF LE 3).ZG46A         CK NUM                  10357600
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          10357700
&ZMS           SETC  '&ZMS.&MF"'                                        10357800
&ZMS           SETC  '&ZMS "MF"'                                        10357900
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               10358000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10358100
.ZG46A         ANOP  ,                                                  10358200
.*-------------------------------------------------------------------   10358300
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     10358400
               AIF   (N'&SYSLIST NE 0).ZG46B    POSITIONALS?            10358500
               AIF   ('&ALET' NE '').ZG46B      KEYS?                   10358600
               AIF   ('&NUMRANGE' NE '').ZG46B  KEYS?                   10358700
               AIF   ('&RANGLIST' NE '').ZG46B  KEYS?                   10358800
               AIF   ('&FAILBLKP' NE '').ZG46B  KEYS?                   10358900
               AIF   ('&CROSSOVER' NE '').ZG46B  KEYS?                  10359000
               AIF   ('&RETCODE' NE '').ZG46B   KEYS?                   10359100
               AIF   ('&RSNCODE' NE '').ZG46B   KEYS?                   10359200
               AGO    .ZG46C     INVOCATION OKAY                        10359300
.ZG46B         ANOP  ,                                                  10359400
&ZMS           SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE        10359500
&ZMS           SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                  10359600
&ZMS           SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'             10359700
               MNOTE 8,' &ZMS ON THE INVOCATION.'                       10359800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10359900
.ZG46C         ANOP  ,                                                  10360000
.*-------------------------------------------------------------------   10360100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   10360200
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          10360300
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          10360400
               AIF   (N'&MF(2) GT 1).ZG48B      MULTI PARMS             10360500
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          10360600
.ZG48B         AIF   (K'&MF(2) GT 0).ZG48C                              10360700
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        10360800
&ZMS           SETC  'WHEN "L" IS SPECIFIED'    *KRQDA*                 10360900
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                10361000
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       10361100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10361200
.ZG48C         ANOP  ,                                                  10361300
.*-------------------------------------------------------------------   10361400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               10361500
               AIF   (K'&ZXMFCTRL LE 0).ZG48P   NOT I/O                 10361600
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG48P                     10361700
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        10361800
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          10361900
&ZMS           SETC  '&ZMS.&MF"'                                        10362000
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          10362100
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                  10362200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10362300
.ZG48P         ANOP  ,                                                  10362400
.*-------------------------------------------------------------------   10362500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      10362600
&ZXMFATTR      SETC  'INPUT'     SET IN/OUTPUT                          10362700
&XMFATTR       SETC  '0D'                                               10362800
               AIF   (K'&MF(3) LE 0).ZG51B      PARM                    10362900
&XMFATTR       SETC  '&MF(3,1)'  SET XVARIABLE                          10363000
               AIF   (N'&MF(3) GT 1).ZG51B      MULTI PARMS             10363100
&XMFATTR       SETC  '&MF(3)'    SET XVARIABLE                          10363200
.ZG51B         ANOP  ,                                                  10363300
.*-------------------------------------------------------------------   10363400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  10363500
               AIF   (K'&ZXMFATTR LE 0).ZG51P   NOT I/O                 10363600
               AIF   ('&XMFATTR'(1,1) NE '(').ZG51P                     10363700
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        10363800
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          10363900
&ZMS           SETC  '&ZMS.&MF"'                                        10364000
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          10364100
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                  10364200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10364300
.ZG51P         ANOP  ,                                                  10364400
.*-------------------------------------------------------------------   10364500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 10364600
               AIF   (K'&ZXMFATTR LE 0).ZG51S   NOT I/O                 10364700
               AIF   (K'&XMFATTR LE 60).ZG51S   LNG OK                  10364800
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        10364900
&ZMS           SETC  '"MF='      *KLNGA* MNOTE                          10365000
&ZMS           SETC  '&ZMS.&MF"'                                        10365100
&ZMS           SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'              10365200
               MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                 10365300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10365400
.ZG51S         ANOP  ,                                                  10365500
.*-------------------------------------------------------------------   10365600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           10365700
.ZG53          ANOP  ,                                                  10365800
&ZTLC          SETC 'E'                                                 10365900
               AIF   ('&MF(1)' NE '&ZTLC').ZG61                         10366000
&XMF           SETC  'E'         SET KEYWORD                            10366100
               AIF   (N'&MF LE 3).ZG53A         CK NUM                  10366200
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          10366300
&ZMS           SETC  '&ZMS.&MF"'                                        10366400
&ZMS           SETC  '&ZMS "MF"'                                        10366500
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               10366600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10366700
.ZG53A         ANOP  ,                                                  10366800
.*-------------------------------------------------------------------   10366900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   10367000
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          10367100
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          10367200
               AIF   (N'&MF(2) GT 1).ZG55B      MULTI PARMS             10367300
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          10367400
.ZG55B         AIF   (K'&MF(2) GT 0).ZG55C                              10367500
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        10367600
&ZMS           SETC  'WHEN "E" IS SPECIFIED'    *KRQDA*                 10367700
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                10367800
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       10367900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10368000
.ZG55C         ANOP  ,                                                  10368100
.*-------------------------------------------------------------------   10368200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              10368300
               AIF   (K'&ZXMFCTRL LE 0).ZG55R   NOT I/O                 10368400
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG55R                     10368500
&ZCGPR         SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                         10368600
               AIF   ('&ZCGPR'(1,1) NE '0').ZG55P                       10368700
               AIF   (K'&ZCGPR GT 2).ZG55Q                              10368800
               AIF   ('&ZCGPR' EQ '0').ZG55Q                            10368900
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      10369000
               AIF   (T'&ZCGPR NE 'N').ZG55Q    INVALID REG NAME        10369100
.ZG55P         ANOP  ,                                                  10369200
               AIF   (T'&ZCGPR NE 'N').ZG55R    NON NUMERIC             10369300
               AIF   ('&ZCGPR' LT '1').ZG55Q                            10369400
               AIF   ('&ZCGPR' LE '12').ZG55R                           10369500
.ZG55Q         ANOP  ,                                                  10369600
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          10369700
&ZMS           SETC  '&ZMS.&MF"'                                        10369800
&ZMS           SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'          10369900
               MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                   10370000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10370100
.ZG55R         ANOP  ,                                                  10370200
.*-------------------------------------------------------------------   10370300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             10370400
&XMFSCK        SETC  ''          INITIALIZE XVARIABLE                   10370500
.ZG59A   AIF   ('&MF(3)' NE 'COMPLETE').ZG60A                           10370600
&XMFSCK        SETC  'COMPLETE'  SET KEYWORD                            10370700
.*-------------------------------------------------------------------   10370800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             10370900
.ZG60A         AIF   (K'&XMFSCK GT 0).ZG60C     KEYWORD                 10371000
               AIF   (K'&MF(3) LE 0).ZG60B                              10371100
&ZMS           SETC  '"MF='      *KUKWA* MNOTE                          10371200
&ZMS           SETC  '&ZMS.&MF"'                                        10371300
&ZMS           SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '          10371400
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                10371500
&ZMS           SETC  '&ZMS "COMPLETE".'         VALID KEYWORD           10371600
               MNOTE 8,' &ZMS '                                         10371700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10371800
.ZG60B         ANOP  ,                                                  10371900
&XMFSCK        SETC  'COMPLETE'  SET DEFAULT KEYWORD                    10372000
.ZG60C         ANOP  ,                                                  10372100
&ZXMFSCK       SETC  'INPUT'     SET IN/OUTPUT                          10372200
.*------------------------------------------------------------------    10372300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           10372400
.ZG61          ANOP  ,                                                  10372500
&ZXMF          SETC  'INPUT'     SET IN/OUTPUT                          10372600
               AIF   (K'&XMF GT 0).ZG61E        VALID ARG               10372700
               AIF   (T'&MF EQ 'O').ZG61D       OMITTED                 10372800
&ZASYSLNDX     SETA  0                                                  10372900
.ZG61A         ANOP  ,           POSITIONAL MACRO KEY                   10373000
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       10373100
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG61C                   10373200
&ZTLC          SETC 'MF'                                                10373300
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG61A          10373400
.ZG61B         ANOP  ,                                                  10373500
&ZXMF          SETC  ''          RESET IN/OUTPUT                        10373600
&ZMS           SETC  'THE "MF" KEY'             *KOPTA* MNOTE           10373700
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            10373800
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   10373900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10374000
               AGO   .ZG61E                                             10374100
.ZG61C         ANOP  ,                                                  10374200
&ZXMF          SETC  ''          RESET IN/OUTPUT                        10374300
&ZMS           SETC  '"MF='      *KUKWA* MNOTE                          10374400
&ZMS           SETC  '&ZMS.&MF"'                                        10374500
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          10374600
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                10374700
&ZMS           SETC  '&ZMS "S",'                VALID KEYWORD           10374800
&ZMS           SETC  '&ZMS "L",'                VALID KEYWORD           10374900
&ZMS           SETC  '&ZMS OR "E".'             VALID KEYWORD           10375000
               MNOTE 8,' &ZMS '                                         10375100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10375200
               AGO   .ZG61E                                             10375300
.ZG61D         ANOP  ,                                                  10375400
&XMF           SETC  'S'         SET DEFAULT KEYWORD                    10375500
&XMFSCK        SETC  'COMPLETE'  COMPLETE CHECKING                      10375600
.ZG61E         ANOP  ,                                                  10375700
.********************************************************************   10375800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 10375900
.********************************************************************   10376000
               ACTR  10000                                              10376100
.*-------------------------------------------------------------------   10376200
.***AG.MF03 MF=(SLE)                                                    10376300
               AIF   ('&XMF' EQ 'L').ZGMFX                              10376400
.*-------------------------------------------------------------------   10376500
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  10376600
&XOUTVAR1      SETC  ''          INITIALIZE XVARIABLE                   10376700
&ZASYSLNDX     SETA  0                                                  10376800
.ZG2A          ANOP  ,           POSITIONAL KEY SEARCH                  10376900
&ZASYSLNDX     SETA  &ZASYSLNDX+1               NEXT POSITIONAL         10377000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    10377100
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             10377200
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'APURGE').ZG2A                10377300
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         10377400
&ZXOUTVAR1     SETC  'INPUT'     SET IN/OUTPUT                          10377500
&XOUTVAR1      SETC  'APURGE'    SET XVARIABLE                          10377600
&ZXAPURGE      SETC  'INPUT'     SET IN/OUTPUT                          10377700
&XAPURGE       SETC  'APURGE'    SET XVARIABLE PARM                     10377800
.ZG2B          ANOP  ,                                                  10377900
.*-------------------------------------------------------------------   10378000
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  10378100
&ZASYSLNDX     SETA  0                                                  10378200
.ZG6A          ANOP  ,           POSITIONAL KEY SEARCH                  10378300
&ZASYSLNDX     SETA  &ZASYSLNDX+1               NEXT POSITIONAL         10378400
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG6C  DONE                    10378500
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG6A             10378600
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'AREAD').ZG6A                 10378700
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         10378800
               AIF   (K'&XOUTVAR1 LE 0).ZG6B    VALID                   10378900
&ZMS           SETC  '"AREAD'    *KMEKA* MNOTE                          10379000
&ZMS           SETC  '&ZMS."'                                           10379100
&ZMS           SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'              10379200
&ZMS           SETC  '&ZMS "&XOUTVAR1"'                                 10379300
               MNOTE 8,' &ZMS KEY.'                                     10379400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10379500
               AGO   .ZG6C                                              10379600
.*                                                                      10400000
.ZG6B          ANOP  ,                                                  10422900
&ZXOUTVAR1     SETC  'INPUT'     SET IN/OUTPUT                          10445800
&XOUTVAR1      SETC  'AREAD'     SET XVARIABLE                          10468700
&ZXAREAD       SETC  'INPUT'     SET IN/OUTPUT                          10491600
&XAREAD        SETC  'AREAD'     SET XVARIABLE PARM                     10514500
.ZG6C          ANOP  ,                                                  10537400
.*-------------------------------------------------------------------   10560300
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  10583200
&ZASYSLNDX     SETA  0                                                  10606100
.ZG19A         ANOP  ,           POSITIONAL KEY SEARCH                  10629000
&ZASYSLNDX     SETA  &ZASYSLNDX+1               NEXT POSITIONAL         10651900
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG19C  DONE                   10674800
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG19A            10697700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'AWRITE').ZG19A               10720600
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         10743500
               AIF   (K'&XOUTVAR1 LE 0).ZG19B   VALID                   10766400
&ZMS           SETC  '"AWRITE'   *KMEKA* MNOTE                          10789300
&ZMS           SETC  '&ZMS."'                                           10812200
&ZMS           SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'              10835100
&ZMS           SETC  '&ZMS "&XOUTVAR1"'                                 10858000
               MNOTE 8,' &ZMS KEY.'                                     10880900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10903800
               AGO   .ZG19C                                             10926700
.*                                                                      10950000
.ZG19B         ANOP  ,                                                  10952000
&ZXOUTVAR1     SETC  'INPUT'     SET IN/OUTPUT                          10954000
&XOUTVAR1      SETC  'AWRITE'    SET XVARIABLE                          10956000
&ZXAWRITE      SETC  'INPUT'     SET IN/OUTPUT                          10958000
&XAWRITE       SETC  'AWRITE'    SET XVARIABLE PARM                     10960000
.ZG19C         ANOP  ,                                                  10962000
.*-------------------------------------------------------------------   10964000
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  10966000
&ZASYSLNDX     SETA  0                                                  10968000
.ZG32A         ANOP  ,           POSITIONAL KEY SEARCH                  10970000
&ZASYSLNDX     SETA  &ZASYSLNDX+1               NEXT POSITIONAL         10972000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG32C  DONE                   10974000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG32A            10976000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'AQUERY').ZG32A               10978000
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         10980000
               AIF   (K'&XOUTVAR1 LE 0).ZG32B   VALID                   10982000
&ZMS           SETC  '"AQUERY'   *KMEKA* MNOTE                          10984000
&ZMS           SETC  '&ZMS."'                                           10986000
&ZMS           SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'              10988000
&ZMS           SETC  '&ZMS "&XOUTVAR1"'                                 10990000
               MNOTE 8,' &ZMS KEY.'                                     10992000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            10994000
               AGO   .ZG32C                                             10996000
.*                                                                      11000000
.ZG32B         ANOP  ,                                                  11000600
&ZXOUTVAR1     SETC  'INPUT'     SET IN/OUTPUT                          11001200
&XOUTVAR1      SETC  'AQUERY'    SET XVARIABLE                          11001800
&ZXAQUERY      SETC  'INPUT'     SET IN/OUTPUT                          11002400
&XAQUERY       SETC  'AQUERY'    SET XVARIABLE PARM                     11003000
.ZG32C         ANOP  ,                                                  11003600
.*------------------------------------------------------------------    11004200
.***AG.KMEKY09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          11004800
               AIF   (K'&XOUTVAR1 GT 0).ZG36B                           11005400
&ZXOUTVAR1     SETC  ''          RESET IN/OUTPUT                        11006000
&ZXAPURGE      SETC  ''          RESET IN/OUTPUT                        11006600
&XOUTVAR1      SETC  ''          ENSURE NULL                            11007200
&XAPURGE       SETC  ''          ENSURE NULL                            11007800
&ZMS           SETC  'ONE OF THE FOLLOWING'     *KMERA* MNOTE           11008400
&ZMS           SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                11009000
&ZMS           SETC  '&ZMS REQUIRED:'                                   11009600
&ZMS           SETC  '&ZMS "APURGE",'           VALID ME KEY            11010200
&ZMS           SETC  '&ZMS "AREAD",'            VALID ME KEY            11010800
&ZMS           SETC  '&ZMS "AWRITE",'           VALID ME KEY            11011400
&ZMS           SETC  '&ZMS OR "AQUERY".'        VALID ME KEY            11012000
               MNOTE 8,' &ZMS '                                         11012600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11013200
.ZG36B         ANOP  ,                                                  11013800
.*-------------------------------------------------------------------   11014400
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          11015000
.ZG2           AIF   ('&XOUTVAR1' NE 'APURGE').ZG6                      11015600
.*-------------------------------------------------------------------   11016200
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               11016800
&ZCVAL         SETC ''           ERROR KEY FIELD                        11017400
.ZG2I0         AIF   (K'&NUMRANGE LE 0).ZG2I1                           11018000
&ZCVAL         SETC '&ZCVAL NUMRANGE'           DISALLOWED KEY          11018600
.ZG2I1         AIF   (K'&RANGLIST LE 0).ZG2I2                           11019200
&ZCVAL         SETC '&ZCVAL RANGLIST'           DISALLOWED KEY          11019800
.ZG2I2         AIF   (K'&FAILBLKP LE 0).ZG2I3                           11020400
&ZCVAL         SETC '&ZCVAL FAILBLKP'           DISALLOWED KEY          11021000
.ZG2I3         AIF   (K'&CROSSOVER LE 0).ZG2I4                          11021600
&ZCVAL         SETC '&ZCVAL CROSSOVER'          DISALLOWED KEY          11022200
.ZG2I4         AIF   (K'&ZCVAL LE 0).ZG2J       KEY                     11022800
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              11023400
&ZMS           SETC  '"APURGE'   *KMEIA* MNOTE                          11024000
&ZMS           SETC  '&ZMS."'                                           11024600
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               11025200
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               11025800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11026400
.ZG2J          ANOP  ,                                                  11027000
.*-------------------------------------------------------------------   11027600
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                11028200
               AIF   (K'&ZXAPURGE LE 0).ZG2R    NOT I/O                 11028800
               AIF   ('&XAPURGE'(1,1) NE '(').ZG2R                      11029400
&ZCGPR         SETC  '&XAPURGE'(2,K'&XAPURGE-2)                         11030000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                        11030600
               AIF   (K'&ZCGPR GT 2).ZG2Q                               11031200
               AIF   ('&ZCGPR' EQ '0').ZG2Q                             11031800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11032400
               AIF   (T'&ZCGPR NE 'N').ZG2Q     INVALID REG NAME        11033000
.ZG2P          ANOP  ,                                                  11033600
               AIF   (T'&ZCGPR NE 'N').ZG2R     NON NUMERIC             11034200
               AIF   ('&ZCGPR' LT '2').ZG2Q                             11034800
               AIF   ('&ZCGPR' LE '12').ZG2R                            11035400
.ZG2Q          ANOP  ,                                                  11036000
&ZMS           SETC  '"APURGE='  *KGPRA* MNOTE                          11036600
&ZMS           SETC  '&ZMS.&APURGE"'                                    11037200
&ZMS           SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'          11037800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11038400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11039000
.ZG2R          ANOP  ,                                                  11039600
.*----------------------------------------------------------------***   11040200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     11040800
               AIF   (N'&ALET LE 1).ZG4A        CK NUM                  11041400
&ZMS           SETC  '"ALET='    *KPOSA* MNOTE                          11042000
&ZMS           SETC  '&ZMS.&ALET"'                                      11042600
&ZMS           SETC  '&ZMS "ALET"'                                      11043200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11043800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11044400
.ZG4A          ANOP  ,                                                  11045000
.*-------------------------------------------------------------------   11045600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         11046200
&ZXALET        SETC  'INPUT'     SET IN/OUTPUT                          11046800
&XALET         SETC  '&ALET(1)'  SET XVARIABLE                          11047400
               AIF   (N'&ALET GT 1).ZG4B        MULTI PARMS             11048000
&XALET         SETC  '&ALET'     SET XVARIABLE                          11048600
.ZG4B          AIF   (K'&ALET(1) GT 0).ZG4C                             11049200
&ZXALET        SETC  ''          RESET IN/OUTPUT                        11049800
&ZMS           SETC  ' '         *KRQDA*                                11050400
&ZMS           SETC  '&ZMS "ALET" KEY AND ITS ARGUMENT'                 11051000
               MNOTE 8,' &ZMS ARE REQUIRED.'                            11051600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11052200
.ZG4C          ANOP  ,                                                  11052800
.*-------------------------------------------------------------------   11053400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    11054000
               AIF   (K'&ZXALET LE 0).ZG4R      NOT I/O                 11054600
               AIF   ('&XALET'(1,1) NE '(').ZG4R                        11055200
&ZCGPR         SETC  '&XALET'(2,K'&XALET-2)                             11055800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                        11056400
               AIF   (K'&ZCGPR GT 2).ZG4Q                               11057000
               AIF   ('&ZCGPR' EQ '0').ZG4Q                             11057600
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11058200
               AIF   (T'&ZCGPR NE 'N').ZG4Q     INVALID REG NAME        11058800
.ZG4P          ANOP  ,                                                  11059400
               AIF   (T'&ZCGPR NE 'N').ZG4R     NON NUMERIC             11060000
               AIF   ('&ZCGPR' LT '2').ZG4Q                             11060600
               AIF   ('&ZCGPR' LE '12').ZG4R                            11061200
.ZG4Q          ANOP  ,                                                  11061800
&ZMS           SETC  '"ALET='    *KGPRA* MNOTE                          11062400
&ZMS           SETC  '&ZMS.&ALET"'                                      11063000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11063600
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11064200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11064800
.ZG4R          ANOP  ,                                                  11065400
.*-------------------------------------------------------------------   11066000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          11066600
.ZG6           AIF   ('&XOUTVAR1' NE 'AREAD').ZG19                      11067200
.*-------------------------------------------------------------------   11067800
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               11068400
&ZCVAL         SETC ''           ERROR KEY FIELD                        11069000
.ZG6I0         AIF   (K'&CROSSOVER LE 0).ZG6I1                          11069600
&ZCVAL         SETC '&ZCVAL CROSSOVER'          DISALLOWED KEY          11070200
.ZG6I1         AIF   (K'&ZCVAL LE 0).ZG6J       KEY                     11070800
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              11071400
&ZMS           SETC  '"AREAD'    *KMEIA* MNOTE                          11072000
&ZMS           SETC  '&ZMS."'                                           11072600
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               11073200
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               11073800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11074400
.ZG6J          ANOP  ,                                                  11075000
.*-------------------------------------------------------------------   11075600
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                11076200
               AIF   (K'&ZXAREAD LE 0).ZG6R     NOT I/O                 11076800
               AIF   ('&XAREAD'(1,1) NE '(').ZG6R                       11077400
&ZCGPR         SETC  '&XAREAD'(2,K'&XAREAD-2)                           11078000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                        11078600
               AIF   (K'&ZCGPR GT 2).ZG6Q                               11079200
               AIF   ('&ZCGPR' EQ '0').ZG6Q                             11079800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11080400
               AIF   (T'&ZCGPR NE 'N').ZG6Q     INVALID REG NAME        11081000
.ZG6P          ANOP  ,                                                  11081600
               AIF   (T'&ZCGPR NE 'N').ZG6R     NON NUMERIC             11082200
               AIF   ('&ZCGPR' LT '2').ZG6Q                             11082800
               AIF   ('&ZCGPR' LE '12').ZG6R                            11083400
.ZG6Q          ANOP  ,                                                  11084000
&ZMS           SETC  '"AREAD='   *KGPRA* MNOTE                          11084600
&ZMS           SETC  '&ZMS.&AREAD"'                                     11085200
&ZMS           SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'          11085800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11086400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11087000
.ZG6R          ANOP  ,                                                  11087600
.*----------------------------------------------------------------***   11088200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     11088800
               AIF   (N'&ALET LE 1).ZG8A        CK NUM                  11089400
&ZMS           SETC  '"ALET='    *KPOSA* MNOTE                          11090000
&ZMS           SETC  '&ZMS.&ALET"'                                      11090600
&ZMS           SETC  '&ZMS "ALET"'                                      11091200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11091800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11092400
.ZG8A          ANOP  ,                                                  11093000
.*-------------------------------------------------------------------   11093600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         11094200
&ZXALET        SETC  'INPUT'     SET IN/OUTPUT                          11094800
&XALET         SETC  '&ALET(1)'  SET XVARIABLE                          11095400
               AIF   (N'&ALET GT 1).ZG8B        MULTI PARMS             11096000
&XALET         SETC  '&ALET'     SET XVARIABLE                          11096600
.ZG8B          AIF   (K'&ALET(1) GT 0).ZG8C                             11097200
&ZXALET        SETC  ''          RESET IN/OUTPUT                        11097800
&ZMS           SETC  ' '         *KRQDA*                                11098400
&ZMS           SETC  '&ZMS "ALET" KEY AND ITS ARGUMENT'                 11099000
               MNOTE 8,' &ZMS ARE REQUIRED.'                            11099600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11100200
.ZG8C          ANOP  ,                                                  11100800
.*-------------------------------------------------------------------   11101400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    11102000
               AIF   (K'&ZXALET LE 0).ZG8R      NOT I/O                 11102600
               AIF   ('&XALET'(1,1) NE '(').ZG8R                        11103200
&ZCGPR         SETC  '&XALET'(2,K'&XALET-2)                             11103800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                        11104400
               AIF   (K'&ZCGPR GT 2).ZG8Q                               11105000
               AIF   ('&ZCGPR' EQ '0').ZG8Q                             11105600
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11106200
               AIF   (T'&ZCGPR NE 'N').ZG8Q     INVALID REG NAME        11106800
.ZG8P          ANOP  ,                                                  11107400
               AIF   (T'&ZCGPR NE 'N').ZG8R     NON NUMERIC             11108000
               AIF   ('&ZCGPR' LT '2').ZG8Q                             11108600
               AIF   ('&ZCGPR' LE '12').ZG8R                            11109200
.ZG8Q          ANOP  ,                                                  11109800
&ZMS           SETC  '"ALET='    *KGPRA* MNOTE                          11110400
&ZMS           SETC  '&ZMS.&ALET"'                                      11111000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11111600
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11112200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11112800
.ZG8R          ANOP  ,                                                  11113400
.*----------------------------------------------------------------***   11114000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     11114600
               AIF   (N'&NUMRANGE LE 1).ZG11A   CK NUM                  11115200
&ZMS           SETC  '"NUMRANGE='               *KPOSA* MNOTE           11115800
&ZMS           SETC  '&ZMS.&NUMRANGE"'                                  11116400
&ZMS           SETC  '&ZMS "NUMRANGE"'                                  11117000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11117600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11118200
.ZG11A         ANOP  ,                                                  11118800
.*-------------------------------------------------------------------   11119400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         11120000
&ZXNUMRANGE    SETC  'INPUT'     SET IN/OUTPUT                          11120600
&XNUMRANGE     SETC  '1'                                                11121200
               AIF   (K'&NUMRANGE(1) LE 0).ZG11B  PARM                  11121800
&XNUMRANGE     SETC  '&NUMRANGE(1)'             SET XVARIABLE           11122400
               AIF   (N'&NUMRANGE GT 1).ZG11B   MULTI PARMS             11123000
&XNUMRANGE     SETC  '&NUMRANGE'                SET XVARIABLE           11123600
.ZG11B         ANOP  ,                                                  11124200
.*-------------------------------------------------------------------   11124800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    11125400
               AIF   (K'&ZXNUMRANGE LE 0).ZG11R  NOT I/O                11126000
               AIF   ('&XNUMRANGE'(1,1) NE '(').ZG11R                   11126600
&ZCGPR         SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                     11127200
               AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                       11127800
               AIF   (K'&ZCGPR GT 2).ZG11Q                              11128400
               AIF   ('&ZCGPR' EQ '0').ZG11Q                            11129000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11129600
               AIF   (T'&ZCGPR NE 'N').ZG11Q    INVALID REG NAME        11130200
.ZG11P         ANOP  ,                                                  11130800
               AIF   (T'&ZCGPR NE 'N').ZG11R    NON NUMERIC             11131400
               AIF   ('&ZCGPR' LT '2').ZG11Q                            11132000
               AIF   ('&ZCGPR' LE '12').ZG11R                           11132600
.ZG11Q         ANOP  ,                                                  11133200
&ZMS           SETC  '"NUMRANGE='               *KGPRA* MNOTE           11133800
&ZMS           SETC  '&ZMS.&NUMRANGE"'                                  11134400
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11135000
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11135600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11136200
.ZG11R         ANOP  ,                                                  11136800
.*----------------------------------------------------------------***   11137400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     11138000
               AIF   (N'&RANGLIST LE 1).ZG14A   CK NUM                  11138600
&ZMS           SETC  '"RANGLIST='               *KPOSA* MNOTE           11139200
&ZMS           SETC  '&ZMS.&RANGLIST"'                                  11139800
&ZMS           SETC  '&ZMS "RANGLIST"'                                  11140400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11141000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11141600
.ZG14A         ANOP  ,                                                  11142200
.*-------------------------------------------------------------------   11142800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         11143400
&ZXRANGLIST    SETC  'INPUT'     SET IN/OUTPUT                          11144000
&XRANGLIST     SETC  '&RANGLIST(1)'             SET XVARIABLE           11144600
               AIF   (N'&RANGLIST GT 1).ZG14B   MULTI PARMS             11145200
&XRANGLIST     SETC  '&RANGLIST'                SET XVARIABLE           11145800
.ZG14B         AIF   (K'&RANGLIST(1) GT 0).ZG14C                        11146400
&ZXRANGLIST    SETC  ''          RESET IN/OUTPUT                        11147000
&ZMS           SETC  ' '         *KRQDA*                                11147600
&ZMS           SETC  '&ZMS "RANGLIST" KEY AND ITS ARGUMENT'             11148200
               MNOTE 8,' &ZMS ARE REQUIRED.'                            11148800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11149400
.ZG14C         ANOP  ,                                                  11150000
.*-------------------------------------------------------------------   11150600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    11151200
               AIF   (K'&ZXRANGLIST LE 0).ZG14R  NOT I/O                11151800
               AIF   ('&XRANGLIST'(1,1) NE '(').ZG14R                   11152400
&ZCGPR         SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                     11153000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                       11153600
               AIF   (K'&ZCGPR GT 2).ZG14Q                              11154200
               AIF   ('&ZCGPR' EQ '0').ZG14Q                            11154800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11155400
               AIF   (T'&ZCGPR NE 'N').ZG14Q    INVALID REG NAME        11156000
.ZG14P         ANOP  ,                                                  11156600
               AIF   (T'&ZCGPR NE 'N').ZG14R    NON NUMERIC             11157200
               AIF   ('&ZCGPR' LT '2').ZG14Q                            11157800
               AIF   ('&ZCGPR' LE '12').ZG14R                           11158400
.ZG14Q         ANOP  ,                                                  11159000
&ZMS           SETC  '"RANGLIST='               *KGPRA* MNOTE           11159600
&ZMS           SETC  '&ZMS.&RANGLIST"'                                  11160200
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11160800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11161400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11162000
.ZG14R         ANOP  ,                                                  11162600
.*----------------------------------------------------------------***   11163200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    11163800
               AIF   (N'&FAILBLKP LE 1).ZG17A   CK NUM                  11164400
&ZMS           SETC  '"FAILBLKP='               *KPOSA* MNOTE           11165000
&ZMS           SETC  '&ZMS.&FAILBLKP"'                                  11165600
&ZMS           SETC  '&ZMS "FAILBLKP"'                                  11166200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11166800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11167400
.ZG17A         ANOP  ,                                                  11168000
.*-------------------------------------------------------------------   11168600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        11169200
               AIF   (K'&FAILBLKP(1) LE 0).ZG17C  NO PARM               11169800
&ZXFAILBLKP    SETC  'OUTPUT'    SET OUTPUT                             11170400
&XFAILBLKP     SETC  '&FAILBLKP(1)'             SET XVARIABLE           11171000
               AIF   (N'&FAILBLKP GT 1).ZG17C                           11171600
&XFAILBLKP     SETC  '&FAILBLKP'                SET XVARIABLE           11172200
.ZG17C         ANOP  ,                                                  11172800
.*-------------------------------------------------------------------   11173400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   11174000
               AIF   (K'&ZXFAILBLKP LE 0).ZG17R  NOT I/O                11174600
               AIF   ('&XFAILBLKP'(1,1) NE '(').ZG17R                   11175200
&ZCGPR         SETC  '&XFAILBLKP'(2,K'&XFAILBLKP-2)                     11175800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                       11176400
               AIF   (K'&ZCGPR GT 2).ZG17Q                              11177000
               AIF   ('&ZCGPR' EQ '0').ZG17Q                            11177600
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11178200
               AIF   (T'&ZCGPR NE 'N').ZG17Q    INVALID REG NAME        11178800
.ZG17P         ANOP  ,                                                  11179400
               AIF   (T'&ZCGPR NE 'N').ZG17R    NON NUMERIC             11180000
               AIF   ('&ZCGPR' LT '2').ZG17Q                            11180600
               AIF   ('&ZCGPR' LE '12').ZG17R                           11181200
.ZG17Q         ANOP  ,                                                  11181800
&ZMS           SETC  '"FAILBLKP='               *KGPRA* MNOTE           11182400
&ZMS           SETC  '&ZMS.&FAILBLKP"'                                  11183000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11183600
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11184200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11184800
.ZG17R         ANOP  ,                                                  11185400
.*-------------------------------------------------------------------   11186000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          11186600
.ZG19          AIF   ('&XOUTVAR1' NE 'AWRITE').ZG32                     11187200
.*-------------------------------------------------------------------   11187800
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               11188400
&ZCVAL         SETC ''           ERROR KEY FIELD                        11189000
.ZG19I0        AIF   (K'&CROSSOVER LE 0).ZG19I1                         11189600
&ZCVAL         SETC '&ZCVAL CROSSOVER'          DISALLOWED KEY          11190200
.ZG19I1        AIF   (K'&ZCVAL LE 0).ZG19J      KEY                     11190800
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              11191400
&ZMS           SETC  '"AWRITE'   *KMEIA* MNOTE                          11192000
&ZMS           SETC  '&ZMS."'                                           11192600
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               11193200
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               11193800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11194400
.ZG19J         ANOP  ,                                                  11195000
.*-------------------------------------------------------------------   11195600
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                11196200
               AIF   (K'&ZXAWRITE LE 0).ZG19R   NOT I/O                 11196800
               AIF   ('&XAWRITE'(1,1) NE '(').ZG19R                     11197400
&ZCGPR         SETC  '&XAWRITE'(2,K'&XAWRITE-2)                         11198000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                       11198600
               AIF   (K'&ZCGPR GT 2).ZG19Q                              11199200
               AIF   ('&ZCGPR' EQ '0').ZG19Q                            11199800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11200400
               AIF   (T'&ZCGPR NE 'N').ZG19Q    INVALID REG NAME        11201000
.ZG19P         ANOP  ,                                                  11201600
               AIF   (T'&ZCGPR NE 'N').ZG19R    NON NUMERIC             11202200
               AIF   ('&ZCGPR' LT '2').ZG19Q                            11202800
               AIF   ('&ZCGPR' LE '12').ZG19R                           11203400
.ZG19Q         ANOP  ,                                                  11204000
&ZMS           SETC  '"AWRITE='  *KGPRA* MNOTE                          11204600
&ZMS           SETC  '&ZMS.&AWRITE"'                                    11205200
&ZMS           SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'          11205800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11206400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11207000
.ZG19R         ANOP  ,                                                  11207600
.*----------------------------------------------------------------***   11208200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     11208800
               AIF   (N'&ALET LE 1).ZG21A       CK NUM                  11209400
&ZMS           SETC  '"ALET='    *KPOSA* MNOTE                          11210000
&ZMS           SETC  '&ZMS.&ALET"'                                      11210600
&ZMS           SETC  '&ZMS "ALET"'                                      11211200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11211800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11212400
.ZG21A         ANOP  ,                                                  11213000
.*-------------------------------------------------------------------   11213600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         11214200
&ZXALET        SETC  'INPUT'     SET IN/OUTPUT                          11214800
&XALET         SETC  '&ALET(1)'  SET XVARIABLE                          11215400
               AIF   (N'&ALET GT 1).ZG21B       MULTI PARMS             11216000
&XALET         SETC  '&ALET'     SET XVARIABLE                          11216600
.ZG21B         AIF   (K'&ALET(1) GT 0).ZG21C                            11217200
&ZXALET        SETC  ''          RESET IN/OUTPUT                        11217800
&ZMS           SETC  ' '         *KRQDA*                                11218400
&ZMS           SETC  '&ZMS "ALET" KEY AND ITS ARGUMENT'                 11219000
               MNOTE 8,' &ZMS ARE REQUIRED.'                            11219600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11220200
.ZG21C         ANOP  ,                                                  11220800
.*-------------------------------------------------------------------   11221400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    11222000
               AIF   (K'&ZXALET LE 0).ZG21R     NOT I/O                 11222600
               AIF   ('&XALET'(1,1) NE '(').ZG21R                       11223200
&ZCGPR         SETC  '&XALET'(2,K'&XALET-2)                             11223800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                       11224400
               AIF   (K'&ZCGPR GT 2).ZG21Q                              11225000
               AIF   ('&ZCGPR' EQ '0').ZG21Q                            11225600
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11226200
               AIF   (T'&ZCGPR NE 'N').ZG21Q    INVALID REG NAME        11226800
.ZG21P         ANOP  ,                                                  11227400
               AIF   (T'&ZCGPR NE 'N').ZG21R    NON NUMERIC             11228000
               AIF   ('&ZCGPR' LT '2').ZG21Q                            11228600
               AIF   ('&ZCGPR' LE '12').ZG21R                           11229200
.ZG21Q         ANOP  ,                                                  11229800
&ZMS           SETC  '"ALET='    *KGPRA* MNOTE                          11230400
&ZMS           SETC  '&ZMS.&ALET"'                                      11231000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11231600
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11232200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11232800
.ZG21R         ANOP  ,                                                  11233400
.*----------------------------------------------------------------***   11234000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     11234600
               AIF   (N'&NUMRANGE LE 1).ZG24A   CK NUM                  11235200
&ZMS           SETC  '"NUMRANGE='               *KPOSA* MNOTE           11235800
&ZMS           SETC  '&ZMS.&NUMRANGE"'                                  11236400
&ZMS           SETC  '&ZMS "NUMRANGE"'                                  11237000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11237600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11238200
.ZG24A         ANOP  ,                                                  11238800
.*-------------------------------------------------------------------   11239400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         11240000
&ZXNUMRANGE    SETC  'INPUT'     SET IN/OUTPUT                          11240600
&XNUMRANGE     SETC  '1'                                                11241200
               AIF   (K'&NUMRANGE(1) LE 0).ZG24B  PARM                  11241800
&XNUMRANGE     SETC  '&NUMRANGE(1)'             SET XVARIABLE           11242400
               AIF   (N'&NUMRANGE GT 1).ZG24B   MULTI PARMS             11243000
&XNUMRANGE     SETC  '&NUMRANGE'                SET XVARIABLE           11243600
.ZG24B         ANOP  ,                                                  11244200
.*-------------------------------------------------------------------   11244800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    11245400
               AIF   (K'&ZXNUMRANGE LE 0).ZG24R  NOT I/O                11246000
               AIF   ('&XNUMRANGE'(1,1) NE '(').ZG24R                   11246600
&ZCGPR         SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                     11247200
               AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                       11247800
               AIF   (K'&ZCGPR GT 2).ZG24Q                              11248400
               AIF   ('&ZCGPR' EQ '0').ZG24Q                            11249000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11249600
               AIF   (T'&ZCGPR NE 'N').ZG24Q    INVALID REG NAME        11250200
.ZG24P         ANOP  ,                                                  11250800
               AIF   (T'&ZCGPR NE 'N').ZG24R    NON NUMERIC             11251400
               AIF   ('&ZCGPR' LT '2').ZG24Q                            11252000
               AIF   ('&ZCGPR' LE '12').ZG24R                           11252600
.ZG24Q         ANOP  ,                                                  11253200
&ZMS           SETC  '"NUMRANGE='               *KGPRA* MNOTE           11253800
&ZMS           SETC  '&ZMS.&NUMRANGE"'                                  11254400
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11255000
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11255600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11256200
.ZG24R         ANOP  ,                                                  11256800
.*----------------------------------------------------------------***   11257400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     11258000
               AIF   (N'&RANGLIST LE 1).ZG27A   CK NUM                  11258600
&ZMS           SETC  '"RANGLIST='               *KPOSA* MNOTE           11259200
&ZMS           SETC  '&ZMS.&RANGLIST"'                                  11259800
&ZMS           SETC  '&ZMS "RANGLIST"'                                  11260400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11261000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11261600
.ZG27A         ANOP  ,                                                  11262200
.*-------------------------------------------------------------------   11262800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         11263400
&ZXRANGLIST    SETC  'INPUT'     SET IN/OUTPUT                          11264000
&XRANGLIST     SETC  '&RANGLIST(1)'             SET XVARIABLE           11264600
               AIF   (N'&RANGLIST GT 1).ZG27B   MULTI PARMS             11265200
&XRANGLIST     SETC  '&RANGLIST'                SET XVARIABLE           11265800
.ZG27B         AIF   (K'&RANGLIST(1) GT 0).ZG27C                        11266400
&ZXRANGLIST    SETC  ''          RESET IN/OUTPUT                        11267000
&ZMS           SETC  ' '         *KRQDA*                                11267600
&ZMS           SETC  '&ZMS "RANGLIST" KEY AND ITS ARGUMENT'             11268200
               MNOTE 8,' &ZMS ARE REQUIRED.'                            11268800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11269400
.ZG27C         ANOP  ,                                                  11270000
.*-------------------------------------------------------------------   11270600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    11271200
               AIF   (K'&ZXRANGLIST LE 0).ZG27R  NOT I/O                11271800
               AIF   ('&XRANGLIST'(1,1) NE '(').ZG27R                   11272400
&ZCGPR         SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                     11273000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                       11273600
               AIF   (K'&ZCGPR GT 2).ZG27Q                              11274200
               AIF   ('&ZCGPR' EQ '0').ZG27Q                            11274800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11275400
               AIF   (T'&ZCGPR NE 'N').ZG27Q    INVALID REG NAME        11276000
.ZG27P         ANOP  ,                                                  11276600
               AIF   (T'&ZCGPR NE 'N').ZG27R    NON NUMERIC             11277200
               AIF   ('&ZCGPR' LT '2').ZG27Q                            11277800
               AIF   ('&ZCGPR' LE '12').ZG27R                           11278400
.ZG27Q         ANOP  ,                                                  11279000
&ZMS           SETC  '"RANGLIST='               *KGPRA* MNOTE           11279600
&ZMS           SETC  '&ZMS.&RANGLIST"'                                  11280200
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11280800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11281400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11282000
.ZG27R         ANOP  ,                                                  11282600
.*----------------------------------------------------------------***   11283200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    11283800
               AIF   (N'&FAILBLKP LE 1).ZG30A   CK NUM                  11284400
&ZMS           SETC  '"FAILBLKP='               *KPOSA* MNOTE           11285000
&ZMS           SETC  '&ZMS.&FAILBLKP"'                                  11285600
&ZMS           SETC  '&ZMS "FAILBLKP"'                                  11286200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11286800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11287400
.ZG30A         ANOP  ,                                                  11288000
.*-------------------------------------------------------------------   11288600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        11289200
               AIF   (K'&FAILBLKP(1) LE 0).ZG30C  NO PARM               11289800
&ZXFAILBLKP    SETC  'OUTPUT'    SET OUTPUT                             11290400
&XFAILBLKP     SETC  '&FAILBLKP(1)'             SET XVARIABLE           11291000
               AIF   (N'&FAILBLKP GT 1).ZG30C                           11291600
&XFAILBLKP     SETC  '&FAILBLKP'                SET XVARIABLE           11292200
.ZG30C         ANOP  ,                                                  11292800
.*-------------------------------------------------------------------   11293400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   11294000
               AIF   (K'&ZXFAILBLKP LE 0).ZG30R  NOT I/O                11294600
               AIF   ('&XFAILBLKP'(1,1) NE '(').ZG30R                   11295200
&ZCGPR         SETC  '&XFAILBLKP'(2,K'&XFAILBLKP-2)                     11295800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG30P                       11296400
               AIF   (K'&ZCGPR GT 2).ZG30Q                              11297000
               AIF   ('&ZCGPR' EQ '0').ZG30Q                            11297600
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11298200
               AIF   (T'&ZCGPR NE 'N').ZG30Q    INVALID REG NAME        11298800
.ZG30P         ANOP  ,                                                  11299400
               AIF   (T'&ZCGPR NE 'N').ZG30R    NON NUMERIC             11300000
               AIF   ('&ZCGPR' LT '2').ZG30Q                            11300600
               AIF   ('&ZCGPR' LE '12').ZG30R                           11301200
.ZG30Q         ANOP  ,                                                  11301800
&ZMS           SETC  '"FAILBLKP='               *KGPRA* MNOTE           11302400
&ZMS           SETC  '&ZMS.&FAILBLKP"'                                  11303000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11303600
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11304200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11304800
.ZG30R         ANOP  ,                                                  11305400
.*-------------------------------------------------------------------   11306000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          11306600
.ZG32          AIF   ('&XOUTVAR1' NE 'AQUERY').ZG36                     11307200
.*-------------------------------------------------------------------   11307800
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               11308400
&ZCVAL         SETC ''           ERROR KEY FIELD                        11309000
.ZG32I0        AIF   (K'&ALET LE 0).ZG32I1                              11309600
&ZCVAL         SETC '&ZCVAL ALET'               DISALLOWED KEY          11310200
.ZG32I1        AIF   (K'&NUMRANGE LE 0).ZG32I2                          11310800
&ZCVAL         SETC '&ZCVAL NUMRANGE'           DISALLOWED KEY          11311400
.ZG32I2        AIF   (K'&RANGLIST LE 0).ZG32I3                          11312000
&ZCVAL         SETC '&ZCVAL RANGLIST'           DISALLOWED KEY          11312600
.ZG32I3        AIF   (K'&FAILBLKP LE 0).ZG32I4                          11313200
&ZCVAL         SETC '&ZCVAL FAILBLKP'           DISALLOWED KEY          11313800
.ZG32I4        AIF   (K'&ZCVAL LE 0).ZG32J      KEY                     11314400
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              11315000
&ZMS           SETC  '"AQUERY'   *KMEIA* MNOTE                          11315600
&ZMS           SETC  '&ZMS."'                                           11316200
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               11316800
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               11317400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11318000
.ZG32J         ANOP  ,                                                  11318600
.*-------------------------------------------------------------------   11319200
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                11319800
               AIF   (K'&ZXAQUERY LE 0).ZG32R   NOT I/O                 11320400
               AIF   ('&XAQUERY'(1,1) NE '(').ZG32R                     11321000
&ZCGPR         SETC  '&XAQUERY'(2,K'&XAQUERY-2)                         11321600
               AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                       11322200
               AIF   (K'&ZCGPR GT 2).ZG32Q                              11322800
               AIF   ('&ZCGPR' EQ '0').ZG32Q                            11323400
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11324000
               AIF   (T'&ZCGPR NE 'N').ZG32Q    INVALID REG NAME        11324600
.ZG32P         ANOP  ,                                                  11325200
               AIF   (T'&ZCGPR NE 'N').ZG32R    NON NUMERIC             11325800
               AIF   ('&ZCGPR' LT '2').ZG32Q                            11326400
               AIF   ('&ZCGPR' LE '12').ZG32R                           11327000
.ZG32Q         ANOP  ,                                                  11327600
&ZMS           SETC  '"AQUERY='  *KGPRA* MNOTE                          11328200
&ZMS           SETC  '&ZMS.&AQUERY"'                                    11328800
&ZMS           SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'          11329400
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11330000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11330600
.ZG32R         ANOP  ,                                                  11331200
.*-------------------------------------------------------------------   11331800
.***AG.KCK03 VALUE, RQD INPUT, ME KEYS -CHARACTER LENGTH                11332400
               AIF   (K'&ZXAQUERY LE 0).ZG32S   NOT I/O                 11333000
               AIF   (K'&XAQUERY LE 8).ZG32S    LNG OK                  11333600
&ZXAQUERY      SETC  ''          RESET IN/OUTPUT                        11334200
&ZMS           SETC  '"AQUERY='  *KLNGA* MNOTE                          11334800
&ZMS           SETC  '&ZMS.&AQUERY"'                                    11335400
&ZMS           SETC  '&ZMS ARGUMENT 0 EXCEEDS THE MAXIMUM'              11336000
               MNOTE 8,' &ZMS LENGTH OF 8 CHARACTERS.'                  11336600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11337200
.ZG32S         ANOP  ,                                                  11337800
.*----------------------------------------------------------------***   11338400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    11339000
               AIF   (N'&CROSSOVER LE 1).ZG34A  CK NUM                  11339600
&ZMS           SETC  '"CROSSOVER='              *KPOSA* MNOTE           11340200
&ZMS           SETC  '&ZMS.&CROSSOVER"'                                 11340800
&ZMS           SETC  '&ZMS "CROSSOVER"'                                 11341400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11342000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11342600
.ZG34A         ANOP  ,                                                  11343200
.*-------------------------------------------------------------------   11343800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        11344400
               AIF   (K'&CROSSOVER(1) LE 0).ZG34C  NO PARM              11345000
&ZXCROSSOVER   SETC  'OUTPUT'    SET OUTPUT                             11345600
&XCROSSOVER    SETC  '&CROSSOVER(1)'            SET XVARIABLE           11346200
               AIF   (N'&CROSSOVER GT 1).ZG34C                          11346800
&XCROSSOVER    SETC  '&CROSSOVER'               SET XVARIABLE           11347400
.ZG34C         ANOP  ,                                                  11348000
.*-------------------------------------------------------------------   11348600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   11349200
               AIF   (K'&ZXCROSSOVER LE 0).ZG34R  NOT I/O               11349800
               AIF   ('&XCROSSOVER'(1,1) NE '(').ZG34R                  11350400
&ZCGPR         SETC  '&XCROSSOVER'(2,K'&XCROSSOVER-2)                   11351000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                       11351600
               AIF   (K'&ZCGPR GT 2).ZG34Q                              11352200
               AIF   ('&ZCGPR' EQ '0').ZG34Q                            11352800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11353400
               AIF   (T'&ZCGPR NE 'N').ZG34Q    INVALID REG NAME        11354000
.ZG34P         ANOP  ,                                                  11354600
               AIF   (T'&ZCGPR NE 'N').ZG34R    NON NUMERIC             11355200
               AIF   ('&ZCGPR' LT '2').ZG34Q                            11355800
               AIF   ('&ZCGPR' LE '12').ZG34R                           11356400
.ZG34Q         ANOP  ,                                                  11357000
&ZMS           SETC  '"CROSSOVER='              *KGPRA* MNOTE           11357600
&ZMS           SETC  '&ZMS.&CROSSOVER"'                                 11358200
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11358800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11359400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11360000
.ZG34R         ANOP  ,                                                  11360600
.*-------------------------------------------------------------------   11361200
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           11361800
.ZG36          ANOP  ,           END MUTUALLY EXCLUSIVE KEYS            11362400
.*----------------------------------------------------------------***   11363000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    11363600
               AIF   (N'&RETCODE LE 1).ZG38A    CK NUM                  11364200
&ZMS           SETC  '"RETCODE='                *KPOSA* MNOTE           11364800
&ZMS           SETC  '&ZMS.&RETCODE"'                                   11365400
&ZMS           SETC  '&ZMS "RETCODE"'                                   11366000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11366600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11367200
.ZG38A         ANOP  ,                                                  11367800
.*-------------------------------------------------------------------   11368400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        11369000
               AIF   (K'&RETCODE(1) LE 0).ZG38C  NO PARM                11369600
&ZXRETCODE     SETC  'OUTPUT'    SET OUTPUT                             11370200
&XRETCODE      SETC  '&RETCODE(1)'              SET XVARIABLE           11370800
               AIF   (N'&RETCODE GT 1).ZG38C                            11371400
&XRETCODE      SETC  '&RETCODE'  SET XVARIABLE                          11372000
.ZG38C         ANOP  ,                                                  11372600
.*-------------------------------------------------------------------   11373200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   11373800
               AIF   (K'&ZXRETCODE LE 0).ZG38R  NOT I/O                 11374400
               AIF   ('&XRETCODE'(1,1) NE '(').ZG38R                    11375000
&ZCGPR         SETC  '&XRETCODE'(2,K'&XRETCODE-2)                       11375600
               AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                       11376200
               AIF   (K'&ZCGPR GT 2).ZG38Q                              11376800
               AIF   ('&ZCGPR' EQ '0').ZG38Q                            11377400
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11378000
               AIF   (T'&ZCGPR NE 'N').ZG38Q    INVALID REG NAME        11378600
.ZG38P         ANOP  ,                                                  11379200
               AIF   (T'&ZCGPR NE 'N').ZG38R    NON NUMERIC             11379800
               AIF   ('&ZCGPR' LT '2').ZG38Q                            11380400
               AIF   ('&ZCGPR' LE '12').ZG38R                           11381000
.ZG38Q         ANOP  ,                                                  11381600
&ZMS           SETC  '"RETCODE='                *KGPRA* MNOTE           11382200
&ZMS           SETC  '&ZMS.&RETCODE"'                                   11382800
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11383400
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11384000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11384600
.ZG38R         ANOP  ,                                                  11385200
.*----------------------------------------------------------------***   11385800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    11386400
               AIF   (N'&RSNCODE LE 1).ZG41A    CK NUM                  11387000
&ZMS           SETC  '"RSNCODE='                *KPOSA* MNOTE           11387600
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   11388200
&ZMS           SETC  '&ZMS "RSNCODE"'                                   11388800
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                11389400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11390000
.ZG41A         ANOP  ,                                                  11390600
.*-------------------------------------------------------------------   11391200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        11391800
               AIF   (K'&RSNCODE(1) LE 0).ZG41C  NO PARM                11392400
&ZXRSNCODE     SETC  'OUTPUT'    SET OUTPUT                             11393000
&XRSNCODE      SETC  '&RSNCODE(1)'              SET XVARIABLE           11393600
               AIF   (N'&RSNCODE GT 1).ZG41C                            11394200
&XRSNCODE      SETC  '&RSNCODE'  SET XVARIABLE                          11394800
.ZG41C         ANOP  ,                                                  11395400
.*-------------------------------------------------------------------   11396000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   11396600
               AIF   (K'&ZXRSNCODE LE 0).ZG41R  NOT I/O                 11397200
               AIF   ('&XRSNCODE'(1,1) NE '(').ZG41R                    11397800
&ZCGPR         SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                       11398400
               AIF   ('&ZCGPR'(1,1) NE '0').ZG41P                       11399000
               AIF   (K'&ZCGPR GT 2).ZG41Q                              11399600
               AIF   ('&ZCGPR' EQ '0').ZG41Q                            11400200
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      11400800
               AIF   (T'&ZCGPR NE 'N').ZG41Q    INVALID REG NAME        11401400
.ZG41P         ANOP  ,                                                  11402000
               AIF   (T'&ZCGPR NE 'N').ZG41R    NON NUMERIC             11402600
               AIF   ('&ZCGPR' LT '2').ZG41Q                            11403200
               AIF   ('&ZCGPR' LE '12').ZG41R                           11403800
.ZG41Q         ANOP  ,                                                  11404400
&ZMS           SETC  '"RSNCODE='                *KGPRA* MNOTE           11405000
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   11405600
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          11406200
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   11406800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11407400
.ZG41R         ANOP  ,                                                  11408000
.******************************************************************     11408600
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        11409200
.******************************************************************     11409800
               ACTR  10000                                              11410400
.*-------------------------------------------------------------------   11411000
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           11411600
&ZCVAL         SETC  ''          ERROR FIELD                            11412200
&ZAWRK         SETA  0           POSITIONAL COUNTER                     11412800
&ZASYSLNDX     SETA  0           NON-X KEY COUNTER                      11413400
.ZGLIST2       ANOP  ,                                                  11414000
&ZASYSLNDX     SETA  &ZASYSLNDX+1               NEXT NON-X KEY          11414600
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 11415200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          11415800
&ZAWRK         SETA  &ZAWRK+1    NEXT POSITIONAL                        11416400
               AIF   (&ZAWRK LE 0).ZGLIST2                              11417000
&ZCVAL         SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                11417600
               AGO   .ZGLIST2                                           11418200
.*                                                                      11450000
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  11464000
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)      STRIP COMMA             11478000
&ZMS           SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE           11492000
&ZMS           SETC  '&ZMS "&ZCVAL"'                                    11506000
&ZMS           SETC  '&ZMS CANNOT BE USED.'                             11520000
&ZMS           SETC  '&ZMS NO POSITIONAL ARGUMENTS'                     11534000
               MNOTE 8,' &ZMS ARE ALLOWED.'                             11548000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            11562000
.ZGLISTX       ANOP  ,                                                  11576000
&ZASYSLNDX     SETA  0                                                  11590000
.*-------------------------------------------------------------------   11604000
.***AG.MF04 MF=(SLE)                                                    11618000
.ZGMFX         ANOP  ,           END OF FULL SYNTAX CHECK               11632000
.*******************************************************************    11646000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       11660000
.*******************************************************************    11674000
               AIF   (&ZMACRET NE 0).ZLX2       ERROR DETECTED          11688000
.*******************************************************************    11702000
.***AE.01  START OF IOSADMF MACRO CODE                                  11716000
.*******************************************************************    11730000
               LCLC  &M0M0001                 NAME                      11744000
&M0M0001       SETC  '&XLABEL'                SET NAME                  11758000
               AIF   (K'&XLABEL NE 0).XLAB2                             11772000
&M0M0001       SETC  'M00M&SYSNDX'            DEFAULT NAME              11786000
.*                                                                      11800000
.XLAB2         ANOP  ,                                                  11802300
&M0M0001 DS    0H                             IOSADMF-1                 11804600
.*******************************************************************    11806900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              11809200
.*******************************************************************    11811500
              PUSH  PRINT                                               11813800
               AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON         11816100
               PRINT OFF         ++ PR01                                11818400
               AGO   .ZPRNTXX                                           11820700
.ZPRINTX       PRINT ON                                                 11823000
.ZPRNTXX       ANOP  ,                                                  11825300
.********************************************************************   11827600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     11829900
.********************************************************************   11832200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       11834500
                      LCLA  &ZOPN1         INVOCATION INDEX             11836800
                      LCLC  &ZOPL(4095)    LABEL                        11839100
                      LCLC  &ZOPO(4095)    OPERATION                    11841400
                      LCLC  &ZOPV(4095)    VALUE                        11843700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  11846000
.*                                                                      11850000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     11855500
.******************************************************************     11861000
.***AL.L10 IOSADMF FMT=LIST MF=S|L PARAMETERS                           11866500
.******************************************************************     11872000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     11877500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     11883000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     11888500
&XMFATTR              SETC  '0D'                                        11894000
.*                                                                      11900000
&ZOPN                 SETA  &ZOPN+1                                     11950000
&ZOPL(&ZOPN)          SETC  ' '                                         12000000
&ZOPO(&ZOPN)          SETC  'B'                                         12050000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                12100000
&ZOPD(&ZOPN)          SETC  '++ IOSADMF ARG PARMS'                      12150000
.*                                                                      16250000
&ZOPN                 SETA  &ZOPN+1                                     16258300
&ZOPL(&ZOPN)          SETC  ' '                                         16266600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     16274900
&ZOPV(&ZOPN)          SETC  '1'                                         16283200
&ZOPD(&ZOPN)          SETC  ' '                                         16291500
.*                                                                      16300000
.ZLMFSL2              ANOP  ,                                           16304300
.*-------------------------------------------------------------------   16308600
.***AM.L01  IOSADMF FMT=LIST PARAMETERS                                 16312900
&ZOPN                 SETA &ZOPN+1                                      16317200
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   16321500
&ZOPO(&ZOPN)          SETC 'DS'                                         16325800
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   16330100
&ZOPD(&ZOPN)          SETC '++ IOSADMF PARM LIST'                       16334400
.*-------------------------------------------------------------------   16338700
.***AM.L02 XVERSION XL1                                                 16343000
&ZOPN                 SETA &ZOPN+1                                      16347300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         16351600
&ZOPO(&ZOPN)          SETC 'DS'                                         16355900
&ZOPV(&ZOPN)          SETC 'XL1'                                        16360200
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          16364500
.*-------------------------------------------------------------------   16368800
.***AM.L03 XFLAGS BL.8                                                  16373100
&ZOPN                 SETA &ZOPN+1                                      16377400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           16381700
&ZOPO(&ZOPN)          SETC 'DS'                                         16386000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       16390300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             16394600
.*                                                                      16400000
&ZOPN                 SETA  &ZOPN+1                                     16406200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_APURGE'                  16412400
&ZOPO(&ZOPN)          SETC  'EQU'                                       16418600
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             16424800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               16431000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).APURGE'                       16437200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      16443400
.*                                                                      16450000
&ZOPN                 SETA  &ZOPN+1                                     16456200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_AREAD'                   16462400
&ZOPO(&ZOPN)          SETC  'EQU'                                       16468600
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             16474800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               16481000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).AREAD'                        16487200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      16493400
.*                                                                      16500000
&ZOPN                 SETA  &ZOPN+1                                     16550000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_AWRITE'                  16600000
&ZOPO(&ZOPN)          SETC  'EQU'                                       16650000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             16700000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               16750000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).AWRITE'                       16800000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      16850000
.*                                                                      17500000
&ZOPN                 SETA  &ZOPN+1                                     17500700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_AQUERY'                  17501400
&ZOPO(&ZOPN)          SETC  'EQU'                                       17502100
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             17502800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               17503500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).AQUERY'                       17504200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      17504900
.*-------------------------------------------------------------------   17505600
.***AM.L09  XRESERVED1 XL2                                              17506300
&ZOPN                 SETA &ZOPN+1                                      17507000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       17507700
&ZOPO(&ZOPN)          SETC 'DS'                                         17508400
&ZOPV(&ZOPN)          SETC 'XL2'                                        17509100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 17509800
.*-------------------------------------------------------------------   17510500
.***AM.L09  XALET F                                                     17511200
&ZOPN                 SETA &ZOPN+1                                      17511900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XALET'                            17512600
&ZOPO(&ZOPN)          SETC 'DS'                                         17513300
&ZOPV(&ZOPN)          SETC 'F'                                          17514000
&ZOPD(&ZOPN)          SETC '++ &ZXALET  XALET'                          17514700
.*-------------------------------------------------------------------   17515400
.***AM.L09  XNUMRANGE F                                                 17516100
&ZOPN                 SETA &ZOPN+1                                      17516800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNUMRANGE'                        17517500
&ZOPO(&ZOPN)          SETC 'DS'                                         17518200
&ZOPV(&ZOPN)          SETC 'F'                                          17518900
&ZOPD(&ZOPN)          SETC '++ &ZXNUMRANGE  XNUMRANGE'                  17519600
.*-------------------------------------------------------------------   17520300
.***AM.L09  XRANGLIST A                                                 17521000
&ZOPN                 SETA &ZOPN+1                                      17521700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRANGLIST'                        17522400
&ZOPO(&ZOPN)          SETC 'DS'                                         17523100
&ZOPV(&ZOPN)          SETC 'A'                                          17523800
&ZOPD(&ZOPN)          SETC '++ &ZXRANGLIST  XRANGLIST'                  17524500
.*-------------------------------------------------------------------   17525200
.***AM.L09  XFAILBLKP A                                                 17525900
&ZOPN                 SETA &ZOPN+1                                      17526600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFAILBLKP'                        17527300
&ZOPO(&ZOPN)          SETC 'DS'                                         17528000
&ZOPV(&ZOPN)          SETC 'A'                                          17528700
&ZOPD(&ZOPN)          SETC '++ &ZXFAILBLKP  XFAILBLKP'                  17529400
.*-------------------------------------------------------------------   17530100
.***AM.L09  XCROSSOVER F                                                17530800
&ZOPN                 SETA &ZOPN+1                                      17531500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCROSSOVER'                       17532200
&ZOPO(&ZOPN)          SETC 'DS'                                         17532900
&ZOPV(&ZOPN)          SETC 'F'                                          17533600
&ZOPD(&ZOPN)          SETC '++ &ZXCROSSOVER  XCROSSOVER'                17534300
.*-------------------------------------------------------------------   17535000
.***AM.L09  XRESERVED2 CL32                                             17535700
&ZOPN                 SETA &ZOPN+1                                      17536400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       17537100
&ZOPO(&ZOPN)          SETC 'DS'                                         17537800
&ZOPV(&ZOPN)          SETC 'CL32'                                       17538500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED2'                 17539200
.*-------------------------------------------------------------------   17539900
.***AM.L10 END OF IOSADMF LIST PARAMETERS                               17540600
&ZOPN                 SETA &ZOPN+1                                      17541300
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 17542000
&ZOPO(&ZOPN)          SETC 'EQU'                                        17542700
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 17543400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         17544100
.*                                                                      17550000
&ZOPN                 SETA &ZOPN+1                                      17577700
&ZOPL(&ZOPN)          SETC ' '                                          17605400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      17633100
&ZOPV(&ZOPN)          SETC '1'                                          17660800
&ZOPD(&ZOPN)          SETC ' '                                          17688500
.*-------------------------------------------------------------------   17716200
.***AL.L12 IOSADMF FMT=LIST MF=S|L PARAMETERS                           17743900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         17771600
.*                                                                      17800000
&ZOPN                 SETA  &ZOPN+1                                     17808300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                17816600
&ZOPO(&ZOPN)          SETC  'DC'                                        17824900
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   17833200
&ZOPD(&ZOPN)          SETC  '++ IOSADMF ARG PARMS'                      17841500
.*                                                                      17850000
.ZLMFSLX              ANOP  ,                                           17870000
.*-------------------------------------------------------------------   17890000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          17910000
&ZPLLEN               SETA 56                                           17930000
.*                                                                      17950000
.******************************************************************     17955500
.***AI.L01 IOSADMF FMT=LIST FILL IN PARAMETER AREA                      17961000
.******************************************************************     17966500
                      ACTR  10000                                       17972000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               17977500
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    17983000
&ZCVAL                SETC  'LAE'          XAX MODE                     17988500
.ZIMFXA               ANOP ,                                            17994000
.*                                                                      18000000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    18050000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         18100000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 18150000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                18200000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 18250000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                18300000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   18350000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    18400000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   18450000
&ZOPN                 SETA  &ZOPN+1                                     18500000
&ZOPL(&ZOPN)          SETC  ' '                                         18550000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    18600000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              18650000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       18700000
                      AGO   .ZIMFNX                                     18750000
.*                                                                      23000000
.ZIMFN2               ANOP ,                                            23023000
&ZOPN                 SETA  &ZOPN+1                                     23046000
&ZOPL(&ZOPN)          SETC  ' '                                         23069000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    23092000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                23115000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       23138000
.ZIMFNX               ANOP ,                                            23161000
.********************************************************************   23184000
.***AI.L02 IOSADMF FMT=LIST INITIALIZE PARAMETER AREA                   23207000
.********************************************************************   23230000
.***AI.L03 MF=(SLE)                                                     23253000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      23276000
.*                                                                      23300000
&ZOPN                 SETA  &ZOPN+1                                     23318000
&ZOPL(&ZOPN)          SETC  ' '                                         23336000
&ZOPO(&ZOPN)          SETC  'XC'                                        23354000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         23372000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             23390000
.ZIMFLX               ANOP  ,                                           23408000
.*-------------------------------------------------------------------   23426000
.***AI.L04A XVERSION XL1                                                23444000
&ZOPN                 SETA  &ZOPN+1                                     23462000
&ZOPL(&ZOPN)          SETC  ' '                                         23480000
&ZOPO(&ZOPN)          SETC  'MVI'                                       23498000
&ZOPV(&ZOPN)          SETC  '0(1),1'                                    23516000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     23534000
.*-------------------------------------------------------------------   23552000
.***AI.L05 XFLAGS BL1                                                   23570000
&ZW                   SETC  ''                                          23588000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            23606000
.*-------------------------------------------------------------------   23624000
.***AI.L08 XFLAGS "APURGE"                                              23642000
.***      BL1'1XXXXXXX'                                                 23660000
         AIF   ('&XAPURGE' EQ '').ZI3A                                  23678000
&ZW                   SETC  '&ZW.1'                                     23696000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              23714000
                      AGO   .ZI3C                                       23732000
.*                                                                      23750000
.ZI3A                 ANOP  ,                                           23759000
&ZW                   SETC  '&ZW.0'                                     23768000
.ZI3C                 ANOP  ,                                           23777000
.*-------------------------------------------------------------------   23786000
.***AI.L08 XFLAGS "AREAD"                                               23795000
.***      BL1'X1XXXXXX'                                                 23804000
         AIF   ('&XAREAD' EQ '').ZI4A                                   23813000
&ZW                   SETC  '&ZW.1'                                     23822000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              23831000
                      AGO   .ZI4C                                       23840000
.*                                                                      23850000
.ZI4A                 ANOP  ,                                           23890900
&ZW                   SETC  '&ZW.0'                                     23931800
.ZI4C                 ANOP  ,                                           23972700
.*-------------------------------------------------------------------   24013600
.***AI.L08 XFLAGS "AWRITE"                                              24054500
.***      BL1'XX1XXXXX'                                                 24095400
         AIF   ('&XAWRITE' EQ '').ZI5A                                  24136300
&ZW                   SETC  '&ZW.1'                                     24177200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              24218100
                      AGO   .ZI5C                                       24259000
.*                                                                      24300000
.ZI5A                 ANOP  ,                                           24322700
&ZW                   SETC  '&ZW.0'                                     24345400
.ZI5C                 ANOP  ,                                           24368100
.*-------------------------------------------------------------------   24390800
.***AI.L08 XFLAGS "AQUERY"                                              24413500
.***      BL1'XXXX1XXX'                                                 24436200
         AIF   ('&XAQUERY' EQ '').ZI6A                                  24458900
&ZW                   SETC  '&ZW.01000'                                 24481600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              24504300
                      AGO   .ZI6C                                       24527000
.*                                                                      24550000
.ZI6A                 ANOP  ,                                           24555500
&ZW                   SETC  '&ZW.00000'                                 24561000
.ZI6C                 ANOP  ,                                           24566500
.*-------------------------------------------------------------------   24572000
.***AI.L11 XFLAGS BL1                                                   24577500
                      AIF   ('&ZCLNG' NE 'YES').ZI6E  ALL ZERO BITS     24583000
&ZOPN                 SETA  &ZOPN+1                                     24588500
&ZOPL(&ZOPN)          SETC  ' '                                         24594000
&ZOPO(&ZOPN)          SETC  'OI'                                        24599500
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             24605000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              24610500
.ZI6E                 ANOP  ,                                           24616000
.*-------------------------------------------------------------------   24621500
.***AI.L25  XALET F                                                     24627000
                      AIF   ('&ZXALET' EQ '').ZI8E  NOT USED            24632500
                      AIF   ('&ZXALET' EQ 'OUTPUT').ZI8E                24638000
&ZCGPR                SETC  '&XALET'                                    24643500
.*                                                                      24650000
                      AIF   ('&XALET'(1,1) NE '(').ZI8B                 24700000
&ZCGPR   SETC  '0('.'&XALET'(2,K'&XALET-2).')'                          24750000
                      AGO   .ZI8D                                       24800000
.ZI8B                 ANOP  ,                                           24850000
.*                                                                      25100000
&ZC                   SETC  '&XALET'(1,1)                               25141600
                      AIF   (T'&ZC NE 'N').ZI8D                         25183200
&ZC                   SETC  '&XALET'                                    25224800
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI8D            25266400
&ZCGPR                SETC  '=FL4''&XALET'''                            25308000
.*                                                                      25350000
.ZI8D                 ANOP  ,                                           25400000
.*                                                                      25500000
&ZOPN                 SETA  &ZOPN+1                                     25550000
&ZOPL(&ZOPN)          SETC  ' '                                         25600000
&ZOPO(&ZOPN)          SETC  'MVC'                                       25650000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             25700000
&ZOPD(&ZOPN)          SETC  '++ &ZXALET XALET F'                        25750000
.*                                                                      25950000
.ZI8E                 ANOP  ,                                           26000000
.*-------------------------------------------------------------------   26050000
.***AI.L25  XNUMRANGE F                                                 26100000
                      AIF   ('&ZXNUMRANGE' EQ '').ZI9E  NOT USED        26150000
                      AIF   ('&ZXNUMRANGE' EQ 'OUTPUT').ZI9E            26200000
&ZCGPR                SETC  '&XNUMRANGE'                                26250000
.*                                                                      26550000
                      AIF   ('&XNUMRANGE'(1,1) NE '(').ZI9B             26580000
&ZCGPR   SETC  '0('.'&XNUMRANGE'(2,K'&XNUMRANGE-2).')'                  26610000
                      AGO   .ZI9D                                       26640000
.ZI9B                 ANOP  ,                                           26670000
.*                                                                      26700000
&ZC                   SETC  '&XNUMRANGE'(1,1)                           26708300
                      AIF   (T'&ZC NE 'N').ZI9D                         26716600
&ZC                   SETC  '&XNUMRANGE'                                26724900
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI9D            26733200
&ZCGPR                SETC  '=FL4''&XNUMRANGE'''                        26741500
.*                                                                      26750000
.ZI9D                 ANOP  ,                                           26800000
.*                                                                      27150000
&ZOPN                 SETA  &ZOPN+1                                     27175000
&ZOPL(&ZOPN)          SETC  ' '                                         27200000
&ZOPO(&ZOPN)          SETC  'MVC'                                       27225000
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             27250000
&ZOPD(&ZOPN)          SETC  '++ &ZXNUMRANGE XNUMRANGE F'                27275000
.*                                                                      27300000
.ZI9E                 ANOP  ,                                           27342800
.*-------------------------------------------------------------------   27385600
.***AI.L25  XRANGLIST AL4                                               27428400
                      AIF   ('&ZXRANGLIST' EQ '').ZI10E  NOT USED       27471200
                      AIF   ('&ZXRANGLIST' EQ 'OUTPUT').ZI10E           27514000
&ZCGPR                SETC  '&XRANGLIST'                                27556800
.*                                                                      27600000
                      AIF   ('&XRANGLIST'(1,1) NE '(').ZI10B            27650000
&ZCGPR   SETC  '0('.'&XRANGLIST'(2,K'&XRANGLIST-2).')'                  27700000
                      AGO   .ZI10D                                      27750000
.ZI10B                ANOP  ,                                           27800000
.*                                                                      27850000
&ZC                   SETC  '&XRANGLIST'(1,1)                           27875000
                      AIF   (T'&ZC NE 'N').ZI10D                        27900000
&ZC                   SETC  '&XRANGLIST'                                27925000
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI10D           27950000
&ZCGPR                SETC  '=AL4(&XRANGLIST)'                          27975000
.*                                                                      28000000
.ZI10D                ANOP  ,                                           28050000
.*                                                                      28150000
&ZOPN                 SETA  &ZOPN+1                                     28200000
&ZOPL(&ZOPN)          SETC  ' '                                         28250000
&ZOPO(&ZOPN)          SETC  'MVC'                                       28300000
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            28350000
&ZOPD(&ZOPN)          SETC  '++ &ZXRANGLIST XRANGLIST AL4'              28400000
.*                                                                      28500000
.ZI10E                ANOP  ,                                           28512500
.*-------------------------------------------------------------------   28525000
&ZOPN1                SETA &ZOPN                                        28537500
.*******************************************************************    28550000
.***  PROCESS IOSADMF OUTPUT PARAMETERS                                 28562500
.*******************************************************************    28575000
                      ACTR  10000                                       28587500
.*------------------------------------------------------------------    28600000
.***AO.L02 XFAILBLKP A                                                  28612500
         AIF   ('&ZXFAILBLKP' EQ 'OUTPUT').ZO11A  OUTPUT                28625000
         AIF   ('&ZXFAILBLKP' NE 'INOUT').ZO11C  INOUT                  28637500
.ZO11A    AIF   ('&XFAILBLKP'(1,1) NE '(').ZO11B  ADDR IN GPR           28650000
&ZCGPR   SETC  '&XFAILBLKP'(2,K'&XFAILBLKP-2)                           28662500
&ZOPN                 SETA  &ZOPN+1                                     28675000
&ZOPL(&ZOPN)          SETC  ' '                                         28687500
&ZOPO(&ZOPN)          SETC  'MVC'                                       28700000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),16(1)'                         28712500
&ZOPD(&ZOPN)          SETC  '++ XFAILBLKP A'                            28725000
                      AGO   .ZO11C                                      28737500
.*                                                                      28750000
.ZO11B                ANOP  ,                                           28754200
&ZAWRK   SETA  K'&XFAILBLKP                                             28758400
         AIF   ('&XFAILBLKP'(&ZAWRK,1) NE ')').ZO11G                    28762600
&ZN      SETA  2                                                        28766800
.ZO11H    ANOP                                                          28771000
         AIF   (&ZN GE &ZAWRK).ZO11G                                    28775200
         AIF   ('&XFAILBLKP'(&ZN,1) NE '(').ZO11I                       28779400
&ZC      SETC  '&XFAILBLKP'(1,&ZN).'4'.','                              28783600
&ZC      SETC  '&ZC'.'&XFAILBLKP'(&ZN+1,&ZAWRK-&ZN).',16(1)'            28787800
         AGO   .ZO11J                                                   28792000
.ZO11I    ANOP                                                          28796200
&ZN      SETA  &ZN+1                                                    28800400
         AGO   .ZO11H                                                   28804600
.ZO11G    ANOP                                                          28808800
&ZC      SETC  '&XFAILBLKP.(4),16(1)'                                   28813000
.ZO11J    ANOP                                                          28817200
&ZOPN                 SETA  &ZOPN+1                                     28821400
&ZOPL(&ZOPN)          SETC  ' '                                         28825600
&ZOPO(&ZOPN)          SETC  'MVC'                                       28829800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       28834000
&ZOPD(&ZOPN)          SETC  '++ XFAILBLKP A'                            28838200
.ZO11C                ANOP  ,                                           28842400
.*------------------------------------------------------------------    28846600
.***AO.L02 XCROSSOVER F                                                 28850800
         AIF   ('&ZXCROSSOVER' EQ 'OUTPUT').ZO12A  OUTPUT               28855000
         AIF   ('&ZXCROSSOVER' NE 'INOUT').ZO12C  INOUT                 28859200
.ZO12A    AIF   ('&XCROSSOVER'(1,1) NE '(').ZO12B  ADDR IN GPR          28863400
&ZCGPR   SETC  '&XCROSSOVER'(2,K'&XCROSSOVER-2)                         28867600
&ZOPN                 SETA  &ZOPN+1                                     28871800
&ZOPL(&ZOPN)          SETC  ' '                                         28876000
&ZOPO(&ZOPN)          SETC  'MVC'                                       28880200
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),20(1)'                         28884400
&ZOPD(&ZOPN)          SETC  '++ XCROSSOVER F'                           28888600
                      AGO   .ZO12C                                      28892800
.*                                                                      28900000
.ZO12B                ANOP  ,                                           28905200
&ZAWRK   SETA  K'&XCROSSOVER                                            28910400
         AIF   ('&XCROSSOVER'(&ZAWRK,1) NE ')').ZO12G                   28915600
&ZN      SETA  2                                                        28920800
.ZO12H    ANOP                                                          28926000
         AIF   (&ZN GE &ZAWRK).ZO12G                                    28931200
         AIF   ('&XCROSSOVER'(&ZN,1) NE '(').ZO12I                      28936400
&ZC      SETC  '&XCROSSOVER'(1,&ZN).'4'.','                             28941600
&ZC      SETC  '&ZC'.'&XCROSSOVER'(&ZN+1,&ZAWRK-&ZN).',20(1)'           28946800
         AGO   .ZO12J                                                   28952000
.ZO12I    ANOP                                                          28957200
&ZN      SETA  &ZN+1                                                    28962400
         AGO   .ZO12H                                                   28967600
.ZO12G    ANOP                                                          28972800
&ZC      SETC  '&XCROSSOVER.(4),20(1)'                                  28978000
.ZO12J    ANOP                                                          28983200
&ZOPN                 SETA  &ZOPN+1                                     28988400
&ZOPL(&ZOPN)          SETC  ' '                                         28993600
&ZOPO(&ZOPN)          SETC  'MVC'                                       28998800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       29004000
&ZOPD(&ZOPN)          SETC  '++ XCROSSOVER F'                           29009200
.ZO12C                ANOP  ,                                           29014400
.*******************************************************************    29019600
.***AO.X02  RETURN CODE PROCESSING                                      29024800
.*******************************************************************    29030000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    29035200
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            29040400
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             29045600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             29050800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               29056000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                29061200
&ZOPN                 SETA  &ZOPN+1                                     29066400
&ZOPL(&ZOPN)          SETC  ' '                                         29071600
&ZOPO(&ZOPN)          SETC  'ST'                                        29076800
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              29082000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        29087200
                      AGO   .ZMRETX                                     29092400
.*                                                                      29100000
.ZMRET2               ANOP  ,                                           29108000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                29116000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                29124000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                29132000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  29140000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   29148000
&ZOPN                 SETA  &ZOPN+1                                     29156000
&ZOPL(&ZOPN)          SETC  ' '                                         29164000
&ZOPO(&ZOPN)          SETC  'LR'                                        29172000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 29180000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        29188000
.ZMRETX               ANOP  ,                                           29196000
.*******************************************************************    29204000
.***AO.X03  REASON CODE PROCESSING                                      29212000
.*******************************************************************    29220000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    29228000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            29236000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              29244000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             29252000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              29260000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             29268000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                29276000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 29284000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                29292000
&ZOPN                 SETA  &ZOPN+1                                     29300000
&ZOPL(&ZOPN)          SETC  ' '                                         29308000
&ZOPO(&ZOPN)          SETC  'ST'                                        29316000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               29324000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        29332000
                      AGO   .ZMRSNX                                     29340000
.*                                                                      29350000
.ZMRSN2               ANOP  ,                                           29360400
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                29370800
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 29381200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                29391600
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 29402000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                29412400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   29422800
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    29433200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   29443600
&ZOPN                 SETA  &ZOPN+1                                     29454000
&ZOPL(&ZOPN)          SETC  ' '                                         29464400
&ZOPO(&ZOPN)          SETC  'LR'                                        29474800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  29485200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        29495600
.ZMRSNX               ANOP  ,                                           29506000
.*******************************************************************    29516400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   29526800
.*******************************************************************    29537200
.ZMFLX                ANOP  ,              MF=L PROCESSING              29547600
.*******************************************************************    29558000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               29568400
.*******************************************************************    29578800
                      ACTR  10000                                       29589200
.*                                                                      29600000
                      LCLA  &ZLC           COLUMN POSITION              29650000
                      LCLA  &ZOPX          LIST TABLE INDEX             29700000
                      LCLC  &ZLL           LABEL                        29750000
                      LCLC  &ZLOP          OPERATION                    29800000
                      LCLC  &ZLV           VALUE                        29850000
                      LCLC  &ZLD           DESCRIPTION                  29900000
.*                                                                      30000000
&ZOPX                 SETA  1                                           30003500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            30007000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              30010500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              30014000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              30017500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              30021000
                      AIF   (K'&ZLD LE 0).ZL5                           30024500
&ZLC                  SETA  35             COMMENT COLUMN               30028000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    30031500
&ZLC                  SETA  33             COMMMENT COLUMN              30035000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   30038500
&ZLV                  SETC  '&ZLV'.' '                                  30042000
                      AGO   .ZL3                                        30045500
.*                                                                      30050000
.ZL4                  ANOP  ,                                           30090000
&ZLV                  SETC  '&ZLV'.' '                                  30130000
.ZL5                  ANOP  ,                                           30170000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               30210000
.*                                                                      30250000
&ZLL     &ZLOP &ZLV                                                     30300000
.*                                                                      30700000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               30716600
                      AGO   .ZL2           CONTINUE LOOPING             30733200
.*                                                                      30750000
.ZLX                  ANOP  ,                                           30800000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                30850000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  30900000
         L     14,16(0,0)         ++ GET CVT ADDRESS                    43850000
         L     14,772(14,0)       ++ GET SFT ADDRESS                    43900000
.*********************************************************************  43950000
.*                                                                   *  44000000
.*  Get LX/EX for ADMF Services                                      *  44050000
.*                                                                   *  44100000
.*  Note: LX/EX is calculated by multiplying the PC number (99)      *  44150000
.*        times the length of a PC/AUTH table entry (4) and          *  44200000
.*        then subtracting 4.                                        *  44250000
.*                                                                   *  44300000
.*********************************************************************  44350000
         L     14,392(14,0)       ++ GET LX/EX FOR ADMF SERVICES        44400000
         PC    0(14)              ++ PC TO ADMF SERVICES                44450000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  44500000
.ZLINKX               ANOP  ,                                           44550000
.*******************************************************************    44600000
.***AP.X01  FORMAT GENERATED CODE                                       44650000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            44700000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              44750000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              44800000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              44850000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              44900000
                      AIF   (K'&ZLD LE 0).ZL51                          44950000
&ZLC                  SETA  35             COMMENT COLUMN               45000000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   45050000
&ZLC                  SETA  33             COMMENT COLUMN               45100000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  45150000
&ZLV                  SETC  '&ZLV'.' '                                  45200000
                      AGO   .ZL31                                       45250000
.*                                                                      47150000
.ZL41                 ANOP  ,                                           47160000
&ZLV                  SETC  '&ZLV'.' '                                  47170000
.ZL51                 ANOP  ,                                           47180000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               47190000
.*                                                                      47200000
&ZLL     &ZLOP &ZLV                                                     47250000
.*                                                                      47300000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               47350000
                      AGO   .ZL21          CONTINUE LOOPING             47400000
.*                                                                      47450000
.ZLX1                 ANOP  ,                                           47500000
.*******************************************************************    47550000
.***AP.X02  END OF IOSADMF MACRO                                        47600000
&ZIOSADMF             SETC  'YES'          SET IOSADMF USED             47650000
         POP   PRINT                                                    47700000
*                                            IOSADMF-1                  47750000
         SPACE 1                                                        47800000
.ZLX2                 ANOP  ,                                           47850000
         MEND                                                           47900000
**********************************************************************/ 47950000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  48000000
*%IOSADMF: MACRO KEYS(APURGE,ALET,AREAD,NUMRANGE,RANGLIST,FAILBLKP,     48050000
*                 AWRITE,AQUERY,CROSSOVER,RETCODE,RSNCODE,MF);          48100000
*  ANS('?'||MACLABEL||' '||'IOSADMFP '||MACLIST||                       48150000
*         ' '||MACKEYS||';') COL(MACLMAR);                              48200000
*%END IOSADMF;                                                          48250000
