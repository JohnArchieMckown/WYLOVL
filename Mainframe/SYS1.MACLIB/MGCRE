*/*                                                                     00050000
         MACRO                                                          00100000
&NAME    MGCRE &MF=^,&TEXT=^,&CMDFLAG=^,&CONSID=^,&CONSNAME=^,         X00150000
               &TOKEN=^,&CART=^,&UTOKEN=^                          @D1C 00200000
.*********************************************************************  00250000
.*                                                                   *  00300000
.*01* MACRO NAME = MGCRE                                             *  00350000
.*                                                                   *  00400000
.*01* DESCRIPTIVE NAME = MGCRE MACRO                                 *  00450000
.*                                                                   *  00500000
.*01* COPYRIGHT =                                                    *  00550000
.*                5655-068                                           *  00600000
.*                THIS MODULE IS "RESTRICTED MATERIALS OF IBM"       *  00650000
.*                (C) COPYRIGHT IBM CORP. 1990                       *  00700000
.*                LICENSED MATERIALS - PROPERTY OF IBM               *  00750000
.*                                                                   *  00800000
.*01* STATUS    = HBB4410                                            *  00850000
.*                                                                   *  00900000
.*01* FUNCTION  =                                                    *  00950000
.*                                                                   *  01000000
.*       THE MGCRE MACRO IS USED TO BUILD A PARAMETER LIST           *  01050000
.*       FOR SVC 34 COMMAND PROCESSING.                              *  01100000
.*                                                                   *  01150000
.*                                                                   *  01200000
.*02* OPERATION =                                                    *  01250000
.*                                                                   *  01300000
.*       MGCRE AS AN INTERFACE FOR SVC 34 COMMANDS WILL:             *  01350000
.*         - BUILD THE MGCRE PARAMETER LIST WITH THE PARAMETERS      *  01400000
.*           SUPPLIED BY THE ISSUER                                  *  01450000
.*         - PLACE THE ADDRESS OF THE PARAMETER LIST INTO REGISTER 1 *  01500000
.*         - ISSUE SVC 34                                            *  01550000
.*                                                                   *  01600000
.*01* USAGE     =                                                    *  01650000
.*                                                                   *  01700000
.*       THIS MACRO MAY BE USED BY AUTHORIZED USERS TO BUILD THE     *  01750000
.*       MGCRE PARAMETER LIST AND ISSUE SVC 34.                      *  01800000
.*                                                                   *  01850000
.*01* INVOCATION =                                                   *  01900000
.*                                                                   *  01950000
.*     SPECIFY:     MGCRE  TEXT=,CMDFLAG=,CONSID=,CONSNAME=,         *  02000000
.*                         TOKEN=,MF=,CART=,UTOKEN=               @D1C  02050000
.*                                                                   *  02100000
.*                                                                   *  02150000
.*     WHERE:       TEXT     = POINTER TO A DATA AREA CONTAINING     *  02200000
.*                             THE 2-BYTE COMMAND TEXT LENGTH        *  02250000
.*                             IMMEDIATELY FOLLOWED BY THE COMMAND   *  02300000
.*                             TEXT.  IF A REGISTER IS USED, IT      *  02350000
.*                             CONTAINS THE ADDRESS OF A DATA        *  02400000
.*                             AREA CONTAINING THE COMMAND TEXT      *  02450000
.*                             LENGTH FOLLOWED BY THE COMMAND TEXT.  *  02500000
.*                             THE MAXIMUM LENGTH OF THE TEXT IS     *  02550000
.*                             126 CHARACTERS.                       *  02600000
.*                                                                   *  02650000
.*                  CMDFLAG  = THIS FIELD IS OPTIONAL. VALID         *  02700000
.*                             VALUES ARE:                           *  02750000
.*                             COMMTASK - COMMAND WAS RE-ISSUED      *  02800000
.*                                        INTERNALLY BY IEAVC700     *  02850000
.*                                        (COMM TASK COMMAND QUEUER).*  02900000
.*                                        THIS OPERAND IS MUTUALLY   *  02950000
.*                                        EXCLUSIVE WITH SUBSYS.     *  03000000
.*                                                                   *  03050000
.*                             SUBSYS   - COMMAND WAS ISSUED BY A    *  03100000
.*                                        SUBSYSTEM OUT OF THE SSI.  *  03150000
.*                                        THIS OPERAND IS MUTUALLY   *  03200000
.*                                        EXCLUSIVE WITH COMMTASK.   *  03250000
.*                                                                   *  03300000
.*                             NOHCPY   - COMMAND IS NOT TO BE       *  03350000
.*                                        HARDCOPIED.                *  03400000
.*                                                                   *  03450000
.*                  CONSID   = CONTAINS 4-BYTE CONSOLE ID OF THE     *  03500000
.*                             CONSOLE ISSUING THE COMMAND. IF A     *  03550000
.*                             REGISTER IS USED, IT CONTAINS A       *  03600000
.*                             4-BYTE CONSOLE ID. THIS KEYWORD IS    *  03650000
.*                             MUTUALLY EXCLUSIVE WITH CONSNAME.     *  03700000
.*                                                                   *  03750000
.*                  CONSNAME = CONTAINS A 2-8 CHARACTER CONSOLE      *  03800000
.*                             NAME, LEFT JUSTIFIED AND PADDED       *  03850000
.*                             WITH BLANKS. IF A REGISTER IS USED,   *  03900000
.*                             IT CONTAINS THE ADDRESS OF AN         *  03950000
.*                             8-BYTE FIELD CONTAINING THE 2-8       *  04000000
.*                             CHARACTER CONSOLE NAME.  THIS KEYWORD *  04050000
.*                             IS MUTUALLY EXCLUSIVE WITH CONSID.    *  04100000
.*                                                                   *  04150000
.*                  TOKEN      CONTAINS A 31-BIT RIGHT            @01C  04173600
.*                             JUSTIFIED TOKEN THAT IS            @01C  04197200
.*                             ASSOCIATED WITH THIS COMMAND. IF   @01C  04220800
.*                             A REGISTER IS USED, THE REGISTER   @01C  04244400
.*                             WILL CONTAIN A 31-BIT RIGHT        @01A  04268000
.*                             JUSTIFIED TOKEN.  THIS FIELD IS    @01A  04291600
.*                             OPTIONAL.                          @01A  04315200
.*                                                                *     04338800
.*                  CART     = CONTAINS THE                       @03C  04354000
.*                             8-BYTE COMMAND AND RESPONSE TOKEN  @L1A  04369300
.*                             (CART).  IF A REGISTER IS USED, IT @L1A  04375400
.*                             SPECIFIES A 31-BIT ADDRESS         @L1A  04381500
.*                             POINTER TO THE CART.  THIS FIELD   @L1A  04387600
.*                             IS OPTIONAL.                       @L1A  04393700
.*                                                                   *  04400000
.*                  UTOKEN   = POINTER TO A DATA AREA CONTAINING  @D1A  04405500
.*                             A SECURITY TOKEN (UTOKEN).         @D1A  04411000
.*                             IT IS USED IN SVC 34 PROCESSING    @D1A  04416500
.*                             TO CHECK THE ISSUER'S AUTHORITY.   @D1A  04422000
.*                             IF A REGISTER IS USED, IT          @D1A  04427500
.*                             CONTAINS THE ADDRESS OF A DATA     @D1A  04433000
.*                             AREA CONTAINING THE UTOKEN.        @D1A  04438500
.*                             THIS FIELD IS OPTIONAL.            @D1A  04441200
.*                                                                @D1A  04444000
.*                  MF       = SPECIFIES THE TYPE OF EXPANSION       *  04450000
.*                             THAT IS REQUIRED.  VALID VALUES       *  04500000
.*                             ARE: E OR L.                          *  04550000
.*                                                                   *  04600000
.*01* DEPENDENCIES    = NONE                                         *  04650000
.*                                                                   *  04700000
.*01* CHANGE ACTIVITY =                                              *  04750000
.*      $L0 = CNMGEMG, HBB4410, 870424, PDU9: CONSOLE MERGE STAGE II *  04770000
.*      $L1 = TSOOP,   HBB4410, 870831, PDDI: TSO OPERATOR           *  04790000
.*      $L2 = TSOOP7CW HBB4410, 880420, PDCW: TSO OPERATOR           *  04810000
.*      $D1 = DCR238,  HBB4410, 890814, PDEF: SP410 BARLOW SUPPORT   *  04830000
.*      $01 = OY38182, HBB4410, 910110, PDHE: DEFINE TOKEN AS 31-BIT *  04836600
.*                                            TO MATCH MGCR          *  04843200
.*      $02 = OY60067, HBB4410, 930107, PDCM: UTOKEN REGISTER VALUE  *  04846600
.*      $03 = OW13765, HBB5510, 950731, PDHL: FIX COMMENTS           *  04848300
.*                                                                   *  04850000
.*01* MACROS          = THE PARAMETER LIST GENERATED BY THIS MACRO   *  04900000
.*                      IS MAPPED BY IEZMGCRE.  HOWEVER, IEZMGCRE    *  04950000
.*                      NOT REQUIRED TO USE THIS MACRO.              *  05000000
.*                                                                   *  05050000
.*01* MESSAGES =  THE MGCRE MACRO WILL ISSUE THE FOLLOWING           *  05100000
.*                MNOTES UPON THE DETECTION OF SYNTAX ERRORS:        *  05150000
.*                                                                   *  05200000
.*                                                                   *  05250000
.*02*  WARNING = (SEVERITY 4)                                        *  05300000
.*                                                                   *  05350000
.*         CMDFLAG KEYWORD IGNORED.  'FFFFFFFF' VALUE IS NOT         *  05400000
.*          VALID.                                                   *  05450000
.*                                                                   *  05500000
.*         'KKKKKKKK' KEYWORD IGNORED.  NO DATA SPECIFIED.           *  05550000
.*                                                                   *  05600000
.*         'KKKKKKKK' DATA IGNORED.  NO KEYWORDS PERMITTED ON THE    *  05650000
.*           LIST FORM OF MGCRE.                                     *  05700000
.*                                                                   *  05750000
.*          KKKKKKKK(X,Y) HAS TOO MANY ARGUMENTS. ARGUMENTS          *  05800000
.*           IGNORED AFTER X.                                        *  05850000
.*                                                                   *  05900000
.*          KKKKKKKK(X,Y,Z) HAS TOO MANY ARGUMENTS. ARGUMENTS        *  05950000
.*           IGNORED AFTER Z.                                        *  06000000
.*                                                                   *  06050000
.*                                                                   *  06100000
.*                                                                   *  06150000
.*     WHERE:  'FFFFFFFF' IS NOT COMMTASK, SUBSYS, OR NOHCPY         *  06200000
.*             'KKKKKKKK' MAY BE CONSID, CONSNAME, TOKEN, TEXT,      *  06250000
.*             CMDFLAG, OR UTOKEN                                 @D1C  06300000
.*             X, Y, AND Z ARE ARBITRARY ARGUMENTS                   *  06350000
.*                                                                   *  06400000
.*02*  ERROR = (SEVERITY 12)                                         *  06450000
.*                                                                   *  06500000
.*         NO TEXT GENERATED. 'MF' VALUE IS NOT VALID.               *  06550000
.*                                                                   *  06600000
.*         NO TEXT GENERATED. 'MF' VALUE IS NOT SPECIFIED.           *  06650000
.*                                                                   *  06700000
.*         NO TEXT GENERATED. 'TEXT' VALUE IS REQUIRED BUT NOT       *  06750000
.*          SUPPLIED.                                                *  06800000
.*                                                                   *  06850000
.*         NO TEXT GENERATED.  'CMDFLAG=SUBSYS' IS MUTUALLY          *  06900000
.*          EXCLUSIVE WITH 'CMDFLAG=COMMTASK'.                       *  06950000
.*                                                                   *  07000000
.*         NO TEXT GENERATED.  'CONSNAME' IS MUTUALLY EXCLUSIVE      *  07050000
.*          WITH 'CONSID'.                                           *  07100000
.*                                                                   *  07150000
.*         NO TEXT GENERATED.  CONSID OR CONSNAME IS REQUIRED        *  07200000
.*          BUT NOT SUPPLIED.                                        *  07250000
.*                                                                   *  07300000
.*                                                                   *  07325000
.*01* ABEND CODES    = NONE                                          *  07350000
.*                                                                   *  07400000
.*********************************************************************  07450000
.*                                                                   *  07500000
.*********************************************************************  07550000
.*       L O C A L  D E C L A R A T I O N S                          *  07600000
.*********************************************************************  07650000
         LCLA  &CNT                     COUNTER FOR COMMAND FLAGS       07700000
         LCLA  &I                       COUNTER FOR GENERATING PARMLIST 07725000
         LCLA  &INDX                    COUNTER FOR CLEARING FLAG  @L1A 07750000
         LCLA  &FLG2VAL                 ACCUMULATOR VALUE          @L1A 07775000
         LCLB  &IDSPEC                  CONSOLE ID SPECIFIED            07800000
         LCLB  &NMSPEC                  CONSOLE NAME SPECIFIED          07850000
         LCLB  &FLG(8)                  COMMAND FLAGS                   07900000
         LCLB  &FLG2(8)                 COMMAND FLAG - BYTE 2           07925000
         LCLB  &TEXTOK                  TEXT VALUE SPECIFIED CORRECTLY  07950000
         LCLB  &CIDOK                   CONSID VALUE SPECIFIED         X08000000
                                        CORRECTLY                       08050000
         LCLB  &CNMEOK                  CONSNAME VALUE SPECIFIED       X08100000
                                        CORRECTLY                       08150000
         LCLB  &FLGSOK                  CMDFLAG VALUES SPECIFIED       X08200000
                                        CORRECTLY                       08250000
         LCLB  &TKNOK                   TOKEN VALUE SPECIFIED CORRECTLY 08300000
         LCLB  &CARTOK                  CART VALUE SPECIFIED       @L1AX08316600
                                        CORRECTLY                  @L1A 08333200
         LCLB  &UTKNOK                  UTOKEN VALUE SPECIFIED     @D1AX08336500
                                        CORRECTLY                  @D1A 08339800
         LCLB  &FLGS2OK                 CMDFLAG VALUES SPECIFIED       X08343100
                                        CORRECTLY                  @D1A 08346400
         LCLC  &GNAME                   LOCAL NAME USED FOR BRANCHS     08350000
.*********************************************************************  08400000
         ACTR  30000                                                    08450000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          08500000
.*********************************************************************  08550000
.*       I N I T I A L I Z E  V A R I A B L E S                      *  08600000
.*********************************************************************  08650000
&CNT     SETA  0                        INITIALIZE COUNTER TO ZERO      08700000
&FLG2VAL SETA  0                        INITIALIZE FLAGS VALUE TO ZERO  08725000
&IDSPEC  SETB  0                        INDICATE CONSID NOT SPECIFIED   08750000
&NMSPEC  SETB  0                        INDICATE CONSNAME NOT SPECIFIED 08800000
&TEXTOK  SETB  0                        USED TO VERIFY THAT TEXT VALUE X08850000
                                        WAS SPECIFIED CORRECTLY         08900000
&CIDOK   SETB  0                        USED TO VERIFY THAT CONSID     X08950000
                                        VALUE WAS SPECIFIED CORRECTLY   09000000
&CNMEOK  SETB  0                        USED TO VERIFY THAT CONSNAME   X09050000
                                        VALUE WAS SPECIFIED CORRECTLY   09100000
&FLGSOK  SETB  0                        USED TO VERIFY THAT CMDFLAG    X09150000
                                        VALUE WAS SPECIFIED CORRECTLY   09200000
&TKNOK   SETB  0                        USED TO VERIFY THAT TOKEN      X09250000
                                        VALUE WAS SPECIFIED CORRECTLY   09300000
&CARTOK  SETB  0                        USED TO VERIFY THAT CART   @L1AX09316600
                                        VALUE WAS SPEC'ED CORRECTLY@L1A 09333200
&UTKNOK  SETB  0                        USED TO VERIFY THAT UTOKEN     X09333500
                                        VALUE WAS SPEC'D CORRECTLY @D1A 09333800
&FLGS2OK SETB  0                        USED TO VERIFY THAT CMDFLAG    X09334100
                                        VALUE WAS SPEC'D CORRECTLY @D1A 09334400
.*-------------------------------------------------------*.        @L1A 09334800
.*       INITIALIZE FLAGS FOR FLAG BYTE 2 TO ZERO        *.        @L1A 09336400
.*-------------------------------------------------------*.        @L1A 09338000
&INDX    SETA  1                                         *.        @L1A 09339600
.CLRFLGS ANOP                                            *.        @L1A 09341200
&FLG(&INDX) SETB  0                                      *.        @L1A 09342800
&FLG2(&INDX) SETB  0                                     *.        @D1A 09343600
&INDX    SETA  &INDX+1                                   *.        @L1A 09344400
         AIF   (&INDX LT 9).CLRFLGS                      *.        @L1A 09346000
.*-------------------------------------------------------*.        @L1A 09347600
.START   ANOP                                                           09350000
         AIF   ('&MF' NE '^').MFSPEC      MF KEYWORD SPECIFIED ?        09400000
         MNOTE 12,' NO TEXT GENERATED. ''MF'' VALUE IS NOT SPECIFIED.'  09450000
         AGO   .EXIT                                                    09500000
.MFSPEC  ANOP                                                           09550000
         AIF   ('&MF' NE '').MFLORE       MF KEYWORD IS LIST OR EXEC    09600000
         MNOTE 12,' NO TEXT GENERATED. ''MF'' VALUE IS NOT SPECIFIED.'  09650000
         AGO   .EXIT                                                    09700000
.MFLORE  ANOP                                                           09750000
         AIF   ('&MF(1)' EQ 'L').MFLIST   LIST FORM SPECIFIED ?         09800000
         AIF   ('&MF(1)' EQ 'E').MFEXEC   EXEC FORM SPECIFIED ?         09850000
         MNOTE 12,' NO TEXT GENERATED. ''MF'' VALUE IS NOT VALID.'      09900000
         AGO   .EXIT                                                    09950000
.*********************************************************************  10000000
.*       L I S T  F O R M                                            *  10050000
.*********************************************************************  10100000
.MFLIST  ANOP                         LIST FORM WAS SPECIFIED           10150000
&NAME    DS    0H                      MGCRE PARAMTER LIST              10200000
         AIF   (N'&MF EQ 1).LTVALID   VERIFY NO PARAMETERS ON LIST FORM 10250000
         MNOTE 4,' ''MF=&MF'' HAS TOO MANY ARGUMENTS. ARGUMENTS IGNOREDX10300000
                AFTER  &MF(1,1) .'                                      10350000
.*********************************************************************  10400000
.*       NO VALUES ARE PERMITTED ON THE LIST FORM OF MGCRE.  IF      *  10450000
.*       ANY KEYWORDS ARE SPECIFIED THEY WILL BE IGNORED.            *  10500000
.*********************************************************************  10550000
.LTVALID ANOP                             LIST FORM SPECIFIED CORRECTLY 10600000
         AIF   ('&TEXT' EQ '^').LFLAG     TEXT VALUE SPECIFIED ?        10650000
         MNOTE 4,' ''TEXT'' DATA IGNORED.  NO KEYWORDS PERMITTED ON THEX10700000
                LIST FORM OF MGCRE.'                                    10750000
.LFLAG   ANOP                                                           10800000
         AIF   ('&CMDFLAG' EQ '^').LCID     CMDFLAG VALUE SPECIFIED ?   10850000
         MNOTE 4,' ''CMDFLAG'' DATA IGNORED.  NO KEYWORDS PERMITTED ON X10900000
               THE LIST FORM OF MGCRE.'                                 10950000
.LCID    ANOP                                                           11000000
         AIF   ('&CONSID' EQ '^').LCNAME    CONSID VALUE SPECIFIED ?    11050000
         MNOTE 4,' ''CONSID'' DATA IGNORED.  NO KEYWORDS PERMITTED ON TX11100000
               HE LIST FORM OF MGCRE.'                                  11150000
.LCNAME  ANOP                                                           11200000
         AIF   ('&CONSNAME' EQ '^').LTOKEN  CONSNAME VALUE SPECIFIED ?  11250000
         MNOTE 4,' ''CONSNAME'' DATA IGNORED. NO KEYWORDS PERMITTED ON X11300000
               THE LIST FORM OF MGCRE.'                                 11350000
.LTOKEN  ANOP                                                           11400000
         AIF   ('&TOKEN' EQ '^').LCART     TOKEN VALUE SPECIFIED ? @L1C 11450000
         MNOTE 4,' ''TOKEN'' DATA IGNORED. NO KEYWORDS PERMITTED ON THEX11500000
                LIST FORM OF MGCRE.'                                    11550000
.LCART   ANOP                                                      @L1A 11560000
         AIF   ('&CART' EQ '^').LUTOKEN     CART VALUE SPECIFIED ? @D1C 11570000
         MNOTE 4,' ''CART'' DATA IGNORED. NO KEYWORDS PERMITTED ON THE X11580000
               LIST FORM OF MGCRE.'                                @L1A 11590000
.LUTOKEN ANOP                                                      @D1A 11592000
         AIF   ('&UTOKEN' EQ '^').LISTOK   UTOKEN VALUE SPECIFIED? @D1A 11594000
         MNOTE 4,' ''UTOKEN'' DATA IGNORED. NO KEYWORDS PERMITTED ON THX11596000
               E LIST FORM OF MGCRE.'                              @D1A 11598000
.LISTOK  ANOP                                                           11600000
.*********************************************************************  11650000
.*       G E N E R A T E  P A R A M E T E R  L I S T                 *  11700000
.*********************************************************************  11750000
         DC    AL1(0)                  FLAG FIELD '00'                  11800000
         DC    AL1(0)                  RESERVED                         11850000
&I       SETA  1                                                        11900000
.CLRFLG  ANOP                                                           11950000
&FLG(&I) SETB  0                                                        12000000
&I       SETA  &I+1                                                     12050000
         AIF   (&I LT 9).CLRFLG                                         12100000
         DC    B'&FLG(1)&FLG(2)&FLG(3)&FLG(4)&FLG(5)&FLG(6)&FLG(7)&FLG(X12150000
               8)'                     FLAG FIELD                       12200000
         DC    B'&FLG2(1)&FLG2(2)&FLG2(3)&FLG2(4)&FLG2(5)&FLG2(6)&FLG2(X12233300
               7)&FLG2(8)'             FLAG FIELD 2                @L1A 12266600
         DC    CL5'MGCRE'              CONTROL BLOCK ACRONYM 'MGCRE'    12300000
         DC    AL1(1)                  VERSION LEVEL                    12350000
         DC    AL2(0)                  RESERVED                         12400000
         DC    AL4(0)                  ADDRESS OF THE COMMAND TEXT      12450000
         DC    AL4(0)                  TOKEN                            12500000
         DC    CL8'        '           CONSOLE NAME                     12550000
         DC    AL4(0)                  CONSOLE ID                       12600000
         DC    XL1'0'                  COMMAND DISPOSITION         @L1A 12616600
         DC    XL2'0'                  COMMAND AUTHORITY LEVEL     @L1A 12633200
         DC    XL1'0'                  RESERVED                    @L1A 12649800
         DC    XL8'00'                 COMMAND AND RESPOSE TOKEN   @L1A 12662300
         DC    XL8'00'                 SYSTEM NAME                 @L1C 12674800
         DC    AL4(0)                  UTOKEN ADDRESS              @D1A 12683200
         DC    XL4'00'                 RESERVED                    @D1C 12691600
         AGO   .EXIT                                                    12700000
.*********************************************************************  12750000
.*       E X E C  F O R M                                            *  12800000
.*********************************************************************  12850000
.MFEXEC  ANOP                         PROCESS MF LISTNAME               12900000
&FLG(1)  SETB  1                      INDICATE MGCRE WAS SPECIFIED      12950000
&FLGSOK  SETB  1                      CMDFLAG VALUE SPECIFIED          X13000000
                                             CORRECTLY                  13050000
         AIF   (N'&MF LE 2).ENAME     TOO MANY ARGUEMENTS ON MF KEYWORD 13100000
         MNOTE 4,' ''MF=&MF'' HAS TOO MANY ARGUMENTS. ARGUMENTS IGNOREDX13150000
                AFTER &MF(2) .'                                         13200000
         AGO   .EXVALID                                                 13250000
.ENAME   ANOP                         LIST NAME FOR EXEC FORM SPECIFIED 13300000
         AIF   (N'&MF EQ 2).EXVALID                                     13350000
         MNOTE 12,' NO TEXT GENERATED. MF LIST NAME IS REQUIRED BUT NOTX13400000
                SUPPLIED.'                                              13450000
         AGO   .EXIT                                                    13500000
.EXVALID ANOP                         EXEC FORM SPECIFIED CORRECTLY     13550000
&FLG(1)  SETB  1                      INDICATE THAT MGCRE WAS SPECIFIED 13600000
.*********************************************************************  13650000
.*       T E X T                                                     *  13700000
.*********************************************************************  13750000
         AIF   (N'&TEXT LE 1).ETEXT  TOO MANY ARGUMENTS ON TEXT KEYWORD 13800000
         MNOTE 4,' ''TEXT=&TEXT'' HAS TOO MANY ARGUMENTS. ARGUMENTS IGNX13850000
               ORED AFTER &TEXT(1,1) .'                                 13900000
.ETEXT   ANOP                                                           13950000
         AIF   ('&TEXT' NE '^').VFYTEXT                                 14000000
         MNOTE 12,' NO TEXT GENERATED. ''TEXT'' VALUE IS REQUIRED BUT NX14050000
               OT SUPPLIED.'                                            14100000
         AGO   .EXIT                                                    14150000
.VFYTEXT ANOP                                                           14200000
         AIF   ('&TEXT' EQ '').NOTEXT    TEXT VALUE SPECIFIED ?         14250000
         AGO   .CONT1                                                   14300000
.NOTEXT  ANOP                                                           14350000
         MNOTE 12,' NO TEXT GENERATED. ''TEXT'' VALUE IS REQUIRED BUT NX14400000
               OT SUPPLIED.'                                            14450000
         AGO   .EXIT                                                    14500000
.CONT1   ANOP                                                           14550000
&TEXTOK  SETB  1                             TEXT VALUE SPECIFIED      X14600000
                                             CORRECTLY                  14650000
.*********************************************************************  14700000
.*       C O N S O L E  I D                                          *  14750000
.*********************************************************************  14800000
.CHKCID  ANOP                      TOO MANY ARGUMENTS ON CONSID KEYWORD 14850000
         AIF   (N'&CONSID LE 1).ECONSID                                 14900000
         MNOTE 4,' ''CONSID=&CONSID'' HAS TOO MANY ARGUMENTS. ARGUMENTSX14950000
                IGNORED AFTER &CONSID(1,1) .'                           15000000
.ECONSID ANOP                                                           15050000
         AIF   ('&CONSID' EQ '^').CHKNAME  CONSID KEYWORD NOT SPECIFIED 15100000
         AIF   ('&CONSID' NE '').VFYCID    NO DATA SPECIFIED ON CONSID  15150000
         MNOTE 4,' ''CONSID'' KEYWORD IGNORED. NO DATA SPECIFIED.'      15200000
         AGO   .CHKNAME                                                 15250000
.VFYCID  ANOP                                VERIFY CONSOLE ID          15300000
&IDSPEC  SETB  1                             INDICATE CONSID SPECIFIEC  15350000
&FLG(6)  SETB  1                             INDICATE CONSID SPECIFIED X15400000
                                             CORRECTLY                  15450000
&CIDOK   SETB  1                             CONSID VALUE SPECIFIED    X15500000
                                             CORRECTLY                  15550000
&FLGSOK  SETB  1                             CMDFLAG VALUE SPECIFIED   X15600000
                                             CORRECTLY                  15650000
.*********************************************************************  15700000
.*       C O N S O L E  N A M E                                      *  15750000
.*********************************************************************  15800000
.CHKNAME ANOP                                                           15850000
         AIF   (N'&CONSNAME LE 1).ECNAME     TOO MANY ARGUMENTS ON CONSX15900000
                                             NAME KEYWORD               15950000
         MNOTE 4,' ''CONSNAME=&CONSNAME'' HAS TOO MANY ARGUMENTS. ARGUMX16000000
               ENTS IGNORED AFTER &CONSNAME(1,1) .'                     16050000
.ECNAME  ANOP                                                           16100000
         AIF   ('&CONSNAME' EQ '^').CIDSPEC CONSNAME NOT SPECIFIED      16150000
         AIF   ('&CONSNAME' NE '').CNMSPEC  CONSNAME SPECIFIED ?        16200000
         MNOTE 4,' ''CONSNAME'' KEYWORD IGNORED. NO DATA SPECIFIED.'    16250000
         AGO   .CIDSPEC            CONSID SPECIFIED ?                   16300000
.CNMSPEC ANOP                      CONSNAME WAS SPECIFIED               16350000
&NMSPEC  SETB  1                   INDICATE THAT CONSNAME WAS SPECIFIED 16400000
&FLG(7)  SETB  1                   INDICATE CONSNAME WAS SPECIFIED IN  X16450000
                                   THE COMMAND FLAGS                    16500000
&FLGSOK  SETB  1                   CMDFLAG VALUE SPECIFIED             X16550000
                                             CORRECTLY                  16600000
         AGO   .BTHSPEC            BOTH CONSID AND CONSNAME SPECIFIED ? 16650000
.CIDSPEC ANOP                      CONSID SPECIFIED ?                   16700000
         AIF   ('&IDSPEC' NE '0').BTHSPEC   BOTH SPECIFIED ?            16750000
         MNOTE 12,' NO TEXT GENERATED. CONSID OR CONSNAME IS REQUIRED BX16800000
               UT NOT SUPPLIED.'                                        16850000
         AGO   .EXIT                                                    16900000
.BTHSPEC ANOP                      BOTH CONSID AND CONSNAME SPECIFIED ? 16950000
         AIF   ('&IDSPEC' EQ '1' AND '&NMSPEC' EQ '1').MNOTE1           17000000
         AIF   ('&CONSNAME' EQ '' OR '&CONSNAME' EQ '^').CHKFLAG        17050000
&CNMEOK  SETB  1                             CONSNAME VALUE SPECIFIED  X17100000
                                             CORRECTLY                  17150000
         AGO   .CHKFLAG                                                 17200000
.MNOTE1  ANOP                                                           17250000
         MNOTE 12,' NO TEXT GENERATED. ''CONSNAME'' IS MUTUALLY EXCLUSIX17300000
               VE WITH ''CONSID''.'                                     17350000
         AGO   .EXIT                                                    17400000
.*********************************************************************  17450000
.*       C O M M A N D  F L A G S                                    *  17500000
.*********************************************************************  17550000
.CHKFLAG ANOP                                                           17600000
         AIF   ('&CMDFLAG' EQ '^').CHKTKN        CMDFLAG SPECIFIED ?    17650000
         AIF   ('&CMDFLAG' NE '').FLGSPEC        CMDFLAG DATA SPEC ?    17700000
         MNOTE 4,' ''CMDFLAG'' KEYWORD IGNORED. NO DATA SPECIFIED.'     17750000
.FLGSPEC ANOP                                                           17800000
         AIF   (N'&CMDFLAG LE 3).CNTFLAG         TOO MANY ARGUMENTS ON X17850000
                                                 CMDFLAG KEYWORD        17900000
         MNOTE 4,' ''CMDFLAG=&CMDFLAG'' HAS TOO MANY ARGUMENTS. ARGUMENX17950000
               TS IGNORED AFTER &CMDFLAG(3,1) .'                        18000000
.CNTFLAG ANOP                                                           18050000
&CNT     SETA  &CNT+1                                                   18100000
         AIF   (&CNT GT N'&CMDFLAG).CONT2                               18150000
         AIF   ('&CMDFLAG(&CNT)' EQ 'SUBSYS').SETFLG2                   18200000
         AGO   .CHKFLG3                                                 18250000
.SETFLG2 ANOP                                                           18300000
&FLG(2)  SETB  1                                                        18350000
.CHKFLG3 ANOP                                                           18400000
         AIF   ('&CMDFLAG(&CNT)' EQ 'COMMTASK').SETFLG3                 18450000
         AGO   .CHKFLG4                                                 18500000
.SETFLG3 ANOP                                                           18550000
&FLG(3)  SETB  1                                                        18600000
.CHKFLG4 ANOP                                                           18650000
         AIF   ('&CMDFLAG(&CNT)' EQ 'NOHCPY').SETFLG4                   18700000
         AGO   .OTHERS                                                  18750000
.SETFLG4 ANOP                                                           18800000
&FLG(4)  SETB  1                                                        18850000
.OTHERS  ANOP                                                           18900000
         AIF   ('&CMDFLAG(&CNT)' EQ '^').CONT2                          18950000
         AIF   ('&CMDFLAG(&CNT)' EQ '').FNODAT                          19000000
         AIF   ('&CMDFLAG(&CNT)' EQ 'SUBSYS'   OR                      X19050000
                '&CMDFLAG(&CNT)' EQ 'COMMTASK' OR                      X19100000
                '&CMDFLAG(&CNT)' EQ 'NOHCPY').FVALID                    19150000
         AGO   .FNTVAL                                                  19200000
.FVALID  ANOP                      CMDFLAG VALUE SPECIFIED IS VALID     19250000
         AIF   ('&FLG(2)' EQ '1' AND '&FLG(3)' EQ '1').FLGEXC COMMTASK X19300000
                                              AND SUBSYS SPECIFIED ?    19350000
         AGO   .CNTFLAG                                                 19400000
.FNTVAL  ANOP                      CMDFLAG VALUE SPECIFIED IS NOT VALID 19450000
         MNOTE 4,' CMDFLAG VALUE IGNORED. ''CMDFLAG=&CMDFLAG(&CNT)'' ISX19500000
                NOT VALID.'                                             19550000
         AGO   .CNTFLAG                                                 19600000
.FNODAT  ANOP                                                           19650000
         MNOTE 4,' ''CMDFLAG'' KEYWORD IGNORED. NO DATA SPECIFIED.'     19700000
         AGO   .CNTFLAG                                                 19750000
.FLGEXC  ANOP                                                           19800000
         MNOTE 12,' NO TEXT GENERATED. ''CMDFLAG=SUBSYS'' IS MUTUALLY EX19850000
               XCLUSIVE WITH ''CMDFLAG=COMMTASK''.'                     19900000
         AGO   .EXIT                                                    19950000
.CONT2   ANOP                                                           20000000
&FLGSOK  SETB  1                             CMDFLAG VALUE SPECIFIED   X20050000
                                             CORRECTLY                  20100000
.*********************************************************************  20150000
.*       T O K E N                                                   *  20200000
.*********************************************************************  20250000
.CHKTKN  ANOP                                                           20300000
         AIF   (N'&TOKEN LE 1).ETOKEN      TOO MANY ARGUMENTS ON TOKEN X20350000
                                           KEYWORD                      20400000
         MNOTE 4,' ''TOKEN=&TOKEN'' HAS TOO MANY ARGUMENTS. ARGUMENTS IX20450000
               GNORED AFTER &TOKEN(1,1) .'                              20500000
.ETOKEN  ANOP                                                           20550000
         AIF   ('&TOKEN' EQ '^').CHKCART   TOKEN VALUE SPECIFIED ? @L1C 20600000
         AIF   ('&TOKEN' NE '').CONT3       NO DATA SPECIFIED           20650000
         MNOTE 4,' ''TOKEN'' KEYWORD IGNORED. NO DATA SPECIFIED.'       20700000
         AGO   .CHKCART                   BYPASS TOKEN PROCESSING  @D1A 20725000
.CONT3   ANOP                                                           20750000
&TKNOK   SETB  1                             TOKEN VALUE SPECIFIED     X20800000
                                             CORRECTLY                  20850000
&FLGSOK  SETB  1                             CMDFLAG VALUE SPECIFIED   X20900000
                                             CORRECTLY                  20950000
&FLG(5)  SETB  1                             INDICATE TOKEN  SPECIFIED X21000000
                                             CORRECTLY                  21050000
.***************************************************************** @L1A 21053300
.*       C A R T                                                 * @L1A 21056600
.***************************************************************** @L1A 21059900
.CHKCART ANOP                                                      @L1A 21063200
         AIF   (N'&CART LE 1).ECART        TOO MANY ARGUMENTS ON   @L1AX21066500
                                           CART KEYWORD            @L1A 21069800
         MNOTE 4,' ''CART=&CART'' HAS TOO MANY ARGUMENTS.  ARGUMENTS IGX21073100
               NORED AFTER &CART(1,1) .'                           @L1A 21076400
.ECART   ANOP                                                           21079700
         AIF   ('&CART' EQ '^').CHKUTKN    CART VALUE SPECIFIED ?  @D1C 21083000
         AIF   ('&CART' NE '').CONT4        NO DATA SPECIFIED      @L1A 21086300
         MNOTE 4,' ''CART'' KEYWORD IGNORED. NO DATA SPECIFIED.'   @L1A 21089600
         AGO   .CHKUTKN                    BYPASS CART PROCESSING  @D1A 21091200
.CONT4   ANOP                                                           21092900
&CARTOK  SETB  1                           CART SPECIFIED CORRECLY @L1A 21096200
&FLG2(3) SETB  1                           INDICATE CART SPECIFIED @D1A 21096300
&FLGS2OK SETB  1                           INDICATE A FLAG WAS SET @D1A 21096400
.***************************************************************** @D1A 21096500
.*       U T O K E N                                             * @D1A 21096600
.***************************************************************** @D1A 21096700
.CHKUTKN ANOP                                                      @D1A 21096800
         AIF   (N'&UTOKEN LE 1).EUTKN      TOO MANY ARGUMENTS ON   @D1AX21096900
                                           UTOKEN KEYWORD          @D1A 21097000
         MNOTE 4,' ''UTOKEN=&UTOKEN'' HAS TOO MANY ARGUMENTS.  ARGUMENTX21097100
               S IGNORED AFTER &UTOKEN(1,1) .'                     @D1A 21097200
.EUTKN   ANOP                                                           21097300
         AIF   ('&UTOKEN' EQ '^').INSERT   UTOKEN VALUE SPECIFIED? @D1A 21097400
         AIF   ('&UTOKEN' NE '').CONT5      NO DATA SPECIFIED      @D1A 21097500
         MNOTE 4,' ''UTOKEN'' KEYWORD IGNORED. NO DATA SPECIFIED.' @D1A 21097600
         AGO   .INSERT                   BYPASS UTOKEN PROCESSING  @D1A 21097700
.CONT5   ANOP                                                           21097800
&UTKNOK  SETB  1                         UTOKEN SPECIFIED CORRECLY @D1A 21097900
&FLG2(5) SETB  1                         INDICATE UTOKEN SPECIFIED @D1A 21098000
&FLGS2OK SETB  1                           INDICATE A FLAG WAS SET @D1A 21098100
.*********************************************************************  21100000
.*       INSERT ALL VALUES SPECIFIED INTO THE PARAMTER LIST          *  21150000
.*********************************************************************  21200000
.INSERT  ANOP                                                           21250000
&NAME    IHBINNRA &MF(2)             SET UP PARAMETER LIST ADDRESS      21300000
         XC    0(4,1),0(1)                 CLEAR LIST UPTO ACRONYM @L2C 21316600
         XC    10(50,1),10(1)              CLEAR LIST PAST VERSION @L2A 21333200
.*********************************************************************  21350000
.*       INSERT TEXT VALUE IF IT WAS SPECIFIED                       *  21400000
.*********************************************************************  21450000
.INSRTTX ANOP                                                           21500000
         AIF   ('&TEXTOK' NE '1').INSRTID                               21550000
         AIF   ('&TEXT'(1,1) EQ '(').ETEXTRG   TEXT VALUE IS IN A REG   21600000
         MVC   12(4,1),&TEXT(1,1)           INSERT TEXT ADDRESS INTO   X21633300
                                            PARMLIST               @03C 21666600
         AGO   .INSRTID                                                 21700000
.ETEXTRG ANOP                                                           21750000
         ST    &TEXT(1,1),12(,1)            INSERT TEXT ADDRESS INTO   X21783300
                                            PARMLIST               @03C 21816600
         AGO   .INSRTID                                                 21850000
.*********************************************************************  21900000
.*       INSERT CONSID VALUE IF IT WAS SPECIFIED                     *  21950000
.*********************************************************************  22000000
.INSRTID ANOP                                                           22050000
         AIF   ('&CIDOK' NE '1').INSRTNM                                22100000
         AIF   ('&CONSID'(1,1) EQ '(').ECIDRG CONSID VALUE IS IN A REG  22150000
         MVC   28(4,1),&CONSID(1,1)          INSERT CONSID INTO PLIST   22200000
         AGO   .INSRTNM                                                 22250000
.ECIDRG  ANOP                                                           22300000
         ST    &CONSID(1,1),28(,1)          INSERT CONSID INTO PLIST    22350000
.*********************************************************************  22400000
.*       INSERT CONSNAME VALUE IF IT WAS SPECIFIED                   *  22450000
.*********************************************************************  22500000
.INSRTNM ANOP                                                           22550000
         AIF   ('&CNMEOK' NE '1').SETFLGS                               22600000
         AIF   ('&CONSNAME'(1,1) EQ '(').ENAMERG                        22650000
         MVC   20(8,1),&CONSNAME(1,1)      INSERT CONSNAME INTO PLIST   22700000
         AGO   .SETFLGS                                                 22750000
.ENAMERG ANOP                               CONSNAME VALUE IS IN A REG  22800000
         MVC   20(8,1),0(&CONSNAME(1,1))    INSERT CONSNAME INTO PLIST  22850000
         AGO   .SETFLGS                                                 22900000
.*********************************************************************  22950000
.*       INSERT CMDFLAG VALUES IF IT WAS SPECIFIED                   *  23000000
.*********************************************************************  23050000
.SETFLGS ANOP                      SET THE COMMAND FLAGS                23100000
         AIF   ('&FLGSOK' NE '1').INSRTTK                               23150000
         AIF   (NOT &FLG(1) AND                                        X23200000
                NOT &FLG(2) AND                                        X23250000
                NOT &FLG(3) AND                                        X23300000
                NOT &FLG(4) AND                                        X23350000
                NOT &FLG(5) AND                                        X23400000
                NOT &FLG(6) AND                                        X23450000
                NOT &FLG(7) AND                                        X23500000
                NOT &FLG(8)).CHKTKN                                     23550000
.*       SLR   1,1                          CLEAR REGISTER ONE          23600000
         OI    2(1),B'&FLG(1)&FLG(2)&FLG(3)&FLG(4)&FLG(5)&FLG(6)&FLG(7)X23650000
               &FLG(8)'                     SET COMMAND FLAGS           23700000
.*********************************************************************  23750000
.*       INSERT TOKEN VALUES IF IT WAS SPECIFIED                     *  23800000
.*********************************************************************  23850000
.INSRTTK ANOP                                                           23900000
         AIF   ('&TKNOK' NE '1').NSRTCRT                           @D1C 23950000
         AIF   ('&TOKEN'(1,1) EQ '(').ETKNRG   TOKEN VALUE IS IN A REG  24000000
         MVC   16(4,1),&TOKEN(1,1)          INSERT TOKEN INTO PARMLIST  24050000
         AGO   .NSRTCRT                     CHECK NEXT KEYWORD     @D1C 24100000
.ETKNRG  ANOP                                                           24150000
         ST    &TOKEN(1,1),16(,1)           INSERT TOKEN INTO PARMLIST  24200000
         AGO   .NSRTCRT                     CHECK NEXT KEYWORD     @D1C 24201900
.******************************************************************@L1A 24203800
.*       INSERT CART VALUE IF IT WAS SPECIFIED                    *@L1A 24207600
.******************************************************************@L1A 24211400
.NSRTCRT ANOP                                                      @L1A 24215200
         AIF   ('&CARTOK' NE '1').INSRTUT    CART SPECIFIED?       @D1C 24219000
         AIF   ('&CART'(1,1) EQ '(').ETCART  CART VALUE IS IN A REG@L1A 24222800
         MVC   36(8,1),&CART              MOVE CART INTO PARMLIST  @L1A 24228500
         AGO   .INSRTUT                  CHECK NEXT KEYWORD        @D1C 24234200
.ETCART  ANOP                                                           24238000
         MVC   36(8,1),0(&CART(1,1))     INSERT CART INTO PARMLIST @L1A 24244000
         AGO   .INSRTUT                  CHECK NEXT KEYWORD        @D1C 24244300
.******************************************************************@D1A 24244600
.*       INSERT UTOKEN VALUE IF IT WAS SPECIFIED                  *@D1A 24244900
.******************************************************************@D1A 24245200
.INSRTUT ANOP                                                      @D1A 24245500
         AIF   ('&UTKNOK' NE '1').FLG2STF  UTOKEN SPECIFIED?       @D1A 24245800
         AIF   ('&UTOKEN'(1,1) EQ '(').ETUTKN UTOKEN IS IN A REG   @D1A 24246100
         MVC   52(4,1),&UTOKEN           MOVE UTOKEN ADDRESS INTO      X24246300
                                         PARMLIST                  @03C 24246500
         AGO   .FLG2STF                  GO SET FLAG 2 BITS        @D1A 24246700
.ETUTKN  ANOP                                                           24247000
         ST    &UTOKEN(1,1),52(,1)       INSERT UTOKEN ADDRESS INTO    X24247200
                                         PARMLIST                  @03C 24247400
         AGO   .FLG2STF                  GO SET FLAG 2 BITS        @D1A 24247600
.******************************************************************@D1M 24247900
.*       STORE FLAG BYTE 2 INFORMATION                             @D1M 24248200
.******************************************************************@D1M 24248500
.FLG2STF ANOP                                                      @D1M 24248800
         AIF   ('&FLGS2OK' NE '1').EXECSVC                         @D1A 24249100
         OI    3(1),B'&FLG2(1)&FLG2(2)&FLG2(3)&FLG2(4)&FLG2(5)&FLG2(6)&X24249400
               FLG2(7)&FLG2(8)'          SET FLAG BYTE 2           @D1M 24249700
.*********************************************************************  24250000
.*       I S S U E  S V C  3 4                                       *  24300000
.*********************************************************************  24350000
.EXECSVC ANOP                                                           24375000
         SVC 34                             ISSUE SVC 34           @L1C 24425000
.EXIT    MEND                                                           24450000
**/                                                                     24500000
* %MGCRE: MACRO KEYS(                                                   24550000
*                    MF,       /* LIST FORMAT                      */   24600000
*                    TEXT,     /* COMMAND TEXT AREA ADDRESS    @03C*/   24650000
*                    CMDFLAG,  /* SOURCE OF COMMAND                */   24700000
*                    CONSID,   /* 4-BYTE CONSOLE ID                */   24750000
*                    CONSNAME, /* CONSOLE NAME                     */   24800000
*                    CART,     /* COMMAND AND RESPONSE TOKEN   @L1A*/   24833300
*                    TOKEN,    /* TOKEN ASSOCIATED WITH COMMAND@D1C*/   24855500
*                    UTOKEN    /* SECURITY TOKEN ADDRESS       @03C*/   24877700
*                          );                                           24900000
*            ANS('?'||MACLABEL||'MGCREP '||MACLIST||MACKEYS||';');      24950000
*%END MGCRE;                                                            25000000
