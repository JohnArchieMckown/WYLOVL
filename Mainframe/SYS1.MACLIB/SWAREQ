* /*** START OF SPECIFICATIONS **************************************/  00050000
* /*                                                                */  00100000
* /*01* MODULE NAME = SWAREQ                                    @L1A*/  00150000
* /*                                                                */  00200000
* /*01* DESCRIPTIVE NAME = SWA MANAGER LOCATE MODE INVOCATION   @L1A*/  00250000
* /*                                                                */  00300000
* /*    COPYRIGHT =                                             @L1A*/  00350000
* /*                5695-047                                    @L3C*/  00400000
* /*                THIS MACRO IS "RESTRICTED MATERIALS OF IBM" @L3C*/  00450000
* /*                (C) COPYRIGHT IBM CORP. 1983, 1990          @L3C*/  00500000
* /*                LICENSED MATERIALS - PROPERTY OF IBM        @L3C*/  00550000
* /*                                                                */  00700000
* /* STATUS - HBB4420                                           @L3C*/  00750000
* /*                                                                */  00800000
* /*01* FUNCTION =                                                  */  00850000
* /*                                                                */  00900000
* /*    PLS :   THE SWAREQ MACRO IS USED TO INVOKE THE SWA      @L1C*/  00950000
* /*            MANAGER LOCATE MODE (IEFQB556) ROUTINE OR       @T0A*/  00983300
* /*            OPTIONALLY THE UNAUTHORIZED SERVICE (IEFQBSVA). @T0A*/  01016600
* /*                                                                */  01050000
* /*    ASM :   THE SWAREQ MACRO IS USED TO SET/MODIFY THE      @L2A*/  01100000
* /*            PARAMETER LIST TO SWA MANAGER AND/OR INVOKE     @L2A*/  01150000
* /*            THE SWA MANAGER LOCATE MODE(IEFQB556) ROUTINE   @T0A*/  01175000
* /*            OR OPTIONALLY THE UNAUTHORIZED SERVICE          @T0A*/  01200000
* /*            (IEFQBSVA).                                     @T0A*/  01225000
* /*                                                            @L2A*/  01250000
* /*02* OPERATION:                                              @L1A*/  01300000
* /*                                                            @L2A*/  01350000
* /*    PLS:                                                    @L2A*/  01400000
* /*     . VERIFY THE FUNCTION CODE                             @L1A*/  01450000
* /*       VALID FUNCTION CODES ARE:                            @L1A*/  01500000
* /*       AL, AC, WL, RL, DB, LA, AS, GB, FB                   @L3C*/  01550000
* /*                                                            @L1A*/  01600000
* /*     . CHECK FOR A MISSING EPA KEYWORD OR NULL SUBPARAMETER @L1A*/  01650000
* /*     . CHECK FOR MORE THAN 1 POSITIONAL PARAMETER           @L1A*/  01700000
* /*     . CHECK FOR MORE THAN 1 SUBPARAMETER ON EPA KEYWORD    @L1A*/  01750000
* /*     . VERIFY THE UNAUTH KEYWORD AS YES OR NO               @T0A*/  01775000
* /*     . VERIFY IEFJESCT WAS INCLUDED                         @D1A*/  01781200
* /*     . IF UNAUTH=YES IS SPECIFIED, CHECK FOR AN EXTENDED    @D1A*/  01787400
* /*       EPA                                                  @D1A*/  01793600
* /*                                                                */  01800000
* /*      IF AN INVALID FUNCTION CODE WAS FOUND OR ANY OF THE   @L1A*/  01850000
* /*      ABOVE CONDITIONS WERE TRUE THEN SET UP THE            @L1A*/  01900000
* /*      APPROPRIATE ERROR MESSAGE TO BE ISSUED AT COMPILE     @L1A*/  01950000
* /*      STAGE AND MACRO PROCESSING STAGE AND RETURN TO        @L1A*/  02000000
* /*      CALLER.                                               @L1A*/  02050000
* /*                                                                */  02100000
* /*      IF NO ERRORS WERE ENCOUNTERED, THEN GENERATE CODE     @L1A*/  02150000
* /*      TO CALL THE SWA MANAGER VIA A BASSM AND PASS THE      @L1A*/  02200000
* /*      PARAMETERS REQUESTED.                                 @L1A*/  02250000
* /*                                                                */  02300000
* /*      IF NO ERRORS WERE ENCOUNTERED AND UNAUTH WAS          @T0A*/  02308300
* /*      SPECIFIED AS YES, THEN GENERATE THE CODE TO CALL THE  @T0A*/  02316600
* /*      UNAUTHORIZED SWA MANAGER VIA A BALR AND PASS THE      @T0A*/  02324900
* /*      PARAMETERS REQUESTED.                                 @T0A*/  02333200
* /*                                                                */  02341500
* /*    ASM :                                                   @L2A*/  02350000
* /*     . VERIFY THE MACRO FORM                                @L2A*/  02400000
* /*       VALID MACRO FORMS ARE:                               @L2A*/  02450000
* /*       L (LIST), E (EXEC), M (MODIFY)                       @L2A*/  02500000
* /*                                                            @L2A*/  02550000
* /*     . IF MF=L                                              @L2A*/  02600000
* /*       - GENERATE GENERALIZED PARAMETER LIST.               @L2A*/  02650000
* /*                                                            @L2A*/  02700000
* /*     . IF MF=M OR E                                         @L2A*/  02750000
* /*                                                            @L2A*/  02800000
* /*       - CHECK THE SECOND SUBPARAMETER ON THE MF KEYWORD,   @L2A*/  02850000
* /*         WHICH IS THE ADDRESS OF THE PARAMETER LIST TO SWA  @L2A*/  02900000
* /*         MANAGER, TO SEE IF IT IS A SYMBOL OR REGISTER.     @L2A*/  02950000
* /*       - CHECK FOR ADDITIONAL SUBPARAMTERS                  @L2A*/  03000000
* /*                                                            @L2A*/  03050000
* /*     . IF FUNCTION CODE SPECIFIED                           @L2A*/  03100000
* /*       - VERIFY THE FUNCTION CODE                           @L2A*/  03150000
* /*         VALID FUNCTION CODES ARE:                          @L2A*/  03200000
* /*         AL, AC, WL, RL, DB, LA, AS, GB, FB                 @L3C*/  03250000
* /*       - CHECK FOR ADDITIONAL SUBPARAMETERS.                @L2A*/  03300000
* /*                                                            @L2A*/  03350000
* /*     . IF EPA SPECIFIED                                     @L2A*/  03400000
* /*       - VERIFY THE EPA                                     @L2A*/  03450000
* /*         VALID EPA VALUES ARE:                              @L2A*/  03500000
* /*         VALID ASSEMBLER SYMBOLS OR REGISTERS.              @L2A*/  03550000
* /*       - CHECK FOR ADDITIONAL SUBPARAMETERS.                @L2A*/  03600000
* /*                                                            @L2A*/  03650000
* /*     . IF UNAUTH SPECIFIED                                  @T0A*/  03662500
* /*       - VERIFY THE VALUE SPECIFIED AS YES OR NO            @T0A*/  03675000
* /*                                                            @L2A*/  03687500
* /*      IF ANY ERRORS WERE FOUND AS A RESULT OF DOING THE     @L2A*/  03700000
* /*      ABOVE PROCESSING THEN ISSUE THE APPROPRIATE MNOTE.    @L2A*/  03750000
* /*                                                            @L2A*/  03800000
* /*      IF NO SERIOUS ERRORS(LEVEL 12) WERE FOUND, THEN       @L2A*/  03850000
* /*        IF MF=L, THEN GENERATE GENERALIZED PARAMETER LIST   @L2A*/  03900000
* /*        IF MF=M, THEN SET/MODIFY THE PARAMETERS SPECIFIED.  @L2A*/  03950000
* /*        IF MF=E, THEN SET/MODIFY THE PARAMETERS SPECIFIED   @L2A*/  04000000
* /*                 AND GENERATE THE CODE TO CALL THE SWA      @L2A*/  04050000
* /*                 MANAGER VIA A BASSM OR IF REQUESTED THE    @T0A*/  04087500
* /*                 UNAUTHORIZED SWA MANAGER VIA A BALR        @T0A*/  04125000
* /*                 PASSING THE PARAMETER LIST SPECIFIED.      @T0A*/  04162500
* /*                                                            @L2A*/  04200000
* /*01* NOTES = NONE                                            @L1A*/  04250000
* /*                                                                */  04300000
* /*02* DEPENDENCIES =                                          @L1A*/  04350000
* /*                                                                */  04400000
* /*    PLS: THE CALLER MUST DEFINE CVTPTR                      @L2C*/  04450000
* /*         (EQUAL TO LOCATION 16) AND INCLUDE THE CVT AND     @L1A*/  04500000
* /*         IEFJESCT MAPPING MACROS.                           @L1A*/  04550000
* /*         THE JESCT SHOULD BE INCLUDED BEFORE THIS MACRO IS  @D1A*/  04566600
* /*         INVOKED.                                           @D1A*/  04583200
* /*                                                                */  04600000
* /*    ASM: THE CALLER MUST INCLUDE THE CVT AND THE            @L2A*/  04650000
* /*         IEFJESCT MAPPING MACROS.                           @L2A*/  04700000
* /*         THE CALLER MUST OBTAIN THE STORAGE FOR THE         @L2A*/  04750000
* /*         PARAMETER LIST.                                    @L2A*/  04800000
* /*                                                            @L2A*/  04850000
* /*02* RESTRICTIONS =                                          @L1A*/  04900000
* /*      ASSEMBLER H IS REQUIRED FOR BASSM INSTRUCTION.        @L1A*/  04950000
* /*                                                                */  05000000
* /*      THE UNAUTHORIZED FUNCTION ONLY SUPPORTS CALLERS       @T0A*/  05005500
* /*      EXECUTING IN 31-BIT ADDRESSING MODE.                      */  05011000
* /*                                                                */  05016500
* /*      THE UNAUTHORIZED FUNCTION ONLY SUPPORTS THE           @T0A*/  05022000
* /*      LOCATE/ALL (LA) FUNCTION. ONLY 1 EPA, NOT A           @T0A*/  05027500
* /*      CHAIN OF EPAS, MAY BE PASSED AS INPUT. THE            @T0A*/  05033000
* /*      FUNCTION CODE SPECIFIED IS IGNORED.                   @T0A*/  05038500
* /*                                                                */  05044000
* /*01* MODULE TYPE = MACRO                                     @L1A*/  05050000
* /*                                                                */  05100000
* /*01* ENTRY POINT = N/A                                       @L1A*/  05150000
* /*                                                                */  05200000
* /*02* METHOD OF INVOCATION:                                   @L1A*/  05250000
* /*                                                                */  05300000
* /*    PLS INVOCATION:                                         @L2A*/  05350000
* /*      ?SWAREQ(FUNCTION CODE) EPA(EPA ADDR) UNAUTH(YES/NO)   @T0C*/  05400000
* /*                                                                */  05450000
* /*      WHERE FUNCTION CODE IS ONE OF THE FOLLOWING:          @L1A*/  05500000
* /*         AL, AC, WL, RL, DB, LA, AS, GB, FB                 @L3C*/  05550000
* /*                                                                */  05600000
* /*      WHERE EPA ADDRESS IS THE ADDRESS OF AN EPA            @L1A*/  05650000
* /*                                                                */  05700000
* /*      WHERE UNAUTH SPECIFIES WHETHER THE UNAUTHORIZED       @T0A*/  05725000
* /*      INTERFACE TO THE LOCATE ALL FUNCTION IS DESIRED       @T0A*/  05750000
* /*                                                                */  05775000
* /*    ASM INVOCATION:                                         @T0C*/  05800000
* /*      AA   SWAREQ FCODE=XX,EPA=YY,MF=ZZ,UNAUTH=YES/NO       @L2A*/  05825000
* /*                                                            @L2A*/  05850000
* /*      WHERE AA IS A LABEL WHICH WILL APPEAR ON THE          @L2A*/  05900000
* /*      FIRST GENERATED ASSEMBLER STATEMENT.                  @L2A*/  05950000
* /*                                                            @L2A*/  06000000
* /*      WHERE XX IS ONE OF THE FOLLOWING:                     @L2A*/  06050000
* /*         AL, AC, WL, RL, DB, LA, AS, GB, FB                 @L3C*/  06100000
* /*                                                            @L2A*/  06150000
* /*      WHERE YY IS THE ADDRESS OF AN EPA POINTER WHICH CAN   @L2A*/  06200000
* /*      BE SPECIFIED AS A SYMBOL OR REGISTER 2-12.            @L2A*/  06250000
* /*      FOR MF=L, THE REGISTER FORM IS INVALID.               @L2A*/  06300000
* /*                                                            @L2A*/  06350000
* /*      WHERE ZZ IS ONE OF THE FOLLOWING: L, M, OR E          @L2A*/  06400000
* /*      IF MF=M OR E , THEN THE ADDRESS OF THE PARAMETER      @L2A*/  06450000
* /*      LIST MUST BE SPECIFIED AS THE SECOND SUBPARAMETER.    @L2A*/  06500000
* /*      THIS CAN BE A SYMBOL OR REGISTER 2-12.                @L2A*/  06550000
* /*                                                            @L2A*/  06600000
* /*      IF A REGISTER IS USED, IT MUST BE IN PARENTHESIS.     @L2A*/  06650000
* /*      SYMBOLS EQUATED TO REGISTERS ENCLOSED IN PARENTHESIS  @L2A*/  06700000
* /*      ARE ALSO VALID.                                       @L2A*/  06750000
* /*                                                            @L2A*/  06800000
* /*      WHERE UNAUTH SPECIFIES WHETHER THE UNAUTHORIZED       @T0A*/  06812500
* /*      INTERFACE TO THE LOCATE ALL FUNCTION IS DESIRED       @T0A*/  06825000
* /*                                                            @L2A*/  06837500
* /*02* REGISTERS USED IN ASSEMBLER VERSION: R0,R1,R13,R14,R15  @L2A*/  06850000
* /*                                                            @L2A*/  06900000
* /*02* INPUT =                                                 @L1C*/  06950000
* /*                                                                */  07000000
* /*    PLS:  THE FOLLOWING PARAMETERS MUST BE SPECIFIED:       @L2C*/  07050000
* /*        . FUNCTION CODE                                     @L1A*/  07100000
* /*        . ADDRESS OF THE EPA                                @L1A*/  07150000
* /*        THE FOLLOWING PARAMETER IS OPTIONAL:                @T0A*/  07166600
* /*        . UNAUTH        (UNAUTHORIZED SERVICE)              @T0A*/  07183200
* /*                                                                */  07200000
* /*    ASM:  THE FOLLOWING PARAMETERS MUST BE SPECIFIED:       @L2A*/  07250000
* /*        . MACRO FORM (MF)                                   @L2A*/  07300000
* /*        . IF MF=M OR E, THEN THE SECOND SUBPARAMETER OF MF  @L2A*/  07350000
* /*          IS THE ADDRESS OF THE PARAMETER LIST FOR SWA      @L2A*/  07400000
* /*          MANAGER.                                          @L2A*/  07450000
* /*                                                            @L2A*/  07500000
* /*        THE FOLLOWING PARAMETERS ARE OPTIONAL BUT MUST BE   @L2A*/  07550000
* /*        SPECIFIED AT LEAST ONCE ON SOME MACRO FORM:         @L2A*/  07600000
* /*        . FUNCTION CODE (FCODE)                             @L2A*/  07650000
* /*        . EPA POINTER ADDRESS   (EPA)                       @L2A*/  07683300
* /*        . UNAUTH        (UNAUTHORIZED SERVICE)              @T0A*/  07716600
* /*                                                            @L2A*/  07750000
* /*        A LABEL MAY ALSO BE PLACED ON THE MACRO CALL        @L2A*/  07800000
* /*        WHICH WILL BE PLACED ON THE FIRST ASSEMBLER         @L2A*/  07850000
* /*        STATEMENT GENERATED.                                @L2A*/  07900000
* /*                                                            @L2A*/  07950000
* /*02* OUTPUT =                                                @L1A*/  08000000
* /*                                                                */  08050000
* /*    PLS:  THE OUTPUT FROM THE SWAREQ MACRO CONSISTS OF      @L2C*/  08100000
* /*          INSTRUCTIONS TO CLEAN THE SAVE AREA ADDRESS,      @L1A*/  08150000
* /*          GET THE ADDRESS OF SWA MANAGER (IEFQB556)         @L1A*/  08200000
* /*          OR UNAUTHORIZED SWA MANAGER (IEFQBSVA)            @T0A*/  08225000
* /*          AND BRANCH TO IT, OR TO PRODUCE AN ERROR MESSAGE  @L1A*/  08250000
* /*          IF AN INVALID REQUEST IS ISSUED.                  @L1A*/  08300000
* /*          A RETURN CODE (EHARC) IS ALSO SET.                @D1A*/  08325000
* /*                                                                */  08350000
* /*    ASM:  IF MF=L:                                          @L2A*/  08400000
* /*           . THE GENERALIZED PARAMETER LIST:                @L2A*/  08450000
* /*             THE FIRST WORD IS THE ADDRESS OF THE           @L2A*/  08500000
* /*             POINTER TO THE EPA CHAIN.                      @L2A*/  08550000
* /*             THE SECOND WORD IS THE ADDRESS OF THE          @L2A*/  08600000
* /*             FUNCTION CODE.                                 @L2A*/  08650000
* /*          IF MF=M:                                          @L2A*/  08700000
* /*           . THE CODE TO SET/MODIFY THE PARAMETER LIST.     @L2A*/  08750000
* /*          IF MF=E:                                          @L2A*/  08800000
* /*           . THE INSTRUCTIONS TO SET/MODIFY THE PARAMETER   @L2A*/  08850000
* /*             LIST, TO CLEAN THE SAVE AREA ADDRESS, TO GET   @L2A*/  08900000
* /*             ADDRESS OF SWA MANAGER (IEFQB556) OR           @L2A*/  08933300
* /*             UNAUTHORIZED SWA MANAGER (IEFQBSVA) AND TO     @T0A*/  08966600
* /*             BRANCH TO IT.                                  @L2A*/  09000000
* /*                                                            @L2A*/  09050000
* /*02* EXIT - NORMAL =                                         @L1A*/  09100000
* /*                                                            @L2A*/  09150000
* /*        . CONDITION = NO ERRORS DETECTED                    @L2C*/  09200000
* /*        . OUTPUT    = REFER TO OUTPUT SECTION IN PROLOG     @L1A*/  09250000
* /*        . RETURN CODES = NONE                               @L1A*/  09300000
* /*                                                            @L2A*/  09350000
* /*02* EXIT - ERROR =                                          @L1A*/  09400000
* /*                                                            @L2A*/  09450000
* /*    PLS:. CONDITIONS =                                      @L2C*/  09500000
* /*           . INVALID FUNCTION REQUEST OR FUNCTION NOT       @L1A*/  09550000
* /*             REQUESTED                                      @L1A*/  09600000
* /*           . KEYWORD EPA IS MISSING                         @L1A*/  09650000
* /*           . MORE THAN 1 POSITIONAL PARAMETER IS PRESENT    @L1A*/  09700000
* /*           . MORE THAN 1 SUBPARAMETER ON KEYWORD EPA        @L1A*/  09750000
* /*           . INVALID VALUE SPECIFIED FOR THE KEYWORD UNAUTH @T0A*/  09775000
* /*   EHARC=4 - IEFJESCT NOT INCLUDED                          @D1A*/  09783300
* /*   EHARC=4 - UNAUTH=YES SPECIFIED WITHOUT AN EXTENDED EPA   @D1A*/  09791600
* /*                                                                */  09800000
* /*        . OUTPUT    =                                       @L1A*/  09850000
* /*           ERROR MNOTE ISSUED                               @L1A*/  09900000
* /*           RETURN CODE 4 MAY BE SET                         @D1A*/  09925000
* /*                                                                */  09950000
* /*    ASM:. CONDITIONS =                                      @L2A*/  10000000
* /*           . MACRO FORM REQUEST IS INVALID OR MISSING       @L2A*/  10050000
* /*           . INCORRECT NUMBER OF SUBPARAMETERS FOR          @L2A*/  10100000
* /*             MF=M OR E.                                     @L2A*/  10150000
* /*           . INVALID SPECIFICATION FOR ADDRESS OF PARAMETER @L2A*/  10200000
* /*             LIST FOR SWA MANAGER ON THE MF KEYWORD         @L2A*/  10250000
* /*           . INCORRECT NUMBER OF SUBPARAMETERS FOR REGISTER @L2A*/  10300000
* /*             FORM OF ADDRESS ON MF KEYWORD                  @L2A*/  10350000
* /*           . INVALID FUNCTION CODE                          @L2A*/  10400000
* /*           . MORE THAN 1 SUBPARAMETER ON KEYWORD FCODE      @L2A*/  10450000
* /*           . INVALID PARAMETER FOR EPA ADDRESS              @L2A*/  10500000
* /*           . MORE THAN 1 SUBPARAMETER ON KEYWORD EPA        @L2A*/  10550000
* /*           . SPECIFYING REGISTER FORM OF EPA WHEN MF=L      @L2A*/  10600000
* /*           . INVALID VALUE SPECIFIED FOR THE KEYWORD UNAUTH @T0A*/  10616600
* /*           . KEYWORD UNAUTH IS ONLY VALID FOR MF=E          @T0A*/  10633200
* /*                                                            @L2A*/  10650000
* /*        . OUTPUT    =                                       @L2A*/  10700000
* /*           . ERROR MNOTE ISSUED                             @L2A*/  10750000
* /*           . IF SEVERITY IS 4, CODE WILL BE GENERATED       @L2A*/  10800000
* /*             AS REQUESTED.                                  @L2A*/  10850000
* /*                                                            @L2A*/  10900000
* /*01* EXTERNAL REFERENCES = NONE                              @L1A*/  10950000
* /*                                                                */  11000000
* /*01* MESSAGES =                                              @L1A*/  11050000
* /*                                                                */  11100000
* /*    PLS:                                                    @L2A*/  11150000
* /*     . 'FUNCTION REQUEST IS INVALID OR MISSING'             @L1A*/  11200000
* /*     . 'KEYWORD ''EPA'' IS MISSING'                         @L1A*/  11250000
* /*     . 'MORE THAN 1 POSITIONAL PARAMETER PRESENT'           @L1A*/  11300000
* /*     . 'MORE THAN 1 SUBPARAMETER ON KEYWORD ''EPA'''        @L1A*/  11350000
* /*     . 'KEYWORD ''UNAUTH'' MUST BE SPECIFIED AS YES OR NO'  @T0A*/  11375000
* /*   'AHA0053 SWAREQ: MACRO IEFJESCT REQUIRED BUT WAS NOT     @D1A*/  11378100
* /*    FOUND BEFORE THIS INVOCATION'                           @D1A*/  11381200
* /*   'AHA0053 SWAREQ: INSERT OR MOVE THE INCLUDE OF IEFJESCT  @D1A*/  11384300
* /*    BEFORE THIS INVOCATION'                                 @D1A*/  11387400
* /*   'AHA0054 SWAREQ: KEYWORD 'UNAUTH' REQUIRES EXTENDED EPA  @D1A*/  11390500
* /*   'AHA0055 SWAREQ: KEYWORD 'UNAUTH' ALLOWED ONLY FOR       @D1A*/  11393600
* /*    FUNCTIONS 'LA' AND 'RL''                                @D1A*/  11396700
* /*                                                                */  11400000
* /*    ASM:                                                        */  11450000
* /*     . 'MACRO FORM REQUEST IS INVALID OR MISSING'           @L2A*/  11500000
* /*     . 'INCORRECT NUMBER OF SUBPARAMETERS FOR MF=M OR E'    @L2A*/  11550000
* /*     . 'INCORRECT NUMBER OF SUBPARAMETERS FOR REGISTER FORM @L2A*/  11600000
* /*        OF ADDRESS PARAMETER ON MF KEYWORD'                 @L2A*/  11650000
* /*     . 'ADDRESS PARAMETER ON MF KEYWORD IS MISSING OR       @L2A*/  11700000
* /*        INVALID'                                            @L2A*/  11750000
* /*     . 'FUNCTION REQUEST IS INVALID'                        @L2A*/  11800000
* /*     . 'MORE THAN 1 SUBPARAMETER ON KEYWORD ''FCODE'''      @L2A*/  11850000
* /*     . 'ADDRESS PARAMETER ON EPA KEYWORD IS INVALID'        @L2A*/  11900000
* /*     . 'MORE THAN 1 SUBPARAMETER ON KEYWORD ''EPA'''        @L2A*/  11950000
* /*     . 'REGISTER FORM OF EPA KEYWORD IS INVALID FOR MF=L'   @L2A*/  12000000
* /*     . 'KEYWORD ''UNAUTH'' MUST BE SPECIFIED AS YES OR NO'  @T0A*/  12016600
* /*     . 'KEYWORD ''UNAUTH'' IS ONLY VALID FOR MF=E'          @T0A*/  12033200
* /*                                                                */  12050000
* /*01*  ABEND CODES = N/A                                      @L1A*/  12100000
* /*                                                                */  12150000
* /*01*  SERIALIZATION = N/A                                    @L1A*/  12200000
* /*                                                                */  12250000
* /*01*  CHANGE ACTIVITY = ZA52669,L1,R1,L2,R2,T0,D1,L3         @L3C*/  12300000
* /*                                                                */  12350000
* /*  $L1=ALLVSCR  JBB2110 820605 PDD7: SWA MANAGER VSCR        @L1A*/  12391600
* /*  $R1=PAB0002  JBB2110 820608 PDD7: PTM PAB0002             @R1A*/  12433200
* /*  $L2=SWABOVE  JBB2220 850220 PDR6: SWA ABOVE THE LINE      @L2A*/  12474800
* /*  $R2=PA20697  JBB2220 851209 PDR6: PTM PA20697             @R2A*/  12516400
* /*  $T0=OY10290  JBB2220 871120 PDR6: UNAUTH SWA MANAGER SUPT @T0A*/  12558000
* /*  $D1=DEO0265  HBB4410 890918 PDCC: COMPILE ERROR CHECKING  @D1A*/  12579000
* /*  $L3=APPC1    HBB4420 890310 PDB3: APPC                    @L3A*/  12589500
* /*                                                                */  12600000
* /** END OF SPECIFICATIONS *****************************************/  12650000
*/* A  PROLOGUE                                                 @L1A*/  12700000
*/* C  CODE TO CLEAN UP SAVE AREA ADDRESS BEFORE CALL TO SWA    @L1A*/  12750000
*/*    MANAGER.                                                 @L1A*/  12800000
*/* A  CODE TO SURROUND THE INSTRUCTIONS THAT ISSUE THE CALL    @R1A*/  12850000
*/*    TO SWA MANAGER WITH A DO-END GROUP.                      @R1A*/  12900000
*/* A  CODE TO PROVIDE ASSEMBLER VERSION OF SWAREQ MACRO AND    @L2A*/  12950000
*/*    TO ADD NEW SWA MANAGER FUNCTION LOCATE/ALL (LA)          @L2A*/  13000000
*/* A  ADDED SKIP TO THE ANSWER STATEMENTS WHICH GENERATE THE   @R2A*/  13050000
*/*    MODIFIED SOURCE CODE.                                    @R2A*/  13100000
*/* A  SUPPORT TO PROVIDE THE INVOCATION OF THE UNAUTHORIZED    @T0A*/  13116600
*/*    VERSION OF SWA MANAGER FOR LOCATE/ALL REQUESTS           @T0A*/  13133200
*/* A  ADDED PLAS MACRO STATEMENTS TO CHECK FOR IEFJESCT BEING  @D1A*/  13135300
*/*    INCLUDED. SWAREQ WILL NOW ISSUE WARNING MESSAGES AND     @D1A*/  13137400
*/*    RETURN TO THE CALLER WITH A CONDITION CODE OF 4 IF THE   @D1A*/  13139500
*/*    JESCT WASN'T ALREADY INCLUDED.                           @D1A*/  13142600
*/* A  ADDED PLAS MACRO STATEMENTS TO CHECK FOR EXTENDED EPA    @D1A*/  13145800
*/*    BEING REQUESTED IF UNAUTH=YES IS CODED.                  @D1A*/  13147900
*/* A  ADDED PLAS MACRO STATEMENTS TO CHECK FOR ALLOWABLE       @D1A*/  13148600
*/*    FUNCTIONS IF UNAUTH=YES IS CODED.                        @D1A*/  13149300
*/* A  ADD SUPPORT FOR NEW FUNCTIONS AS, GB AND FB              @L3A*/  13149600
*                                                                       13150000
* % SWAREQ: MACRO KEYS(EPA,UNAUTH);              /*              @T0C*/ 13200000
*                                                                       13250000
*/* THESE DECLARES ARE EXTERNAL TO THIS MACRO DEFINITION        @D1A*/  13300000
*                                                                       13350000
*  DECLARE EHARC FIXED EXTERNAL;                 /*             @D1A*/  13355500
*  DECLARE IEFJESCT CHARACTER EXTERNAL;          /*             @D1A*/  13361000
*  DEACTIVATE IEFJESCT;                          /*             @D1A*/  13366500
*  DECLARE EPAEXTND CHARACTER EXTERNAL;          /*             @D1A*/  13372000
*                                                                       13377500
*/* THESE DECLARES ARE INTERNAL TO THIS MACRO DEFINITION        @D1C*/  13383000
*                                                                       13388500
*  DCL INCLUDE_MESSAGE CHAR;                                /*  @D1A*/  13394000
*  DCL (FCODE,MCALL,ERROR,ERRCK) CHAR;                                  13400000
*  DCL (BADFCODE,KEYPARM1,XTRPOSPM,KEYPARM2,KEYPARM3) CHAR; /*  @T0C*/  13450000
*  DCL (COMNT,COMNT2,COMNT3,COMNT4,COMNT5,COMNT6) CHAR;     /*  @T0C*/  13500000
*                                                                       13550000
*  EHARC = 0;                       /*                          @D1A*/  13575000
*  FCODE = MACLIST(1);              /* SET TO VALUE OF FIRST            13600000
*                                      POSITIONAL PARAMETER          */ 13650000
*                                                                       13700000
*/* RECONSTRUCT MACRO INVOCATION AS CODED BY USER. PUT IT IN COMMENT */ 13750000
*/* FORM FOR COMPILE STAGE.                                          */ 13800000
*                                                                       13850000
*  IF UNAUTH = '' THEN              /* DETERMINE IF UNAUTH SPECIFIED    13866600
*                                                                @T0A*/ 13883200
*    MCALL = '?SWAREQ (' || FCODE || ') EPA (' || EPA(1) || ')'; /*     13899800
*                                       REMOVED SEMICOLON    @ZA52669*/ 13916400
*  ELSE                             /* UNAUTH WAS SPECIFIED      @T0A*/ 13933000
*    MCALL = '?SWAREQ (' || FCODE || ') EPA (' || EPA(1) ||             13949600
*           ') UNAUTH ' || UNAUTH ; /*                           @T0A*/ 13966200
*                                                                       13982800
*  COMNT = COMMENT (MCALL);                                             14000000
*                                                                       14050000
*/* TEST FOR A VALID POSITIONAL PARAMETER (FUNCTION CODE)            */ 14100000
*                                                                       14150000
*  IF FCODE = 'AL' THEN             /* ASSIGN LOCATE                 */ 14200000
*  ERRCK = 'OK';                                                        14250000
*  IF FCODE = 'AC' THEN             /* ASSIGN CONDITIONAL    @ZA52669*/ 14300000
*  ERRCK = 'OK';                                                        14350000
*  IF FCODE = 'WL' THEN             /* WRITE LOCATE                  */ 14400000
*  ERRCK = 'OK';                                                        14450000
*  IF FCODE = 'RL' THEN             /* READ LOCATE                   */ 14500000
*  ERRCK = 'OK';                                                        14550000
*  IF FCODE = 'DB' THEN             /* DELETE BLOCK                  */ 14600000
*  ERRCK = 'OK';                                                        14650000
*  IF FCODE = 'LA' THEN             /* LOCATE ALL                @L2A*/ 14700000
*  ERRCK = 'OK';                    /*                           @L2A*/ 14750000
*  IF FCODE = 'AS' THEN             /* ASSIGN SPECIFIC           @L3A*/ 14757100
*  ERRCK = 'OK';                    /*                           @L3A*/ 14764200
*  IF FCODE = 'GB' THEN             /* GET BLOCK                 @L3A*/ 14771300
*  ERRCK = 'OK';                    /*                           @L3A*/ 14778400
*  IF FCODE = 'FB' THEN             /* FREE BLOCK                @L3A*/ 14785500
*  ERRCK = 'OK';                    /*                           @L3A*/ 14792600
*  IF ERRCK ^= 'OK' THEN            /* INVALID FUNCTION REQUEST      */ 14800000
*    DO;                                                                14850000
*      ERROR = 'YES';               /* INDICATE ERROR FOR LATER USE  */ 14900000
*      BADFCODE = 'FUNCTION REQUEST IS INVALID OR MISSING';             14950000
*      COMNT2 = COMMENT (BADFCODE); /* PUT MESSAGE IN COMMENT FORM   */ 15000000
*      ANS(COMNT2) SKIP ;           /* MESSAGE FOR COMPILE STAGE     */ 15050000
*      ANS MSG (BADFCODE);          /* MESSAGE FOR MACRO PROCESSING     15100000
*                                      STAGE                         */ 15150000
*    END;                                                               15200000
*                                                                       15250000
*/* TEST FOR OTHER ERRORS AS FOLLOWS                                 */ 15300000
*/* MISSING EPA KEYWORD OR NULL SUBPARAMETER.                        */ 15350000
*/* MORE THAN 1 POSITIONAL PARAMETER.                                */ 15400000
*/* MORE THAN 1 SUBPARAMETER ON EPA KEYWORD.                         */ 15450000
*/* MACRO IEFJESCT NOT INCLUDED                                  @D1A*/ 15466600
*/* UNAUTH SPECIFIED WITHOUT EXTENDED EPA                        @D1A*/ 15483200
*/* UNAUTH SPECIFIED FOR INVALID FUNCTIONS                       @D1A*/ 15491600
*                                                                       15500000
*/* IF THE MAPPING MACRO IEFJESCT HASN'T BEEN INCLUDED, ISSUE    @D1A*/ 15501300
*/* A MESSAGE AND SET THE 'ERROR' FLAG.                          @D1A*/ 15502600
*  IF IEFJESCT ^= 'IEFJESCT' THEN DO;                         /* @D1A*/ 15503900
*                                                                       15505200
*    ERRTEXT = 'AHA0053 SWAREQ: MACRO IEFJESCT REQUIRED BUT WAS ' ||    15506500
*              'NOT FOUND BEFORE THIS INVOCATION';   /* PRIME MESSAGE   15507800
*                                                       AREA     @D1A*/ 15509100
*    ANSWER MSG(ERRTEXT) NORESCAN;  /* PUT OUT MESSAGE           @D1A*/ 15510400
*    COMNT6 = COMMENT(ERRTEXT);   /* PUT MESSAGE IN COMMENT FORM @D1A*/ 15510800
*    ANS(COMNT6) SKIP ;           /* MESSAGE FOR COMPILE STAGE   @D1A*/ 15511200
*                                                                       15511700
*    ERRTEXT = 'AHA0053 SWAREQ: INSERT OR MOVE THE INCLUDE ' ||         15513000
*              'OF IEFJESCT BEFORE THIS INVOCATION';   /* PRIME MESSAGE 15514300
*                                                         AREA   @D1A*/ 15515600
*    ANSWER MSG(ERRTEXT) NORESCAN;  /* PUT OUT MESSAGE           @D1A*/ 15516900
*    COMNT6 = COMMENT(ERRTEXT);   /* PUT MESSAGE IN COMMENT FORM @D1A*/ 15517300
*    ANS(COMNT6) SKIP ;           /* MESSAGE FOR COMPILE STAGE   @D1A*/ 15517700
*                                                                       15518200
*    EHARC = 4;                   /* WARNING FROM MACRO PHASE    @D1A*/ 15520100
*  END;                                                       /* @D1A*/ 15522100
*                                                                       15523400
*/* IF THE UNAUTHORIZED INTERFACE WAS SPECIFIED, BUT THE         @D1A*/ 15524700
*/* EXTENDED EPA WAS NOT, ISSUE A MESSAGE AND SET THE 'ERROR'    @D1A*/ 15526000
*/* FLAG.                                                        @D1A*/ 15527300
*/*                                                              @D1A*/ 15528600
*                                                                       15529900
*  IF UNAUTH = '(YES)' &                                                15531200
*     EPAEXTND ^= 'YES' THEN DO;   /* IF UNAUTH WAS SPECIFIED, WAS      15532500
*                                     THE EXTENDED EPA DECLARED? @D1A*/ 15533800
*                                                                       15546800
*    ERRTEXT = 'AHA0054 SWAREQ: KEYWORD ''UNAUTH'' REQUIRES ' ||        15547000
*                 'EXTENDED EPA';  /* SET ERROR MESSAGE          @D1A*/ 15547200
*    ANSWER MSG(ERRTEXT) NORESCAN;  /* PUT OUT MESSAGE           @D1A*/ 15547400
*    COMNT6 = COMMENT(ERRTEXT);   /* PUT MESSAGE IN COMMENT FORM @D1A*/ 15547600
*    ANS(COMNT6) SKIP ;           /* MESSAGE FOR COMPILE STAGE   @D1A*/ 15547800
*                                                                       15548100
*    EHARC = 4;                   /* WARNING FROM MACRO PHASE    @D1A*/ 15548200
*  END;                            /*                            @D1A*/ 15548300
*                                                                       15548400
*  IF UNAUTH = '(YES)' & (FCODE ^= 'LA' & FCODE ^= 'RL') THEN DO;  /*   15548500
*                                     IF UNAUTH WAS SPECIFIED, WAS THE  15548600
*                                     FUNCTION ALLOWED?          @D1A*/ 15548700
*                                                                       15548800
*    ERRTEXT = 'AHA0055 SWAREQ: KEYWORD ''UNAUTH'' ALLOWED ONLY FOR' || 15548900
*          ' FUNCTIONS ''LA'' AND ''RL''';  /* SET ERROR MESSAGE @D1A*/ 15549000
*    ANSWER MSG(ERRTEXT) NORESCAN;  /* PUT OUT MESSAGE           @D1A*/ 15549100
*    COMNT6 = COMMENT(ERRTEXT);   /* PUT MESSAGE IN COMMENT FORM @D1A*/ 15549200
*    ANS(COMNT6) SKIP ;           /* MESSAGE FOR COMPILE STAGE   @D1A*/ 15549300
*                                                                       15549400
*    EHARC = 4;                   /* WARNING FROM MACRO PHASE    @D1A*/ 15549500
*  END;                            /*                            @D1A*/ 15549600
*                                                                       15549700
*  IF EPA(1) = '' THEN              /* WAS THERE AN EPA KEYWORD         15550000
*                                      PARAMETER                     */ 15600000
*    KEYPARM1 = 'KEYWORD ''EPA'' MISSING'; /* NO SET UP MESSAGE      */ 15650000
*  IF MACLIST(2) ^= '' THEN         /* MORE THAN 1 POSITIONAL           15700000
*                                      PARAMETER                     */ 15750000
*    XTRPOSPM = 'MORE THAN 1 POSITIONAL PARAMETER PRESENT'; /* YES   */ 15800000
*  IF EPA(2) ^= '' THEN             /* MORE THAN 1 SUBPARAMETER ON      15850000
*                                      EPA KEYWORD                   */ 15900000
*    KEYPARM2 = 'MORE THAN 1 SUBPARAMETER ON KEYWORD ''EPA'''; /* YES*/ 15950000
*  IF KEYPARM1 ^= '' THEN           /* WAS THERE AN EPA KEYWORD      */ 16000000
*    DO;                                                                16050000
*      ERROR = 'YES';               /* INDICATE ERROR FOR LATER USE  */ 16100000
*      COMNT3 = COMMENT (KEYPARM1); /* PUT MESSAGE IN COMMENT FORM   */ 16150000
*      ANS(COMNT3) SKIP ;           /* MESSAGE FOR COMPILE STAGE     */ 16200000
*      ANS MSG (KEYPARM1);          /* MESSAGE FOR MACRO PROCESSING     16250000
*                                      STAGE                         */ 16300000
*    END;                                                               16350000
*  IF KEYPARM2 ^= '' THEN           /* WAS THERE MORE THAN 1            16400000
*                                      SUBPARAMETER ON EPA KEYWORD   */ 16450000
*    DO;                                                                16500000
*      ERROR = 'YES';               /* INDICATE ERROR FOR LATER USE  */ 16550000
*      COMNT5 = COMMENT (KEYPARM2); /* PUT MESSAGE IN COMMENT FORM   */ 16600000
*      ANS(COMNT5) SKIP ;           /* MESSAGE FOR COMPILE STAGE     */ 16650000
*      ANS MSG (KEYPARM2);          /* MESSAGE FOR MACRO PROCESSING     16700000
*                                      STAGE                         */ 16750000
*    END;                                                               16800000
*  IF XTRPOSPM ^= '' THEN           /* WAS THERE MORE THAN 1            16850000
*                                      POSITIONAL PARAMETER          */ 16900000
*    DO;                                                                16950000
*      ERROR = 'YES';               /* INDICATE ERROR FOR LATER USE  */ 17000000
*      COMNT4 = COMMENT(XTRPOSPM);  /* PUT MESSAGE IN COMMENT FORM   */ 17050000
*      ANS(COMNT4) SKIP ;           /* MESSAGE FOR COMPILE STAGE     */ 17100000
*      ANS MSG (XTRPOSPM);          /* MESSAGE FOR MACRO PROCESSING     17150000
*                                      STAGE                         */ 17200000
*    END;                                                               17250000
*                                                                       17253100
*/* TEST FOR A VALID SPECIFICATION FOR UNAUTH KEYWORD.           @T0A*/ 17256200
*                                                                       17259300
*  IF UNAUTH ^= '' & UNAUTH ^= '(YES)' &                                17262400
*     UNAUTH ^= '(NO)' THEN         /* IF UNAUTH WAS SPECIFIED, DID     17265500
*                                      IT CONTAIN A VALID VALUE 8@T0A*/ 17268600
*    DO;                                                                17271700
*      ERROR = 'YES';               /* INDICATE ERROR FOR LATER USE  */ 17274800
*      KEYPARM3 = 'KEYWORD ''UNAUTH'' MUST BE SPECIFIED AS YES OR NO';  17277900
*      COMNT6 = COMMENT(KEYPARM3);  /* PUT MESSAGE IN COMMENT FORM   */ 17281000
*      ANS(COMNT6) SKIP ;           /* MESSAGE FOR COMPILE STAGE     */ 17284100
*      ANS MSG (KEYPARM3);          /* MESSAGE FOR MACRO PROCESSING     17287200
*                                      STAGE                         */ 17290300
*    END;                                                               17293400
*                                                                       17296500
*  IF ERROR = 'YES' THEN            /* IF THERE WAS AN ERROR A       */ 17300000
*  GOTO B;                          /* COMPILE STAGE MESSAGE HAS BEEN   17350000
*                                      GENERATED. SKIP THE NEXT         17400000
*                                      MESSAGE AND DON'T PASS A CALL    17450000
*                                      SWAMGR STATEMENT TO THE          17500000
*                                      COMPILE STAGE                 */ 17550000
*  ANS (COMNT) SKIP;                /* REPLICA OF THE MACRO             17600000
*                                      INVOCATION FOR A COMPILE         17650000
*                                      STAGE MESSAGE             @R2C*/ 17700000
*                                                                       17750000
*/* PASS THE STATEMENT TO THE COMPILE STAGE THAT WILL CALL THE SWA   */ 17800000
*/* MANAGER AND PASS THE PARAMETERS REQUESTED. THIS WILL BE BYPASSED */ 17850000
*/* IF ANY ERROR WAS DETECTED.                                       */ 17900000
*                                                                       17950000
*  ANS('DO;') SKIP;                                            /*@R2C*/ 18000000
*  ANS('GEN(LA    13,0(,13));') SKIP;                          /*@R2C*/ 18050000
*  IF UNAUTH = '(YES)' THEN         /* IF UNAUTHORIZED SERVICE          18066600
*                                      REQUESTED                3@T0A*/ 18083200
*     ANS('CALL USWAMGR (' || EPA(1) || ',''' || FCODE || ''');') SKIP; 18099800
*  ELSE                                                                 18116400
*     ANS('CALL SWAMGR (' || EPA(1) || ',''' || FCODE || ''');') SKIP;  18133000
*  ANS('END;') SKIP;                                           /*@R2C*/ 18150000
*  B:;                                                                  18190000
*  RETURN CODE(EHARC);              /* RETURN MACRO CODE         @D1A*/ 18230000
*                                                                       18250000
*% END  SWAREQ;                                                /*@L2C*/ 18350000
*% GOTO ENDMAC;                                                /*@L2A   18400000
         MACRO                                                     @L2A 18450000
&NAME    SWAREQ &FCODE=,&EPA=,&MF=,&UNAUTH=                        @T0C 18500000
         LCLC  &ERROR                      DEFINE SET SYMBOL ERROR @L2A 18550000
&ERROR   SETC  'NO'                        INIT ERROR TO 'NO'      @L2A 18600000
.*                                                                 @L2A 18650000
.********************************************************************** 18700000
.*                                                                @L2A* 18750000
.*   TEST THE MF KEYWORD TO DETERMINE THE FORM OF EXPANSION       @L2A* 18800000
.*   REQUESTED. THE THREE TYPES ALLOWED ARE:                      @L2A* 18850000
.*       L - LIST FORM                                            @L2A* 18900000
.*       M - MODIFY FORM                                          @L2A* 18950000
.*       E - EXECUTE FORM                                         @L2A* 19000000
.*   IF THE MF PARAMETER IS INVALID ISSUE AN MNOTE.               @L2A* 19050000
.*                                                                @L2A* 19100000
.********************************************************************** 19150000
.*                                                                @L2A  19200000
         AIF   ('&MF' EQ 'L').SWALIST      IS MACRO FORM=LIST     @L2A  19250000
         AIF   ('&MF(1)' EQ 'E' OR '&MF(1)' EQ 'M').SWAMDEX       @L2A  19300000
.*                                   IS MACRO FORM=MODIFY OR EXEC @L2A  19350000
         MNOTE 12,'SWAREQ: MACRO FORM REQUEST IS INVALID OR MISSING'    19400000
.*                                                                @L2A  19450000
         AGO   .MACEND                                                  19500000
.*                                                                @L2A  19550000
.********************************************************************** 19600000
.*                                                                @L2A* 19650000
.*   THIS IS THE PORTION OF THE MACRO COMMON TO THE MODIFY AND    @L2A* 19700000
.*   EXECUTE FORM OF SWAREQ. ON THE MODIFY AND EXECUTE FORM BOTH  @L2A* 19750000
.*   THE FORM (E OR M) AND THE ADDRESS OF THE PARAMETER LIST      @L2A* 19800000
.*   MUST BE SPECIFIED.                                           @L2A* 19850000
.*                                                                @L2A* 19900000
.********************************************************************** 19950000
.*                                                                @L2A  20000000
.SWAMDEX ANOP                                                     @L2A  20050000
.*                                                                @L2A  20100000
.********************************************************************** 20150000
.*                                                                @L2A* 20200000
.*   TEST THE ADDRESS PARAMETER SPECIFIED ON THE MF KEYWORD TO    @L2A* 20250000
.*   SEE IF IT IS PRESENT AND TO SEE IF IT IS SPECIFIED IN   .    @L2A* 20300000
.*   SYMBOL OR REGISTER FORM. IF VALID, PUT ADDRESS OF PARAMETER  @L2A* 20350000
.*   LIST INTO REGISTER 1. IF INVALID, ISSUE AN MNOTE.            @L2A* 20400000
.*                                                                @L2A* 20450000
.********************************************************************** 20500000
.*                                                                @L2A  20550000
         ANOP                                                     @L2A  20600000
         AIF   (T'&NAME EQ 'O').MFADDR WAS A LABEL SPECIFIED ON   @L2A  20650000
.*                                     THE MACRO CALL             @L2A  20700000
&NAME    DS    0H                      LABEL SPECIFIED ON MACRO CALL    20750000
*                                      FOR BRANCHING              @L2A  20800000
.MFADDR  ANOP                                                     @L2A  20850000
         AIF   (T'&MF(2) EQ 'O').ADDRINV  IS ADDRESS PARAMETER ON @L2A  20900000
.*                                        MF KEYWORD MISSING      @L2A  20950000
         AIF   ('&MF(2)'(1,1) EQ '(').MFREG  WAS THE ADDRESS SPECIFIED  21000000
.*                                           IN A REGISTER        @L2A  21050000
.MFSYMB  ANOP                       NO, A SYMBOL CONTAINS ADDRESS @L2A  21100000
         AIF   (T'&MF(2) EQ 'N').ADDRINV  IS ADDRESS PARAMETER ON @L2A  21150000
.*                                        MF KEYWORD INVALID      @L2A  21200000
         LA    1,&MF(2)                PUT THE ADDRESS OF THE PARAMETER 21250000
*                                      LIST IN REGISTER 1         @L2A  21300000
         AGO   .SUBMF                                             @L2A  21350000
.MFREG   ANOP                       YES, A REGISTER CONTAINS ADDR @L2A  21400000
         LR    1,&MF(2,1)              PUT THE ADDRESS OF THE PARAMETER 21450000
*                                      LIST IN REGISTER 1         @L2A  21500000
         AIF   (N'&MF(2) EQ 1).FCDECHK CORRECT NUMBER OF SUBPARMS @L2A  21550000
         MNOTE 04,'SWAREQ: INCORRECT NUMBER OF SUBPARAMETERS FOR REGIST*21600000
               ER FORM OF ADDRESS PARAMETER ON MF KEYWORD'        @L2A  21650000
         AGO   .SUBMF                                             @L2A  21700000
.ADDRINV ANOP                                                     @L2A  21750000
         MNOTE 12,'SWAREQ: ADDRESS PARAMETER ON MF KEYWORD IS MISSING  *21800000
               OR INVALID'                                        @L2A  21850000
         AGO   .MACEND                                            @L2A  21900000
.*                                                                @L2A  21950000
.********************************************************************** 22000000
.*                                                                @L2A* 22050000
.*   TEST TO SEE IF THE CORRECT NUMBER OF SUBPARAMETERS IS        @L2A* 22100000
.*   PRESENT ON THE MF KEYWORD. IF INVALID, ISSUE AN MNOTE.       @L2A* 22150000
.*                                                                @L2A* 22200000
.********************************************************************** 22250000
.*                                                                @L2A  22300000
.SUBMF   ANOP                                                     @L2A  22350000
         AIF   (N'&MF EQ 2).FCDECHK    CORRECT NUMBER OF SUBPARMS @L2A  22400000
         MNOTE 04,'SWAREQ: INCORRECT NUMBER OF SUBPARAMETERS FOR MF=M  *22450000
               OR E'                                              @L2A  22500000
.*                                                                @L2A  22550000
.********************************************************************** 22600000
.*                                                                @L2A* 22650000
.*   TEST FCODE TO SEE IF A FUNCTION CODE WAS SPECIFIED. IF       @L2A* 22700000
.*   PRESENT, VERIFY THAT IT IS A VALID TYPE. IF INVALID,         @L2A* 22750000
.*   ISSUE AN MNOTE AND SET ERROR TO 'YES'                        @L2A* 22800000
.*                                                                @L2A* 22850000
.********************************************************************** 22900000
.*                                                                @L2A  22950000
.FCDECHK ANOP                                                     @L2A  23000000
         AIF   (T'&FCODE EQ 'O').EPACHK        IS FCODE NULL      @L2A  23050000
         AIF   ('&FCODE(1)' EQ 'AL').FCDEOK1   ASSIGN LOCATE      @L2A  23100000
         AIF   ('&FCODE(1)' EQ 'AC').FCDEOK1   ASSIGN CONDITIONAL @L2A  23150000
         AIF   ('&FCODE(1)' EQ 'WL').FCDEOK1   WRITE LOCATE       @L2A  23200000
         AIF   ('&FCODE(1)' EQ 'RL').FCDEOK1   READ LOCATE        @L2A  23250000
         AIF   ('&FCODE(1)' EQ 'DB').FCDEOK1   DELETE BLOCK       @L2A  23300000
         AIF   ('&FCODE(1)' EQ 'LA').FCDEOK1   LOCATE ALL         @L2A  23350000
         AIF   ('&FCODE(1)' EQ 'AS').FCDEOK1   ASSIGN SPECIFIC    @L3A  23362500
         AIF   ('&FCODE(1)' EQ 'GB').FCDEOK1   GET BLOCK          @L3A  23375000
         AIF   ('&FCODE(1)' EQ 'FB').FCDEOK1   FREE BLOCK         @L3A  23387500
         MNOTE 12,'SWAREQ: FUNCTION REQUEST IS INVALID'           @L2A  23400000
&ERROR   SETC  'YES'                           SET INVALID        @L2A  23450000
         AGO   .SUBFCDE                                           @L2A  23500000
.FCDEOK1 ANOP                                                     @L2A  23550000
         LA    0,=CL2'&FCODE(1)'       GET ADDRESS OF FCODE       @L2A  23600000
         ST    0,4(,1)                 PUT ADDRESS OF FCODE IN THE      23650000
*                                      2ND WORD OF PARAMETER LIST @L2A  23700000
.*                                                                @L2A  23750000
.********************************************************************** 23800000
.*                                                                @L2A* 23850000
.*      TEST FOR AN EXTRA SUBPARAMETER IN THE FUNCTION REQUEST.   @L2A* 23900000
.*      IF PRESENT, ISSUE AN MNOTE.                               @L2A* 23950000
.*                                                                @L2A* 24000000
.********************************************************************** 24050000
.*                                                                @L2A  24100000
.SUBFCDE ANOP                                                     @L2A  24150000
         AIF   (N'&FCODE LE 1).EPACHK        NO EXTRA SUBPARM     @L2A  24200000
         MNOTE 04,'SWAREQ: MORE THAN 1 SUBPARAMETER ON KEYWORD ''FCODE'*24250000
               ''                                                 @L2A  24300000
.*                                                                @L2A  24350000
.********************************************************************** 24400000
.*                                                                @L2A* 24450000
.*      TEST EPA TO SEE IF IT WAS SPECIFIED. IF PRESENT, VERIFY   @L2A* 24500000
.*      THAT IT IS IN VALID SYMBOL OR REGISTER FORM. IF INVALID,  @L2A* 24550000
.*      ISSUE AN MNOTE AND SET ERROR TO 'YES'.                    @L2A* 24600000
.*                                                                @L2A* 24650000
.********************************************************************** 24700000
.*                                                                @L2A  24750000
.EPACHK  ANOP                                                     @L2A  24800000
         AIF   (T'&EPA EQ 'O').UNAUCHK       IS EPA PARM NULL     @T0C  24850000
         AIF   ('&EPA'(1,1) EQ '(').EPAREG   WAS ADDRESS SPECIFIED      24900000
.*                                           IN A REGISTER        @L2A  24950000
.EPASYM  ANOP                          NO, A SYMBOL CONTAINS ADDR @L2A  25000000
         AIF   (T'&EPA EQ 'N').EPAINV1 IS THE ADDRESS INVALID     @L2A  25050000
         LA    0,&EPA                  GET ADDRESS OF EPAPTR      @L2A  25100000
         ST    0,0(,1)                 PUT ADDRESS OF EPAPTR IN THE     25150000
*                                      1ST WORD OF PARAMETER LIST @L2A  25200000
         AGO   .UNAUCHK                                           @T0C  25250000
.EPAREG  ANOP                          YES,A REGISTER CONTAINS ADDR@L2A 25300000
         ST    &EPA(1),0(,1)           PUT ADDRESS OF EPAPTR IN THE     25350000
*                                      1ST WORD OF PARAMETER LIST @L2A  25400000
         AGO   .SUBEPA                                            @L2A  25450000
.EPAINV1 ANOP                                                     @L2A  25500000
         MNOTE 12,'SWAREQ: ADDRESS PARAMETER ON EPA KEYWORD IS INVALID' 25550000
.*                                                                @L2A  25600000
&ERROR   SETC  'YES'                   SET INVALID                @L2A  25650000
.*                                                                @L2A  25700000
.********************************************************************** 25750000
.*                                                                @L2A* 25800000
.*      TEST FOR AN EXTRA SUBPARAMETER IN THE EPA PARAMETER. IF   @L2A* 25850000
.*      PRESENT, ISSUE AN MNOTE.                                  @L2A* 25900000
.*                                                                @L2A* 25950000
.********************************************************************** 26000000
.*                                                                @L2A  26050000
.SUBEPA  ANOP                                                     @L2A  26100000
         AIF   (N'&EPA LE 1).UNAUCHK   NO EXTRA SUBPARM ON EPA    @T0C  26150000
         MNOTE 04,'SWAREQ: MORE THAN 1 SUBPARAMETER ON KEYWORD ''EPA''' 26200000
.*                                                                @L2A  26250000
.*                                                                      26252500
.********************************************************************** 26255000
.*                                                                    * 26257500
.*      TEST TO SEE IF THE UNAUTH KEYWORD WAS VALIDLY SPECIFIED       * 26260000
.*                                                                    * 26262500
.********************************************************************** 26265000
.*                                                                      26267500
.UNAUCHK ANOP                                                     @T0A  26270000
         AIF   (T'&UNAUTH EQ 'O').SWAEXEC    IS UNAUTH PARM NULL  @T0A  26272500
         AIF   ('&UNAUTH' EQ 'YES').UNAUEXEC IS UNAUTH PARM YES   @T0A  26275000
         AIF   ('&UNAUTH' EQ 'NO').UNAUEXEC  IS UNAUTH PARM NO    @T0A  26277500
         MNOTE 12,'SWAREQ: KEYWORD ''UNAUTH'' MUST BE SPECIFIED AS YES *26280000
               OR NO'                                             @T0A  26282500
&ERROR   SETC  'YES'                   SET INVALID                @T0A  26285000
.UNAUEXEC ANOP                                                    @T0A  26287500
         AIF   ('&MF(1)' EQ 'E').SWAEXEC   IS MACRO FORM EXEC     @T0A  26290000
         MNOTE 12,'SWAREQ: KEYWORD ''UNAUTH'' IS ONLY VALID FOR MF=E'  *26292500
                                                                  @T0A  26295000
&ERROR   SETC  'YES'                   SET INVALID                @T0A  26297500
.*                                                                @L2A  26300000
.********************************************************************** 26350000
.*                                                                @L2A* 26400000
.*      TEST TO SEE IF MACRO FORM IS EXEC. IF YES, TEST ERROR     @L2A* 26450000
.*      TO SEE IF THE MACRO CALL IS VALID. IF VALID SET UP THE    @L2A* 26500000
.*      CALL TO THE SWA MANAGER.                                  @L2A* 26550000
.*                                                                @L2A* 26600000
.********************************************************************** 26650000
.*                                                                @L2A  26700000
.SWAEXEC ANOP                                                     @L2A  26750000
         AIF   ('&MF(1)' NE 'E').MACEND    IS MACRO FORM NOT EXEC @L2A  26800000
         AIF   ('&ERROR' EQ 'YES').MACEND  IS MACRO CALL VALID    @L2A  26850000
         LA    13,0(,13)               PREPARE R13 FOR CALL       @L2A  26900000
         L     15,CVTPTR               GET POINTER TO CVT         @L2A  26950000
         USING CVTMAP,15                                          @L2A  27000000
         L     15,CVTJESCT             GET POINTER TO JESCT       @L2A  27050000
         USING JESCT,15                                           @L2A  27100000
         L     15,JESCTEXT             GET POINTER TO JESCTEXT    @L2A  27150000
         USING JESPEXT,15                                         @L2A  27200000
         AIF   ('&UNAUTH' EQ 'YES').USWAMGR   WAS UNAUTHORIZED         *27216600
                                       SERVICE REQUESTED?         @T0A  27233200
         L     15,JESQB556             GET ADDRESS OF SWA MANAGER @L2A  27250000
         DROP  15                                                 @L2A  27300000
         BASSM 14,15                   BRANCH TO SWA MANAGER      @L2A  27350000
         AGO   .MACEND                                                  27356200
.USWAMGR ANOP                          UNAUTHORIZED SERVICE REQUESTED  *27362400
                                                                  @T0A  27368600
         L     15,JESQBSVA             GET ADDRESS OF UNAUTHORIZED     *27374800
                                       SWA MANAGER                @T0A  27381000
         DROP  15                                                 @T0A  27387200
         BALR  14,15                   BRANCH TO SWA MANAGER      @T0A  27393400
         AGO   .MACEND                                            @L2A  27400000
.*                                                                @L2A  27450000
.********************************************************************** 27500000
.*                                                                @L2A* 27550000
.*      THIS IS THE LIST FORM OF THE MACRO. IT WILL GENERATE THE  @L2A* 27600000
.*      GENERALIZED PARAMETER LIST. IF THE EPA AND FCODE ARE      @L2A* 27650000
.*      PRESENT THEY WILL ALSO BE PROCESSED.                      @L2A* 27700000
.*                                                                @L2A* 27750000
.********************************************************************** 27800000
.*                                                                @L2A  27850000
.SWALIST ANOP                                                     @L2A  27900000
&NAME    DS    0F                      SWA MANAGER PARAMETER LIST @L2A  27950000
.*                                                                @L2A  28000000
.********************************************************************** 28050000
.*                                                                @L2A* 28100000
.*      TEST EPA TO SEE IF IT WAS SPECIFIED. IF PRESENT, VERIFY   @L2A* 28150000
.*      THAT IT IS NOT A REGISTER SINCE FOR MF=L REGISTERS ARE    @L2A* 28200000
.*      NOT VALID. IF INVALID, ISSUE AND MNOTE. IF VALID,         @L2A* 28250000
.*      GENERATE THE EPA PORTION OF THE PARAMETER LIST USING THE  @L2A* 28300000
.*      VALUE OF THE EPA GIVEN. IF NOT PRESENT, GENERATE A DS     @L2A* 28350000
.*      FOR THE EPA.                                              @L2A* 28400000
.*                                                                @L2A* 28450000
.********************************************************************** 28500000
.*                                                                @L2A  28550000
         AIF   (T'&EPA EQ 'O').NULLEPA IS EPA NULL                @L2A  28600000
         AIF   ('&EPA'(1,1) EQ '(').EPAINV2 IS EPA IN REGISTER FORM@L2A 28650000
EPA@&SYSNDX DC A(&EPA)                 ADDR OF EPA FOR SWA MANAGER@L2A  28700000
         AGO   .FCDCHK                                            @L2A  28750000
.EPAINV2 ANOP                                                     @L2A  28800000
         MNOTE 12,'SWAREQ: REGISTER FORM OF EPA KEYWORD IS INVALID FOR *28850000
               MF=L'                                              @L2A  28900000
         AGO   .FCDCHK                                            @L2A  28950000
.NULLEPA ANOP                                                     @L2A  29000000
EPA@&SYSNDX DS A                       ADDR OF EPA FOR SWA MANAGER@L2A  29050000
.*                                                                @L2A  29100000
.********************************************************************** 29150000
.*                                                                @L2A* 29200000
.*   TEST FCODE TO SEE IF A FUNCTION CODE WAS SPECIFIED. IF       @L2A* 29250000
.*   PRESENT, VERIFY THAT IT IS A VALID TYPE. IF INVALID,         @L2A* 29300000
.*   ISSUE AN MNOTE. IF VALID, GENERATE THE FCODE PORTION OF THE  @L2A* 29350000
.*   PARAMETER LIST USING THE VALUE OF THE FCODE GIVEN. IF NOT    @L2A* 29400000
.*   PRESENT, GENERATE A DS FOR THE FCODE.                        @L2A* 29450000
.*                                                                @L2A* 29500000
.********************************************************************** 29550000
.*                                                                @L2A  29600000
.FCDCHK  ANOP                                                     @L2A  29650000
         AIF   (T'&FCODE EQ 'O').NULLFCD       IS FCODE NULL      @L2A  29700000
         AIF   ('&FCODE(1)' EQ 'AL').FCDEOK2   ASSIGN LOCATE      @L2A  29750000
         AIF   ('&FCODE(1)' EQ 'AC').FCDEOK2   ASSIGN CONDITIONAL @L2A  29800000
         AIF   ('&FCODE(1)' EQ 'WL').FCDEOK2   WRITE LOCATE       @L2A  29850000
         AIF   ('&FCODE(1)' EQ 'RL').FCDEOK2   READ LOCATE        @L2A  29900000
         AIF   ('&FCODE(1)' EQ 'DB').FCDEOK2   DELETE BLOCK       @L2A  29950000
         AIF   ('&FCODE(1)' EQ 'LA').FCDEOK2   LOCATE ALL         @L2A  30000000
         AIF   ('&FCODE(1)' EQ 'AS').FCDEOK2   ASSIGN SPECIFIC    @L3A  30012500
         AIF   ('&FCODE(1)' EQ 'GB').FCDEOK2   GET BLOCK          @L3A  30025000
         AIF   ('&FCODE(1)' EQ 'FB').FCDEOK2   FREE BLOCK         @L3A  30037500
         MNOTE 12,'SWAREQ: FUNCTION REQUEST IS INVALID'           @L2A  30050000
         AGO   .SUBFCD                                            @L2A  30100000
.FCDEOK2 ANOP                                                     @L2A  30150000
FCD@&SYSNDX DC A(FCDE&SYSNDX)          ADDR OF FUNCTION CODE FOR  @L2A  30200000
*                                      SWA MANAGER                @L2A  30250000
FCDE&SYSNDX DC CL2'&FCODE(1)'          FUNCTION CODE              @L2A  30300000
.*                                                                @L2A  30350000
.********************************************************************** 30400000
.*                                                                @L2A* 30450000
.*      TEST FOR AN EXTRA SUBPARAMETER IN THE FUNCTION REQUEST.   @L2A* 30500000
.*      IF PRESENT, ISSUE AN MNOTE.                               @L2A* 30550000
.*                                                                @L2A* 30600000
.********************************************************************** 30650000
.*                                                                @L2A  30700000
.SUBFCD  ANOP                                                     @L2A  30750000
         AIF   (N'&FCODE LE 1).MACEND        NO EXTRA SUBPARM     @L2A  30800000
         MNOTE 04,'SWAREQ: MORE THAN 1 SUBPARAMETER ON KEYWORD ''FCODE'*30850000
               ''                                                 @L2A  30900000
         AGO   .MACEND                                            @L2A  30950000
.NULLFCD ANOP                                                     @L2A  31000000
FCD@&SYSNDX DS A                       ADDR OF FUNCTION CODE FOR  @L2A  31050000
*                                      SWA MANAGER                @L2A  31100000
.MACEND  ANOP                                                     @L2A  31150000
         MEND                                                     @L2A  31200000
*                                                               @L2A*/  31250000
* %ENDMAC: ;                                                  /*@L2A*/  31300000
