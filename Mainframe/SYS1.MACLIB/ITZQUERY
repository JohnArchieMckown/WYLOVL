*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  ITZQUERY                              -08/11/99-<0> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  Transaction Trace Query                       * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00600000
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00650000
*                                                                     * 00700000
* STATUS= JBB6609                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      This service is used to query if the particular transaction or * 01100000
*      work unit needs to be traced.                                  * 01150000
*                                                                     * 01200000
*01* EXTERNAL CLASSIFICATION:  PI                                     * 01250000
*                                                                     * 01600000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01650000
*                                                                     * 01700000
*01* ENVIRONMENT:                                                     * 01750000
*                                                                     * 01800000
*                                                                     * 01850000
*      Minimum authorization: Problem state.  PSW key 8-15.           * 01900000
*                                                                     * 01950000
*      Dispatchable unit mode: Task or SRB mode.                      * 02000000
*                                                                     * 02050000
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 02100000
*                                                                     * 02150000
*      AMODE:            31-bit.                                      * 02200000
*                                                                     * 02250000
*      ASC mode:         Primary.                                     * 02300000
*                                                                     * 02350000
*      Interrupt status: Enabled for I/O and external interrupts.     * 02400000
*                                                                     * 02450000
*      Locks:            No locks held.                               * 02500000
*                                                                     * 02550000
*      Control parameters: Control parameters must be in the primary  * 02583300
*                        address space.                               * 02616600
*                                                                     * 02650000
*                                                                     * 02700000
*                                                                     * 02750000
*01* PROGRAMMING REQUIREMENTS:                                        * 02800000
*                                                                     * 02850000
*    Any module that invokes this macro must include the macros CVT   * 02900000
*    and IHAECVT.  e.g. in PL/X - %INCLUDE SYSLIB(CVT),  %INCLUDE     * 02950000
*    SYSLIB(IHAECVT)                                                  * 03000000
*                                                                     * 03150000
*01* RESTRICTIONS:                                                    * 03200000
*                                                                     * 03250000
*01* INPUT REGISTER INFORMATION:                                      * 03300000
*                                                                     * 03350000
*    Before issuing the ITZQUERY macro, the caller must ensure that   * 03370800
*    the following general purpose registers (GPRs) contain the       * 03391600
*    specified information:                                           * 03412400
*                                                                     * 03433200
*                                                                     * 03454000
*    REGISTER  CONTENTS                                               * 03474800
*                                                                     * 03495600
*    13        The address of a 72-byte standard save area in the     * 03516400
*              primary address space                                  * 03537200
*                                                                     * 03558000
*                                                                     * 03578800
*                                                                     * 03600000
*    Before issuing the ITZQUERY macro, the caller does not have to   * 03650000
*    place any information into any AR                                * 03700000
*                                                                     * 03850000
*01* OUTPUT REGISTER INFORMATION:                                     * 03900000
*                                                                     * 03950000
*    When control returns to the caller, the GPRs contain:            * 04000000
*                                                                     * 04050000
*                                                                     * 04100000
*    REGISTER  CONTENTS                                               * 04150000
*                                                                     * 04200000
*    0         Unchanged                                              * 04250000
*                                                                     * 04300000
*    1         Used as work register by the system                    * 04350000
*                                                                     * 04400000
*    2-13      Unchanged                                              * 04450000
*                                                                     * 04500000
*    14        Used as work register by the system                    * 04537500
*                                                                     * 04575000
*    15        Contains the return code.                              * 04612500
*                                                                     * 04650000
*                                                                     * 04700000
*                                                                     * 04750000
*    When control returns to the caller, the ARs contain:             * 04800000
*                                                                     * 04850000
*                                                                     * 04900000
*    REGISTER  CONTENTS                                               * 04950000
*                                                                     * 05000000
*    0-1       Used as work registers by the system                   * 05050000
*                                                                     * 05100000
*    2-13      Unchanged                                              * 05150000
*                                                                     * 05200000
*    14-15     Used as work registers by the system                   * 05250000
*                                                                     * 05300000
*                                                                     * 05350000
*                                                                     * 05400000
*    Some callers depend on register contents remaining the same      * 05450000
*    before and after issuing a service.  If the system changes the   * 05500000
*    contents of registers on which the caller depends, the caller    * 05550000
*    must save them before issuing the service, and restore them      * 05600000
*    after the system returns control.                                * 05650000
*                                                                     * 05700000
*01* PERFORMANCE IMPLICATIONS:                                        * 05750000
*                                                                     * 05800000
*    Specifying the MONTKN in a monitoring environment results in a   * 05850000
*    faster query.                                                    * 05900000
*                                                                     * 05950000
*01* SYNTAX:                                                          * 06000000
*                                                                     * 06050000
*[xlabel]  ITZQUERY   [ MONTKN=xmontkn|0]                           * 06100000
*                      ,TRACETKN=xtracetkn                            * 06300000
*                     [,TRACELVL=xtracelvl]                           * 06350000
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 06600000
*                    [,MF=S]                                         * 06650000
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 06700000
*                    [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]            * 06733300
*                    [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]            * 06766600
*                                                                     * 06800000
*                                                                     * 06850000
*      Where:                                                         * 06900000
*                                                                     * 06950000
*                                                                     * 07000000
*      [xlabel]                                                       * 07050000
*          is an optional symbol, starting in column 1, that is the   * 07100000
*          name on the ITZQUERY macro invocation.  The name must      * 07150000
*          conform to the rules for an ordinary assembler language    * 07200000
*          symbol.                                                    * 07250000
*          DEFAULT: No name.                                          * 07300000
*                                                                     * 07350000
*                                                                     * 07400000
*                                                                     * 07450000
*                                                                     * 07500000
*      [MONTKN=xmontkn|0]                                           * 07550000
*          is the name (RS-type) of an optional fullword input that   * 07600000
*          is the token used to locate the current monitoring         * 07650000
*          environment.                                               * 07700000
*                                                                     * 09250000
*          It is recommended that MONTKN be specified for a           * 09300000
*          monitoring environment to keep the query pathlength short  * 09350000
*          and fast.                                                  * 09400000
*          DEFAULT: 0                                                 * 09450000
*                                                                     * 09800000
*                                                                     * 09850000
*                                                                     * 09900000
*                                                                     * 09950000
*      TRACETKN=xtracetkn                                             * 10000000
*          is the name (RS-type) of a required 32 character output    * 10050000
*          that specifies the transaction trace token returned from   * 10083300
*          query.                                                     * 10116600
*                                                                     * 10150000
*                                                                     * 10200000
*                                                                     * 10250000
*                                                                     * 10300000
*      [TRACELVL=xtracelvl]                                           * 10350000
*          is the name (RS-type) of an optional byte output that      * 10400000
*          specifies the transaction trace indicator returned from    * 10450000
*          query. A non-zero value implies that this work unit is     * 10500000
*          eligible for tracing. A value of zero implies that this    * 10550000
*          work unit is not eligible for tracing. In that case the    * 10600000
*          trace token is also set to zero.                           * 10650000
*                                                                     * 12600000
*                                                                     * 12650000
*                                                                     * 12700000
*                                                                     * 12750000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 12800000
*          is an optional byte input decimal value in the "0-0" range * 12850000
*          that specifies the macro version.  PLISTVER is the only    * 12900000
*          key allowed on the list form of MF and determines which    * 12950000
*          parameter list is generated (see Macro USAGE NOTE 2).      * 13000000
*          Note that MAX may be specified instead of a number, and    * 13050000
*          the parameter list will be of the largest size currently   * 13100000
*          supported. This size may grow from release to release      * 13150000
*          (thus possibly affecting the amount of storage needed by   * 13200000
*          your program).  If your program can tolerate this, IBM     * 13250000
*          recommends that you always specify MAX when creating the   * 13300000
*          list form parameter list as that will ensure that the list * 13350000
*          form parameter list is always long enough to hold whatever * 13400000
*          parameters might be specified on the execute form.         * 13450000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 13500000
*          default is the lowest version which allows all of the      * 13550000
*          parameters specified on the invocation to be processed.    * 13600000
*                                                                     * 13650000
*                                                                     * 13700000
*                                                                     * 13750000
*                                                                     * 13800000
*      [MF=S|L|M|E]                                                 * 13850000
*          is an optional keyword input which specifies the macro     * 13900000
*          form.                                                      * 13950000
*          DEFAULT: S                                                 * 14000000
*                                                                     * 14050000
*                                                                     * 14100000
*          [MF=S]                                                     * 14150000
*              specifies the standard form of the macro.  The "S"     * 14200000
*              form generates code to put the parameters into an      * 14250000
*              in-line parameter list and invoke the desired service. * 14300000
*              Full checking for required macro keys is done along    * 14350000
*              with supplying defaults for omitted optional           * 14400000
*              parameters.                                            * 14450000
*                                                                     * 14500000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 14550000
*              specifies the list form of the macro.  The "L" form    * 14600000
*              defines an area to be used for the parameter list.     * 14650000
*              Only the PLISTVER key may be specified on the          * 14700000
*              invocation.  All other macro parameters are flagged as * 14750000
*              errors.  If PLISTVER is not specified, the original    * 14800000
*              parameter list definition is used.                     * 14850000
*                                                                     * 14900000
*            ,xmfctrl                                                 * 14950000
*              is a required input.  It is the name of a storage area * 15000000
*              for the parameter list.                                * 15050000
*                                                                     * 15100000
*            ,xmfattr|0D                                            * 15150000
*              is an optional 60 character input string that varies   * 15200000
*              from 1 to 60 characters. Use it to force boundary      * 15250000
*              alignment of the parameter list. Use only 0F or 0D.    * 15300000
*              DEFAULT: 0D which forces the parameter list to a       * 15350000
*              doubleword boundary.                                   * 15400000
*                                                                     * 15450000
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 15500000
*              specifies the modify form of the macro.  The "M" form  * 15550000
*              generates code to put the parameters into the          * 15600000
*              parameter list specified by xmfctrl.                   * 15650000
*                                                                     * 15750000
*            ,xmfctrl                                                 * 15800000
*              is a required input.  It is the name (RS-type), or     * 15850000
*              address in register (1)-(12), of a storage area for    * 15900000
*              the parameter list.                                    * 15950000
*                                                                     * 16000000
*            ,COMPLETE|NOCHECK]                                     * 16050000
*              is an optional keyword input which specifies the       * 16100000
*              degree of macro parameter syntax checking.             * 16150000
*              DEFAULT: COMPLETE                                      * 16200000
*                                                                     * 16250000
*                                                                     * 16300000
*              COMPLETE                                               * 16350000
*                  Checking for required macro keys is done and       * 16400000
*                  defaults are supplied for omitted optional         * 16450000
*                  parameters.  (See Macro Usage Note 2).             * 16451400
*                                                                     * 16452800
*              NOCHECK                                                * 16454200
*                  Checking for required macro keys is not done nor   * 16455600
*                  are defaults supplied for omitted optional         * 16457000
*                  parameters.                                        * 16458400
*                                                                     * 16459800
*                                                                     * 16461200
*                                                                     * 16462600
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 16464000
*              specifies the execute form of the macro.  The "E" form * 16465400
*              generates code to put the parameters into the          * 16466800
*              parameter list specified by xmfctrl and invoke the     * 16468200
*              desired service.                                       * 16469600
*                                                                     * 16471000
*            ,xmfctrl                                                 * 16472400
*              is a required input.  It is the name (RS-type), or     * 16473800
*              address in register (1)-(12), of a storage area for    * 16475200
*              the parameter list.                                    * 16476600
*                                                                     * 16478000
*            ,COMPLETE|NOCHECK                                      * 16479400
*              is an optional keyword input which specifies the       * 16480800
*              degree of macro parameter syntax checking.             * 16482200
*              DEFAULT: COMPLETE                                      * 16483600
*                                                                     * 16485000
*                                                                     * 16486400
*              COMPLETE                                               * 16487800
*                  Checking for required macro keys is done and       * 16489200
*                  defaults are supplied for omitted optional         * 16490600
*                  parameters.  (See Macro Usage Note 2).             * 16492000
*                                                                     * 16493400
*              NOCHECK                                                * 16494800
*                  Checking for required macro keys is not done nor   * 16496200
*                  are defaults supplied for omitted optional         * 16497600
*                  parameters.                                        * 16500000
*                                                                     * 16550000
*                                                                     * 16600000
*                                                                     * 16650000
*                                                                     * 16700000
*                                                                     * 16750000
*                                                                     * 16800000
*                                                                     * 16850000
*01* RETURN CODES:                                                    * 16900000
*                                                                     * 16950000
*                                                                     * 17000000
*       0         NAME: ITZGOOD                                       * 17050000
*                                                                     * 17100000
*                 Meaning: Success                                    * 17107600
*                                                                     * 17115200
*                 Action: trace this work unit. Trace token is        * 17122800
*                 non-zero                                            * 17130400
*                                                                     * 17138000
*       4         NAME: ITZNOTR                                       * 17145600
*                                                                     * 17153200
*                 Meaning: Work unit not to be traced.                * 17160800
*                                                                     * 17168400
*                 Action: do not trace this work unit.                * 17176000
*                                                                     * 17183600
*                                                                     * 17191200
*                                                                     * 17200000
*01* REASON CODES:  None.                                             * 17250000
*                                                                     * 21750000
*01* MODULE TYPE:  ASSEM MACRO                                        * 21800000
*                                                                     * 21850000
*02*   PROCESSOR:  ASSEM                                              * 21900000
*                                                                     * 21950000
*01* COMPONENT:  SCTTR                                                * 22000000
*                                                                     * 22050000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 22100000
*                                                                     * 22150000
*01* ABEND CODES:  None.                                              * 22200000
*                                                                     * 22250000
*01* EXAMPLES:                                                        * 22300000
*                                                                     * 22350000
*01* MACRO USAGE NOTES:                                               * 22400000
*                                                                     * 22450000
*                                                                     * 22500000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 22550000
*        global macro variable.  Any value other than 'NO' will       * 22600000
*        result in the macro expansion being printed.  The default is * 22650000
*        'YES'.  The following examples illustrate how the ZPRINT     * 22700000
*        variable should be set.                                      * 22750000
*                                                                     * 22800000
*                    GBLC &ZPRINT                                     * 22850000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 22900000
*                                                                     * 22950000
*                                                                     * 23000000
*    2.  When using the NOCHECK option in conjunction with the Modify * 23007100
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 23014200
*        Modify   or  Execute  form  invocation  which  specifies  or * 23021300
*        defaults  to  the  COMPLETE  option.   This insures that the * 23028400
*        parameter  list  is  initialized completely.   The parameter * 23035500
*        list  field which identifies the version number of the macro * 23042600
*        is only set when the Standard form or the Complete option of * 23049700
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 23056800
*        explicitly  specified.  Be sure that the resulting parameter * 23063900
*        list version number covers all the keys that you use.        * 23071000
*                                                                     * 23078100
*                                                                     * 23085200
*    3.  All   keys   currently   contained  in  the  ITZQUERY  macro * 23092300
*        correspond  to  version  0.   If you specify PLISTVER, use a * 23100000
*        value of 0 or MAX.                                           * 23150000
*                                                                     * 23200000
*                                                                     * 23250000
*                                                                     * 23300000
*                                                                     * 23350000
*01* CHANGE ACTIVITY:                                                 * 23400000
*                                                                     * 23450000
*   Flag LineItem  FMID    Date   ID    Comment                       * 23500000
*                                                                     * 23550000
*    $L0=PR390AMG JBB6609 981215 PD00AJ:  Transaction Trace initial   * 23580000
*                                         support                     * 23610000
*    $L1=PR390    JBB6609 990115 PD00AJ:  Transaction Trace initial   * 23640000
*                                         support                     * 23670000
* macrfy   = 'YES'                                                    * 23677500
* maclang  = 'ASMPLAS'                                                * 23685000
* macprint = 'YES'.                                                   * 23692500
****** END OF SPECIFICATIONS *****************************************/ 23700000
*/* TLINE 1 *********************************************************** 23750000
         MACRO                                                          23800000
&XLABEL  ITZQUERY &MONTKN=,&TRACETKN=,&TRACELVL=,&PLISTVER=,&MF=        23850000
.*                                                                      23950000
*              MACDATE -08/11/99-<0>                                    24000000
.*                                                                      24050000
.*******************************************************************    24100000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        24150000
.*******************************************************************    24200000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   24250000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     24300000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             24350000
.*                                                                      24400000
              GBLC  &ZITZQUERY  YES=MACRO USED AT LEAST ONCE            24450000
.*******************************************************************    24500000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          24550000
.*******************************************************************    24600000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 24650000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            24700000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              24750000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             24800000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             24850000
              LCLA  &ZAWRK      USED AS A WORK AREA                     24900000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  24950000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   25000000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 25050000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             25100000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 25150000
              LCLA  &ZMACRET    MACRO RETURN CODE                       25200000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        25250000
.*                                                                      25300000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      25350000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              25400000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   25450000
              LCLC  &ZENDBASEPL                 End of base PL          25500000
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   25550000
.*******************************************************************    25600000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             25650000
.*******************************************************************    25700000
              LCLA  &ZI         INDEX FOR ARRAY                         25750000
              LCLA  &ZJ         INDEX FOR PARMS                         25800000
              LCLA  &ZK         INDEX FOR PARSE                         25850000
              LCLA  &ZLO        LOW RANGE VALUE                         25900000
              LCLA  &ZHI        HIGH RANGE VALUE                        25950000
              LCLC  &ZW         WORK AREA FOR PARM                      26000000
.********************************************************************   26050000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 26100000
.********************************************************************   26150000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 26200000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          26250000
.*                                                                      26300000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       26350000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        26400000
              SPLEVEL  TEST                                             26450000
.ZSYS2        ANOP  ,                                                   26500000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              26550000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              26600000
              SYSSTATE TEST                                             26650000
              AGO   .ZSYS4                                              26700000
.ZSYS3        ANOP  ,                                                   26750000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 26800000
.ZSYS4        ANOP  ,                                                   26850000
.*******************************************************************    26900000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   26950000
.*******************************************************************    27000000
              LCLC  &XMONTKN    ++ NAME                                 27100000
              LCLC  &XTRACETKN  ++ NAME                                 27150000
              LCLC  &XTRACELVL  ++ NAME                                 27200000
              LCLA  &XPLISTVER  ++ VALUE                                27450000
              LCLC  &XMF        ++ VALUE                                27500000
              LCLC  &XMFCTRL    ++ NAME                                 27550000
              LCLC  &XMFATTR    ++ VALUE                                27600000
              LCLC  &XMFSCK     ++ VALUE                                27650000
.*******************************************************************    27700000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           27750000
.*******************************************************************    27800000
              LCLC  &ZXMONTKN   ++ INPUT NAME                           27900000
              LCLC  &ZXTRACETKN                 ++ OUTPUT NAME          27950000
              LCLC  &ZXTRACELVL                 ++ OUTPUT NAME          28000000
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          28250000
              LCLC  &ZXMF       ++ INPUT VALUE                          28300000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           28350000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          28400000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          28450000
.********************************************************************   28500000
.***AC.PLV01  PROCESS PLISTVER                                      *   28550000
.********************************************************************   28600000
&XPLISTVER      SETA  0                                                 28650000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       28700000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   28750000
&XPLISTVER      SETA  0                                                 28800000
.ZPLV0          ANOP  ,                                                 28850000
.*                                                                      28900000
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      28950000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      29000000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  29050000
.*-------------------------------------------------------------------   29100000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 29150000
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                29200000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 29250000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 29300000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               29350000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                29400000
                AGO   .ZPVCK2                                           29450000
.ZPVCK3         ANOP  ,                                                 29500000
.*-------------------------------------------------------------------   29550000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  29600000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                29650000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 29700000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         29750000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 29800000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                29850000
                AGO   .ZPVCKE                                           29900000
.ZPVCK2         ANOP  ,                                                 29950000
.*-------------------------------------------------------------------   30000000
&ZCVAL          SETC  '&PLISTVER(1)'                                    30050000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             30100000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             30150000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        30200000
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      30250000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     30300000
.ZPVCK6         ANOP  ,                                                 30350000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                30400000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 30450000
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         30500000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         30550000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                30600000
&XPLISTVER      SETA  0                                                 30650000
                AGO   .ZPVCKE                                           30700000
.*-------------------------------------------------------------------   30750000
.ZPVCK4A        ANOP  ,                                                 30800000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        30850000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                30900000
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               30950000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          31000000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 31050000
                MNOTE 8,' &ZMS IS REQUIRED.'                            31100000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                31150000
                AGO   .ZPVCK5                                           31200000
.ZPVCK4         ANOP  ,                                                 31250000
&XPLISTVER      SETA  &PLISTVER(1)                                      31300000
.ZPVCK5         ANOP  ,                                                 31350000
.ZPVCKE         ANOP  ,                                                 31400000
.********************************************************************   31450000
.***AG.MF01 PROCESS MF MACRO FORMS                                      31500000
.********************************************************************   31550000
              ACTR  10000                                               31600000
.*------------------------------------------------------------------    31650000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           31700000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    31750000
.*-------------------------------------------------------------------   31800000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           31850000
.ZG15         ANOP  ,                                                   31900000
&ZTLC         SETC 'S'                                                  31950000
              AIF   ('&MF(1)' NE '&ZTLC').ZG16                          32000000
&XMF          SETC  'S'         SET KEYWORD                             32050000
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              32075000
              AIF   (N'&MF LE 1).ZG15A          CK NUM                  32100000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           32150000
&ZMS          SETC  '&ZMS.&MF"'                                         32200000
&ZMS          SETC  '&ZMS "MF"'                                         32250000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 32300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             32350000
.ZG15A        ANOP  ,                                                   32400000
.*-------------------------------------------------------------------   32450000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           32500000
.ZG16         ANOP  ,                                                   32550000
&ZTLC         SETC 'L'                                                  32600000
              AIF   ('&MF(1)' NE '&ZTLC').ZG23                          32650000
&XMF          SETC  'L'         SET KEYWORD                             32700000
              AIF   (N'&MF LE 3).ZG16A          CK NUM                  32750000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           32800000
&ZMS          SETC  '&ZMS.&MF"'                                         32850000
&ZMS          SETC  '&ZMS "MF"'                                         32900000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                32950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33000000
.ZG16A        ANOP  ,                                                   33050000
.*-------------------------------------------------------------------   33100000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     33150000
              AIF   (N'&SYSLIST NE 0).ZG16B     POSITIONALS?            33200000
              AIF   ('&MONTKN' NE '').ZG16B     KEYS?                   33250000
              AIF   ('&TRACETKN' NE '').ZG16B   KEYS?                   33300000
              AIF   ('&TRACELVL' NE '').ZG16B   KEYS?                   33350000
              AGO    .ZG16C     INVOCATION OKAY                         33400000
.ZG16B        ANOP  ,                                                   33450000
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            33750000
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                33800000
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           33850000
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              33900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33950000
.ZG16C        ANOP  ,                                                   34000000
.*-------------------------------------------------------------------   34050000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   34100000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           34150000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           34200000
              AIF   (N'&MF(2) GT 1).ZG18B       MULTI PARMS             34250000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           34300000
.ZG18B        AIF   (K'&MF(2) GT 0).ZG18C                               34350000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         34400000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 34450000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 34500000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        34550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34600000
.ZG18C        ANOP  ,                                                   34650000
.*-------------------------------------------------------------------   34700000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               34750000
              AIF   (K'&ZXMFCTRL LE 0).ZG18P    NOT I/O                 34800000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG18P                      34850000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         34900000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           34950000
&ZMS          SETC  '&ZMS.&MF"'                                         35000000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           35050000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   35100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             35150000
.ZG18P        ANOP  ,                                                   35200000
.*-------------------------------------------------------------------   35250000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      35300000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           35350000
&XMFATTR      SETC  '0D'                                                35400000
              AIF   (K'&MF(3) LE 0).ZG21B       PARM                    35450000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           35500000
              AIF   (N'&MF(3) GT 1).ZG21B       MULTI PARMS             35550000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           35600000
.ZG21B        ANOP  ,                                                   35650000
.*-------------------------------------------------------------------   35700000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  35750000
              AIF   (K'&ZXMFATTR LE 0).ZG21P    NOT I/O                 35800000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG21P                      35850000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         35900000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           35950000
&ZMS          SETC  '&ZMS.&MF"'                                         36000000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           36050000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   36100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36150000
.ZG21P        ANOP  ,                                                   36200000
.*-------------------------------------------------------------------   36250000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 36300000
              AIF   (K'&ZXMFATTR LE 0).ZG21S    NOT I/O                 36350000
              AIF   (K'&XMFATTR LE 60).ZG21S    LNG OK                  36400000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         36450000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           36500000
&ZMS          SETC  '&ZMS.&MF"'                                         36550000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               36600000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  36650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36700000
.ZG21S        ANOP  ,                                                   36750000
.*-------------------------------------------------------------------   36800000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36850000
.ZG23         ANOP  ,                                                   36900000
&ZTLC         SETC 'M'                                                  36950000
              AIF   ('&MF(1)' NE '&ZTLC').ZG32                          37000000
&XMF          SETC  'M'         SET KEYWORD                             37050000
              AIF   (N'&MF LE 3).ZG23A          CK NUM                  37100000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           37150000
&ZMS          SETC  '&ZMS.&MF"'                                         37200000
&ZMS          SETC  '&ZMS "MF"'                                         37250000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                37300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37350000
.ZG23A        ANOP  ,                                                   37400000
.*-------------------------------------------------------------------   37450000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   37500000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           37550000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           37600000
              AIF   (N'&MF(2) GT 1).ZG25B       MULTI PARMS             37650000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           37700000
.ZG25B        AIF   (K'&MF(2) GT 0).ZG25C                               37750000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         37800000
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 37850000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 37900000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        37950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             38000000
.ZG25C        ANOP  ,                                                   38050000
.*-------------------------------------------------------------------   38100000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              38150000
              AIF   (K'&ZXMFCTRL LE 0).ZG25R    NOT I/O                 38200000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG25R                      38250000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          38300000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                        38350000
              AIF   (K'&ZCGPR GT 2).ZG25Q                               38400000
              AIF   ('&ZCGPR' EQ '0').ZG25Q                             38450000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       38500000
              AIF   (T'&ZCGPR NE 'N').ZG25Q     INVALID REG NAME        38550000
.ZG25P        ANOP  ,                                                   38600000
              AIF   (T'&ZCGPR NE 'N').ZG25R     NON NUMERIC             38650000
              AIF   ('&ZCGPR' LT '1').ZG25Q                             38700000
              AIF   ('&ZCGPR' LE '12').ZG25R                            38750000
.ZG25Q        ANOP  ,                                                   38800000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           38850000
&ZMS          SETC  '&ZMS.&MF"'                                         38900000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           38950000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    39000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39050000
.ZG25R        ANOP  ,                                                   39100000
.*-------------------------------------------------------------------   39150000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             39200000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    39250000
.ZG29A   AIF   ('&MF(3)' NE 'COMPLETE').ZG30A                           39300000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             39350000
.*-------------------------------------------------------------------   39400000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             39410000
.ZG30A   AIF   ('&MF(3)' NE 'NOCHECK').ZG31A                            39420000
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             39430000
.*-------------------------------------------------------------------   39440000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             39450000
.ZG31A        AIF   (K'&XMFSCK GT 0).ZG31C      KEYWORD                 39500000
              AIF   (K'&MF(3) LE 0).ZG31B                               39550000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           39600000
&ZMS          SETC  '&ZMS.&MF"'                                         39650000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           39700000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 39750000
&ZMS          SETC  '&ZMS "COMPLETE"'                                   39783300
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                39816600
              MNOTE 8,' &ZMS '                                          39850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39900000
.ZG31B        ANOP  ,                                                   39950000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     40000000
.ZG31C        ANOP  ,                                                   40001300
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           40002600
.*-------------------------------------------------------------------   40003900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           40005200
.ZG32         ANOP  ,                                                   40006500
&ZTLC         SETC 'E'                                                  40007800
              AIF   ('&MF(1)' NE '&ZTLC').ZG41                          40009100
&XMF          SETC  'E'         SET KEYWORD                             40010400
              AIF   (N'&MF LE 3).ZG32A          CK NUM                  40011700
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           40013000
&ZMS          SETC  '&ZMS.&MF"'                                         40014300
&ZMS          SETC  '&ZMS "MF"'                                         40015600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                40016900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40018200
.ZG32A        ANOP  ,                                                   40019500
.*-------------------------------------------------------------------   40020800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   40022100
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           40023400
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           40024700
              AIF   (N'&MF(2) GT 1).ZG34B       MULTI PARMS             40026000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           40027300
.ZG34B        AIF   (K'&MF(2) GT 0).ZG34C                               40028600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         40029900
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 40031200
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 40032500
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        40033800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40035100
.ZG34C        ANOP  ,                                                   40036400
.*-------------------------------------------------------------------   40037700
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              40039000
              AIF   (K'&ZXMFCTRL LE 0).ZG34R    NOT I/O                 40040300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG34R                      40041600
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          40042900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                        40044200
              AIF   (K'&ZCGPR GT 2).ZG34Q                               40045500
              AIF   ('&ZCGPR' EQ '0').ZG34Q                             40046800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       40048100
              AIF   (T'&ZCGPR NE 'N').ZG34Q     INVALID REG NAME        40049400
.ZG34P        ANOP  ,                                                   40050700
              AIF   (T'&ZCGPR NE 'N').ZG34R     NON NUMERIC             40052000
              AIF   ('&ZCGPR' LT '1').ZG34Q                             40053300
              AIF   ('&ZCGPR' LE '12').ZG34R                            40054600
.ZG34Q        ANOP  ,                                                   40055900
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           40057200
&ZMS          SETC  '&ZMS.&MF"'                                         40058500
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           40059800
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    40061100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40062400
.ZG34R        ANOP  ,                                                   40063700
.*-------------------------------------------------------------------   40065000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             40066300
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    40067600
.ZG38A   AIF   ('&MF(3)' NE 'COMPLETE').ZG39A                           40068900
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             40070200
.*-------------------------------------------------------------------   40071500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             40072800
.ZG39A   AIF   ('&MF(3)' NE 'NOCHECK').ZG40A                            40074100
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             40075400
.*-------------------------------------------------------------------   40076700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             40078000
.ZG40A        AIF   (K'&XMFSCK GT 0).ZG40C      KEYWORD                 40079300
              AIF   (K'&MF(3) LE 0).ZG40B                               40080600
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           40081900
&ZMS          SETC  '&ZMS.&MF"'                                         40083200
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           40084500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 40085800
&ZMS          SETC  '&ZMS "COMPLETE"'                                   40087100
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                40088400
              MNOTE 8,' &ZMS '                                          40089700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40091000
.ZG40B        ANOP  ,                                                   40092300
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     40093600
.ZG40C        ANOP  ,                                                   40094900
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           40100000
.*------------------------------------------------------------------    40150000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           40200000
.ZG41         ANOP  ,                                                   40250000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           40300000
              AIF   (K'&XMF GT 0).ZG41E         VALID ARG               40350000
              AIF   (T'&MF EQ 'O').ZG41D        OMITTED                 40400000
&ZASYSLNDX    SETA  0                                                   40450000
.ZG41A        ANOP  ,           POSITIONAL MACRO KEY                    40500000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        40550000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG41C                    40600000
&ZTLC         SETC 'MF'                                                 40650000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG41A           40700000
.ZG41B        ANOP  ,                                                   40750000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         40800000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           40850000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             40900000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    40950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41000000
              AGO   .ZG41E                                              41050000
.ZG41C        ANOP  ,                                                   41100000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         41150000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           41200000
&ZMS          SETC  '&ZMS.&MF"'                                         41250000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           41300000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 41350000
&ZMS          SETC  '&ZMS "S",'                                         41400000
&ZMS          SETC  '&ZMS "L",'                                         41450000
&ZMS          SETC  '&ZMS "M",'                                         41475000
&ZMS          SETC  '&ZMS OR "E".'                                      41500000
              MNOTE 8,' &ZMS '                                          41550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41600000
              AGO   .ZG41E                                              41650000
.ZG41D        ANOP  ,                                                   41700000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     41750000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       41800000
.ZG41E        ANOP  ,                                                   41850000
.********************************************************************   41900000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 41950000
.********************************************************************   42000000
              ACTR  10000                                               42050000
.*-------------------------------------------------------------------   42100000
.***AG.MF03 MF=(SLME)                                                   42150000
              AIF   ('&XMF' EQ 'L').ZGMFX                               42200000
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     42250000
.*----------------------------------------------------------------***   45700000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     45750000
              AIF   (N'&MONTKN LE 1).ZG2A       CK NUM                  45800000
&ZMS          SETC  '"MONTKN='  *KPOSA* MNOTE                           45850000
&ZMS          SETC  '&ZMS.&MONTKN"'                                     45900000
&ZMS          SETC  '&ZMS "MONTKN"'                                     45950000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 46000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46050000
.ZG2A         ANOP  ,                                                   46100000
.*-------------------------------------------------------------------   46150000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         46200000
&ZXMONTKN     SETC  'INPUT'     SET IN/OUTPUT                           46250000
&XMONTKN      SETC  '0'                                                 46300000
              AIF   (K'&MONTKN(1) LE 0).ZG2B    PARM                    46350000
&XMONTKN      SETC  '&MONTKN(1)'                SET XVARIABLE           46400000
              AIF   (N'&MONTKN GT 1).ZG2B       MULTI PARMS             46450000
&XMONTKN      SETC  '&MONTKN'   SET XVARIABLE                           46500000
.ZG2B         ANOP  ,                                                   46550000
.*-------------------------------------------------------------------   46600000
.***AG.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     46650000
              AIF   (K'&ZXMONTKN LE 0).ZG2P     NOT I/O                 46700000
              AIF   ('&XMONTKN'(1,1) NE '(').ZG2P                       46750000
&ZXMONTKN     SETC  ''          RESET IN/OUTPUT                         46800000
&ZMS          SETC  '"MONTKN='  *KGPRA* MNOTE                           46850000
&ZMS          SETC  '&ZMS.&MONTKN"'                                     46900000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           46950000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   47000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47050000
.ZG2P         ANOP  ,                                                   47100000
.*----------------------------------------------------------------***   48850000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    48900000
              AIF   (N'&TRACETKN LE 1).ZG5A     CK NUM                  48950000
&ZMS          SETC  '"TRACETKN='                *KPOSA* MNOTE           49000000
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   49050000
&ZMS          SETC  '&ZMS "TRACETKN"'                                   49100000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 49150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49200000
.ZG5A         ANOP  ,                                                   49250000
.*-------------------------------------------------------------------   49300000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        49350000
&ZXTRACETKN   SETC  'OUTPUT'    SET IN/OUTPUT                           49400000
&XTRACETKN    SETC  '&TRACETKN(1)'              SET XVARIABLE           49450000
              AIF   (N'&TRACETKN GT 1).ZG5B     MULTI PARMS             49500000
&XTRACETKN    SETC  '&TRACETKN'                 SET XVARIABLE           49550000
.ZG5B         AIF   (K'&TRACETKN(1) GT 0).ZG5C                          49600000
&ZXTRACETKN   SETC  ''          RESET IN/OUTPUT                         49650000
&ZMS          SETC  ' '         *KRQDA*                                 49700000
&ZMS          SETC  '&ZMS "TRACETKN" KEY AND ITS'                       49750000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    49800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49850000
.ZG5C         ANOP  ,                                                   49900000
.*-------------------------------------------------------------------   49950000
.***AG.KCK01 NAME, RQD OUTPUT, KEYS -GPR NOT ALLOWED                    50000000
              AIF   (K'&ZXTRACETKN LE 0).ZG5P   NOT I/O                 50050000
              AIF   ('&XTRACETKN'(1,1) NE '(').ZG5P                     50100000
&ZXTRACETKN   SETC  ''          RESET IN/OUTPUT                         50150000
&ZMS          SETC  '"TRACETKN='                *KGPRA* MNOTE           50200000
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   50250000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           50300000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   50350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50400000
.ZG5P         ANOP  ,                                                   50450000
.*----------------------------------------------------------------***   50500000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    50550000
              AIF   (N'&TRACELVL LE 1).ZG8A     CK NUM                  50600000
&ZMS          SETC  '"TRACELVL='                *KPOSA* MNOTE           50650000
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   50700000
&ZMS          SETC  '&ZMS "TRACELVL"'                                   50750000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 50800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50850000
.ZG8A         ANOP  ,                                                   50900000
.*-------------------------------------------------------------------   50950000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        51000000
              AIF   (K'&TRACELVL(1) LE 0).ZG8C  NO PARM                 51050000
&ZXTRACELVL   SETC  'OUTPUT'    SET OUTPUT                              51100000
&XTRACELVL    SETC  '&TRACELVL(1)'              SET XVARIABLE           51150000
              AIF   (N'&TRACELVL GT 1).ZG8C                             51200000
&XTRACELVL    SETC  '&TRACELVL'                 SET XVARIABLE           51250000
.ZG8C         ANOP  ,                                                   51300000
.*-------------------------------------------------------------------   51350000
.***AG.KCK01 NAME, OPT OUTPUT, KEYS -GPR NOT ALLOWED                    51400000
              AIF   (K'&ZXTRACELVL LE 0).ZG8P   NOT I/O                 51450000
              AIF   ('&XTRACELVL'(1,1) NE '(').ZG8P                     51500000
&ZXTRACELVL   SETC  ''          RESET IN/OUTPUT                         51550000
&ZMS          SETC  '"TRACELVL='                *KGPRA* MNOTE           51600000
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   51650000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           51700000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   51750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51800000
.ZG8P         ANOP  ,                                                   51850000
.******************************************************************     59900000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        59950000
.******************************************************************     60000000
              ACTR  10000                                               60050000
.*----------------------------------------------------------------***   60100000
.***AH.P02 EXTRA POSITIONALS                                            60150000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               60200000
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                60250000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            60300000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             60350000
.ZGLISTX1     ANOP  ,                                                   60400000
&ZCVAL        SETC  ''          ERROR FIELD                             60450000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       60500000
.ZGLIST2      ANOP  ,                                                   60550000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         60600000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                60650000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   60700000
              AGO   .ZGLIST2                                            60750000
.*                                                                      60800000
.ZGLIST3      ANOP  ,                                                   60850000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             60900000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           60950000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     61000000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              61050000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      61100000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              61150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61200000
.ZGLISTX      ANOP  ,                                                   61250000
&ZASYSLNDX    SETA  0                                                   61300000
.*-------------------------------------------------------------------   61350000
.***AG.MF04 MF=(SLME)                                                   61400000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                61450000
.********************************************************************   61450300
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             61450600
.********************************************************************   61450900
              ACTR  10000                                               61451200
.*-------------------------------------------------------------------   61451500
.***AE.MF01 MF=(SLME)                                                   61451800
              AIF   ('&XMF' EQ 'L').ZEMFX                               61452100
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      61452400
.********************************************************************   61452700
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        61453000
.********************************************************************   61453300
.*----------------------------------------------------------------***   61453600
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          61453900
              AIF   (N'&MONTKN LE 1).ZE2A       CK NUM                  61454200
&ZMS          SETC  '"MONTKN='  *KPOSA* MNOTE                           61454500
&ZMS          SETC  '&ZMS.&MONTKN"'                                     61454800
&ZMS          SETC  '&ZMS "MONTKN"'                                     61455100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 61455400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61455700
.ZE2A         ANOP  ,                                                   61456000
.*-------------------------------------------------------------------   61456300
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     61456600
              AIF   (K'&MONTKN(1) LE 0).ZE2B    NO PRM                  61456900
&ZXMONTKN     SETC  'INPUT'     SET IN/OUTPUT                           61457200
&XMONTKN      SETC  '&MONTKN(1)'                SET XVARIABLE           61457500
              AIF   (N'&MONTKN GT 1).ZE2B                               61457800
.*            ANOP              MULTIPLE PARMS                          61458100
&XMONTKN      SETC  '&MONTKN'   SET XVARIABLE                           61458400
.ZE2B         ANOP  ,                                                   61458700
.*-------------------------------------------------------------------   61459000
.***AE.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     61459300
              AIF   (K'&ZXMONTKN LE 0).ZE2P     NOT I/O                 61459600
              AIF   ('&XMONTKN'(1,1) NE '(').ZE2P                       61459900
&ZXMONTKN     SETC  ''          RESET IN/OUTPUT                         61460200
&ZMS          SETC  '"MONTKN='  *KGPRA* MNOTE                           61460500
&ZMS          SETC  '&ZMS.&MONTKN"'                                     61460800
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           61461100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   61461400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61461700
.ZE2P         ANOP  ,                                                   61462000
.*----------------------------------------------------------------***   61462300
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         61462600
              AIF   (N'&TRACETKN LE 1).ZE5A     CK NUM                  61462900
&ZMS          SETC  '"TRACETKN='                *KPOSA* MNOTE           61463200
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   61463500
&ZMS          SETC  '&ZMS "TRACETKN"'                                   61463800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 61464100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61464400
.ZE5A         ANOP  ,                                                   61464700
.*-------------------------------------------------------------------   61465000
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    61465300
              AIF   (K'&TRACETKN(1) LE 0).ZE5B  NO PRM                  61465600
&ZXTRACETKN   SETC  'OUTPUT'    SET IN/OUTPUT                           61465900
&XTRACETKN    SETC  '&TRACETKN(1)'              SET XVARIABLE           61466200
              AIF   (N'&TRACETKN GT 1).ZE5B                             61466500
.*            ANOP              MULTIPLE PARMS                          61466800
&XTRACETKN    SETC  '&TRACETKN'                 SET XVARIABLE           61467100
.ZE5B         ANOP  ,                                                   61467400
.*-------------------------------------------------------------------   61467700
.***AE.KCK01 NAME, RQD OUTPUT, KEYS -GPR NOT ALLOWED                    61468000
              AIF   (K'&ZXTRACETKN LE 0).ZE5P   NOT I/O                 61468300
              AIF   ('&XTRACETKN'(1,1) NE '(').ZE5P                     61468600
&ZXTRACETKN   SETC  ''          RESET IN/OUTPUT                         61468900
&ZMS          SETC  '"TRACETKN='                *KGPRA* MNOTE           61469200
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   61469500
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           61469800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   61470100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61470400
.ZE5P         ANOP  ,                                                   61470700
.*----------------------------------------------------------------***   61471000
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         61471300
              AIF   (N'&TRACELVL LE 1).ZE8A     CK NUM                  61471600
&ZMS          SETC  '"TRACELVL='                *KPOSA* MNOTE           61471900
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   61472200
&ZMS          SETC  '&ZMS "TRACELVL"'                                   61472500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 61472800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61473100
.ZE8A         ANOP  ,                                                   61473400
.*-------------------------------------------------------------------   61473700
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    61474000
              AIF   (K'&TRACELVL(1) LE 0).ZE8B  NO PRM                  61474300
&ZXTRACELVL   SETC  'OUTPUT'    SET IN/OUTPUT                           61474600
&XTRACELVL    SETC  '&TRACELVL(1)'              SET XVARIABLE           61474900
              AIF   (N'&TRACELVL GT 1).ZE8B                             61475200
.*            ANOP              MULTIPLE PARMS                          61475500
&XTRACELVL    SETC  '&TRACELVL'                 SET XVARIABLE           61475800
.ZE8B         ANOP  ,                                                   61476100
.*-------------------------------------------------------------------   61476400
.***AE.KCK01 NAME, OPT OUTPUT, KEYS -GPR NOT ALLOWED                    61476700
              AIF   (K'&ZXTRACELVL LE 0).ZE8P   NOT I/O                 61477000
              AIF   ('&XTRACELVL'(1,1) NE '(').ZE8P                     61477300
&ZXTRACELVL   SETC  ''          RESET IN/OUTPUT                         61477600
&ZMS          SETC  '"TRACELVL='                *KGPRA* MNOTE           61477900
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   61478200
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           61478500
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   61478800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61479100
.ZE8P         ANOP  ,                                                   61479400
.******************************************************************     61479700
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        61480000
.******************************************************************     61480300
              ACTR  10000                                               61480600
.*----------------------------------------------------------------***   61480900
.***AF.P02 EXTRA POSITIONALS                                            61481200
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               61481500
&ZCVAL        SETC  ''          ERROR FIELD                             61481800
&ZAWRK        SETA  0           POSITIONAL NUMBER                       61482100
.ZELIST2      ANOP  ,                                                   61482400
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         61482700
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                61483000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   61483300
              AGO   .ZELIST2                                            61483600
.*                                                                      61483900
.ZELIST3      ANOP  ,                                                   61484200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             61484500
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           61484800
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     61485100
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              61485400
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      61485700
              MNOTE 8,' &ZMS ARE ALLOWED.'                              61486000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61486300
.ZELISTX      ANOP  ,                                                   61486600
&ZASYSLNDX    SETA  0                                                   61486900
.*-------------------------------------------------------------------   61487200
.***AE.MF02 MF=(SLME)                                                   61487500
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             61487800
.*******************************************************************    61500000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       61550000
.*******************************************************************    61600000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          61650000
.*******************************************************************    61700000
.***AE.01  START OF ITZQUERY MACRO CODE                                 61750000
.*******************************************************************    61800000
              LCLC  &M0M0001                 NAME                       61850000
&M0M0001      SETC  '&XLABEL'                SET NAME                   61900000
              AIF   (K'&XLABEL NE 0).XLAB2                              61950000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               62000000
.*                                                                      62050000
.XLAB2        ANOP  ,                                                   62100000
              AIF   ('&XMF' EQ 'L').XLAB3                               62150000
&M0M0001 DS    0H                             ITZQUERY-0                62200000
.XLAB3        ANOP  ,                                                   62250000
.*******************************************************************    62300000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              62350000
.*******************************************************************    62400000
              PUSH  PRINT                                               62450000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          62500000
              PRINT OFF         ++ PR01                                 62550000
              AGO   .ZPRNTXX                                            62600000
.ZPRINTX      PRINT ON                                                  62650000
.ZPRNTXX      ANOP  ,                                                   62700000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  62750000
&NOQLAB SETC  'NOQRY&SYSNDX'       Generate unique label           @L1A 62755500
&QDONE  SETC  'QRDN&SYSNDX'        Generate unique label           @L1A 62761000
        AIF   ('&XMF' EQ 'L').QRLST                                @L1A 62766500
        AIF   ('&SYSASCE' EQ 'P').NOTAR   Ck for AR mode callers   @L1A 62767800
        LAE   15,0(15,0)           Clear AR 14                     @L1A 62769100
.NOTAR  ANOP                                                       @L1A 62770400
        L     15,16(0,0)                                           @L1A 62772000
        L     15,140(15,0)                                         @L1A 62777500
        TM    519(15),B'10000000'  Is TTrace active?               @L1A 62783000
        BZ    &NOQLAB              No, skip query                  @L1A 62788500
.QRLST  ANOP                                                       @L1A 62794000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  62800000
.********************************************************************   62850000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     62900000
.********************************************************************   62950000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       63000000
                      LCLA  &ZOPN1         INVOCATION INDEX             63050000
                      LCLC  &ZOPL(4095)    LABEL                        63100000
                      LCLC  &ZOPO(4095)    OPERATION                    63150000
                      LCLC  &ZOPV(4095)    VALUE                        63200000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  63250000
.*                                                                      63300000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     63350000
.******************************************************************     63400000
.***AL.L10 ITZQUERY FMT=LIST MF=S|L PARAMETERS                          63450000
.******************************************************************     63500000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     63550000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     63600000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     63650000
&XMFATTR              SETC  '0D'                                        63700000
.*                                                                      63750000
&ZOPN                 SETA  &ZOPN+1                                     63800000
&ZOPL(&ZOPN)          SETC  ' '                                         63850000
&ZOPO(&ZOPN)          SETC  'B'                                         63900000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                63950000
&ZOPD(&ZOPN)          SETC  '++ ITZQUERY ARG PARMS'                     64000000
.*                                                                      64050000
&ZOPN                 SETA  &ZOPN+1                                     64100000
&ZOPL(&ZOPN)          SETC  ' '                                         64150000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     64200000
&ZOPV(&ZOPN)          SETC  '1'                                         64250000
&ZOPD(&ZOPN)          SETC  ' '                                         64300000
.*                                                                      64350000
.ZLMFSL2              ANOP  ,                                           64400000
.*-------------------------------------------------------------------   64450000
.***AM.L00  ITZQUERY FMT=LIST name                                      64500000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    64550000
&ZOPN                 SETA &ZOPN+1                                      64600000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   64650000
&ZOPO(&ZOPN)          SETC 'EQU'                                        64700000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   64750000
&ZOPD(&ZOPN)          SETC '++ ITZQUERY NAME'                           64800000
.ZLMFSL2M             ANOP  ,                                           64850000
.*-------------------------------------------------------------------   64900000
.***AM.L01  ITZQUERY FMT=LIST PARAMETERS                                64950000
&ZOPN                 SETA &ZOPN+1                                      65000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   65050000
&ZOPO(&ZOPN)          SETC 'DS'                                         65100000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   65150000
&ZOPD(&ZOPN)          SETC '++ ITZQUERY PARM LIST'                      65200000
.*-------------------------------------------------------------------   65250000
.***AM.L02 XVERSION XL1                                                 65300000
&ZOPN                 SETA &ZOPN+1                                      65350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         65400000
&ZOPO(&ZOPN)          SETC 'DS'                                         65450000
&ZOPV(&ZOPN)          SETC 'XL1'                                        65500000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          65550000
.*-------------------------------------------------------------------   65600000
.***AM.L03 XREQUEST BL.8                                                65650000
&ZOPN                 SETA &ZOPN+1                                      65700000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         65750000
&ZOPO(&ZOPN)          SETC 'DS'                                         65800000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       65813600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             65827200
.*                                                                      65840800
&ZOPN                 SETA  &ZOPN+1                                     65854400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_TRACELVL'                65868000
&ZOPO(&ZOPN)          SETC  'EQU'                                       65881600
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             65895200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               65908800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TRACELVL'                     65922400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      65936000
.*-------------------------------------------------------------------   65950000
.***AM.L09  XRESERVED1 CL2                                              66000000
&ZOPN                 SETA &ZOPN+1                                      66127700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       66138800
&ZOPO(&ZOPN)          SETC 'DS'                                         66150000
&ZOPV(&ZOPN)          SETC 'CL2'                                        66177100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 66204300
.*-------------------------------------------------------------------   66208600
.***AM.L09  XMONTKN F                                                   66212900
&ZOPN                 SETA &ZOPN+1                                      66217200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          66221500
&ZOPO(&ZOPN)          SETC 'DS'                                         66225800
&ZOPV(&ZOPN)          SETC 'F'                                          66230100
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN  XMONTKN'                      66234400
.*-------------------------------------------------------------------   66238700
.***AM.L09 ADDR XTRACELVL A                                             66243000
&ZOPN                 SETA &ZOPN+1                                      66247300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTRACELVL_ADDR'                   66251600
&ZOPO(&ZOPN)          SETC 'DS'                                         66255900
&ZOPV(&ZOPN)          SETC 'A'                                          66257100
&ZOPD(&ZOPN)          SETC '++ &ZXTRACELVL ADDR XTRACELVL'              66258300
.*-------------------------------------------------------------------   66259500
.***AM.L09 ADDR XTRACETKN A                                             66260700
&ZOPN                 SETA &ZOPN+1                                      66261900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTRACETKN_ADDR'                   66263100
&ZOPO(&ZOPN)          SETC 'DS'                                         66264300
&ZOPV(&ZOPN)          SETC 'A'                                          66265500
&ZOPD(&ZOPN)          SETC '++ &ZXTRACETKN ADDR XTRACETKN'              66266700
.*-------------------------------------------------------------------   66268800
.***AM.L09  XQRYWKA CL24                                                66273100
&ZOPN                 SETA &ZOPN+1                                      66277400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQRYWKA'                          66281700
&ZOPO(&ZOPN)          SETC 'DS'                                         66286000
&ZOPV(&ZOPN)          SETC 'CL24'                                       66290300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XQRYWKA'                    66294600
.*-------------------------------------------------------------------   66295200
.***AM.L09  XWRKAREA CL24                                               66295800
&ZOPN                 SETA &ZOPN+1                                      66296400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWRKAREA'                         66297000
&ZOPO(&ZOPN)          SETC 'DS'                                         66297600
&ZOPV(&ZOPN)          SETC 'CL24'                                       66298200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XWRKAREA'                   66298800
.*-------------------------------------------------------------------   66300000
.***AM.L10 END OF ITZQUERY LIST PARAMETERS                              66350000
&ZOPN                 SETA &ZOPN+1                                      66400000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 66450000
&ZOPO(&ZOPN)          SETC 'EQU'                                        66500000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 66550000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         66600000
.*                                                                      66650000
&ZOPN                 SETA &ZOPN+1                                      66700000
&ZOPL(&ZOPN)          SETC ' '                                          66750000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      66800000
&ZOPV(&ZOPN)          SETC '1'                                          66850000
&ZOPD(&ZOPN)          SETC ' '                                          66900000
.*-------------------------------------------------------------------   66950000
.***AL.L12 ITZQUERY FMT=LIST MF=S|L PARAMETERS                          67000000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         67050000
.*                                                                      67100000
&ZOPN                 SETA  &ZOPN+1                                     67150000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                67200000
&ZOPO(&ZOPN)          SETC  'DC'                                        67250000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   67300000
&ZOPD(&ZOPN)          SETC  '++ ITZQUERY ARG PARMS'                     67350000
.*                                                                      67400000
.ZLMFSLX              ANOP  ,                                           67450000
.*-------------------------------------------------------------------   67500000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          67550000
&ZPLLEN               SETA 64                                           67600000
.*                                                                      67650000
.******************************************************************     67700000
.***AI.L01 ITZQUERY FMT=LIST FILL IN PARAMETER AREA                     67750000
.******************************************************************     67800000
                      ACTR  10000                                       67850000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               67900000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    67950000
&ZCVAL                SETC  'LAE'          XAX MODE                     68000000
.ZIMFXA               ANOP ,                                            68050000
.*                                                                      68100000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    68150000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         68200000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 68250000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                68300000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 68350000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                68400000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   68450000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    68500000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   68550000
&ZOPN                 SETA  &ZOPN+1                                     68600000
&ZOPL(&ZOPN)          SETC  ' '                                         68650000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    68700000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              68750000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       68800000
                      AGO   .ZIMFNX                                     68850000
.*                                                                      68900000
.ZIMFN2               ANOP ,                                            68950000
&ZOPN                 SETA  &ZOPN+1                                     69000000
&ZOPL(&ZOPN)          SETC  ' '                                         69050000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    69100000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                69150000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       69200000
.ZIMFNX               ANOP ,                                            69250000
.********************************************************************   69300000
.***AI.L02 ITZQUERY FMT=LIST INITIALIZE PARAMETER AREA                  69350000
.********************************************************************   69400000
.***AI.L03 MF=(SLME)                                                    69450000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      69500000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            69525000
.*                                                                      69550000
&ZOPN                 SETA  &ZOPN+1                                     69600000
&ZOPL(&ZOPN)          SETC  ' '                                         69650000
&ZOPO(&ZOPN)          SETC  'XC'                                        69700000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         69750000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             69800000
.ZIMFLX               ANOP  ,                                           69850000
.*-------------------------------------------------------------------   69900000
.***AI.L05 XREQUEST BL1                                                 69901000
&ZW                   SETC  ''                                          69902000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            69903000
&ZMS                  SETC  ''                                          69903300
&ZC                   SETC  ''                                          69903600
.*-------------------------------------------------------------------   69904000
.***AI.L08 XREQUEST "TRACELVL"                                          69905000
.***      BL1'1XXXXXXX'                                                 69906000
         AIF   ('&TRACELVL' EQ '').ZI3A                                 69907000
         AIF   ('&TRACELVL' EQ '').ZI3A                                 69908000
&ZW                   SETC  '&ZW.10000000'                              69909000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              69910000
&ZMS                  SETC  '&ZMS.01111111'                             69910500
                      AGO   .ZI3C                                       69911000
.*                                                                      69912000
.ZI3A                 ANOP  ,                                           69913000
&ZW                   SETC  '&ZW.00000000'                              69914000
&ZMS                  SETC  '&ZMS.11111111'                             69914500
.ZI3C                 ANOP  ,                                           69915000
.*-------------------------------------------------------------------   69916000
.***AI.L11 XREQUEST BL1                                                 69917000
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI3D               69917100
                      AIF   ('&ZC' NE 'YES').ZI3D                       69917200
&ZOPN                 SETA  &ZOPN+1                                     69917300
&ZOPL(&ZOPN)          SETC  ' '                                         69917400
&ZOPO(&ZOPN)          SETC  'NI'                                        69917500
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            69917600
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             69917700
.ZI3D                 ANOP  ,                                           69917800
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     69918000
&ZOPN                 SETA  &ZOPN+1                                     69919000
&ZOPL(&ZOPN)          SETC  ' '                                         69920000
&ZOPO(&ZOPN)          SETC  'OI'                                        69921000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             69922000
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             69923000
.ZI3E                 ANOP  ,                                           69924000
.*-------------------------------------------------------------------   69925000
.***AI.L25  XMONTKN F                                                   69926000
                      AIF   ('&ZXMONTKN' EQ '').ZI5E                    69927000
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI5E              69928000
&ZCGPR                SETC  '&XMONTKN'                                  69929000
         AIF   ('&XMONTKN' NE '0').ZI5A                                 69929400
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI5E                           69929800
.*                                                                      69930200
&ZCGPR                SETC  '=XL4''00'''                                69930600
                      AGO   .ZI5D                                       69931000
.ZI5A                 ANOP  ,                                           69931400
.*                                                                      69932000
&ZC                   SETC  '&XMONTKN'(1,1)                             69933000
                      AIF   (T'&ZC NE 'N').ZI5D                         69934000
&ZC                   SETC  '&XMONTKN'                                  69935000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                69936000
&ZCGPR                SETC  '=FL4''&XMONTKN'''                          69937000
.*                                                                      69938000
.ZI5D                 ANOP  ,                                           69939000
.*                                                                      69940000
&ZOPN                 SETA  &ZOPN+1                                     69941000
&ZOPL(&ZOPN)          SETC  ' '                                         69942000
&ZOPO(&ZOPN)          SETC  'MVC'                                       69943000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             69944000
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      69945000
.*                                                                      69946000
.ZI5E                 ANOP  ,                                           69947200
.*-------------------------------------------------------------------   69948400
.***AI.L19 ADDR XTRACELVL A                                             69949600
                      AIF   ('&ZXTRACELVL' EQ '').ZI6H                  69950800
&ZCLNG                SETC  '&XTRACELVL'                                69952000
&ZCGPR                SETC  '14'                                        69953200
.*                                                                      69954400
&ZOPN                 SETA  &ZOPN+1                                     69955600
&ZOPL(&ZOPN)          SETC  ' '                                         69956800
&ZOPO(&ZOPN)          SETC  'LA'                                        69958000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             69959200
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACELVL XTRACELVL'                  69960400
.*                                                                      69961600
&ZOPN                 SETA  &ZOPN+1                                     69962800
&ZOPL(&ZOPN)          SETC  ' '                                         69964000
&ZOPO(&ZOPN)          SETC  'ST'                                        69965200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              69966400
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACELVL XTRACELVL'                  69967600
.*                                                                      69968800
.ZI6H                 ANOP  ,                                           69970000
.*-------------------------------------------------------------------   69971200
.***AI.L19 ADDR XTRACETKN A                                             69972400
                      AIF   ('&ZXTRACETKN' EQ '').ZI7H                  69973600
&ZCLNG                SETC  '&XTRACETKN'                                69974800
&ZCGPR                SETC  '14'                                        69976000
.*                                                                      69977200
&ZOPN                 SETA  &ZOPN+1                                     69978400
&ZOPL(&ZOPN)          SETC  ' '                                         69979600
&ZOPO(&ZOPN)          SETC  'LA'                                        69980800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             69982000
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACETKN XTRACETKN'                  69983200
.*                                                                      69984400
&ZOPN                 SETA  &ZOPN+1                                     69985600
&ZOPL(&ZOPN)          SETC  ' '                                         69986800
&ZOPO(&ZOPN)          SETC  'ST'                                        69988000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             69989200
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACETKN XTRACETKN'                  69990400
.*                                                                      69991600
.ZI7H                 ANOP  ,                                           69992800
.*-------------------------------------------------------------------   69994000
&ZOPN1                SETA &ZOPN                                        69995200
.*-------------------------------------------------------------------   69996400
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              69997600
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         69998800
.*******************************************************************    70000000
.***  PROCESS ITZQUERY OUTPUT PARAMETERS                                70050000
.*******************************************************************    70100000
                      ACTR  10000                                       70150000
.*******************************************************************    73300000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   73350000
.*******************************************************************    73400000
.ZMFLX                ANOP  ,              MF=L PROCESSING              73450000
.*******************************************************************    73500000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               73550000
.*******************************************************************    73600000
                      ACTR  10000                                       73650000
.*                                                                      73700000
                      LCLA  &ZLC           COLUMN POSITION              73750000
                      LCLA  &ZOPX          LIST TABLE INDEX             73800000
                      LCLC  &ZLL           LABEL                        73850000
                      LCLC  &ZLOP          OPERATION                    73900000
                      LCLC  &ZLV           VALUE                        73950000
                      LCLC  &ZLD           DESCRIPTION                  74000000
.*                                                                      74050000
&ZOPX                 SETA  1                                           74100000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            74150000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              74200000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              74250000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              74300000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              74350000
                      AIF   (K'&ZLD LE 0).ZL5                           74400000
&ZLC                  SETA  35             COMMENT COLUMN               74450000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    74500000
&ZLC                  SETA  33             COMMMENT COLUMN              74550000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   74600000
&ZLV                  SETC  '&ZLV'.' '                                  74650000
                      AGO   .ZL3                                        74700000
.*                                                                      74750000
.ZL4                  ANOP  ,                                           74800000
&ZLV                  SETC  '&ZLV'.' '                                  74850000
.ZL5                  ANOP  ,                                           74900000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               74950000
.*                                                                      75000000
&ZLL     &ZLOP &ZLV                                                     75050000
.*                                                                      75100000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               75150000
                      AGO   .ZL2           CONTINUE LOOPING             75200000
.*                                                                      75250000
.ZLX                  ANOP  ,                                           75300000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                75350000
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                75375000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  75400000
        L     15,616(15,0)                                         @L1A 75450000
        L     15,16(15,0)          Get query rtn address           @L1A 75465000
        BALR  14,15                Invoke TTrace Query Rtn         @L1A 75480000
        B     &QDONE                                               @L1A 75484000
&NOQLAB  DS    0H                                                  @L1A 75488000
        LA    15,4                                                 @L1A 75492000
&QDONE   DS    0H                                                  @L1A 75496000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  75500000
.ZLINKX               ANOP  ,                                           75550000
.*******************************************************************    75600000
.***AP.X01  FORMAT GENERATED CODE                                       75650000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            75700000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              75750000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              75800000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              75850000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              75900000
                      AIF   (K'&ZLD LE 0).ZL51                          75950000
&ZLC                  SETA  35             COMMENT COLUMN               76000000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   76050000
&ZLC                  SETA  33             COMMENT COLUMN               76100000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  76150000
&ZLV                  SETC  '&ZLV'.' '                                  76200000
                      AGO   .ZL31                                       76250000
.*                                                                      76300000
.ZL41                 ANOP  ,                                           76350000
&ZLV                  SETC  '&ZLV'.' '                                  76400000
.ZL51                 ANOP  ,                                           76450000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               76500000
.*                                                                      76550000
&ZLL     &ZLOP &ZLV                                                     76600000
.*                                                                      76650000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               76700000
                      AGO   .ZL21          CONTINUE LOOPING             76750000
.*                                                                      76800000
.ZLX1                 ANOP  ,                                           76850000
.*******************************************************************    76900000
.***AP.X02  END OF ITZQUERY MACRO                                       76950000
&ZITZQUERY            SETC  'YES'          SET ITZQUERY USED            77000000
         POP   PRINT                                                    77050000
*                                            ITZQUERY-0                 77100000
         SPACE 1                                                        77150000
.ZLX2                 ANOP  ,                                           77200000
         MEND                                                           77250000
**********************************************************************/ 77300000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  77350000
*%ITZQUERY: MACRO KEYS(MONTKN,TRACETKN,TRACELVL,PLISTVER,MF);           77400000
*  ANS('?'||MACLABEL||' '||'ITZQUERP '||MACLIST||                       77500000
*         ' '||MACKEYS||';') COL(MACLMAR);                              77550000
*%END ITZQUERY;                                                         77600000
