*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IOSENQ                                -03/09/00-<0> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  IOS ENQ Services                              * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00600000
*                                                                     * 00700000
* STATUS= HBB7703                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      IOSENQ allows you to to request functions involving the        * 01100000
*      dynamic chpid systems ENQ.  You can request to obtain the ENQ  * 01150000
*      (shared or exclusive, conditional or unconditional) or release * 01200000
*      the ENQ.                                                       * 01250000
*                                                                     * 01300000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 01350000
*                                                                     * 01400000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01450000
*                                                                     * 01500000
*01* ENVIRONMENT:                                                     * 01550000
*                                                                     * 01600000
*                                                                     * 01650000
*      Minimum authorization: Supervisor state.  Zero PSW key.        * 01700000
*                                                                     * 01750000
*      Dispatchable unit mode: Task mode.                             * 01800000
*                                                                     * 01850000
*      Cross Memory Mode: PASN=HASN=SASN.                             * 01900000
*                                                                     * 01950000
*      AMODE:            31-bit.                                      * 02000000
*                                                                     * 02050000
*      ASC mode:         Primary.                                     * 02100000
*                                                                     * 02150000
*      Interrupt status: Enabled for I/O and external interrupts.     * 02200000
*                                                                     * 02250000
*      Locks:            The caller must not be locked.               * 02300000
*                                                                     * 02350000
*      Control parameters: Control parameters must be in the primary  * 02400000
*                        address space.                               * 02450000
*                                                                     * 02500000
*                                                                     * 02550000
*                                                                     * 02600000
*01* PROGRAMMING REQUIREMENTS:                                        * 02650000
*                                                                     * 02700000
*    The caller should include the IOSDENQ macro to get equate        * 02750000
*    symbols for the return and reason codes.                         * 02800000
*                                                                     * 02850000
*01* RESTRICTIONS:                                                    * 02900000
*                                                                     * 02950000
*    The caller must not have functional recovery routines (FRRs)     * 03000000
*    established.                                                     * 03050000
*                                                                     * 03100000
*    The caller must not have a pending ENQ for the same resource     * 03150000
*    managed by this service.                                         * 03200000
*                                                                     * 03250000
*01* INPUT REGISTER INFORMATION:                                      * 03300000
*                                                                     * 03350000
*    Before issuing the IOSENQ macro, the caller does not have to     * 03400000
*    place any information into any general purpose register (GPR) or * 03450000
*    access register (AR) unless using it in register notation for a  * 03500000
*    particular parameter, or using it as a base register.            * 03550000
*                                                                     * 03600000
*01* OUTPUT REGISTER INFORMATION:                                     * 03650000
*                                                                     * 03700000
*    When control returns to the caller, the GPRs contain:            * 03750000
*                                                                     * 03800000
*                                                                     * 03850000
*    REGISTER    CONTENTS                                             * 03900000
*                                                                     * 03950000
*    0           Reason code if GPR15 is not 0                        * 04000000
*                                                                     * 04050000
*    1           Used as a work register by the system                * 04100000
*                                                                     * 04150000
*    2-13        Unchanged                                            * 04200000
*                                                                     * 04250000
*    14          Used as a work register by the system                * 04300000
*                                                                     * 04350000
*    15          Return code                                          * 04400000
*                                                                     * 04450000
*                                                                     * 04500000
*                                                                     * 04550000
*    When control returns to the caller, the ARs contain:             * 04600000
*                                                                     * 04650000
*                                                                     * 04700000
*    REGISTER    CONTENTS                                             * 04750000
*                                                                     * 04800000
*    0-1         Used as work registers by the system                 * 04850000
*                                                                     * 04900000
*    2-13        Unchanged                                            * 04950000
*                                                                     * 05000000
*    14-15       Used as work registers by the system                 * 05050000
*                                                                     * 05100000
*                                                                     * 05150000
*                                                                     * 05200000
*    Some callers depend on register contents remaining the same      * 05250000
*    before and after issuing a service.  If the system changes the   * 05300000
*    contents of registers on which the caller depends, the caller    * 05350000
*    must save them before issuing the service, and restore them      * 05400000
*    after the system returns control.                                * 05450000
*                                                                     * 05500000
*01* PERFORMANCE IMPLICATIONS:                                        * 05550000
*    None.                                                            * 05600000
*                                                                     * 05650000
*01* SYNTAX:                                                          * 05700000
*                                                                     * 05750000
*[xlabel]  IOSENQ    RESOURCE=DYNCHPID                               * 05800000
*                   ,RESOURCE=NOT_SUPPORTED                          * 05850000
*                   ,REQUEST=ENQ                                     * 05900000
*                  |    ,STATE=SHARED                                * 05950000
*                  |    ,STATE=EXCLUSIVE                             * 06000000
*                  |    ,COND=NO                                     * 06050000
*                  |    ,COND=YES                                    * 06100000
*                  |        [,WAITTIME=xwaittime|SYSTEM_DEFINED]    * 06150000
*                   ,REQUEST=DEQ                                     * 06200000
*                   [,RETCODE=xretcode]                               * 06250000
*                   [,RSNCODE=xrsncode]                               * 06300000
*                   [,PLISTVER=xplistver|IMPLIED_VERSION]           * 06350000
*                  [,MF=S]                                           * 06400000
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 06450000
*                  [,MF=(E,xmfctrl,COMPLETE)]                      * 06500000
*                                                                     * 06550000
*                                                                     * 06600000
*      Where:                                                         * 06650000
*                                                                     * 06700000
*                                                                     * 06750000
*      [xlabel]                                                       * 06800000
*          is an optional symbol, starting in column 1, that is the   * 06850000
*          name on the IOSENQ macro invocation.  The name must        * 06900000
*          conform to the rules for an ordinary assembler language    * 06950000
*          symbol.                                                    * 07000000
*          DEFAULT: No name.                                          * 07050000
*                                                                     * 07100000
*                                                                     * 07150000
*                                                                     * 07200000
*                                                                     * 07250000
*      RESOURCE=DYNCHPID|NOT_SUPPORTED                              * 07300000
*          is a required keyword input that indicates the type of     * 07350000
*          request.                                                   * 07400000
*                                                                     * 07450000
*                                                                     * 07500000
*          RESOURCE=DYNCHPID                                          * 07550000
*              indicates to deal with the dynamic CHPID ENQ resource. * 07600000
*                                                                     * 07650000
*          RESOURCE=NOT_SUPPORTED                                     * 07700000
*              included just for AMG's sake.                          * 07750000
*                                                                     * 07800000
*                                                                     * 07850000
*                                                                     * 07900000
*                                                                     * 07950000
*                                                                     * 08000000
*                                                                     * 08050000
*      REQUEST=ENQ|DEQ                                              * 08100000
*          is a required keyword input that indicates the type of     * 08150000
*          request.                                                   * 08200000
*                                                                     * 08250000
*                                                                     * 08300000
*          REQUEST=ENQ                                                * 08350000
*              indicates to perform an ENQ operation.                 * 08400000
*                                                                     * 08450000
*                                                                     * 08500000
*              STATE=SHARED|EXCLUSIVE                               * 08550000
*                  is a required keyword input that indicates the     * 08600000
*                  state of the ENQ.                                  * 08650000
*                                                                     * 08700000
*                                                                     * 08750000
*                  STATE=SHARED                                       * 08800000
*                      indicates to obtain the ENQ in shared state.   * 08850000
*                                                                     * 08900000
*                  STATE=EXCLUSIVE                                    * 08950000
*                      indicates to obtain the ENQ in exclusive       * 09000000
*                      state.                                         * 09050000
*                                                                     * 09100000
*                                                                     * 09150000
*                                                                     * 09200000
*                                                                     * 09250000
*                                                                     * 09300000
*                                                                     * 09350000
*              COND=NO|YES                                          * 09400000
*                  is a required keyword input that indicates the     * 09450000
*                  conditional nature of the ENQ.                     * 09500000
*                                                                     * 09550000
*                                                                     * 09600000
*                  COND=NO                                            * 09650000
*                      indicates that this is not a conditional ENQ.  * 09700000
*                      Control will only be returned to the caller    * 09750000
*                      when the ENQ is held.                          * 09800000
*                                                                     * 09850000
*                  COND=YES                                           * 09900000
*                      indicates that this is a conditional ENQ.  If  * 09950000
*                      the ENQ cannot be obtained within the given    * 10000000
*                      length of time, processing is ended, and a     * 10050000
*                      return code indicating this situation is       * 10100000
*                      provided to the caller.                        * 10150000
*                                                                     * 10200000
*                                                                     * 10250000
*                      [WAITTIME=xwaittime|SYSTEM_DEFINED]          * 10300000
*                          is the name (RS-type), or address in       * 10350000
*                          register (2)-(12), of an optional fullword * 10400000
*                          input that specifies the maximum time in   * 10450000
*                          hundredths of seconds that the system is   * 10500000
*                          to wait for the ENQ to be obtained.  A     * 10550000
*                          value of 0, or omitting this parameter,    * 10600000
*                          results in the system using a              * 10650000
*                          pre-determined wait time.  The value is    * 10700000
*                          treated as a 32-bit unsigned number.       * 10750000
*                          DEFAULT: SYSTEM_DEFINED                    * 10800000
*                                                                     * 10850000
*                                                                     * 10900000
*                                                                     * 10950000
*                                                                     * 11000000
*                                                                     * 11050000
*                                                                     * 11100000
*                                                                     * 11150000
*          REQUEST=DEQ                                                * 11200000
*              indicates to perform a DEQ operation.  A warning       * 11250000
*              return code wil result if the ENQ is not held.         * 11300000
*                                                                     * 11350000
*                                                                     * 11400000
*                                                                     * 11450000
*                                                                     * 11500000
*                                                                     * 11550000
*                                                                     * 11600000
*      [RETCODE=xretcode]                                             * 11650000
*          is the name (RS-type) of an optional fullword output       * 11700000
*          variable, or register (2)-(12), into which the return code * 11750000
*          is to be copied from GPR 15.                               * 11800000
*                                                                     * 11850000
*                                                                     * 11900000
*                                                                     * 11950000
*                                                                     * 12000000
*      [RSNCODE=xrsncode]                                             * 12050000
*          is the name (RS-type) of an optional fullword output       * 12100000
*          variable, or register (2)-(12), into which the reason code * 12150000
*          is to be copied from GPR 0.                                * 12200000
*                                                                     * 12250000
*                                                                     * 12300000
*                                                                     * 12350000
*                                                                     * 12400000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 12450000
*          is an optional byte input decimal value in the "0-0" range * 12500000
*          that specifies the macro version.  PLISTVER is the only    * 12550000
*          key allowed on the list form of MF and determines which    * 12600000
*          parameter list is generated.  Note that MAX may be         * 12650000
*          specified instead of a number, and the parameter list will * 12700000
*          be of the largest size currently supported. This size may  * 12750000
*          grow from release to release (thus possibly affecting the  * 12800000
*          amount of storage needed by your program).  If your        * 12850000
*          program can tolerate this, IBM recommends that you always  * 12900000
*          specify MAX when creating the list form parameter list as  * 12950000
*          that will ensure that the list form parameter list is      * 13000000
*          always long enough to hold whatever parameters might be    * 13050000
*          specified on the execute form.                             * 13100000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 13150000
*          default is the lowest version which allows all of the      * 13200000
*          parameters specified on the invocation to be processed.    * 13250000
*                                                                     * 13300000
*                                                                     * 13350000
*                                                                     * 13400000
*                                                                     * 13450000
*      [MF=S|L|E]                                                   * 13500000
*          is an optional keyword input which specifies the macro     * 13550000
*          form.                                                      * 13600000
*          DEFAULT: S                                                 * 13650000
*                                                                     * 13700000
*                                                                     * 13750000
*          [MF=S]                                                     * 13800000
*              specifies the standard form of the macro.  The "S"     * 13850000
*              form generates code to put the parameters into an      * 13900000
*              in-line parameter list and invoke the desired service. * 13950000
*              Full checking for required macro keys is done along    * 14000000
*              with supplying defaults for omitted optional           * 14050000
*              parameters.                                            * 14100000
*                                                                     * 14150000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 14200000
*              specifies the list form of the macro.  The "L" form    * 14250000
*              defines an area to be used for the parameter list.     * 14300000
*              Only the PLISTVER key may be specified on the          * 14350000
*              invocation.  All other macro parameters are flagged as * 14400000
*              errors.  If PLISTVER is not specified, the original    * 14450000
*              parameter list definition is used.                     * 14500000
*                                                                     * 14550000
*            ,xmfctrl                                                 * 14600000
*              is a required input.  It is the name of a storage area * 14650000
*              for the parameter list.                                * 14700000
*                                                                     * 14750000
*            ,xmfattr|0D                                            * 14800000
*              is an optional 60 character input string that varies   * 14850000
*              from 1 to 60 characters. Use it to force boundary      * 14900000
*              alignment of the parameter list. Use only 0F or 0D.    * 14950000
*              DEFAULT: 0D which forces the parameter list to a       * 15000000
*              doubleword boundary.                                   * 15050000
*                                                                     * 15100000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 15150000
*              specifies the execute form of the macro.  The "E" form * 15200000
*              generates code to put the parameters into the          * 15250000
*              parameter list specified by xmfctrl and provides full  * 15300000
*              syntax checking with default setting.                  * 15350000
*                                                                     * 15400000
*            ,xmfctrl                                                 * 15450000
*              is a required input.  It is the name (RS-type), or     * 15500000
*              address in register (1)-(12), of a storage area for    * 15550000
*              the parameter list.                                    * 15600000
*                                                                     * 15650000
*            ,COMPLETE                                              * 15700000
*              is an optional keyword input which specifies the       * 15750000
*              degree of macro parameter syntax checking.             * 15800000
*              DEFAULT: COMPLETE                                      * 15850000
*                                                                     * 15900000
*                                                                     * 15950000
*              COMPLETE                                               * 16000000
*                  Checking for required macro keys is done and       * 16050000
*                  defaults are supplied for omitted optional         * 16100000
*                  parameters.                                        * 16150000
*                                                                     * 16200000
*                                                                     * 16250000
*                                                                     * 16300000
*                                                                     * 16350000
*                                                                     * 16400000
*                                                                     * 16450000
*                                                                     * 16500000
*01* ABEND CODES:  None.                                              * 16550000
*                                                                     * 16600000
*       The caller may get the following abend codes:                 * 16650000
*                                                                     * 16700000
*                                                                     * 16750000
*       0C4-4           Meaning: your program was not in supervisor   * 16800000
*                       state with PSW key 0                          * 16850000
*                                                                     * 16900000
*                       Action: only call IOSENQ when in supervisor   * 16950000
*                       state with PSW key 0                          * 17000000
*                                                                     * 17050000
*       B78-8           Meaning: your program was in problem state    * 17100000
*                       with PSW key 8-15                             * 17150000
*                                                                     * 17200000
*                       Action: only call IOSENQ when in supervisor   * 17250000
*                       state with PSW key 0                          * 17300000
*                                                                     * 17350000
*                                                                     * 17400000
*                                                                     * 17450000
*01* RETURN CODES:                                                    * 17500000
*                                                                     * 17550000
*                                                                     * 17600000
*                 Macro IOSDENQ provides equate symbols for the       * 17650000
*                 return and reason codes.                            * 17700000
*                                                                     * 17750000
*       0         Name: IOSENQRc_OK                                   * 17800000
*                                                                     * 17850000
*                 Meaning:  IOSENQ request successful.                * 17900000
*                                                                     * 17950000
*                 Action:  None required.                             * 18000000
*                                                                     * 18050000
*                                                                     * 18100000
*                 ENQ       MEANING: The ENQ is held.                 * 18150000
*                                                                     * 18200000
*                           ACTION: None required.                    * 18250000
*                                                                     * 18300000
*                 DEQ       MEANING: The ENQ is no longer held.       * 18350000
*                                                                     * 18400000
*                           ACTION: None required.                    * 18450000
*                                                                     * 18500000
*                                                                     * 18550000
*                                                                     * 18600000
*                                                                     * 18650000
*       4         Name: IOSENQRc_Warn                                 * 18700000
*                                                                     * 18750000
*                 Meaning: Warning                                    * 18800000
*                                                                     * 18850000
*                 Action:  Refer to the action provided with the      * 18900000
*                 specific reason code.                               * 18950000
*                                                                     * 19000000
*                                                                     * 19050000
*                 HEX REASON  MEANING/ACTION                          * 19100000
*                 CODE                                                * 19150000
*                                                                     * 19200000
*                 xxxx0401    Name: IOSENQRsnEnqAlreadyHeld           * 19250000
*                                                                     * 19300000
*                             Meaning: For ENQ, this task already     * 19350000
*                             holds the ENQ.  It could be held either * 19400000
*                             in shared or exclusive state.           * 19450000
*                                                                     * 19500000
*                             Action: Avoid using the IOSENQ          * 19550000
*                             REQUEST=ADD function when you already   * 19600000
*                             hold the requested ENQ.                 * 19650000
*                                                                     * 19700000
*                 xxxx0402    Name: IOSENQRsnEnqNotHeld               * 19750000
*                                                                     * 19800000
*                             Meaning: DEQ was requested but the      * 19850000
*                             caller did not have the ENQ.            * 19900000
*                                                                     * 19950000
*                             Action: None required.                  * 20000000
*                                                                     * 20050000
*                                                                     * 20100000
*                                                                     * 20150000
*                                                                     * 20200000
*       8         Name: IOSENQRc_InvParm                              * 20250000
*                                                                     * 20300000
*                 Meaning:  IOSENQ request specifies parmeters that   * 20350000
*                 are not valid.                                      * 20400000
*                                                                     * 20450000
*                 Action:  Refer to the action provided with the      * 20500000
*                 specific reason code.                               * 20550000
*                                                                     * 20600000
*                                                                     * 20650000
*                 HEX REASON  MEANING/ACTION                          * 20700000
*                 CODE                                                * 20750000
*                                                                     * 20800000
*                 xxxx0801    Name: IOSENQRsnBadRequest               * 20850000
*                                                                     * 20900000
*                             Meaning: An incorrect request was       * 20950000
*                             specified.                              * 21000000
*                                                                     * 21050000
*                             Action: Check for storage overlays.     * 21100000
*                                                                     * 21150000
*                 xxxx0802    Name: IOSENQRsnBadResource              * 21200000
*                                                                     * 21250000
*                             Meaning: An incorrect resource was      * 21300000
*                             requested.                              * 21350000
*                                                                     * 21400000
*                             Action: Check for storage overlays.     * 21450000
*                                                                     * 21500000
*                                                                     * 21550000
*                                                                     * 21600000
*                                                                     * 21650000
*       C         Name: IOSENQRc_Env                                  * 21700000
*                                                                     * 21750000
*                 Meaning: Environmental error                        * 21800000
*                                                                     * 21850000
*                 Action:  Refer to the action provided with the      * 21900000
*                 specific reason code.                               * 21950000
*                                                                     * 22000000
*                                                                     * 22050000
*                 HEX REASON  MEANING/ACTION                          * 22100000
*                 CODE                                                * 22150000
*                                                                     * 22200000
*                 xxxx0C01    Name: IOSENQRsnCouldNotGetENQ           * 22250000
*                                                                     * 22300000
*                             Meaning: On a conditional ENQ request,  * 22350000
*                             the ENQ could not be obtained within    * 22400000
*                             the specified time period.              * 22450000
*                                                                     * 22500000
*                             Action: Specify a longer time period,   * 22550000
*                             or request the ENQ unconditionally.     * 22600000
*                                                                     * 22650000
*                                                                     * 22700000
*                                                                     * 22750000
*                                                                     * 22800000
*                                                                     * 22850000
*01* REASON CODES:                                                    * 22900000
*                                                                     * 22950000
*       Reason codes, as appropriate, are defined under their         * 23000000
*       corresponding return code.                                    * 23050000
*                                                                     * 23100000
*01* MODULE TYPE:  ASSEM MACRO                                        * 23150000
*                                                                     * 23200000
*02*   PROCESSOR:  ASSEM                                              * 23250000
*                                                                     * 23300000
*01* COMPONENT:  SC1C3                                                * 23350000
*                                                                     * 23400000
*01* DISTRIBUTION LIBRARY: AINTLIB                                    * 23450000
*                                                                     * 23500000
*01* EXAMPLES:                                                        * 23550000
*                                                                     * 23600000
*    Example 1                                                        * 23650000
*                                                                     * 23700000
*    Operation:                                                       * 23750000
*                                                                     * 23800000
*                                                                     * 23850000
*    1.  Obtain the ENQ unconditionally                               * 23900000
*                                                                     * 23950000
*                                                                     * 24000000
*                                                                     * 24050000
*    The code is as follows.                                          * 24100000
*                                                                     * 24150000
*             IOSENQ REQUEST=ENQ,COND=NO,                         *   * 24200000
*                   RETCODE=LRETCODE,RSNCODE=LRSNCODE,            *   * 24250000
*                   MF=(E,IOENQL)                                     * 24300000
*    *                                                                * 24350000
*    * Place code to check return/reason codes here                   * 24400000
*    *                                                                * 24450000
*     ... processing code here ...                                    * 24500000
*             IOSDENQ               Return code information           * 24550000
*    DYNAREA  DSECT                                                   * 24600000
*    LRETCODE DS    F                                                 * 24650000
*    LRSNCODE DS    F                                                 * 24700000
*             IOSENQ MF=(L,IOENQL)                                    * 24750000
*                                                                     * 24800000
*                                                                     * 24850000
*    Example 2                                                        * 24900000
*                                                                     * 24950000
*    Operation:                                                       * 25000000
*                                                                     * 25050000
*                                                                     * 25100000
*    1.  Try to obtain the ENQ, but wait no more than 2 seconds.      * 25150000
*        Note that the WAITTIME parameter is expressed in hundredths  * 25200000
*        of seconds, so a value of 200 represents 2 seconds.          * 25250000
*                                                                     * 25300000
*                                                                     * 25350000
*                                                                     * 25400000
*    The code is as follows.                                          * 25450000
*                                                                     * 25500000
*             IOSENQ REQUEST=ENQ,COND=YES,                        *   * 25550000
*                   WAITTIME=WT,                                  *   * 25600000
*                   RETCODE=LRETCODE,RSNCODE=LRSNCODE,            *   * 25650000
*                   MF=(E,IOENQL)                                     * 25700000
*    *                                                                * 25750000
*    * Place code to check return/reason codes here                   * 25800000
*    *                                                                * 25850000
*     ... processing code here ...                                    * 25900000
*             IOSDENQ               Return code information           * 25950000
*    WT       DC    F'200'          200 hundredths of seconds         * 26000000
*    DYNAREA  DSECT                                                   * 26050000
*    LRETCODE DS    F                                                 * 26100000
*    LRSNCODE DS    F                                                 * 26150000
*             IOSENQ MF=(L,IOENQL)                                    * 26200000
*                                                                     * 26250000
*                                                                     * 26300000
*    Example 3                                                        * 26350000
*                                                                     * 26400000
*    Operation:                                                       * 26450000
*                                                                     * 26500000
*                                                                     * 26550000
*    1.  Get rid of (DEQ) the ENQ                                     * 26600000
*                                                                     * 26650000
*                                                                     * 26700000
*                                                                     * 26750000
*    The code is as follows.                                          * 26800000
*                                                                     * 26850000
*             IOSENQ REQUEST=DEQ,COND=NO,                         *   * 26900000
*                   RETCODE=LRETCODE,RSNCODE=LRSNCODE,            *   * 26950000
*                   MF=(E,IOENQL)                                     * 27000000
*    *                                                                * 27050000
*    * Place code to check return/reason codes here                   * 27100000
*    *                                                                * 27150000
*     ... processing code here ...                                    * 27200000
*             IOSDENQ               Return code information           * 27250000
*    DYNAREA  DSECT                                                   * 27300000
*    LRETCODE DS    F                                                 * 27350000
*    LRSNCODE DS    F                                                 * 27400000
*             IOSENQ MF=(L,IOENQL)                                    * 27450000
*                                                                     * 27500000
*                                                                     * 27550000
*01* MACRO USAGE NOTES:                                               * 27600000
*                                                                     * 27650000
*                                                                     * 27700000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 27750000
*        global macro variable.  Any value other than 'NO' will       * 27800000
*        result in the macro expansion being printed.  The default is * 27850000
*        'YES'.  The following examples illustrate how the ZPRINT     * 27900000
*        variable should be set.                                      * 27950000
*                                                                     * 28000000
*                    GBLC &ZPRINT                                     * 28050000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 28100000
*                                                                     * 28150000
*                                                                     * 28200000
*    2.  All  keys currently contained in the IOSENQ macro correspond * 28250000
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 28300000
*        MAX.                                                         * 28350000
*                                                                     * 28400000
*                                                                     * 28450000
*                                                                     * 28500000
*                                                                     * 28550000
*01* CHANGE ACTIVITY:                                                 * 28600000
*                                                                     * 28650000
*   Flag LineItem  FMID    Date   ID    Comment                       * 28700000
*                                                                     * 28750000
*    $L0=DYCHMAMG HBB7703 990706 PD00XB:  Dynamic CHPID               * 28800000
*    $L1=DYCHMIOS HBB7703 990706 PD00XB:  Dynamic CHPID               * 28850000
*    $P1=PXD0967  HBB7703 991220 PD00XB:  Fix offset to service       * 28866600
*                                         routine address             * 28883200
*    $P2=PXD1449  HBB7703 000310 PDNO:  Correct CDPI information      * 28891600
****** END OF SPECIFICATIONS *****************************************/ 28900000
*/* TLINE 1 *********************************************************** 28950000
         MACRO                                                          29000000
&XLABEL  IOSENQ &RESOURCE=,&REQUEST=,&STATE=,&COND=,&WAITTIME=,        *29050000
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      29100000
.*                                                                      29150000
*                   MACDATE -03/09/00-<0>                               29200000
.*                                                                      29250000
.*******************************************************************    29300000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        29350000
.*******************************************************************    29400000
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              29450000
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                29500000
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        29550000
.*                                                                      29600000
                   GBLC  &ZIOSENQ    YES=MACRO USED AT LEAST ONCE       29650000
.*******************************************************************    29700000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          29750000
.*******************************************************************    29800000
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            29850000
                   LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS       29900000
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         29950000
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        30000000
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        30050000
                   LCLA  &ZAWRK      USED AS A WORK AREA                30100000
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             30150000
                   LCLA  &ZN         NUMERIC WORK VARIABLE              30200000
                   LCLC  &ZC         CHARACTER WORK VARIABLE            30250000
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        30300000
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            30350000
                   LCLA  &ZMACRET    MACRO RETURN CODE                  30400000
&ZMACRET           SETA  0           ASSUME NO ERRORS                   30450000
.*                                                                      30500000
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      30550000
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         30600000
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              30650000
                   LCLC  &ZENDBASEPL            End of base PL          30700000
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              30750000
.*******************************************************************    30800000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             30850000
.*******************************************************************    30900000
                   LCLA  &ZI         INDEX FOR ARRAY                    30950000
                   LCLA  &ZJ         INDEX FOR PARMS                    31000000
                   LCLA  &ZK         INDEX FOR PARSE                    31050000
                   LCLA  &ZLO        LOW RANGE VALUE                    31100000
                   LCLA  &ZHI        HIGH RANGE VALUE                   31150000
                   LCLC  &ZW         WORK AREA FOR PARM                 31200000
.********************************************************************   31250000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 31300000
.********************************************************************   31350000
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            31400000
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     31450000
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   31475000
.*                                                                      31500000
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     31550000
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      31600000
                   SPLEVEL  TEST                                        31650000
.ZSYS2             ANOP  ,                                              31700000
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          31750000
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          31800000
                   SYSSTATE TEST                                        31850000
                   AGO   .ZSYS4                                         31900000
.ZSYS3             ANOP  ,                                              31950000
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            32000000
.ZSYS4             ANOP  ,                                              32050000
.*******************************************************************    32100000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   32150000
.*******************************************************************    32200000
                   LCLC  &XRESOURCE  ++ VALUE                           32250000
                   LCLC  &XREQUEST   ++ VALUE                           32300000
                   LCLC  &XSTATE     ++ VALUE                           32350000
                   LCLC  &XCOND      ++ VALUE                           32400000
                   LCLC  &XWAITTIME  ++ NAME                            32450000
                   LCLC  &XRETCODE   ++ NAME                            32500000
                   LCLC  &XRSNCODE   ++ NAME                            32550000
                   LCLA  &XPLISTVER  ++ VALUE                           32600000
                   LCLC  &XMF        ++ VALUE                           32650000
                   LCLC  &XMFCTRL    ++ NAME                            32700000
                   LCLC  &XMFATTR    ++ VALUE                           32750000
                   LCLC  &XMFSCK     ++ VALUE                           32800000
.*******************************************************************    32850000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           32900000
.*******************************************************************    32950000
                   LCLC  &ZXRESOURCE            ++ INPUT VALUE          33000000
                   LCLC  &ZXREQUEST  ++ INPUT VALUE                     33050000
                   LCLC  &ZXSTATE    ++ INPUT VALUE                     33100000
                   LCLC  &ZXCOND     ++ INPUT VALUE                     33150000
                   LCLC  &ZXWAITTIME            ++ INPUT NAME           33200000
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     33250000
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     33300000
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          33350000
                   LCLC  &ZXMF       ++ INPUT VALUE                     33400000
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      33450000
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     33500000
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     33550000
.********************************************************************   33600000
.***AC.PLV01  PROCESS PLISTVER                                      *   33650000
.********************************************************************   33700000
&XPLISTVER      SETA  0                                                 33750000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       33800000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   33850000
&XPLISTVER      SETA  0                                                 33900000
.ZPLV0          ANOP  ,                                                 33950000
.*                                                                      34000000
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      34050000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      34100000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  34150000
.*-------------------------------------------------------------------   34200000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 34250000
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                34300000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 34350000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 34400000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               34450000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                34500000
                AGO   .ZPVCK2                                           34550000
.ZPVCK3         ANOP  ,                                                 34600000
.*-------------------------------------------------------------------   34650000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  34700000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                34750000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 34800000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         34850000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 34900000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                34950000
                AGO   .ZPVCKE                                           35000000
.ZPVCK2         ANOP  ,                                                 35050000
.*-------------------------------------------------------------------   35100000
&ZCVAL          SETC  '&PLISTVER(1)'                                    35150000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             35200000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             35250000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        35300000
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      35350000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     35400000
.ZPVCK6         ANOP  ,                                                 35450000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                35500000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 35550000
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         35600000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         35650000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                35700000
&XPLISTVER      SETA  0                                                 35750000
                AGO   .ZPVCKE                                           35800000
.*-------------------------------------------------------------------   35850000
.ZPVCK4A        ANOP  ,                                                 35900000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        35950000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                36000000
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               36050000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          36100000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 36150000
                MNOTE 8,' &ZMS IS REQUIRED.'                            36200000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                36250000
                AGO   .ZPVCK5                                           36300000
.ZPVCK4         ANOP  ,                                                 36350000
&XPLISTVER      SETA  &PLISTVER(1)                                      36400000
.ZPVCK5         ANOP  ,                                                 36450000
.ZPVCKE         ANOP  ,                                                 36500000
.********************************************************************   36550000
.***AG.MF01 PROCESS MF MACRO FORMS                                      36600000
.********************************************************************   36650000
                   ACTR  10000                                          36700000
.*------------------------------------------------------------------    36750000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36800000
&XMF               SETC  ''          INITIALIZE XVARIABLE               36850000
.*-------------------------------------------------------------------   36900000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36950000
.ZG35              ANOP  ,                                              37000000
&ZTLC              SETC 'S'                                             37050000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG36                     37100000
&XMF               SETC  'S'         SET KEYWORD                        37150000
                   AIF   (N'&MF LE 1).ZG35A     CK NUM                  37200000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      37250000
&ZMS               SETC  '&ZMS.&MF"'                                    37300000
&ZMS               SETC  '&ZMS "MF"'                                    37350000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            37400000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        37450000
.ZG35A             ANOP  ,                                              37500000
.*-------------------------------------------------------------------   37550000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           37600000
.ZG36              ANOP  ,                                              37650000
&ZTLC              SETC 'L'                                             37700000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG43                     37750000
&XMF               SETC  'L'         SET KEYWORD                        37800000
                   AIF   (N'&MF LE 3).ZG36A     CK NUM                  37850000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      37900000
&ZMS               SETC  '&ZMS.&MF"'                                    37950000
&ZMS               SETC  '&ZMS "MF"'                                    38000000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           38050000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        38100000
.ZG36A             ANOP  ,                                              38150000
.*-------------------------------------------------------------------   38200000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     38250000
                   AIF   (N'&SYSLIST NE 0).ZG36B  POSITIONALS?          38300000
                   AIF   ('&RESOURCE' NE '').ZG36B  KEYS?               38350000
                   AIF   ('&REQUEST' NE '').ZG36B  KEYS?                38400000
                   AIF   ('&STATE' NE '').ZG36B  KEYS?                  38450000
                   AIF   ('&COND' NE '').ZG36B  KEYS?                   38500000
                   AIF   ('&WAITTIME' NE '').ZG36B  KEYS?               38550000
                   AIF   ('&RETCODE' NE '').ZG36B  KEYS?                38600000
                   AIF   ('&RSNCODE' NE '').ZG36B  KEYS?                38650000
                   AGO    .ZG36C     INVOCATION OKAY                    38700000
.ZG36B             ANOP  ,                                              38750000
&ZMS               SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE           38800000
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           38850000
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      38900000
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         38950000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        39000000
.ZG36C             ANOP  ,                                              39050000
.*-------------------------------------------------------------------   39100000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   39150000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      39200000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      39250000
                   AIF   (N'&MF(2) GT 1).ZG38B  MULTI PARMS             39300000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      39350000
.ZG38B             AIF   (K'&MF(2) GT 0).ZG38C                          39400000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    39450000
&ZMS               SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*               39500000
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            39550000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   39600000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        39650000
.ZG38C             ANOP  ,                                              39700000
.*-------------------------------------------------------------------   39750000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               39800000
                   AIF   (K'&ZXMFCTRL LE 0).ZG38P  NOT I/O              39850000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG38P                 39900000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    39950000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      40000000
&ZMS               SETC  '&ZMS.&MF"'                                    40050000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      40100000
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              40150000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        40200000
.ZG38P             ANOP  ,                                              40250000
.*-------------------------------------------------------------------   40300000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      40350000
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      40400000
&XMFATTR           SETC  '0D'                                           40450000
                   AIF   (K'&MF(3) LE 0).ZG41B  PARM                    40500000
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      40550000
                   AIF   (N'&MF(3) GT 1).ZG41B  MULTI PARMS             40600000
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      40650000
.ZG41B             ANOP  ,                                              40700000
.*-------------------------------------------------------------------   40750000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  40800000
                   AIF   (K'&ZXMFATTR LE 0).ZG41P  NOT I/O              40850000
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG41P                 40900000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    40950000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      41000000
&ZMS               SETC  '&ZMS.&MF"'                                    41050000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      41100000
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              41150000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        41200000
.ZG41P             ANOP  ,                                              41250000
.*-------------------------------------------------------------------   41300000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 41350000
                   AIF   (K'&ZXMFATTR LE 0).ZG41S  NOT I/O              41400000
                   AIF   (K'&XMFATTR LE 60).ZG41S  LNG OK               41450000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    41500000
&ZMS               SETC  '"MF='      *KLNGA* MNOTE                      41550000
&ZMS               SETC  '&ZMS.&MF"'                                    41600000
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          41650000
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             41700000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        41750000
.ZG41S             ANOP  ,                                              41800000
.*-------------------------------------------------------------------   41850000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           41900000
.ZG43              ANOP  ,                                              41950000
&ZTLC              SETC 'E'                                             42000000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG51                     42050000
&XMF               SETC  'E'         SET KEYWORD                        42100000
                   AIF   (N'&MF LE 3).ZG43A     CK NUM                  42150000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      42200000
&ZMS               SETC  '&ZMS.&MF"'                                    42250000
&ZMS               SETC  '&ZMS "MF"'                                    42300000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           42350000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        42400000
.ZG43A             ANOP  ,                                              42450000
.*-------------------------------------------------------------------   42500000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   42550000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      42600000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      42650000
                   AIF   (N'&MF(2) GT 1).ZG45B  MULTI PARMS             42700000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      42750000
.ZG45B             AIF   (K'&MF(2) GT 0).ZG45C                          42800000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    42850000
&ZMS               SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*               42900000
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            42950000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   43000000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        43050000
.ZG45C             ANOP  ,                                              43100000
.*-------------------------------------------------------------------   43150000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              43200000
                   AIF   (K'&ZXMFCTRL LE 0).ZG45R  NOT I/O              43250000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG45R                 43300000
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     43350000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG45P                   43400000
                   AIF   (K'&ZCGPR GT 2).ZG45Q                          43450000
                   AIF   ('&ZCGPR' EQ '0').ZG45Q                        43500000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  43550000
                   AIF   (T'&ZCGPR NE 'N').ZG45Q  INVALID REG NAME      43600000
.ZG45P             ANOP  ,                                              43650000
                   AIF   (T'&ZCGPR NE 'N').ZG45R  NON NUMERIC           43700000
                   AIF   ('&ZCGPR' LT '1').ZG45Q                        43750000
                   AIF   ('&ZCGPR' LE '12').ZG45R                       43800000
.ZG45Q             ANOP  ,                                              43850000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      43900000
&ZMS               SETC  '&ZMS.&MF"'                                    43950000
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      44000000
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               44050000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44100000
.ZG45R             ANOP  ,                                              44150000
.*-------------------------------------------------------------------   44200000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             44250000
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               44300000
.ZG49A   AIF   ('&MF(3)' NE 'COMPLETE').ZG50A                           44350000
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        44400000
.*-------------------------------------------------------------------   44450000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             44500000
.ZG50A             AIF   (K'&XMFSCK GT 0).ZG50C  KEYWORD                44550000
                   AIF   (K'&MF(3) LE 0).ZG50B                          44600000
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      44650000
&ZMS               SETC  '&ZMS.&MF"'                                    44700000
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      44750000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            44800000
&ZMS               SETC  '&ZMS "COMPLETE".'                             44850000
                   MNOTE 8,' &ZMS '                                     44900000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44950000
.ZG50B             ANOP  ,                                              45000000
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                45050000
.ZG50C             ANOP  ,                                              45100000
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      45150000
.*------------------------------------------------------------------    45200000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           45250000
.ZG51              ANOP  ,                                              45300000
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      45350000
                   AIF   (K'&XMF GT 0).ZG51E    VALID ARG               45400000
                   AIF   (T'&MF EQ 'O').ZG51D   OMITTED                 45450000
&ZASYSLNDX         SETA  0                                              45500000
.ZG51A             ANOP  ,           POSITIONAL MACRO KEY               45550000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   45600000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG51C               45650000
&ZTLC              SETC 'MF'                                            45700000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG51A      45750000
.ZG51B             ANOP  ,                                              45800000
&ZXMF              SETC  ''          RESET IN/OUTPUT                    45850000
&ZMS               SETC  'THE "MF" KEY'         *KOPTA* MNOTE           45900000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        45950000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               46000000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        46050000
                   AGO   .ZG51E                                         46100000
.ZG51C             ANOP  ,                                              46150000
&ZXMF              SETC  ''          RESET IN/OUTPUT                    46200000
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      46250000
&ZMS               SETC  '&ZMS.&MF"'                                    46300000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      46350000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            46400000
&ZMS               SETC  '&ZMS "S",'                                    46450000
&ZMS               SETC  '&ZMS "L",'                                    46500000
&ZMS               SETC  '&ZMS OR "E".'                                 46550000
                   MNOTE 8,' &ZMS '                                     46600000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        46650000
                   AGO   .ZG51E                                         46700000
.ZG51D             ANOP  ,                                              46750000
&XMF               SETC  'S'         SET DEFAULT KEYWORD                46800000
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  46850000
.ZG51E             ANOP  ,                                              46900000
.********************************************************************   46950000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 47000000
.********************************************************************   47050000
                   ACTR  10000                                          47100000
.*-------------------------------------------------------------------   47150000
.***AG.MF03 MF=(SLE)                                                    47200000
                   AIF   ('&XMF' EQ 'L').ZGMFX                          47250000
.*------------------------------------------------------------------    47300000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           47350000
&XRESOURCE         SETC  ''          INITIALIZE XVARIABLE               47400000
.*-------------------------------------------------------------------   47450000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           47500000
.ZG3               ANOP  ,                                              47550000
                   AIF   (K'&RESOURCE(1) LE 0).ZG3A                     47600000
&ZTLC              SETC 'DYNCHPID'                                      47650000
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG4                47700000
&XRESOURCE         SETC  'DYNCHPID'  SET KEYWORD                        47750000
                   AIF   (N'&RESOURCE LE 1).ZG3A  CK NUM                47800000
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           47850000
&ZMS               SETC  '&ZMS.&RESOURCE"'                              47900000
&ZMS               SETC  '&ZMS "RESOURCE"'                              47950000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            48000000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        48050000
.ZG3A              ANOP  ,                                              48100000
.*-------------------------------------------------------------------   48150000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           48200000
.ZG4               ANOP  ,                                              48250000
&ZTLC              SETC 'NOT_SUPPORTED'                                 48300000
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG5                48350000
&XRESOURCE         SETC  'NOT_SUPPORTED'        SET KEYWORD             48400000
                   AIF   (N'&RESOURCE LE 1).ZG4A  CK NUM                48450000
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           48500000
&ZMS               SETC  '&ZMS.&RESOURCE"'                              48550000
&ZMS               SETC  '&ZMS "RESOURCE"'                              48600000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            48650000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        48700000
.ZG4A              ANOP  ,                                              48750000
.*------------------------------------------------------------------    48800000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           48850000
.ZG5               ANOP  ,                                              48900000
&ZXRESOURCE        SETC  'INPUT'     SET IN/OUTPUT                      48950000
                   AIF   (K'&XRESOURCE GT 0).ZG5E  VALID ARG            49000000
                   AIF   (T'&RESOURCE EQ 'O').ZG5D  OMITTED             49050000
&ZASYSLNDX         SETA  0                                              49100000
.ZG5A              ANOP  ,           POSITIONAL MACRO KEY               49150000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   49200000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG5C                49250000
&ZTLC              SETC 'RESOURCE'                                      49300000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG5A       49350000
.ZG5B              ANOP  ,                                              49400000
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    49450000
&ZMS               SETC  'THE "RESOURCE" KEY'   *KOPTA* MNOTE           49500000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        49550000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               49600000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        49650000
                   AGO   .ZG5E                                          49700000
.ZG5C              ANOP  ,                                              49750000
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    49800000
&ZMS               SETC  '"RESOURCE='           *KUKWA* MNOTE           49850000
&ZMS               SETC  '&ZMS.&RESOURCE"'                              49900000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      49950000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            50000000
&ZMS               SETC  '&ZMS "DYNCHPID"'                              50050000
&ZMS               SETC  '&ZMS OR "NOT_SUPPORTED".'                     50100000
                   MNOTE 8,' &ZMS '                                     50150000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        50200000
                   AGO   .ZG5E                                          50250000
.ZG5D              ANOP  ,                                              50300000
&XRESOURCE         SETC  'DYNCHPID'  SET DEFAULT KEYWORD                50350000
.ZG5E              ANOP  ,                                              50400000
.*------------------------------------------------------------------    50450000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           50500000
                   AIF   (K'&RESOURCE(1) GT 0).ZG5F  PARM               50550000
&XRESOURCE         SETC  ''          ENSURE NULL KEYWORD                50600000
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    50650000
&ZMS               SETC  'THE'                                          50700000
&ZMS               SETC  '&ZMS "RESOURCE" KEY AND ITS'                  50750000
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  50800000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            50850000
&ZMS               SETC  '&ZMS "DYNCHPID"'                              50900000
&ZMS               SETC  '&ZMS OR "NOT_SUPPORTED".'                     50950000
                   MNOTE 8,' &ZMS '                                     51000000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        51050000
.ZG5F              ANOP  ,                                              51100000
.*------------------------------------------------------------------    51150000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           51200000
&XREQUEST          SETC  ''          INITIALIZE XVARIABLE               51250000
.*-------------------------------------------------------------------   51300000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           51350000
.ZG8               ANOP  ,                                              51400000
                   AIF   (K'&REQUEST(1) LE 0).ZG8A                      51450000
&ZTLC              SETC 'ENQ'                                           51500000
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG22                51550000
&XREQUEST          SETC  'ENQ'       SET KEYWORD                        51600000
                   AIF   (N'&REQUEST LE 1).ZG8A  CK NUM                 51650000
&ZMS               SETC  '"REQUEST='            *KPOSA* MNOTE           51700000
&ZMS               SETC  '&ZMS.&REQUEST"'                               51750000
&ZMS               SETC  '&ZMS "REQUEST"'                               51800000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            51850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        51900000
.ZG8A              ANOP  ,                                              51950000
.*------------------------------------------------------------------    52000000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           52050000
&XSTATE            SETC  ''          INITIALIZE XVARIABLE               52100000
.*-------------------------------------------------------------------   52150000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           52200000
.ZG11              ANOP  ,                                              52250000
                   AIF   (K'&STATE(1) LE 0).ZG11A                       52300000
&ZTLC              SETC 'SHARED'                                        52350000
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG12                  52400000
&XSTATE            SETC  'SHARED'    SET KEYWORD                        52450000
                   AIF   (N'&STATE LE 1).ZG11A  CK NUM                  52500000
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      52550000
&ZMS               SETC  '&ZMS.&STATE"'                                 52600000
&ZMS               SETC  '&ZMS "STATE"'                                 52650000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            52700000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        52750000
.ZG11A             ANOP  ,                                              52800000
.*-------------------------------------------------------------------   52850000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           52900000
.ZG12              ANOP  ,                                              52950000
&ZTLC              SETC 'EXCLUSIVE'                                     53000000
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG13                  53050000
&XSTATE            SETC  'EXCLUSIVE'            SET KEYWORD             53100000
                   AIF   (N'&STATE LE 1).ZG12A  CK NUM                  53150000
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      53200000
&ZMS               SETC  '&ZMS.&STATE"'                                 53250000
&ZMS               SETC  '&ZMS "STATE"'                                 53300000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            53350000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        53400000
.ZG12A             ANOP  ,                                              53450000
.*------------------------------------------------------------------    53500000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           53550000
.ZG13              ANOP  ,                                              53600000
&ZXSTATE           SETC  'INPUT'     SET IN/OUTPUT                      53650000
                   AIF   (K'&XSTATE GT 0).ZG13E  VALID ARG              53700000
                   AIF   (T'&STATE EQ 'O').ZG13D  OMITTED               53750000
&ZASYSLNDX         SETA  0                                              53800000
.ZG13A             ANOP  ,           POSITIONAL MACRO KEY               53850000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   53900000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG13C               53950000
&ZTLC              SETC 'STATE'                                         54000000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG13A      54050000
.ZG13B             ANOP  ,                                              54100000
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    54150000
&ZMS               SETC  'THE "STATE" KEY'      *KOPTA* MNOTE           54200000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        54250000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               54300000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        54350000
                   AGO   .ZG13E                                         54400000
.ZG13C             ANOP  ,                                              54450000
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    54500000
&ZMS               SETC  '"STATE='   *KUKWA* MNOTE                      54550000
&ZMS               SETC  '&ZMS.&STATE"'                                 54600000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      54650000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            54700000
&ZMS               SETC  '&ZMS "SHARED"'                                54750000
&ZMS               SETC  '&ZMS OR "EXCLUSIVE".'                         54800000
                   MNOTE 8,' &ZMS '                                     54850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        54900000
                   AGO   .ZG13E                                         54950000
.ZG13D             ANOP  ,                                              55000000
&XSTATE            SETC  'SHARED'    SET DEFAULT KEYWORD                55050000
.ZG13E             ANOP  ,                                              55100000
.*------------------------------------------------------------------    55150000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           55200000
                   AIF   (K'&STATE(1) GT 0).ZG13F  PARM                 55250000
&XSTATE            SETC  ''          ENSURE NULL KEYWORD                55300000
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    55350000
&ZMS               SETC  'THE'                                          55400000
&ZMS               SETC  '&ZMS "STATE" KEY AND ITS'                     55450000
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  55500000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            55550000
&ZMS               SETC  '&ZMS "SHARED"'                                55600000
&ZMS               SETC  '&ZMS OR "EXCLUSIVE".'                         55650000
                   MNOTE 8,' &ZMS '                                     55700000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        55750000
.ZG13F             ANOP  ,                                              55800000
.*------------------------------------------------------------------    55850000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           55900000
&XCOND             SETC  ''          INITIALIZE XVARIABLE               55950000
.*-------------------------------------------------------------------   56000000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           56050000
.ZG16              ANOP  ,                                              56100000
                   AIF   (K'&COND(1) LE 0).ZG16A                        56150000
&ZTLC              SETC 'NO'                                            56200000
                   AIF   ('&COND(1)' NE '&ZTLC').ZG17                   56250000
&XCOND             SETC  'NO'        SET KEYWORD                        56300000
                   AIF   (N'&COND LE 1).ZG16A   CK NUM                  56350000
&ZMS               SETC  '"COND='    *KPOSA* MNOTE                      56400000
&ZMS               SETC  '&ZMS.&COND"'                                  56450000
&ZMS               SETC  '&ZMS "COND"'                                  56500000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            56550000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        56600000
.ZG16A             ANOP  ,                                              56650000
.*------------------------------------------------------------------    56700000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           56750000
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        56800000
.ZG16A0            AIF   (K'&WAITTIME LE 0).ZG16A1  OK                  56850000
&ZCVAL             SETC '&ZCVAL WAITTIME'       INCORRECT KEY USED      56900000
.ZG16A1            AIF   (K'&ZCVAL LE 0).ZG16A2  OK                     56950000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          57000000
&ZMS               SETC  '"COND'     *KMEIA* MNOTE                      57050000
&ZMS               SETC  '&ZMS.=&COND"'                                 57100000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           57150000
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           57200000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        57250000
.ZG16A2            ANOP  ,                                              57300000
.*-------------------------------------------------------------------   57350000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           57400000
.ZG17              ANOP  ,                                              57450000
&ZTLC              SETC 'YES'                                           57500000
                   AIF   ('&COND(1)' NE '&ZTLC').ZG21                   57550000
&XCOND             SETC  'YES'       SET KEYWORD                        57600000
                   AIF   (N'&COND LE 1).ZG17A   CK NUM                  57650000
&ZMS               SETC  '"COND='    *KPOSA* MNOTE                      57700000
&ZMS               SETC  '&ZMS.&COND"'                                  57750000
&ZMS               SETC  '&ZMS "COND"'                                  57800000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            57850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        57900000
.ZG17A             ANOP  ,                                              57950000
.*----------------------------------------------------------------***   58000000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     58050000
                   AIF   (N'&WAITTIME LE 1).ZG19A  CK NUM               58100000
&ZMS               SETC  '"WAITTIME='           *KPOSA* MNOTE           58150000
&ZMS               SETC  '&ZMS.&WAITTIME"'                              58200000
&ZMS               SETC  '&ZMS "WAITTIME"'                              58250000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            58300000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        58350000
.ZG19A             ANOP  ,                                              58400000
.*-------------------------------------------------------------------   58450000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         58500000
&ZXWAITTIME        SETC  'INPUT'     SET IN/OUTPUT                      58550000
&XWAITTIME         SETC  'SYSTEM_DEFINED'                               58600000
                   AIF   (K'&WAITTIME(1) LE 0).ZG19B  PARM              58650000
&XWAITTIME         SETC  '&WAITTIME(1)'         SET XVARIABLE           58700000
                   AIF   (N'&WAITTIME GT 1).ZG19B  MULTI PARMS          58750000
&XWAITTIME         SETC  '&WAITTIME'            SET XVARIABLE           58800000
.ZG19B             ANOP  ,                                              58850000
.*-------------------------------------------------------------------   58900000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    58950000
                   AIF   (K'&ZXWAITTIME LE 0).ZG19R  NOT I/O            59000000
         AIF   ('&XWAITTIME' EQ 'SYSTEM_DEFINED').ZG19R                 59050000
                   AIF   ('&XWAITTIME'(1,1) NE '(').ZG19R               59100000
&ZCGPR             SETC  '&XWAITTIME'(2,K'&XWAITTIME-2)                 59150000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                   59200000
                   AIF   (K'&ZCGPR GT 2).ZG19Q                          59250000
                   AIF   ('&ZCGPR' EQ '0').ZG19Q                        59300000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  59350000
                   AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME      59400000
.ZG19P             ANOP  ,                                              59450000
                   AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC           59500000
                   AIF   ('&ZCGPR' LT '2').ZG19Q                        59550000
                   AIF   ('&ZCGPR' LE '12').ZG19R                       59600000
.ZG19Q             ANOP  ,                                              59650000
&ZMS               SETC  '"WAITTIME='           *KGPRA* MNOTE           59700000
&ZMS               SETC  '&ZMS.&WAITTIME"'                              59750000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      59800000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               59850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        59900000
.ZG19R             ANOP  ,                                              59950000
.*------------------------------------------------------------------    60000000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           60050000
.ZG21              ANOP  ,                                              60100000
&ZXCOND            SETC  'INPUT'     SET IN/OUTPUT                      60150000
                   AIF   (K'&XCOND GT 0).ZG21E  VALID ARG               60200000
                   AIF   (T'&COND EQ 'O').ZG21D  OMITTED                60250000
&ZASYSLNDX         SETA  0                                              60300000
.ZG21A             ANOP  ,           POSITIONAL MACRO KEY               60350000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   60400000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C               60450000
&ZTLC              SETC 'COND'                                          60500000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG21A      60550000
.ZG21B             ANOP  ,                                              60600000
&ZXCOND            SETC  ''          RESET IN/OUTPUT                    60650000
&ZMS               SETC  'THE "COND" KEY'       *KOPTA* MNOTE           60700000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        60750000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               60800000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        60850000
                   AGO   .ZG21E                                         60900000
.ZG21C             ANOP  ,                                              60950000
&ZXCOND            SETC  ''          RESET IN/OUTPUT                    61000000
&ZMS               SETC  '"COND='    *KUKWA* MNOTE                      61050000
&ZMS               SETC  '&ZMS.&COND"'                                  61100000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      61150000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            61200000
&ZMS               SETC  '&ZMS "NO"'                                    61250000
&ZMS               SETC  '&ZMS OR "YES".'                               61300000
                   MNOTE 8,' &ZMS '                                     61350000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        61400000
                   AGO   .ZG21E                                         61450000
.ZG21D             ANOP  ,                                              61500000
&XCOND             SETC  'NO'        SET DEFAULT KEYWORD                61550000
.ZG21E             ANOP  ,                                              61600000
.*------------------------------------------------------------------    61650000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           61700000
                   AIF   (K'&COND(1) GT 0).ZG21F  PARM                  61750000
&XCOND             SETC  ''          ENSURE NULL KEYWORD                61800000
&ZXCOND            SETC  ''          RESET IN/OUTPUT                    61850000
&ZMS               SETC  'THE'                                          61900000
&ZMS               SETC  '&ZMS "COND" KEY AND ITS'                      61950000
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  62000000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            62050000
&ZMS               SETC  '&ZMS "NO"'                                    62100000
&ZMS               SETC  '&ZMS OR "YES".'                               62150000
                   MNOTE 8,' &ZMS '                                     62200000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        62250000
.ZG21F             ANOP  ,                                              62300000
.*-------------------------------------------------------------------   62350000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           62400000
.ZG22              ANOP  ,                                              62450000
&ZTLC              SETC 'DEQ'                                           62500000
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG23                62550000
&XREQUEST          SETC  'DEQ'       SET KEYWORD                        62600000
                   AIF   (N'&REQUEST LE 1).ZG22A  CK NUM                62650000
&ZMS               SETC  '"REQUEST='            *KPOSA* MNOTE           62700000
&ZMS               SETC  '&ZMS.&REQUEST"'                               62750000
&ZMS               SETC  '&ZMS "REQUEST"'                               62800000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            62850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        62900000
.ZG22A             ANOP  ,                                              62950000
.*------------------------------------------------------------------    63000000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           63050000
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        63100000
.ZG22A0            AIF   (K'&STATE LE 0).ZG22A1  OK                     63150000
&ZCVAL             SETC '&ZCVAL STATE'          INCORRECT KEY USED      63200000
.ZG22A1            AIF   (K'&COND LE 0).ZG22A2  OK                      63250000
&ZCVAL             SETC '&ZCVAL COND'           INCORRECT KEY USED      63300000
.ZG22A2            AIF   (K'&WAITTIME LE 0).ZG22A3  OK                  63350000
&ZCVAL             SETC '&ZCVAL WAITTIME'       INCORRECT KEY USED      63400000
.ZG22A3            AIF   (K'&ZCVAL LE 0).ZG22A4  OK                     63450000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          63500000
&ZMS               SETC  '"REQUEST'  *KMEIA* MNOTE                      63550000
&ZMS               SETC  '&ZMS.=&REQUEST"'                              63600000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           63650000
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           63700000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        63750000
.ZG22A4            ANOP  ,                                              63800000
.*------------------------------------------------------------------    63850000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           63900000
.ZG23              ANOP  ,                                              63950000
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      64000000
                   AIF   (K'&XREQUEST GT 0).ZG23E  VALID ARG            64050000
                   AIF   (T'&REQUEST EQ 'O').ZG23D  OMITTED             64100000
&ZASYSLNDX         SETA  0                                              64150000
.ZG23A             ANOP  ,           POSITIONAL MACRO KEY               64200000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   64250000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG23C               64300000
&ZTLC              SETC 'REQUEST'                                       64350000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG23A      64400000
.ZG23B             ANOP  ,                                              64450000
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    64500000
&ZMS               SETC  'THE "REQUEST" KEY'    *KOPTA* MNOTE           64550000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        64600000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               64650000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        64700000
                   AGO   .ZG23E                                         64750000
.ZG23C             ANOP  ,                                              64800000
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    64850000
&ZMS               SETC  '"REQUEST='            *KUKWA* MNOTE           64900000
&ZMS               SETC  '&ZMS.&REQUEST"'                               64950000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      65000000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            65050000
&ZMS               SETC  '&ZMS "ENQ"'                                   65100000
&ZMS               SETC  '&ZMS OR "DEQ".'                               65150000
                   MNOTE 8,' &ZMS '                                     65200000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        65250000
                   AGO   .ZG23E                                         65300000
.ZG23D             ANOP  ,                                              65350000
&XREQUEST          SETC  'ENQ'       SET DEFAULT KEYWORD                65400000
.ZG23E             ANOP  ,                                              65450000
.*------------------------------------------------------------------    65500000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           65550000
                   AIF   (K'&REQUEST(1) GT 0).ZG23F  PARM               65600000
&XREQUEST          SETC  ''          ENSURE NULL KEYWORD                65650000
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    65700000
&ZMS               SETC  'THE'                                          65750000
&ZMS               SETC  '&ZMS "REQUEST" KEY AND ITS'                   65800000
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  65850000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            65900000
&ZMS               SETC  '&ZMS "ENQ"'                                   65950000
&ZMS               SETC  '&ZMS OR "DEQ".'                               66000000
                   MNOTE 8,' &ZMS '                                     66050000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        66100000
.ZG23F             ANOP  ,                                              66150000
.*----------------------------------------------------------------***   66200000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    66250000
                   AIF   (N'&RETCODE LE 1).ZG25A  CK NUM                66300000
&ZMS               SETC  '"RETCODE='            *KPOSA* MNOTE           66350000
&ZMS               SETC  '&ZMS.&RETCODE"'                               66400000
&ZMS               SETC  '&ZMS "RETCODE"'                               66450000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            66500000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        66550000
.ZG25A             ANOP  ,                                              66600000
.*-------------------------------------------------------------------   66650000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        66700000
                   AIF   (K'&RETCODE(1) LE 0).ZG25C  NO PARM            66750000
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         66800000
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           66850000
                   AIF   (N'&RETCODE GT 1).ZG25C                        66900000
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      66950000
.ZG25C             ANOP  ,                                              67000000
.*-------------------------------------------------------------------   67050000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   67100000
                   AIF   (K'&ZXRETCODE LE 0).ZG25R  NOT I/O             67150000
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG25R                67200000
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   67250000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                   67300000
                   AIF   (K'&ZCGPR GT 2).ZG25Q                          67350000
                   AIF   ('&ZCGPR' EQ '0').ZG25Q                        67400000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  67450000
                   AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME      67500000
.ZG25P             ANOP  ,                                              67550000
                   AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC           67600000
                   AIF   ('&ZCGPR' LT '2').ZG25Q                        67650000
                   AIF   ('&ZCGPR' LE '12').ZG25R                       67700000
.ZG25Q             ANOP  ,                                              67750000
&ZMS               SETC  '"RETCODE='            *KGPRA* MNOTE           67800000
&ZMS               SETC  '&ZMS.&RETCODE"'                               67850000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      67900000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               67950000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        68000000
.ZG25R             ANOP  ,                                              68050000
.*----------------------------------------------------------------***   68100000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    68150000
                   AIF   (N'&RSNCODE LE 1).ZG28A  CK NUM                68200000
&ZMS               SETC  '"RSNCODE='            *KPOSA* MNOTE           68250000
&ZMS               SETC  '&ZMS.&RSNCODE"'                               68300000
&ZMS               SETC  '&ZMS "RSNCODE"'                               68350000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            68400000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        68450000
.ZG28A             ANOP  ,                                              68500000
.*-------------------------------------------------------------------   68550000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        68600000
                   AIF   (K'&RSNCODE(1) LE 0).ZG28C  NO PARM            68650000
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         68700000
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           68750000
                   AIF   (N'&RSNCODE GT 1).ZG28C                        68800000
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      68850000
.ZG28C             ANOP  ,                                              68900000
.*-------------------------------------------------------------------   68950000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   69000000
                   AIF   (K'&ZXRSNCODE LE 0).ZG28R  NOT I/O             69050000
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG28R                69100000
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   69150000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                   69200000
                   AIF   (K'&ZCGPR GT 2).ZG28Q                          69250000
                   AIF   ('&ZCGPR' EQ '0').ZG28Q                        69300000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  69350000
                   AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME      69400000
.ZG28P             ANOP  ,                                              69450000
                   AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC           69500000
                   AIF   ('&ZCGPR' LT '2').ZG28Q                        69550000
                   AIF   ('&ZCGPR' LE '12').ZG28R                       69600000
.ZG28Q             ANOP  ,                                              69650000
&ZMS               SETC  '"RSNCODE='            *KGPRA* MNOTE           69700000
&ZMS               SETC  '&ZMS.&RSNCODE"'                               69750000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      69800000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               69850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        69900000
.ZG28R             ANOP  ,                                              69950000
.******************************************************************     70000000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        70050000
.******************************************************************     70100000
                   ACTR  10000                                          70150000
.*----------------------------------------------------------------***   70200000
.***AH.P02 EXTRA POSITIONALS                                            70250000
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           70300000
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           70350000
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       70400000
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        70450000
.ZGLISTX1          ANOP  ,                                              70500000
&ZCVAL             SETC  ''          ERROR FIELD                        70550000
&ZAWRK             SETA  0           POSITIONAL NUMBER                  70600000
.ZGLIST2           ANOP  ,                                              70650000
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    70700000
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           70750000
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                70800000
                   AGO   .ZGLIST2                                       70850000
.*                                                                      70900000
.ZGLIST3           ANOP  ,                                              70950000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             71000000
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE       71050000
&ZMS               SETC  '&ZMS "&ZCVAL"'                                71100000
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         71150000
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 71200000
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         71250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        71300000
.ZGLISTX           ANOP  ,                                              71350000
&ZASYSLNDX         SETA  0                                              71400000
.*-------------------------------------------------------------------   71450000
.***AG.MF04 MF=(SLE)                                                    71500000
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           71550000
.*******************************************************************    71600000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       71650000
.*******************************************************************    71700000
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          71750000
.*******************************************************************    71800000
.***AE.01  START OF IOSENQ MACRO CODE                                   71850000
.*******************************************************************    71900000
                   LCLC  &M0M0001                 NAME                  71950000
&M0M0001           SETC  '&XLABEL'                SET NAME              72000000
                   AIF   (K'&XLABEL NE 0).XLAB2                         72050000
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          72100000
.*                                                                      72150000
.XLAB2             ANOP  ,                                              72200000
                   AIF   ('&XMF' EQ 'L').XLAB3                          72250000
&M0M0001 DS    0H                             IOSENQ-0                  72300000
.XLAB3             ANOP  ,                                              72350000
.*******************************************************************    72400000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              72450000
.*******************************************************************    72500000
              PUSH  PRINT                                               72550000
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     72600000
                   PRINT OFF         ++ PR01                            72650000
                   AGO   .ZPRNTXX                                       72700000
.ZPRINTX           PRINT ON                                             72750000
.ZPRNTXX           ANOP  ,                                              72800000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  72850000
         LCLC  &T2                                                 @L1A 72900000
         AIF   ('&RESOURCE' EQ '').OKRESOURCE                      @L1A 72950000
         AIF   ('&RESOURCE' EQ 'DYNCHPID').OKRESOURCE              @L1A 73000000
&T2      SETC  'RESOURCE=NOT_SUPPORTED MAY NOT BE SPECIFIED.'      @L1A 73050000
         MNOTE 8,'&T2'                                             @L1A 73100000
         MEXIT                                                     @L1A 73150000
.OKRESOURCE ANOP                                                   @L1A 73200000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  73250000
.********************************************************************   73300000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     73350000
.********************************************************************   73400000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       73450000
                      LCLA  &ZOPN1         INVOCATION INDEX             73500000
                      LCLC  &ZOPL(4095)    LABEL                        73550000
                      LCLC  &ZOPO(4095)    OPERATION                    73600000
                      LCLC  &ZOPV(4095)    VALUE                        73650000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  73700000
.*                                                                      73750000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     73800000
.******************************************************************     73850000
.***AL.L10 IOSENQ FMT=LIST MF=S|L PARAMETERS                            73900000
.******************************************************************     73950000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     74000000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     74050000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     74100000
&XMFATTR              SETC  '0D'                                        74150000
.*                                                                      74200000
&ZOPN                 SETA  &ZOPN+1                                     74250000
&ZOPL(&ZOPN)          SETC  ' '                                         74300000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     74325000
&ZOPO(&ZOPN)          SETC  'B'                                         74350000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                74400000
                      AGO   .ZALVL6B                                    74408300
.ZALVL6A              ANOP                                              74416600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      74424900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              74433200
.ZALVL6B              ANOP                                              74441500
&ZOPD(&ZOPN)          SETC  '++ IOSENQ ARG PARMS'                       74450000
.*                                                                      74500000
&ZOPN                 SETA  &ZOPN+1                                     74550000
&ZOPL(&ZOPN)          SETC  ' '                                         74600000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     74650000
&ZOPV(&ZOPN)          SETC  '1'                                         74700000
&ZOPD(&ZOPN)          SETC  ' '                                         74750000
.*                                                                      74800000
.ZLMFSL2              ANOP  ,                                           74850000
.*-------------------------------------------------------------------   74900000
.***AM.L00  IOSENQ FMT=LIST name                                        74950000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    75000000
&ZOPN                 SETA &ZOPN+1                                      75050000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   75100000
&ZOPO(&ZOPN)          SETC 'EQU'                                        75150000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   75200000
&ZOPD(&ZOPN)          SETC '++ IOSENQ NAME'                             75250000
.ZLMFSL2M             ANOP  ,                                           75300000
.*-------------------------------------------------------------------   75350000
.***AM.L01  IOSENQ FMT=LIST PARAMETERS                                  75400000
&ZOPN                 SETA &ZOPN+1                                      75450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   75500000
&ZOPO(&ZOPN)          SETC 'DS'                                         75550000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   75600000
&ZOPD(&ZOPN)          SETC '++ IOSENQ PARM LIST'                        75650000
.*-------------------------------------------------------------------   75700000
.***AM.L02 XVERSION XL1                                                 75750000
&ZOPN                 SETA &ZOPN+1                                      75800000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         75850000
&ZOPO(&ZOPN)          SETC 'DS'                                         75900000
&ZOPV(&ZOPN)          SETC 'XL1'                                        75950000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          76000000
.*-------------------------------------------------------------------   76050000
.***AM.L05 XREQUEST XL1                                                 76100000
&ZOPN                 SETA &ZOPN+1                                      76150000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         76200000
&ZOPO(&ZOPN)          SETC 'DS'                                         76250000
&ZOPV(&ZOPN)          SETC 'XL1'                                        76300000
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     76350000
.*                                                                      76400000
&ZOPN                 SETA  &ZOPN+1                                     76450000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_ENQ'                    76500000
&ZOPO(&ZOPN)          SETC  'EQU'                                       76550000
&ZOPV(&ZOPN)          SETC  '0'                                         76600000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              76650000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ENQ'                          76700000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      76750000
.*                                                                      76800000
&ZOPN                 SETA  &ZOPN+1                                     76850000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_DEQ'                    76900000
&ZOPO(&ZOPN)          SETC  'EQU'                                       76950000
&ZOPV(&ZOPN)          SETC  '1'                                         77000000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              77050000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEQ'                          77100000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      77150000
.*-------------------------------------------------------------------   77200000
.***AM.L03 XFLAGS0 BL.8                                                 77250000
&ZOPN                 SETA &ZOPN+1                                      77300000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS0'                          77350000
&ZOPO(&ZOPN)          SETC 'DS'                                         77400000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       77450000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             77500000
.*                                                                      77550000
&ZOPN                 SETA  &ZOPN+1                                     77600000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATE_SHARED'                   77650000
&ZOPO(&ZOPN)          SETC  'EQU'                                       77700000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             77750000
&ZOPD(&ZOPN)          SETC  '++ XSTATE.'                                77800000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SHARED'                       77850000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      77900000
.*                                                                      77950000
&ZOPN                 SETA  &ZOPN+1                                     78000000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCOND_YES'                       78050000
&ZOPO(&ZOPN)          SETC  'EQU'                                       78100000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             78150000
&ZOPD(&ZOPN)          SETC  '++ XCOND.'                                 78200000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          78250000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      78300000
.*-------------------------------------------------------------------   78350000
.***AM.L05 XRESOURCE XL1                                                78400000
&ZOPN                 SETA &ZOPN+1                                      78450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESOURCE'                        78500000
&ZOPO(&ZOPN)          SETC 'DS'                                         78550000
&ZOPV(&ZOPN)          SETC 'XL1'                                        78600000
&ZOPD(&ZOPN)          SETC '++ &ZXRESOURCE XRESOURCE'                   78650000
.*                                                                      78700000
&ZOPN                 SETA  &ZOPN+1                                     78750000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRESOURCE_DYNCHPID'              78800000
&ZOPO(&ZOPN)          SETC  'EQU'                                       78850000
&ZOPV(&ZOPN)          SETC  '0'                                         78900000
&ZOPD(&ZOPN)          SETC  '++ XRESOURCE.'                             78950000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DYNCHPID'                     79000000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      79050000
.*-------------------------------------------------------------------   79100000
.***AM.L09  XWAITTIME F                                                 79150000
&ZOPN                 SETA &ZOPN+1                                      79200000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWAITTIME'                        79250000
&ZOPO(&ZOPN)          SETC 'DS'                                         79300000
&ZOPV(&ZOPN)          SETC 'F'                                          79350000
&ZOPD(&ZOPN)          SETC '++ &ZXWAITTIME  XWAITTIME'                  79400000
.*-------------------------------------------------------------------   79450000
.***AM.L09  XRSV0008 CL8                                                79500000
&ZOPN                 SETA &ZOPN+1                                      79550000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0008'                         79600000
&ZOPO(&ZOPN)          SETC 'DS'                                         79650000
&ZOPV(&ZOPN)          SETC 'CL8'                                        79700000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0008'                      79750000
.*-------------------------------------------------------------------   79800000
.***AM.L10 END OF IOSENQ LIST PARAMETERS                                79850000
&ZOPN                 SETA &ZOPN+1                                      79900000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 79950000
&ZOPO(&ZOPN)          SETC 'EQU'                                        80000000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 80050000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         80100000
.*                                                                      80150000
&ZOPN                 SETA &ZOPN+1                                      80200000
&ZOPL(&ZOPN)          SETC ' '                                          80250000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      80300000
&ZOPV(&ZOPN)          SETC '1'                                          80350000
&ZOPD(&ZOPN)          SETC ' '                                          80400000
.*-------------------------------------------------------------------   80450000
.***AL.L12 IOSENQ FMT=LIST MF=S|L PARAMETERS                            80500000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         80550000
.*                                                                      80600000
&ZOPN                 SETA  &ZOPN+1                                     80650000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                80700000
&ZOPO(&ZOPN)          SETC  'DC'                                        80750000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   80800000
&ZOPD(&ZOPN)          SETC  '++ IOSENQ ARG PARMS'                       80850000
.*                                                                      80900000
.ZLMFSLX              ANOP  ,                                           80950000
.*-------------------------------------------------------------------   81000000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          81050000
&ZPLLEN               SETA 16                                           81100000
.*                                                                      81150000
.******************************************************************     81200000
.***AI.L01 IOSENQ FMT=LIST FILL IN PARAMETER AREA                       81250000
.******************************************************************     81300000
                      ACTR  10000                                       81350000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               81400000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    81450000
&ZCVAL                SETC  'LAE'          XAX MODE                     81500000
.ZIMFXA               ANOP ,                                            81550000
.*                                                                      81600000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    81650000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         81700000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 81750000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                81800000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 81850000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                81900000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   81950000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    82000000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   82050000
&ZOPN                 SETA  &ZOPN+1                                     82100000
&ZOPL(&ZOPN)          SETC  ' '                                         82150000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    82200000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              82250000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       82300000
                      AGO   .ZIMFNX                                     82350000
.*                                                                      82400000
.ZIMFN2               ANOP ,                                            82450000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     82454500
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     82459000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  82463500
&ZOPN                 SETA  &ZOPN+1                                     82468000
&ZOPL(&ZOPN)          SETC  ' '                                         82472500
&ZOPO(&ZOPN)          SETC  'LAE'                                       82477000
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  82481500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       82486000
                      AGO   .ZIMFNX                                     82490500
.ZIMFNX1              ANOP ,                                            82495000
&ZOPN                 SETA  &ZOPN+1                                     82500000
&ZOPL(&ZOPN)          SETC  ' '                                         82550000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    82600000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                82650000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       82700000
.ZIMFNX               ANOP ,                                            82750000
.********************************************************************   82800000
.***AI.L02 IOSENQ FMT=LIST INITIALIZE PARAMETER AREA                    82850000
.********************************************************************   82900000
.***AI.L03 MF=(SLE)                                                     82950000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      83000000
.*                                                                      83050000
&ZOPN                 SETA  &ZOPN+1                                     83100000
&ZOPL(&ZOPN)          SETC  ' '                                         83150000
&ZOPO(&ZOPN)          SETC  'XC'                                        83200000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         83250000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             83300000
.ZIMFLX               ANOP  ,                                           83350000
.*-------------------------------------------------------------------   83400000
.***AI.L07 XREQUEST AL1                                                 83450000
&ZW                   SETC  ''                                          83500000
.*-------------------------------------------------------------------   83550000
.***AI.L15 XREQUEST "ENQ" AL1                                           83600000
         AIF   ('&XREQUEST' NE 'ENQ').ZI3A                              83650000
&ZW                   SETC  '0'                                         83700000
.ZI3A                 ANOP  ,                                           83750000
.*-------------------------------------------------------------------   83800000
.***AI.L15 XREQUEST "DEQ" AL1                                           83850000
         AIF   ('&XREQUEST' NE 'DEQ').ZI4A                              83900000
&ZW                   SETC  '1'                                         83950000
.ZI4A                 ANOP  ,                                           84000000
.*-------------------------------------------------------------------   84050000
.***AI.L17 XREQUEST AL1                                                 84100000
                      AIF   ('&ZW' EQ '0').ZI4B                         84150000
                      AIF   ('&ZW' EQ '').ZI4B                          84200000
.*                                                                      84250000
&ZOPN                 SETA  &ZOPN+1                                     84300000
&ZOPL(&ZOPN)          SETC  ' '                                         84350000
&ZOPO(&ZOPN)          SETC  'MVI'                                       84400000
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  84450000
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    84500000
.ZI4B                 ANOP  ,                                           84550000
.*-------------------------------------------------------------------   84600000
.***AI.L05 XFLAGS0 BL1                                                  84650000
&ZW                   SETC  ''                                          84700000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            84750000
.*-------------------------------------------------------------------   84800000
.***AI.L08 XFLAGS0 "SHARED"                                             84850000
.***      BL1'1XXXXXXX'                                                 84900000
         AIF   ('&XSTATE' NE 'SHARED').ZI6A                             84950000
&ZW                   SETC  '&ZW.1'                                     85000000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              85050000
                      AGO   .ZI6C                                       85100000
.*                                                                      85150000
.ZI6A                 ANOP  ,                                           85200000
&ZW                   SETC  '&ZW.0'                                     85250000
.ZI6C                 ANOP  ,                                           85300000
.*-------------------------------------------------------------------   85350000
.***AI.L08 XFLAGS0 "YES"                                                85400000
.***      BL1'XXX1XXXX'                                                 85450000
         AIF   ('&XCOND' NE 'YES').ZI7A                                 85500000
&ZW                   SETC  '&ZW.0010000'                               85550000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              85600000
                      AGO   .ZI7C                                       85650000
.*                                                                      85700000
.ZI7A                 ANOP  ,                                           85750000
&ZW                   SETC  '&ZW.0000000'                               85800000
.ZI7C                 ANOP  ,                                           85850000
.*-------------------------------------------------------------------   85900000
.***AI.L11 XFLAGS0 BL1                                                  85950000
                      AIF   ('&ZCLNG' NE 'YES').ZI7E  ALL ZERO BITS     86000000
&ZOPN                 SETA  &ZOPN+1                                     86050000
&ZOPL(&ZOPN)          SETC  ' '                                         86100000
&ZOPO(&ZOPN)          SETC  'OI'                                        86150000
&ZOPV(&ZOPN)          SETC  '2(1),B''&ZW'''                             86200000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              86250000
.ZI7E                 ANOP  ,                                           86300000
.*-------------------------------------------------------------------   86350000
.***AI.L07 XRESOURCE AL1                                                86400000
&ZW                   SETC  ''                                          86450000
.*-------------------------------------------------------------------   86500000
.***AI.L15 XRESOURCE "DYNCHPID" AL1                                     86550000
         AIF   ('&XRESOURCE' NE 'DYNCHPID').ZI9A                        86600000
&ZW                   SETC  '0'                                         86650000
.ZI9A                 ANOP  ,                                           86700000
.*-------------------------------------------------------------------   86750000
.***AI.L17 XRESOURCE AL1                                                86800000
                      AIF   ('&ZW' EQ '0').ZI9B                         86850000
                      AIF   ('&ZW' EQ '').ZI9B                          86900000
.*                                                                      86950000
&ZOPN                 SETA  &ZOPN+1                                     87000000
&ZOPL(&ZOPN)          SETC  ' '                                         87050000
&ZOPO(&ZOPN)          SETC  'MVI'                                       87100000
&ZOPV(&ZOPN)          SETC  '3(1),&ZW'                                  87150000
&ZOPD(&ZOPN)          SETC  '++ &ZXRESOURCE XRESOURCE'                  87200000
.ZI9B                 ANOP  ,                                           87250000
.*-------------------------------------------------------------------   87300000
.***AI.L18  XWAITTIME F                                                 87350000
         AIF   ('&XWAITTIME' NE 'SYSTEM_DEFINED').ZI10                  87400000
&ZXWAITTIME           SETC  ''             RESET INPUT/OUTPUT           87450000
.ZI10                 ANOP  ,                                           87500000
.*-------------------------------------------------------------------   87550000
.***AI.L25  XWAITTIME F                                                 87600000
                      AIF   ('&ZXWAITTIME' EQ '').ZI10E                 87650000
                      AIF   ('&ZXWAITTIME' EQ 'OUTPUT').ZI10E           87700000
&ZCGPR                SETC  '&XWAITTIME'                                87750000
.*                                                                      87800000
                      AIF   ('&XWAITTIME'(1,1) NE '(').ZI10B            87850000
&ZCGPR   SETC  '0('.'&XWAITTIME'(2,K'&XWAITTIME-2).')'                  87900000
                      AGO   .ZI10D                                      87950000
.ZI10B                ANOP  ,                                           88000000
.*                                                                      88050000
&ZC                   SETC  '&XWAITTIME'(1,1)                           88100000
                      AIF   (T'&ZC NE 'N').ZI10D                        88150000
&ZC                   SETC  '&XWAITTIME'                                88200000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               88250000
&ZCGPR                SETC  '=FL4''&XWAITTIME'''                        88300000
.*                                                                      88350000
.ZI10D                ANOP  ,                                           88400000
.*                                                                      88450000
&ZOPN                 SETA  &ZOPN+1                                     88500000
&ZOPL(&ZOPN)          SETC  ' '                                         88550000
&ZOPO(&ZOPN)          SETC  'MVC'                                       88600000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             88650000
&ZOPD(&ZOPN)          SETC  '++ &ZXWAITTIME XWAITTIME'                  88700000
.*                                                                      88750000
.ZI10E                ANOP  ,                                           88800000
.*-------------------------------------------------------------------   88850000
&ZOPN1                SETA &ZOPN                                        88900000
.*******************************************************************    88950000
.***  PROCESS IOSENQ OUTPUT PARAMETERS                                  89000000
.*******************************************************************    89050000
                      ACTR  10000                                       89100000
.*******************************************************************    89150000
.***AO.X02  RETURN CODE PROCESSING                                      89200000
.*******************************************************************    89250000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    89300000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            89350000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             89400000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             89450000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               89500000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                89550000
&ZOPN                 SETA  &ZOPN+1                                     89600000
&ZOPL(&ZOPN)          SETC  ' '                                         89650000
&ZOPO(&ZOPN)          SETC  'ST'                                        89700000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              89750000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        89800000
                      AGO   .ZMRETX                                     89850000
.*                                                                      89900000
.ZMRET2               ANOP  ,                                           89950000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                90000000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                90050000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                90100000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  90150000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   90200000
&ZOPN                 SETA  &ZOPN+1                                     90250000
&ZOPL(&ZOPN)          SETC  ' '                                         90300000
&ZOPO(&ZOPN)          SETC  'LR'                                        90350000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 90400000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        90450000
.ZMRETX               ANOP  ,                                           90500000
.*******************************************************************    90550000
.***AO.X03  REASON CODE PROCESSING                                      90600000
.*******************************************************************    90650000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    90700000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            90750000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              90800000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             90850000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              90900000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             90950000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                91000000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 91050000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                91100000
&ZOPN                 SETA  &ZOPN+1                                     91150000
&ZOPL(&ZOPN)          SETC  ' '                                         91200000
&ZOPO(&ZOPN)          SETC  'ST'                                        91250000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               91300000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        91350000
                      AGO   .ZMRSNX                                     91400000
.*                                                                      91450000
.ZMRSN2               ANOP  ,                                           91500000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                91550000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 91600000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                91650000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 91700000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                91750000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   91800000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    91850000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   91900000
&ZOPN                 SETA  &ZOPN+1                                     91950000
&ZOPL(&ZOPN)          SETC  ' '                                         92000000
&ZOPO(&ZOPN)          SETC  'LR'                                        92050000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  92100000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        92150000
.ZMRSNX               ANOP  ,                                           92200000
.*******************************************************************    92250000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   92300000
.*******************************************************************    92350000
.ZMFLX                ANOP  ,              MF=L PROCESSING              92400000
.*******************************************************************    92450000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               92500000
.*******************************************************************    92550000
                      ACTR  10000                                       92600000
.*                                                                      92650000
                      LCLA  &ZLC           COLUMN POSITION              92700000
                      LCLA  &ZOPX          LIST TABLE INDEX             92750000
                      LCLC  &ZLL           LABEL                        92800000
                      LCLC  &ZLOP          OPERATION                    92850000
                      LCLC  &ZLV           VALUE                        92900000
                      LCLC  &ZLD           DESCRIPTION                  92950000
.*                                                                      93000000
&ZOPX                 SETA  1                                           93050000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            93100000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              93150000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              93200000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              93250000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              93300000
                      AIF   (K'&ZLD LE 0).ZL5                           93350000
&ZLC                  SETA  35             COMMENT COLUMN               93400000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    93450000
&ZLC                  SETA  33             COMMMENT COLUMN              93500000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   93550000
&ZLV                  SETC  '&ZLV'.' '                                  93600000
                      AGO   .ZL3                                        93650000
.*                                                                      93700000
.ZL4                  ANOP  ,                                           93750000
&ZLV                  SETC  '&ZLV'.' '                                  93800000
.ZL5                  ANOP  ,                                           93850000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               93900000
.*                                                                      93950000
&ZLL     &ZLOP &ZLV                                                     94000000
.*                                                                      94050000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               94100000
                      AGO   .ZL2           CONTINUE LOOPING             94150000
.*                                                                      94200000
.ZLX                  ANOP  ,                                           94250000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                94300000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  94350000
         L     14,16(0,0)              Get CVT address             @L1A 94400000
         L     14,124(14,0)            Get IOCOM address           @L1A 94450000
         L     14,208(14,0)            Get IOVT address            @L1A 94500000
         L     15,236(14,0)            Get target routine address  @L1A 94550000
         BASR  14,15                   Call routine                @L1A 94600000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  94650000
.ZLINKX               ANOP  ,                                           94700000
.*******************************************************************    94750000
.***AP.X01  FORMAT GENERATED CODE                                       94800000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            94850000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              94900000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              94950000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              95000000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              95050000
                      AIF   (K'&ZLD LE 0).ZL51                          95100000
&ZLC                  SETA  35             COMMENT COLUMN               95150000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   95200000
&ZLC                  SETA  33             COMMENT COLUMN               95250000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  95300000
&ZLV                  SETC  '&ZLV'.' '                                  95350000
                      AGO   .ZL31                                       95400000
.*                                                                      95450000
.ZL41                 ANOP  ,                                           95500000
&ZLV                  SETC  '&ZLV'.' '                                  95550000
.ZL51                 ANOP  ,                                           95600000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               95650000
.*                                                                      95700000
&ZLL     &ZLOP &ZLV                                                     95750000
.*                                                                      95800000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               95850000
                      AGO   .ZL21          CONTINUE LOOPING             95900000
.*                                                                      95950000
.ZLX1                 ANOP  ,                                           96000000
.*******************************************************************    96050000
.***AP.X02  END OF IOSENQ MACRO                                         96100000
&ZIOSENQ              SETC  'YES'          SET IOSENQ USED              96150000
         POP   PRINT                                                    96200000
*                                            IOSENQ-0                   96250000
         SPACE 1                                                        96300000
.ZLX2                 ANOP  ,                                           96350000
         MEND                                                           96400000
**********************************************************************/ 96450000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  96500000
*%IOSENQ: MACRO KEYS(RESOURCE,REQUEST,STATE,COND,WAITTIME,RETCODE,      96550000
*                 RSNCODE,PLISTVER,MF);                                 96600000
*  ANS('?'||MACLABEL||' '||'IOSENQP '||MACLIST||                        96650000
*         ' '||MACKEYS||';') COL(MACLMAR);                              96700000
*%END IOSENQ;                                                           96750000
