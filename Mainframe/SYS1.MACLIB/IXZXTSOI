*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXZXTSOI                              -96/01/26-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Multi-system TSO/E interface                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1997                           * 00001300
*                                                                     * 00001400
* STATUS= HBB6603                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      Purpose:  This service provides the necessary interfaces to    * 00002200
*      allow TSO/E to run as a multi-system component in conjunction  * 00002300
*      with Generic Resources provided by VTAM.                       * 00002400
*                                                                     * 00002500
*      The macro provides the following functions:                    * 00002600
*                                                                     * 00002700
*                                                                     * 00002800
*      1.  Determine which system in the sysplex a TSO user is        * 00002900
*          running and return this information to the caller.         * 00003000
*                                                                     * 00003100
*      2.  Run a TSO/E exit routine on the system in the sysplex      * 00003200
*          where a TSO user is logged on.                             * 00003300
*                                                                     * 00003400
*      3.  Run a TSO/E exit routine on a specified system in the      * 00003500
*          sysplex, a group of systems in the sysplex, or all active  * 00003600
*          systems in the sysplex.                                    * 00003700
*                                                                     * 00003800
*                                                                     * 00003900
*      When using this service to run a TSO/E exit routine on one or  * 00004000
*      more systems:                                                  * 00004100
*                                                                     * 00004200
*                                                                     * 00004300
*      1.  The caller can pass input data to the exit routine via     * 00004400
*          this service.                                              * 00004500
*                                                                     * 00004600
*      2.  The caller can indicate via this service that output data, * 00004700
*          if generated by the TSO/E exit routine, is to be returned  * 00004800
*          to the caller.                                             * 00004900
*                                                                     * 00005000
*      3.  The TSO/E exit routine will run only on active systems in  * 00005100
*          the sysplex.                                               * 00005200
*                                                                     * 00005300
*      4.  A group of systems can be specified using the name of a    * 00005400
*          token previously built using the service IEANTCR.  The     * 00005500
*          token must be in IEEGSYS format in order for this service  * 00005600
*          to use it.  Or, a special name of *ALL can be specified to * 00005700
*          represent all active systems in the sysplex.               * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*      When using this service to run a TSO/E exit routine on a       * 00006100
*      system where a userid is logged on:                            * 00006200
*                                                                     * 00006300
*                                                                     * 00006400
*      1.  The caller must pass input data to the exit routine via    * 00006500
*          this service.                                              * 00006600
*                                                                     * 00006700
*      2.  The caller can indicate via this service that output data, * 00006800
*          if generated by the TSO/E exit routine, is to be returned  * 00006900
*          to the caller.                                             * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*      When using this service to determine where a userid is logged  * 00007300
*      on:                                                            * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*      1.  No TSO/E exit routine will be called.                      * 00007700
*                                                                     * 00007800
*      2.  The caller must not pass input data via this service.      * 00007900
*                                                                     * 00008000
*      3.  The caller must indicate that output data is to be         * 00008100
*          returned.  The output data, provided by JES, will contain  * 00008200
*          the system name.                                           * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*      EEC Implications:                                              * 00008700
*                                                                     * 00008800
*      This macro is not an EEC interface.                            * 00008900
*                                                                     * 00009000
*      Related Macros:                                                * 00009100
*                                                                     * 00009200
*      None                                                           * 00009300
*                                                                     * 00009400
*      Requirements                                                   * 00009500
*                                                                     * 00009600
*                                                                     * 00009700
*      o   JES environment: All JES environments                      * 00009800
*                                                                     * 00009900
*      o   Authorization: Supervisor State                            * 00010000
*                                                                     * 00010100
*      o   Dispatchable unit mode: Task                               * 00010200
*                                                                     * 00010300
*      o   Cross memory mode: PASN = HASN = SASN                      * 00010400
*                                                                     * 00010500
*      o   Callers key: 0-7                                           * 00010600
*                                                                     * 00010700
*      o   AMODE: 31                                                  * 00010800
*                                                                     * 00010900
*      o   ASC mode: Primary                                          * 00011000
*                                                                     * 00011100
*      o   Serialization: Enabled for interrupts                      * 00011200
*                                                                     * 00011300
*      o   Locks: The caller must not hold any locks.                 * 00011400
*                                                                     * 00011500
*      o   Control Parameters:  None                                  * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*      Register Information                                           * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*      o   Input registers                                            * 00012300
*                                                                     * 00012400
*          Before issuing the IXZXTSOI macro, the caller does not     * 00012500
*          have to place any information into any register unless     * 00012600
*          using it in register notation for a particular parameter,  * 00012700
*          or using it as a base register.                            * 00012800
*                                                                     * 00012900
*      o   Output registers                                           * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*          -   R0 - Reason code                                       * 00013300
*                                                                     * 00013400
*          -   R1 - Unpredictable                                     * 00013500
*                                                                     * 00013600
*          -   R2-R13 - Unchanged                                     * 00013700
*                                                                     * 00013800
*          -   R14 - Unpredictable                                    * 00013900
*                                                                     * 00014000
*          -   R15 - Return code                                      * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*      Programming Notes/Requirements                                 * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*      1.  This macro has implied MVS waits.  Therefore, callers must * 00015000
*          not do anything that prohibits waits (for example, holding * 00015100
*          any locks).                                                * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*      Restrictions                                                   * 00015600
*                                                                     * 00015700
*                                                                     * 00015800
*      o   The caller must not hold any locks.                        * 00015900
*                                                                     * 00016000
*      o   The caller must not have an FRR established.               * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*      Performance Implications:                                      * 00016500
*                                                                     * 00016600
*      This macro has no performance impact.                          * 00016700
*                                                                     * 00016800
*01* EXTERNAL CLASSIFICATION:  NONE                                   * 00016900
*                                                                     * 00017000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00017100
*                                                                     * 00017200
*01* SYNTAX:                                                          * 00017300
*                                                                     * 00017400
*[xlabel]  IXZXTSOI    USERID=xuserid                                * 00017500
*                     ,SYSTEM=xsystem                                * 00017600
*                     [,INDATA=xindata|0                            * 00017700
*                          ,INDATALEN=xindatalen                      * 00017800
*                         [,INDATAKEY=xindatakey|CALLER_KEY]]       * 00017900
*                     [,OUTDATA=xoutdata                              * 00018000
*                          ,OUTDATALEN=xoutdatalen                    * 00018100
*                         [,OUTDATAKEY=xoutdatakey|CALLER_KEY]]     * 00018200
*                     [,RTNCODE=xrtncode]                             * 00018300
*                     [,RSNCODE=xrsncode]                             * 00018400
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00018500
*                    [,MF=S]                                         * 00018600
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00018700
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*      Where:                                                         * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*      [xlabel]                                                       * 00019400
*          is an optional symbol, starting in column 1, that is the   * 00019500
*          name on the IXZXTSOI macro invocation.  The name must      * 00019600
*          conform to the rules for an ordinary assembler language    * 00019700
*          symbol.                                                    * 00019800
*          DEFAULT: No name.                                          * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*      The following is a set of mutually exclusive keys.  This set   * 00020400
*      is required; only one key must be specified.                   * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*      USERID=xuserid                                                 * 00020800
*          belongs to a set of mutually exclusive keys. It is the     * 00020900
*          name (RS-type), or address in register (2)-(12), of an 8   * 00021000
*          character input that specifies the userid which the caller * 00021100
*          is trying to locate.  If found, the input data provided by * 00021200
*          the caller (via INDATA= keyword) will be passed to the     * 00021300
*          TSO/E exit routine on the system where the userid is       * 00021400
*          running. If the userid is not active no data will be       * 00021500
*          passed and no exit routine will be called.                 * 00021600
*                                                                     * 00021700
*          If no input data is provided, no exit routine will be      * 00021800
*          called.  The name of the system on which the user is       * 00021900
*          active will be returned via the OUTDATA parameter.         * 00022000
*          OUTDATA must be specified in order to use the function in  * 00022100
*          this way.                                                  * 00022200
*                                                                     * 00022300
*      SYSTEM=xsystem                                                 * 00022400
*          belongs to a set of mutually exclusive keys. It is the     * 00022500
*          name (RS-type), or address in register (2)-(12), of an 8   * 00022600
*          character input that specifies the system where the TSO/E  * 00022700
*          exit routine is to be invoked, or the name of a group of   * 00022800
*          systems on which the TSO/E exit routine is to be invoked.  * 00022900
*          The group must have previously been registered via the     * 00023000
*          name/token service and must be in IEEGSYS format.          * 00023100
*                                                                     * 00023200
*          If *ALL is specified, the data specfied by INDATA will be  * 00023300
*          passed to the TSO/E exit routine on all active systems in  * 00023400
*          the sysplex.                                               * 00023500
*                                                                     * 00023600
*          If a group is specified, the data specfied by INDATA will  * 00023700
*          be passed to the TSO/E exit routine on all active systems  * 00023800
*          in the group.                                              * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*      End of a set of mutually exclusive required keys.              * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*      [INDATA=xindata|0                                            * 00024700
*          is the name (RS-type), or address in register (2)-(12), of * 00024800
*          an optional 4 byte input that contains the address of a    * 00024900
*          block of data that is passed to the TSO/E exit routine,    * 00025000
*          when using this service to call an exit routine.  The data * 00025100
*          must be read-accessible in the caller's key.               * 00025200
*          DEFAULT: 0 No data is to be passed to the caller.          * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*          INDATALEN=xindatalen                                       * 00025600
*              is the name (RS-type), or address in register          * 00025700
*              (2)-(12), of a required fullword input that contains   * 00025800
*              the length of the data item pointed to by the DATA     * 00025900
*              keyword. This is the amount of data that will be       * 00026000
*              transfered to the target system or systems.  This      * 00026100
*              value must be no greater than 60K bytes.               * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*          [INDATAKEY=xindatakey|CALLER_KEY]]                       * 00026700
*              is the name (RS-type), or address in register          * 00026800
*              (2)-(12), of an optional byte input that specifies the * 00026900
*              key of the input data.                                 * 00027000
*              DEFAULT: CALLER_KEY The key of the caller              * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*      [OUTDATA=xoutdata                                              * 00027800
*          is the name (RS-type), or address in register (2)-(12), of * 00027900
*          an optional 4 byte output that will contain the address of * 00028000
*          the output data.                                           * 00028100
*                                                                     * 00028200
*          When using this service to determine which system in the   * 00028300
*          sysplex a user is logged on, OUTDATA is required.  Upon    * 00028400
*          return, the address referenced by OUTDATA contains a       * 00028500
*          pointer to a data area containing the system name.         * 00028600
*          OUTDATALEN contains the length of this data area.          * 00028700
*                                                                     * 00028800
*          When using this service to call a TSO/E exit routine,      * 00028900
*          OUTDATA may be specified to request any output generated   * 00029000
*          by the TSO/E exit routine to be returned to the caller.    * 00029100
*          Upon return, the address referenced by OUTDATA contains a  * 00029200
*          pointer to a data area mapped by the macro IXZYRCRD and    * 00029300
*          this data area contains one or more segments of data, one  * 00029400
*          for each system that invoked the TSO/E exit routine.       * 00029500
*          OUTDATALEN contains the length of the entire data area.    * 00029600
*                                                                     * 00029700
*          If OUTDATA is specified, the caller is responsible for     * 00029800
*          freeing the area.  The subpool in which the storage        * 00029900
*          resides is represented by the constant                     * 00030000
*          RCRD_StorageSubpool, which is defined within IXZYRCRD.     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*          OUTDATALEN=xoutdatalen                                     * 00030400
*              is the name (RS-type), or address in register          * 00030500
*              (2)-(12), of a required fullword output that specifies * 00030600
*              the length of the returned data.  Note: the length of  * 00030700
*              the returned data cannot exceed 60K bytes.             * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*          [OUTDATAKEY=xoutdatakey|CALLER_KEY]]                     * 00031300
*              is the name (RS-type), or address in register          * 00031400
*              (2)-(12), of an optional byte input that specifies the * 00031500
*              key of the returned data.                              * 00031600
*              DEFAULT: CALLER_KEY The key of the caller              * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*      [RTNCODE=xrtncode]                                             * 00032400
*          is the name (RS-type) of an optional fullword output       * 00032500
*          variable, or register (2)-(12), into which the return code * 00032600
*          is to be copied from GPR 15.                               * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*      [RSNCODE=xrsncode]                                             * 00033200
*          is the name (RS-type) of an optional fullword output       * 00033300
*          variable, or register (2)-(12), into which the reason code * 00033400
*          is to be copied from GPR 0.                                * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00034000
*          is an optional byte input decimal value in the "1-1" range * 00034100
*          that specifies the macro version.  PLISTVER is the only    * 00034200
*          key allowed on the list form of MF and determines which    * 00034300
*          parameter list is generated.  Note that MAX may be         * 00034400
*          specified instead of a number, and the parameter list will * 00034500
*          be of the largest size currently supported. This size may  * 00034600
*          grow from release to release (thus possibly affecting the  * 00034700
*          amount of storage needed by your program).  If your        * 00034800
*          program can tolerate this, IBM recommends that you always  * 00034900
*          specify MAX when creating the list form parameter list as  * 00035000
*          that will ensure that the list form parameter list is      * 00035100
*          always long enough to hold whatever parameters might be    * 00035200
*          specified on the execute form.                             * 00035300
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00035400
*          default is the lowest version which allows all of the      * 00035500
*          parameters specified on the invocation to be processed.    * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*      [MF=S|L|E]                                                   * 00036100
*          is an optional keyword input which specifies the macro     * 00036200
*          form.                                                      * 00036300
*          DEFAULT: S                                                 * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*          [MF=S]                                                     * 00036700
*              specifies the standard form of the macro.  The "S"     * 00036800
*              form generates code to put the parameters into an      * 00036900
*              in-line parameter list and invoke the desired service. * 00037000
*              Full checking for required macro keys is done along    * 00037100
*              with supplying defaults for omitted optional           * 00037200
*              parameters.                                            * 00037300
*                                                                     * 00037400
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00037500
*              specifies the list form of the macro.  The "L" form    * 00037600
*              defines an area to be used for the parameter list.     * 00037700
*              Only the PLISTVER key may be specified on the          * 00037800
*              invocation.  All other macro parameters are flagged as * 00037900
*              errors.  If PLISTVER is not specified, the original    * 00038000
*              parameter list definition is used.                     * 00038100
*                                                                     * 00038200
*            ,xmfctrl                                                 * 00038300
*              is a required input.  It is the name of a storage area * 00038400
*              for the parameter list.                                * 00038500
*                                                                     * 00038600
*            ,xmfattr|0D                                            * 00038700
*              is an optional 60 character input string that varies   * 00038800
*              from 1 to 60 characters. It can contain any value that * 00038900
*              is valid on an assembler DS pseudo-op. You can use     * 00039000
*              this parameter to force boundary alignment of the      * 00039100
*              parameter list.                                        * 00039200
*              DEFAULT: 0D which forces the parameter list to a       * 00039300
*              doubleword boundary.                                   * 00039400
*                                                                     * 00039500
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00039600
*              specifies the execute form of the macro.  The "E" form * 00039700
*              generates code to put the parameters into the          * 00039800
*              parameter list specified by xmfctrl and provides full  * 00039900
*              syntax checking with default setting.                  * 00040000
*                                                                     * 00040100
*            ,xmfctrl                                                 * 00040200
*              is a required input.  It is the name (RS-type), or     * 00040300
*              address in register (1)-(12), of a storage area for    * 00040400
*              the parameter list.                                    * 00040500
*                                                                     * 00040600
*            ,COMPLETE                                              * 00040700
*              is an optional keyword input which specifies the       * 00040800
*              degree of macro parameter syntax checking.             * 00040900
*              DEFAULT: COMPLETE                                      * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*              COMPLETE                                               * 00041300
*                  Checking for required macro keys is done and       * 00041400
*                  defaults are supplied for omitted optional         * 00041500
*                  parameters.                                        * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*01* RETURN CODES:                                                    * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                 Return code and Reason code constants are defined   * 00042700
*                 within IXZYTSRC.                                    * 00042800
*                                                                     * 00042900
*       00        Name: TSRC_RC_Successful                            * 00043000
*                                                                     * 00043100
*                 Meaning: Processing successful.                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                 HEX REASON  NAME/MEANING                            * 00043600
*                 CODE                                                * 00043700
*                                                                     * 00043800
*                 00          Name: TSRC_RSN_Successful               * 00043900
*                                                                     * 00044000
*                             Meaning: Processing completed           * 00044100
*                             successfully.                           * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*                 04          Name: TSRC_RSN_Output_Not_Returned      * 00044500
*                                                                     * 00044600
*                             Meaning:  Processing completed          * 00044700
*                             successfully.  However, the module      * 00044800
*                             produced output on one or more systems  * 00044900
*                             but the output could not be passed back * 00045000
*                             because OUTDATA= was not specified.     * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*       04        Name: TSRC_RC_Unsuccessful                          * 00045600
*                                                                     * 00045700
*                 Meaning: Processing unsuccessful.                   * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*                 HEX REASON  NAME/MEANING                            * 00046200
*                 CODE                                                * 00046300
*                                                                     * 00046400
*                 04          Name: TSRC_RSN_Userid_Not_Found         * 00046500
*                                                                     * 00046600
*                             Meaning:  The userid specified by       * 00046700
*                             USERID= was not found.                  * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*                 08          Name: TSRC_RSN_Duplicate_Users          * 00047100
*                                                                     * 00047200
*                             Meaning:  Duplicate users were found.   * 00047300
*                                                                     * 00047400
*                                                                     * 00047500
*                 0C          Name: TSRC_RSN_Input_Length_Too_Large   * 00047600
*                                                                     * 00047700
*                             Meaning:  Input data length exceeded    * 00047800
*                             the maximum.                            * 00047900
*                                                                     * 00048000
*                                                                     * 00048100
*                 10          Name: TSRC_RSN_Output_Length_Too_Large  * 00048200
*                                                                     * 00048300
*                             Meaning:  Output data length returned   * 00048400
*                             by the exit(s) exceeded the maximum. No * 00048500
*                             output data is returned in OUTDATA.     * 00048600
*                                                                     * 00048700
*                                                                     * 00048800
*                 14          Name: TSRC_RSN_Exits_Not_All_Successful * 00048900
*                                                                     * 00049000
*                             Meaning:  Not all IXZXTSOI exit         * 00049100
*                             routines ran successfully.              * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*                 18          Name: TSRC_RSN_Exit_Not_Successful      * 00049500
*                                                                     * 00049600
*                             Meaning:  The single IXZXTSOI exit      * 00049700
*                             routine on the target processor did not * 00049800
*                             run successfully.                       * 00049900
*                                                                     * 00050000
*                                                                     * 00050100
*                 1C          Name: TSRC_RSN_Storage_Unavailable      * 00050200
*                                                                     * 00050300
*                             Meaning:  Unable to obtain the required * 00050400
*                             storage to return information provided  * 00050500
*                             by the IXZXTSOI exit routines to the    * 00050600
*                             caller.                                 * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*                 20          Name: TSRC_RSN_System_Not_Found         * 00051000
*                                                                     * 00051100
*                             Meaning:  The system specified by       * 00051200
*                             SYSTEM= was not found, or is            * 00051300
*                             down-level.                             * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*                 24          Name: TSRC_RSN_Internal_Error           * 00051700
*                                                                     * 00051800
*                             Meaning:  An internal error occurred.   * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*                 28          Name: TSRC_RSN_JESXCF_Not_Initialized   * 00052200
*                                                                     * 00052300
*                             Meaning:  JESXCF is not initialized.    * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*                 2C          Name: TSRC_RSN_System_Not_Active        * 00052700
*                                                                     * 00052800
*                             Meaning:  The system name specified by  * 00052900
*                             SYSTEM= was valid but not active.       * 00053000
*                                                                     * 00053100
*                                                                     * 00053200
*                 30          Name:                                   * 00053300
*                             TSRC_RSN_Service_Not_Supported_By_JES   * 00053400
*                                                                     * 00053500
*                             Meaning:  The current version of the    * 00053600
*                             Job Entry Subsystem does not support    * 00053700
*                             this service.                           * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*                 34          Name: TSRC_RSN_Service_Not_Available    * 00054100
*                                                                     * 00054200
*                             Meaning:  The service is not available  * 00054300
*                             right now.                              * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*                 38          Name:                                   * 00054700
*                             TSRC_RSN_No_Active_System_In_Group      * 00054800
*                                                                     * 00054900
*                             Meaning:  The group is valid but no     * 00055000
*                             system in the group is active.          * 00055100
*                                                                     * 00055200
*                                                                     * 00055300
*                 40          Name: TSRC_RSN_Incorrect_Eyecatcher     * 00055400
*                                                                     * 00055500
*                             Meaning:  The eyecatcher in the         * 00055600
*                             IXZXTSOI parameter list was not         * 00055700
*                             correct.                                * 00055800
*                                                                     * 00055900
*                                                                     * 00056000
*                 44          Name: TSRC_RSN_Incorrect_Version        * 00056100
*                                                                     * 00056200
*                             Meaning:  The version number in the     * 00056300
*                             IXZXTSOI parameter list was not         * 00056400
*                             correct.                                * 00056500
*                                                                     * 00056600
*                                                                     * 00056700
*                                                                     * 00056800
*                                                                     * 00056900
*       08        Name: TSRC_RC_System_Error                          * 00057000
*                                                                     * 00057100
*                 Meaning: A system error occurred.                   * 00057200
*                                                                     * 00057300
*                                                                     * 00057400
*       0C        Name: TSRC_RC_System_Abend                          * 00057500
*                                                                     * 00057600
*                 Meaning: A system abend occurred.                   * 00057700
*                                                                     * 00057800
*                                                                     * 00057900
*                                                                     * 00058000
*                                                                     * 00058100
*01* REASON CODES:                                                    * 00058200
*                                                                     * 00058300
*       A unique reason code will be returned for any given return    * 00058400
*       code.  Reason code and return code constants are defined      * 00058500
*       within IXZYTSRC.  See the Return Codes section (above) for a  * 00058600
*       complete description of the reason codes.                     * 00058700
*                                                                     * 00058800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00058900
*                                                                     * 00059000
*02*   PROCESSOR:  ASSEM                                              * 00059100
*                                                                     * 00059200
*01* COMPONENT:  SCJSC                                                * 00059300
*                                                                     * 00059400
*01* MACRO USAGE NOTES:                                               * 00059500
*                                                                     * 00059600
*                                                                     * 00059700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00059800
*        global macro variable.  Any value other than 'NO' will       * 00059900
*        result in the macro expansion being printed.  The default is * 00060000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00060100
*        variable should be set.                                      * 00060200
*                                                                     * 00060300
*                    GBLC &ZPRINT                                     * 00060400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00060500
*                                                                     * 00060600
*                                                                     * 00060700
*    2.  All   keys   currently   contained  in  the  IXZXTSOI  macro * 00060800
*        correspond  to  version  1.   If you specify PLISTVER, use a * 00060900
*        value of 1 or MAX.                                           * 00061000
*                                                                     * 00061100
*                                                                     * 00061200
*                                                                     * 00061300
*                                                                     * 00061400
*01* CHANGE ACTIVITY:                                                 * 00061500
*                                                                     * 00061600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00061700
*                                                                     * 00061800
*    $R0=TSOGR    HBB6603 960126 PD0RF: TSOGR Support                 * 00061900
****** END OF SPECIFICATIONS *****************************************/ 00062000
*/********************************************************************* 00062100
         MACRO                                                          00062200
&XLABEL  IXZXTSOI &USERID=,&SYSTEM=,&INDATA=,&INDATALEN=,&INDATAKEY=,  *00062300
               &OUTDATA=,&OUTDATALEN=,&OUTDATAKEY=,&RTNCODE=,&RSNCODE=,*00062400
               &PLISTVER=,&MF=                                          00062500
.*                                                                      00062600
*                MACDATE -96/01/26-<1>                                  00062700
.*                                                                      00062800
.*******************************************************************    00062900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00063000
.*******************************************************************    00063100
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00063200
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00063300
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00063400
.*                                                                      00063500
                GBLC  &ZIXZXTSOI  YES=MACRO USED AT LEAST ONCE          00063600
.*******************************************************************    00063700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00063800
.*******************************************************************    00063900
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00064000
                LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS          00064100
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00064200
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00064300
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00064400
                LCLA  &ZAWRK      USED AS A WORK AREA                   00064500
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00064600
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00064700
                LCLC  &ZC         CHARACTER WORK VARIABLE               00064800
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00064900
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00065000
                LCLA  &ZMACRET    MACRO RETURN CODE                     00065100
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00065200
.*                                                                      00065300
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00065400
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00065500
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00065600
                LCLC  &ZENDBASEPL               End of base PL          00065700
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00065800
.*******************************************************************    00065900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00066000
.*******************************************************************    00066100
                LCLA  &ZI         INDEX FOR ARRAY                       00066200
                LCLA  &ZJ         INDEX FOR PARMS                       00066300
                LCLA  &ZK         INDEX FOR PARSE                       00066400
                LCLA  &ZLO        LOW RANGE VALUE                       00066500
                LCLA  &ZHI        HIGH RANGE VALUE                      00066600
                LCLC  &ZW         WORK AREA FOR PARM                    00066700
.********************************************************************   00066800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00066900
.********************************************************************   00067000
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00067100
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00067200
.*                                                                      00067300
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00067400
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00067500
                SPLEVEL  TEST                                           00067600
.ZSYS2          ANOP  ,                                                 00067700
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00067800
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00067900
                SYSSTATE TEST                                           00068000
                AGO   .ZSYS4                                            00068100
.ZSYS3          ANOP  ,                                                 00068200
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00068300
.ZSYS4          ANOP  ,                                                 00068400
.*******************************************************************    00068500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00068600
.*******************************************************************    00068700
                LCLC  &XREQTYPE   ++ NAME                               00068800
                LCLC  &XUSERID    ++ NAME                               00068900
                LCLC  &XSYSTEM    ++ NAME                               00069000
                LCLC  &XINDATA    ++ NAME                               00069100
                LCLC  &XINDATALEN               ++ NAME                 00069200
                LCLC  &XINDATAKEY               ++ NAME                 00069300
                LCLC  &XOUTDATA   ++ NAME                               00069400
                LCLC  &XOUTDATALEN              ++ NAME                 00069500
                LCLC  &XOUTDATAKEY              ++ NAME                 00069600
                LCLC  &XRTNCODE   ++ NAME                               00069700
                LCLC  &XRSNCODE   ++ NAME                               00069800
                LCLA  &XPLISTVER  ++ VALUE                              00069900
                LCLC  &XMF        ++ VALUE                              00070000
                LCLC  &XMFCTRL    ++ NAME                               00070100
                LCLC  &XMFATTR    ++ VALUE                              00070200
                LCLC  &XMFSCK     ++ VALUE                              00070300
.*******************************************************************    00070400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00070500
.*******************************************************************    00070600
                LCLC  &ZXREQTYPE  ++ INPUT NAME                         00070700
                LCLC  &ZXUSERID   ++ INPUT NAME                         00070800
                LCLC  &ZXSYSTEM   ++ INPUT NAME                         00070900
                LCLC  &ZXINDATA   ++ INPUT NAME                         00071000
                LCLC  &ZXINDATALEN              ++ INPUT NAME           00071100
                LCLC  &ZXINDATAKEY              ++ INPUT NAME           00071200
                LCLC  &ZXOUTDATA  ++ OUTPUT NAME                        00071300
                LCLC  &ZXOUTDATALEN             ++ OUTPUT NAME          00071400
                LCLC  &ZXOUTDATAKEY             ++ INPUT NAME           00071500
                LCLC  &ZXRTNCODE  ++ OUTPUT NAME                        00071600
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00071700
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00071800
                LCLC  &ZXMF       ++ INPUT VALUE                        00071900
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00072000
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00072100
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00072200
.********************************************************************   00072300
.***AC.PLV01  PROCESS PLISTVER                                      *   00072400
.********************************************************************   00072500
&XPLISTVER      SETA  1                                                 00072600
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00072700
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00072800
&XPLISTVER      SETA  1                                                 00072900
.ZPLV0          ANOP  ,                                                 00073000
.*                                                                      00073100
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00073200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00073300
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00073400
.*-------------------------------------------------------------------   00073500
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00073600
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00073700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00073800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00073900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00074000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00074100
                AGO   .ZPVCK2                                           00074200
.ZPVCK3         ANOP  ,                                                 00074300
.*-------------------------------------------------------------------   00074400
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00074500
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00074600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00074700
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00074800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00074900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00075000
                AGO   .ZPVCKE                                           00075100
.ZPVCK2         ANOP  ,                                                 00075200
.*-------------------------------------------------------------------   00075300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00075400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00075500
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00075600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00075700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00075800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00075900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00076000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00076100
                AGO   .ZPVCK5                                           00076200
.ZPVCK4         ANOP  ,                                                 00076300
&XPLISTVER      SETA  &PLISTVER(1)                                      00076400
.ZPVCK5         ANOP  ,                                                 00076500
.*-------------------------------------------------------------------   00076600
&ZCVAL          SETC  '&PLISTVER(1)'                                    00076700
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00076800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00076900
                AIF   (&XPLISTVER LT 1).ZPVCK6  TOO LOW                 00077000
                AIF   (&XPLISTVER LE 1).ZPVCKE  NOT HIGH                00077100
.ZPVCK6         ANOP   ,                                                00077200
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00077300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00077400
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00077500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00077600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00077700
.ZPVCKE         ANOP   ,                                                00077800
.********************************************************************   00077900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00078000
.********************************************************************   00078100
                ACTR  10000                                             00078200
.*------------------------------------------------------------------    00078300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00078400
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00078500
.*-------------------------------------------------------------------   00078600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00078700
.ZG34           ANOP  ,                                                 00078800
&ZTLC           SETC 'S'                                                00078900
                AIF   ('&MF(1)' NE '&ZTLC').ZG35                        00079000
&XMF            SETC  'S'         SET KEYWORD                           00079100
                AIF   (N'&MF LE 1).ZG34A        CK NUM                  00079200
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00079300
&ZMS            SETC  '&ZMS.&MF"'                                       00079400
&ZMS            SETC  '&ZMS "MF"'                                       00079500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00079600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00079700
.ZG34A          ANOP  ,                                                 00079800
.*-------------------------------------------------------------------   00079900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00080000
.ZG35           ANOP  ,                                                 00080100
&ZTLC           SETC 'L'                                                00080200
                AIF   ('&MF(1)' NE '&ZTLC').ZG42                        00080300
&XMF            SETC  'L'         SET KEYWORD                           00080400
                AIF   (N'&MF LE 3).ZG35A        CK NUM                  00080500
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00080600
&ZMS            SETC  '&ZMS.&MF"'                                       00080700
&ZMS            SETC  '&ZMS "MF"'                                       00080800
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00080900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00081000
.ZG35A          ANOP  ,                                                 00081100
.*-------------------------------------------------------------------   00081200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00081300
                AIF   (N'&SYSLIST NE 0).ZG35B   POSITIONALS?            00081400
                AIF   ('&USERID' NE '').ZG35B   KEYS?                   00081500
                AIF   ('&SYSTEM' NE '').ZG35B   KEYS?                   00081600
                AIF   ('&INDATA' NE '').ZG35B   KEYS?                   00081700
                AIF   ('&INDATALEN' NE '').ZG35B  KEYS?                 00081800
                AIF   ('&INDATAKEY' NE '').ZG35B  KEYS?                 00081900
                AIF   ('&OUTDATA' NE '').ZG35B  KEYS?                   00082000
                AIF   ('&OUTDATALEN' NE '').ZG35B  KEYS?                00082100
                AIF   ('&OUTDATAKEY' NE '').ZG35B  KEYS?                00082200
                AIF   ('&RTNCODE' NE '').ZG35B  KEYS?                   00082300
                AIF   ('&RSNCODE' NE '').ZG35B  KEYS?                   00082400
                AGO    .ZG35C     INVOCATION OKAY                       00082500
.ZG35B          ANOP  ,                                                 00082600
&ZMS            SETC  'THE "L" FORM OF "MF"'    *MFLA* MNOTE            00082700
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00082800
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00082900
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00083000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00083100
.ZG35C          ANOP  ,                                                 00083200
.*-------------------------------------------------------------------   00083300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00083400
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00083500
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00083600
                AIF   (N'&MF(2) GT 1).ZG37B     MULTI PARMS             00083700
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00083800
.ZG37B          AIF   (K'&MF(2) GT 0).ZG37C                             00083900
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00084000
&ZMS            SETC  'WHEN "L" IS SPECIFIED'   *KRQDA*                 00084100
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00084200
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00084300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00084400
.ZG37C          ANOP  ,                                                 00084500
.*-------------------------------------------------------------------   00084600
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00084700
                AIF   (K'&ZXMFCTRL LE 0).ZG37P  NOT I/O                 00084800
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG37P                    00084900
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00085000
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00085100
&ZMS            SETC  '&ZMS.&MF"'                                       00085200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00085300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00085400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00085500
.ZG37P          ANOP  ,                                                 00085600
.*-------------------------------------------------------------------   00085700
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00085800
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00085900
&XMFATTR        SETC  '0D'                                              00086000
                AIF   (K'&MF(3) LE 0).ZG40B     PARM                    00086100
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00086200
                AIF   (N'&MF(3) GT 1).ZG40B     MULTI PARMS             00086300
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00086400
.ZG40B          ANOP  ,                                                 00086500
.*-------------------------------------------------------------------   00086600
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00086700
                AIF   (K'&ZXMFATTR LE 0).ZG40P  NOT I/O                 00086800
                AIF   ('&XMFATTR'(1,1) NE '(').ZG40P                    00086900
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00087000
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00087100
&ZMS            SETC  '&ZMS.&MF"'                                       00087200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00087300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00087400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00087500
.ZG40P          ANOP  ,                                                 00087600
.*-------------------------------------------------------------------   00087700
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00087800
                AIF   (K'&ZXMFATTR LE 0).ZG40S  NOT I/O                 00087900
                AIF   (K'&XMFATTR LE 60).ZG40S  LNG OK                  00088000
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00088100
&ZMS            SETC  '"MF='      *KLNGA* MNOTE                         00088200
&ZMS            SETC  '&ZMS.&MF"'                                       00088300
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00088400
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00088500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00088600
.ZG40S          ANOP  ,                                                 00088700
.*-------------------------------------------------------------------   00088800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00088900
.ZG42           ANOP  ,                                                 00089000
&ZTLC           SETC 'E'                                                00089100
                AIF   ('&MF(1)' NE '&ZTLC').ZG50                        00089200
&XMF            SETC  'E'         SET KEYWORD                           00089300
                AIF   (N'&MF LE 3).ZG42A        CK NUM                  00089400
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00089500
&ZMS            SETC  '&ZMS.&MF"'                                       00089600
&ZMS            SETC  '&ZMS "MF"'                                       00089700
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00089800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00089900
.ZG42A          ANOP  ,                                                 00090000
.*-------------------------------------------------------------------   00090100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00090200
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00090300
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00090400
                AIF   (N'&MF(2) GT 1).ZG44B     MULTI PARMS             00090500
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00090600
.ZG44B          AIF   (K'&MF(2) GT 0).ZG44C                             00090700
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00090800
&ZMS            SETC  'WHEN "E" IS SPECIFIED'   *KRQDA*                 00090900
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00091000
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00091100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00091200
.ZG44C          ANOP  ,                                                 00091300
.*-------------------------------------------------------------------   00091400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00091500
                AIF   (K'&ZXMFCTRL LE 0).ZG44R  NOT I/O                 00091600
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG44R                    00091700
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00091800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                      00091900
                AIF   (K'&ZCGPR GT 2).ZG44Q                             00092000
                AIF   ('&ZCGPR' EQ '0').ZG44Q                           00092100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00092200
                AIF   (T'&ZCGPR NE 'N').ZG44Q   INVALID REG NAME        00092300
.ZG44P          ANOP  ,                                                 00092400
                AIF   (T'&ZCGPR NE 'N').ZG44R   NON NUMERIC             00092500
                AIF   ('&ZCGPR' LT '1').ZG44Q                           00092600
                AIF   ('&ZCGPR' LE '12').ZG44R                          00092700
.ZG44Q          ANOP  ,                                                 00092800
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00092900
&ZMS            SETC  '&ZMS.&MF"'                                       00093000
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00093100
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00093200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00093300
.ZG44R          ANOP  ,                                                 00093400
.*-------------------------------------------------------------------   00093500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00093600
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00093700
.ZG48A   AIF   ('&MF(3)' NE 'COMPLETE').ZG49A                           00093800
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00093900
.*-------------------------------------------------------------------   00094000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00094100
.ZG49A          AIF   (K'&XMFSCK GT 0).ZG49C    KEYWORD                 00094200
                AIF   (K'&MF(3) LE 0).ZG49B                             00094300
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00094400
&ZMS            SETC  '&ZMS.&MF"'                                       00094500
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00094600
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00094700
&ZMS            SETC  '&ZMS "COMPLETE".'        VALID KEYWORD           00094800
                MNOTE 8,' &ZMS '                                        00094900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00095000
.ZG49B          ANOP  ,                                                 00095100
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00095200
.ZG49C          ANOP  ,                                                 00095300
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00095400
.*------------------------------------------------------------------    00095500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095600
.ZG50           ANOP  ,                                                 00095700
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00095800
                AIF   (K'&XMF GT 0).ZG50E       VALID ARG               00095900
                AIF   (T'&MF EQ 'O').ZG50D      OMITTED                 00096000
&ZASYSLNDX      SETA  0                                                 00096100
.ZG50A          ANOP  ,           POSITIONAL MACRO KEY                  00096200
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00096300
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG50C                  00096400
&ZTLC           SETC 'MF'                                               00096500
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG50A         00096600
.ZG50B          ANOP  ,                                                 00096700
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00096800
&ZMS            SETC  'THE "MF" KEY'            *KOPTA* MNOTE           00096900
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00097000
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00097100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00097200
                AGO   .ZG50E                                            00097300
.ZG50C          ANOP  ,                                                 00097400
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00097500
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00097600
&ZMS            SETC  '&ZMS.&MF"'                                       00097700
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00097800
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00097900
&ZMS            SETC  '&ZMS "S",'               VALID KEYWORD           00098000
&ZMS            SETC  '&ZMS "L",'               VALID KEYWORD           00098100
&ZMS            SETC  '&ZMS OR "E".'            VALID KEYWORD           00098200
                MNOTE 8,' &ZMS '                                        00098300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00098400
                AGO   .ZG50E                                            00098500
.ZG50D          ANOP  ,                                                 00098600
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00098700
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00098800
.ZG50E          ANOP  ,                                                 00098900
.********************************************************************   00099000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00099100
.********************************************************************   00099200
                ACTR  10000                                             00099300
.*-------------------------------------------------------------------   00099400
.***AG.MF03 MF=(SLE)                                                    00099500
                AIF   ('&XMF' EQ 'L').ZGMFX                             00099600
.*----------------------------------------------------------------***   00099700
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00099800
&XREQTYPE       SETC  ''          INITIALIZE XVARIABLE                  00099900
                AIF   (K'&USERID LE 0).ZG2C                             00100000
&ZXREQTYPE      SETC  'INPUT'     SET IN/OUTPUT                         00100100
&XREQTYPE       SETC  'USERID'    SET XVARIABLE                         00100200
&ZXUSERID       SETC  'INPUT'     SET IN/OUTPUT                         00100300
&XUSERID        SETC  '&USERID(1)'              SET XVARIABLE PARM      00100400
                AIF   (N'&USERID GT 1).ZG2A     MULTIPLE PARMS          00100500
&XUSERID        SETC  '&USERID'   SET XVARIABLE PARM                    00100600
.ZG2A           AIF   (N'&USERID LE 1).ZG2B     CK NUM                  00100700
&ZMS            SETC  '"USERID='  *KPOSA* MNOTE                         00100800
&ZMS            SETC  '&ZMS.&USERID"'                                   00100900
&ZMS            SETC  '&ZMS "USERID"'                                   00101000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00101100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00101200
.ZG2B           AIF   (K'&XUSERID GT 0).ZG2C    ONE PARM                00101300
&ZXREQTYPE      SETC  ''          RESET IN/OUTPUT                       00101400
&ZXUSERID       SETC  ''          RESET IN/OUTPUT                       00101500
&ZMS            SETC  ' '         *KRQDA*                               00101600
&ZMS            SETC  '&ZMS "USERID" KEY AND ITS ARGUMENT'              00101700
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00101800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00101900
.ZG2C           ANOP  ,                                                 00102000
.*----------------------------------------------------------------***   00102100
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00102200
                AIF   (K'&SYSTEM LE 0).ZG3D     NO ME KEY               00102300
                AIF   (N'&SYSTEM LE 1).ZG3A     CK NUM                  00102400
&ZMS            SETC  '"SYSTEM='  *KPOSA* MNOTE                         00102500
&ZMS            SETC  '&ZMS.&SYSTEM"'                                   00102600
&ZMS            SETC  '&ZMS "SYSTEM"'                                   00102700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00102800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00102900
.ZG3A           AIF   (K'&XREQTYPE LE 0).ZG3B                           00103000
&ZMS            SETC  '"SYSTEM'   *KMEKA* MNOTE                         00103100
&ZMS            SETC  '&ZMS.=&SYSTEM"'                                  00103200
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00103300
&ZMS            SETC  '&ZMS "&XREQTYPE"'                                00103400
                MNOTE 8,' &ZMS KEY.'                                    00103500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00103600
                AGO   .ZG3D                                             00103700
.*                                                                      00103800
.ZG3B           ANOP  ,                                                 00103900
&ZXREQTYPE      SETC  'INPUT'     SET IN/OUTPUT                         00104000
&XREQTYPE       SETC  'SYSTEM'    SET XVARIABLE                         00104100
&ZXSYSTEM       SETC  'INPUT'     SET IN/OUTPUT                         00104200
&XSYSTEM        SETC  '&SYSTEM(1)'              SET XVARIABLE PARM      00104300
                AIF   (N'&SYSTEM GT 1).ZG3C     MULTIPLE PARMS          00104400
&XSYSTEM        SETC  '&SYSTEM'   SET XVARIABLE PARM                    00104500
.ZG3C           AIF   (K'&XSYSTEM GT 0).ZG3D    ONE PARM                00104600
&ZXREQTYPE      SETC  ''          RESET IN/OUTPUT                       00104700
&ZXSYSTEM       SETC  ''          RESET IN/OUTPUT                       00104800
&ZMS            SETC  ' '         *KRQDA*                               00104900
&ZMS            SETC  '&ZMS "SYSTEM" KEY AND ITS ARGUMENT'              00105000
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00105100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00105200
.ZG3D           ANOP  ,                                                 00105300
.*------------------------------------------------------------------    00105400
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00105500
                AIF   (K'&XREQTYPE GT 0).ZG4B                           00105600
&ZXREQTYPE      SETC  ''          RESET IN/OUTPUT                       00105700
&ZXUSERID       SETC  ''          RESET IN/OUTPUT                       00105800
&XREQTYPE       SETC  ''          ENSURE NULL                           00105900
&XUSERID        SETC  ''          ENSURE NULL                           00106000
&ZMS            SETC  'ONE OF THE FOLLOWING'    *KMERA* MNOTE           00106100
&ZMS            SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'               00106200
&ZMS            SETC  '&ZMS REQUIRED:'                                  00106300
&ZMS            SETC  '&ZMS "USERID"'           VALID ME KEY            00106400
&ZMS            SETC  '&ZMS OR "SYSTEM".'       VALID ME KEY            00106500
                MNOTE 8,' &ZMS '                                        00106600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00106700
.ZG4B           ANOP  ,                                                 00106800
.*-------------------------------------------------------------------   00106900
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00107000
.ZG2            AIF   ('&XREQTYPE' NE 'USERID').ZG3                     00107100
.*-------------------------------------------------------------------   00107200
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00107300
                AIF   (K'&ZXUSERID LE 0).ZG2R   NOT I/O                 00107400
                AIF   ('&XUSERID'(1,1) NE '(').ZG2R                     00107500
&ZCGPR          SETC  '&XUSERID'(2,K'&XUSERID-2)                        00107600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                       00107700
                AIF   (K'&ZCGPR GT 2).ZG2Q                              00107800
                AIF   ('&ZCGPR' EQ '0').ZG2Q                            00107900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00108000
                AIF   (T'&ZCGPR NE 'N').ZG2Q    INVALID REG NAME        00108100
.ZG2P           ANOP  ,                                                 00108200
                AIF   (T'&ZCGPR NE 'N').ZG2R    NON NUMERIC             00108300
                AIF   ('&ZCGPR' LT '2').ZG2Q                            00108400
                AIF   ('&ZCGPR' LE '12').ZG2R                           00108500
.ZG2Q           ANOP  ,                                                 00108600
&ZMS            SETC  '"USERID='  *KGPRA* MNOTE                         00108700
&ZMS            SETC  '&ZMS.&USERID"'                                   00108800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00108900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00109000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00109100
.ZG2R           ANOP  ,                                                 00109200
.*-------------------------------------------------------------------   00109300
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00109400
.ZG3            AIF   ('&XREQTYPE' NE 'SYSTEM').ZG4                     00109500
.*-------------------------------------------------------------------   00109600
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00109700
                AIF   (K'&ZXSYSTEM LE 0).ZG3R   NOT I/O                 00109800
                AIF   ('&XSYSTEM'(1,1) NE '(').ZG3R                     00109900
&ZCGPR          SETC  '&XSYSTEM'(2,K'&XSYSTEM-2)                        00110000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                       00110100
                AIF   (K'&ZCGPR GT 2).ZG3Q                              00110200
                AIF   ('&ZCGPR' EQ '0').ZG3Q                            00110300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00110400
                AIF   (T'&ZCGPR NE 'N').ZG3Q    INVALID REG NAME        00110500
.ZG3P           ANOP  ,                                                 00110600
                AIF   (T'&ZCGPR NE 'N').ZG3R    NON NUMERIC             00110700
                AIF   ('&ZCGPR' LT '2').ZG3Q                            00110800
                AIF   ('&ZCGPR' LE '12').ZG3R                           00110900
.ZG3Q           ANOP  ,                                                 00111000
&ZMS            SETC  '"SYSTEM='  *KGPRA* MNOTE                         00111100
&ZMS            SETC  '&ZMS.&SYSTEM"'                                   00111200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00111300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00111400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00111500
.ZG3R           ANOP  ,                                                 00111600
.*-------------------------------------------------------------------   00111700
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00111800
.ZG4            ANOP  ,           END MUTUALLY EXCLUSIVE KEYS           00111900
.*----------------------------------------------------------------***   00112000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00112100
                AIF   (N'&INDATA LE 1).ZG6A     CK NUM                  00112200
&ZMS            SETC  '"INDATA='  *KPOSA* MNOTE                         00112300
&ZMS            SETC  '&ZMS.&INDATA"'                                   00112400
&ZMS            SETC  '&ZMS "INDATA"'                                   00112500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00112600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112700
.ZG6A           ANOP  ,                                                 00112800
.*-------------------------------------------------------------------   00112900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00113000
&ZXINDATA       SETC  'INPUT'     SET IN/OUTPUT                         00113100
&XINDATA        SETC  '0'                                               00113200
                AIF   (K'&INDATA(1) LE 0).ZG6B  PARM                    00113300
&XINDATA        SETC  '&INDATA(1)'              SET XVARIABLE           00113400
                AIF   (N'&INDATA GT 1).ZG6B     MULTI PARMS             00113500
&XINDATA        SETC  '&INDATA'   SET XVARIABLE                         00113600
.ZG6B           ANOP  ,                                                 00113700
.*-------------------------------------------------------------------   00113800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00113900
                AIF   (K'&ZXINDATA LE 0).ZG6R   NOT I/O                 00114000
                AIF   ('&XINDATA'(1,1) NE '(').ZG6R                     00114100
&ZCGPR          SETC  '&XINDATA'(2,K'&XINDATA-2)                        00114200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                       00114300
                AIF   (K'&ZCGPR GT 2).ZG6Q                              00114400
                AIF   ('&ZCGPR' EQ '0').ZG6Q                            00114500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00114600
                AIF   (T'&ZCGPR NE 'N').ZG6Q    INVALID REG NAME        00114700
.ZG6P           ANOP  ,                                                 00114800
                AIF   (T'&ZCGPR NE 'N').ZG6R    NON NUMERIC             00114900
                AIF   ('&ZCGPR' LT '2').ZG6Q                            00115000
                AIF   ('&ZCGPR' LE '12').ZG6R                           00115100
.ZG6Q           ANOP  ,                                                 00115200
&ZMS            SETC  '"INDATA='  *KGPRA* MNOTE                         00115300
&ZMS            SETC  '&ZMS.&INDATA"'                                   00115400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00115500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00115600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00115700
.ZG6R           ANOP  ,                                                 00115800
.*----------------------------------------------------------------***   00115900
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00116000
                AIF   (N'&INDATALEN LE 1).ZG8A  CK NUM                  00116100
&ZMS            SETC  '"INDATALEN='             *KPOSA* MNOTE           00116200
&ZMS            SETC  '&ZMS.&INDATALEN"'                                00116300
&ZMS            SETC  '&ZMS "INDATALEN"'                                00116400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00116500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00116600
.ZG8A           ANOP  ,                                                 00116700
.*-------------------------------------------------------------------   00116800
.***AG.KXVAR09 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00116900
&ZXINDATALEN    SETC  'INPUT'     SET IN/OUTPUT                         00117000
&XINDATALEN     SETC  '&INDATALEN(1)'           SET XVARIABLE           00117100
                AIF   (N'&INDATALEN GT 1).ZG8B  MULTI PARMS             00117200
&XINDATALEN     SETC  '&INDATALEN'              SET XVARIABLE           00117300
.ZG8B           AIF   (K'&INDATA(1) GT 0).ZG8C  KEY                     00117400
                AIF   (K'&INDATALEN(1) LE 0).ZG8D  PARM                 00117500
&ZMS            SETC  '"INDATALEN'              *KDEPA* MNOTE           00117600
&ZMS            SETC  '&ZMS.=&INDATALEN"'                               00117700
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00117800
&ZMS            SETC  '&ZMS '                                           00117900
&ZMS            SETC  '&ZMS "INDATA"'                                   00118000
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00118100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00118200
                AGO   .ZG8E                                             00118300
.*                                                                      00118400
.ZG8C           AIF   (K'&INDATALEN(1) GT 0).ZG8E  PARM                 00118500
&ZXINDATALEN    SETC  ''          RESET IN/OUTPUT                       00118600
&ZMS            SETC  ' '         *KRQDA*                               00118700
&ZMS            SETC  '&ZMS "INDATALEN" KEY AND ITS ARGUMENT'           00118800
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00118900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00119000
.ZG8D           ANOP  ,                                                 00119100
&XINDATALEN     SETC  '0'         SET DEFAULT                           00119200
.ZG8E           ANOP  ,                                                 00119300
.*-------------------------------------------------------------------   00119400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00119500
                AIF   (K'&ZXINDATALEN LE 0).ZG8R  NOT I/O               00119600
                AIF   ('&XINDATALEN'(1,1) NE '(').ZG8R                  00119700
&ZCGPR          SETC  '&XINDATALEN'(2,K'&XINDATALEN-2)                  00119800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                       00119900
                AIF   (K'&ZCGPR GT 2).ZG8Q                              00120000
                AIF   ('&ZCGPR' EQ '0').ZG8Q                            00120100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00120200
                AIF   (T'&ZCGPR NE 'N').ZG8Q    INVALID REG NAME        00120300
.ZG8P           ANOP  ,                                                 00120400
                AIF   (T'&ZCGPR NE 'N').ZG8R    NON NUMERIC             00120500
                AIF   ('&ZCGPR' LT '2').ZG8Q                            00120600
                AIF   ('&ZCGPR' LE '12').ZG8R                           00120700
.ZG8Q           ANOP  ,                                                 00120800
&ZMS            SETC  '"INDATALEN='             *KGPRA* MNOTE           00120900
&ZMS            SETC  '&ZMS.&INDATALEN"'                                00121000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00121100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00121200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00121300
.ZG8R           ANOP  ,                                                 00121400
.*----------------------------------------------------------------***   00121500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00121600
                AIF   (N'&INDATAKEY LE 1).ZG11A  CK NUM                 00121700
&ZMS            SETC  '"INDATAKEY='             *KPOSA* MNOTE           00121800
&ZMS            SETC  '&ZMS.&INDATAKEY"'                                00121900
&ZMS            SETC  '&ZMS "INDATAKEY"'                                00122000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00122100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00122200
.ZG11A          ANOP  ,                                                 00122300
.*-------------------------------------------------------------------   00122400
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00122500
&XINDATAKEY     SETC  'CALLER_KEY'              SET DEFAULT             00122600
                AIF   (K'&INDATAKEY(1) LE 0).ZG11C  PARM                00122700
&XINDATAKEY     SETC  '&INDATAKEY(1)'           SET XVARIABLE           00122800
                AIF   (N'&INDATAKEY GT 1).ZG11B  MULTI PARMS            00122900
&XINDATAKEY     SETC  '&INDATAKEY'              SET XVARIABLE           00123000
.ZG11B          AIF   (K'&INDATA(1) GT 0).ZG11C  KEY                    00123100
&ZMS            SETC  '"INDATAKEY'              *KDEPA* MNOTE           00123200
&ZMS            SETC  '&ZMS.=&INDATAKEY"'                               00123300
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00123400
&ZMS            SETC  '&ZMS '                                           00123500
&ZMS            SETC  '&ZMS "INDATA"'                                   00123600
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00123700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00123800
.ZG11C          ANOP  ,                                                 00123900
&ZXINDATAKEY    SETC  'INPUT'     SET IN/OUTPUT                         00124000
.*-------------------------------------------------------------------   00124100
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00124200
                AIF   (K'&ZXINDATAKEY LE 0).ZG11R  NOT I/O              00124300
                AIF   ('&XINDATAKEY' EQ 'CALLER_KEY').ZG11R             00124400
                AIF   ('&XINDATAKEY'(1,1) NE '(').ZG11R                 00124500
&ZCGPR          SETC  '&XINDATAKEY'(2,K'&XINDATAKEY-2)                  00124600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                      00124700
                AIF   (K'&ZCGPR GT 2).ZG11Q                             00124800
                AIF   ('&ZCGPR' EQ '0').ZG11Q                           00124900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00125000
                AIF   (T'&ZCGPR NE 'N').ZG11Q   INVALID REG NAME        00125100
.ZG11P          ANOP  ,                                                 00125200
                AIF   (T'&ZCGPR NE 'N').ZG11R   NON NUMERIC             00125300
                AIF   ('&ZCGPR' LT '2').ZG11Q                           00125400
                AIF   ('&ZCGPR' LE '12').ZG11R                          00125500
.ZG11Q          ANOP  ,                                                 00125600
&ZMS            SETC  '"INDATAKEY='             *KGPRA* MNOTE           00125700
&ZMS            SETC  '&ZMS.&INDATAKEY"'                                00125800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00125900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00126000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00126100
.ZG11R          ANOP  ,                                                 00126200
.*----------------------------------------------------------------***   00126300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00126400
                AIF   (N'&OUTDATA LE 1).ZG15A   CK NUM                  00126500
&ZMS            SETC  '"OUTDATA='               *KPOSA* MNOTE           00126600
&ZMS            SETC  '&ZMS.&OUTDATA"'                                  00126700
&ZMS            SETC  '&ZMS "OUTDATA"'                                  00126800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00126900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00127000
.ZG15A          ANOP  ,                                                 00127100
.*-------------------------------------------------------------------   00127200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00127300
                AIF   (K'&OUTDATA(1) LE 0).ZG15C  NO PARM               00127400
&ZXOUTDATA      SETC  'OUTPUT'    SET OUTPUT                            00127500
&XOUTDATA       SETC  '&OUTDATA(1)'             SET XVARIABLE           00127600
                AIF   (N'&OUTDATA GT 1).ZG15C                           00127700
&XOUTDATA       SETC  '&OUTDATA'  SET XVARIABLE                         00127800
.ZG15C          ANOP  ,                                                 00127900
.*-------------------------------------------------------------------   00128000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00128100
                AIF   (K'&ZXOUTDATA LE 0).ZG15R  NOT I/O                00128200
                AIF   ('&XOUTDATA'(1,1) NE '(').ZG15R                   00128300
&ZCGPR          SETC  '&XOUTDATA'(2,K'&XOUTDATA-2)                      00128400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                      00128500
                AIF   (K'&ZCGPR GT 2).ZG15Q                             00128600
                AIF   ('&ZCGPR' EQ '0').ZG15Q                           00128700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00128800
                AIF   (T'&ZCGPR NE 'N').ZG15Q   INVALID REG NAME        00128900
.ZG15P          ANOP  ,                                                 00129000
                AIF   (T'&ZCGPR NE 'N').ZG15R   NON NUMERIC             00129100
                AIF   ('&ZCGPR' LT '2').ZG15Q                           00129200
                AIF   ('&ZCGPR' LE '12').ZG15R                          00129300
.ZG15Q          ANOP  ,                                                 00129400
&ZMS            SETC  '"OUTDATA='               *KGPRA* MNOTE           00129500
&ZMS            SETC  '&ZMS.&OUTDATA"'                                  00129600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00129700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00129800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00129900
.ZG15R          ANOP  ,                                                 00130000
.*----------------------------------------------------------------***   00130100
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00130200
                AIF   (N'&OUTDATALEN LE 1).ZG17A  CK NUM                00130300
&ZMS            SETC  '"OUTDATALEN='            *KPOSA* MNOTE           00130400
&ZMS            SETC  '&ZMS.&OUTDATALEN"'                               00130500
&ZMS            SETC  '&ZMS "OUTDATALEN"'                               00130600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00130700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00130800
.ZG17A          ANOP  ,                                                 00130900
.*-------------------------------------------------------------------   00131000
.***AG.KXVAR10 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00131100
                AIF   (K'&OUTDATA(1) GT 0).ZG17B  KEY                   00131200
                AIF   (K'&OUTDATALEN(1) LE 0).ZG17D  NO PRM             00131300
&ZMS            SETC  '"OUTDATALEN'             *KDEPA* MNOTE           00131400
&ZMS            SETC  '&ZMS.=&OUTDATALEN"'                              00131500
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00131600
&ZMS            SETC  '&ZMS '                                           00131700
&ZMS            SETC  '&ZMS "OUTDATA"'                                  00131800
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00131900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00132000
                AGO   .ZG17D                                            00132100
.*                                                                      00132200
.ZG17B          ANOP  ,                                                 00132300
                AIF   (K'&OUTDATALEN(1) LE 0).ZG17C  NO PRM             00132400
&ZXOUTDATALEN   SETC  'OUTPUT'    SET OUTPUT                            00132500
&XOUTDATALEN    SETC  '&OUTDATALEN(1))'         SET XVARIABLE           00132600
                AIF   (N'&OUTDATALEN GT 1).ZG17C                        00132700
&XOUTDATALEN    SETC  '&OUTDATALEN'             SET XVARIABLE           00132800
                AGO   .ZG17D                                            00132900
.ZG17C          ANOP  ,                                                 00133000
&ZMS            SETC  'WHEN "OUTDATA" IS SPECIFIED'  *KRQDA*            00133100
&ZMS            SETC  '&ZMS , "OUTDATALEN" KEY AND ITS ARGUMENT'        00133200
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00133300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00133400
.ZG17D          ANOP  ,                                                 00133500
.*-------------------------------------------------------------------   00133600
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00133700
                AIF   (K'&ZXOUTDATALEN LE 0).ZG17R  NOT I/O             00133800
                AIF   ('&XOUTDATALEN'(1,1) NE '(').ZG17R                00133900
&ZCGPR          SETC  '&XOUTDATALEN'(2,K'&XOUTDATALEN-2)                00134000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                      00134100
                AIF   (K'&ZCGPR GT 2).ZG17Q                             00134200
                AIF   ('&ZCGPR' EQ '0').ZG17Q                           00134300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00134400
                AIF   (T'&ZCGPR NE 'N').ZG17Q   INVALID REG NAME        00134500
.ZG17P          ANOP  ,                                                 00134600
                AIF   (T'&ZCGPR NE 'N').ZG17R   NON NUMERIC             00134700
                AIF   ('&ZCGPR' LT '2').ZG17Q                           00134800
                AIF   ('&ZCGPR' LE '12').ZG17R                          00134900
.ZG17Q          ANOP  ,                                                 00135000
&ZMS            SETC  '"OUTDATALEN='            *KGPRA* MNOTE           00135100
&ZMS            SETC  '&ZMS.&OUTDATALEN"'                               00135200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00135300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00135400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00135500
.ZG17R          ANOP  ,                                                 00135600
.*----------------------------------------------------------------***   00135700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00135800
                AIF   (N'&OUTDATAKEY LE 1).ZG20A  CK NUM                00135900
&ZMS            SETC  '"OUTDATAKEY='            *KPOSA* MNOTE           00136000
&ZMS            SETC  '&ZMS.&OUTDATAKEY"'                               00136100
&ZMS            SETC  '&ZMS "OUTDATAKEY"'                               00136200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00136300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00136400
.ZG20A          ANOP  ,                                                 00136500
.*-------------------------------------------------------------------   00136600
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00136700
&XOUTDATAKEY    SETC  'CALLER_KEY'              SET DEFAULT             00136800
                AIF   (K'&OUTDATAKEY(1) LE 0).ZG20C  PARM               00136900
&XOUTDATAKEY    SETC  '&OUTDATAKEY(1)'          SET XVARIABLE           00137000
                AIF   (N'&OUTDATAKEY GT 1).ZG20B  MULTI PARMS           00137100
&XOUTDATAKEY    SETC  '&OUTDATAKEY'             SET XVARIABLE           00137200
.ZG20B          AIF   (K'&OUTDATA(1) GT 0).ZG20C  KEY                   00137300
&ZMS            SETC  '"OUTDATAKEY'             *KDEPA* MNOTE           00137400
&ZMS            SETC  '&ZMS.=&OUTDATAKEY"'                              00137500
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00137600
&ZMS            SETC  '&ZMS '                                           00137700
&ZMS            SETC  '&ZMS "OUTDATA"'                                  00137800
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00137900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00138000
.ZG20C          ANOP  ,                                                 00138100
&ZXOUTDATAKEY   SETC  'INPUT'     SET IN/OUTPUT                         00138200
.*-------------------------------------------------------------------   00138300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00138400
                AIF   (K'&ZXOUTDATAKEY LE 0).ZG20R  NOT I/O             00138500
                AIF   ('&XOUTDATAKEY' EQ 'CALLER_KEY').ZG20R            00138600
                AIF   ('&XOUTDATAKEY'(1,1) NE '(').ZG20R                00138700
&ZCGPR          SETC  '&XOUTDATAKEY'(2,K'&XOUTDATAKEY-2)                00138800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                      00138900
                AIF   (K'&ZCGPR GT 2).ZG20Q                             00139000
                AIF   ('&ZCGPR' EQ '0').ZG20Q                           00139100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00139200
                AIF   (T'&ZCGPR NE 'N').ZG20Q   INVALID REG NAME        00139300
.ZG20P          ANOP  ,                                                 00139400
                AIF   (T'&ZCGPR NE 'N').ZG20R   NON NUMERIC             00139500
                AIF   ('&ZCGPR' LT '2').ZG20Q                           00139600
                AIF   ('&ZCGPR' LE '12').ZG20R                          00139700
.ZG20Q          ANOP  ,                                                 00139800
&ZMS            SETC  '"OUTDATAKEY='            *KGPRA* MNOTE           00139900
&ZMS            SETC  '&ZMS.&OUTDATAKEY"'                               00140000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00140100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00140200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00140300
.ZG20R          ANOP  ,                                                 00140400
.*----------------------------------------------------------------***   00140500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00140600
                AIF   (N'&RTNCODE LE 1).ZG24A   CK NUM                  00140700
&ZMS            SETC  '"RTNCODE='               *KPOSA* MNOTE           00140800
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00140900
&ZMS            SETC  '&ZMS "RTNCODE"'                                  00141000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00141100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00141200
.ZG24A          ANOP  ,                                                 00141300
.*-------------------------------------------------------------------   00141400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00141500
                AIF   (K'&RTNCODE(1) LE 0).ZG24C  NO PARM               00141600
&ZXRTNCODE      SETC  'OUTPUT'    SET OUTPUT                            00141700
&XRTNCODE       SETC  '&RTNCODE(1)'             SET XVARIABLE           00141800
                AIF   (N'&RTNCODE GT 1).ZG24C                           00141900
&XRTNCODE       SETC  '&RTNCODE'  SET XVARIABLE                         00142000
.ZG24C          ANOP  ,                                                 00142100
.*-------------------------------------------------------------------   00142200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00142300
                AIF   (K'&ZXRTNCODE LE 0).ZG24R  NOT I/O                00142400
                AIF   ('&XRTNCODE'(1,1) NE '(').ZG24R                   00142500
&ZCGPR          SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                      00142600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                      00142700
                AIF   (K'&ZCGPR GT 2).ZG24Q                             00142800
                AIF   ('&ZCGPR' EQ '0').ZG24Q                           00142900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00143000
                AIF   (T'&ZCGPR NE 'N').ZG24Q   INVALID REG NAME        00143100
.ZG24P          ANOP  ,                                                 00143200
                AIF   (T'&ZCGPR NE 'N').ZG24R   NON NUMERIC             00143300
                AIF   ('&ZCGPR' LT '2').ZG24Q                           00143400
                AIF   ('&ZCGPR' LE '12').ZG24R                          00143500
.ZG24Q          ANOP  ,                                                 00143600
&ZMS            SETC  '"RTNCODE='               *KGPRA* MNOTE           00143700
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00143800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00143900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00144000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00144100
.ZG24R          ANOP  ,                                                 00144200
.*----------------------------------------------------------------***   00144300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00144400
                AIF   (N'&RSNCODE LE 1).ZG27A   CK NUM                  00144500
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           00144600
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00144700
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00144800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00144900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00145000
.ZG27A          ANOP  ,                                                 00145100
.*-------------------------------------------------------------------   00145200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00145300
                AIF   (K'&RSNCODE(1) LE 0).ZG27C  NO PARM               00145400
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00145500
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00145600
                AIF   (N'&RSNCODE GT 1).ZG27C                           00145700
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00145800
.ZG27C          ANOP  ,                                                 00145900
.*-------------------------------------------------------------------   00146000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00146100
                AIF   (K'&ZXRSNCODE LE 0).ZG27R  NOT I/O                00146200
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG27R                   00146300
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00146400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                      00146500
                AIF   (K'&ZCGPR GT 2).ZG27Q                             00146600
                AIF   ('&ZCGPR' EQ '0').ZG27Q                           00146700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00146800
                AIF   (T'&ZCGPR NE 'N').ZG27Q   INVALID REG NAME        00146900
.ZG27P          ANOP  ,                                                 00147000
                AIF   (T'&ZCGPR NE 'N').ZG27R   NON NUMERIC             00147100
                AIF   ('&ZCGPR' LT '2').ZG27Q                           00147200
                AIF   ('&ZCGPR' LE '12').ZG27R                          00147300
.ZG27Q          ANOP  ,                                                 00147400
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           00147500
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00147600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00147700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00147800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00147900
.ZG27R          ANOP  ,                                                 00148000
.******************************************************************     00148100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00148200
.******************************************************************     00148300
                ACTR  10000                                             00148400
.*----------------------------------------------------------------***   00148500
.***AH.P02 EXTRA POSITIONALS                                            00148600
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00148700
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00148800
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00148900
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00149000
.ZGLISTX1       ANOP  ,                                                 00149100
&ZCVAL          SETC  ''          ERROR FIELD                           00149200
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00149300
.ZGLIST2        ANOP  ,                                                 00149400
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00149500
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00149600
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00149700
                AGO   .ZGLIST2                                          00149800
.*                                                                      00149900
.ZGLIST3        ANOP  ,                                                 00150000
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00150100
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          00150200
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00150300
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00150400
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00150500
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00150600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00150700
.ZGLISTX        ANOP  ,                                                 00150800
&ZASYSLNDX      SETA  0                                                 00150900
.*-------------------------------------------------------------------   00151000
.***AG.MF04 MF=(SLE)                                                    00151100
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00151200
.*******************************************************************    00151300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00151400
.*******************************************************************    00151500
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00151600
.*******************************************************************    00151700
.***AE.01  START OF IXZXTSOI MACRO CODE                                 00151800
.*******************************************************************    00151900
                LCLC  &M0M0001                 NAME                     00152000
&M0M0001        SETC  '&XLABEL'                SET NAME                 00152100
                AIF   (K'&XLABEL NE 0).XLAB2                            00152200
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00152300
.*                                                                      00152400
.XLAB2          ANOP  ,                                                 00152500
&M0M0001 DS    0H                             IXZXTSOI-1                00152600
.*******************************************************************    00152700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00152800
.*******************************************************************    00152900
              PUSH  PRINT                                               00153000
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00153100
                PRINT OFF         ++ PR01                               00153200
                AGO   .ZPRNTXX                                          00153300
.ZPRINTX        PRINT ON                                                00153400
.ZPRNTXX        ANOP  ,                                                 00153500
.********************************************************************   00153600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00153700
.********************************************************************   00153800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00153900
                      LCLA  &ZOPN1         INVOCATION INDEX             00154000
                      LCLC  &ZOPL(4095)    LABEL                        00154100
                      LCLC  &ZOPO(4095)    OPERATION                    00154200
                      LCLC  &ZOPV(4095)    VALUE                        00154300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00154400
.*                                                                      00154500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00154600
.******************************************************************     00154700
.***AL.L10 IXZXTSOI FMT=LIST MF=S|L PARAMETERS                          00154800
.******************************************************************     00154900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00155000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00155100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00155200
&XMFATTR              SETC  '0D'                                        00155300
.*                                                                      00155400
&ZOPN                 SETA  &ZOPN+1                                     00155500
&ZOPL(&ZOPN)          SETC  ' '                                         00155600
&ZOPO(&ZOPN)          SETC  'B'                                         00155700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00155800
&ZOPD(&ZOPN)          SETC  '++ IXZXTSOI ARG PARMS'                     00155900
.*                                                                      00156000
&ZOPN                 SETA  &ZOPN+1                                     00156100
&ZOPL(&ZOPN)          SETC  ' '                                         00156200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00156300
&ZOPV(&ZOPN)          SETC  '1'                                         00156400
&ZOPD(&ZOPN)          SETC  ' '                                         00156500
.*                                                                      00156600
.ZLMFSL2              ANOP  ,                                           00156700
.*-------------------------------------------------------------------   00156800
.***AM.L01  IXZXTSOI FMT=LIST PARAMETERS                                00156900
&ZOPN                 SETA &ZOPN+1                                      00157000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00157100
&ZOPO(&ZOPN)          SETC 'DS'                                         00157200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00157300
&ZOPD(&ZOPN)          SETC '++ IXZXTSOI PARM LIST'                      00157400
.*-------------------------------------------------------------------   00157500
.***AM.L02 XVERSION XL1                                                 00157600
&ZOPN                 SETA &ZOPN+1                                      00157700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00157800
&ZOPO(&ZOPN)          SETC 'DS'                                         00157900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00158000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00158100
.*-------------------------------------------------------------------   00158200
.***AM.L09  XEYECATCHER CL6                                             00158300
&ZOPN                 SETA &ZOPN+1                                      00158400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYECATCHER'                      00158500
&ZOPO(&ZOPN)          SETC 'DS'                                         00158600
&ZOPV(&ZOPN)          SETC 'CL6'                                        00158700
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XEYECATCHER'                   00158800
.*-------------------------------------------------------------------   00158900
.***AM.L03 XMACROOPTIONS BL.8                                           00159000
&ZOPN                 SETA &ZOPN+1                                      00159100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMACROOPTIONS'                    00159200
&ZOPO(&ZOPN)          SETC 'DS'                                         00159300
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00159400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00159500
.*                                                                      00159600
&ZOPN                 SETA  &ZOPN+1                                     00159700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_USERID'                  00159800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00159900
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00160000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00160100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).USERID'                       00160200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00160300
.*                                                                      00160400
&ZOPN                 SETA  &ZOPN+1                                     00160500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SYSTEM'                  00160600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00160700
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00160800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00160900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYSTEM'                       00161000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00161100
.*                                                                      00161200
&ZOPN                 SETA  &ZOPN+1                                     00161300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_INDATAKEY'               00161400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00161500
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00161600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00161700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INDATAKEY'                    00161800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00161900
.*                                                                      00162000
&ZOPN                 SETA  &ZOPN+1                                     00162100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_OUTDATAKEY'              00162200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00162300
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00162400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00162500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).OUTDATAKEY'                   00162600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00162700
.*                                                                      00162800
&ZOPN                 SETA  &ZOPN+1                                     00162900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_INDATA'                  00163000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00163100
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00163200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00163300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INDATA'                       00163400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00163500
.*                                                                      00163600
&ZOPN                 SETA  &ZOPN+1                                     00163700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_OUTDATA'                 00163800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00163900
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00164000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00164100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).OUTDATA'                      00164200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00164300
.*-------------------------------------------------------------------   00164400
.***AM.L09  XINDATAKEY XL1                                              00164500
&ZOPN                 SETA &ZOPN+1                                      00164600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINDATAKEY'                       00164700
&ZOPO(&ZOPN)          SETC 'DS'                                         00164800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00164900
&ZOPD(&ZOPN)          SETC '++ &ZXINDATAKEY  XINDATAKEY'                00165000
.*-------------------------------------------------------------------   00165100
.***AM.L09  XOUTDATAKEY XL1                                             00165200
&ZOPN                 SETA &ZOPN+1                                      00165300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTDATAKEY'                      00165400
&ZOPO(&ZOPN)          SETC 'DS'                                         00165500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00165600
&ZOPD(&ZOPN)          SETC '++ &ZXOUTDATAKEY  XOUTDATAKEY'              00165700
.*-------------------------------------------------------------------   00165800
.***AM.L09  XRSV0001 CL2                                                00165900
&ZOPN                 SETA &ZOPN+1                                      00166000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00166100
&ZOPO(&ZOPN)          SETC 'DS'                                         00166200
&ZOPV(&ZOPN)          SETC 'CL2'                                        00166300
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00166400
.*-------------------------------------------------------------------   00166500
.***AM.L09  XUSERID CL8                                                 00166600
&ZOPN                 SETA &ZOPN+1                                      00166700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERID'                          00166800
&ZOPO(&ZOPN)          SETC 'DS'                                         00166900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00167000
&ZOPD(&ZOPN)          SETC '++ &ZXUSERID  XUSERID'                      00167100
.*-------------------------------------------------------------------   00167200
.***AM.L09  XINDATA A                                                   00167300
&ZOPN                 SETA &ZOPN+1                                      00167400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINDATA'                          00167500
&ZOPO(&ZOPN)          SETC 'DS'                                         00167600
&ZOPV(&ZOPN)          SETC 'A'                                          00167700
&ZOPD(&ZOPN)          SETC '++ &ZXINDATA  XINDATA'                      00167800
.*-------------------------------------------------------------------   00167900
.***AM.L09  XINDATALEN F                                                00168000
&ZOPN                 SETA &ZOPN+1                                      00168100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINDATALEN'                       00168200
&ZOPO(&ZOPN)          SETC 'DS'                                         00168300
&ZOPV(&ZOPN)          SETC 'F'                                          00168400
&ZOPD(&ZOPN)          SETC '++ &ZXINDATALEN  XINDATALEN'                00168500
.*-------------------------------------------------------------------   00168600
.***AM.L09  XOUTDATA A                                                  00168700
&ZOPN                 SETA &ZOPN+1                                      00168800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTDATA'                         00168900
&ZOPO(&ZOPN)          SETC 'DS'                                         00169000
&ZOPV(&ZOPN)          SETC 'A'                                          00169100
&ZOPD(&ZOPN)          SETC '++ &ZXOUTDATA  XOUTDATA'                    00169200
.*-------------------------------------------------------------------   00169300
.***AM.L09  XOUTDATALEN F                                               00169400
&ZOPN                 SETA &ZOPN+1                                      00169500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTDATALEN'                      00169600
&ZOPO(&ZOPN)          SETC 'DS'                                         00169700
&ZOPV(&ZOPN)          SETC 'F'                                          00169800
&ZOPD(&ZOPN)          SETC '++ &ZXOUTDATALEN  XOUTDATALEN'              00169900
.*-------------------------------------------------------------------   00170000
.***AM.L09  XRSV0002 CL4                                                00170100
&ZOPN                 SETA &ZOPN+1                                      00170200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00170300
&ZOPO(&ZOPN)          SETC 'DS'                                         00170400
&ZOPV(&ZOPN)          SETC 'CL4'                                        00170500
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00170600
.*-------------------------------------------------------------------   00170700
.***AM.L09  XRSV0003 CL16                                               00170800
&ZOPN                 SETA &ZOPN+1                                      00170900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00171000
&ZOPO(&ZOPN)          SETC 'DS'                                         00171100
&ZOPV(&ZOPN)          SETC 'CL16'                                       00171200
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0003'                      00171300
.*-------------------------------------------------------------------   00171400
.***AM.MLM1 SAVED LOCATION COUNTER                                      00171500
                      AIF  ('&ZENDBASEPL' NE '').ZL20LB                 00171600
&ZENDBASEPL           SETC 'YES'                                        00171700
&ZOPN                 SETA &ZOPN+1                                      00171800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00171900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00172000
&ZOPV(&ZOPN)          SETC '*'                                          00172100
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00172200
.ZL20LB               ANOP  ,                                           00172300
.*-------------------------------------------------------------------   00172400
.***AM.PJR1 DEFINED ON XUSERID                                          00172500
&ZOPN                 SETA &ZOPN+1                                      00172600
&ZOPL(&ZOPN)          SETC ' '                                          00172700
&ZOPO(&ZOPN)          SETC 'ORG'                                        00172800
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+12'                               00172900
&ZOPD(&ZOPN)          SETC ' '                                          00173000
.*-------------------------------------------------------------------   00173100
.***AM.L09  XSYSTEM CL8                                                 00173200
&ZOPN                 SETA &ZOPN+1                                      00173300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSTEM'                          00173400
&ZOPO(&ZOPN)          SETC 'DS'                                         00173500
&ZOPV(&ZOPN)          SETC 'CL8'                                        00173600
&ZOPD(&ZOPN)          SETC '++ &ZXSYSTEM  XSYSTEM'                      00173700
&ZOPN                 SETA &ZOPN+1                                      00173800
&ZOPL(&ZOPN)          SETC ' '                                          00173900
&ZOPO(&ZOPN)          SETC 'ORG'                                        00174000
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00174100
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00174200
.*-------------------------------------------------------------------   00174300
.***AM.L10 END OF IXZXTSOI LIST PARAMETERS                              00174400
&ZOPN                 SETA &ZOPN+1                                      00174500
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00174600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00174700
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00174800
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00174900
.*                                                                      00175000
&ZOPN                 SETA &ZOPN+1                                      00175100
&ZOPL(&ZOPN)          SETC ' '                                          00175200
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00175300
&ZOPV(&ZOPN)          SETC '1'                                          00175400
&ZOPD(&ZOPN)          SETC ' '                                          00175500
.*-------------------------------------------------------------------   00175600
.***AL.L12 IXZXTSOI FMT=LIST MF=S|L PARAMETERS                          00175700
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00175800
.*                                                                      00175900
&ZOPN                 SETA  &ZOPN+1                                     00176000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00176100
&ZOPO(&ZOPN)          SETC  'DC'                                        00176200
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00176300
&ZOPD(&ZOPN)          SETC  '++ IXZXTSOI ARG PARMS'                     00176400
.*                                                                      00176500
.ZLMFSLX              ANOP  ,                                           00176600
.*-------------------------------------------------------------------   00176700
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00176800
&ZPLLEN               SETA 56                                           00176900
.*                                                                      00177000
.******************************************************************     00177100
.***AI.L01 IXZXTSOI FMT=LIST FILL IN PARAMETER AREA                     00177200
.******************************************************************     00177300
                      ACTR  10000                                       00177400
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00177500
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00177600
&ZCVAL                SETC  'LAE'          XAX MODE                     00177700
.ZIMFXA               ANOP ,                                            00177800
.*                                                                      00177900
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00178000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00178100
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00178200
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00178300
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00178400
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00178500
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00178600
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00178700
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00178800
&ZOPN                 SETA  &ZOPN+1                                     00178900
&ZOPL(&ZOPN)          SETC  ' '                                         00179000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00179100
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00179200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00179300
                      AGO   .ZIMFNX                                     00179400
.*                                                                      00179500
.ZIMFN2               ANOP ,                                            00179600
&ZOPN                 SETA  &ZOPN+1                                     00179700
&ZOPL(&ZOPN)          SETC  ' '                                         00179800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00179900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00180000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00180100
.ZIMFNX               ANOP ,                                            00180200
.********************************************************************   00180300
.***AI.L02 IXZXTSOI FMT=LIST INITIALIZE PARAMETER AREA                  00180400
.********************************************************************   00180500
.***AI.L03 MF=(SLE)                                                     00180600
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00180700
.*                                                                      00180800
&ZOPN                 SETA  &ZOPN+1                                     00180900
&ZOPL(&ZOPN)          SETC  ' '                                         00181000
&ZOPO(&ZOPN)          SETC  'XC'                                        00181100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00181200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00181300
.ZIMFLX               ANOP  ,                                           00181400
.*-------------------------------------------------------------------   00181500
.***AI.L04B XVERSION XL1                                                00181600
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00181700
&ZOPN                 SETA  &ZOPN+1                                     00181800
&ZOPL(&ZOPN)          SETC  ' '                                         00181900
&ZOPO(&ZOPN)          SETC  'MVI'                                       00182000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00182100
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00182200
.ZIMFVX               ANOP  ,                                           00182300
.*-------------------------------------------------------------------   00182400
.***AI.L60 XEYECATCHER CL6                                              00182500
&ZOPN                 SETA  &ZOPN+1                                     00182600
&ZOPL(&ZOPN)          SETC  ' '                                         00182700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00182800
&ZOPV(&ZOPN)          SETC  '1(6,1),=CL6''YTSOGR'''                     00182900
&ZOPD(&ZOPN)          SETC  '++ CL6 CONSTANT'                           00183000
.*-------------------------------------------------------------------   00183100
.***AI.L05 XMACROOPTIONS BL1                                            00183200
&ZW                   SETC  ''                                          00183300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00183400
.*-------------------------------------------------------------------   00183500
.***AI.L08 XMACROOPTIONS "USERID"                                       00183600
.***      BL1'1XXXXXXX'                                                 00183700
         AIF   ('&USERID' EQ '').ZI4A                                   00183800
&ZW                   SETC  '&ZW.1'                                     00183900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00184000
                      AGO   .ZI4C                                       00184100
.*                                                                      00184200
.ZI4A                 ANOP  ,                                           00184300
&ZW                   SETC  '&ZW.0'                                     00184400
.ZI4C                 ANOP  ,                                           00184500
.*-------------------------------------------------------------------   00184600
.***AI.L08 XMACROOPTIONS "SYSTEM"                                       00184700
.***      BL1'X1XXXXXX'                                                 00184800
         AIF   ('&SYSTEM' EQ '').ZI5A                                   00184900
&ZW                   SETC  '&ZW.1'                                     00185000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00185100
                      AGO   .ZI5C                                       00185200
.*                                                                      00185300
.ZI5A                 ANOP  ,                                           00185400
&ZW                   SETC  '&ZW.0'                                     00185500
.ZI5C                 ANOP  ,                                           00185600
.*-------------------------------------------------------------------   00185700
.***AI.L08 XMACROOPTIONS "INDATAKEY"                                    00185800
.***      BL1'XX1XXXXX'                                                 00185900
         AIF   ('&INDATAKEY' EQ '').ZI6A                                00186000
         AIF   ('&INDATAKEY' EQ 'CALLER_KEY').ZI6A                      00186100
&ZW                   SETC  '&ZW.1'                                     00186200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00186300
                      AGO   .ZI6C                                       00186400
.*                                                                      00186500
.ZI6A                 ANOP  ,                                           00186600
&ZW                   SETC  '&ZW.0'                                     00186700
.ZI6C                 ANOP  ,                                           00186800
.*-------------------------------------------------------------------   00186900
.***AI.L08 XMACROOPTIONS "OUTDATAKEY"                                   00187000
.***      BL1'XXX1XXXX'                                                 00187100
         AIF   ('&OUTDATAKEY' EQ '').ZI7A                               00187200
         AIF   ('&OUTDATAKEY' EQ 'CALLER_KEY').ZI7A                     00187300
&ZW                   SETC  '&ZW.1'                                     00187400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00187500
                      AGO   .ZI7C                                       00187600
.*                                                                      00187700
.ZI7A                 ANOP  ,                                           00187800
&ZW                   SETC  '&ZW.0'                                     00187900
.ZI7C                 ANOP  ,                                           00188000
.*-------------------------------------------------------------------   00188100
.***AI.L08 XMACROOPTIONS "INDATA"                                       00188200
.***      BL1'XXXX1XXX'                                                 00188300
         AIF   ('&INDATA' EQ '').ZI8A                                   00188400
&ZW                   SETC  '&ZW.1'                                     00188500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00188600
                      AGO   .ZI8C                                       00188700
.*                                                                      00188800
.ZI8A                 ANOP  ,                                           00188900
&ZW                   SETC  '&ZW.0'                                     00189000
.ZI8C                 ANOP  ,                                           00189100
.*-------------------------------------------------------------------   00189200
.***AI.L08 XMACROOPTIONS "OUTDATA"                                      00189300
.***      BL1'XXXXX1XX'                                                 00189400
         AIF   ('&OUTDATA' EQ '').ZI9A                                  00189500
&ZW                   SETC  '&ZW.100'                                   00189600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00189700
                      AGO   .ZI9C                                       00189800
.*                                                                      00189900
.ZI9A                 ANOP  ,                                           00190000
&ZW                   SETC  '&ZW.000'                                   00190100
.ZI9C                 ANOP  ,                                           00190200
.*-------------------------------------------------------------------   00190300
.***AI.L11 XMACROOPTIONS BL1                                            00190400
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00190500
&ZOPN                 SETA  &ZOPN+1                                     00190600
&ZOPL(&ZOPN)          SETC  ' '                                         00190700
&ZOPO(&ZOPN)          SETC  'OI'                                        00190800
&ZOPV(&ZOPN)          SETC  '7(1),B''&ZW'''                             00190900
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             00191000
.ZI9E                 ANOP  ,                                           00191100
.*-------------------------------------------------------------------   00191200
.***AI.L18  XINDATAKEY XL1                                              00191300
         AIF   ('&XINDATAKEY' NE 'CALLER_KEY').ZI10                     00191400
&ZXINDATAKEY          SETC  ''             RESET INPUT/OUTPUT           00191500
.ZI10                 ANOP  ,                                           00191600
.*-------------------------------------------------------------------   00191700
.***AI.L25  XINDATAKEY XL1                                              00191800
                      AIF   ('&ZXINDATAKEY' EQ '').ZI10E                00191900
                      AIF   ('&ZXINDATAKEY' EQ 'OUTPUT').ZI10E          00192000
&ZCGPR                SETC  '&XINDATAKEY'                               00192100
.*                                                                      00192200
                      AIF   ('&XINDATAKEY'(1,1) NE '(').ZI10B           00192300
&ZCGPR   SETC  '0('.'&XINDATAKEY'(2,K'&XINDATAKEY-2).')'                00192400
                      AGO   .ZI10D                                      00192500
.ZI10B                ANOP  ,                                           00192600
.*                                                                      00192700
&ZC                   SETC  '&XINDATAKEY'(1,1)                          00192800
                      AIF   (T'&ZC NE 'N').ZI10D                        00192900
&ZC                   SETC  '&XINDATAKEY'                               00193000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00193100
&ZCGPR                SETC  '=AL1(&XINDATAKEY)'                         00193200
.*                                                                      00193300
.ZI10D                ANOP  ,                                           00193400
.*                                                                      00193500
&ZOPN                 SETA  &ZOPN+1                                     00193600
&ZOPL(&ZOPN)          SETC  ' '                                         00193700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00193800
&ZOPV(&ZOPN)          SETC  '8(1,1),&ZCGPR'                             00193900
&ZOPD(&ZOPN)          SETC  '++ &ZXINDATAKEY XINDATAKEY'                00194000
.*                                                                      00194100
.ZI10E                ANOP  ,                                           00194200
.*-------------------------------------------------------------------   00194300
.***AI.L18  XOUTDATAKEY XL1                                             00194400
         AIF   ('&XOUTDATAKEY' NE 'CALLER_KEY').ZI11                    00194500
&ZXOUTDATAKEY         SETC  ''             RESET INPUT/OUTPUT           00194600
.ZI11                 ANOP  ,                                           00194700
.*-------------------------------------------------------------------   00194800
.***AI.L25  XOUTDATAKEY XL1                                             00194900
                      AIF   ('&ZXOUTDATAKEY' EQ '').ZI11E               00195000
                      AIF   ('&ZXOUTDATAKEY' EQ 'OUTPUT').ZI11E         00195100
&ZCGPR                SETC  '&XOUTDATAKEY'                              00195200
.*                                                                      00195300
                      AIF   ('&XOUTDATAKEY'(1,1) NE '(').ZI11B          00195400
&ZCGPR   SETC  '0('.'&XOUTDATAKEY'(2,K'&XOUTDATAKEY-2).')'              00195500
                      AGO   .ZI11D                                      00195600
.ZI11B                ANOP  ,                                           00195700
.*                                                                      00195800
&ZC                   SETC  '&XOUTDATAKEY'(1,1)                         00195900
                      AIF   (T'&ZC NE 'N').ZI11D                        00196000
&ZC                   SETC  '&XOUTDATAKEY'                              00196100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00196200
&ZCGPR                SETC  '=AL1(&XOUTDATAKEY)'                        00196300
.*                                                                      00196400
.ZI11D                ANOP  ,                                           00196500
.*                                                                      00196600
&ZOPN                 SETA  &ZOPN+1                                     00196700
&ZOPL(&ZOPN)          SETC  ' '                                         00196800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00196900
&ZOPV(&ZOPN)          SETC  '9(1,1),&ZCGPR'                             00197000
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTDATAKEY XOUTDATAKEY'              00197100
.*                                                                      00197200
.ZI11E                ANOP  ,                                           00197300
.*-------------------------------------------------------------------   00197400
.***AI.L25  XUSERID CL8                                                 00197500
                      AIF   ('&ZXUSERID' EQ '').ZI13E                   00197600
                      AIF   ('&ZXUSERID' EQ 'OUTPUT').ZI13E             00197700
&ZCGPR                SETC  '&XUSERID'                                  00197800
.*                                                                      00197900
                      AIF   ('&XUSERID'(1,1) NE '(').ZI13B              00198000
&ZCGPR   SETC  '0('.'&XUSERID'(2,K'&XUSERID-2).')'                      00198100
.ZI13B                ANOP  ,                                           00198200
.*                                                                      00198300
&ZOPN                 SETA  &ZOPN+1                                     00198400
&ZOPL(&ZOPN)          SETC  ' '                                         00198500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00198600
&ZOPV(&ZOPN)          SETC  '12(8,1),&ZCGPR'                            00198700
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERID XUSERID'                      00198800
.*                                                                      00198900
.ZI13E                ANOP  ,                                           00199000
.*-------------------------------------------------------------------   00199100
.***AI.L25  XINDATA AL4                                                 00199200
                      AIF   ('&ZXINDATA' EQ '').ZI14E                   00199300
                      AIF   ('&ZXINDATA' EQ 'OUTPUT').ZI14E             00199400
&ZCGPR                SETC  '&XINDATA'                                  00199500
         AIF   ('&XINDATA' EQ '0').ZI14E                                00199600
.*                                                                      00199700
                      AIF   ('&XINDATA'(1,1) NE '(').ZI14B              00199800
&ZCGPR   SETC  '0('.'&XINDATA'(2,K'&XINDATA-2).')'                      00199900
                      AGO   .ZI14D                                      00200000
.ZI14B                ANOP  ,                                           00200100
.*                                                                      00200200
&ZC                   SETC  '&XINDATA'(1,1)                             00200300
                      AIF   (T'&ZC NE 'N').ZI14D                        00200400
&ZC                   SETC  '&XINDATA'                                  00200500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI14D               00200600
&ZCGPR                SETC  '=AL4(&XINDATA)'                            00200700
.*                                                                      00200800
.ZI14D                ANOP  ,                                           00200900
.*                                                                      00201000
&ZOPN                 SETA  &ZOPN+1                                     00201100
&ZOPL(&ZOPN)          SETC  ' '                                         00201200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00201300
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00201400
&ZOPD(&ZOPN)          SETC  '++ &ZXINDATA XINDATA'                      00201500
.*                                                                      00201600
.ZI14E                ANOP  ,                                           00201700
.*-------------------------------------------------------------------   00201800
.***AI.L25  XINDATALEN F                                                00201900
                      AIF   ('&ZXINDATALEN' EQ '').ZI15E                00202000
                      AIF   ('&ZXINDATALEN' EQ 'OUTPUT').ZI15E          00202100
&ZCGPR                SETC  '&XINDATALEN'                               00202200
.*                                                                      00202300
                      AIF   ('&XINDATALEN'(1,1) NE '(').ZI15B           00202400
&ZCGPR   SETC  '0('.'&XINDATALEN'(2,K'&XINDATALEN-2).')'                00202500
                      AGO   .ZI15D                                      00202600
.ZI15B                ANOP  ,                                           00202700
.*                                                                      00202800
&ZC                   SETC  '&XINDATALEN'(1,1)                          00202900
                      AIF   (T'&ZC NE 'N').ZI15D                        00203000
&ZC                   SETC  '&XINDATALEN'                               00203100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               00203200
&ZCGPR                SETC  '=FL4''&XINDATALEN'''                       00203300
.*                                                                      00203400
.ZI15D                ANOP  ,                                           00203500
.*                                                                      00203600
&ZOPN                 SETA  &ZOPN+1                                     00203700
&ZOPL(&ZOPN)          SETC  ' '                                         00203800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00203900
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00204000
&ZOPD(&ZOPN)          SETC  '++ &ZXINDATALEN XINDATALEN'                00204100
.*                                                                      00204200
.ZI15E                ANOP  ,                                           00204300
.*-------------------------------------------------------------------   00204400
.***AI.L25  XSYSTEM CL8                                                 00204500
                      AIF   ('&ZXSYSTEM' EQ '').ZI21E                   00204600
                      AIF   ('&ZXSYSTEM' EQ 'OUTPUT').ZI21E             00204700
&ZCGPR                SETC  '&XSYSTEM'                                  00204800
.*                                                                      00204900
                      AIF   ('&XSYSTEM'(1,1) NE '(').ZI21B              00205000
&ZCGPR   SETC  '0('.'&XSYSTEM'(2,K'&XSYSTEM-2).')'                      00205100
.ZI21B                ANOP  ,                                           00205200
.*                                                                      00205300
&ZOPN                 SETA  &ZOPN+1                                     00205400
&ZOPL(&ZOPN)          SETC  ' '                                         00205500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00205600
&ZOPV(&ZOPN)          SETC  '12(8,1),&ZCGPR'                            00205700
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSTEM XSYSTEM'                      00205800
.*                                                                      00205900
.ZI21E                ANOP  ,                                           00206000
.*-------------------------------------------------------------------   00206100
&ZOPN1                SETA &ZOPN                                        00206200
.*******************************************************************    00206300
.***  PROCESS IXZXTSOI OUTPUT PARAMETERS                                00206400
.*******************************************************************    00206500
                      ACTR  10000                                       00206600
.*------------------------------------------------------------------    00206700
.***AO.LVER01                                                           00206800
                      AIF  (&XPLISTVER LT 1).ZO16Z  PLVER               00206900
.*------------------------------------------------------------------    00207000
.***AO.L02 XOUTDATA A                                                   00207100
         AIF   ('&ZXOUTDATA' EQ 'OUTPUT').ZO16A  OUTPUT                 00207200
         AIF   ('&ZXOUTDATA' NE 'INOUT').ZO16C  INOUT                   00207300
.ZO16A    AIF   ('&XOUTDATA'(1,1) NE '(').ZO16B  ADDR IN GPR            00207400
&ZCGPR   SETC  '&XOUTDATA'(2,K'&XOUTDATA-2)                             00207500
&ZOPN                 SETA  &ZOPN+1                                     00207600
&ZOPL(&ZOPN)          SETC  ' '                                         00207700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00207800
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),28(1)'                         00207900
&ZOPD(&ZOPN)          SETC  '++ XOUTDATA A'                             00208000
                      AGO   .ZO16C                                      00208100
.*                                                                      00208200
.ZO16B                ANOP  ,                                           00208300
&ZAWRK   SETA  K'&XOUTDATA                                              00208400
         AIF   ('&XOUTDATA'(&ZAWRK,1) NE ')').ZO16G                     00208500
&ZN      SETA  2                                                        00208600
.ZO16H    ANOP                                                          00208700
         AIF   (&ZN GE &ZAWRK).ZO16G                                    00208800
         AIF   ('&XOUTDATA'(&ZN,1) NE '(').ZO16I                        00208900
&ZC      SETC  '&XOUTDATA'(1,&ZN).'4'.','                               00209000
&ZC      SETC  '&ZC'.'&XOUTDATA'(&ZN+1,&ZAWRK-&ZN).',28(1)'             00209100
         AGO   .ZO16J                                                   00209200
.ZO16I    ANOP                                                          00209300
&ZN      SETA  &ZN+1                                                    00209400
         AGO   .ZO16H                                                   00209500
.ZO16G    ANOP                                                          00209600
&ZC      SETC  '&XOUTDATA.(4),28(1)'                                    00209700
.ZO16J    ANOP                                                          00209800
&ZOPN                 SETA  &ZOPN+1                                     00209900
&ZOPL(&ZOPN)          SETC  ' '                                         00210000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00210100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00210200
&ZOPD(&ZOPN)          SETC  '++ XOUTDATA A'                             00210300
.ZO16C                ANOP  ,                                           00210400
.*------------------------------------------------------------------    00210500
.***AO.LVER02                                                           00210600
.ZO16Z                ANOP  ,                                           00210700
.*------------------------------------------------------------------    00210800
.***AO.LVER01                                                           00210900
                      AIF  (&XPLISTVER LT 1).ZO17Z  PLVER               00211000
.*------------------------------------------------------------------    00211100
.***AO.L02 XOUTDATALEN F                                                00211200
         AIF   ('&ZXOUTDATALEN' EQ 'OUTPUT').ZO17A  OUTPUT              00211300
         AIF   ('&ZXOUTDATALEN' NE 'INOUT').ZO17C  INOUT                00211400
.ZO17A    AIF   ('&XOUTDATALEN'(1,1) NE '(').ZO17B  ADDR IN GPR         00211500
&ZCGPR   SETC  '&XOUTDATALEN'(2,K'&XOUTDATALEN-2)                       00211600
&ZOPN                 SETA  &ZOPN+1                                     00211700
&ZOPL(&ZOPN)          SETC  ' '                                         00211800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00211900
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),32(1)'                         00212000
&ZOPD(&ZOPN)          SETC  '++ XOUTDATALEN F'                          00212100
                      AGO   .ZO17C                                      00212200
.*                                                                      00212300
.ZO17B                ANOP  ,                                           00212400
&ZAWRK   SETA  K'&XOUTDATALEN                                           00212500
         AIF   ('&XOUTDATALEN'(&ZAWRK,1) NE ')').ZO17G                  00212600
&ZN      SETA  2                                                        00212700
.ZO17H    ANOP                                                          00212800
         AIF   (&ZN GE &ZAWRK).ZO17G                                    00212900
         AIF   ('&XOUTDATALEN'(&ZN,1) NE '(').ZO17I                     00213000
&ZC      SETC  '&XOUTDATALEN'(1,&ZN).'4'.','                            00213100
&ZC      SETC  '&ZC'.'&XOUTDATALEN'(&ZN+1,&ZAWRK-&ZN).',32(1)'          00213200
         AGO   .ZO17J                                                   00213300
.ZO17I    ANOP                                                          00213400
&ZN      SETA  &ZN+1                                                    00213500
         AGO   .ZO17H                                                   00213600
.ZO17G    ANOP                                                          00213700
&ZC      SETC  '&XOUTDATALEN.(4),32(1)'                                 00213800
.ZO17J    ANOP                                                          00213900
&ZOPN                 SETA  &ZOPN+1                                     00214000
&ZOPL(&ZOPN)          SETC  ' '                                         00214100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00214200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00214300
&ZOPD(&ZOPN)          SETC  '++ XOUTDATALEN F'                          00214400
.ZO17C                ANOP  ,                                           00214500
.*------------------------------------------------------------------    00214600
.***AO.LVER02                                                           00214700
.ZO17Z                ANOP  ,                                           00214800
.*******************************************************************    00214900
.***AO.X02  RETURN CODE PROCESSING                                      00215000
.*******************************************************************    00215100
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00215200
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00215300
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00215400
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00215500
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00215600
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00215700
&ZOPN                 SETA  &ZOPN+1                                     00215800
&ZOPL(&ZOPN)          SETC  ' '                                         00215900
&ZOPO(&ZOPN)          SETC  'ST'                                        00216000
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00216100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00216200
                      AGO   .ZMRETX                                     00216300
.*                                                                      00216400
.ZMRET2               ANOP  ,                                           00216500
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00216600
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00216700
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00216800
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00216900
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00217000
&ZOPN                 SETA  &ZOPN+1                                     00217100
&ZOPL(&ZOPN)          SETC  ' '                                         00217200
&ZOPO(&ZOPN)          SETC  'LR'                                        00217300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00217400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00217500
.ZMRETX               ANOP  ,                                           00217600
.*******************************************************************    00217700
.***AO.X03  REASON CODE PROCESSING                                      00217800
.*******************************************************************    00217900
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00218000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00218100
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00218200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00218300
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00218400
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00218500
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00218600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00218700
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00218800
&ZOPN                 SETA  &ZOPN+1                                     00218900
&ZOPL(&ZOPN)          SETC  ' '                                         00219000
&ZOPO(&ZOPN)          SETC  'ST'                                        00219100
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00219200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00219300
                      AGO   .ZMRSNX                                     00219400
.*                                                                      00219500
.ZMRSN2               ANOP  ,                                           00219600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00219700
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00219800
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00219900
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00220000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00220100
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00220200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00220300
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00220400
&ZOPN                 SETA  &ZOPN+1                                     00220500
&ZOPL(&ZOPN)          SETC  ' '                                         00220600
&ZOPO(&ZOPN)          SETC  'LR'                                        00220700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00220800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00220900
.ZMRSNX               ANOP  ,                                           00221000
.*******************************************************************    00221100
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00221200
.*******************************************************************    00221300
.ZMFLX                ANOP  ,              MF=L PROCESSING              00221400
.*******************************************************************    00221500
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00221600
.*******************************************************************    00221700
                      ACTR  10000                                       00221800
.*                                                                      00221900
                      LCLA  &ZLC           COLUMN POSITION              00222000
                      LCLA  &ZOPX          LIST TABLE INDEX             00222100
                      LCLC  &ZLL           LABEL                        00222200
                      LCLC  &ZLOP          OPERATION                    00222300
                      LCLC  &ZLV           VALUE                        00222400
                      LCLC  &ZLD           DESCRIPTION                  00222500
.*                                                                      00222600
&ZOPX                 SETA  1                                           00222700
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00222800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00222900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00223000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00223100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00223200
                      AIF   (K'&ZLD LE 0).ZL5                           00223300
&ZLC                  SETA  35             COMMENT COLUMN               00223400
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00223500
&ZLC                  SETA  33             COMMMENT COLUMN              00223600
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00223700
&ZLV                  SETC  '&ZLV'.' '                                  00223800
                      AGO   .ZL3                                        00223900
.*                                                                      00224000
.ZL4                  ANOP  ,                                           00224100
&ZLV                  SETC  '&ZLV'.' '                                  00224200
.ZL5                  ANOP  ,                                           00224300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00224400
.*                                                                      00224500
&ZLL     &ZLOP &ZLV                                                     00224600
.*                                                                      00224700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00224800
                      AGO   .ZL2           CONTINUE LOOPING             00224900
.*                                                                      00225000
.ZLX                  ANOP  ,                                           00225100
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00225200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00225300
.*                                                                      00225400
.*----------------------------------------------------------------      00225500
.*       Check whether either INDATA or OUTDATA accompanies             00225600
.*       USERID.  One of these must be specified if USERID is           00225700
.*       specified.                                                     00225800
.*----------------------------------------------------------------      00225900
.*                                                                      00226000
         AIF   (('&USERID' NE '')                                      +00226100
                AND ('&INDATA' EQ '') AND ('&OUTDATA' EQ '')).UIOREQ    00226200
         AGO   .EUSRCHK                                                 00226300
.*                                                                      00226400
.UIOREQ  ANOP                                                           00226500
         MNOTE 8,'INDATA OR OUTDATA REQUIRED WHEN USERID IS SPECIFIED'  00226600
         MEXIT                                                          00226700
.*                                                                      00226800
.EUSRCHK ANOP                                                           00226900
.*                                                                      00227000
&JXOKLAB SETC  'JXL&SYSNDX'      Generate a unique label                00227100
&TSOELAB SETC  'TSE&SYSNDX'      Generate a unique label                00227200
         L     14,16(0,0)        Load the CVT address                   00227300
         L     14,140(0,14)      Load the ECVT address                  00227400
         ICM   14,B'1111',284(14)  Get the JCCT address                 00227500
         BNZ   &JXOKLAB          There is one, continue                 00227600
         LA    15,40             Set JESXCF down reason code            00227700
         LA    0,4               Set unsuccessful return code           00227800
         B     &TSOELAB          Skip the PC                            00227900
&JXOKLAB DS    0H                                                       00228000
         L     14,40(0,14)       Load the PC number                     00228100
         PC    0(14)             Call the TSO GR routine                00228200
         AIF   ('&XMFCTRL'(1,1) NE '(').TSOI200                         00228300
         LR    1,&XMFCTRL         Restore the parameter list address    00228400
         AGO   .TSOI250                                                 00228500
.TSOI200 ANOP                                                           00228600
         LA    1,&XMFCTRL         Restore the parameter list address    00228700
.TSOI250 ANOP                                                           00228800
&TSOELAB DS    0H                                                       00228900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00229000
.ZLINKX               ANOP  ,                                           00229100
.*******************************************************************    00229200
.***AP.X01  FORMAT GENERATED CODE                                       00229300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00229400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00229500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00229600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00229700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00229800
                      AIF   (K'&ZLD LE 0).ZL51                          00229900
&ZLC                  SETA  35             COMMENT COLUMN               00230000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00230100
&ZLC                  SETA  33             COMMENT COLUMN               00230200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00230300
&ZLV                  SETC  '&ZLV'.' '                                  00230400
                      AGO   .ZL31                                       00230500
.*                                                                      00230600
.ZL41                 ANOP  ,                                           00230700
&ZLV                  SETC  '&ZLV'.' '                                  00230800
.ZL51                 ANOP  ,                                           00230900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00231000
.*                                                                      00231100
&ZLL     &ZLOP &ZLV                                                     00231200
.*                                                                      00231300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00231400
                      AGO   .ZL21          CONTINUE LOOPING             00231500
.*                                                                      00231600
.ZLX1                 ANOP  ,                                           00231700
.*******************************************************************    00231800
.***AP.X02  END OF IXZXTSOI MACRO                                       00231900
&ZIXZXTSOI            SETC  'YES'          SET IXZXTSOI USED            00232000
         POP   PRINT                                                    00232100
*                                            IXZXTSOI-1                 00232200
         SPACE 1                                                        00232300
.ZLX2                 ANOP  ,                                           00232400
         MEND                                                           00232500
**********************************************************************/ 00232600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00232700
*%IXZXTSOI: MACRO KEYS(USERID,SYSTEM,INDATA,INDATALEN,INDATAKEY,        00232800
*                 OUTDATA,OUTDATALEN,OUTDATAKEY,RTNCODE,RSNCODE,        00232900
*                 PLISTVER,MF);                                         00233000
*  ANS('?'||MACLABEL||' '||'IXZPTSOI '||MACLIST||                       00233100
*         ' '||MACKEYS||';') COL(MACLMAR);                              00233200
*%END IXZXTSOI;                                                         00233300
