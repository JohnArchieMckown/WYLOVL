*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXZXIXCN                              -93/08/16-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  JES3 connect processing                       * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1993, 1996                     * 00001300
*                                                                     * 00001400
* STATUS= HBB6601                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      Purpose:  The IXZXIXCN is issued during JES3 connect           * 00002200
*      processing to tell JESXCF when the JES3 connect processing has * 00002300
*      begun and ended.  JESXCF uses this information to determine    * 00002400
*      when messages can begin flowing to other systems.  Before the  * 00002500
*      member is connected, JESXCF will only send those messages with * 00002600
*      the message attribute J3CONNECT or EXPRESS.                    * 00002700
*                                                                     * 00002800
*      IBM use of this interface:  JES3 will use this service to      * 00002900
*      indicate the beginning and end of connect processing so that   * 00003000
*      JESXCF can start sending messages that are not connect         * 00003100
*      messages.                                                      * 00003200
*                                                                     * 00003300
*      Customer use of this interface:  None, this is an internal     * 00003400
*      macro.                                                         * 00003500
*                                                                     * 00003600
*      CDPI Implications:                                             * 00003700
*                                                                     * 00003800
*      This macro is an internal macro and is not part of the general * 00003900
*      use programming interface.                                     * 00004000
*                                                                     * 00004100
*      EEC Implications:  This macro is not an EEC interface.         * 00004200
*                                                                     * 00004300
*      Related Macros:  The following macros are required in order to * 00004400
*      use this macro service:                                        * 00004500
*                                                                     * 00004600
*                                                                     * 00004700
*      o   JES3:                                                      * 00004800
*                                                                     * 00004900
*                                                                     * 00005000
*          -   IATYMOD - must be included in the module and must have * 00005100
*              been invoked before the IXZXIXCN macro service.        * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*                                                                     * 00005700
*      Requirements                                                   * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*      o   Authorization: Authorized                                  * 00006100
*                                                                     * 00006200
*      o   Dispatchable unit mode: Task                               * 00006300
*                                                                     * 00006400
*      o   Cross memory mode: PASN = HASN = SASN                      * 00006500
*                                                                     * 00006600
*      o   AMODE: 31                                                  * 00006700
*                                                                     * 00006800
*      o   ASC mode: Primary                                          * 00006900
*                                                                     * 00007000
*      o   Serialization: Enabled for interrupts                      * 00007100
*                                                                     * 00007200
*      o   Locks:  This service assumes no locks are held by the      * 00007300
*          user.                                                      * 00007400
*                                                                     * 00007500
*      o   Control Parameters:  None                                  * 00007600
*                                                                     * 00007700
*      o   JES Environments:                                          * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*          -   JES3 Main Task                                         * 00008100
*                                                                     * 00008200
*          -   JES3 Subtask                                           * 00008300
*                                                                     * 00008400
*          -   JES3 FSS                                               * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*      Register Information                                           * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*      o   Input registers                                            * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*          -   R0-R15 - Undefined                                     * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*      o   Output registers                                           * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*          -   R0 - Reason code                                       * 00010400
*                                                                     * 00010500
*          -   R1 - Unpredictable                                     * 00010600
*                                                                     * 00010700
*          -   R2-R13 - Unchanged                                     * 00010800
*                                                                     * 00010900
*          -   R14 - Unpredictable                                    * 00011000
*                                                                     * 00011100
*          -   R15 - Return code                                      * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*      Programming Notes/Requirements:  None                          * 00011800
*                                                                     * 00011900
*      Restrictions                                                   * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*      o   Can not be issued until JES initialization has attached    * 00012300
*          and initializes the JES Common XCF Task.                   * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*      Performance Implications:  This macro has minimal performance  * 00012800
*      impact, the service routine causes a subtasked function to be  * 00012900
*      performed.                                                     * 00013000
*                                                                     * 00013100
*01* EXTERNAL CLASSIFICATION:   NONE                                  * 00013200
*                                                                     * 00013300
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00013400
*                                                                     * 00013500
*01* SYNTAX:                                                          * 00013600
*                                                                     * 00013700
*[xlabel]  IXZXIXCN     GROUPTOKEN=xgrouptoken                        * 00013800
*                      ,REQTYPE=BEGIN|END                           * 00013900
*                     [,RESET=YES|NO]                               * 00014000
*                     [,MEMBER=xmember|NONE]                        * 00014100
*                     [,RTNCODE=xrtncode]                             * 00014200
*                     [,RSNCODE=xrsncode]                             * 00014300
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00014400
*                    [,MF=S]                                         * 00014500
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00014600
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*      Where:                                                         * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*      [xlabel]                                                       * 00015300
*          is an optional symbol, starting in column 1, that is the   * 00015400
*          name on the IXZXIXCN macro invocation.  The name must      * 00015500
*          conform to the rules for an ordinary assembler language    * 00015600
*          symbol.                                                    * 00015700
*          DEFAULT: No name.                                          * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*      GROUPTOKEN=xgrouptoken                                         * 00016300
*          is the name (RS-type), or address in register (2)-(12), of * 00016400
*          a required fullword input that contains the JES XCF group  * 00016500
*          token.                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*      REQTYPE=BEGIN|END                                            * 00017100
*          is a required keyword input indicating the type of connect * 00017200
*          request.                                                   * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*          REQTYPE=BEGIN                                              * 00017600
*              Indicates the start of the connect sequence.           * 00017700
*                                                                     * 00017800
*          REQTYPE=END                                                * 00017900
*              Indicates the end of the connect sequence.             * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*      [RESET=YES|NO]                                               * 00018700
*          is an optional keyword input                               * 00018800
*          DEFAULT: YES                                               * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*          RESET=YES                                                  * 00019200
*              Indicates that the connecting member's connect bit in  * 00019300
*              the user state field should be turned off.             * 00019400
*                                                                     * 00019500
*          RESET=NO                                                   * 00019600
*              Indicates that this member's connect bit in the user   * 00019700
*              state field should not be reset.                       * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*      [MEMBER=xmember|NONE]                                        * 00020500
*          is the name (RS-type), or address in register (2)-(12), of * 00020600
*          an optional 16 character input indicating which member the * 00020700
*          caller wishes to connect with.  For JES3, it is the member * 00020800
*          name of the JES3 Global.                                   * 00020900
*          DEFAULT: NONE                                              * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*      [RTNCODE=xrtncode]                                             * 00021500
*          is the name (RS-type) of an optional fullword output       * 00021600
*          variable, or register (2)-(12), into which the return code * 00021700
*          is to be copied from GPR 15.                               * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*      [RSNCODE=xrsncode]                                             * 00022300
*          is the name (RS-type) of an optional fullword output       * 00022400
*          variable, or register (2)-(12), into which the reason code * 00022500
*          is to be copied from GPR 0.                                * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00023100
*          is an optional byte input decimal value in the "1-1" range * 00023200
*          that specifies the macro version.  PLISTVER is the only    * 00023300
*          key allowed on the list form of MF and determines which    * 00023400
*          parameter list is generated.  Note that MAX may be         * 00023500
*          specified instead of a number, and the parameter list will * 00023600
*          be of the largest size currently supported. This size may  * 00023700
*          grow from release to release (thus possibly affecting the  * 00023800
*          amount of storage needed by your program).  If your        * 00023900
*          program can tolerate this, IBM recommends that you always  * 00024000
*          specify MAX when creating the list form parameter list as  * 00024100
*          that will ensure that the list form parameter list is      * 00024200
*          always long enough to hold whatever parameters might be    * 00024300
*          specified on the execute form.                             * 00024400
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00024500
*          default is the lowest version which allows all of the      * 00024600
*          parameters specified on the invocation to be processed.    * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*      [MF=S|L|E]                                                   * 00025200
*          is an optional keyword input which specifies the macro     * 00025300
*          form.                                                      * 00025400
*          DEFAULT: S                                                 * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*          [MF=S]                                                     * 00025800
*              specifies the standard form of the macro.  The "S"     * 00025900
*              form generates code to put the parameters into an      * 00026000
*              in-line parameter list and invoke the desired service. * 00026100
*              Full checking for required macro keys is done along    * 00026200
*              with supplying defaults for omitted optional           * 00026300
*              parameters.                                            * 00026400
*                                                                     * 00026500
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00026600
*              specifies the list form of the macro.  The "L" form    * 00026700
*              defines an area to be used for the parameter list.     * 00026800
*              Only the PLISTVER key may be specified on the          * 00026900
*              invocation.  All other macro parameters are flagged as * 00027000
*              errors.  If PLISTVER is not specified, the original    * 00027100
*              parameter list definition is used.                     * 00027200
*                                                                     * 00027300
*            ,xmfctrl                                                 * 00027400
*              is a required input.  It is the name of a storage area * 00027500
*              for the parameter list.                                * 00027600
*                                                                     * 00027700
*            ,xmfattr|0D                                            * 00027800
*              is an optional 60 character input string that varies   * 00027900
*              from 1 to 60 characters. It can contain any value that * 00028000
*              is valid on an assembler DS pseudo-op. You can use     * 00028100
*              this parameter to force boundary alignment of the      * 00028200
*              parameter list.                                        * 00028300
*              DEFAULT: 0D which forces the parameter list to a       * 00028400
*              doubleword boundary.                                   * 00028500
*                                                                     * 00028600
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00028700
*              specifies the execute form of the macro.  The "E" form * 00028800
*              generates code to put the parameters into the          * 00028900
*              parameter list specified by xmfctrl and provides full  * 00029000
*              syntax checking with default setting.                  * 00029100
*                                                                     * 00029200
*            ,xmfctrl                                                 * 00029300
*              is a required input.  It is the name (RS-type), or     * 00029400
*              address in register (1)-(12), of a storage area for    * 00029500
*              the parameter list.                                    * 00029600
*                                                                     * 00029700
*            ,COMPLETE                                              * 00029800
*              is an optional keyword input which specifies the       * 00029900
*              degree of macro parameter syntax checking.             * 00030000
*              DEFAULT: COMPLETE                                      * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*              COMPLETE                                               * 00030400
*                  Checking for required macro keys is done and       * 00030500
*                  defaults are supplied for omitted optional         * 00030600
*                  parameters.                                        * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*01* RETURN CODES:                                                    * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*            0    Processing successful.                              * 00031800
*                                                                     * 00031900
*            4    Processing did not complete do to user error.       * 00032000
*                                                                     * 00032100
*            8    Processing did not complete due to system error.    * 00032200
*                                                                     * 00032300
*            C    Processing did not complete due to a system abend.  * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*01* REASON CODES:                                                    * 00032800
*                                                                     * 00032900
*       REASON    RETURN                                              * 00033000
*       CODE      CODE      DESCRIPTION                               * 00033100
*                                          * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*              0  0         Processing was sucessful.                 * 00033500
*                                                                     * 00033600
*              4  4         Processing failed because, the  parameter * 00033700
*                           list    passed      to  IXZXIXCN  service * 00033800
*                           routine does not have a valid eyecatcher  * 00033900
*                                                                     * 00034000
*              8  4         Processing  failed because, the parameter * 00034100
*                           list   passed  to  the  IXZXIXCN  service * 00034200
*                           routine had an invalid version indicator. * 00034300
*                           The caller may need to be recompiled.     * 00034400
*                                                                     * 00034500
*              C  4         Processing failed because, the grouptoken * 00034600
*                           passed  to  the  IXZXIXCN service routine * 00034700
*                           was not valid.                            * 00034800
*                                                                     * 00034900
*             10  4         Processing   failed  because,the  IXZIXCN * 00035000
*                           service  routine  was  called on a member * 00035100
*                           that is detaching.                        * 00035200
*                                                                     * 00035300
*             14  4         Processing   failed  because,the  MEMBER= * 00035400
*                           keyword   was   not   specified   on  the * 00035500
*                           REQTYPE=BEGIN request.                    * 00035600
*                                                                     * 00035700
*             18  4         Processing   failed  because,the  MEMBER= * 00035800
*                           member was IPLed before the request could * 00035900
*                           complete.                                 * 00036000
*                                                                     * 00036100
*              0  C         Processing  failed due to a system abend. * 00036200
*                           The request is rejected.                  * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00036700
*                                                                     * 00036800
*02*   PROCESSOR:  ASSEM                                              * 00036900
*                                                                     * 00037000
*01* COMPONENT:  SCJSC                                                * 00037100
*                                                                     * 00037200
*01* MACRO USAGE NOTES:                                               * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00037600
*        global macro variable.  Any value other than 'NO' will       * 00037700
*        result in the macro expansion being printed.  The default is * 00037800
*        'YES'.  The following examples illustrate how the ZPRINT     * 00037900
*        variable should be set.                                      * 00038000
*                                                                     * 00038100
*                    GBLC &ZPRINT                                     * 00038200
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*    2.  All   keys   currently   contained  in  the  IXZXIXCN  macro * 00038600
*        correspond  to  version  1.   If you specify PLISTVER, use a * 00038700
*        value of 1 or MAX.                                           * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*01* CHANGE ACTIVITY:                                                 * 00039300
*                                                                     * 00039400
*   Flag LineItem  FMID    Date   ID    Comment                       * 00039500
*                                                                     * 00039600
*    $N0=JESXCF   HBB5510 921201 PD0AL:                               * 00039700
****** END OF SPECIFICATIONS *****************************************/ 00039800
*/********************************************************************* 00039900
         MACRO                                                          00040000
&XLABEL  IXZXIXCN &GROUPTOKEN=,&REQTYPE=,&RESET=,&MEMBER=,&RTNCODE=,   *00040100
               &RSNCODE=,&PLISTVER=,&MF=                                00040200
.*                                                                      00040300
*                MACDATE -93/08/16-<1>                                  00040400
.*                                                                      00040500
.*******************************************************************    00040600
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00040700
.*******************************************************************    00040800
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00040900
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00041000
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00041100
.*                                                                      00041200
                GBLC  &ZIXZXIXCN  YES=MACRO USED AT LEAST ONCE          00041300
.*******************************************************************    00041400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00041500
.*******************************************************************    00041600
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00041700
                LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS          00041800
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00041900
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00042000
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00042100
                LCLA  &ZAWRK      USED AS A WORK AREA                   00042200
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00042300
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00042400
                LCLC  &ZC         CHARACTER WORK VARIABLE               00042500
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00042600
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00042700
                LCLA  &ZMACRET    MACRO RETURN CODE                     00042800
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00042900
.*                                                                      00043000
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00043100
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00043200
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00043300
                LCLC  &ZENDBASEPL               End of base PL          00043400
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00043500
.*******************************************************************    00043600
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00043700
.*******************************************************************    00043800
                LCLA  &ZI         INDEX FOR ARRAY                       00043900
                LCLA  &ZJ         INDEX FOR PARMS                       00044000
                LCLA  &ZK         INDEX FOR PARSE                       00044100
                LCLA  &ZLO        LOW RANGE VALUE                       00044200
                LCLA  &ZHI        HIGH RANGE VALUE                      00044300
                LCLC  &ZW         WORK AREA FOR PARM                    00044400
.*******************************************************************    00044500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00044600
.*******************************************************************    00044700
                LCLC  &XGROUPTOKEN              ++ NAME                 00044800
                LCLC  &XREQTYPE   ++ VALUE                              00044900
                LCLC  &XRESET     ++ VALUE                              00045000
                LCLC  &XMEMBER    ++ NAME                               00045100
                LCLC  &XRTNCODE   ++ NAME                               00045200
                LCLC  &XRSNCODE   ++ NAME                               00045300
                LCLA  &XPLISTVER  ++ VALUE                              00045400
                LCLC  &XMF        ++ VALUE                              00045500
                LCLC  &XMFCTRL    ++ NAME                               00045600
                LCLC  &XMFATTR    ++ VALUE                              00045700
                LCLC  &XMFSCK     ++ VALUE                              00045800
.*******************************************************************    00045900
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00046000
.*******************************************************************    00046100
                LCLC  &ZXGROUPTOKEN             ++ INPUT NAME           00046200
                LCLC  &ZXREQTYPE  ++ INPUT VALUE                        00046300
                LCLC  &ZXRESET    ++ INPUT VALUE                        00046400
                LCLC  &ZXMEMBER   ++ INPUT NAME                         00046500
                LCLC  &ZXRTNCODE  ++ OUTPUT NAME                        00046600
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00046700
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00046800
                LCLC  &ZXMF       ++ INPUT VALUE                        00046900
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00047000
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00047100
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00047200
.********************************************************************   00047300
.***AC.PLV01  PROCESS PLISTVER                                      *   00047400
.********************************************************************   00047500
&XPLISTVER      SETA  1                                                 00047600
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00047700
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00047800
&XPLISTVER      SETA  1                                                 00047900
.ZPLV0          ANOP  ,                                                 00048000
.*                                                                      00048100
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00048200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00048300
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00048400
.*-------------------------------------------------------------------   00048500
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00048600
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00048700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00048800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00048900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00049000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00049100
                AGO   .ZPVCK2                                           00049200
.ZPVCK3         ANOP  ,                                                 00049300
.*-------------------------------------------------------------------   00049400
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00049500
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00049600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00049700
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00049800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00049900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00050000
                AGO   .ZPVCKE                                           00050100
.ZPVCK2         ANOP  ,                                                 00050200
.*-------------------------------------------------------------------   00050300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00050400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00050500
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00050600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00050700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00050800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00050900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00051000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00051100
                AGO   .ZPVCK5                                           00051200
.ZPVCK4         ANOP  ,                                                 00051300
&XPLISTVER      SETA  &PLISTVER(1)                                      00051400
.ZPVCK5         ANOP  ,                                                 00051500
.*-------------------------------------------------------------------   00051600
&ZCVAL          SETC  '&PLISTVER(1)'                                    00051700
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00051800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00051900
                AIF   (&XPLISTVER LT 1).ZPVCK6  TOO LOW                 00052000
                AIF   (&XPLISTVER LE 1).ZPVCKE  NOT HIGH                00052100
.ZPVCK6         ANOP   ,                                                00052200
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00052300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00052400
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00052500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00052600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00052700
.ZPVCKE         ANOP   ,                                                00052800
.********************************************************************   00052900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00053000
.********************************************************************   00053100
                ACTR  10000                                             00053200
.*------------------------------------------------------------------    00053300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053400
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00053500
.*-------------------------------------------------------------------   00053600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053700
.ZG28           ANOP  ,                                                 00053800
&ZTLC           SETC 'S'                                                00053900
                AIF   ('&MF(1)' NE '&ZTLC').ZG29                        00054000
&XMF            SETC  'S'         SET KEYWORD                           00054100
                AIF   (N'&MF LE 1).ZG28A        CK NUM                  00054200
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00054300
&ZMS            SETC  '&ZMS.&MF"'                                       00054400
&ZMS            SETC  '&ZMS "MF"'                                       00054500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00054600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00054700
.ZG28A          ANOP  ,                                                 00054800
.*-------------------------------------------------------------------   00054900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00055000
.ZG29           ANOP  ,                                                 00055100
&ZTLC           SETC 'L'                                                00055200
                AIF   ('&MF(1)' NE '&ZTLC').ZG36                        00055300
&XMF            SETC  'L'         SET KEYWORD                           00055400
                AIF   (N'&MF LE 3).ZG29A        CK NUM                  00055500
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00055600
&ZMS            SETC  '&ZMS.&MF"'                                       00055700
&ZMS            SETC  '&ZMS "MF"'                                       00055800
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00055900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00056000
.ZG29A          ANOP  ,                                                 00056100
.*-------------------------------------------------------------------   00056200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00056300
                AIF   (N'&SYSLIST NE 0).ZG29B   POSITIONALS?            00056400
                AIF   ('&GROUPTOKEN' NE '').ZG29B  KEYS?                00056500
                AIF   ('&REQTYPE' NE '').ZG29B  KEYS?                   00056600
                AIF   ('&RESET' NE '').ZG29B    KEYS?                   00056700
                AIF   ('&MEMBER' NE '').ZG29B   KEYS?                   00056800
                AIF   ('&RTNCODE' NE '').ZG29B  KEYS?                   00056900
                AIF   ('&RSNCODE' NE '').ZG29B  KEYS?                   00057000
                AGO    .ZG29C     INVOCATION OKAY                       00057100
.ZG29B          ANOP  ,                                                 00057200
&ZMS            SETC  'THE "L" FORM OF "MF"'    *MFLA* MNOTE            00057300
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00057400
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00057500
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00057600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00057700
.ZG29C          ANOP  ,                                                 00057800
.*-------------------------------------------------------------------   00057900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00058000
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00058100
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00058200
                AIF   (N'&MF(2) GT 1).ZG31B     MULTI PARMS             00058300
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00058400
.ZG31B          AIF   (K'&MF(2) GT 0).ZG31C                             00058500
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00058600
&ZMS            SETC  'WHEN "L" IS SPECIFIED'   *KRQDA*                 00058700
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00058800
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00058900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00059000
.ZG31C          ANOP  ,                                                 00059100
.*-------------------------------------------------------------------   00059200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00059300
                AIF   (K'&ZXMFCTRL LE 0).ZG31P  NOT I/O                 00059400
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG31P                    00059500
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00059600
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00059700
&ZMS            SETC  '&ZMS.&MF"'                                       00059800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00059900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00060000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00060100
.ZG31P          ANOP  ,                                                 00060200
.*-------------------------------------------------------------------   00060300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00060400
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00060500
&XMFATTR        SETC  '0D'                                              00060600
                AIF   (K'&MF(3) LE 0).ZG34B     PARM                    00060700
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00060800
                AIF   (N'&MF(3) GT 1).ZG34B     MULTI PARMS             00060900
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00061000
.ZG34B          ANOP  ,                                                 00061100
.*-------------------------------------------------------------------   00061200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00061300
                AIF   (K'&ZXMFATTR LE 0).ZG34P  NOT I/O                 00061400
                AIF   ('&XMFATTR'(1,1) NE '(').ZG34P                    00061500
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00061600
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00061700
&ZMS            SETC  '&ZMS.&MF"'                                       00061800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00061900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00062000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00062100
.ZG34P          ANOP  ,                                                 00062200
.*-------------------------------------------------------------------   00062300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00062400
                AIF   (K'&ZXMFATTR LE 0).ZG34S  NOT I/O                 00062500
                AIF   (K'&XMFATTR LE 60).ZG34S  LNG OK                  00062600
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00062700
&ZMS            SETC  '"MF='      *KLNGA* MNOTE                         00062800
&ZMS            SETC  '&ZMS.&MF"'                                       00062900
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00063000
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00063100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00063200
.ZG34S          ANOP  ,                                                 00063300
.*-------------------------------------------------------------------   00063400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00063500
.ZG36           ANOP  ,                                                 00063600
&ZTLC           SETC 'E'                                                00063700
                AIF   ('&MF(1)' NE '&ZTLC').ZG44                        00063800
&XMF            SETC  'E'         SET KEYWORD                           00063900
                AIF   (N'&MF LE 3).ZG36A        CK NUM                  00064000
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00064100
&ZMS            SETC  '&ZMS.&MF"'                                       00064200
&ZMS            SETC  '&ZMS "MF"'                                       00064300
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00064400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00064500
.ZG36A          ANOP  ,                                                 00064600
.*-------------------------------------------------------------------   00064700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00064800
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00064900
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00065000
                AIF   (N'&MF(2) GT 1).ZG38B     MULTI PARMS             00065100
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00065200
.ZG38B          AIF   (K'&MF(2) GT 0).ZG38C                             00065300
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00065400
&ZMS            SETC  'WHEN "E" IS SPECIFIED'   *KRQDA*                 00065500
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00065600
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00065700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00065800
.ZG38C          ANOP  ,                                                 00065900
.*-------------------------------------------------------------------   00066000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00066100
                AIF   (K'&ZXMFCTRL LE 0).ZG38R  NOT I/O                 00066200
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG38R                    00066300
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00066400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                      00066500
                AIF   (K'&ZCGPR GT 2).ZG38Q                             00066600
                AIF   ('&ZCGPR' EQ '0').ZG38Q                           00066700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00066800
                AIF   (T'&ZCGPR NE 'N').ZG38Q   INVALID REG NAME        00066900
.ZG38P          ANOP  ,                                                 00067000
                AIF   (T'&ZCGPR NE 'N').ZG38R   NON NUMERIC             00067100
                AIF   ('&ZCGPR' LT '1').ZG38Q                           00067200
                AIF   ('&ZCGPR' LE '12').ZG38R                          00067300
.ZG38Q          ANOP  ,                                                 00067400
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00067500
&ZMS            SETC  '&ZMS.&MF"'                                       00067600
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00067700
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00067800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00067900
.ZG38R          ANOP  ,                                                 00068000
.*-------------------------------------------------------------------   00068100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00068200
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00068300
.ZG42A   AIF   ('&MF(3)' NE 'COMPLETE').ZG43A                           00068400
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00068500
.*-------------------------------------------------------------------   00068600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00068700
.ZG43A          AIF   (K'&XMFSCK GT 0).ZG43C    KEYWORD                 00068800
                AIF   (K'&MF(3) LE 0).ZG43B                             00068900
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00069000
&ZMS            SETC  '&ZMS.&MF"'                                       00069100
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00069200
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00069300
&ZMS            SETC  '&ZMS "COMPLETE".'        VALID KEYWORD           00069400
                MNOTE 8,' &ZMS '                                        00069500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00069600
.ZG43B          ANOP  ,                                                 00069700
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00069800
.ZG43C          ANOP  ,                                                 00069900
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00070000
.*------------------------------------------------------------------    00070100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00070200
.ZG44           ANOP  ,                                                 00070300
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00070400
                AIF   (K'&XMF GT 0).ZG44E       VALID ARG               00070500
                AIF   (T'&MF EQ 'O').ZG44D      OMITTED                 00070600
&ZASYSLNDX      SETA  0                                                 00070700
.ZG44A          ANOP  ,           POSITIONAL MACRO KEY                  00070800
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00070900
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG44C                  00071000
&ZTLC           SETC 'MF'                                               00071100
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG44A         00071200
.ZG44B          ANOP  ,                                                 00071300
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00071400
&ZMS            SETC  'THE "MF" KEY'            *KOPTA* MNOTE           00071500
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00071600
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00071700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00071800
                AGO   .ZG44E                                            00071900
.ZG44C          ANOP  ,                                                 00072000
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00072100
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00072200
&ZMS            SETC  '&ZMS.&MF"'                                       00072300
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00072400
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00072500
&ZMS            SETC  '&ZMS "S",'               VALID KEYWORD           00072600
&ZMS            SETC  '&ZMS "L",'               VALID KEYWORD           00072700
&ZMS            SETC  '&ZMS OR "E".'            VALID KEYWORD           00072800
                MNOTE 8,' &ZMS '                                        00072900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00073000
                AGO   .ZG44E                                            00073100
.ZG44D          ANOP  ,                                                 00073200
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00073300
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00073400
.ZG44E          ANOP  ,                                                 00073500
.********************************************************************   00073600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00073700
.********************************************************************   00073800
                ACTR  10000                                             00073900
.*-------------------------------------------------------------------   00074000
.***AG.MF03 MF=(SLE)                                                    00074100
                AIF   ('&XMF' EQ 'L').ZGMFX                             00074200
.*----------------------------------------------------------------***   00074300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00074400
                AIF   (N'&GROUPTOKEN LE 1).ZG2A  CK NUM                 00074500
&ZMS            SETC  '"GROUPTOKEN='            *KPOSA* MNOTE           00074600
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00074700
&ZMS            SETC  '&ZMS "GROUPTOKEN"'                               00074800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00074900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00075000
.ZG2A           ANOP  ,                                                 00075100
.*-------------------------------------------------------------------   00075200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00075300
&ZXGROUPTOKEN   SETC  'INPUT'     SET IN/OUTPUT                         00075400
&XGROUPTOKEN    SETC  '&GROUPTOKEN(1)'          SET XVARIABLE           00075500
                AIF   (N'&GROUPTOKEN GT 1).ZG2B  MULTI PARMS            00075600
&XGROUPTOKEN    SETC  '&GROUPTOKEN'             SET XVARIABLE           00075700
.ZG2B           AIF   (K'&GROUPTOKEN(1) GT 0).ZG2C                      00075800
&ZXGROUPTOKEN   SETC  ''          RESET IN/OUTPUT                       00075900
&ZMS            SETC  ' '         *KRQDA*                               00076000
&ZMS            SETC  '&ZMS "GROUPTOKEN" KEY AND ITS ARGUMENT'          00076100
                MNOTE 8,' &ZMS ARE REQUIRED.'                           00076200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00076300
.ZG2C           ANOP  ,                                                 00076400
.*-------------------------------------------------------------------   00076500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00076600
                AIF   (K'&ZXGROUPTOKEN LE 0).ZG2R  NOT I/O              00076700
                AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZG2R                 00076800
&ZCGPR          SETC  '&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2)                00076900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                       00077000
                AIF   (K'&ZCGPR GT 2).ZG2Q                              00077100
                AIF   ('&ZCGPR' EQ '0').ZG2Q                            00077200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00077300
                AIF   (T'&ZCGPR NE 'N').ZG2Q    INVALID REG NAME        00077400
.ZG2P           ANOP  ,                                                 00077500
                AIF   (T'&ZCGPR NE 'N').ZG2R    NON NUMERIC             00077600
                AIF   ('&ZCGPR' LT '2').ZG2Q                            00077700
                AIF   ('&ZCGPR' LE '12').ZG2R                           00077800
.ZG2Q           ANOP  ,                                                 00077900
&ZMS            SETC  '"GROUPTOKEN='            *KGPRA* MNOTE           00078000
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00078100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00078200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00078300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00078400
.ZG2R           ANOP  ,                                                 00078500
.*----------------------------------------------------------------***   00078600
.***AG.KKWRD01 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00078700
                AIF   (N'&REQTYPE LE 1).ZG5A    CK NUM                  00078800
&ZMS            SETC  '"REQTYPE='               *KPOSA* MNOTE           00078900
&ZMS            SETC  '&ZMS.&REQTYPE"'                                  00079000
&ZMS            SETC  '&ZMS "REQTYPE"'                                  00079100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00079200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00079300
.ZG5A           ANOP  ,                                                 00079400
.*-------------------------------------------------------------------   00079500
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00079600
&XREQTYPE       SETC  ''          INITIALIZE XVARIABLE                  00079700
.ZG6A   AIF   ('&REQTYPE(1)' NE 'BEGIN').ZG7A                           00079800
&XREQTYPE       SETC  'BEGIN'     SET KEYWORD                           00079900
.*-------------------------------------------------------------------   00080000
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00080100
.ZG7A   AIF   ('&REQTYPE(1)' NE 'END').ZG8A                             00080200
&XREQTYPE       SETC  'END'       SET KEYWORD                           00080300
.*-------------------------------------------------------------------   00080400
.***AG.KKWRD03 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00080500
.ZG8A           AIF   (K'&XREQTYPE GT 0).ZG8C   KEYWORD                 00080600
                AIF   (K'&REQTYPE(1) LE 0).ZG8B                         00080700
&ZMS            SETC  '"REQTYPE='               *KUKWA* MNOTE           00080800
&ZMS            SETC  '&ZMS.&REQTYPE"'                                  00080900
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00081000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00081100
&ZMS            SETC  '&ZMS "BEGIN"'            VALID KEYWORD           00081200
&ZMS            SETC  '&ZMS OR "END".'          VALID KEYWORD           00081300
                MNOTE 8,' &ZMS '                                        00081400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00081500
.ZG8B           ANOP  ,                                                 00081600
&XREQTYPE       SETC  'BEGIN'     SET DEFAULT KEYWORD                   00081700
.ZG8C           ANOP  ,                                                 00081800
&ZXREQTYPE      SETC  'INPUT'     SET IN/OUTPUT                         00081900
.*-------------------------------------------------------------------   00082000
.***AG.KKWRD04 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00082100
                AIF   (K'&REQTYPE(1) GT 0).ZG8D  VALID                  00082200
&ZXREQTYPE      SETC  ''          RESET IN/OUTPUT                       00082300
&ZMS            SETC  'THE'                                             00082400
&ZMS            SETC  '&ZMS "REQTYPE" KEY AND ITS ARGUMENT'             00082500
&ZMS            SETC  '&ZMS ARE REQUIRED.'                              00082600
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00082700
&ZMS            SETC  '&ZMS "BEGIN"'            VALID KEYWORD           00082800
&ZMS            SETC  '&ZMS OR "END".'          VALID KEYWORD           00082900
                MNOTE 8,' &ZMS '                                        00083000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00083100
.ZG8D           ANOP  ,                                                 00083200
.*----------------------------------------------------------------***   00083300
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00083400
                AIF   (N'&RESET LE 1).ZG10A     CK NUM                  00083500
&ZMS            SETC  '"RESET='   *KPOSA* MNOTE                         00083600
&ZMS            SETC  '&ZMS.&RESET"'                                    00083700
&ZMS            SETC  '&ZMS "RESET"'                                    00083800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00083900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00084000
.ZG10A          ANOP  ,                                                 00084100
.*-------------------------------------------------------------------   00084200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00084300
&XRESET         SETC  ''          INITIALIZE XVARIABLE                  00084400
.ZG11A   AIF   ('&RESET(1)' NE 'YES').ZG12A                             00084500
&XRESET         SETC  'YES'       SET KEYWORD                           00084600
.*-------------------------------------------------------------------   00084700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00084800
.ZG12A   AIF   ('&RESET(1)' NE 'NO').ZG13A                              00084900
&XRESET         SETC  'NO'        SET KEYWORD                           00085000
.*-------------------------------------------------------------------   00085100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00085200
.ZG13A          AIF   (K'&XRESET GT 0).ZG13C    KEYWORD                 00085300
                AIF   (K'&RESET(1) LE 0).ZG13B                          00085400
&ZMS            SETC  '"RESET='   *KUKWA* MNOTE                         00085500
&ZMS            SETC  '&ZMS.&RESET"'                                    00085600
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00085700
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00085800
&ZMS            SETC  '&ZMS "YES"'              VALID KEYWORD           00085900
&ZMS            SETC  '&ZMS OR "NO".'           VALID KEYWORD           00086000
                MNOTE 8,' &ZMS '                                        00086100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00086200
.ZG13B          ANOP  ,                                                 00086300
&XRESET         SETC  'YES'       SET DEFAULT KEYWORD                   00086400
.ZG13C          ANOP  ,                                                 00086500
&ZXRESET        SETC  'INPUT'     SET IN/OUTPUT                         00086600
.*----------------------------------------------------------------***   00086700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00086800
                AIF   (N'&MEMBER LE 1).ZG15A    CK NUM                  00086900
&ZMS            SETC  '"MEMBER='  *KPOSA* MNOTE                         00087000
&ZMS            SETC  '&ZMS.&MEMBER"'                                   00087100
&ZMS            SETC  '&ZMS "MEMBER"'                                   00087200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00087300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00087400
.ZG15A          ANOP  ,                                                 00087500
.*-------------------------------------------------------------------   00087600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00087700
&ZXMEMBER       SETC  'INPUT'     SET IN/OUTPUT                         00087800
&XMEMBER        SETC  'NONE'                                            00087900
                AIF   (K'&MEMBER(1) LE 0).ZG15B  PARM                   00088000
&XMEMBER        SETC  '&MEMBER(1)'              SET XVARIABLE           00088100
                AIF   (N'&MEMBER GT 1).ZG15B    MULTI PARMS             00088200
&XMEMBER        SETC  '&MEMBER'   SET XVARIABLE                         00088300
.ZG15B          ANOP  ,                                                 00088400
.*-------------------------------------------------------------------   00088500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00088600
                AIF   (K'&ZXMEMBER LE 0).ZG15R  NOT I/O                 00088700
                AIF   ('&XMEMBER' EQ 'NONE').ZG15R                      00088800
                AIF   ('&XMEMBER'(1,1) NE '(').ZG15R                    00088900
&ZCGPR          SETC  '&XMEMBER'(2,K'&XMEMBER-2)                        00089000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                      00089100
                AIF   (K'&ZCGPR GT 2).ZG15Q                             00089200
                AIF   ('&ZCGPR' EQ '0').ZG15Q                           00089300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00089400
                AIF   (T'&ZCGPR NE 'N').ZG15Q   INVALID REG NAME        00089500
.ZG15P          ANOP  ,                                                 00089600
                AIF   (T'&ZCGPR NE 'N').ZG15R   NON NUMERIC             00089700
                AIF   ('&ZCGPR' LT '2').ZG15Q                           00089800
                AIF   ('&ZCGPR' LE '12').ZG15R                          00089900
.ZG15Q          ANOP  ,                                                 00090000
&ZMS            SETC  '"MEMBER='  *KGPRA* MNOTE                         00090100
&ZMS            SETC  '&ZMS.&MEMBER"'                                   00090200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00090300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00090400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00090500
.ZG15R          ANOP  ,                                                 00090600
.*----------------------------------------------------------------***   00090700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00090800
                AIF   (N'&RTNCODE LE 1).ZG18A   CK NUM                  00090900
&ZMS            SETC  '"RTNCODE='               *KPOSA* MNOTE           00091000
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00091100
&ZMS            SETC  '&ZMS "RTNCODE"'                                  00091200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00091300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00091400
.ZG18A          ANOP  ,                                                 00091500
.*-------------------------------------------------------------------   00091600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00091700
                AIF   (K'&RTNCODE(1) LE 0).ZG18C  NO PARM               00091800
&ZXRTNCODE      SETC  'OUTPUT'    SET OUTPUT                            00091900
&XRTNCODE       SETC  '&RTNCODE(1)'             SET XVARIABLE           00092000
                AIF   (N'&RTNCODE GT 1).ZG18C                           00092100
&XRTNCODE       SETC  '&RTNCODE'  SET XVARIABLE                         00092200
.ZG18C          ANOP  ,                                                 00092300
.*-------------------------------------------------------------------   00092400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00092500
                AIF   (K'&ZXRTNCODE LE 0).ZG18R  NOT I/O                00092600
                AIF   ('&XRTNCODE'(1,1) NE '(').ZG18R                   00092700
&ZCGPR          SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                      00092800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                      00092900
                AIF   (K'&ZCGPR GT 2).ZG18Q                             00093000
                AIF   ('&ZCGPR' EQ '0').ZG18Q                           00093100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00093200
                AIF   (T'&ZCGPR NE 'N').ZG18Q   INVALID REG NAME        00093300
.ZG18P          ANOP  ,                                                 00093400
                AIF   (T'&ZCGPR NE 'N').ZG18R   NON NUMERIC             00093500
                AIF   ('&ZCGPR' LT '2').ZG18Q                           00093600
                AIF   ('&ZCGPR' LE '12').ZG18R                          00093700
.ZG18Q          ANOP  ,                                                 00093800
&ZMS            SETC  '"RTNCODE='               *KGPRA* MNOTE           00093900
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00094000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00094100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00094200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00094300
.ZG18R          ANOP  ,                                                 00094400
.*----------------------------------------------------------------***   00094500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00094600
                AIF   (N'&RSNCODE LE 1).ZG21A   CK NUM                  00094700
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           00094800
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00094900
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00095000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00095100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00095200
.ZG21A          ANOP  ,                                                 00095300
.*-------------------------------------------------------------------   00095400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00095500
                AIF   (K'&RSNCODE(1) LE 0).ZG21C  NO PARM               00095600
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00095700
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00095800
                AIF   (N'&RSNCODE GT 1).ZG21C                           00095900
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00096000
.ZG21C          ANOP  ,                                                 00096100
.*-------------------------------------------------------------------   00096200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00096300
                AIF   (K'&ZXRSNCODE LE 0).ZG21R  NOT I/O                00096400
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG21R                   00096500
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00096600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                      00096700
                AIF   (K'&ZCGPR GT 2).ZG21Q                             00096800
                AIF   ('&ZCGPR' EQ '0').ZG21Q                           00096900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00097000
                AIF   (T'&ZCGPR NE 'N').ZG21Q   INVALID REG NAME        00097100
.ZG21P          ANOP  ,                                                 00097200
                AIF   (T'&ZCGPR NE 'N').ZG21R   NON NUMERIC             00097300
                AIF   ('&ZCGPR' LT '2').ZG21Q                           00097400
                AIF   ('&ZCGPR' LE '12').ZG21R                          00097500
.ZG21Q          ANOP  ,                                                 00097600
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           00097700
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00097800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00097900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00098000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00098100
.ZG21R          ANOP  ,                                                 00098200
.******************************************************************     00098300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00098400
.******************************************************************     00098500
                ACTR  10000                                             00098600
.*----------------------------------------------------------------***   00098700
.***AH.P02 EXTRA POSITIONALS                                            00098800
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00098900
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00099000
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00099100
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00099200
.ZGLISTX1       ANOP  ,                                                 00099300
&ZCVAL          SETC  ''          ERROR FIELD                           00099400
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00099500
.ZGLIST2        ANOP  ,                                                 00099600
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00099700
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00099800
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00099900
                AGO   .ZGLIST2                                          00100000
.*                                                                      00100100
.ZGLIST3        ANOP  ,                                                 00100200
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00100300
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          00100400
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00100500
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00100600
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00100700
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00100800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00100900
.ZGLISTX        ANOP  ,                                                 00101000
&ZASYSLNDX      SETA  0                                                 00101100
.*-------------------------------------------------------------------   00101200
.***AG.MF04 MF=(SLE)                                                    00101300
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00101400
.*******************************************************************    00101500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00101600
.*******************************************************************    00101700
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00101800
.*******************************************************************    00101900
.***AE.01  START OF IXZXIXCN MACRO CODE                                 00102000
.*******************************************************************    00102100
                LCLC  &M0M0001                 NAME                     00102200
&M0M0001        SETC  '&XLABEL'                SET NAME                 00102300
                AIF   (K'&XLABEL NE 0).XLAB2                            00102400
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00102500
.*                                                                      00102600
.XLAB2          ANOP  ,                                                 00102700
&M0M0001 DS    0H                             IXZXIXCN-1                00102800
.*******************************************************************    00102900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00103000
.*******************************************************************    00103100
              PUSH  PRINT                                               00103200
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00103300
                PRINT OFF         ++ PR01                               00103400
                AGO   .ZPRNTXX                                          00103500
.ZPRINTX        PRINT ON                                                00103600
.ZPRNTXX        ANOP  ,                                                 00103700
.********************************************************************   00103800
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00103900
.********************************************************************   00104000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00104100
                      LCLA  &ZOPN1         INVOCATION INDEX             00104200
                      LCLC  &ZOPL(4095)    LABEL                        00104300
                      LCLC  &ZOPO(4095)    OPERATION                    00104400
                      LCLC  &ZOPV(4095)    VALUE                        00104500
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00104600
.*                                                                      00104700
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00104800
.******************************************************************     00104900
.***AL.L10 IXZXIXCN FMT=LIST MF=S|L PARAMETERS                          00105000
.******************************************************************     00105100
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00105200
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00105300
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00105400
&XMFATTR              SETC  '0D'                                        00105500
.*                                                                      00105600
&ZOPN                 SETA  &ZOPN+1                                     00105700
&ZOPL(&ZOPN)          SETC  ' '                                         00105800
&ZOPO(&ZOPN)          SETC  'B'                                         00105900
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00106000
&ZOPD(&ZOPN)          SETC  '++ IXZXIXCN ARG PARMS'                     00106100
.*                                                                      00106200
&ZOPN                 SETA  &ZOPN+1                                     00106300
&ZOPL(&ZOPN)          SETC  ' '                                         00106400
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00106500
&ZOPV(&ZOPN)          SETC  '1'                                         00106600
&ZOPD(&ZOPN)          SETC  ' '                                         00106700
.*                                                                      00106800
.ZLMFSL2              ANOP  ,                                           00106900
.*-------------------------------------------------------------------   00107000
.***AM.L01  IXZXIXCN FMT=LIST PARAMETERS                                00107100
&ZOPN                 SETA &ZOPN+1                                      00107200
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00107300
&ZOPO(&ZOPN)          SETC 'DS'                                         00107400
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00107500
&ZOPD(&ZOPN)          SETC '++ IXZXIXCN PARM LIST'                      00107600
.*-------------------------------------------------------------------   00107700
.***AM.L02 XVERSION XL1                                                 00107800
&ZOPN                 SETA &ZOPN+1                                      00107900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00108000
&ZOPO(&ZOPN)          SETC 'DS'                                         00108100
&ZOPV(&ZOPN)          SETC 'XL1'                                        00108200
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00108300
.*-------------------------------------------------------------------   00108400
.***AM.L09  XEYECATCH CL6                                               00108500
&ZOPN                 SETA &ZOPN+1                                      00108600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYECATCH'                        00108700
&ZOPO(&ZOPN)          SETC 'DS'                                         00108800
&ZOPV(&ZOPN)          SETC 'CL6'                                        00108900
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XEYECATCH'                     00109000
.*-------------------------------------------------------------------   00109100
.***AM.L09  XRSV0001 CL1                                                00109200
&ZOPN                 SETA &ZOPN+1                                      00109300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00109400
&ZOPO(&ZOPN)          SETC 'DS'                                         00109500
&ZOPV(&ZOPN)          SETC 'CL1'                                        00109600
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00109700
.*-------------------------------------------------------------------   00109800
.***AM.L09  XGROUPTOKEN F                                               00109900
&ZOPN                 SETA &ZOPN+1                                      00110000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGROUPTOKEN'                      00110100
&ZOPO(&ZOPN)          SETC 'DS'                                         00110200
&ZOPV(&ZOPN)          SETC 'F'                                          00110300
&ZOPD(&ZOPN)          SETC '++ &ZXGROUPTOKEN  XGROUPTOKEN'              00110400
.*-------------------------------------------------------------------   00110500
.***AM.L09  XMEMBER CL16                                                00110600
&ZOPN                 SETA &ZOPN+1                                      00110700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMEMBER'                          00110800
&ZOPO(&ZOPN)          SETC 'DS'                                         00110900
&ZOPV(&ZOPN)          SETC 'CL16'                                       00111000
&ZOPD(&ZOPN)          SETC '++ &ZXMEMBER  XMEMBER'                      00111100
.*-------------------------------------------------------------------   00111200
.***AM.L03 XREQTYPE BL.8                                                00111300
&ZOPN                 SETA &ZOPN+1                                      00111400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQTYPE'                         00111500
&ZOPO(&ZOPN)          SETC 'DS'                                         00111600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00111700
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00111800
.*                                                                      00111900
&ZOPN                 SETA  &ZOPN+1                                     00112000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_BEGIN'                  00112100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00112200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00112300
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00112400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).BEGIN'                        00112500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00112600
.*                                                                      00112700
&ZOPN                 SETA  &ZOPN+1                                     00112800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_END'                    00112900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00113000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00113100
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00113200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).END'                          00113300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00113400
.*-------------------------------------------------------------------   00113500
.***AM.L03 XRESET BL.8                                                  00113600
&ZOPN                 SETA &ZOPN+1                                      00113700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESET'                           00113800
&ZOPO(&ZOPN)          SETC 'DS'                                         00113900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00114000
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00114100
.*                                                                      00114200
&ZOPN                 SETA  &ZOPN+1                                     00114300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRESET_YES'                      00114400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00114500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00114600
&ZOPD(&ZOPN)          SETC  '++ XRESET.'                                00114700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00114800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00114900
.*                                                                      00115000
&ZOPN                 SETA  &ZOPN+1                                     00115100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRESET_NO'                       00115200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00115300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00115400
&ZOPD(&ZOPN)          SETC  '++ XRESET.'                                00115500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00115600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00115700
.*-------------------------------------------------------------------   00115800
.***AM.L03 XKEYS BL.8                                                   00115900
&ZOPN                 SETA &ZOPN+1                                      00116000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYS'                            00116100
&ZOPO(&ZOPN)          SETC 'DS'                                         00116200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00116300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00116400
.*                                                                      00116500
&ZOPN                 SETA  &ZOPN+1                                     00116600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_REQTYPE'                 00116700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00116800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00116900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00117000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REQTYPE'                      00117100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00117200
.*                                                                      00117300
&ZOPN                 SETA  &ZOPN+1                                     00117400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MEMBER'                  00117500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00117600
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00117700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00117800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MEMBER'                       00117900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00118000
.*-------------------------------------------------------------------   00118100
.***AM.L10 END OF IXZXIXCN LIST PARAMETERS                              00118200
&ZOPN                 SETA &ZOPN+1                                      00118300
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00118400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00118500
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00118600
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00118700
.*                                                                      00118800
&ZOPN                 SETA &ZOPN+1                                      00118900
&ZOPL(&ZOPN)          SETC ' '                                          00119000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00119100
&ZOPV(&ZOPN)          SETC '1'                                          00119200
&ZOPD(&ZOPN)          SETC ' '                                          00119300
.*-------------------------------------------------------------------   00119400
.***AL.L12 IXZXIXCN FMT=LIST MF=S|L PARAMETERS                          00119500
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00119600
.*                                                                      00119700
&ZOPN                 SETA  &ZOPN+1                                     00119800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00119900
&ZOPO(&ZOPN)          SETC  'DC'                                        00120000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00120100
&ZOPD(&ZOPN)          SETC  '++ IXZXIXCN ARG PARMS'                     00120200
.*                                                                      00120300
.ZLMFSLX              ANOP  ,                                           00120400
.*-------------------------------------------------------------------   00120500
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00120600
&ZPLLEN               SETA 31                                           00120700
.*                                                                      00120800
.******************************************************************     00120900
.***AI.L01 IXZXIXCN FMT=LIST FILL IN PARAMETER AREA                     00121000
.******************************************************************     00121100
                      ACTR  10000                                       00121200
&ZCVAL                SETC  'LA'            XA MODE                     00121300
.*                                                                      00121400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00121500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00121600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00121700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00121800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00121900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00122000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00122100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00122200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00122300
&ZOPN                 SETA  &ZOPN+1                                     00122400
&ZOPL(&ZOPN)          SETC  ' '                                         00122500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00122600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00122700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00122800
                      AGO   .ZIMFNX                                     00122900
.*                                                                      00123000
.ZIMFN2               ANOP ,                                            00123100
&ZOPN                 SETA  &ZOPN+1                                     00123200
&ZOPL(&ZOPN)          SETC  ' '                                         00123300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00123400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00123500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00123600
.ZIMFNX               ANOP ,                                            00123700
.********************************************************************   00123800
.***AI.L02 IXZXIXCN FMT=LIST INITIALIZE PARAMETER AREA                  00123900
.********************************************************************   00124000
.***AI.L03 MF=(SLE)                                                     00124100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00124200
.*                                                                      00124300
&ZOPN                 SETA  &ZOPN+1                                     00124400
&ZOPL(&ZOPN)          SETC  ' '                                         00124500
&ZOPO(&ZOPN)          SETC  'XC'                                        00124600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00124700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00124800
.ZIMFLX               ANOP  ,                                           00124900
.*-------------------------------------------------------------------   00125000
.***AI.L04B XVERSION XL1                                                00125100
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00125200
&ZOPN                 SETA  &ZOPN+1                                     00125300
&ZOPL(&ZOPN)          SETC  ' '                                         00125400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00125500
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00125600
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00125700
.ZIMFVX               ANOP  ,                                           00125800
.*-------------------------------------------------------------------   00125900
.***AI.L60 XEYECATCH CL6                                                00126000
&ZOPN                 SETA  &ZOPN+1                                     00126100
&ZOPL(&ZOPN)          SETC  ' '                                         00126200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00126300
&ZOPV(&ZOPN)          SETC  '1(6,1),=CL6''YIXCT '''                     00126400
&ZOPD(&ZOPN)          SETC  '++ CL6 CONSTANT'                           00126500
.*-------------------------------------------------------------------   00126600
.***AI.L25  XGROUPTOKEN F                                               00126700
                      AIF   ('&ZXGROUPTOKEN' EQ '').ZI4E  NOT USED      00126800
                      AIF   ('&ZXGROUPTOKEN' EQ 'OUTPUT').ZI4E          00126900
&ZCGPR                SETC  '&XGROUPTOKEN'                              00127000
.*                                                                      00127100
                      AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZI4B           00127200
&ZCGPR   SETC  '0('.'&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2).')'              00127300
                      AGO   .ZI4D                                       00127400
.ZI4B                 ANOP  ,                                           00127500
.*                                                                      00127600
&ZC                   SETC  '&XGROUPTOKEN'(1,1)                         00127700
                      AIF   (T'&ZC NE 'N').ZI4D                         00127800
&ZC                   SETC  '&XGROUPTOKEN'                              00127900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI4D                00128000
&ZCGPR                SETC  '=FL4''&XGROUPTOKEN'''                      00128100
.*                                                                      00128200
.ZI4D                 ANOP  ,                                           00128300
.*                                                                      00128400
&ZOPN                 SETA  &ZOPN+1                                     00128500
&ZOPL(&ZOPN)          SETC  ' '                                         00128600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00128700
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00128800
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPTOKEN XGROUPTOKEN F'            00128900
.*                                                                      00129000
.ZI4E                 ANOP  ,                                           00129100
.*-------------------------------------------------------------------   00129200
.***AI.L18  XMEMBER CL16                                                00129300
         AIF   ('&XMEMBER' NE 'NONE').ZI5                               00129400
&ZXMEMBER             SETC  ''             RESET INPUT/OUTPUT           00129500
.ZI5                  ANOP  ,                                           00129600
.*-------------------------------------------------------------------   00129700
.***AI.L25  XMEMBER CL16                                                00129800
                      AIF   ('&ZXMEMBER' EQ '').ZI5E  NOT USED          00129900
                      AIF   ('&ZXMEMBER' EQ 'OUTPUT').ZI5E              00130000
&ZCGPR                SETC  '&XMEMBER'                                  00130100
.*                                                                      00130200
                      AIF   ('&XMEMBER'(1,1) NE '(').ZI5B               00130300
&ZCGPR   SETC  '0('.'&XMEMBER'(2,K'&XMEMBER-2).')'                      00130400
.ZI5B                 ANOP  ,                                           00130500
.*                                                                      00130600
&ZOPN                 SETA  &ZOPN+1                                     00130700
&ZOPL(&ZOPN)          SETC  ' '                                         00130800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00130900
&ZOPV(&ZOPN)          SETC  '12(16,1),&ZCGPR'                           00131000
&ZOPD(&ZOPN)          SETC  '++ &ZXMEMBER XMEMBER CL16'                 00131100
.*                                                                      00131200
.ZI5E                 ANOP  ,                                           00131300
.*-------------------------------------------------------------------   00131400
.***AI.L05 XREQTYPE BL1                                                 00131500
&ZW                   SETC  ''                                          00131600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00131700
.*-------------------------------------------------------------------   00131800
.***AI.L08 XREQTYPE "BEGIN"                                             00131900
.***      BL1'1XXXXXXX'                                                 00132000
         AIF   ('&XREQTYPE' NE 'BEGIN').ZI7A                            00132100
&ZW                   SETC  '&ZW.1'                                     00132200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00132300
                      AGO   .ZI7C                                       00132400
.*                                                                      00132500
.ZI7A                 ANOP  ,                                           00132600
&ZW                   SETC  '&ZW.0'                                     00132700
.ZI7C                 ANOP  ,                                           00132800
.*-------------------------------------------------------------------   00132900
.***AI.L08 XREQTYPE "END"                                               00133000
.***      BL1'X1XXXXXX'                                                 00133100
         AIF   ('&XREQTYPE' NE 'END').ZI8A                              00133200
&ZW                   SETC  '&ZW.1000000'                               00133300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00133400
                      AGO   .ZI8C                                       00133500
.*                                                                      00133600
.ZI8A                 ANOP  ,                                           00133700
&ZW                   SETC  '&ZW.0000000'                               00133800
.ZI8C                 ANOP  ,                                           00133900
.*-------------------------------------------------------------------   00134000
.***AI.L11 XREQTYPE BL1                                                 00134100
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     00134200
&ZOPN                 SETA  &ZOPN+1                                     00134300
&ZOPL(&ZOPN)          SETC  ' '                                         00134400
&ZOPO(&ZOPN)          SETC  'OI'                                        00134500
&ZOPV(&ZOPN)          SETC  '28(1),B''&ZW'''                            00134600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00134700
.ZI8E                 ANOP  ,                                           00134800
.*-------------------------------------------------------------------   00134900
.***AI.L05 XRESET BL1                                                   00135000
&ZW                   SETC  ''                                          00135100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00135200
.*-------------------------------------------------------------------   00135300
.***AI.L08 XRESET "YES"                                                 00135400
.***      BL1'1XXXXXXX'                                                 00135500
         AIF   ('&XRESET' NE 'YES').ZI10A                               00135600
&ZW                   SETC  '&ZW.1'                                     00135700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00135800
                      AGO   .ZI10C                                      00135900
.*                                                                      00136000
.ZI10A                ANOP  ,                                           00136100
&ZW                   SETC  '&ZW.0'                                     00136200
.ZI10C                ANOP  ,                                           00136300
.*-------------------------------------------------------------------   00136400
.***AI.L08 XRESET "NO"                                                  00136500
.***      BL1'X1XXXXXX'                                                 00136600
         AIF   ('&XRESET' NE 'NO').ZI11A                                00136700
&ZW                   SETC  '&ZW.1000000'                               00136800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00136900
                      AGO   .ZI11C                                      00137000
.*                                                                      00137100
.ZI11A                ANOP  ,                                           00137200
&ZW                   SETC  '&ZW.0000000'                               00137300
.ZI11C                ANOP  ,                                           00137400
.*-------------------------------------------------------------------   00137500
.***AI.L11 XRESET BL1                                                   00137600
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    00137700
&ZOPN                 SETA  &ZOPN+1                                     00137800
&ZOPL(&ZOPN)          SETC  ' '                                         00137900
&ZOPO(&ZOPN)          SETC  'OI'                                        00138000
&ZOPV(&ZOPN)          SETC  '29(1),B''&ZW'''                            00138100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00138200
.ZI11E                ANOP  ,                                           00138300
.*-------------------------------------------------------------------   00138400
.***AI.L05 XKEYS BL1                                                    00138500
&ZW                   SETC  ''                                          00138600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00138700
.*-------------------------------------------------------------------   00138800
.***AI.L08 XKEYS "REQTYPE"                                              00138900
.***      BL1'1XXXXXXX'                                                 00139000
         AIF   ('&REQTYPE' EQ '').ZI13A                                 00139100
&ZW                   SETC  '&ZW.1'                                     00139200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00139300
                      AGO   .ZI13C                                      00139400
.*                                                                      00139500
.ZI13A                ANOP  ,                                           00139600
&ZW                   SETC  '&ZW.0'                                     00139700
.ZI13C                ANOP  ,                                           00139800
.*-------------------------------------------------------------------   00139900
.***AI.L08 XKEYS "MEMBER"                                               00140000
.***      BL1'X1XXXXXX'                                                 00140100
         AIF   ('&MEMBER' EQ '').ZI14A                                  00140200
         AIF   ('&MEMBER' EQ 'NONE').ZI14A                              00140300
&ZW                   SETC  '&ZW.1000000'                               00140400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00140500
                      AGO   .ZI14C                                      00140600
.*                                                                      00140700
.ZI14A                ANOP  ,                                           00140800
&ZW                   SETC  '&ZW.0000000'                               00140900
.ZI14C                ANOP  ,                                           00141000
.*-------------------------------------------------------------------   00141100
.***AI.L11 XKEYS BL1                                                    00141200
                      AIF   ('&ZCLNG' NE 'YES').ZI14E  ALL ZERO BITS    00141300
&ZOPN                 SETA  &ZOPN+1                                     00141400
&ZOPL(&ZOPN)          SETC  ' '                                         00141500
&ZOPO(&ZOPN)          SETC  'OI'                                        00141600
&ZOPV(&ZOPN)          SETC  '30(1),B''&ZW'''                            00141700
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00141800
.ZI14E                ANOP  ,                                           00141900
.*-------------------------------------------------------------------   00142000
&ZOPN1                SETA &ZOPN                                        00142100
.*******************************************************************    00142200
.***  PROCESS IXZXIXCN OUTPUT PARAMETERS                                00142300
.*******************************************************************    00142400
                      ACTR  10000                                       00142500
.*******************************************************************    00142600
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00142700
.*******************************************************************    00142800
&ZOPN                 SETA  &ZOPN+1                                     00142900
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               00143000
&ZOPO(&ZOPN)          SETC  'DS'                                        00143100
&ZOPV(&ZOPN)          SETC  '0H'                                        00143200
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      00143300
.*******************************************************************    00143400
.***AO.X02  RETURN CODE PROCESSING                                      00143500
.*******************************************************************    00143600
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00143700
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00143800
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00143900
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00144000
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00144100
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00144200
&ZOPN                 SETA  &ZOPN+1                                     00144300
&ZOPL(&ZOPN)          SETC  ' '                                         00144400
&ZOPO(&ZOPN)          SETC  'ST'                                        00144500
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00144600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00144700
                      AGO   .ZMRETX                                     00144800
.*                                                                      00144900
.ZMRET2               ANOP  ,                                           00145000
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00145100
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00145200
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00145300
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00145400
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00145500
&ZOPN                 SETA  &ZOPN+1                                     00145600
&ZOPL(&ZOPN)          SETC  ' '                                         00145700
&ZOPO(&ZOPN)          SETC  'LR'                                        00145800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00145900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00146000
.ZMRETX               ANOP  ,                                           00146100
.*******************************************************************    00146200
.***AO.X03  REASON CODE PROCESSING                                      00146300
.*******************************************************************    00146400
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00146500
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00146600
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00146700
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00146800
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00146900
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00147000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00147100
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00147200
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00147300
&ZOPN                 SETA  &ZOPN+1                                     00147400
&ZOPL(&ZOPN)          SETC  ' '                                         00147500
&ZOPO(&ZOPN)          SETC  'ST'                                        00147600
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00147700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00147800
                      AGO   .ZMRSNX                                     00147900
.*                                                                      00148000
.ZMRSN2               ANOP  ,                                           00148100
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00148200
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00148300
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00148400
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00148500
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00148600
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00148700
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00148800
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00148900
&ZOPN                 SETA  &ZOPN+1                                     00149000
&ZOPL(&ZOPN)          SETC  ' '                                         00149100
&ZOPO(&ZOPN)          SETC  'LR'                                        00149200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00149300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00149400
.ZMRSNX               ANOP  ,                                           00149500
.*******************************************************************    00149600
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00149700
.*******************************************************************    00149800
.ZMFLX                ANOP  ,              MF=L PROCESSING              00149900
.*******************************************************************    00150000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00150100
.*******************************************************************    00150200
                      ACTR  10000                                       00150300
.*                                                                      00150400
                      LCLA  &ZLC           COLUMN POSITION              00150500
                      LCLA  &ZOPX          LIST TABLE INDEX             00150600
                      LCLC  &ZLL           LABEL                        00150700
                      LCLC  &ZLOP          OPERATION                    00150800
                      LCLC  &ZLV           VALUE                        00150900
                      LCLC  &ZLD           DESCRIPTION                  00151000
.*                                                                      00151100
&ZOPX                 SETA  1                                           00151200
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00151300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00151400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00151500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00151600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00151700
                      AIF   (K'&ZLD LE 0).ZL5                           00151800
&ZLC                  SETA  35             COMMENT COLUMN               00151900
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00152000
&ZLC                  SETA  33             COMMMENT COLUMN              00152100
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00152200
&ZLV                  SETC  '&ZLV'.' '                                  00152300
                      AGO   .ZL3                                        00152400
.*                                                                      00152500
.ZL4                  ANOP  ,                                           00152600
&ZLV                  SETC  '&ZLV'.' '                                  00152700
.ZL5                  ANOP  ,                                           00152800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00152900
.*                                                                      00153000
&ZLL     &ZLOP &ZLV                                                     00153100
.*                                                                      00153200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00153300
                      AGO   .ZL2           CONTINUE LOOPING             00153400
.*                                                                      00153500
.ZLX                  ANOP  ,                                           00153600
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00153700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00153800
         GBLC  &ANVIRON           JES2 environment variable             00153900
         GBLB  &J3MN              JES3 Main Task environment            00154000
         GBLB  &J3ST              JES3 Subtask environment              00154100
         GBLB  &J3FSS             JES3 FSS environment                  00154200
         GBLB  &JSXCF             JESXCF environment                    00154300
         AIF   (&J3MN).IXCN050    Are we running under JES3 Main task   00154400
         AIF   (&J3ST).IXCN050    Are we running under JES3 Sub task    00154500
         AIF   (&J3FSS).IXCN050   Are we running under JES3 FSS         00154600
         MNOTE 8,'IXZ0001 Running in an invalid environment'            00154700
.IXCN050 ANOP                                                           00154800
         AIF   ('&GROUPTOKEN'(1,1) NE '(').IXCN100                      00154900
         LR    14,&GROUPTOKEN     Load the address of the group token   00155000
         L     14,0(14)           Load the group token                  00155100
         AGO   .IXCN150                                                 00155200
.IXCN100 ANOP                                                           00155300
         L     14,&GROUPTOKEN     Load the group token                  00155400
.IXCN150 ANOP                                                           00155500
         L     14,100(14)          Load the PC number of the            00155600
*                                 routine to be called                  00155700
         PC    0(14)              Call the acknowledge message          00155800
*                                 routine                               00155900
         AIF   ('&XMFCTRL'(1,1) NE '(').IXCN200                         00156000
         LR    1,&XMFCTRL         Restore the parameter list address    00156100
         AGO   .IXCN250                                                 00156200
.IXCN200 ANOP                                                           00156300
         LA    1,&XMFCTRL         Restore the parameter list address    00156400
.IXCN250 ANOP                                                           00156500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00156600
.ZLINKX               ANOP  ,                                           00156700
.*******************************************************************    00156800
.***AP.X01  FORMAT GENERATED CODE                                       00156900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00157000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00157100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00157200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00157300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00157400
                      AIF   (K'&ZLD LE 0).ZL51                          00157500
&ZLC                  SETA  35             COMMENT COLUMN               00157600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00157700
&ZLC                  SETA  33             COMMENT COLUMN               00157800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00157900
&ZLV                  SETC  '&ZLV'.' '                                  00158000
                      AGO   .ZL31                                       00158100
.*                                                                      00158200
.ZL41                 ANOP  ,                                           00158300
&ZLV                  SETC  '&ZLV'.' '                                  00158400
.ZL51                 ANOP  ,                                           00158500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00158600
.*                                                                      00158700
&ZLL     &ZLOP &ZLV                                                     00158800
.*                                                                      00158900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00159000
                      AGO   .ZL21          CONTINUE LOOPING             00159100
.*                                                                      00159200
.ZLX1                 ANOP  ,                                           00159300
.*******************************************************************    00159400
.***AP.X02  END OF IXZXIXCN MACRO                                       00159500
&ZIXZXIXCN            SETC  'YES'          SET IXZXIXCN USED            00159600
         POP   PRINT                                                    00159700
*                                            IXZXIXCN-1                 00159800
         SPACE 1                                                        00159900
.ZLX2                 ANOP  ,                                           00160000
         MEND                                                           00160100
**********************************************************************/ 00160200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00160300
*%IXZXIXCN: MACRO KEYS(GROUPTOKEN,REQTYPE,RESET,MEMBER,RTNCODE,         00160400
*                 RSNCODE,PLISTVER,MF);                                 00160500
*  ANS('?'||MACLABEL||' '||'IXZPIXCN '||MACLIST||                       00160600
*         ' '||MACKEYS||';') COL(MACLMAR);                              00160700
*%END IXZXIXCN;                                                         00160800
