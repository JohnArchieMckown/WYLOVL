*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  UCBLOOK                               -12/13/99-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  UCB Look-Up                                   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5655-068 (C) COPYRIGHT IBM CORP. 1990, 1994                     * 00001200
*                                                                     * 00001300
* STATUS= HBB5520                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The UCBLOOK macro is used to obtain the UCB common segment     * 00002100
*      address of a given device number or a given volume serial.     * 00002200
*      The input device number may be specified either as binary or   * 00002300
*      EBCDIC.                                                        * 00002400
*                                                                     * 00002500
*      UCBLOOK can be used to locate any UCB including those defined  * 00002600
*      as dynamic and those with 4 digit device numbers.  The caller  * 00002700
*      must cause the UCB to be pinned via the PIN parameter unless   * 00002800
*      the caller is running in an environment such that dynamic I/O  * 00002900
*      configuration changes cannot occur.                            * 00003000
*                                                                     * 00003100
*      UCBLOOK can be used to locate Actual UCBs that are located     * 00003200
*      above or below the 16Mb line.                                  * 00003300
*                                                                     * 00003400
*      The contents of registers 0, 1, 14, and 15 are altered by the  * 00003500
*      macro expansion.                                               * 00003600
*                                                                     * 00003700
*      The parameter list must be in the caller's primary address     * 00003800
*      space or be addressable by the dispatchable unit access list.  * 00003900
*                                                                     * 00004000
*      The LINKAGE=BRANCH option is intended for performance          * 00004100
*      sensitive invokers or programs which require this function     * 00004200
*      during NIP before a PC can be issued.                          * 00004300
*                                                                     * 00004400
*      The NONBASE=YES option is intended for including alias UCBs of * 00004500
*      a parallel access volume.  If this option is not specified     * 00004600
*      then UCBLOOK will not return the UCB address of an alias UCB.  * 00004700
*                                                                     * 00004800
*      The UNBOUND_ALIAS=YES option is intended for including alias   * 00004900
*      UCBs of a parallel access volume that have not yet been bound  * 00005000
*      to a base PAV.  If this option is not specified then UCBLOOK   * 00005100
*      will not return the UCB address of an alias UCB.               * 00005200
*                                                                     * 00005300
*01* EXTERNAL CLASSIFICATION:                                         * 00005400
*                                                                     * 00005500
*02* GUPI: BASE                                                       * 00005600
*                                                                     * 00005700
*02* PSPI: FIELDS                                                     * 00005800
*          UCBPXPTR, UCBPAREA                                         * 00005900
*                                                                     * 00006000
*02* NONE: FIELDS                                                     * 00006100
*          NOTFIND, UNBOUND_ALIAS                                     * 00006200
*                                                                     * 00006300
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00006400
*                                                                     * 00006500
*01* ENVIRONMENT:                                                     * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*      Dispatchable unit mode: Task or SRB mode.                      * 00006900
*                                                                     * 00007000
*      Minimum authorization: Supervisor state or program key mask    * 00007100
*                        (PKM) allowing keys 0-7.                     * 00007200
*                                                                     * 00007300
*      AMODE:            24- or 31-bit.                               * 00007400
*                                                                     * 00007500
*      ASC mode:         Primary or Access Register.                  * 00007600
*                                                                     * 00007700
*                        If in Access Register ASC mode, specify      * 00007800
*                        SYSSTATE ASCENV=AR before invoking this      * 00007900
*                        macro.                                       * 00008000
*                                                                     * 00008100
*      Interrupt status: Enabled or disabled for I/O and external     * 00008200
*                        interrupts.                                  * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*01* RESTRICTIONS:                                                    * 00008700
*    The invoker must not hold any lock higher than the IOSULUT lock. * 00008800
*                                                                     * 00008900
*    The LINKAGE=BRANCH option is limited to callers which meet the   * 00009000
*    following criteria:                                              * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*    o   supervisor state key 0                                       * 00009400
*                                                                     * 00009500
*    o   31 bit addressing mode                                       * 00009600
*                                                                     * 00009700
*    o   primary ASC mode                                             * 00009800
*                                                                     * 00009900
*    o   the parameter list (including any data areas pointed to by   * 00010000
*        the parameter list) resides in fixed or DREF storage         * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*01* SYNTAX:                                                          * 00010500
*                                                                     * 00010600
*[xlabel]  UCBLOOK    DEVN=xdevn                                     * 00010700
*                    ,DEVNCHAR=xdevnchar                             * 00010800
*                    ,VOLSER=xvolser                                 * 00010900
*                        [,DEVCLASS=DASDTAPE|TAPE|DASD]             * 00011000
*                     ,UCBPTR=xucbptr                                 * 00011100
*                    [,UCBCXPTR=xucbcxptr]                            * 00011200
*                    [,UCBPXPTR=xucbpxptr]                            * 00011300
*                    [,LOC=BELOW|ANY]                               * 00011400
*                    [,DYNAMIC=NO|YES]                              * 00011500
*                    [,RANGE=3DIGIT|ALL]                            * 00011600
*                    [,NONBASE=NO|YES]                              * 00011700
*                    [,UNBOUND_ALIAS=NO|YES]                        * 00011800
*                    [,NOTFIND=NO|YES]                              * 00011900
*                    ,PIN                                            * 00012000
*                   |     ,TEXT=xtext                                 * 00012100
*                   |     ,PTOKEN=xptoken                             * 00012200
*                   |    [,COMPID=xcompid|NONE]                     * 00012300
*                   |    [,HELP=xhelp|NONE]                         * 00012400
*                   |    [,LASTING]                                   * 00012500
*                   |    [,PINPATHS]                                  * 00012600
*                    ,NOPIN                                          * 00012700
*                    [,UCBPAREA=xucbparea|NONE]                     * 00012800
*                    [,IOCTOKEN=xioctoken|NONE]                     * 00012900
*                    [,LINKAGE=SYSTEM|BRANCH]                       * 00013000
*                    [,RETCODE=xretcode]                              * 00013100
*                    [,RSNCODE=xrsncode]                              * 00013200
*                    [,PLISTVER=xplistver|IMPLIED_VERSION]          * 00013300
*                   [,MF=S]                                          * 00013400
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 00013500
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*      Where:                                                         * 00013900
*                                                                     * 00014000
*                                                                     * 00014100
*      [xlabel]                                                       * 00014200
*          is an optional symbol, starting in column 1, that is the   * 00014300
*          name on the UCBLOOK macro invocation.  The name must       * 00014400
*          conform to the rules for an ordinary assembler language    * 00014500
*          symbol.                                                    * 00014600
*          DEFAULT: No name.                                          * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*      The following is a set of mutually exclusive keys.  This set   * 00015200
*      is required; only one key must be specified.                   * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*      DEVN=xdevn                                                     * 00015600
*          belongs to a set of mutually exclusive keys. It is the     * 00015700
*          name (RS-type), or address in register (2)-(12), of a      * 00015800
*          halfword input which specifies the device number in binary * 00015900
*          of the device whose UCB address is to be obtained.         * 00016000
*                                                                     * 00016100
*      DEVNCHAR=xdevnchar                                             * 00016200
*          belongs to a set of mutually exclusive keys. It is the     * 00016300
*          name (RS-type), or address in register (2)-(12), of a 4    * 00016400
*          character input which specifies the device number in       * 00016500
*          EBCDIC of the device whose UCB address is to be obtained.  * 00016600
*                                                                     * 00016700
*          NOTE:  A three digit device number can either be           * 00016800
*          represented as ' ddd' or '0ddd'.                           * 00016900
*                                                                     * 00017000
*      VOLSER=xvolser                                                 * 00017100
*          belongs to a set of mutually exclusive keys. It is the     * 00017200
*          name (RS-type), or address in register (2)-(12), of a 6    * 00017300
*          character input which specifies the volume serial in       * 00017400
*          EBCDIC of the device whose UCB address is to be obtained.  * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*          [DEVCLASS=DASDTAPE|TAPE|DASD]                            * 00017800
*              is an optional keyword input which specifies the       * 00017900
*              device class that is to be searched for the VOLSER     * 00018000
*              look-up.                                               * 00018100
*              DEFAULT: DASDTAPE                                      * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*              DEVCLASS=DASDTAPE                                      * 00018500
*                  searches both DASD and TAPE UCBs                   * 00018600
*                                                                     * 00018700
*              DEVCLASS=TAPE                                          * 00018800
*                  searches TAPE UCBs                                 * 00018900
*                                                                     * 00019000
*              DEVCLASS=DASD                                          * 00019100
*                  searches DASD UCBs                                 * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*      End of a set of mutually exclusive required keys.              * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*      UCBPTR=xucbptr                                                 * 00020400
*          is the name (RS-type), or address in register (2)-(12), of * 00020500
*          a required 4 byte output that will contain the address of  * 00020600
*          the UCB common segment associated with the look-up         * 00020700
*          argument (DEVN, DEVNCHAR, or VOLSER).                      * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*      [UCBCXPTR=xucbcxptr]                                           * 00021300
*          is the name (RS-type), or address in register (2)-(12), of * 00021400
*          an optional 4 byte output that will contain the address of * 00021500
*          the UCB common extension segment associated with the       * 00021600
*          look-up argument (DEVN, DEVNCHAR, or VOLSER).  This        * 00021700
*          address points to the area mapped by macro IEFUCBOB.       * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*      [UCBPXPTR=xucbpxptr]                                           * 00022300
*          is the name (RS-type), or address in register (2)-(12), of * 00022400
*          an optional 4 byte output that will contain the address of * 00022500
*          the UCB prefix extension segment associated with the       * 00022600
*          look-up argument (DEVN, DEVNCHAR, or VOLSER).  This        * 00022700
*          address points to the area mapped by macro IOSDUPFX.       * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*      [LOC=BELOW|ANY]                                              * 00023300
*          is an optional keyword input that indicates whether or not * 00023400
*          the look-up is to include Actual UCBs from above or below  * 00023500
*          the 16Mb line.                                             * 00023600
*          DEFAULT: BELOW                                             * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*          LOC=BELOW                                                  * 00024000
*              limits the look-up to Actual UCBs below the 16MB line. * 00024100
*                                                                     * 00024200
*          LOC=ANY                                                    * 00024300
*              request that both above and below the 16Mb line Actual * 00024400
*              UCBs be included in the look-up.                       * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*      [DYNAMIC=NO|YES]                                             * 00025200
*          is an optional keyword input that indicates whether the    * 00025300
*          look-up is to be restricted to static or                   * 00025400
*          installation-static UCBs only (i.e. UCBs which are not     * 00025500
*          subject to dynamic additions and deletions)                * 00025600
*          DEFAULT: NO                                                * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*          DYNAMIC=NO                                                 * 00026000
*              limits the look-up to UCBs defined as static or        * 00026100
*              installation-static                                    * 00026200
*                                                                     * 00026300
*          DYNAMIC=YES                                                * 00026400
*              requests that static, installation-static, and dynamic * 00026500
*              UCBs be included in the look-up                        * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*      [RANGE=3DIGIT|ALL]                                           * 00027300
*          is an optional keyword input that indicates whether or not * 00027400
*          the look-up is to include UCBs with 4 digit device numbers * 00027500
*          DEFAULT: 3DIGIT                                            * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*          RANGE=3DIGIT                                               * 00027900
*              limits the look-up to UCBs with 3 digit device numbers * 00028000
*                                                                     * 00028100
*          RANGE=ALL                                                  * 00028200
*              requests that both UCBs with 3 digit device numbers    * 00028300
*              and UCBs with 4 digit device numbers be included in    * 00028400
*              the look-up                                            * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*      [NONBASE=NO|YES]                                             * 00029200
*          is an optional keyword input that indicates whether or not * 00029300
*          the look-up will include alias UCBs of a parallel access   * 00029400
*          volume.                                                    * 00029500
*          DEFAULT: NO                                                * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*          NONBASE=NO                                                 * 00029900
*              the look-up will not include alias UCBs                * 00030000
*                                                                     * 00030100
*          NONBASE=YES                                                * 00030200
*              the look-up will include alias UCBs                    * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*      [UNBOUND_ALIAS=NO|YES]                                       * 00031000
*          is an optional keyword input that indicates whether or not * 00031100
*          the look-up will include alias UCBs of a parallel access   * 00031200
*          volume that have not yet been bound to a base PAV.         * 00031300
*                                                                     * 00031400
*          NOTE:  The UNBOUND_ALIAS keyword is for system use use     * 00031500
*          only.                                                      * 00031600
*          DEFAULT: NO                                                * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*          UNBOUND_ALIAS=NO                                           * 00032000
*              the look-up will not include alias UCBs                * 00032100
*                                                                     * 00032200
*          UNBOUND_ALIAS=YES                                          * 00032300
*              the look-up will include alias UCBs                    * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*      [NOTFIND=NO|YES]                                             * 00033100
*          is an optional keyword input that indicates whether the    * 00033200
*          look-up is to include not-findable UCBs                    * 00033300
*                                                                     * 00033400
*          NOTE:  The NOTFIND keyword is for IOS use only.            * 00033500
*          DEFAULT: NO                                                * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*          NOTFIND=NO                                                 * 00033900
*              limits the look-up to findable UCBs                    * 00034000
*                                                                     * 00034100
*          NOTFIND=YES                                                * 00034200
*              requests that both findable and not-findable UCBs be   * 00034300
*              included in the look-up                                * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*                                                                     * 00035000
*      The following is a set of mutually exclusive keys.  This set   * 00035100
*      is required; only one key must be specified.                   * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*      PIN                                                            * 00035500
*          The UCB is to be pinned to prevent its disappearance via   * 00035600
*          the dynamic UCB capability.  It is the caller's            * 00035700
*          responsibility to un-pin the UCB using the UCBPIN UNPIN    * 00035800
*          service.                                                   * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*          TEXT=xtext                                                 * 00036200
*              is the name (RS-type) of a required 58 character input * 00036300
*              which specifies the descriptive text documenting the   * 00036400
*              reason for the PIN request.  This text will be         * 00036500
*              displayed on a message identifying the reason for a    * 00036600
*              configuration change failure if this pin request       * 00036700
*              remains outstanding during a configuration change.     * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*          PTOKEN=xptoken                                             * 00037300
*              is the name (RS-type), or address in register          * 00037400
*              (2)-(12), of a required 8 character output which is to * 00037500
*              receive the pin token. The caller must use the pin     * 00037600
*              token when unpinning the UCB.                          * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*          [COMPID=xcompid|NONE]                                    * 00038200
*              is the name (RS-type) of an optional 5 character input * 00038300
*              which specifies the component ID of the component      * 00038400
*              requesting the pin.                                    * 00038500
*              DEFAULT: NONE                                          * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*          [HELP=xhelp|NONE]                                        * 00039100
*              is the name (RS-type), or address in register          * 00039200
*              (2)-(12), of an optional 8 character input which       * 00039300
*              specifies the help panel ID in SYS1.LINKLIB which      * 00039400
*              provides help information on why the device was pinned * 00039500
*              and/or how to un-pin the device.                       * 00039600
*              DEFAULT: NONE                                          * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*          [LASTING]                                                  * 00040200
*              KEYWORD that indicates that the pin request should not * 00040300
*              be automatically cleaned up (i.e. unpinned) by IOS     * 00040400
*              during end-of-task or end-of-memory termination.       * 00040500
*              DEFAULT: NONE                                          * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*          [PINPATHS]                                                 * 00041100
*              KEYWORD that indicates to pin all paths to the device  * 00041200
*              (in addition to pinning the device)                    * 00041300
*              DEFAULT: NONE                                          * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*      NOPIN                                                          * 00041800
*          The UCB will not be pinned.                                * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*      End of a set of mutually exclusive required keys.              * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*      [UCBPAREA=xucbparea|NONE]                                    * 00042700
*          is the name (RS-type), or address in register (2)-(12), of * 00042800
*          an optional 48 character input work area which is to       * 00042900
*          receive a copy of the UCB prefix data.  The data can be    * 00043000
*          mapped by macro IOSDUPI.                                   * 00043100
*          DEFAULT: NONE                                              * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*      [IOCTOKEN=xioctoken|NONE]                                    * 00043700
*          is the name (RS-type), or address in register (2)-(12), of * 00043800
*          an optional 48 character input/output which specifies the  * 00043900
*          I/O configuration token.  If the UCB definition for the    * 00044000
*          UCB to be returned is not consistent with the I/O          * 00044100
*          configuration token supplied as input, the caller will be  * 00044200
*          notified via a return code.                                * 00044300
*                                                                     * 00044400
*          If the input IOCTOKEN is set to binary zeroes, then this   * 00044500
*          service will set IOCTOKEN to the current I/O configuration * 00044600
*          token.                                                     * 00044700
*          DEFAULT: NONE                                              * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*                                                                     * 00045200
*      [LINKAGE=SYSTEM|BRANCH]                                      * 00045300
*          is an optional keyword input that indicates whether a      * 00045400
*          branch-entry linkage should be generated or a Program Call * 00045500
*          should be issued for the routine invocation.               * 00045600
*          DEFAULT: SYSTEM                                            * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*          LINKAGE=SYSTEM                                             * 00046000
*              requests Program Call invocation.                      * 00046100
*                                                                     * 00046200
*          LINKAGE=BRANCH                                             * 00046300
*              requests branch-entry invocation.  See INVOCATION      * 00046400
*              REQUIREMENTS for the restrictions on branch-entry      * 00046500
*              invocation.                                            * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*                                                                     * 00047200
*      [RETCODE=xretcode]                                             * 00047300
*          is the name (RS-type) of an optional fullword output       * 00047400
*          variable, or register (2)-(12), into which the return code * 00047500
*          is to be copied from GPR 15.                               * 00047600
*                                                                     * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*                                                                     * 00048000
*      [RSNCODE=xrsncode]                                             * 00048100
*          is the name (RS-type) of an optional fullword output       * 00048200
*          variable, or register (2)-(12), into which the reason code * 00048300
*          is to be copied from GPR 0.                                * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*                                                                     * 00048800
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00048900
*          is an optional byte input decimal value in the "2-2" range * 00049000
*          that specifies the macro version.  PLISTVER is the only    * 00049100
*          key allowed on the list form of MF and determines which    * 00049200
*          parameter list is generated.  Note that MAX may be         * 00049300
*          specified instead of a number, and the parameter list will * 00049400
*          be of the largest size currently supported. This size may  * 00049500
*          grow from release to release (thus possibly affecting the  * 00049600
*          amount of storage needed by your program).  If your        * 00049700
*          program can tolerate this, IBM recommends that you always  * 00049800
*          specify MAX when creating the list form parameter list as  * 00049900
*          that will ensure that the list form parameter list is      * 00050000
*          always long enough to hold whatever parameters might be    * 00050100
*          specified on the execute form.                             * 00050200
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00050300
*          default is the lowest version which allows all of the      * 00050400
*          parameters specified on the invocation to be processed.    * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*      [MF=S|L|E]                                                   * 00051000
*          is an optional keyword input which specifies the macro     * 00051100
*          form.                                                      * 00051200
*          DEFAULT: S                                                 * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*          [MF=S]                                                     * 00051600
*              specifies the standard form of the macro.  The "S"     * 00051700
*              form generates code to put the parameters into an      * 00051800
*              in-line parameter list and invoke the desired service. * 00051900
*              Full checking for required macro keys is done along    * 00052000
*              with supplying defaults for omitted optional           * 00052100
*              parameters.                                            * 00052200
*                                                                     * 00052300
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00052400
*              specifies the list form of the macro.  The "L" form    * 00052500
*              defines an area to be used for the parameter list.     * 00052600
*              Only the PLISTVER key may be specified on the          * 00052700
*              invocation.  All other macro parameters are flagged as * 00052800
*              errors.  If PLISTVER is not specified, the original    * 00052900
*              parameter list definition is used.                     * 00053000
*                                                                     * 00053100
*            ,xmfctrl                                                 * 00053200
*              is a required input.  It is the name of a storage area * 00053300
*              for the parameter list.                                * 00053400
*                                                                     * 00053500
*            ,xmfattr|0D                                            * 00053600
*              is an optional 60 character input string that varies   * 00053700
*              from 1 to 60 characters. Use it to force boundary      * 00053800
*              alignment of the parameter list. Use only 0F or 0D.    * 00053900
*              DEFAULT: 0D which forces the parameter list to a       * 00054000
*              doubleword boundary.                                   * 00054100
*                                                                     * 00054200
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00054300
*              specifies the execute form of the macro.  The "E" form * 00054400
*              generates code to put the parameters into the          * 00054500
*              parameter list specified by xmfctrl and provides full  * 00054600
*              syntax checking with default setting.                  * 00054700
*                                                                     * 00054800
*            ,xmfctrl                                                 * 00054900
*              is a required input.  It is the name (RS-type), or     * 00055000
*              address in register (1)-(12), of a storage area for    * 00055100
*              the parameter list.                                    * 00055200
*                                                                     * 00055300
*            ,COMPLETE                                              * 00055400
*              is an optional keyword input which specifies the       * 00055500
*              degree of macro parameter syntax checking.             * 00055600
*              DEFAULT: COMPLETE                                      * 00055700
*                                                                     * 00055800
*                                                                     * 00055900
*              COMPLETE                                               * 00056000
*                  Checking for required macro keys is done and       * 00056100
*                  defaults are supplied for omitted optional         * 00056200
*                  parameters.                                        * 00056300
*                                                                     * 00056400
*                                                                     * 00056500
*                                                                     * 00056600
*                                                                     * 00056700
*                                                                     * 00056800
*                                                                     * 00056900
*                                                                     * 00057000
*01* RETURN CODES:                                                    * 00057100
*                                                                     * 00057200
*                                                                     * 00057300
*                                                                     * 00057400
*                 X'00'     Successful execution.  The address of the * 00057500
*                           UCB common segment has been returned in   * 00057600
*                           UCBPTR.  Also, the pin token has been     * 00057700
*                           returned in PTOKEN if PIN was specified.  * 00057800
*                                                                     * 00057900
*                 X'04'     No UCB exists for the device number or    * 00058000
*                           VOLSER specified as input.  The contents  * 00058100
*                           of UCBPTR remain unchanged.               * 00058200
*                                                                     * 00058300
*                 X'08'     Error in caller's parameters              * 00058400
*                                                                     * 00058500
*                           Reason codes                              * 00058600
*                                                                     * 00058700
*                                                                     * 00058800
*                           X'01'     The caller specified an invalid * 00058900
*                                     ALET.                           * 00059000
*                                                                     * 00059100
*                           X'02'     An error occurred in accessing  * 00059200
*                                     the caller's parameter list.    * 00059300
*                                                                     * 00059400
*                           X'04'     An error occurred referencing   * 00059500
*                                     the user-supplied work area for * 00059600
*                                     the UCB prefix data (UCBPAREA). * 00059700
*                                     (This reason code is valid only * 00059800
*                                     for callers using the UCBPAREA  * 00059900
*                                     keyword.                        * 00060000
*                                                                     * 00060100
*                           X'05'     An error occurred referencing   * 00060200
*                                     the user-supplied work area for * 00060300
*                                     the IOCTOKEN (IOCTOKEN).  (This * 00060400
*                                     reason code is valid only for   * 00060500
*                                     callers using the IOCTOKEN      * 00060600
*                                     keyword.                        * 00060700
*                                                                     * 00060800
*                           X'0A'     An error occurred referencing   * 00060900
*                                     the user-supplied area for the  * 00061000
*                                     pin reason text (TEXT).  (This  * 00061100
*                                     reason code is valid only for   * 00061200
*                                     callers using the TEXT          * 00061300
*                                     keyword.)                       * 00061400
*                                                                     * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*                 X'0C'     The UCB definition for the device         * 00061800
*                           represented by the look-up argument has   * 00061900
*                           changed and is no longer consistent with  * 00062000
*                           the UCB definition represented by the     * 00062100
*                           input I/O configuration token.  (This     * 00062200
*                           return code is valid only for callers     * 00062300
*                           using the IOCTOKEN keyword.               * 00062400
*                                                                     * 00062500
*                 X'10'     The UCB address was returned in UCBPTR    * 00062600
*                           and the UCB was pinned, but the paths     * 00062700
*                           could not be pinned.  (This return code   * 00062800
*                           is valid only for callers using the       * 00062900
*                           PINPATHS keyword.                         * 00063000
*                                                                     * 00063100
*                 X'20'     An unexpected error occurred.             * 00063200
*                                                                     * 00063300
*                                                                     * 00063400
*                                                                     * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*01* REASON CODES:                                                    * 00063800
*                                                                     * 00063900
*       See return codes section.                                     * 00064000
*                                                                     * 00064100
*01* MODULE TYPE:  ASSEM MACRO                                        * 00064200
*                                                                     * 00064300
*02*   PROCESSOR:  ASSEM                                              * 00064400
*                                                                     * 00064500
*01* COMPONENT:  SC1C3                                                * 00064600
*                                                                     * 00064700
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00064800
*                                                                     * 00064900
*01* MACRO USAGE NOTES:                                               * 00065000
*                                                                     * 00065100
*                                                                     * 00065200
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00065300
*        global macro variable.  Any value other than 'NO' will       * 00065400
*        result in the macro expansion being printed.  The default is * 00065500
*        'YES'.  The following examples illustrate how the ZPRINT     * 00065600
*        variable should be set.                                      * 00065700
*                                                                     * 00065800
*                    GBLC &ZPRINT                                     * 00065900
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00066000
*                                                                     * 00066100
*                                                                     * 00066200
*    2.  All keys currently contained in the UCBLOOK macro correspond * 00066300
*        to  version 2.  If you specify PLISTVER, use a value of 2 or * 00066400
*        MAX.                                                         * 00066500
*                                                                     * 00066600
*                                                                     * 00066700
*                                                                     * 00066800
*                                                                     * 00066900
*01* CHANGE ACTIVITY:                                                 * 00067000
*                                                                     * 00067100
*   Flag LineItem  FMID    Date   ID    Comment                       * 00067200
*                                                                     * 00067300
*    $L0=USERV    HBB4410 890626 PDLK:  UCB Services                  * 00067400
*    $L1=UCBVP    HBB5520 940106 PDKB:  UCB VSCR Support - Add LOC    * 00067500
*                                         keyword                     * 00067600
*    $L2=PAVS     HBB5520 940210 PDLP:  Add NONBASE keyword option    * 00067700
*    $P1=PEO3586  HBB4410 900226 PDLK:  Use macdefs=no to get around  * 00067800
*                                         AMG problem                 * 00067900
*    $P2=PH31790  HBB4420 901126 PDLS:  Add NOTFIND option            * 00068000
*    $P3=PIG3063  HBB5510 930924 PDKB:  CDPI update.                  * 00068100
*    $D1=DCR112   HBB5510 930520 PDLL:  Add UCBCXPTR and UCBPXPTR     * 00068200
*                                         options                     * 00068300
*    $D2=DCR095   HBB5520 940912 PDLU:  Changed UCBLOOK UCBCXPTR to   * 00068400
*                                         GUPI.                       * 00068500
*    $01=OW37980  HBB6603 990531 PDLZ:  Add UNBOUND_ALIAS keyword     * 00068600
*                                         option                      * 00068700
****** END OF SPECIFICATIONS *****************************************/ 00068800
*/* TLINE 1 *********************************************************** 00068900
         MACRO                                                          00069000
&XLABEL  UCBLOOK &DEVN=,&DEVNCHAR=,&VOLSER=,&DEVCLASS=,&UCBPTR=,       *00069100
               &UCBCXPTR=,&UCBPXPTR=,&LOC=,&DYNAMIC=,&RANGE=,&NONBASE=,*00069200
               &UNBOUND_ALIAS=,&NOTFIND=,&TEXT=,&PTOKEN=,&COMPID=,     *00069300
               &HELP=,&UCBPAREA=,&IOCTOKEN=,&LINKAGE=,&RETCODE=,       *00069400
               &RSNCODE=,&PLISTVER=,&MF=                                00069500
.*                                                                      00069600
*                   MACDATE -12/13/99-<2>                               00069700
.*                                                                      00069800
.*******************************************************************    00069900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00070000
.*******************************************************************    00070100
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00070200
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00070300
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00070400
.*                                                                      00070500
                   GBLC  &ZUCBLOOK   YES=MACRO USED AT LEAST ONCE       00070600
.*******************************************************************    00070700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00070800
.*******************************************************************    00070900
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00071000
                   LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS       00071100
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00071200
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00071300
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00071400
                   LCLA  &ZAWRK      USED AS A WORK AREA                00071500
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00071600
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00071700
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00071800
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00071900
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00072000
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00072100
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00072200
.*                                                                      00072300
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00072400
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00072500
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00072600
                   LCLC  &ZENDBASEPL            End of base PL          00072700
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00072800
.*******************************************************************    00072900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00073000
.*******************************************************************    00073100
                   LCLA  &ZI         INDEX FOR ARRAY                    00073200
                   LCLA  &ZJ         INDEX FOR PARMS                    00073300
                   LCLA  &ZK         INDEX FOR PARSE                    00073400
                   LCLA  &ZLO        LOW RANGE VALUE                    00073500
                   LCLA  &ZHI        HIGH RANGE VALUE                   00073600
                   LCLC  &ZW         WORK AREA FOR PARM                 00073700
.********************************************************************   00073800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00073900
.********************************************************************   00074000
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00074100
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00074200
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00074300
.*                                                                      00074400
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00074500
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00074600
                   SPLEVEL  TEST                                        00074700
.ZSYS2             ANOP  ,                                              00074800
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00074900
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00075000
                   SYSSTATE TEST                                        00075100
                   AGO   .ZSYS4                                         00075200
.ZSYS3             ANOP  ,                                              00075300
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00075400
.ZSYS4             ANOP  ,                                              00075500
.*******************************************************************    00075600
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00075700
.*******************************************************************    00075800
                   LCLC  &XDEVVAR1   ++ NAME                            00075900
                   LCLC  &XDEVN      ++ NAME                            00076000
                   LCLC  &XDEVNCHAR  ++ NAME                            00076100
                   LCLC  &XVOLSER    ++ NAME                            00076200
                   LCLC  &XDEVCLASS  ++ VALUE                           00076300
                   LCLC  &XUCBPTR    ++ NAME                            00076400
                   LCLC  &XUCBCXPTR  ++ NAME                            00076500
                   LCLC  &XUCBPXPTR  ++ NAME                            00076600
                   LCLC  &XLOC       ++ VALUE                           00076700
                   LCLC  &XDYNAMIC   ++ VALUE                           00076800
                   LCLC  &XRANGE     ++ VALUE                           00076900
                   LCLC  &XNONBASE   ++ VALUE                           00077000
                   LCLC  &XUNBOUND_ALIAS        ++ VALUE                00077100
                   LCLC  &XNOTFIND   ++ VALUE                           00077200
                   LCLC  &XPINREQ    ++ VALUE                           00077300
                   LCLC  &XPIN       ++ VALUE                           00077400
                   LCLC  &XTEXT      ++ NAME                            00077500
                   LCLC  &XPTOKEN    ++ NAME                            00077600
                   LCLC  &XCOMPID    ++ NAME                            00077700
                   LCLC  &XHELP      ++ NAME                            00077800
                   LCLC  &XLASTING   ++ VALUE                           00077900
                   LCLC  &XPINPATHS  ++ VALUE                           00078000
                   LCLC  &XNOPIN     ++ VALUE                           00078100
                   LCLC  &XUCBPAREA  ++ NAME                            00078200
                   LCLC  &XIOCTOKEN  ++ NAME                            00078300
                   LCLC  &XLINKAGE   ++ VALUE                           00078400
                   LCLC  &XRETCODE   ++ NAME                            00078500
                   LCLC  &XRSNCODE   ++ NAME                            00078600
                   LCLA  &XPLISTVER  ++ VALUE                           00078700
                   LCLC  &XMF        ++ VALUE                           00078800
                   LCLC  &XMFCTRL    ++ NAME                            00078900
                   LCLC  &XMFATTR    ++ VALUE                           00079000
                   LCLC  &XMFSCK     ++ VALUE                           00079100
.*******************************************************************    00079200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00079300
.*******************************************************************    00079400
                   LCLC  &ZXDEVVAR1  ++ INPUT NAME                      00079500
                   LCLC  &ZXDEVN     ++ INPUT NAME                      00079600
                   LCLC  &ZXDEVNCHAR            ++ INPUT NAME           00079700
                   LCLC  &ZXVOLSER   ++ INPUT NAME                      00079800
                   LCLC  &ZXDEVCLASS            ++ INPUT VALUE          00079900
                   LCLC  &ZXUCBPTR   ++ OUTPUT NAME                     00080000
                   LCLC  &ZXUCBCXPTR            ++ OUTPUT NAME          00080100
                   LCLC  &ZXUCBPXPTR            ++ OUTPUT NAME          00080200
                   LCLC  &ZXLOC      ++ INPUT VALUE                     00080300
                   LCLC  &ZXDYNAMIC  ++ INPUT VALUE                     00080400
                   LCLC  &ZXRANGE    ++ INPUT VALUE                     00080500
                   LCLC  &ZXNONBASE  ++ INPUT VALUE                     00080600
                   LCLC  &ZXUNBOUND_ALIAS       ++ INPUT VALUE          00080700
                   LCLC  &ZXNOTFIND  ++ INPUT VALUE                     00080800
                   LCLC  &ZXPINREQ   ++ INPUT VALUE                     00080900
                   LCLC  &ZXPIN      ++ INPUT VALUE                     00081000
                   LCLC  &ZXTEXT     ++ INPUT NAME                      00081100
                   LCLC  &ZXPTOKEN   ++ OUTPUT NAME                     00081200
                   LCLC  &ZXCOMPID   ++ INPUT NAME                      00081300
                   LCLC  &ZXHELP     ++ INPUT NAME                      00081400
                   LCLC  &ZXLASTING  ++ INPUT VALUE                     00081500
                   LCLC  &ZXPINPATHS            ++ INPUT VALUE          00081600
                   LCLC  &ZXNOPIN    ++ INPUT VALUE                     00081700
                   LCLC  &ZXUCBPAREA            ++ INPUT NAME           00081800
                   LCLC  &ZXIOCTOKEN            ++ INOUT NAME           00081900
                   LCLC  &ZXLINKAGE  ++ INPUT VALUE                     00082000
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00082100
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00082200
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00082300
                   LCLC  &ZXMF       ++ INPUT VALUE                     00082400
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00082500
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00082600
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00082700
.********************************************************************   00082800
.***AC.PLV01  PROCESS PLISTVER                                      *   00082900
.********************************************************************   00083000
&XPLISTVER      SETA  2                                                 00083100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00083200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00083300
&XPLISTVER      SETA  2                                                 00083400
.ZPLV0          ANOP  ,                                                 00083500
.*                                                                      00083600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00083700
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00083800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00083900
.*-------------------------------------------------------------------   00084000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00084100
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00084200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00084300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00084400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00084500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084600
                AGO   .ZPVCK2                                           00084700
.ZPVCK3         ANOP  ,                                                 00084800
.*-------------------------------------------------------------------   00084900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00085000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00085100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00085200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00085300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00085400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00085500
                AGO   .ZPVCKE                                           00085600
.ZPVCK2         ANOP  ,                                                 00085700
.*-------------------------------------------------------------------   00085800
&ZCVAL          SETC  '&PLISTVER(1)'                                    00085900
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00086000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00086100
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00086200
                AIF   (&ZN LT 2).ZPVCK6    TOO LOW                      00086300
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00086400
.ZPVCK6         ANOP  ,                                                 00086500
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00086600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00086700
&ZMS            SETC  '&ZMS THE RANGE IS "2-2"'                         00086800
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00086900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00087000
&XPLISTVER      SETA  2                                                 00087100
                AGO   .ZPVCKE                                           00087200
.*-------------------------------------------------------------------   00087300
.ZPVCK4A        ANOP  ,                                                 00087400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00087500
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00087600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00087700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00087800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00087900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00088000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00088100
                AGO   .ZPVCK5                                           00088200
.ZPVCK4         ANOP  ,                                                 00088300
&XPLISTVER      SETA  &PLISTVER(1)                                      00088400
.ZPVCK5         ANOP  ,                                                 00088500
.ZPVCKE         ANOP  ,                                                 00088600
.********************************************************************   00088700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00088800
.********************************************************************   00088900
                   ACTR  10000                                          00089000
.*------------------------------------------------------------------    00089100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089200
&XMF               SETC  ''          INITIALIZE XVARIABLE               00089300
.*-------------------------------------------------------------------   00089400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089500
.ZG95              ANOP  ,                                              00089600
&ZTLC              SETC 'S'                                             00089700
                   AIF   ('&MF(1)' NE '&ZTLC').ZG96                     00089800
&XMF               SETC  'S'         SET KEYWORD                        00089900
                   AIF   (N'&MF LE 1).ZG95A     CK NUM                  00090000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      00090100
&ZMS               SETC  '&ZMS.&MF"'                                    00090200
&ZMS               SETC  '&ZMS "MF"'                                    00090300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00090400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00090500
.ZG95A             ANOP  ,                                              00090600
.*-------------------------------------------------------------------   00090700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090800
.ZG96              ANOP  ,                                              00090900
&ZTLC              SETC 'L'                                             00091000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG103                    00091100
&XMF               SETC  'L'         SET KEYWORD                        00091200
                   AIF   (N'&MF LE 3).ZG96A     CK NUM                  00091300
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      00091400
&ZMS               SETC  '&ZMS.&MF"'                                    00091500
&ZMS               SETC  '&ZMS "MF"'                                    00091600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00091700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00091800
.ZG96A             ANOP  ,                                              00091900
.*-------------------------------------------------------------------   00092000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00092100
                   AIF   (N'&SYSLIST NE 0).ZG96B  POSITIONALS?          00092200
                   AIF   ('&DEVN' NE '').ZG96B  KEYS?                   00092300
                   AIF   ('&DEVNCHAR' NE '').ZG96B  KEYS?               00092400
                   AIF   ('&VOLSER' NE '').ZG96B  KEYS?                 00092500
                   AIF   ('&DEVCLASS' NE '').ZG96B  KEYS?               00092600
                   AIF   ('&UCBPTR' NE '').ZG96B  KEYS?                 00092700
                   AIF   ('&UCBCXPTR' NE '').ZG96B  KEYS?               00092800
                   AIF   ('&UCBPXPTR' NE '').ZG96B  KEYS?               00092900
                   AIF   ('&LOC' NE '').ZG96B   KEYS?                   00093000
                   AIF   ('&DYNAMIC' NE '').ZG96B  KEYS?                00093100
                   AIF   ('&RANGE' NE '').ZG96B  KEYS?                  00093200
                   AIF   ('&NONBASE' NE '').ZG96B  KEYS?                00093300
                   AIF   ('&UNBOUND_ALIAS' NE '').ZG96B  KEYS?          00093400
                   AIF   ('&NOTFIND' NE '').ZG96B  KEYS?                00093500
                   AIF   ('&TEXT' NE '').ZG96B  KEYS?                   00093600
                   AIF   ('&PTOKEN' NE '').ZG96B  KEYS?                 00093700
                   AIF   ('&COMPID' NE '').ZG96B  KEYS?                 00093800
                   AIF   ('&HELP' NE '').ZG96B  KEYS?                   00093900
                   AIF   ('&UCBPAREA' NE '').ZG96B  KEYS?               00094000
                   AIF   ('&IOCTOKEN' NE '').ZG96B  KEYS?               00094100
                   AIF   ('&LINKAGE' NE '').ZG96B  KEYS?                00094200
                   AIF   ('&RETCODE' NE '').ZG96B  KEYS?                00094300
                   AIF   ('&RSNCODE' NE '').ZG96B  KEYS?                00094400
                   AGO    .ZG96C     INVOCATION OKAY                    00094500
.ZG96B             ANOP  ,                                              00094600
&ZMS               SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE           00094700
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00094800
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00094900
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00095000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00095100
.ZG96C             ANOP  ,                                              00095200
.*-------------------------------------------------------------------   00095300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00095400
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00095500
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00095600
                   AIF   (N'&MF(2) GT 1).ZG98B  MULTI PARMS             00095700
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00095800
.ZG98B             AIF   (K'&MF(2) GT 0).ZG98C                          00095900
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00096000
&ZMS               SETC  ' '         *KRQDA*                            00096100
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00096200
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00096300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00096400
.ZG98C             ANOP  ,                                              00096500
.*-------------------------------------------------------------------   00096600
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00096700
                   AIF   (K'&ZXMFCTRL LE 0).ZG98P  NOT I/O              00096800
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG98P                 00096900
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00097000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      00097100
&ZMS               SETC  '&ZMS.&MF"'                                    00097200
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00097300
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00097400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00097500
.ZG98P             ANOP  ,                                              00097600
.*-------------------------------------------------------------------   00097700
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00097800
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00097900
&XMFATTR           SETC  '0D'                                           00098000
                   AIF   (K'&MF(3) LE 0).ZG101B  PARM                   00098100
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00098200
                   AIF   (N'&MF(3) GT 1).ZG101B  MULTI PARMS            00098300
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00098400
.ZG101B            ANOP  ,                                              00098500
.*-------------------------------------------------------------------   00098600
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00098700
                   AIF   (K'&ZXMFATTR LE 0).ZG101P  NOT I/O             00098800
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG101P                00098900
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00099000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      00099100
&ZMS               SETC  '&ZMS.&MF"'                                    00099200
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00099300
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00099400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00099500
.ZG101P            ANOP  ,                                              00099600
.*-------------------------------------------------------------------   00099700
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00099800
                   AIF   (K'&ZXMFATTR LE 0).ZG101S  NOT I/O             00099900
                   AIF   (K'&XMFATTR LE 60).ZG101S  LNG OK              00100000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00100100
&ZMS               SETC  '"MF='      *KLNGA* MNOTE                      00100200
&ZMS               SETC  '&ZMS.&MF"'                                    00100300
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00100400
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00100500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00100600
.ZG101S            ANOP  ,                                              00100700
.*-------------------------------------------------------------------   00100800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100900
.ZG103             ANOP  ,                                              00101000
&ZTLC              SETC 'E'                                             00101100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG111                    00101200
&XMF               SETC  'E'         SET KEYWORD                        00101300
                   AIF   (N'&MF LE 3).ZG103A    CK NUM                  00101400
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      00101500
&ZMS               SETC  '&ZMS.&MF"'                                    00101600
&ZMS               SETC  '&ZMS "MF"'                                    00101700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00101800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00101900
.ZG103A            ANOP  ,                                              00102000
.*-------------------------------------------------------------------   00102100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00102200
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00102300
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00102400
                   AIF   (N'&MF(2) GT 1).ZG105B  MULTI PARMS            00102500
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00102600
.ZG105B            AIF   (K'&MF(2) GT 0).ZG105C                         00102700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00102800
&ZMS               SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*               00102900
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00103000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00103100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00103200
.ZG105C            ANOP  ,                                              00103300
.*-------------------------------------------------------------------   00103400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00103500
                   AIF   (K'&ZXMFCTRL LE 0).ZG105R  NOT I/O             00103600
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG105R                00103700
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00103800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG105P                  00103900
                   AIF   (K'&ZCGPR GT 2).ZG105Q                         00104000
                   AIF   ('&ZCGPR' EQ '0').ZG105Q                       00104100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00104200
                   AIF   (T'&ZCGPR NE 'N').ZG105Q  INVALID REG NAME     00104300
.ZG105P            ANOP  ,                                              00104400
                   AIF   (T'&ZCGPR NE 'N').ZG105R  NON NUMERIC          00104500
                   AIF   ('&ZCGPR' LT '1').ZG105Q                       00104600
                   AIF   ('&ZCGPR' LE '12').ZG105R                      00104700
.ZG105Q            ANOP  ,                                              00104800
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      00104900
&ZMS               SETC  '&ZMS.&MF"'                                    00105000
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00105100
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00105200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00105300
.ZG105R            ANOP  ,                                              00105400
.*-------------------------------------------------------------------   00105500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105600
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00105700
.ZG109A   AIF   ('&MF(3)' NE 'COMPLETE').ZG110A                         00105800
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00105900
.*-------------------------------------------------------------------   00106000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00106100
.ZG110A            AIF   (K'&XMFSCK GT 0).ZG110C  KEYWORD               00106200
                   AIF   (K'&MF(3) LE 0).ZG110B                         00106300
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      00106400
&ZMS               SETC  '&ZMS.&MF"'                                    00106500
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00106600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00106700
&ZMS               SETC  '&ZMS "COMPLETE".'                             00106800
                   MNOTE 8,' &ZMS '                                     00106900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00107000
.ZG110B            ANOP  ,                                              00107100
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00107200
.ZG110C            ANOP  ,                                              00107300
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00107400
.*------------------------------------------------------------------    00107500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107600
.ZG111             ANOP  ,                                              00107700
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00107800
                   AIF   (K'&XMF GT 0).ZG111E   VALID ARG               00107900
                   AIF   (T'&MF EQ 'O').ZG111D  OMITTED                 00108000
&ZASYSLNDX         SETA  0                                              00108100
.ZG111A            ANOP  ,           POSITIONAL MACRO KEY               00108200
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00108300
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG111C              00108400
&ZTLC              SETC 'MF'                                            00108500
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG111A     00108600
.ZG111B            ANOP  ,                                              00108700
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00108800
&ZMS               SETC  'THE "MF" KEY'         *KOPTA* MNOTE           00108900
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00109000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00109100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00109200
                   AGO   .ZG111E                                        00109300
.ZG111C            ANOP  ,                                              00109400
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00109500
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      00109600
&ZMS               SETC  '&ZMS.&MF"'                                    00109700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00109800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00109900
&ZMS               SETC  '&ZMS "S",'                                    00110000
&ZMS               SETC  '&ZMS "L",'                                    00110100
&ZMS               SETC  '&ZMS OR "E".'                                 00110200
                   MNOTE 8,' &ZMS '                                     00110300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00110400
                   AGO   .ZG111E                                        00110500
.ZG111D            ANOP  ,                                              00110600
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00110700
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00110800
.ZG111E            ANOP  ,                                              00110900
.********************************************************************   00111000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00111100
.********************************************************************   00111200
                   ACTR  10000                                          00111300
.*-------------------------------------------------------------------   00111400
.***AG.MF03 MF=(SLE)                                                    00111500
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00111600
.*----------------------------------------------------------------***   00111700
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00111800
&XDEVVAR1          SETC  ''          INITIALIZE XVARIABLE               00111900
                   AIF   (K'&DEVN LE 0).ZG2C                            00112000
&ZXDEVVAR1         SETC  'INPUT'     SET IN/OUTPUT                      00112100
&XDEVVAR1          SETC  'DEVN'      SET XVARIABLE                      00112200
&ZXDEVN            SETC  'INPUT'     SET IN/OUTPUT                      00112300
&XDEVN             SETC  '&DEVN(1)'  SET XVARIABLE PARM                 00112400
                   AIF   (N'&DEVN GT 1).ZG2A                            00112500
&XDEVN             SETC  '&DEVN'     SET XVARIABLE PARM                 00112600
.ZG2A              AIF   (N'&DEVN LE 1).ZG2B    CK NUM                  00112700
&ZMS               SETC  '"DEVN='    *KPOSA* MNOTE                      00112800
&ZMS               SETC  '&ZMS.&DEVN"'                                  00112900
&ZMS               SETC  '&ZMS "DEVN"'                                  00113000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00113100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00113200
.ZG2B              AIF   (K'&XDEVN GT 0).ZG2C   ONE PARM                00113300
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00113400
&ZXDEVN            SETC  ''          RESET IN/OUTPUT                    00113500
&ZMS               SETC  ' '         *KRQDA*                            00113600
&ZMS               SETC  '&ZMS "DEVN" KEY AND ITS'                      00113700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00113800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00113900
.ZG2C              ANOP  ,                                              00114000
.*----------------------------------------------------------------***   00114100
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00114200
                   AIF   (K'&DEVNCHAR LE 0).ZG3D  NO ME KEY             00114300
                   AIF   (N'&DEVNCHAR LE 1).ZG3A  CK NUM                00114400
&ZMS               SETC  '"DEVNCHAR='           *KPOSA* MNOTE           00114500
&ZMS               SETC  '&ZMS.&DEVNCHAR"'                              00114600
&ZMS               SETC  '&ZMS "DEVNCHAR"'                              00114700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00114800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00114900
.ZG3A              AIF   (K'&XDEVVAR1 LE 0).ZG3B                        00115000
&ZMS               SETC  '"DEVNCHAR'            *KMEKA* MNOTE           00115100
&ZMS               SETC  '&ZMS.=&DEVNCHAR"'                             00115200
&ZMS               SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'          00115300
&ZMS               SETC  '&ZMS "&XDEVVAR1"'                             00115400
                   MNOTE 8,' &ZMS KEY.'                                 00115500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00115600
                   AGO   .ZG3D                                          00115700
.*                                                                      00115800
.ZG3B              ANOP  ,                                              00115900
&ZXDEVVAR1         SETC  'INPUT'     SET IN/OUTPUT                      00116000
&XDEVVAR1          SETC  'DEVNCHAR'  SET XVARIABLE                      00116100
&ZXDEVNCHAR        SETC  'INPUT'     SET IN/OUTPUT                      00116200
&XDEVNCHAR         SETC  '&DEVNCHAR(1)'         SET XVARIABLE PARM      00116300
                   AIF   (N'&DEVNCHAR GT 1).ZG3C                        00116400
&XDEVNCHAR         SETC  '&DEVNCHAR'            SET XVARIABLE PARM      00116500
.ZG3C              AIF   (K'&XDEVNCHAR GT 0).ZG3D  ONE PARM             00116600
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00116700
&ZXDEVNCHAR        SETC  ''          RESET IN/OUTPUT                    00116800
&ZMS               SETC  ' '         *KRQDA*                            00116900
&ZMS               SETC  '&ZMS "DEVNCHAR" KEY AND ITS'                  00117000
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00117100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00117200
.ZG3D              ANOP  ,                                              00117300
.*----------------------------------------------------------------***   00117400
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00117500
                   AIF   (K'&VOLSER LE 0).ZG4D  NO ME KEY               00117600
                   AIF   (N'&VOLSER LE 1).ZG4A  CK NUM                  00117700
&ZMS               SETC  '"VOLSER='  *KPOSA* MNOTE                      00117800
&ZMS               SETC  '&ZMS.&VOLSER"'                                00117900
&ZMS               SETC  '&ZMS "VOLSER"'                                00118000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00118100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118200
.ZG4A              AIF   (K'&XDEVVAR1 LE 0).ZG4B                        00118300
&ZMS               SETC  '"VOLSER'   *KMEKA* MNOTE                      00118400
&ZMS               SETC  '&ZMS.=&VOLSER"'                               00118500
&ZMS               SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'          00118600
&ZMS               SETC  '&ZMS "&XDEVVAR1"'                             00118700
                   MNOTE 8,' &ZMS KEY.'                                 00118800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118900
                   AGO   .ZG4D                                          00119000
.*                                                                      00119100
.ZG4B              ANOP  ,                                              00119200
&ZXDEVVAR1         SETC  'INPUT'     SET IN/OUTPUT                      00119300
&XDEVVAR1          SETC  'VOLSER'    SET XVARIABLE                      00119400
&ZXVOLSER          SETC  'INPUT'     SET IN/OUTPUT                      00119500
&XVOLSER           SETC  '&VOLSER(1)'           SET XVARIABLE PARM      00119600
                   AIF   (N'&VOLSER GT 1).ZG4C                          00119700
&XVOLSER           SETC  '&VOLSER'   SET XVARIABLE PARM                 00119800
.ZG4C              AIF   (K'&XVOLSER GT 0).ZG4D  ONE PARM               00119900
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00120000
&ZXVOLSER          SETC  ''          RESET IN/OUTPUT                    00120100
&ZMS               SETC  ' '         *KRQDA*                            00120200
&ZMS               SETC  '&ZMS "VOLSER" KEY AND ITS'                    00120300
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00120400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00120500
.ZG4D              ANOP  ,                                              00120600
.*------------------------------------------------------------------    00120700
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00120800
                   AIF   (K'&XDEVVAR1 GT 0).ZG11B                       00120900
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00121000
&ZXDEVN            SETC  ''          RESET IN/OUTPUT                    00121100
&XDEVVAR1          SETC  ''          ENSURE NULL                        00121200
&XDEVN             SETC  ''          ENSURE NULL                        00121300
&ZMS               SETC  'ONE OF THE FOLLOWING'  *KMERA* MNOTE          00121400
&ZMS               SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'            00121500
&ZMS               SETC  '&ZMS REQUIRED:'                               00121600
&ZMS               SETC  '&ZMS "DEVN",'         VALID ME KEY            00121700
&ZMS               SETC  '&ZMS "DEVNCHAR",'     VALID ME KEY            00121800
&ZMS               SETC  '&ZMS OR "VOLSER".'    VALID ME KEY            00121900
                   MNOTE 8,' &ZMS '                                     00122000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00122100
.ZG11B             ANOP  ,                                              00122200
.*-------------------------------------------------------------------   00122300
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00122400
.ZG2               AIF   ('&XDEVVAR1' NE 'DEVN').ZG3                    00122500
.*-------------------------------------------------------------------   00122600
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00122700
&ZCVAL             SETC ''           ERROR KEY FIELD                    00122800
.ZG2I0             AIF   (K'&DEVCLASS LE 0).ZG2I1                       00122900
&ZCVAL             SETC '&ZCVAL DEVCLASS'       DISALLOWED KEY          00123000
.ZG2I1             AIF   (K'&ZCVAL LE 0).ZG2J   KEY                     00123100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00123200
&ZMS               SETC  '"DEVN'     *KMEIA* MNOTE                      00123300
&ZMS               SETC  '&ZMS.=&DEVN"'                                 00123400
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00123500
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00123600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00123700
.ZG2J              ANOP  ,                                              00123800
.*-------------------------------------------------------------------   00123900
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00124000
                   AIF   (K'&ZXDEVN LE 0).ZG2R  NOT I/O                 00124100
                   AIF   ('&XDEVN'(1,1) NE '(').ZG2R                    00124200
&ZCGPR             SETC  '&XDEVN'(2,K'&XDEVN-2)                         00124300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                    00124400
                   AIF   (K'&ZCGPR GT 2).ZG2Q                           00124500
                   AIF   ('&ZCGPR' EQ '0').ZG2Q                         00124600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00124700
                   AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME       00124800
.ZG2P              ANOP  ,                                              00124900
                   AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC            00125000
                   AIF   ('&ZCGPR' LT '2').ZG2Q                         00125100
                   AIF   ('&ZCGPR' LE '12').ZG2R                        00125200
.ZG2Q              ANOP  ,                                              00125300
&ZMS               SETC  '"DEVN='    *KGPRA* MNOTE                      00125400
&ZMS               SETC  '&ZMS.&DEVN"'                                  00125500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00125600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00125700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00125800
.ZG2R              ANOP  ,                                              00125900
.*-------------------------------------------------------------------   00126000
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00126100
.ZG3               AIF   ('&XDEVVAR1' NE 'DEVNCHAR').ZG4                00126200
.*-------------------------------------------------------------------   00126300
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00126400
&ZCVAL             SETC ''           ERROR KEY FIELD                    00126500
.ZG3I0             AIF   (K'&DEVCLASS LE 0).ZG3I1                       00126600
&ZCVAL             SETC '&ZCVAL DEVCLASS'       DISALLOWED KEY          00126700
.ZG3I1             AIF   (K'&ZCVAL LE 0).ZG3J   KEY                     00126800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00126900
&ZMS               SETC  '"DEVNCHAR'            *KMEIA* MNOTE           00127000
&ZMS               SETC  '&ZMS.=&DEVNCHAR"'                             00127100
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00127200
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00127300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00127400
.ZG3J              ANOP  ,                                              00127500
.*-------------------------------------------------------------------   00127600
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00127700
                   AIF   (K'&ZXDEVNCHAR LE 0).ZG3R  NOT I/O             00127800
                   AIF   ('&XDEVNCHAR'(1,1) NE '(').ZG3R                00127900
&ZCGPR             SETC  '&XDEVNCHAR'(2,K'&XDEVNCHAR-2)                 00128000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                    00128100
                   AIF   (K'&ZCGPR GT 2).ZG3Q                           00128200
                   AIF   ('&ZCGPR' EQ '0').ZG3Q                         00128300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00128400
                   AIF   (T'&ZCGPR NE 'N').ZG3Q  INVALID REG NAME       00128500
.ZG3P              ANOP  ,                                              00128600
                   AIF   (T'&ZCGPR NE 'N').ZG3R  NON NUMERIC            00128700
                   AIF   ('&ZCGPR' LT '2').ZG3Q                         00128800
                   AIF   ('&ZCGPR' LE '12').ZG3R                        00128900
.ZG3Q              ANOP  ,                                              00129000
&ZMS               SETC  '"DEVNCHAR='           *KGPRA* MNOTE           00129100
&ZMS               SETC  '&ZMS.&DEVNCHAR"'                              00129200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00129300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00129400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00129500
.ZG3R              ANOP  ,                                              00129600
.*-------------------------------------------------------------------   00129700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00129800
.ZG4               AIF   ('&XDEVVAR1' NE 'VOLSER').ZG11                 00129900
.*-------------------------------------------------------------------   00130000
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00130100
                   AIF   (K'&ZXVOLSER LE 0).ZG4R  NOT I/O               00130200
                   AIF   ('&XVOLSER'(1,1) NE '(').ZG4R                  00130300
&ZCGPR             SETC  '&XVOLSER'(2,K'&XVOLSER-2)                     00130400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                    00130500
                   AIF   (K'&ZCGPR GT 2).ZG4Q                           00130600
                   AIF   ('&ZCGPR' EQ '0').ZG4Q                         00130700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00130800
                   AIF   (T'&ZCGPR NE 'N').ZG4Q  INVALID REG NAME       00130900
.ZG4P              ANOP  ,                                              00131000
                   AIF   (T'&ZCGPR NE 'N').ZG4R  NON NUMERIC            00131100
                   AIF   ('&ZCGPR' LT '2').ZG4Q                         00131200
                   AIF   ('&ZCGPR' LE '12').ZG4R                        00131300
.ZG4Q              ANOP  ,                                              00131400
&ZMS               SETC  '"VOLSER='  *KGPRA* MNOTE                      00131500
&ZMS               SETC  '&ZMS.&VOLSER"'                                00131600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00131700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00131800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00131900
.ZG4R              ANOP  ,                                              00132000
.*----------------------------------------------------------------***   00132100
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00132200
                   AIF   (N'&DEVCLASS LE 1).ZG6A  CK NUM                00132300
&ZMS               SETC  '"DEVCLASS='           *KPOSA* MNOTE           00132400
&ZMS               SETC  '&ZMS.&DEVCLASS"'                              00132500
&ZMS               SETC  '&ZMS "DEVCLASS"'                              00132600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00132700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00132800
.ZG6A              ANOP  ,                                              00132900
.*-------------------------------------------------------------------   00133000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00133100
&XDEVCLASS         SETC  ''          INITIALIZE XVARIABLE               00133200
.ZG7A   AIF   ('&DEVCLASS(1)' NE 'DASDTAPE').ZG8A                       00133300
&XDEVCLASS         SETC  'DASDTAPE'  SET KEYWORD                        00133400
.*-------------------------------------------------------------------   00133500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00133600
.ZG8A   AIF   ('&DEVCLASS(1)' NE 'TAPE').ZG9A                           00133700
&XDEVCLASS         SETC  'TAPE'      SET KEYWORD                        00133800
.*-------------------------------------------------------------------   00133900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00134000
.ZG9A   AIF   ('&DEVCLASS(1)' NE 'DASD').ZG10A                          00134100
&XDEVCLASS         SETC  'DASD'      SET KEYWORD                        00134200
.*-------------------------------------------------------------------   00134300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00134400
.ZG10A             AIF   (K'&XDEVCLASS GT 0).ZG10C  KEYWORD             00134500
                   AIF   (K'&DEVCLASS(1) LE 0).ZG10B                    00134600
&ZMS               SETC  '"DEVCLASS='           *KUKWA* MNOTE           00134700
&ZMS               SETC  '&ZMS.&DEVCLASS"'                              00134800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00134900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00135000
&ZMS               SETC  '&ZMS "DASDTAPE",'                             00135100
&ZMS               SETC  '&ZMS "TAPE",'                                 00135200
&ZMS               SETC  '&ZMS OR "DASD".'                              00135300
                   MNOTE 8,' &ZMS '                                     00135400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00135500
.ZG10B             ANOP  ,                                              00135600
&XDEVCLASS         SETC  'DASDTAPE'  SET DEFAULT KEYWORD                00135700
.ZG10C             ANOP  ,                                              00135800
&ZXDEVCLASS        SETC  'INPUT'     SET IN/OUTPUT                      00135900
.*-------------------------------------------------------------------   00136000
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00136100
.ZG11              ANOP  ,           END MUTUALLY EXCLUSIVE KEYS        00136200
.*----------------------------------------------------------------***   00136300
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00136400
                   AIF   (N'&UCBPTR LE 1).ZG13A  CK NUM                 00136500
&ZMS               SETC  '"UCBPTR='  *KPOSA* MNOTE                      00136600
&ZMS               SETC  '&ZMS.&UCBPTR"'                                00136700
&ZMS               SETC  '&ZMS "UCBPTR"'                                00136800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00136900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00137000
.ZG13A             ANOP  ,                                              00137100
.*-------------------------------------------------------------------   00137200
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00137300
&ZXUCBPTR          SETC  'OUTPUT'    SET IN/OUTPUT                      00137400
&XUCBPTR           SETC  '&UCBPTR(1)'           SET XVARIABLE           00137500
                   AIF   (N'&UCBPTR GT 1).ZG13B  MULTI PARMS            00137600
&XUCBPTR           SETC  '&UCBPTR'   SET XVARIABLE                      00137700
.ZG13B             AIF   (K'&UCBPTR(1) GT 0).ZG13C                      00137800
&ZXUCBPTR          SETC  ''          RESET IN/OUTPUT                    00137900
&ZMS               SETC  ' '         *KRQDA*                            00138000
&ZMS               SETC  '&ZMS "UCBPTR" KEY AND ITS'                    00138100
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00138200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00138300
.ZG13C             ANOP  ,                                              00138400
.*-------------------------------------------------------------------   00138500
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00138600
                   AIF   (K'&ZXUCBPTR LE 0).ZG13R  NOT I/O              00138700
                   AIF   ('&XUCBPTR'(1,1) NE '(').ZG13R                 00138800
&ZCGPR             SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                     00138900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG13P                   00139000
                   AIF   (K'&ZCGPR GT 2).ZG13Q                          00139100
                   AIF   ('&ZCGPR' EQ '0').ZG13Q                        00139200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00139300
                   AIF   (T'&ZCGPR NE 'N').ZG13Q  INVALID REG NAME      00139400
.ZG13P             ANOP  ,                                              00139500
                   AIF   (T'&ZCGPR NE 'N').ZG13R  NON NUMERIC           00139600
                   AIF   ('&ZCGPR' LT '2').ZG13Q                        00139700
                   AIF   ('&ZCGPR' LE '12').ZG13R                       00139800
.ZG13Q             ANOP  ,                                              00139900
&ZMS               SETC  '"UCBPTR='  *KGPRA* MNOTE                      00140000
&ZMS               SETC  '&ZMS.&UCBPTR"'                                00140100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00140200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00140300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00140400
.ZG13R             ANOP  ,                                              00140500
.*----------------------------------------------------------------***   00140600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00140700
                   AIF   (N'&UCBCXPTR LE 1).ZG16A  CK NUM               00140800
&ZMS               SETC  '"UCBCXPTR='           *KPOSA* MNOTE           00140900
&ZMS               SETC  '&ZMS.&UCBCXPTR"'                              00141000
&ZMS               SETC  '&ZMS "UCBCXPTR"'                              00141100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00141200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00141300
.ZG16A             ANOP  ,                                              00141400
.*-------------------------------------------------------------------   00141500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00141600
                   AIF   (K'&UCBCXPTR(1) LE 0).ZG16C  NO PARM           00141700
&ZXUCBCXPTR        SETC  'OUTPUT'    SET OUTPUT                         00141800
&XUCBCXPTR         SETC  '&UCBCXPTR(1)'         SET XVARIABLE           00141900
                   AIF   (N'&UCBCXPTR GT 1).ZG16C                       00142000
&XUCBCXPTR         SETC  '&UCBCXPTR'            SET XVARIABLE           00142100
.ZG16C             ANOP  ,                                              00142200
.*-------------------------------------------------------------------   00142300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00142400
                   AIF   (K'&ZXUCBCXPTR LE 0).ZG16R  NOT I/O            00142500
                   AIF   ('&XUCBCXPTR'(1,1) NE '(').ZG16R               00142600
&ZCGPR             SETC  '&XUCBCXPTR'(2,K'&XUCBCXPTR-2)                 00142700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                   00142800
                   AIF   (K'&ZCGPR GT 2).ZG16Q                          00142900
                   AIF   ('&ZCGPR' EQ '0').ZG16Q                        00143000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00143100
                   AIF   (T'&ZCGPR NE 'N').ZG16Q  INVALID REG NAME      00143200
.ZG16P             ANOP  ,                                              00143300
                   AIF   (T'&ZCGPR NE 'N').ZG16R  NON NUMERIC           00143400
                   AIF   ('&ZCGPR' LT '2').ZG16Q                        00143500
                   AIF   ('&ZCGPR' LE '12').ZG16R                       00143600
.ZG16Q             ANOP  ,                                              00143700
&ZMS               SETC  '"UCBCXPTR='           *KGPRA* MNOTE           00143800
&ZMS               SETC  '&ZMS.&UCBCXPTR"'                              00143900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00144000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00144100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00144200
.ZG16R             ANOP  ,                                              00144300
.*----------------------------------------------------------------***   00144400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00144500
                   AIF   (N'&UCBPXPTR LE 1).ZG19A  CK NUM               00144600
&ZMS               SETC  '"UCBPXPTR='           *KPOSA* MNOTE           00144700
&ZMS               SETC  '&ZMS.&UCBPXPTR"'                              00144800
&ZMS               SETC  '&ZMS "UCBPXPTR"'                              00144900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00145000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00145100
.ZG19A             ANOP  ,                                              00145200
.*-------------------------------------------------------------------   00145300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00145400
                   AIF   (K'&UCBPXPTR(1) LE 0).ZG19C  NO PARM           00145500
&ZXUCBPXPTR        SETC  'OUTPUT'    SET OUTPUT                         00145600
&XUCBPXPTR         SETC  '&UCBPXPTR(1)'         SET XVARIABLE           00145700
                   AIF   (N'&UCBPXPTR GT 1).ZG19C                       00145800
&XUCBPXPTR         SETC  '&UCBPXPTR'            SET XVARIABLE           00145900
.ZG19C             ANOP  ,                                              00146000
.*-------------------------------------------------------------------   00146100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00146200
                   AIF   (K'&ZXUCBPXPTR LE 0).ZG19R  NOT I/O            00146300
                   AIF   ('&XUCBPXPTR'(1,1) NE '(').ZG19R               00146400
&ZCGPR             SETC  '&XUCBPXPTR'(2,K'&XUCBPXPTR-2)                 00146500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                   00146600
                   AIF   (K'&ZCGPR GT 2).ZG19Q                          00146700
                   AIF   ('&ZCGPR' EQ '0').ZG19Q                        00146800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00146900
                   AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME      00147000
.ZG19P             ANOP  ,                                              00147100
                   AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC           00147200
                   AIF   ('&ZCGPR' LT '2').ZG19Q                        00147300
                   AIF   ('&ZCGPR' LE '12').ZG19R                       00147400
.ZG19Q             ANOP  ,                                              00147500
&ZMS               SETC  '"UCBPXPTR='           *KGPRA* MNOTE           00147600
&ZMS               SETC  '&ZMS.&UCBPXPTR"'                              00147700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00147800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00147900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00148000
.ZG19R             ANOP  ,                                              00148100
.*----------------------------------------------------------------***   00148200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00148300
                   AIF   (N'&LOC LE 1).ZG22A    CK NUM                  00148400
&ZMS               SETC  '"LOC='     *KPOSA* MNOTE                      00148500
&ZMS               SETC  '&ZMS.&LOC"'                                   00148600
&ZMS               SETC  '&ZMS "LOC"'                                   00148700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00148800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00148900
.ZG22A             ANOP  ,                                              00149000
.*-------------------------------------------------------------------   00149100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00149200
&XLOC              SETC  ''          INITIALIZE XVARIABLE               00149300
.ZG23A   AIF   ('&LOC(1)' NE 'BELOW').ZG24A                             00149400
&XLOC              SETC  'BELOW'     SET KEYWORD                        00149500
.*-------------------------------------------------------------------   00149600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00149700
.ZG24A   AIF   ('&LOC(1)' NE 'ANY').ZG25A                               00149800
&XLOC              SETC  'ANY'       SET KEYWORD                        00149900
.*-------------------------------------------------------------------   00150000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00150100
.ZG25A             AIF   (K'&XLOC GT 0).ZG25C   KEYWORD                 00150200
                   AIF   (K'&LOC(1) LE 0).ZG25B                         00150300
&ZMS               SETC  '"LOC='     *KUKWA* MNOTE                      00150400
&ZMS               SETC  '&ZMS.&LOC"'                                   00150500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00150600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00150700
&ZMS               SETC  '&ZMS "BELOW"'                                 00150800
&ZMS               SETC  '&ZMS OR "ANY".'                               00150900
                   MNOTE 8,' &ZMS '                                     00151000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00151100
.ZG25B             ANOP  ,                                              00151200
&XLOC              SETC  'BELOW'     SET DEFAULT KEYWORD                00151300
.ZG25C             ANOP  ,                                              00151400
&ZXLOC             SETC  'INPUT'     SET IN/OUTPUT                      00151500
.*----------------------------------------------------------------***   00151600
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00151700
                   AIF   (N'&DYNAMIC LE 1).ZG27A  CK NUM                00151800
&ZMS               SETC  '"DYNAMIC='            *KPOSA* MNOTE           00151900
&ZMS               SETC  '&ZMS.&DYNAMIC"'                               00152000
&ZMS               SETC  '&ZMS "DYNAMIC"'                               00152100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00152200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00152300
.ZG27A             ANOP  ,                                              00152400
.*-------------------------------------------------------------------   00152500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00152600
&XDYNAMIC          SETC  ''          INITIALIZE XVARIABLE               00152700
.ZG28A   AIF   ('&DYNAMIC(1)' NE 'NO').ZG29A                            00152800
&XDYNAMIC          SETC  'NO'        SET KEYWORD                        00152900
.*-------------------------------------------------------------------   00153000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153100
.ZG29A   AIF   ('&DYNAMIC(1)' NE 'YES').ZG30A                           00153200
&XDYNAMIC          SETC  'YES'       SET KEYWORD                        00153300
.*-------------------------------------------------------------------   00153400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153500
.ZG30A             AIF   (K'&XDYNAMIC GT 0).ZG30C  KEYWORD              00153600
                   AIF   (K'&DYNAMIC(1) LE 0).ZG30B                     00153700
&ZMS               SETC  '"DYNAMIC='            *KUKWA* MNOTE           00153800
&ZMS               SETC  '&ZMS.&DYNAMIC"'                               00153900
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00154000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00154100
&ZMS               SETC  '&ZMS "NO"'                                    00154200
&ZMS               SETC  '&ZMS OR "YES".'                               00154300
                   MNOTE 8,' &ZMS '                                     00154400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00154500
.ZG30B             ANOP  ,                                              00154600
&XDYNAMIC          SETC  'NO'        SET DEFAULT KEYWORD                00154700
.ZG30C             ANOP  ,                                              00154800
&ZXDYNAMIC         SETC  'INPUT'     SET IN/OUTPUT                      00154900
.*----------------------------------------------------------------***   00155000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00155100
                   AIF   (N'&RANGE LE 1).ZG32A  CK NUM                  00155200
&ZMS               SETC  '"RANGE='   *KPOSA* MNOTE                      00155300
&ZMS               SETC  '&ZMS.&RANGE"'                                 00155400
&ZMS               SETC  '&ZMS "RANGE"'                                 00155500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00155600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00155700
.ZG32A             ANOP  ,                                              00155800
.*-------------------------------------------------------------------   00155900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00156000
&XRANGE            SETC  ''          INITIALIZE XVARIABLE               00156100
.ZG33A   AIF   ('&RANGE(1)' NE '3DIGIT').ZG34A                          00156200
&XRANGE            SETC  '3DIGIT'    SET KEYWORD                        00156300
.*-------------------------------------------------------------------   00156400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00156500
.ZG34A   AIF   ('&RANGE(1)' NE 'ALL').ZG35A                             00156600
&XRANGE            SETC  'ALL'       SET KEYWORD                        00156700
.*-------------------------------------------------------------------   00156800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00156900
.ZG35A             AIF   (K'&XRANGE GT 0).ZG35C  KEYWORD                00157000
                   AIF   (K'&RANGE(1) LE 0).ZG35B                       00157100
&ZMS               SETC  '"RANGE='   *KUKWA* MNOTE                      00157200
&ZMS               SETC  '&ZMS.&RANGE"'                                 00157300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00157400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00157500
&ZMS               SETC  '&ZMS "3DIGIT"'                                00157600
&ZMS               SETC  '&ZMS OR "ALL".'                               00157700
                   MNOTE 8,' &ZMS '                                     00157800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00157900
.ZG35B             ANOP  ,                                              00158000
&XRANGE            SETC  '3DIGIT'    SET DEFAULT KEYWORD                00158100
.ZG35C             ANOP  ,                                              00158200
&ZXRANGE           SETC  'INPUT'     SET IN/OUTPUT                      00158300
.*----------------------------------------------------------------***   00158400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00158500
                   AIF   (N'&NONBASE LE 1).ZG37A  CK NUM                00158600
&ZMS               SETC  '"NONBASE='            *KPOSA* MNOTE           00158700
&ZMS               SETC  '&ZMS.&NONBASE"'                               00158800
&ZMS               SETC  '&ZMS "NONBASE"'                               00158900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00159000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00159100
.ZG37A             ANOP  ,                                              00159200
.*-------------------------------------------------------------------   00159300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159400
&XNONBASE          SETC  ''          INITIALIZE XVARIABLE               00159500
.ZG38A   AIF   ('&NONBASE(1)' NE 'NO').ZG39A                            00159600
&XNONBASE          SETC  'NO'        SET KEYWORD                        00159700
.*-------------------------------------------------------------------   00159800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159900
.ZG39A   AIF   ('&NONBASE(1)' NE 'YES').ZG40A                           00160000
&XNONBASE          SETC  'YES'       SET KEYWORD                        00160100
.*-------------------------------------------------------------------   00160200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00160300
.ZG40A             AIF   (K'&XNONBASE GT 0).ZG40C  KEYWORD              00160400
                   AIF   (K'&NONBASE(1) LE 0).ZG40B                     00160500
&ZMS               SETC  '"NONBASE='            *KUKWA* MNOTE           00160600
&ZMS               SETC  '&ZMS.&NONBASE"'                               00160700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00160800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00160900
&ZMS               SETC  '&ZMS "NO"'                                    00161000
&ZMS               SETC  '&ZMS OR "YES".'                               00161100
                   MNOTE 8,' &ZMS '                                     00161200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00161300
.ZG40B             ANOP  ,                                              00161400
&XNONBASE          SETC  'NO'        SET DEFAULT KEYWORD                00161500
.ZG40C             ANOP  ,                                              00161600
&ZXNONBASE         SETC  'INPUT'     SET IN/OUTPUT                      00161700
.*----------------------------------------------------------------***   00161800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00161900
                   AIF   (N'&UNBOUND_ALIAS LE 1).ZG42A  CK NUM          00162000
&ZMS               SETC  '"UNBOUND_ALIAS='      *KPOSA* MNOTE           00162100
&ZMS               SETC  '&ZMS.&UNBOUND_ALIAS"'                         00162200
&ZMS               SETC  '&ZMS "UNBOUND_ALIAS"'                         00162300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00162400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00162500
.ZG42A             ANOP  ,                                              00162600
.*-------------------------------------------------------------------   00162700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00162800
&XUNBOUND_ALIAS    SETC  ''          INITIALIZE XVARIABLE               00162900
.ZG43A   AIF   ('&UNBOUND_ALIAS(1)' NE 'NO').ZG44A                      00163000
&XUNBOUND_ALIAS    SETC  'NO'        SET KEYWORD                        00163100
.*-------------------------------------------------------------------   00163200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00163300
.ZG44A   AIF   ('&UNBOUND_ALIAS(1)' NE 'YES').ZG45A                     00163400
&XUNBOUND_ALIAS    SETC  'YES'       SET KEYWORD                        00163500
.*-------------------------------------------------------------------   00163600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00163700
.ZG45A             AIF   (K'&XUNBOUND_ALIAS GT 0).ZG45C  KEYWORD        00163800
                   AIF   (K'&UNBOUND_ALIAS(1) LE 0).ZG45B               00163900
&ZMS               SETC  '"UNBOUND_ALIAS='      *KUKWA* MNOTE           00164000
&ZMS               SETC  '&ZMS.&UNBOUND_ALIAS"'                         00164100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00164200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00164300
&ZMS               SETC  '&ZMS "NO"'                                    00164400
&ZMS               SETC  '&ZMS OR "YES".'                               00164500
                   MNOTE 8,' &ZMS '                                     00164600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00164700
.ZG45B             ANOP  ,                                              00164800
&XUNBOUND_ALIAS    SETC  'NO'        SET DEFAULT KEYWORD                00164900
.ZG45C             ANOP  ,                                              00165000
&ZXUNBOUND_ALIAS   SETC  'INPUT'     SET IN/OUTPUT                      00165100
.*----------------------------------------------------------------***   00165200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00165300
                   AIF   (N'&NOTFIND LE 1).ZG47A  CK NUM                00165400
&ZMS               SETC  '"NOTFIND='            *KPOSA* MNOTE           00165500
&ZMS               SETC  '&ZMS.&NOTFIND"'                               00165600
&ZMS               SETC  '&ZMS "NOTFIND"'                               00165700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00165800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00165900
.ZG47A             ANOP  ,                                              00166000
.*-------------------------------------------------------------------   00166100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00166200
&XNOTFIND          SETC  ''          INITIALIZE XVARIABLE               00166300
.ZG48A   AIF   ('&NOTFIND(1)' NE 'NO').ZG49A                            00166400
&XNOTFIND          SETC  'NO'        SET KEYWORD                        00166500
.*-------------------------------------------------------------------   00166600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00166700
.ZG49A   AIF   ('&NOTFIND(1)' NE 'YES').ZG50A                           00166800
&XNOTFIND          SETC  'YES'       SET KEYWORD                        00166900
.*-------------------------------------------------------------------   00167000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00167100
.ZG50A             AIF   (K'&XNOTFIND GT 0).ZG50C  KEYWORD              00167200
                   AIF   (K'&NOTFIND(1) LE 0).ZG50B                     00167300
&ZMS               SETC  '"NOTFIND='            *KUKWA* MNOTE           00167400
&ZMS               SETC  '&ZMS.&NOTFIND"'                               00167500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00167600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00167700
&ZMS               SETC  '&ZMS "NO"'                                    00167800
&ZMS               SETC  '&ZMS OR "YES".'                               00167900
                   MNOTE 8,' &ZMS '                                     00168000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00168100
.ZG50B             ANOP  ,                                              00168200
&XNOTFIND          SETC  'NO'        SET DEFAULT KEYWORD                00168300
.ZG50C             ANOP  ,                                              00168400
&ZXNOTFIND         SETC  'INPUT'     SET IN/OUTPUT                      00168500
.*-------------------------------------------------------------------   00168600
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00168700
&XPINREQ           SETC  ''          INITIALIZE XVARIABLE               00168800
&ZASYSLNDX         SETA  0                                              00168900
.ZG52A             ANOP  ,           POSITIONAL KEY SEARCH              00169000
&ZASYSLNDX         SETA  &ZASYSLNDX+1           NEXT POSITIONAL         00169100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG52B  DONE                   00169200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG52A            00169300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'PIN').ZG52A                  00169400
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00169500
&ZXPINREQ          SETC  'INPUT'     SET IN/OUTPUT                      00169600
&XPINREQ           SETC  'PIN'       SET XVARIABLE                      00169700
&ZXPIN             SETC  'INPUT'     SET IN/OUTPUT                      00169800
&XPIN              SETC  'PIN'       SET XVARIABLE PARM                 00169900
.ZG52B             ANOP  ,                                              00170000
.*-------------------------------------------------------------------   00170100
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00170200
&ZASYSLNDX         SETA  0                                              00170300
.ZG71A             ANOP  ,           POSITIONAL KEY SEARCH              00170400
&ZASYSLNDX         SETA  &ZASYSLNDX+1           NEXT POSITIONAL         00170500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG71C  DONE                   00170600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG71A            00170700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'NOPIN').ZG71A                00170800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00170900
                   AIF   (K'&XPINREQ LE 0).ZG71B  VALID                 00171000
&ZMS               SETC  '"NOPIN'    *KMEKA* MNOTE                      00171100
&ZMS               SETC  '&ZMS."'                                       00171200
&ZMS               SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'          00171300
&ZMS               SETC  '&ZMS "&XPINREQ"'                              00171400
                   MNOTE 8,' &ZMS KEY.'                                 00171500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00171600
                   AGO   .ZG71C                                         00171700
.*                                                                      00171800
.ZG71B             ANOP  ,                                              00171900
&ZXPINREQ          SETC  'INPUT'     SET IN/OUTPUT                      00172000
&XPINREQ           SETC  'NOPIN'     SET XVARIABLE                      00172100
&ZXNOPIN           SETC  'INPUT'     SET IN/OUTPUT                      00172200
&XNOPIN            SETC  'NOPIN'     SET XVARIABLE PARM                 00172300
.ZG71C             ANOP  ,                                              00172400
.*------------------------------------------------------------------    00172500
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00172600
                   AIF   (K'&XPINREQ GT 0).ZG72B                        00172700
&ZXPINREQ          SETC  ''          RESET IN/OUTPUT                    00172800
&ZXPIN             SETC  ''          RESET IN/OUTPUT                    00172900
&XPINREQ           SETC  ''          ENSURE NULL                        00173000
&XPIN              SETC  ''          ENSURE NULL                        00173100
&ZMS               SETC  'ONE OF THE FOLLOWING'  *KMERA* MNOTE          00173200
&ZMS               SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'            00173300
&ZMS               SETC  '&ZMS REQUIRED:'                               00173400
&ZMS               SETC  '&ZMS "PIN"'           VALID ME KEY            00173500
&ZMS               SETC  '&ZMS OR "NOPIN".'     VALID ME KEY            00173600
                   MNOTE 8,' &ZMS '                                     00173700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00173800
.ZG72B             ANOP  ,                                              00173900
.*-------------------------------------------------------------------   00174000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00174100
.ZG52              AIF   ('&XPINREQ' NE 'PIN').ZG71                     00174200
.*----------------------------------------------------------------***   00174300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00174400
                   AIF   (N'&TEXT LE 1).ZG54A   CK NUM                  00174500
&ZMS               SETC  '"TEXT='    *KPOSA* MNOTE                      00174600
&ZMS               SETC  '&ZMS.&TEXT"'                                  00174700
&ZMS               SETC  '&ZMS "TEXT"'                                  00174800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00174900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00175000
.ZG54A             ANOP  ,                                              00175100
.*-------------------------------------------------------------------   00175200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00175300
&ZXTEXT            SETC  'INPUT'     SET IN/OUTPUT                      00175400
&XTEXT             SETC  '&TEXT(1)'  SET XVARIABLE                      00175500
                   AIF   (N'&TEXT GT 1).ZG54B   MULTI PARMS             00175600
&XTEXT             SETC  '&TEXT'     SET XVARIABLE                      00175700
.ZG54B             AIF   (K'&TEXT(1) GT 0).ZG54C                        00175800
&ZXTEXT            SETC  ''          RESET IN/OUTPUT                    00175900
&ZMS               SETC  ' '         *KRQDA*                            00176000
&ZMS               SETC  '&ZMS "TEXT" KEY AND ITS'                      00176100
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00176200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00176300
.ZG54C             ANOP  ,                                              00176400
.*-------------------------------------------------------------------   00176500
.***AG.KCK01 NAME, RQD INPUT, KEYS -GPR NOT ALLOWED                     00176600
                   AIF   (K'&ZXTEXT LE 0).ZG54P  NOT I/O                00176700
                   AIF   ('&XTEXT'(1,1) NE '(').ZG54P                   00176800
&ZXTEXT            SETC  ''          RESET IN/OUTPUT                    00176900
&ZMS               SETC  '"TEXT='    *KGPRA* MNOTE                      00177000
&ZMS               SETC  '&ZMS.&TEXT"'                                  00177100
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00177200
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'              00177300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00177400
.ZG54P             ANOP  ,                                              00177500
.*----------------------------------------------------------------***   00177600
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00177700
                   AIF   (N'&PTOKEN LE 1).ZG57A  CK NUM                 00177800
&ZMS               SETC  '"PTOKEN='  *KPOSA* MNOTE                      00177900
&ZMS               SETC  '&ZMS.&PTOKEN"'                                00178000
&ZMS               SETC  '&ZMS "PTOKEN"'                                00178100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00178200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00178300
.ZG57A             ANOP  ,                                              00178400
.*-------------------------------------------------------------------   00178500
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00178600
&ZXPTOKEN          SETC  'OUTPUT'    SET IN/OUTPUT                      00178700
&XPTOKEN           SETC  '&PTOKEN(1)'           SET XVARIABLE           00178800
                   AIF   (N'&PTOKEN GT 1).ZG57B  MULTI PARMS            00178900
&XPTOKEN           SETC  '&PTOKEN'   SET XVARIABLE                      00179000
.ZG57B             AIF   (K'&PTOKEN(1) GT 0).ZG57C                      00179100
&ZXPTOKEN          SETC  ''          RESET IN/OUTPUT                    00179200
&ZMS               SETC  ' '         *KRQDA*                            00179300
&ZMS               SETC  '&ZMS "PTOKEN" KEY AND ITS'                    00179400
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00179500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00179600
.ZG57C             ANOP  ,                                              00179700
.*-------------------------------------------------------------------   00179800
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00179900
                   AIF   (K'&ZXPTOKEN LE 0).ZG57R  NOT I/O              00180000
                   AIF   ('&XPTOKEN'(1,1) NE '(').ZG57R                 00180100
&ZCGPR             SETC  '&XPTOKEN'(2,K'&XPTOKEN-2)                     00180200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                   00180300
                   AIF   (K'&ZCGPR GT 2).ZG57Q                          00180400
                   AIF   ('&ZCGPR' EQ '0').ZG57Q                        00180500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00180600
                   AIF   (T'&ZCGPR NE 'N').ZG57Q  INVALID REG NAME      00180700
.ZG57P             ANOP  ,                                              00180800
                   AIF   (T'&ZCGPR NE 'N').ZG57R  NON NUMERIC           00180900
                   AIF   ('&ZCGPR' LT '2').ZG57Q                        00181000
                   AIF   ('&ZCGPR' LE '12').ZG57R                       00181100
.ZG57Q             ANOP  ,                                              00181200
&ZMS               SETC  '"PTOKEN='  *KGPRA* MNOTE                      00181300
&ZMS               SETC  '&ZMS.&PTOKEN"'                                00181400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00181500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00181600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00181700
.ZG57R             ANOP  ,                                              00181800
.*----------------------------------------------------------------***   00181900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00182000
                   AIF   (N'&COMPID LE 1).ZG60A  CK NUM                 00182100
&ZMS               SETC  '"COMPID='  *KPOSA* MNOTE                      00182200
&ZMS               SETC  '&ZMS.&COMPID"'                                00182300
&ZMS               SETC  '&ZMS "COMPID"'                                00182400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00182500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00182600
.ZG60A             ANOP  ,                                              00182700
.*-------------------------------------------------------------------   00182800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00182900
&ZXCOMPID          SETC  'INPUT'     SET IN/OUTPUT                      00183000
&XCOMPID           SETC  'NONE'                                         00183100
                   AIF   (K'&COMPID(1) LE 0).ZG60B  PARM                00183200
&XCOMPID           SETC  '&COMPID(1)'           SET XVARIABLE           00183300
                   AIF   (N'&COMPID GT 1).ZG60B  MULTI PARMS            00183400
&XCOMPID           SETC  '&COMPID'   SET XVARIABLE                      00183500
.ZG60B             ANOP  ,                                              00183600
.*-------------------------------------------------------------------   00183700
.***AG.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     00183800
                   AIF   (K'&ZXCOMPID LE 0).ZG60P  NOT I/O              00183900
                   AIF   ('&XCOMPID' EQ 'NONE').ZG60P                   00184000
                   AIF   ('&XCOMPID'(1,1) NE '(').ZG60P                 00184100
&ZXCOMPID          SETC  ''          RESET IN/OUTPUT                    00184200
&ZMS               SETC  '"COMPID='  *KGPRA* MNOTE                      00184300
&ZMS               SETC  '&ZMS.&COMPID"'                                00184400
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00184500
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'              00184600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00184700
.ZG60P             ANOP  ,                                              00184800
.*----------------------------------------------------------------***   00184900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00185000
                   AIF   (N'&HELP LE 1).ZG63A   CK NUM                  00185100
&ZMS               SETC  '"HELP='    *KPOSA* MNOTE                      00185200
&ZMS               SETC  '&ZMS.&HELP"'                                  00185300
&ZMS               SETC  '&ZMS "HELP"'                                  00185400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00185500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00185600
.ZG63A             ANOP  ,                                              00185700
.*-------------------------------------------------------------------   00185800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00185900
&ZXHELP            SETC  'INPUT'     SET IN/OUTPUT                      00186000
&XHELP             SETC  'NONE'                                         00186100
                   AIF   (K'&HELP(1) LE 0).ZG63B  PARM                  00186200
&XHELP             SETC  '&HELP(1)'  SET XVARIABLE                      00186300
                   AIF   (N'&HELP GT 1).ZG63B   MULTI PARMS             00186400
&XHELP             SETC  '&HELP'     SET XVARIABLE                      00186500
.ZG63B             ANOP  ,                                              00186600
.*-------------------------------------------------------------------   00186700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00186800
                   AIF   (K'&ZXHELP LE 0).ZG63R  NOT I/O                00186900
         AIF   ('&XHELP' EQ 'NONE').ZG63R                               00187000
                   AIF   ('&XHELP'(1,1) NE '(').ZG63R                   00187100
&ZCGPR             SETC  '&XHELP'(2,K'&XHELP-2)                         00187200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG63P                   00187300
                   AIF   (K'&ZCGPR GT 2).ZG63Q                          00187400
                   AIF   ('&ZCGPR' EQ '0').ZG63Q                        00187500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00187600
                   AIF   (T'&ZCGPR NE 'N').ZG63Q  INVALID REG NAME      00187700
.ZG63P             ANOP  ,                                              00187800
                   AIF   (T'&ZCGPR NE 'N').ZG63R  NON NUMERIC           00187900
                   AIF   ('&ZCGPR' LT '2').ZG63Q                        00188000
                   AIF   ('&ZCGPR' LE '12').ZG63R                       00188100
.ZG63Q             ANOP  ,                                              00188200
&ZMS               SETC  '"HELP='    *KGPRA* MNOTE                      00188300
&ZMS               SETC  '&ZMS.&HELP"'                                  00188400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00188500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00188600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00188700
.ZG63R             ANOP  ,                                              00188800
.*----------------------------------------------------------------***   00188900
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00189000
&XLASTING          SETC  ''          RESET XVARIABLE                    00189100
&ZXLASTING         SETC  ''          RESET IN/OUTPUT                    00189200
&ZASYSLNDX         SETA  0                                              00189300
.ZG66A             ANOP  ,           POSITIONAL MACRO KEY               00189400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00189500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG66B                         00189600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG66A            00189700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'LASTING').ZG66A              00189800
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00189900
&XLASTING          SETC  'LASTING'   MACRO KEY FOUND                    00190000
&ZXLASTING         SETC  'INPUT'     SET IN/OUTPUT                      00190100
.ZG66B             ANOP  ,                                              00190200
.*-------------------------------------------------------------------   00190300
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00190400
                   AIF   (K'&XLASTING GT 0).ZG66C  KEY ENTERED          00190500
&ZXLASTING         SETC  'INPUT'     SET IN/OUTPUT                      00190600
&XLASTING          SETC  'NONE'      SET DEFAULT                        00190700
.ZG66C             ANOP  ,                                              00190800
.*----------------------------------------------------------------***   00190900
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00191000
&XPINPATHS         SETC  ''          RESET XVARIABLE                    00191100
&ZXPINPATHS        SETC  ''          RESET IN/OUTPUT                    00191200
&ZASYSLNDX         SETA  0                                              00191300
.ZG69A             ANOP  ,           POSITIONAL MACRO KEY               00191400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00191500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG69B                         00191600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG69A            00191700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'PINPATHS').ZG69A             00191800
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00191900
&XPINPATHS         SETC  'PINPATHS'  MACRO KEY FOUND                    00192000
&ZXPINPATHS        SETC  'INPUT'     SET IN/OUTPUT                      00192100
.ZG69B             ANOP  ,                                              00192200
.*-------------------------------------------------------------------   00192300
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00192400
                   AIF   (K'&XPINPATHS GT 0).ZG69C  KEY ENTERED         00192500
&ZXPINPATHS        SETC  'INPUT'     SET IN/OUTPUT                      00192600
&XPINPATHS         SETC  'NONE'      SET DEFAULT                        00192700
.ZG69C             ANOP  ,                                              00192800
.*-------------------------------------------------------------------   00192900
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00193000
.ZG71              AIF   ('&XPINREQ' NE 'NOPIN').ZG72                   00193100
.*-------------------------------------------------------------------   00193200
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00193300
&ZCVAL             SETC ''           ERROR KEY FIELD                    00193400
.ZG71I0            AIF   (K'&TEXT LE 0).ZG71I1                          00193500
&ZCVAL             SETC '&ZCVAL TEXT'           DISALLOWED KEY          00193600
.ZG71I1            AIF   (K'&PTOKEN LE 0).ZG71I2                        00193700
&ZCVAL             SETC '&ZCVAL PTOKEN'         DISALLOWED KEY          00193800
.ZG71I2            AIF   (K'&COMPID LE 0).ZG71I3                        00193900
&ZCVAL             SETC '&ZCVAL COMPID'         DISALLOWED KEY          00194000
.ZG71I3            AIF   (K'&HELP LE 0).ZG71I4                          00194100
&ZCVAL             SETC '&ZCVAL HELP'           DISALLOWED KEY          00194200
.ZG71I4            AIF   (K'&XLASTING LE 0).ZG71I5                      00194300
&ZCVAL             SETC '&ZCVAL XLASTING'       DISALLOWED KEY          00194400
.ZG71I5            AIF   (K'&XPINPATHS LE 0).ZG71I6                     00194500
&ZCVAL             SETC '&ZCVAL XPINPATHS'      DISALLOWED KEY          00194600
.ZG71I6            AIF   (K'&ZCVAL LE 0).ZG71J  KEY                     00194700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00194800
&ZMS               SETC  '"NOPIN'    *KMEIA* MNOTE                      00194900
&ZMS               SETC  '&ZMS."'                                       00195000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00195100
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00195200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00195300
.ZG71J             ANOP  ,                                              00195400
.*-------------------------------------------------------------------   00195500
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00195600
.ZG72              ANOP  ,           END MUTUALLY EXCLUSIVE KEYS        00195700
.*----------------------------------------------------------------***   00195800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00195900
                   AIF   (N'&UCBPAREA LE 1).ZG74A  CK NUM               00196000
&ZMS               SETC  '"UCBPAREA='           *KPOSA* MNOTE           00196100
&ZMS               SETC  '&ZMS.&UCBPAREA"'                              00196200
&ZMS               SETC  '&ZMS "UCBPAREA"'                              00196300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00196400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00196500
.ZG74A             ANOP  ,                                              00196600
.*-------------------------------------------------------------------   00196700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00196800
&ZXUCBPAREA        SETC  'INPUT'     SET IN/OUTPUT                      00196900
&XUCBPAREA         SETC  'NONE'                                         00197000
                   AIF   (K'&UCBPAREA(1) LE 0).ZG74B  PARM              00197100
&XUCBPAREA         SETC  '&UCBPAREA(1)'         SET XVARIABLE           00197200
                   AIF   (N'&UCBPAREA GT 1).ZG74B  MULTI PARMS          00197300
&XUCBPAREA         SETC  '&UCBPAREA'            SET XVARIABLE           00197400
.ZG74B             ANOP  ,                                              00197500
.*-------------------------------------------------------------------   00197600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00197700
                   AIF   (K'&ZXUCBPAREA LE 0).ZG74R  NOT I/O            00197800
         AIF   ('&XUCBPAREA' EQ 'NONE').ZG74R                           00197900
                   AIF   ('&XUCBPAREA'(1,1) NE '(').ZG74R               00198000
&ZCGPR             SETC  '&XUCBPAREA'(2,K'&XUCBPAREA-2)                 00198100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG74P                   00198200
                   AIF   (K'&ZCGPR GT 2).ZG74Q                          00198300
                   AIF   ('&ZCGPR' EQ '0').ZG74Q                        00198400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00198500
                   AIF   (T'&ZCGPR NE 'N').ZG74Q  INVALID REG NAME      00198600
.ZG74P             ANOP  ,                                              00198700
                   AIF   (T'&ZCGPR NE 'N').ZG74R  NON NUMERIC           00198800
                   AIF   ('&ZCGPR' LT '2').ZG74Q                        00198900
                   AIF   ('&ZCGPR' LE '12').ZG74R                       00199000
.ZG74Q             ANOP  ,                                              00199100
&ZMS               SETC  '"UCBPAREA='           *KGPRA* MNOTE           00199200
&ZMS               SETC  '&ZMS.&UCBPAREA"'                              00199300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00199400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00199500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00199600
.ZG74R             ANOP  ,                                              00199700
.*----------------------------------------------------------------***   00199800
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00199900
                   AIF   (N'&IOCTOKEN LE 1).ZG77A  CK NUM               00200000
&ZMS               SETC  '"IOCTOKEN='           *KPOSA* MNOTE           00200100
&ZMS               SETC  '&ZMS.&IOCTOKEN"'                              00200200
&ZMS               SETC  '&ZMS "IOCTOKEN"'                              00200300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00200400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00200500
.ZG77A             ANOP  ,                                              00200600
.*-------------------------------------------------------------------   00200700
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         00200800
&ZXIOCTOKEN        SETC  'INOUT'     SET IN/OUTPUT                      00200900
&XIOCTOKEN         SETC  'NONE'                                         00201000
                   AIF   (K'&IOCTOKEN(1) LE 0).ZG77B  PARM              00201100
&XIOCTOKEN         SETC  '&IOCTOKEN(1)'         SET XVARIABLE           00201200
                   AIF   (N'&IOCTOKEN GT 1).ZG77B  MULTI PARMS          00201300
&XIOCTOKEN         SETC  '&IOCTOKEN'            SET XVARIABLE           00201400
.ZG77B             ANOP  ,                                              00201500
.*-------------------------------------------------------------------   00201600
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00201700
                   AIF   (K'&ZXIOCTOKEN LE 0).ZG77R  NOT I/O            00201800
         AIF   ('&XIOCTOKEN' EQ 'NONE').ZG77R                           00201900
                   AIF   ('&XIOCTOKEN'(1,1) NE '(').ZG77R               00202000
&ZCGPR             SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                 00202100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG77P                   00202200
                   AIF   (K'&ZCGPR GT 2).ZG77Q                          00202300
                   AIF   ('&ZCGPR' EQ '0').ZG77Q                        00202400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00202500
                   AIF   (T'&ZCGPR NE 'N').ZG77Q  INVALID REG NAME      00202600
.ZG77P             ANOP  ,                                              00202700
                   AIF   (T'&ZCGPR NE 'N').ZG77R  NON NUMERIC           00202800
                   AIF   ('&ZCGPR' LT '2').ZG77Q                        00202900
                   AIF   ('&ZCGPR' LE '12').ZG77R                       00203000
.ZG77Q             ANOP  ,                                              00203100
&ZMS               SETC  '"IOCTOKEN='           *KGPRA* MNOTE           00203200
&ZMS               SETC  '&ZMS.&IOCTOKEN"'                              00203300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00203400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00203500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00203600
.ZG77R             ANOP  ,                                              00203700
.*----------------------------------------------------------------***   00203800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00203900
                   AIF   (N'&LINKAGE LE 1).ZG80A  CK NUM                00204000
&ZMS               SETC  '"LINKAGE='            *KPOSA* MNOTE           00204100
&ZMS               SETC  '&ZMS.&LINKAGE"'                               00204200
&ZMS               SETC  '&ZMS "LINKAGE"'                               00204300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00204400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00204500
.ZG80A             ANOP  ,                                              00204600
.*-------------------------------------------------------------------   00204700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00204800
&XLINKAGE          SETC  ''          INITIALIZE XVARIABLE               00204900
.ZG81A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG82A                        00205000
&XLINKAGE          SETC  'SYSTEM'    SET KEYWORD                        00205100
.*-------------------------------------------------------------------   00205200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00205300
.ZG82A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG83A                        00205400
&XLINKAGE          SETC  'BRANCH'    SET KEYWORD                        00205500
.*-------------------------------------------------------------------   00205600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00205700
.ZG83A             AIF   (K'&XLINKAGE GT 0).ZG83C  KEYWORD              00205800
                   AIF   (K'&LINKAGE(1) LE 0).ZG83B                     00205900
&ZMS               SETC  '"LINKAGE='            *KUKWA* MNOTE           00206000
&ZMS               SETC  '&ZMS.&LINKAGE"'                               00206100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00206200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00206300
&ZMS               SETC  '&ZMS "SYSTEM"'                                00206400
&ZMS               SETC  '&ZMS OR "BRANCH".'                            00206500
                   MNOTE 8,' &ZMS '                                     00206600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00206700
.ZG83B             ANOP  ,                                              00206800
&XLINKAGE          SETC  'SYSTEM'    SET DEFAULT KEYWORD                00206900
.ZG83C             ANOP  ,                                              00207000
&ZXLINKAGE         SETC  'INPUT'     SET IN/OUTPUT                      00207100
.*----------------------------------------------------------------***   00207200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00207300
                   AIF   (N'&RETCODE LE 1).ZG85A  CK NUM                00207400
&ZMS               SETC  '"RETCODE='            *KPOSA* MNOTE           00207500
&ZMS               SETC  '&ZMS.&RETCODE"'                               00207600
&ZMS               SETC  '&ZMS "RETCODE"'                               00207700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00207800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00207900
.ZG85A             ANOP  ,                                              00208000
.*-------------------------------------------------------------------   00208100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00208200
                   AIF   (K'&RETCODE(1) LE 0).ZG85C  NO PARM            00208300
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00208400
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00208500
                   AIF   (N'&RETCODE GT 1).ZG85C                        00208600
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00208700
.ZG85C             ANOP  ,                                              00208800
.*-------------------------------------------------------------------   00208900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00209000
                   AIF   (K'&ZXRETCODE LE 0).ZG85R  NOT I/O             00209100
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG85R                00209200
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00209300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG85P                   00209400
                   AIF   (K'&ZCGPR GT 2).ZG85Q                          00209500
                   AIF   ('&ZCGPR' EQ '0').ZG85Q                        00209600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00209700
                   AIF   (T'&ZCGPR NE 'N').ZG85Q  INVALID REG NAME      00209800
.ZG85P             ANOP  ,                                              00209900
                   AIF   (T'&ZCGPR NE 'N').ZG85R  NON NUMERIC           00210000
                   AIF   ('&ZCGPR' LT '2').ZG85Q                        00210100
                   AIF   ('&ZCGPR' LE '12').ZG85R                       00210200
.ZG85Q             ANOP  ,                                              00210300
&ZMS               SETC  '"RETCODE='            *KGPRA* MNOTE           00210400
&ZMS               SETC  '&ZMS.&RETCODE"'                               00210500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00210600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00210700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00210800
.ZG85R             ANOP  ,                                              00210900
.*----------------------------------------------------------------***   00211000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00211100
                   AIF   (N'&RSNCODE LE 1).ZG88A  CK NUM                00211200
&ZMS               SETC  '"RSNCODE='            *KPOSA* MNOTE           00211300
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00211400
&ZMS               SETC  '&ZMS "RSNCODE"'                               00211500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00211600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00211700
.ZG88A             ANOP  ,                                              00211800
.*-------------------------------------------------------------------   00211900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00212000
                   AIF   (K'&RSNCODE(1) LE 0).ZG88C  NO PARM            00212100
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00212200
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00212300
                   AIF   (N'&RSNCODE GT 1).ZG88C                        00212400
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00212500
.ZG88C             ANOP  ,                                              00212600
.*-------------------------------------------------------------------   00212700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00212800
                   AIF   (K'&ZXRSNCODE LE 0).ZG88R  NOT I/O             00212900
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG88R                00213000
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00213100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG88P                   00213200
                   AIF   (K'&ZCGPR GT 2).ZG88Q                          00213300
                   AIF   ('&ZCGPR' EQ '0').ZG88Q                        00213400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00213500
                   AIF   (T'&ZCGPR NE 'N').ZG88Q  INVALID REG NAME      00213600
.ZG88P             ANOP  ,                                              00213700
                   AIF   (T'&ZCGPR NE 'N').ZG88R  NON NUMERIC           00213800
                   AIF   ('&ZCGPR' LT '2').ZG88Q                        00213900
                   AIF   ('&ZCGPR' LE '12').ZG88R                       00214000
.ZG88Q             ANOP  ,                                              00214100
&ZMS               SETC  '"RSNCODE='            *KGPRA* MNOTE           00214200
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00214300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00214400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00214500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00214600
.ZG88R             ANOP  ,                                              00214700
.******************************************************************     00214800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00214900
.******************************************************************     00215000
                   ACTR  10000                                          00215100
.*-------------------------------------------------------------------   00215200
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00215300
&ZCVAL             SETC  ''          ERROR FIELD                        00215400
&ZAWRK             SETA  0           POSITIONAL COUNTER                 00215500
&ZASYSLNDX         SETA  0           NON-X KEY COUNTER                  00215600
.ZGLIST2           ANOP  ,                                              00215700
&ZASYSLNDX         SETA  &ZASYSLNDX+1           NEXT NON-X KEY          00215800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00215900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00216000
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00216100
                   AIF   (&ZAWRK LE 0).ZGLIST2                          00216200
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA            00216300
                   AGO   .ZGLIST2                                       00216400
.*                                                                      00216500
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00216600
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00216700
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE       00216800
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00216900
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00217000
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00217100
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00217200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00217300
.ZGLISTX           ANOP  ,                                              00217400
&ZASYSLNDX         SETA  0                                              00217500
.*-------------------------------------------------------------------   00217600
.***AG.MF04 MF=(SLE)                                                    00217700
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00217800
.*******************************************************************    00217900
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00218000
.*******************************************************************    00218100
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00218200
.*******************************************************************    00218300
.***AE.01  START OF UCBLOOK MACRO CODE                                  00218400
.*******************************************************************    00218500
                   LCLC  &M0M0001                 NAME                  00218600
&M0M0001           SETC  '&XLABEL'                SET NAME              00218700
                   AIF   (K'&XLABEL NE 0).XLAB2                         00218800
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00218900
.*                                                                      00219000
.XLAB2             ANOP  ,                                              00219100
                   AIF   ('&XMF' EQ 'L').XLAB3                          00219200
&M0M0001 DS    0H                             UCBLOOK-2                 00219300
.XLAB3             ANOP  ,                                              00219400
.*******************************************************************    00219500
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00219600
.*******************************************************************    00219700
              PUSH  PRINT                                               00219800
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00219900
                   PRINT OFF         ++ PR01                            00220000
                   AGO   .ZPRNTXX                                       00220100
.ZPRINTX           PRINT ON                                             00220200
.ZPRNTXX           ANOP  ,                                              00220300
.********************************************************************   00220400
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00220500
.********************************************************************   00220600
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00220700
                      LCLA  &ZOPN1         INVOCATION INDEX             00220800
                      LCLC  &ZOPL(4095)    LABEL                        00220900
                      LCLC  &ZOPO(4095)    OPERATION                    00221000
                      LCLC  &ZOPV(4095)    VALUE                        00221100
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00221200
.*                                                                      00221300
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00221400
.******************************************************************     00221500
.***AL.L10 UCBLOOK FMT=LIST MF=S|L PARAMETERS                           00221600
.******************************************************************     00221700
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00221800
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00221900
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00222000
&XMFATTR              SETC  '0D'                                        00222100
.*                                                                      00222200
&ZOPN                 SETA  &ZOPN+1                                     00222300
&ZOPL(&ZOPN)          SETC  ' '                                         00222400
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00222500
&ZOPO(&ZOPN)          SETC  'B'                                         00222600
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00222700
                      AGO   .ZALVL6B                                    00222800
.ZALVL6A              ANOP                                              00222900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00223000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00223100
.ZALVL6B              ANOP                                              00223200
&ZOPD(&ZOPN)          SETC  '++ UCBLOOK ARG PARMS'                      00223300
.*                                                                      00223400
&ZOPN                 SETA  &ZOPN+1                                     00223500
&ZOPL(&ZOPN)          SETC  ' '                                         00223600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00223700
&ZOPV(&ZOPN)          SETC  '1'                                         00223800
&ZOPD(&ZOPN)          SETC  ' '                                         00223900
.*                                                                      00224000
.ZLMFSL2              ANOP  ,                                           00224100
.*-------------------------------------------------------------------   00224200
.***AM.L00  UCBLOOK FMT=LIST name                                       00224300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00224400
&ZOPN                 SETA &ZOPN+1                                      00224500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00224600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00224700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00224800
&ZOPD(&ZOPN)          SETC '++ UCBLOOK NAME'                            00224900
.ZLMFSL2M             ANOP  ,                                           00225000
.*-------------------------------------------------------------------   00225100
.***AM.L01  UCBLOOK FMT=LIST PARAMETERS                                 00225200
&ZOPN                 SETA &ZOPN+1                                      00225300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00225400
&ZOPO(&ZOPN)          SETC 'DS'                                         00225500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00225600
&ZOPD(&ZOPN)          SETC '++ UCBLOOK PARM LIST'                       00225700
.*-------------------------------------------------------------------   00225800
.***AM.L02 XVERSION XL1                                                 00225900
&ZOPN                 SETA &ZOPN+1                                      00226000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00226100
&ZOPO(&ZOPN)          SETC 'DS'                                         00226200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00226300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00226400
.*-------------------------------------------------------------------   00226500
.***AM.L09  XRESERVED1 CL1                                              00226600
&ZOPN                 SETA &ZOPN+1                                      00226700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00226800
&ZOPO(&ZOPN)          SETC 'DS'                                         00226900
&ZOPV(&ZOPN)          SETC 'CL1'                                        00227000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 00227100
.*-------------------------------------------------------------------   00227200
.***AM.L09  XDEVN XL2                                                   00227300
&ZOPN                 SETA &ZOPN+1                                      00227400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVN'                            00227500
&ZOPO(&ZOPN)          SETC 'DS'                                         00227600
&ZOPV(&ZOPN)          SETC 'XL2'                                        00227700
&ZOPD(&ZOPN)          SETC '++ &ZXDEVN  XDEVN'                          00227800
.*-------------------------------------------------------------------   00227900
.***AM.L09  XDEVNCHAR CL4                                               00228000
&ZOPN                 SETA &ZOPN+1                                      00228100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVNCHAR'                        00228200
&ZOPO(&ZOPN)          SETC 'DS'                                         00228300
&ZOPV(&ZOPN)          SETC 'CL4'                                        00228400
&ZOPD(&ZOPN)          SETC '++ &ZXDEVNCHAR  XDEVNCHAR'                  00228500
.*-------------------------------------------------------------------   00228600
.***AM.L09  XVOLSER CL6                                                 00228700
&ZOPN                 SETA &ZOPN+1                                      00228800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVOLSER'                          00228900
&ZOPO(&ZOPN)          SETC 'DS'                                         00229000
&ZOPV(&ZOPN)          SETC 'CL6'                                        00229100
&ZOPD(&ZOPN)          SETC '++ &ZXVOLSER  XVOLSER'                      00229200
.*-------------------------------------------------------------------   00229300
.***AM.L05 XDEVCLASS XL1                                                00229400
&ZOPN                 SETA &ZOPN+1                                      00229500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVCLASS'                        00229600
&ZOPO(&ZOPN)          SETC 'DS'                                         00229700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00229800
&ZOPD(&ZOPN)          SETC '++ &ZXDEVCLASS XDEVCLASS'                   00229900
.*                                                                      00230000
&ZOPN                 SETA  &ZOPN+1                                     00230100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEVCLASS_DASDTAPE'              00230200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00230300
&ZOPV(&ZOPN)          SETC  '0'                                         00230400
&ZOPD(&ZOPN)          SETC  '++ XDEVCLASS.'                             00230500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DASDTAPE'                     00230600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00230700
.*                                                                      00230800
&ZOPN                 SETA  &ZOPN+1                                     00230900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEVCLASS_TAPE'                  00231000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00231100
&ZOPV(&ZOPN)          SETC  '1'                                         00231200
&ZOPD(&ZOPN)          SETC  '++ XDEVCLASS.'                             00231300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TAPE'                         00231400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00231500
.*                                                                      00231600
&ZOPN                 SETA  &ZOPN+1                                     00231700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEVCLASS_DASD'                  00231800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00231900
&ZOPV(&ZOPN)          SETC  '2'                                         00232000
&ZOPD(&ZOPN)          SETC  '++ XDEVCLASS.'                             00232100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DASD'                         00232200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00232300
.*-------------------------------------------------------------------   00232400
.***AM.L03 XRESERVED2 BL.8                                              00232500
&ZOPN                 SETA &ZOPN+1                                      00232600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00232700
&ZOPO(&ZOPN)          SETC 'DS'                                         00232800
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00232900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00233000
.*                                                                      00233100
&ZOPN                 SETA  &ZOPN+1                                     00233200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XNOTFIND_YES'                    00233300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00233400
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00233500
&ZOPD(&ZOPN)          SETC  '++ XNOTFIND.'                              00233600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00233700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00233800
.*-------------------------------------------------------------------   00233900
.***AM.L09  XUCBPTR A                                                   00234000
&ZOPN                 SETA &ZOPN+1                                      00234100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPTR'                          00234200
&ZOPO(&ZOPN)          SETC 'DS'                                         00234300
&ZOPV(&ZOPN)          SETC 'A'                                          00234400
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPTR  XUCBPTR'                      00234500
.*-------------------------------------------------------------------   00234600
.***AM.L09  XCOMPID CL5                                                 00234700
&ZOPN                 SETA &ZOPN+1                                      00234800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPID'                          00234900
&ZOPO(&ZOPN)          SETC 'DS'                                         00235000
&ZOPV(&ZOPN)          SETC 'CL5'                                        00235100
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPID  XCOMPID'                      00235200
.*-------------------------------------------------------------------   00235300
.***AM.L03 XMASK BL.8                                                   00235400
&ZOPN                 SETA &ZOPN+1                                      00235500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMASK'                            00235600
&ZOPO(&ZOPN)          SETC 'DS'                                         00235700
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00235800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00235900
.*                                                                      00236000
&ZOPN                 SETA  &ZOPN+1                                     00236100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XNONBASE_YES'                    00236200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00236300
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00236400
&ZOPD(&ZOPN)          SETC  '++ XNONBASE.'                              00236500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00236600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00236700
.*                                                                      00236800
&ZOPN                 SETA  &ZOPN+1                                     00236900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDYNAMIC_NO'                     00237000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00237100
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00237200
&ZOPD(&ZOPN)          SETC  '++ XDYNAMIC.'                              00237300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00237400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00237500
.*                                                                      00237600
&ZOPN                 SETA  &ZOPN+1                                     00237700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRANGE_3DIGIT'                   00237800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00237900
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00238000
&ZOPD(&ZOPN)          SETC  '++ XRANGE.'                                00238100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).3DIGIT'                       00238200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00238300
.*                                                                      00238400
&ZOPN                 SETA  &ZOPN+1                                     00238500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XLOC_ANY'                        00238600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00238700
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00238800
&ZOPD(&ZOPN)          SETC  '++ XLOC.'                                  00238900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ANY'                          00239000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239100
.*                                                                      00239200
&ZOPN                 SETA  &ZOPN+1                                     00239300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUNBOUND_ALIAS_YES'              00239400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00239500
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00239600
&ZOPD(&ZOPN)          SETC  '++ XUNBOUND_ALIAS.'                        00239700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00239800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239900
.*-------------------------------------------------------------------   00240000
.***AM.L03 XFLAGS BL.8                                                  00240100
&ZOPN                 SETA &ZOPN+1                                      00240200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00240300
&ZOPO(&ZOPN)          SETC 'DS'                                         00240400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00240500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00240600
.*                                                                      00240700
&ZOPN                 SETA  &ZOPN+1                                     00240800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DEVN'                    00240900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00241000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00241100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00241200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEVN'                         00241300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00241400
.*                                                                      00241500
&ZOPN                 SETA  &ZOPN+1                                     00241600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DEVNCHAR'                00241700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00241800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00241900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00242000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEVNCHAR'                     00242100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00242200
.*                                                                      00242300
&ZOPN                 SETA  &ZOPN+1                                     00242400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_VOLSER'                  00242500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00242600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00242700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00242800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).VOLSER'                       00242900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00243000
.*                                                                      00243100
&ZOPN                 SETA  &ZOPN+1                                     00243200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_LASTING'                 00243300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00243400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00243500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00243600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LASTING'                      00243700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00243800
.*                                                                      00243900
&ZOPN                 SETA  &ZOPN+1                                     00244000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_COMPID'                  00244100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00244200
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00244300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00244400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMPID'                       00244500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00244600
.*                                                                      00244700
&ZOPN                 SETA  &ZOPN+1                                     00244800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_HELP'                    00244900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00245000
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00245100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00245200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).HELP'                         00245300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00245400
.*                                                                      00245500
&ZOPN                 SETA  &ZOPN+1                                     00245600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PIN'                     00245700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00245800
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00245900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00246000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PIN'                          00246100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00246200
.*                                                                      00246300
&ZOPN                 SETA  &ZOPN+1                                     00246400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PINPATHS'                00246500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00246600
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00246700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00246800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PINPATHS'                     00246900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00247000
.*-------------------------------------------------------------------   00247100
.***AM.L03 XFLAGS2 BL.8                                                 00247200
&ZOPN                 SETA &ZOPN+1                                      00247300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS2'                          00247400
&ZOPO(&ZOPN)          SETC 'DS'                                         00247500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00247600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00247700
.*                                                                      00247800
&ZOPN                 SETA  &ZOPN+1                                     00247900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBCXPTR'                00248000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00248100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00248200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00248300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBCXPTR'                     00248400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00248500
.*                                                                      00248600
&ZOPN                 SETA  &ZOPN+1                                     00248700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBPXPTR'                00248800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00248900
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00249000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00249100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBPXPTR'                     00249200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00249300
.*-------------------------------------------------------------------   00249400
.***AM.L09 ADDR XTEXT A                                                 00249500
&ZOPN                 SETA &ZOPN+1                                      00249600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTEXT_ADDR'                       00249700
&ZOPO(&ZOPN)          SETC 'DS'                                         00249800
&ZOPV(&ZOPN)          SETC 'A'                                          00249900
&ZOPD(&ZOPN)          SETC '++ &ZXTEXT ADDR XTEXT'                      00250000
.*-------------------------------------------------------------------   00250100
.***AM.L09 ALET XTEXT F                                                 00250200
&ZOPN                 SETA &ZOPN+1                                      00250300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTEXT_ALET'                       00250400
&ZOPO(&ZOPN)          SETC 'DS'                                         00250500
&ZOPV(&ZOPN)          SETC 'F'                                          00250600
&ZOPD(&ZOPN)          SETC '++ &ZXTEXT ALET XTEXT'                      00250700
.*-------------------------------------------------------------------   00250800
.***AM.L09  XPTOKEN CL8                                                 00250900
&ZOPN                 SETA &ZOPN+1                                      00251000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPTOKEN'                          00251100
&ZOPO(&ZOPN)          SETC 'DS'                                         00251200
&ZOPV(&ZOPN)          SETC 'CL8'                                        00251300
&ZOPD(&ZOPN)          SETC '++ &ZXPTOKEN  XPTOKEN'                      00251400
.*-------------------------------------------------------------------   00251500
.***AM.L09  XHELP CL8                                                   00251600
&ZOPN                 SETA &ZOPN+1                                      00251700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XHELP'                            00251800
&ZOPO(&ZOPN)          SETC 'DS'                                         00251900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00252000
&ZOPD(&ZOPN)          SETC '++ &ZXHELP  XHELP'                          00252100
.*-------------------------------------------------------------------   00252200
.***AM.L09 ADDR XIOCTOKEN A                                             00252300
&ZOPN                 SETA &ZOPN+1                                      00252400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ADDR'                   00252500
&ZOPO(&ZOPN)          SETC 'DS'                                         00252600
&ZOPV(&ZOPN)          SETC 'A'                                          00252700
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ADDR XIOCTOKEN'              00252800
.*-------------------------------------------------------------------   00252900
.***AM.L09 ALET XIOCTOKEN F                                             00253000
&ZOPN                 SETA &ZOPN+1                                      00253100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ALET'                   00253200
&ZOPO(&ZOPN)          SETC 'DS'                                         00253300
&ZOPV(&ZOPN)          SETC 'F'                                          00253400
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ALET XIOCTOKEN'              00253500
.*-------------------------------------------------------------------   00253600
.***AM.L09 ADDR XUCBPAREA A                                             00253700
&ZOPN                 SETA &ZOPN+1                                      00253800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPAREA_ADDR'                   00253900
&ZOPO(&ZOPN)          SETC 'DS'                                         00254000
&ZOPV(&ZOPN)          SETC 'A'                                          00254100
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPAREA ADDR XUCBPAREA'              00254200
.*-------------------------------------------------------------------   00254300
.***AM.L09 ALET XUCBPAREA F                                             00254400
&ZOPN                 SETA &ZOPN+1                                      00254500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPAREA_ALET'                   00254600
&ZOPO(&ZOPN)          SETC 'DS'                                         00254700
&ZOPV(&ZOPN)          SETC 'F'                                          00254800
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPAREA ALET XUCBPAREA'              00254900
.*-------------------------------------------------------------------   00255000
.***AM.L09  XUCBCXPTR A                                                 00255100
&ZOPN                 SETA &ZOPN+1                                      00255200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBCXPTR'                        00255300
&ZOPO(&ZOPN)          SETC 'DS'                                         00255400
&ZOPV(&ZOPN)          SETC 'A'                                          00255500
&ZOPD(&ZOPN)          SETC '++ &ZXUCBCXPTR  XUCBCXPTR'                  00255600
.*-------------------------------------------------------------------   00255700
.***AM.L09  XUCBPXPTR A                                                 00255800
&ZOPN                 SETA &ZOPN+1                                      00255900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPXPTR'                        00256000
&ZOPO(&ZOPN)          SETC 'DS'                                         00256100
&ZOPV(&ZOPN)          SETC 'A'                                          00256200
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPXPTR  XUCBPXPTR'                  00256300
.*-------------------------------------------------------------------   00256400
.***AM.L10 END OF UCBLOOK LIST PARAMETERS                               00256500
&ZOPN                 SETA &ZOPN+1                                      00256600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00256700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00256800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00256900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00257000
.*                                                                      00257100
&ZOPN                 SETA &ZOPN+1                                      00257200
&ZOPL(&ZOPN)          SETC ' '                                          00257300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00257400
&ZOPV(&ZOPN)          SETC '1'                                          00257500
&ZOPD(&ZOPN)          SETC ' '                                          00257600
.*-------------------------------------------------------------------   00257700
.***AL.L12 UCBLOOK FMT=LIST MF=S|L PARAMETERS                           00257800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00257900
.*                                                                      00258000
&ZOPN                 SETA  &ZOPN+1                                     00258100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00258200
&ZOPO(&ZOPN)          SETC  'DC'                                        00258300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00258400
&ZOPD(&ZOPN)          SETC  '++ UCBLOOK ARG PARMS'                      00258500
.*                                                                      00258600
.ZLMFSLX              ANOP  ,                                           00258700
.*-------------------------------------------------------------------   00258800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00258900
&ZPLLEN               SETA 76                                           00259000
.*                                                                      00259100
.******************************************************************     00259200
.***AI.L01 UCBLOOK FMT=LIST FILL IN PARAMETER AREA                      00259300
.******************************************************************     00259400
                      ACTR  10000                                       00259500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00259600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00259700
&ZCVAL                SETC  'LAE'          XAX MODE                     00259800
.ZIMFXA               ANOP ,                                            00259900
.*                                                                      00260000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00260100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00260200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00260300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00260400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00260500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00260600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00260700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00260800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00260900
&ZOPN                 SETA  &ZOPN+1                                     00261000
&ZOPL(&ZOPN)          SETC  ' '                                         00261100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00261200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00261300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00261400
                      AGO   .ZIMFNX                                     00261500
.*                                                                      00261600
.ZIMFN2               ANOP ,                                            00261700
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00261800
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00261900
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00262000
&ZOPN                 SETA  &ZOPN+1                                     00262100
&ZOPL(&ZOPN)          SETC  ' '                                         00262200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00262300
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00262400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00262500
                      AGO   .ZIMFNX                                     00262600
.ZIMFNX1              ANOP ,                                            00262700
&ZOPN                 SETA  &ZOPN+1                                     00262800
&ZOPL(&ZOPN)          SETC  ' '                                         00262900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00263000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00263100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00263200
.ZIMFNX               ANOP ,                                            00263300
.********************************************************************   00263400
.***AI.L02 UCBLOOK FMT=LIST INITIALIZE PARAMETER AREA                   00263500
.********************************************************************   00263600
.***AI.L03 MF=(SLE)                                                     00263700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00263800
.*                                                                      00263900
&ZOPN                 SETA  &ZOPN+1                                     00264000
&ZOPL(&ZOPN)          SETC  ' '                                         00264100
&ZOPO(&ZOPN)          SETC  'XC'                                        00264200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00264300
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00264400
.ZIMFLX               ANOP  ,                                           00264500
.*-------------------------------------------------------------------   00264600
.***AI.L04A XVERSION XL1                                                00264700
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00264800
&ZOPN                 SETA  &ZOPN+1                                     00264900
&ZOPL(&ZOPN)          SETC  ' '                                         00265000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00265100
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00265200
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00265300
.ZIMFVW               ANOP  ,                                           00265400
.*-------------------------------------------------------------------   00265500
.***AI.L25  XDEVN XL2                                                   00265600
                      AIF   ('&ZXDEVN' EQ '').ZI3E                      00265700
                      AIF   ('&ZXDEVN' EQ 'OUTPUT').ZI3E                00265800
&ZCGPR                SETC  '&XDEVN'                                    00265900
.*                                                                      00266000
                      AIF   ('&XDEVN'(1,1) NE '(').ZI3B                 00266100
&ZCGPR   SETC  '0('.'&XDEVN'(2,K'&XDEVN-2).')'                          00266200
                      AGO   .ZI3D                                       00266300
.ZI3B                 ANOP  ,                                           00266400
.*                                                                      00266500
&ZC                   SETC  '&XDEVN'(1,1)                               00266600
                      AIF   (T'&ZC NE 'N').ZI3D                         00266700
&ZC                   SETC  '&XDEVN'                                    00266800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI3D                00266900
&ZCGPR                SETC  '=FL2''&XDEVN'''                            00267000
.*                                                                      00267100
.ZI3D                 ANOP  ,                                           00267200
.*                                                                      00267300
&ZOPN                 SETA  &ZOPN+1                                     00267400
&ZOPL(&ZOPN)          SETC  ' '                                         00267500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00267600
&ZOPV(&ZOPN)          SETC  '2(2,1),&ZCGPR'                             00267700
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVN XDEVN'                          00267800
.*                                                                      00267900
.ZI3E                 ANOP  ,                                           00268000
.*-------------------------------------------------------------------   00268100
.***AI.L25  XDEVNCHAR CL4                                               00268200
                      AIF   ('&ZXDEVNCHAR' EQ '').ZI4E                  00268300
                      AIF   ('&ZXDEVNCHAR' EQ 'OUTPUT').ZI4E            00268400
&ZCGPR                SETC  '&XDEVNCHAR'                                00268500
.*                                                                      00268600
                      AIF   ('&XDEVNCHAR'(1,1) NE '(').ZI4B             00268700
&ZCGPR   SETC  '0('.'&XDEVNCHAR'(2,K'&XDEVNCHAR-2).')'                  00268800
.ZI4B                 ANOP  ,                                           00268900
.*                                                                      00269000
&ZOPN                 SETA  &ZOPN+1                                     00269100
&ZOPL(&ZOPN)          SETC  ' '                                         00269200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00269300
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00269400
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVNCHAR XDEVNCHAR'                  00269500
.*                                                                      00269600
.ZI4E                 ANOP  ,                                           00269700
.*-------------------------------------------------------------------   00269800
.***AI.L25  XVOLSER CL6                                                 00269900
                      AIF   ('&ZXVOLSER' EQ '').ZI5E                    00270000
                      AIF   ('&ZXVOLSER' EQ 'OUTPUT').ZI5E              00270100
&ZCGPR                SETC  '&XVOLSER'                                  00270200
.*                                                                      00270300
                      AIF   ('&XVOLSER'(1,1) NE '(').ZI5B               00270400
&ZCGPR   SETC  '0('.'&XVOLSER'(2,K'&XVOLSER-2).')'                      00270500
.ZI5B                 ANOP  ,                                           00270600
.*                                                                      00270700
&ZOPN                 SETA  &ZOPN+1                                     00270800
&ZOPL(&ZOPN)          SETC  ' '                                         00270900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00271000
&ZOPV(&ZOPN)          SETC  '8(6,1),&ZCGPR'                             00271100
&ZOPD(&ZOPN)          SETC  '++ &ZXVOLSER XVOLSER'                      00271200
.*                                                                      00271300
.ZI5E                 ANOP  ,                                           00271400
.*-------------------------------------------------------------------   00271500
.***AI.L07 XDEVCLASS AL1                                                00271600
&ZW                   SETC  ''                                          00271700
.*-------------------------------------------------------------------   00271800
.***AI.L15 XDEVCLASS "DASDTAPE" AL1                                     00271900
         AIF   ('&XDEVCLASS' NE 'DASDTAPE').ZI7A                        00272000
&ZW                   SETC  '0'                                         00272100
.ZI7A                 ANOP  ,                                           00272200
.*-------------------------------------------------------------------   00272300
.***AI.L15 XDEVCLASS "TAPE" AL1                                         00272400
         AIF   ('&XDEVCLASS' NE 'TAPE').ZI8A                            00272500
&ZW                   SETC  '1'                                         00272600
.ZI8A                 ANOP  ,                                           00272700
.*-------------------------------------------------------------------   00272800
.***AI.L15 XDEVCLASS "DASD" AL1                                         00272900
         AIF   ('&XDEVCLASS' NE 'DASD').ZI9A                            00273000
&ZW                   SETC  '2'                                         00273100
.ZI9A                 ANOP  ,                                           00273200
.*-------------------------------------------------------------------   00273300
.***AI.L17 XDEVCLASS AL1                                                00273400
                      AIF   ('&ZW' EQ '0').ZI9B                         00273500
                      AIF   ('&ZW' EQ '').ZI9B                          00273600
.*                                                                      00273700
&ZOPN                 SETA  &ZOPN+1                                     00273800
&ZOPL(&ZOPN)          SETC  ' '                                         00273900
&ZOPO(&ZOPN)          SETC  'MVI'                                       00274000
&ZOPV(&ZOPN)          SETC  '14(1),&ZW'                                 00274100
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVCLASS XDEVCLASS'                  00274200
.ZI9B                 ANOP  ,                                           00274300
.*-------------------------------------------------------------------   00274400
.***AI.L05 XRESERVED2 BL1                                               00274500
&ZW                   SETC  ''                                          00274600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00274700
.*-------------------------------------------------------------------   00274800
.***AI.L08 XRESERVED2 "YES"                                             00274900
.***      BL1'1XXXXXXX'                                                 00275000
         AIF   ('&XNOTFIND' NE 'YES').ZI11A                             00275100
&ZW                   SETC  '&ZW.10000000'                              00275200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00275300
                      AGO   .ZI11C                                      00275400
.*                                                                      00275500
.ZI11A                ANOP  ,                                           00275600
&ZW                   SETC  '&ZW.00000000'                              00275700
.ZI11C                ANOP  ,                                           00275800
.*-------------------------------------------------------------------   00275900
.***AI.L11 XRESERVED2 BL1                                               00276000
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    00276100
&ZOPN                 SETA  &ZOPN+1                                     00276200
&ZOPL(&ZOPN)          SETC  ' '                                         00276300
&ZOPO(&ZOPN)          SETC  'OI'                                        00276400
&ZOPV(&ZOPN)          SETC  '15(1),B''&ZW'''                            00276500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00276600
.ZI11E                ANOP  ,                                           00276700
.*-------------------------------------------------------------------   00276800
.***AI.L18  XCOMPID CL5                                                 00276900
         AIF   ('&XCOMPID' NE 'NONE').ZI13                              00277000
&ZXCOMPID             SETC  ''             RESET INPUT/OUTPUT           00277100
.ZI13                 ANOP  ,                                           00277200
.*-------------------------------------------------------------------   00277300
.***AI.L25  XCOMPID CL5                                                 00277400
                      AIF   ('&ZXCOMPID' EQ '').ZI13E                   00277500
                      AIF   ('&ZXCOMPID' EQ 'OUTPUT').ZI13E             00277600
&ZCGPR                SETC  '&XCOMPID'                                  00277700
.*                                                                      00277800
&ZOPN                 SETA  &ZOPN+1                                     00277900
&ZOPL(&ZOPN)          SETC  ' '                                         00278000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00278100
&ZOPV(&ZOPN)          SETC  '20(5,1),&ZCGPR'                            00278200
&ZOPD(&ZOPN)          SETC  '++ &ZXCOMPID XCOMPID'                      00278300
.*                                                                      00278400
.ZI13E                ANOP  ,                                           00278500
.*-------------------------------------------------------------------   00278600
.***AI.L05 XMASK BL1                                                    00278700
&ZW                   SETC  ''                                          00278800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00278900
.*-------------------------------------------------------------------   00279000
.***AI.L08 XMASK "YES"                                                  00279100
.***      BL1'1XXXXXXX'                                                 00279200
         AIF   ('&XNONBASE' NE 'YES').ZI15A                             00279300
&ZW                   SETC  '&ZW.1'                                     00279400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00279500
                      AGO   .ZI15C                                      00279600
.*                                                                      00279700
.ZI15A                ANOP  ,                                           00279800
&ZW                   SETC  '&ZW.0'                                     00279900
.ZI15C                ANOP  ,                                           00280000
.*-------------------------------------------------------------------   00280100
.***AI.L08 XMASK "NO"                                                   00280200
.***      BL1'X1XXXXXX'                                                 00280300
         AIF   ('&XDYNAMIC' NE 'NO').ZI16A                              00280400
&ZW                   SETC  '&ZW.1'                                     00280500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00280600
                      AGO   .ZI16C                                      00280700
.*                                                                      00280800
.ZI16A                ANOP  ,                                           00280900
&ZW                   SETC  '&ZW.0'                                     00281000
.ZI16C                ANOP  ,                                           00281100
.*-------------------------------------------------------------------   00281200
.***AI.L08 XMASK "3DIGIT"                                               00281300
.***      BL1'XX1XXXXX'                                                 00281400
         AIF   ('&XRANGE' NE '3DIGIT').ZI17A                            00281500
&ZW                   SETC  '&ZW.1'                                     00281600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00281700
                      AGO   .ZI17C                                      00281800
.*                                                                      00281900
.ZI17A                ANOP  ,                                           00282000
&ZW                   SETC  '&ZW.0'                                     00282100
.ZI17C                ANOP  ,                                           00282200
.*-------------------------------------------------------------------   00282300
.***AI.L08 XMASK "ANY"                                                  00282400
.***      BL1'XXX1XXXX'                                                 00282500
         AIF   ('&XLOC' NE 'ANY').ZI18A                                 00282600
&ZW                   SETC  '&ZW.1'                                     00282700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00282800
                      AGO   .ZI18C                                      00282900
.*                                                                      00283000
.ZI18A                ANOP  ,                                           00283100
&ZW                   SETC  '&ZW.0'                                     00283200
.ZI18C                ANOP  ,                                           00283300
.*-------------------------------------------------------------------   00283400
.***AI.L08 XMASK "YES"                                                  00283500
.***      BL1'XXXXXXX1'                                                 00283600
         AIF   ('&XUNBOUND_ALIAS' NE 'YES').ZI19A                       00283700
&ZW                   SETC  '&ZW.0001'                                  00283800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00283900
                      AGO   .ZI19C                                      00284000
.*                                                                      00284100
.ZI19A                ANOP  ,                                           00284200
&ZW                   SETC  '&ZW.0000'                                  00284300
.ZI19C                ANOP  ,                                           00284400
.*-------------------------------------------------------------------   00284500
.***AI.L11 XMASK BL1                                                    00284600
                      AIF   ('&ZCLNG' NE 'YES').ZI19E  ALL ZERO BITS    00284700
&ZOPN                 SETA  &ZOPN+1                                     00284800
&ZOPL(&ZOPN)          SETC  ' '                                         00284900
&ZOPO(&ZOPN)          SETC  'OI'                                        00285000
&ZOPV(&ZOPN)          SETC  '25(1),B''&ZW'''                            00285100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00285200
.ZI19E                ANOP  ,                                           00285300
.*-------------------------------------------------------------------   00285400
.***AI.L05 XFLAGS BL1                                                   00285500
&ZW                   SETC  ''                                          00285600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00285700
.*-------------------------------------------------------------------   00285800
.***AI.L08 XFLAGS "DEVN"                                                00285900
.***      BL1'1XXXXXXX'                                                 00286000
         AIF   ('&DEVN' EQ '').ZI21A                                    00286100
         AIF   ('&DEVN' EQ 'NO').ZI21A                                  00286200
&ZW                   SETC  '&ZW.1'                                     00286300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00286400
                      AGO   .ZI21C                                      00286500
.*                                                                      00286600
.ZI21A                ANOP  ,                                           00286700
&ZW                   SETC  '&ZW.0'                                     00286800
.ZI21C                ANOP  ,                                           00286900
.*-------------------------------------------------------------------   00287000
.***AI.L08 XFLAGS "DEVNCHAR"                                            00287100
.***      BL1'X1XXXXXX'                                                 00287200
         AIF   ('&DEVNCHAR' EQ '').ZI22A                                00287300
         AIF   ('&DEVNCHAR' EQ 'NO').ZI22A                              00287400
&ZW                   SETC  '&ZW.1'                                     00287500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00287600
                      AGO   .ZI22C                                      00287700
.*                                                                      00287800
.ZI22A                ANOP  ,                                           00287900
&ZW                   SETC  '&ZW.0'                                     00288000
.ZI22C                ANOP  ,                                           00288100
.*-------------------------------------------------------------------   00288200
.***AI.L08 XFLAGS "VOLSER"                                              00288300
.***      BL1'XX1XXXXX'                                                 00288400
         AIF   ('&VOLSER' EQ '').ZI23A                                  00288500
         AIF   ('&VOLSER' EQ 'NO').ZI23A                                00288600
&ZW                   SETC  '&ZW.1'                                     00288700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00288800
                      AGO   .ZI23C                                      00288900
.*                                                                      00289000
.ZI23A                ANOP  ,                                           00289100
&ZW                   SETC  '&ZW.0'                                     00289200
.ZI23C                ANOP  ,                                           00289300
.*-------------------------------------------------------------------   00289400
.***AI.L08 XFLAGS "LASTING"                                             00289500
.***      BL1'XXX1XXXX'                                                 00289600
         AIF   ('&XLASTING' EQ '').ZI24A                                00289700
         AIF   ('&XLASTING' EQ 'NONE').ZI24A                            00289800
&ZW                   SETC  '&ZW.1'                                     00289900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00290000
                      AGO   .ZI24C                                      00290100
.*                                                                      00290200
.ZI24A                ANOP  ,                                           00290300
&ZW                   SETC  '&ZW.0'                                     00290400
.ZI24C                ANOP  ,                                           00290500
.*-------------------------------------------------------------------   00290600
.***AI.L08 XFLAGS "COMPID"                                              00290700
.***      BL1'XXXX1XXX'                                                 00290800
         AIF   ('&COMPID' EQ '').ZI25A                                  00290900
         AIF   ('&COMPID' EQ 'NONE').ZI25A                              00291000
&ZW                   SETC  '&ZW.1'                                     00291100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00291200
                      AGO   .ZI25C                                      00291300
.*                                                                      00291400
.ZI25A                ANOP  ,                                           00291500
&ZW                   SETC  '&ZW.0'                                     00291600
.ZI25C                ANOP  ,                                           00291700
.*-------------------------------------------------------------------   00291800
.***AI.L08 XFLAGS "HELP"                                                00291900
.***      BL1'XXXXX1XX'                                                 00292000
         AIF   ('&HELP' EQ '').ZI26A                                    00292100
         AIF   ('&HELP' EQ 'NONE').ZI26A                                00292200
&ZW                   SETC  '&ZW.1'                                     00292300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00292400
                      AGO   .ZI26C                                      00292500
.*                                                                      00292600
.ZI26A                ANOP  ,                                           00292700
&ZW                   SETC  '&ZW.0'                                     00292800
.ZI26C                ANOP  ,                                           00292900
.*-------------------------------------------------------------------   00293000
.***AI.L08 XFLAGS "PIN"                                                 00293100
.***      BL1'XXXXXX1X'                                                 00293200
         AIF   ('&XPIN' EQ '').ZI27A                                    00293300
         AIF   ('&XPIN' EQ 'NONE').ZI27A                                00293400
&ZW                   SETC  '&ZW.1'                                     00293500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00293600
                      AGO   .ZI27C                                      00293700
.*                                                                      00293800
.ZI27A                ANOP  ,                                           00293900
&ZW                   SETC  '&ZW.0'                                     00294000
.ZI27C                ANOP  ,                                           00294100
.*-------------------------------------------------------------------   00294200
.***AI.L08 XFLAGS "PINPATHS"                                            00294300
.***      BL1'XXXXXXX1'                                                 00294400
         AIF   ('&XPINPATHS' EQ '').ZI28A                               00294500
         AIF   ('&XPINPATHS' EQ 'NONE').ZI28A                           00294600
&ZW                   SETC  '&ZW.1'                                     00294700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00294800
                      AGO   .ZI28C                                      00294900
.*                                                                      00295000
.ZI28A                ANOP  ,                                           00295100
&ZW                   SETC  '&ZW.0'                                     00295200
.ZI28C                ANOP  ,                                           00295300
.*-------------------------------------------------------------------   00295400
.***AI.L11 XFLAGS BL1                                                   00295500
                      AIF   ('&ZCLNG' NE 'YES').ZI28E  ALL ZERO BITS    00295600
&ZOPN                 SETA  &ZOPN+1                                     00295700
&ZOPL(&ZOPN)          SETC  ' '                                         00295800
&ZOPO(&ZOPN)          SETC  'OI'                                        00295900
&ZOPV(&ZOPN)          SETC  '26(1),B''&ZW'''                            00296000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00296100
.ZI28E                ANOP  ,                                           00296200
.*-------------------------------------------------------------------   00296300
.***AI.L05 XFLAGS2 BL1                                                  00296400
&ZW                   SETC  ''                                          00296500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00296600
.*-------------------------------------------------------------------   00296700
.***AI.L08 XFLAGS2 "UCBCXPTR"                                           00296800
.***      BL1'1XXXXXXX'                                                 00296900
         AIF   ('&UCBCXPTR' EQ '').ZI30A                                00297000
         AIF   ('&UCBCXPTR' EQ '').ZI30A                                00297100
&ZW                   SETC  '&ZW.1'                                     00297200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00297300
                      AGO   .ZI30C                                      00297400
.*                                                                      00297500
.ZI30A                ANOP  ,                                           00297600
&ZW                   SETC  '&ZW.0'                                     00297700
.ZI30C                ANOP  ,                                           00297800
.*-------------------------------------------------------------------   00297900
.***AI.L08 XFLAGS2 "UCBPXPTR"                                           00298000
.***      BL1'X1XXXXXX'                                                 00298100
         AIF   ('&UCBPXPTR' EQ '').ZI31A                                00298200
         AIF   ('&UCBPXPTR' EQ '').ZI31A                                00298300
&ZW                   SETC  '&ZW.1000000'                               00298400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00298500
                      AGO   .ZI31C                                      00298600
.*                                                                      00298700
.ZI31A                ANOP  ,                                           00298800
&ZW                   SETC  '&ZW.0000000'                               00298900
.ZI31C                ANOP  ,                                           00299000
.*-------------------------------------------------------------------   00299100
.***AI.L11 XFLAGS2 BL1                                                  00299200
                      AIF   ('&ZCLNG' NE 'YES').ZI31E  ALL ZERO BITS    00299300
&ZOPN                 SETA  &ZOPN+1                                     00299400
&ZOPL(&ZOPN)          SETC  ' '                                         00299500
&ZOPO(&ZOPN)          SETC  'OI'                                        00299600
&ZOPV(&ZOPN)          SETC  '27(1),B''&ZW'''                            00299700
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             00299800
.ZI31E                ANOP  ,                                           00299900
.*-------------------------------------------------------------------   00300000
.***AI.L19 ADDR XTEXT A                                                 00300100
                      AIF   ('&ZXTEXT' EQ '').ZI32H                     00300200
&ZCLNG                SETC  '&XTEXT'                                    00300300
&ZCGPR                SETC  '14'                                        00300400
.*                                                                      00300500
&ZOPN                 SETA  &ZOPN+1                                     00300600
&ZOPL(&ZOPN)          SETC  ' '                                         00300700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00300800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00300900
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00301000
.*                                                                      00301100
&ZOPN                 SETA  &ZOPN+1                                     00301200
&ZOPL(&ZOPN)          SETC  ' '                                         00301300
&ZOPO(&ZOPN)          SETC  'ST'                                        00301400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,28(,1)'                             00301500
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00301600
.*                                                                      00301700
.ZI32H                ANOP  ,                                           00301800
.*-------------------------------------------------------------------   00301900
.***AI.L24 ALET XTEXT F                                                 00302000
         AIF   ('&ZXTEXT' EQ '').ZI33G                                  00302100
         AIF   ('&SYSASCE' EQ 'P').ZI33G   SYSSTATE PRIMARY             00302200
&ZCLNG                SETC  '&XTEXT'                                    00302300
.*                                                                      00302400
&ZCGPR                SETC  '14'                                        00302500
.*                                                                      00302600
&ZOPN                 SETA  &ZOPN+1                                     00302700
&ZOPL(&ZOPN)          SETC  ' '                                         00302800
&ZOPO(&ZOPN)          SETC  'STAM'                                      00302900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,32(1)'                       00303000
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00303100
.*                                                                      00303200
.ZI33G                ANOP  ,                                           00303300
.*-------------------------------------------------------------------   00303400
.***AI.L18  XHELP CL8                                                   00303500
         AIF   ('&XHELP' NE 'NONE').ZI35                                00303600
&ZXHELP               SETC  ''             RESET INPUT/OUTPUT           00303700
.ZI35                 ANOP  ,                                           00303800
.*-------------------------------------------------------------------   00303900
.***AI.L25  XHELP CL8                                                   00304000
                      AIF   ('&ZXHELP' EQ '').ZI35E                     00304100
                      AIF   ('&ZXHELP' EQ 'OUTPUT').ZI35E               00304200
&ZCGPR                SETC  '&XHELP'                                    00304300
.*                                                                      00304400
                      AIF   ('&XHELP'(1,1) NE '(').ZI35B                00304500
&ZCGPR   SETC  '0('.'&XHELP'(2,K'&XHELP-2).')'                          00304600
.ZI35B                ANOP  ,                                           00304700
.*                                                                      00304800
&ZOPN                 SETA  &ZOPN+1                                     00304900
&ZOPL(&ZOPN)          SETC  ' '                                         00305000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00305100
&ZOPV(&ZOPN)          SETC  '44(8,1),&ZCGPR'                            00305200
&ZOPD(&ZOPN)          SETC  '++ &ZXHELP XHELP'                          00305300
.*                                                                      00305400
.ZI35E                ANOP  ,                                           00305500
.*-------------------------------------------------------------------   00305600
.***AI.L18 ADDR XIOCTOKEN A                                             00305700
         AIF   ('&XIOCTOKEN' NE 'NONE').ZI36                            00305800
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           00305900
.ZI36                 ANOP  ,                                           00306000
.*-------------------------------------------------------------------   00306100
.***AI.L19 ADDR XIOCTOKEN A                                             00306200
                      AIF   ('&ZXIOCTOKEN' EQ '').ZI36H                 00306300
&ZCLNG                SETC  '&XIOCTOKEN'                                00306400
&ZCGPR                SETC  '14'                                        00306500
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI36F  IN GPR                 00306600
.*                                                                      00306700
&ZOPN                 SETA  &ZOPN+1                                     00306800
&ZOPL(&ZOPN)          SETC  ' '                                         00306900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00307000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00307100
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00307200
.*                                                                      00307300
                      AGO   .ZI36G                                      00307400
.*                                                                      00307500
.ZI36F                ANOP  ,                                           00307600
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           00307700
.*                                                                      00307800
.ZI36G                ANOP  ,                                           00307900
.*                                                                      00308000
&ZOPN                 SETA  &ZOPN+1                                     00308100
&ZOPL(&ZOPN)          SETC  ' '                                         00308200
&ZOPO(&ZOPN)          SETC  'ST'                                        00308300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,52(,1)'                             00308400
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00308500
.*                                                                      00308600
.ZI36H                ANOP  ,                                           00308700
.*-------------------------------------------------------------------   00308800
.***AI.L18 ALET XIOCTOKEN F                                             00308900
         AIF   ('&XIOCTOKEN' NE 'NONE').ZI37                            00309000
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           00309100
.ZI37                 ANOP  ,                                           00309200
.*-------------------------------------------------------------------   00309300
.***AI.L23 ALET XIOCTOKEN F                                             00309400
         AIF   ('&ZXIOCTOKEN' EQ '').ZI37G                              00309500
         AIF   ('&SYSASCE' EQ 'P').ZI37G   SYSSTATE PRIMARY             00309600
&ZCLNG                SETC  '&XIOCTOKEN'                                00309700
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI37E  IN AR                  00309800
.*                                                                      00309900
&ZCGPR                SETC  '14'                                        00310000
                      AGO   .ZI37F                                      00310100
.*                                                                      00310200
.ZI37E                ANOP  ,                                           00310300
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           00310400
.*                                                                      00310500
.ZI37F                ANOP  ,                                           00310600
.*                                                                      00310700
&ZOPN                 SETA  &ZOPN+1                                     00310800
&ZOPL(&ZOPN)          SETC  ' '                                         00310900
&ZOPO(&ZOPN)          SETC  'STAM'                                      00311000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,56(1)'                       00311100
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00311200
.*                                                                      00311300
.ZI37G                ANOP  ,                                           00311400
.*-------------------------------------------------------------------   00311500
.***AI.L18 ADDR XUCBPAREA A                                             00311600
         AIF   ('&XUCBPAREA' NE 'NONE').ZI38                            00311700
&ZXUCBPAREA           SETC  ''             RESET INPUT/OUTPUT           00311800
.ZI38                 ANOP  ,                                           00311900
.*-------------------------------------------------------------------   00312000
.***AI.L19 ADDR XUCBPAREA A                                             00312100
                      AIF   ('&ZXUCBPAREA' EQ '').ZI38H                 00312200
&ZCLNG                SETC  '&XUCBPAREA'                                00312300
&ZCGPR                SETC  '14'                                        00312400
         AIF   ('&XUCBPAREA'(1,1) EQ '(').ZI38F  IN GPR                 00312500
.*                                                                      00312600
&ZOPN                 SETA  &ZOPN+1                                     00312700
&ZOPL(&ZOPN)          SETC  ' '                                         00312800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00312900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00313000
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPAREA XUCBPAREA'                  00313100
.*                                                                      00313200
                      AGO   .ZI38G                                      00313300
.*                                                                      00313400
.ZI38F                ANOP  ,                                           00313500
&ZCGPR   SETC  '&XUCBPAREA'(2,K'&XUCBPAREA-2)                           00313600
.*                                                                      00313700
.ZI38G                ANOP  ,                                           00313800
.*                                                                      00313900
&ZOPN                 SETA  &ZOPN+1                                     00314000
&ZOPL(&ZOPN)          SETC  ' '                                         00314100
&ZOPO(&ZOPN)          SETC  'ST'                                        00314200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,60(,1)'                             00314300
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPAREA XUCBPAREA'                  00314400
.*                                                                      00314500
.ZI38H                ANOP  ,                                           00314600
.*-------------------------------------------------------------------   00314700
.***AI.L18 ALET XUCBPAREA F                                             00314800
         AIF   ('&XUCBPAREA' NE 'NONE').ZI39                            00314900
&ZXUCBPAREA           SETC  ''             RESET INPUT/OUTPUT           00315000
.ZI39                 ANOP  ,                                           00315100
.*-------------------------------------------------------------------   00315200
.***AI.L23 ALET XUCBPAREA F                                             00315300
         AIF   ('&ZXUCBPAREA' EQ '').ZI39G                              00315400
         AIF   ('&SYSASCE' EQ 'P').ZI39G   SYSSTATE PRIMARY             00315500
&ZCLNG                SETC  '&XUCBPAREA'                                00315600
         AIF   ('&XUCBPAREA'(1,1) EQ '(').ZI39E  IN AR                  00315700
.*                                                                      00315800
&ZCGPR                SETC  '14'                                        00315900
                      AGO   .ZI39F                                      00316000
.*                                                                      00316100
.ZI39E                ANOP  ,                                           00316200
&ZCGPR   SETC  '&XUCBPAREA'(2,K'&XUCBPAREA-2)                           00316300
.*                                                                      00316400
.ZI39F                ANOP  ,                                           00316500
.*                                                                      00316600
&ZOPN                 SETA  &ZOPN+1                                     00316700
&ZOPL(&ZOPN)          SETC  ' '                                         00316800
&ZOPO(&ZOPN)          SETC  'STAM'                                      00316900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,64(1)'                       00317000
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPAREA XUCBPAREA'                  00317100
.*                                                                      00317200
.ZI39G                ANOP  ,                                           00317300
.*-------------------------------------------------------------------   00317400
&ZOPN1                SETA &ZOPN                                        00317500
.*******************************************************************    00317600
.***  PROCESS UCBLOOK OUTPUT PARAMETERS                                 00317700
.*******************************************************************    00317800
                      ACTR  10000                                       00317900
.*------------------------------------------------------------------    00318000
.***AO.L02 XUCBPTR A                                                    00318100
         AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZO12A  OUTPUT                  00318200
         AIF   ('&ZXUCBPTR' NE 'INOUT').ZO12C  INOUT                    00318300
.ZO12A    AIF   ('&XUCBPTR'(1,1) NE '(').ZO12B  ADDR IN GPR             00318400
&ZCGPR   SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                               00318500
&ZOPN                 SETA  &ZOPN+1                                     00318600
&ZOPL(&ZOPN)          SETC  ' '                                         00318700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00318800
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),16(1)'                         00318900
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              00319000
                      AGO   .ZO12C                                      00319100
.*                                                                      00319200
.ZO12B                ANOP  ,                                           00319300
&ZAWRK   SETA  K'&XUCBPTR                                               00319400
         AIF   ('&XUCBPTR'(&ZAWRK,1) NE ')').ZO12G                      00319500
&ZN      SETA  2                                                        00319600
.ZO12H    ANOP                                                          00319700
         AIF   (&ZN GE &ZAWRK).ZO12G                                    00319800
         AIF   ('&XUCBPTR'(&ZN,1) NE '(').ZO12I                         00319900
&ZC      SETC  '&XUCBPTR'(1,&ZN).'4'.','                                00320000
&ZC      SETC  '&ZC'.'&XUCBPTR'(&ZN+1,&ZAWRK-&ZN).',16(1)'              00320100
         AGO   .ZO12J                                                   00320200
.ZO12I    ANOP                                                          00320300
&ZN      SETA  &ZN+1                                                    00320400
         AGO   .ZO12H                                                   00320500
.ZO12G    ANOP                                                          00320600
&ZC      SETC  '&XUCBPTR.(4),16(1)'                                     00320700
.ZO12J    ANOP                                                          00320800
&ZOPN                 SETA  &ZOPN+1                                     00320900
&ZOPL(&ZOPN)          SETC  ' '                                         00321000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00321100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00321200
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              00321300
.ZO12C                ANOP  ,                                           00321400
.*------------------------------------------------------------------    00321500
.***AO.L02 XPTOKEN CL8                                                  00321600
         AIF   ('&ZXPTOKEN' EQ 'OUTPUT').ZO34A  OUTPUT                  00321700
         AIF   ('&ZXPTOKEN' NE 'INOUT').ZO34C  INOUT                    00321800
.ZO34A    AIF   ('&XPTOKEN'(1,1) NE '(').ZO34B  ADDR IN GPR             00321900
&ZCGPR   SETC  '&XPTOKEN'(2,K'&XPTOKEN-2)                               00322000
&ZOPN                 SETA  &ZOPN+1                                     00322100
&ZOPL(&ZOPN)          SETC  ' '                                         00322200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00322300
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),36(1)'                         00322400
&ZOPD(&ZOPN)          SETC  '++ XPTOKEN CL8'                            00322500
                      AGO   .ZO34C                                      00322600
.*                                                                      00322700
.ZO34B                ANOP  ,                                           00322800
&ZAWRK   SETA  K'&XPTOKEN                                               00322900
         AIF   ('&XPTOKEN'(&ZAWRK,1) NE ')').ZO34G                      00323000
&ZN      SETA  2                                                        00323100
.ZO34H    ANOP                                                          00323200
         AIF   (&ZN GE &ZAWRK).ZO34G                                    00323300
         AIF   ('&XPTOKEN'(&ZN,1) NE '(').ZO34I                         00323400
&ZC      SETC  '&XPTOKEN'(1,&ZN).'8'.','                                00323500
&ZC      SETC  '&ZC'.'&XPTOKEN'(&ZN+1,&ZAWRK-&ZN).',36(1)'              00323600
         AGO   .ZO34J                                                   00323700
.ZO34I    ANOP                                                          00323800
&ZN      SETA  &ZN+1                                                    00323900
         AGO   .ZO34H                                                   00324000
.ZO34G    ANOP                                                          00324100
&ZC      SETC  '&XPTOKEN.(8),36(1)'                                     00324200
.ZO34J    ANOP                                                          00324300
&ZOPN                 SETA  &ZOPN+1                                     00324400
&ZOPL(&ZOPN)          SETC  ' '                                         00324500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00324600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00324700
&ZOPD(&ZOPN)          SETC  '++ XPTOKEN CL8'                            00324800
.ZO34C                ANOP  ,                                           00324900
.*------------------------------------------------------------------    00325000
.***AO.L02 XUCBCXPTR A                                                  00325100
         AIF   ('&ZXUCBCXPTR' EQ 'OUTPUT').ZO40A  OUTPUT                00325200
         AIF   ('&ZXUCBCXPTR' NE 'INOUT').ZO40C  INOUT                  00325300
.ZO40A    AIF   ('&XUCBCXPTR'(1,1) NE '(').ZO40B  ADDR IN GPR           00325400
&ZCGPR   SETC  '&XUCBCXPTR'(2,K'&XUCBCXPTR-2)                           00325500
&ZOPN                 SETA  &ZOPN+1                                     00325600
&ZOPL(&ZOPN)          SETC  ' '                                         00325700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00325800
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),68(1)'                         00325900
&ZOPD(&ZOPN)          SETC  '++ XUCBCXPTR A'                            00326000
                      AGO   .ZO40C                                      00326100
.*                                                                      00326200
.ZO40B                ANOP  ,                                           00326300
&ZAWRK   SETA  K'&XUCBCXPTR                                             00326400
         AIF   ('&XUCBCXPTR'(&ZAWRK,1) NE ')').ZO40G                    00326500
&ZN      SETA  2                                                        00326600
.ZO40H    ANOP                                                          00326700
         AIF   (&ZN GE &ZAWRK).ZO40G                                    00326800
         AIF   ('&XUCBCXPTR'(&ZN,1) NE '(').ZO40I                       00326900
&ZC      SETC  '&XUCBCXPTR'(1,&ZN).'4'.','                              00327000
&ZC      SETC  '&ZC'.'&XUCBCXPTR'(&ZN+1,&ZAWRK-&ZN).',68(1)'            00327100
         AGO   .ZO40J                                                   00327200
.ZO40I    ANOP                                                          00327300
&ZN      SETA  &ZN+1                                                    00327400
         AGO   .ZO40H                                                   00327500
.ZO40G    ANOP                                                          00327600
&ZC      SETC  '&XUCBCXPTR.(4),68(1)'                                   00327700
.ZO40J    ANOP                                                          00327800
&ZOPN                 SETA  &ZOPN+1                                     00327900
&ZOPL(&ZOPN)          SETC  ' '                                         00328000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00328100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00328200
&ZOPD(&ZOPN)          SETC  '++ XUCBCXPTR A'                            00328300
.ZO40C                ANOP  ,                                           00328400
.*------------------------------------------------------------------    00328500
.***AO.L02 XUCBPXPTR A                                                  00328600
         AIF   ('&ZXUCBPXPTR' EQ 'OUTPUT').ZO41A  OUTPUT                00328700
         AIF   ('&ZXUCBPXPTR' NE 'INOUT').ZO41C  INOUT                  00328800
.ZO41A    AIF   ('&XUCBPXPTR'(1,1) NE '(').ZO41B  ADDR IN GPR           00328900
&ZCGPR   SETC  '&XUCBPXPTR'(2,K'&XUCBPXPTR-2)                           00329000
&ZOPN                 SETA  &ZOPN+1                                     00329100
&ZOPL(&ZOPN)          SETC  ' '                                         00329200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00329300
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),72(1)'                         00329400
&ZOPD(&ZOPN)          SETC  '++ XUCBPXPTR A'                            00329500
                      AGO   .ZO41C                                      00329600
.*                                                                      00329700
.ZO41B                ANOP  ,                                           00329800
&ZAWRK   SETA  K'&XUCBPXPTR                                             00329900
         AIF   ('&XUCBPXPTR'(&ZAWRK,1) NE ')').ZO41G                    00330000
&ZN      SETA  2                                                        00330100
.ZO41H    ANOP                                                          00330200
         AIF   (&ZN GE &ZAWRK).ZO41G                                    00330300
         AIF   ('&XUCBPXPTR'(&ZN,1) NE '(').ZO41I                       00330400
&ZC      SETC  '&XUCBPXPTR'(1,&ZN).'4'.','                              00330500
&ZC      SETC  '&ZC'.'&XUCBPXPTR'(&ZN+1,&ZAWRK-&ZN).',72(1)'            00330600
         AGO   .ZO41J                                                   00330700
.ZO41I    ANOP                                                          00330800
&ZN      SETA  &ZN+1                                                    00330900
         AGO   .ZO41H                                                   00331000
.ZO41G    ANOP                                                          00331100
&ZC      SETC  '&XUCBPXPTR.(4),72(1)'                                   00331200
.ZO41J    ANOP                                                          00331300
&ZOPN                 SETA  &ZOPN+1                                     00331400
&ZOPL(&ZOPN)          SETC  ' '                                         00331500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00331600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00331700
&ZOPD(&ZOPN)          SETC  '++ XUCBPXPTR A'                            00331800
.ZO41C                ANOP  ,                                           00331900
.*******************************************************************    00332000
.***AO.X02  RETURN CODE PROCESSING                                      00332100
.*******************************************************************    00332200
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00332300
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00332400
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00332500
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00332600
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00332700
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00332800
&ZOPN                 SETA  &ZOPN+1                                     00332900
&ZOPL(&ZOPN)          SETC  ' '                                         00333000
&ZOPO(&ZOPN)          SETC  'ST'                                        00333100
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00333200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00333300
                      AGO   .ZMRETX                                     00333400
.*                                                                      00333500
.ZMRET2               ANOP  ,                                           00333600
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00333700
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00333800
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00333900
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00334000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00334100
&ZOPN                 SETA  &ZOPN+1                                     00334200
&ZOPL(&ZOPN)          SETC  ' '                                         00334300
&ZOPO(&ZOPN)          SETC  'LR'                                        00334400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00334500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00334600
.ZMRETX               ANOP  ,                                           00334700
.*******************************************************************    00334800
.***AO.X03  REASON CODE PROCESSING                                      00334900
.*******************************************************************    00335000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00335100
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00335200
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00335300
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00335400
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00335500
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00335600
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00335700
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00335800
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00335900
&ZOPN                 SETA  &ZOPN+1                                     00336000
&ZOPL(&ZOPN)          SETC  ' '                                         00336100
&ZOPO(&ZOPN)          SETC  'ST'                                        00336200
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00336300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00336400
                      AGO   .ZMRSNX                                     00336500
.*                                                                      00336600
.ZMRSN2               ANOP  ,                                           00336700
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00336800
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00336900
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00337000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00337100
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00337200
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00337300
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00337400
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00337500
&ZOPN                 SETA  &ZOPN+1                                     00337600
&ZOPL(&ZOPN)          SETC  ' '                                         00337700
&ZOPO(&ZOPN)          SETC  'LR'                                        00337800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00337900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00338000
.ZMRSNX               ANOP  ,                                           00338100
.*******************************************************************    00338200
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00338300
.*******************************************************************    00338400
.ZMFLX                ANOP  ,              MF=L PROCESSING              00338500
.*******************************************************************    00338600
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00338700
.*******************************************************************    00338800
                      ACTR  10000                                       00338900
.*                                                                      00339000
                      LCLA  &ZLC           COLUMN POSITION              00339100
                      LCLA  &ZOPX          LIST TABLE INDEX             00339200
                      LCLC  &ZLL           LABEL                        00339300
                      LCLC  &ZLOP          OPERATION                    00339400
                      LCLC  &ZLV           VALUE                        00339500
                      LCLC  &ZLD           DESCRIPTION                  00339600
.*                                                                      00339700
&ZOPX                 SETA  1                                           00339800
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00339900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00340000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00340100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00340200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00340300
                      AIF   (K'&ZLD LE 0).ZL5                           00340400
&ZLC                  SETA  35             COMMENT COLUMN               00340500
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00340600
&ZLC                  SETA  33             COMMMENT COLUMN              00340700
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00340800
&ZLV                  SETC  '&ZLV'.' '                                  00340900
                      AGO   .ZL3                                        00341000
.*                                                                      00341100
.ZL4                  ANOP  ,                                           00341200
&ZLV                  SETC  '&ZLV'.' '                                  00341300
.ZL5                  ANOP  ,                                           00341400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00341500
.*                                                                      00341600
&ZLL     &ZLOP &ZLV                                                     00341700
.*                                                                      00341800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00341900
                      AGO   .ZL2           CONTINUE LOOPING             00342000
.*                                                                      00342100
.ZLX                  ANOP  ,                                           00342200
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00342300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00342400
.*-----------BAL invocation code-------------                           00342500
         LA    0,1                ++ SET UCBLOOK FUNCTION CODE          00342600
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        00342700
.*********************************************************************  00342800
.*                                                                   *  00342900
.*  Get addressability to CVT                                        *  00343000
.*                                                                   *  00343100
.*********************************************************************  00343200
         L     15,16(0,0)                                               00343300
.*********************************************************************  00343400
.*                                                                   *  00343500
.*  Get addressability to IOCOM                                      *  00343600
.*                                                                   *  00343700
.*********************************************************************  00343800
         L     15,124(15,0)                                             00343900
.*********************************************************************  00344000
.*                                                                   *  00344100
.*  Get addressability to IOVT                                       *  00344200
.*                                                                   *  00344300
.*********************************************************************  00344400
         L     15,208(15,0)                                             00344500
         L     15,12(15,0)        ++ SET ADDR OF UCB SERVICES           00344600
         BALR  14,15              ++ BRANCH TO UCB SERVICES             00344700
         AGO   .DONE1                                                   00344800
.LNKPC1  ANOP                                                           00344900
         L     14,16(0,0)         ++ GET CVT ADDRESS                    00345000
         L     14,772(14,0)       ++ GET SFT ADDRESS                    00345100
.*********************************************************************  00345200
.*                                                                   *  00345300
.*  Get LX/EX for UCB Services                                       *  00345400
.*                                                                   *  00345500
.*  Note: LX/EX is calculated by multiplying the PC number (78)      *  00345600
.*        times the length of a PC/AUTH table entry (4) and          *  00345700
.*        then subtracting 4.                                        *  00345800
.*                                                                   *  00345900
.*********************************************************************  00346000
         L     14,308(14,0)       ++ GET LX/EX FOR UCB SERVICES         00346100
         PC    0(14)              ++ PC TO UCB SERVICES                 00346200
.DONE1   ANOP                                                           00346300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00346400
.ZLINKX               ANOP  ,                                           00346500
.*******************************************************************    00346600
.***AP.X01  FORMAT GENERATED CODE                                       00346700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00346800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00346900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00347000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00347100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00347200
                      AIF   (K'&ZLD LE 0).ZL51                          00347300
&ZLC                  SETA  35             COMMENT COLUMN               00347400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00347500
&ZLC                  SETA  33             COMMENT COLUMN               00347600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00347700
&ZLV                  SETC  '&ZLV'.' '                                  00347800
                      AGO   .ZL31                                       00347900
.*                                                                      00348000
.ZL41                 ANOP  ,                                           00348100
&ZLV                  SETC  '&ZLV'.' '                                  00348200
.ZL51                 ANOP  ,                                           00348300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00348400
.*                                                                      00348500
&ZLL     &ZLOP &ZLV                                                     00348600
.*                                                                      00348700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00348800
                      AGO   .ZL21          CONTINUE LOOPING             00348900
.*                                                                      00349000
.ZLX1                 ANOP  ,                                           00349100
.*******************************************************************    00349200
.***AP.X02  END OF UCBLOOK MACRO                                        00349300
&ZUCBLOOK             SETC  'YES'          SET UCBLOOK USED             00349400
         POP   PRINT                                                    00349500
*                                            UCBLOOK-2                  00349600
         SPACE 1                                                        00349700
.ZLX2                 ANOP  ,                                           00349800
         MEND                                                           00349900
**********************************************************************/ 00350000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00350100
*%UCBLOOK: MACRO KEYS(DEVN,DEVNCHAR,VOLSER,DEVCLASS,UCBPTR,UCBCXPTR,    00350200
*                 UCBPXPTR,LOC,DYNAMIC,RANGE,NONBASE,UNBOUND_ALIAS,     00350300
*                 NOTFIND,PIN,TEXT,PTOKEN,COMPID,HELP,LASTING,          00350400
*                 PINPATHS,NOPIN,UCBPAREA,IOCTOKEN,LINKAGE,RETCODE,     00350500
*                 RSNCODE,PLISTVER,MF);                                 00350600
*  ANS('?'||MACLABEL||' '||'UCBLOOKP '||MACLIST||                       00350700
*         ' '||MACKEYS||';') COL(MACLMAR);                              00350800
*%END UCBLOOK;                                                          00350900
