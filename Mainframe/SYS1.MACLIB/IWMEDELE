*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IWMEDELE                              -09/15/99-<2> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  Delete Enclave                                * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     5647-A01 (C) COPYRIGHT IBM CORP. 1994, 2000                     * 00600000
*                                                                     * 00750000
* STATUS= JBB6609                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*                                                                     * 00950000
*01* FUNCTION:                                                        * 01000000
*                                                                     * 01050000
*                                                                     * 01100000
*      The purpose of this service is to delete an enclave, so that   * 01136800
*      no SRBs or TCBs exist within the enclave and no new SRBs may   * 01173600
*      be scheduled into the enclave, nor may any TCBs join the       * 01210400
*      enclave.  Some residual enclave related CPU time will not be   * 01247200
*      accounted back to the work request whenever active enclave     * 01284000
*      SRBs/TCBs were present at the time IWMEDELE is invoked.  SRBs  * 01320800
*      scheduled to the enclave which have not completed will be      * 01357600
*      converted to ordinary preemptable SRBs.  TCBs joined to the    * 01395000
*      enclave which have not completed will be converted to ordinary * 01430000
*      TCBs.                                                          * 01465000
*                                                                     * 01500000
*      When an enclave is deleted, the work request is considered to  * 01550000
*      have finished and all related resource accounting will be      * 01600000
*      finalized.                                                     * 01650000
*                                                                     * 01700000
*      IWMEDELE cannot be used to delete a foreign enclave.  The      * 01750000
*      IWMUIMPT macro must be used instead.                           * 01800000
*                                                                     * 02200000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 02250000
*                                                                     * 02300000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 02350000
*                                                                     * 02400000
*01* ENVIRONMENT:                                                     * 02450000
*                                                                     * 02500000
*                                                                     * 02550000
*      Dispatchable unit mode: Task or SRB mode.                      * 02600000
*                                                                     * 02650000
*      Minimum authorization: Supervisor state or program key mask    * 02700000
*                        (PKM) allowing keys 0-7.                     * 02750000
*                                                                     * 02800000
*      AMODE:            31-bit.                                      * 02850000
*                                                                     * 02900000
*      ASC mode:         Primary or Access Register.                  * 02950000
*                                                                     * 03000000
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 03016600
*                                                                     * 03033200
*      Interrupt status: Enabled for I/O and external interrupts.     * 03049800
*                                                                     * 03066400
*      Locks:            No locks held.  FRR environments may be      * 03083000
*                        established.                                 * 03100000
*                                                                     * 03150000
*      Control parameters: Control parameters must be in the primary  * 03183300
*                        address space.                               * 03216600
*                                                                     * 03250000
*                                                                     * 03300000
*                                                                     * 03500000
*01* PROGRAMMING REQUIREMENTS:                                        * 03550000
*                                                                     * 03650000
*                                                                     * 03664000
*    1.  The macro CVT must be included to use this macro.            * 03678000
*                                                                     * 03692000
*    2.  The macro IWMYCON must be included to use this macro.        * 03706000
*                                                                     * 03720000
*    3.  The macro IWMPB must be in the library concatenation, since  * 03734000
*        it is included by IWMYCON.                                   * 03748000
*                                                                     * 03762000
*    4.  Note that the high order halfword of register 0, and the     * 03776000
*        reason code variable when specified, may be non-zero and     * 03790000
*        represents diagnostic data which is NOT part of the external * 03804000
*        interface.  The high order halfword should thus be excluded  * 03818000
*        from comparison with the reason code values described above. * 03832000
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 03846000
*        be used for this purpose.                                    * 03860000
*                                                                     * 03874000
*    5.  All character data, unless otherwise specified, is assumed   * 03888000
*        to be left justified and padded with blanks on the right, as * 03902000
*        needed, to occupy the specified number of bytes.             * 03916000
*                                                                     * 03930000
*    6.  Since this service may only be used by system-like code,     * 03944000
*        some validity checking on the parameter list is not          * 03958000
*        performed. These checks would only be needed if the macro    * 03972000
*        were not used to invoke the service routine.                 * 03986000
*                                                                     * 04000000
*                                                                     * 04050000
*                                                                     * 04100000
*01* RESTRICTIONS:                                                    * 04125000
*                                                                     * 04150000
*                                                                     * 04200000
*    1.  This macro may not be used prior to the completion of WLM    * 04250000
*        address space initialization.                                * 04300000
*                                                                     * 04550000
*    2.  This macro may only be used on MVS/ESA SP5.2 or higher       * 04562900
*        levels.                                                      * 04575800
*                                                                     * 04588700
*                                                                     * 04601600
*                                                                     * 04614500
*01* INPUT REGISTER INFORMATION:                                      * 04627400
*                                                                     * 04640300
*    Before issuing the IWMEDELE macro, the caller does not have to   * 04653200
*    place any information into any register unless using it in       * 04666100
*    register notation for a particular parameter, or using it as a   * 04679000
*    base register.                                                   * 04691900
*                                                                     * 04704800
*01* OUTPUT REGISTER INFORMATION:                                     * 04717700
*                                                                     * 04730600
*    When control returns to the caller, the GPRs contain:            * 04743500
*                                                                     * 04756400
*                                                                     * 04769300
*    REGISTER  CONTENTS                                               * 04782200
*                                                                     * 04795100
*    0         Reason code if GR15 return code is non-zero            * 04808000
*                                                                     * 04820900
*    1         Used as work register by the system                    * 04833800
*                                                                     * 04846700
*    2-13      Unchanged                                              * 04859600
*                                                                     * 04872500
*    14        Used as work registers by the system                   * 04885400
*                                                                     * 04898300
*    15        Return code                                            * 04911200
*                                                                     * 04924100
*                                                                     * 04937000
*                                                                     * 04949900
*    When control returns to the caller, the ARs contain:             * 04962800
*                                                                     * 04975700
*                                                                     * 04988600
*    REGISTER  CONTENTS                                               * 05001500
*                                                                     * 05014400
*    0-1       Used as work registers by the system                   * 05027300
*                                                                     * 05040200
*    2-13      Unchanged                                              * 05053100
*                                                                     * 05066000
*    14-15     Used as work registers by the system                   * 05078900
*                                                                     * 05091800
*                                                                     * 05104700
*                                                                     * 05117600
*    Some callers depend on register contents remaining the same      * 05130500
*    before and after issuing a service.  If the system changes the   * 05143400
*    contents of registers on which the caller depends, the caller    * 05156300
*    must save them before issuing the service, and restore them      * 05169200
*    after the system returns control.                                * 05182100
*                                                                     * 05195000
*01* PERFORMANCE IMPLICATIONS:                                        * 05207900
*                                                                     * 05220800
*    None                                                             * 05233700
*                                                                     * 05250000
*01* SYNTAX:                                                          * 05300000
*                                                                     * 05350000
*[xlabel]  IWMEDELE     ETOKEN=xetoken                                * 05400000
*                     [,CPUSERVICE=xcpuservice]                       * 05425000
*                     [,SYSPLEXCPUSRV=xsysplexcpusrv]                 * 05450000
*                     [,CPUTIME=xcputime]                             * 05475000
*                     [,RETCODE=xretcode]                             * 05500000
*                     [,RSNCODE=xrsncode]                             * 05550000
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 05575000
*                    [,MF=S]                                         * 05600000
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 05650000
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 05700000
*                                                                     * 05750000
*                                                                     * 05800000
*      Where:                                                         * 05850000
*                                                                     * 05900000
*                                                                     * 05950000
*      [xlabel]                                                       * 06000000
*          is an optional symbol, starting in column 1, that is the   * 06050000
*          name on the IWMEDELE macro invocation.  The name must      * 06100000
*          conform to the rules for an ordinary assembler language    * 06150000
*          symbol.                                                    * 06200000
*          DEFAULT: No name.                                          * 06250000
*                                                                     * 06300000
*                                                                     * 06350000
*                                                                     * 06400000
*                                                                     * 06450000
*      ETOKEN=xetoken                                                 * 06500000
*          is the name (RS-type), or address in register (2)-(12), of * 06550000
*          a required 8 character input which contains the enclave    * 06600000
*          token to be returned.                                      * 06650000
*                                                                     * 06651700
*                                                                     * 06653400
*                                                                     * 06655100
*                                                                     * 06656800
*      [CPUSERVICE=xcpuservice]                                       * 06658500
*          is the name (RS-type), or address in register (2)-(12), of * 06660200
*          an optional 64 bit output which will contain the CPU       * 06661900
*          service accumulated by the enclave on the local system.    * 06663600
*                                                                     * 06665300
*                                                                     * 06667000
*                                                                     * 06668700
*                                                                     * 06670400
*      [SYSPLEXCPUSRV=xsysplexcpusrv]                                 * 06672100
*          is the name (RS-type), or address in register (2)-(12), of * 06673800
*          an optional 64 bit output which will contain the CPU       * 06675500
*          service accumulated by the enclave on the local system and * 06677200
*          on other systems through the use of the IWMEXPT and        * 06678900
*          IWMIMPT services.  If the IWMEXPT and IWMIMPT services     * 06680600
*          were not used, SYSPLEXCPUSRV returns the same value as     * 06682300
*          CPUSERVICE.                                                * 06684000
*                                                                     * 06685700
*                                                                     * 06687400
*                                                                     * 06689100
*                                                                     * 06690800
*      [CPUTIME=xcputime]                                             * 06692500
*          is the name (RS-type), or address in register (2)-(12), of * 06694200
*          an optional 64 bit output which will contain the total CPU * 06695900
*          time accumulated by the enclave on the local system.       * 06697600
*                                                                     * 06700000
*                                                                     * 06750000
*                                                                     * 06800000
*                                                                     * 06850000
*      [RETCODE=xretcode]                                             * 07500000
*          is the name (RS-type) of an optional fullword output       * 07550000
*          variable, or register (2)-(12), into which the return code * 07600000
*          is to be copied from GPR 15.                               * 07650000
*                                                                     * 07700000
*                                                                     * 07750000
*                                                                     * 07800000
*                                                                     * 07850000
*      [RSNCODE=xrsncode]                                             * 07900000
*          is the name (RS-type) of an optional fullword output       * 07950000
*          variable, or register (2)-(12), into which the reason code * 08000000
*          is to be copied from GPR 0.                                * 08050000
*                                                                     * 08100000
*                                                                     * 08150000
*                                                                     * 08200000
*                                                                     * 08250000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 08252200
*          is an optional byte input decimal value in the "0-2" range * 08254400
*          that specifies the macro version.  PLISTVER is the only    * 08256600
*          key allowed on the list form of MF and determines which    * 08258800
*          parameter list is generated.  The macro keys associated    * 08260600
*          with each supported version of the macro are listed in     * 08262400
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 08264200
*          instead of a number, and the parameter list will be of the * 08266000
*          largest size currently supported. This size may grow from  * 08267800
*          release to release (thus possibly affecting the amount of  * 08269600
*          storage needed by your program).  If your program can      * 08271400
*          tolerate this, IBM recommends that you always specify MAX  * 08273200
*          when creating the list form parameter list as that will    * 08275000
*          ensure that the list form parameter list is always long    * 08276800
*          enough to hold whatever parameters might be specified on   * 08278600
*          the execute form.                                          * 08280400
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 08283000
*          default is the lowest version which allows all of the      * 08285200
*          parameters specified on the invocation to be processed.    * 08287400
*                                                                     * 08289600
*                                                                     * 08291800
*                                                                     * 08294000
*                                                                     * 08296200
*      [MF=S|L|E]                                                   * 08300000
*          is an optional keyword input which specifies the macro     * 08350000
*          form.                                                      * 08400000
*          DEFAULT: S                                                 * 08450000
*                                                                     * 08500000
*                                                                     * 08550000
*          [MF=S]                                                     * 08600000
*              specifies the standard form of the macro.  The "S"     * 08650000
*              form generates code to put the parameters into an      * 08700000
*              in-line parameter list and invoke the desired service. * 08750000
*              Full checking for required macro keys is done along    * 08800000
*              with supplying defaults for omitted optional           * 08850000
*              parameters.                                            * 08900000
*                                                                     * 08950000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 09000000
*              specifies the list form of the macro.  The "L" form    * 09050000
*              defines an area to be used for the parameter list.     * 09100000
*              Only the PLISTVER key may be specified on the          * 09120000
*              invocation.  All other macro parameters are flagged as * 09140000
*              errors.  If PLISTVER is not specified, the original    * 09160000
*              parameter list definition is used.                     * 09180000
*                                                                     * 09200000
*            ,xmfctrl                                                 * 09250000
*              is a required input.  It is the name of a storage area * 09300000
*              for the parameter list.                                * 09350000
*                                                                     * 09400000
*            ,xmfattr|0D                                            * 09450000
*              is an optional 60 character input string that varies   * 09500000
*              from 1 to 60 characters. Use it to force boundary      * 09550000
*              alignment of the parameter list. Use only 0F or 0D.    * 09600000
*              DEFAULT: 0D which forces the parameter list to a       * 09750000
*              doubleword boundary.                                   * 09800000
*                                                                     * 09850000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 09900000
*              specifies the execute form of the macro.  The "E" form * 09950000
*              generates code to put the parameters into the          * 10000000
*              parameter list specified by xmfctrl and provides full  * 10050000
*              syntax checking with default setting.                  * 10100000
*                                                                     * 10150000
*            ,xmfctrl                                                 * 10200000
*              is a required input.  It is the name (RS-type), or     * 10250000
*              address in register (1)-(12), of a storage area for    * 10300000
*              the parameter list.                                    * 10350000
*                                                                     * 10400000
*            ,COMPLETE                                              * 10450000
*              is an optional keyword input which specifies the       * 10500000
*              degree of macro parameter syntax checking.             * 10550000
*              DEFAULT: COMPLETE                                      * 10600000
*                                                                     * 10650000
*                                                                     * 10700000
*              COMPLETE                                               * 10740000
*                  Checking for required macro keys is done and       * 10780000
*                  defaults are supplied for omitted optional         * 10820000
*                  parameters.                                        * 10860000
*                                                                     * 10900000
*                                                                     * 10950000
*                                                                     * 11000000
*                                                                     * 11050000
*                                                                     * 11100000
*                                                                     * 11150000
*                                                                     * 11200000
*01* ABEND CODES:  None.                                              * 11216600
*                                                                     * 11233200
*01* RETURN CODES:                                                    * 11250000
*                                                                     * 11300000
*                                                                     * 11350000
*            0    Name: IwmRetCodeOk                                  * 11400000
*                                                                     * 11450000
*                 Meaning: Successful completion.                     * 11500000
*                                                                     * 11600000
*                 Action: None required.                              * 11610000
*                                                                     * 11620000
*            4    Name: IwmRetCodeWarning                             * 11630000
*                                                                     * 11640000
*                 Meaning: Successful completion, unusual conditions  * 11650000
*                 noted.                                              * 11660000
*                                                                     * 11670000
*                                                                     * 11680000
*                 HEX REASON  MEANING/ACTION                          * 11690000
*                 CODE                                                * 11700000
*                                                                     * 11750000
*                 xxxx0411    Name: IwmRsnCodeEnclActive              * 11775000
*                                                                     * 11800000
*                             Meaning:  Input enclave had 1 or more   * 11825000
*                             SRBs scheduled or running, or 1 or more * 11850000
*                             TCBs joined to the enclave.             * 11875000
*                                                                     * 11900000
*                             Action: None required.                  * 11925000
*                                                                     * 11950000
*                                                                     * 12000000
*                                                                     * 12050000
*            8    Name: IwmRetCodeInvocError                          * 12075000
*                                                                     * 12100000
*                 Meaning: Invalid invocation environment or          * 12150000
*                 parameters.                                         * 12200000
*                                                                     * 12250000
*                                                                     * 12283300
*                 HEX REASON  MEANING/ACTION                          * 12316600
*                 CODE                                                * 12350000
*                                                                     * 12400000
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 12425000
*                                                                     * 12450000
*                             Meaning: Caller is disabled.            * 12500000
*                                                                     * 12600000
*                             Action: Avoid requesting this function  * 12633300
*                             while disabled.                         * 12666600
*                                                                     * 12700000
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 12750000
*                                                                     * 12850000
*                             Meaning: Caller is locked.              * 12900000
*                                                                     * 13050000
*                             Action: Avoid requesting this function  * 13060300
*                             while locked.                           * 13070600
*                                                                     * 13080900
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 13091200
*                                                                     * 13101500
*                             Meaning:  Error accessing parameter     * 13111800
*                             list.                                   * 13122100
*                                                                     * 13132400
*                             Action: Check for possible storage      * 13142700
*                             overlay.                                * 13153000
*                                                                     * 13163300
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 13173600
*                                                                     * 13183900
*                             Meaning: Caller invoked service but was * 13194200
*                             in 24 bit addressing mode.              * 13204500
*                                                                     * 13214800
*                             Action: Request this function only when * 13225100
*                             you are in 31 bit addressing mode.      * 13235400
*                                                                     * 13245700
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 13246800
*                                                                     * 13247900
*                             Meaning: Version number in parameter    * 13249000
*                             list is not valid.                      * 13250100
*                                                                     * 13251200
*                             Action: Check for possible storage      * 13252300
*                             overlay of the parameter list.          * 13253400
*                                                                     * 13254500
*                 xxxx083A    Name: IwmRsnCodeBadEnclave              * 13256000
*                                                                     * 13266300
*                             Meaning: Enclave token does not pass    * 13276600
*                             verification.                           * 13286900
*                                                                     * 13297200
*                             Action: Check for possible storage      * 13307500
*                             overlay of the enclave token, or        * 13317800
*                             asynchronous events which may have      * 13328100
*                             deleted the enclave.                    * 13330500
*                                                                     * 13332900
*                 xxxx0872    Name: IwmRsnCodeForeignEnclave          * 13335300
*                                                                     * 13337700
*                             Meaning: The enclave is foreign.        * 13340100
*                                                                     * 13342500
*                             Action: Use the IWMUIMPT macro to       * 13344900
*                             delete a foreign enclave.               * 13347300
*                                                                     * 13350000
*                                                                     * 13400000
*                                                                     * 13450000
*            10   Name: IwmRetCodeCompError                           * 13475000
*                                                                     * 13500000
*                 Meaning: Component error.                           * 13550000
*                                                                     * 13600000
*                 Action: No action required.  The function may be    * 13616600
*                 successful if invoked again.                        * 13633200
*                                                                     * 13650000
*                                                                     * 13700000
*                                                                     * 13750000
*01* REASON CODES:                                                    * 13800000
*                                                                     * 13850000
*       A unique reason code will be returned whenever the return     * 13900000
*       code is non-zero.  Reason codes, as appropriate, are defined  * 13950000
*       under their corresponding return code.  Reason code and       * 14000000
*       return code constants are defined within IWMYCON.  Note that  * 14050000
*       the high order halfword of register 0, and the reason code    * 14100000
*       variable when specified, may be non-zero and represents       * 14150000
*       diagnostic data which is NOT part of the external interface.  * 14200000
*       The high order halfword should thus be excluded from          * 14250000
*       comparison with the reason code values described above.  The  * 14300000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 14350000
*       used for this purpose.                                        * 14400000
*                                                                     * 14450000
*01* MODULE TYPE:  ASSEM MACRO                                        * 14500000
*                                                                     * 14550000
*02*   PROCESSOR:  ASSEM                                              * 14600000
*                                                                     * 14650000
*01* COMPONENT:  SCWLM                                                * 14700000
*                                                                     * 14750000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 14800000
*                                                                     * 14850000
*01* EXAMPLES:                                                        * 14853300
*                                                                     * 14856600
*    To allow the current task to delete an enclave:                  * 14859900
*                                                                     * 14863200
*               IWMEDELE ETOKEN=ENCTOKEN,RETCODE=RC,RSNCODE=RSN       * 14866500
*      *                                                              * 14869800
*      * Storage areas                                                * 14873100
*      *                                                              * 14876400
*      ENCTOKEN DS    CL8             Contains the enclave token      * 14879700
*      *                                                              * 14883000
*      RC       DS    F               Return code                     * 14886300
*      RSN      DS    F               Reason code                     * 14889600
*                                                                     * 14892900
*                                                                     * 14896200
*01* MACRO USAGE NOTES:                                               * 14900000
*                                                                     * 14950000
*                                                                     * 15000000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 15050000
*        global macro variable.  Any value other than 'NO' will       * 15100000
*        result in the macro expansion being printed.  The default is * 15150000
*        'YES'.  The following examples illustrate how the ZPRINT     * 15200000
*        variable should be set.                                      * 15250000
*                                                                     * 15300000
*                    GBLC &ZPRINT                                     * 15350000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 15400000
*                                                                     * 15450000
*                                                                     * 15600000
*    2.  The IWMEDELE macro supports multiple versions. The macro key * 15609000
*        list  below  contains the version level in which the key was * 15618000
*        first  introduced.  Positionals  are  identified by the word * 15627000
*        'Positional'  followed by the numeric value of its position. * 15636000
*        Nested  positionals  are  preceded  by their outer key.  The * 15645000
*        lowest value represents the original version and the highest * 15654000
*        value  represents  the  most  recent version of the IWMEDELE * 15663000
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 15672000
*        least  as high as the highest version number of all the keys * 15681000
*        being used.                                                  * 15690000
*                                                                     * 15700000
*        VERSION   KEY                                                * 15750000
*                                                                     * 15800000
*              0      ETOKEN                                          * 15850000
*              1      CPUSERVICE                                      * 15900000
*                     CPUTIME                                         * 15950000
*              2      SYSPLEXCPUSRV                                   * 16000000
*                                                                     * 16250000
*                                                                     * 16300000
*                                                                     * 16350000
*01* CHANGE ACTIVITY:                                                 * 16400000
*                                                                     * 16450000
*   Flag LineItem  FMID    Date   ID    Comment                       * 16500000
*                                                                     * 16550000
*    $L0=ENCLV    HBB5520 940103 PD16:  Enclave Delete                * 16600000
*    $L1=WLMP     HBB6603 950318 PDDE:  Business Unit-of-Work         * 16616600
*                                         Management                  * 16633200
*    $O1=WLMP     HBB6605 980302 PDKN:  Return CPU time and service   * 16638800
*    $L2=WLMPMES  JBB6609 981026 PDCO:  Return sysplex service        * 16644400
****** END OF SPECIFICATIONS *****************************************/ 16650000
*/* TLINE 1 *********************************************************** 16700000
         MACRO                                                          16750000
&XLABEL  IWMEDELE &ETOKEN=,&CPUSERVICE=,&SYSPLEXCPUSRV=,&CPUTIME=,     *16783300
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      16816600
.*                                                                      16850000
*                   MACDATE -09/15/99-<2>                               16900000
.*                                                                      16950000
.*******************************************************************    17000000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        17050000
.*******************************************************************    17100000
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              17150000
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                17200000
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        17250000
.*                                                                      17300000
                   GBLC  &ZIWMEDELE  YES=MACRO USED AT LEAST ONCE       17350000
.*******************************************************************    17400000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          17450000
.*******************************************************************    17500000
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            17550000
                   LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS       17600000
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         17650000
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        17700000
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        17750000
                   LCLA  &ZAWRK      USED AS A WORK AREA                17800000
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             17850000
                   LCLA  &ZN         NUMERIC WORK VARIABLE              17900000
                   LCLC  &ZC         CHARACTER WORK VARIABLE            17950000
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        18000000
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            18050000
                   LCLA  &ZMACRET    MACRO RETURN CODE                  18100000
&ZMACRET           SETA  0           ASSUME NO ERRORS                   18150000
.*                                                                      18200000
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      18227000
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         18254000
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              18281000
                   LCLC  &ZENDBASEPL            End of base PL          18308000
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              18335000
.*******************************************************************    18362300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             18366400
.*******************************************************************    18370500
                   LCLA  &ZI         INDEX FOR ARRAY                    18374700
                   LCLA  &ZJ         INDEX FOR PARMS                    18378900
                   LCLA  &ZK         INDEX FOR PARSE                    18383100
                   LCLA  &ZLO        LOW RANGE VALUE                    18387300
                   LCLA  &ZHI        HIGH RANGE VALUE                   18391500
                   LCLC  &ZW         WORK AREA FOR PARM                 18395700
.********************************************************************   18400000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 18450000
.********************************************************************   18500000
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            18537500
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     18575000
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   18612500
.*                                                                      18650000
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     18700000
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      18750000
                   SPLEVEL  TEST                                        18800000
.ZSYS2             ANOP  ,                                              18850000
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          18900000
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          18950000
                   SYSSTATE TEST                                        19000000
                   AGO   .ZSYS4                                         19050000
.ZSYS3             ANOP  ,                                              19100000
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            19150000
.ZSYS4             ANOP  ,                                              19200000
.*******************************************************************    19250000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   19300000
.*******************************************************************    19350000
                   LCLC  &XETOKEN    ++ NAME                            19387500
                   LCLC  &XCPUSERVICE           ++ NAME                 19425000
                   LCLC  &XSYSPLEXCPUSRV        ++ NAME                 19462500
                   LCLC  &XCPUTIME   ++ NAME                            19500000
                   LCLC  &XRETCODE   ++ NAME                            19537500
                   LCLC  &XRSNCODE   ++ NAME                            19575000
                   LCLA  &XPLISTVER  ++ VALUE                           19612500
                   LCLC  &XMF        ++ VALUE                           19650000
                   LCLC  &XMFCTRL    ++ NAME                            19687500
                   LCLC  &XMFATTR    ++ VALUE                           19725000
                   LCLC  &XMFSCK     ++ VALUE                           19762500
.*******************************************************************    19800000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           19850000
.*******************************************************************    19900000
                   LCLC  &ZXETOKEN   ++ INPUT NAME                      19937500
                   LCLC  &ZXCPUSERVICE          ++ OUTPUT NAME          19975000
                   LCLC  &ZXSYSPLEXCPUSRV       ++ OUTPUT NAME          20012500
                   LCLC  &ZXCPUTIME  ++ OUTPUT NAME                     20050000
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     20087500
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     20125000
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          20162500
                   LCLC  &ZXMF       ++ INPUT VALUE                     20200000
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      20237500
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     20275000
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     20312500
.********************************************************************   20350000
.***AC.PLV01  PROCESS PLISTVER                                      *   20350800
.********************************************************************   20351600
&XPLISTVER      SETA  0                                                 20352400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       20353200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   20354000
&XPLISTVER      SETA  2                                                 20354800
.ZPLV0          ANOP  ,                                                 20355600
.*                                                                      20355700
                AIF   ('&CPUSERVICE' EQ '').ZPLV1E                      20355800
                AIF   (&XPLISTVER GE 1).ZPLV1E                          20355900
&XPLISTVER      SETA  1                                                 20356000
.ZPLV1E         ANOP  ,                                                 20356100
.*                                                                      20356200
                AIF   ('&SYSPLEXCPUSRV' EQ '').ZPLV2E                   20356300
                AIF   (&XPLISTVER GE 2).ZPLV2E                          20356400
&XPLISTVER      SETA  2                                                 20356500
.ZPLV2E         ANOP  ,                                                 20356600
.*                                                                      20356700
                AIF   ('&CPUTIME' EQ '').ZPLV3E                         20356800
                AIF   (&XPLISTVER GE 1).ZPLV3E                          20356900
&XPLISTVER      SETA  1                                                 20357000
.ZPLV3E         ANOP  ,                                                 20357100
.*                                                                      20357200
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      20357300
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      20358000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  20358800
.*-------------------------------------------------------------------   20359600
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 20360400
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                20361200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 20362000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 20362800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               20363600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                20364400
                AGO   .ZPVCK2                                           20365200
.ZPVCK3         ANOP  ,                                                 20366000
.*-------------------------------------------------------------------   20366800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  20367600
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                20368400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 20369200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         20370000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 20370800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                20371600
                AGO   .ZPVCKE                                           20372400
.ZPVCK2         ANOP  ,                                                 20373200
.*-------------------------------------------------------------------   20374000
&ZCVAL          SETC  '&PLISTVER(1)'                                    20374800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             20375600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             20376400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        20377000
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      20377600
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     20378200
.ZPVCK6         ANOP  ,                                                 20378800
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                20379600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 20380400
&ZMS            SETC  '&ZMS THE RANGE IS "0-2"'                         20381200
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         20382000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                20382800
&XPLISTVER      SETA  2                                                 20383600
                AGO   .ZPVCKE                                           20384400
.*-------------------------------------------------------------------   20385200
.ZPVCK4A        ANOP  ,                                                 20386000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        20386800
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                20387600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               20388400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          20389200
&ZMS            SETC  '&ZMS &XPLISTVER'                                 20390000
                MNOTE 8,' &ZMS IS REQUIRED.'                            20390800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                20391600
                AGO   .ZPVCK5                                           20392400
.ZPVCK4         ANOP  ,                                                 20393200
&XPLISTVER      SETA  &PLISTVER(1)                                      20394000
.ZPVCK5         ANOP  ,                                                 20394800
.ZPVCKE         ANOP  ,                                                 20395600
.********************************************************************   20396400
.***AG.MF01 PROCESS MF MACRO FORMS                                      20400000
.********************************************************************   20450000
                   ACTR  10000                                          20500000
.*------------------------------------------------------------------    20550000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           20600000
&XMF               SETC  ''          INITIALIZE XVARIABLE               20650000
.*-------------------------------------------------------------------   20700000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           20750000
.ZG24              ANOP  ,                                              20800000
&ZTLC              SETC 'S'                                             20850000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG25                     20900000
&XMF               SETC  'S'         SET KEYWORD                        20950000
                   AIF   (N'&MF LE 1).ZG24A     CK NUM                  21000000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      21050000
&ZMS               SETC  '&ZMS.&MF"'                                    21100000
&ZMS               SETC  '&ZMS "MF"'                                    21150000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            21200000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        21250000
.ZG24A             ANOP  ,                                              21300000
.*-------------------------------------------------------------------   21350000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           21400000
.ZG25              ANOP  ,                                              21450000
&ZTLC              SETC 'L'                                             21500000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG32                     21550000
&XMF               SETC  'L'         SET KEYWORD                        21600000
                   AIF   (N'&MF LE 3).ZG25A     CK NUM                  21650000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      21700000
&ZMS               SETC  '&ZMS.&MF"'                                    21750000
&ZMS               SETC  '&ZMS "MF"'                                    21800000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           21850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        21900000
.ZG25A             ANOP  ,                                              21950000
.*-------------------------------------------------------------------   22000000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     22050000
                   AIF   (N'&SYSLIST NE 0).ZG25B  POSITIONALS?          22093700
                   AIF   ('&ETOKEN' NE '').ZG25B  KEYS?                 22137400
                   AIF   ('&CPUSERVICE' NE '').ZG25B  KEYS?             22181100
                   AIF   ('&SYSPLEXCPUSRV' NE '').ZG25B  KEYS?          22224800
                   AIF   ('&CPUTIME' NE '').ZG25B  KEYS?                22268500
                   AIF   ('&RETCODE' NE '').ZG25B  KEYS?                22312200
                   AIF   ('&RSNCODE' NE '').ZG25B  KEYS?                22355900
                   AGO    .ZG25C     INVOCATION OKAY                    22399600
.ZG25B             ANOP  ,                                              22443300
&ZMS               SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE           22487000
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           22530700
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      22574400
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         22618100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        22661800
.ZG25C             ANOP  ,                                              22705500
.*-------------------------------------------------------------------   22750000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   22800000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      22850000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      22900000
                   AIF   (N'&MF(2) GT 1).ZG27B  MULTI PARMS             22950000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      23000000
.ZG27B             AIF   (K'&MF(2) GT 0).ZG27C                          23050000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    23100000
&ZMS               SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*               23150000
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            23200000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   23250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        23300000
.ZG27C             ANOP  ,                                              23350000
.*-------------------------------------------------------------------   23400000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               23450000
                   AIF   (K'&ZXMFCTRL LE 0).ZG27P  NOT I/O              23500000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG27P                 23550000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    23600000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      23650000
&ZMS               SETC  '&ZMS.&MF"'                                    23700000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      23750000
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              23800000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        23850000
.ZG27P             ANOP  ,                                              23900000
.*-------------------------------------------------------------------   23950000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      24000000
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      24050000
&XMFATTR           SETC  '0D'                                           24100000
                   AIF   (K'&MF(3) LE 0).ZG30B  PARM                    24150000
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      24200000
                   AIF   (N'&MF(3) GT 1).ZG30B  MULTI PARMS             24250000
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      24300000
.ZG30B             ANOP  ,                                              24350000
.*-------------------------------------------------------------------   24400000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  24450000
                   AIF   (K'&ZXMFATTR LE 0).ZG30P  NOT I/O              24500000
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG30P                 24550000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    24600000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      24650000
&ZMS               SETC  '&ZMS.&MF"'                                    24700000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      24750000
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              24800000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        24850000
.ZG30P             ANOP  ,                                              24900000
.*-------------------------------------------------------------------   24950000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 25000000
                   AIF   (K'&ZXMFATTR LE 0).ZG30S  NOT I/O              25050000
                   AIF   (K'&XMFATTR LE 60).ZG30S  LNG OK               25100000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    25150000
&ZMS               SETC  '"MF='      *KLNGA* MNOTE                      25200000
&ZMS               SETC  '&ZMS.&MF"'                                    25250000
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          25300000
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             25350000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        25400000
.ZG30S             ANOP  ,                                              25450000
.*-------------------------------------------------------------------   25500000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           25550000
.ZG32              ANOP  ,                                              25600000
&ZTLC              SETC 'E'                                             25650000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG40                     25700000
&XMF               SETC  'E'         SET KEYWORD                        25750000
                   AIF   (N'&MF LE 3).ZG32A     CK NUM                  25800000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      25850000
&ZMS               SETC  '&ZMS.&MF"'                                    25900000
&ZMS               SETC  '&ZMS "MF"'                                    25950000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           26000000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        26050000
.ZG32A             ANOP  ,                                              26100000
.*-------------------------------------------------------------------   26150000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   26200000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      26250000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      26300000
                   AIF   (N'&MF(2) GT 1).ZG34B  MULTI PARMS             26350000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      26400000
.ZG34B             AIF   (K'&MF(2) GT 0).ZG34C                          26450000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    26500000
&ZMS               SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*               26550000
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            26600000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   26650000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        26700000
.ZG34C             ANOP  ,                                              26750000
.*-------------------------------------------------------------------   26800000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              26850000
                   AIF   (K'&ZXMFCTRL LE 0).ZG34R  NOT I/O              26900000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG34R                 26950000
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     27000000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                   27050000
                   AIF   (K'&ZCGPR GT 2).ZG34Q                          27100000
                   AIF   ('&ZCGPR' EQ '0').ZG34Q                        27150000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  27200000
                   AIF   (T'&ZCGPR NE 'N').ZG34Q  INVALID REG NAME      27250000
.ZG34P             ANOP  ,                                              27300000
                   AIF   (T'&ZCGPR NE 'N').ZG34R  NON NUMERIC           27350000
                   AIF   ('&ZCGPR' LT '1').ZG34Q                        27400000
                   AIF   ('&ZCGPR' LE '12').ZG34R                       27450000
.ZG34Q             ANOP  ,                                              27500000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      27550000
&ZMS               SETC  '&ZMS.&MF"'                                    27600000
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      27650000
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               27700000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        27750000
.ZG34R             ANOP  ,                                              27800000
.*-------------------------------------------------------------------   27850000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             27900000
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               27950000
.ZG38A   AIF   ('&MF(3)' NE 'COMPLETE').ZG39A                           28000000
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        28050000
.*-------------------------------------------------------------------   28100000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             28150000
.ZG39A             AIF   (K'&XMFSCK GT 0).ZG39C  KEYWORD                28200000
                   AIF   (K'&MF(3) LE 0).ZG39B                          28250000
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      28300000
&ZMS               SETC  '&ZMS.&MF"'                                    28350000
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      28400000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            28450000
&ZMS               SETC  '&ZMS "COMPLETE".'                             28500000
                   MNOTE 8,' &ZMS '                                     28550000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        28600000
.ZG39B             ANOP  ,                                              28650000
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                28700000
.ZG39C             ANOP  ,                                              28750000
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      28800000
.*------------------------------------------------------------------    28850000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           28900000
.ZG40              ANOP  ,                                              28950000
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      29000000
                   AIF   (K'&XMF GT 0).ZG40E    VALID ARG               29050000
                   AIF   (T'&MF EQ 'O').ZG40D   OMITTED                 29100000
&ZASYSLNDX         SETA  0                                              29150000
.ZG40A             ANOP  ,           POSITIONAL MACRO KEY               29200000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   29250000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG40C               29300000
&ZTLC              SETC 'MF'                                            29350000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG40A      29400000
.ZG40B             ANOP  ,                                              29450000
&ZXMF              SETC  ''          RESET IN/OUTPUT                    29500000
&ZMS               SETC  'THE "MF" KEY'         *KOPTA* MNOTE           29550000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        29600000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               29650000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        29700000
                   AGO   .ZG40E                                         29750000
.ZG40C             ANOP  ,                                              29800000
&ZXMF              SETC  ''          RESET IN/OUTPUT                    29850000
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      29900000
&ZMS               SETC  '&ZMS.&MF"'                                    29950000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      30000000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            30050000
&ZMS               SETC  '&ZMS "S",'                                    30100000
&ZMS               SETC  '&ZMS "L",'                                    30150000
&ZMS               SETC  '&ZMS OR "E".'                                 30200000
                   MNOTE 8,' &ZMS '                                     30250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        30300000
                   AGO   .ZG40E                                         30350000
.ZG40D             ANOP  ,                                              30400000
&XMF               SETC  'S'         SET DEFAULT KEYWORD                30450000
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  30500000
.ZG40E             ANOP  ,                                              30550000
.********************************************************************   30600000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 30650000
.********************************************************************   30700000
                   ACTR  10000                                          30750000
.*-------------------------------------------------------------------   30800000
.***AG.MF03 MF=(SLE)                                                    30850000
                   AIF   ('&XMF' EQ 'L').ZGMFX                          30900000
.*----------------------------------------------------------------***   30950000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     31000000
                   AIF   (N'&ETOKEN LE 1).ZG2A  CK NUM                  31050000
&ZMS               SETC  '"ETOKEN='  *KPOSA* MNOTE                      31100000
&ZMS               SETC  '&ZMS.&ETOKEN"'                                31150000
&ZMS               SETC  '&ZMS "ETOKEN"'                                31200000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            31250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        31300000
.ZG2A              ANOP  ,                                              31350000
.*-------------------------------------------------------------------   31400000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         31450000
&ZXETOKEN          SETC  'INPUT'     SET IN/OUTPUT                      31500000
&XETOKEN           SETC  '&ETOKEN(1)'           SET XVARIABLE           31550000
                   AIF   (N'&ETOKEN GT 1).ZG2B  MULTI PARMS             31600000
&XETOKEN           SETC  '&ETOKEN'   SET XVARIABLE                      31650000
.ZG2B              AIF   (K'&ETOKEN(1) GT 0).ZG2C                       31700000
&ZXETOKEN          SETC  ''          RESET IN/OUTPUT                    31750000
&ZMS               SETC  ' '         *KRQDA*                            31800000
&ZMS               SETC  '&ZMS "ETOKEN" KEY AND ITS'                    31850000
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               31900000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        31950000
.ZG2C              ANOP  ,                                              32000000
.*-------------------------------------------------------------------   32050000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    32100000
                   AIF   (K'&ZXETOKEN LE 0).ZG2R  NOT I/O               32150000
                   AIF   ('&XETOKEN'(1,1) NE '(').ZG2R                  32200000
&ZCGPR             SETC  '&XETOKEN'(2,K'&XETOKEN-2)                     32250000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                    32300000
                   AIF   (K'&ZCGPR GT 2).ZG2Q                           32350000
                   AIF   ('&ZCGPR' EQ '0').ZG2Q                         32400000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  32450000
                   AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME       32500000
.ZG2P              ANOP  ,                                              32550000
                   AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC            32600000
                   AIF   ('&ZCGPR' LT '2').ZG2Q                         32650000
                   AIF   ('&ZCGPR' LE '12').ZG2R                        32700000
.ZG2Q              ANOP  ,                                              32750000
&ZMS               SETC  '"ETOKEN='  *KGPRA* MNOTE                      32800000
&ZMS               SETC  '&ZMS.&ETOKEN"'                                32850000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      32900000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               32950000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        33000000
.ZG2R              ANOP  ,                                              33050000
.*----------------------------------------------------------------***   33100000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    33150000
                   AIF   (N'&CPUSERVICE LE 1).ZG5A  CK NUM              33200000
&ZMS               SETC  '"CPUSERVICE='         *KPOSA* MNOTE           33250000
&ZMS               SETC  '&ZMS.&CPUSERVICE"'                            33300000
&ZMS               SETC  '&ZMS "CPUSERVICE"'                            33350000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            33400000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        33450000
.ZG5A              ANOP  ,                                              33500000
.*-------------------------------------------------------------------   33550000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        33600000
                   AIF   (K'&CPUSERVICE(1) LE 0).ZG5C  NO PARM          33650000
&ZXCPUSERVICE      SETC  'OUTPUT'    SET OUTPUT                         33700000
&XCPUSERVICE       SETC  '&CPUSERVICE(1)'       SET XVARIABLE           33750000
                   AIF   (N'&CPUSERVICE GT 1).ZG5C                      33800000
&XCPUSERVICE       SETC  '&CPUSERVICE'          SET XVARIABLE           33850000
.ZG5C              ANOP  ,                                              33900000
.*-------------------------------------------------------------------   33950000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   34000000
                   AIF   (K'&ZXCPUSERVICE LE 0).ZG5R  NOT I/O           34050000
                   AIF   ('&XCPUSERVICE'(1,1) NE '(').ZG5R              34100000
&ZCGPR             SETC  '&XCPUSERVICE'(2,K'&XCPUSERVICE-2)             34150000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                    34200000
                   AIF   (K'&ZCGPR GT 2).ZG5Q                           34250000
                   AIF   ('&ZCGPR' EQ '0').ZG5Q                         34300000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  34350000
                   AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME       34400000
.ZG5P              ANOP  ,                                              34450000
                   AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC            34500000
                   AIF   ('&ZCGPR' LT '2').ZG5Q                         34550000
                   AIF   ('&ZCGPR' LE '12').ZG5R                        34600000
.ZG5Q              ANOP  ,                                              34650000
&ZMS               SETC  '"CPUSERVICE='         *KGPRA* MNOTE           34700000
&ZMS               SETC  '&ZMS.&CPUSERVICE"'                            34750000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      34800000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               34850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        34900000
.ZG5R              ANOP  ,                                              34950000
.*----------------------------------------------------------------***   35000000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    35050000
                   AIF   (N'&SYSPLEXCPUSRV LE 1).ZG8A  CK NUM           35100000
&ZMS               SETC  '"SYSPLEXCPUSRV='      *KPOSA* MNOTE           35150000
&ZMS               SETC  '&ZMS.&SYSPLEXCPUSRV"'                         35200000
&ZMS               SETC  '&ZMS "SYSPLEXCPUSRV"'                         35250000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            35300000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        35350000
.ZG8A              ANOP  ,                                              35400000
.*-------------------------------------------------------------------   35450000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        35500000
                   AIF   (K'&SYSPLEXCPUSRV(1) LE 0).ZG8C  NO PARM       35550000
&ZXSYSPLEXCPUSRV   SETC  'OUTPUT'    SET OUTPUT                         35600000
&XSYSPLEXCPUSRV    SETC  '&SYSPLEXCPUSRV(1)'    SET XVARIABLE           35650000
                   AIF   (N'&SYSPLEXCPUSRV GT 1).ZG8C                   35700000
&XSYSPLEXCPUSRV    SETC  '&SYSPLEXCPUSRV'       SET XVARIABLE           35750000
.ZG8C              ANOP  ,                                              35800000
.*-------------------------------------------------------------------   35850000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   35900000
                   AIF   (K'&ZXSYSPLEXCPUSRV LE 0).ZG8R  NOT I/O        35921600
                   AIF   ('&XSYSPLEXCPUSRV'(1,1) NE '(').ZG8R           35943200
&ZCGPR             SETC  '&XSYSPLEXCPUSRV'(2,K'&XSYSPLEXCPUSRV-2)       35964800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                    35986400
                   AIF   (K'&ZCGPR GT 2).ZG8Q                           36008000
                   AIF   ('&ZCGPR' EQ '0').ZG8Q                         36029600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  36051200
                   AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME       36072800
.ZG8P              ANOP  ,                                              36094400
                   AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC            36116000
                   AIF   ('&ZCGPR' LT '2').ZG8Q                         36137600
                   AIF   ('&ZCGPR' LE '12').ZG8R                        36159200
.ZG8Q              ANOP  ,                                              36180800
&ZMS               SETC  '"SYSPLEXCPUSRV='      *KGPRA* MNOTE           36202400
&ZMS               SETC  '&ZMS.&SYSPLEXCPUSRV"'                         36224000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      36245600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               36267200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        36288800
.ZG8R              ANOP  ,                                              36310400
.*----------------------------------------------------------------***   36332000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    36353600
                   AIF   (N'&CPUTIME LE 1).ZG11A  CK NUM                36375200
&ZMS               SETC  '"CPUTIME='            *KPOSA* MNOTE           36396800
&ZMS               SETC  '&ZMS.&CPUTIME"'                               36418400
&ZMS               SETC  '&ZMS "CPUTIME"'                               36440000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            36461600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        36483200
.ZG11A             ANOP  ,                                              36504800
.*-------------------------------------------------------------------   36526400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        36548000
                   AIF   (K'&CPUTIME(1) LE 0).ZG11C  NO PARM            36569600
&ZXCPUTIME         SETC  'OUTPUT'    SET OUTPUT                         36591200
&XCPUTIME          SETC  '&CPUTIME(1)'          SET XVARIABLE           36612800
                   AIF   (N'&CPUTIME GT 1).ZG11C                        36634400
&XCPUTIME          SETC  '&CPUTIME'  SET XVARIABLE                      36656000
.ZG11C             ANOP  ,                                              36677600
.*-------------------------------------------------------------------   36699200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   36720800
                   AIF   (K'&ZXCPUTIME LE 0).ZG11R  NOT I/O             36742400
                   AIF   ('&XCPUTIME'(1,1) NE '(').ZG11R                36764000
&ZCGPR             SETC  '&XCPUTIME'(2,K'&XCPUTIME-2)                   36785600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                   36807200
                   AIF   (K'&ZCGPR GT 2).ZG11Q                          36828800
                   AIF   ('&ZCGPR' EQ '0').ZG11Q                        36850400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  36872000
                   AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME      36893600
.ZG11P             ANOP  ,                                              36915200
                   AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC           36936800
                   AIF   ('&ZCGPR' LT '2').ZG11Q                        36958400
                   AIF   ('&ZCGPR' LE '12').ZG11R                       36980000
.ZG11Q             ANOP  ,                                              37001600
&ZMS               SETC  '"CPUTIME='            *KGPRA* MNOTE           37023200
&ZMS               SETC  '&ZMS.&CPUTIME"'                               37044800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      37066400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               37088000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        37109600
.ZG11R             ANOP  ,                                              37131200
.*----------------------------------------------------------------***   37152800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    37174400
                   AIF   (N'&RETCODE LE 1).ZG14A  CK NUM                37196000
&ZMS               SETC  '"RETCODE='            *KPOSA* MNOTE           37217600
&ZMS               SETC  '&ZMS.&RETCODE"'                               37239200
&ZMS               SETC  '&ZMS "RETCODE"'                               37260800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            37282400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        37304000
.ZG14A             ANOP  ,                                              37325600
.*-------------------------------------------------------------------   37347200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        37368800
                   AIF   (K'&RETCODE(1) LE 0).ZG14C  NO PARM            37390400
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         37412000
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           37433600
                   AIF   (N'&RETCODE GT 1).ZG14C                        37455200
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      37476800
.ZG14C             ANOP  ,                                              37498400
.*-------------------------------------------------------------------   37520000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   37541600
                   AIF   (K'&ZXRETCODE LE 0).ZG14R  NOT I/O             37563200
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG14R                37584800
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   37606400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                   37628000
                   AIF   (K'&ZCGPR GT 2).ZG14Q                          37649600
                   AIF   ('&ZCGPR' EQ '0').ZG14Q                        37671200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  37692800
                   AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME      37714400
.ZG14P             ANOP  ,                                              37736000
                   AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC           37757600
                   AIF   ('&ZCGPR' LT '2').ZG14Q                        37779200
                   AIF   ('&ZCGPR' LE '12').ZG14R                       37800800
.ZG14Q             ANOP  ,                                              37822400
&ZMS               SETC  '"RETCODE='            *KGPRA* MNOTE           37844000
&ZMS               SETC  '&ZMS.&RETCODE"'                               37865600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      37887200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               37908800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        37930400
.ZG14R             ANOP  ,                                              37952000
.*----------------------------------------------------------------***   37973600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    37995200
                   AIF   (N'&RSNCODE LE 1).ZG17A  CK NUM                38016800
&ZMS               SETC  '"RSNCODE='            *KPOSA* MNOTE           38038400
&ZMS               SETC  '&ZMS.&RSNCODE"'                               38060000
&ZMS               SETC  '&ZMS "RSNCODE"'                               38081600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            38103200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        38124800
.ZG17A             ANOP  ,                                              38146400
.*-------------------------------------------------------------------   38168000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        38189600
                   AIF   (K'&RSNCODE(1) LE 0).ZG17C  NO PARM            38211200
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         38232800
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           38254400
                   AIF   (N'&RSNCODE GT 1).ZG17C                        38276000
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      38297600
.ZG17C             ANOP  ,                                              38319200
.*-------------------------------------------------------------------   38340800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   38362400
                   AIF   (K'&ZXRSNCODE LE 0).ZG17R  NOT I/O             38384000
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG17R                38405600
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   38427200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                   38448800
                   AIF   (K'&ZCGPR GT 2).ZG17Q                          38470400
                   AIF   ('&ZCGPR' EQ '0').ZG17Q                        38492000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  38513600
                   AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME      38535200
.ZG17P             ANOP  ,                                              38556800
                   AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC           38578400
                   AIF   ('&ZCGPR' LT '2').ZG17Q                        38600000
                   AIF   ('&ZCGPR' LE '12').ZG17R                       38621600
.ZG17Q             ANOP  ,                                              38643200
&ZMS               SETC  '"RSNCODE='            *KGPRA* MNOTE           38664800
&ZMS               SETC  '&ZMS.&RSNCODE"'                               38686400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      38708000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               38729600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        38751200
.ZG17R             ANOP  ,                                              38772800
.******************************************************************     38800000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        38850000
.******************************************************************     38900000
                   ACTR  10000                                          38950000
.*----------------------------------------------------------------***   39000000
.***AH.P02 EXTRA POSITIONALS                                            39050000
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           39084600
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           39119200
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       39153800
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        39188400
.ZGLISTX1          ANOP  ,                                              39223000
&ZCVAL             SETC  ''          ERROR FIELD                        39257600
&ZAWRK             SETA  0           POSITIONAL NUMBER                  39292200
.ZGLIST2           ANOP  ,                                              39326800
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    39361400
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           39396000
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                39430600
                   AGO   .ZGLIST2                                       39465200
.*                                                                      39500000
.ZGLIST3           ANOP  ,                                              39550000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             39600000
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE       39650000
&ZMS               SETC  '&ZMS "&ZCVAL"'                                39700000
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         39750000
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 39800000
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         39850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        39900000
.ZGLISTX           ANOP  ,                                              39950000
&ZASYSLNDX         SETA  0                                              40000000
.*-------------------------------------------------------------------   40050000
.***AG.MF04 MF=(SLE)                                                    40100000
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           40150000
.*******************************************************************    40200000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       40250000
.*******************************************************************    40300000
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          40350000
.*******************************************************************    40400000
.***AE.01  START OF IWMEDELE MACRO CODE                                 40450000
.*******************************************************************    40500000
                   LCLC  &M0M0001                 NAME                  40550000
&M0M0001           SETC  '&XLABEL'                SET NAME              40600000
                   AIF   (K'&XLABEL NE 0).XLAB2                         40650000
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          40700000
.*                                                                      40750000
.XLAB2             ANOP  ,                                              40780000
                   AIF   ('&XMF' EQ 'L').XLAB3                          40810000
&M0M0001 DS    0H                             IWMEDELE-2                40840000
.XLAB3             ANOP  ,                                              40870000
.*******************************************************************    40900000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              40950000
.*******************************************************************    41000000
              PUSH  PRINT                                               41050000
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     41100000
                   PRINT OFF         ++ PR01                            41150000
                   AGO   .ZPRNTXX                                       41200000
.ZPRINTX           PRINT ON                                             41250000
.ZPRNTXX           ANOP  ,                                              41300000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  41350000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  41400000
.********************************************************************   41450000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     41500000
.********************************************************************   41550000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       41600000
                      LCLA  &ZOPN1         INVOCATION INDEX             41650000
                      LCLC  &ZOPL(4095)    LABEL                        41700000
                      LCLC  &ZOPO(4095)    OPERATION                    41750000
                      LCLC  &ZOPV(4095)    VALUE                        41800000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  41850000
.*                                                                      41900000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     41950000
.******************************************************************     42000000
.***AL.L10 IWMEDELE FMT=LIST MF=S|L PARAMETERS                          42050000
.******************************************************************     42100000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     42150000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     42200000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     42250000
&XMFATTR              SETC  '0D'                                        42300000
.*                                                                      42350000
&ZOPN                 SETA  &ZOPN+1                                     42400000
&ZOPL(&ZOPN)          SETC  ' '                                         42450000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     42475000
&ZOPO(&ZOPN)          SETC  'B'                                         42500000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                42550000
                      AGO   .ZALVL6B                                    42558300
.ZALVL6A              ANOP                                              42566600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      42574900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              42583200
.ZALVL6B              ANOP                                              42591500
&ZOPD(&ZOPN)          SETC  '++ IWMEDELE ARG PARMS'                     42600000
.*                                                                      42650000
&ZOPN                 SETA  &ZOPN+1                                     42700000
&ZOPL(&ZOPN)          SETC  ' '                                         42750000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     42800000
&ZOPV(&ZOPN)          SETC  '1'                                         42850000
&ZOPD(&ZOPN)          SETC  ' '                                         42900000
.*                                                                      42950000
.ZLMFSL2              ANOP  ,                                           43000000
.*-------------------------------------------------------------------   43005000
.***AM.L00  IWMEDELE FMT=LIST name                                      43010000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    43015000
&ZOPN                 SETA &ZOPN+1                                      43020000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   43025000
&ZOPO(&ZOPN)          SETC 'EQU'                                        43030000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   43035000
&ZOPD(&ZOPN)          SETC '++ IWMEDELE NAME'                           43040000
.ZLMFSL2M             ANOP  ,                                           43045000
.*-------------------------------------------------------------------   43050000
.***AM.L01  IWMEDELE FMT=LIST PARAMETERS                                43100000
&ZOPN                 SETA &ZOPN+1                                      43150000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   43200000
&ZOPO(&ZOPN)          SETC 'DS'                                         43250000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   43300000
&ZOPD(&ZOPN)          SETC '++ IWMEDELE PARM LIST'                      43350000
.*-------------------------------------------------------------------   43400000
.***AM.L02 XVERSION XL1                                                 43450000
&ZOPN                 SETA &ZOPN+1                                      43500000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         43550000
&ZOPO(&ZOPN)          SETC 'DS'                                         43600000
&ZOPV(&ZOPN)          SETC 'XL1'                                        43650000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          43700000
.*-------------------------------------------------------------------   43750000
.***AM.L09  XRSV0001 CL3                                                43800000
&ZOPN                 SETA &ZOPN+1                                      43850000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         43900000
&ZOPO(&ZOPN)          SETC 'DS'                                         43950000
&ZOPV(&ZOPN)          SETC 'CL3'                                        44000000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      44050000
.*-------------------------------------------------------------------   44100000
.***AM.L09  XETOKEN CL8                                                 44150000
&ZOPN                 SETA &ZOPN+1                                      44200000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XETOKEN'                          44250000
&ZOPO(&ZOPN)          SETC 'DS'                                         44300000
&ZOPV(&ZOPN)          SETC 'CL8'                                        44350000
&ZOPD(&ZOPN)          SETC '++ &ZXETOKEN  XETOKEN'                      44400000
.*-------------------------------------------------------------------   44450000
.***AM.L09  XRSV000C CL4                                                44500000
&ZOPN                 SETA &ZOPN+1                                      44550000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV000C'                         44600000
&ZOPO(&ZOPN)          SETC 'DS'                                         44650000
&ZOPV(&ZOPN)          SETC 'CL4'                                        44700000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV000C'                      44750000
.*-------------------------------------------------------------------   44800000
.***AM.L09  XRSV0010 CL4                                                44850000
&ZOPN                 SETA &ZOPN+1                                      44900000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0010'                         44950000
&ZOPO(&ZOPN)          SETC 'DS'                                         45000000
&ZOPV(&ZOPN)          SETC 'CL4'                                        45050000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0010'                      45100000
.*-------------------------------------------------------------------   45150000
.***AM.MLM2 SAVED LOCATION COUNTER                                      45150700
                      AIF  (&XPLISTVER GE 1).ZL5LA                      45151400
                      AIF  ('&ZENDBASEPL' NE '').ZL5LA                  45152100
&ZENDBASEPL           SETC 'YES'                                        45152800
&ZOPN                 SETA &ZOPN+1                                      45153500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           45154200
&ZOPO(&ZOPN)          SETC 'EQU'                                        45154900
&ZOPV(&ZOPN)          SETC '*'                                          45155600
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       45156300
.ZL5LA                ANOP  ,                                           45157000
.*-------------------------------------------------------------------   45157700
.***AM.LVER1                                                            45158400
                      AIF  (&XPLISTVER LT 1).ZL5L                       45159100
.*-------------------------------------------------------------------   45159800
.*-------------------------------------------------------------------   45160500
.***AM.L09  XCPUSERVICE BL.64                                           45161200
&ZOPN                 SETA &ZOPN+1                                      45161900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCPUSERVICE'                      45162600
&ZOPO(&ZOPN)          SETC 'DS'                                         45163300
&ZOPV(&ZOPN)          SETC 'BL.64'                                      45164000
&ZOPD(&ZOPN)          SETC '++ &ZXCPUSERVICE  XCPUSERVICE'              45164700
.*-------------------------------------------------------------------   45165400
.***AM.LVER2                                                            45166100
.ZL5L                 ANOP  ,                                           45166800
.*-------------------------------------------------------------------   45167500
.*-------------------------------------------------------------------   45168200
.***AM.LVER1                                                            45168900
                      AIF  (&XPLISTVER LT 1).ZL6L                       45169600
.*-------------------------------------------------------------------   45170300
.*-------------------------------------------------------------------   45171000
.***AM.L09  XCPUTIME BL.64                                              45171700
&ZOPN                 SETA &ZOPN+1                                      45172400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCPUTIME'                         45173100
&ZOPO(&ZOPN)          SETC 'DS'                                         45173800
&ZOPV(&ZOPN)          SETC 'BL.64'                                      45174500
&ZOPD(&ZOPN)          SETC '++ &ZXCPUTIME  XCPUTIME'                    45175200
.*-------------------------------------------------------------------   45175900
.***AM.LVER2                                                            45176600
.ZL6L                 ANOP  ,                                           45177300
.*-------------------------------------------------------------------   45178000
.*-------------------------------------------------------------------   45178700
.***AM.MLM2 SAVED LOCATION COUNTER                                      45179400
                      AIF  (&XPLISTVER GE 2).ZL7LA                      45180100
                      AIF  ('&ZENDBASEPL' NE '').ZL7LA                  45180800
&ZENDBASEPL           SETC 'YES'                                        45181500
&ZOPN                 SETA &ZOPN+1                                      45182200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           45182900
&ZOPO(&ZOPN)          SETC 'EQU'                                        45183600
&ZOPV(&ZOPN)          SETC '*'                                          45184300
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       45185000
.ZL7LA                ANOP  ,                                           45185700
.*-------------------------------------------------------------------   45186400
.***AM.LVER1                                                            45187100
                      AIF  (&XPLISTVER LT 2).ZL7L                       45187800
.*-------------------------------------------------------------------   45188500
.*-------------------------------------------------------------------   45189200
.***AM.L09  XSYSPLEXCPUSRV BL.64                                        45189900
&ZOPN                 SETA &ZOPN+1                                      45190600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSPLEXCPUSRV'                   45191300
&ZOPO(&ZOPN)          SETC 'DS'                                         45192000
&ZOPV(&ZOPN)          SETC 'BL.64'                                      45192700
&ZOPD(&ZOPN)          SETC '++ &ZXSYSPLEXCPUSRV  XSYSPLEXCPUSRV'        45193400
.*-------------------------------------------------------------------   45194100
.***AM.LVER2                                                            45194800
.ZL7L                 ANOP  ,                                           45195500
.*-------------------------------------------------------------------   45196200
.*-------------------------------------------------------------------   45196900
.***AM.L10 END OF IWMEDELE LIST PARAMETERS                              45200000
&ZOPN                 SETA &ZOPN+1                                      45250000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 45300000
&ZOPO(&ZOPN)          SETC 'EQU'                                        45350000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 45400000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         45450000
.*                                                                      45500000
&ZOPN                 SETA &ZOPN+1                                      45550000
&ZOPL(&ZOPN)          SETC ' '                                          45600000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      45650000
&ZOPV(&ZOPN)          SETC '1'                                          45700000
&ZOPD(&ZOPN)          SETC ' '                                          45750000
.*-------------------------------------------------------------------   45800000
.***AL.L12 IWMEDELE FMT=LIST MF=S|L PARAMETERS                          45850000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         45900000
.*                                                                      45950000
&ZOPN                 SETA  &ZOPN+1                                     46000000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                46050000
&ZOPO(&ZOPN)          SETC  'DC'                                        46100000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   46150000
&ZOPD(&ZOPN)          SETC  '++ IWMEDELE ARG PARMS'                     46200000
.*                                                                      46250000
.ZLMFSLX              ANOP  ,                                           46300000
.*-------------------------------------------------------------------   46350000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          46400000
&ZPLLEN               SETA 20                                           46450000
.*                                                                      46500000
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    46505500
&ZPLLEN               SETA 36                                           46511000
.ZLLEN2Z              ANOP  ,                                           46516500
.*                                                                      46522000
                      AIF  (&XPLISTVER LT 2).ZLLEN3Z                    46527500
&ZPLLEN               SETA 44                                           46533000
.ZLLEN3Z              ANOP  ,                                           46538500
.*                                                                      46544000
.******************************************************************     46550000
.***AI.L01 IWMEDELE FMT=LIST FILL IN PARAMETER AREA                     46600000
.******************************************************************     46650000
                      ACTR  10000                                       46700000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               46750000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    46800000
&ZCVAL                SETC  'LAE'          XAX MODE                     46850000
.ZIMFXA               ANOP ,                                            46900000
.*                                                                      46950000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    47000000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         47050000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 47100000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                47150000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 47200000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                47250000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   47300000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    47350000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   47400000
&ZOPN                 SETA  &ZOPN+1                                     47450000
&ZOPL(&ZOPN)          SETC  ' '                                         47500000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    47550000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              47600000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       47650000
                      AGO   .ZIMFNX                                     47700000
.*                                                                      47750000
.ZIMFN2               ANOP ,                                            47800000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     47812500
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     47825000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  47837500
&ZOPN                 SETA  &ZOPN+1                                     47850000
&ZOPL(&ZOPN)          SETC  ' '                                         47856200
&ZOPO(&ZOPN)          SETC  'LAE'                                       47862400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  47868600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       47874800
                      AGO   .ZIMFNX                                     47881000
.ZIMFNX1              ANOP ,                                            47887200
&ZOPN                 SETA  &ZOPN+1                                     47893400
&ZOPL(&ZOPN)          SETC  ' '                                         47900000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    47950000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                48000000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       48050000
.ZIMFNX               ANOP ,                                            48100000
.********************************************************************   48150000
.***AI.L02 IWMEDELE FMT=LIST INITIALIZE PARAMETER AREA                  48200000
.********************************************************************   48250000
.***AI.L03 MF=(SLE)                                                     48300000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      48350000
.*                                                                      48400000
&ZOPN                 SETA  &ZOPN+1                                     48450000
&ZOPL(&ZOPN)          SETC  ' '                                         48500000
&ZOPO(&ZOPN)          SETC  'XC'                                        48550000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         48600000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             48650000
.ZIMFLX               ANOP  ,                                           48700000
.*-------------------------------------------------------------------   48705000
.***AI.L04A XVERSION XL1                                                48710000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    48715000
&ZOPN                 SETA  &ZOPN+1                                     48720000
&ZOPL(&ZOPN)          SETC  ' '                                         48725000
&ZOPO(&ZOPN)          SETC  'MVI'                                       48730000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           48735000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     48740000
.ZIMFVW               ANOP  ,                                           48745000
.*-------------------------------------------------------------------   48750000
.***AI.L25  XETOKEN CL8                                                 48800000
                      AIF   ('&ZXETOKEN' EQ '').ZI3E                    48850000
                      AIF   ('&ZXETOKEN' EQ 'OUTPUT').ZI3E              48900000
&ZCGPR                SETC  '&XETOKEN'                                  48950000
.*                                                                      49000000
                      AIF   ('&XETOKEN'(1,1) NE '(').ZI3B               49050000
&ZCGPR   SETC  '0('.'&XETOKEN'(2,K'&XETOKEN-2).')'                      49100000
.ZI3B                 ANOP  ,                                           49200000
.*                                                                      49650000
&ZOPN                 SETA  &ZOPN+1                                     49700000
&ZOPL(&ZOPN)          SETC  ' '                                         49750000
&ZOPO(&ZOPN)          SETC  'MVC'                                       49800000
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             49850000
&ZOPD(&ZOPN)          SETC  '++ &ZXETOKEN XETOKEN'                      49900000
.*                                                                      49950000
.ZI3E                 ANOP  ,                                           50000000
.*-------------------------------------------------------------------   50050000
&ZOPN1                SETA &ZOPN                                        50100000
.*******************************************************************    50150000
.***  PROCESS IWMEDELE OUTPUT PARAMETERS                                50200000
.*******************************************************************    50250000
                      ACTR  10000                                       50300000
.*------------------------------------------------------------------    50314500
.***AO.LVER01                                                           50329000
                      AIF  (&XPLISTVER LT 1).ZO6Z  PLVER                50343500
.*------------------------------------------------------------------    50358000
.***AO.L02 XCPUSERVICE XL8                                              50372500
         AIF   ('&ZXCPUSERVICE' EQ 'OUTPUT').ZO6A  OUTPUT               50387000
         AIF   ('&ZXCPUSERVICE' NE 'INOUT').ZO6C  INOUT                 50401500
.ZO6A    AIF   ('&XCPUSERVICE'(1,1) NE '(').ZO6B  ADDR IN GPR           50416000
&ZCGPR   SETC  '&XCPUSERVICE'(2,K'&XCPUSERVICE-2)                       50430500
&ZOPN                 SETA  &ZOPN+1                                     50445000
&ZOPL(&ZOPN)          SETC  ' '                                         50459500
&ZOPO(&ZOPN)          SETC  'MVC'                                       50474000
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),20(1)'                         50488500
&ZOPD(&ZOPN)          SETC  '++ XCPUSERVICE XL8'                        50503000
                      AGO   .ZO6C                                       50517500
.*                                                                      50532000
.ZO6B                 ANOP  ,                                           50546500
&ZAWRK   SETA  K'&XCPUSERVICE                                           50561000
         AIF   ('&XCPUSERVICE'(&ZAWRK,1) NE ')').ZO6G                   50575500
&ZN      SETA  2                                                        50590000
.ZO6H    ANOP                                                           50604500
         AIF   (&ZN GE &ZAWRK).ZO6G                                     50619000
         AIF   ('&XCPUSERVICE'(&ZN,1) NE '(').ZO6I                      50633500
&ZC      SETC  '&XCPUSERVICE'(1,&ZN).'8'.','                            50648000
&ZC      SETC  '&ZC'.'&XCPUSERVICE'(&ZN+1,&ZAWRK-&ZN).',20(1)'          50662500
         AGO   .ZO6J                                                    50677000
.ZO6I    ANOP                                                           50691500
&ZN      SETA  &ZN+1                                                    50706000
         AGO   .ZO6H                                                    50720500
.ZO6G    ANOP                                                           50735000
&ZC      SETC  '&XCPUSERVICE.(8),20(1)'                                 50749500
.ZO6J    ANOP                                                           50764000
&ZOPN                 SETA  &ZOPN+1                                     50778500
&ZOPL(&ZOPN)          SETC  ' '                                         50793000
&ZOPO(&ZOPN)          SETC  'MVC'                                       50807500
&ZOPV(&ZOPN)          SETC  '&ZC'                                       50822000
&ZOPD(&ZOPN)          SETC  '++ XCPUSERVICE XL8'                        50836500
.ZO6C                 ANOP  ,                                           50851000
.*------------------------------------------------------------------    50865500
.***AO.LVER02                                                           50880000
.ZO6Z                 ANOP  ,                                           50894500
.*------------------------------------------------------------------    50909000
.***AO.LVER01                                                           50923500
                      AIF  (&XPLISTVER LT 1).ZO7Z  PLVER                50938000
.*------------------------------------------------------------------    50952500
.***AO.L02 XCPUTIME XL8                                                 50967000
         AIF   ('&ZXCPUTIME' EQ 'OUTPUT').ZO7A  OUTPUT                  50981500
         AIF   ('&ZXCPUTIME' NE 'INOUT').ZO7C  INOUT                    50996000
.ZO7A    AIF   ('&XCPUTIME'(1,1) NE '(').ZO7B  ADDR IN GPR              51010500
&ZCGPR   SETC  '&XCPUTIME'(2,K'&XCPUTIME-2)                             51025000
&ZOPN                 SETA  &ZOPN+1                                     51039500
&ZOPL(&ZOPN)          SETC  ' '                                         51054000
&ZOPO(&ZOPN)          SETC  'MVC'                                       51068500
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),28(1)'                         51083000
&ZOPD(&ZOPN)          SETC  '++ XCPUTIME XL8'                           51097500
                      AGO   .ZO7C                                       51112000
.*                                                                      51126500
.ZO7B                 ANOP  ,                                           51141000
&ZAWRK   SETA  K'&XCPUTIME                                              51155500
         AIF   ('&XCPUTIME'(&ZAWRK,1) NE ')').ZO7G                      51170000
&ZN      SETA  2                                                        51184500
.ZO7H    ANOP                                                           51199000
         AIF   (&ZN GE &ZAWRK).ZO7G                                     51213500
         AIF   ('&XCPUTIME'(&ZN,1) NE '(').ZO7I                         51228000
&ZC      SETC  '&XCPUTIME'(1,&ZN).'8'.','                               51242500
&ZC      SETC  '&ZC'.'&XCPUTIME'(&ZN+1,&ZAWRK-&ZN).',28(1)'             51257000
         AGO   .ZO7J                                                    51271500
.ZO7I    ANOP                                                           51286000
&ZN      SETA  &ZN+1                                                    51300500
         AGO   .ZO7H                                                    51315000
.ZO7G    ANOP                                                           51329500
&ZC      SETC  '&XCPUTIME.(8),28(1)'                                    51344000
.ZO7J    ANOP                                                           51358500
&ZOPN                 SETA  &ZOPN+1                                     51373000
&ZOPL(&ZOPN)          SETC  ' '                                         51387500
&ZOPO(&ZOPN)          SETC  'MVC'                                       51402000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       51416500
&ZOPD(&ZOPN)          SETC  '++ XCPUTIME XL8'                           51431000
.ZO7C                 ANOP  ,                                           51445500
.*------------------------------------------------------------------    51460000
.***AO.LVER02                                                           51474500
.ZO7Z                 ANOP  ,                                           51489000
.*------------------------------------------------------------------    51503500
.***AO.LVER01                                                           51518000
                      AIF  (&XPLISTVER LT 2).ZO8Z  PLVER                51532500
.*------------------------------------------------------------------    51547000
.***AO.L02 XSYSPLEXCPUSRV XL8                                           51561500
         AIF   ('&ZXSYSPLEXCPUSRV' EQ 'OUTPUT').ZO8A  OUTPUT            51576000
         AIF   ('&ZXSYSPLEXCPUSRV' NE 'INOUT').ZO8C  INOUT              51590500
.ZO8A    AIF   ('&XSYSPLEXCPUSRV'(1,1) NE '(').ZO8B  ADDR IN GPR        51605000
&ZCGPR   SETC  '&XSYSPLEXCPUSRV'(2,K'&XSYSPLEXCPUSRV-2)                 51619500
&ZOPN                 SETA  &ZOPN+1                                     51634000
&ZOPL(&ZOPN)          SETC  ' '                                         51648500
&ZOPO(&ZOPN)          SETC  'MVC'                                       51663000
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),36(1)'                         51677500
&ZOPD(&ZOPN)          SETC  '++ XSYSPLEXCPUSRV XL8'                     51692000
                      AGO   .ZO8C                                       51706500
.*                                                                      51721000
.ZO8B                 ANOP  ,                                           51735500
&ZAWRK   SETA  K'&XSYSPLEXCPUSRV                                        51750000
         AIF   ('&XSYSPLEXCPUSRV'(&ZAWRK,1) NE ')').ZO8G                51764500
&ZN      SETA  2                                                        51779000
.ZO8H    ANOP                                                           51793500
         AIF   (&ZN GE &ZAWRK).ZO8G                                     51808000
         AIF   ('&XSYSPLEXCPUSRV'(&ZN,1) NE '(').ZO8I                   51822500
&ZC      SETC  '&XSYSPLEXCPUSRV'(1,&ZN).'8'.','                         51837000
&ZC      SETC  '&ZC'.'&XSYSPLEXCPUSRV'(&ZN+1,&ZAWRK-&ZN).',36(1)'       51851500
         AGO   .ZO8J                                                    51866000
.ZO8I    ANOP                                                           51880500
&ZN      SETA  &ZN+1                                                    51895000
         AGO   .ZO8H                                                    51909500
.ZO8G    ANOP                                                           51924000
&ZC      SETC  '&XSYSPLEXCPUSRV.(8),36(1)'                              51938500
.ZO8J    ANOP                                                           51953000
&ZOPN                 SETA  &ZOPN+1                                     51967500
&ZOPL(&ZOPN)          SETC  ' '                                         51982000
&ZOPO(&ZOPN)          SETC  'MVC'                                       51996500
&ZOPV(&ZOPN)          SETC  '&ZC'                                       52011000
&ZOPD(&ZOPN)          SETC  '++ XSYSPLEXCPUSRV XL8'                     52025500
.ZO8C                 ANOP  ,                                           52040000
.*------------------------------------------------------------------    52054500
.***AO.LVER02                                                           52069000
.ZO8Z                 ANOP  ,                                           52083500
.*******************************************************************    52100000
.***AO.X02  RETURN CODE PROCESSING                                      52150000
.*******************************************************************    52200000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    52250000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            52300000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             52350000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             52400000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               52450000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                52500000
&ZOPN                 SETA  &ZOPN+1                                     52550000
&ZOPL(&ZOPN)          SETC  ' '                                         52600000
&ZOPO(&ZOPN)          SETC  'ST'                                        52650000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              52700000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        52750000
                      AGO   .ZMRETX                                     52800000
.*                                                                      52850000
.ZMRET2               ANOP  ,                                           52900000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                52950000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                53000000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                53050000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  53100000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   53150000
&ZOPN                 SETA  &ZOPN+1                                     53200000
&ZOPL(&ZOPN)          SETC  ' '                                         53250000
&ZOPO(&ZOPN)          SETC  'LR'                                        53300000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 53350000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        53400000
.ZMRETX               ANOP  ,                                           53450000
.*******************************************************************    53500000
.***AO.X03  REASON CODE PROCESSING                                      53550000
.*******************************************************************    53600000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    53650000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            53700000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              53750000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             53800000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              53850000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             53900000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                53950000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 54000000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                54050000
&ZOPN                 SETA  &ZOPN+1                                     54100000
&ZOPL(&ZOPN)          SETC  ' '                                         54150000
&ZOPO(&ZOPN)          SETC  'ST'                                        54200000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               54250000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        54300000
                      AGO   .ZMRSNX                                     54350000
.*                                                                      54400000
.ZMRSN2               ANOP  ,                                           54450000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                54500000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 54550000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                54600000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 54650000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                54700000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   54750000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    54800000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   54850000
&ZOPN                 SETA  &ZOPN+1                                     54900000
&ZOPL(&ZOPN)          SETC  ' '                                         54950000
&ZOPO(&ZOPN)          SETC  'LR'                                        55000000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  55050000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        55100000
.ZMRSNX               ANOP  ,                                           55150000
.*******************************************************************    55200000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   55250000
.*******************************************************************    55300000
.ZMFLX                ANOP  ,              MF=L PROCESSING              55350000
.*******************************************************************    55400000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               55450000
.*******************************************************************    55500000
                      ACTR  10000                                       55550000
.*                                                                      55600000
                      LCLA  &ZLC           COLUMN POSITION              55650000
                      LCLA  &ZOPX          LIST TABLE INDEX             55700000
                      LCLC  &ZLL           LABEL                        55750000
                      LCLC  &ZLOP          OPERATION                    55800000
                      LCLC  &ZLV           VALUE                        55850000
                      LCLC  &ZLD           DESCRIPTION                  55900000
.*                                                                      55950000
&ZOPX                 SETA  1                                           56000000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            56050000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              56100000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              56150000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              56200000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              56250000
                      AIF   (K'&ZLD LE 0).ZL5                           56300000
&ZLC                  SETA  35             COMMENT COLUMN               56350000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    56400000
&ZLC                  SETA  33             COMMMENT COLUMN              56450000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   56500000
&ZLV                  SETC  '&ZLV'.' '                                  56550000
                      AGO   .ZL3                                        56600000
.*                                                                      56650000
.ZL4                  ANOP  ,                                           56700000
&ZLV                  SETC  '&ZLV'.' '                                  56750000
.ZL5                  ANOP  ,                                           56800000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               56850000
.*                                                                      56900000
&ZLL     &ZLOP &ZLV                                                     56950000
.*                                                                      57000000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               57050000
                      AGO   .ZL2           CONTINUE LOOPING             57100000
.*                                                                      57150000
.ZLX                  ANOP  ,                                           57200000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                57250000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  57300000
         L     14,16(0,0)              GET CVT ADDRESS                  57350000
         L     14,772(14,0)            GET SFT ADDRESS                  57400000
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       57450000
         LA    15,25                   GET EX FOR SERVICE ROUTINE       57500000
         OR    14,15                   GET PC NUMBER                    57550000
         PC    0(14)                                                    57600000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  57750000
.ZLINKX               ANOP  ,                                           57800000
.*******************************************************************    57850000
.***AP.X01  FORMAT GENERATED CODE                                       57900000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            57950000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              58000000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              58050000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              58100000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              58150000
                      AIF   (K'&ZLD LE 0).ZL51                          58200000
&ZLC                  SETA  35             COMMENT COLUMN               58250000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   58300000
&ZLC                  SETA  33             COMMENT COLUMN               58350000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  58400000
&ZLV                  SETC  '&ZLV'.' '                                  58450000
                      AGO   .ZL31                                       58500000
.*                                                                      58550000
.ZL41                 ANOP  ,                                           58600000
&ZLV                  SETC  '&ZLV'.' '                                  58650000
.ZL51                 ANOP  ,                                           58700000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               58750000
.*                                                                      58800000
&ZLL     &ZLOP &ZLV                                                     58850000
.*                                                                      58900000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               58950000
                      AGO   .ZL21          CONTINUE LOOPING             59000000
.*                                                                      59050000
.ZLX1                 ANOP  ,                                           59100000
.*******************************************************************    59150000
.***AP.X02  END OF IWMEDELE MACRO                                       59200000
&ZIWMEDELE            SETC  'YES'          SET IWMEDELE USED            59250000
         POP   PRINT                                                    59300000
*                                            IWMEDELE-2                 59350000
         SPACE 1                                                        59400000
.ZLX2                 ANOP  ,                                           59450000
         MEND                                                           59500000
**********************************************************************/ 59550000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  59600000
*%IWMEDELE: MACRO KEYS(ETOKEN,CPUSERVICE,SYSPLEXCPUSRV,CPUTIME,         59633300
*                 RETCODE,RSNCODE,PLISTVER,MF);                         59666600
*  ANS('?'||MACLABEL||' '||'IWMEDELP '||MACLIST||                       59700000
*         ' '||MACKEYS||';') COL(MACLMAR);                              59750000
*%END IWMEDELE;                                                         59800000
