*        %GOTO FCTLPRO  ;         /* Bilingual header                   00050000
         MACRO                                                          00100000
         BPXYFCTL  &DSECT=YES,&LIST=YES                       8@D1A     00150000
         GBLB  &FCTL411                                                 00200000
         AIF   (&FCTL411 EQ 1).E411                                     00250000
&FCTL411 SETB  1                                                        00300000
         AIF   ('&LIST' EQ 'YES').A411                                  00350000
         PUSH  PRINT  BPXYFCTL: Command values and flags                00400000
         PRINT OFF              specified on FCNTL system call          00450000
         AGO   .A411                                                    00500000
*                                  */                                   00550000
*%FCTLPRO : ;                                                           00600000
*/****START OF SPECIFICATIONS****************************************** 00650000
*                                                                       00700000
*    $MAC (BPXYFCTL) COMP(SCPX1) PROD(BPX):                             00750000
*                                                                       00800000
*01* MACRO NAME: BPXYFCTL                                               00850000
*                                                                       00900000
*01* DSECT NAME: FCTLFDFLAGS                                            00950000
*                                                                       01000000
*01* DESCRIPTIVE NAME: Command values and flags specified               01050000
*                      on FCNTL system call                             01100000
*                                                                       01150000
*02*   ACRONYM: FCTL                                                    01200000
**/                                                                     01250000
*/*01* PROPRIETARY STATEMENT=                                        */ 01300000
*/***PROPRIETARY_STATEMENT********************************************/ 01350000
*/*                                                                  */ 01400000
*/*                                                                  */ 01450000
*/* LICENSED MATERIALS - PROPERTY OF IBM                             */ 01500000
*/* THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      */ 01550000
*/* 5647-A01 (C) COPYRIGHT IBM CORP. 1993,2000                       */ 01600000
*/*                                                                  */ 01700000
*/* STATUS= HBB7703                                                  */ 01750000
*/*                                                                  */ 01800000
*/***END_OF_PROPRIETARY_STATEMENT*************************************/ 01850000
*/*                                                                     01900000
*                                                                       01925000
*01* EXTERNAL CLASSIFICATION:  GUPI                                     01950000
*01* END OF EXTERNAL CLASSIFICATION:                                    02000000
*                                                                       02050000
*01* FUNCTION:                                                          02100000
*                                                                       02150000
*      The FCTL defines the flags and command values for the            02200000
*      FCNTL system call.                                               02250000
*                                                                       02300000
*                                                                       02350000
*01* METHOD OF ACCESS:                                                  02400000
*                                                                       02450000
*02*   PL/X:                                                            02500000
*        %INCLUDE SYSLIB(BPXYFCTL)                                      02550000
*        By default, the FCTLFD is based on FctlFdPtr. If               02600000
*        other basing is desired, use %FCTLFDBASE='BASED(XXXXXX)'.      02650000
*        If %FCTLFDBASE='BASED(FctlFdPtr)' is coded, a Declare for      02700000
*        FctlFdPtr is also generated.                                   02750000
*                                                                       02800000
*02*   ASM:                                                             02850000
*        With DSECT=NO, storage is allocated in line                    02900000
*        and addressability is provided thru that DSECT or CSECT.       02950000
*        With DSECT=YES, a DSECT is produced and "USING FCTL,reg"       03000000
*        is required for addressability.  Here "reg" contains the       03050000
*        address of FCTL#LENGTH bytes of storage.                       03100000
*        The default is DSECT=YES.                                      03150000
*                                                                       03200000
*01* SIZE: FCTL#LENGTH = 4 bytes                                        03250000
*                                                                       03300000
*01* POINTED TO BY: FctlFdPtr                                           03350000
*                                                                       03400000
*01* CREATED BY: Caller of system call                                  03450000
*                                                                       03500000
*01* DELETED BY: Caller of system call                                  03550000
*                                                                       03600000
*01* STORAGE ATTRIBUTES:                                                03650000
*02*   SUBPOOL/DATASPACE:                                               03700000
*02*   KEY:                N/A                                          03750000
*02*   RESIDENCY:          N/A                                          03800000
*                                                                       03850000
*01* FREQUENCY: 1 per call to FCNTL                                     03900000
*                                                                       03950000
*01* SERIALIZATION: N/A                                                 04000000
*                                                                       04050000
*01* DEPENDENCIES: None                                                 04100000
*                                                                       04150000
*01* NOTES: Open flags are mapped by BPXYOPNF                           04200000
*                                                                       04250000
*01* COMPONENT: OpenMVS (SCPX1)                                         04300000
*                                                                       04350000
*01* DISTRIBUTION LIBRARY:  AMACLIB                                     04400000
*                                                                       04450000
*01* EYE-CATCHER: None                                                  04500000
*                                                                       04550000
*01* CHANGE-ACTIVITY:                                                   04600000
*                                                                       04650000
* $L0=POSIXXF, HOM1110, 921201, PDSV: OpenMVS Initial Release           04700000
* $D0=DCR0008, HOM1110, 920811, PDJS: Close range of file descriptors   04750000
* $D1=DL70019, HOM1110, 921201, PDJM: Assembler macro fixup             04800000
* $P2=PL70366, HOM1110, 920908, PDSV: Macro commentary                  04850000
* $P3=PL70597, HOM1110, 930104, PDJM: Use "OpenMVS"                     04900000
* $D2=DPFA065, HOM1130, 940727, PDJV: Universal Unix - Dcr A065.18      04950000
* $D3=DPFA065, HOM1130, 941214, PDJS: Universal Unix - Dcr A065.34      05000000
* $D4=DSYA194, JBB6604, 960912, PDJS: Sparse Tables  A194.03            05050000
****END OF SPECIFICATIONS*********************************************/ 05100000
*        %GOTO FCTLPLS  ;         /* Bilingual header                   05150000
.A411    ANOP  ,                                                        05200000
** BPXYFCTL: File descriptor flags and command values                   05250000
**  Used By: FCT                                                        05300000
         AIF   ('&DSECT' EQ 'NO').B411                        7@D1A     05350000
FCTL                 DSECT ,                                            05400000
         AGO   .C411                                                    05450000
.B411    ANOP  ,                                                        05500000
FCTL                 DS    0F                                           05550000
.C411    ANOP  ,                                                        05600000
*                                 External file descriptor flags        05650000
FCTLFDFL1            DS    B                                            05700000
FCTLRS01             EQU   X'80'  Reserved-DO NOT USE THIS BIT!         05750000
*                                 FCTLFDFLAGS must never be < 0         05800000
FCTLFDFL2            DS    B      Reserved                              05850000
FCTLFDFL3            DS    B      Reserved                              05900000
FCTLFDFL4            DS    B                                            05950000
FCTLCLOFORK          EQU   X'02'  1= close_on_fork                      06000000
FCTLCLOEXEC          EQU   X'01'  1= close_on_exec                      06050000
            SPACE ,                                                     06100000
*                                 Command value definitions             06150000
F_DUPFD              EQU   0      Duplicate file descriptor             06200000
F_GETFD              EQU   1      Get file descriptor flags             06250000
F_SETFD              EQU   2      Set file descriptor flags             06300000
F_GETFL              EQU   3      Set file status flags                 06350000
F_SETFL              EQU   4      Set file status flags                 06400000
F_GETLK              EQU   5      Get record locking information        06450000
F_SETLK              EQU   6      Set record locking information        06500000
F_SETLKW             EQU   7      Set record locking information -      06550000
*                                 wait if blocked                       06600000
F_DUPFD2             EQU   8      Duplicate file descriptor, option 2   06650000
F_CLOSFD             EQU   9      Close file descriptors          @D0A  06700000
F_GETOWN             EQU   10     Get process id or process group @D2A  06750000
F_SETOWN             EQU   11     Set process id or process group @D3A  06800000
FCTL#LENGTH          EQU   *-FCTL Length of this structure              06850000
** BPXYFCTL End                                                         06900000
         SPACE 3                                                        06950000
         AIF   ('&LIST' EQ 'YES').E411                        6@D1A     07000000
         POP   PRINT                                                    07050000
.E411    ANOP  ,                                                        07100000
         MEND                                                           07150000
  Terminating PL/X comment                                          */  07200000
 %FCTLPLS : ;                                                           07250000
 %IF FCTLFDBASE='' %THEN                                                07300000
   %DO;                                                                 07350000
     %FCTLFDBASE='BASED(FctlFdPtr)';                                    07400000
   %END;                                                                07450000
  %IF FCTLFDBASE='BASED(FctlFdPtr)' %THEN                               07500000
    %DO;                                                                07550000
      DCL FctlFdPtr   Ptr(31);        /* Pointer to the FCTL          */07600000
    %END;                                                               07650000
                                 /* External file descriptor flags  */  07700000
 DCL                                                                    07750000
   1  FctlFdFlags Bit(32) FCTLFDBASE,                                   07800000
    7 FctlReserved  Bit(1),      /* Reserved-DO NOT USE THIS BIT!       07850000
                                    FctlFdFlags must never be < 0   */  07900000
    7 *             Bit(29),     /* Reserved                        */  07950000
    7 FctlCloFork   Bit(1),      /* 1= close_on_fork                */  08000000
    7 FctlCloExec   Bit(1);      /* 1= close_on_exec                */  08050000
                                 /* Command value definitions       */  08100000
 /*******************************************************************/  08150000
 /* Values greater than 255 are reserved for C-RTL support.  Do not */  08200000
 /* Create Command value definitions greater than 255!!!            */  08250000
 /*******************************************************************/  08300000
 DCL                                                                    08350000
 F_DUPFD  Fixed(31) Constant(0),  /* Duplicate file descriptor      */  08400000
 F_GETFD  Fixed(31) Constant(1),  /* Get file descriptor flags      */  08450000
 F_SETFD  Fixed(31) Constant(2),  /* Set file descriptor flags      */  08500000
 F_GETFL  Fixed(31) Constant(3),  /* Set file status flags          */  08550000
 F_SETFL  Fixed(31) Constant(4),  /* Set file status flags          */  08600000
 F_GETLK  Fixed(31) Constant(5),  /* Get record locking information */  08650000
 F_SETLK  Fixed(31) Constant(6),  /* Set record locking information */  08700000
 F_SETLKW Fixed(31) Constant(7),  /* Set record locking information -   08750000
                                     wait if blocked                */  08800000
 F_DUPFD2 Fixed(31) Constant(8),  /* Duplicate file descriptor,         08850000
                                     option 2                       */  08900000
 F_CLOSFD Fixed(31) Constant(9),  /* Close file descriptors     @D0A*/  08950000
 F_GETOWN Fixed(31) Constant(10), /* Get PID or GID             @D2A*/  09000000
 F_SETOWN Fixed(31) Constant(11), /* Set PID or GID             @D2A*/  09050000
                                                                        09100000
 /*******************************************************************/  09150000
 /* Working backwards from 255, values reserved for internal use.   */  09200000
 /**************************************************************@D4A*/  09250000
 F_CLOSFD_UNAUTH Fixed(31) Constant(255);  /* Internal use only @D4A*/  09300000
 /*******************************************************************/  09350000
 /* Values greater than 255 are reserved for C-RTL support.  Do not */  09400000
 /* Create Command value definitions greater than 255!!!            */  09450000
 /*******************************************************************/  09500000
