*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  CSRUNIC                                -12/01/99-<> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  Unicode instruction services                  * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00600000
*                                                                     * 00700000
* STATUS= HBB7703                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      CSRUNIC allows you to request processing of a group of         * 01100000
*      instructions related to unicode data.  Unicode data uses the   * 01111100
*      binary code of the Unicode Worldwide Character Standard; these * 01122200
*      codes support the characters of most the world's written       * 01133300
*      languages.  For details about the unicode instructions, see    * 01144400
*      S/390 Principles of Operations.  The CSRUNIC macro invokes the * 01155500
*      requested instructions by name, if the unicode hardware is     * 01166600
*      present.  If the hardware is not present, the macro simulates  * 01177700
*      the requested instructions.                                    * 01188800
*                                                                     * 01200000
*01* EXTERNAL CLASSIFICATION:                                         * 01250000
*                                                                     * 01300000
*02* GUPI: BASE                                                       * 01350000
*                                                                     * 01400000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01450000
*                                                                     * 01500000
*01* ENVIRONMENT:                                                     * 01550000
*                                                                     * 01600000
*                                                                     * 01650000
*      Minimum authorization:                                         * 01700000
*                                                                     * 01750000
*                        The minimum authority for CSRUNIC is problem * 01800000
*                        state and PSW key 8-15.                      * 01850000
*                                                                     * 01900000
*      Dispatchable unit mode: Task or SRB mode.                      * 01950000
*                                                                     * 02000000
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 02050000
*                                                                     * 02100000
*      AMODE:            31-bit.                                      * 02150000
*                                                                     * 02200000
*      ASC mode:         Primary or Access Register.                  * 02250000
*                                                                     * 02300000
*      Interrupt status: Enabled or disabled for I/O and external     * 02350000
*                        interrupts.                                  * 02400000
*                                                                     * 02450000
*      Locks:            The caller is not required to hold any locks * 02500000
*                        on entry.  The caller may hold the local,    * 02550000
*                        CMS, or CPU lock.                            * 02600000
*                                                                     * 02650000
*      Control parameters: None.                                      * 02700000
*                                                                     * 02750000
*                                                                     * 02800000
*                                                                     * 02850000
*01* PROGRAMMING REQUIREMENTS:                                        * 02900000
*                                                                     * 02950000
*    The caller must include the CSRYUNIC macro to get a mapping for  * 03000000
*    the parameter block for the requested function.  The CSRYUNIC    * 03050000
*    macro also includes symbolic equates for the return codes from   * 03100000
*    the service.                                                     * 03150000
*                                                                     * 03200000
*01* RESTRICTIONS:                                                    * 03250000
*                                                                     * 03300000
*    None                                                             * 03350000
*                                                                     * 03400000
*01* INPUT REGISTER INFORMATION:                                      * 03450000
*                                                                     * 03500000
*    Before issuing the CSRUNIC macro, the caller must ensure that    * 03550000
*    the following general purpose registers (GPRs) contain the       * 03600000
*    specified information:                                           * 03650000
*                                                                     * 03700000
*                                                                     * 03750000
*    REGISTER    CONTENTS                                             * 03800000
*                                                                     * 03850000
*    13          Address of standard 72-byte save area. When not in   * 03900000
*                AR-ASC mode, the area must be in the primary address * 03950000
*                space. When in AR-ASC mode, it must be in the space  * 04000000
*                addressed via the ALET in access register 13.        * 04050000
*                                                                     * 04100000
*                                                                     * 04150000
*                                                                     * 04200000
*    Before issuing the CSRUNIC macro in AR-ASC mode, the caller must * 04250000
*    ensure that the following access registers (ARs) contain the     * 04300000
*    specified information:                                           * 04350000
*                                                                     * 04400000
*                                                                     * 04450000
*    REGISTER    CONTENTS                                             * 04500000
*                                                                     * 04550000
*    13          ALET of the 72-byte save area pointed to by GPR 13.  * 04600000
*                                                                     * 04650000
*                                                                     * 04700000
*                                                                     * 04750000
*01* OUTPUT REGISTER INFORMATION:                                     * 04800000
*                                                                     * 04850000
*    When control returns to the caller, the GPRs contain:            * 04900000
*                                                                     * 04950000
*                                                                     * 05000000
*    REGISTER    CONTENTS                                             * 05050000
*                                                                     * 05100000
*    0-1         Used as work registers by the system                 * 05150000
*                                                                     * 05200000
*    2-13        Unchanged                                            * 05250000
*                                                                     * 05300000
*    14          Used as a work register by the system                * 05350000
*                                                                     * 05400000
*    15          Return code                                          * 05450000
*                                                                     * 05500000
*                                                                     * 05550000
*                                                                     * 05600000
*    When control returns to the caller, the ARs contain:             * 05650000
*                                                                     * 05700000
*                                                                     * 05750000
*    REGISTER    CONTENTS                                             * 05800000
*                                                                     * 05850000
*    0-1         Used as work registers by the system                 * 05900000
*                                                                     * 05950000
*    2-13        Unchanged                                            * 06000000
*                                                                     * 06050000
*    14-15       Used as work registers by the system                 * 06100000
*                                                                     * 06150000
*                                                                     * 06200000
*                                                                     * 06250000
*    Some callers depend on register contents remaining the same      * 06300000
*    before and after issuing a service.  If the system changes the   * 06350000
*    contents of registers on which the caller depends, the caller    * 06400000
*    must save them before issuing the service, and restore them      * 06450000
*    after the system returns control.                                * 06500000
*                                                                     * 06550000
*01* PERFORMANCE IMPLICATIONS:                                        * 06600000
*    None.                                                            * 06650000
*                                                                     * 06700000
*01* SYNTAX:                                                          * 06750000
*                                                                     * 06800000
*[xlabel]  CSRUNIC    FUNCTION=MVCLU                                 * 06850000
*                    ,FUNCTION=CLCLU                                 * 06900000
*                    ,FUNCTION=TP                                    * 06950000
*                    ,FUNCTION=PKA                                   * 07000000
*                    ,FUNCTION=PKU                                   * 07050000
*                    ,FUNCTION=UNPKA                                 * 07100000
*                    ,FUNCTION=UNPKU                                 * 07150000
*                    ,FUNCTION=TRTT                                  * 07200000
*                    ,FUNCTION=TRTO                                  * 07250000
*                    ,FUNCTION=TROT                                  * 07300000
*                    ,FUNCTION=TROO                                  * 07350000
*                    ,FUNCTION=TRE                                   * 07400000
*                    ,FUNCTION=CUUTF                                 * 07450000
*                    ,FUNCTION=CUTFU                                 * 07500000
*                     ,PBLOCK=xpblock                                 * 07550000
*                    [,RETCODE=xretcode]                              * 07600000
*                                                                     * 07650000
*                                                                     * 07700000
*      Where:                                                         * 07750000
*                                                                     * 07800000
*                                                                     * 07850000
*      [xlabel]                                                       * 07900000
*          is an optional symbol, starting in column 1, that is the   * 07950000
*          name on the CSRUNIC macro invocation.  The name must       * 08000000
*          conform to the rules for an ordinary assembler language    * 08050000
*          symbol.                                                    * 08100000
*          DEFAULT: No name.                                          * 08150000
*                                                                     * 08200000
*                                                                     * 08250000
*                                                                     * 08300000
*                                                                     * 08350000
*      FUNCTION=MVCLU|CLCLU|TP|PKA|PKU|UNPKA|UNPKU|TRTT|TRTO|TROT|TR * 08400000
*          OO|TRE|CUUTF|CUTFU                                        * 08450000
*          is a required keyword input that designates the function   * 08500000
*          to be performed.                                           * 08550000
*                                                                     * 08600000
*                                                                     * 08650000
*          FUNCTION=MVCLU                                             * 08700000
*              indicates to process an MVCLU operation.               * 08750000
*                                                                     * 08800000
*          FUNCTION=CLCLU                                             * 08850000
*              indicates to process a CLCLU operation.                * 08900000
*                                                                     * 08950000
*          FUNCTION=TP                                                * 09000000
*              indicates to process a TP operation.                   * 09050000
*                                                                     * 09100000
*          FUNCTION=PKA                                               * 09150000
*              indicates to process a PKA operation.                  * 09200000
*                                                                     * 09250000
*          FUNCTION=PKU                                               * 09300000
*              indicates to process a PKU operation.                  * 09350000
*                                                                     * 09400000
*          FUNCTION=UNPKA                                             * 09450000
*              indicates to process an UNPKA operation.               * 09500000
*                                                                     * 09550000
*          FUNCTION=UNPKU                                             * 09600000
*              indicates to process an UNPKU operation.               * 09650000
*                                                                     * 09700000
*          FUNCTION=TRTT                                              * 09750000
*              indicates to process a TRTT operation.                 * 09800000
*                                                                     * 09850000
*          FUNCTION=TRTO                                              * 09900000
*              indicates to process a TRTO operation.                 * 09950000
*                                                                     * 10000000
*          FUNCTION=TROT                                              * 10050000
*              indicates to process a TROT operation.                 * 10100000
*                                                                     * 10150000
*          FUNCTION=TROO                                              * 10200000
*              indicates to process a TROO operation.                 * 10250000
*                                                                     * 10300000
*          FUNCTION=TRE                                               * 10350000
*              indicates to process a TRE operation.                  * 10400000
*                                                                     * 10450000
*          FUNCTION=CUUTF                                             * 10500000
*              indicates to process a CUUTF operation.                * 10550000
*                                                                     * 10600000
*          FUNCTION=CUTFU                                             * 10650000
*              indicates to process a CUTFU operation.                * 10700000
*                                                                     * 10750000
*                                                                     * 10800000
*                                                                     * 10850000
*                                                                     * 10900000
*                                                                     * 10950000
*                                                                     * 11000000
*      PBLOCK=xpblock                                                 * 11050000
*          is the name (RX-type), or address in register (2)-(12), of * 11100000
*          a required 36 character input area that is mapped by       * 11150000
*          DSECTs in macro CSRYUNIC that correlate to the function    * 11200000
*          requested. The area provides the information needed by,    * 11250000
*          and provided on return by, the CSRUNIC service.  It should * 11300000
*          begin on a fullword boundary.                              * 11350000
*                                                                     * 11400000
*          The name of the DSECT is "UNIC_" followed by the requested * 11450000
*          function (e.g., UNIC_MVCLU for the MVCLU function).        * 11500000
*                                                                     * 11550000
*                                                                     * 11600000
*                                                                     * 11650000
*                                                                     * 11700000
*      [RETCODE=xretcode]                                             * 11750000
*          is the name (RS-type) of an optional fullword output       * 11800000
*          variable, or register (2)-(12), into which the return code * 11850000
*          is to be copied from GPR 15.                               * 11900000
*                                                                     * 11950000
*                                                                     * 12000000
*                                                                     * 12050000
*01* ABEND CODES:  None.                                              * 12100000
*                                                                     * 12150000
*                                                                     * 12200000
*       0C4             The user may get this completion code if a    * 12250000
*                       user-provided data area is not accessible.    * 12300000
*                                                                     * 12350000
*       0C6             The user may get this completion code if the  * 12400000
*                       instruction has been executed in the hardware * 12450000
*                       and the provided data does not meet the       * 12500000
*                       requirements for that instruction.            * 12550000
*                                                                     * 12600000
*                                                                     * 12650000
*                       o   For MVCLU, either the source length or    * 12700000
*                           target length was not even.               * 12750000
*                                                                     * 12800000
*                       o   For CLCLU, either the source length or    * 12850000
*                           target length was not even.               * 12900000
*                                                                     * 12950000
*                       o   For PKA, the source length exceeded 31.   * 13000000
*                                                                     * 13050000
*                       o   For PKU, the source length exceeded 64 or * 13100000
*                           was not even (i.e., the LengthMinusOne    * 13150000
*                           was not odd).                             * 13200000
*                                                                     * 13250000
*                       o   For UNPKA, the target length exceeded 31. * 13300000
*                                                                     * 13350000
*                       o   For UNPKU, the target length exceeded 64  * 13400000
*                           or was not even (i.e., the LengthMinusOne * 13450000
*                           was not odd).                             * 13500000
*                                                                     * 13550000
*                       o   For TRTT, the length was not even.        * 13600000
*                                                                     * 13650000
*                       o   For TRTT, the table was not on a page     * 13662500
*                           boundary.                                 * 13675000
*                                                                     * 13687500
*                       o   For TRTO, the length was not even.        * 13700000
*                                                                     * 13705000
*                       o   For TRTO, the table was not on a page     * 13710000
*                           boundary.                                 * 13715000
*                                                                     * 13720000
*                       o   For TROT, the table was not on a          * 13725000
*                           doubleword boundary.                      * 13730000
*                                                                     * 13735000
*                       o   For TROO, the table was not on a          * 13740000
*                           doubleword boundary.                      * 13745000
*                                                                     * 13750000
*                       o   For CUTFU, a bad UTF-8 character was      * 13800000
*                           encountered.                              * 13850000
*                                                                     * 14000000
*                                                                     * 14050000
*                                                                     * 14062500
*                       The user may get this completion code if the  * 14075000
*                       work area was not on a doubleword boundary.   * 14087500
*                                                                     * 14100000
*                                                                     * 14150000
*                                                                     * 14200000
*01* RETURN CODES:                                                    * 14250000
*                                                                     * 14300000
*                                                                     * 14350000
*                 Return code constants are defined in macro          * 14400000
*                 CSRYUNIC.                                           * 14450000
*                                                                     * 14500000
*       0         Name: UNIC_MVCLU_RC_OpLengthsEqual                  * 14550000
*                                                                     * 14600000
*                 Meaning: the operand lengths were the same          * 14650000
*                                                                     * 14700000
*                 Action: None required                               * 14750000
*                                                                     * 14800000
*       4         Name: UNIC_MVCLU_RC_TargetLengthShorter             * 14850000
*                                                                     * 14900000
*                 Meaning: The target operand was shorter than the    * 14950000
*                 source operand                                      * 15000000
*                                                                     * 15050000
*                 Action: None required                               * 15100000
*                                                                     * 15150000
*       8         Name: UNIC_MVCLU_RC_TargetLengthLonger              * 15200000
*                                                                     * 15250000
*                 Meaning: The target operand was longer than the     * 15300000
*                 source operand                                      * 15350000
*                                                                     * 15400000
*                 Action: None required                               * 15450000
*                                                                     * 15500000
*       10        Name: UNIC_MVCLU_RC_TargetLengthNotEven             * 15550000
*                                                                     * 15600000
*                 Meaning: The target operand was not an even number  * 15650000
*                 of bytes                                            * 15700000
*                                                                     * 15750000
*                 Action: Only call CSRUNIC FUNCTION=MVCLU when the   * 15800000
*                 target operand is an even number of bytes (i.e., a  * 15850000
*                 whole number of unicode characters)                 * 15900000
*                                                                     * 15950000
*       14        Name: UNIC_MVCLU_RC_SourceLengthNotEven             * 16000000
*                                                                     * 16050000
*                 Meaning: The source operand was not an even number  * 16100000
*                 of bytes                                            * 16150000
*                                                                     * 16200000
*                 Action: Only call CSRUNIC FUNCTION=MVCLU when the   * 16250000
*                 source operand is an even number of bytes (i.e., a  * 16300000
*                 whole number of unicode characters)                 * 16350000
*                                                                     * 16400000
*       1C        Name: UNIC_MVCLU_RC_WorkareaNotAligned              * 16450000
*                                                                     * 16500000
*                 Meaning: The workarea provided was not on a         * 16550000
*                 doubleword boundary.                                * 16600000
*                                                                     * 16650000
*                 Action: Make sure that the workarea is on a         * 16700000
*                 doubleword boundary.                                * 16750000
*                                                                     * 16800000
*       0         Name: UNIC_CLCLU_RC_OperandsEqual                   * 16850000
*                                                                     * 16900000
*                 Meaning: the two operands were equal                * 16950000
*                                                                     * 17000000
*                 Action: None required                               * 17050000
*                                                                     * 17100000
*       4         Name: UNIC_CLCLU_RC_LeftOpLessThanRight             * 17150000
*                                                                     * 17200000
*                 Meaning: The left operand was less than the right   * 17250000
*                 operand                                             * 17300000
*                                                                     * 17350000
*                 Action: None required                               * 17400000
*                                                                     * 17450000
*       8         Name: UNIC_CLCLU_RC_RightOpLessThanLeft             * 17500000
*                                                                     * 17550000
*                 Meaning: The right operand was less than the left   * 17600000
*                 operand                                             * 17650000
*                                                                     * 17700000
*                 Action: None required                               * 17750000
*                                                                     * 17800000
*       10        Name: UNIC_CLCLU_RC_LeftOpLengthNotEven             * 17850000
*                                                                     * 17900000
*                 Meaning: The left operand was not an even number of * 17950000
*                 bytes                                               * 18000000
*                                                                     * 18050000
*                 Action: Only call CSRUNIC FUNCTION=CLCLU when the   * 18100000
*                 left operand is an even number of bytes (i.e., a    * 18150000
*                 whole number of unicode characters)                 * 18200000
*                                                                     * 18250000
*       14        Name: UNIC_CLCLU_RC_RightOpLengthNotEven            * 18300000
*                                                                     * 18350000
*                 Meaning: The right operand was not an even number   * 18400000
*                 of bytes                                            * 18450000
*                                                                     * 18500000
*                 Action: Only call CSRUNIC FUNCTION=CLCLU when the   * 18550000
*                 right operand is an even number of bytes (i.e., a   * 18600000
*                 whole number of unicode characters)                 * 18650000
*                                                                     * 18700000
*       1C        Name: UNIC_CLCLU_RC_WorkareaNotAligned              * 18750000
*                                                                     * 18800000
*                 Meaning: The workarea provided was not on a         * 18850000
*                 doubleword boundary.                                * 18900000
*                                                                     * 18950000
*                 Action: Make sure that the workarea is on a         * 19000000
*                 doubleword boundary.                                * 19050000
*                                                                     * 19100000
*       0         Name: UNIC_TP_RC_Valid                              * 19150000
*                                                                     * 19200000
*                 Meaning: the operand is a valid packed number       * 19250000
*                                                                     * 19300000
*                 Action: None required                               * 19350000
*                                                                     * 19400000
*       4         Name: UNIC_TP_RC_SignNotValid                       * 19450000
*                                                                     * 19500000
*                 Meaning: The sign of the operand was not valid. All * 19550000
*                 the digits were valid.                              * 19600000
*                                                                     * 19650000
*                 Action: None required                               * 19700000
*                                                                     * 19750000
*       8         Name: UNIC_TP_RC_DigitNotValid                      * 19800000
*                                                                     * 19850000
*                 Meaning: One or more digits of the operand were not * 19900000
*                 valid. The sign was valid.                          * 19950000
*                                                                     * 20000000
*                 Action: None required                               * 20050000
*                                                                     * 20100000
*       0C        Name: UNIC_TP_RC_SignDigitNotValid                  * 20150000
*                                                                     * 20200000
*                 Meaning: The sign and one or more digits of the     * 20250000
*                 operand were not valid.                             * 20300000
*                                                                     * 20350000
*                 Action: None required                               * 20400000
*                                                                     * 20450000
*       1C        Name: UNIC_TP_RC_WorkareaNotAligned                 * 20500000
*                                                                     * 20550000
*                 Meaning: The workarea provided was not on a         * 20600000
*                 doubleword boundary.                                * 20650000
*                                                                     * 20700000
*                 Action: Make sure that the workarea is on a         * 20750000
*                 doubleword boundary.                                * 20800000
*                                                                     * 20850000
*       0         Name: UNIC_PKA_RC_OK                                * 20900000
*                                                                     * 20950000
*                 Meaning: The pack operation completed successfully  * 21000000
*                                                                     * 21050000
*                 Action: None required                               * 21100000
*                                                                     * 21150000
*       14        Name: UNIC_PKA_RC_SourceLengthNotValid              * 21200000
*                                                                     * 21250000
*                 Meaning: The length of the source operand exceeded  * 21300000
*                 32 bytes (i.e., the LengthMinusOne exceeded 31)     * 21350000
*                                                                     * 21400000
*                 Action: Avoid calling CSRUNIC REQUEST=PKA for an    * 21450000
*                 operand longer than 32 bytes                        * 21500000
*                                                                     * 21550000
*       1C        Name: UNIC_PKA_RC_WorkareaNotAligned                * 21600000
*                                                                     * 21650000
*                 Meaning: The workarea provided was not on a         * 21700000
*                 doubleword boundary.                                * 21750000
*                                                                     * 21800000
*                 Action: Make sure that the workarea is on a         * 21850000
*                 doubleword boundary.                                * 21900000
*                                                                     * 21950000
*       0         Name: UNIC_PKU_RC_OK                                * 22000000
*                                                                     * 22050000
*                 Meaning: The pack operation completed successfully  * 22100000
*                                                                     * 22150000
*                 Action: None required                               * 22200000
*                                                                     * 22250000
*       14        Name: UNIC_PKU_RC_SourceLengthNotValid              * 22300000
*                                                                     * 22350000
*                 Meaning: The length of the source operand exceeded  * 22400000
*                 64 bytes (i.e., the LengthMinusOne exceeded 63)     * 22450000
*                                                                     * 22500000
*                 Action: Avoid calling CSRUNIC REQUEST=PKU for an    * 22550000
*                 operand longer than 64 bytes                        * 22600000
*                                                                     * 22650000
*       24        Name: UNIC_PKU_RC_SourceLengthNotEven               * 22700000
*                                                                     * 22750000
*                 Meaning: The source operand was not an even number  * 22800000
*                 of bytes                                            * 22850000
*                                                                     * 22900000
*                 Action: Only call CSRUNIC FUNCTION=PKU when the     * 22950000
*                 source operand is an even number of bytes (i.e., a  * 23000000
*                 whole number of unicode characters)                 * 23050000
*                                                                     * 23100000
*       1C        Name: UNIC_PKU_RC_WorkareaNotAligned                * 23150000
*                                                                     * 23200000
*                 Meaning: The workarea provided was not on a         * 23250000
*                 doubleword boundary.                                * 23300000
*                                                                     * 23350000
*                 Action: Make sure that the workarea is on a         * 23400000
*                 doubleword boundary.                                * 23450000
*                                                                     * 23500000
*       0         Name: UNIC_UNPKA_RC_Positive                        * 23550000
*                                                                     * 23600000
*                 Meaning: The operand represented a positive number  * 23650000
*                                                                     * 23700000
*                 Action: None required                               * 23750000
*                                                                     * 23800000
*       4         Name: UNIC_UNPKA_RC_Negative                        * 23850000
*                                                                     * 23900000
*                 Meaning: The operand represented a negative number  * 23950000
*                                                                     * 24000000
*                 Action: None required                               * 24050000
*                                                                     * 24100000
*       0C        Name: UNIC_UNPKA_RC_BadSign                         * 24150000
*                                                                     * 24200000
*                 Meaning: The operand did not have a valid sign      * 24250000
*                                                                     * 24300000
*                 Action: None required                               * 24350000
*                                                                     * 24400000
*       14        Name: UNIC_UNPKA_RC_TargetLengthNotValid            * 24450000
*                                                                     * 24500000
*                 Meaning: The length of the target operand exceeded  * 24550000
*                 32 bytes (i.e., the LengthMinusOne exceeded 31)     * 24600000
*                                                                     * 24650000
*                 Action: Avoid calling CSRUNIC REQUEST=PKA for an    * 24700000
*                 operand longer than 32 bytes                        * 24750000
*                                                                     * 24800000
*       1C        Name: UNIC_UNPKA_RC_WorkareaNotAligned              * 24850000
*                                                                     * 24900000
*                 Meaning: The workarea provided was not on a         * 24950000
*                 doubleword boundary.                                * 25000000
*                                                                     * 25050000
*                 Action: Make sure that the workarea is on a         * 25100000
*                 doubleword boundary.                                * 25150000
*                                                                     * 25200000
*       0         Name: UNIC_UNPKU_RC_Positive                        * 25250000
*                                                                     * 25300000
*                 Meaning: The operand represented a positive number  * 25350000
*                                                                     * 25400000
*                 Action: None required                               * 25450000
*                                                                     * 25500000
*       4         Name: UNIC_UNPKU_RC_Negative                        * 25550000
*                                                                     * 25600000
*                 Meaning: The operand represented a negative number  * 25650000
*                                                                     * 25700000
*                 Action: None required                               * 25750000
*                                                                     * 25800000
*       0C        Name: UNIC_UNPKU_RC_BadSign                         * 25850000
*                                                                     * 25900000
*                 Meaning: The operand did not have a valid sign      * 25950000
*                                                                     * 26000000
*                 Action: None required                               * 26050000
*                                                                     * 26100000
*       14        Name: UNIC_UNPKU_RC_TargetLengthNotValid            * 26150000
*                                                                     * 26200000
*                 Meaning: The length of the target operand exceeded  * 26250000
*                 64 bytes (i.e., the LengthMinusOne exceeded 63)     * 26300000
*                                                                     * 26350000
*                 Action: Avoid calling CSRUNIC REQUEST=PKU for an    * 26400000
*                 operand longer than 64 bytes                        * 26450000
*                                                                     * 26500000
*       24        Name: UNIC_UNPKU_RC_TargetLengthNotEven             * 26550000
*                                                                     * 26600000
*                 Meaning: The target operand was not an even number  * 26650000
*                 of bytes                                            * 26700000
*                                                                     * 26750000
*                 Action: Only call CSRUNIC FUNCTION=UNPKU when the   * 26800000
*                 target operand is an even number of bytes (i.e., a  * 26850000
*                 whole number of unicode characters)                 * 26900000
*                                                                     * 26950000
*       1C        Name: UNIC_UNPKU_RC_WorkareaNotAligned              * 27000000
*                                                                     * 27050000
*                 Meaning: The workarea provided was not on a         * 27100000
*                 doubleword boundary.                                * 27150000
*                                                                     * 27200000
*                 Action: Make sure that the workarea is on a         * 27250000
*                 doubleword boundary.                                * 27300000
*                                                                     * 27350000
*       0         Name: UNIC_TRTT_RC_TestCharNotFound                 * 27400000
*                                                                     * 27450000
*                 Meaning: The translation completed. The test        * 27500000
*                 character was not found.                            * 27550000
*                                                                     * 27600000
*                 Action: None required                               * 27650000
*                                                                     * 27700000
*       4         Name: UNIC_TRTT_RC_TestCharFound                    * 27750000
*                                                                     * 27800000
*                 Meaning: The test character was found. The          * 27850000
*                 operation ended at that point.                      * 27900000
*                                                                     * 27950000
*                 Action: None required                               * 28000000
*                                                                     * 28050000
*       10        Name: UNIC_TRTT_RC_LengthNotEven                    * 28100000
*                                                                     * 28150000
*                 Meaning: The operand was not an even number of      * 28200000
*                 bytes                                               * 28250000
*                                                                     * 28300000
*                 Action: Only call CSRUNIC FUNCTION=TRTT when the    * 28350000
*                 operand is an even number of bytes (i.e., a whole   * 28400000
*                 number of unicode characters)                       * 28450000
*                                                                     * 28500000
*       1C        Name: UNIC_TRTT_RC_WorkareaNotAligned               * 28550000
*                                                                     * 28600000
*                 Meaning: The workarea provided was not on a         * 28650000
*                 doubleword boundary.                                * 28700000
*                                                                     * 28750000
*                 Action: Make sure that the workarea is on a         * 28800000
*                 doubleword boundary.                                * 28850000
*                                                                     * 28900000
*       20        Name: UNIC_TRTT_RC_TableNotAligned                  * 28905500
*                                                                     * 28911000
*                 Meaning: The table provided was not on a page       * 28916500
*                 boundary.                                           * 28922000
*                                                                     * 28927500
*                 Action: Make sure that the table is on a page       * 28933000
*                 boundary.                                           * 28938500
*                                                                     * 28944000
*       0         Name: UNIC_TRTO_RC_TestCharNotFound                 * 28950000
*                                                                     * 29000000
*                 Meaning: The translation completed. The test        * 29050000
*                 character was not found.                            * 29100000
*                                                                     * 29150000
*                 Action: None required                               * 29200000
*                                                                     * 29250000
*       4         Name: UNIC_TRTO_RC_TestCharFound                    * 29300000
*                                                                     * 29350000
*                 Meaning: The test character was found. The          * 29400000
*                 operation ended at that point.                      * 29450000
*                                                                     * 29500000
*                 Action: None required                               * 29550000
*                                                                     * 29600000
*       10        Name: UNIC_TRTO_RC_LengthNotEven                    * 29650000
*                                                                     * 29700000
*                 Meaning: The operand was not an even number of      * 29750000
*                 bytes                                               * 29800000
*                                                                     * 29850000
*                 Action: Only call CSRUNIC FUNCTION=TRTO when the    * 29900000
*                 operand is an even number of bytes (i.e., a whole   * 29950000
*                 number of unicode characters)                       * 30000000
*                                                                     * 30050000
*       1C        Name: UNIC_TRTO_RC_WorkareaNotAligned               * 30100000
*                                                                     * 30150000
*                 Meaning: The workarea provided was not on a         * 30200000
*                 doubleword boundary.                                * 30250000
*                                                                     * 30300000
*                 Action: Make sure that the workarea is on a         * 30350000
*                 doubleword boundary.                                * 30400000
*                                                                     * 30450000
*       20        Name: UNIC_TRTO_RC_TableNotAligned                  * 30455500
*                                                                     * 30461000
*                 Meaning: The table provided was not on a page       * 30466500
*                 boundary.                                           * 30472000
*                                                                     * 30477500
*                 Action: Make sure that the table is on a page       * 30483000
*                 boundary.                                           * 30488500
*                                                                     * 30494000
*       0         Name: UNIC_TROT_RC_TestCharNotFound                 * 30500000
*                                                                     * 30550000
*                 Meaning: The translation completed. The test        * 30600000
*                 character was not found.                            * 30650000
*                                                                     * 30700000
*                 Action: None required                               * 30750000
*                                                                     * 30800000
*       4         Name: UNIC_TROT_RC_TestCharFound                    * 30850000
*                                                                     * 30900000
*                 Meaning: The test character was found. The          * 30950000
*                 operation ended at that point.                      * 31000000
*                                                                     * 31050000
*                 Action: None required                               * 31100000
*                                                                     * 31150000
*       1C        Name: UNIC_TROT_RC_WorkareaNotAligned               * 31200000
*                                                                     * 31250000
*                 Meaning: The workarea provided was not on a         * 31300000
*                 doubleword boundary.                                * 31350000
*                                                                     * 31400000
*                 Action: Make sure that the workarea is on a         * 31450000
*                 doubleword boundary.                                * 31500000
*                                                                     * 31505500
*       20        Name: UNIC_TROT_RC_TableNotAligned                  * 31511000
*                                                                     * 31516500
*                 Meaning: The table provided was not on a doubleword * 31522000
*                 boundary.                                           * 31527500
*                                                                     * 31533000
*                 Action: Make sure that the table is on a doubleword * 31538500
*                 boundary.                                           * 31544000
*                                                                     * 31550000
*       0         Name: UNIC_TROO_RC_TestCharNotFound                 * 31600000
*                                                                     * 31650000
*                 Meaning: The translation completed. The test        * 31700000
*                 character was not found.                            * 31750000
*                                                                     * 31800000
*                 Action: None required                               * 31850000
*                                                                     * 31900000
*       4         Name: UNIC_TROO_RC_TestCharFound                    * 31950000
*                                                                     * 32000000
*                 Meaning: The test character was found. The          * 32050000
*                 operation ended at that point.                      * 32100000
*                                                                     * 32150000
*                 Action: None required                               * 32200000
*                                                                     * 32250000
*       1C        Name: UNIC_TROO_RC_WorkareaNotAligned               * 32300000
*                                                                     * 32350000
*                 Meaning: The workarea provided was not on a         * 32400000
*                 doubleword boundary.                                * 32450000
*                                                                     * 32500000
*                 Action: Make sure that the workarea is on a         * 32550000
*                 doubleword boundary.                                * 32600000
*                                                                     * 32605500
*       20        Name: UNIC_TROO_RC_TableNotAligned                  * 32611000
*                                                                     * 32616500
*                 Meaning: The table provided was not on a doubleword * 32622000
*                 boundary.                                           * 32627500
*                                                                     * 32633000
*                 Action: Make sure that the table is on a doubleword * 32638500
*                 boundary.                                           * 32644000
*                                                                     * 32650000
*       0         Name: UNIC_TRE_RC_TestCharNotFound                  * 32700000
*                                                                     * 32750000
*                 Meaning: The translation completed. The test        * 32800000
*                 character was not found.                            * 32850000
*                                                                     * 32900000
*                 Action: None required                               * 32950000
*                                                                     * 33000000
*       4         Name: UNIC_TRE_RC_TestCharFound                     * 33050000
*                                                                     * 33100000
*                 Meaning: The test character was found. The          * 33150000
*                 operation ended at that point.                      * 33200000
*                                                                     * 33250000
*                 Action: None required                               * 33300000
*                                                                     * 33350000
*       1C        Name: UNIC_TRE_RC_WorkareaNotAligned                * 33400000
*                                                                     * 33450000
*                 Meaning: The workarea provided was not on a         * 33500000
*                 doubleword boundary.                                * 33550000
*                                                                     * 33600000
*                 Action: Make sure that the workarea is on a         * 33650000
*                 doubleword boundary.                                * 33700000
*                                                                     * 33750000
*       0         Name: UNIC_CUUTF_RC_SourceExhausted                 * 33800000
*                                                                     * 33850000
*                 Meaning: All unicode characters in the source were  * 33900000
*                 converted to their UTF-8 equivalents.               * 33950000
*                                                                     * 34000000
*                 Action: None required                               * 34050000
*                                                                     * 34100000
*       4         Name: UNIC_CUUTF_RC_TargetExhausted                 * 34150000
*                                                                     * 34200000
*                 Meaning: The target operand did not have enough     * 34250000
*                 room to hold the UTF-8 equivalents of all of the    * 34300000
*                 source unicode characters.                          * 34350000
*                                                                     * 34400000
*                 Action: Provide a larger target area.               * 34450000
*                                                                     * 34500000
*       1C        Name: UNIC_CUUTF_RC_WorkareaNotAligned              * 34550000
*                                                                     * 34600000
*                 Meaning: The workarea provided was not on a         * 34650000
*                 doubleword boundary.                                * 34700000
*                                                                     * 34750000
*                 Action: Make sure that the workarea is on a         * 34800000
*                 doubleword boundary.                                * 34850000
*                                                                     * 34900000
*       0         Name: UNIC_CUTFU_RC_SourceExhausted                 * 34950000
*                                                                     * 35000000
*                 Meaning: All UTF-8 characters in the source were    * 35050000
*                 converted to their unicode equivalents.             * 35100000
*                                                                     * 35150000
*                 Action: None required                               * 35200000
*                                                                     * 35250000
*       4         Name: UNIC_CUTFU_RC_TargetExhausted                 * 35300000
*                                                                     * 35350000
*                 Meaning: The target operand did not have enough     * 35400000
*                 room to hold the unicode equivalents of all of the  * 35450000
*                 source UTF-8 characters.                            * 35500000
*                                                                     * 35550000
*                 Action: Provide a larger target area.               * 35600000
*                                                                     * 35650000
*       8         Name: UNIC_CUTFU_RC_BadUtf8Char                     * 35700000
*                                                                     * 35750000
*                 Meaning: A character in the source operand was not  * 35800000
*                 a valid UTF-8 character.                            * 35850000
*                                                                     * 35900000
*                 Action: Make sure that the source operand contains  * 35950000
*                 only valid UTF-8 characters.                        * 36000000
*                                                                     * 36050000
*       1C        Name: UNIC_CUTFU_RC_WorkareaNotAligned              * 36100000
*                                                                     * 36150000
*                 Meaning: The workarea provided was not on a         * 36200000
*                 doubleword boundary.                                * 36250000
*                                                                     * 36300000
*                 Action: Make sure that the workarea is on a         * 36350000
*                 doubleword boundary.                                * 36400000
*                                                                     * 36450000
*                                                                     * 36500000
*                                                                     * 36550000
*01* REASON CODES:  None.                                             * 36600000
*                                                                     * 36650000
*01* MODULE TYPE:  ASSEM MACRO                                        * 36700000
*                                                                     * 36750000
*02*   PROCESSOR:  ASSEM                                              * 36800000
*                                                                     * 36850000
*01* COMPONENT:  SCCSR                                                * 36900000
*                                                                     * 36950000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 37000000
*                                                                     * 37050000
*01* EXAMPLES:                                                        * 37100000
*                                                                     * 37150000
*    Example 1                                                        * 37200000
*                                                                     * 37250000
*    Operation:                                                       * 37300000
*                                                                     * 37350000
*    Execute a MVCLU operation.                                       * 37400000
*                                                                     * 37450000
*    The code is as follows.                                          * 37500000
*                                                                     * 37550000
*            LA    2,MYPBLOCK               Get address of parm       * 37600000
*            USING UNIC_MVCLU,2                                       * 37650000
*            XC    UNIC_MVCLU(UNIC_MVCLU_LEN),UNIC_MVCLU Clear block  * 37700000
*      *                                       Also includes ALETs    * 37750000
*            MVC   UNIC_MVCLU_TARGETADDR,TARGADDR Set target area     * 37800000
*            MVC   UNIC_MVCLU_TARGETLEN,TARGLEN   Set target length   * 37850000
*            MVC   UNIC_MVCLU_SOURCEADDR,SOURCEADDR Set source area   * 37900000
*            MVC   UNIC_MVCLU_SOURCELEN,SOURCELEN   Set source length * 37950000
*            MVC   UNIC_MVCLU_PAD,PADCHAR         Set pad char        * 38000000
*            LA    3,WORKAREA                                         * 38050000
*            ST    3,UNIC_MVCLU_WORKAREAADDR Set workarea address     * 38100000
*            CSRUNIC  FUNCTION=MVCLU,PBLOCK=UNIC_MVCLU                * 38150000
*            DROP  2                                                  * 38200000
*       .                                                             * 38250000
*       .                                                             * 38300000
*               DS    0F        Align parameter on word boundary      * 38350000
*      MYPBLOCK DS    (UNIC_MVCLU_LEN)CL1 PBLOCK parameter            * 38400000
*      TARGADDR DS    A         Output target area                    * 38450000
*      TARGLEN  DS    F         Length of target area                 * 38500000
*      SOURCEADDR DS  A         Input source area                     * 38550000
*      SOURCELEN DS   F         Length of source area                 * 38600000
*      PADCHAR  DC    XL2'4040' Pad with X'4040'                      * 38650000
*               DS    0D        Doubleword align workarea             * 38700000
*      WORKAREA DS    CL512     Work area                             * 38750000
*                                                                     * 38800000
*                                                                     * 38850000
*01* MACRO USAGE NOTES:                                               * 38900000
*                                                                     * 38950000
*                                                                     * 39000000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 39050000
*        global macro variable.  Any value other than 'NO' will       * 39100000
*        result in the macro expansion being printed.  The default is * 39150000
*        'YES'.  The following examples illustrate how the ZPRINT     * 39200000
*        variable should be set.                                      * 39250000
*                                                                     * 39300000
*                    GBLC &ZPRINT                                     * 39350000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 39400000
*                                                                     * 39450000
*                                                                     * 39500000
*                                                                     * 39550000
*01* CHANGE ACTIVITY:                                                 * 39600000
*                                                                     * 39650000
*   Flag LineItem  FMID    Date   ID    Comment                       * 39700000
*                                                                     * 39750000
*    $L0=CICSOAMG HBB7703 980825 PD00XB:  UNICODE                     * 39800000
*    $L1=CICSOCSR HBB7703 980825 PD00XB:  UNICODE                     * 39850000
****** END OF SPECIFICATIONS *****************************************/ 39900000
*/* TLINE 1 *********************************************************** 39950000
         MACRO                                                          40000000
&XLABEL  CSRUNIC &FUNCTION=,&PBLOCK=,&RETCODE=                          40050000
.*                                                                      40100000
*              MACDATE -12/01/99-<0>                                    40150000
.*                                                                      40200000
.*******************************************************************    40250000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        40300000
.*******************************************************************    40350000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   40400000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     40450000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             40500000
.*                                                                      40550000
              GBLC  &ZCSRUNIC   YES=MACRO USED AT LEAST ONCE            40600000
.*******************************************************************    40650000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          40700000
.*******************************************************************    40750000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 40800000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            40850000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              40900000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             40950000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             41000000
              LCLA  &ZAWRK      USED AS A WORK AREA                     41050000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  41100000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   41150000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 41200000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             41250000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 41300000
              LCLA  &ZMACRET    MACRO RETURN CODE                       41350000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        41400000
.*                                                                      41450000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      41500000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              41550000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   41600000
              LCLC  &ZENDBASEPL                 End of base PL          41650000
.********************************************************************   41700000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 41750000
.********************************************************************   41800000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 41850000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          41900000
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        41950000
.*                                                                      42000000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       42050000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        42100000
              SPLEVEL  TEST                                             42150000
.ZSYS2        ANOP  ,                                                   42200000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              42250000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              42300000
              SYSSTATE TEST                                             42350000
              AGO   .ZSYS4                                              42400000
.ZSYS3        ANOP  ,                                                   42450000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 42500000
.ZSYS4        ANOP  ,                                                   42550000
.*******************************************************************    42600000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   42650000
.*******************************************************************    42700000
              LCLC  &XFUNCTION  ++ VALUE                                42750000
              LCLC  &XPBLOCK    ++ NAME                                 42800000
              LCLC  &XRETCODE   ++ NAME                                 42850000
.*******************************************************************    42900000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           42950000
.*******************************************************************    43000000
              LCLC  &ZXFUNCTION                 ++ INPUT VALUE          43050000
              LCLC  &ZXPBLOCK   ++ INPUT NAME                           43100000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          43150000
.********************************************************************   43200000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 43250000
.********************************************************************   43300000
              ACTR  10000                                               43350000
.*------------------------------------------------------------------    43400000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           43450000
&XFUNCTION    SETC  ''          INITIALIZE XVARIABLE                    43500000
.*-------------------------------------------------------------------   43550000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           43600000
.ZG3          ANOP  ,                                                   43650000
              AIF   (K'&FUNCTION(1) LE 0).ZG3A                          43700000
&ZTLC         SETC 'MVCLU'                                              43750000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG4                     43800000
&XFUNCTION    SETC  'MVCLU'     SET KEYWORD                             43850000
              AIF   (N'&FUNCTION LE 1).ZG3A     CK NUM                  43900000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           43950000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   44000000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   44050000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 44100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44150000
.ZG3A         ANOP  ,                                                   44200000
.*-------------------------------------------------------------------   44250000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           44300000
.ZG4          ANOP  ,                                                   44350000
&ZTLC         SETC 'CLCLU'                                              44400000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG5                     44450000
&XFUNCTION    SETC  'CLCLU'     SET KEYWORD                             44500000
              AIF   (N'&FUNCTION LE 1).ZG4A     CK NUM                  44550000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           44600000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   44650000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   44700000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 44750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44800000
.ZG4A         ANOP  ,                                                   44850000
.*-------------------------------------------------------------------   44900000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           44950000
.ZG5          ANOP  ,                                                   45000000
&ZTLC         SETC 'TP'                                                 45050000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG6                     45100000
&XFUNCTION    SETC  'TP'        SET KEYWORD                             45150000
              AIF   (N'&FUNCTION LE 1).ZG5A     CK NUM                  45200000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           45250000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   45300000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   45350000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 45400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45450000
.ZG5A         ANOP  ,                                                   45500000
.*-------------------------------------------------------------------   45550000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           45600000
.ZG6          ANOP  ,                                                   45650000
&ZTLC         SETC 'PKA'                                                45700000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG7                     45750000
&XFUNCTION    SETC  'PKA'       SET KEYWORD                             45800000
              AIF   (N'&FUNCTION LE 1).ZG6A     CK NUM                  45850000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           45900000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   45950000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   46000000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 46050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46100000
.ZG6A         ANOP  ,                                                   46150000
.*-------------------------------------------------------------------   46200000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           46250000
.ZG7          ANOP  ,                                                   46300000
&ZTLC         SETC 'PKU'                                                46350000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG8                     46400000
&XFUNCTION    SETC  'PKU'       SET KEYWORD                             46450000
              AIF   (N'&FUNCTION LE 1).ZG7A     CK NUM                  46500000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           46550000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   46600000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   46650000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 46700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46750000
.ZG7A         ANOP  ,                                                   46800000
.*-------------------------------------------------------------------   46850000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           46900000
.ZG8          ANOP  ,                                                   46950000
&ZTLC         SETC 'UNPKA'                                              47000000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG9                     47050000
&XFUNCTION    SETC  'UNPKA'     SET KEYWORD                             47100000
              AIF   (N'&FUNCTION LE 1).ZG8A     CK NUM                  47150000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           47200000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   47250000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   47300000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 47350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47400000
.ZG8A         ANOP  ,                                                   47450000
.*-------------------------------------------------------------------   47500000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           47550000
.ZG9          ANOP  ,                                                   47600000
&ZTLC         SETC 'UNPKU'                                              47650000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG10                    47700000
&XFUNCTION    SETC  'UNPKU'     SET KEYWORD                             47750000
              AIF   (N'&FUNCTION LE 1).ZG9A     CK NUM                  47800000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           47850000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   47900000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   47950000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 48000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             48050000
.ZG9A         ANOP  ,                                                   48100000
.*-------------------------------------------------------------------   48150000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           48200000
.ZG10         ANOP  ,                                                   48250000
&ZTLC         SETC 'TRTT'                                               48300000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG11                    48350000
&XFUNCTION    SETC  'TRTT'      SET KEYWORD                             48400000
              AIF   (N'&FUNCTION LE 1).ZG10A    CK NUM                  48450000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           48500000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   48550000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   48600000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 48650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             48700000
.ZG10A        ANOP  ,                                                   48750000
.*-------------------------------------------------------------------   48800000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           48850000
.ZG11         ANOP  ,                                                   48900000
&ZTLC         SETC 'TRTO'                                               48950000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG12                    49000000
&XFUNCTION    SETC  'TRTO'      SET KEYWORD                             49050000
              AIF   (N'&FUNCTION LE 1).ZG11A    CK NUM                  49100000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           49150000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   49200000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   49250000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 49300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49350000
.ZG11A        ANOP  ,                                                   49400000
.*-------------------------------------------------------------------   49450000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           49500000
.ZG12         ANOP  ,                                                   49550000
&ZTLC         SETC 'TROT'                                               49600000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG13                    49650000
&XFUNCTION    SETC  'TROT'      SET KEYWORD                             49700000
              AIF   (N'&FUNCTION LE 1).ZG12A    CK NUM                  49750000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           49800000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   49850000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   49900000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 49950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50000000
.ZG12A        ANOP  ,                                                   50050000
.*-------------------------------------------------------------------   50100000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           50150000
.ZG13         ANOP  ,                                                   50200000
&ZTLC         SETC 'TROO'                                               50250000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG14                    50300000
&XFUNCTION    SETC  'TROO'      SET KEYWORD                             50350000
              AIF   (N'&FUNCTION LE 1).ZG13A    CK NUM                  50400000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           50450000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   50500000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   50550000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 50600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50650000
.ZG13A        ANOP  ,                                                   50700000
.*-------------------------------------------------------------------   50750000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           50800000
.ZG14         ANOP  ,                                                   50850000
&ZTLC         SETC 'TRE'                                                50900000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG15                    50950000
&XFUNCTION    SETC  'TRE'       SET KEYWORD                             51000000
              AIF   (N'&FUNCTION LE 1).ZG14A    CK NUM                  51050000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           51100000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   51150000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   51200000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 51250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51300000
.ZG14A        ANOP  ,                                                   51350000
.*-------------------------------------------------------------------   51400000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           51450000
.ZG15         ANOP  ,                                                   51500000
&ZTLC         SETC 'CUUTF'                                              51550000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG16                    51600000
&XFUNCTION    SETC  'CUUTF'     SET KEYWORD                             51650000
              AIF   (N'&FUNCTION LE 1).ZG15A    CK NUM                  51700000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           51750000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   51800000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   51850000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 51900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51950000
.ZG15A        ANOP  ,                                                   52000000
.*-------------------------------------------------------------------   52050000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           52100000
.ZG16         ANOP  ,                                                   52150000
&ZTLC         SETC 'CUTFU'                                              52200000
              AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG17                    52250000
&XFUNCTION    SETC  'CUTFU'     SET KEYWORD                             52300000
              AIF   (N'&FUNCTION LE 1).ZG16A    CK NUM                  52350000
&ZMS          SETC  '"FUNCTION='                *KPOSA* MNOTE           52400000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   52450000
&ZMS          SETC  '&ZMS "FUNCTION"'                                   52500000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 52550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             52600000
.ZG16A        ANOP  ,                                                   52650000
.*------------------------------------------------------------------    52700000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           52750000
.ZG17         ANOP  ,                                                   52800000
&ZXFUNCTION   SETC  'INPUT'     SET IN/OUTPUT                           52850000
              AIF   (K'&XFUNCTION GT 0).ZG17E   VALID ARG               52900000
              AIF   (T'&FUNCTION EQ 'O').ZG17D  OMITTED                 52950000
&ZASYSLNDX    SETA  0                                                   53000000
.ZG17A        ANOP  ,           POSITIONAL MACRO KEY                    53050000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        53100000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C                    53150000
&ZTLC         SETC 'FUNCTION'                                           53200000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A           53250000
.ZG17B        ANOP  ,                                                   53300000
&ZXFUNCTION   SETC  ''          RESET IN/OUTPUT                         53350000
&ZMS          SETC  'THE "FUNCTION" KEY'        *KOPTA* MNOTE           53400000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             53450000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    53500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             53550000
              AGO   .ZG17E                                              53600000
.ZG17C        ANOP  ,                                                   53650000
&ZXFUNCTION   SETC  ''          RESET IN/OUTPUT                         53700000
&ZMS          SETC  '"FUNCTION='                *KUKWA* MNOTE           53750000
&ZMS          SETC  '&ZMS.&FUNCTION"'                                   53800000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           53850000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 53900000
&ZMS          SETC  '&ZMS "MVCLU",'                                     53950000
&ZMS          SETC  '&ZMS "CLCLU",'                                     54000000
&ZMS          SETC  '&ZMS "TP",'                                        54050000
&ZMS          SETC  '&ZMS "PKA",'                                       54100000
&ZMS          SETC  '&ZMS "PKU",'                                       54150000
&ZMS          SETC  '&ZMS "UNPKA",'                                     54200000
&ZMS          SETC  '&ZMS "UNPKU",'                                     54250000
&ZMS          SETC  '&ZMS "TRTT",'                                      54300000
&ZMS          SETC  '&ZMS "TRTO",'                                      54350000
&ZMS          SETC  '&ZMS "TROT",'                                      54400000
&ZMS          SETC  '&ZMS "TROO",'                                      54450000
&ZMS          SETC  '&ZMS "TRE",'                                       54500000
&ZMS          SETC  '&ZMS "CUUTF",'                                     54550000
&ZMS          SETC  '&ZMS OR "CUTFU".'                                  54600000
              MNOTE 8,' &ZMS '                                          54650000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             54700000
              AGO   .ZG17E                                              54750000
.ZG17D        ANOP  ,                                                   54800000
&XFUNCTION    SETC  'MVCLU'     SET DEFAULT KEYWORD                     54850000
.ZG17E        ANOP  ,                                                   54900000
.*------------------------------------------------------------------    54950000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           55000000
              AIF   (K'&FUNCTION(1) GT 0).ZG17F  PARM                   55050000
&XFUNCTION    SETC  ''          ENSURE NULL KEYWORD                     55100000
&ZXFUNCTION   SETC  ''          RESET IN/OUTPUT                         55150000
&ZMS          SETC  'THE'                                               55200000
&ZMS          SETC  '&ZMS "FUNCTION" KEY AND ITS'                       55250000
&ZMS          SETC  '&ZMS ARGUMENT ARE REQUIRED.'                       55300000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 55350000
&ZMS          SETC  '&ZMS "MVCLU",'                                     55400000
&ZMS          SETC  '&ZMS "CLCLU",'                                     55450000
&ZMS          SETC  '&ZMS "TP",'                                        55500000
&ZMS          SETC  '&ZMS "PKA",'                                       55550000
&ZMS          SETC  '&ZMS "PKU",'                                       55600000
&ZMS          SETC  '&ZMS "UNPKA",'                                     55650000
&ZMS          SETC  '&ZMS "UNPKU",'                                     55700000
&ZMS          SETC  '&ZMS "TRTT",'                                      55750000
&ZMS          SETC  '&ZMS "TRTO",'                                      55800000
&ZMS          SETC  '&ZMS "TROT",'                                      55850000
&ZMS          SETC  '&ZMS "TROO",'                                      55900000
&ZMS          SETC  '&ZMS "TRE",'                                       55950000
&ZMS          SETC  '&ZMS "CUUTF",'                                     56000000
&ZMS          SETC  '&ZMS OR "CUTFU".'                                  56050000
              MNOTE 8,' &ZMS '                                          56100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56150000
.ZG17F        ANOP  ,                                                   56200000
.*----------------------------------------------------------------***   56250000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     56300000
              AIF   (N'&PBLOCK LE 1).ZG19A      CK NUM                  56350000
&ZMS          SETC  '"PBLOCK='  *KPOSA* MNOTE                           56400000
&ZMS          SETC  '&ZMS.&PBLOCK"'                                     56450000
&ZMS          SETC  '&ZMS "PBLOCK"'                                     56500000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 56550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56600000
.ZG19A        ANOP  ,                                                   56650000
.*-------------------------------------------------------------------   56700000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         56750000
&ZXPBLOCK     SETC  'INPUT'     SET IN/OUTPUT                           56800000
&XPBLOCK      SETC  '&PBLOCK(1)'                SET XVARIABLE           56850000
              AIF   (N'&PBLOCK GT 1).ZG19B      MULTI PARMS             56900000
&XPBLOCK      SETC  '&PBLOCK'   SET XVARIABLE                           56950000
.ZG19B        AIF   (K'&PBLOCK(1) GT 0).ZG19C                           57000000
&ZXPBLOCK     SETC  ''          RESET IN/OUTPUT                         57050000
&ZMS          SETC  ' '         *KRQDA*                                 57100000
&ZMS          SETC  '&ZMS "PBLOCK" KEY AND ITS'                         57150000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    57200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             57250000
.ZG19C        ANOP  ,                                                   57300000
.*-------------------------------------------------------------------   57350000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    57400000
              AIF   (K'&ZXPBLOCK LE 0).ZG19R    NOT I/O                 57450000
              AIF   ('&XPBLOCK'(1,1) NE '(').ZG19R                      57500000
&ZCGPR        SETC  '&XPBLOCK'(2,K'&XPBLOCK-2)                          57550000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        57600000
              AIF   (K'&ZCGPR GT 2).ZG19Q                               57650000
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             57700000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       57750000
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        57800000
.ZG19P        ANOP  ,                                                   57850000
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             57900000
              AIF   ('&ZCGPR' LT '2').ZG19Q                             57950000
              AIF   ('&ZCGPR' LE '12').ZG19R                            58000000
.ZG19Q        ANOP  ,                                                   58050000
&ZMS          SETC  '"PBLOCK='  *KGPRA* MNOTE                           58100000
&ZMS          SETC  '&ZMS.&PBLOCK"'                                     58150000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           58200000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    58250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             58300000
.ZG19R        ANOP  ,                                                   58350000
.*----------------------------------------------------------------***   58400000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    58450000
              AIF   (N'&RETCODE LE 1).ZG22A     CK NUM                  58500000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           58550000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    58600000
&ZMS          SETC  '&ZMS "RETCODE"'                                    58650000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 58700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             58750000
.ZG22A        ANOP  ,                                                   58800000
.*-------------------------------------------------------------------   58850000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        58900000
              AIF   (K'&RETCODE(1) LE 0).ZG22C  NO PARM                 58950000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              59000000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           59050000
              AIF   (N'&RETCODE GT 1).ZG22C                             59100000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           59150000
.ZG22C        ANOP  ,                                                   59200000
.*-------------------------------------------------------------------   59250000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   59300000
              AIF   (K'&ZXRETCODE LE 0).ZG22R   NOT I/O                 59350000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG22R                     59400000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        59450000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                        59500000
              AIF   (K'&ZCGPR GT 2).ZG22Q                               59550000
              AIF   ('&ZCGPR' EQ '0').ZG22Q                             59600000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       59650000
              AIF   (T'&ZCGPR NE 'N').ZG22Q     INVALID REG NAME        59700000
.ZG22P        ANOP  ,                                                   59750000
              AIF   (T'&ZCGPR NE 'N').ZG22R     NON NUMERIC             59800000
              AIF   ('&ZCGPR' LT '2').ZG22Q                             59850000
              AIF   ('&ZCGPR' LE '12').ZG22R                            59900000
.ZG22Q        ANOP  ,                                                   59950000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           60000000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    60050000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           60100000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    60150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             60200000
.ZG22R        ANOP  ,                                                   60250000
.******************************************************************     60300000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        60350000
.******************************************************************     60400000
              ACTR  10000                                               60450000
.*----------------------------------------------------------------***   60500000
.***AH.P02 EXTRA POSITIONALS                                            60550000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               60600000
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                60650000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            60700000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             60750000
.ZGLISTX1     ANOP  ,                                                   60800000
&ZCVAL        SETC  ''          ERROR FIELD                             60850000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       60900000
.ZGLIST2      ANOP  ,                                                   60950000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         61000000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                61050000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   61100000
              AGO   .ZGLIST2                                            61150000
.*                                                                      61200000
.ZGLIST3      ANOP  ,                                                   61250000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             61300000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           61350000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     61400000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              61450000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      61500000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              61550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61600000
.ZGLISTX      ANOP  ,                                                   61650000
&ZASYSLNDX    SETA  0                                                   61700000
.*******************************************************************    61750000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       61800000
.*******************************************************************    61850000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          61900000
.*******************************************************************    61950000
.***AE.01  START OF CSRUNIC MACRO CODE                                  62000000
.*******************************************************************    62050000
              LCLC  &M0M0001                 NAME                       62100000
&M0M0001      SETC  '&XLABEL'                SET NAME                   62150000
              AIF   (K'&XLABEL NE 0).XLAB2                              62200000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               62250000
.*                                                                      62300000
.XLAB2        ANOP  ,                                                   62350000
&M0M0001 DS    0H                             CSRUNIC-0                 62400000
.*******************************************************************    62450000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              62500000
.*******************************************************************    62550000
              PUSH  PRINT                                               62600000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          62650000
              PRINT OFF         ++ PR01                                 62700000
              AGO   .ZPRNTXX                                            62750000
.ZPRINTX      PRINT ON                                                  62800000
.ZPRNTXX      ANOP  ,                                                   62850000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  62900000
           LCLA  &OFF                                                   62950000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  63000000
.********************************************************************   63050000
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    63100000
.********************************************************************   63150000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       63200000
                      LCLA  &ZOPN1         INVOCATION INDEX             63250000
                      LCLC  &ZOPL(4095)    LABEL                        63300000
                      LCLC  &ZOPO(4095)    OPERATION                    63350000
                      LCLC  &ZOPV(4095)    VALUE                        63400000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  63450000
.*                                                                      63500000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     63550000
.*-------------------------------------------------------------------   63600000
&ZOPN1                SETA &ZOPN                                        63650000
.*******************************************************************    63700000
.***AO.X02  RETURN CODE PROCESSING                                      63750000
.*******************************************************************    63800000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    63850000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            63900000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             63950000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             64000000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               64050000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                64100000
&ZOPN                 SETA  &ZOPN+1                                     64150000
&ZOPL(&ZOPN)          SETC  ' '                                         64200000
&ZOPO(&ZOPN)          SETC  'ST'                                        64250000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              64300000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        64350000
                      AGO   .ZMRETX                                     64400000
.*                                                                      64450000
.ZMRET2               ANOP  ,                                           64500000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                64550000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                64600000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                64650000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  64700000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   64750000
&ZOPN                 SETA  &ZOPN+1                                     64800000
&ZOPL(&ZOPN)          SETC  ' '                                         64850000
&ZOPO(&ZOPN)          SETC  'LR'                                        64900000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 64950000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        65000000
.ZMRETX               ANOP  ,                                           65050000
.*******************************************************************    65100000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               65150000
.*******************************************************************    65200000
                      ACTR  10000                                       65250000
.*                                                                      65300000
                      LCLA  &ZLC           COLUMN POSITION              65350000
                      LCLA  &ZOPX          LIST TABLE INDEX             65400000
                      LCLC  &ZLL           LABEL                        65450000
                      LCLC  &ZLOP          OPERATION                    65500000
                      LCLC  &ZLV           VALUE                        65550000
                      LCLC  &ZLD           DESCRIPTION                  65600000
.*                                                                      65650000
&ZOPX                 SETA  1                                           65700000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            65750000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              65800000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              65850000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              65900000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              65950000
                      AIF   (K'&ZLD LE 0).ZL5                           66000000
&ZLC                  SETA  35             COMMENT COLUMN               66050000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    66100000
&ZLC                  SETA  33             COMMMENT COLUMN              66150000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   66200000
&ZLV                  SETC  '&ZLV'.' '                                  66250000
                      AGO   .ZL3                                        66300000
.*                                                                      66350000
.ZL4                  ANOP  ,                                           66400000
&ZLV                  SETC  '&ZLV'.' '                                  66450000
.ZL5                  ANOP  ,                                           66500000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               66550000
.*                                                                      66600000
&ZLL     &ZLOP &ZLV                                                     66650000
.*                                                                      66700000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               66750000
                      AGO   .ZL2           CONTINUE LOOPING             66800000
.*                                                                      66850000
.ZLX                  ANOP  ,                                           66900000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  66950000
           AIF   ('&XFUNCTION' NE 'MVCLU').TRYCLCLU                @L1A 67000000
&OFF       SETA  0                                                 @L1A 67050000
           AGO   .HAVEFUNCTION                                     @L1A 67100000
.TRYCLCLU  ANOP                                                    @L1A 67150000
           AIF   ('&XFUNCTION' NE 'CLCLU').TRYTP                   @L1A 67200000
&OFF       SETA  4                                                 @L1A 67250000
           AGO   .HAVEFUNCTION                                     @L1A 67300000
.TRYTP     ANOP                                                    @L1A 67350000
           AIF   ('&XFUNCTION' NE 'TP').TRYPKA                     @L1A 67400000
&OFF       SETA  8                                                 @L1A 67450000
           AGO   .HAVEFUNCTION                                     @L1A 67500000
.TRYPKA    ANOP                                                    @L1A 67550000
           AIF   ('&XFUNCTION' NE 'PKA').TRYPKU                    @L1A 67600000
&OFF       SETA  12                                                @L1A 67650000
           AGO   .HAVEFUNCTION                                     @L1A 67700000
.TRYPKU    ANOP                                                    @L1A 67750000
           AIF   ('&XFUNCTION' NE 'PKU').TRYUNPKA                  @L1A 67800000
&OFF       SETA  16                                                @L1A 67850000
           AGO   .HAVEFUNCTION                                     @L1A 67900000
.TRYUNPKA  ANOP                                                    @L1A 67950000
           AIF   ('&XFUNCTION' NE 'UNPKA').TRYUNPKU                @L1A 68000000
&OFF       SETA  20                                                @L1A 68050000
           AGO   .HAVEFUNCTION                                     @L1A 68100000
.TRYUNPKU  ANOP                                                    @L1A 68150000
           AIF   ('&XFUNCTION' NE 'UNPKU').TRYTRTT                 @L1A 68200000
&OFF       SETA  24                                                @L1A 68250000
           AGO   .HAVEFUNCTION                                     @L1A 68300000
.TRYTRTT   ANOP                                                    @L1A 68350000
           AIF   ('&XFUNCTION' NE 'TRTT').TRYTRTO                  @L1A 68400000
&OFF       SETA  28                                                @L1A 68450000
           AGO   .HAVEFUNCTION                                     @L1A 68500000
.TRYTRTO   ANOP                                                    @L1A 68550000
           AIF   ('&XFUNCTION' NE 'TRTO').TRYTROT                  @L1A 68600000
&OFF       SETA  32                                                @L1A 68650000
           AGO   .HAVEFUNCTION                                     @L1A 68700000
.TRYTROT   ANOP                                                    @L1A 68750000
           AIF   ('&XFUNCTION' NE 'TROT').TRYTROO                  @L1A 68800000
&OFF       SETA  36                                                @L1A 68850000
           AGO   .HAVEFUNCTION                                     @L1A 68900000
.TRYTROO   ANOP                                                    @L1A 68950000
           AIF   ('&XFUNCTION' NE 'TROO').TRYTRE                   @L1A 69000000
&OFF       SETA  40                                                @L1A 69050000
           AGO   .HAVEFUNCTION                                     @L1A 69100000
.TRYTRE    ANOP                                                    @L1A 69150000
           AIF   ('&XFUNCTION' NE 'TRE').TRYCUUTF                  @L1A 69200000
&OFF       SETA  44                                                @L1A 69250000
           AGO   .HAVEFUNCTION                                     @L1A 69300000
.TRYCUUTF  ANOP                                                    @L1A 69350000
           AIF   ('&XFUNCTION' NE 'CUUTF').TRYCUTFU                @L1A 69400000
&OFF       SETA  48                                                @L1A 69450000
           AGO   .HAVEFUNCTION                                     @L1A 69500000
.TRYCUTFU  ANOP                                                    @L1A 69550000
&OFF       SETA  52                                                @L1A 69600000
           AGO   .HAVEFUNCTION                                     @L1A 69650000
.HAVEFUNCTION ANOP                                                 @L1A 69700000
           AIF   ('&PBLOCK'(1,1) EQ '(').INREG                     @L1A 69750000
           LAE   1,&PBLOCK(1)        Get parameter address/ALET    @L1A 69800000
           AGO   .DONE                                             @L1A 69850000
.INREG  ANOP                                                       @L1A 69900000
           AIF ('&PBLOCK(1)' EQ '1').DONE                          @L1A 69950000
           LAE   1,0(0,&PBLOCK(1))   Get parameter address/ALET    @L1A 70000000
.DONE   ANOP                                                       @L1A 70050000
           L     15,16(0,0)         Get CVT address                @L1A 70100000
           L     15,544(15,0)       Get CSRTABLE                   @L1A 70150000
           L     15,52(15,0)        Get address of service table   @L1A 70200000
           L     15,&OFF.(15,0)     Get address of service         @L1A 70250000
           BASR  14,15              Call service                   @L1A 70300000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  70350000
.*******************************************************************    70400000
.***AP.X01  FORMAT GENERATED CODE                                       70450000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            70500000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              70550000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              70600000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              70650000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              70700000
                      AIF   (K'&ZLD LE 0).ZL51                          70750000
&ZLC                  SETA  35             COMMENT COLUMN               70800000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   70850000
&ZLC                  SETA  33             COMMENT COLUMN               70900000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  70950000
&ZLV                  SETC  '&ZLV'.' '                                  71000000
                      AGO   .ZL31                                       71050000
.*                                                                      71100000
.ZL41                 ANOP  ,                                           71150000
&ZLV                  SETC  '&ZLV'.' '                                  71200000
.ZL51                 ANOP  ,                                           71250000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               71300000
.*                                                                      71350000
&ZLL     &ZLOP &ZLV                                                     71400000
.*                                                                      71450000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               71500000
                      AGO   .ZL21          CONTINUE LOOPING             71550000
.*                                                                      71600000
.ZLX1                 ANOP  ,                                           71650000
.*******************************************************************    71700000
.***AP.X02  END OF CSRUNIC MACRO                                        71750000
&ZCSRUNIC             SETC  'YES'          SET CSRUNIC USED             71800000
         POP   PRINT                                                    71850000
*                                            CSRUNIC-0                  71900000
         SPACE 1                                                        71950000
.ZLX2                 ANOP  ,                                           72000000
         MEND                                                           72050000
**********************************************************************/ 72100000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  72150000
*%CSRUNIC: MACRO KEYS(FUNCTION,PBLOCK,RETCODE);                         72200000
*  ANS('?'||MACLABEL||' '||'CSRUNICP '||MACLIST||                       72250000
*         ' '||MACKEYS||';') COL(MACLMAR);                              72300000
*%END CSRUNIC;                                                          72350000
