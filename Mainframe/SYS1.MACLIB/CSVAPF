*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  CSVAPF                                -08/25/93-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  APF Services                                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5695-047 (C) COPYRIGHT IBM CORP. 1992                           * 00001300
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00001400
*                                                                     * 00001500
* STATUS= HBB4430                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*                                                                     * 00001900
*01* FUNCTION:                                                        * 00002000
*                                                                     * 00002100
*                                                                     * 00002200
*      CSVAPF provides an interface to request services against the   * 00002300
*      APF List.                                                      * 00002400
*                                                                     * 00002500
*      The following services are provided:                           * 00002600
*                                                                     * 00002700
*                                                                     * 00002800
*      QUERY    Determine if a particular dataset is in the list.     * 00002900
*                                                                     * 00003000
*      QUERYFORMAT Determine the current format (dynamic or static)   * 00003100
*               of the list.                                          * 00003200
*                                                                     * 00003300
*      ADD      Add an entry to the dynamic list.                     * 00003400
*                                                                     * 00003500
*      DELETE   Remove an entry from the dynamic list.                * 00003600
*                                                                     * 00003700
*      LIST     Return information about all of the entries in the    * 00003800
*               list.                                                 * 00003900
*                                                                     * 00004000
*      DYNFORMAT Change to use the dynamically formatted list.        * 00004100
*               Subsequently, the ADD and DELETE functions can be     * 00004200
*               used.                                                 * 00004300
*                                                                     * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*      INPUT REGISTERS:                                               * 00004900
*                                                                     * 00005000
*                                                                     * 00005100
*                          GR0-GR1     reserved                       * 00005200
*                                                                     * 00005300
*                          GR2-GR12    undefined                      * 00005400
*                                                                     * 00005500
*                          GR13        Address of standard 72-byte    * 00005600
*                                      save area for QUERY.           * 00005700
*                                                                     * 00005800
*                          GR14-GR15   reserved                       * 00005900
*                                                                     * 00006000
*                          AR0-AR1     reserved                       * 00006100
*                                                                     * 00006200
*                          AR2-AR13    undefined                      * 00006300
*                                                                     * 00006400
*                          AR14-AR15   reserved                       * 00006500
*                                                                     * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*      OUTPUT ENVIRONMENT: Same as on entry                           * 00006900
*                                                                     * 00007000
*      OUTPUT REGISTERS:                                              * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*                          GR0         reason code based on GR15 or 0 * 00007400
*                                                                     * 00007500
*                          GR1         Not intended interface         * 00007600
*                                                                     * 00007700
*                          GR2-GR13    unchanged                      * 00007800
*                                                                     * 00007900
*                          GR14        Not intended interface         * 00008000
*                                                                     * 00008100
*                          GR15        return code                    * 00008200
*                                                                     * 00008300
*                          AR0-AR1     Not intended interface         * 00008400
*                                                                     * 00008500
*                          AR2-AR13    unchanged                      * 00008600
*                                                                     * 00008700
*                          AR14-AR15   Not intended interface         * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*01* ENVIRONMENT:                                                     * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*      Dispatchable unit mode: Task or SRB mode.                      * 00009700
*                                                                     * 00009800
*                        The ADD, DELETE, and DYNFORMAT functions     * 00009900
*                        require task mode.                           * 00010000
*                                                                     * 00010100
*      Minimum authorization:                                         * 00010200
*                                                                     * 00010300
*                        The ADD, DELETE, and DYNFORMAT functions     * 00010400
*                        require SAF authority to the FACILITY class. * 00010500
*                        If SAF is not available, then the caller     * 00010600
*                        must be supervisor state or key 0-7.  For    * 00010700
*                        ADD and DELETE, the entity name used to do   * 00010800
*                        the RACHECK is "CSVAPF.dsname".  For         * 00010900
*                        DYNFORMAT, the entity name used to do the    * 00011000
*                        RACHECK is                                   * 00011100
*                        "CSVAPF.MVS.SETPROG.FORMAT.DYNAMIC".         * 00011200
*                                                                     * 00011300
*                        The QUERY, QUERYFORMAT and LIST functions    * 00011400
*                        allow any state.                             * 00011500
*                                                                     * 00011600
*      AMODE:            24- or 31-bit.                               * 00011700
*                                                                     * 00011800
*                        Invokers of CSVAPF QUERY must be in 31-bit   * 00011900
*                        AMODE as linkage is via branch. For the      * 00012000
*                        other services, linkage is via stacking PC.  * 00012100
*                        All addresses are assumed to be clean 31-bit * 00012200
*                        addresses, even for 24-bit mode callers.     * 00012300
*                                                                     * 00012400
*                        Invokers of CSVAPF QUERYFORMAT must be in    * 00012500
*                        31-bit AMODE, as the control structures      * 00012600
*                        referenced reside above 16M.                 * 00012700
*                                                                     * 00012800
*      ASC mode:         Primary or Access Register.                  * 00012900
*                                                                     * 00013000
*                        The QUERY, QUERYFORMAT, and LIST functions   * 00013100
*                        allow any primary, secondary, and home       * 00013200
*                        address spaces.                              * 00013300
*                                                                     * 00013400
*                        The ADD, DELETE, and DYNFORMAT functions     * 00013500
*                        require p=h=s.                               * 00013600
*                                                                     * 00013700
*      Serialization:                                                 * 00013800
*                                                                     * 00013900
*                        The caller must be enabled, but may be       * 00014000
*                        locked and have FRRs for the QUERY,          * 00014100
*                        QUERYFORMAT, and LIST functions.             * 00014200
*                                                                     * 00014300
*      Restrictions:     None.                                        * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*01* SYNTAX:                                                          * 00014800
*                                                                     * 00014900
*[xlabel]  CSVAPF    REQUEST=QUERY                                   * 00015000
*                  |     ,DSNAME=xdsname                              * 00015100
*                  |   [,VOLTYPE=SMS]                                * 00015200
*                  |   [,VOLTYPE=ANY                                 * 00015300
*                  |         ,VOLUME=xvolume]                         * 00015400
*                  |   [,TEST=NO]                                    * 00015500
*                  |   [,TEST=YES]                                   * 00015600
*                   ,REQUEST=QUERYFORMAT                             * 00015700
*                  |     ,FORMAT=xformat                              * 00015800
*                   ,REQUEST=ADD                                     * 00015900
*                  |     ,DSNAME=xdsname                              * 00016000
*                  |   [,VOLTYPE=SMS]                                * 00016100
*                  |   [,VOLTYPE=ANY                                 * 00016200
*                  |         ,VOLUME=xvolume]                         * 00016300
*                   ,REQUEST=DELETE                                  * 00016400
*                  |     ,DSNAME=xdsname                              * 00016500
*                  |   [,VOLTYPE=SMS]                                * 00016600
*                  |   [,VOLTYPE=ANY                                 * 00016700
*                  |         ,VOLUME=xvolume]                         * 00016800
*                   ,REQUEST=DYNFORMAT                               * 00016900
*                   ,REQUEST=LIST                                    * 00017000
*                        ,ANSAREA=xansarea                            * 00017100
*                        ,ANSLEN=xanslen                              * 00017200
*                   [,RETCODE=xretcode]                               * 00017300
*                   [,RSNCODE=xrsncode]                               * 00017400
*                  [,MF=S]                                           * 00017500
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 00017600
*                  [,MF=(E,xmfctrl,COMPLETE)]                      * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*      Where:                                                         * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      [xlabel]                                                       * 00018300
*          is an optional symbol, starting in column 1, that is the   * 00018400
*          name on the CSVAPF macro invocation.  The name must        * 00018500
*          conform to the rules for an ordinary assembler language    * 00018600
*          symbol.                                                    * 00018700
*          DEFAULT: No name.                                          * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*      REQUEST=QUERY|QUERYFORMAT|ADD|DELETE|DYNFORMAT|LIST          * 00019300
*          is a required keyword input that indicates the type of     * 00019400
*          request.                                                   * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*          REQUEST=QUERY                                              * 00019800
*              indicates to query if a particular dataset is in the   * 00019900
*              APF list.                                              * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*              DSNAME=xdsname                                         * 00020300
*                  is the name (RS-type), or address in register      * 00020400
*                  (2)-(12), of a required 44 character input         * 00020500
*                  containing the name of the subject dataset.        * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*              [VOLTYPE=SMS|ANY]                                    * 00021100
*                  is an optional keyword input that indicates the    * 00021200
*                  status of the volume associated with this dataset. * 00021300
*                  DEFAULT: SMS                                       * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                  [VOLTYPE=SMS]                                      * 00021700
*                      indicates that the dataset is SMS-managed and  * 00021800
*                      that no volume is ever to be associated with   * 00021900
*                      the dataset.                                   * 00022000
*                                                                     * 00022100
*                  [VOLTYPE=ANY                                       * 00022200
*                      indicates that the dataset may or may not be   * 00022300
*                      SMS-managed and that the accompanying volume   * 00022400
*                      is to be used.                                 * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                      VOLUME=xvolume]                                * 00022800
*                          is the name (RS-type), or address in       * 00022900
*                          register (2)-(12), of a required 6         * 00023000
*                          character input containing the name of the * 00023100
*                          volume on which the dataset resides.  The  * 00023200
*                          special volume indications of "******" for * 00023300
*                          the SYSRES volume and "*MCAT*" for the     * 00023400
*                          volume containing the master catalog are   * 00023500
*                          not supported for QUERY.                   * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*              [TEST=NO|YES]                                        * 00024500
*                  is an optional keyword input that indicates        * 00024600
*                  whether or not to see if the QUERY routine has     * 00024700
*                  been set up yet.                                   * 00024800
*                  DEFAULT: NO                                        * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*                  [TEST=NO]                                          * 00025200
*                      that indicates not to do this test. Once past  * 00025300
*                      the point of the creation of the second        * 00025400
*                      address space in the system, it is not         * 00025500
*                      necessary to perform this test. The QUERY      * 00025600
*                      routine will have been defined.                * 00025700
*                                                                     * 00025800
*                  [TEST=YES]                                         * 00025900
*                      that indicates to do the test. If the routine  * 00026000
*                      has not been set up, then the QUERY request    * 00026100
*                      returns with an indication of "Not in the      * 00026200
*                      list".                                         * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*          REQUEST=QUERYFORMAT                                        * 00026900
*              indicates to return the current state (static or       * 00027000
*              dynamic) of the APF list. The system assumes that the  * 00027100
*              APF list has already been initialized. The RETCODE,    * 00027200
*              RSNCODE, and MF keys may not be specified.             * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*              FORMAT=xformat                                         * 00027600
*                  is the name (RS-type), or address in register      * 00027700
*                  (2)-(12), of a required byte output that will      * 00027800
*                  contain the current state of the APF list.  If 0,  * 00027900
*                  the list is static. If 1, the list is dynamic -    * 00028000
*                  additions and deletions are allowed.               * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*          REQUEST=ADD                                                * 00028500
*              indicates to add an entry to the dynamic APF list.     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*              DSNAME=xdsname                                         * 00028900
*                  is the name (RS-type), or address in register      * 00029000
*                  (2)-(12), of a required 44 character input         * 00029100
*                  containing the name of the dataset to be added.    * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*              [VOLTYPE=SMS|ANY]                                    * 00029700
*                  is an optional keyword input that indicates the    * 00029800
*                  status of the volume associated with this dataset. * 00029900
*                  DEFAULT: SMS                                       * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                  [VOLTYPE=SMS]                                      * 00030300
*                      indicates that the dataset is SMS-managed and  * 00030400
*                      that no volume is ever to be associated with   * 00030500
*                      the dataset.                                   * 00030600
*                                                                     * 00030700
*                  [VOLTYPE=ANY                                       * 00030800
*                      indicates that the dataset may or may not be   * 00030900
*                      SMS-managed and that the accompanying volume   * 00031000
*                      is to be used.                                 * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                      VOLUME=xvolume]                                * 00031400
*                          is the name (RS-type), or address in       * 00031500
*                          register (2)-(12), of a required 6         * 00031600
*                          character input containing the name of the * 00031700
*                          volume on which the dataset resides.  If   * 00031800
*                          the specified volume is "******", the      * 00031900
*                          SYSRES volume is used.  If the specified   * 00032000
*                          volume is "*MCAT*", the volume containing  * 00032100
*                          the master catalog is used.  If the        * 00032200
*                          specified volume contains all 0s then the  * 00032300
*                          dataset is assumed to be SMS-managed.      * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*          REQUEST=DELETE                                             * 00033200
*              indicates to remove an entry from the dynamic APF      * 00033300
*              list.                                                  * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*              DSNAME=xdsname                                         * 00033700
*                  is the name (RS-type), or address in register      * 00033800
*                  (2)-(12), of a required 44 character input         * 00033900
*                  containing the name of the dataset to be deleted.  * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*              [VOLTYPE=SMS|ANY]                                    * 00034500
*                  is an optional keyword input that indicates the    * 00034600
*                  status of the volume associated with this dataset. * 00034700
*                  DEFAULT: SMS                                       * 00034800
*                                                                     * 00034900
*                                                                     * 00035000
*                  [VOLTYPE=SMS]                                      * 00035100
*                      indicates that the dataset is SMS-managed and  * 00035200
*                      that no volume is ever to be associated with   * 00035300
*                      the dataset.                                   * 00035400
*                                                                     * 00035500
*                  [VOLTYPE=ANY                                       * 00035600
*                      indicates that the dataset may or may not be   * 00035700
*                      SMS-managed and that the accompanying volume   * 00035800
*                      is to be used.                                 * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                      VOLUME=xvolume]                                * 00036200
*                          is the name (RS-type), or address in       * 00036300
*                          register (2)-(12), of a required 6         * 00036400
*                          character input containing the name of the * 00036500
*                          volume on which the dataset resides.  If   * 00036600
*                          the specified volume is "******", then the * 00036700
*                          SYSRES volume is used.  If the specified   * 00036800
*                          volume is "*MCAT*", the volume containing  * 00036900
*                          the master catalog is used.  If the        * 00037000
*                          specified volume contains all 0s then the  * 00037100
*                          dataset is assumed to be SMS-managed.      * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*          REQUEST=DYNFORMAT                                          * 00038000
*              requests a transition from the static table format to  * 00038100
*              the dynamically formatted list.                        * 00038200
*                                                                     * 00038300
*          REQUEST=LIST                                               * 00038400
*              requests to return information about all of the        * 00038500
*              entries in the list. The list is mapped by macro       * 00038600
*              CSVAPFAA and consists of a header (APFHDR) followed by * 00038700
*              one or more entries (APFE).                            * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*              ANSAREA=xansarea                                       * 00039100
*                  is the name (RS-type), or address in register      * 00039200
*                  (2)-(12), of a required character output that      * 00039300
*                  indicates the area into which the output is to be  * 00039400
*                  placed.  This area is mapped by macro CSVAPFAA.    * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*              ANSLEN=xanslen                                         * 00040000
*                  is the name (RS-type), or address in register      * 00040100
*                  (2)-(12), of a required fullword input that        * 00040200
*                  indicates the length of the answer area provided.  * 00040300
*                  The length must be at least as long as the length  * 00040400
*                  of the APFHDR structure contained in mapping macro * 00040500
*                  CSVAPFAA.                                          * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*      [RETCODE=xretcode]                                             * 00041500
*          is the name (RS-type) of an optional fullword output       * 00041600
*          variable, or register (2)-(12), into which the return code * 00041700
*          is to be copied from GPR 15.                               * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*      [RSNCODE=xrsncode]                                             * 00042300
*          is the name (RS-type) of an optional fullword output       * 00042400
*          variable, or register (2)-(12), into which the reason code * 00042500
*          is to be copied from GPR 0.                                * 00042600
*                                                                     * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*      [MF=S|L|E]                                                   * 00043100
*          is an optional keyword input which specifies the macro     * 00043200
*          form.                                                      * 00043300
*          DEFAULT: S                                                 * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*          [MF=S]                                                     * 00043700
*              specifies the standard form of the macro.  The "S"     * 00043800
*              form generates code to put the parameters into an      * 00043900
*              in-line parameter list and invoke the desired service. * 00044000
*              Full checking for required macro keys is done along    * 00044100
*              with supplying defaults for omitted optional           * 00044200
*              parameters.                                            * 00044300
*                                                                     * 00044400
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00044500
*              specifies the list form of the macro.  The "L" form    * 00044600
*              defines an area to be used for the parameter list.     * 00044700
*              Any other macro parameters are flagged as errors.      * 00044800
*                                                                     * 00044900
*            ,xmfctrl                                                 * 00045000
*              is a required input.  It is the name of a storage area * 00045100
*              for the parameter list.                                * 00045200
*                                                                     * 00045300
*            ,xmfattr|0D                                            * 00045400
*              is an optional 60 character input string that varies   * 00045500
*              from 1 to 60 characters. It can contain any value that * 00045600
*              is valid on an assembler DS pseudo-op. You can use     * 00045700
*              this parameter to force boundary alignment of the      * 00045800
*              parameter list.                                        * 00045900
*              DEFAULT: 0D which forces the parameter list to a       * 00046000
*              doubleword boundary.                                   * 00046100
*                                                                     * 00046200
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00046300
*              specifies the execute form of the macro.  The "E" form * 00046400
*              generates code to put the parameters into the          * 00046500
*              parameter list specified by xmfctrl and provides full  * 00046600
*              syntax checking with default setting.                  * 00046700
*                                                                     * 00046800
*            ,xmfctrl                                                 * 00046900
*              is a required input.  It is the name (RS-type), or     * 00047000
*              address in register (1)-(12), of a storage area for    * 00047100
*              the parameter list.                                    * 00047200
*                                                                     * 00047300
*            ,COMPLETE                                              * 00047400
*              is an optional keyword input which specifies the       * 00047500
*              degree of macro parameter syntax checking.             * 00047600
*              DEFAULT: COMPLETE                                      * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*              COMPLETE   Checking for required macro keys is done    * 00048000
*                        and defaults are supplied for omitted        * 00048100
*                        optional parameters.                         * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*01* RETURN CODES:                                                    * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*                 Equates for the return and reason codes are defined * 00049300
*                 by macro CSVAPFAA.                                  * 00049400
*                                                                     * 00049500
*       0         CSVAPF request successful.                          * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*                 QUERY     Dataset found in APF list                 * 00049900
*                                                                     * 00050000
*                 ADD       Dataset added to the APF list             * 00050100
*                                                                     * 00050200
*                 DELETE    Dataset deleted from the APF list         * 00050300
*                                                                     * 00050400
*                 LIST      All data returned                         * 00050500
*                                                                     * 00050600
*                 DYNFORMAT Dynamically formatted APF list is now     * 00050700
*                           being used                                * 00050800
*                                                                     * 00050900
*                                                                     * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*       4         Warning                                             * 00051300
*                                                                     * 00051400
*                 HEX REASON   MEANING                                * 00051500
*                 CODE                                                * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*                 xxxx0401    Dataset is in the list. For Query, the  * 00051900
*                             dataset is marked "SMS-managed". For    * 00052000
*                             ADD, the dataset already exists in the  * 00052100
*                             list.                                   * 00052200
*                                                                     * 00052300
*                 xxxx0402    Dataset is not in the list.  For Query  * 00052400
*                             the data set is not authorized.  For    * 00052500
*                             Delete, the requested operation was not * 00052600
*                             performed.                              * 00052700
*                                                                     * 00052800
*                 xxxx0403    For List request, not all data was      * 00052900
*                             returned because the answer area is not * 00053000
*                             big enough. Answer area field APFHTLEN  * 00053100
*                             indicates how much space is currently   * 00053200
*                             required. The user should re-issue the  * 00053300
*                             request designating a larger answer     * 00053400
*                             area.                                   * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*       8         CSVAPF request specifies invalid parameters.        * 00054000
*                                                                     * 00054100
*                 HEX REASON   MEANING                                * 00054200
*                 CODE                                                * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                 xxxx0801    Unable to access parameter list         * 00054600
*                                                                     * 00054700
*                 xxxx0802    SRB mode                                * 00054800
*                                                                     * 00054900
*                 xxxx0803    Not Enabled                             * 00055000
*                                                                     * 00055100
*                 xxxx0804    Not authorized                          * 00055200
*                                                                     * 00055300
*                 xxxx0805    Home address space different than       * 00055400
*                             primary address space                   * 00055500
*                                                                     * 00055600
*                 xxxx0806    Bad answer area ALET                    * 00055700
*                                                                     * 00055800
*                 xxxx0807    Error accessing answer area             * 00055900
*                                                                     * 00056000
*                 xxxx0808    QUERY - AnsLen is less than size of the * 00056100
*                             header area                             * 00056200
*                                                                     * 00056300
*                 xxxx0809    Request type is not valid               * 00056400
*                                                                     * 00056500
*                 xxxx080A    Unable to establish ESTAE. "xxxx"       * 00056600
*                             contains ESTAE return code              * 00056700
*                                                                     * 00056800
*                 xxxx080B    Reserved field not 0                    * 00056900
*                                                                     * 00057000
*                 xxxx080C    Bad dataset name. First character is    * 00057100
*                             blank                                   * 00057200
*                                                                     * 00057300
*                 xxxx080D    Bad parmlist ALET                       * 00057400
*                                                                     * 00057500
*                 xxxx080E    Bad version number                      * 00057600
*                                                                     * 00057700
*                 xxxx080F    Locked (for ADD, DELETE, DYNFORMAT)     * 00057800
*                                                                     * 00057900
*                                                                     * 00058000
*                                                                     * 00058100
*                                                                     * 00058200
*       C         Environmental error                                 * 00058300
*                                                                     * 00058400
*                 HEX REASON   MEANING                                * 00058500
*                 CODE                                                * 00058600
*                                                                     * 00058700
*                                                                     * 00058800
*                 xxxx0C01    Function is not available. APF FORMAT   * 00058900
*                             is STATIC                               * 00059000
*                                                                     * 00059100
*                 xxxx0C02    Function is not available. DFP level is * 00059200
*                             not at least DFP 4.1.0.                 * 00059300
*                                                                     * 00059400
*                                                                     * 00059500
*                                                                     * 00059600
*                                                                     * 00059700
*       10        Unexpected failure.  The state of the request is    * 00059800
*                 unpredictable.                                      * 00059900
*                                                                     * 00060000
*                 HEX REASON   MEANING                                * 00060100
*                 CODE                                                * 00060200
*                                                                     * 00060300
*                                                                     * 00060400
*                 xxxx1001    Unexpected failure                      * 00060500
*                                                                     * 00060600
*                                                                     * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*01* REASON CODES:                                                    * 00061100
*                                                                     * 00061200
*       Reason codes, as appropriate, are defined under their         * 00061300
*       corresponding return code.  Reason code and return code       * 00061400
*       constants are defined within CSVAPFAA.                        * 00061500
*                                                                     * 00061600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00061700
*                                                                     * 00061800
*02*   PROCESSOR:  ASSEM                                              * 00061900
*                                                                     * 00062000
*01* COMPONENT:  SC1CJ                                                * 00062100
*                                                                     * 00062200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00062300
*                                                                     * 00062400
*01* MACRO USAGE NOTES:                                               * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00062800
*        global macro variable.  Any value other than 'NO' will       * 00062900
*        result in the macro expansion being printed.  The default is * 00063000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00063100
*        variable should be set.                                      * 00063200
*                                                                     * 00063300
*                    GBLC &ZPRINT                                     * 00063400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*                                                                     * 00063800
*01* CHANGE ACTIVITY:                                                 * 00063900
*                                                                     * 00064000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00064100
*                                                                     * 00064200
*    $L0=ANVALAPA HBB4430 901112 PD00XB:  Dynamic APF                 * 00064300
*    $01=OY60389  HBB4430 921224 PD34EP:  *MCAT* support              * 00064400
****** END OF SPECIFICATIONS *****************************************/ 00064500
*/********************************************************************* 00064600
         MACRO                                                          00064700
&XLABEL  CSVAPF &REQUEST=,&DSNAME=,&VOLTYPE=,&VOLUME=,&TEST=,&FORMAT=, *00064800
               &ANSAREA=,&ANSLEN=,&RETCODE=,&RSNCODE=,&MF=              00064900
.*                                                                      00065000
*                 MACDATE -08/25/93-<0>                                 00065100
.*                                                                      00065200
.*******************************************************************    00065300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00065400
.*******************************************************************    00065500
                 GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                00065600
                 GBLC  &ZTEST      YES=TEST NO=NO TEST                  00065700
                 GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX          00065800
.*                                                                      00065900
                 GBLC  &ZCSVAPF    YES=MACRO USED AT LEAST ONCE         00066000
.*******************************************************************    00066100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00066200
.*******************************************************************    00066300
                 LCLC  &ZMS        ERROR MESSAGE WORK AREA              00066400
                 LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS         00066500
                 LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED           00066600
                 LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR          00066700
                 LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE          00066800
                 LCLA  &ZAWRK      USED AS A WORK AREA                  00066900
                 LCLA  &ZASIZ      USED FOR SIZE OF VALUE               00067000
                 LCLA  &ZN         NUMERIC WORK VARIABLE                00067100
                 LCLC  &ZC         CHARACTER WORK VARIABLE              00067200
                 LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE          00067300
                 LCLA  &ZTLA       VALUE TOO LONG VARIABLE              00067400
                 LCLA  &ZMACRET    MACRO RETURN CODE                    00067500
&ZMACRET         SETA  0           ASSUME NO ERRORS                     00067600
.*                                                                      00067700
                 LCLC  &ZCSYSLIST(255)          NONXKEY, POS ARRAY      00067800
                 LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()           00067900
                 LCLA  &ZPLLEN     PARAMETER LIST LENGTH                00068000
.********************************************************************   00068100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00068200
.********************************************************************   00068300
                 GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL              00068400
                 GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE       00068500
.*                                                                      00068600
                 AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED       00068700
                 AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED        00068800
                 SPLEVEL  TEST                                          00068900
.ZSYS2           ANOP  ,                                                00069000
                 AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1            00069100
                 AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1            00069200
                 SYSSTATE TEST                                          00069300
                 AGO   .ZSYS4                                           00069400
.ZSYS3           ANOP  ,                                                00069500
&SYSASCE         SETC  'P'         ASSUME SYSSTATE PRIMARY              00069600
.ZSYS4           ANOP  ,                                                00069700
.*******************************************************************    00069800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00069900
.*******************************************************************    00070000
                 LCLC  &XREQUEST   ++ VALUE                             00070100
                 LCLC  &XDSNAME    ++ NAME                              00070200
                 LCLC  &XVOLTYPE   ++ VALUE                             00070300
                 LCLC  &XVOLUME    ++ NAME                              00070400
                 LCLC  &XTEST      ++ VALUE                             00070500
                 LCLC  &XFORMAT    ++ NAME                              00070600
                 LCLC  &XANSAREA   ++ NAME                              00070700
                 LCLC  &XANSLEN    ++ NAME                              00070800
                 LCLC  &XRETCODE   ++ NAME                              00070900
                 LCLC  &XRSNCODE   ++ NAME                              00071000
                 LCLC  &XMF        ++ VALUE                             00071100
                 LCLC  &XMFCTRL    ++ NAME                              00071200
                 LCLC  &XMFATTR    ++ VALUE                             00071300
                 LCLC  &XMFSCK     ++ VALUE                             00071400
.*******************************************************************    00071500
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00071600
.*******************************************************************    00071700
                 LCLC  &ZXREQUEST  ++ INPUT VALUE                       00071800
                 LCLC  &ZXDSNAME   ++ INPUT NAME                        00071900
                 LCLC  &ZXVOLTYPE  ++ INPUT VALUE                       00072000
                 LCLC  &ZXVOLUME   ++ INPUT NAME                        00072100
                 LCLC  &ZXTEST     ++ INPUT VALUE                       00072200
                 LCLC  &ZXFORMAT   ++ OUTPUT NAME                       00072300
                 LCLC  &ZXANSAREA  ++ OUTPUT NAME                       00072400
                 LCLC  &ZXANSLEN   ++ INPUT NAME                        00072500
                 LCLC  &ZXRETCODE  ++ OUTPUT NAME                       00072600
                 LCLC  &ZXRSNCODE  ++ OUTPUT NAME                       00072700
                 LCLC  &ZXMF       ++ INPUT VALUE                       00072800
                 LCLC  &ZXMFCTRL   ++ INPUT NAME                        00072900
                 LCLC  &ZXMFATTR   ++ INPUT VALUE                       00073000
                 LCLC  &ZXMFSCK    ++ INPUT VALUE                       00073100
.********************************************************************   00073200
.***AG.MF01 PROCESS MF MACRO FORMS                                      00073300
.********************************************************************   00073400
                 ACTR  10000                                            00073500
.*------------------------------------------------------------------    00073600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00073700
&XMF             SETC  ''          INITIALIZE XVARIABLE                 00073800
.*-------------------------------------------------------------------   00073900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00074000
.ZG65            ANOP  ,                                                00074100
&ZTLC            SETC 'S'                                               00074200
                 AIF   ('&MF(1)' NE '&ZTLC').ZG66                       00074300
&XMF             SETC  'S'         SET KEYWORD                          00074400
                 AIF   (N'&MF LE 1).ZG65A       CK NUM                  00074500
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00074600
&ZMS             SETC  '&ZMS.&MF"'                                      00074700
&ZMS             SETC  '&ZMS "MF"'                                      00074800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00074900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00075000
.ZG65A           ANOP  ,                                                00075100
.*-------------------------------------------------------------------   00075200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075300
.ZG66            ANOP  ,                                                00075400
&ZTLC            SETC 'L'                                               00075500
                 AIF   ('&MF(1)' NE '&ZTLC').ZG73                       00075600
&XMF             SETC  'L'         SET KEYWORD                          00075700
                 AIF   (N'&MF LE 3).ZG66A       CK NUM                  00075800
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00075900
&ZMS             SETC  '&ZMS.&MF"'                                      00076000
&ZMS             SETC  '&ZMS "MF"'                                      00076100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00076200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00076300
.ZG66A           ANOP  ,                                                00076400
.*-------------------------------------------------------------------   00076500
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00076600
                 AIF   (N'&SYSLIST NE 0).ZG66B  POSITIONALS?            00076700
                 AIF   ('&REQUEST' NE '').ZG66B  KEYS?                  00076800
                 AIF   ('&DSNAME' NE '').ZG66B  KEYS?                   00076900
                 AIF   ('&VOLTYPE' NE '').ZG66B  KEYS?                  00077000
                 AIF   ('&VOLUME' NE '').ZG66B  KEYS?                   00077100
                 AIF   ('&TEST' NE '').ZG66B    KEYS?                   00077200
                 AIF   ('&FORMAT' NE '').ZG66B  KEYS?                   00077300
                 AIF   ('&ANSAREA' NE '').ZG66B  KEYS?                  00077400
                 AIF   ('&ANSLEN' NE '').ZG66B  KEYS?                   00077500
                 AIF   ('&RETCODE' NE '').ZG66B  KEYS?                  00077600
                 AIF   ('&RSNCODE' NE '').ZG66B  KEYS?                  00077700
                 AGO    .ZG66C     INVOCATION OKAY                      00077800
.ZG66B           ANOP  ,                                                00077900
&ZMS             SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE      00078000
&ZMS             SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                00078100
&ZMS             SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'           00078200
                 MNOTE 8,' &ZMS ON THE INVOCATION.'                     00078300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00078400
.ZG66C           ANOP  ,                                                00078500
.*-------------------------------------------------------------------   00078600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00078700
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00078800
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00078900
                 AIF   (N'&MF(2) GT 1).ZG68B    MULTI PARMS             00079000
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00079100
.ZG68B           AIF   (K'&MF(2) GT 0).ZG68C                            00079200
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00079300
&ZMS             SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*                 00079400
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00079500
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00079600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00079700
.ZG68C           ANOP  ,                                                00079800
.*-------------------------------------------------------------------   00079900
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00080000
                 AIF   (K'&ZXMFCTRL LE 0).ZG68P  NOT I/O                00080100
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG68P                   00080200
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00080300
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00080400
&ZMS             SETC  '&ZMS.&MF"'                                      00080500
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00080600
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                00080700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00080800
.ZG68P           ANOP  ,                                                00080900
.*-------------------------------------------------------------------   00081000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00081100
&ZXMFATTR        SETC  'INPUT'     SET IN/OUTPUT                        00081200
&XMFATTR         SETC  '0D'                                             00081300
                 AIF   (K'&MF(3) LE 0).ZG71B    PARM                    00081400
&XMFATTR         SETC  '&MF(3,1)'  SET XVARIABLE                        00081500
                 AIF   (N'&MF(3) GT 1).ZG71B    MULTI PARMS             00081600
&XMFATTR         SETC  '&MF(3)'    SET XVARIABLE                        00081700
.ZG71B           ANOP  ,                                                00081800
.*-------------------------------------------------------------------   00081900
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00082000
                 AIF   (K'&ZXMFATTR LE 0).ZG71P  NOT I/O                00082100
                 AIF   ('&XMFATTR'(1,1) NE '(').ZG71P                   00082200
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00082300
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00082400
&ZMS             SETC  '&ZMS.&MF"'                                      00082500
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00082600
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                00082700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00082800
.ZG71P           ANOP  ,                                                00082900
.*-------------------------------------------------------------------   00083000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00083100
                 AIF   (K'&ZXMFATTR LE 0).ZG71S  NOT I/O                00083200
                 AIF   (K'&XMFATTR LE 60).ZG71S  LNG OK                 00083300
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00083400
&ZMS             SETC  '"MF='      *KLNGA* MNOTE                        00083500
&ZMS             SETC  '&ZMS.&MF"'                                      00083600
&ZMS             SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'            00083700
                 MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'               00083800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00083900
.ZG71S           ANOP  ,                                                00084000
.*-------------------------------------------------------------------   00084100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084200
.ZG73            ANOP  ,                                                00084300
&ZTLC            SETC 'E'                                               00084400
                 AIF   ('&MF(1)' NE '&ZTLC').ZG81                       00084500
&XMF             SETC  'E'         SET KEYWORD                          00084600
                 AIF   (N'&MF LE 3).ZG73A       CK NUM                  00084700
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00084800
&ZMS             SETC  '&ZMS.&MF"'                                      00084900
&ZMS             SETC  '&ZMS "MF"'                                      00085000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00085100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00085200
.ZG73A           ANOP  ,                                                00085300
.*-------------------------------------------------------------------   00085400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00085500
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00085600
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00085700
                 AIF   (N'&MF(2) GT 1).ZG75B    MULTI PARMS             00085800
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00085900
.ZG75B           AIF   (K'&MF(2) GT 0).ZG75C                            00086000
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00086100
&ZMS             SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*                 00086200
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00086300
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00086400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00086500
.ZG75C           ANOP  ,                                                00086600
.*-------------------------------------------------------------------   00086700
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00086800
                 AIF   (K'&ZXMFCTRL LE 0).ZG75R  NOT I/O                00086900
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG75R                   00087000
&ZCGPR           SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                       00087100
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG75P                     00087200
                 AIF   (K'&ZCGPR GT 2).ZG75Q                            00087300
                 AIF   ('&ZCGPR' EQ '0').ZG75Q                          00087400
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00087500
                 AIF   (T'&ZCGPR NE 'N').ZG75Q  INVALID REG NAME        00087600
.ZG75P           ANOP  ,                                                00087700
                 AIF   (T'&ZCGPR NE 'N').ZG75R  NON NUMERIC             00087800
                 AIF   ('&ZCGPR' LT '1').ZG75Q                          00087900
                 AIF   ('&ZCGPR' LE '12').ZG75R                         00088000
.ZG75Q           ANOP  ,                                                00088100
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00088200
&ZMS             SETC  '&ZMS.&MF"'                                      00088300
&ZMS             SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'        00088400
                 MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                 00088500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00088600
.ZG75R           ANOP  ,                                                00088700
.*-------------------------------------------------------------------   00088800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00088900
&XMFSCK          SETC  ''          INITIALIZE XVARIABLE                 00089000
.ZG79A   AIF   ('&MF(3)' NE 'COMPLETE').ZG80A                           00089100
&XMFSCK          SETC  'COMPLETE'  SET KEYWORD                          00089200
.*-------------------------------------------------------------------   00089300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00089400
.ZG80A           AIF   (K'&XMFSCK GT 0).ZG80C   KEYWORD                 00089500
                 AIF   (K'&MF(3) LE 0).ZG80B                            00089600
&ZMS             SETC  '"MF='      *KUKWA* MNOTE                        00089700
&ZMS             SETC  '&ZMS.&MF"'                                      00089800
&ZMS             SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '        00089900
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00090000
&ZMS             SETC  '&ZMS "COMPLETE".'       VALID KEYWORD           00090100
                 MNOTE 8,' &ZMS '                                       00090200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00090300
.ZG80B           ANOP  ,                                                00090400
&XMFSCK          SETC  'COMPLETE'  SET DEFAULT KEYWORD                  00090500
.ZG80C           ANOP  ,                                                00090600
&ZXMFSCK         SETC  'INPUT'     SET IN/OUTPUT                        00090700
.*------------------------------------------------------------------    00090800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090900
.ZG81            ANOP  ,                                                00091000
&ZXMF            SETC  'INPUT'     SET IN/OUTPUT                        00091100
                 AIF   (K'&XMF GT 0).ZG81E      VALID ARG               00091200
                 AIF   (T'&MF EQ 'O').ZG81D     OMITTED                 00091300
&ZASYSLNDX       SETA  0                                                00091400
.ZG81A           ANOP  ,           POSITIONAL MACRO KEY                 00091500
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00091600
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG81C                 00091700
&ZTLC            SETC 'MF'                                              00091800
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG81A        00091900
.ZG81B           ANOP  ,                                                00092000
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00092100
&ZMS             SETC  'THE "MF" KEY'           *KOPTA* MNOTE           00092200
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00092300
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00092400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00092500
                 AGO   .ZG81E                                           00092600
.ZG81C           ANOP  ,                                                00092700
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00092800
&ZMS             SETC  '"MF='      *KUKWA* MNOTE                        00092900
&ZMS             SETC  '&ZMS.&MF"'                                      00093000
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00093100
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00093200
&ZMS             SETC  '&ZMS "S",'              VALID KEYWORD           00093300
&ZMS             SETC  '&ZMS "L",'              VALID KEYWORD           00093400
&ZMS             SETC  '&ZMS OR "E".'           VALID KEYWORD           00093500
                 MNOTE 8,' &ZMS '                                       00093600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00093700
                 AGO   .ZG81E                                           00093800
.ZG81D           ANOP  ,                                                00093900
&XMF             SETC  'S'         SET DEFAULT KEYWORD                  00094000
&XMFSCK          SETC  'COMPLETE'  COMPLETE CHECKING                    00094100
.ZG81E           ANOP  ,                                                00094200
.********************************************************************   00094300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00094400
.********************************************************************   00094500
                 ACTR  10000                                            00094600
.*-------------------------------------------------------------------   00094700
.***AG.MF03 MF=(SLE)                                                    00094800
                 AIF   ('&XMF' EQ 'L').ZGMFX                            00094900
.*------------------------------------------------------------------    00095000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095100
&XREQUEST        SETC  ''          INITIALIZE XVARIABLE                 00095200
.*-------------------------------------------------------------------   00095300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095400
.ZG3             ANOP  ,                                                00095500
                 AIF   (K'&REQUEST(1) LE 0).ZG3A                        00095600
&ZTLC            SETC 'QUERY'                                           00095700
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG20                  00095800
&XREQUEST        SETC  'QUERY'     SET KEYWORD                          00095900
                 AIF   (N'&REQUEST LE 1).ZG3A   CK NUM                  00096000
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00096100
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00096200
&ZMS             SETC  '&ZMS "REQUEST"'                                 00096300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00096400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00096500
.ZG3A            ANOP  ,                                                00096600
.*------------------------------------------------------------------    00096700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096800
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00096900
.ZG3A0           AIF   (K'&FORMAT LE 0).ZG3A1   OK                      00097000
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00097100
.ZG3A1           AIF   (K'&ANSAREA LE 0).ZG3A2  OK                      00097200
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00097300
.ZG3A2           AIF   (K'&ANSLEN LE 0).ZG3A3   OK                      00097400
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00097500
.ZG3A3           AIF   (K'&ZCVAL LE 0).ZG3A4    OK                      00097600
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00097700
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00097800
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00097900
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00098000
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00098100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00098200
.ZG3A4           ANOP  ,                                                00098300
.*----------------------------------------------------------------***   00098400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00098500
                 AIF   (N'&DSNAME LE 1).ZG5A    CK NUM                  00098600
&ZMS             SETC  '"DSNAME='  *KPOSA* MNOTE                        00098700
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00098800
&ZMS             SETC  '&ZMS "DSNAME"'                                  00098900
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00099000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00099100
.ZG5A            ANOP  ,                                                00099200
.*-------------------------------------------------------------------   00099300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00099400
&ZXDSNAME        SETC  'INPUT'     SET IN/OUTPUT                        00099500
&XDSNAME         SETC  '&DSNAME(1)'             SET XVARIABLE           00099600
                 AIF   (N'&DSNAME GT 1).ZG5B    MULTI PARMS             00099700
&XDSNAME         SETC  '&DSNAME'   SET XVARIABLE                        00099800
.ZG5B            AIF   (K'&DSNAME(1) GT 0).ZG5C                         00099900
&ZXDSNAME        SETC  ''          RESET IN/OUTPUT                      00100000
&ZMS             SETC  ' '         *KRQDA*                              00100100
&ZMS             SETC  '&ZMS "DSNAME" KEY AND ITS ARGUMENT'             00100200
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00100300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00100400
.ZG5C            ANOP  ,                                                00100500
.*-------------------------------------------------------------------   00100600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00100700
                 AIF   (K'&ZXDSNAME LE 0).ZG5R  NOT I/O                 00100800
                 AIF   ('&XDSNAME'(1,1) NE '(').ZG5R                    00100900
&ZCGPR           SETC  '&XDSNAME'(2,K'&XDSNAME-2)                       00101000
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                      00101100
                 AIF   (K'&ZCGPR GT 2).ZG5Q                             00101200
                 AIF   ('&ZCGPR' EQ '0').ZG5Q                           00101300
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00101400
                 AIF   (T'&ZCGPR NE 'N').ZG5Q   INVALID REG NAME        00101500
.ZG5P            ANOP  ,                                                00101600
                 AIF   (T'&ZCGPR NE 'N').ZG5R   NON NUMERIC             00101700
                 AIF   ('&ZCGPR' LT '2').ZG5Q                           00101800
                 AIF   ('&ZCGPR' LE '12').ZG5R                          00101900
.ZG5Q            ANOP  ,                                                00102000
&ZMS             SETC  '"DSNAME='  *KGPRA* MNOTE                        00102100
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00102200
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00102300
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00102400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00102500
.ZG5R            ANOP  ,                                                00102600
.*------------------------------------------------------------------    00102700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102800
&XVOLTYPE        SETC  ''          INITIALIZE XVARIABLE                 00102900
.*-------------------------------------------------------------------   00103000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00103100
.ZG9             ANOP  ,                                                00103200
                 AIF   (K'&VOLTYPE(1) LE 0).ZG9A                        00103300
&ZTLC            SETC 'SMS'                                             00103400
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG10                  00103500
&XVOLTYPE        SETC  'SMS'       SET KEYWORD                          00103600
                 AIF   (N'&VOLTYPE LE 1).ZG9A   CK NUM                  00103700
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00103800
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00103900
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00104000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00104100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00104200
.ZG9A            ANOP  ,                                                00104300
.*------------------------------------------------------------------    00104400
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104500
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00104600
.ZG9A0           AIF   (K'&VOLUME LE 0).ZG9A1   OK                      00104700
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00104800
.ZG9A1           AIF   (K'&ZCVAL LE 0).ZG9A2    OK                      00104900
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00105000
&ZMS             SETC  '"VOLTYPE'  *KMEIA* MNOTE                        00105100
&ZMS             SETC  '&ZMS.=&VOLTYPE"'                                00105200
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00105300
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00105400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00105500
.ZG9A2           ANOP  ,                                                00105600
.*-------------------------------------------------------------------   00105700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105800
.ZG10            ANOP  ,                                                00105900
&ZTLC            SETC 'ANY'                                             00106000
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG14                  00106100
&XVOLTYPE        SETC  'ANY'       SET KEYWORD                          00106200
                 AIF   (N'&VOLTYPE LE 1).ZG10A  CK NUM                  00106300
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00106400
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00106500
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00106600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00106700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00106800
.ZG10A           ANOP  ,                                                00106900
.*----------------------------------------------------------------***   00107000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00107100
                 AIF   (N'&VOLUME LE 1).ZG12A   CK NUM                  00107200
&ZMS             SETC  '"VOLUME='  *KPOSA* MNOTE                        00107300
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00107400
&ZMS             SETC  '&ZMS "VOLUME"'                                  00107500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00107600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00107700
.ZG12A           ANOP  ,                                                00107800
.*-------------------------------------------------------------------   00107900
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00108000
&ZXVOLUME        SETC  'INPUT'     SET IN/OUTPUT                        00108100
&XVOLUME         SETC  '&VOLUME(1)'             SET XVARIABLE           00108200
                 AIF   (N'&VOLUME GT 1).ZG12B   MULTI PARMS             00108300
&XVOLUME         SETC  '&VOLUME'   SET XVARIABLE                        00108400
.ZG12B           AIF   (K'&VOLUME(1) GT 0).ZG12C                        00108500
&ZXVOLUME        SETC  ''          RESET IN/OUTPUT                      00108600
&ZMS             SETC  'WHEN "ANY" IS SPECIFIED'  *KRQDA*               00108700
&ZMS             SETC  '&ZMS , "VOLUME" KEY AND ITS ARGUMENT'           00108800
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00108900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00109000
.ZG12C           ANOP  ,                                                00109100
.*-------------------------------------------------------------------   00109200
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00109300
                 AIF   (K'&ZXVOLUME LE 0).ZG12R  NOT I/O                00109400
                 AIF   ('&XVOLUME'(1,1) NE '(').ZG12R                   00109500
&ZCGPR           SETC  '&XVOLUME'(2,K'&XVOLUME-2)                       00109600
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                     00109700
                 AIF   (K'&ZCGPR GT 2).ZG12Q                            00109800
                 AIF   ('&ZCGPR' EQ '0').ZG12Q                          00109900
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00110000
                 AIF   (T'&ZCGPR NE 'N').ZG12Q  INVALID REG NAME        00110100
.ZG12P           ANOP  ,                                                00110200
                 AIF   (T'&ZCGPR NE 'N').ZG12R  NON NUMERIC             00110300
                 AIF   ('&ZCGPR' LT '2').ZG12Q                          00110400
                 AIF   ('&ZCGPR' LE '12').ZG12R                         00110500
.ZG12Q           ANOP  ,                                                00110600
&ZMS             SETC  '"VOLUME='  *KGPRA* MNOTE                        00110700
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00110800
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00110900
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00111000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00111100
.ZG12R           ANOP  ,                                                00111200
.*------------------------------------------------------------------    00111300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00111400
.ZG14            ANOP  ,                                                00111500
&ZXVOLTYPE       SETC  'INPUT'     SET IN/OUTPUT                        00111600
                 AIF   (K'&XVOLTYPE GT 0).ZG14E  VALID ARG              00111700
                 AIF   (T'&VOLTYPE EQ 'O').ZG14D  OMITTED               00111800
&ZASYSLNDX       SETA  0                                                00111900
.ZG14A           ANOP  ,           POSITIONAL MACRO KEY                 00112000
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00112100
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG14C                 00112200
&ZTLC            SETC 'VOLTYPE'                                         00112300
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG14A        00112400
.ZG14B           ANOP  ,                                                00112500
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00112600
&ZMS             SETC  'THE "VOLTYPE" KEY'      *KOPTA* MNOTE           00112700
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00112800
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00112900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00113000
                 AGO   .ZG14E                                           00113100
.ZG14C           ANOP  ,                                                00113200
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00113300
&ZMS             SETC  '"VOLTYPE='              *KUKWA* MNOTE           00113400
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00113500
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00113600
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00113700
&ZMS             SETC  '&ZMS "SMS"'             VALID KEYWORD           00113800
&ZMS             SETC  '&ZMS OR "ANY".'         VALID KEYWORD           00113900
                 MNOTE 8,' &ZMS '                                       00114000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00114100
                 AGO   .ZG14E                                           00114200
.ZG14D           ANOP  ,                                                00114300
&XVOLTYPE        SETC  'SMS'       SET DEFAULT KEYWORD                  00114400
.ZG14E           ANOP  ,                                                00114500
.*------------------------------------------------------------------    00114600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114700
&XTEST           SETC  ''          INITIALIZE XVARIABLE                 00114800
.*-------------------------------------------------------------------   00114900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115000
.ZG17            ANOP  ,                                                00115100
                 AIF   (K'&TEST(1) LE 0).ZG17A                          00115200
&ZTLC            SETC 'NO'                                              00115300
                 AIF   ('&TEST(1)' NE '&ZTLC').ZG18                     00115400
&XTEST           SETC  'NO'        SET KEYWORD                          00115500
                 AIF   (N'&TEST LE 1).ZG17A     CK NUM                  00115600
&ZMS             SETC  '"TEST='    *KPOSA* MNOTE                        00115700
&ZMS             SETC  '&ZMS.&TEST"'                                    00115800
&ZMS             SETC  '&ZMS "TEST"'                                    00115900
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00116000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00116100
.ZG17A           ANOP  ,                                                00116200
.*-------------------------------------------------------------------   00116300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116400
.ZG18            ANOP  ,                                                00116500
&ZTLC            SETC 'YES'                                             00116600
                 AIF   ('&TEST(1)' NE '&ZTLC').ZG19                     00116700
&XTEST           SETC  'YES'       SET KEYWORD                          00116800
                 AIF   (N'&TEST LE 1).ZG18A     CK NUM                  00116900
&ZMS             SETC  '"TEST='    *KPOSA* MNOTE                        00117000
&ZMS             SETC  '&ZMS.&TEST"'                                    00117100
&ZMS             SETC  '&ZMS "TEST"'                                    00117200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00117300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00117400
.ZG18A           ANOP  ,                                                00117500
.*------------------------------------------------------------------    00117600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117700
.ZG19            ANOP  ,                                                00117800
&ZXTEST          SETC  'INPUT'     SET IN/OUTPUT                        00117900
                 AIF   (K'&XTEST GT 0).ZG19E    VALID ARG               00118000
                 AIF   (T'&TEST EQ 'O').ZG19D   OMITTED                 00118100
&ZASYSLNDX       SETA  0                                                00118200
.ZG19A           ANOP  ,           POSITIONAL MACRO KEY                 00118300
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00118400
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG19C                 00118500
&ZTLC            SETC 'TEST'                                            00118600
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG19A        00118700
.ZG19B           ANOP  ,                                                00118800
&ZXTEST          SETC  ''          RESET IN/OUTPUT                      00118900
&ZMS             SETC  'THE "TEST" KEY'         *KOPTA* MNOTE           00119000
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00119100
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00119200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00119300
                 AGO   .ZG19E                                           00119400
.ZG19C           ANOP  ,                                                00119500
&ZXTEST          SETC  ''          RESET IN/OUTPUT                      00119600
&ZMS             SETC  '"TEST='    *KUKWA* MNOTE                        00119700
&ZMS             SETC  '&ZMS.&TEST"'                                    00119800
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00119900
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00120000
&ZMS             SETC  '&ZMS "NO"'              VALID KEYWORD           00120100
&ZMS             SETC  '&ZMS OR "YES".'         VALID KEYWORD           00120200
                 MNOTE 8,' &ZMS '                                       00120300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00120400
                 AGO   .ZG19E                                           00120500
.ZG19D           ANOP  ,                                                00120600
&XTEST           SETC  'NO'        SET DEFAULT KEYWORD                  00120700
.ZG19E           ANOP  ,                                                00120800
.*-------------------------------------------------------------------   00120900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121000
.ZG20            ANOP  ,                                                00121100
&ZTLC            SETC 'QUERYFORMAT'                                     00121200
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG24                  00121300
&XREQUEST        SETC  'QUERYFORMAT'            SET KEYWORD             00121400
                 AIF   (N'&REQUEST LE 1).ZG20A  CK NUM                  00121500
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00121600
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00121700
&ZMS             SETC  '&ZMS "REQUEST"'                                 00121800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00121900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00122000
.ZG20A           ANOP  ,                                                00122100
.*------------------------------------------------------------------    00122200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00122300
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00122400
.ZG20A0          AIF   (K'&DSNAME LE 0).ZG20A1  OK                      00122500
&ZCVAL           SETC '&ZCVAL DSNAME'           INCORRECT KEY USED      00122600
.ZG20A1          AIF   (K'&VOLTYPE LE 0).ZG20A2  OK                     00122700
&ZCVAL           SETC '&ZCVAL VOLTYPE'          INCORRECT KEY USED      00122800
.ZG20A2          AIF   (K'&VOLUME LE 0).ZG20A3  OK                      00122900
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00123000
.ZG20A3          AIF   (K'&TEST LE 0).ZG20A4    OK                      00123100
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00123200
.ZG20A4          AIF   (K'&ANSAREA LE 0).ZG20A5  OK                     00123300
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00123400
.ZG20A5          AIF   (K'&ANSLEN LE 0).ZG20A6  OK                      00123500
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00123600
.ZG20A6          AIF   (K'&ZCVAL LE 0).ZG20A7   OK                      00123700
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00123800
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00123900
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00124000
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00124100
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00124200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00124300
.ZG20A7          ANOP  ,                                                00124400
.*----------------------------------------------------------------***   00124500
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00124600
                 AIF   (N'&FORMAT LE 1).ZG22A   CK NUM                  00124700
&ZMS             SETC  '"FORMAT='  *KPOSA* MNOTE                        00124800
&ZMS             SETC  '&ZMS.&FORMAT"'                                  00124900
&ZMS             SETC  '&ZMS "FORMAT"'                                  00125000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00125100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00125200
.ZG22A           ANOP  ,                                                00125300
.*-------------------------------------------------------------------   00125400
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00125500
&ZXFORMAT        SETC  'OUTPUT'    SET IN/OUTPUT                        00125600
&XFORMAT         SETC  '&FORMAT(1)'             SET XVARIABLE           00125700
                 AIF   (N'&FORMAT GT 1).ZG22B   MULTI PARMS             00125800
&XFORMAT         SETC  '&FORMAT'   SET XVARIABLE                        00125900
.ZG22B           AIF   (K'&FORMAT(1) GT 0).ZG22C                        00126000
&ZXFORMAT        SETC  ''          RESET IN/OUTPUT                      00126100
&ZMS             SETC  ' '         *KRQDA*                              00126200
&ZMS             SETC  '&ZMS "FORMAT" KEY AND ITS ARGUMENT'             00126300
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00126400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00126500
.ZG22C           ANOP  ,                                                00126600
.*-------------------------------------------------------------------   00126700
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00126800
                 AIF   (K'&ZXFORMAT LE 0).ZG22R  NOT I/O                00126900
                 AIF   ('&XFORMAT'(1,1) NE '(').ZG22R                   00127000
&ZCGPR           SETC  '&XFORMAT'(2,K'&XFORMAT-2)                       00127100
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                     00127200
                 AIF   (K'&ZCGPR GT 2).ZG22Q                            00127300
                 AIF   ('&ZCGPR' EQ '0').ZG22Q                          00127400
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00127500
                 AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME        00127600
.ZG22P           ANOP  ,                                                00127700
                 AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC             00127800
                 AIF   ('&ZCGPR' LT '2').ZG22Q                          00127900
                 AIF   ('&ZCGPR' LE '12').ZG22R                         00128000
.ZG22Q           ANOP  ,                                                00128100
&ZMS             SETC  '"FORMAT='  *KGPRA* MNOTE                        00128200
&ZMS             SETC  '&ZMS.&FORMAT"'                                  00128300
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00128400
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00128500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00128600
.ZG22R           ANOP  ,                                                00128700
.*-------------------------------------------------------------------   00128800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128900
.ZG24            ANOP  ,                                                00129000
&ZTLC            SETC 'ADD'                                             00129100
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG36                  00129200
&XREQUEST        SETC  'ADD'       SET KEYWORD                          00129300
                 AIF   (N'&REQUEST LE 1).ZG24A  CK NUM                  00129400
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00129500
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00129600
&ZMS             SETC  '&ZMS "REQUEST"'                                 00129700
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00129800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00129900
.ZG24A           ANOP  ,                                                00130000
.*------------------------------------------------------------------    00130100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130200
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00130300
.ZG24A0          AIF   (K'&TEST LE 0).ZG24A1    OK                      00130400
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00130500
.ZG24A1          AIF   (K'&FORMAT LE 0).ZG24A2  OK                      00130600
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00130700
.ZG24A2          AIF   (K'&ANSAREA LE 0).ZG24A3  OK                     00130800
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00130900
.ZG24A3          AIF   (K'&ANSLEN LE 0).ZG24A4  OK                      00131000
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00131100
.ZG24A4          AIF   (K'&ZCVAL LE 0).ZG24A5   OK                      00131200
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00131300
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00131400
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00131500
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00131600
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00131700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00131800
.ZG24A5          ANOP  ,                                                00131900
.*----------------------------------------------------------------***   00132000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00132100
                 AIF   (N'&DSNAME LE 1).ZG26A   CK NUM                  00132200
&ZMS             SETC  '"DSNAME='  *KPOSA* MNOTE                        00132300
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00132400
&ZMS             SETC  '&ZMS "DSNAME"'                                  00132500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00132600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00132700
.ZG26A           ANOP  ,                                                00132800
.*-------------------------------------------------------------------   00132900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00133000
&ZXDSNAME        SETC  'INPUT'     SET IN/OUTPUT                        00133100
&XDSNAME         SETC  '&DSNAME(1)'             SET XVARIABLE           00133200
                 AIF   (N'&DSNAME GT 1).ZG26B   MULTI PARMS             00133300
&XDSNAME         SETC  '&DSNAME'   SET XVARIABLE                        00133400
.ZG26B           AIF   (K'&DSNAME(1) GT 0).ZG26C                        00133500
&ZXDSNAME        SETC  ''          RESET IN/OUTPUT                      00133600
&ZMS             SETC  ' '         *KRQDA*                              00133700
&ZMS             SETC  '&ZMS "DSNAME" KEY AND ITS ARGUMENT'             00133800
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00133900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00134000
.ZG26C           ANOP  ,                                                00134100
.*-------------------------------------------------------------------   00134200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00134300
                 AIF   (K'&ZXDSNAME LE 0).ZG26R  NOT I/O                00134400
                 AIF   ('&XDSNAME'(1,1) NE '(').ZG26R                   00134500
&ZCGPR           SETC  '&XDSNAME'(2,K'&XDSNAME-2)                       00134600
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                     00134700
                 AIF   (K'&ZCGPR GT 2).ZG26Q                            00134800
                 AIF   ('&ZCGPR' EQ '0').ZG26Q                          00134900
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00135000
                 AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME        00135100
.ZG26P           ANOP  ,                                                00135200
                 AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC             00135300
                 AIF   ('&ZCGPR' LT '2').ZG26Q                          00135400
                 AIF   ('&ZCGPR' LE '12').ZG26R                         00135500
.ZG26Q           ANOP  ,                                                00135600
&ZMS             SETC  '"DSNAME='  *KGPRA* MNOTE                        00135700
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00135800
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00135900
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00136000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00136100
.ZG26R           ANOP  ,                                                00136200
.*------------------------------------------------------------------    00136300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136400
&XVOLTYPE        SETC  ''          INITIALIZE XVARIABLE                 00136500
.*-------------------------------------------------------------------   00136600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136700
.ZG30            ANOP  ,                                                00136800
                 AIF   (K'&VOLTYPE(1) LE 0).ZG30A                       00136900
&ZTLC            SETC 'SMS'                                             00137000
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG31                  00137100
&XVOLTYPE        SETC  'SMS'       SET KEYWORD                          00137200
                 AIF   (N'&VOLTYPE LE 1).ZG30A  CK NUM                  00137300
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00137400
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00137500
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00137600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00137700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00137800
.ZG30A           ANOP  ,                                                00137900
.*------------------------------------------------------------------    00138000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138100
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00138200
.ZG30A0          AIF   (K'&VOLUME LE 0).ZG30A1  OK                      00138300
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00138400
.ZG30A1          AIF   (K'&ZCVAL LE 0).ZG30A2   OK                      00138500
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00138600
&ZMS             SETC  '"VOLTYPE'  *KMEIA* MNOTE                        00138700
&ZMS             SETC  '&ZMS.=&VOLTYPE"'                                00138800
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00138900
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00139000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00139100
.ZG30A2          ANOP  ,                                                00139200
.*-------------------------------------------------------------------   00139300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139400
.ZG31            ANOP  ,                                                00139500
&ZTLC            SETC 'ANY'                                             00139600
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG35                  00139700
&XVOLTYPE        SETC  'ANY'       SET KEYWORD                          00139800
                 AIF   (N'&VOLTYPE LE 1).ZG31A  CK NUM                  00139900
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00140000
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00140100
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00140200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00140300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00140400
.ZG31A           ANOP  ,                                                00140500
.*----------------------------------------------------------------***   00140600
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00140700
                 AIF   (N'&VOLUME LE 1).ZG33A   CK NUM                  00140800
&ZMS             SETC  '"VOLUME='  *KPOSA* MNOTE                        00140900
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00141000
&ZMS             SETC  '&ZMS "VOLUME"'                                  00141100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00141200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00141300
.ZG33A           ANOP  ,                                                00141400
.*-------------------------------------------------------------------   00141500
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00141600
&ZXVOLUME        SETC  'INPUT'     SET IN/OUTPUT                        00141700
&XVOLUME         SETC  '&VOLUME(1)'             SET XVARIABLE           00141800
                 AIF   (N'&VOLUME GT 1).ZG33B   MULTI PARMS             00141900
&XVOLUME         SETC  '&VOLUME'   SET XVARIABLE                        00142000
.ZG33B           AIF   (K'&VOLUME(1) GT 0).ZG33C                        00142100
&ZXVOLUME        SETC  ''          RESET IN/OUTPUT                      00142200
&ZMS             SETC  'WHEN "ANY" IS SPECIFIED'  *KRQDA*               00142300
&ZMS             SETC  '&ZMS , "VOLUME" KEY AND ITS ARGUMENT'           00142400
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00142500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00142600
.ZG33C           ANOP  ,                                                00142700
.*-------------------------------------------------------------------   00142800
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00142900
                 AIF   (K'&ZXVOLUME LE 0).ZG33R  NOT I/O                00143000
                 AIF   ('&XVOLUME'(1,1) NE '(').ZG33R                   00143100
&ZCGPR           SETC  '&XVOLUME'(2,K'&XVOLUME-2)                       00143200
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                     00143300
                 AIF   (K'&ZCGPR GT 2).ZG33Q                            00143400
                 AIF   ('&ZCGPR' EQ '0').ZG33Q                          00143500
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00143600
                 AIF   (T'&ZCGPR NE 'N').ZG33Q  INVALID REG NAME        00143700
.ZG33P           ANOP  ,                                                00143800
                 AIF   (T'&ZCGPR NE 'N').ZG33R  NON NUMERIC             00143900
                 AIF   ('&ZCGPR' LT '2').ZG33Q                          00144000
                 AIF   ('&ZCGPR' LE '12').ZG33R                         00144100
.ZG33Q           ANOP  ,                                                00144200
&ZMS             SETC  '"VOLUME='  *KGPRA* MNOTE                        00144300
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00144400
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00144500
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00144600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00144700
.ZG33R           ANOP  ,                                                00144800
.*------------------------------------------------------------------    00144900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145000
.ZG35            ANOP  ,                                                00145100
&ZXVOLTYPE       SETC  'INPUT'     SET IN/OUTPUT                        00145200
                 AIF   (K'&XVOLTYPE GT 0).ZG35E  VALID ARG              00145300
                 AIF   (T'&VOLTYPE EQ 'O').ZG35D  OMITTED               00145400
&ZASYSLNDX       SETA  0                                                00145500
.ZG35A           ANOP  ,           POSITIONAL MACRO KEY                 00145600
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00145700
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG35C                 00145800
&ZTLC            SETC 'VOLTYPE'                                         00145900
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG35A        00146000
.ZG35B           ANOP  ,                                                00146100
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00146200
&ZMS             SETC  'THE "VOLTYPE" KEY'      *KOPTA* MNOTE           00146300
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00146400
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00146500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00146600
                 AGO   .ZG35E                                           00146700
.ZG35C           ANOP  ,                                                00146800
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00146900
&ZMS             SETC  '"VOLTYPE='              *KUKWA* MNOTE           00147000
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00147100
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00147200
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00147300
&ZMS             SETC  '&ZMS "SMS"'             VALID KEYWORD           00147400
&ZMS             SETC  '&ZMS OR "ANY".'         VALID KEYWORD           00147500
                 MNOTE 8,' &ZMS '                                       00147600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00147700
                 AGO   .ZG35E                                           00147800
.ZG35D           ANOP  ,                                                00147900
&XVOLTYPE        SETC  'SMS'       SET DEFAULT KEYWORD                  00148000
.ZG35E           ANOP  ,                                                00148100
.*-------------------------------------------------------------------   00148200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148300
.ZG36            ANOP  ,                                                00148400
&ZTLC            SETC 'DELETE'                                          00148500
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG48                  00148600
&XREQUEST        SETC  'DELETE'    SET KEYWORD                          00148700
                 AIF   (N'&REQUEST LE 1).ZG36A  CK NUM                  00148800
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00148900
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00149000
&ZMS             SETC  '&ZMS "REQUEST"'                                 00149100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00149200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00149300
.ZG36A           ANOP  ,                                                00149400
.*------------------------------------------------------------------    00149500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149600
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00149700
.ZG36A0          AIF   (K'&TEST LE 0).ZG36A1    OK                      00149800
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00149900
.ZG36A1          AIF   (K'&FORMAT LE 0).ZG36A2  OK                      00150000
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00150100
.ZG36A2          AIF   (K'&ANSAREA LE 0).ZG36A3  OK                     00150200
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00150300
.ZG36A3          AIF   (K'&ANSLEN LE 0).ZG36A4  OK                      00150400
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00150500
.ZG36A4          AIF   (K'&ZCVAL LE 0).ZG36A5   OK                      00150600
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00150700
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00150800
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00150900
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00151000
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00151100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00151200
.ZG36A5          ANOP  ,                                                00151300
.*----------------------------------------------------------------***   00151400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00151500
                 AIF   (N'&DSNAME LE 1).ZG38A   CK NUM                  00151600
&ZMS             SETC  '"DSNAME='  *KPOSA* MNOTE                        00151700
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00151800
&ZMS             SETC  '&ZMS "DSNAME"'                                  00151900
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00152000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00152100
.ZG38A           ANOP  ,                                                00152200
.*-------------------------------------------------------------------   00152300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00152400
&ZXDSNAME        SETC  'INPUT'     SET IN/OUTPUT                        00152500
&XDSNAME         SETC  '&DSNAME(1)'             SET XVARIABLE           00152600
                 AIF   (N'&DSNAME GT 1).ZG38B   MULTI PARMS             00152700
&XDSNAME         SETC  '&DSNAME'   SET XVARIABLE                        00152800
.ZG38B           AIF   (K'&DSNAME(1) GT 0).ZG38C                        00152900
&ZXDSNAME        SETC  ''          RESET IN/OUTPUT                      00153000
&ZMS             SETC  ' '         *KRQDA*                              00153100
&ZMS             SETC  '&ZMS "DSNAME" KEY AND ITS ARGUMENT'             00153200
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00153300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00153400
.ZG38C           ANOP  ,                                                00153500
.*-------------------------------------------------------------------   00153600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00153700
                 AIF   (K'&ZXDSNAME LE 0).ZG38R  NOT I/O                00153800
                 AIF   ('&XDSNAME'(1,1) NE '(').ZG38R                   00153900
&ZCGPR           SETC  '&XDSNAME'(2,K'&XDSNAME-2)                       00154000
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                     00154100
                 AIF   (K'&ZCGPR GT 2).ZG38Q                            00154200
                 AIF   ('&ZCGPR' EQ '0').ZG38Q                          00154300
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00154400
                 AIF   (T'&ZCGPR NE 'N').ZG38Q  INVALID REG NAME        00154500
.ZG38P           ANOP  ,                                                00154600
                 AIF   (T'&ZCGPR NE 'N').ZG38R  NON NUMERIC             00154700
                 AIF   ('&ZCGPR' LT '2').ZG38Q                          00154800
                 AIF   ('&ZCGPR' LE '12').ZG38R                         00154900
.ZG38Q           ANOP  ,                                                00155000
&ZMS             SETC  '"DSNAME='  *KGPRA* MNOTE                        00155100
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00155200
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00155300
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00155400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00155500
.ZG38R           ANOP  ,                                                00155600
.*------------------------------------------------------------------    00155700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155800
&XVOLTYPE        SETC  ''          INITIALIZE XVARIABLE                 00155900
.*-------------------------------------------------------------------   00156000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156100
.ZG42            ANOP  ,                                                00156200
                 AIF   (K'&VOLTYPE(1) LE 0).ZG42A                       00156300
&ZTLC            SETC 'SMS'                                             00156400
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG43                  00156500
&XVOLTYPE        SETC  'SMS'       SET KEYWORD                          00156600
                 AIF   (N'&VOLTYPE LE 1).ZG42A  CK NUM                  00156700
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00156800
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00156900
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00157000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00157100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00157200
.ZG42A           ANOP  ,                                                00157300
.*------------------------------------------------------------------    00157400
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157500
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00157600
.ZG42A0          AIF   (K'&VOLUME LE 0).ZG42A1  OK                      00157700
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00157800
.ZG42A1          AIF   (K'&ZCVAL LE 0).ZG42A2   OK                      00157900
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00158000
&ZMS             SETC  '"VOLTYPE'  *KMEIA* MNOTE                        00158100
&ZMS             SETC  '&ZMS.=&VOLTYPE"'                                00158200
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00158300
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00158400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00158500
.ZG42A2          ANOP  ,                                                00158600
.*-------------------------------------------------------------------   00158700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158800
.ZG43            ANOP  ,                                                00158900
&ZTLC            SETC 'ANY'                                             00159000
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG47                  00159100
&XVOLTYPE        SETC  'ANY'       SET KEYWORD                          00159200
                 AIF   (N'&VOLTYPE LE 1).ZG43A  CK NUM                  00159300
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00159400
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00159500
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00159600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00159700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00159800
.ZG43A           ANOP  ,                                                00159900
.*----------------------------------------------------------------***   00160000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00160100
                 AIF   (N'&VOLUME LE 1).ZG45A   CK NUM                  00160200
&ZMS             SETC  '"VOLUME='  *KPOSA* MNOTE                        00160300
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00160400
&ZMS             SETC  '&ZMS "VOLUME"'                                  00160500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00160600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00160700
.ZG45A           ANOP  ,                                                00160800
.*-------------------------------------------------------------------   00160900
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00161000
&ZXVOLUME        SETC  'INPUT'     SET IN/OUTPUT                        00161100
&XVOLUME         SETC  '&VOLUME(1)'             SET XVARIABLE           00161200
                 AIF   (N'&VOLUME GT 1).ZG45B   MULTI PARMS             00161300
&XVOLUME         SETC  '&VOLUME'   SET XVARIABLE                        00161400
.ZG45B           AIF   (K'&VOLUME(1) GT 0).ZG45C                        00161500
&ZXVOLUME        SETC  ''          RESET IN/OUTPUT                      00161600
&ZMS             SETC  'WHEN "ANY" IS SPECIFIED'  *KRQDA*               00161700
&ZMS             SETC  '&ZMS , "VOLUME" KEY AND ITS ARGUMENT'           00161800
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00161900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00162000
.ZG45C           ANOP  ,                                                00162100
.*-------------------------------------------------------------------   00162200
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00162300
                 AIF   (K'&ZXVOLUME LE 0).ZG45R  NOT I/O                00162400
                 AIF   ('&XVOLUME'(1,1) NE '(').ZG45R                   00162500
&ZCGPR           SETC  '&XVOLUME'(2,K'&XVOLUME-2)                       00162600
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG45P                     00162700
                 AIF   (K'&ZCGPR GT 2).ZG45Q                            00162800
                 AIF   ('&ZCGPR' EQ '0').ZG45Q                          00162900
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00163000
                 AIF   (T'&ZCGPR NE 'N').ZG45Q  INVALID REG NAME        00163100
.ZG45P           ANOP  ,                                                00163200
                 AIF   (T'&ZCGPR NE 'N').ZG45R  NON NUMERIC             00163300
                 AIF   ('&ZCGPR' LT '2').ZG45Q                          00163400
                 AIF   ('&ZCGPR' LE '12').ZG45R                         00163500
.ZG45Q           ANOP  ,                                                00163600
&ZMS             SETC  '"VOLUME='  *KGPRA* MNOTE                        00163700
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00163800
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00163900
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00164000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00164100
.ZG45R           ANOP  ,                                                00164200
.*------------------------------------------------------------------    00164300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00164400
.ZG47            ANOP  ,                                                00164500
&ZXVOLTYPE       SETC  'INPUT'     SET IN/OUTPUT                        00164600
                 AIF   (K'&XVOLTYPE GT 0).ZG47E  VALID ARG              00164700
                 AIF   (T'&VOLTYPE EQ 'O').ZG47D  OMITTED               00164800
&ZASYSLNDX       SETA  0                                                00164900
.ZG47A           ANOP  ,           POSITIONAL MACRO KEY                 00165000
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00165100
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG47C                 00165200
&ZTLC            SETC 'VOLTYPE'                                         00165300
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG47A        00165400
.ZG47B           ANOP  ,                                                00165500
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00165600
&ZMS             SETC  'THE "VOLTYPE" KEY'      *KOPTA* MNOTE           00165700
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00165800
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00165900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00166000
                 AGO   .ZG47E                                           00166100
.ZG47C           ANOP  ,                                                00166200
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00166300
&ZMS             SETC  '"VOLTYPE='              *KUKWA* MNOTE           00166400
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00166500
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00166600
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00166700
&ZMS             SETC  '&ZMS "SMS"'             VALID KEYWORD           00166800
&ZMS             SETC  '&ZMS OR "ANY".'         VALID KEYWORD           00166900
                 MNOTE 8,' &ZMS '                                       00167000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00167100
                 AGO   .ZG47E                                           00167200
.ZG47D           ANOP  ,                                                00167300
&XVOLTYPE        SETC  'SMS'       SET DEFAULT KEYWORD                  00167400
.ZG47E           ANOP  ,                                                00167500
.*-------------------------------------------------------------------   00167600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167700
.ZG48            ANOP  ,                                                00167800
&ZTLC            SETC 'DYNFORMAT'                                       00167900
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG49                  00168000
&XREQUEST        SETC  'DYNFORMAT'              SET KEYWORD             00168100
                 AIF   (N'&REQUEST LE 1).ZG48A  CK NUM                  00168200
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00168300
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00168400
&ZMS             SETC  '&ZMS "REQUEST"'                                 00168500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00168600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00168700
.ZG48A           ANOP  ,                                                00168800
.*------------------------------------------------------------------    00168900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169000
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00169100
.ZG48A0          AIF   (K'&DSNAME LE 0).ZG48A1  OK                      00169200
&ZCVAL           SETC '&ZCVAL DSNAME'           INCORRECT KEY USED      00169300
.ZG48A1          AIF   (K'&VOLTYPE LE 0).ZG48A2  OK                     00169400
&ZCVAL           SETC '&ZCVAL VOLTYPE'          INCORRECT KEY USED      00169500
.ZG48A2          AIF   (K'&VOLUME LE 0).ZG48A3  OK                      00169600
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00169700
.ZG48A3          AIF   (K'&TEST LE 0).ZG48A4    OK                      00169800
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00169900
.ZG48A4          AIF   (K'&FORMAT LE 0).ZG48A5  OK                      00170000
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00170100
.ZG48A5          AIF   (K'&ANSAREA LE 0).ZG48A6  OK                     00170200
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00170300
.ZG48A6          AIF   (K'&ANSLEN LE 0).ZG48A7  OK                      00170400
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00170500
.ZG48A7          AIF   (K'&ZCVAL LE 0).ZG48A8   OK                      00170600
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00170700
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00170800
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00170900
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00171000
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00171100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00171200
.ZG48A8          ANOP  ,                                                00171300
.*-------------------------------------------------------------------   00171400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171500
.ZG49            ANOP  ,                                                00171600
&ZTLC            SETC 'LIST'                                            00171700
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG56                  00171800
&XREQUEST        SETC  'LIST'      SET KEYWORD                          00171900
                 AIF   (N'&REQUEST LE 1).ZG49A  CK NUM                  00172000
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00172100
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00172200
&ZMS             SETC  '&ZMS "REQUEST"'                                 00172300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00172400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00172500
.ZG49A           ANOP  ,                                                00172600
.*------------------------------------------------------------------    00172700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00172800
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00172900
.ZG49A0          AIF   (K'&DSNAME LE 0).ZG49A1  OK                      00173000
&ZCVAL           SETC '&ZCVAL DSNAME'           INCORRECT KEY USED      00173100
.ZG49A1          AIF   (K'&VOLTYPE LE 0).ZG49A2  OK                     00173200
&ZCVAL           SETC '&ZCVAL VOLTYPE'          INCORRECT KEY USED      00173300
.ZG49A2          AIF   (K'&VOLUME LE 0).ZG49A3  OK                      00173400
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00173500
.ZG49A3          AIF   (K'&TEST LE 0).ZG49A4    OK                      00173600
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00173700
.ZG49A4          AIF   (K'&FORMAT LE 0).ZG49A5  OK                      00173800
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00173900
.ZG49A5          AIF   (K'&ZCVAL LE 0).ZG49A6   OK                      00174000
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00174100
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00174200
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00174300
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00174400
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00174500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00174600
.ZG49A6          ANOP  ,                                                00174700
.*----------------------------------------------------------------***   00174800
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00174900
                 AIF   (N'&ANSAREA LE 1).ZG51A  CK NUM                  00175000
&ZMS             SETC  '"ANSAREA='              *KPOSA* MNOTE           00175100
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00175200
&ZMS             SETC  '&ZMS "ANSAREA"'                                 00175300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00175400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00175500
.ZG51A           ANOP  ,                                                00175600
.*-------------------------------------------------------------------   00175700
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00175800
&ZXANSAREA       SETC  'OUTPUT'    SET IN/OUTPUT                        00175900
&XANSAREA        SETC  '&ANSAREA(1)'            SET XVARIABLE           00176000
                 AIF   (N'&ANSAREA GT 1).ZG51B  MULTI PARMS             00176100
&XANSAREA        SETC  '&ANSAREA'  SET XVARIABLE                        00176200
.ZG51B           AIF   (K'&ANSAREA(1) GT 0).ZG51C                       00176300
&ZXANSAREA       SETC  ''          RESET IN/OUTPUT                      00176400
&ZMS             SETC  ' '         *KRQDA*                              00176500
&ZMS             SETC  '&ZMS "ANSAREA" KEY AND ITS ARGUMENT'            00176600
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00176700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00176800
.ZG51C           ANOP  ,                                                00176900
.*-------------------------------------------------------------------   00177000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00177100
                 AIF   (K'&ZXANSAREA LE 0).ZG51R  NOT I/O               00177200
                 AIF   ('&XANSAREA'(1,1) NE '(').ZG51R                  00177300
&ZCGPR           SETC  '&XANSAREA'(2,K'&XANSAREA-2)                     00177400
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG51P                     00177500
                 AIF   (K'&ZCGPR GT 2).ZG51Q                            00177600
                 AIF   ('&ZCGPR' EQ '0').ZG51Q                          00177700
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00177800
                 AIF   (T'&ZCGPR NE 'N').ZG51Q  INVALID REG NAME        00177900
.ZG51P           ANOP  ,                                                00178000
                 AIF   (T'&ZCGPR NE 'N').ZG51R  NON NUMERIC             00178100
                 AIF   ('&ZCGPR' LT '2').ZG51Q                          00178200
                 AIF   ('&ZCGPR' LE '12').ZG51R                         00178300
.ZG51Q           ANOP  ,                                                00178400
&ZMS             SETC  '"ANSAREA='              *KGPRA* MNOTE           00178500
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00178600
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00178700
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00178800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00178900
.ZG51R           ANOP  ,                                                00179000
.*----------------------------------------------------------------***   00179100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00179200
                 AIF   (N'&ANSLEN LE 1).ZG54A   CK NUM                  00179300
&ZMS             SETC  '"ANSLEN='  *KPOSA* MNOTE                        00179400
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00179500
&ZMS             SETC  '&ZMS "ANSLEN"'                                  00179600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00179700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00179800
.ZG54A           ANOP  ,                                                00179900
.*-------------------------------------------------------------------   00180000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00180100
&ZXANSLEN        SETC  'INPUT'     SET IN/OUTPUT                        00180200
&XANSLEN         SETC  '&ANSLEN(1)'             SET XVARIABLE           00180300
                 AIF   (N'&ANSLEN GT 1).ZG54B   MULTI PARMS             00180400
&XANSLEN         SETC  '&ANSLEN'   SET XVARIABLE                        00180500
.ZG54B           AIF   (K'&ANSLEN(1) GT 0).ZG54C                        00180600
&ZXANSLEN        SETC  ''          RESET IN/OUTPUT                      00180700
&ZMS             SETC  ' '         *KRQDA*                              00180800
&ZMS             SETC  '&ZMS "ANSLEN" KEY AND ITS ARGUMENT'             00180900
                 MNOTE 8,' &ZMS ARE REQUIRED.'                          00181000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00181100
.ZG54C           ANOP  ,                                                00181200
.*-------------------------------------------------------------------   00181300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00181400
                 AIF   (K'&ZXANSLEN LE 0).ZG54R  NOT I/O                00181500
                 AIF   ('&XANSLEN'(1,1) NE '(').ZG54R                   00181600
&ZCGPR           SETC  '&XANSLEN'(2,K'&XANSLEN-2)                       00181700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG54P                     00181800
                 AIF   (K'&ZCGPR GT 2).ZG54Q                            00181900
                 AIF   ('&ZCGPR' EQ '0').ZG54Q                          00182000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00182100
                 AIF   (T'&ZCGPR NE 'N').ZG54Q  INVALID REG NAME        00182200
.ZG54P           ANOP  ,                                                00182300
                 AIF   (T'&ZCGPR NE 'N').ZG54R  NON NUMERIC             00182400
                 AIF   ('&ZCGPR' LT '2').ZG54Q                          00182500
                 AIF   ('&ZCGPR' LE '12').ZG54R                         00182600
.ZG54Q           ANOP  ,                                                00182700
&ZMS             SETC  '"ANSLEN='  *KGPRA* MNOTE                        00182800
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00182900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00183000
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00183100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00183200
.ZG54R           ANOP  ,                                                00183300
.*------------------------------------------------------------------    00183400
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183500
.ZG56            ANOP  ,                                                00183600
&ZXREQUEST       SETC  'INPUT'     SET IN/OUTPUT                        00183700
                 AIF   (K'&XREQUEST GT 0).ZG56E  VALID ARG              00183800
                 AIF   (T'&REQUEST EQ 'O').ZG56D  OMITTED               00183900
&ZASYSLNDX       SETA  0                                                00184000
.ZG56A           ANOP  ,           POSITIONAL MACRO KEY                 00184100
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00184200
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG56C                 00184300
&ZTLC            SETC 'REQUEST'                                         00184400
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG56A        00184500
.ZG56B           ANOP  ,                                                00184600
&ZXREQUEST       SETC  ''          RESET IN/OUTPUT                      00184700
&ZMS             SETC  'THE "REQUEST" KEY'      *KOPTA* MNOTE           00184800
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00184900
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00185000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00185100
                 AGO   .ZG56E                                           00185200
.ZG56C           ANOP  ,                                                00185300
&ZXREQUEST       SETC  ''          RESET IN/OUTPUT                      00185400
&ZMS             SETC  '"REQUEST='              *KUKWA* MNOTE           00185500
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00185600
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00185700
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00185800
&ZMS             SETC  '&ZMS "QUERY",'          VALID KEYWORD           00185900
&ZMS             SETC  '&ZMS "QUERYFORMAT",'    VALID KEYWORD           00186000
&ZMS             SETC  '&ZMS "ADD",'            VALID KEYWORD           00186100
&ZMS             SETC  '&ZMS "DELETE",'         VALID KEYWORD           00186200
&ZMS             SETC  '&ZMS "DYNFORMAT",'      VALID KEYWORD           00186300
&ZMS             SETC  '&ZMS OR "LIST".'        VALID KEYWORD           00186400
                 MNOTE 8,' &ZMS '                                       00186500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00186600
                 AGO   .ZG56E                                           00186700
.ZG56D           ANOP  ,                                                00186800
&XREQUEST        SETC  'QUERY'     SET DEFAULT KEYWORD                  00186900
.ZG56E           ANOP  ,                                                00187000
.*------------------------------------------------------------------    00187100
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00187200
                 AIF   (K'&REQUEST(1) GT 0).ZG56F  PARM                 00187300
&XREQUEST        SETC  ''          ENSURE NULL KEYWORD                  00187400
&ZXREQUEST       SETC  ''          RESET IN/OUTPUT                      00187500
&ZMS             SETC  'THE'                                            00187600
&ZMS             SETC  '&ZMS "REQUEST" KEY AND ITS ARGUMENT'            00187700
&ZMS             SETC  '&ZMS ARE REQUIRED.'                             00187800
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00187900
&ZMS             SETC  '&ZMS "QUERY",'          VALID KEYWORD           00188000
&ZMS             SETC  '&ZMS "QUERYFORMAT",'    VALID KEYWORD           00188100
&ZMS             SETC  '&ZMS "ADD",'            VALID KEYWORD           00188200
&ZMS             SETC  '&ZMS "DELETE",'         VALID KEYWORD           00188300
&ZMS             SETC  '&ZMS "DYNFORMAT",'      VALID KEYWORD           00188400
&ZMS             SETC  '&ZMS OR "LIST".'        VALID KEYWORD           00188500
                 MNOTE 8,' &ZMS '                                       00188600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00188700
.ZG56F           ANOP  ,                                                00188800
.*----------------------------------------------------------------***   00188900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00189000
                 AIF   (N'&RETCODE LE 1).ZG58A  CK NUM                  00189100
&ZMS             SETC  '"RETCODE='              *KPOSA* MNOTE           00189200
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00189300
&ZMS             SETC  '&ZMS "RETCODE"'                                 00189400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00189500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00189600
.ZG58A           ANOP  ,                                                00189700
.*-------------------------------------------------------------------   00189800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00189900
                 AIF   (K'&RETCODE(1) LE 0).ZG58C  NO PARM              00190000
&ZXRETCODE       SETC  'OUTPUT'    SET OUTPUT                           00190100
&XRETCODE        SETC  '&RETCODE(1)'            SET XVARIABLE           00190200
                 AIF   (N'&RETCODE GT 1).ZG58C                          00190300
&XRETCODE        SETC  '&RETCODE'  SET XVARIABLE                        00190400
.ZG58C           ANOP  ,                                                00190500
.*-------------------------------------------------------------------   00190600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00190700
                 AIF   (K'&ZXRETCODE LE 0).ZG58R  NOT I/O               00190800
                 AIF   ('&XRETCODE'(1,1) NE '(').ZG58R                  00190900
&ZCGPR           SETC  '&XRETCODE'(2,K'&XRETCODE-2)                     00191000
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG58P                     00191100
                 AIF   (K'&ZCGPR GT 2).ZG58Q                            00191200
                 AIF   ('&ZCGPR' EQ '0').ZG58Q                          00191300
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00191400
                 AIF   (T'&ZCGPR NE 'N').ZG58Q  INVALID REG NAME        00191500
.ZG58P           ANOP  ,                                                00191600
                 AIF   (T'&ZCGPR NE 'N').ZG58R  NON NUMERIC             00191700
                 AIF   ('&ZCGPR' LT '2').ZG58Q                          00191800
                 AIF   ('&ZCGPR' LE '12').ZG58R                         00191900
.ZG58Q           ANOP  ,                                                00192000
&ZMS             SETC  '"RETCODE='              *KGPRA* MNOTE           00192100
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00192200
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00192300
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00192400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00192500
.ZG58R           ANOP  ,                                                00192600
.*----------------------------------------------------------------***   00192700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00192800
                 AIF   (N'&RSNCODE LE 1).ZG61A  CK NUM                  00192900
&ZMS             SETC  '"RSNCODE='              *KPOSA* MNOTE           00193000
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00193100
&ZMS             SETC  '&ZMS "RSNCODE"'                                 00193200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00193300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00193400
.ZG61A           ANOP  ,                                                00193500
.*-------------------------------------------------------------------   00193600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00193700
                 AIF   (K'&RSNCODE(1) LE 0).ZG61C  NO PARM              00193800
&ZXRSNCODE       SETC  'OUTPUT'    SET OUTPUT                           00193900
&XRSNCODE        SETC  '&RSNCODE(1)'            SET XVARIABLE           00194000
                 AIF   (N'&RSNCODE GT 1).ZG61C                          00194100
&XRSNCODE        SETC  '&RSNCODE'  SET XVARIABLE                        00194200
.ZG61C           ANOP  ,                                                00194300
.*-------------------------------------------------------------------   00194400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00194500
                 AIF   (K'&ZXRSNCODE LE 0).ZG61R  NOT I/O               00194600
                 AIF   ('&XRSNCODE'(1,1) NE '(').ZG61R                  00194700
&ZCGPR           SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                     00194800
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                     00194900
                 AIF   (K'&ZCGPR GT 2).ZG61Q                            00195000
                 AIF   ('&ZCGPR' EQ '0').ZG61Q                          00195100
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00195200
                 AIF   (T'&ZCGPR NE 'N').ZG61Q  INVALID REG NAME        00195300
.ZG61P           ANOP  ,                                                00195400
                 AIF   (T'&ZCGPR NE 'N').ZG61R  NON NUMERIC             00195500
                 AIF   ('&ZCGPR' LT '2').ZG61Q                          00195600
                 AIF   ('&ZCGPR' LE '12').ZG61R                         00195700
.ZG61Q           ANOP  ,                                                00195800
&ZMS             SETC  '"RSNCODE='              *KGPRA* MNOTE           00195900
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00196000
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00196100
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00196200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00196300
.ZG61R           ANOP  ,                                                00196400
.******************************************************************     00196500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00196600
.******************************************************************     00196700
                 ACTR  10000                                            00196800
.*----------------------------------------------------------------***   00196900
.***AH.P02 EXTRA POSITIONALS                                            00197000
                 AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS             00197100
&ZCVAL           SETC  ''          ERROR FIELD                          00197200
&ZAWRK           SETA  0           POSITIONAL NUMBER                    00197300
.ZGLIST2         ANOP  ,                                                00197400
&ZAWRK           SETA  &ZAWRK+1    NEXT POSITIONAL                      00197500
                 AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE             00197600
&ZCVAL           SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                  00197700
                 AGO   .ZGLIST2                                         00197800
.*                                                                      00197900
.ZGLIST3         ANOP  ,                                                00198000
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)    STRIP COMMA             00198100
&ZMS             SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE         00198200
&ZMS             SETC  '&ZMS "&ZCVAL"'                                  00198300
&ZMS             SETC  '&ZMS CANNOT BE USED.'                           00198400
&ZMS             SETC  '&ZMS NO POSITIONAL ARGUMENTS'                   00198500
                 MNOTE 8,' &ZMS ARE ALLOWED.'                           00198600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00198700
.ZGLISTX         ANOP  ,                                                00198800
&ZASYSLNDX       SETA  0                                                00198900
.*-------------------------------------------------------------------   00199000
.***AG.MF04 MF=(SLE)                                                    00199100
.ZGMFX           ANOP  ,           END OF FULL SYNTAX CHECK             00199200
.*******************************************************************    00199300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00199400
.*******************************************************************    00199500
                 AIF   (&ZMACRET NE 0).ZLX2     ERROR DETECTED          00199600
.*******************************************************************    00199700
.***AE.01  START OF CSVAPF MACRO CODE                                   00199800
.*******************************************************************    00199900
                 LCLC  &M0M0001                 NAME                    00200000
&M0M0001         SETC  '&XLABEL'                SET NAME                00200100
                 AIF   (K'&XLABEL NE 0).XLAB2                           00200200
&M0M0001         SETC  'M00M&SYSNDX'            DEFAULT NAME            00200300
.*                                                                      00200400
.XLAB2           ANOP  ,                                                00200500
&M0M0001 DS    0H                             CSVAPF-0                  00200600
.*******************************************************************    00200700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00200800
.*******************************************************************    00200900
              PUSH  PRINT                                               00201000
                 AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON       00201100
                 PRINT OFF         ++ PR01                              00201200
                 AGO   .ZPRNTXX                                         00201300
.ZPRINTX         PRINT ON                                               00201400
.ZPRNTXX         ANOP  ,                                                00201500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00201600
         LCLC  &T2,&T1                                                  00201700
         LCLA  &A1                                                      00201800
         AIF   ('&REQUEST' NE 'QUERYFORMAT').NOQF                       00201900
    AIF ('&MF' EQ '' AND '&RETCODE' EQ '' AND '&RSNCODE' EQ '').OKRET   00202000
&T1      SETC  'MF, RETCODE AND RSNCODE ARE NOT VALID WITH '            00202100
&T1      SETC  '&T1.REQUEST=QUERYFORMAT'                                00202200
         MNOTE 4,'&T1'                                                  00202300
.OKRET   ANOP                                                           00202400
         L     15,16(0,0)              GET CVT                          00202500
         L     15,140(15,0)            GET ECVT                         00202600
         L     15,228(15,0)                                             00202700
         AIF   ('&SYSASCE' EQ 'P').NOAR                                 00202800
         LAE   15,0(15,0)              CLEAR AR15                       00202900
.NOAR    ANOP                                                           00203000
         AIF   ('&FORMAT'(1,1) NE '(').LREG  Not a reg, branch          00203100
&T1      SETC  '&FORMAT'(2,K'&FORMAT-2)  Isolate reg number             00203200
&T1      SETC  '0(1,&T1.)'             Target expression                00203300
         AGO   .MREG                                                    00203400
.LREG    ANOP                          Not a reg                        00203500
&A1      SETA  K'&FORMAT               Length of expression             00203600
         AIF   ('&FORMAT'(&A1,1) NE ')').NOTRX  Branch if not RX        00203700
&A2      SETA  2                                                        00203800
.OREG    ANOP                          Loop to find open paren          00203900
         AIF   (&A2 GE &A1).NOTRX      Reached end, treat as non-RX     00204000
         AIF   ('&FORMAT'(&A2,1) NE '(').NREG  Not open paren, branch   00204100
&T1      SETC  '&FORMAT'(1,&A2).'1'.','    Found paren                  00204200
&T1      SETC  '&T1'.'&FORMAT'(&A2+1,&A1-&A2)  Create expression        00204300
         AGO   .MREG                                                    00204400
.NREG    ANOP                          Continue loop                    00204500
&A2      SETA  &A2+1                   Next character                   00204600
         AGO   .OREG                   Repeat                           00204700
.NOTRX   ANOP                          Not an RX-address                00204800
&T1      SETC  '&FORMAT(1).(1)'        Get expression                   00204900
.MREG    ANOP                          Produce resulting statement      00205000
         MVC   &T1,25(15)              GET FORMAT VALUE                 00205100
         MEXIT                                                          00205200
.NOQF    ANOP                                                           00205300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00205400
.********************************************************************   00205500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00205600
.********************************************************************   00205700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00205800
                      LCLA  &ZOPN1         INVOCATION INDEX             00205900
                      LCLC  &ZOPL(4095)    LABEL                        00206000
                      LCLC  &ZOPO(4095)    OPERATION                    00206100
                      LCLC  &ZOPV(4095)    VALUE                        00206200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00206300
.*                                                                      00206400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00206500
.******************************************************************     00206600
.***AL.L10 CSVAPF FMT=LIST MF=S|L PARAMETERS                            00206700
.******************************************************************     00206800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00206900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00207000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00207100
&XMFATTR              SETC  '0D'                                        00207200
.*                                                                      00207300
&ZOPN                 SETA  &ZOPN+1                                     00207400
&ZOPL(&ZOPN)          SETC  ' '                                         00207500
&ZOPO(&ZOPN)          SETC  'B'                                         00207600
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00207700
&ZOPD(&ZOPN)          SETC  '++ CSVAPF ARG PARMS'                       00207800
.*                                                                      00207900
&ZOPN                 SETA  &ZOPN+1                                     00208000
&ZOPL(&ZOPN)          SETC  ' '                                         00208100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00208200
&ZOPV(&ZOPN)          SETC  '1'                                         00208300
&ZOPD(&ZOPN)          SETC  ' '                                         00208400
.*                                                                      00208500
.ZLMFSL2              ANOP  ,                                           00208600
.*-------------------------------------------------------------------   00208700
.***AM.L01  CSVAPF FMT=LIST PARAMETERS                                  00208800
&ZOPN                 SETA &ZOPN+1                                      00208900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00209000
&ZOPO(&ZOPN)          SETC 'DS'                                         00209100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00209200
&ZOPD(&ZOPN)          SETC '++ CSVAPF PARM LIST'                        00209300
.*-------------------------------------------------------------------   00209400
.***AM.L02 XVERSION XL1                                                 00209500
&ZOPN                 SETA &ZOPN+1                                      00209600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00209700
&ZOPO(&ZOPN)          SETC 'DS'                                         00209800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00209900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00210000
.*-------------------------------------------------------------------   00210100
.***AM.L05 XREQUEST XL1                                                 00210200
&ZOPN                 SETA &ZOPN+1                                      00210300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00210400
&ZOPO(&ZOPN)          SETC 'DS'                                         00210500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00210600
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00210700
.*                                                                      00210800
&ZOPN                 SETA  &ZOPN+1                                     00210900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_QUERY'                  00211000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00211100
&ZOPV(&ZOPN)          SETC  '0'                                         00211200
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00211300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).QUERY'                        00211400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00211500
.*                                                                      00211600
&ZOPN                 SETA  &ZOPN+1                                     00211700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_ADD'                    00211800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00211900
&ZOPV(&ZOPN)          SETC  '1'                                         00212000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00212100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ADD'                          00212200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00212300
.*                                                                      00212400
&ZOPN                 SETA  &ZOPN+1                                     00212500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_DELETE'                 00212600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00212700
&ZOPV(&ZOPN)          SETC  '2'                                         00212800
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00212900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DELETE'                       00213000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00213100
.*                                                                      00213200
&ZOPN                 SETA  &ZOPN+1                                     00213300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_LIST'                   00213400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00213500
&ZOPV(&ZOPN)          SETC  '3'                                         00213600
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00213700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LIST'                         00213800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00213900
.*                                                                      00214000
&ZOPN                 SETA  &ZOPN+1                                     00214100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_DYNFORMAT'              00214200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00214300
&ZOPV(&ZOPN)          SETC  '4'                                         00214400
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00214500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DYNFORMAT'                    00214600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00214700
.*-------------------------------------------------------------------   00214800
.***AM.L03 XFLAGS BL.8                                                  00214900
&ZOPN                 SETA &ZOPN+1                                      00215000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00215100
&ZOPO(&ZOPN)          SETC 'DS'                                         00215200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00215300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00215400
.*                                                                      00215500
&ZOPN                 SETA  &ZOPN+1                                     00215600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XVOLTYPE_ANY'                    00215700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00215800
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00215900
&ZOPD(&ZOPN)          SETC  '++ XVOLTYPE.'                              00216000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ANY'                          00216100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00216200
.*-------------------------------------------------------------------   00216300
.***AM.L09  XRSV0001 CL1                                                00216400
&ZOPN                 SETA &ZOPN+1                                      00216500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00216600
&ZOPO(&ZOPN)          SETC 'DS'                                         00216700
&ZOPV(&ZOPN)          SETC 'CL1'                                        00216800
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00216900
.*-------------------------------------------------------------------   00217000
.***AM.L09  XDSNAME CL44                                                00217100
&ZOPN                 SETA &ZOPN+1                                      00217200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDSNAME'                          00217300
&ZOPO(&ZOPN)          SETC 'DS'                                         00217400
&ZOPV(&ZOPN)          SETC 'CL44'                                       00217500
&ZOPD(&ZOPN)          SETC '++ &ZXDSNAME  XDSNAME'                      00217600
.*-------------------------------------------------------------------   00217700
.***AM.L09  XVOLUME CL6                                                 00217800
&ZOPN                 SETA &ZOPN+1                                      00217900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVOLUME'                          00218000
&ZOPO(&ZOPN)          SETC 'DS'                                         00218100
&ZOPV(&ZOPN)          SETC 'CL6'                                        00218200
&ZOPD(&ZOPN)          SETC '++ &ZXVOLUME  XVOLUME'                      00218300
.*-------------------------------------------------------------------   00218400
.***AM.L09  XRSV0002 CL2                                                00218500
&ZOPN                 SETA &ZOPN+1                                      00218600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00218700
&ZOPO(&ZOPN)          SETC 'DS'                                         00218800
&ZOPV(&ZOPN)          SETC 'CL2'                                        00218900
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00219000
.*-------------------------------------------------------------------   00219100
.***AM.L09 ADDR XANSAREA A                                              00219200
&ZOPN                 SETA &ZOPN+1                                      00219300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ADDR'                    00219400
&ZOPO(&ZOPN)          SETC 'DS'                                         00219500
&ZOPV(&ZOPN)          SETC 'A'                                          00219600
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ADDR XANSAREA'                00219700
.*-------------------------------------------------------------------   00219800
.***AM.L09 ALET XANSAREA F                                              00219900
&ZOPN                 SETA &ZOPN+1                                      00220000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ALET'                    00220100
&ZOPO(&ZOPN)          SETC 'DS'                                         00220200
&ZOPV(&ZOPN)          SETC 'F'                                          00220300
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ALET XANSAREA'                00220400
.*-------------------------------------------------------------------   00220500
.***AM.L09  XANSLEN F                                                   00220600
&ZOPN                 SETA &ZOPN+1                                      00220700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00220800
&ZOPO(&ZOPN)          SETC 'DS'                                         00220900
&ZOPV(&ZOPN)          SETC 'F'                                          00221000
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN  XANSLEN'                      00221100
.*-------------------------------------------------------------------   00221200
.***AM.L10 END OF CSVAPF LIST PARAMETERS                                00221300
&ZOPN                 SETA &ZOPN+1                                      00221400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00221500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00221600
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00221700
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00221800
.*                                                                      00221900
&ZOPN                 SETA &ZOPN+1                                      00222000
&ZOPL(&ZOPN)          SETC ' '                                          00222100
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00222200
&ZOPV(&ZOPN)          SETC '1'                                          00222300
&ZOPD(&ZOPN)          SETC ' '                                          00222400
.*-------------------------------------------------------------------   00222500
.***AL.L12 CSVAPF FMT=LIST MF=S|L PARAMETERS                            00222600
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00222700
.*                                                                      00222800
&ZOPN                 SETA  &ZOPN+1                                     00222900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00223000
&ZOPO(&ZOPN)          SETC  'DC'                                        00223100
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00223200
&ZOPD(&ZOPN)          SETC  '++ CSVAPF ARG PARMS'                       00223300
.*                                                                      00223400
.ZLMFSLX              ANOP  ,                                           00223500
.*-------------------------------------------------------------------   00223600
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00223700
&ZPLLEN               SETA 68                                           00223800
.*                                                                      00223900
.******************************************************************     00224000
.***AI.L01 CSVAPF FMT=LIST FILL IN PARAMETER AREA                       00224100
.******************************************************************     00224200
                      ACTR  10000                                       00224300
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00224400
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00224500
&ZCVAL                SETC  'LAE'          XAX MODE                     00224600
.ZIMFXA               ANOP ,                                            00224700
.*                                                                      00224800
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00224900
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00225000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00225100
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00225200
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00225300
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00225400
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00225500
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00225600
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00225700
&ZOPN                 SETA  &ZOPN+1                                     00225800
&ZOPL(&ZOPN)          SETC  ' '                                         00225900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00226000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00226100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00226200
                      AGO   .ZIMFNX                                     00226300
.*                                                                      00226400
.ZIMFN2               ANOP ,                                            00226500
&ZOPN                 SETA  &ZOPN+1                                     00226600
&ZOPL(&ZOPN)          SETC  ' '                                         00226700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00226800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00226900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00227000
.ZIMFNX               ANOP ,                                            00227100
.********************************************************************   00227200
.***AI.L02 CSVAPF FMT=LIST INITIALIZE PARAMETER AREA                    00227300
.********************************************************************   00227400
.***AI.L03 MF=(SLE)                                                     00227500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00227600
.*                                                                      00227700
&ZOPN                 SETA  &ZOPN+1                                     00227800
&ZOPL(&ZOPN)          SETC  ' '                                         00227900
&ZOPO(&ZOPN)          SETC  'XC'                                        00228000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00228100
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00228200
.ZIMFLX               ANOP  ,                                           00228300
.*-------------------------------------------------------------------   00228400
.***AI.L07 XREQUEST AL1                                                 00228500
&ZW                   SETC  ''                                          00228600
.*-------------------------------------------------------------------   00228700
.***AI.L15 XREQUEST "QUERY" AL1                                         00228800
         AIF   ('&XREQUEST' NE 'QUERY').ZI3A                            00228900
&ZW                   SETC  '0'                                         00229000
.ZI3A                 ANOP  ,                                           00229100
.*-------------------------------------------------------------------   00229200
.***AI.L15 XREQUEST "ADD" AL1                                           00229300
         AIF   ('&XREQUEST' NE 'ADD').ZI4A                              00229400
&ZW                   SETC  '1'                                         00229500
.ZI4A                 ANOP  ,                                           00229600
.*-------------------------------------------------------------------   00229700
.***AI.L15 XREQUEST "DELETE" AL1                                        00229800
         AIF   ('&XREQUEST' NE 'DELETE').ZI5A                           00229900
&ZW                   SETC  '2'                                         00230000
.ZI5A                 ANOP  ,                                           00230100
.*-------------------------------------------------------------------   00230200
.***AI.L15 XREQUEST "LIST" AL1                                          00230300
         AIF   ('&XREQUEST' NE 'LIST').ZI6A                             00230400
&ZW                   SETC  '3'                                         00230500
.ZI6A                 ANOP  ,                                           00230600
.*-------------------------------------------------------------------   00230700
.***AI.L15 XREQUEST "DYNFORMAT" AL1                                     00230800
         AIF   ('&XREQUEST' NE 'DYNFORMAT').ZI7A                        00230900
&ZW                   SETC  '4'                                         00231000
.ZI7A                 ANOP  ,                                           00231100
.*-------------------------------------------------------------------   00231200
.***AI.L17 XREQUEST AL1                                                 00231300
                      AIF   ('&ZW' EQ '0').ZI7B                         00231400
                      AIF   ('&ZW' EQ '').ZI7B                          00231500
.*                                                                      00231600
&ZOPN                 SETA  &ZOPN+1                                     00231700
&ZOPL(&ZOPN)          SETC  ' '                                         00231800
&ZOPO(&ZOPN)          SETC  'MVI'                                       00231900
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  00232000
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST AL1'                00232100
.ZI7B                 ANOP  ,                                           00232200
.*-------------------------------------------------------------------   00232300
.***AI.L05 XFLAGS BL1                                                   00232400
&ZW                   SETC  ''                                          00232500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00232600
.*-------------------------------------------------------------------   00232700
.***AI.L08 XFLAGS "ANY"                                                 00232800
.***      BL1'XXXXXXX1'                                                 00232900
         AIF   ('&XVOLTYPE' NE 'ANY').ZI9A                              00233000
&ZW                   SETC  '&ZW.00000001'                              00233100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00233200
                      AGO   .ZI9C                                       00233300
.*                                                                      00233400
.ZI9A                 ANOP  ,                                           00233500
&ZW                   SETC  '&ZW.00000000'                              00233600
.ZI9C                 ANOP  ,                                           00233700
.*-------------------------------------------------------------------   00233800
.***AI.L11 XFLAGS BL1                                                   00233900
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00234000
&ZOPN                 SETA  &ZOPN+1                                     00234100
&ZOPL(&ZOPN)          SETC  ' '                                         00234200
&ZOPO(&ZOPN)          SETC  'OI'                                        00234300
&ZOPV(&ZOPN)          SETC  '2(1),B''&ZW'''                             00234400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00234500
.ZI9E                 ANOP  ,                                           00234600
.*-------------------------------------------------------------------   00234700
.***AI.L25  XDSNAME CL44                                                00234800
                      AIF   ('&ZXDSNAME' EQ '').ZI11E  NOT USED         00234900
                      AIF   ('&ZXDSNAME' EQ 'OUTPUT').ZI11E             00235000
&ZCGPR                SETC  '&XDSNAME'                                  00235100
.*                                                                      00235200
                      AIF   ('&XDSNAME'(1,1) NE '(').ZI11B              00235300
&ZCGPR   SETC  '0('.'&XDSNAME'(2,K'&XDSNAME-2).')'                      00235400
.ZI11B                ANOP  ,                                           00235500
.*                                                                      00235600
&ZOPN                 SETA  &ZOPN+1                                     00235700
&ZOPL(&ZOPN)          SETC  ' '                                         00235800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00235900
&ZOPV(&ZOPN)          SETC  '4(44,1),&ZCGPR'                            00236000
&ZOPD(&ZOPN)          SETC  '++ &ZXDSNAME XDSNAME CL44'                 00236100
.*                                                                      00236200
.ZI11E                ANOP  ,                                           00236300
.*-------------------------------------------------------------------   00236400
.***AI.L25  XVOLUME CL6                                                 00236500
                      AIF   ('&ZXVOLUME' EQ '').ZI12E  NOT USED         00236600
                      AIF   ('&ZXVOLUME' EQ 'OUTPUT').ZI12E             00236700
&ZCGPR                SETC  '&XVOLUME'                                  00236800
.*                                                                      00236900
                      AIF   ('&XVOLUME'(1,1) NE '(').ZI12B              00237000
&ZCGPR   SETC  '0('.'&XVOLUME'(2,K'&XVOLUME-2).')'                      00237100
.ZI12B                ANOP  ,                                           00237200
.*                                                                      00237300
&ZOPN                 SETA  &ZOPN+1                                     00237400
&ZOPL(&ZOPN)          SETC  ' '                                         00237500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00237600
&ZOPV(&ZOPN)          SETC  '48(6,1),&ZCGPR'                            00237700
&ZOPD(&ZOPN)          SETC  '++ &ZXVOLUME XVOLUME CL6'                  00237800
.*                                                                      00237900
.ZI12E                ANOP  ,                                           00238000
.*-------------------------------------------------------------------   00238100
.***AI.L19 ADDR XANSAREA A                                              00238200
                      AIF   ('&ZXANSAREA' EQ '').ZI14H  NOT USED        00238300
&ZCLNG                SETC  '&XANSAREA'                                 00238400
&ZCGPR                SETC  '14'                                        00238500
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI14F  IN GPR                  00238600
.*                                                                      00238700
&ZOPN                 SETA  &ZOPN+1                                     00238800
&ZOPL(&ZOPN)          SETC  ' '                                         00238900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00239000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00239100
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA A'                  00239200
.*                                                                      00239300
                      AGO   .ZI14G                                      00239400
.*                                                                      00239500
.ZI14F                ANOP  ,                                           00239600
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00239700
.*                                                                      00239800
.ZI14G                ANOP  ,                                           00239900
.*                                                                      00240000
&ZOPN                 SETA  &ZOPN+1                                     00240100
&ZOPL(&ZOPN)          SETC  ' '                                         00240200
&ZOPO(&ZOPN)          SETC  'ST'                                        00240300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,56(,1)'                             00240400
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA A'                  00240500
.*                                                                      00240600
.ZI14H                ANOP  ,                                           00240700
.*-------------------------------------------------------------------   00240800
.***AI.L23 ALET XANSAREA F                                              00240900
         AIF   ('&ZXANSAREA' EQ '').ZI15G  NOT USED                     00241000
         AIF   ('&SYSASCE' EQ 'P').ZI15G   SYSSTATE PRIMARY             00241100
&ZCLNG                SETC  '&XANSAREA'                                 00241200
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI15E  IN AR                   00241300
.*                                                                      00241400
&ZCGPR                SETC  '14'                                        00241500
                      AGO   .ZI15F                                      00241600
.*                                                                      00241700
.ZI15E                ANOP  ,                                           00241800
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00241900
.*                                                                      00242000
.ZI15F                ANOP  ,                                           00242100
.*                                                                      00242200
&ZOPN                 SETA  &ZOPN+1                                     00242300
&ZOPL(&ZOPN)          SETC  ' '                                         00242400
&ZOPO(&ZOPN)          SETC  'STAM'                                      00242500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,60(1)'                       00242600
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA F'                  00242700
.*                                                                      00242800
.ZI15G                ANOP  ,                                           00242900
.*-------------------------------------------------------------------   00243000
.***AI.L25  XANSLEN F                                                   00243100
                      AIF   ('&ZXANSLEN' EQ '').ZI16E  NOT USED         00243200
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI16E             00243300
&ZCGPR                SETC  '&XANSLEN'                                  00243400
.*                                                                      00243500
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI16B              00243600
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00243700
                      AGO   .ZI16D                                      00243800
.ZI16B                ANOP  ,                                           00243900
.*                                                                      00244000
&ZC                   SETC  '&XANSLEN'(1,1)                             00244100
                      AIF   (T'&ZC NE 'N').ZI16D                        00244200
&ZC                   SETC  '&XANSLEN'                                  00244300
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI16D           00244400
&ZCGPR                SETC  '=FL4''&XANSLEN'''                          00244500
.*                                                                      00244600
.ZI16D                ANOP  ,                                           00244700
.*                                                                      00244800
&ZOPN                 SETA  &ZOPN+1                                     00244900
&ZOPL(&ZOPN)          SETC  ' '                                         00245000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00245100
&ZOPV(&ZOPN)          SETC  '64(4,1),&ZCGPR'                            00245200
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN F'                    00245300
.*                                                                      00245400
.ZI16E                ANOP  ,                                           00245500
.*-------------------------------------------------------------------   00245600
&ZOPN1                SETA &ZOPN                                        00245700
.*******************************************************************    00245800
.***  PROCESS CSVAPF OUTPUT PARAMETERS                                  00245900
.*******************************************************************    00246000
                      ACTR  10000                                       00246100
.*******************************************************************    00246200
.***AO.X02  RETURN CODE PROCESSING                                      00246300
.*******************************************************************    00246400
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00246500
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00246600
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00246700
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00246800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00246900
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00247000
&ZOPN                 SETA  &ZOPN+1                                     00247100
&ZOPL(&ZOPN)          SETC  ' '                                         00247200
&ZOPO(&ZOPN)          SETC  'ST'                                        00247300
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00247400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00247500
                      AGO   .ZMRETX                                     00247600
.*                                                                      00247700
.ZMRET2               ANOP  ,                                           00247800
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00247900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00248000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00248100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00248200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00248300
&ZOPN                 SETA  &ZOPN+1                                     00248400
&ZOPL(&ZOPN)          SETC  ' '                                         00248500
&ZOPO(&ZOPN)          SETC  'LR'                                        00248600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00248700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00248800
.ZMRETX               ANOP  ,                                           00248900
.*******************************************************************    00249000
.***AO.X03  REASON CODE PROCESSING                                      00249100
.*******************************************************************    00249200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00249300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00249400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00249500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00249600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00249700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00249800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00249900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00250000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00250100
&ZOPN                 SETA  &ZOPN+1                                     00250200
&ZOPL(&ZOPN)          SETC  ' '                                         00250300
&ZOPO(&ZOPN)          SETC  'ST'                                        00250400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00250500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00250600
                      AGO   .ZMRSNX                                     00250700
.*                                                                      00250800
.ZMRSN2               ANOP  ,                                           00250900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00251000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00251100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00251200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00251300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00251400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00251500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00251600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00251700
&ZOPN                 SETA  &ZOPN+1                                     00251800
&ZOPL(&ZOPN)          SETC  ' '                                         00251900
&ZOPO(&ZOPN)          SETC  'LR'                                        00252000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00252100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00252200
.ZMRSNX               ANOP  ,                                           00252300
.*******************************************************************    00252400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00252500
.*******************************************************************    00252600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00252700
.*******************************************************************    00252800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00252900
.*******************************************************************    00253000
                      ACTR  10000                                       00253100
.*                                                                      00253200
                      LCLA  &ZLC           COLUMN POSITION              00253300
                      LCLA  &ZOPX          LIST TABLE INDEX             00253400
                      LCLC  &ZLL           LABEL                        00253500
                      LCLC  &ZLOP          OPERATION                    00253600
                      LCLC  &ZLV           VALUE                        00253700
                      LCLC  &ZLD           DESCRIPTION                  00253800
.*                                                                      00253900
&ZOPX                 SETA  1                                           00254000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00254100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00254200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00254300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00254400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00254500
                      AIF   (K'&ZLD LE 0).ZL5                           00254600
&ZLC                  SETA  35             COMMENT COLUMN               00254700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00254800
&ZLC                  SETA  33             COMMMENT COLUMN              00254900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00255000
&ZLV                  SETC  '&ZLV'.' '                                  00255100
                      AGO   .ZL3                                        00255200
.*                                                                      00255300
.ZL4                  ANOP  ,                                           00255400
&ZLV                  SETC  '&ZLV'.' '                                  00255500
.ZL5                  ANOP  ,                                           00255600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00255700
.*                                                                      00255800
&ZLL     &ZLOP &ZLV                                                     00255900
.*                                                                      00256000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00256100
                      AGO   .ZL2           CONTINUE LOOPING             00256200
.*                                                                      00256300
.ZLX                  ANOP  ,                                           00256400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00256500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00256600
         AIF   ('&REQUEST' EQ 'QUERY').QUERLINK                         00256700
         L     14,16(0,0)              GET CVT ADDRESS                  00256800
         L     14,772(14,0)            GET SFT ADDRESS                  00256900
         L     14,356(14,0)            GET LX/EX FOR SERVICE ROUTINE    00257000
         PC    0(14)                                                    00257100
         AGO   .ENDLINK                                                 00257200
.QUERLINK ANOP                                                          00257300
         L     15,16(0,0)              GET CVT ADDRESS                  00257400
         L     15,140(15,0)            GET ECVT ADDRESS                 00257500
         L     15,228(15,0)                                             00257600
         AIF   ('&TEST' NE 'YES').DOBALR                                00257700
         LTR   15,15                   SEE IF ROUTINE EXISTS            00257800
         BZ    C&SYSNDX                NO, AVOID CALL                   00257900
         L     15,8(15,0)              GET APF QUERY ADDRESS            00258000
         LTR   15,15                   SEE IF ROUTINE EXISTS            00258100
         BNZ   A&SYSNDX                YES, CALL IT                     00258200
C&SYSNDX DS    0H                      NO CALL NEEDED                   00258300
         LA    15,4                    INDICATE NOT IN LIST             00258400
         LA    0,X'0402'               REASON CODE=0                    00258500
         B     B&SYSNDX                                                 00258600
A&SYSNDX DS    0H                      NEED TO CALL                     00258700
         BALR  14,15                   CALL ROUTINE                     00258800
B&SYSNDX DS    0H                                                       00258900
         AGO   .ENDBALR                                                 00259000
.DOBALR  ANOP                                                           00259100
         L     15,8(15,0)              GET APF QUERY ADDRESS            00259200
         BALR  14,15                   CALL ROUTINE                     00259300
.ENDBALR ANOP                                                           00259400
.ENDLINK ANOP                                                           00259500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00259600
.ZLINKX               ANOP  ,                                           00259700
.*******************************************************************    00259800
.***AP.X01  FORMAT GENERATED CODE                                       00259900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00260000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00260100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00260200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00260300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00260400
                      AIF   (K'&ZLD LE 0).ZL51                          00260500
&ZLC                  SETA  35             COMMENT COLUMN               00260600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00260700
&ZLC                  SETA  33             COMMENT COLUMN               00260800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00260900
&ZLV                  SETC  '&ZLV'.' '                                  00261000
                      AGO   .ZL31                                       00261100
.*                                                                      00261200
.ZL41                 ANOP  ,                                           00261300
&ZLV                  SETC  '&ZLV'.' '                                  00261400
.ZL51                 ANOP  ,                                           00261500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00261600
.*                                                                      00261700
&ZLL     &ZLOP &ZLV                                                     00261800
.*                                                                      00261900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00262000
                      AGO   .ZL21          CONTINUE LOOPING             00262100
.*                                                                      00262200
.ZLX1                 ANOP  ,                                           00262300
.*******************************************************************    00262400
.***AP.X02  END OF CSVAPF MACRO                                         00262500
&ZCSVAPF              SETC  'YES'          SET CSVAPF USED              00262600
         POP   PRINT                                                    00262700
*                                            CSVAPF-0                   00262800
         SPACE 1                                                        00262900
.ZLX2                 ANOP  ,                                           00263000
         MEND                                                           00263100
**********************************************************************/ 00263200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00263300
*%CSVAPF: MACRO KEYS(REQUEST,DSNAME,VOLTYPE,VOLUME,TEST,FORMAT,         00263400
*                 ANSAREA,ANSLEN,RETCODE,RSNCODE,MF);                   00263500
*  ANS('?'||MACLABEL||' '||'CSVAPFP '||MACLIST||                        00263600
*         ' '||MACKEYS||';') COL(MACLMAR);                              00263700
*%END CSVAPF;                                                           00263800
