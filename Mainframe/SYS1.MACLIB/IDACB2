         MACRO                                                          00050000
         IDACB2 &CALLER=GEN,&BLKTYPE=,&MF=,   *** INTERNAL KEYWORDS ***-00100000
               &LABEL=,&SHRPOOL=,&LOC=,                            @L9C-00150000
               &AM=,                                            X04SVHS-00200000
               &ACBLEN=,&ATRB=,&AVSPAC=,&BUFND=,   *** ACB KEYWORDS ***-00250000
               &BUFNI=,&BUFNO=,&BUFSP=,&CINV=,&DDNAME=,&ENDRBA=,       -00300000
               &ERROR=,&EXLST=,&FS=,&KEYLEN=,&LRECL=,&JFCB=,   @XM01140-00350000
               &MACRF=,&NCIS=,&NDELR=,&NEXCP=,&NEXT=,&NINSR=,&NIXL=,   -00400000
               &NLOGR=,&NRETR=,&NSSS=,&NUPDR=,&OFLAGS=,&PASSWD=,&RKP=, -00450000
               &BSTRNO=,&CRA=,&OPENOBJ=,&AIXRKP=,               X04SVHS-00500000
               &MAREA=,&MLEN=,                                  X04SVHS-00550000
               &STRNO=,&STMST=,&CATALOG=,&APPLID=,               X03004-00600000
               &NSEXIT=,                                       @G40AKCM-00605000
               &USERPTR=,                                      @XM01129-00610000
               &SUBSYSNM=,&RLSREAD=,&CTRLACB=,                     @LQA-00630000
               &XAVSPAC=,&XENDRBA=,&XHALCRBA=,                     @EAA-00640000
               &EODAD=,&JRNAD=,                  *** EXLST KEYWORDS ***-00650000
               &LERAD=,&SYNAD=,&EXLLEN=,&LOGON=,&LOSTERM=,       X03004-00700000
               &RELREQ=,&ATTN=,&TPEND=,                        @Z40BHUC-00750000
               &SCIP=,&DFASY=,&RESP=,                          @Z40BHUC-00800000
               &QUIESCE=,&RLSWAIT=,                                @LQA-00825000
               &ACB=,&AREA=,&AREALEN=,&ARG=,&ECB=, *** RPL KEYWORDS ***-00850000
               &FDBK=,&MSGAREA=,&MSGLEN=,&NXTRPL=,&OPTCD=,             -00900000
               &RBA=,&RECLEN=,&IO=,&RPLLEN=,&AAREA=,&AAREALN=,   X03004-00950000
               &ARECLEN=,&EXIT=,&NIB=,                          X04SVHS-01000000
               &BRANCH=,&USER=,&RTNCD=,&FDBK2=,&SENSE=,          X03004-01050000
               &REQ=,&DATAFLG=,                                  X03004-01100000
               &TRANSID=,&AIXPC=,&FTNCD=,&AIXFLAG=,             X04SVHS-01150000
               &CHNGDIR=,&STYPE=,&RTYPE=,&CHAIN=,&POST=,        X3004BS-01200000
               &RESPOND=,&CONTROL=,&OBSQAC=,&IBSQAC=,           X3004BS-01250000
               &OBSQVAL=,&IBSQVAL=,&SEQNO=,&SSENSEO=,           X3004BS-01300000
               &SSENSEI=,&USENSEO=,&USENSEI=,                  @Z40BHUC-01350000
               &BRACKET=,&SSENSMO=,&SSENSMI=,&SIGDATA=,        X03004HS-01400000
               &LUWID=,&TIMEOUT=,&XRBA=,                           @EAC-01425000
               &NAME=,&USERFLD=,&MODE=,      *** NIB KEYWORDS ***X03004-01450000
               &LISTEND=,&CONDN=,&PROC=,&NIBLEN=,                X03004-01500000
               &CID=,&DEVCHAR=,&CON=,&RESPLIM=,&SDT=,           X3004BS-01550000
               &LOGMODE=,&BNDAREA=,&CODESEL=,                  @Z40BHUC-01600000
               &CRYPT=,&ENCR=,                                     @LPC-01607300
               &RMODE31=                                           @LPA 01614600
.*                                                                      01622100
.* $MAC(IDACB2  ):                                                      01624200
.*                                                                      01626300
.*                                                                      01638900
.*PROPRIETARY V3 STATEMENT                                              01639000
.*LICENSED MATERIALS - PROPERTY OF IBM                                  01639100
.*"RESTRICTED MATERIALS OF IBM"                                         01639200
.*5695-DF1                                                              01639300
.*(C) COPYRIGHT 1983,1995  IBM CORP.                                    01639400
.*END PROPRIETARY V3 STATEMENT                                          01639900
.*                                                                      01640400
.* STATUS = DFSMS/MVS VERSION 1 RELEASE 3.0                             01641700
.*                                                                      01643100
.*                                                                      01647300
.* FUNCTION - 1. VALIDITY CHECK AND TRANSFORM ALL CONTROL BLOCK         01650000
.*               KEYWORDS                                               01700000
.*            2. GENERATE THE CODE REQUIRED TO BUILD AND DYNAMICALLY    01750000
.*               MODIFY THE PARAMETER LIST AND ARGUMENT CONTROL ENTRIES 01800000
.*            3. GENERATE THE CODE FOR LINKAGE TO THE CONTROL BLOCK     01850000
.*               MANIPULATION ROUTINE                                   01900000
.* INNER MACROS - IDACB1,IDAERMAC                                       01950000
.* CALLERS - GENCB,MODCB,SHOWCB,TESTCB                                  02000000
.* CHANGE ACTIVITY                                                      02010000
.* $L3=DFP,JDP1110,,STLJRB: MVS/XA DFP RELEASE 1.1 VSAM 31-BIT     @L3A 02015000
.* $L9=DFP,HDP2230,,STLJRB: MVS/XA DFP RELEASE 2.3   VSAM 31-BIT   @L9A 02020000
.* $LP=DFP,HDP2230,,STLJTP: MVS/XA DFP RELEASE 2.3 31/24 BIT       @LPA 02025000
.* APAR TO SHIP 31/24 BIT CODE                                 @YA04964 02030000
.* CHANGE CONTINUATION CHARACTER TO '-'                        @YA21786 02035000
.* $LQ=VSAMRLS,HDZ11C0,930910,SJPLRG: VSAM-RLS CBMM SUPPORT        @LQA 02040000
.* OW21279,HDZ11C0,960627,SJPLTLD: INDIRECT ADDR PATH WRONG    @WA21279 02045000
.* GLOBALS                                                              02050000
.* OW23308,HDZ11D0,970519,SJPLLLL: SET SHOWCB CNTL BLOCK NAME  @WA23308 02066600
.*                                                                      02083200
         GBLB  &IDACB01                ERROR INDICATOR                  02100000
         GBLA  &IDACB02                NUMBER OF FIELDS IN HEADER ACE   02150000
         GBLA  &IDACB03                LENGTH OF HEADER ACE             02200000
         GBLA  &IDACB04(5)             HEADER TYPE ARRAY                02250000
         GBLC  &IDACB05(5)             HEADER VALUE ARRAY               02300000
         GBLA  &IDACB06(5)             HEADER OFFSET ARRAY              02350000
         GBLA  &IDACB07(5)             HEADER FIELD LENGTH ARRAY        02400000
         GBLA  &IDACB09                NUMBER OF SHOWCB ELEMENTS        02450000
         GBLA  &IDACB10(60)            SHOWCB ELEMENT ID ARRAY     @LQC 02500000
         GBLA  &IDACB11                VALUE TYPE-SET BY IDACB1         02550000
         GBLC  &IDACB12                EXIT LIST CODES-SET BY IDACB1    02600000
         GBLC  &IDACB13                OPERAND VALUE - SET BY IDACB1    02650000
         GBLB  &IDABUG                 DEBUG SWITCH                     02700000
         GBLA  &IDAENO                 NUMBER OF ELEMENTS               02750000
         GBLA  &IDAETYP(60)            ELEMENT TYPE ARRAY          @LQC 02800000
         GBLA  &IDAEID(60)             ELEMENT ID ARRAY            @LQC 02850000
         GBLA  &IDAELEN(60)            ELEMENT FIELD LENGTH ARRAY  @LQC 02900000
         GBLC  &IDAVALX(60)            ELEMENT ARITHMETIC VALUE ARR@LQC 02950000
         GBLC  &IDAVALC(60)            ELEMENT CHARACTER VALUE ARR @LQC 03000000
         GBLC  &IDAOPT2,&IDAOPT3       OPTCD BIT STRING EXTENSION       03060000
         GBLC  &IDAPRC2                PROC BIT STRING EXTENSION        03070000
         GBLC  &IDAMAC2                MACRF BIT STRING EXTENSION  @LQA 03085000
.* LOCALS                                                               03137500
         GBLA  &EOFF(60)               ELEMENT OFFSET ARRAY        @LQC 03143700
         LCLA  &ACBID,&EXLID,&RPLID    BLOCK TYPE CODES                 03150000
         LCLA  &NIBID                  BLOCK TYPE CODES          X03004 03200000
         LCLA  &VN1,&VN2,&VN3,&AN1,&AN2,&AN3,&AN4 OPERAND TYPE CODES    03250000
         LCLA  &I,&J,&WORKA            WORK VARIABLES           X04SVHS 03300000
         LCLA  &BTC                    BLOCK TYPE CODE                  03350000
         LCLA  &FTC                    FUNCTION TYPE CODE               03400000
         LCLB  &RMF                    REENTRANT MACRO FORM SWITCH      03450000
         LCLA  &PLLEN                  PARAMETER LIST LENGTH            03500000
         LCLC  &PLLBL,&ERRLBL          GENERATED LABELS            @L9C 03550000
.*                                                                 @L9D 03600000
         LCLC  &H                      USED TO FORM STH OP CODE         03650000
         LCLC  &WORKC                  WORK VARIABLE                    03700000
         LCLC  &BLK                    BLOCK TYPE CODE                  03750000
         LCLC  &Z16                     WORK CONSTANT           X04SVHS 03760000
         LCLC  &GENFG1                 SUM OF GENFLAG1 BITS        @L9A 03770000
         LCLB  &GFL0,&GFL1,&GFL2,&GFL3 GENFLAG1 BITS 0 - 3         @L9A 03780000
         LCLB  &GFL4,&GFL5,&GFL6,&GFL7 GENFLAG1 BITS 4 - 7         @L9A 03790000
.* INITIALIZATION ***************************************************** 03800000
&ACBID   SETA  X'0A0'                  ACB BLOCK TYPE CODE              03850000
&EXLID   SETA  X'0B0'                  EXLST BLOCK TYPE CODE            03900000
&RPLID   SETA  X'0C0'                  RPL BLOCK TYPE CODE              03950000
&NIBID   SETA  X'0D0'                  NIB BLOCK TYPE CODE       X03004 04000000
&VN1     SETA  1                       SELF-DEFINING TERM < 4096        04050000
&VN2     SETA  2                       BIT CODE SUBLIST                 04100000
&VN3     SETA  3                       CHARACTER STRING                 04150000
&AN1     SETA  4                       REGISTER SPECIFICATION           04200000
&AN2     SETA  5                       S-ADCON EXPRESSION               04250000
&AN3     SETA  6                       INDIRECT ADDRESS                 04300000
&AN4     SETA  7                       A-ADCON EXPRESSION               04350000
&GFL0    SETB  ('&LOC' EQ  'ANY')      IF GENCB AND LOC=ANY SET 1  @L9A 04355000
&GFL1    SETB  0                       BIT 1 FLAG RESERVED         @L9A 04360000
&GFL2    SETB  0                       BIT 2 FLAG RESERVED         @L9A 04365000
&GFL3    SETB  0                       BIT 3 FLAG RESERVED         @L9A 04370000
&GFL4    SETB  0                       BIT 4 FLAG RESERVED         @L9A 04375000
&GFL5    SETB  0                       BIT 5 FLAG RESERVED         @L9A 04380000
&GFL6    SETB  0                       BIT 6 FLAG RESERVED         @L9A 04385000
&GFL7    SETB  0                       BIT 7 FLAG RESERVED         @L9A 04390000
&GENFG1  SETC  '&GFL0&GFL1&GFL2&GFL3&GFL4&GFL5&GFL6&GFL7'          @L9A 04395000
&PLLBL   SETC  'IDA'.'&SYSNDX'.'A'                                      04400000
&ERRLBL  SETC  'IDA'.'&SYSNDX'.'A'                                      04450000
.*                                                                      04460000
&Z16     SETC  '0000000000000000'       INITIALIZE TO 16 ZEROES X04SVHS 04470000
.*             INITIALIZE GLOBAL ARRAYS TO ZERO                         04472000
&IDAENO  SETA  0                        INIT NUMBER OF ELEMENTS X04SVHS 04480000
.I000050 ANOP                                                   X04SVHS 04492000
&I       SETA  &I+1                     BUMP INDEX              X04SVHS 04494000
         AIF   (&I GT 60).I000075       ARE ALL ELEMENTS INIT      @LQC 04495000
&IDAETYP(&I) SETA 0                     INIT TYPE ELEMENT       X04SVHS 04496000
&IDAEID(&I) SETA 0                      INIT ID ELEMENT         X04SVHS 04498000
&IDAELEN(&I) SETA 0                     INIT LENGTH ELEMENT     X04SVHS 04498400
&IDAVALX(&I) SETC '&Z16&Z16'            INIT EXLST CODE ELEMENT X04SVHS 04498800
&IDAVALC(&I) SETC '&Z16&Z16'            INIT VALUE ELEMENT      X04SVHS 04499200
         AGO   .I000050                 POINT TO NEXT ELEMENT   X04SVHS 04499600
.********************************************************************** 04512200
.I000075 ANOP                                                   X04SVHS 04524800
         AIF   ('&MF' EQ '' OR '&MF(1)' EQ 'L' OR '&MF(1)' EQ 'E' OR   -04537400
               '&MF(1)' EQ 'G').I000100 VALIDITY CHECK MF               04550000
         IDAERMAC 3,MF,&MF                                              04600000
&IDACB01 SETB  1                                                        04650000
.I000100 ANOP                                                           04700000
.* SET REENTRANT FORM OF MACRO SWITCH                                   04750000
&RMF     SETB  ('&MF(1)' EQ 'G' OR ('&MF(1)' EQ 'L' AND N'&MF GT 1))    04800000
.********************************************************************** 04810000
.* SET FUNCTION TYPE CODE                                               04850000
&FTC     SETA  1                                                        04900000
         AIF   ('&CALLER' EQ 'GEN').I000200  TEST FOR GENCB             04950000
&FTC     SETA  2                                                        05000000
         AIF   ('&CALLER' EQ 'MOD').I000200  TEST FOR MODCB             05050000
&FTC     SETA  3                                                        05100000
         AIF   ('&CALLER' EQ 'SHOW').I000200 TEST FOR SHOWCB            05150000
&FTC     SETA  4                             ASSUME TESTCB              05200000
.I000200 AIF   ('&AM' NE 'VTAM').I000300                                05250000
&FTC     SETA  &FTC+16                                                  05260000
.********************************************************************** 05310000
.*             PROCESS SHOWCB                                           05320000
.********************************************************************** 05330000
.I000300 AIF   ('&CALLER' NE 'SHOW').I000900                            05350000
         AIF   ('&BLKTYPE' NE 'ACB').I000400                            05400000
&BTC     SETA  &ACBID                                                   05450000
&BLK     SETC  'ACB'                   INDICATE SHOWCB ACB     @WA23308 05475000
         AGO   .I000700                                                 05500000
.I000400 AIF   ('&BLKTYPE' NE 'EXLST').I000500                          05550000
&BTC     SETA  &EXLID                                                   05600000
&BLK     SETC  'EXLST'                 INDICATE SHOWCB EXLST   @WA23308 05625000
         AGO   .I000700                                                 05650000
.I000500 AIF   ('&BLKTYPE' NE 'RPL').I000600                            05700000
&BTC     SETA  &RPLID                                                   05700300
&BLK     SETC  'RPL'                   INDICATE SHOWCB RPL     @WA23308 05700400
         AGO   .I000700                                                 05700600
.I000600 AIF   ('&BLKTYPE' NE 'NIB').I000700                            05700900
&BTC     SETA  &NIBID                                            X03004 05701200
&BLK     SETC  'NIB'                   INDICATE SHOWCB NIB     @WA23308 05701300
.I000700 ANOP                                                           05701500
.*************************************************             @ZA07565 05702000
.* LOOK FOR REGISTER FORM                        *             @Z40BHCJ 05704000
.*************************************************             @Z40BHCJ 05706000
         AIF   (&IDACB09 NE 1).I000710                         @Z40BHCJ 05710000
         AIF   (&IDACB10(1) NE X'35').I000710                  @Z40BHCJ 05720000
         AIF   ('&IDACB05(4)' LT '4').I000710                  @ZA33610 05730000
         AIF   (&IDACB04(3) EQ &AN1 AND '&IDACB05(3)' EQ '1').I000710   05732000
         AIF   ('&MF(1)' EQ '').I022700                        @Z40BHCJ 05740000
.I000710 ANOP                                                  @ZA07565 05742000
&IDAENO  SETA  &IDACB09                 SET NO. OF FIELDS TO BE SHOWN   06000000
&I       SETA  0                       BYPASS VALIDITY CHECKS AND ...   06050000
.I000800 ANOP                             TRANSFORMATIONS FOR SHOWCB    06100000
&I       SETA  &I+1                                                     06150000
         AIF   (&I GT &IDAENO).I013500 HAVE ALL ELEMENTS BEEN PROCESSED 06200000
&IDAEID(&I) SETA  &IDACB10(&I)         SET ELEMENT ID ARRAY             06250000
         AGO   .I000800                CHECK NEXT ELEMENT               06300000
.********************************************************************** 06310000
.*       CHECK BLKTYPE                                                  06320000
.********************************************************************** 06330000
.I000900 AIF   ('&BLKTYPE' EQ 'ACB').I001400 CHECK FOR ACB              06350000
         AIF   ('&BLKTYPE' EQ 'RPL').I001100 CHECK FOR RPL              06400000
         AIF   ('&BLKTYPE' EQ 'NIB').I001300 CHECK FOR NIB              06450000
.*             'BLKTYPE' IS EITHER NULL OR 'EXLST'. IF NULL, IDACB2 HAS 06460000
.*             BEEN CALLED BY THE EXECUTE FORM OF GENCB, MODCB, OR      06470000
.*             TESTCB, AND TO DETERMINE WHAT TYPE CONTROL BLOCK WILL BE 06480000
.*             AFFECTED, EACH INNER MACRO (IDACBRPL, IDACBEXL, IDACBACB 06490000
.*             IDACBNIB) IS CALLED UNTIL A VALID KEYWORD (OTHER THAN    06492000
.*             AM) IS FOUND. IF NO VALID KEYWORD IS FOUND, AN ERROR     06494000
.*             MESSAGE IS ISSUED BECAUSE IT IS IMPOSSIBLE TO DETERMINE  06496000
.*             WHAT TYPE CONTROL BLOCK THE USER WANTS.                  06498000
.*             IF BLOCK IS A NIB AND EXLST IS THE ONLY         @XA07799 06498400
.*             PARAMETER ON A GENCB, BLK=NIB IS REQUIRED.      @XA07799 06498500
.*             WHEN USING MODCB OR TESTCB, NIB OR ACB MUST BE  @XA07799 06498600
.*             USED IF EXLST IS A PARAMETER AND NOT A BLKTYPE. @XA07799 06498700
.*                                                                      06498800
.********************************************************************** 06499500
.*             EXLST                                                    06499900
.********************************************************************** 06516600
         IDACBEXL AM=&AM,MF=&MF,CALLER=&CALLER,EODAD=&EODAD,           -06533300
               JRNAD=&JRNAD,LERAD=&LERAD,SYNAD=&SYNAD,EXLLEN=&EXLLEN,  -06550000
               QUIESCE=&QUIESCE,RLSWAIT=&RLSWAIT,                  @LQA-06575000
               LOGON=&LOGON,LOSTERM=&LOSTERM,RELREQ=&RELREQ,           -06600000
               NSEXIT=&NSEXIT,                                 @G40AKCM-06620000
               ATTN=&ATTN,TPEND=&TPEND,                        @Z40BHUC-06650000
               SCIP=&SCIP,DFASY=&DFASY,RESP=&RESP              @Z40BHUC 06700000
         AIF   (&IDAENO EQ 1 AND '&AM' NE '' AND                       -06750000
               '&BLKTYPE' NE 'EXLST' AND '&CALLER' EQ 'GEN').I001000    06800000
.*                                                              X04SVHS 06802000
.*             IF THE ABOVE CONDITIONS ARE MET, NO VALID EXLST KEYWORD  06802400
.*             EXCEPT AM WAS FOUND AND IT IS ASSUMED THAT AN EXLST      06802800
.*             IS NOT TO BE GENERATED.                                  06803200
         AIF   (&IDAENO EQ 0 AND '&BLKTYPE' NE 'EXLST').I001100 X04SVHS 06804000
.*             IF BLKTYPE ISN'T EQUAL TO EXLST AND ELEMENT COUNT        06806000
.*             IS ZERO, TRY RPL.                                        06806400
&BTC     SETA  &EXLID                   INDICATE EXLST          X04SVHS 06808000
         AGO   .I001500                                                 06810000
.I001000 ANOP                                                   X04SVHS 06850000
&IDAENO  SETA  0                                                X04SVHS 06900000
.I001100 ANOP                                                           07000000
.********************************************************************** 07010000
.*             RPL                                                      07020000
.********************************************************************** 07030000
         IDACBRPL AM=&AM,MF=&MF,CALLER=&CALLER,ACB=&ACB,AREA=&AREA,    -07050000
               AREALEN=&AREALEN,ARG=&ARG,ECB=&ECB,FDBK=&FDBK,          -07100000
               MSGAREA=&MSGAREA,MSGLEN=&MSGLEN,NXTRPL=&NXTRPL,         -07150000
               OPTCD=&OPTCD,RBA=&RBA,RECLEN=&RECLEN,IO=&IO,            -07200000
               RPLLEN=&RPLLEN,AAREA=&AAREA,AAREALN=&AAREALN,           -07250000
               ARECLEN=&ARECLEN,EXIT=&EXIT,KEYLEN=&KEYLEN,             -07300000
               NIB=&NIB,BRANCH=&BRANCH,USER=&USER,                     -07350000
               RTNCD=&RTNCD,FDBK2=&FDBK2,SENSE=&SENSE,REQ=&REQ,        -07400000
               DATAFLG=&DATAFLG,TRANSID=&TRANSID,AIXPC=&AIXPC,         -07450000
               FTNCD=&FTNCD,AIXFLAG=&AIXFLAG,CHNGDIR=&CHNGDIR,         -07500000
               STYPE=&STYPE,RTYPE=&RTYPE,CHAIN=&CHAIN,POST=&POST,      -07550000
               RESPOND=&RESPOND,CONTROL=&CONTROL,OBSQAC=&OBSQAC,       -07600000
               IBSQAC=&IBSQAC,OBSQVAL=&OBSQVAL,IBSQVAL=&IBSQVAL,       -07650000
               SEQNO=&SEQNO,SSENSEO=&SSENSEO,SSENSEI=&SSENSEI,         -07700000
               USENSEO=&USENSEO,USENSEI=&USENSEI,              @Z40BHUC-07750000
               BRACKET=&BRACKET,SSENSMO=&SSENSMO,SSENSMI=&SSENSMI,     -07800000
               SIGDATA=&SIGDATA,CODESEL=&CODESEL,              @Z40BHUC-07850000
               CRYPT=&CRYPT,XRBA=&XRBA,                            @EAC-07853300
               LUWID=&LUWID,TIMEOUT=&TIMEOUT                       @LQA 07856600
.**********************************************************    @Z40BHCJ 07860000
.* TEST FOR POSSIBLE REGISTER FORM                             @Z40BHCJ 07862000
.**********************************************************    @Z40BHCJ 07870000
         AIF   ('&BLKTYPE' NE 'RPL' OR '&CALLER' NE 'MOD').I001190      07880000
         AIF   ('&MF(1)' NE '').I001190   NOT L, E, OR G MODE  @ZA10885 07895000
         AIF   ('&RECLEN' EQ '').I001190                       @Z40BHCJ 07905000
         AIF   (&IDAENO EQ 1).I022700                          @Z40BHCJ 07915000
.I001190 ANOP                                                  @Z40BHCJ 07946000
         AIF   ('&BLKTYPE' NE 'RPL' AND &IDAENO EQ 1 AND               -07950800
               '&AM' NE '' AND '&CALLER' EQ 'GEN').I001200              07954000
.*             IF THE ABOVE CONDITIONS ARE MET, NO VALID RPL KEYWORD    07957200
.*             EXCEPT AM WAS FOUND AND IT IS ASSUMED THAT AN RPL        07960400
.*             IS NOT TO BE GENERATED.                                  07963600
         AIF   (&IDAENO EQ 0 AND '&BLKTYPE' NE 'RPL').I001300  @XA07799 07966800
.*             IF BLKTYPE IS NOT RPL AND ELEMENT COUNT IS ZERO,         07970000
.*             TRY NIB.                                        @XA07799 07980000
&BTC     SETA  &RPLID                                                   08000000
         AGO   .I001500                                                 08050000
.I001200 ANOP                                                   X04SVHS 08100000
&IDAENO  SETA  0                                                X04SVHS 08150000
.I001300 ANOP                                                   X04SVHS 08250000
.********************************************************************** 08260000
.*             NIB                                                      08270000
.********************************************************************** 08280000
         IDACBNIB EXLST=&EXLST,MF=&MF,CALLER=&CALLER,NAME=&NAME,       -08300000
               USERFLD=&USERFLD,MODE=&MODE,LISTEND=&LISTEND,           -08350000
               CONDN=&CONDN,PROC=&PROC,NIBLEN=&NIBLEN,CID=&CID,        -08400000
               DEVCHAR=&DEVCHAR,CON=&CON,RESPLIM=&RESPLIM,SDT=&SDT,    -08450000
               LOGMODE=&LOGMODE,BNDAREA=&BNDAREA,              @Z40BHUC-08470000
               ENCR=&ENCR                                      @G40AKSL 08490000
         AIF   (&IDAENO EQ 0 AND '&BLKTYPE' NE 'NIB').I001400  @XA07799 08510000
         AIF   (&IDAENO EQ 1 AND '&EXLST' NE '' AND                    -08520000
               '&BLKTYPE' NE 'NIB').I001350                    @XA07799 08530000
&BTC     SETA  &NIBID                                            X03004 08550000
         AGO   .I001500                                                 08600000
.I001350 ANOP                                                           08610000
&IDAENO  SETA  0                                                        08620000
.I001400 ANOP                                                           08650000
.********************************************************************** 08660000
.*             ACB                                                      08670000
.********************************************************************** 08680000
         IDACBACB AM=&AM,MF=&MF,CALLER=&CALLER,ACBLEN=&ACBLEN,         -08700000
               ATRB=&ATRB,AVSPAC=&AVSPAC,BUFND=&BUFND,BUFNI=&BUFNI,    -08750000
               BUFNO=&BUFNO,BUFSP=&BUFSP,CINV=&CINV,DDNAME=&DDNAME,    -08800000
               ENDRBA=&ENDRBA,ERROR=&ERROR,EXLST=&EXLST,FS=&FS,        -08850000
               KEYLEN=&KEYLEN,LRECL=&LRECL,MACRF=&MACRF,NCIS=&NCIS,    -08900000
               NDELR=&NDELR,NEXCP=&NEXCP,NEXT=&NEXT,NINSR=&NINSR,      -08950000
               NIXL=&NIXL,NLOGR=&NLOGR,NRETR=&NRETR,NSSS=&NSSS,        -09000000
               NUPDR=&NUPDR,OFLAGS=&OFLAGS,PASSWD=&PASSWD,RKP=&RKP,    -09050000
               BSTRNO=&BSTRNO,CRA=&CRA,OPENOBJ=&OPENOBJ,AIXRKP=&AIXRKP,-09100000
               STRNO=&STRNO,STMST=&STMST,CATALOG=&CATALOG,             -09150000
               USERPTR=&USERPTR,JFCB=&JFCB,SHRPOOL=&SHRPOOL,       @L3C-09160000
               APPLID=&APPLID,MAREA=&MAREA,MLEN=&MLEN,                 -09174000
               RMODE31=&RMODE31,                                   @LQC-09181000
               SUBSYSNM=&SUBSYSNM,RLSREAD=&RLSREAD,                @LQA-09188000
               CTRLACB=&CTRLACB,XAVSPAC=&XAVSPAC,XENDRBA=&XENDRBA, @EAC-09192600
               XHALCRBA=&XHALCRBA                                  @EAA 09197200
.*                                                                      09202000
         AIF   ('&BLKTYPE' NE 'ACB' AND &IDAENO EQ 1                   -09210000
               AND '&AM' NE '' AND '&CALLER' EQ 'GEN').I001450          09220000
.*             IF THESE ABOVE CONDITIONS ARE MET, THEN ONLY 'AM'        09230000
.*             KEYWORD WAS SPECIFIED WITH MF=E FOR GENCB, AND THERE     09240000
.*             IS NO WAY TO DETERMINE WHAT TYPE CONTROL BLOCK IS        09242000
.*             REQUIRED                                                 09244000
         AIF   (&IDAENO NE 0 OR '&BLKTYPE' EQ 'ACB').I001475    X04SVHS 09246000
.*             IF ELEMENT COUNT IS 0 AND BLKTYPE NOT ACB,               09246400
.*             THEN THERE ARE NO VALID KEYWORDS SPECIFIED, BLOCK TYPE   09248000
.*             HAS NOT BEEN SPECIFIED, AND IT IS IMPOSSIBLE TO          09254400
.*             DETERMINE WHAT TYPE CONTROL BLOCK IS REQUIRED.           09255200
         AIF   ('&AM' NE 'VTAM' AND '&MF(1)' EQ 'E').I001500            09256400
.*             IF AM=VTAM, THEN BLOCK TYPE MUST BE SPECIFIED.  ELSE     09258400
.*             IT MUST BE SPECIFIED EXCEPT WHEN USING EXECUTE FORM      09260400
.*             OF GENCB.                                                09260500
.I001450 ANOP                                                           09260800
         AIF   ('&CALLER' NE 'GEN').I001500                     X04SVHS 09262800
.*             IF CALLER IS EQUAL GEN, THEN AT THIS POINT IT IS         09264800
.*             IMPOSSIBLE TO DETERMINE WHAT TYPE CONTROL BLOCK THE      09265200
.*             USER IS REQUESTING. THIS WILL OCCUR ONLY ON THE          09265600
.*             EXECUTE FORM OF GENCB.                                   09266000
         IDAERMAC 2,BLOCK-TYPE                                          09266400
&IDACB01 SETB  1                                                        09272000
         AGO   .I001500                                         X04SVHS 09277600
.I001475 ANOP                                                   X04SVHS 09283200
&BTC     SETA  &ACBID                   INDICATE BLK=ACB        X04SVHS 09288800
.********************************************************************** 09290800
.* SCAN CONTROL BLOCK LENGTH KEYWORDS    -    TESTCB ONLY               09294400
.********************************************************************** 09296400
.I001500 AIF   ('&CALLER' NE 'TEST').I001900                            09300000
         AIF   ('&EXLLEN' EQ '').I001600         *** EXLLEN ***         09350000
         AIF   ('&BLKTYPE' NE 'EXLST' AND '&BLKTYPE' NE '').I001600     09400000
         AIF   (NOT ('&AM' EQ 'VSAM' OR '&AM' EQ '')).I001510           09410000
         IDACB3 ARG=&EXLLEN,ARGNAME=EXLLEN,KWTC=X'2A',MF=&MF            09450000
.I001510 AIF   ('&AM' NE 'VTAM').I001600                                09500000
         IDACB3 ARG=&EXLLEN,ARGNAME=EXLLEN,KWTC=X'3F',MF=&MF            09600000
.I001600 AIF   ('&RPLLEN' EQ '').I001700         *** RPLLEN ***         09800000
         AIF   ('&BLKTYPE' NE 'RPL' AND '&BLKTYPE' NE '').I001700       09850000
         AIF   (NOT ('&AM' EQ 'VSAM' OR '&AM' EQ '')).I001610           09860000
         IDACB3 ARG=&RPLLEN,ARGNAME=RPLLEN,KWTC=X'37',MF=&MF            09900000
.I001610 AIF   ('&AM' NE 'VTAM').I001700                                09950000
         IDACB3 ARG=&RPLLEN,ARGNAME=RPLLEN,KWTC=X'3E',MF=&MF            10000000
.I001700 AIF   ('&ACBLEN' EQ '').I001800         *** ACBLEN ***         10250000
         AIF   ('&BLKTYPE' NE 'ACB' AND '&BLKTYPE' NE '').I001800       10300000
         AIF   (NOT ('&AM' EQ 'VSAM' OR '&AM' EQ '')).I001710           10310000
         IDACB3 ARG=&ACBLEN,ARGNAME=ACBLEN,KWTC=X'03',MF=&MF            10350000
.I001710 AIF   ('&AM' NE 'VTAM').I001800                                10400000
         IDACB3 ARG=&ACBLEN,ARGNAME=ACBLEN,KWTC=X'3D',MF=&MF            10500000
.I001800 AIF   ('&NIBLEN' EQ '').I001900         *** NIBLEN ***         10700000
         AIF   ('&BLKTYPE' NE 'NIB' AND '&BLKTYPE' NE '').I001900       10750000
         IDACB3 ARG=&NIBLEN,ARGNAME=NIBLEN,KWTC=X'53',MF=&MF            10800000
.********************************************************************** 10850000
.* SCAN FOR INVALID CONTROL BLOCK KEYWORDS                              11050000
.********************************************************************** 11060000
.I001900 AIF   (&BTC NE &ACBID).I002000                                 11100000
&BLK     SETC  'ACB'                                                    11150000
         AGO   .I002300                                                 11200000
.I002000 AIF   (&BTC NE &RPLID).I002100                                 11250000
&BLK     SETC  'RPL'                                                    11300000
         AGO   .I002300                                                 11350000
.I002100 AIF   (&BTC NE &NIBID).I002200                          X03004 11400000
&BLK     SETC  'NIB'                                             X03004 11450000
         AGO   .I002300                                                 11500000
.I002200 AIF   (&BTC NE &EXLID).I002300                        @ZA07565 11550000
&BLK     SETC  'EXLST'                                                  11600000
.********************************************************************** 11610000
.*             THE FOLLOWING BLOCK OF CODE CHECKS TO SEE IF ALL         11640000
.*             KEYWORDS SPECIFIED ARE VALID FOR THE CONTROL BLOCK       11642000
.*             SPECIFIED.                                               11644000
.********************************************************************** 11646000
.*             EXLST KEYWORDS ONLY                                      11648000
.******************************                                         11648400
.I002300 AIF   ('&BLK' EQ 'EXLST').I003900                              11648800
         AIF   ('&EODAD' EQ '').I002400                                 11650000
         IDAERMAC 11,EODAD,&BLK                                         11700000
.I002400 AIF   ('&JRNAD' EQ '').I002500                                 11750000
         IDAERMAC 11,JRNAD,&BLK                                         11800000
.I002500 AIF   ('&LERAD' EQ '').I002600                                 11850000
         IDAERMAC 11,LERAD,&BLK                                         11900000
.I002600 AIF   ('&SYNAD' EQ '').I002620                          X03004 11950000
         IDAERMAC 11,SYNAD,&BLK                                         12000000
.I002620 AIF   ('&QUIESCE' EQ '').I002640                          @LQA 12010000
         IDAERMAC 11,QUIESCE,&BLK                                  @LQA 12020000
.I002640 AIF   ('&RLSWAIT' EQ '').I002700                          @LQA 12030000
         IDAERMAC 11,RLSWAIT,&BLK                                  @LQA 12040000
.I002700 AIF   ('&LOGON' EQ '').I002800                          X03004 12050000
         IDAERMAC 11,LOGON,&BLK                                  X03004 12100000
.I002800 AIF   ('&LOSTERM' EQ '').I002900                        X03004 12150000
         IDAERMAC 11,LOSTERM,&BLK                                X03004 12200000
.I002900 AIF   ('&RELREQ' EQ '').I003200                       @Z40BHUC 12250000
         IDAERMAC 11,RELREQ,&BLK                                 X03004 12300000
.I003200 AIF   ('&ATTN' EQ '').I003300                           X03004 12550000
         IDAERMAC 11,ATTN,&BLK                                   X03004 12600000
.I003300 AIF   ('&TPEND' EQ '').I003350                        @G40AKCM 12650000
         IDAERMAC 11,TPEND,&BLK                                  X03004 12670000
.I003350 AIF   ('&NSEXIT' EQ '').I003400                       @G40AKCM 12690000
         IDAERMAC 11,NSEXIT,&BLK                               @G40AKCM 12710000
.I003400 AIF   ('&SCIP' EQ '').I003500                          X3004BS 12750000
         IDAERMAC 11,SCIP,&BLK                                  X3004BS 12800000
.I003500 AIF   ('&DFASY' EQ '').I003600                         X3004BS 12850000
         IDAERMAC 11,DFASY,&BLK                                 X3004BS 12900000
.I003600 AIF   ('&RESP' EQ '').I003800                         @Z40BHUC 12950000
         IDAERMAC 11,RESP,&BLK                                  X3004BS 13000000
.I003800 AIF   ('&EXLLEN' EQ '' OR '&BLKTYPE' EQ '').I003900            13150000
         IDAERMAC  11,EXLLEN,&BLK                                       13200000
.******************************                                         13220000
.*       RPL KEYWORDS ONLY                                              13240000
.******************************                                         13260000
.I003900 AIF   ('&BLK' EQ 'RPL').I008600                                13280000
         AIF   ('&ACB' EQ '').I004000                                   13300000
         AIF   ('&CALLER' NE 'GENCB'  AND  '&BLK' EQ 'ACB').I004000     13350000
         IDAERMAC 11,ACB,&BLK                                           13400000
.I004000 AIF   ('&AREA' EQ '').I004100                                  13450000
         IDAERMAC 11,AREA,&BLK                                          13500000
.I004100 AIF   ('&AREALEN' EQ '').I004200                               13550000
         IDAERMAC 11,AREALEN,&BLK                                       13600000
.I004200 AIF   ('&ARG' EQ '').I004300                                   13650000
         IDAERMAC 11,ARG,&BLK                                           13700000
.I004300 AIF   ('&ECB' EQ '').I004400                                   13750000
         IDAERMAC 11,ECB,&BLK                                           13800000
.I004400 AIF   ('&KEYLEN' EQ ''  OR  '&BLK' EQ 'ACB').I004500   X04SVHS 13850000
         IDAERMAC 11,KEYLEN,&BLK                                        13900000
.I004500 AIF   ('&MSGAREA' EQ '').I004600                               13950000
         IDAERMAC 11,MSGAREA,&BLK                                       14050000
.I004600 AIF   ('&MSGLEN' EQ '').I004700                                14100000
         IDAERMAC 11,MSGLEN,&BLK                                        14200000
.I004700 AIF   ('&NXTRPL' EQ '').I004800                                14250000
         IDAERMAC 11,NXTRPL,&BLK                                        14300000
.I004800 AIF   ('&OPTCD' EQ '').I004900                                 14350000
         IDAERMAC 11,OPTCD,&BLK                                         14400000
.I004900 AIF   ('&RECLEN' EQ '').I005000                                14450000
         IDAERMAC 11,RECLEN,&BLK                                        14500000
.I005000 AIF   ('&IO' EQ '').I005100                                    14550000
         IDAERMAC 11,IO,&BLK                                            14600000
.I005100 AIF   ('&FDBK' EQ '').I005200                                  14650000
         IDAERMAC 11,FDBK,&BLK                                          14700000
.I005200 AIF   ('&RBA' EQ '').I005300                                   14750000
         IDAERMAC 11,RBA,&BLK                                           14800000
.I005300 AIF   ('&AAREA' EQ '').I005400                          X03004 14850000
         IDAERMAC 11,AAREA,&BLK                                  X03004 14900000
.I005400 AIF   ('&AAREALN' EQ '').I005500                        X03004 14950000
         IDAERMAC 11,AAREALN,&BLK                                X03004 15000000
.I005500 AIF   ('&ARECLEN' EQ '').I005600                        X03004 15050000
         IDAERMAC 11,ARECLEN,&BLK                                X03004 15100000
.I005600 AIF   ('&EXIT' EQ '').I005900                           X03004 15150000
         IDAERMAC 11,EXIT,&BLK                                   X03004 15200000
.I005900 AIF   ('&NIB' EQ '').I006000                            X03004 15450000
         AIF ('&CALLER' NE 'GENCB' AND '&BLK' EQ 'NIB').I006000  X03004 15500000
         IDAERMAC 11,NIB,&BLK                                    X03004 15550000
.I006000 AIF   ('&BRANCH' EQ '').I006100                         X03004 15600000
         IDAERMAC 11,BRANCH,&BLK                                 X03004 15650000
.I006100 AIF   ('&USER' EQ '').I006300                           X03004 15700000
         IDAERMAC 11,USER,&BLK                                   X03004 15750000
.I006300 AIF   ('&RTNCD' EQ '').I006400                          X03004 15800000
         IDAERMAC 11,RTNCD,&BLK                                  X03004 15850000
.I006400 AIF   ('&FDBK2' EQ '').I006500                          X03004 15900000
         IDAERMAC 11,FDBK2,&BLK                                  X03004 15950000
.I006500 AIF   ('&SENSE' EQ '').I006600                          X03004 16000000
         IDAERMAC 11,SENSE,&BLK                                  X03004 16050000
.I006600 AIF   ('&REQ' EQ '').I006700                            X03004 16100000
         IDAERMAC 11,REQ,&BLK                                    X03004 16150000
.I006700 AIF   ('&DATAFLG' EQ '').I006800                        X03004 16200000
         IDAERMAC 11,DATAFLG,&BLK                                X03004 16250000
.I006800 AIF   ('&CHNGDIR' EQ '').I006850                       X3004BS 16300000
         IDAERMAC 11,CHNGDIR,&BLK                               X3004BS 16350000
.I006850 AIF   ('&CODESEL' EQ '').I006900                      @Z40BHUC 16360000
         IDAERMAC 11,CODESEL,&BLK                              @Z40BHUC 16370000
.I006900 AIF   ('&STYPE' EQ '').I007000                         X3004BS 16400000
         IDAERMAC 11,STYPE,&BLK                                 X3004BS 16450000
.I007000 AIF   ('&RTYPE' EQ '').I007100                         X3004BS 16500000
         IDAERMAC 11,RTYPE,&BLK                                 X3004BS 16550000
.I007100 AIF   ('&CHAIN' EQ '').I007200                         X3004BS 16600000
         IDAERMAC 11,CHAIN,&BLK                                 X3004BS 16650000
.I007200 AIF   ('&POST' EQ '').I007300                          X3004BS 16700000
         IDAERMAC 11,POST,&BLK                                  X3004BS 16750000
.I007300 AIF   ('&RESPOND' EQ '').I007400                       X3004BS 16800000
         IDAERMAC 11,RESPOND,&BLK                               X3004BS 16850000
.I007400 AIF   ('&CONTROL' EQ '').I007500                       X3004BS 16900000
         IDAERMAC 11,CONTROL,&BLK                               X3004BS 16950000
.I007500 AIF   ('&OBSQAC' EQ '').I007600                        X3004BS 17000000
         IDAERMAC 11,OBSQAC,&BLK                                X3004BS 17050000
.I007600 AIF   ('&IBSQAC' EQ '').I007700                        X3004BS 17100000
         IDAERMAC 11,IBSQAC,&BLK                                X3004BS 17150000
.I007700 AIF   ('&OBSQVAL' EQ '').I007800                       X3004BS 17200000
         IDAERMAC 11,OBSQVAL,&BLK                               X3004BS 17250000
.I007800 AIF   ('&IBSQVAL' EQ '').I007850                      @Z40BHUC 17300000
         IDAERMAC 11,IBSQVAL,&BLK                               X3004BS 17350000
.I007850 AIF   ('&SIGDATA' EQ '').I007900                      @Z40BHUC 17360000
         IDAERMAC 11,SIGDATA,&BLK                              @Z40BHUC 17370000
.I007900 AIF   ('&SEQNO' EQ '').I008000                         X3004BS 17400000
         IDAERMAC 11,SEQNO,&BLK                                 X3004BS 17450000
.I008000 AIF   ('&SSENSEO' EQ '').I008100                       X3004BS 17500000
         IDAERMAC 11,SSENSEO,&BLK                               X3004BS 17550000
.I008100 AIF   ('&SSENSEI' EQ '').I008200                       X3004BS 17600000
         IDAERMAC 11,SSENSEI,&BLK                               X3004BS 17650000
.I008200 AIF   ('&USENSEO' EQ '').I008300                       X3004BS 17700000
         IDAERMAC 11,USENSEO,&BLK                               X3004BS 17750000
.I008300 AIF   ('&USENSEI' EQ '').I008410                      @Z40BHUC 17800000
         IDAERMAC 11,USENSEI,&BLK                               X3004BS 17850000
.I008410 AIF   ('&BRACKET' EQ '').I008420                       X04SVHS 17953000
         IDAERMAC 11,BRACKET,&BLK                               X04SVHS 17956000
.I008420 AIF   ('&SSENSMO' EQ '').I008430                       X04SVHS 17959000
         IDAERMAC 11,SSENSMO,&BLK                               X04SVHS 17962000
.I008430 AIF   ('&SSENSMI' EQ '').I008440                       X04SVHS 17965000
         IDAERMAC 11,SSENSMI,&BLK                               X04SVHS 17968000
.I008440 AIF   ('&SIGDATA' EQ '').I008450                       X04SVHS 17971000
         IDAERMAC 11,SIGDATA,&BLK                               X04SVHS 17974000
.I008450 AIF   ('&AIXPC' EQ '').I008460                         X04SVHS 17977000
         IDAERMAC 11,AIXPC,&BLK                                 X04SVHS 17980000
.I008460 AIF   ('&AIXFLAG' EQ '').I008470                       X04SVHS 17983000
         IDAERMAC 11,AIXFLAG,&BLK                               X04SVHS 17986000
.I008470 AIF   ('&TRANSID' EQ '').I008480                       X04SVHS 17989000
         IDAERMAC 11,TRANSID,&BLK                               X04SVHS 17992000
.I008480 AIF   ('&FTNCD' EQ '').I008500                         X04SVHS 17995000
         IDAERMAC 11,FTNCD,&BLK                                 X04SVHS 17998000
.I008500 AIF   ('&RPLLEN' EQ '' OR '&BLKTYPE' EQ '').I008510   @G40AKSL 18000000
         IDAERMAC  11,RPLLEN,&BLK                                       18010000
.I008510 AIF   ('&CRYPT' EQ '').I008520                            @LQC 18020000
         IDAERMAC  11,CRYPT,&BLK                               @G40AKSL 18030000
.I008520 AIF   ('&LUWID' EQ '').I008530                            @LQA 18046000
         IDAERMAC  11,LUWID,&BLK                                   @LQA 18062000
.I008530 AIF   ('&TIMEOUT' EQ '').I008600                          @LQA 18078000
         IDAERMAC  11,TIMEOUT,&BLK                                 @LQA 18094000
.******************************                                         18110000
.*       NIB KEYWORDS ONLY                                              18120000
.******************************                                         18130000
.I008600 AIF   ('&BLK' EQ 'NIB').I010000                                18150000
         AIF   ('&NAME' EQ '').I008700                           X03004 18200000
         IDAERMAC 11,NAME,&BLK                                   X03004 18250000
.I008700 AIF   ('&USERFLD' EQ '').I008800                        X03004 18300000
         IDAERMAC 11,USERFLD,&BLK                                X03004 18350000
.I008800 AIF   ('&MODE' EQ '').I008900                           X03004 18400000
         IDAERMAC 11,MODE,&BLK                                   X03004 18450000
.I008900 AIF   ('&LISTEND' EQ '').I009000                        X03004 18500000
         IDAERMAC 11,LISTEND,&BLK                                X03004 18550000
.I009000 AIF   ('&CONDN' EQ '').I009100                          X03004 18600000
         IDAERMAC 11,CONDN,&BLK                                  X03004 18650000
.I009100 AIF   ('&PROC' EQ '').I009200                           X03004 18700000
         IDAERMAC 11,PROC,&BLK                                   X03004 18750000
.I009200 AIF   ('&CID' EQ '').I009300                            X03004 18800000
         IDAERMAC 11,CID,&BLK                                    X03004 18850000
.I009300 AIF   ('&DEVCHAR' EQ '').I009400                        X03004 18900000
         IDAERMAC 11,DEVCHAR,&BLK                                X03004 18950000
.I009400 AIF   ('&CON' EQ '').I009500                            X03004 19000000
         IDAERMAC 11,CON,&BLK                                    X03004 19050000
.I009500 AIF   ('&EXLST' EQ '' OR '&BLK' EQ 'ACB').I009600      X3004BS 19100000
         AIF   ('&CALLER' NE 'GENCB'  AND  '&BLK' EQ 'EXLST').I009600   19150000
         IDAERMAC 11,EXLST,&BLK                                 X3004BS 19200000
.I009600 AIF   ('&RESPLIM' EQ '').I009700                       X3004BS 19250000
         IDAERMAC 11,RESPLIM,&BLK                               X3004BS 19300000
.I009700 AIF   ('&SDT' EQ '').I009800                           X3004BS 19350000
         IDAERMAC 11,SDT,&BLK                                   X3004BS 19400000
.I009800 AIF   ('&PROC' EQ '').I009840                         @Z40BHUC 19450000
         IDAERMAC 11,PROC,&BLK                                  X3004BS 19500000
.I009840 AIF   ('&LOGMODE' EQ '').I009870                      @Z40BHUC 19510000
         IDAERMAC 11,LOGMODE,&BLK                              @Z40BHUC 19520000
.I009870 AIF   ('&BNDAREA' EQ '').I009900                      @Z40BHUC 19530000
         IDAERMAC 11,BNDAREA,&BLK                              @Z40BHUC 19540000
.I009900 AIF   ('&NIBLEN' EQ ''  OR  '&BLKTYPE' EQ '').I009910 @G40AKSL 19550000
         IDAERMAC 11,NIBLEN,&BLK                                 X03004 19560000
.I009910 AIF   ('&ENCR' EQ '').I010000                         @G40AKSL 19570000
         IDAERMAC 11,ENCR,&BLK                                 @G40AKSL 19580000
.******************************                                         19610000
.*       ACB KEYWORDS ONLY                                              19620000
.******************************                                         19630000
.I010000 AIF   ('&BLK' EQ 'ACB').I013100                                19650000
         AIF   ('&ATRB' EQ '').I010100                                  19700000
         IDAERMAC 11,ATRB,&BLK                                          19750000
.I010100 AIF   ('&AVSPAC' EQ '').I010200                                19800000
         IDAERMAC 11,AVSPAC,&BLK                                        19850000
.I010200 AIF   ('&BUFND' EQ '').I010300                                 19900000
         IDAERMAC 11,BUFND,&BLK                                         19950000
.I010300 AIF   ('&BUFNI' EQ '').I010400                                 20000000
         IDAERMAC 11,BUFNI,&BLK                                         20050000
.I010400 AIF   ('&BUFNO' EQ '').I010500                                 20100000
         IDAERMAC 11,BUFNO,&BLK                                         20150000
.I010500 AIF   ('&BUFSP' EQ '').I010600                                 20200000
         IDAERMAC 11,BUFSP,&BLK                                         20250000
.I010600 AIF   ('&CINV' EQ '').I010700                                  20300000
         IDAERMAC 11,CINV,&BLK                                          20350000
.I010700 AIF   ('&DDNAME' EQ '').I010800                                20400000
         IDAERMAC 11,DDNAME,&BLK                                        20450000
.I010800 AIF   ('&ENDRBA' EQ '').I010900                                20500000
         IDAERMAC 11,ENDRBA,&BLK                                        20550000
.I010900 AIF   ('&ERROR' EQ '').I011000                                 20600000
         IDAERMAC 11,ERROR,&BLK                                         20650000
.I011000 AIF   ('&EXLST' EQ '').I011100                                 20700000
         AIF   ('&BLK' EQ 'NIB').I011100                        X3004BS 20750000
         AIF   ('&CALLER' NE 'GENCB'  AND  '&BLK' EQ 'EXLST').I011100   20800000
         IDAERMAC 11,EXLST,&BLK                                         20850000
.I011100 AIF   ('&FS' EQ '').I011150                           @XM01140 20900000
         IDAERMAC 11,FS,&BLK                                            20950000
.I011150 AIF   ('&JFCB' EQ '').I011200                         @XM01140 20960000
         IDAERMAC 11,JFCB,&BLK                                 @XM01140 20970000
.I011200 AIF   ('&LRECL' EQ '').I011300                                 21000000
         IDAERMAC 11,LRECL,&BLK                                         21050000
.I011300 AIF   ('&MACRF' EQ '').I011400                                 21100000
         IDAERMAC 11,MACRF,&BLK                                         21150000
.I011400 AIF   ('&NCIS' EQ '').I011500                                  21200000
         IDAERMAC 11,NCIS,&BLK                                          21250000
.I011500 AIF   ('&NDELR' EQ '').I011600                                 21300000
         IDAERMAC 11,NDELR,&BLK                                         21350000
.I011600 AIF   ('&NEXCP' EQ '').I011700                                 21400000
         IDAERMAC 11,NEXCP,&BLK                                         21450000
.I011700 AIF   ('&NEXT' EQ '').I011800                                  21500000
         IDAERMAC 11,NEXT,&BLK                                          21550000
.I011800 AIF   ('&NINSR' EQ '').I011900                                 21600000
         IDAERMAC 11,NINSR,&BLK                                         21650000
.I011900 AIF   ('&NIXL' EQ '').I012000                                  21700000
         IDAERMAC 11,NIXL,&BLK                                          21750000
.I012000 AIF   ('&NLOGR' EQ '').I012100                                 21800000
         IDAERMAC 11,NLOGR,&BLK                                         21850000
.I012100 AIF   ('&NRETR' EQ '').I012200                                 21900000
         IDAERMAC 11,NRETR,&BLK                                         21950000
.I012200 AIF   ('&NSSS' EQ '').I012300                                  22000000
         IDAERMAC 11,NSSS,&BLK                                          22050000
.I012300 AIF   ('&NUPDR' EQ '').I012400                                 22100000
         IDAERMAC 11,NUPDR,&BLK                                         22150000
.I012400 AIF   ('&OFLAGS' EQ '').I012500                                22200000
         IDAERMAC 11,OFLAGS,&BLK                                        22250000
.I012500 AIF   ('&PASSWD' EQ '').I012600                                22300000
         IDAERMAC 11,PASSWD,&BLK                                        22350000
.I012600 AIF   ('&RKP' EQ '').I012700                                   22400000
         IDAERMAC 11,RKP,&BLK                                           22450000
.I012700 AIF   ('&STRNO' EQ '').I012800                                 22500000
         IDAERMAC 11,STRNO,&BLK                                         22550000
.I012800 AIF   ('&STMST' EQ '').I012900                                 22600000
         IDAERMAC 11,STMST,&BLK                                         22650000
.I012900 AIF   ('&APPLID' EQ '').I013010                        X04SVHS 22700000
         IDAERMAC 11,APPLID,&BLK                                 X03004 22750000
.I013010 AIF   ('&BSTRNO' EQ '').I013020                        X04SVHS 22753000
         IDAERMAC 11,BSTRNO,&BLK                                X04SVHS 22756000
.I013020 AIF   ('&MAREA' EQ '').I013030                         X04SVHS 22759000
         IDAERMAC 11,MAREA,&BLK                                 X04SVHS 22762000
.I013030 AIF   ('&MLEN' EQ '').I013040                          X04SVHS 22765000
         IDAERMAC 11,MLEN,&BLK                                  X04SVHS 22768000
.I013040 AIF   ('&CRA' EQ '').I013050                           X04SVHS 22771000
         IDAERMAC 11,CRA,&BLK                                   X04SVHS 22774000
.I013050 AIF   ('&AIXRKP' EQ '').I013060                        X04SVHS 22777000
         IDAERMAC 11,AIXRKP,&BLK                                X04SVHS 22780000
.I013060 AIF   ('&OPENOBJ' EQ '').I013070                               22783000
         IDAERMAC 11,OPENOBJ,&BLK                               X04SVHS 22784000
.I013070 AIF   ('&SHRPOOL' EQ '').I013075                          @L3C 22786000
         IDAERMAC 11,SHRPOOL,&BLK                                  @LPA 22787800
.I013075 AIF   ('&RMODE31' EQ '').I013080                          @LPA 22789600
         IDAERMAC 11,RMODE31,&BLK                                  @LPA 22791400
.I013080 AIF   ('&USERPTR' EQ '').I013000                          @LPC 22793200
         IDAERMAC 11,USERPTR,&BLK                              @XM01129 22795000
.I013000 AIF   ('&ACBLEN' EQ ''  OR  '&BLKTYPE' EQ '').I013085     @LQC 22822500
         IDAERMAC 11,ACBLEN,&BLK                                        22850000
.I013085 AIF   ('&RLSREAD' EQ '').I013090                          @LQA 22857100
         IDAERMAC 11,RLSREAD,&BLK                                  @LQA 22864200
.I013090 AIF   ('&CTRLACB' EQ '').I013091                          @EAC 22871300
         IDAERMAC 11,CTRLACB,&BLK                                  @LQA 22878400
.I013091 AIF   ('&XAVSPAC' EQ '').I013092                          @EAA 22879400
         IDAERMAC 11,XAVSPAC,&BLK                                  @EAA 22880400
.I013092 AIF   ('&XENDRBA' EQ '').I013093                          @EAA 22881400
         IDAERMAC 11,XENDRBA,&BLK                                  @EAA 22882400
.I013093 AIF   ('&XHALCRBA' EQ '').I013095                         @EAA 22883400
         IDAERMAC 11,XHALCRBA,&BLK                                 @EAA 22884400
.I013095 AIF   ('&SUBSYSNM' EQ '').I013100                         @LQA 22885500
         IDAERMAC 11,SUBSYSNM,&BLK                                 @LQA 22892600
.I013100   AIF   ('&CALLER' NE 'TEST'  OR  &IDAENO LE 1).I013200        22900000
         IDAERMAC 9,&IDAENO                                             22950000
         MEXIT                                                          23000000
.I013200 AIF   (NOT &IDACB01).I013300                                   23050000
         MEXIT                         EXIT IF ANY ERRORS DETECTED      23100000
.********************************************************************** 23110000
.I013300 ANOP                                                           23150000
&I       SETA  &IDAENO+1                                                23200000
.I013400 ANOP                          SET DEFAULT ELEMENT LENGTH TO 4  23250000
&I       SETA  &I-1                                                     23300000
         AIF   (&I LE 0).I013500                                        23350000
         AIF   (&IDAELEN(&I) NE 0).I013400                              23400000
&IDAELEN(&I) SETA 4                                                     23450000
         AIF   (&BTC EQ &ACBID AND &IDAEID(&I) EQ X'12').I013450        23466600
.*                                IF ACB AND MACRF, SET LEN=12 @WA21279 23483200
         AIF   (&BTC NE &EXLID OR '&MF(1)' EQ 'E').I013400              23500000
&IDAELEN(&I) SETA 8                                                     23550000
         AGO   .I013400                                                 23600000
.I013450 ANOP                     ACB AND MACRF, LENGTH = 12   @WA21279 23612500
&IDAELEN(&I) SETA 12                                           @WA21279 23625000
         AGO   .I013400                                        @WA21279 23637500
.*                                                                      23650000
.* CODE GENERATION                                                      23700000
.*                                                                      23750000
.I013500 ANOP                                                           23800000
         AIF   ('&MF(1)' NE 'E').I016600                                23850000
.********************************************************************** 23860000
.* EXECUTE FORM ******************************************************* 23900000
.********************************************************************** 23910000
         IDACB1 ARG=&MF,ARGNAME=MF,TYPE=C,POS=2,MF=E                    23950000
         AIF   (&IDACB11 EQ &AN2).I013600 S TYPE ADCON SPECIFIED        24000000
         AIF   (&IDACB11 EQ &AN3).I013700 INDIRECT ADDR SPECIFIED       24050000
         AIF   (&IDACB11 EQ &AN4).I013800 A TYPE ADCON SPECIFIED        24100000
         AIF   ('&IDACB13' EQ '1').I013900  PARM LIST IN REG 1          24150000
&LABEL   LR    1,&IDACB13              POINT TO PARAMETER LIST          24200000
         AGO   .I014000                                                 24250000
.I013600 ANOP                                                           24300000
.*                                      S TYPE ADCON                    24310000
&LABEL   DC    X'4110'                 POINT TO ...                     24356600
         DC    S(&IDACB13)             PARAMETER LIST                   24403200
         AGO   .I014000                                                 24450000
.I013700 ANOP                                                           24500000
.*                                      INDIRECT ADDRESS                24510000
&LABEL   DC    X'4110'                 POINT TO ...                     24557500
         DC    S(&IDACB13)             PARAMETER LIST ADDRESS           24605000
         L     1,0(,1)                 POINT TO PARAMETER LIST          24652500
         AGO   .I014000                                                 24700000
.I013800 ANOP                                                           24750000
.*                                      A TYPE ADCON                    24760000
&LABEL   LA    1,&IDACB13              POINT TO PARAMETER LIST          24805000
         AGO   .I014000                                                 24850000
.I013900 AIF   ('&LABEL' EQ '').I014000                                 24900000
         DS    0H                                               XA03893 24925000
&LABEL   EQU   *                                                        24950000
.I014000 ANOP                                                           25000000
         L     15,0(,1)                POINT TO HEADER                  25050000
         TM    1(15),X'10'             TEST LIST FOR AM=VTAM     X03004 25100000
         AIF   ('&AM' EQ 'VTAM').I014100                                25150000
         BO    &ERRLBL                 ERROR IF ON EXECUTE       X03004 25179100
         AIF   ('&CALLER' NE 'GEN').I014200                        @L9A 25208300
         AIF   ('&GENFG1' NE '00000000').I014010                   @L9A 25216600
         NI    10(15),X'00'            CLEAR GENFLAG1 BITS         @L9A 25224900
         AGO   .I014200                                            @L9A 25233200
.I014010 OI    10(15),B'&GENFG1'       SET GENFLAG1 BITS           @L9A 25241600
         AGO   .I014200                                                 25250000
.I014100 ANOP                                                    X03004 25300000
         BZ    &ERRLBL                 ERROR IF NOT ON EXECUTE   X03004 25350000
.I014200 ANOP                                                    X03004 25400000
&I       SETA  &IDACB04(1)+&IDACB04(2)+&IDACB04(3)+&IDACB04(4)          25450000
.*             NO HEADER ACE IS BUILT IF EXECUTE FORM AND WAREA,        25460000
.*             LENGTH, AND COPIES PARAMETERS ARE NULL                   25470000
         AIF   (&I+&IDAENO LE 0).I016400                                25500000
         AIF   (&I LE 0).I015100                                        25550000
.* MODIFY HEADER ARGUMENT CONTROL ENTRY  -  MF=E                        25600000
&I       SETA  &IDACB02+1              NUMBER OF FIELDS IN HEADER       25650000
.I014300 ANOP                                                           25700000
&I       SETA  &I-1                                                     25750000
         AIF   (&I LE 0).I015000         TEST FOR END OF LIST           25800000
         AIF   (&IDACB04(&I) LE 0).I014300 TEST FOR FLD TO BE MODIFIED  25850000
&WORKA   SETA  4-&IDACB07(&I)                                           25900000
         AIF   (&IDACB04(&I) EQ &AN3).I014800  INDIRECT ADDR SPECIFIED  25950000
         AIF   (&IDACB04(&I) EQ &AN4).I014900  A TYPE ADCON SPECIFIED   26000000
&H       SETC  ''                                                       26050000
         AIF   (&IDACB07(&I) NE 2).I014400 TEST FOR HALF-WORD FIELD     26100000
&H       SETC  'H'                                                      26150000
.I014400 AIF   (&IDACB04(&I) EQ &AN1).I014600  REGISTER SPECIFICATION   26200000
         AIF   (&IDACB04(&I) EQ &AN2).I014700  S TYPE ADCON SPECIFIED   26250000
         AIF   (&IDACB04(&I) EQ &VN1).I014500  SELF DEFINING TERM       26300000
         IDAERMAC 7,IDACB2-HMOD        INVALID HEADER TYPE CODE         26350000
         MEXIT                                                          26400000
.*                                     *** VN1 ***  SELF DEFINING TERM  26450000
.I014500 LA    14,&IDACB05(&I)         LOAD HEADER FIELD VALUE          26500000
         ST&H  14,&IDACB06(&I)(,15)    STORE VALUE IN HEADER            26550000
         AGO   .I014300                                                 26600000
.*                                     *** AN1 ***  REG SPECIFIECATION  26650000
.I014600 ST&H  &IDACB05(&I),&IDACB06(&I)(,15) STORE VALUE IN HEADER     26700000
         AGO   .I014300                                                 26750000
.*                                     *** AN2 ***  S TYPE ADCON        26800000
.I014700 DC    X'41E0'                 LOAD VALUE ...                   26850000
         DC    S(&IDACB05(&I))         OF HEADER FIELD                  26900000
         ST&H  14,&IDACB06(&I)(,15)    STORE VALUE IN HEADER            26950000
         AGO   .I014300                                                 27000000
.*                                     *** AN3 ***  INDIRECT ADDRESS    27050000
.I014800 DC    X'41E0'                 LOAD POINTER TO ...              27100000
         DC    S(&IDACB05(&I))         VALUE OF HEADER FIELD            27150000
         MVC   &IDACB06(&I)(&IDACB07(&I),15),&WORKA.(14)               -27200000
                                       MOVE VALUE TO HEADER             27250000
         AGO   .I014300                                                 27300000
.*                                     *** AN4 ***  A TYPE ADCON        27350000
.I014900 CNOP  0,4                                                      27400000
         BAL   14,*+8                  BRANCH AROUND CONSTANT           27450000
         DC    A(&IDACB05(&I))         VALUE OF HEADER FIELD            27500000
         MVC   &IDACB06(&I)(&IDACB07(&I),15),&WORKA.(14)               -27550000
                                       MOVE VALUE TO HEADER             27600000
         AGO   .I014300                                                 27650000
.I015000 AIF   (&IDAENO LE 0).I016400    TEST FOR NO ELEMENTS TO MODIFY 27700000
.******************************                                         27710000
.* LOCATE AND MODIFY ELEMENT ARGUMENT CONTROL ENTRIES   -   MF=E        27750000
.******************************                                         27760000
.I015100 ANOP                                                           27800000
&I       SETA  0                                                        27850000
.I015200 ANOP                                                           27900000
&I       SETA  &I+1                                                     27950000
         AIF   (&I GT &IDAENO).I016400 TEST FOR ALL ELEMENTS MODIFIED   28000000
         LR    14,1                    POINT TO PARAMETER LIST          28050000
         AIF   (&I GT 1).I015300         TEST FOR FIRST ELEMENT         28100000
         B     *+20                    BYPASS HEADER                    28145500
.I015300 LA    14,4(,14)               POINT TO NEXT PLIST ENTRY        28191000
         L     15,0(,14)               POINT TO NEXT ELEMENT            28236500
         CLI   1(15),&IDAEID(&I)       TEST ELEMENT ID                  28282000
         BE    *+14                    BRANCH IF ELEMENT FOUND          28327500
         LTR   15,15                   TEST FOR END OF PARAMETER LIST   28373000
         BP    *-18                    CONTINUE SEARCH IF NOT END       28418500
         B     &ERRLBL                 ELEMENT NOT FOUND - ERROR        28464000
.*                                                                      28510000
         AIF   (&IDAETYP(&I) EQ &VN1).I015400 SELF DEFINING TERM        28550000
         AIF   (&IDAETYP(&I) EQ &VN2).I015500 BIT STRING                28600000
         AIF   (&IDAETYP(&I) EQ &VN3).I015800 CHARACTER STRING          28650000
         AIF   (&IDAETYP(&I) EQ &AN1).I015900 REGISTER SPECIFICATION    28700000
         AIF   (&IDAETYP(&I) EQ &AN2).I016000 S TYPE ADCON              28750000
         AIF   (&IDAETYP(&I) EQ &AN3).I016100 INDIRECT ADDRESS          28800000
         AIF   (&IDAETYP(&I) EQ &AN4).I016200 A TYPE ADCON              28850000
         AIF   (&IDAETYP(&I) EQ 0).I016300                              28900000
         IDAERMAC 7,IDACB2-EMOD                                         28950000
         MEXIT                                                          29000000
.*                                     *** VN1 *** SELF DEFINING TERM   29050000
.I015400 LA    14,&IDAVALC(&I)         LOAD ELEMENT VALUE               29100000
         ST    14,4(,15)               STORE VALUE IN ELEMENT           29150000
         AGO   .I015200                                                 29200000
.*                                     *** VN2 *** BIT STRING           29250000
.I015500 AIF   (&IDAEID(&I) EQ X'34').I015600 TEST FOR OPTCD     X03004 29300000
         AIF   (&IDAEID(&I) EQ X'50').I015700 TEST FOR PROC      X03004 29350000
         AIF   (&IDAEID(&I) EQ X'12').I015750 TEST FOR MACRF       @LQA 29382000
         BAL   14,*+8                  BRANCH AROUND CONSTANT    X03004 29414000
         DC    B'&IDAVALC(&I)'         BINARY VALUE                     29446000
         MVC   4(4,15),0(14)           MOVE VALUE TO ELEMENT            29478000
         AIF   (&IDAEID(&I) EQ X'40').I016300                   X04SVHS 29510000
.*             IF KEYWORD IS AM, CHECK FOR EXLST                        29520000
         AGO   .I015200                                                 29550000
.I015600 BAL   14,*+16                 BRANCH AROUND CONSTANT    X03004 29600000
         DC    B'&IDAVALC(&I)'         BINARY VALUE              X03004 29650000
         DC    B'&IDAOPT2'             BINARY VALUE              X03004 29700000
         DC    B'&IDAOPT3'             BINARY VALUE              X03004 29750000
         MVC   4(12,15),0(14)          MOVE VALUE TO ELEMENT     X03004 29800000
         AGO   .I015200                                                 29850000
.I015700 BAL   14,*+12                 BRANCH AROUND CONSTANT    X03004 29900000
         DC    B'&IDAVALC(&I)'         BINARY VALUE              X03004 29950000
         DC    B'&IDAPRC2'             BINARY VALUE              X03004 30000000
         MVC   4(8,15),0(14)           MOVE VALUE TO ELEMENT     X03004 30050000
         AGO   .I015200                                                 30100000
.I015750 BAL   14,*+12                 BRANCH AROUND CONSTANT      @LQA 30108300
         DC    B'&IDAVALC(&I)'         BINARY VALUE                @LQA 30116600
         DC    B'&IDAMAC2'             BINARY VALUE                @LQA 30124900
         MVC   4(8,15),0(14)           MOVE VALUE TO ELEMENT       @LQA 30133200
         AGO   .I015200                                            @LQA 30141500
.*                                     *** VN3 *** CHARACTER STRING     30150000
.I015800 BAL   14,*+12                 BRANCH AROUND CONSTANT           30200000
         DC    CL8'&IDAVALC(&I)'       EIGHT-BYTE CHARACTER STRING      30250000
         MVC   4(8,15),0(14)           MOVE CHARACTER STRING TO ELEMENT 30300000
         AGO   .I015200                                                 30350000
.*                                     *** AN1 *** REG SPECIFICATION    30400000
.I015900 ST    &IDAVALC(&I),4(,15)     STORE VALUE IN ELEMENT           30450000
         AGO   .I016300                                                 30500000
.*                                     *** AN2 *** S TYPE ADCON         30550000
.I016000 DC    X'41E0'                 LOAD ADDRESS VALUE               30600000
         DC    S(&IDAVALC(&I))                                          30650000
         ST    14,4(,15)               STORE VALUE IN ELEMENT           30700000
         AGO   .I016300                                                 30750000
.*                                     *** AN3 *** INDIRECT ADDRESS     30800000
.I016100 DC    X'41E0'                 LOAD POINTER ...                 30850000
         DC    S(&IDAVALC(&I))         TO VALUE                         30900000
         MVC   4(&IDAELEN(&I),15),0(14) MOVE VALUE TO ELEMENT           30950000
         AGO   .I016300                                                 31000000
.*                                     *** AN4 *** A TYPE ADCON         31050000
.I016200 CNOP  0,4                                                      31100000
         BAL   14,*+8                  BRANCH AROUND CONSTANT           31150000
         DC    A(&IDAVALC(&I))         ADDRESS VALUE                    31200000
         MVC   4(4,15),0(14)           MOVE VALUE TO ELEMENT            31250000
.I016300 AIF   (&BTC NE &EXLID OR &IDAEID(&I) EQ 42).I015200            31300000
.*             IF EXLST EXIT FLAGS MUST BE GENERATED                    31310000
.*                                     *** EXIT LIST ENTRY ***          31350000
         BAL   14,*+8                  BRANCH AROUND CONSTANT           31400000
         DC    B'&IDAVALX(&I)'         EXIT ATTRIBUTES                  31450000
         MVC   8(4,15),0(14)           MOVE ATTRIBUTES TO ELEMENT       31500000
         AGO   .I015200                                                 31550000
.I016400 B     IDA&SYSNDX.B            BRANCH AROUND ERR CODE  X03004HS 31591600
&ERRLBL  LA    15,8                    SET ERROR RETURN CODE            31633200
         AIF   (&IDABUG).I016500         TEST FOR DEBUG MODE            31674800
         CNOP  0,4                     ADJUST TO WORD BOUNDARY @Z40BHCJ 31716400
         B     *+20                    BYPASS LINKAGE          @Z40BHCJ 31758000
         AGO   .I022100                                         X04SVHS 31800000
.I016500 ANOP                                                  X03004HS 31850000
         CNOP  0,4                     ADJUST TO WORD BOUNDARY X03004HS 31890000
         B     *+20                    BYPASS LINKAGE          @Z40BHCJ 31930000
         AGO   .I022000                  ISSUE CALL FOR IDA019C1        31970000
.********************************************************************** 32010000
.* STANDARD FORM ****************************************************** 32050000
.* DYNAMIC MODIFICATION *********************************************** 32100000
.********************************************************************** 32110000
.I016600 ANOP                                                           32150000
&PLLEN   SETA  4*(&IDAENO+1)              CALCULATE LENGTH OF PARM LIST 32200000
.*      CALC OFFSET FROM START OF PARM LIST TO EACH ELEMENT VALUE FIELD 32250000
&EOFF(1) SETA  &PLLEN+&IDACB03+4        ACCOUNT FOR LENGTH OF HEADER    32300000
&I       SETA  1                                                        32350000
.I016700 ANOP                                                           32400000
&I       SETA  &I+1                                                     32450000
         AIF   (&I GT &IDAENO).I016800  CHECK FOR END OF LIST           32500000
&EOFF(&I) SETA &EOFF(&I-1)+&IDAELEN(&I-1)+4                             32550000
.*                                      SET ELEMENT OFFSET ARRAY        32560000
         AGO   .I016700                                                 32600000
.*      MODIFY HEADER ARGUMENT CONTROL ENTRY  -  MF=S                   32650000
.I016800 AIF   ('&MF' NE 'L').I016900   CHECK FOR LIST FORM             32700000
         AIF   ('&LABEL' EQ '').I018700                                 32750000
&PLLBL   SETC  '&LABEL'                                                 32800000
         AGO   .I018700                                                 32850000
.I016900 AIF   ('&LABEL' EQ '').I017000                                 32900000
         DS    0H                                               XA03893 32925000
&LABEL   EQU   *                                                        32950000
.I017000 AIF   (&RMF).I020600            GO IF MF = REENTRANT           33000000
.I017100 ANOP                                                           33050000
&I       SETA  0                                                        33100000
.I017200 ANOP                                                           33150000
&I       SETA  &I+1                                                     33200000
         AIF   (&I GT &IDACB02).I017800  TEST FOR END OF HEADER LIST    33250000
         AIF   (&IDACB04(&I) LT &AN1 OR &IDACB04(&I) GT &AN3).I017200   33300000
.*             CHECK IF HEADER ELEMENT IS REGISTER SPECIFICATION,       33310000
.*             S TYPE ADCON, OR INDIRECT ADDRESS                        33320000
&H       SETC  ''                                                       33350000
         AIF   (&IDACB07(&I) NE 2).I017300                              33400000
&H       SETC  'H'                                                      33450000
.I017300 ANOP                                                           33500000
&WORKA   SETA  &PLLEN+&IDACB06(&I)     CALC OFFSET FROM START OF PLIST  33550000
         AIF   (&IDACB04(&I) EQ &AN3).I017600                           33600000
.*                                      CHECK FOR INDIRECT ADDRESS      33610000
&WORKC   SETC  '&WORKA'.'(,1)'         OPERAND 2 FOR MF = REENTRANT     33650000
         AIF   (&RMF).I017400                                           33700000
&WORKC   SETC  '&PLLBL'.'+'.'&WORKA'   OPERAND 2 FOR MF = S/L           33750000
.I017400 AIF   (&IDACB04(&I) EQ &AN2).I017500 CHECK FOR S TYPE ADCON    33800000
         AIF   (&IDACB04(&I) EQ &AN3).I017600 CHECK FOR INDIRECT ADDR   33850000
.*                                     *** AN1 *** REG SPECIFICATION    33900000
         ST&H  &IDACB05(&I),&WORKC     STORE VALUE IN HEADER            33950000
         AGO   .I017200                                                 34000000
.*                                     *** AN2 *** S TYPE ADCON         34050000
.I017500 DC    X'41F0'                 LOAD ADDRESS VALUE ...           34100000
         DC    S(&IDACB05(&I))         FOR HEADER FIELD                 34150000
         ST&H  15,&WORKC               STORE VALUE IN HEADER            34200000
         AGO   .I017200                                                 34250000
.*                                     *** AN3 *** INDIRECT ADDRESS     34300000
.I017600 DC    X'41F0'                 LOAD POINTER TO VALUE            34350000
         DC    S(&IDACB05(&I))         FOR HEADER FIELD                 34400000
&J       SETA  4-&IDACB07(&I)          CALC OFFSET IN USER FIELD        34450000
&WORKC   SETC  '&WORKA'.'('.'&IDACB07(&I)'.',1)' OPERND 1 FOR MF=REENT  34500000
         AIF   (&RMF).I017700                                           34550000
&WORKC   SETC  '&PLLBL'.'+'.'&WORKA'.'('.'&IDACB07(&I)'.')' OP1 MF=S/L  34600000
.I017700 MVC   &WORKC,&J.(15)          MOVE VALUE TO HEADER             34650000
         AGO   .I017200                                                 34700000
.******************************                                         34710000
.*      MODIFY ELEMENT ARGUMENT CONTROL ENTRIES  -  MF=S                34750000
.******************************                                         34760000
.I017800 ANOP                                                           34800000
&I       SETA  0                                                        34850000
.I017900 ANOP                                                           34900000
&I       SETA  &I+1                                                     34950000
         AIF   (&I GT &IDAENO).I018500    TEST FOR END OF ELEMENT LIST  35000000
         AIF   (&IDAETYP(&I) LT &AN1 OR &IDAETYP(&I) GT &AN3).I017900   35050000
.*             CHECK IF ELEMENT TYPE IS REGISTER SPECIFICATION,         35060000
.*             S TYPE ADCON, OR INDIRECT ADDRESS                        35070000
         AIF   (&IDAETYP(&I) EQ &AN3).I018200 CHECK FOR INDIRECT ADDR   35100000
&WORKC   SETC  '&EOFF(&I)'.'(,1)'      OPERAND 2 FOR MF = REENTRANT     35150000
         AIF   (&RMF).I018000                                           35200000
&WORKC   SETC  '&PLLBL'.'+'.'&EOFF(&I)' OPERAND 2 FOR MF = S/L          35250000
.I018000 AIF   (&IDAETYP(&I) EQ &AN2).I018100                           35300000
.*                                     *** AN1 *** REG SPECIFICATION    35350000
         ST    &IDAVALC(&I),&WORKC     STORE VALUE IN ELEMENT           35400000
         AGO   .I017900                                                 35450000
.*                                     *** AN2 *** S TYPE ADCON         35500000
.I018100 DC    X'41F0'                 LOAD ADDRESS VALUE               35550000
         DC    S(&IDAVALC(&I))                                          35600000
         ST    15,&WORKC                                                35650000
         AGO   .I017900                                                 35700000
.*                                     *** AN3 *** INDIRECT ADDRESS     35750000
.I018200 DC    X'41F0'                 LOAD POINTER TO VALUE            35800000
         DC    S(&IDAVALC(&I))                                          35850000
&J       SETA  4                                                        35900000
         AIF   (&BTC EQ &EXLID AND &IDAEID(&I) NE 42).I018300           35950000
&J       SETA  &IDAELEN(&I)                                             36000000
.I018300 ANOP                                                           36050000
&WORKC   SETC  '&EOFF(&I)'.'('.'&J'.',1)' OPERAND 1 FOR MF = REENT      36100000
         AIF   (&RMF).I018400                                           36150000
&WORKC   SETC  '&PLLBL'.'+'.'&EOFF(&I)'.'('.'&J'.')'                    36200000
.*                                     OP 1 FOR MF = S/L                36202000
.I018400 MVC   &WORKC,0(15)            MOVE VALUE TO ELEMENT            36251000
         AGO   .I017900                                                 36300000
.I018500 AIF   (&RMF).I021900            GO IF MF = REENTRANT           36350000
         AIF   (&IDAENO GE 1).I018600   TEST FOR NO ELEMENTS IN LIST    36400000
         CNOP  0,4                                                      36450000
&WORKA   SETA  &IDACB03+4                                               36500000
         BAL   1,&PLLBL+&WORKA         BRANCH AROUND CONSTANTS          36550000
         AGO   .I018700                                                 36600000
.I018600 CNOP  0,4                                                      36650000
&WORKA   SETA  &EOFF(&IDAENO)+&IDAELEN(&IDAENO)                         36700000
         BAL   1,&PLLBL+&WORKA         BRANCH AROUND CONSTANTS          36730000
.********************************************************************** 36760000
.* STANDARD AND LIST FORMS ******************************************** 36800000
.* BUILD PARAMETER LIST                                                 36850000
.********************************************************************** 36860000
.I018700 AIF   (&IDAENO GT 0).I018800  TEST FOR NO ELEMENTS IN LIST     36900000
&PLLBL   DC    A(*+4+X'80000000')      ADDRESS OF HEADER                36950000
         AGO   .I019100                                                 37000000
.I018800 ANOP                                                           37050000
&PLLBL   DC    A(*+&PLLEN)             ADDRESS OF HEADER                37100000
&I       SETA  0                                                        37150000
.I018900 ANOP                                                           37200000
&I       SETA  &I+1                                                     37250000
         AIF   (&I GE &IDAENO).I019000                                  37300000
&WORKA   SETA  &EOFF(&I)-4                                              37350000
         DC    A(&PLLBL+&WORKA)        ELEMENT ADDRESS                  37400000
         AGO   .I018900                                                 37450000
.I019000 ANOP                                                           37500000
&WORKA   SETA  &EOFF(&I)-4                                              37550000
         DC    A(&PLLBL+&WORKA+X'80000000') ADDRESS OF LAST ELEMENT     37580000
.******************************                                         37610000
.* BUILD HEADER ARGUMENT CONTROL ENTRY                                  37650000
.******************************                                         37660000
.I019100 DC    AL1(&BTC)               BLOCK TYPE CODE                  37706600
         DC    AL1(&FTC)               FUNCTION TYPE CODE               37753200
&I       SETA  0                                                        37800000
.I019200 ANOP                                                           37850000
&I       SETA  &I+1                                                     37900000
         AIF   (&I GT &IDACB02).I019400                                 37950000
         AIF   (&IDACB04(&I) EQ &VN1 OR &IDACB04(&I) EQ &AN4).I019300   38000000
.******************************                                         38002000
.*             CHECK IF HEADER TYPE IS SELF DEFINING TERM OR            38010000
.*             A TYPE ADCON.                                            38020000
.******************************                                         38030000
         AIF   ((&I EQ &IDACB02) AND                                   -38036600
                ('&CALLER' EQ 'GEN')).I019210                      @L9A 38043200
         DC    AL&IDACB07(&I)(0)        HEADER FIELD VALUE              38071600
         AGO   .I019200                                                 38100000
.I019210 ANOP                                                           38110000
         DC    B'&GENFG1'               GENCB FLAGS                @L9A 38120000
         DC    AL1(0)                   RESERVED                   @L9A 38130000
         AGO   .I019400                                            @L9A 38140000
.I019300 DC    AL&IDACB07(&I)(&IDACB05(&I)) HEADER FIELD VALUE          38170000
         AGO   .I019200                                                 38200000
.******************************                                         38210000
.* BUILD ELEMENT ARGUMENT CONTROL ENTRIES                               38250000
.******************************                                         38260000
.I019400 ANOP                                                           38300000
&I       SETA  0                                                        38350000
.I019500 ANOP                                                           38400000
&I       SETA  &I+1                                                     38450000
         AIF   (&I GT &IDAENO).I020500                                  38500000
         DC    AL2(&IDAEID(&I))           ELEMENT ID                    38550000
         AIF   (&IDAEID(&I) NE X'34').I019600 TEST FOR OPTCD     X03004 38600000
         DC    AL2(2)                  BIT STRING LENGTH         X03004 38650000
         AGO   .I019800                                          X03004 38700000
.I019600 AIF   (&IDAEID(&I) NE X'50').I019700 TEST FOR PROC      X03004 38750000
         DC    AL2(1)                  BIT STRING LENGTH         X03004 38800000
         AGO   .I019800                                          X03004 38850000
.I019700 AIF   (&IDAEID(&I) NE X'12').I019750 TEST FOR MACRF       @LQA 38870000
         DC    AL2(1)                  BIT STRING LENGTH           @LQA 38890000
         AGO   .I019800                                            @LQA 38910000
.I019750 DC    AL2(0)                  RESERVED                    @LQC 38930000
         AIF   ('&CALLER' EQ 'SHOW').I019500                            38950000
.I019800 AIF   (&IDAETYP(&I) EQ &VN2).I019900 CHECK FOR BIT STRING      39000000
         AIF   (&IDAETYP(&I) EQ &VN3).I020100 CHECK FOR CHAR STRING     39050000
         AIF   (&IDAETYP(&I) GE &AN1 AND &IDAETYP(&I) LE &AN3).I020200  39100000
.******************************                                         39110000
.*                                     *** VN1 OR AN4 ***               39150000
.*             SELF DEFINING TERM OR A TYPE ADCON                       39160000
.******************************                                         39170000
         DC    A(&IDAVALC(&I))         ELEMENT VALUE                    39210000
         AGO   .I020300                                                 39250000
.*                                     *** VN2 *** BIT STRING           39300000
.I019900 DC    B'&IDAVALC(&I)'         ELEMENT VALUE                    39350000
         AIF   (&IDAEID(&I) NE X'34').I020000 TEST FOR OPTCD     X03004 39400000
         DC    B'&IDAOPT2'             ELEMENT VALUE             X03004 39450000
         DC    B'&IDAOPT3'             ELEMENT VALUE             X03004 39500000
         AGO   .I019500                                                 39550000
.I020000 AIF   (&IDAEID(&I) NE X'50').I020050 TEST FOR PROC             39600000
         DC    B'&IDAPRC2'             ELEMENT VALUE             X03004 39650000
         AGO   .I019500                                                 39700000
.I020050 AIF   (&IDAEID(&I) NE X'12').I020090 TEST FOR MACRF       @LQA 39704000
         DC    B'&IDAMAC2'             ELEMENT VALUE               @LQA 39708000
         AGO   .I019500                                            @LQA 39712000
.I020090 AIF   (&IDAEID(&I) EQ X'40').I020300                      @LQC 39716000
.*             IF KEYWORD IS AM, CHECK FOR EXLST                X04SVHS 39720000
         AGO   .I019500                 CHECK NEXT ELEMENT      X04SVHS 39730000
.*                                     *** VN3 *** CHAR STRING          39750000
.I020100 DC    CL8'&IDAVALC(&I)'       ELEMENT VALUE                    39800000
         AGO   .I019500                                                 39850000
.*                                     *** AN1, AN2, OR AN3 ***         39900000
.*             REGISTER SPECIFICATION, S TYPE ADCON, OR INDIRECT ADDR   39910000
.I020200 AIF   (&IDAETYP(&I) EQ &AN3 AND                               -39921200
               &IDAEID(&I) EQ X'12').I020250                   @WA21279 39932400
.*                                     INDIRECT ADDR AND MACRF @WA21279 39943600
         DC    A(0)                    ELEMENT VALUE TO BE MODIFIED     39954800
         AGO   .I020300                CHECK FOR EXLIST        @WA21279 39966000
.I020250 DC    A(0)                    ELEM TO MODIFY MACRF-1  @WA21279 39977300
         DC    A(0)                    ELEM TO MODIFY MACRF-2  @WA21279 39988600
.I020300 AIF   (&BTC EQ &EXLID AND &IDAEID(&I) NE 42 AND               -40000000
               &IDAEID(&I) NE 63).I020400                               40050000
         AIF   (&IDAELEN(&I) LE 4).I019500                              40100000
         DC    A(0)                    REMAINDER OF ELEMENT FIELD       40150000
         AIF   (&IDAELEN(&I) LE 8).I019500                              40200000
         AIF   (&IDAELEN(&I) LE 12 AND                                 -40212500
               &IDAEID(&I) EQ X'12' AND                                -40225000
               &IDAETYP(&I) EQ &AN3).I019500                   @WA21279 40237500
         DC    A(0)                   REMAINDER OF ELEMENT FIELD X03004 40268700
         AGO   .I019500                                                 40300000
.I020400 DC    B'&IDAVALX(&I)'         EXIT ATTRIBUTES                  40350000
         AGO   .I019500                                                 40400000
.I020500 AIF   (&RMF).I021200            GO IF MF = REENTRANT           40450000
         AIF   ('&MF' NE 'L').I022000                                   40500000
         MEXIT                                                          40550000
.********************************************************************** 40560000
.* REENTRANT MACRO FORMS - GENERATE AND LIST ************************** 40600000
.* GENERATE EQUATE FOR LENGTH OF PARAMETER LIST AREA USED               40650000
.********************************************************************** 40660000
.I020600 AIF   (N'&MF LT 3).I020900                                     40700000
         AIF   (&IDAENO GT 0).I020700                                   40750000
&WORKA   SETA  &IDACB03+4                                               40800000
         AGO   .I020800                                                 40850000
.I020700 ANOP                                                           40900000
&WORKA   SETA  &EOFF(&IDAENO)+&IDAELEN(&IDAENO) CALC AREA LENGTH        40950000
.I020800 ANOP                                                           41000000
&MF(3)   EQU   &WORKA                  LENGTH OF PARM LIST AREA USED    41050000
.I020900 CNOP  0,4                                                      41100000
         AIF   (&IDAENO GT 0).I021000                                   41150000
&WORKA   SETA  &IDACB03+4                                               41200000
         AGO   .I021100                                                 41250000
.I021000 ANOP                                                           41300000
&WORKA   SETA  &EOFF(&IDAENO)+&IDAELEN(&IDAENO)-&PLLEN+4                41350000
.*                                     CALC LENGTH OF ACES              41360000
.I021100 BAL   15,*+&WORKA             BRANCH OVER CONSTANTS            41385000
.******************************                                         41410000
.* BUILD HEADER AND ELEMENT ACES INLINE                                 41450000
         AGO   .I019100                  SHARE MF = L/S CODE            41500000
.******************************                                         41510000
.* TRANSFORM AREA ADDRESS AND LOAD REGISTER 1                           41550000
.******************************                                         41560000
.I021200 IDACB1 ARG=&MF,TYPE=C,POS=2,MF=&MF                             41600000
.*             THE VALUES IN GLOBALS &IDACB11 AND &IDACB13 ARE SET      41610000
.*             BY IDACB1.                                               41620000
         AIF   (&IDACB11 EQ &AN2).I021300 S TYPE ADCON                  41650000
         AIF   (&IDACB11 EQ &AN3).I021400 INDIRECT ADDRESS              41700000
         AIF   (&IDACB11 EQ &AN4).I021500 A TYPE ADCON                  41750000
         AIF   ('&IDACB13' EQ '1').I021600 IS PARM LIST IN REG 1        41800000
         LR    1,&IDACB13              POINT TO PARAMETER LIST AREA     41850000
         AGO   .I021600                                                 41900000
.I021300 ANOP                          *** AN2 *** S TYPE ADCON         41950000
         DC    X'4110'                 POINT TO ...                     41993300
         DC    S(&IDACB13)             PARAMETER LIST AREA              42036600
         AGO   .I021600                                                 42080000
.I021400 ANOP                          *** AN3 *** INDIRECT ADDRESS     42120000
         DC    X'4110'                 POINT TO ...                     42170000
         DC    S(&IDACB13)             ADDRESS OF PARAMETER LIST AREA   42220000
         L     1,0(,1)                 POINT TO PARAMETER LIST AREA     42270000
         AGO   .I021600                                                 42350000
.I021500 ANOP                          *** AN4 *** A TYPE ADCON         42400000
         LA    1,&IDACB13              POINT TO PARAMETER LIST AREA     42450000
.I021600 ANOP                                                           42500000
&WORKA   SETA  &WORKA-4                                                 42550000
         MVC   &PLLEN.(&WORKA,1),0(15) MOVE ACES TO AREA                42580000
.******************************                                         42610000
.* BUILD PARAMETER LIST                                                 42650000
.******************************                                         42660000
         LA    15,&PLLEN.(,1)          POINT TO HEADER ACE              42706600
         ST    15,0(,1)                STORE ADDRESS IN PARAMETER LIST  42753200
&I       SETA  0                       INIT ELEMENT STACK INDEX         42800000
&J       SETA  0                       INIT PLIST ENTRY OFFSET          42850000
.I021700 ANOP                                                           42900000
&I       SETA  &I+1                    INCR ELEMENT STACK INDEX         42950000
         AIF   (&I GT &IDAENO).I021800                                  43000000
&J       SETA  &J+4                    INCR PLIST ENTRY OFFSET          43050000
&WORKA   SETA  &EOFF(&I)-4          OFFSET TO ELEMENT ACE               43100000
         LA    15,&WORKA.(,1)          POINT TO ELEMENT ACE             43150000
         ST    15,&J.(,1)              STORE ADDRESS IN PARAMETER LIST  43200000
         AGO   .I021700                                                 43250000
.I021800 OI    &J.(1),X'80'            MARK END OF PARAMETER LIST       43280000
.******************************                                         43310000
.* MODIFY HEADER AND ELEMENT ACES                                       43350000
.******************************                                         43360000
         AGO   .I017100                  SHARE CODE WITH MF = S         43400000
.I021900 AIF   ('&MF(1)' EQ 'G').I022000                                43450000
         MEXIT                                                          43500000
.********************************************************************** 43510000
.* LINKAGE ************************************************************ 43550000
.********************************************************************** 43560000
.I022000 ANOP                                                  X03004HS 43600000
         AIF   (NOT(&IDABUG)).I022100   CHECK FOR DEBUG MODE            43650000
         CNOP  0,4                     ALIGN TO FULL WORD BOUNDRY       43672000
IDA&SYSNDX.B B     *+8                                         X03004HS 43694000
         DC    V(IDA019C1)                                              43716000
         L     15,*-4                                                   43738000
         AGO  .I022200                                                  43760000
.* LOCATE AND BRANCH TO CONTROL BLOCK MANIPULATION ROUTINE              43800000
.I022100 ANOP                                                  X03004HS 43850000
IDA&SYSNDX.B L     15,16                  POINT TO CVT         X03004HS 43890000
         L     15,256(,15)             POINT TO AMCBS                   43930000
         L     15,12(,15)              POINT TO CB MANIPULATION ROUTINE 43970000
.I022200 AIF   ('&BLK' EQ '').I022650  NO VALID BLKTYPE        @ZA07565 44010000
.* EITHER BLK WAS SPECIFIED OR A VALID PARAMETER IDENTIFIED BLK@ZA07565 44015000
.*                                     CHECK FOR GENCB             @L9C 44020000
&WORKA   SETA  8                       SET INDEX TO GENCB/ACB  @Z40BHCJ 44025000
         AIF  ('&CALLER' NE 'GEN').I022300                     @Z40BHCJ 44030000
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44035000
&WORKA   SETA  12                      SET INDEX TO GENCB/RPL  @Z40BHCJ 44040000
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44045000
&WORKA   SETA  16                      SET INDEX TO GENCB/EXLST@Z40BHCJ 44050000
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44055000
&WORKA   SETA  20                      SET INDEX TO GENCB/NIB  @Z40BHCJ 44060000
         AIF  ('&BLK' EQ 'NIB').I022600                        @ZA07565 44065000
.I022300 ANOP                          CHECK FOR MODCB         @Z40BHCJ 44070000
&WORKA   SETA  24                       SET INDEX TO MODCB/ACB @Z40BHCJ 44075000
         AIF  ('&CALLER' NE 'MOD').I022400                     @Z40BHCJ 44080000
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44085000
&WORKA   SETA  28                      SET INDEX TO MODCB/RPL  @Z40BHCJ 44090000
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44095000
&WORKA   SETA  32                      SET INDEX TO MODCB/EXLST@Z40BHCJ 44100000
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44105000
&WORKA   SETA  36                      SET INDEX TO MODCB/NIB  @Z40BHCJ 44110000
         AIF  ('&BLK' EQ 'NIB').I022600                        @ZA07565 44115000
.I022400 ANOP                          CHECK FOR SHOWCB        @Z40BHCJ 44120000
&WORKA   SETA  40                      SET INDEX TO SHOWCB/ACB @Z40BHCJ 44125000
         AIF  ('&CALLER' NE 'SHOW').I022500                    @Z40BHCJ 44130000
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44135000
&WORKA   SETA  44                      SET INDEX TO SHOWCB/RPL @Z40BHCJ 44140000
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44145000
&WORKA   SETA  48                      SET INDEX TO SHOWCB/EXL @Z40BHCJ 44150000
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44155000
&WORKA   SETA  52                      SET INDEX TO SHOWCB/NIB @Z40BHCJ 44160000
         AIF  ('&BLK' EQ 'NIB').I022600                        @ZA07565 44165000
.*                TESTCB CHECK                                          44199600
.I022500 ANOP                          ASSUME TESTCB           @Z40BHCJ 44237300
         AIF  ('&CALLER' NE 'TEST').I022650                    @Z40BHCJ 44247300
&WORKA   SETA  56                      SET INDEX TO TESTCB/ACB @Z40BHCJ 44249800
         AIF  ('&BLK' EQ 'ACB').I022600                        @ZA07565 44269800
&WORKA   SETA  60                      SET INDEX TO TESTCB/RPL @Z40BHCJ 44273800
         AIF  ('&BLK' EQ 'RPL').I022600                        @ZA07565 44277800
&WORKA   SETA  64                      SET INDEX TO TESTCB/EXL @Z40BHCJ 44281800
         AIF  ('&BLK' EQ 'EXLST').I022600                      @ZA07565 44285800
&WORKA   SETA  68                      SET INDEX TO TESTCB/NIB @Z40BHCJ 44289800
.I022600 ANOP                          BUILD BRANCH INSTRUCTION@Z40BHCJ 44298600
         BAL   14,&WORKA.(,15)         BRANCH TO ROUTINE       @Z40BHCJ 44299000
         MEXIT                                                 @Z40BHCJ 44299400
.*****************************************************         @Z40BHCJ 44299500
.* DON'T KNOW CALLER OR BLKTYPE SO USE OLD INTERFACE *         @Z40BHCJ 44299600
.*****************************************************         @Z40BHCJ 44299700
.I022650 ANOP                                                  @Z40BHCJ 44304600
         BAL   14,0(,15)               BRANCH TO ROUTINE       @ZA07565 44306600
         MEXIT                                                 @Z40BHCJ 44308600
.**********************************************                @Z40BHCJ 44309700
.*  REGISTER FORM CODE GENERATION             *                @Z40BHCJ 44314600
.**********************************************                @Z40BHCJ 44319500
.I022700 ANOP                                                  @Z40BHCJ 44319700
&I       SETA  2                                               @Z40BHCJ 44329700
         AIF   (&IDACB04(&I) NE &AN1).I022800  NOT REGISTER    @Z40BHCJ 44339700
         AIF   ('&IDACB05(&I)' EQ '1').I023100  REGISTER1      @Z40BHCJ 44343700
&LABEL   LR    1,&IDACB05(&I)          POINT TO RPL            @ZA10861 44347700
         AGO   .I023110                                        @Z40BHCJ 44351700
.I022800 AIF   (&IDACB04(&I) NE &AN2).I022900 NOT S-TYPE ADCON @Z40BHCJ 44355700
&LABEL   DC    X'4110'                 POINT TO                @ZA10861 44359700
         DC    S(&IDACB05(&I))         RPL                     @Z40BHCJ 44363700
         AGO   .I023110                                        @Z40BHCJ 44367700
.I022900 AIF  (&IDACB04(&I) NE &AN3).I023000 NOT INDIRECT ADDR @Z40BHCJ 44371700
&LABEL   DC    X'4110'                 POINT TO                @ZA10861 44375700
         DC    S(&IDACB05(&I))         ADDRESS OF RPL          @Z40BHCJ 44379700
         L     1,0(,1)                 POINT TO RPL            @Z40BHCJ 44383700
         AGO   .I023110                                        @ZA10861 44387700
.I023000 ANOP                          DIRECT ADDRESS          @Z40BHCJ 44391700
&LABEL   LA    1,&IDACB05(&I)          POINT TO RPL            @ZA10884 44395700
         AGO   .I023110                                        @ZA10884 44399700
.I023100 ANOP                          RPL IN REGISTER 1       @Z40BHCJ 44403700
&LABEL   DS    0H                                              @ZA10861 44407700
.I023110 AIF  ('&CALLER' NE 'MOD').I023600                     @Z40BHCJ 44411700
         IDACB1 ARG=&RECLEN,ARGNAME=RECLEN                     @Z40BHCJ 44415700
         AIF   (&IDACB11 NE &AN1).I023300  RECLEN NOT IN REG   @Z40BHCJ 44419700
         AIF   ('&IDACB13' EQ '0').I023600                     @Z40BHCJ 44423700
         LR    0,&IDACB13              LOAD RECLEN             @Z40BHCJ 44427700
         AGO   .I023600                                        @Z40BHCJ 44431700
.I023300 AIF   (&IDACB11 NE &AN2).I023400  NOT S-TYPE ADCON    @Z40BHCJ 44435700
         DC    X'4100'                 LOAD REGISTER 0         @ZA25133 44439700
         DC    S(&IDACB13)             WITH RECLEN             @Z40BHCJ 44443700
         AGO   .I023600                                        @Z40BHCJ 44447700
.I023400 AIF   (&IDACB11 NE &AN3).I023500  NOT INDIRECT ADDR   @Z40BHCJ 44451700
         DC    X'41F0'                 POINT TO                @ZA25133 44456900
         DC    S(&IDACB13)             ADDRESS OF RECLEN       @ZA25133 44462100
         L     0,0(,15)                POINT TO RECLEN         @Z40BHCJ 44467300
         AGO   .I023600                                        @Z40BHCJ 44472700
.I023500 ANOP                                                  @Z40BHCJ 44472800
         CNOP  0,4                     ALIGN TO WORD BOUNDARY           44474500
         B     *+8                     BRANCH AROUND CONSTANT  @Z40BHCJ 44476200
         DC    AL4(&IDACB13)           RECLEN                  @Z40BHCJ 44477900
         L     0,*-4                   LOAD RECLEN             @Z40BHCJ 44479600
.I023600 ANOP                                                  @Z40BHCJ 44481700
         AIF   (NOT(&IDABUG)).I023700                          @Z40BHCJ 44481800
         CNOP  0,4                     ALIGN TO WORD BOUNDRY   @Z40BHCJ 44482400
         B     *+8                     BRANCH AROUND ADCON     @Z40BHCJ 44483000
         DC    V(IDA019C1)             ADDRESS OF IDA019C1     @Z40BHCJ 44483600
         L     15,*-4                  POINT TO ROUTINE        @Z40BHCJ 44484200
         AGO   .I023800                                        @Z40BHCJ 44484800
.I023700 ANOP                                                  @Z40BHCJ 44485000
         L     15,16                   POINT TO CVT            @Z40BHCJ 44485700
         L     15,256(,15)             POINT TO AMCBS          @Z40BHCJ 44486400
         L     15,12(,15)              POINT TO ROUTINE        @Z40BHCJ 44487100
.I023800 ANOP                                                  @Z40BHCJ 44487800
         AIF  ('&CALLER' NE 'MOD').I023900                     @Z40BHCJ 44488200
         BAL   14,80(,15)              BRANCH TO ROUTINE       @Z40BHCJ 44489600
         MEXIT                                                 @Z40BHCJ 44491000
.I023900 ANOP                                                  @Z40BHCJ 44496300
         BAL   14,76(,15)               BRANCH TO ROUTINE      @Z40BHCJ 44497300
         AIF  (&IDACB04(3) NE &AN1).I024000                    @Z40BHCJ 44498300
         ST    0,0(,&IDACB05(3))        STORE RECLEN IN AREA   @Z40BHCJ 44498700
         MEXIT                                                 @Z40BHCJ 44499100
.I024000 AIF  (&IDACB04(3) NE &AN2).I024100                    @Z40BHCJ 44499500
         DC    X'5000'                  STORE RECLEN           @Z40BHCJ 44522800
         DC    S(&IDACB05(3))           IN AREA                @Z40BHCJ 44546100
         MEXIT                                                 @Z40BHCJ 44569500
.I024100 ANOP                                                  @Z40BHCJ 44579500
         AIF  (&IDACB04(3) NE &AN3).I024200                    @Z40BHCJ 44589500
         L     1,&IDACB05(3)            LOAD ADDRESS OF AREA   @Z40BHCJ 44590900
         ST    0,0(,1)                  STORE RECLEN IN AREA   @Z40BHCJ 44592300
         MEXIT                                                 @Z40BHCJ 44593900
.I024200 ANOP                                                  @Z40BHCJ 44597500
         ST    0,&IDACB05(3)            STORE ADDRESS IN AREA  @Z40BHCJ 44598500
         MEND                                                  @Z40BHCJ 44599500
