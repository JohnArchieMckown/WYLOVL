*%GOTO PAVE00;                                                          00000991
* /*                                                                    00001981
         MACRO                                                          00002971
         IOSDPAVE &CSECT=NO,&LIST=YES                                   00003961
 TITLE   'IOSDPAVE  - IOS Parallel Access Volume Exit Table'            00004951
*  */                                                                   00005941
*%PAVE00: ;                                                             00006931
*/* Start Of Specifications ******************************************* 00007921
*                                                                       00008911
*01* Macro Name: IOSDPAVE                                               00009901
*01*   Acronym: PAVE                                                    00010891
*                                                                       00011881
*01*   Descriptive Name: IOS Parallel Access Volume Exit Table          00012871
*                                                                       00013861
*01*   Dsect Name: PAVE                                                 00014851
*                                                                       00015841
*01* Component: IOS (SC1C3)                                             00016831
*                                                                       00017821
*01* Proprietary Statement =                                            00018811
*                                                                       00019801
*     LICENSED MATERIALS - PROPERTY OF IBM                              00020791
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                       00021781
*     5645-001 (C) COPYRIGHT IBM CORP. 1997                             00022771
*                                                                       00023761
*01* Status = HBB6603                                                   00024751
*                                                                       00025741
*01* Function: IOSDPAVE maps the Parallel Access Volume (PAV) exit      00026731
*              table to be used by callers who require synchronous      00027721
*              notification when the PAV state changes for a device.    00028711
*              Note that asynchronous notification is done via          00029701
*              ENF 33 processing.                                       00030691
*                                                                       00031681
*01* Notes:    This data area maps a header followed by a variable      00032671
*              size table of 4-byte entries.  Users of this interface   00033661
*              can specify an exit routine address that is to get       00034651
*              control synchronously whenever the PAV state changes     00035641
*              for a device.                                            00036631
*                                                                       00037621
*              To set an entry in the table, users should search        00038611
*              through the table until an available entry or slot       00039601
*              is found.  Note that if no available entries exist       00040591
*              in the table then a synchronous exit cannot be           00041581
*              established.  It is the user's responsibility to         00042571
*              insure that updates to this table are made safely        00043561
*              in an effort to avoid corrupting another user's          00044551
*              entry in the table.                                      00045541
*                                                                       00046531
*              Synchronous exit restrictions:                           00047521
*              . The exit routine must reside in common storage         00048511
*              . When control is given to the exit routine, the         00049501
*                registers will contain the following:                  00050491
*                - Reg 0    = Undefined                                 00051481
*                - Reg 1    = The address of a 1-word parameter         00052471
*                             list which is mapped as follows:          00053461
*                             Word 0: The address of the ENF Device     00054451
*                                     Availability Parameter List       00055441
*                                     (DACH).  The DACH provided        00056431
*                                     will have a DACHTYPE of           00057421
*                                     'PAVS'.                           00058411
*                                                                       00059401
*                             Note: The DACH is mapped by mapping       00060391
*                                   macro IOSDDACH                      00061381
*                . Reg 2-12 = Undefined                                 00062371
*                . Reg 13   = Address of an 18-Word Save Area           00063361
*                . Reg 14   = Return Address                            00064351
*                . Reg 15   = Exit Entry Address                        00065341
*                                                                       00066331
*              . When control is returned to IOS, the exit routine      00067321
*                must restore the registers as follows:                 00068311
*                . Reg 0    = Undefined                                 00069301
*                . Reg 1-14 = Restored to the original contents on      00070291
*                             entry to the exit                         00071281
*                . Reg 15   = Undefined                                 00072271
*                                                                       00073261
*01* Eye Catcher: PAVE                                                  00074251
*02*  Offset: 0                                                         00075241
*02*  Length: 4                                                         00076231
*                                                                       00077221
*01* Method of Access:                                                  00078211
*                                                                       00079201
*02*   ASM:   IOSDPAVE CSECT=value                                      00080191
*               Where value is:                                         00081181
*               YES - Maps the PAVE as a CSECT.                         00082171
*                     Note:  This option is used by                     00083161
*                            IOSVDATA to allocate the                   00084151
*                            exit table                                 00085141
*                NO - Maps the PAVE as a DSECT.                         00086131
*                                                                       00087121
*02*   PL/X:  %INCLUDE SYSLIB(IOSDPAVE)                                 00088111
*                                                                       00089101
*             Note: PL/X users must also include the I/O                00090091
*                   Communication area mapped by IECDIOCM               00091081
*                                                                       00092071
*01* Pointed to by: IOCPAVE field of the IOCOM                          00093061
*                                                                       00094051
*01* Created by: IOSVDATA                                               00095041
*                                                                       00096031
*01* Deleted by: N/A                                                    00097021
*                                                                       00098011
*01* Storage Attributes:                                                00099001
*02*  Subpool: Nucleus                                                  00099991
*02*  Key: N/A                                                          00100981
*02*  Data Space: N/A                                                   00101971
*02*  Residency: Above 16M Line                                         00102961
*02*  Frequency: One                                                    00103951
*02*  Main Storage: Yes                                                 00104941
*02*  Auxiliary Storage: N/A                                            00105931
*02*  Virtual Storage: N/A                                              00106921
*                                                                       00107911
*01* Size: 8-Byte Header plus 4-bytes per entry                         00108901
*                                                                       00109891
*01* Serialization: Compare and Swap (CS) when setting Exit             00110881
*                   Table Entries                                       00111871
*                                                                       00112861
*01* Dependencies: None                                                 00113851
*                                                                       00114841
*01* External Classification: PI                                        00115831
*01* End of External Classification                                     00116821
*                                                                       00117811
* CHANGE-ACTIVITY:                                                      00118801
*  $L0=OW43831  HBB6603 000915 PDNO: Add support for PAV synchronous    00119791
*                                    ENF exit processing                00120781
*                                                                       00121771
** End Of Specifications *********************************************/ 00122761
*%GOTO PAVE01;                                                          00123751
* /*                                                                    00124741
           AIF   ('&CSECT' NE 'YES').PAVE02                             00125731
**********************************************************************  00126721
* PAVE - CSECT                                                       *  00127711
**********************************************************************  00128701
PAVE       DS    0D                    IOS PAV Exit Table               00129691
           ENTRY PAVE                                                   00130681
PAVEID     DC    CL4'PAVE'             Eye Catcher - "PAVE"             00131671
PAVEVERS   DC    XL1'01'               Version                          00132661
           DC    XL3'000000'           Reserved                         00133651
**********************************************************************  00134641
* Exit Table Entries                                                    00135631
**********************************************************************  00136621
           DC    A(0)                  Entry 1 - Exit Routine Address   00137611
           DC    A(0)                  Entry 2 - Exit Routine Address   00138601
           DC    A(0)                  Entry 3 - Exit Routine Address   00139591
           DC    A(0)                  Entry 4 - Exit Routine Address   00140581
           MEXIT                                                        00141571
.PAVE02    ANOP                                                         00142561
**********************************************************************  00143551
* PAVE - DSECT                                                       *  00144541
**********************************************************************  00145531
PAVE       DSECT                       IOS PAV Exit Table               00146521
PAVEHDR    DS   0CL8                   PAVE Header                      00147511
PAVEID     DS    CL4                   Eye Catcher - "PAVE"             00148501
PAVEVERS   DS    XL1                   PAVE Version                     00149491
           DS    XL3                   Reserved                         00150481
PAVEARRAY  DS   0XL16                  PAVE Entry Array                 00151471
PAVEENTRY  DS   0F                     PAVE Entry                       00152461
PAVERTN    DS    F                     Exit Routine Address             00153451
           ORG   PAVEARRAY+L'PAVEARRAY '                                00154441
**********************************************************************  00155431
* PAVE Constants                                                     *  00156421
**********************************************************************  00157411
PAVEMAXENTRY EQU 4                     Current number of entries in     00158401
*                                      the PAVE                         00159391
           MEND                                                         00160381
*  */                                                                   00161371
*%PAVE01: ;                                                             00162361
*/********************************************************************/ 00163351
*/* IOS Parallel Access Volume Exit Table                            */ 00164341
*/********************************************************************/ 00165331
*DCL 1 PavE Bdy(DWORD) Based(IocPavE), /* IOS PAV exit table         */ 00166321
*      3 PavEHdr Char(8),             /* PAVE Header                 */ 00167311
*        5 PavEId   Char(4),          /* Eye catcher - "PAVE"        */ 00168301
*        5 PavEVers Fixed(8),         /* PAVE Version                */ 00169291
*        5 *        Char(3),          /* Reserved                    */ 00170281
*      3 PavEArray,                   /* PAVE Entry Array            */ 00171271
*        5 PavEEntry(PavEMaxEntry),   /* PAVE Entry                  */ 00172261
*          7 PavERtn   Ptr(31);       /* Exit Routine Address        */ 00173251
*/********************************************************************/ 00174241
*/* PAVE Constants                                                   */ 00175231
*/********************************************************************/ 00176221
*DCL PavEMaxEntry Fixed(8) Constant(4); /* Current number of entries    00177211
*                                        in the PAVE                 */ 00178201
