*/**** START OF SPECIFICATIONS **************************************** 00001000
*                                                                     * 00002000
*                                                                     * 00003000
*01* MACRO NAME:  CSVINFO                               -94/05/23-<0> * 00004000
*                                                                     * 00005000
*                                                                     * 00006000
*01* DESCRIPTIVE NAME:  CSV Information Retrieval Service             * 00007000
*                                                                     * 00008000
*01* PROPRIETARY STATEMENT:                                           * 00009000
*                                                                     * 00010000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00011000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00012000
*     5695-047 (C) COPYRIGHT IBM CORP. 1992                           * 00013000
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00014000
*                                                                     * 00015000
* STATUS= HBB4430                                                     * 00016000
*                                                                     * 00017000
*                                                                     * 00018000
*                                                                     * 00019000
*01* FUNCTION:                                                        * 00020000
*                                                                     * 00021000
*      The CSVINFO service searches contents supervision control      * 00022000
*      structures and returns selected module information as          * 00023000
*      specified by the user.                                         * 00024000
*                                                                     * 00025000
*      The user must provide a module information processing routine  * 00026000
*      which will process the information returned for each instance  * 00027000
*      of module information located by the CSVINFO service.          * 00028000
*                                                                     * 00029000
*      CSVINFO is provided in list, execute, modify, and standard     * 00030000
*      forms.  The list form accepts no variable parameters and is    * 00031000
*      used only to reserve space for the CSVINFO parameter list.     * 00032000
*      The execute and modify forms are provided for use with the     * 00033000
*      list form.  It will initialize the parameter list from the     * 00034000
*      keywords specified and call the service routine.  It is        * 00035000
*      provided for use with reentrant routines.  The standard form   * 00036000
*      is provided for use with routines which do not require         * 00037000
*      reentrant code.  All valid keywords may be used with this      * 00038000
*      form.                                                          * 00039000
*                                                                     * 00040000
*                                                                     * 00041000
*                                                                     * 00042000
*                                                                     * 00043000
*      INPUT REGISTERS:                                               * 00044000
*                                                                     * 00045000
*                                                                     * 00046000
*                          GR0         reserved                       * 00047000
*                                                                     * 00048000
*                          GR1         used to pass parameter list    * 00049000
*                                                                     * 00050000
*                          GR2-GR13    undefined                      * 00051000
*                                                                     * 00052000
*                          GR14-GR15   reserved for linkage           * 00053000
*                                                                     * 00054000
*                          AR0-AR1     reserved                       * 00055000
*                                                                     * 00056000
*                          AR2-AR13    undefined                      * 00057000
*                                                                     * 00058000
*                          AR14-AR15   reserved                       * 00059000
*                                                                     * 00060000
*                                                                     * 00061000
*                                                                     * 00062000
*                                                                     * 00063000
*                                                                     * 00063300
*                                                                     * 00063600
*      OUTPUT ENVIRONMENT: Same as on entry                           * 00064000
*                                                                     * 00065000
*      OUTPUT REGISTERS:                                              * 00066000
*                                                                     * 00067000
*                                                                     * 00068000
*                          GR0         reason code                    * 00069000
*                                                                     * 00070000
*                          GR1         unpredictable                  * 00071000
*                                                                     * 00072000
*                          GR2-GR13    unchanged                      * 00073000
*                                                                     * 00074000
*                          GR14        unpredictable                  * 00075000
*                                                                     * 00076000
*                          GR15        return code                    * 00077000
*                                                                     * 00078000
*                          AR0-AR1     unpredictable                  * 00079000
*                                                                     * 00080000
*                          AR2-AR13    unchanged                      * 00081000
*                                                                     * 00082000
*                          AR14-AR15   unpredictable                  * 00083000
*                                                                     * 00084000
*                                                                     * 00085000
*                                                                     * 00086000
*                                                                     * 00086300
*                                                                     * 00086600
*01* ENVIRONMENT:                                                     * 00087000
*                                                                     * 00088000
*                                                                     * 00089000
*      Dispatchable unit mode: Task or SRB mode.                      * 00090000
*                                                                     * 00091000
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00091800
*                        key.  For CSVINFO, an authorized caller is a * 00092600
*                        supervisor state caller.  The service only   * 00093400
*                        serializes its operations for authorized     * 00094200
*                        callers.                                     * 00095000
*                                                                     * 00096000
*      AMODE:            31-bit.                                      * 00097000
*                                                                     * 00098000
*      ASC mode:         Primary.                                     * 00099000
*                                                                     * 00100000
*      Serialization:    Enabled.  The authorized caller may invoke   * 00101000
*                        CSVINFO holding the LOCAL and/or CMS         * 00102000
*                        lock(s).  The LOCAL lock is used to          * 00103000
*                        serialize the job pack area queue and the    * 00104000
*                        CMS lock is used to serialize the active     * 00105000
*                        link pack area queue.  The service obtains   * 00106000
*                        the LOCAL lock and the CMS lock (as needed)  * 00107000
*                        for serialization ONLY when the following    * 00108000
*                        conditions are true:                         * 00109000
*                                                                     * 00110000
*                                                                     * 00111000
*                        1.  The service is invoked by an authorized  * 00112000
*                            caller.                                  * 00113000
*                                                                     * 00114000
*                        2.  The service is NOT invoked under IPCS.   * 00115000
*                                                                     * 00116000
*                        3.  The needed lock is NOT already held.     * 00117000
*                                                                     * 00118000
*                                                                     * 00119000
*                                                                     * 00119500
*                        N.B.  Unauthorized users are cautioned that  * 00120000
*                        the service may terminate unexpectedly,      * 00121000
*                        detect spurious errors in control blocks, or * 00122000
*                        return incorrect data if multi-tasking is    * 00123000
*                        taking place in the user's address space,    * 00124000
*                        since no serialization is obtained by the    * 00125000
*                        service.                                     * 00126000
*                                                                     * 00127000
*      Restrictions:     No locks may be held which would prevent     * 00128000
*                        CSVINFO from obtaining the LOCAL lock to     * 00129000
*                        search the job pack area queue and/or the    * 00130000
*                        CMS lock to search the link pack area queue. * 00131000
*                                                                     * 00132000
*                                                                     * 00133000
*                                                                     * 00133500
*01* SYNTAX:                                                          * 00134000
*                                                                     * 00135000
*[xlabel]  CSVINFO    FUNC=LPA                                       * 00136000
*                    ,FUNC=JPA                                       * 00137000
*                   |     ,TCBADDR=xtcbaddr                           * 00138000
*                    ,FUNC=TASKLOAD                                  * 00139000
*                   |     ,TCBADDR=xtcbaddr                           * 00140000
*                    ,FUNC=TASKALL                                   * 00141000
*                   |     ,TCBADDR=xtcbaddr                           * 00142000
*                    ,FUNC=RB                                        * 00143000
*                         ,RBADDR=xrbaddr                             * 00144000
*                    ,ENV=MVS                                        * 00145000
*                    ,ENV=IPCS                                       * 00146000
*                         ,ABDPLPTR=xabdplptr                         * 00147000
*                         ,ASID=xasid                                 * 00148000
*                     ,MIPR=xmipr                                     * 00149000
*                    [,USERDATA=xuserdata|NULL]                     * 00150000
*                    [,RETCODE=xretcode]                              * 00151000
*                    [,RSNCODE=xrsncode]                              * 00152000
*                    [,COM=xcom|NULL]                               * 00153000
*                   [,MF=S]                                          * 00154000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 00155000
*                   [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]             * 00156000
*                   [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]             * 00157000
*                                                                     * 00158000
*                                                                     * 00159000
*      Where:                                                         * 00160000
*                                                                     * 00161000
*                                                                     * 00162000
*      [xlabel]                                                       * 00163000
*          is an optional symbol, starting in column 1, that is the   * 00164000
*          name on the CSVINFO macro invocation.  The name must       * 00165000
*          conform to the rules for an ordinary assembler language    * 00166000
*          symbol.                                                    * 00167000
*          DEFAULT: No name.                                          * 00168000
*                                                                     * 00169000
*                                                                     * 00170000
*                                                                     * 00171000
*                                                                     * 00171500
*      FUNC=LPA|JPA|TASKLOAD|TASKALL|RB                             * 00172000
*          is a required keyword input that specifies the function    * 00173000
*          which CSVINFO is to perform.                               * 00174000
*                                                                     * 00175000
*                                                                     * 00176000
*          FUNC=LPA                                                   * 00177000
*              requests that CSVINFO return module information for    * 00178000
*              Link Pack Area (LPA) modules.                          * 00179000
*                                                                     * 00180000
*          FUNC=JPA                                                   * 00181000
*              requests that CSVINFO return module information for    * 00182000
*              all modules in the Job Pack Queue for the Job Step     * 00183000
*              Task associated with the task specified by the TCBADDR * 00184000
*              keyword.                                               * 00185000
*                                                                     * 00186000
*              Module information is returned for all modules in the  * 00187000
*              private area known to the selected Job Step Task.      * 00188000
*              This covers all modules brought into storage via LINK  * 00189000
*              (or LINKX), LOAD, ATTACH (or ATTACHX), XCTL (or        * 00190000
*              XCTLX), or via the OpenMVS "exec()" function syscall.  * 00191000
*              It also inlcudes any modules that are in common        * 00192000
*              storage as a result of a LOAD to GLOBAL having been    * 00193000
*              performed by any task in the job running under the     * 00194000
*              selected Job Step Task.                                * 00195000
*                                                                     * 00196000
*                                                                     * 00197000
*              TCBADDR=xtcbaddr                                       * 00198000
*                  is the name (RS-type), or address in register      * 00199000
*                  (2)-(12), of a required 4 byte input that contains * 00200000
*                  the address of the TCB to which the JPA function   * 00201000
*                  applies.                                           * 00202000
*                                                                     * 00203000
*                                                                     * 00204000
*                                                                     * 00204500
*          FUNC=TASKLOAD                                              * 00205000
*              requests that CSVINFO return module information for    * 00206000
*              all modules LOADed (and not yet DELETEd) by the task   * 00207000
*              specified by the TCBADDR keyword.                      * 00208000
*                                                                     * 00209000
*                                                                     * 00210000
*              TCBADDR=xtcbaddr                                       * 00211000
*                  is the name (RS-type), or address in register      * 00212000
*                  (2)-(12), of a required 4 byte input that contains * 00213000
*                  the address of the TCB to which the TASKLOAD       * 00214000
*                  function applies.                                  * 00215000
*                                                                     * 00216000
*                                                                     * 00217000
*                                                                     * 00217500
*          FUNC=TASKALL                                               * 00218000
*              requests that CSVINFO return module information for    * 00219000
*              all modules running under RBs under the task specified * 00220000
*              by the TCBADDR keyword.  This represents the           * 00221000
*              information for all the modules that have been LINKed  * 00222000
*              or XCTLed to under the specified task and have not yet * 00223000
*              completed.                                             * 00224000
*                                                                     * 00225000
*              This function may return information on LPA modules as * 00226000
*              well as private modules. Note that this function may   * 00227000
*              give duplicate information on some modules, since a    * 00228000
*              module may well be in use multiple times.              * 00229000
*                                                                     * 00230000
*                                                                     * 00231000
*              TCBADDR=xtcbaddr                                       * 00232000
*                  is the name (RS-type), or address in register      * 00233000
*                  (2)-(12), of a required 4 byte input that contains * 00234000
*                  the address of the TCB to which the TASKALL        * 00235000
*                  function applies.                                  * 00236000
*                                                                     * 00237000
*                                                                     * 00238000
*                                                                     * 00238500
*          FUNC=RB                                                    * 00239000
*              requests that CSVINFO return module information for    * 00240000
*              the module running under the RB specified by the       * 00241000
*              RBADDR keyword.                                        * 00242000
*                                                                     * 00243000
*                                                                     * 00244000
*              RBADDR=xrbaddr                                         * 00245000
*                  is the name (RS-type), or address in register      * 00246000
*                  (2)-(12), of a required 4 byte input that contains * 00247000
*                  the address of the RB for which module information * 00248000
*                  is to be provided.                                 * 00249000
*                                                                     * 00250000
*                                                                     * 00251000
*                                                                     * 00252000
*                                                                     * 00253000
*                                                                     * 00254000
*                                                                     * 00254200
*                                                                     * 00254400
*                                                                     * 00254600
*      ENV=MVS|IPCS                                                 * 00255000
*          is a required keyword input that specifies the operating   * 00256000
*          environment in which CSVINFO is being invoked.             * 00257000
*                                                                     * 00258000
*                                                                     * 00259000
*          ENV=MVS                                                    * 00260000
*              indicates that CSVINFO is being invoked in a normal    * 00261000
*              MVS execution environment.  The caller may be either   * 00262000
*              authorized or not.  If the caller is authorized, the   * 00263000
*              local lock and CMS LOCK may be held by the caller.     * 00264000
*                                                                     * 00265000
*          ENV=IPCS                                                   * 00266000
*              indicates that CSVINFO is being invoked in an IPCS     * 00267000
*              environment.  The caller must be unauthorized.  No     * 00268000
*              serialization or recovery is obtained by the CSVINFO   * 00269000
*              service when this option is specified.                 * 00270000
*                                                                     * 00271000
*              The BLSABDPL mapping macro must be included in the     * 00272000
*              program when this option is specified.                 * 00272600
*                                                                     * 00273200
*              Current addressability to the ABDPL is not required to * 00273800
*              invoke CSVINFO.                                        * 00274400
*                                                                     * 00275000
*                                                                     * 00276000
*              ABDPLPTR=xabdplptr                                     * 00276900
*                  is the name (RS-type), or address in register      * 00277800
*                  (2)-(12), of a required 4 byte input that contains * 00278700
*                  the address of the ABDUMP parameter list (ABDPL)   * 00279600
*                  which is currently in use.  The address of the     * 00280500
*                  ABDPL is passed on to the caller's module          * 00281400
*                  information processing routine in the input        * 00282300
*                  parameter list mapped by the CSVMODI mapping       * 00283200
*                  macro.                                             * 00284100
*                                                                     * 00285000
*                                                                     * 00286000
*                                                                     * 00287000
*                                                                     * 00287500
*              ASID=xasid                                             * 00288000
*                  is the name (RS-type), or address in register      * 00289000
*                  (2)-(12), of a required 16 bit input address space * 00290000
*                  id in the dump from which the requested module     * 00291000
*                  information is to be obtained.                     * 00292000
*                                                                     * 00293000
*                  The specified address space id is stored in the    * 00294200
*                  ADPLASID field of the ABDPL and the ADPLASID field * 00295400
*                  will have this value when the MIPR routine is      * 00296600
*                  entered.                                           * 00297800
*                                                                     * 00298100
*                                                                     * 00298400
*                                                                     * 00298700
*                                                                     * 00299000
*                                                                     * 00300000
*                                                                     * 00301000
*                                                                     * 00302000
*                                                                     * 00303000
*      MIPR=xmipr                                                     * 00304000
*          is a required input.  It is the name (RS-type), or address * 00305000
*          in register (2)-(12), of the caller's Module Information   * 00306000
*          Processing Routine (MIPR).                                 * 00307000
*                                                                     * 00308000
*          The interface to the caller's MIPR is as follows:          * 00309000
*                                                                     * 00310000
*          SERIALIZATION AND RECOVERY                                 * 00311000
*                                                                     * 00312000
*          The user's MIPR gets control with CSVINFO's FRR in place   * 00313000
*          and the local lock held if the user is authorized.         * 00313200
*                                                                     * 00313400
*          If FUNC(LPA) is requested by an authorized user, the CMS   * 00313600
*          lock is also held when the MIPR gets control.  Care should * 00313800
*          be taken that the MIPR routine does not consume excessive  * 00314000
*          time, as holding this lock for an extended period of time  * 00314200
*          could cause system problems.                               * 00314400
*                                                                     * 00315000
*          If the user is unauthorized, the user's MIPR receives      * 00316000
*          control with CSVINFO's ESTAE routine in effect.  No locks  * 00317000
*          are obtained by CSVINFO when the caller is unauthorized.   * 00318000
*                                                                     * 00319000
*          MIPR INPUT (CSVINFO OUTPUT)                                * 00320000
*                                                                     * 00321000
*          The MIPR routine gets control via standard branch entry    * 00322000
*          linkage in 31 bit addressing mode.                         * 00323000
*                                                                     * 00324000
*                                                                     * 00325000
*                                                                     * 00326000
*          MIPR INPUT REGISTERS:                                      * 00327000
*                                                                     * 00328000
*                                                                     * 00329000
*                              GR0         reserved                   * 00330000
*                                                                     * 00331000
*                              GR1         address of the Contents    * 00332000
*                                          Supervision Module         * 00333000
*                                          Information Area mapped by * 00334000
*                                          the CSVMODI mapping macro. * 00335000
*                                                                     * 00336000
*                              GR2-GR12    irrelevant                 * 00337000
*                                                                     * 00338000
*                              GR13        address of standard 72     * 00339000
*                                          byte savearea              * 00340000
*                                                                     * 00341000
*                              GR14        return address to CSVINFO  * 00342000
*                                          service                    * 00343000
*                                                                     * 00344000
*                              GR15        address of the MIPR        * 00345000
*                                          routine entry point        * 00346000
*                                                                     * 00347000
*                              AR0-AR15    reserved. AR mode note     * 00348000
*                                          supported.                 * 00349000
*                                                                     * 00349200
*                                                                     * 00349400
*                                                                     * 00349500
*                              MIPR OUTPUT                            * 00349600
*                                                                     * 00350000
*                                                                     * 00351000
*          MIPR OUTPUT REGISTERS:                                     * 00352000
*                                                                     * 00353000
*                                                                     * 00354000
*                              MIPR output environment: Same as on    * 00355000
*                                          entry                      * 00356000
*                                                                     * 00357000
*                              GR0-GR1     unpredictable              * 00357300
*                                                                     * 00357600
*                              GR2-GR12    (unchanged) must be        * 00357900
*                                          restored to contents at    * 00358200
*                                          input to MIPR              * 00358500
*                                                                     * 00359000
*                              GR13        unchanged (save area       * 00360000
*                                          address)                   * 00361000
*                                                                     * 00362000
*                              GR14        unchanged (CSVINFO return  * 00363000
*                                          address)                   * 00364000
*                                                                     * 00365000
*                              GR15        MIPR return code           * 00366000
*                                                                     * 00367000
*                                          The user's Module          * 00368000
*                                          Information Processing     * 00369000
*                                          Routine (MIPR) should      * 00370000
*                                          return to CSVINFO with a   * 00371000
*                                          return code as follows:    * 00372000
*                                                                     * 00373000
*                                                                     * 00374000
*                                          o   0 - Continue           * 00375000
*                                              Processing             * 00376000
*                                                                     * 00377000
*                                          o   anything else -        * 00378000
*                                              terminate processing.  * 00379000
*                                                                     * 00380000
*                                              A non-zero return code * 00381000
*                                              will be passed back to * 00382000
*                                              the caller of CSVINFO  * 00383000
*                                              as the reason code     * 00384000
*                                              associated with return * 00385000
*                                              code 8.                * 00386000
*                                                                     * 00387000
*                                                                     * 00388000
*                                                                     * 00388500
*                              AR0-AR1     unpredictable              * 00389000
*                                                                     * 00390000
*                              AR2-AR13    unchanged                  * 00391000
*                                                                     * 00392000
*                              AR14-AR15   unpredictable              * 00393000
*                                                                     * 00394000
*                                                                     * 00395000
*                                                                     * 00396000
*                                                                     * 00396300
*                                                                     * 00396600
*          The CSVMODI mapping consists of a main section with        * 00397000
*          pointers to other sections containing portions of the      * 00398000
*          overall module information.  All of the meaningful         * 00399000
*          contents supervision information related to the instance   * 00400000
*          of the module's usage is contained in the areas mapped by  * 00401000
*          the macro.                                                 * 00402000
*                                                                     * 00403000
*          See the macro in SYS1.MACLIB for details of the CSVMODI    * 00404000
*          macro.                                                     * 00405000
*                                                                     * 00406000
*                                                                     * 00407000
*                                                                     * 00408000
*                                                                     * 00408500
*      [USERDATA=xuserdata|NULL]                                    * 00409000
*          is the name (RS-type) of an optional 16 character input    * 00410000
*          containing user data from the caller that is made          * 00411000
*          available to the module information processing routine     * 00412000
*          specified by the MIPR keyword.  The information is         * 00413000
*          included in the CSVMODI mapping macro.                     * 00414000
*          DEFAULT: NULL                                              * 00415000
*                                                                     * 00416000
*                                                                     * 00417000
*                                                                     * 00418000
*                                                                     * 00418500
*      [RETCODE=xretcode]                                             * 00419000
*          is the name (RS-type) of an optional fullword output       * 00420000
*          variable, or register (2)-(12), into which the return code * 00421000
*          is to be copied from GPR 15.                               * 00422000
*                                                                     * 00423000
*                                                                     * 00424000
*                                                                     * 00425000
*                                                                     * 00425500
*      [RSNCODE=xrsncode]                                             * 00426000
*          is the name (RS-type) of an optional fullword output       * 00427000
*          variable, or register (2)-(12), into which the reason code * 00428000
*          is to be copied from GPR 0.                                * 00429000
*                                                                     * 00430000
*                                                                     * 00431000
*                                                                     * 00432000
*                                                                     * 00432500
*      [COM=xcom|NULL]                                              * 00433000
*          is an optional character input  that will appear in the    * 00434000
*          block comment before the macro invocation echo. It can be  * 00435000
*          used to comment the macro invocation.  The comment string  * 00436000
*          must be enclosed in quotes if it contains any lower case   * 00437000
*          characters.                                                * 00438000
*          DEFAULT: NULL                                              * 00439000
*                                                                     * 00440000
*                                                                     * 00441000
*                                                                     * 00442000
*                                                                     * 00442500
*      [MF=S|L|M|E]                                                 * 00443000
*          is an optional keyword input which specifies the macro     * 00444000
*          form.                                                      * 00445000
*          DEFAULT: S                                                 * 00446000
*                                                                     * 00447000
*                                                                     * 00448000
*          [MF=S]                                                     * 00449000
*              specifies the standard form of the macro.  The "S"     * 00450000
*              form generates code to put the parameters into an      * 00451000
*              in-line parameter list and invoke the desired service. * 00452000
*              Full checking for required macro keys is done along    * 00453000
*              with supplying defaults for omitted optional           * 00454000
*              parameters.                                            * 00455000
*                                                                     * 00456000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00457000
*              specifies the list form of the macro.  The "L" form    * 00458000
*              defines an area to be used for the parameter list.     * 00459000
*              Any other macro parameters are flagged as errors.      * 00460000
*                                                                     * 00461000
*            ,xmfctrl                                                 * 00462000
*              is a required input.  It is the name of a storage area * 00463000
*              for the parameter list.                                * 00464000
*                                                                     * 00465000
*            ,xmfattr|0D                                            * 00466000
*              is an optional 60 character input string that varies   * 00467000
*              from 1 to 60 characters. It can contain any value that * 00468000
*              is valid on an assembler DS pseudo-op. You can use     * 00469000
*              this parameter to force boundary alignment of the      * 00470000
*              parameter list.                                        * 00471000
*              DEFAULT: 0D which forces the parameter list to a       * 00472000
*              doubleword boundary.                                   * 00473000
*                                                                     * 00474000
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00475000
*              specifies the modify form of the macro.  The "M" form  * 00476000
*              generates code to put the parameters into the          * 00477000
*              parameter list specified by xmfctrl.                   * 00478000
*                                                                     * 00479000
*            ,xmfctrl                                                 * 00480000
*              is a required input.  It is the name (RS-type), or     * 00481000
*              address in register (1)-(12), of a storage area for    * 00482000
*              the parameter list.                                    * 00483000
*                                                                     * 00484000
*            ,COMPLETE|NOCHECK]                                     * 00485000
*              is an optional keyword input which specifies the       * 00486000
*              degree of macro parameter syntax checking.             * 00487000
*              DEFAULT: COMPLETE                                      * 00488000
*                                                                     * 00489000
*                                                                     * 00490000
*              COMPLETE   Checking for required macro keys is done    * 00491000
*                        and defaults are supplied for omitted        * 00492000
*                        optional parameters.  (See Macro Usage Note  * 00493000
*                        2).                                          * 00494000
*                                                                     * 00495000
*              NOCHECK   Checking for required macro keys is not done * 00496000
*                        nor are defaults supplied for omitted        * 00497000
*                        optional parameters.                         * 00498000
*                                                                     * 00499000
*                                                                     * 00500000
*                                                                     * 00500500
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00501000
*              specifies the execute form of the macro.  The "E" form * 00502000
*              generates code to put the parameters into the          * 00503000
*              parameter list specified by xmfctrl and invoke the     * 00504000
*              desired service.                                       * 00505000
*                                                                     * 00506000
*            ,xmfctrl                                                 * 00507000
*              is a required input.  It is the name (RS-type), or     * 00508000
*              address in register (1)-(12), of a storage area for    * 00509000
*              the parameter list.                                    * 00510000
*                                                                     * 00511000
*            ,COMPLETE|NOCHECK                                      * 00512000
*              is an optional keyword input which specifies the       * 00513000
*              degree of macro parameter syntax checking.             * 00514000
*              DEFAULT: COMPLETE                                      * 00515000
*                                                                     * 00516000
*                                                                     * 00517000
*              COMPLETE   Checking for required macro keys is done    * 00518000
*                        and defaults are supplied for omitted        * 00519000
*                        optional parameters.  (See Macro Usage Note  * 00520000
*                        2).                                          * 00521000
*                                                                     * 00522000
*              NOCHECK   Checking for required macro keys is not done * 00523000
*                        nor are defaults supplied for omitted        * 00524000
*                        optional parameters.                         * 00525000
*                                                                     * 00525200
*                                                                     * 00525400
*                                                                     * 00525600
*                                                                     * 00526000
*                                                                     * 00527000
*                                                                     * 00528000
*                                                                     * 00529000
*01* RETURN CODES:                                                    * 00530000
*                                                                     * 00531000
*                                                                     * 00532000
*                                                                     * 00533000
*                      0 -- (MODI_OK) CSVINFO retrieved all the       * 00534000
*                           requested information.                    * 00535000
*                                                                     * 00536000
*                      4 -- (MODI_NOINFO) There was no information    * 00537000
*                           for CSVINFO to return.                    * 00538000
*                                                                     * 00539000
*                      8 -- (MODI_CALLER) CSVINFO processing was      * 00540000
*                           terminated by a non-zero return code from * 00541000
*                           the user's module information processing  * 00542000
*                           routine (MIPR).  The reason code contains * 00543000
*                           the return code from that routine.  The   * 00544000
*                           meaning assigned to the return codes from * 00545000
*                           the user's MIPR is entirely up to the     * 00546000
*                           user.                                     * 00547000
*                                                                     * 00548000
*                      12 ('C'X) -- (MODI_LOCKS) CSVINFO was unable   * 00549000
*                           to obtain the locks needed for            * 00550000
*                           serialization.                            * 00551000
*                                                                     * 00552000
*                      16 ('10'X) -- (MODI_INVALID_INPUT) Invalid or  * 00553000
*                           unaccessable input parameters.            * 00554000
*                                                                     * 00555000
*                      20 ('14'X) -- (MODI_NOTAVAIL) The CSVINFO      * 00556000
*                           service is not available.                 * 00557000
*                                                                     * 00558000
*                      24 ('18'X) -- (MODI_NOTRETRIEVED) CSVINFO      * 00559000
*                           processing terminated because requested   * 00560000
*                           information could not be retrieved from   * 00561000
*                           the dump.  This return code only applies  * 00562000
*                           to the ENV(IPCS) option.                  * 00563000
*                                                                     * 00564000
*                      28 ('1C'X) -- (MODI_UNEXPECTED) Processing     * 00565000
*                           terminated unexcpectedly.                 * 00566000
*                                                                     * 00567000
*                      32 ('20'X) -- (MODI_BELOW430) The CSVINFO      * 00568000
*                           function is not supported on the current  * 00569000
*                           level of the system.                      * 00570000
*                                                                     * 00571000
*                      36 ('24'X) -- (MODI_BAD_PARMLIST) The CSVINFO  * 00572000
*                           parameter list is not valid for the level * 00573000
*                           of CSVINFO service on the system.         * 00574000
*                                                                     * 00575000
*                      40 ('28'X) -- (MODI_LOOP_LIMIT) The CSVINFO    * 00575100
*                           service has exceeded a large internal     * 00575200
*                           threshold value for the number of times   * 00575300
*                           the MIPR is invoked.  This return code    * 00575400
*                           indicates either that there is a loop in  * 00575500
*                           a queue being run or that the combination * 00575600
*                           or running unserialized and encountering  * 00575700
*                           some bad data is causing an apparent      * 00575800
*                           infinite loop.                            * 00575900
*                                                                     * 00576000
*                      44 ('2C'X) -- (MODI_INELIGIBLE_RB) The RB      * 00576100
*                           supplied via RBADDR as input for FUNC(RB) * 00576200
*                           was not a PRB or SVRB.                    * 00576300
*                                                                     * 00576400
*                      48 ('30'X) -- (MODI_MIPR_FAILED) The supplied  * 00576500
*                           MIPR routine failed.                      * 00576600
*                                                                     * 00576700
*                      52 ('34'X) -- (MODI_RB_LOOP) The RB supplied   * 00576800
*                           via RBADDR as input for FUNC(RB) has      * 00576900
*                           resulted in the CSVINFO service exceeding * 00577000
*                           the expected number of iterations through * 00577100
*                           an RB chain.                              * 00577200
*                                                                     * 00577300
*                                                                     * 00577400
*                                                                     * 00577500
*                                                                     * 00577600
*                                                                     * 00577700
*01* REASON CODES:                                                    * 00578000
*                                                                     * 00579000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00580000
*                                                                     * 00581000
*02*   PROCESSOR:  ASSEM                                              * 00582000
*                                                                     * 00583000
*01* COMPONENT:  SC1CJ                                                * 00584000
*                                                                     * 00585000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00586000
*                                                                     * 00587000
*01* MACRO USAGE NOTES:                                               * 00588000
*                                                                     * 00589000
*                                                                     * 00590000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00591000
*        global macro variable.  Any value other than 'NO' will       * 00592000
*        result in the macro expansion being printed.  The default is * 00593000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00594000
*        variable should be set.                                      * 00595000
*                                                                     * 00596000
*                    GBLC &ZPRINT                                     * 00597000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00598000
*                                                                     * 00599000
*                                                                     * 00600000
*    2.  When using the NOCHECK option in conjunction with the Modify * 00601000
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00602000
*        Modify   or  Execute  form  invocation  which  specifies  or * 00603000
*        defaults  to  the  COMPLETE  option.   This insures that the * 00604000
*        parameter list is initialized completely.                    * 00605000
*                                                                     * 00606000
*                                                                     * 00607000
*                                                                     * 00607500
*01* CHANGE ACTIVITY:                                                 * 00608000
*                                                                     * 00609000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00610000
*                                                                     * 00611000
*    $L0=POSIX    HBB4430 020592 PD34EP:  Initial version.            * 00612400
*    $L1=POSIX    HBB4430 031892 PD34EP:  Add MODI_MIPR_LIMIT return  * 00613800
*                                         code.                       * 00615400
*    $P1=POSIX    HBB4430 042992 PD34EP:  PKB2200.                    * 00615800
*    $P2=POSIX    HBB4430 061792 PD34EP:  PKB3388.                    * 00616200
*    $L2=POSIX    HBB4430 042992 PD34EP:  Macro no longer sets        * 00616600
*                                         ADPLASID.                   * 00617200
*    $D1=POSIX    HBB4430 061792 PD34EP:  DKB0129.                    * 00617500
*    $P3=POSIX    HBB4430 062592 PD34EP:  PKB3662.                    * 00617700
*    $P4=POSIX    HBB4430 072992 PD34EP:  PKB3865.                    * 00617900
*    $P5=POSIX    HBB4430 072992 PD34EP:  PKB3675.                    * 00618100
*    $01=POSIX    HBB4430 120392 PD34EP:  OY58986 (PKB4295).          * 00618200
*    $02=OW02434  HBB4430 052394 PD34DH:  Add MODI_RB_LOOP return     * 00618300
*                                         code.                       * 00618400
****** END OF SPECIFICATIONS *****************************************/ 00618500
*/********************************************************************* 00618600
         MACRO                                                          00618700
&XLABEL  CSVINFO &FUNC=,&TCBADDR=,&RBADDR=,&ENV=,&ABDPLPTR=,&ASID=,    *00619000
               &MIPR=,&USERDATA=,&RETCODE=,&RSNCODE=,&COM=,&MF=         00620000
.*                                                                      00621000
*              MACDATE -94/05/23-<0>                                    00622000
.*                                                                      00623000
.*******************************************************************    00624000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00625000
.*******************************************************************    00626000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00627000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00628000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00629000
.*                                                                      00630000
              GBLC  &ZCSVINFO   YES=MACRO USED AT LEAST ONCE            00631000
.*******************************************************************    00632000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00633000
.*******************************************************************    00634000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00635000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00636000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00637000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00638000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00639000
              LCLA  &ZAWRK      USED AS A WORK AREA                     00640000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00641000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00642000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00643000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00644000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00645000
              LCLA  &ZMACRET    MACRO RETURN CODE                       00646000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00647000
.*                                                                      00648000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00649000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00650000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00651000
              LCLC  &ZENDBASEPL                 End of base PL          00651500
.********************************************************************   00652000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00653000
.********************************************************************   00654000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00655000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00656000
.*                                                                      00657000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00658000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00659000
              SPLEVEL  TEST                                             00660000
.ZSYS2        ANOP  ,                                                   00661000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00662000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00663000
              SYSSTATE TEST                                             00664000
              AGO   .ZSYS4                                              00665000
.ZSYS3        ANOP  ,                                                   00666000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00667000
.ZSYS4        ANOP  ,                                                   00668000
.*******************************************************************    00669000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00670000
.*******************************************************************    00671000
              LCLC  &XFUNC      ++ VALUE                                00672000
              LCLC  &XTCBADDR   ++ NAME                                 00673000
              LCLC  &XRBADDR    ++ NAME                                 00674000
              LCLC  &XENV       ++ VALUE                                00675000
              LCLC  &XABDPLPTR  ++ NAME                                 00676000
              LCLC  &XASID      ++ NAME                                 00677000
              LCLC  &XMIPR      ++ NAME                                 00678000
              LCLC  &XUSERDATA  ++ NAME                                 00679000
              LCLC  &XRETCODE   ++ NAME                                 00680000
              LCLC  &XRSNCODE   ++ NAME                                 00681000
              LCLC  &XCOM       ++ VALUE                                00682000
              LCLC  &XMF        ++ VALUE                                00683000
              LCLC  &XMFCTRL    ++ NAME                                 00684000
              LCLC  &XMFATTR    ++ VALUE                                00685000
              LCLC  &XMFSCK     ++ VALUE                                00686000
.*******************************************************************    00687000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00688000
.*******************************************************************    00689000
              LCLC  &ZXFUNC     ++ INPUT VALUE                          00690000
              LCLC  &ZXTCBADDR  ++ INPUT NAME                           00691000
              LCLC  &ZXRBADDR   ++ INPUT NAME                           00692000
              LCLC  &ZXENV      ++ INPUT VALUE                          00693000
              LCLC  &ZXABDPLPTR                 ++ INPUT NAME           00694000
              LCLC  &ZXASID     ++ INPUT NAME                           00695000
              LCLC  &ZXMIPR     ++ INPUT NAME                           00696000
              LCLC  &ZXUSERDATA                 ++ INPUT NAME           00697000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00698000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00699000
              LCLC  &ZXCOM      ++ INPUT VALUE                          00700000
              LCLC  &ZXMF       ++ INPUT VALUE                          00701000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00702000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00703000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00704000
.********************************************************************   00705000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00706000
.********************************************************************   00707000
              ACTR  10000                                               00708000
.*------------------------------------------------------------------    00709000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00710000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00711000
.*-------------------------------------------------------------------   00712000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00713000
.ZG49         ANOP  ,                                                   00714000
&ZTLC         SETC 'S'                                                  00715000
              AIF   ('&MF(1)' NE '&ZTLC').ZG50                          00716000
&XMF          SETC  'S'         SET KEYWORD                             00717000
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00718000
              AIF   (N'&MF LE 1).ZG49A          CK NUM                  00719000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00720000
&ZMS          SETC  '&ZMS.&MF"'                                         00721000
&ZMS          SETC  '&ZMS "MF"'                                         00722000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00723000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00724000
.ZG49A        ANOP  ,                                                   00725000
.*-------------------------------------------------------------------   00726000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00727000
.ZG50         ANOP  ,                                                   00728000
&ZTLC         SETC 'L'                                                  00729000
              AIF   ('&MF(1)' NE '&ZTLC').ZG57                          00730000
&XMF          SETC  'L'         SET KEYWORD                             00731000
              AIF   (N'&MF LE 3).ZG50A          CK NUM                  00732000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00733000
&ZMS          SETC  '&ZMS.&MF"'                                         00734000
&ZMS          SETC  '&ZMS "MF"'                                         00735000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00736000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00737000
.ZG50A        ANOP  ,                                                   00738000
.*-------------------------------------------------------------------   00739000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00740000
              AIF   (N'&SYSLIST NE 0).ZG50B     POSITIONALS?            00741000
              AIF   ('&FUNC' NE '').ZG50B       KEYS?                   00742000
              AIF   ('&TCBADDR' NE '').ZG50B    KEYS?                   00743000
              AIF   ('&RBADDR' NE '').ZG50B     KEYS?                   00744000
              AIF   ('&ENV' NE '').ZG50B        KEYS?                   00745000
              AIF   ('&ABDPLPTR' NE '').ZG50B   KEYS?                   00746000
              AIF   ('&ASID' NE '').ZG50B       KEYS?                   00747000
              AIF   ('&MIPR' NE '').ZG50B       KEYS?                   00748000
              AIF   ('&USERDATA' NE '').ZG50B   KEYS?                   00749000
              AIF   ('&RETCODE' NE '').ZG50B    KEYS?                   00750000
              AIF   ('&RSNCODE' NE '').ZG50B    KEYS?                   00751000
              AIF   ('&COM' NE '').ZG50B        KEYS?                   00752000
              AGO    .ZG50C     INVOCATION OKAY                         00753000
.ZG50B        ANOP  ,                                                   00754000
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         00755000
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   00756000
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              00757000
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        00758000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00759000
.ZG50C        ANOP  ,                                                   00760000
.*-------------------------------------------------------------------   00761000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00762000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00763000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00764000
              AIF   (N'&MF(2) GT 1).ZG52B       MULTI PARMS             00765000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00766000
.ZG52B        AIF   (K'&MF(2) GT 0).ZG52C                               00767000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00768000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00769000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00770000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00771000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00772000
.ZG52C        ANOP  ,                                                   00773000
.*-------------------------------------------------------------------   00774000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00775000
              AIF   (K'&ZXMFCTRL LE 0).ZG52P    NOT I/O                 00776000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG52P                      00777000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00778000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00779000
&ZMS          SETC  '&ZMS.&MF"'                                         00780000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00781000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00782000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00783000
.ZG52P        ANOP  ,                                                   00784000
.*-------------------------------------------------------------------   00785000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00786000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00787000
&XMFATTR      SETC  '0D'                                                00788000
              AIF   (K'&MF(3) LE 0).ZG55B       PARM                    00789000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00790000
              AIF   (N'&MF(3) GT 1).ZG55B       MULTI PARMS             00791000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00792000
.ZG55B        ANOP  ,                                                   00793000
.*-------------------------------------------------------------------   00794000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00795000
              AIF   (K'&ZXMFATTR LE 0).ZG55P    NOT I/O                 00796000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG55P                      00797000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00798000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00799000
&ZMS          SETC  '&ZMS.&MF"'                                         00800000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00801000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00802000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00803000
.ZG55P        ANOP  ,                                                   00804000
.*-------------------------------------------------------------------   00805000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00806000
              AIF   (K'&ZXMFATTR LE 0).ZG55S    NOT I/O                 00807000
              AIF   (K'&XMFATTR LE 60).ZG55S    LNG OK                  00808000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00809000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00810000
&ZMS          SETC  '&ZMS.&MF"'                                         00811000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00812000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00813000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00814000
.ZG55S        ANOP  ,                                                   00815000
.*-------------------------------------------------------------------   00816000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00817000
.ZG57         ANOP  ,                                                   00818000
&ZTLC         SETC 'M'                                                  00819000
              AIF   ('&MF(1)' NE '&ZTLC').ZG66                          00820000
&XMF          SETC  'M'         SET KEYWORD                             00821000
              AIF   (N'&MF LE 3).ZG57A          CK NUM                  00822000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00823000
&ZMS          SETC  '&ZMS.&MF"'                                         00824000
&ZMS          SETC  '&ZMS "MF"'                                         00825000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00826000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00827000
.ZG57A        ANOP  ,                                                   00828000
.*-------------------------------------------------------------------   00829000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00830000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00831000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00832000
              AIF   (N'&MF(2) GT 1).ZG59B       MULTI PARMS             00833000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00834000
.ZG59B        AIF   (K'&MF(2) GT 0).ZG59C                               00835000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00836000
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 00837000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00838000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00839000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00840000
.ZG59C        ANOP  ,                                                   00841000
.*-------------------------------------------------------------------   00842000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00843000
              AIF   (K'&ZXMFCTRL LE 0).ZG59R    NOT I/O                 00844000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG59R                      00845000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00846000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                        00847000
              AIF   (K'&ZCGPR GT 2).ZG59Q                               00848000
              AIF   ('&ZCGPR' EQ '0').ZG59Q                             00849000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00850000
              AIF   (T'&ZCGPR NE 'N').ZG59Q     INVALID REG NAME        00851000
.ZG59P        ANOP  ,                                                   00852000
              AIF   (T'&ZCGPR NE 'N').ZG59R     NON NUMERIC             00853000
              AIF   ('&ZCGPR' LT '1').ZG59Q                             00854000
              AIF   ('&ZCGPR' LE '12').ZG59R                            00855000
.ZG59Q        ANOP  ,                                                   00856000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00857000
&ZMS          SETC  '&ZMS.&MF"'                                         00858000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00859000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00860000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00861000
.ZG59R        ANOP  ,                                                   00862000
.*-------------------------------------------------------------------   00863000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00864000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00865000
.ZG63A   AIF   ('&MF(3)' NE 'COMPLETE').ZG64A                           00866000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00867000
.*-------------------------------------------------------------------   00868000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00869000
.ZG64A   AIF   ('&MF(3)' NE 'NOCHECK').ZG65A                            00870000
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00871000
.*-------------------------------------------------------------------   00872000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00873000
.ZG65A        AIF   (K'&XMFSCK GT 0).ZG65C      KEYWORD                 00874000
              AIF   (K'&MF(3) LE 0).ZG65B                               00875000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00876000
&ZMS          SETC  '&ZMS.&MF"'                                         00877000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00878000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00879000
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00880000
&ZMS          SETC  '&ZMS OR "NOCHECK".'        VALID KEYWORD           00880600
              MNOTE 8,' &ZMS '                                          00881200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00882000
.ZG65B        ANOP  ,                                                   00883000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00884000
.ZG65C        ANOP  ,                                                   00885000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00886000
.*-------------------------------------------------------------------   00887000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00888000
.ZG66         ANOP  ,                                                   00889000
&ZTLC         SETC 'E'                                                  00890000
              AIF   ('&MF(1)' NE '&ZTLC').ZG75                          00891000
&XMF          SETC  'E'         SET KEYWORD                             00892000
              AIF   (N'&MF LE 3).ZG66A          CK NUM                  00893000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00894000
&ZMS          SETC  '&ZMS.&MF"'                                         00895000
&ZMS          SETC  '&ZMS "MF"'                                         00896000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00897000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00898000
.ZG66A        ANOP  ,                                                   00899000
.*-------------------------------------------------------------------   00900000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00901000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00902000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00903000
              AIF   (N'&MF(2) GT 1).ZG68B       MULTI PARMS             00904000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00905000
.ZG68B        AIF   (K'&MF(2) GT 0).ZG68C                               00906000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00907000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00908000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00909000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00910000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00911000
.ZG68C        ANOP  ,                                                   00912000
.*-------------------------------------------------------------------   00913000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00914000
              AIF   (K'&ZXMFCTRL LE 0).ZG68R    NOT I/O                 00915000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG68R                      00916000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00917000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG68P                        00918000
              AIF   (K'&ZCGPR GT 2).ZG68Q                               00919000
              AIF   ('&ZCGPR' EQ '0').ZG68Q                             00920000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00921000
              AIF   (T'&ZCGPR NE 'N').ZG68Q     INVALID REG NAME        00922000
.ZG68P        ANOP  ,                                                   00923000
              AIF   (T'&ZCGPR NE 'N').ZG68R     NON NUMERIC             00924000
              AIF   ('&ZCGPR' LT '1').ZG68Q                             00925000
              AIF   ('&ZCGPR' LE '12').ZG68R                            00926000
.ZG68Q        ANOP  ,                                                   00927000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00928000
&ZMS          SETC  '&ZMS.&MF"'                                         00929000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00930000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00931000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00932000
.ZG68R        ANOP  ,                                                   00933000
.*-------------------------------------------------------------------   00934000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00935000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00936000
.ZG72A   AIF   ('&MF(3)' NE 'COMPLETE').ZG73A                           00937000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00938000
.*-------------------------------------------------------------------   00939000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00940000
.ZG73A   AIF   ('&MF(3)' NE 'NOCHECK').ZG74A                            00941000
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00942000
.*-------------------------------------------------------------------   00943000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00944000
.ZG74A        AIF   (K'&XMFSCK GT 0).ZG74C      KEYWORD                 00945000
              AIF   (K'&MF(3) LE 0).ZG74B                               00946000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00947000
&ZMS          SETC  '&ZMS.&MF"'                                         00948000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00949000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00950000
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00951000
&ZMS          SETC  '&ZMS OR "NOCHECK".'        VALID KEYWORD           00951600
              MNOTE 8,' &ZMS '                                          00952200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00953000
.ZG74B        ANOP  ,                                                   00954000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00955000
.ZG74C        ANOP  ,                                                   00956000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00957000
.*------------------------------------------------------------------    00958000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00959000
.ZG75         ANOP  ,                                                   00960000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00961000
              AIF   (K'&XMF GT 0).ZG75E         VALID ARG               00962000
              AIF   (T'&MF EQ 'O').ZG75D        OMITTED                 00963000
&ZASYSLNDX    SETA  0                                                   00964000
.ZG75A        ANOP  ,           POSITIONAL MACRO KEY                    00965000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00966000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG75C                    00967000
&ZTLC         SETC 'MF'                                                 00968000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG75A           00969000
.ZG75B        ANOP  ,                                                   00970000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00971000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00972000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00973000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00974000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00975000
              AGO   .ZG75E                                              00976000
.ZG75C        ANOP  ,                                                   00977000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00978000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00979000
&ZMS          SETC  '&ZMS.&MF"'                                         00980000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00981000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00982000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00983000
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00984000
&ZMS          SETC  '&ZMS "M",'                 VALID KEYWORD           00985000
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           00985600
              MNOTE 8,' &ZMS '                                          00986200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00987000
              AGO   .ZG75E                                              00988000
.ZG75D        ANOP  ,                                                   00989000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00990000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00991000
.ZG75E        ANOP  ,                                                   00992000
.********************************************************************   00993000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00994000
.********************************************************************   00995000
              ACTR  10000                                               00996000
.*-------------------------------------------------------------------   00997000
.***AG.MF03 MF=(SLME)                                                   00998000
              AIF   ('&XMF' EQ 'L').ZGMFX                               00999000
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     01000000
.*------------------------------------------------------------------    01001000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01002000
&XFUNC        SETC  ''          INITIALIZE XVARIABLE                    01003000
.*-------------------------------------------------------------------   01004000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01005000
.ZG3          ANOP  ,                                                   01006000
              AIF   (K'&FUNC(1) LE 0).ZG3A                              01007000
&ZTLC         SETC 'LPA'                                                01008000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG4                         01009000
&XFUNC        SETC  'LPA'       SET KEYWORD                             01010000
              AIF   (N'&FUNC LE 1).ZG3A         CK NUM                  01011000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01012000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01013000
&ZMS          SETC  '&ZMS "FUNC"'                                       01014000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01015000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01016000
.ZG3A         ANOP  ,                                                   01017000
.*------------------------------------------------------------------    01018000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01019000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             01020000
.ZG3A0        AIF   (K'&TCBADDR LE 0).ZG3A1     OK                      01021000
&ZCVAL        SETC '&ZCVAL TCBADDR'             INCORRECT KEY USED      01022000
.ZG3A1        AIF   (K'&RBADDR LE 0).ZG3A2      OK                      01023000
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      01024000
.ZG3A2        AIF   (K'&ZCVAL LE 0).ZG3A3       OK                      01025000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               01026000
&ZMS          SETC  '"FUNC'     *KMEIA* MNOTE                           01027000
&ZMS          SETC  '&ZMS.=&FUNC"'                                      01028000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                01029000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                01030000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01031000
.ZG3A3        ANOP  ,                                                   01032000
.*-------------------------------------------------------------------   01033000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01034000
.ZG4          ANOP  ,                                                   01035000
&ZTLC         SETC 'JPA'                                                01036000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG8                         01037000
&XFUNC        SETC  'JPA'       SET KEYWORD                             01038000
              AIF   (N'&FUNC LE 1).ZG4A         CK NUM                  01039000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01040000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01041000
&ZMS          SETC  '&ZMS "FUNC"'                                       01042000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01043000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01044000
.ZG4A         ANOP  ,                                                   01045000
.*------------------------------------------------------------------    01046000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01047000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             01048000
.ZG4A0        AIF   (K'&RBADDR LE 0).ZG4A1      OK                      01049000
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      01050000
.ZG4A1        AIF   (K'&ZCVAL LE 0).ZG4A2       OK                      01051000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               01052000
&ZMS          SETC  '"FUNC'     *KMEIA* MNOTE                           01053000
&ZMS          SETC  '&ZMS.=&FUNC"'                                      01054000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                01055000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                01056000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01057000
.ZG4A2        ANOP  ,                                                   01058000
.*----------------------------------------------------------------***   01059000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01060000
              AIF   (N'&TCBADDR LE 1).ZG6A      CK NUM                  01061000
&ZMS          SETC  '"TCBADDR='                 *KPOSA* MNOTE           01062000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01063000
&ZMS          SETC  '&ZMS "TCBADDR"'                                    01064000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01065000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01066000
.ZG6A         ANOP  ,                                                   01067000
.*-------------------------------------------------------------------   01068000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01069000
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           01070000
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           01071000
              AIF   (N'&TCBADDR GT 1).ZG6B      MULTI PARMS             01072000
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           01073000
.ZG6B         AIF   (K'&TCBADDR(1) GT 0).ZG6C                           01074000
&ZXTCBADDR    SETC  ''          RESET IN/OUTPUT                         01075000
&ZMS          SETC  ' '         *KRQDA*                                 01076000
&ZMS          SETC  '&ZMS "TCBADDR" KEY AND ITS ARGUMENT'               01077000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             01078000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01079000
.ZG6C         ANOP  ,                                                   01080000
.*-------------------------------------------------------------------   01081000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01082000
              AIF   (K'&ZXTCBADDR LE 0).ZG6R    NOT I/O                 01083000
              AIF   ('&XTCBADDR'(1,1) NE '(').ZG6R                      01084000
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        01085000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                         01086000
              AIF   (K'&ZCGPR GT 2).ZG6Q                                01087000
              AIF   ('&ZCGPR' EQ '0').ZG6Q                              01088000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01089000
              AIF   (T'&ZCGPR NE 'N').ZG6Q      INVALID REG NAME        01090000
.ZG6P         ANOP  ,                                                   01091000
              AIF   (T'&ZCGPR NE 'N').ZG6R      NON NUMERIC             01092000
              AIF   ('&ZCGPR' LT '2').ZG6Q                              01093000
              AIF   ('&ZCGPR' LE '12').ZG6R                             01094000
.ZG6Q         ANOP  ,                                                   01095000
&ZMS          SETC  '"TCBADDR='                 *KGPRA* MNOTE           01096000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01097000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01098000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01099000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01100000
.ZG6R         ANOP  ,                                                   01101000
.*-------------------------------------------------------------------   01102000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01103000
.ZG8          ANOP  ,                                                   01104000
&ZTLC         SETC 'TASKLOAD'                                           01105000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG12                        01106000
&XFUNC        SETC  'TASKLOAD'  SET KEYWORD                             01107000
              AIF   (N'&FUNC LE 1).ZG8A         CK NUM                  01108000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01109000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01110000
&ZMS          SETC  '&ZMS "FUNC"'                                       01111000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01112000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01113000
.ZG8A         ANOP  ,                                                   01114000
.*------------------------------------------------------------------    01115000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01116000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             01117000
.ZG8A0        AIF   (K'&RBADDR LE 0).ZG8A1      OK                      01118000
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      01119000
.ZG8A1        AIF   (K'&ZCVAL LE 0).ZG8A2       OK                      01120000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               01121000
&ZMS          SETC  '"FUNC'     *KMEIA* MNOTE                           01122000
&ZMS          SETC  '&ZMS.=&FUNC"'                                      01123000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                01124000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                01125000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01126000
.ZG8A2        ANOP  ,                                                   01127000
.*----------------------------------------------------------------***   01128000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01129000
              AIF   (N'&TCBADDR LE 1).ZG10A     CK NUM                  01130000
&ZMS          SETC  '"TCBADDR='                 *KPOSA* MNOTE           01131000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01132000
&ZMS          SETC  '&ZMS "TCBADDR"'                                    01133000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01134000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01135000
.ZG10A        ANOP  ,                                                   01136000
.*-------------------------------------------------------------------   01137000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01138000
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           01139000
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           01140000
              AIF   (N'&TCBADDR GT 1).ZG10B     MULTI PARMS             01141000
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           01142000
.ZG10B        AIF   (K'&TCBADDR(1) GT 0).ZG10C                          01143000
&ZXTCBADDR    SETC  ''          RESET IN/OUTPUT                         01144000
&ZMS          SETC  ' '         *KRQDA*                                 01145000
&ZMS          SETC  '&ZMS "TCBADDR" KEY AND ITS ARGUMENT'               01146000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             01147000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01148000
.ZG10C        ANOP  ,                                                   01149000
.*-------------------------------------------------------------------   01150000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01151000
              AIF   (K'&ZXTCBADDR LE 0).ZG10R   NOT I/O                 01152000
              AIF   ('&XTCBADDR'(1,1) NE '(').ZG10R                     01153000
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        01154000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        01155000
              AIF   (K'&ZCGPR GT 2).ZG10Q                               01156000
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             01157000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01158000
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        01159000
.ZG10P        ANOP  ,                                                   01160000
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             01161000
              AIF   ('&ZCGPR' LT '2').ZG10Q                             01162000
              AIF   ('&ZCGPR' LE '12').ZG10R                            01163000
.ZG10Q        ANOP  ,                                                   01164000
&ZMS          SETC  '"TCBADDR='                 *KGPRA* MNOTE           01165000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01166000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01167000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01168000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01169000
.ZG10R        ANOP  ,                                                   01170000
.*-------------------------------------------------------------------   01171000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01172000
.ZG12         ANOP  ,                                                   01173000
&ZTLC         SETC 'TASKALL'                                            01174000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG16                        01175000
&XFUNC        SETC  'TASKALL'   SET KEYWORD                             01176000
              AIF   (N'&FUNC LE 1).ZG12A        CK NUM                  01177000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01178000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01179000
&ZMS          SETC  '&ZMS "FUNC"'                                       01180000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01181000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01182000
.ZG12A        ANOP  ,                                                   01183000
.*------------------------------------------------------------------    01184000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01185000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             01186000
.ZG12A0       AIF   (K'&RBADDR LE 0).ZG12A1     OK                      01187000
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      01188000
.ZG12A1       AIF   (K'&ZCVAL LE 0).ZG12A2      OK                      01189000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               01190000
&ZMS          SETC  '"FUNC'     *KMEIA* MNOTE                           01191000
&ZMS          SETC  '&ZMS.=&FUNC"'                                      01192000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                01193000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                01194000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01195000
.ZG12A2       ANOP  ,                                                   01196000
.*----------------------------------------------------------------***   01197000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01198000
              AIF   (N'&TCBADDR LE 1).ZG14A     CK NUM                  01199000
&ZMS          SETC  '"TCBADDR='                 *KPOSA* MNOTE           01200000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01201000
&ZMS          SETC  '&ZMS "TCBADDR"'                                    01202000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01203000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01204000
.ZG14A        ANOP  ,                                                   01205000
.*-------------------------------------------------------------------   01206000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01207000
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           01208000
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           01209000
              AIF   (N'&TCBADDR GT 1).ZG14B     MULTI PARMS             01210000
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           01211000
.ZG14B        AIF   (K'&TCBADDR(1) GT 0).ZG14C                          01212000
&ZXTCBADDR    SETC  ''          RESET IN/OUTPUT                         01213000
&ZMS          SETC  ' '         *KRQDA*                                 01214000
&ZMS          SETC  '&ZMS "TCBADDR" KEY AND ITS ARGUMENT'               01215000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             01216000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01217000
.ZG14C        ANOP  ,                                                   01218000
.*-------------------------------------------------------------------   01219000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01220000
              AIF   (K'&ZXTCBADDR LE 0).ZG14R   NOT I/O                 01221000
              AIF   ('&XTCBADDR'(1,1) NE '(').ZG14R                     01222000
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        01223000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                        01224000
              AIF   (K'&ZCGPR GT 2).ZG14Q                               01225000
              AIF   ('&ZCGPR' EQ '0').ZG14Q                             01226000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01227000
              AIF   (T'&ZCGPR NE 'N').ZG14Q     INVALID REG NAME        01228000
.ZG14P        ANOP  ,                                                   01229000
              AIF   (T'&ZCGPR NE 'N').ZG14R     NON NUMERIC             01230000
              AIF   ('&ZCGPR' LT '2').ZG14Q                             01231000
              AIF   ('&ZCGPR' LE '12').ZG14R                            01232000
.ZG14Q        ANOP  ,                                                   01233000
&ZMS          SETC  '"TCBADDR='                 *KGPRA* MNOTE           01234000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01235000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01236000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01237000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01238000
.ZG14R        ANOP  ,                                                   01239000
.*-------------------------------------------------------------------   01240000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01241000
.ZG16         ANOP  ,                                                   01242000
&ZTLC         SETC 'RB'                                                 01243000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG20                        01244000
&XFUNC        SETC  'RB'        SET KEYWORD                             01245000
              AIF   (N'&FUNC LE 1).ZG16A        CK NUM                  01246000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01247000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01248000
&ZMS          SETC  '&ZMS "FUNC"'                                       01249000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01251000
.ZG16A        ANOP  ,                                                   01252000
.*------------------------------------------------------------------    01253000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01254000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             01255000
.ZG16A0       AIF   (K'&TCBADDR LE 0).ZG16A1    OK                      01256000
&ZCVAL        SETC '&ZCVAL TCBADDR'             INCORRECT KEY USED      01257000
.ZG16A1       AIF   (K'&ZCVAL LE 0).ZG16A2      OK                      01258000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               01259000
&ZMS          SETC  '"FUNC'     *KMEIA* MNOTE                           01260000
&ZMS          SETC  '&ZMS.=&FUNC"'                                      01261000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                01262000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                01263000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01264000
.ZG16A2       ANOP  ,                                                   01265000
.*----------------------------------------------------------------***   01266000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01267000
              AIF   (N'&RBADDR LE 1).ZG18A      CK NUM                  01268000
&ZMS          SETC  '"RBADDR='  *KPOSA* MNOTE                           01269000
&ZMS          SETC  '&ZMS.&RBADDR"'                                     01270000
&ZMS          SETC  '&ZMS "RBADDR"'                                     01271000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01272000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01273000
.ZG18A        ANOP  ,                                                   01274000
.*-------------------------------------------------------------------   01275000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01276000
&ZXRBADDR     SETC  'INPUT'     SET IN/OUTPUT                           01277000
&XRBADDR      SETC  '&RBADDR(1)'                SET XVARIABLE           01278000
              AIF   (N'&RBADDR GT 1).ZG18B      MULTI PARMS             01279000
&XRBADDR      SETC  '&RBADDR'   SET XVARIABLE                           01280000
.ZG18B        AIF   (K'&RBADDR(1) GT 0).ZG18C                           01281000
&ZXRBADDR     SETC  ''          RESET IN/OUTPUT                         01282000
&ZMS          SETC  ' '         *KRQDA*                                 01283000
&ZMS          SETC  '&ZMS "RBADDR" KEY AND ITS ARGUMENT'                01284000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             01285000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01286000
.ZG18C        ANOP  ,                                                   01287000
.*-------------------------------------------------------------------   01288000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01289000
              AIF   (K'&ZXRBADDR LE 0).ZG18R    NOT I/O                 01290000
              AIF   ('&XRBADDR'(1,1) NE '(').ZG18R                      01291000
&ZCGPR        SETC  '&XRBADDR'(2,K'&XRBADDR-2)                          01292000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                        01293000
              AIF   (K'&ZCGPR GT 2).ZG18Q                               01294000
              AIF   ('&ZCGPR' EQ '0').ZG18Q                             01295000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01296000
              AIF   (T'&ZCGPR NE 'N').ZG18Q     INVALID REG NAME        01297000
.ZG18P        ANOP  ,                                                   01298000
              AIF   (T'&ZCGPR NE 'N').ZG18R     NON NUMERIC             01299000
              AIF   ('&ZCGPR' LT '2').ZG18Q                             01300000
              AIF   ('&ZCGPR' LE '12').ZG18R                            01301000
.ZG18Q        ANOP  ,                                                   01302000
&ZMS          SETC  '"RBADDR='  *KGPRA* MNOTE                           01303000
&ZMS          SETC  '&ZMS.&RBADDR"'                                     01304000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01305000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01306000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01307000
.ZG18R        ANOP  ,                                                   01308000
.*------------------------------------------------------------------    01309000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01310000
.ZG20         ANOP  ,                                                   01311000
&ZXFUNC       SETC  'INPUT'     SET IN/OUTPUT                           01312000
              AIF   (K'&XFUNC GT 0).ZG20E       VALID ARG               01313000
              AIF   (T'&FUNC EQ 'O').ZG20D      OMITTED                 01314000
&ZASYSLNDX    SETA  0                                                   01315000
.ZG20A        ANOP  ,           POSITIONAL MACRO KEY                    01316000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        01317000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG20C                    01318000
&ZTLC         SETC 'FUNC'                                               01319000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG20A           01320000
.ZG20B        ANOP  ,                                                   01321000
&ZXFUNC       SETC  ''          RESET IN/OUTPUT                         01322000
&ZMS          SETC  'THE "FUNC" KEY'            *KOPTA* MNOTE           01323000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             01324000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    01325000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01326000
              AGO   .ZG20E                                              01327000
.ZG20C        ANOP  ,                                                   01328000
&ZXFUNC       SETC  ''          RESET IN/OUTPUT                         01329000
&ZMS          SETC  '"FUNC='    *KUKWA* MNOTE                           01330000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01331000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           01332000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01333000
&ZMS          SETC  '&ZMS "LPA",'               VALID KEYWORD           01334000
&ZMS          SETC  '&ZMS "JPA",'               VALID KEYWORD           01335000
&ZMS          SETC  '&ZMS "TASKLOAD",'          VALID KEYWORD           01336000
&ZMS          SETC  '&ZMS "TASKALL",'           VALID KEYWORD           01337000
&ZMS          SETC  '&ZMS OR "RB".'             VALID KEYWORD           01337600
              MNOTE 8,' &ZMS '                                          01338200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01339000
              AGO   .ZG20E                                              01340000
.ZG20D        ANOP  ,                                                   01341000
&XFUNC        SETC  'LPA'       SET DEFAULT KEYWORD                     01342000
.ZG20E        ANOP  ,                                                   01343000
.*------------------------------------------------------------------    01344000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01345000
              AIF   (K'&FUNC(1) GT 0).ZG20F     PARM                    01346000
&XFUNC        SETC  ''          ENSURE NULL KEYWORD                     01347000
&ZXFUNC       SETC  ''          RESET IN/OUTPUT                         01348000
&ZMS          SETC  'THE'                                               01349000
&ZMS          SETC  '&ZMS "FUNC" KEY AND ITS ARGUMENT'                  01350000
&ZMS          SETC  '&ZMS ARE REQUIRED.'                                01351000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01352000
&ZMS          SETC  '&ZMS "LPA",'               VALID KEYWORD           01353000
&ZMS          SETC  '&ZMS "JPA",'               VALID KEYWORD           01354000
&ZMS          SETC  '&ZMS "TASKLOAD",'          VALID KEYWORD           01355000
&ZMS          SETC  '&ZMS "TASKALL",'           VALID KEYWORD           01356000
&ZMS          SETC  '&ZMS OR "RB".'             VALID KEYWORD           01356600
              MNOTE 8,' &ZMS '                                          01357200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01358000
.ZG20F        ANOP  ,                                                   01359000
.*------------------------------------------------------------------    01360000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01361000
&XENV         SETC  ''          INITIALIZE XVARIABLE                    01362000
.*-------------------------------------------------------------------   01363000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01364000
.ZG23         ANOP  ,                                                   01365000
              AIF   (K'&ENV(1) LE 0).ZG23A                              01366000
&ZTLC         SETC 'MVS'                                                01367000
              AIF   ('&ENV(1)' NE '&ZTLC').ZG24                         01368000
&XENV         SETC  'MVS'       SET KEYWORD                             01369000
              AIF   (N'&ENV LE 1).ZG23A         CK NUM                  01370000
&ZMS          SETC  '"ENV='     *KPOSA* MNOTE                           01371000
&ZMS          SETC  '&ZMS.&ENV"'                                        01372000
&ZMS          SETC  '&ZMS "ENV"'                                        01373000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01374000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01375000
.ZG23A        ANOP  ,                                                   01376000
.*------------------------------------------------------------------    01377000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01378000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             01379000
.ZG23A0       AIF   (K'&ABDPLPTR LE 0).ZG23A1   OK                      01380000
&ZCVAL        SETC '&ZCVAL ABDPLPTR'            INCORRECT KEY USED      01381000
.ZG23A1       AIF   (K'&ASID LE 0).ZG23A2       OK                      01382000
&ZCVAL        SETC '&ZCVAL ASID'                INCORRECT KEY USED      01383000
.ZG23A2       AIF   (K'&ZCVAL LE 0).ZG23A3      OK                      01384000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               01385000
&ZMS          SETC  '"ENV'      *KMEIA* MNOTE                           01386000
&ZMS          SETC  '&ZMS.=&ENV"'                                       01387000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                01388000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                01389000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01390000
.ZG23A3       ANOP  ,                                                   01391000
.*-------------------------------------------------------------------   01392000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01393000
.ZG24         ANOP  ,                                                   01394000
&ZTLC         SETC 'IPCS'                                               01395000
              AIF   ('&ENV(1)' NE '&ZTLC').ZG31                         01396000
&XENV         SETC  'IPCS'      SET KEYWORD                             01397000
              AIF   (N'&ENV LE 1).ZG24A         CK NUM                  01398000
&ZMS          SETC  '"ENV='     *KPOSA* MNOTE                           01399000
&ZMS          SETC  '&ZMS.&ENV"'                                        01400000
&ZMS          SETC  '&ZMS "ENV"'                                        01401000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01402000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01403000
.ZG24A        ANOP  ,                                                   01404000
.*----------------------------------------------------------------***   01405000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01406000
              AIF   (N'&ABDPLPTR LE 1).ZG26A    CK NUM                  01407000
&ZMS          SETC  '"ABDPLPTR='                *KPOSA* MNOTE           01408000
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   01409000
&ZMS          SETC  '&ZMS "ABDPLPTR"'                                   01410000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01411000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01412000
.ZG26A        ANOP  ,                                                   01413000
.*-------------------------------------------------------------------   01414000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01415000
&ZXABDPLPTR   SETC  'INPUT'     SET IN/OUTPUT                           01416000
&XABDPLPTR    SETC  '&ABDPLPTR(1)'              SET XVARIABLE           01417000
              AIF   (N'&ABDPLPTR GT 1).ZG26B    MULTI PARMS             01418000
&XABDPLPTR    SETC  '&ABDPLPTR'                 SET XVARIABLE           01419000
.ZG26B        AIF   (K'&ABDPLPTR(1) GT 0).ZG26C                         01420000
&ZXABDPLPTR   SETC  ''          RESET IN/OUTPUT                         01421000
&ZMS          SETC  ' '         *KRQDA*                                 01422000
&ZMS          SETC  '&ZMS "ABDPLPTR" KEY AND ITS ARGUMENT'              01423000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             01424000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01425000
.ZG26C        ANOP  ,                                                   01426000
.*-------------------------------------------------------------------   01427000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01428000
              AIF   (K'&ZXABDPLPTR LE 0).ZG26R  NOT I/O                 01429000
              AIF   ('&XABDPLPTR'(1,1) NE '(').ZG26R                    01430000
&ZCGPR        SETC  '&XABDPLPTR'(2,K'&XABDPLPTR-2)                      01431000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        01432000
              AIF   (K'&ZCGPR GT 2).ZG26Q                               01433000
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             01434000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01435000
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        01436000
.ZG26P        ANOP  ,                                                   01437000
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             01438000
              AIF   ('&ZCGPR' LT '2').ZG26Q                             01439000
              AIF   ('&ZCGPR' LE '12').ZG26R                            01440000
.ZG26Q        ANOP  ,                                                   01441000
&ZMS          SETC  '"ABDPLPTR='                *KGPRA* MNOTE           01442000
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   01443000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01444000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01445000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01446000
.ZG26R        ANOP  ,                                                   01447000
.*----------------------------------------------------------------***   01448000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01449000
              AIF   (N'&ASID LE 1).ZG29A        CK NUM                  01450000
&ZMS          SETC  '"ASID='    *KPOSA* MNOTE                           01451000
&ZMS          SETC  '&ZMS.&ASID"'                                       01452000
&ZMS          SETC  '&ZMS "ASID"'                                       01453000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01454000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01455000
.ZG29A        ANOP  ,                                                   01456000
.*-------------------------------------------------------------------   01457000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01458000
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           01459000
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           01460000
              AIF   (N'&ASID GT 1).ZG29B        MULTI PARMS             01461000
&XASID        SETC  '&ASID'     SET XVARIABLE                           01462000
.ZG29B        AIF   (K'&ASID(1) GT 0).ZG29C                             01463000
&ZXASID       SETC  ''          RESET IN/OUTPUT                         01464000
&ZMS          SETC  ' '         *KRQDA*                                 01465000
&ZMS          SETC  '&ZMS "ASID" KEY AND ITS ARGUMENT'                  01466000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             01467000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01468000
.ZG29C        ANOP  ,                                                   01469000
.*-------------------------------------------------------------------   01470000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01471000
              AIF   (K'&ZXASID LE 0).ZG29R      NOT I/O                 01472000
              AIF   ('&XASID'(1,1) NE '(').ZG29R                        01473000
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              01474000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                        01475000
              AIF   (K'&ZCGPR GT 2).ZG29Q                               01476000
              AIF   ('&ZCGPR' EQ '0').ZG29Q                             01477000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01478000
              AIF   (T'&ZCGPR NE 'N').ZG29Q     INVALID REG NAME        01479000
.ZG29P        ANOP  ,                                                   01480000
              AIF   (T'&ZCGPR NE 'N').ZG29R     NON NUMERIC             01481000
              AIF   ('&ZCGPR' LT '2').ZG29Q                             01482000
              AIF   ('&ZCGPR' LE '12').ZG29R                            01483000
.ZG29Q        ANOP  ,                                                   01484000
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           01485000
&ZMS          SETC  '&ZMS.&ASID"'                                       01486000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01487000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01488000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01489000
.ZG29R        ANOP  ,                                                   01490000
.*------------------------------------------------------------------    01491000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01492000
.ZG31         ANOP  ,                                                   01493000
&ZXENV        SETC  'INPUT'     SET IN/OUTPUT                           01494000
              AIF   (K'&XENV GT 0).ZG31E        VALID ARG               01495000
              AIF   (T'&ENV EQ 'O').ZG31D       OMITTED                 01496000
&ZASYSLNDX    SETA  0                                                   01497000
.ZG31A        ANOP  ,           POSITIONAL MACRO KEY                    01498000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        01499000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG31C                    01500000
&ZTLC         SETC 'ENV'                                                01501000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG31A           01502000
.ZG31B        ANOP  ,                                                   01503000
&ZXENV        SETC  ''          RESET IN/OUTPUT                         01504000
&ZMS          SETC  'THE "ENV" KEY'             *KOPTA* MNOTE           01505000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             01506000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    01507000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01508000
              AGO   .ZG31E                                              01509000
.ZG31C        ANOP  ,                                                   01510000
&ZXENV        SETC  ''          RESET IN/OUTPUT                         01511000
&ZMS          SETC  '"ENV='     *KUKWA* MNOTE                           01512000
&ZMS          SETC  '&ZMS.&ENV"'                                        01513000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           01514000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01515000
&ZMS          SETC  '&ZMS "MVS"'                VALID KEYWORD           01516000
&ZMS          SETC  '&ZMS OR "IPCS".'           VALID KEYWORD           01516600
              MNOTE 8,' &ZMS '                                          01517200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01518000
              AGO   .ZG31E                                              01519000
.ZG31D        ANOP  ,                                                   01520000
&XENV         SETC  'MVS'       SET DEFAULT KEYWORD                     01521000
.ZG31E        ANOP  ,                                                   01522000
.*------------------------------------------------------------------    01523000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01524000
              AIF   (K'&ENV(1) GT 0).ZG31F      PARM                    01525000
&XENV         SETC  ''          ENSURE NULL KEYWORD                     01526000
&ZXENV        SETC  ''          RESET IN/OUTPUT                         01527000
&ZMS          SETC  'THE'                                               01528000
&ZMS          SETC  '&ZMS "ENV" KEY AND ITS ARGUMENT'                   01529000
&ZMS          SETC  '&ZMS ARE REQUIRED.'                                01530000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01531000
&ZMS          SETC  '&ZMS "MVS"'                VALID KEYWORD           01532000
&ZMS          SETC  '&ZMS OR "IPCS".'           VALID KEYWORD           01532600
              MNOTE 8,' &ZMS '                                          01533200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01534000
.ZG31F        ANOP  ,                                                   01535000
.*----------------------------------------------------------------***   01536000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     01537000
              AIF   (N'&MIPR LE 1).ZG33A        CK NUM                  01538000
&ZMS          SETC  '"MIPR='    *KPOSA* MNOTE                           01539000
&ZMS          SETC  '&ZMS.&MIPR"'                                       01540000
&ZMS          SETC  '&ZMS "MIPR"'                                       01541000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01542000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01543000
.ZG33A        ANOP  ,                                                   01544000
.*-------------------------------------------------------------------   01545000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         01546000
&ZXMIPR       SETC  'INPUT'     SET IN/OUTPUT                           01547000
&XMIPR        SETC  '&MIPR(1)'  SET XVARIABLE                           01548000
              AIF   (N'&MIPR GT 1).ZG33B        MULTI PARMS             01549000
&XMIPR        SETC  '&MIPR'     SET XVARIABLE                           01550000
.ZG33B        AIF   (K'&MIPR(1) GT 0).ZG33C                             01551000
&ZXMIPR       SETC  ''          RESET IN/OUTPUT                         01552000
&ZMS          SETC  ' '         *KRQDA*                                 01553000
&ZMS          SETC  '&ZMS "MIPR" KEY AND ITS ARGUMENT'                  01554000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             01555000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01556000
.ZG33C        ANOP  ,                                                   01557000
.*-------------------------------------------------------------------   01558000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01559000
              AIF   (K'&ZXMIPR LE 0).ZG33R      NOT I/O                 01560000
              AIF   ('&XMIPR'(1,1) NE '(').ZG33R                        01561000
&ZCGPR        SETC  '&XMIPR'(2,K'&XMIPR-2)                              01562000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                        01563000
              AIF   (K'&ZCGPR GT 2).ZG33Q                               01564000
              AIF   ('&ZCGPR' EQ '0').ZG33Q                             01565000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01566000
              AIF   (T'&ZCGPR NE 'N').ZG33Q     INVALID REG NAME        01567000
.ZG33P        ANOP  ,                                                   01568000
              AIF   (T'&ZCGPR NE 'N').ZG33R     NON NUMERIC             01569000
              AIF   ('&ZCGPR' LT '2').ZG33Q                             01570000
              AIF   ('&ZCGPR' LE '12').ZG33R                            01571000
.ZG33Q        ANOP  ,                                                   01572000
&ZMS          SETC  '"MIPR='    *KGPRA* MNOTE                           01573000
&ZMS          SETC  '&ZMS.&MIPR"'                                       01574000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01575000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01576000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01577000
.ZG33R        ANOP  ,                                                   01578000
.*----------------------------------------------------------------***   01579000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01580000
              AIF   (N'&USERDATA LE 1).ZG36A    CK NUM                  01581000
&ZMS          SETC  '"USERDATA='                *KPOSA* MNOTE           01582000
&ZMS          SETC  '&ZMS.&USERDATA"'                                   01583000
&ZMS          SETC  '&ZMS "USERDATA"'                                   01584000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01585000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01586000
.ZG36A        ANOP  ,                                                   01587000
.*-------------------------------------------------------------------   01588000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01589000
&ZXUSERDATA   SETC  'INPUT'     SET IN/OUTPUT                           01590000
&XUSERDATA    SETC  'NULL'                                              01591000
              AIF   (K'&USERDATA(1) LE 0).ZG36B  PARM                   01592000
&XUSERDATA    SETC  '&USERDATA(1)'              SET XVARIABLE           01593000
              AIF   (N'&USERDATA GT 1).ZG36B    MULTI PARMS             01594000
&XUSERDATA    SETC  '&USERDATA'                 SET XVARIABLE           01595000
.ZG36B        ANOP  ,                                                   01596000
.*-------------------------------------------------------------------   01597000
.***AG.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     01598000
              AIF   (K'&ZXUSERDATA LE 0).ZG36P  NOT I/O                 01599000
              AIF   ('&XUSERDATA' EQ 'NULL').ZG36P                      01600000
              AIF   ('&XUSERDATA'(1,1) NE '(').ZG36P                    01601000
&ZXUSERDATA   SETC  ''          RESET IN/OUTPUT                         01602000
&ZMS          SETC  '"USERDATA='                *KGPRA* MNOTE           01603000
&ZMS          SETC  '&ZMS.&USERDATA"'                                   01604000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           01605000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   01606000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01607000
.ZG36P        ANOP  ,                                                   01608000
.*----------------------------------------------------------------***   01609000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01610000
              AIF   (N'&RETCODE LE 1).ZG39A     CK NUM                  01611000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           01612000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    01613000
&ZMS          SETC  '&ZMS "RETCODE"'                                    01614000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01615000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01616000
.ZG39A        ANOP  ,                                                   01617000
.*-------------------------------------------------------------------   01618000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01619000
              AIF   (K'&RETCODE(1) LE 0).ZG39C  NO PARM                 01620000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              01621000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           01622000
              AIF   (N'&RETCODE GT 1).ZG39C                             01623000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           01624000
.ZG39C        ANOP  ,                                                   01625000
.*-------------------------------------------------------------------   01626000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01627000
              AIF   (K'&ZXRETCODE LE 0).ZG39R   NOT I/O                 01628000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG39R                     01629000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        01630000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG39P                        01631000
              AIF   (K'&ZCGPR GT 2).ZG39Q                               01632000
              AIF   ('&ZCGPR' EQ '0').ZG39Q                             01633000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01634000
              AIF   (T'&ZCGPR NE 'N').ZG39Q     INVALID REG NAME        01635000
.ZG39P        ANOP  ,                                                   01636000
              AIF   (T'&ZCGPR NE 'N').ZG39R     NON NUMERIC             01637000
              AIF   ('&ZCGPR' LT '2').ZG39Q                             01638000
              AIF   ('&ZCGPR' LE '12').ZG39R                            01639000
.ZG39Q        ANOP  ,                                                   01640000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           01641000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    01642000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01643000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01644000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01645000
.ZG39R        ANOP  ,                                                   01646000
.*----------------------------------------------------------------***   01647000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01648000
              AIF   (N'&RSNCODE LE 1).ZG42A     CK NUM                  01649000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           01650000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    01651000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    01652000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01653000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01654000
.ZG42A        ANOP  ,                                                   01655000
.*-------------------------------------------------------------------   01656000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01657000
              AIF   (K'&RSNCODE(1) LE 0).ZG42C  NO PARM                 01658000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              01659000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           01660000
              AIF   (N'&RSNCODE GT 1).ZG42C                             01661000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           01662000
.ZG42C        ANOP  ,                                                   01663000
.*-------------------------------------------------------------------   01664000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01665000
              AIF   (K'&ZXRSNCODE LE 0).ZG42R   NOT I/O                 01666000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG42R                     01667000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        01668000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                        01669000
              AIF   (K'&ZCGPR GT 2).ZG42Q                               01670000
              AIF   ('&ZCGPR' EQ '0').ZG42Q                             01671000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01672000
              AIF   (T'&ZCGPR NE 'N').ZG42Q     INVALID REG NAME        01673000
.ZG42P        ANOP  ,                                                   01674000
              AIF   (T'&ZCGPR NE 'N').ZG42R     NON NUMERIC             01675000
              AIF   ('&ZCGPR' LT '2').ZG42Q                             01676000
              AIF   ('&ZCGPR' LE '12').ZG42R                            01677000
.ZG42Q        ANOP  ,                                                   01678000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           01679000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    01680000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01681000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01682000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01683000
.ZG42R        ANOP  ,                                                   01684000
.*----------------------------------------------------------------***   01685000
.***AG.KXVAR05 VALUE, OPT INPUT, KEYS -XVARIABLE KEY                    01686000
              AIF   (N'&COM LE 1).ZG45A         CK NUM                  01687000
&ZMS          SETC  '"COM='     *KPOSA* MNOTE                           01688000
&ZMS          SETC  '&ZMS.&COM"'                                        01689000
&ZMS          SETC  '&ZMS "COM"'                                        01690000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01691000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01692000
.ZG45A        ANOP  ,                                                   01693000
.*-------------------------------------------------------------------   01694000
.***AG.KXVAR13 VALUE, OPT INPUT, KEYS -XVARIABLE                        01695000
&ZXCOM        SETC  'INPUT'     SET IN/OUTPUT                           01696000
&XCOM         SETC  'NULL'                                              01697000
              AIF   (K'&COM(1) LE 0).ZG45B      PARM                    01698000
&XCOM         SETC  '&COM(1)'   SET XVARIABLE                           01699000
              AIF   (N'&COM GT 1).ZG45B         MULTI PARMS             01700000
&XCOM         SETC  '&COM'      SET XVARIABLE                           01701000
.ZG45B        ANOP  ,                                                   01702000
.*-------------------------------------------------------------------   01703000
.***AG.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    01704000
              AIF   (K'&ZXCOM LE 0).ZG45P       NOT I/O                 01705000
              AIF   ('&XCOM' EQ 'NULL').ZG45P                           01706000
              AIF   ('&XCOM'(1,1) NE '(').ZG45P                         01707000
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         01708000
&ZMS          SETC  '"COM='     *KGPRA* MNOTE                           01709000
&ZMS          SETC  '&ZMS.&COM"'                                        01710000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           01711000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   01712000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01713000
.ZG45P        ANOP  ,                                                   01714000
.*-------------------------------------------------------------------   01715000
.***AG.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   01716000
              AIF   (K'&ZXCOM LE 0).ZG45S       NOT I/O                 01717000
              AIF   ('&XCOM' EQ 'NULL').ZG45S                           01718000
              AIF   (K'&XCOM LE 256).ZG45S      LNG OK                  01719000
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         01720000
&ZMS          SETC  '"COM='     *KLNGA* MNOTE                           01721000
&ZMS          SETC  '&ZMS.&COM"'                                        01722000
&ZMS          SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'               01723000
              MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'                 01724000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01725000
.ZG45S        ANOP  ,                                                   01726000
.******************************************************************     01727000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        01728000
.******************************************************************     01729000
              ACTR  10000                                               01730000
.*----------------------------------------------------------------***   01731000
.***AH.P02 EXTRA POSITIONALS                                            01732000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               01733000
&ZCVAL        SETC  ''          ERROR FIELD                             01734000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       01735000
.ZGLIST2      ANOP  ,                                                   01736000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         01737000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                01738000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   01739000
              AGO   .ZGLIST2                                            01740000
.*                                                                      01741000
.ZGLIST3      ANOP  ,                                                   01742000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             01743000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           01744000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     01745000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              01746000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      01747000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              01748000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01749000
.ZGLISTX      ANOP  ,                                                   01750000
&ZASYSLNDX    SETA  0                                                   01751000
.*-------------------------------------------------------------------   01752000
.***AG.MF04 MF=(SLME)                                                   01753000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                01754000
.********************************************************************   01755000
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             01756000
.********************************************************************   01757000
              ACTR  10000                                               01758000
.*-------------------------------------------------------------------   01759000
.***AE.MF01 MF=(SLME)                                                   01760000
              AIF   ('&XMF' EQ 'L').ZEMFX                               01761000
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      01762000
.********************************************************************   01763000
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        01764000
.********************************************************************   01765000
&XFUNC        SETC  ''          INITIALIZE XVARIABLE                    01766000
&XENV         SETC  ''          INITIALIZE XVARIABLE                    01767000
.*-------------------------------------------------------------------   01768000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01769000
&ZTLC         SETC 'LPA'                                                01770000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE3A                        01771000
&XFUNC        SETC  'LPA'       SET KEYWORD                             01772000
              AIF   (N'&FUNC LE 1).ZE3A         CK NUM                  01773000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01774000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01775000
&ZMS          SETC  '&ZMS "FUNC"'                                       01776000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01777000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01778000
.ZE3A         ANOP  ,                                                   01779000
.*-------------------------------------------------------------------   01780000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01781000
&ZTLC         SETC 'JPA'                                                01782000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE4A                        01783000
&XFUNC        SETC  'JPA'       SET KEYWORD                             01784000
              AIF   (N'&FUNC LE 1).ZE4A         CK NUM                  01785000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01786000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01787000
&ZMS          SETC  '&ZMS "FUNC"'                                       01788000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01789000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01790000
.ZE4A         ANOP  ,                                                   01791000
.*----------------------------------------------------------------***   01792000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          01793000
              AIF   (N'&TCBADDR LE 1).ZE6A      CK NUM                  01794000
&ZMS          SETC  '"TCBADDR='                 *KPOSA* MNOTE           01795000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01796000
&ZMS          SETC  '&ZMS "TCBADDR"'                                    01797000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01798000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01799000
.ZE6A         ANOP  ,                                                   01800000
.*-------------------------------------------------------------------   01801000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     01802000
              AIF   (K'&TCBADDR(1) LE 0).ZE6B   NO PRM                  01803000
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           01804000
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           01805000
              AIF   (N'&TCBADDR GT 1).ZE6B                              01806000
.*            ANOP              MULTIPLE PARMS                          01807000
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           01808000
.ZE6B         ANOP  ,                                                   01809000
.*-------------------------------------------------------------------   01810000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01811000
              AIF   (K'&ZXTCBADDR LE 0).ZE6R    NOT I/O                 01812000
              AIF   ('&XTCBADDR'(1,1) NE '(').ZE6R                      01813000
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        01814000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE6P                         01815000
              AIF   (K'&ZCGPR GT 2).ZE6Q                                01816000
              AIF   ('&ZCGPR' EQ '0').ZE6Q                              01817000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01818000
              AIF   (T'&ZCGPR NE 'N').ZE6Q      INVALID REG NAME        01819000
.ZE6P         ANOP  ,                                                   01820000
              AIF   (T'&ZCGPR NE 'N').ZE6R      NON NUMERIC             01821000
              AIF   ('&ZCGPR' LT '2').ZE6Q                              01822000
              AIF   ('&ZCGPR' LE '12').ZE6R                             01823000
.ZE6Q         ANOP  ,                                                   01824000
&ZMS          SETC  '"TCBADDR='                 *KGPRA* MNOTE           01825000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01826000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01827000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01828000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01829000
.ZE6R         ANOP  ,                                                   01830000
.*-------------------------------------------------------------------   01831000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01832000
&ZTLC         SETC 'TASKLOAD'                                           01833000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE8A                        01834000
&XFUNC        SETC  'TASKLOAD'  SET KEYWORD                             01835000
              AIF   (N'&FUNC LE 1).ZE8A         CK NUM                  01836000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01837000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01838000
&ZMS          SETC  '&ZMS "FUNC"'                                       01839000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01840000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01841000
.ZE8A         ANOP  ,                                                   01842000
.*----------------------------------------------------------------***   01843000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          01844000
              AIF   (N'&TCBADDR LE 1).ZE10A     CK NUM                  01845000
&ZMS          SETC  '"TCBADDR='                 *KPOSA* MNOTE           01846000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01847000
&ZMS          SETC  '&ZMS "TCBADDR"'                                    01848000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01849000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01850000
.ZE10A        ANOP  ,                                                   01851000
.*-------------------------------------------------------------------   01852000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     01853000
              AIF   (K'&TCBADDR(1) LE 0).ZE10B  NO PRM                  01854000
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           01855000
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           01856000
              AIF   (N'&TCBADDR GT 1).ZE10B                             01857000
.*            ANOP              MULTIPLE PARMS                          01858000
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           01859000
.ZE10B        ANOP  ,                                                   01860000
.*-------------------------------------------------------------------   01861000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01862000
              AIF   (K'&ZXTCBADDR LE 0).ZE10R   NOT I/O                 01863000
              AIF   ('&XTCBADDR'(1,1) NE '(').ZE10R                     01864000
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        01865000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        01866000
              AIF   (K'&ZCGPR GT 2).ZE10Q                               01867000
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             01868000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01869000
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        01870000
.ZE10P        ANOP  ,                                                   01871000
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             01872000
              AIF   ('&ZCGPR' LT '2').ZE10Q                             01873000
              AIF   ('&ZCGPR' LE '12').ZE10R                            01874000
.ZE10Q        ANOP  ,                                                   01875000
&ZMS          SETC  '"TCBADDR='                 *KGPRA* MNOTE           01876000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01877000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01878000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01879000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01880000
.ZE10R        ANOP  ,                                                   01881000
.*-------------------------------------------------------------------   01882000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01883000
&ZTLC         SETC 'TASKALL'                                            01884000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE12A                       01885000
&XFUNC        SETC  'TASKALL'   SET KEYWORD                             01886000
              AIF   (N'&FUNC LE 1).ZE12A        CK NUM                  01887000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01888000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01889000
&ZMS          SETC  '&ZMS "FUNC"'                                       01890000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01891000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01892000
.ZE12A        ANOP  ,                                                   01893000
.*----------------------------------------------------------------***   01894000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          01895000
              AIF   (N'&TCBADDR LE 1).ZE14A     CK NUM                  01896000
&ZMS          SETC  '"TCBADDR='                 *KPOSA* MNOTE           01897000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01898000
&ZMS          SETC  '&ZMS "TCBADDR"'                                    01899000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01901000
.ZE14A        ANOP  ,                                                   01902000
.*-------------------------------------------------------------------   01903000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     01904000
              AIF   (K'&TCBADDR(1) LE 0).ZE14B  NO PRM                  01905000
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           01906000
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           01907000
              AIF   (N'&TCBADDR GT 1).ZE14B                             01908000
.*            ANOP              MULTIPLE PARMS                          01909000
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           01910000
.ZE14B        ANOP  ,                                                   01911000
.*-------------------------------------------------------------------   01912000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01913000
              AIF   (K'&ZXTCBADDR LE 0).ZE14R   NOT I/O                 01914000
              AIF   ('&XTCBADDR'(1,1) NE '(').ZE14R                     01915000
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        01916000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE14P                        01917000
              AIF   (K'&ZCGPR GT 2).ZE14Q                               01918000
              AIF   ('&ZCGPR' EQ '0').ZE14Q                             01919000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01920000
              AIF   (T'&ZCGPR NE 'N').ZE14Q     INVALID REG NAME        01921000
.ZE14P        ANOP  ,                                                   01922000
              AIF   (T'&ZCGPR NE 'N').ZE14R     NON NUMERIC             01923000
              AIF   ('&ZCGPR' LT '2').ZE14Q                             01924000
              AIF   ('&ZCGPR' LE '12').ZE14R                            01925000
.ZE14Q        ANOP  ,                                                   01926000
&ZMS          SETC  '"TCBADDR='                 *KGPRA* MNOTE           01927000
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    01928000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01929000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01930000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01931000
.ZE14R        ANOP  ,                                                   01932000
.*-------------------------------------------------------------------   01933000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01934000
&ZTLC         SETC 'RB'                                                 01935000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE16A                       01936000
&XFUNC        SETC  'RB'        SET KEYWORD                             01937000
              AIF   (N'&FUNC LE 1).ZE16A        CK NUM                  01938000
&ZMS          SETC  '"FUNC='    *KPOSA* MNOTE                           01939000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01940000
&ZMS          SETC  '&ZMS "FUNC"'                                       01941000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01942000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01943000
.ZE16A        ANOP  ,                                                   01944000
.*----------------------------------------------------------------***   01945000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          01946000
              AIF   (N'&RBADDR LE 1).ZE18A      CK NUM                  01947000
&ZMS          SETC  '"RBADDR='  *KPOSA* MNOTE                           01948000
&ZMS          SETC  '&ZMS.&RBADDR"'                                     01949000
&ZMS          SETC  '&ZMS "RBADDR"'                                     01950000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01951000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01952000
.ZE18A        ANOP  ,                                                   01953000
.*-------------------------------------------------------------------   01954000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     01955000
              AIF   (K'&RBADDR(1) LE 0).ZE18B   NO PRM                  01956000
&ZXRBADDR     SETC  'INPUT'     SET IN/OUTPUT                           01957000
&XRBADDR      SETC  '&RBADDR(1)'                SET XVARIABLE           01958000
              AIF   (N'&RBADDR GT 1).ZE18B                              01959000
.*            ANOP              MULTIPLE PARMS                          01960000
&XRBADDR      SETC  '&RBADDR'   SET XVARIABLE                           01961000
.ZE18B        ANOP  ,                                                   01962000
.*-------------------------------------------------------------------   01963000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    01964000
              AIF   (K'&ZXRBADDR LE 0).ZE18R    NOT I/O                 01965000
              AIF   ('&XRBADDR'(1,1) NE '(').ZE18R                      01966000
&ZCGPR        SETC  '&XRBADDR'(2,K'&XRBADDR-2)                          01967000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE18P                        01968000
              AIF   (K'&ZCGPR GT 2).ZE18Q                               01969000
              AIF   ('&ZCGPR' EQ '0').ZE18Q                             01970000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01971000
              AIF   (T'&ZCGPR NE 'N').ZE18Q     INVALID REG NAME        01972000
.ZE18P        ANOP  ,                                                   01973000
              AIF   (T'&ZCGPR NE 'N').ZE18R     NON NUMERIC             01974000
              AIF   ('&ZCGPR' LT '2').ZE18Q                             01975000
              AIF   ('&ZCGPR' LE '12').ZE18R                            01976000
.ZE18Q        ANOP  ,                                                   01977000
&ZMS          SETC  '"RBADDR='  *KGPRA* MNOTE                           01978000
&ZMS          SETC  '&ZMS.&RBADDR"'                                     01979000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01980000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01981000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01982000
.ZE18R        ANOP  ,                                                   01983000
.*------------------------------------------------------------------    01984000
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           01985000
.ZE20         AIF   (K'&XFUNC GT 0).ZE20A       VALID                   01986000
              AIF   (K'&FUNC(1) LE 0).ZE20B                             01987000
&ZMS          SETC  '"FUNC='    *KUKWA* MNOTE                           01988000
&ZMS          SETC  '&ZMS.&FUNC"'                                       01989000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           01990000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01991000
&ZMS          SETC  '&ZMS "LPA",'               VALID KEYWORD           01992000
&ZMS          SETC  '&ZMS "JPA",'               VALID KEYWORD           01993000
&ZMS          SETC  '&ZMS "TASKLOAD",'          VALID KEYWORD           01994000
&ZMS          SETC  '&ZMS "TASKALL",'           VALID KEYWORD           01995000
&ZMS          SETC  '&ZMS OR "RB".'             VALID KEYWORD           01995600
              MNOTE 8,' &ZMS '                                          01996200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01997000
              AGO   .ZE20B                                              01998000
.*                                                                      01999000
.ZE20A        ANOP  ,                                                   02000000
&ZXFUNC       SETC  'INPUT'     SET IN/OUTPUT                           02001000
.ZE20B        ANOP  ,                                                   02002000
.*-------------------------------------------------------------------   02003000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02004000
&ZTLC         SETC 'MVS'                                                02005000
              AIF   ('&ENV(1)' NE '&ZTLC').ZE23A                        02006000
&XENV         SETC  'MVS'       SET KEYWORD                             02007000
              AIF   (N'&ENV LE 1).ZE23A         CK NUM                  02008000
&ZMS          SETC  '"ENV='     *KPOSA* MNOTE                           02009000
&ZMS          SETC  '&ZMS.&ENV"'                                        02010000
&ZMS          SETC  '&ZMS "ENV"'                                        02011000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02012000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02013000
.ZE23A        ANOP  ,                                                   02014000
.*-------------------------------------------------------------------   02015000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02016000
&ZTLC         SETC 'IPCS'                                               02017000
              AIF   ('&ENV(1)' NE '&ZTLC').ZE24A                        02018000
&XENV         SETC  'IPCS'      SET KEYWORD                             02019000
              AIF   (N'&ENV LE 1).ZE24A         CK NUM                  02020000
&ZMS          SETC  '"ENV='     *KPOSA* MNOTE                           02021000
&ZMS          SETC  '&ZMS.&ENV"'                                        02022000
&ZMS          SETC  '&ZMS "ENV"'                                        02023000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02024000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02025000
.ZE24A        ANOP  ,                                                   02026000
.*----------------------------------------------------------------***   02027000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02028000
              AIF   (N'&ABDPLPTR LE 1).ZE26A    CK NUM                  02029000
&ZMS          SETC  '"ABDPLPTR='                *KPOSA* MNOTE           02030000
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   02031000
&ZMS          SETC  '&ZMS "ABDPLPTR"'                                   02032000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02033000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02034000
.ZE26A        ANOP  ,                                                   02035000
.*-------------------------------------------------------------------   02036000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02037000
              AIF   (K'&ABDPLPTR(1) LE 0).ZE26B NO PRM                  02038000
&ZXABDPLPTR   SETC  'INPUT'     SET IN/OUTPUT                           02039000
&XABDPLPTR    SETC  '&ABDPLPTR(1)'              SET XVARIABLE           02040000
              AIF   (N'&ABDPLPTR GT 1).ZE26B                            02041000
.*            ANOP              MULTIPLE PARMS                          02042000
&XABDPLPTR    SETC  '&ABDPLPTR'                 SET XVARIABLE           02043000
.ZE26B        ANOP  ,                                                   02044000
.*-------------------------------------------------------------------   02045000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02046000
              AIF   (K'&ZXABDPLPTR LE 0).ZE26R  NOT I/O                 02047000
              AIF   ('&XABDPLPTR'(1,1) NE '(').ZE26R                    02048000
&ZCGPR        SETC  '&XABDPLPTR'(2,K'&XABDPLPTR-2)                      02049000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                        02050000
              AIF   (K'&ZCGPR GT 2).ZE26Q                               02051000
              AIF   ('&ZCGPR' EQ '0').ZE26Q                             02052000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       02053000
              AIF   (T'&ZCGPR NE 'N').ZE26Q     INVALID REG NAME        02054000
.ZE26P        ANOP  ,                                                   02055000
              AIF   (T'&ZCGPR NE 'N').ZE26R     NON NUMERIC             02056000
              AIF   ('&ZCGPR' LT '2').ZE26Q                             02057000
              AIF   ('&ZCGPR' LE '12').ZE26R                            02058000
.ZE26Q        ANOP  ,                                                   02059000
&ZMS          SETC  '"ABDPLPTR='                *KGPRA* MNOTE           02060000
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   02061000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           02062000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    02063000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02064000
.ZE26R        ANOP  ,                                                   02065000
.*----------------------------------------------------------------***   02066000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02067000
              AIF   (N'&ASID LE 1).ZE29A        CK NUM                  02068000
&ZMS          SETC  '"ASID='    *KPOSA* MNOTE                           02069000
&ZMS          SETC  '&ZMS.&ASID"'                                       02070000
&ZMS          SETC  '&ZMS "ASID"'                                       02071000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02072000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02073000
.ZE29A        ANOP  ,                                                   02074000
.*-------------------------------------------------------------------   02075000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02076000
              AIF   (K'&ASID(1) LE 0).ZE29B     NO PRM                  02077000
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           02078000
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           02079000
              AIF   (N'&ASID GT 1).ZE29B                                02080000
.*            ANOP              MULTIPLE PARMS                          02081000
&XASID        SETC  '&ASID'     SET XVARIABLE                           02082000
.ZE29B        ANOP  ,                                                   02083000
.*-------------------------------------------------------------------   02084000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02085000
              AIF   (K'&ZXASID LE 0).ZE29R      NOT I/O                 02086000
              AIF   ('&XASID'(1,1) NE '(').ZE29R                        02087000
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              02088000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                        02089000
              AIF   (K'&ZCGPR GT 2).ZE29Q                               02090000
              AIF   ('&ZCGPR' EQ '0').ZE29Q                             02091000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       02092000
              AIF   (T'&ZCGPR NE 'N').ZE29Q     INVALID REG NAME        02093000
.ZE29P        ANOP  ,                                                   02094000
              AIF   (T'&ZCGPR NE 'N').ZE29R     NON NUMERIC             02095000
              AIF   ('&ZCGPR' LT '2').ZE29Q                             02096000
              AIF   ('&ZCGPR' LE '12').ZE29R                            02097000
.ZE29Q        ANOP  ,                                                   02098000
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           02099000
&ZMS          SETC  '&ZMS.&ASID"'                                       02100000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           02101000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    02102000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02103000
.ZE29R        ANOP  ,                                                   02104000
.*------------------------------------------------------------------    02105000
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           02106000
.ZE31         AIF   (K'&XENV GT 0).ZE31A        VALID                   02107000
              AIF   (K'&ENV(1) LE 0).ZE31B                              02108000
&ZMS          SETC  '"ENV='     *KUKWA* MNOTE                           02109000
&ZMS          SETC  '&ZMS.&ENV"'                                        02110000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           02111000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 02112000
&ZMS          SETC  '&ZMS "MVS"'                VALID KEYWORD           02113000
&ZMS          SETC  '&ZMS OR "IPCS".'           VALID KEYWORD           02113600
              MNOTE 8,' &ZMS '                                          02114200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02115000
              AGO   .ZE31B                                              02116000
.*                                                                      02117000
.ZE31A        ANOP  ,                                                   02118000
&ZXENV        SETC  'INPUT'     SET IN/OUTPUT                           02119000
.ZE31B        ANOP  ,                                                   02120000
.*----------------------------------------------------------------***   02121000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          02122000
              AIF   (N'&MIPR LE 1).ZE33A        CK NUM                  02123000
&ZMS          SETC  '"MIPR='    *KPOSA* MNOTE                           02124000
&ZMS          SETC  '&ZMS.&MIPR"'                                       02125000
&ZMS          SETC  '&ZMS "MIPR"'                                       02126000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02127000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02128000
.ZE33A        ANOP  ,                                                   02129000
.*-------------------------------------------------------------------   02130000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     02131000
              AIF   (K'&MIPR(1) LE 0).ZE33B     NO PRM                  02132000
&ZXMIPR       SETC  'INPUT'     SET IN/OUTPUT                           02133000
&XMIPR        SETC  '&MIPR(1)'  SET XVARIABLE                           02134000
              AIF   (N'&MIPR GT 1).ZE33B                                02135000
.*            ANOP              MULTIPLE PARMS                          02136000
&XMIPR        SETC  '&MIPR'     SET XVARIABLE                           02137000
.ZE33B        ANOP  ,                                                   02138000
.*-------------------------------------------------------------------   02139000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    02140000
              AIF   (K'&ZXMIPR LE 0).ZE33R      NOT I/O                 02141000
              AIF   ('&XMIPR'(1,1) NE '(').ZE33R                        02142000
&ZCGPR        SETC  '&XMIPR'(2,K'&XMIPR-2)                              02143000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE33P                        02144000
              AIF   (K'&ZCGPR GT 2).ZE33Q                               02145000
              AIF   ('&ZCGPR' EQ '0').ZE33Q                             02146000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       02147000
              AIF   (T'&ZCGPR NE 'N').ZE33Q     INVALID REG NAME        02148000
.ZE33P        ANOP  ,                                                   02149000
              AIF   (T'&ZCGPR NE 'N').ZE33R     NON NUMERIC             02150000
              AIF   ('&ZCGPR' LT '2').ZE33Q                             02151000
              AIF   ('&ZCGPR' LE '12').ZE33R                            02152000
.ZE33Q        ANOP  ,                                                   02153000
&ZMS          SETC  '"MIPR='    *KGPRA* MNOTE                           02154000
&ZMS          SETC  '&ZMS.&MIPR"'                                       02155000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           02156000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    02157000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02158000
.ZE33R        ANOP  ,                                                   02159000
.*----------------------------------------------------------------***   02160000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          02161000
              AIF   (N'&USERDATA LE 1).ZE36A    CK NUM                  02162000
&ZMS          SETC  '"USERDATA='                *KPOSA* MNOTE           02163000
&ZMS          SETC  '&ZMS.&USERDATA"'                                   02164000
&ZMS          SETC  '&ZMS "USERDATA"'                                   02165000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02166000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02167000
.ZE36A        ANOP  ,                                                   02168000
.*-------------------------------------------------------------------   02169000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     02170000
              AIF   (K'&USERDATA(1) LE 0).ZE36B NO PRM                  02171000
&ZXUSERDATA   SETC  'INPUT'     SET IN/OUTPUT                           02172000
&XUSERDATA    SETC  '&USERDATA(1)'              SET XVARIABLE           02173000
              AIF   (N'&USERDATA GT 1).ZE36B                            02174000
.*            ANOP              MULTIPLE PARMS                          02175000
&XUSERDATA    SETC  '&USERDATA'                 SET XVARIABLE           02176000
.ZE36B        ANOP  ,                                                   02177000
.*-------------------------------------------------------------------   02178000
.***AE.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     02179000
              AIF   (K'&ZXUSERDATA LE 0).ZE36P  NOT I/O                 02180000
              AIF   ('&XUSERDATA'(1,1) NE '(').ZE36P                    02181000
&ZXUSERDATA   SETC  ''          RESET IN/OUTPUT                         02182000
&ZMS          SETC  '"USERDATA='                *KGPRA* MNOTE           02183000
&ZMS          SETC  '&ZMS.&USERDATA"'                                   02184000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           02185000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   02186000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02187000
.ZE36P        ANOP  ,                                                   02188000
.*----------------------------------------------------------------***   02189000
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         02190000
              AIF   (N'&RETCODE LE 1).ZE39A     CK NUM                  02191000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           02192000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    02193000
&ZMS          SETC  '&ZMS "RETCODE"'                                    02194000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02195000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02196000
.ZE39A        ANOP  ,                                                   02197000
.*-------------------------------------------------------------------   02198000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    02199000
              AIF   (K'&RETCODE(1) LE 0).ZE39B  NO PRM                  02200000
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           02201000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           02202000
              AIF   (N'&RETCODE GT 1).ZE39B                             02203000
.*            ANOP              MULTIPLE PARMS                          02204000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           02205000
.ZE39B        ANOP  ,                                                   02206000
.*-------------------------------------------------------------------   02207000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   02208000
              AIF   (K'&ZXRETCODE LE 0).ZE39R   NOT I/O                 02209000
              AIF   ('&XRETCODE'(1,1) NE '(').ZE39R                     02210000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        02211000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE39P                        02212000
              AIF   (K'&ZCGPR GT 2).ZE39Q                               02213000
              AIF   ('&ZCGPR' EQ '0').ZE39Q                             02214000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       02215000
              AIF   (T'&ZCGPR NE 'N').ZE39Q     INVALID REG NAME        02216000
.ZE39P        ANOP  ,                                                   02217000
              AIF   (T'&ZCGPR NE 'N').ZE39R     NON NUMERIC             02218000
              AIF   ('&ZCGPR' LT '2').ZE39Q                             02219000
              AIF   ('&ZCGPR' LE '12').ZE39R                            02220000
.ZE39Q        ANOP  ,                                                   02221000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           02222000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    02223000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           02224000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    02225000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02226000
.ZE39R        ANOP  ,                                                   02227000
.*----------------------------------------------------------------***   02228000
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         02229000
              AIF   (N'&RSNCODE LE 1).ZE42A     CK NUM                  02230000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           02231000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    02232000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    02233000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02234000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02235000
.ZE42A        ANOP  ,                                                   02236000
.*-------------------------------------------------------------------   02237000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    02238000
              AIF   (K'&RSNCODE(1) LE 0).ZE42B  NO PRM                  02239000
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           02240000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           02241000
              AIF   (N'&RSNCODE GT 1).ZE42B                             02242000
.*            ANOP              MULTIPLE PARMS                          02243000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           02244000
.ZE42B        ANOP  ,                                                   02245000
.*-------------------------------------------------------------------   02246000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   02247000
              AIF   (K'&ZXRSNCODE LE 0).ZE42R   NOT I/O                 02248000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE42R                     02249000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        02250000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE42P                        02251000
              AIF   (K'&ZCGPR GT 2).ZE42Q                               02252000
              AIF   ('&ZCGPR' EQ '0').ZE42Q                             02253000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       02254000
              AIF   (T'&ZCGPR NE 'N').ZE42Q     INVALID REG NAME        02255000
.ZE42P        ANOP  ,                                                   02256000
              AIF   (T'&ZCGPR NE 'N').ZE42R     NON NUMERIC             02257000
              AIF   ('&ZCGPR' LT '2').ZE42Q                             02258000
              AIF   ('&ZCGPR' LE '12').ZE42R                            02259000
.ZE42Q        ANOP  ,                                                   02260000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           02261000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    02262000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           02263000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    02264000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02265000
.ZE42R        ANOP  ,                                                   02266000
.*----------------------------------------------------------------***   02267000
.***AE.KXVAR03 VALUE, OPT INPUT, KEYS -XVAR KEY                         02268000
              AIF   (N'&COM LE 1).ZE45A         CK NUM                  02269000
&ZMS          SETC  '"COM='     *KPOSA* MNOTE                           02270000
&ZMS          SETC  '&ZMS.&COM"'                                        02271000
&ZMS          SETC  '&ZMS "COM"'                                        02272000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 02273000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02274000
.ZE45A        ANOP  ,                                                   02275000
.*-------------------------------------------------------------------   02276000
.***AE.KXVAR04 VALUE, OPT INPUT, KEYS -XVAR ARGUMENT                    02277000
              AIF   (K'&COM(1) LE 0).ZE45B      NO PRM                  02278000
&ZXCOM        SETC  'INPUT'     SET IN/OUTPUT                           02279000
&XCOM         SETC  '&COM(1)'   SET XVARIABLE                           02280000
              AIF   (N'&COM GT 1).ZE45B                                 02281000
.*            ANOP              MULTIPLE PARMS                          02282000
&XCOM         SETC  '&COM'      SET XVARIABLE                           02283000
.ZE45B        ANOP  ,                                                   02284000
.*-------------------------------------------------------------------   02285000
.***AE.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    02286000
              AIF   (K'&ZXCOM LE 0).ZE45P       NOT I/O                 02287000
              AIF   ('&XCOM'(1,1) NE '(').ZE45P                         02288000
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         02289000
&ZMS          SETC  '"COM='     *KGPRA* MNOTE                           02290000
&ZMS          SETC  '&ZMS.&COM"'                                        02291000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           02292000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   02293000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02294000
.ZE45P        ANOP  ,                                                   02295000
.*-------------------------------------------------------------------   02296000
.***AE.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   02297000
              AIF   (K'&ZXCOM LE 0).ZE45S       NOT I/O                 02298000
              AIF   (K'&XCOM LE 256).ZE45S      LNG OK                  02299000
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         02300000
&ZMS          SETC  '"COM='     *KLNGA* MNOTE                           02301000
&ZMS          SETC  '&ZMS.&COM"'                                        02302000
&ZMS          SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'               02303000
              MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'                 02304000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02305000
.ZE45S        ANOP  ,                                                   02306000
.******************************************************************     02307000
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        02308000
.******************************************************************     02309000
              ACTR  10000                                               02310000
.*----------------------------------------------------------------***   02311000
.***AF.P02 EXTRA POSITIONALS                                            02312000
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               02313000
&ZCVAL        SETC  ''          ERROR FIELD                             02314000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       02315000
.ZELIST2      ANOP  ,                                                   02316000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         02317000
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                02318000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   02319000
              AGO   .ZELIST2                                            02320000
.*                                                                      02321000
.ZELIST3      ANOP  ,                                                   02322000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             02323000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           02324000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     02325000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              02326000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      02327000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              02328000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             02329000
.ZELISTX      ANOP  ,                                                   02330000
&ZASYSLNDX    SETA  0                                                   02331000
.*-------------------------------------------------------------------   02332000
.***AE.MF02 MF=(SLME)                                                   02333000
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             02334000
.*******************************************************************    02335000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       02336000
.*******************************************************************    02337000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          02338000
.*******************************************************************    02339000
.***AE.01  START OF CSVINFO MACRO CODE                                  02340000
.*******************************************************************    02341000
              LCLC  &M0M0001                 NAME                       02342000
&M0M0001      SETC  '&XLABEL'                SET NAME                   02343000
              AIF   (K'&XLABEL NE 0).XLAB2                              02344000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               02345000
.*                                                                      02346000
.XLAB2        ANOP  ,                                                   02347000
&M0M0001 DS    0H                             CSVINFO-0                 02348000
.*******************************************************************    02349000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              02350000
.*******************************************************************    02351000
              PUSH  PRINT                                               02352000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          02353000
              PRINT OFF         ++ PR01                                 02354000
              AGO   .ZPRNTXX                                            02355000
.ZPRINTX      PRINT ON                                                  02356000
.ZPRNTXX      ANOP  ,                                                   02357000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  02358000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  02359000
.********************************************************************   02360000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     02361000
.********************************************************************   02362000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       02363000
                      LCLA  &ZOPN1         INVOCATION INDEX             02364000
                      LCLC  &ZOPL(4095)    LABEL                        02365000
                      LCLC  &ZOPO(4095)    OPERATION                    02366000
                      LCLC  &ZOPV(4095)    VALUE                        02367000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  02368000
.*                                                                      02369000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     02370000
.******************************************************************     02371000
.***AL.L10 CSVINFO FMT=LIST MF=S|L PARAMETERS                           02372000
.******************************************************************     02373000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     02374000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     02375000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     02376000
&XMFATTR              SETC  '0D'                                        02377000
.*                                                                      02378000
&ZOPN                 SETA  &ZOPN+1                                     02379000
&ZOPL(&ZOPN)          SETC  ' '                                         02380000
&ZOPO(&ZOPN)          SETC  'B'                                         02381000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                02382000
&ZOPD(&ZOPN)          SETC  '++ CSVINFO ARG PARMS'                      02383000
.*                                                                      02384000
&ZOPN                 SETA  &ZOPN+1                                     02385000
&ZOPL(&ZOPN)          SETC  ' '                                         02386000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     02387000
&ZOPV(&ZOPN)          SETC  '1'                                         02388000
&ZOPD(&ZOPN)          SETC  ' '                                         02389000
.*                                                                      02390000
.ZLMFSL2              ANOP  ,                                           02391000
.*-------------------------------------------------------------------   02392000
.***AM.L01  CSVINFO FMT=LIST PARAMETERS                                 02393000
&ZOPN                 SETA &ZOPN+1                                      02394000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   02395000
&ZOPO(&ZOPN)          SETC 'DS'                                         02396000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   02397000
&ZOPD(&ZOPN)          SETC '++ CSVINFO PARM LIST'                       02398000
.*-------------------------------------------------------------------   02399000
.***AM.L02 XVERSION XL1                                                 02400000
&ZOPN                 SETA &ZOPN+1                                      02401000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         02402000
&ZOPO(&ZOPN)          SETC 'DS'                                         02403000
&ZOPV(&ZOPN)          SETC 'XL1'                                        02404000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          02405000
.*-------------------------------------------------------------------   02406000
.***AM.L03 XFLAGS1 BL.8                                                 02407000
&ZOPN                 SETA &ZOPN+1                                      02408000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS1'                          02409000
&ZOPO(&ZOPN)          SETC 'DS'                                         02410000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       02411000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             02412000
.*                                                                      02413000
&ZOPN                 SETA  &ZOPN+1                                     02414000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_JPA'                       02415000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02416000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             02417000
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 02418000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).JPA'                          02419000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02420000
.*                                                                      02421000
&ZOPN                 SETA  &ZOPN+1                                     02422000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_LPA'                       02423000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02424000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             02425000
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 02426000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LPA'                          02427000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02428000
.*                                                                      02429000
&ZOPN                 SETA  &ZOPN+1                                     02430000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_TASKLOAD'                  02431000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02432000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             02433000
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 02434000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TASKLOAD'                     02435000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02436000
.*                                                                      02437000
&ZOPN                 SETA  &ZOPN+1                                     02438000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_TASKALL'                   02439000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02440000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             02441000
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 02442000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TASKALL'                      02443000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02444000
.*                                                                      02445000
&ZOPN                 SETA  &ZOPN+1                                     02446000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_RB'                        02447000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02448000
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             02449000
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 02450000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RB'                           02451000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02452000
.*                                                                      02453000
&ZOPN                 SETA  &ZOPN+1                                     02454000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XENV_MVS'                        02455000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02456000
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             02457000
&ZOPD(&ZOPN)          SETC  '++ XENV.'                                  02458000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MVS'                          02459000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02460000
.*                                                                      02461000
&ZOPN                 SETA  &ZOPN+1                                     02462000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XENV_IPCS'                       02463000
&ZOPO(&ZOPN)          SETC  'EQU'                                       02464000
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             02465000
&ZOPD(&ZOPN)          SETC  '++ XENV.'                                  02466000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IPCS'                         02467000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      02468000
.*-------------------------------------------------------------------   02469000
.***AM.L09  XASID BL.16                                                 02470000
&ZOPN                 SETA &ZOPN+1                                      02471000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XASID'                            02472000
&ZOPO(&ZOPN)          SETC 'DS'                                         02473000
&ZOPV(&ZOPN)          SETC 'BL.16'                                      02474000
&ZOPD(&ZOPN)          SETC '++ &ZXASID  XASID'                          02475000
.*-------------------------------------------------------------------   02476000
.***AM.L09  XABDPLPTR A                                                 02477000
&ZOPN                 SETA &ZOPN+1                                      02478000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XABDPLPTR'                        02479000
&ZOPO(&ZOPN)          SETC 'DS'                                         02480000
&ZOPV(&ZOPN)          SETC 'A'                                          02481000
&ZOPD(&ZOPN)          SETC '++ &ZXABDPLPTR  XABDPLPTR'                  02482000
.*-------------------------------------------------------------------   02483000
.***AM.L09  XRSVCPL2 CL04                                               02484000
&ZOPN                 SETA &ZOPN+1                                      02485000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVCPL2'                         02486000
&ZOPO(&ZOPN)          SETC 'DS'                                         02487000
&ZOPV(&ZOPN)          SETC 'CL04'                                       02488000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSVCPL2'                      02489000
.*-------------------------------------------------------------------   02490000
.***AM.L09  XRSVCPL3 CL04                                               02491000
&ZOPN                 SETA &ZOPN+1                                      02492000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVCPL3'                         02493000
&ZOPO(&ZOPN)          SETC 'DS'                                         02494000
&ZOPV(&ZOPN)          SETC 'CL04'                                       02495000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSVCPL3'                      02496000
.*-------------------------------------------------------------------   02497000
.***AM.L09  XMIPR A                                                     02498000
&ZOPN                 SETA &ZOPN+1                                      02499000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMIPR'                            02500000
&ZOPO(&ZOPN)          SETC 'DS'                                         02501000
&ZOPV(&ZOPN)          SETC 'A'                                          02502000
&ZOPD(&ZOPN)          SETC '++ &ZXMIPR  XMIPR'                          02503000
.*-------------------------------------------------------------------   02504000
.***AM.L09  XUSERDATA CL16                                              02505000
&ZOPN                 SETA &ZOPN+1                                      02506000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERDATA'                        02507000
&ZOPO(&ZOPN)          SETC 'DS'                                         02508000
&ZOPV(&ZOPN)          SETC 'CL16'                                       02509000
&ZOPD(&ZOPN)          SETC '++ &ZXUSERDATA  XUSERDATA'                  02510000
.*-------------------------------------------------------------------   02511000
.***AM.L09  XTCBADDR A                                                  02512000
&ZOPN                 SETA &ZOPN+1                                      02513000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTCBADDR'                         02514000
&ZOPO(&ZOPN)          SETC 'DS'                                         02515000
&ZOPV(&ZOPN)          SETC 'A'                                          02516000
&ZOPD(&ZOPN)          SETC '++ &ZXTCBADDR  XTCBADDR'                    02517000
.*-------------------------------------------------------------------   02518000
.***AM.L09  XRBADDR A                                                   02519000
&ZOPN                 SETA &ZOPN+1                                      02520000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRBADDR'                          02521000
&ZOPO(&ZOPN)          SETC 'DS'                                         02522000
&ZOPV(&ZOPN)          SETC 'A'                                          02523000
&ZOPD(&ZOPN)          SETC '++ &ZXRBADDR  XRBADDR'                      02524000
.*-------------------------------------------------------------------   02525000
.***AM.L10 END OF CSVINFO LIST PARAMETERS                               02526000
&ZOPN                 SETA &ZOPN+1                                      02527000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 02528000
&ZOPO(&ZOPN)          SETC 'EQU'                                        02529000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 02530000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         02531000
.*                                                                      02532000
&ZOPN                 SETA &ZOPN+1                                      02533000
&ZOPL(&ZOPN)          SETC ' '                                          02534000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      02535000
&ZOPV(&ZOPN)          SETC '1'                                          02536000
&ZOPD(&ZOPN)          SETC ' '                                          02537000
.*-------------------------------------------------------------------   02538000
.***AL.L12 CSVINFO FMT=LIST MF=S|L PARAMETERS                           02539000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         02540000
.*                                                                      02541000
&ZOPN                 SETA  &ZOPN+1                                     02542000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                02543000
&ZOPO(&ZOPN)          SETC  'DC'                                        02544000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   02545000
&ZOPD(&ZOPN)          SETC  '++ CSVINFO ARG PARMS'                      02546000
.*                                                                      02547000
.ZLMFSLX              ANOP  ,                                           02548000
.*-------------------------------------------------------------------   02549000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          02550000
&ZPLLEN               SETA 44                                           02551000
.*                                                                      02552000
.******************************************************************     02553000
.***AI.L01 CSVINFO FMT=LIST FILL IN PARAMETER AREA                      02554000
.******************************************************************     02555000
                      ACTR  10000                                       02556000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               02557000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    02558000
&ZCVAL                SETC  'LAE'          XAX MODE                     02559000
.ZIMFXA               ANOP ,                                            02560000
.*                                                                      02561000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    02562000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         02563000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 02564000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                02565000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 02566000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                02567000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   02568000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    02569000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   02570000
&ZOPN                 SETA  &ZOPN+1                                     02571000
&ZOPL(&ZOPN)          SETC  ' '                                         02572000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    02573000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              02574000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       02575000
                      AGO   .ZIMFNX                                     02576000
.*                                                                      02577000
.ZIMFN2               ANOP ,                                            02578000
&ZOPN                 SETA  &ZOPN+1                                     02579000
&ZOPL(&ZOPN)          SETC  ' '                                         02580000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    02581000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                02582000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       02583000
.ZIMFNX               ANOP ,                                            02584000
.********************************************************************   02585000
.***AI.L02 CSVINFO FMT=LIST INITIALIZE PARAMETER AREA                   02586000
.********************************************************************   02587000
.***AI.L03 MF=(SLME)                                                    02588000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      02589000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            02590000
.*                                                                      02591000
&ZOPN                 SETA  &ZOPN+1                                     02592000
&ZOPL(&ZOPN)          SETC  ' '                                         02593000
&ZOPO(&ZOPN)          SETC  'XC'                                        02594000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         02595000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             02596000
.ZIMFLX               ANOP  ,                                           02597000
.*-------------------------------------------------------------------   02598000
.***AI.L05 XFLAGS1 BL1                                                  02599000
&ZW                   SETC  ''                                          02600000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            02601000
&ZMS                  SETC  ''                                          02602000
&ZC                   SETC  ''                                          02603000
.*-------------------------------------------------------------------   02604000
.***AI.L08 XFLAGS1 "JPA"                                                02605000
.***      BL1'1XXXXXXX'                                                 02606000
         AIF   ('&XFUNC' NE 'JPA').ZI3A                                 02607000
&ZW                   SETC  '&ZW.1'                                     02608000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              02609000
&ZMS                  SETC  '&ZMS.1'                                    02610000
                      AGO   .ZI3C                                       02611000
.*                                                                      02612000
.ZI3A                 ANOP  ,                                           02613000
&ZW                   SETC  '&ZW.0'                                     02614000
         AIF   ('&ZXFUNC' EQ '').ZI3B                                   02615000
&ZMS                  SETC  '&ZMS.0'                                    02616000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             02617000
                      AGO   .ZI3C                                       02618000
.*                                                                      02619000
.ZI3B                 ANOP  ,                                           02620000
&ZMS                  SETC  '&ZMS.1'                                    02621000
.ZI3C                 ANOP  ,                                           02622000
.*-------------------------------------------------------------------   02623000
.***AI.L08 XFLAGS1 "LPA"                                                02624000
.***      BL1'X1XXXXXX'                                                 02625000
         AIF   ('&XFUNC' NE 'LPA').ZI4A                                 02626000
&ZW                   SETC  '&ZW.1'                                     02627000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              02628000
&ZMS                  SETC  '&ZMS.1'                                    02629000
                      AGO   .ZI4C                                       02630000
.*                                                                      02631000
.ZI4A                 ANOP  ,                                           02632000
&ZW                   SETC  '&ZW.0'                                     02633000
         AIF   ('&ZXFUNC' EQ '').ZI4B                                   02634000
&ZMS                  SETC  '&ZMS.0'                                    02635000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             02636000
                      AGO   .ZI4C                                       02637000
.*                                                                      02638000
.ZI4B                 ANOP  ,                                           02639000
&ZMS                  SETC  '&ZMS.1'                                    02640000
.ZI4C                 ANOP  ,                                           02641000
.*-------------------------------------------------------------------   02642000
.***AI.L08 XFLAGS1 "TASKLOAD"                                           02643000
.***      BL1'XX1XXXXX'                                                 02644000
         AIF   ('&XFUNC' NE 'TASKLOAD').ZI5A                            02645000
&ZW                   SETC  '&ZW.1'                                     02646000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              02647000
&ZMS                  SETC  '&ZMS.1'                                    02648000
                      AGO   .ZI5C                                       02649000
.*                                                                      02650000
.ZI5A                 ANOP  ,                                           02651000
&ZW                   SETC  '&ZW.0'                                     02652000
         AIF   ('&ZXFUNC' EQ '').ZI5B                                   02653000
&ZMS                  SETC  '&ZMS.0'                                    02654000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             02655000
                      AGO   .ZI5C                                       02656000
.*                                                                      02657000
.ZI5B                 ANOP  ,                                           02658000
&ZMS                  SETC  '&ZMS.1'                                    02659000
.ZI5C                 ANOP  ,                                           02660000
.*-------------------------------------------------------------------   02661000
.***AI.L08 XFLAGS1 "TASKALL"                                            02662000
.***      BL1'XXX1XXXX'                                                 02663000
         AIF   ('&XFUNC' NE 'TASKALL').ZI6A                             02664000
&ZW                   SETC  '&ZW.1'                                     02665000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              02666000
&ZMS                  SETC  '&ZMS.1'                                    02667000
                      AGO   .ZI6C                                       02668000
.*                                                                      02669000
.ZI6A                 ANOP  ,                                           02670000
&ZW                   SETC  '&ZW.0'                                     02671000
         AIF   ('&ZXFUNC' EQ '').ZI6B                                   02672000
&ZMS                  SETC  '&ZMS.0'                                    02673000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             02674000
                      AGO   .ZI6C                                       02675000
.*                                                                      02676000
.ZI6B                 ANOP  ,                                           02677000
&ZMS                  SETC  '&ZMS.1'                                    02678000
.ZI6C                 ANOP  ,                                           02679000
.*-------------------------------------------------------------------   02680000
.***AI.L08 XFLAGS1 "RB"                                                 02681000
.***      BL1'XXXX1XXX'                                                 02682000
         AIF   ('&XFUNC' NE 'RB').ZI7A                                  02683000
&ZW                   SETC  '&ZW.1'                                     02684000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              02685000
&ZMS                  SETC  '&ZMS.1'                                    02686000
                      AGO   .ZI7C                                       02687000
.*                                                                      02688000
.ZI7A                 ANOP  ,                                           02689000
&ZW                   SETC  '&ZW.0'                                     02690000
         AIF   ('&ZXFUNC' EQ '').ZI7B                                   02691000
&ZMS                  SETC  '&ZMS.0'                                    02692000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             02693000
                      AGO   .ZI7C                                       02694000
.*                                                                      02695000
.ZI7B                 ANOP  ,                                           02696000
&ZMS                  SETC  '&ZMS.1'                                    02697000
.ZI7C                 ANOP  ,                                           02698000
.*-------------------------------------------------------------------   02699000
.***AI.L08 XFLAGS1 "MVS"                                                02700000
.***      BL1'XXXXX1XX'                                                 02701000
         AIF   ('&XENV' NE 'MVS').ZI8A                                  02702000
&ZW                   SETC  '&ZW.1'                                     02703000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              02704000
&ZMS                  SETC  '&ZMS.1'                                    02705000
                      AGO   .ZI8C                                       02706000
.*                                                                      02707000
.ZI8A                 ANOP  ,                                           02708000
&ZW                   SETC  '&ZW.0'                                     02709000
         AIF   ('&ZXENV' EQ '').ZI8B                                    02710000
&ZMS                  SETC  '&ZMS.0'                                    02711000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             02712000
                      AGO   .ZI8C                                       02713000
.*                                                                      02714000
.ZI8B                 ANOP  ,                                           02715000
&ZMS                  SETC  '&ZMS.1'                                    02716000
.ZI8C                 ANOP  ,                                           02717000
.*-------------------------------------------------------------------   02718000
.***AI.L08 XFLAGS1 "IPCS"                                               02719000
.***      BL1'XXXXXX1X'                                                 02720000
         AIF   ('&XENV' NE 'IPCS').ZI9A                                 02721000
&ZW                   SETC  '&ZW.10'                                    02722000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              02723000
&ZMS                  SETC  '&ZMS.11'                                   02724000
                      AGO   .ZI9C                                       02725000
.*                                                                      02726000
.ZI9A                 ANOP  ,                                           02727000
&ZW                   SETC  '&ZW.00'                                    02728000
         AIF   ('&ZXENV' EQ '').ZI9B                                    02729000
&ZMS                  SETC  '&ZMS.01'                                   02730000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             02731000
                      AGO   .ZI9C                                       02732000
.*                                                                      02733000
.ZI9B                 ANOP  ,                                           02734000
&ZMS                  SETC  '&ZMS.11'                                   02735000
.ZI9C                 ANOP  ,                                           02736000
.*-------------------------------------------------------------------   02737000
.***AI.L11 XFLAGS1 BL1                                                  02738000
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI9D               02739000
                      AIF   ('&ZC' NE 'YES').ZI9D                       02740000
&ZOPN                 SETA  &ZOPN+1                                     02741000
&ZOPL(&ZOPN)          SETC  ' '                                         02742000
&ZOPO(&ZOPN)          SETC  'NI'                                        02743000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            02744000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              02745000
.ZI9D                 ANOP  ,                                           02746000
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     02747000
&ZOPN                 SETA  &ZOPN+1                                     02748000
&ZOPL(&ZOPN)          SETC  ' '                                         02749000
&ZOPO(&ZOPN)          SETC  'OI'                                        02750000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             02751000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              02752000
.ZI9E                 ANOP  ,                                           02753000
.*-------------------------------------------------------------------   02754000
.***AI.L25  XASID XL2                                                   02755000
                      AIF   ('&ZXASID' EQ '').ZI10E  NOT USED           02756000
                      AIF   ('&ZXASID' EQ 'OUTPUT').ZI10E               02757000
&ZCGPR                SETC  '&XASID'                                    02758000
.*                                                                      02759000
                      AIF   ('&XASID'(1,1) NE '(').ZI10B                02760000
&ZCGPR   SETC  '0('.'&XASID'(2,K'&XASID-2).')'                          02761000
                      AGO   .ZI10D                                      02762000
.ZI10B                ANOP  ,                                           02763000
.*                                                                      02764000
&ZC                   SETC  '&XASID'(1,1)                               02765000
                      AIF   (T'&ZC NE 'N').ZI10D                        02766000
&ZC                   SETC  '&XASID'                                    02767000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               02768000
&ZCGPR                SETC  '=BL2''&XASID'''                            02769000
.*                                                                      02770000
.ZI10D                ANOP  ,                                           02771000
.*                                                                      02772000
&ZOPN                 SETA  &ZOPN+1                                     02773000
&ZOPL(&ZOPN)          SETC  ' '                                         02774000
&ZOPO(&ZOPN)          SETC  'MVC'                                       02775000
&ZOPV(&ZOPN)          SETC  '2(2,1),&ZCGPR'                             02776000
&ZOPD(&ZOPN)          SETC  '++ &ZXASID XASID XL2'                      02777000
.*                                                                      02778000
.ZI10E                ANOP  ,                                           02779000
.*-------------------------------------------------------------------   02780000
.***AI.L25  XABDPLPTR AL4                                               02780300
                      AIF   ('&ZXABDPLPTR' EQ '').ZI11E  NOT USED       02780600
                      AIF   ('&ZXABDPLPTR' EQ 'OUTPUT').ZI11E           02780900
&ZCGPR                SETC  '&XABDPLPTR'                                02781200
.*                                                                      02781500
                      AIF   ('&XABDPLPTR'(1,1) NE '(').ZI11B            02781800
&ZCGPR   SETC  '0('.'&XABDPLPTR'(2,K'&XABDPLPTR-2).')'                  02782100
                      AGO   .ZI11D                                      02782400
.ZI11B                ANOP  ,                                           02782700
.*                                                                      02783000
&ZC                   SETC  '&XABDPLPTR'(1,1)                           02783300
                      AIF   (T'&ZC NE 'N').ZI11D                        02783600
&ZC                   SETC  '&XABDPLPTR'                                02783900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               02784200
&ZCGPR                SETC  '=AL4(&XABDPLPTR)'                          02784500
.*                                                                      02784800
.ZI11D                ANOP  ,                                           02785100
.*                                                                      02786000
&ZOPN                 SETA  &ZOPN+1                                     02787000
&ZOPL(&ZOPN)          SETC  ' '                                         02788000
&ZOPO(&ZOPN)          SETC  'MVC'                                       02789000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             02790000
&ZOPD(&ZOPN)          SETC  '++ &ZXABDPLPTR XABDPLPTR AL4'              02791000
.*                                                                      02792000
.ZI11E                ANOP  ,                                           02799500
.*-------------------------------------------------------------------   02807000
.***AI.L19  XMIPR A                                                     02808000
                      AIF   ('&ZXMIPR' EQ '').ZI14H  NOT USED           02809000
&ZCLNG                SETC  '&XMIPR'                                    02810000
&ZCGPR                SETC  '14'                                        02811000
         AIF   ('&XMIPR'(1,1) EQ '(').ZI14F  IN GPR                     02812000
.*                                                                      02813000
&ZOPN                 SETA  &ZOPN+1                                     02814000
&ZOPL(&ZOPN)          SETC  ' '                                         02815000
&ZOPO(&ZOPN)          SETC  'LA'                                        02816000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             02817000
&ZOPD(&ZOPN)          SETC  '++ &ZXMIPR XMIPR A'                        02818000
.*                                                                      02819000
                      AGO   .ZI14G                                      02820000
.*                                                                      02821000
.ZI14F                ANOP  ,                                           02822000
&ZCGPR   SETC  '&XMIPR'(2,K'&XMIPR-2)                                   02823000
.*                                                                      02824000
.ZI14G                ANOP  ,                                           02825000
.*                                                                      02826000
&ZOPN                 SETA  &ZOPN+1                                     02827000
&ZOPL(&ZOPN)          SETC  ' '                                         02828000
&ZOPO(&ZOPN)          SETC  'ST'                                        02829000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             02830000
&ZOPD(&ZOPN)          SETC  '++ &ZXMIPR XMIPR A'                        02831000
.*                                                                      02832000
.ZI14H                ANOP  ,                                           02833000
.*-------------------------------------------------------------------   02834000
.***AI.L18  XUSERDATA CL16                                              02835000
                      AIF   ('&XUSERDATA' NE 'NULL').ZI15               02836000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI15  CK *        02837000
&ZXUSERDATA           SETC  ''             RESET INPUT/OUTPUT           02838000
.ZI15                 ANOP  ,                                           02839000
.*-------------------------------------------------------------------   02840000
.***AI.L25  XUSERDATA CL16                                              02841000
                      AIF   ('&ZXUSERDATA' EQ '').ZI15E  NOT USED       02842000
                      AIF   ('&ZXUSERDATA' EQ 'OUTPUT').ZI15E           02843000
&ZCGPR                SETC  '&XUSERDATA'                                02844000
                      AIF   ('&XUSERDATA' NE 'NULL').ZI15A              02845000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI15E             02846000
.*                                                                      02847000
&ZCGPR                SETC  '=XL16''00'''                               02848000
.ZI15A                ANOP  ,                                           02849000
.*                                                                      02850000
&ZOPN                 SETA  &ZOPN+1                                     02851000
&ZOPL(&ZOPN)          SETC  ' '                                         02852000
&ZOPO(&ZOPN)          SETC  'MVC'                                       02853000
&ZOPV(&ZOPN)          SETC  '20(16,1),&ZCGPR'                           02854000
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERDATA XUSERDATA CL16'             02855000
.*                                                                      02856000
.ZI15E                ANOP  ,                                           02857000
.*-------------------------------------------------------------------   02858000
.***AI.L25  XTCBADDR AL4                                                02859000
                      AIF   ('&ZXTCBADDR' EQ '').ZI16E  NOT USED        02860000
                      AIF   ('&ZXTCBADDR' EQ 'OUTPUT').ZI16E            02861000
&ZCGPR                SETC  '&XTCBADDR'                                 02862000
.*                                                                      02863000
                      AIF   ('&XTCBADDR'(1,1) NE '(').ZI16B             02864000
&ZCGPR   SETC  '0('.'&XTCBADDR'(2,K'&XTCBADDR-2).')'                    02865000
                      AGO   .ZI16D                                      02866000
.ZI16B                ANOP  ,                                           02867000
.*                                                                      02868000
&ZC                   SETC  '&XTCBADDR'(1,1)                            02869000
                      AIF   (T'&ZC NE 'N').ZI16D                        02870000
&ZC                   SETC  '&XTCBADDR'                                 02871000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               02872000
&ZCGPR                SETC  '=AL4(&XTCBADDR)'                           02873000
.*                                                                      02874000
.ZI16D                ANOP  ,                                           02875000
.*                                                                      02876000
&ZOPN                 SETA  &ZOPN+1                                     02877000
&ZOPL(&ZOPN)          SETC  ' '                                         02878000
&ZOPO(&ZOPN)          SETC  'MVC'                                       02879000
&ZOPV(&ZOPN)          SETC  '36(4,1),&ZCGPR'                            02880000
&ZOPD(&ZOPN)          SETC  '++ &ZXTCBADDR XTCBADDR AL4'                02881000
.*                                                                      02882000
.ZI16E                ANOP  ,                                           02883000
.*-------------------------------------------------------------------   02884000
.***AI.L25  XRBADDR AL4                                                 02885000
                      AIF   ('&ZXRBADDR' EQ '').ZI17E  NOT USED         02886000
                      AIF   ('&ZXRBADDR' EQ 'OUTPUT').ZI17E             02887000
&ZCGPR                SETC  '&XRBADDR'                                  02888000
.*                                                                      02889000
                      AIF   ('&XRBADDR'(1,1) NE '(').ZI17B              02890000
&ZCGPR   SETC  '0('.'&XRBADDR'(2,K'&XRBADDR-2).')'                      02891000
                      AGO   .ZI17D                                      02892000
.ZI17B                ANOP  ,                                           02893000
.*                                                                      02894000
&ZC                   SETC  '&XRBADDR'(1,1)                             02895000
                      AIF   (T'&ZC NE 'N').ZI17D                        02896000
&ZC                   SETC  '&XRBADDR'                                  02897000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI17D               02898000
&ZCGPR                SETC  '=AL4(&XRBADDR)'                            02899000
.*                                                                      02900000
.ZI17D                ANOP  ,                                           02901000
.*                                                                      02902000
&ZOPN                 SETA  &ZOPN+1                                     02903000
&ZOPL(&ZOPN)          SETC  ' '                                         02904000
&ZOPO(&ZOPN)          SETC  'MVC'                                       02905000
&ZOPV(&ZOPN)          SETC  '40(4,1),&ZCGPR'                            02906000
&ZOPD(&ZOPN)          SETC  '++ &ZXRBADDR XRBADDR AL4'                  02907000
.*                                                                      02908000
.ZI17E                ANOP  ,                                           02909000
.*-------------------------------------------------------------------   02910000
&ZOPN1                SETA &ZOPN                                        02911000
.*-------------------------------------------------------------------   02912000
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              02913000
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         02914000
.*******************************************************************    02915000
.***  PROCESS CSVINFO OUTPUT PARAMETERS                                 02916000
.*******************************************************************    02917000
                      ACTR  10000                                       02918000
.*******************************************************************    02919000
.***AO.X02  RETURN CODE PROCESSING                                      02920000
.*******************************************************************    02921000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    02922000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            02923000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             02924000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             02925000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               02926000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                02927000
&ZOPN                 SETA  &ZOPN+1                                     02928000
&ZOPL(&ZOPN)          SETC  ' '                                         02929000
&ZOPO(&ZOPN)          SETC  'ST'                                        02930000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              02931000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        02932000
                      AGO   .ZMRETX                                     02933000
.*                                                                      02934000
.ZMRET2               ANOP  ,                                           02935000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                02936000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                02937000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                02938000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  02939000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   02940000
&ZOPN                 SETA  &ZOPN+1                                     02941000
&ZOPL(&ZOPN)          SETC  ' '                                         02942000
&ZOPO(&ZOPN)          SETC  'LR'                                        02943000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 02944000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        02945000
.ZMRETX               ANOP  ,                                           02946000
.*******************************************************************    02947000
.***AO.X03  REASON CODE PROCESSING                                      02948000
.*******************************************************************    02949000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    02950000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            02951000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              02952000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             02953000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              02954000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             02955000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                02956000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 02957000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                02958000
&ZOPN                 SETA  &ZOPN+1                                     02959000
&ZOPL(&ZOPN)          SETC  ' '                                         02960000
&ZOPO(&ZOPN)          SETC  'ST'                                        02961000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               02962000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        02963000
                      AGO   .ZMRSNX                                     02964000
.*                                                                      02965000
.ZMRSN2               ANOP  ,                                           02966000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                02967000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 02968000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                02969000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 02970000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                02971000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   02972000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    02973000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   02974000
&ZOPN                 SETA  &ZOPN+1                                     02975000
&ZOPL(&ZOPN)          SETC  ' '                                         02976000
&ZOPO(&ZOPN)          SETC  'LR'                                        02977000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  02978000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        02979000
.ZMRSNX               ANOP  ,                                           02980000
.*******************************************************************    02981000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   02982000
.*******************************************************************    02983000
.ZMFLX                ANOP  ,              MF=L PROCESSING              02984000
.*******************************************************************    02985000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               02986000
.*******************************************************************    02987000
                      ACTR  10000                                       02988000
.*                                                                      02989000
                      LCLA  &ZLC           COLUMN POSITION              02990000
                      LCLA  &ZOPX          LIST TABLE INDEX             02991000
                      LCLC  &ZLL           LABEL                        02992000
                      LCLC  &ZLOP          OPERATION                    02993000
                      LCLC  &ZLV           VALUE                        02994000
                      LCLC  &ZLD           DESCRIPTION                  02995000
.*                                                                      02996000
&ZOPX                 SETA  1                                           02997000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            02998000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              02999000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              03000000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              03001000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              03002000
                      AIF   (K'&ZLD LE 0).ZL5                           03003000
&ZLC                  SETA  35             COMMENT COLUMN               03004000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    03005000
&ZLC                  SETA  33             COMMMENT COLUMN              03006000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   03007000
&ZLV                  SETC  '&ZLV'.' '                                  03008000
                      AGO   .ZL3                                        03009000
.*                                                                      03010000
.ZL4                  ANOP  ,                                           03011000
&ZLV                  SETC  '&ZLV'.' '                                  03012000
.ZL5                  ANOP  ,                                           03013000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               03014000
.*                                                                      03015000
&ZLL     &ZLOP &ZLV                                                     03016000
.*                                                                      03017000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               03018000
                      AGO   .ZL2           CONTINUE LOOPING             03019000
.*                                                                      03020000
.ZLX                  ANOP  ,                                           03021000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                03022000
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                03023000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  03024000
&CSVABDP SETC '&XMFCTRL'.'_XABDPLPTR' Unique label to ref XABDPLPTR     03024300
&CSVCPL2 SETC '&XMFCTRL'.'_XRSVCPL2' Unique label to ref XRSVCPL2       03024600
.*                                                                @P1A  03024900
&CSVCPL3 SETC '&XMFCTRL'.'_XRSVCPL3' Unique label to ref XRSVCPL3       03025200
.*                                                                @P1A  03025500
&CSVIU   SETC '#Z'.'&SYSNDX'(2,3).'A'  Unique label base                03026000
&CSVLAB1 SETC '&CSVIU'.'_1'        Generate unique label 1              03027000
&CSVISNO SETC '&CSVIU'.'_S'        Unique label for Service number wd   03028000
                      AIF   ('&XENV'(1,3) NE 'MVS').CSVIPCS             03029000
.*------------------------------------ ENV(MVS) linkage -------         03030000
         ST   1,&CSVCPL3           Set up ptr to parameter structure    03030200
.*                                                                @P1A  03030400
         LA   1,&CSVCPL3           Set R1 to addr of parmlist pointer   03030600
.*                                                                @P1A  03030800
         LA   15,20                Assume MODI_NOTAVAIL return code     03031000
         L    14,16(0,0)           Get CVT address                      03032000
         TM   116(14),B'00001000'  Ck CVTOSEXT - Does CVTOSLVL exist?   03032100
.*                                                                @P5A  03032200
         BZ   &CSVLAB1             No - pass back return code 20        03032300
.*                                                                @P5A  03032400
         TM   1265(14),B'10000000' Ck CVTH4430 - On SP4.3.0 or later?   03032500
.*                                                                @P5A  03032600
         BZ   &CSVLAB1             No - pass back return code 20        03032700
.*                                                                @P5A  03032800
         L    14,140(,14)          Get ECVT address (CVTECVT)           03033000
         L    14,228(,14)                                               03034000
         L    14,20(,14)                                                03035000
         LTR  14,14                Is CSVINFO service available?        03036000
         BZ   &CSVLAB1             No - pass back return code 20        03037000
         LR   15,14                                                     03038000
         BALR 14,15                Call CSVINFO service                 03039000
&CSVLAB1 DS  0H                                                         03040000
                      AGO   .CSVEND                                     03041000
.CSVIPCS              ANOP  ,                                           03042000
.*-------------------------------- If in IPCS environment               03043000
.*                                 --- ENV(IPCS ) ---                   03044000
         L    14,4(1)              Get temp ABDPL addressability        03044300
.*                                                                @P1A  03044600
         ST   1,&CSVCPL3           ADPLSERV parm 3 = @ of CSVINFO parms 03048600
.*                                                                @P1C  03049200
         LA   15,&CSVISNO          Get address of fullword service #    03050000
         ST   15,&CSVCPL2          Save it as ADPLSERV parameter 2      03050600
.*                                                                @P1C  03051200
         LA   1,&CSVABDP           Set R1 = addr(ADPLSERV parmlist)     03052000
         B    &CSVLAB1             Branch around constant               03053000
&CSVISNO DC   AL4(ADPLSCSI)        Fullword containing ADPLSCSI         03054000
&CSVLAB1 L    15,ADPLSERV-ABDPL(14) Get address of ADPLSERV routine     03054600
.*                                                                @P1C  03055200
         BALR 14,15                Call ADPLESRV router routine         03056000
.CSVEND               ANOP  ,                                           03057000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  03058000
.ZLINKX               ANOP  ,                                           03059000
.*******************************************************************    03060000
.***AP.X01  FORMAT GENERATED CODE                                       03061000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            03062000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              03063000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              03064000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              03065000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              03066000
                      AIF   (K'&ZLD LE 0).ZL51                          03067000
&ZLC                  SETA  35             COMMENT COLUMN               03068000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   03069000
&ZLC                  SETA  33             COMMENT COLUMN               03070000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  03071000
&ZLV                  SETC  '&ZLV'.' '                                  03072000
                      AGO   .ZL31                                       03073000
.*                                                                      03074000
.ZL41                 ANOP  ,                                           03075000
&ZLV                  SETC  '&ZLV'.' '                                  03076000
.ZL51                 ANOP  ,                                           03077000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               03078000
.*                                                                      03079000
&ZLL     &ZLOP &ZLV                                                     03080000
.*                                                                      03081000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               03082000
                      AGO   .ZL21          CONTINUE LOOPING             03083000
.*                                                                      03084000
.ZLX1                 ANOP  ,                                           03085000
.*******************************************************************    03086000
.***AP.X02  END OF CSVINFO MACRO                                        03087000
&ZCSVINFO             SETC  'YES'          SET CSVINFO USED             03088000
         POP   PRINT                                                    03089000
*                                            CSVINFO-0                  03090000
         SPACE 1                                                        03091000
.ZLX2                 ANOP  ,                                           03092000
         MEND                                                           03093000
**********************************************************************/ 03094000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  03095000
*%CSVINFO: MACRO KEYS(FUNC,TCBADDR,RBADDR,ENV,ABDPLPTR,ASID,MIPR,       03096000
*                 USERDATA,RETCODE,RSNCODE,COM,MF);                     03097000
*  ANS('?'||MACLABEL||' '||'CSVINFOP '||MACLIST||                       03098000
*         ' '||MACKEYS||';') COL(MACLMAR);                              03099000
*%END CSVINFO;                                                          03100000
