         MACRO                                                          00050000
&NAME    STIMERM &TYPE,                                                +00100000
               &ID=,                                                   +00150000
               &DINTVL=,                                               +00200000
               &BINTVL=,                                               +00250000
               &GMT=,                                                  +00300000
               &LT=,                                               @L1A+00325000
               &MICVL=,                                                +00350000
               &TOD=,                                                  +00400000
               &TUINTVL=,                                              +00450000
               &TU=,                                                   +00500000
               &MIC=,                                                  +00550000
               &ERRET=,                                                +00600000
               &EXIT=,                                                 +00650000
               &PARM=,                                                 +00700000
               &WAIT=NO,                                               +00750000
               &MF=I,                                                  +00783300
               &RELATED=                                                00816600
.********************************************************************** 00850000
.*                                                                    * 00900000
.* MACRO NAME = STIMERM                                               * 00950000
.*                                                                    * 01000000
.* PROPRIETARY STATEMENT =                                            * 01050000
.*    LICENSED MATERIALS - PROPERTY OF IBM                        @L1C* 01170000
.*    THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 01177500
.*    5695-047 (C)COPYRIGHT IBM CORPORATION 1984, 1990                * 01185000
.*    SEE COPYRIGHT INSTRUCTIONS                                      * 01192500
.*                                                                    * 01200000
.* STATUS = HBB4410                                               @L1C* 01250000
.*                                                                    * 01300000
.* FUNCTION =                                                         * 01350000
.*                                                                    * 01400000
.*    THE STIMERM MACRO ALLOWS THE ISSUER TO SET, TEST OR CANCEL      * 01450000
.*    UP TO 16 REAL TIME INTERVALS.  AT THE TIME THE INTERVAL IS      * 01500000
.*    ESTABLISHED, THE CALLER MAY OPTIONALLY SPECIFY AN EXIT ROUTINE  * 01550000
.*    TO BE GIVEN CONTROL ASYNCHRONOUSLY AFTER THE TIME INTERVAL      * 01583300
.*    EXPIRES OR THAT EXECUTION OF THE CURRENT TASK IS TO BE          * 01633300
.*    SUSPENDED.                                                      * 01683300
.*                                                                    * 01750000
.*    AN ERROR EXIT MAY ALSO BE SPECIFIED WHICH MAY BE GIVEN CONTROL  * 01800000
.*    IF THE STIMERM FUNCTION CANNOT BE PERFORMED.                    * 01850000
.*                                                                    * 01900000
.* OPERATION =                                                        * 01950000
.*                                                                    * 02000000
.*   TYPE can be SET, TEST, or CANCEL. The explanation of each       *  02025000
.*   request and valid keywords follows:                              * 02050000
.*                                                                    * 02075000
.* SET                                                                * 02100000
.*                                                                    * 02150000
.*   This indicates a request to establish a REAL time interval.      * 02200000
.*                                                                    * 02300000
.*,ID=stor addr                   RX-type address or register(2)-(12) * 02350000
.*   specifies the address of a 4-byte storage area in which the      * 02400000
.*   identifier assigned by the timer services to this request will be* 02450000
.*   returned.                                                        * 02500000
.*                                                                    * 02550000
.*  ,BINTVL=stor addr             RX-type address or register(2)-(12) * 02600000
.*  ,DINTVL=stor addr             RX-type address or register(2)-(12) * 02650000
.*  ,LT=stor addr                 RX-type address or register(2)-(12) * 02675000
.*  ,GMT=stor addr                RX-type address or register(2)-(12) * 02700000
.*  ,MICVL=stor addr              RX-type address or register(2)-(12) * 02750000
.*  ,TOD=stor addr                RX-type address or register(2)-(12) * 02800000
.*  ,TUINTVL=stor addr            RX-type address or register(2)-(12) * 02850000
.*                                                                    * 02900000
.*  specifies the storage address and format of the time interval:    * 02950000
.*                                                                    * 03000000
.*  For BINTVL, the address of a 4-byte storage area containing the   * 03050000
.*  time interval. The time interval is represented as an unsigned    * 03100000
.*  32-bit binary number; the low-order bit has a value of 0.01       * 03150000
.*  second.                                                           * 03200000
.*                                                                    * 03250000
.*  For DINTVL, the address of an 8-byte storage area containing the  * 03300000
.*  time interval.  The time interval is represented as zoned decimal * 03350000
.*  digits of the form:                                               * 03400000
.*                                                                    * 03500000
.*  HHMMSSth, where:                                                  * 03550000
.*                                                                    * 03600000
.*  HH  is hours (24-hour clock)                                      * 03650000
.*  MM  is minutes                                                    * 03700000
.*  SS  is seconds                                                    * 03750000
.*  t   is tenths of seconds                                          * 03800000
.*  h   is hundredths of seconds                                      * 03850000
.*                                                                    * 03900000
.*  LT, or Local Time.                                                * 03907100
.*  The address is an 8-byte storage area containing the time of day  * 03914200
.*  at which the interval is to be completed.  The time of day is     * 03921300
.*  represented as zoned decimal digits of the form HHMMSSth, as      * 03928400
.*  described above under DINTVL.                                     * 03935500
.*                                                                    * 03942600
.*  For GMT, the address is an 8-byte storage area containing the     * 03950000
.*  Greenwich mean time at which the interval is to be completed.  The* 04000000
.*  time is represented as zoned decimal digits of the form HHMMSSth, * 04050000
.*  as described above under DINTVL.                                  * 04100000
.*                                                                    * 04150000
.*  For MICVL, the address is an 8-byte storage area containing the   * 04200000
.*  time interval.  The time interval is represented as an unsigned   * 04250000
.*  64-bit binary number; bit 51 is the low-order bit of the interval * 04300000
.*  value and equivalent to 1 microsecond.                            * 04350000
.*                                                                    * 04450000
.*  TOD, or Time of Day. (Same as LT above. The use of this keyword   * 04500000
.*  is not encouraged, it is maintained only for compatibility.)      * 04550000
.*                                                                    * 04750000
.*  For TUINTVL, the address is a 4-byte storage area containing the  * 04800000
.*  time interval.  The time interval is represented as an unsigned   * 04850000
.*  32-bit binary number; the low-order bit has a value of one timer  * 04900000
.*  unit (approximately 26.04166 microseconds).                       * 04950000
.*                                                                    * 05050000
.*  Note:                                                             * 05083300
.*  For DINTVL, GMT, LT, and TOD parameters, the zoned decimal        * 05116600
.*  digits are not checked for validity.  Thus, the specification of  * 05150000
.*  invalid digits can result in an ABEND 0C7, or a time interval     * 05200000
.*  different from that desired.                                      * 05250000
.*                                                                    * 05350000
.*  ,EXIT=exit rtn addr                                               * 05400000
.*                                                                    * 05450000
.*  specifies the address of a routine to be given asynchronous       * 05500000
.*  control after the requested timer interval expires. If WAIT=YES is* 05550000
.*  specified, then the EXIT= parameter must not be specified. The    * 05600000
.*  specified exit routine will be entered in the AMODE of the caller.* 05650000
.*                                                                    * 05750000
.*                                                                    * 05775000
.*  ,PARM=stor addr                                                   * 05800000
.*                                                                    * 05850000
.*  specifies the address of a 4-byte parameter to be passed to the   * 05900000
.*  exit routine after the requested timer interval expires. PARM=stor* 05950000
.*  addr must not be specified if WAIT= YES is specified or EXIT=exit * 06000000
.*  rtn addr is not specified.                                        * 06050000
.*                                                                    * 06150000
.*  ,WAIT=YES|NO                                                      * 06200000
.*                                                                    * 06250000
.*  specifies the task should be suspended until the requested timer  * 06300000
.*  interval expires.  If WAIT=NO is coded (or is indicated by        * 06350000
.*  default), and EXIT= is not coded, then no indication of timer     * 06400000
.*  expiration is given.                                              * 06450000
.*                                                                    * 06500000
.*  EXTERNAL REFERENCES =                                             * 06550000
.*                                                                    * 06600000
.*             ROUTINES   =  IEAVRT00 VIA SVC 47                      * 06612500
.*                                                                    * 06625000
.*  REGISTER CONTENT AFTER MACRO INVOCATION =                         * 06637500
.*                                                                    * 06650000
.*  Register    0  is unpredictable                                   * 06662500
.*  Register    1  will contain the address                           * 06675000
.*                 of the STIMERM parameter list                      * 06687500
.*  Register 2-14  are restored                                       * 06700000
.*  Register   15  contains a return code                             * 06712500
.*                                                                    * 06725000
.*                                                                    * 06737500
.* TEST                                                               * 06750000
.*                                                                    * 06800000
.*  This indicates a request to return the remaining time for a       * 06850000
.*  request made using the STIMERM SET option.                        * 06900000
.*                                                                    * 07000000
.* ,ID=addr                       RX-type address or register(2)-(12) * 07050000
.*                                                                    * 07100000
.*  specifies the address of a 4-byte storage area containing the     * 07150000
.*  identifier assigned by the timer services to a particular timer   * 07200000
.*  request.                                                          * 07250000
.*                                                                    * 07300000
.*  ,TU=stor addr                 RX-type address or register(2)-(12) * 07350000
.*  ,MIC=stor addr                RX-type address or register(2)-(12) * 07400000
.*                                                                    * 07450000
.*  specifies that the remaining time in the interval be returned:    * 07500000
.*                                                                    * 07550000
.*  For TU, the time is returned to the specified 4-byte area in      * 07583300
.*  storage as an unsigned 32-bit binary number.  The low-order bit is* 07633300
.*  approximately 26.04166 microseconds (one timer unit).             * 07700000
.*                                                                    * 07750000
.*  For MIC, the time is returned in microseconds, with bit 51        * 07800000
.*  equivalent to one microsecond.  The stor addr is the 8-byte       * 07833300
.*  storage area where the remaining interval is to be returned.      * 07866600
.*                                                                    * 07900000
.*                                                                    * 08150000
.*                                                                    * 08250000
.*  EXTERNAL REFERENCES =                                             * 08254100
.*                                                                    * 08258200
.*             ROUTINES   =  IEAVRT00 VIA SVC 46                      * 08262300
.*                                                                    * 08266400
.*                                                                    * 08270500
.*  REGISTER CONTENT AFTER MACRO INVOCATION =                         * 08274600
.*                                                                    * 08278700
.*  Register    0  will contain the address of the                    * 08280700
.*                 STIMERM TEST parameter list                        * 08282700
.*  Register    1  unpredictable                                      * 08284700
.*  Register 2-14  are restored                                       * 08286900
.*  Register   15  contains a return code                             * 08291000
.*                                                                    * 08295100
.* CANCEL                                                             * 08300000
.*                                                                    * 08350000
.*  This indicates a request to cancel and optionally return the      * 08400000
.*  remaining time for a STIMERM time request.                        * 08450000
.*                                                                    * 08550000
.* ,ID=addr|ALL                                                       * 08600000
.*                                                                    * 08650000
.*  specifies the address of a 4-byte storage area containing the     * 08700000
.*  identifier assigned by the timer service to a particular timer    * 08750000
.*  request.  ALL will result in all the current TASK's timer requests* 08800000
.*  established by STIMERM SET being cancelled. If ALL is specified,  * 08850000
.*  no remaining time interval is returned.                           * 08900000
.*                                                                    * 08950000
.*  If ALL is specified for the ID= parameter, then neither TU nor MIC* 09000000
.*  may be specified.                                                 * 09050000
.*                                                                    * 09100000
.*  If the STIMERM CANCEL specifies (via ID=ALL or ID=addr) requests    09106200
.*  that were established with the WAIT=YES parameter, those time     * 09112400
.*  intervals will not be cancelled, and the task will not be taken   * 09118600
.*  out of the wait condition.                                        * 09124800
.*                                                                    * 09131000
.*                                                                    * 09137200
.*                                                                    * 09143400
.*  ,TU=stor addr                 RX-type address or register(2)-(12) * 09150000
.*  ,MIC=stor addr                RX-type address or register(2)-(12) * 09200000
.*                                                                    * 09250000
.*  specifies that the remaining time in the interval be returned:    * 09300000
.*                                                                    * 09350000
.*  For TU, the time is returned to the specified 4-byte area in      * 09383300
.*  storage as an unsigned 32-bit binary number.  The low-order bit is* 09433300
.*  approximately 26.04166 microseconds (one timer unit).             * 09500000
.*                                                                    * 09550000
.*                                                                    * 09700000
.*  For MIC, the time is returned in microseconds, with bit 51        * 09740000
.*  equivalent to one microsecond.  The stor addr is the 8-byte       * 09780000
.*  storage area where the remaining interval is to be returned.      * 09820000
.*                                                                    * 09860000
.*  EXTERNAL REFERENCES =                                             * 09900000
.*                                                                    * 09950000
.*             ROUTINES   =  IEAVRT00 VIA SVC 46                      * 10000000
.*                                                                    * 10050000
.*                                                                    * 10056200
.*  REGISTER CONTENT AFTER MACRO INVOCATION =                         * 10062400
.*                                                                    * 10068600
.*  Register    0  will contain the address of the                    * 10072700
.*                 STIMERM CANCEL parameter list                      * 10076800
.*  Register 2-14  are restored                                       * 10081000
.*  Register   15  contains a return code                             * 10087200
.*                                                                    * 10093400
.* GENERAL OPTIONS (Available to SET, TEST & CANCEL):                 * 10100000
.*                                                                    * 10150000
.*  ,ERRET=err rtn addr           RX-type address or register(2)-(12) * 10200000
.*                                                                    * 10250000
.*  specifies the address of the routine to be given control when the * 10300000
.*  STIMERM function cannot be performed.  If this parameter is       * 10350000
.*  omitted, and an error is encountered, the STIMERM issuer will be  * 10400000
.*  abnormally terminated.  The specified error routine will be       * 10450000
.*  entered in the AMODE of the STIMERM invoker.                      * 10500000
.*                                                                    * 10550000
.*  ,MF=L | MF=(E,ctrl addr)                                          * 10600000
.*                                                                    * 10650000
.*  cntrl addr: RX-type address or register(0),(2)-(12) for TEST      * 10657300
.*                                                      & CANCEL      * 10664600
.*                                 register(1)-(12) for SET           * 10672000
.*                                                                    * 10683200
.*  specifies either the list form macro, or an execute form using a  * 10710300
.*  remote problem program parameter list.  If MF=L or MF=(E,cntrl    * 10737400
.*  addr) is not specified, then the default standard form of the     * 10764500
.*  macro is expanded.  If MF=L is specified, the only keyword allowed* 10791600
.*  is RELATED=.  If cntrl addr is specified as general register 1 in * 10818700
.*  the form (1) for the SET option, a one instruction savings in the * 10845800
.*  STIMERM SET macro expansion will result.                          * 10872900
.*                                                                    * 10900000
.*  ,RELATED=value                                                    * 10950000
.*                                                                    * 11000000
.*  specifies information used to self document macro instructions by * 11009300
.*  'relating' functions or services to corresponding functions or    * 11018600
.*  services.  The format and contents of the information specified   * 11027900
.*  are at the discretion of the user, and may be any valid macro     * 11037200
.*  keyword expression.                                               * 11046500
.*                                                                    * 11055800
.*                                                                    * 11074400
.*                                                                    * 11130200
.* MACLIB = AMACLIB                                                   * 11136800
.*                                                                    * 11143400
.* CHANGE-ACTIVITY =                                                  * 11150000
.*                                                                    * 11200000
.* COMPONENT = TIMER (SC1CV)                                          * 11216600
.*                                                                    * 11233200
.*   $D0=DCR0047  JBB2125  830527  PD16FH:  SET TIMER MULTIPLE TQE    * 11250000
.*                                          SUPPORT                   * 11300000
.*   $P1=PAJ0263  JBB2125  830905  PD16FH:  MNOTE IF 'PARM' OPTION    * 11314200
.*                                          SPECIFIED WITH NO EXIT    * 11328400
.*   $P2=PAJ0264  JBB2125  830905  PD16FH:  SET ERROR FLAG IF 'TU'    * 11342600
.*                                          SPECIFIED FOR STIMERM SET * 11356800
.*   $P3=PAJ0266  JBB2125  830905  PD16FH:  HANDLE STIMERM CANCEL     * 11371000
.*                                          WITHOUT 'TU' OR 'MIC'     * 11385200
.*   $L1=CLOCK    HBB4410  880411  PD16LD:  Local Time (LT)           * 11388900
.*   $D1=DCR1006  HBB4410  880819  PD16CU:  ETR support               * 11392600
.*                                                                    * 11396300
.********************************************************************** 11400000
*        MACDATE = 08/19/88                                           * 11450000
         LCLB  &ERRORS            ERROR FLAG                            11500000
         LCLA  &LVL               USED AS STIMERM LEVEL INDICATOR       11625000
         LCLC  &FLAGS             USED TO GENERATE FLAG BITS            11637500
         LCLC  &A                 WORKING NAME FOR INTERVAL FIELD       11650000
         LCLC  &SETID             WORKING NAME FOR ID FIELD             11666600
         LCLC  &SETEXIT           WORKING NAME FOR EXIT ADDRESS FIELD   11683200
         LCLC  &GNAME             GENERATED PARAMETER LIST NAME         11700000
         LCLC  &GLNAME            GENERATED NAME FOR END OF LIST        11712500
         LCLC  &BB                STRINGS FOR MNOTES                    11715600
         LCLC  &DD                MNOTE INVOCATION                      11718700
         LCLC  &UU                STRINGS FOR MNOTE GENERATION          11721800
         LCLA  &LENGTH1           LENGTH OF "SET" LIST                  11725000
         LCLA  &LENGTH2           LENGTH OF "TEST"/"CANCEL" LIST        11737500
         LCLA  &UNITS             No. OF INTERVAL KEYWORDS SPECIFIED    11763500
.**************************************************************         11789500
.**                                                          **         11815500
.**    PARAMETER VERIFICATION AND MNOTE GENERATION SECTION   **         11841500
.**                                                          **         11867500
.**************************************************************         11893500
&LENGTH1 SETA  24                  LENGTH OF "SET" PARM LIST            11920000
&LENGTH2 SETA  16                  LENGTH OF "TEST"/"CANCEL" PARM LIST  11940000
&LVL     SETA  1                   STIMERM LEVEL INDICATOR              11960000
.*                                GENERATE LABEL                        11964000
         AIF  ('&MF' EQ 'L').NONAME  LIST FORM? DON'T GEN NAME HERE     11966000
&NAME    DS    0H                 STIMERM INVOCATION                    11968000
.NONAME  ANOP                                                           11970000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          11972000
&GLNAME  SETC  'IHBL'.'&SYSNDX'    END OF LIST                          11974600
&FLAGS   SETC  '00000000'                 INIT FLAG BYTE STRING         11977200
.*                                 SET LOCAL BITS ACCORDING TO INPUT    11980000
.*  SET LOCAL CHARACTER STRINGS FOR "ID" AND "EXIT" FIELDS              12030000
&SETID   SETC  '&ID'                                                    12080000
&SETEXIT SETC  '&EXIT'                                                  12130000
.*                                VERIFY "TYPE" SPECIFICATION           12707400
         AIF ('&TYPE' EQ 'SET').VERIFYU                                 12712300
         AIF ('&TYPE' EQ 'TEST').VERIFYU                                12717200
         AIF ('&TYPE' EQ 'CANCEL').VERIFYU                              12722100
         MNOTE 12,'(&TYPE) IS NOT VALID. TYPE MUST BE ''SET'' ''TEST'' X12729500
               OR ''CANCEL'' '                                     @L1C 12736900
         MEXIT                    EXIT FROM MACRO                       12744400
.*       VERIFY "SET" TIMER INTERVAL UNIT SPECIFICATIONS                12751800
.VERIFYU ANOP                                                           12759200
         AIF  ('&DINTVL' EQ '').VBIN                                    12766600
&UU      SETC  'DINTVL'                   UPDATE MNOTE STRING           12774000
&A       SETC  '&DINTVL'                  SET INSTRUCTION GEN STRING    12781400
&FLAGS   SETC  '00110000'                 INIT FLAG BYTE STRING         12788800
&UNITS   SETA  1                                                        12796200
.*                                                                      12799900
.VBIN    AIF  ('&BINTVL' EQ '').VTUIN                                   12803600
&UU      SETC  '&UU'.' BINTVL'                                          12811000
&A       SETC  '&BINTVL'                                                12818400
&FLAGS   SETC  '00010000'                                               12825800
&UNITS   SETA  &UNITS+1                                                 12833200
.*                                                                      12836900
.VTUIN   AIF  ('&TUINTVL' EQ '').VTOD                                   12840600
&UU      SETC  '&UU'.' TUINTVL'                                         12848000
&A       SETC  '&TUINTVL'                                               12855400
&FLAGS   SETC  '00000000'                                               12862800
&UNITS   SETA  &UNITS+1                                                 12870200
.*                                                                      12875100
.VTOD    AIF  ('&TOD' EQ '').VLT                                   @L1C 12880000
&UU      SETC  '&UU'.' TOD'                                             12885000
&A       SETC  '&TOD'                                                   12892400
&FLAGS   SETC  '01110000'                                               12899800
&UNITS   SETA  &UNITS+1                                                 12907200
.*                                                                      12908800
.VLT     AIF  ('&LT' EQ '').VMICVL        LT is the same as TOD    @L1A 12910400
&UU      SETC  '&UU'.' LT'                                         @L1A 12912000
&A       SETC  '&LT'                                               @L1A 12913600
&FLAGS   SETC  '01110000'                                          @L1A 12915200
&UNITS   SETA  &UNITS+1                                            @L1A 12916800
.*                                                                      12918400
.VMICVL  AIF  ('&MICVL' EQ '').VGMT                                @D1C 12920000
&UU      SETC  '&UU'.' MICVL'                                           12922000
&A       SETC  '&MICVL'                                                 12929400
&FLAGS   SETC  '00100000'                                               12936800
&UNITS   SETA  &UNITS+1                                                 12944200
.*                                                                      12945100
.VGMT    AIF  ('&GMT' EQ '').VTU                                        12951600
&UU      SETC  '&UU'.' GMT'                                             12959000
&A       SETC  '&GMT'                                                   12966400
&FLAGS   SETC  '01100000'                                               12973800
&UNITS   SETA  &UNITS+1                                                 12981200
.*                                                                      12983000
.*       VERIFY "TEST/CANCEL" TIMER INTERVAL UNIT SPECIFICATIONS        12984900
.VTU     AIF  ('&TU' EQ '').VMIC                                        12988600
&UU      SETC  '&UU'.' TU'                                              12996000
&A       SETC  '&TU'                                                    13003400
&FLAGS   SETC  '00010000'                                               13010800
&UNITS   SETA  &UNITS+1                                                 13018200
.*                                                                      13021900
.VMIC    AIF  ('&MIC' EQ '').VUNITS                                     13025600
&UU      SETC  '&UU'.' MIC'                                             13033000
&A       SETC  '&MIC'                                                   13040400
&FLAGS   SETC  '00000010'                                               13047800
&UNITS   SETA  &UNITS+1                                                 13055200
.*                                                                      13058900
.*                                 VERIFY ONLY ONE UNITS OPERAND        13062600
.VUNITS  AIF   (&UNITS LT 2).VERIFYF                                    13070000
         MNOTE 12,'MULTIPLE INTERVALS-&UU'                              13077400
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13084800
.*-------------------------------------------------------------         13092800
.*------ DETERMINE THE FORM OF MACRO INVOCATION ---------------         13139200
.*-------------------------------------------------------------         13185600
.VERIFYF AIF   ('&MF' EQ 'L').VERIFYL  LIST MACRO FORM?                 13235600
         AIF   ('&MF' EQ 'I' OR '&MF(1)' EQ 'E').VERIFYI                13285600
         MNOTE 12,'MF=&MF IS NOT VALID'                            @L1C 13335600
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13394400
.*-------------------------------------------------------------         13417600
.*------   VERIFY PARAMETERS                    ---------------         13510400
.*-------------------------------------------------------------         13556800
.VERIFYI ANOP                                                           13603200
.*       'ID' OPERAND REQUIRED, NOT SPECIFIED                           13650000
         AIF   ('&ID' NE '').VI1                                        13670000
         MNOTE 12,'ID OPERAND REQUIRED, NOT SPECIFIED'             @L1C 13690000
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13710000
.VI1     AIF   ('&TYPE' NE 'SET').NOTISET         SET OPTION?           13730000
.*-------------- STIMERM SET ----------------------------------         13732600
         AIF   ('&TU' EQ '').VIS1                                       13735200
         MNOTE 12,'TU IS NOT VALID WITH SET REQUEST'               @L1C 13738400
&ERRORS  SETB   1                 SET ON ERROR FLAG                @P2A 13741700
.VIS1    AIF   ('&MIC' EQ '').VIS2                                      13743000
         MNOTE 12,'MIC IS NOT VALID WITH SET REQUEST'              @L1C 13746900
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13750800
.VIS2    AIF   (&UNITS NE 0).VIS3                                       13750900
         MNOTE 12,'''INTERVAL'' OPERAND REQUIRED, NOT SPECIFIED'   @L1C 13751000
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13751200
.VIS3    AIF   ('&ID' NE 'ALL').VIS4                                    13751300
         MNOTE 12,'ID=ALL IS NOT VALID WITH SET REQUEST'           @L1C 13751400
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13751600
.VIS4    AIF   ('&WAIT' EQ 'YES' OR '&WAIT' EQ 'NO').VIS5  LEGAL WAIT?  13751700
         MNOTE 12,'WAIT PARAMETER MUST BE ''YES'' OR ''NO'' '      @L1C 13751900
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13752100
.VIS5    ANOP                                                           13752200
&FLAGS   SETC '&FLAGS'(1,6).'11'                 INITIALIZE AS WAIT=NO  13752300
         AIF   ('&WAIT' EQ 'NO').VIS8            WAIT=NO SPECIFIED?     13752400
         AIF   ('&EXIT' EQ '').VIS6              EXIT?                  13752500
         MNOTE 12,'EXIT AND WAIT=YES OPTIONS ARE MUTUALLY EXCLUSIVE'    13752600
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13752700
.VIS6    AIF   ('&PARM' EQ '').VIS7              PARM                   13752800
         MNOTE 12,'PARM AND WAIT=YES OPTIONS ARE MUTUALLY EXCLUSIVE'    13752900
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13753200
.VIS7    ANOP                                                           13753500
&FLAGS   SETC '&FLAGS'(1,6).'01'                 WAIT=YES               13753800
.VIS8    ANOP                                                           13754100
         AIF  ('&PARM' EQ '').VIS9               PARM SPECIFIED?   @P1A 13754200
         AIF  ('&EXIT' NE '').VIS9               EXIT SPECIFIED?   @P1A 13754300
         MNOTE 12,'EXIT OPTION IS REQUIRED WITH PARM OPTION'       @L1C 13754400
&ERRORS  SETB   1                 SET ON ERROR FLAG                @P1A 13754500
.VIS9    ANOP                                                      @P1A 13754600
         AIF  ('&ERRET' EQ '').EIS                                      13754700
&FLAGS   SETC '&FLAGS'(1,4).'1'.'&FLAGS'(6,3)    ERRET SPECIFIED        13754800
.*-------EXIT MACRO IF ERROR HAS BEEN DETECTED ----------------         13755000
.*-------OTHERWISE, BRANCH TO GENERATE APPROPRIATE CODE--------         13755300
.EIS     AIF  (NOT (&ERRORS) AND '&MF' EQ 'I').ISET                     13755600
         AIF  (NOT (&ERRORS) AND '&MF(1)' EQ 'E').ESET                  13755900
         MEXIT                                                          13756200
.NOTISET ANOP                                                           13756500
         AIF   ('&TYPE' NE 'TEST').NOTITES        TEST OPTION?          13756800
.*                                                                      13756900
.*-------------- STIMERM TEST----------------------------------         13757100
.*                                                                      13757200
.VIT1    AIF   ('&DINTVL&BINTVL&TUINTVL&TOD&LT&MICVL&GMT'              X13757300
               EQ '').VIT2                                         @D1C 13757400
.*  DINTVL BINTVL TUINTVL TOD LT MICVL GMT  IS INVALID                  13757500
.*                                              WITH TEST REQUEST       13757600
         MNOTE 12,'&UU IS NOT VALID WITH TEST REQUEST'             @L1C 13757700
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13758300
.VIT2    AIF   ('&ID' NE 'ALL').VIT3                                    13758600
         MNOTE 12,'ID=ALL IS NOT VALID WITH TEST REQUEST'          @L1C 13759000
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13759500
.VIT3    AIF   ('&PARM' EQ '').VIT4                                     13759800
         MNOTE 12,'PARM IS NOT VALID WITH TEST REQUEST'            @L1C 13760200
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13760700
.VIT4    AIF   ('&EXIT' EQ '').VIT5                                     13761000
         MNOTE 12,'EXIT IS NOT VALID WITH TEST REQUEST'            @L1C 13761400
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13761900
.VIT5    AIF   ('&WAIT' EQ 'NO').VIT6                                   13762200
         MNOTE 12,'WAIT IS NOT VALID WITH TEST REQUEST'            @L1C 13762600
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13763100
.VIT6    AIF   (&UNITS NE 0).VIT7                                       13763400
         MNOTE 12,'''INTERVAL'' OPERAND REQUIRED, NOT SPECIFIED'   @L1C 13763800
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13764300
.VIT7    ANOP                                                           13764600
         AIF  ('&ERRET' EQ '').EIT                                      13764900
&FLAGS   SETC '&FLAGS'(1,5).'1'.'&FLAGS'(7,2)    ERRET SPECIFIED        13765200
.*-------EXIT MACRO IF ERROR HAS BEEN DETECTED ----------------         13765500
.*-------OTHERWISE, BRANCH TO GENERATE APPROPRIATE CODE--------         13765800
.EIT     AIF  (NOT (&ERRORS) AND '&MF' EQ 'I').ITES                     13766100
         AIF  (NOT (&ERRORS) AND '&MF(1)' EQ 'E').ETES                  13766400
         MEXIT                                                          13766700
.NOTITES ANOP                                                           13767000
.*                                                                      13767100
.*-------------- STIMERM CANCEL--------------------------------         13767300
.*                                                                      13767400
&FLAGS   SETC '&FLAGS'(1,7).'1'                  CANCEL SPECIFIED       13767600
.VIC1    AIF   ('&DINTVL&BINTVL&TUINTVL&TOD&LT&MICVL&GMT'              X13767800
               EQ '').VIC2                                         @D1C 13768000
.*  DINTVL BINTVL TUINTVL TOD LT MICVL GMT  IS INVALID                  13768200
.*                                              WITH CANCEL REQUEST     13768400
         MNOTE 12,'&UU IS NOT VALID WITH CANCEL REQUEST'           @L1C 13768600
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13768800
.VIC2    AIF   ('&PARM' EQ '').VIC3                                     13769100
         MNOTE 12,'PARM IS NOT VALID WITH CANCEL REQUEST'          @L1C 13769500
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13770000
.VIC3    AIF   ('&EXIT' EQ '').VIC4                                     13770300
         MNOTE 12,'EXIT IS NOT VALID WITH CANCEL REQUEST'          @L1C 13770700
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13771200
.VIC4    AIF   ('&WAIT' EQ 'NO').VIC5                                   13771500
         MNOTE 12,'WAIT IS NOT VALID WITH CANCEL REQUEST'          @L1C 13771900
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13772400
.*       ("TU" OR "MIC") & "ID=ALL" MUTUALLY EXCLUSIVE                  13772700
.VIC5    AIF   ('&ID' NE 'ALL').VIC7                                    13773000
         AIF   ('&TU' EQ '' AND '&MIC' EQ '').VIC6                      13773300
         MNOTE 12,'&UU AND ID=ALL OPTIONS ARE MUTUALLY EXCLUSIVE'       13773600
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13773900
.VIC6    ANOP                                                           13774200
&FLAGS   SETC '&FLAGS'(1,4).'1'.'&FLAGS'(6,3)    ID=ALL SPECIFIED       13774500
.VIC7    ANOP                                                           13774800
         AIF  ('&ERRET' EQ '').EIC                                      13775100
&FLAGS   SETC '&FLAGS'(1,5).'1'.'&FLAGS'(7,2)    ERRET SPECIFIED        13775400
.*-------EXIT MACRO IF ERROR HAS BEEN DETECTED ----------------         13775700
.*-------OTHERWISE, BRANCH TO GENERATE APPROPRIATE CODE--------         13776000
.EIC     AIF  (NOT (&ERRORS) AND '&MF' EQ 'I').ICAN                     13776300
         AIF  (NOT (&ERRORS) AND '&MF(1)' EQ 'E').ECAN                  13776600
         MEXIT                                                          13776900
.*-------------------------------------------------------------         13777200
.*------ DETERMINE THE TYPE OF LIST MACRO       ---------------         13782400
.*------   VERIFY PARAMETERS                    ---------------         13782800
.*-------------------------------------------------------------         13783200
.VERIFYL ANOP                                                           13783600
&BB      SETC  'OPTION(S) NOT ALLOWED WITH MF=L'                        13783800
         AIF   (&UNITS EQ 0).VL2                                        13784000
.* DINTVL, BINTVL, Etc. IS INVALID WITH MF=L REQUEST                    13784200
&BB      SETC  '&UU '.'&BB'                                             13784400
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13784600
.VL2     AIF   ('&PARM' EQ '').VL3                                      13784800
&BB      SETC  'PARM '.'&BB'                                            13785000
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13785200
.VL3     AIF   ('&WAIT' EQ 'NO' ).VL4                                   13785400
&BB      SETC  'WAIT '.'&BB'                                            13785600
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13785800
.VL4     AIF   ('&EXIT' EQ '').VL5                                      13786000
&BB      SETC  'EXIT '.'&BB'                                            13786200
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13786400
.*                                 ERRET ILLEGAL FOR LIST               13787600
.VL5     AIF   ('&ERRET' EQ '').VL6                                     13787800
&BB      SETC  'ERRET '.'&BB'                                           13788000
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13788200
.*                                 ID ILLEGAL FOR LIST                  13788400
.VL6     AIF   ('&ID' EQ '').LGENAME                                    13788800
&BB      SETC  'ID '.'&BB'                                              13789200
&ERRORS  SETB   1                 SET ON ERROR FLAG                     13789600
.LGENAME ANOP                     PREPARE TO EXIT VALIDATION            13789700
         AIF  (NOT (&ERRORS)).LGENDC                                    13789800
&NAME    DS    0H                                                       13789900
         MNOTE 12,'RELATED IS THE ONLY VALID KEYWORD FOR MF=L FORM'     13790000
         MNOTE 12,'&BB'                                                 13790100
         MEXIT                                                          13790400
.LGENDC  AIF   ('&TYPE' NE 'SET').LSHORT          SET LIST?             13790600
&NAME    DC    XL&LENGTH1'00'     REMOTE STIMERM SET PARM LIST          13790800
         MEXIT                                                          13791000
.LSHORT  ANOP                                     TEST OR CANCEL LIST   13791200
&NAME    DC    XL&LENGTH2'00'     REMOTE STIMERM TEST/CANCEL PARM LIST  13791400
         MEXIT                                                          13791600
.**************************************************************         13792400
.**                                                          **         13792800
.**    IN-LINE LIST SECTION                                  **         13793200
.**                                                          **         13793600
.**************************************************************         13794000
.IROUT   ANOP                                                           13794400
.* --------------------------------IN-LINE ---------------------------- 13800000
.* --------------------------------STIMERM SET------------------------- 13850000
.* -------------------------------------------------------------------- 13900000
.ISET    ANOP                                                           13950000
.* -------------------------------------------------------------------- 14000000
.* -------------------------------------------------------------------- 14100000
.* -------------------------------------------------------------------- 14450000
.* "SET" OPTION FLAG BITS:                                              14500000
.*  BIT NUMBER   HEXADECIMAL   DECIMAL               DESCRIPTION        14500200
.*  0123 4567                                                           14500400
.*  0000 0000       00            0                  TUINTVL            14500600
.*  0001 0000       10           16                  BINTVL             14500800
.*  0010 0000       20           32                  MICVL              14501000
.*  0011 0000       30           48                  DINTVL             14501200
.*  0110 0000       60           96                  GMT                14501400
.*  0111 0000       70          112                  TOD or LT     @L1C 14501600
.*  0000 1000       08            8                  ERRET              14501800
.*  0000 0001       01            1                  WAIT=YES           14502000
.*  0000 0011       03            3                  WAIT=NO            14502200
.* -------------------------------------------------------------------- 14502400
         LA    1,&GNAME           SET UP LIST ADDRESS                   14502600
.* -------------------------------------------------------------------- 14502800
.* ( IS1 )---FIRST WORD OF PARAMETER LIST HAS FLAG BYTE AND LEVEL# ---- 14503000
.* -------------------------------------------------------------------- 14503200
.IS1     ANOP                                                           14503400
.* -------------------------------------------------------------------- 14503600
.* ( IS2 )---SECOND WORD OF PARAMETER LIST IS ID ADDRESS -------------- 14503800
.* -------------------------------------------------------------------- 14504000
.IS2     ANOP                     INITIALIZE 2ND WORD                   14504200
         AIF   ('&ID'(1,1) NE '(').IS3   RX-ADDRESS?                    14504400
         ST    &ID(1),4(,1)       STORE ID ADDRESS INTO LIST            14504600
&SETID   SETC  '0'                GENERATE AD-CON OF ZERO               14504800
.* -------------------------------------------------------------------- 14505000
.* ( IS3 )---THIRD WORD OF PARAMETER LIST IS THE INTERVAL ADDRESS------ 14505200
.* -------------------------------------------------------------------- 14505400
.IS3     ANOP                     INITIALIZE 3RD WORD                   14505600
         AIF   ('&A'(1,1) NE '(').IS4    ADDR IN REG?                   14505800
         ST    &A,8(,1)           STORE INTERVAL ADDRESS INTO LIST      14506000
&A       SETC  '0'                GENERATE AD-CON OF ZERO               14506200
.* -------------------------------------------------------------------- 14506400
.* ( IS4 )---FOURTH WORD OF PARAMETER LIST IS EXIT ROUTINE ADDRESS----- 14506600
.* -------------------------------------------------------------------- 14506800
.IS4     ANOP                     INITIALIZE 4TH WORD                   14507000
         AIF   ('&EXIT' EQ '').IS4SETC                                  14507200
.IS4AIF2 AIF   ('&EXIT'(1,1) NE '(').IS5     ADDR IN REG?               14507400
         ST    &EXIT(1),12(,1)    STORE EXIT ROUTINE ADDRESS INTO LIST  14507600
.IS4SETC ANOP                                                           14507800
&SETEXIT SETC  '0'                GENERATE AD-CON OF ZERO               14508000
.* -------------------------------------------------------------------- 14508200
.* ( IS5 )---FIFTH WORD OF PARAMETER LIST IS THE USER PARAMETER-------- 14508400
.* -------------------------------------------------------------------- 14508600
.IS5     ANOP                     INITIALIZE 5TH WORD                   14508800
         AIF   ('&PARM' EQ '').CALLIS   USER PARM SPECIFIED?            14509000
         AIF   ('&PARM'(1,1) EQ '(').MVCIS5  ADDR IN REGISTER?          14509200
         LA    15,&PARM           GET PARM ADDRESS                      14509400
         MVC   16(4,1),0(15)      MOVE USER PARAMETER INTO LIST         14509600
         AGO   .CALLIS                                                  14509800
.MVCIS5  ANOP                                                           14510000
         MVC   16(4,1),0&PARM     MOVE USER PARAMETER INTO LIST         14510200
.* -------------------------------------------------------------------- 14510400
.* ( CALLIS ) ISSUE THE SUPERVISOR CALL-------------------------------- 14510600
.* -------------------------------------------------------------------- 14510800
.CALLIS  ANOP                                                           14511000
         LA    0,4                LOAD OPTION BYTE INTO GPR 0           14511200
         SLL   0,24               SHIFT OPTION TO HIGH BYTE (BIT 5 ON)  14511400
         B     &GLNAME            BRANCH AROUND PARAMETER LIST          14511600
&GNAME   DS    0A                 24 BYTE "SET" PARAMETER LIST          14511800
         DC    B'&FLAGS',AL3(1)   FLAG BYTE & LVL#                      14512000
         DC    A(&SETID)          ADDRESS OF STORAGE FOR ID             14512200
         DC    A(&A)              ADDRESS OF STORAGE FOR INTERVAL       14512400
         DC    A(&SETEXIT)        ADDRESS OF EXIT ROUTINE               14512600
         DC    A(0)               USER PARM FOR EXIT ROUTINE            14512800
         DC    A(0)               RESERVED                              14513000
&GLNAME  SVC   47                 ISSUE STIMER/STIMERM SET SVC          14513200
         AIF   ('&ERRET' EQ '').ISETEND          ERROR ROUTINE?         14513400
         LTR   15,15              CHECK RETURN CODE FROM SERVICE RTN    14513600
         AIF   ('&ERRET'(1,1) EQ '(').ISETBCR    ERRET IN REGISTER?     14513800
         BNZ   &ERRET             BRANCH TO ERRET IF NON-ZERO           14514000
         AGO   .ISETEND                                                 14514200
.ISETBCR BNZR  &ERRET(1)          BRANCH TO ERRET IF NON-ZERO           14514400
.ISETEND MEXIT                                                          14514600
.* --------------------------------IN-LINE ---------------------------- 14514800
.* --------------------------------STIMERM TEST------------------------ 14515000
.* -------------------------------------------------------------------- 14515200
.ITES    ANOP                                                           14515400
.* -------------------------------------------------------------------- 14515600
.* -------------------------------------------------------------------- 14515800
.* -------------------------------------------------------------------- 14516000
.* "TEST" OPTION FLAG BITS:                                             14516200
.*  BIT NUMBER   HEXADECIMAL   DECIMAL               DESCRIPTION        14516400
.*  0123 4567                                                           14516600
.*  0001 0000       10           16                  TU                 14516800
.*  0000 0100        4            4                  ERRET              14517200
.*  0000 0010        2            2                  MIC                14517300
.* -------------------------------------------------------------------- 14517400
         LA    1,&GNAME           GET ADDRESS OF PARAMETER LIST         14517600
.* -------------------------------------------------------------------- 14517800
.* ( IT1 )---FIRST WORD OF PARAMETER LIST HAS FLAG BYTE AND LEVEL# ---- 14518000
.* -------------------------------------------------------------------- 14518200
.IT1     ANOP                     INITIALIZE 1ST WORD                   14518400
.* -------------------------------------------------------------------- 14518600
.* ( IT2 )---SECOND WORD OF PARAMETER LIST IS ID ADDRESS -------------- 14518800
.* -------------------------------------------------------------------- 14519000
.IT2     ANOP                     INITIALIZE 2ND WORD                   14519200
         AIF   ('&ID'(1,1) NE '(').IT3   ADDR IN REG?                   14519400
         ST    &ID(1),4(,1)       STORE ID ADDRESS INTO LIST            14519600
&SETID   SETC  '0'                GENERATE AD-CON OF ZERO               14519800
.* -------------------------------------------------------------------- 14520000
.* ( IT3 )---THIRD WORD OF PARAMETER LIST IS THE INTERVAL ADDRESS------ 14520200
.* -------------------------------------------------------------------- 14520400
.IT3     ANOP                     INITIALIZE 3RD WORD                   14520600
         AIF   ('&A'(1,1) NE '(').CALLIT  ADDR IN REG?                  14520800
         ST    &A,8(,1)           STORE INTERVAL ADDRESS INTO LIST      14521000
&A       SETC  '0'                GENERATE AD-CON OF ZERO               14521200
.* -------------------------------------------------------------------- 14521400
.* ( CALLIT ) ISSUE THE SUPERVISOR CALL-------------------------------- 14521600
.* -------------------------------------------------------------------- 14521800
.CALLIT  ANOP                                                           14522000
         AGO   .CALLIC                                                  14522200
.* --------------------------------IN-LINE ---------------------------- 14522400
.* --------------------------------STIMERM CANCEL---------------------- 14522600
.* -------------------------------------------------------------------- 14522800
.ICAN    ANOP                                                           14523000
.* -------------------------------------------------------------------- 14523200
.* -------------------------------------------------------------------- 14523400
.* -------------------------------------------------------------------- 14523600
.* "CANCEL" OPTION FLAG BITS:                                           14523800
.*  BIT NUMBER   HEXADECIMAL   DECIMAL               DESCRIPTION        14524000
.*  0123 4567                                                           14524200
.*  0000 1000       08            8                  ID=ALL             14524400
.*  0001 0000       10           16                  TU                 14524600
.*  0000 0010        2            2                  MIC                14524800
.*  0000 0100        4            4                  ERRET              14525000
.*  0000 0001        1            1                  CANCEL             14525200
.* -------------------------------------------------------------------- 14525400
         LA    1,&GNAME           GET ADDRESS OF PARAMETER LIST         14525600
.* -------------------------------------------------------------------- 14525800
.* ( IC1 )---FIRST WORD OF PARAMETER LIST HAS FLAG BYTE AND LEVEL# ---- 14526000
.* -------------------------------------------------------------------- 14526200
.IC1     ANOP                     INITIALIZE 1ST WORD                   14526400
         AIF   ('&ID' NE 'ALL').IC2     "ALL" SPECIFIED?                14526600
&SETID   SETC  '0'                GENERATE AD-CON OF ZERO               14526800
&A       SETC  '0'                GENERATE AD-CON OF ZERO               14527000
         AGO   .CALLIC                                                  14527200
.* -------------------------------------------------------------------- 14527400
.* ( IC2 )---SECOND WORD OF PARAMETER LIST IS ID ADDRESS -------------- 14527600
.* -------------------------------------------------------------------- 14527800
.IC2     ANOP                     INITIALIZE 2ND WORD                   14528000
         AIF   ('&ID'(1,1) NE '(').IC3   ADDR IN REG?                   14528200
         ST    &ID(1),4(,1)       STORE ID ADDRESS INTO LIST            14528400
&SETID   SETC  '0'                GENERATE AD-CON OF ZERO               14528600
.* -------------------------------------------------------------------- 14528800
.* ( IC3 )---THIRD WORD OF PARAMETER LIST IS THE INTERVAL ADDRESS------ 14529000
.* -------------------------------------------------------------------- 14529200
.IC3     ANOP                     INITIALIZE 3RD WORD                   14529400
         AIF  (&UNITS NE 0).IC3R  INTERVAL SPECIFIED?              @P3A 14529500
&A       SETC  '0'                NO! GENERATE AD-CON OF ZERO      @P3A 14529600
         AGO   .CALLIC            GO ISSUE SUPERVISOR CALL         @P3A 14529700
.IC3R    ANOP                                                      @P3A 14529800
         AIF   ('&A'(1,1) NE '(').CALLIC  ADDR IN REG?                  14529900
         ST    &A,8(,1)           STORE INTERVAL ADDRESS INTO LIST      14530000
&A       SETC  '0'                GENERATE AD-CON OF ZERO               14530100
.* -------------------------------------------------------------------- 14530200
.* ( CALLIC ) ISSUE SUPERVISOR CALL TO TTIMER/STIMERM SERVICE---------- 14530400
.* -------------------------------------------------------------------- 14530600
.CALLIC  ANOP                                                           14530800
         LR    0,1                LOAD GPR 0 WITH ADDR OF LIST          14531000
         LA    1,8                LOAD OPTION BYTE INTO GPR 1           14531200
         B     &GLNAME            BRANCH AROUND PARAMETER LIST          14531400
&GNAME   DS    0A                 16 BYTE "TEST/CANCEL" PARAMETER LIST  14531600
         DC    B'&FLAGS',AL3(1)   FLAG BYTE & LVL#                      14531800
         DC    A(&SETID)          ADDRESS OF STORAGE FOR ID             14532000
         DC    A(&A)              ADDRESS OF STORAGE FOR INTERVAL       14532200
         DC    A(0)               RESERVED                              14532400
&GLNAME  SVC   46                 SVC FOR TTIMER/STIMERM TEST/CANCEL    14532600
         AIF   ('&ERRET' EQ '').ICANEND          ERROR ROUTINE?         14532800
         LTR   15,15              CHECK RETURN CODE FROM SERVICE RTN    14533000
         AIF   ('&ERRET'(1,1) EQ '(').ICANBCR    ERRET IN REGISTER?     14533200
         BNZ   &ERRET             BRANCH TO ERRET IF NON-ZERO           14533400
         AGO   .ICANEND                                                 14533600
.ICANBCR BNZR  &ERRET(1)          BRANCH TO ERRET IF NON-ZERO           14533800
.ICANEND MEXIT                                                          14534000
.**************************************************************         14534200
.**                                                          **         14534400
.**    EXECUTE FORM SECTION                                  **         14534600
.**                                                          **         14534800
.**************************************************************         14535000
.EROUT   ANOP                                                           14535200
.* --------------------------------EXECUTE-FORM------------------------ 14535400
.* --------------------------------STIMERM SET------------------------- 14535600
.* -------------------------------------------------------------------- 14535800
.ESET    ANOP                                                           14536000
         AIF   ('&MF(2)' EQ '(1)').ES0  REGISTER 1 IS PTR TO LIST?      14536200
         AIF   ('&MF'(4,1) EQ '(').LRES0 ADDR IN REG?                   14536400
         LA    1,&MF(2)           LA LIST ADDRESS                       14536600
         AGO   .ES0                                                     14536800
.LRES0   ANOP                                                           14537000
         LR    1,&MF(2)           LR LIST ADDRESS                       14537200
.ES0     ANOP                                                           14537400
         XC    0(&LENGTH1,1),0(1) CLEAR LIST TO ZEROES                  14537600
.* -------------------------------------------------------------------- 14537800
.* -------------------------------------------------------------------- 14538000
.* -------------------------------------------------------------------- 14538200
.* "SET" OPTION FLAG BITS:                                              14538400
.*  BIT NUMBER   HEXADECIMAL   DECIMAL   LOCAL BIT   DESCRIPTION        14550000
.*  0123 4567                                                           14600000
.*  0000 0000       00            0                  TUINTVL            14650000
.*  0001 0000       10           16                  BINTVL             14700000
.*  0010 0000       20           32                  MICVL              14750000
.*  0011 0000       30           48                  DINTVL             14800000
.*  0110 0000       60           96                  GMT                14850000
.*  0111 0000       70          112                  TOD                14900000
.*  0000 1000       08            8                  ERRET              14950000
.*  0000 0001       01            1                  WAIT=YES           15000000
.*  0000 0011       03            3                  WAIT=NO            15050000
.* -------------------------------------------------------------------- 15100000
.* -------------------------------------------------------------------- 15600000
.* ( ES1 )---FIRST WORD OF PARAMETER LIST HAS FLAG BYTE AND LEVEL# ---- 29550000
.* -------------------------------------------------------------------- 29600000
.ES1     ANOP                     INITIALIZE 1ST WORD                   29650000
         MVI   0(1),B'&FLAGS'     SET FLAG BYTE                         29700000
         MVI   3(1),&LVL          INITIALIZE LVL# IN PARAMETER LIST     29750000
.* -------------------------------------------------------------------- 29800000
.* ( ES2 )---SECOND WORD OF PARAMETER LIST IS ID ADDRESS -------------- 29850000
.* -------------------------------------------------------------------- 29900000
.ES2     ANOP                     INITIALIZE 2ND WORD                   29950000
         AIF   ('&ID' EQ '').ES3         UNSPECIFIED?                   30000000
         AIF   ('&ID'(1,1) EQ '(').LRES2 ADDR IN REG?                   30050000
         LA    15,&ID             GET ID ADDRESS                        30100000
         ST    15,4(,1)           STORE ID ADDRESS INTO LIST            30350000
         AGO   .ES3                                                     30362500
.LRES2   ANOP                                                           30375000
         ST    &ID(1),4(,1)       STORE ID ADDRESS INTO LIST            30387500
.* -------------------------------------------------------------------- 30400000
.* ( ES3 )---THIRD WORD OF PARAMETER LIST IS THE INTERVAL ADDRESS------ 30450000
.* -------------------------------------------------------------------- 30500000
.ES3     ANOP                     INITIALIZE 3RD WORD                   30550000
         AIF   ('&A' EQ '').ES4          UNSPECIFIED?                   30600000
         AIF   ('&A'(1,1) EQ '(').LRES3  ADDR IN REG?                   30650000
         LA    15,&A              GET INTERVAL ADDRESS                  30700000
         ST    15,8(,1)           STORE INTERVAL ADDRESS INTO LIST      30950000
         AGO   .ES4                                                     30962500
.LRES3   ANOP                                                           30975000
         ST    &A,8(,1)           STORE INTERVAL ADDRESS INTO LIST      30987500
.* -------------------------------------------------------------------- 31000000
.* ( ES4 )---FOURTH WORD OF PARAMETER LIST IS EXIT ROUTINE ADDRESS----- 31050000
.* -------------------------------------------------------------------- 31100000
.ES4     ANOP                     INITIALIZE 4TH WORD                   31150000
         AIF   ('&EXIT' EQ '').ES5 EXIT ROUTINE SPECIFIED?              31200000
         AIF   ('&EXIT'(1,1) EQ '(').LRES4   ADDR IN REG?               31250000
         LA    15,&EXIT           GET EXIT ADDRESS                      31300000
         ST    15,12(,1)          STORE EXIT ROUTINE ADDRESS INTO LIST  31550000
         AGO   .ES5                                                     31562500
.LRES4   ANOP                                                           31575000
         ST    &EXIT(1),12(,1)    STORE EXIT ROUTINE ADDRESS INTO LIST  31587500
.* -------------------------------------------------------------------- 31600000
.* ( ES5 )---FIFTH WORD OF PARAMETER LIST IS THE USER PARAMETER-------- 31650000
.* -------------------------------------------------------------------- 31700000
.ES5     ANOP                     INITIALIZE 5TH WORD                   31750000
         AIF   ('&PARM' EQ '').CALLES   USER PARM SPECIFIED?            31800000
         AIF   ('&PARM'(1,1) EQ '(').MVCES5  ADDRESS IS REGISTER?       31850000
         LA    15,&PARM           GET PARM ADDRESS                      31900000
         MVC   16(4,1),0(15)      MOVE USER PARAMETER INTO LIST         32150000
         AGO   .CALLES                                                  32162500
.MVCES5  ANOP                                                           32175000
         MVC   16(4,1),0&PARM     MOVE USER PARAMETER INTO LIST         32187500
.* -------------------------------------------------------------------- 32200000
.* ( CALLES ) ISSUE THE SUPERVISOR CALL-------------------------------- 32250000
.* -------------------------------------------------------------------- 32300000
.CALLES  ANOP                                                           32350000
         LA    0,4                LOAD OPTION BYTE INTO GPR 0           32400000
         SLL   0,24               SHIFT OPTION TO HIGH BYTE (BIT 5 ON)  32450000
         SVC   47                 ISSUE STIMER/STIMERM SET SVC          32500000
         AIF   ('&ERRET' EQ '').ESETEND          ERROR ROUTINE?         32550000
         LTR   15,15              CHECK RETURN CODE FROM SERVICE RTN    32600000
         AIF   ('&ERRET'(1,1) EQ '(').BCRES      ERRET IN REGISTER?     32650000
         BNZ   &ERRET             BRANCH TO ERRET IF NON-ZERO           32700000
         AGO   .ESETEND                                                 32750000
.BCRES   BCR   7,&ERRET(1)        BRANCH TO ERRET IF NON-ZERO           32800000
.ESETEND MEXIT                                                          32850000
.* --------------------------------EXECUTE-FORM------------------------ 33000000
.* --------------------------------STIMERM TEST------------------------ 33050000
.* -------------------------------------------------------------------- 33100000
.ETES    ANOP                                                           33150000
.* -------------------------------------------------------------------- 33200000
.* -------------------------------------------------------------------- 33300000
.* -------------------------------------------------------------------- 33750000
.* "TEST" OPTION FLAG BITS:                                             33800000
.*  BIT NUMBER   HEXADECIMAL   DECIMAL   LOCAL BIT   DESCRIPTION        33850000
.*  0123 4567                                                           33900000
.*  0001 0000       10           16                  TU                 33950000
.*  0000 0010        2            2                  MIC                34000000
.*  0000 0100        4            4                  ERRET              34050000
.* -------------------------------------------------------------------- 34100000
         AIF   ('&MF'(4,1) EQ '(').LRET0 ADDR IN REG?                   34350000
         LA    1,&MF(2)           LA LIST ADDRESS                       34400000
         AGO   .ET1                                                     34450000
.LRET0   ANOP                                                           34500000
         LR    1,&MF(2)           LR LIST ADDRESS                       34550000
.* -------------------------------------------------------------------- 34600000
.* ( ET1 )---FIRST WORD OF PARAMETER LIST HAS FLAG BYTE AND LEVEL# ---- 34650000
.* -------------------------------------------------------------------- 34700000
.ET1     ANOP                     INITIALIZE 1ST WORD                   34750000
         XC    0(&LENGTH2,1),0(1) CLEAR LIST TO ZEROES                  34775000
         MVI   0(1),B'&FLAGS'     SET FLAG BYTE                         34800000
         MVI   3(1),&LVL          INITIALIZE LVL# IN PARAMETER LIST     34850000
.* -------------------------------------------------------------------- 34900000
.* ( ET2 )---SECOND WORD OF PARAMETER LIST IS ID ADDRESS -------------- 34950000
.* -------------------------------------------------------------------- 35000000
.ET2     ANOP                     INITIALIZE 2ND WORD                   35050000
         AIF   ('&ID' EQ '').ET3         UNSPECIFIED?                   35100000
         AIF   ('&ID'(1,1) EQ '(').LRET2 ADDR IN REG?                   35150000
         LA    15,&ID             GET ID ADDRESS                        35200000
         ST    15,4(,1)           STORE ID ADDRESS INTO LIST            35450000
         AGO   .ET3                                                     35462500
.LRET2   ANOP                                                           35475000
         ST    &ID(1),4(,1)       STORE ID ADDRESS INTO LIST            35487500
.* -------------------------------------------------------------------- 35500000
.* ( ET3 )---THIRD WORD OF PARAMETER LIST IS THE INTERVAL ADDRESS------ 35550000
.* -------------------------------------------------------------------- 35600000
.ET3     ANOP                     INITIALIZE 3RD WORD                   35650000
         AIF   ('&A' EQ '').CALLET       UNSPECIFIED?                   35700000
         AIF   ('&A'(1,1) EQ '(').LRET3  ADDR IN REG?                   35750000
         LA    15,&A              GET INTERVAL ADDRESS                  35800000
         ST    15,8(,1)           STORE INTERVAL ADDRESS INTO LIST      36050000
         AGO   .CALLET                                                  36062500
.LRET3   ANOP                                                           36075000
         ST    &A,8(,1)           STORE INTERVAL ADDRESS INTO LIST      36087500
.* -------------------------------------------------------------------- 36100000
.* ( CALLET ) ISSUE THE SUPERVISOR CALL-------------------------------- 36150000
.* -------------------------------------------------------------------- 36200000
.CALLET  ANOP                                                           36250000
         AIF   ('&MF(2)' EQ '(0)').LAETC  REGISTER 0 IS PTR TO LIST?    36300000
         LR    0,1                LOAD GPR 0 WITH ADDR OF LIST          36350000
.LAETC   ANOP                                                           36400000
         LA    1,8                LOAD OPTION BYTE INTO GPR 1           36450000
         SVC   46                 SVC FOR TTIMER/STIMERM TEST/CANCEL    36550000
         AIF   ('&ERRET' EQ '').ETESEND          ERROR ROUTINE?         36600000
         LTR   15,15              CHECK RETURN CODE FROM SERVICE RTN    36650000
         AIF   ('&ERRET'(1,1) EQ '(').BCRET      ERRET IN REGISTER?     36700000
         BNZ   &ERRET             BRANCH TO ERRET IF NON-ZERO           36750000
         AGO   .ETESEND                                                 36800000
.BCRET   BCR   7,&ERRET(1)        BRANCH TO ERRET IF NON-ZERO           36850000
.ETESEND MEXIT                                                          36900000
.* --------------------------------EXECUTE-FORM------------------------ 37050000
.* --------------------------------STIMERM CANCEL---------------------- 37100000
.* -------------------------------------------------------------------- 37150000
.ECAN    ANOP                                                           37200000
.* -------------------------------------------------------------------- 37250000
.* -------------------------------------------------------------------- 37350000
.* -------------------------------------------------------------------- 37700000
.* "CANCEL" OPTION FLAG BITS:                                           37750000
.*  BIT NUMBER   HEXADECIMAL   DECIMAL   LOCAL BIT   DESCRIPTION        37800000
.*  0123 4567                                                           37850000
.*  0000 1000       08            8                  ID=ALL             37900000
.*  0001 0000       10           16                  TU                 37950000
.*  0000 0010        2            2                  MIC                38000000
.*  0000 0100        4            4                  ERRET              38050000
.*  0000 0001        1            1                  CANCEL             38100000
.* -------------------------------------------------------------------- 38150000
         AIF   ('&MF'(4,1) EQ '(').LREC0 ADDR IN REG?                   38400000
         LA    1,&MF(2)           LA LIST ADDRESS                       38450000
         AGO   .EC1                                                     38500000
.LREC0   ANOP                                                           38550000
         LR    1,&MF(2)           LR LIST ADDRESS                       38600000
.* -------------------------------------------------------------------- 38650000
.* ( EC1 )---FIRST WORD OF PARAMETER LIST HAS FLAG BYTE AND LEVEL# ---- 38700000
.* -------------------------------------------------------------------- 38750000
.EC1     ANOP                     INITIALIZE 1ST WORD                   38800000
         XC    0(&LENGTH2,1),0(1) CLEAR LIST TO ZEROES                  38825000
         MVI   0(1),B'&FLAGS'     SET FLAG BYTE                         38850000
         MVI   3(1),&LVL          INITIALIZE LVL# IN PARAMETER LIST     38900000
         AIF   ('&ID' EQ 'ALL').CALLEC  FOR "ALL" SKIP ID/INTERVAL PROC 38950000
.* -------------------------------------------------------------------- 39150000
.* ( EC2 )---SECOND WORD OF PARAMETER LIST IS ID ADDRESS -------------- 39200000
.* -------------------------------------------------------------------- 39250000
.EC2     ANOP                     INITIALIZE 2ND WORD                   39300000
         AIF   ('&ID' EQ '').EC3        UNSPECIFIED?                    39350000
         AIF   ('&ID'(1,1) EQ '(').LREC2 ADDR IN REG?                   39400000
         LA    15,&ID             GET ID ADDRESS                        39450000
         ST    15,4(,1)           STORE ID ADDRESS INTO LIST            39700000
         AGO   .EC3                                                     39712500
.LREC2   ANOP                                                           39725000
         ST    &ID,4(,1)          STORE ID ADDRESS INTO LIST            39737500
.* -------------------------------------------------------------------- 39750000
.* ( EC3 )---THIRD WORD OF PARAMETER LIST IS THE INTERVAL ADDRESS------ 39800000
.* -------------------------------------------------------------------- 39850000
.EC3     ANOP                     INITIALIZE 3RD WORD                   39900000
         AIF   ('&A' EQ '').CALLEC       UNSPECIFIED?                   39950000
         AIF   ('&A'(1,1) EQ '(').LREC3  ADDR IN REG?                   40000000
         LA    15,&A              GET INTERVAL ADDRESS                  40050000
         ST    15,8(,1)           STORE INTERVAL ADDRESS INTO LIST      40300000
         AGO   .CALLEC                                                  40312500
.LREC3   ANOP                                                           40325000
         ST    &A,8(,1)           STORE INTERVAL ADDRESS INTO LIST      40337500
.* -------------------------------------------------------------------- 40350000
.* ( CALLEC ) ISSUE THE SUPERVISOR CALL-------------------------------- 40400000
.* -------------------------------------------------------------------- 40450000
.CALLEC  ANOP                                                           40500000
         AIF   ('&MF(2)' EQ '(0)').LAECC  REGISTER 0 IS PTR TO LIST?    40550000
         LR    0,1                LOAD GPR 0 WITH ADDR OF LIST          40600000
.LAECC   ANOP                                                           40650000
         LA    1,8                LOAD OPTION BYTE INTO GPR 1           40700000
         SVC   46                 SVC FOR TTIMER/STIMERM TEST/CANCEL    40800000
         AIF   ('&ERRET' EQ '').ECANEND          ERROR ROUTINE?         40850000
         LTR   15,15              CHECK RETURN CODE FROM SERVICE RTN    40900000
         AIF   ('&ERRET'(1,1) EQ '(').BCREC      ERRET IN REGISTER?     40950000
         BNZ   &ERRET             BRANCH TO ERRET IF NON-ZERO           41000000
         AGO   .ECANEND                                                 41050000
.BCREC   BCR   7,&ERRET(1)        BRANCH TO ERRET IF NON-ZERO           41100000
.ECANEND MEXIT                                                          41150000
         MEND                                                           53750000
