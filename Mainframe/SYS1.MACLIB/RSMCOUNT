*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  RSMCOUNT                              -87/09/11-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  RSM Frame Counter Service                     * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5647-A01 (C) COPYRIGHT IBM CORP. 1988, 2000                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7703                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*01* EXTERNAL CLASSIFICATION:  NONE                                   * 00002100
*                                                                     * 00002200
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002300
*                                                                     * 00002400
*02*   OPERATION:                                                     * 00002500
*                                                                     * 00002600
*01* EXTERNAL CLASSIFICATION:  NONE                                   * 00002700
*                                                                     * 00002800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002900
*                                                                     * 00003000
*                                                                     * 00003100
*he RSMCOUNT macro performs syntax checking to validate the user      * 00003200
*pecified request. If an error is detected, macro phase error         * 00003300
*essages are issued and a macro phase return code of 8 is set.        * 00003400
*                                                                     * 00003500
*he parameter list is defined.                                        * 00003600
*                                                                     * 00003700
*he parameter list is initialized and the code is generated to call   * 00003800
*he RSM Frame Counter Service.                                        * 00003900
*                                                                     * 00004000
*01* ENVIRONMENT:                                                     * 00004100
*                                                                     * 00004200
*                                                                     * 00004300
*      Dispatchable unit mode: Task or SRB mode.                      * 00004400
*                                                                     * 00004500
*      Minimum authorization: Supervisor state.  Zero PSW key.        * 00004600
*                                                                     * 00004700
*      AMODE:            31-bit.                                      * 00004800
*                                                                     * 00004900
*      ASC mode:         Primary.                                     * 00005000
*                                                                     * 00005100
*      Serialization:    Enabled.  No locks that would prevent RSM    * 00005200
*                        from obtaining the RSM lock.                 * 00005300
*                                                                     * 00005400
*      Restrictions:     The caller's parameter list must reside in   * 00005500
*                        fixed storage.                               * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*01* SYNTAX:                                                          * 00006000
*                                                                     * 00006100
*[xlabel]  RSMCOUNT     DIVREAL=xdivreal                              * 00006200
*                      ,DIVEXPANDED=xdivexpanded                      * 00006300
*                      ,ASID=xasid                                    * 00006400
*                     [,RETCODE=xretcode]                             * 00006500
*                     [,COM=xcom|NULL]                              * 00006600
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00006700
*                    [,MF=S]                                         * 00006800
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00006900
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*      Where:                                                         * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*      [xlabel]                                                       * 00007600
*          is an optional symbol, starting in column 1, that is the   * 00007700
*          name on the RSMCOUNT macro invocation.  The name must      * 00007800
*          conform to the rules for an ordinary assembler language    * 00007900
*          symbol.                                                    * 00008000
*          DEFAULT: No name.                                          * 00008100
*                                                                     * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*      DIVREAL=xdivreal                                               * 00008600
*          is the name (RS-type), or address in register (2)-(12), of * 00008700
*          a required fullword output variable that is to contain the * 00008800
*          number of pages in real storage that have been mapped      * 00008900
*          using the DIV MAP service.                                 * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*      DIVEXPANDED=xdivexpanded                                       * 00009500
*          is the name (RS-type), or address in register (2)-(12), of * 00009600
*          a required fullword output variable that is to contain the * 00009700
*          number of pages on expanded storage that have been mapped  * 00009800
*          using the DIV MAP service.                                 * 00009900
*                                                                     * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*      ASID=xasid                                                     * 00010400
*          is the name (RS-type), or address in register (2)-(12), of * 00010500
*          a required halfword input variable that must contain the   * 00010600
*          ASID of the address space for which the counts are to be   * 00010700
*          obtained.                                                  * 00010800
*                                                                     * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*      [RETCODE=xretcode]                                             * 00011300
*          is the name (RS-type) of an optional fullword output       * 00011400
*          variable, or register (2)-(12), into which the return code * 00011500
*          is to be copied from GPR 15.                               * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*      [COM=xcom|NULL]                                              * 00012100
*          is an optional character input  that will appear in the    * 00012200
*          block comment before the macro invocation echo. It can be  * 00012300
*          used to comment the macro invocation.  The comment string  * 00012400
*          must be enclosed in quotes if it contains any lower case   * 00012500
*          characters.                                                * 00012600
*          DEFAULT: NULL                                              * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00013200
*          is an optional byte input decimal value in the "0-0" range * 00013300
*          that specifies the macro version.  PLISTVER is the only    * 00013400
*          key allowed on the list form of MF and determines which    * 00013500
*          parameter list is generated.  Note that MAX may be         * 00013600
*          specified instead of a number, and the parameter list will * 00013700
*          be of the largest size currently supported. This size may  * 00013800
*          grow from release to release (thus possibly affecting the  * 00013900
*          amount of storage needed by your program).  If your        * 00014000
*          program can tolerate this, IBM recommends that you always  * 00014100
*          specify MAX when creating the list form parameter list as  * 00014200
*          that will ensure that the list form parameter list is      * 00014300
*          always long enough to hold whatever parameters might be    * 00014400
*          specified on the execute form.                             * 00014500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00014600
*          default is the lowest version which allows all of the      * 00014700
*          parameters specified on the invocation to be processed.    * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*      [MF=S|L|E]                                                   * 00015300
*          is an optional keyword input which specifies the macro     * 00015400
*          form.                                                      * 00015500
*          DEFAULT: S                                                 * 00015600
*                                                                     * 00015700
*                                                                     * 00015800
*          [MF=S]                                                     * 00015900
*              specifies the standard form of the macro.  The "S"     * 00016000
*              form generates code to put the parameters into an      * 00016100
*              in-line parameter list and invoke the desired service. * 00016200
*              Full checking for required macro keys is done along    * 00016300
*              with supplying defaults for omitted optional           * 00016400
*              parameters.                                            * 00016500
*                                                                     * 00016600
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00016700
*              specifies the list form of the macro.  The "L" form    * 00016800
*              defines an area to be used for the parameter list.     * 00016900
*              Only the PLISTVER key may be specified on the          * 00017000
*              invocation.  All other macro parameters are flagged as * 00017100
*              errors.  If PLISTVER is not specified, the original    * 00017200
*              parameter list definition is used.                     * 00017300
*                                                                     * 00017400
*            ,xmfctrl                                                 * 00017500
*              is a required input.  It is the name of a storage area * 00017600
*              for the parameter list.                                * 00017700
*                                                                     * 00017800
*            ,xmfattr|0D                                            * 00017900
*              is an optional 60 character input string that varies   * 00018000
*              from 1 to 60 characters. Use it to force boundary      * 00018100
*              alignment of the parameter list. Use only 0F or 0D.    * 00018200
*              DEFAULT: 0D which forces the parameter list to a       * 00018300
*              doubleword boundary.                                   * 00018400
*                                                                     * 00018500
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00018600
*              specifies the execute form of the macro.  The "E" form * 00018700
*              generates code to put the parameters into the          * 00018800
*              parameter list specified by xmfctrl and provides full  * 00018900
*              syntax checking with default setting.                  * 00019000
*                                                                     * 00019100
*            ,xmfctrl                                                 * 00019200
*              is a required input.  It is the name (RS-type), or     * 00019300
*              address in register (1)-(12), of a storage area for    * 00019400
*              the parameter list.                                    * 00019500
*                                                                     * 00019600
*            ,COMPLETE                                              * 00019700
*              is an optional keyword input which specifies the       * 00019800
*              degree of macro parameter syntax checking.             * 00019900
*              DEFAULT: COMPLETE                                      * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*              COMPLETE                                               * 00020300
*                  Checking for required macro keys is done and       * 00020400
*                  defaults are supplied for omitted optional         * 00020500
*                  parameters.                                        * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*01* RETURN CODES:                                                    * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*            00   Successful completion                               * 00021700
*                                                                     * 00021800
*            04   The input ASID represented a swapped out address    * 00021900
*                 space. Only the DIVEXPANDED count is returned.      * 00022000
*                                                                     * 00022100
*            08   The input ASID represented an address space that    * 00022200
*                 owns no DIV MAPped pages.                           * 00022300
*                                                                     * 00022400
*            0C   The input ASID represented a non-existent address   * 00022500
*                 space or an address space that was not fully        * 00022600
*                 initialized.                                        * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*01* REASON CODES:  None.                                             * 00023100
*                                                                     * 00023200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00023300
*                                                                     * 00023400
*02*   PROCESSOR:  ASSEM                                              * 00023500
*                                                                     * 00023600
*01* COMPONENT:  SC1CR                                                * 00023700
*                                                                     * 00023800
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00023900
*                                                                     * 00024000
*01* MACRO USAGE NOTES:                                               * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00024400
*        global macro variable.  Any value other than 'NO' will       * 00024500
*        result in the macro expansion being printed.  The default is * 00024600
*        'YES'.  The following examples illustrate how the ZPRINT     * 00024700
*        variable should be set.                                      * 00024800
*                                                                     * 00024900
*                    GBLC &ZPRINT                                     * 00025000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*    2.  All   keys   currently   contained  in  the  RSMCOUNT  macro * 00025400
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00025500
*        value of 0 or MAX.                                           * 00025600
*                                                                     * 00025700
*        None                                                         * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*01* CHANGE ACTIVITY:                                                 * 00026200
*                                                                     * 00026300
*   Flag LineItem  FMID    Date   ID    Comment                       * 00026400
*                                                                     * 00026500
*    $L0=DATASPAC HBB3310 091187 PD29:  Data Space Support.           * 00026600
****** END OF SPECIFICATIONS *****************************************/ 00026700
*/* TLINE 1 *********************************************************** 00026800
         MACRO                                                          00026900
&XLABEL  RSMCOUNT &DIVREAL=,&DIVEXPANDED=,&ASID=,&RETCODE=,&COM=,      *00027000
               &PLISTVER=,&MF=                                          00027100
.*                                                                      00027200
*                 MACDATE -87/09/11-<0>                                 00027300
.*                                                                      00027400
.*******************************************************************    00027500
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00027600
.*******************************************************************    00027700
                 GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                00027800
                 GBLC  &ZTEST      YES=TEST NO=NO TEST                  00027900
                 GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX          00028000
.*                                                                      00028100
                 GBLC  &ZRSMCOUNT  YES=MACRO USED AT LEAST ONCE         00028200
.*******************************************************************    00028300
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00028400
.*******************************************************************    00028500
                 LCLC  &ZMS        ERROR MESSAGE WORK AREA              00028600
                 LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS         00028700
                 LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED           00028800
                 LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR          00028900
                 LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE          00029000
                 LCLA  &ZAWRK      USED AS A WORK AREA                  00029100
                 LCLA  &ZASIZ      USED FOR SIZE OF VALUE               00029200
                 LCLA  &ZN         NUMERIC WORK VARIABLE                00029300
                 LCLC  &ZC         CHARACTER WORK VARIABLE              00029400
                 LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE          00029500
                 LCLA  &ZTLA       VALUE TOO LONG VARIABLE              00029600
                 LCLA  &ZMACRET    MACRO RETURN CODE                    00029700
&ZMACRET         SETA  0           ASSUME NO ERRORS                     00029800
.*                                                                      00029900
                 LCLC  &ZCSYSLIST(255)          NONXKEY, POS ARRAY      00030000
                 LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()           00030100
                 LCLA  &ZPLLEN     PARAMETER LIST LENGTH                00030200
                 LCLC  &ZENDBASEPL              End of base PL          00030300
                 LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                00030400
.*******************************************************************    00030500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00030600
.*******************************************************************    00030700
                 LCLA  &ZI         INDEX FOR ARRAY                      00030800
                 LCLA  &ZJ         INDEX FOR PARMS                      00030900
                 LCLA  &ZK         INDEX FOR PARSE                      00031000
                 LCLA  &ZLO        LOW RANGE VALUE                      00031100
                 LCLA  &ZHI        HIGH RANGE VALUE                     00031200
                 LCLC  &ZW         WORK AREA FOR PARM                   00031300
.********************************************************************   00031400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00031500
.********************************************************************   00031600
                 GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL              00031700
                 GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE       00031800
                 GBLA  &SYSALVL    SYSSTATE ARCHLVL                     00031900
.*                                                                      00032000
                 AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED       00032100
                 AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED        00032200
                 SPLEVEL  TEST                                          00032300
.ZSYS2           ANOP  ,                                                00032400
                 AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1            00032500
                 AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1            00032600
                 SYSSTATE TEST                                          00032700
                 AGO   .ZSYS4                                           00032800
.ZSYS3           ANOP  ,                                                00032900
&SYSASCE         SETC  'P'         ASSUME SYSSTATE PRIMARY              00033000
.ZSYS4           ANOP  ,                                                00033100
.*******************************************************************    00033200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00033300
.*******************************************************************    00033400
                 LCLC  &XDIVREAL   ++ NAME                              00033500
                 LCLC  &XDIVEXPANDED            ++ NAME                 00033600
                 LCLC  &XASID      ++ NAME                              00033700
                 LCLC  &XRETCODE   ++ NAME                              00033800
                 LCLC  &XCOM       ++ VALUE                             00033900
                 LCLA  &XPLISTVER  ++ VALUE                             00034000
                 LCLC  &XMF        ++ VALUE                             00034100
                 LCLC  &XMFCTRL    ++ NAME                              00034200
                 LCLC  &XMFATTR    ++ VALUE                             00034300
                 LCLC  &XMFSCK     ++ VALUE                             00034400
.*******************************************************************    00034500
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00034600
.*******************************************************************    00034700
                 LCLC  &ZXDIVREAL  ++ OUTPUT NAME                       00034800
                 LCLC  &ZXDIVEXPANDED           ++ OUTPUT NAME          00034900
                 LCLC  &ZXASID     ++ INPUT NAME                        00035000
                 LCLC  &ZXRETCODE  ++ OUTPUT NAME                       00035100
                 LCLC  &ZXCOM      ++ INPUT VALUE                       00035200
                 LCLC  &ZXPLISTVER              ++ INPUT VALUE          00035300
                 LCLC  &ZXMF       ++ INPUT VALUE                       00035400
                 LCLC  &ZXMFCTRL   ++ INPUT NAME                        00035500
                 LCLC  &ZXMFATTR   ++ INPUT VALUE                       00035600
                 LCLC  &ZXMFSCK    ++ INPUT VALUE                       00035700
.********************************************************************   00035800
.***AC.PLV01  PROCESS PLISTVER                                      *   00035900
.********************************************************************   00036000
&XPLISTVER      SETA  0                                                 00036100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00036200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00036300
&XPLISTVER      SETA  0                                                 00036400
.ZPLV0          ANOP  ,                                                 00036500
.*                                                                      00036600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00036700
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00036800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00036900
.*-------------------------------------------------------------------   00037000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00037100
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00037200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00037300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00037400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00037500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00037600
                AGO   .ZPVCK2                                           00037700
.ZPVCK3         ANOP  ,                                                 00037800
.*-------------------------------------------------------------------   00037900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00038000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00038100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00038200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00038300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00038400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00038500
                AGO   .ZPVCKE                                           00038600
.ZPVCK2         ANOP  ,                                                 00038700
.*-------------------------------------------------------------------   00038800
&ZCVAL          SETC  '&PLISTVER(1)'                                    00038900
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00039000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00039100
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00039200
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00039300
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00039400
.ZPVCK6         ANOP  ,                                                 00039500
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00039600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00039700
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00039800
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00039900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00040000
&XPLISTVER      SETA  0                                                 00040100
                AGO   .ZPVCKE                                           00040200
.*-------------------------------------------------------------------   00040300
.ZPVCK4A        ANOP  ,                                                 00040400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00040500
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00040600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00040700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00040800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00040900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00041000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00041100
                AGO   .ZPVCK5                                           00041200
.ZPVCK4         ANOP  ,                                                 00041300
&XPLISTVER      SETA  &PLISTVER(1)                                      00041400
.ZPVCK5         ANOP  ,                                                 00041500
.ZPVCKE         ANOP  ,                                                 00041600
.********************************************************************   00041700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00041800
.********************************************************************   00041900
                 ACTR  10000                                            00042000
.*------------------------------------------------------------------    00042100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00042200
&XMF             SETC  ''          INITIALIZE XVARIABLE                 00042300
.*-------------------------------------------------------------------   00042400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00042500
.ZG21            ANOP  ,                                                00042600
&ZTLC            SETC 'S'                                               00042700
                 AIF   ('&MF(1)' NE '&ZTLC').ZG22                       00042800
&XMF             SETC  'S'         SET KEYWORD                          00042900
                 AIF   (N'&MF LE 1).ZG21A       CK NUM                  00043000
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00043100
&ZMS             SETC  '&ZMS.&MF"'                                      00043200
&ZMS             SETC  '&ZMS "MF"'                                      00043300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00043400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00043500
.ZG21A           ANOP  ,                                                00043600
.*-------------------------------------------------------------------   00043700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00043800
.ZG22            ANOP  ,                                                00043900
&ZTLC            SETC 'L'                                               00044000
                 AIF   ('&MF(1)' NE '&ZTLC').ZG29                       00044100
&XMF             SETC  'L'         SET KEYWORD                          00044200
                 AIF   (N'&MF LE 3).ZG22A       CK NUM                  00044300
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00044400
&ZMS             SETC  '&ZMS.&MF"'                                      00044500
&ZMS             SETC  '&ZMS "MF"'                                      00044600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00044700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00044800
.ZG22A           ANOP  ,                                                00044900
.*-------------------------------------------------------------------   00045000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00045100
                 AIF   (N'&SYSLIST NE 0).ZG22B  POSITIONALS?            00045200
                 AIF   ('&DIVREAL' NE '').ZG22B  KEYS?                  00045300
                 AIF   ('&DIVEXPANDED' NE '').ZG22B  KEYS?              00045400
                 AIF   ('&ASID' NE '').ZG22B    KEYS?                   00045500
                 AIF   ('&RETCODE' NE '').ZG22B  KEYS?                  00045600
                 AIF   ('&COM' NE '').ZG22B     KEYS?                   00045700
                 AGO    .ZG22C     INVOCATION OKAY                      00045800
.ZG22B           ANOP  ,                                                00045900
&ZMS             SETC  'THE "L" FORM OF "MF"'   *MFLA* MNOTE            00046000
&ZMS             SETC  '&ZMS CAN ONLY HAVE'                             00046100
&ZMS             SETC  '&ZMS THE "PLISTVER" KEY'                        00046200
                 MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'           00046300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00046400
.ZG22C           ANOP  ,                                                00046500
.*-------------------------------------------------------------------   00046600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00046700
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00046800
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00046900
                 AIF   (N'&MF(2) GT 1).ZG24B    MULTI PARMS             00047000
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00047100
.ZG24B           AIF   (K'&MF(2) GT 0).ZG24C                            00047200
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00047300
&ZMS             SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*                 00047400
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00047500
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00047600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00047700
.ZG24C           ANOP  ,                                                00047800
.*-------------------------------------------------------------------   00047900
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00048000
                 AIF   (K'&ZXMFCTRL LE 0).ZG24P  NOT I/O                00048100
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG24P                   00048200
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00048300
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00048400
&ZMS             SETC  '&ZMS.&MF"'                                      00048500
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00048600
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                00048700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00048800
.ZG24P           ANOP  ,                                                00048900
.*-------------------------------------------------------------------   00049000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00049100
&ZXMFATTR        SETC  'INPUT'     SET IN/OUTPUT                        00049200
&XMFATTR         SETC  '0D'                                             00049300
                 AIF   (K'&MF(3) LE 0).ZG27B    PARM                    00049400
&XMFATTR         SETC  '&MF(3,1)'  SET XVARIABLE                        00049500
                 AIF   (N'&MF(3) GT 1).ZG27B    MULTI PARMS             00049600
&XMFATTR         SETC  '&MF(3)'    SET XVARIABLE                        00049700
.ZG27B           ANOP  ,                                                00049800
.*-------------------------------------------------------------------   00049900
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00050000
                 AIF   (K'&ZXMFATTR LE 0).ZG27P  NOT I/O                00050100
                 AIF   ('&XMFATTR'(1,1) NE '(').ZG27P                   00050200
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00050300
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00050400
&ZMS             SETC  '&ZMS.&MF"'                                      00050500
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00050600
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                00050700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00050800
.ZG27P           ANOP  ,                                                00050900
.*-------------------------------------------------------------------   00051000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00051100
                 AIF   (K'&ZXMFATTR LE 0).ZG27S  NOT I/O                00051200
                 AIF   (K'&XMFATTR LE 60).ZG27S  LNG OK                 00051300
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00051400
&ZMS             SETC  '"MF='      *KLNGA* MNOTE                        00051500
&ZMS             SETC  '&ZMS.&MF"'                                      00051600
&ZMS             SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'            00051700
                 MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'               00051800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00051900
.ZG27S           ANOP  ,                                                00052000
.*-------------------------------------------------------------------   00052100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00052200
.ZG29            ANOP  ,                                                00052300
&ZTLC            SETC 'E'                                               00052400
                 AIF   ('&MF(1)' NE '&ZTLC').ZG37                       00052500
&XMF             SETC  'E'         SET KEYWORD                          00052600
                 AIF   (N'&MF LE 3).ZG29A       CK NUM                  00052700
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00052800
&ZMS             SETC  '&ZMS.&MF"'                                      00052900
&ZMS             SETC  '&ZMS "MF"'                                      00053000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00053100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00053200
.ZG29A           ANOP  ,                                                00053300
.*-------------------------------------------------------------------   00053400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00053500
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00053600
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00053700
                 AIF   (N'&MF(2) GT 1).ZG31B    MULTI PARMS             00053800
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00053900
.ZG31B           AIF   (K'&MF(2) GT 0).ZG31C                            00054000
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00054100
&ZMS             SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*                 00054200
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00054300
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00054400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00054500
.ZG31C           ANOP  ,                                                00054600
.*-------------------------------------------------------------------   00054700
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00054800
                 AIF   (K'&ZXMFCTRL LE 0).ZG31R  NOT I/O                00054900
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG31R                   00055000
&ZCGPR           SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                       00055100
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                     00055200
                 AIF   (K'&ZCGPR GT 2).ZG31Q                            00055300
                 AIF   ('&ZCGPR' EQ '0').ZG31Q                          00055400
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00055500
                 AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME        00055600
.ZG31P           ANOP  ,                                                00055700
                 AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC             00055800
                 AIF   ('&ZCGPR' LT '1').ZG31Q                          00055900
                 AIF   ('&ZCGPR' LE '12').ZG31R                         00056000
.ZG31Q           ANOP  ,                                                00056100
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00056200
&ZMS             SETC  '&ZMS.&MF"'                                      00056300
&ZMS             SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'        00056400
                 MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                 00056500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00056600
.ZG31R           ANOP  ,                                                00056700
.*-------------------------------------------------------------------   00056800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00056900
&XMFSCK          SETC  ''          INITIALIZE XVARIABLE                 00057000
.ZG35A   AIF   ('&MF(3)' NE 'COMPLETE').ZG36A                           00057100
&XMFSCK          SETC  'COMPLETE'  SET KEYWORD                          00057200
.*-------------------------------------------------------------------   00057300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00057400
.ZG36A           AIF   (K'&XMFSCK GT 0).ZG36C   KEYWORD                 00057500
                 AIF   (K'&MF(3) LE 0).ZG36B                            00057600
&ZMS             SETC  '"MF='      *KUKWA* MNOTE                        00057700
&ZMS             SETC  '&ZMS.&MF"'                                      00057800
&ZMS             SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '        00057900
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00058000
&ZMS             SETC  '&ZMS "COMPLETE".'                               00058100
                 MNOTE 8,' &ZMS '                                       00058200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00058300
.ZG36B           ANOP  ,                                                00058400
&XMFSCK          SETC  'COMPLETE'  SET DEFAULT KEYWORD                  00058500
.ZG36C           ANOP  ,                                                00058600
&ZXMFSCK         SETC  'INPUT'     SET IN/OUTPUT                        00058700
.*------------------------------------------------------------------    00058800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00058900
.ZG37            ANOP  ,                                                00059000
&ZXMF            SETC  'INPUT'     SET IN/OUTPUT                        00059100
                 AIF   (K'&XMF GT 0).ZG37E      VALID ARG               00059200
                 AIF   (T'&MF EQ 'O').ZG37D     OMITTED                 00059300
&ZASYSLNDX       SETA  0                                                00059400
.ZG37A           ANOP  ,           POSITIONAL MACRO KEY                 00059500
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00059600
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG37C                 00059700
&ZTLC            SETC 'MF'                                              00059800
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG37A        00059900
.ZG37B           ANOP  ,                                                00060000
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00060100
&ZMS             SETC  'THE "MF" KEY'           *KOPTA* MNOTE           00060200
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00060300
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00060400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00060500
                 AGO   .ZG37E                                           00060600
.ZG37C           ANOP  ,                                                00060700
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00060800
&ZMS             SETC  '"MF='      *KUKWA* MNOTE                        00060900
&ZMS             SETC  '&ZMS.&MF"'                                      00061000
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00061100
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00061200
&ZMS             SETC  '&ZMS "S",'                                      00061300
&ZMS             SETC  '&ZMS "L",'                                      00061400
&ZMS             SETC  '&ZMS OR "E".'                                   00061500
                 MNOTE 8,' &ZMS '                                       00061600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00061700
                 AGO   .ZG37E                                           00061800
.ZG37D           ANOP  ,                                                00061900
&XMF             SETC  'S'         SET DEFAULT KEYWORD                  00062000
&XMFSCK          SETC  'COMPLETE'  COMPLETE CHECKING                    00062100
.ZG37E           ANOP  ,                                                00062200
.********************************************************************   00062300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00062400
.********************************************************************   00062500
                 ACTR  10000                                            00062600
.*-------------------------------------------------------------------   00062700
.***AG.MF03 MF=(SLE)                                                    00062800
                 AIF   ('&XMF' EQ 'L').ZGMFX                            00062900
.*----------------------------------------------------------------***   00063000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00063100
                 AIF   (N'&DIVREAL LE 1).ZG2A   CK NUM                  00063200
&ZMS             SETC  '"DIVREAL='              *KPOSA* MNOTE           00063300
&ZMS             SETC  '&ZMS.&DIVREAL"'                                 00063400
&ZMS             SETC  '&ZMS "DIVREAL"'                                 00063500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00063600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00063700
.ZG2A            ANOP  ,                                                00063800
.*-------------------------------------------------------------------   00063900
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00064000
&ZXDIVREAL       SETC  'OUTPUT'    SET IN/OUTPUT                        00064100
&XDIVREAL        SETC  '&DIVREAL(1)'            SET XVARIABLE           00064200
                 AIF   (N'&DIVREAL GT 1).ZG2B   MULTI PARMS             00064300
&XDIVREAL        SETC  '&DIVREAL'  SET XVARIABLE                        00064400
.ZG2B            AIF   (K'&DIVREAL(1) GT 0).ZG2C                        00064500
&ZXDIVREAL       SETC  ''          RESET IN/OUTPUT                      00064600
&ZMS             SETC  ' '         *KRQDA*                              00064700
&ZMS             SETC  '&ZMS "DIVREAL" KEY AND ITS'                     00064800
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00064900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00065000
.ZG2C            ANOP  ,                                                00065100
.*-------------------------------------------------------------------   00065200
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00065300
                 AIF   (K'&ZXDIVREAL LE 0).ZG2R  NOT I/O                00065400
                 AIF   ('&XDIVREAL'(1,1) NE '(').ZG2R                   00065500
&ZCGPR           SETC  '&XDIVREAL'(2,K'&XDIVREAL-2)                     00065600
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                      00065700
                 AIF   (K'&ZCGPR GT 2).ZG2Q                             00065800
                 AIF   ('&ZCGPR' EQ '0').ZG2Q                           00065900
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00066000
                 AIF   (T'&ZCGPR NE 'N').ZG2Q   INVALID REG NAME        00066100
.ZG2P            ANOP  ,                                                00066200
                 AIF   (T'&ZCGPR NE 'N').ZG2R   NON NUMERIC             00066300
                 AIF   ('&ZCGPR' LT '2').ZG2Q                           00066400
                 AIF   ('&ZCGPR' LE '12').ZG2R                          00066500
.ZG2Q            ANOP  ,                                                00066600
&ZMS             SETC  '"DIVREAL='              *KGPRA* MNOTE           00066700
&ZMS             SETC  '&ZMS.&DIVREAL"'                                 00066800
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00066900
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00067000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00067100
.ZG2R            ANOP  ,                                                00067200
.*----------------------------------------------------------------***   00067300
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00067400
                 AIF   (N'&DIVEXPANDED LE 1).ZG5A  CK NUM               00067500
&ZMS             SETC  '"DIVEXPANDED='          *KPOSA* MNOTE           00067600
&ZMS             SETC  '&ZMS.&DIVEXPANDED"'                             00067700
&ZMS             SETC  '&ZMS "DIVEXPANDED"'                             00067800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00067900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00068000
.ZG5A            ANOP  ,                                                00068100
.*-------------------------------------------------------------------   00068200
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00068300
&ZXDIVEXPANDED   SETC  'OUTPUT'    SET IN/OUTPUT                        00068400
&XDIVEXPANDED    SETC  '&DIVEXPANDED(1)'        SET XVARIABLE           00068500
                 AIF   (N'&DIVEXPANDED GT 1).ZG5B  MULTI PARMS          00068600
&XDIVEXPANDED    SETC  '&DIVEXPANDED'           SET XVARIABLE           00068700
.ZG5B            AIF   (K'&DIVEXPANDED(1) GT 0).ZG5C                    00068800
&ZXDIVEXPANDED   SETC  ''          RESET IN/OUTPUT                      00068900
&ZMS             SETC  ' '         *KRQDA*                              00069000
&ZMS             SETC  '&ZMS "DIVEXPANDED" KEY AND ITS'                 00069100
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00069200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00069300
.ZG5C            ANOP  ,                                                00069400
.*-------------------------------------------------------------------   00069500
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00069600
                 AIF   (K'&ZXDIVEXPANDED LE 0).ZG5R  NOT I/O            00069700
                 AIF   ('&XDIVEXPANDED'(1,1) NE '(').ZG5R               00069800
&ZCGPR           SETC  '&XDIVEXPANDED'(2,K'&XDIVEXPANDED-2)             00069900
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                      00070000
                 AIF   (K'&ZCGPR GT 2).ZG5Q                             00070100
                 AIF   ('&ZCGPR' EQ '0').ZG5Q                           00070200
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00070300
                 AIF   (T'&ZCGPR NE 'N').ZG5Q   INVALID REG NAME        00070400
.ZG5P            ANOP  ,                                                00070500
                 AIF   (T'&ZCGPR NE 'N').ZG5R   NON NUMERIC             00070600
                 AIF   ('&ZCGPR' LT '2').ZG5Q                           00070700
                 AIF   ('&ZCGPR' LE '12').ZG5R                          00070800
.ZG5Q            ANOP  ,                                                00070900
&ZMS             SETC  '"DIVEXPANDED='          *KGPRA* MNOTE           00071000
&ZMS             SETC  '&ZMS.&DIVEXPANDED"'                             00071100
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00071200
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00071300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00071400
.ZG5R            ANOP  ,                                                00071500
.*----------------------------------------------------------------***   00071600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00071700
                 AIF   (N'&ASID LE 1).ZG8A      CK NUM                  00071800
&ZMS             SETC  '"ASID='    *KPOSA* MNOTE                        00071900
&ZMS             SETC  '&ZMS.&ASID"'                                    00072000
&ZMS             SETC  '&ZMS "ASID"'                                    00072100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00072200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00072300
.ZG8A            ANOP  ,                                                00072400
.*-------------------------------------------------------------------   00072500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00072600
&ZXASID          SETC  'INPUT'     SET IN/OUTPUT                        00072700
&XASID           SETC  '&ASID(1)'  SET XVARIABLE                        00072800
                 AIF   (N'&ASID GT 1).ZG8B      MULTI PARMS             00072900
&XASID           SETC  '&ASID'     SET XVARIABLE                        00073000
.ZG8B            AIF   (K'&ASID(1) GT 0).ZG8C                           00073100
&ZXASID          SETC  ''          RESET IN/OUTPUT                      00073200
&ZMS             SETC  ' '         *KRQDA*                              00073300
&ZMS             SETC  '&ZMS "ASID" KEY AND ITS'                        00073400
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00073500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00073600
.ZG8C            ANOP  ,                                                00073700
.*-------------------------------------------------------------------   00073800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00073900
                 AIF   (K'&ZXASID LE 0).ZG8R    NOT I/O                 00074000
                 AIF   ('&XASID'(1,1) NE '(').ZG8R                      00074100
&ZCGPR           SETC  '&XASID'(2,K'&XASID-2)                           00074200
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                      00074300
                 AIF   (K'&ZCGPR GT 2).ZG8Q                             00074400
                 AIF   ('&ZCGPR' EQ '0').ZG8Q                           00074500
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00074600
                 AIF   (T'&ZCGPR NE 'N').ZG8Q   INVALID REG NAME        00074700
.ZG8P            ANOP  ,                                                00074800
                 AIF   (T'&ZCGPR NE 'N').ZG8R   NON NUMERIC             00074900
                 AIF   ('&ZCGPR' LT '2').ZG8Q                           00075000
                 AIF   ('&ZCGPR' LE '12').ZG8R                          00075100
.ZG8Q            ANOP  ,                                                00075200
&ZMS             SETC  '"ASID='    *KGPRA* MNOTE                        00075300
&ZMS             SETC  '&ZMS.&ASID"'                                    00075400
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00075500
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00075600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00075700
.ZG8R            ANOP  ,                                                00075800
.*----------------------------------------------------------------***   00075900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00076000
                 AIF   (N'&RETCODE LE 1).ZG11A  CK NUM                  00076100
&ZMS             SETC  '"RETCODE='              *KPOSA* MNOTE           00076200
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00076300
&ZMS             SETC  '&ZMS "RETCODE"'                                 00076400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00076500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00076600
.ZG11A           ANOP  ,                                                00076700
.*-------------------------------------------------------------------   00076800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00076900
                 AIF   (K'&RETCODE(1) LE 0).ZG11C  NO PARM              00077000
&ZXRETCODE       SETC  'OUTPUT'    SET OUTPUT                           00077100
&XRETCODE        SETC  '&RETCODE(1)'            SET XVARIABLE           00077200
                 AIF   (N'&RETCODE GT 1).ZG11C                          00077300
&XRETCODE        SETC  '&RETCODE'  SET XVARIABLE                        00077400
.ZG11C           ANOP  ,                                                00077500
.*-------------------------------------------------------------------   00077600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00077700
                 AIF   (K'&ZXRETCODE LE 0).ZG11R  NOT I/O               00077800
                 AIF   ('&XRETCODE'(1,1) NE '(').ZG11R                  00077900
&ZCGPR           SETC  '&XRETCODE'(2,K'&XRETCODE-2)                     00078000
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                     00078100
                 AIF   (K'&ZCGPR GT 2).ZG11Q                            00078200
                 AIF   ('&ZCGPR' EQ '0').ZG11Q                          00078300
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00078400
                 AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME        00078500
.ZG11P           ANOP  ,                                                00078600
                 AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC             00078700
                 AIF   ('&ZCGPR' LT '2').ZG11Q                          00078800
                 AIF   ('&ZCGPR' LE '12').ZG11R                         00078900
.ZG11Q           ANOP  ,                                                00079000
&ZMS             SETC  '"RETCODE='              *KGPRA* MNOTE           00079100
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00079200
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00079300
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00079400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00079500
.ZG11R           ANOP  ,                                                00079600
.*----------------------------------------------------------------***   00079700
.***AG.KXVAR05 VALUE, OPT INPUT, KEYS -XVARIABLE KEY                    00079800
                 AIF   (N'&COM LE 1).ZG14A      CK NUM                  00079900
&ZMS             SETC  '"COM='     *KPOSA* MNOTE                        00080000
&ZMS             SETC  '&ZMS.&COM"'                                     00080100
&ZMS             SETC  '&ZMS "COM"'                                     00080200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00080300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00080400
.ZG14A           ANOP  ,                                                00080500
.*-------------------------------------------------------------------   00080600
.***AG.KXVAR13 VALUE, OPT INPUT, KEYS -XVARIABLE                        00080700
&ZXCOM           SETC  'INPUT'     SET IN/OUTPUT                        00080800
&XCOM            SETC  'NULL'                                           00080900
                 AIF   (K'&COM(1) LE 0).ZG14B   PARM                    00081000
&XCOM            SETC  '&COM(1)'   SET XVARIABLE                        00081100
                 AIF   (N'&COM GT 1).ZG14B      MULTI PARMS             00081200
&XCOM            SETC  '&COM'      SET XVARIABLE                        00081300
.ZG14B           ANOP  ,                                                00081400
.*-------------------------------------------------------------------   00081500
.***AG.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    00081600
                 AIF   (K'&ZXCOM LE 0).ZG14P    NOT I/O                 00081700
                 AIF   ('&XCOM' EQ 'NULL').ZG14P                        00081800
                 AIF   ('&XCOM'(1,1) NE '(').ZG14P                      00081900
&ZXCOM           SETC  ''          RESET IN/OUTPUT                      00082000
&ZMS             SETC  '"COM='     *KGPRA* MNOTE                        00082100
&ZMS             SETC  '&ZMS.&COM"'                                     00082200
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00082300
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                00082400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00082500
.ZG14P           ANOP  ,                                                00082600
.*-------------------------------------------------------------------   00082700
.***AG.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   00082800
                 AIF   (K'&ZXCOM LE 0).ZG14S    NOT I/O                 00082900
                 AIF   ('&XCOM' EQ 'NULL').ZG14S                        00083000
                 AIF   (K'&XCOM LE 256).ZG14S   LNG OK                  00083100
&ZXCOM           SETC  ''          RESET IN/OUTPUT                      00083200
&ZMS             SETC  '"COM='     *KLNGA* MNOTE                        00083300
&ZMS             SETC  '&ZMS.&COM"'                                     00083400
&ZMS             SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'            00083500
                 MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'              00083600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00083700
.ZG14S           ANOP  ,                                                00083800
.******************************************************************     00083900
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00084000
.******************************************************************     00084100
                 ACTR  10000                                            00084200
.*----------------------------------------------------------------***   00084300
.***AH.P02 EXTRA POSITIONALS                                            00084400
                 AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS             00084500
                 AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL             00084600
                 AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL         00084700
                 AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL          00084800
.ZGLISTX1        ANOP  ,                                                00084900
&ZCVAL           SETC  ''          ERROR FIELD                          00085000
&ZAWRK           SETA  0           POSITIONAL NUMBER                    00085100
.ZGLIST2         ANOP  ,                                                00085200
&ZAWRK           SETA  &ZAWRK+1    NEXT POSITIONAL                      00085300
                 AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE             00085400
&ZCVAL           SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                  00085500
                 AGO   .ZGLIST2                                         00085600
.*                                                                      00085700
.ZGLIST3         ANOP  ,                                                00085800
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)    STRIP COMMA             00085900
&ZMS             SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE         00086000
&ZMS             SETC  '&ZMS "&ZCVAL"'                                  00086100
&ZMS             SETC  '&ZMS CANNOT BE USED.'                           00086200
&ZMS             SETC  '&ZMS NO POSITIONAL ARGUMENTS'                   00086300
                 MNOTE 8,' &ZMS ARE ALLOWED.'                           00086400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00086500
.ZGLISTX         ANOP  ,                                                00086600
&ZASYSLNDX       SETA  0                                                00086700
.*-------------------------------------------------------------------   00086800
.***AG.MF04 MF=(SLE)                                                    00086900
.ZGMFX           ANOP  ,           END OF FULL SYNTAX CHECK             00087000
.*******************************************************************    00087100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00087200
.*******************************************************************    00087300
                 AIF   (&ZMACRET NE 0).ZLX2     ERROR DETECTED          00087400
.*******************************************************************    00087500
.***AE.01  START OF RSMCOUNT MACRO CODE                                 00087600
.*******************************************************************    00087700
                 LCLC  &M0M0001                 NAME                    00087800
&M0M0001         SETC  '&XLABEL'                SET NAME                00087900
                 AIF   (K'&XLABEL NE 0).XLAB2                           00088000
&M0M0001         SETC  'M00M&SYSNDX'            DEFAULT NAME            00088100
.*                                                                      00088200
.XLAB2           ANOP  ,                                                00088300
                 AIF   ('&XMF' EQ 'L').XLAB3                            00088400
&M0M0001 DS    0H                             RSMCOUNT-0                00088500
.XLAB3           ANOP  ,                                                00088600
.*******************************************************************    00088700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00088800
.*******************************************************************    00088900
              PUSH  PRINT                                               00089000
                 AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON       00089100
                 PRINT OFF         ++ PR01                              00089200
                 AGO   .ZPRNTXX                                         00089300
.ZPRINTX         PRINT ON                                               00089400
.ZPRNTXX         ANOP  ,                                                00089500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00089600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00089700
.********************************************************************   00089800
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00089900
.********************************************************************   00090000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00090100
                      LCLA  &ZOPN1         INVOCATION INDEX             00090200
                      LCLC  &ZOPL(4095)    LABEL                        00090300
                      LCLC  &ZOPO(4095)    OPERATION                    00090400
                      LCLC  &ZOPV(4095)    VALUE                        00090500
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00090600
.*                                                                      00090700
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00090800
.******************************************************************     00090900
.***AL.L10 RSMCOUNT FMT=LIST MF=S|L PARAMETERS                          00091000
.******************************************************************     00091100
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00091200
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00091300
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00091400
&XMFATTR              SETC  '0D'                                        00091500
.*                                                                      00091600
&ZOPN                 SETA  &ZOPN+1                                     00091700
&ZOPL(&ZOPN)          SETC  ' '                                         00091800
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00091900
&ZOPO(&ZOPN)          SETC  'B'                                         00092000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00092100
                      AGO   .ZALVL6B                                    00092200
.ZALVL6A              ANOP                                              00092300
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00092400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00092500
.ZALVL6B              ANOP                                              00092600
&ZOPD(&ZOPN)          SETC  '++ RSMCOUNT ARG PARMS'                     00092700
.*                                                                      00092800
&ZOPN                 SETA  &ZOPN+1                                     00092900
&ZOPL(&ZOPN)          SETC  ' '                                         00093000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00093100
&ZOPV(&ZOPN)          SETC  '1'                                         00093200
&ZOPD(&ZOPN)          SETC  ' '                                         00093300
.*                                                                      00093400
.ZLMFSL2              ANOP  ,                                           00093500
.*-------------------------------------------------------------------   00093600
.***AM.L00  RSMCOUNT FMT=LIST name                                      00093700
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00093800
&ZOPN                 SETA &ZOPN+1                                      00093900
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00094000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00094100
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00094200
&ZOPD(&ZOPN)          SETC '++ RSMCOUNT NAME'                           00094300
.ZLMFSL2M             ANOP  ,                                           00094400
.*-------------------------------------------------------------------   00094500
.***AM.L01  RSMCOUNT FMT=LIST PARAMETERS                                00094600
&ZOPN                 SETA &ZOPN+1                                      00094700
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00094800
&ZOPO(&ZOPN)          SETC 'DS'                                         00094900
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00095000
&ZOPD(&ZOPN)          SETC '++ RSMCOUNT PARM LIST'                      00095100
.*-------------------------------------------------------------------   00095200
.***AM.L02 XVERSION XL1                                                 00095300
&ZOPN                 SETA &ZOPN+1                                      00095400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00095500
&ZOPO(&ZOPN)          SETC 'DS'                                         00095600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00095700
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00095800
.*-------------------------------------------------------------------   00095900
.***AM.L09  XRSV0000 CL1                                                00096000
&ZOPN                 SETA &ZOPN+1                                      00096100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0000'                         00096200
&ZOPO(&ZOPN)          SETC 'DS'                                         00096300
&ZOPV(&ZOPN)          SETC 'CL1'                                        00096400
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0000'                      00096500
.*-------------------------------------------------------------------   00096600
.***AM.L09  XASID XL2                                                   00096700
&ZOPN                 SETA &ZOPN+1                                      00096800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XASID'                            00096900
&ZOPO(&ZOPN)          SETC 'DS'                                         00097000
&ZOPV(&ZOPN)          SETC 'XL2'                                        00097100
&ZOPD(&ZOPN)          SETC '++ &ZXASID  XASID'                          00097200
.*-------------------------------------------------------------------   00097300
.***AM.L09  XDIVREAL F                                                  00097400
&ZOPN                 SETA &ZOPN+1                                      00097500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDIVREAL'                         00097600
&ZOPO(&ZOPN)          SETC 'DS'                                         00097700
&ZOPV(&ZOPN)          SETC 'F'                                          00097800
&ZOPD(&ZOPN)          SETC '++ &ZXDIVREAL  XDIVREAL'                    00097900
.*-------------------------------------------------------------------   00098000
.***AM.L09  XDIVEXPANDED F                                              00098100
&ZOPN                 SETA &ZOPN+1                                      00098200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDIVEXPANDED'                     00098300
&ZOPO(&ZOPN)          SETC 'DS'                                         00098400
&ZOPV(&ZOPN)          SETC 'F'                                          00098500
&ZOPD(&ZOPN)          SETC '++ &ZXDIVEXPANDED  XDIVEXPANDED'            00098600
.*-------------------------------------------------------------------   00098700
.***AM.L10 END OF RSMCOUNT LIST PARAMETERS                              00098800
&ZOPN                 SETA &ZOPN+1                                      00098900
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00099000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00099100
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00099200
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00099300
.*                                                                      00099400
&ZOPN                 SETA &ZOPN+1                                      00099500
&ZOPL(&ZOPN)          SETC ' '                                          00099600
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00099700
&ZOPV(&ZOPN)          SETC '1'                                          00099800
&ZOPD(&ZOPN)          SETC ' '                                          00099900
.*-------------------------------------------------------------------   00100000
.***AL.L12 RSMCOUNT FMT=LIST MF=S|L PARAMETERS                          00100100
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00100200
.*                                                                      00100300
&ZOPN                 SETA  &ZOPN+1                                     00100400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00100500
&ZOPO(&ZOPN)          SETC  'DC'                                        00100600
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00100700
&ZOPD(&ZOPN)          SETC  '++ RSMCOUNT ARG PARMS'                     00100800
.*                                                                      00100900
.ZLMFSLX              ANOP  ,                                           00101000
.*-------------------------------------------------------------------   00101100
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00101200
&ZPLLEN               SETA 12                                           00101300
.*                                                                      00101400
.******************************************************************     00101500
.***AI.L01 RSMCOUNT FMT=LIST FILL IN PARAMETER AREA                     00101600
.******************************************************************     00101700
                      ACTR  10000                                       00101800
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00101900
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00102000
&ZCVAL                SETC  'LAE'          XAX MODE                     00102100
.ZIMFXA               ANOP ,                                            00102200
.*                                                                      00102300
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00102400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00102500
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00102600
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00102700
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00102800
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00102900
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00103000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00103100
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00103200
&ZOPN                 SETA  &ZOPN+1                                     00103300
&ZOPL(&ZOPN)          SETC  ' '                                         00103400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00103500
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00103600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00103700
                      AGO   .ZIMFNX                                     00103800
.*                                                                      00103900
.ZIMFN2               ANOP ,                                            00104000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00104100
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00104200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00104300
&ZOPN                 SETA  &ZOPN+1                                     00104400
&ZOPL(&ZOPN)          SETC  ' '                                         00104500
&ZOPO(&ZOPN)          SETC  'LAE'                                       00104600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00104700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00104800
                      AGO   .ZIMFNX                                     00104900
.ZIMFNX1              ANOP ,                                            00105000
&ZOPN                 SETA  &ZOPN+1                                     00105100
&ZOPL(&ZOPN)          SETC  ' '                                         00105200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00105300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00105400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00105500
.ZIMFNX               ANOP ,                                            00105600
.********************************************************************   00105700
.***AI.L02 RSMCOUNT FMT=LIST INITIALIZE PARAMETER AREA                  00105800
.********************************************************************   00105900
.***AI.L03 MF=(SLE)                                                     00106000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00106100
.*                                                                      00106200
&ZOPN                 SETA  &ZOPN+1                                     00106300
&ZOPL(&ZOPN)          SETC  ' '                                         00106400
&ZOPO(&ZOPN)          SETC  'XC'                                        00106500
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00106600
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00106700
.ZIMFLX               ANOP  ,                                           00106800
.*-------------------------------------------------------------------   00106900
.***AI.L25  XASID XL2                                                   00107000
                      AIF   ('&ZXASID' EQ '').ZI3E                      00107100
                      AIF   ('&ZXASID' EQ 'OUTPUT').ZI3E                00107200
&ZCGPR                SETC  '&XASID'                                    00107300
.*                                                                      00107400
                      AIF   ('&XASID'(1,1) NE '(').ZI3B                 00107500
&ZCGPR   SETC  '0('.'&XASID'(2,K'&XASID-2).')'                          00107600
                      AGO   .ZI3D                                       00107700
.ZI3B                 ANOP  ,                                           00107800
.*                                                                      00107900
&ZC                   SETC  '&XASID'(1,1)                               00108000
                      AIF   (T'&ZC NE 'N').ZI3D                         00108100
&ZC                   SETC  '&XASID'                                    00108200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI3D                00108300
&ZCGPR                SETC  '=FL2''&XASID'''                            00108400
.*                                                                      00108500
.ZI3D                 ANOP  ,                                           00108600
.*                                                                      00108700
&ZOPN                 SETA  &ZOPN+1                                     00108800
&ZOPL(&ZOPN)          SETC  ' '                                         00108900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00109000
&ZOPV(&ZOPN)          SETC  '2(2,1),&ZCGPR'                             00109100
&ZOPD(&ZOPN)          SETC  '++ &ZXASID XASID'                          00109200
.*                                                                      00109300
.ZI3E                 ANOP  ,                                           00109400
.*-------------------------------------------------------------------   00109500
&ZOPN1                SETA &ZOPN                                        00109600
.*******************************************************************    00109700
.***  PROCESS RSMCOUNT OUTPUT PARAMETERS                                00109800
.*******************************************************************    00109900
                      ACTR  10000                                       00110000
.*------------------------------------------------------------------    00110100
.***AO.L02 XDIVREAL F                                                   00110200
         AIF   ('&ZXDIVREAL' EQ 'OUTPUT').ZO4A  OUTPUT                  00110300
         AIF   ('&ZXDIVREAL' NE 'INOUT').ZO4C  INOUT                    00110400
.ZO4A    AIF   ('&XDIVREAL'(1,1) NE '(').ZO4B  ADDR IN GPR              00110500
&ZCGPR   SETC  '&XDIVREAL'(2,K'&XDIVREAL-2)                             00110600
&ZOPN                 SETA  &ZOPN+1                                     00110700
&ZOPL(&ZOPN)          SETC  ' '                                         00110800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00110900
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),4(1)'                          00111000
&ZOPD(&ZOPN)          SETC  '++ XDIVREAL F'                             00111100
                      AGO   .ZO4C                                       00111200
.*                                                                      00111300
.ZO4B                 ANOP  ,                                           00111400
&ZAWRK   SETA  K'&XDIVREAL                                              00111500
         AIF   ('&XDIVREAL'(&ZAWRK,1) NE ')').ZO4G                      00111600
&ZN      SETA  2                                                        00111700
.ZO4H    ANOP                                                           00111800
         AIF   (&ZN GE &ZAWRK).ZO4G                                     00111900
         AIF   ('&XDIVREAL'(&ZN,1) NE '(').ZO4I                         00112000
&ZC      SETC  '&XDIVREAL'(1,&ZN).'4'.','                               00112100
&ZC      SETC  '&ZC'.'&XDIVREAL'(&ZN+1,&ZAWRK-&ZN).',4(1)'              00112200
         AGO   .ZO4J                                                    00112300
.ZO4I    ANOP                                                           00112400
&ZN      SETA  &ZN+1                                                    00112500
         AGO   .ZO4H                                                    00112600
.ZO4G    ANOP                                                           00112700
&ZC      SETC  '&XDIVREAL.(4),4(1)'                                     00112800
.ZO4J    ANOP                                                           00112900
&ZOPN                 SETA  &ZOPN+1                                     00113000
&ZOPL(&ZOPN)          SETC  ' '                                         00113100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00113200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00113300
&ZOPD(&ZOPN)          SETC  '++ XDIVREAL F'                             00113400
.ZO4C                 ANOP  ,                                           00113500
.*------------------------------------------------------------------    00113600
.***AO.L02 XDIVEXPANDED F                                               00113700
         AIF   ('&ZXDIVEXPANDED' EQ 'OUTPUT').ZO5A  OUTPUT              00113800
         AIF   ('&ZXDIVEXPANDED' NE 'INOUT').ZO5C  INOUT                00113900
.ZO5A    AIF   ('&XDIVEXPANDED'(1,1) NE '(').ZO5B  ADDR IN GPR          00114000
&ZCGPR   SETC  '&XDIVEXPANDED'(2,K'&XDIVEXPANDED-2)                     00114100
&ZOPN                 SETA  &ZOPN+1                                     00114200
&ZOPL(&ZOPN)          SETC  ' '                                         00114300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00114400
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),8(1)'                          00114500
&ZOPD(&ZOPN)          SETC  '++ XDIVEXPANDED F'                         00114600
                      AGO   .ZO5C                                       00114700
.*                                                                      00114800
.ZO5B                 ANOP  ,                                           00114900
&ZAWRK   SETA  K'&XDIVEXPANDED                                          00115000
         AIF   ('&XDIVEXPANDED'(&ZAWRK,1) NE ')').ZO5G                  00115100
&ZN      SETA  2                                                        00115200
.ZO5H    ANOP                                                           00115300
         AIF   (&ZN GE &ZAWRK).ZO5G                                     00115400
         AIF   ('&XDIVEXPANDED'(&ZN,1) NE '(').ZO5I                     00115500
&ZC      SETC  '&XDIVEXPANDED'(1,&ZN).'4'.','                           00115600
&ZC      SETC  '&ZC'.'&XDIVEXPANDED'(&ZN+1,&ZAWRK-&ZN).',8(1)'          00115700
         AGO   .ZO5J                                                    00115800
.ZO5I    ANOP                                                           00115900
&ZN      SETA  &ZN+1                                                    00116000
         AGO   .ZO5H                                                    00116100
.ZO5G    ANOP                                                           00116200
&ZC      SETC  '&XDIVEXPANDED.(4),8(1)'                                 00116300
.ZO5J    ANOP                                                           00116400
&ZOPN                 SETA  &ZOPN+1                                     00116500
&ZOPL(&ZOPN)          SETC  ' '                                         00116600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00116700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00116800
&ZOPD(&ZOPN)          SETC  '++ XDIVEXPANDED F'                         00116900
.ZO5C                 ANOP  ,                                           00117000
.*******************************************************************    00117100
.***AO.X02  RETURN CODE PROCESSING                                      00117200
.*******************************************************************    00117300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00117400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00117500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00117600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00117700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00117800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00117900
&ZOPN                 SETA  &ZOPN+1                                     00118000
&ZOPL(&ZOPN)          SETC  ' '                                         00118100
&ZOPO(&ZOPN)          SETC  'ST'                                        00118200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00118300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00118400
                      AGO   .ZMRETX                                     00118500
.*                                                                      00118600
.ZMRET2               ANOP  ,                                           00118700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00118800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00118900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00119000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00119100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00119200
&ZOPN                 SETA  &ZOPN+1                                     00119300
&ZOPL(&ZOPN)          SETC  ' '                                         00119400
&ZOPO(&ZOPN)          SETC  'LR'                                        00119500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00119600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00119700
.ZMRETX               ANOP  ,                                           00119800
.*******************************************************************    00119900
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00120000
.*******************************************************************    00120100
.ZMFLX                ANOP  ,              MF=L PROCESSING              00120200
.*******************************************************************    00120300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00120400
.*******************************************************************    00120500
                      ACTR  10000                                       00120600
.*                                                                      00120700
                      LCLA  &ZLC           COLUMN POSITION              00120800
                      LCLA  &ZOPX          LIST TABLE INDEX             00120900
                      LCLC  &ZLL           LABEL                        00121000
                      LCLC  &ZLOP          OPERATION                    00121100
                      LCLC  &ZLV           VALUE                        00121200
                      LCLC  &ZLD           DESCRIPTION                  00121300
.*                                                                      00121400
&ZOPX                 SETA  1                                           00121500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00121600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00121700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00121800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00121900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00122000
                      AIF   (K'&ZLD LE 0).ZL5                           00122100
&ZLC                  SETA  35             COMMENT COLUMN               00122200
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00122300
&ZLC                  SETA  33             COMMMENT COLUMN              00122400
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00122500
&ZLV                  SETC  '&ZLV'.' '                                  00122600
                      AGO   .ZL3                                        00122700
.*                                                                      00122800
.ZL4                  ANOP  ,                                           00122900
&ZLV                  SETC  '&ZLV'.' '                                  00123000
.ZL5                  ANOP  ,                                           00123100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00123200
.*                                                                      00123300
&ZLL     &ZLOP &ZLV                                                     00123400
.*                                                                      00123500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00123600
                      AGO   .ZL2           CONTINUE LOOPING             00123700
.*                                                                      00123800
.ZLX                  ANOP  ,                                           00123900
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00124000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00124100
.*===================================================================== 00124200
.***PD29.MOD     call IARXQVDC                                          00124300
         L     15,X'10'           ++ CVT address                        00124400
         L     15,X'164'(15,0)    ++ PVT address                        00124500
         L     15,X'C4'(15,0)     ++ Service routine address            00124600
         O     15,=X'80000000'    ++ 31 bit AMODE module                00124700
                      AIF   ('&SYSASCE' EQ 'P').USRLBL01  SYSSTATE PRI  00124800
         SAC   0                  ++ Switch to primary ASC mode         00124900
.USRLBL01             ANOP ,                                            00125000
         BASSM 14,15              ++ Call service routine               00125100
                      AIF   ('&SYSASCE' EQ 'P').USRLBL02  SYSSTATE PRI  00125200
         SAC   512                ++ Switch to AR ASC mode              00125300
.USRLBL02             ANOP ,                                            00125400
         LA    0,8                ++ Offset to instruction after BSM    00125500
         ALR   14,0               ++ Address of instruction after BSM   00125600
         BSM   0,14               ++ Restore AMODE                      00125700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00125800
.ZLINKX               ANOP  ,                                           00125900
.*******************************************************************    00126000
.***AP.X01  FORMAT GENERATED CODE                                       00126100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00126200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00126300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00126400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00126500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00126600
                      AIF   (K'&ZLD LE 0).ZL51                          00126700
&ZLC                  SETA  35             COMMENT COLUMN               00126800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00126900
&ZLC                  SETA  33             COMMENT COLUMN               00127000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00127100
&ZLV                  SETC  '&ZLV'.' '                                  00127200
                      AGO   .ZL31                                       00127300
.*                                                                      00127400
.ZL41                 ANOP  ,                                           00127500
&ZLV                  SETC  '&ZLV'.' '                                  00127600
.ZL51                 ANOP  ,                                           00127700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00127800
.*                                                                      00127900
&ZLL     &ZLOP &ZLV                                                     00128000
.*                                                                      00128100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00128200
                      AGO   .ZL21          CONTINUE LOOPING             00128300
.*                                                                      00128400
.ZLX1                 ANOP  ,                                           00128500
.*******************************************************************    00128600
.***AP.X02  END OF RSMCOUNT MACRO                                       00128700
&ZRSMCOUNT            SETC  'YES'          SET RSMCOUNT USED            00128800
         POP   PRINT                                                    00128900
*                                            RSMCOUNT-0                 00129000
         SPACE 1                                                        00129100
.ZLX2                 ANOP  ,                                           00129200
         MEND                                                           00129300
**********************************************************************/ 00129400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00129500
*%RSMCOUNT: MACRO KEYS(DIVREAL,DIVEXPANDED,ASID,RETCODE,COM,PLISTVER,   00129600
*                 MF);                                                  00129700
*  ANS('?'||MACLABEL||' '||'RSMCOUNP '||MACLIST||                       00129800
*         ' '||MACKEYS||';') COL(MACLMAR);                              00129900
*%END RSMCOUNT;                                                         00130000
