*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXZXENVR                              -93/07/13-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  JESXCF Environment Processor                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1996                           * 00001300
*                                                                     * 00001400
* STATUS= HBB6601                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*      The macro defines the JES environments that a module runs in.  * 00002100
*      This information is used by JES and JESXCF macros to validate  * 00002200
*      the environment.                                               * 00002300
*                                                                     * 00002400
*01* EXTERNAL CLASSIFICATION:   NONE                                  * 00002500
*                                                                     * 00002600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002700
*                                                                     * 00002800
*01* SYNTAX:                                                          * 00002900
*                                                                     * 00003000
*[xlabel]  IXZXENVR     OPERATION=SET                               * 00003100
*                      ,ENVIRN=J2MAINTASK|J2SUBTASK|                 * 00003200
*                               J2FSS|J2USER|J3MAINTASK|J3SUBTASK|    * 00003300
*                               J3FSS|J3USER|JESXCF                  * 00003400
*                                                                     * 00003500
*                                                                     * 00003600
*      Where:                                                         * 00003700
*                                                                     * 00003800
*                                                                     * 00003900
*      [xlabel]                                                       * 00004000
*          is an optional symbol, starting in column 1, that is the   * 00004100
*          name on the IXZXENVR macro invocation.  The name must      * 00004200
*          conform to the rules for an ordinary assembler language    * 00004300
*          symbol.                                                    * 00004400
*          DEFAULT: No name.                                          * 00004500
*                                                                     * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*      OPERATION=SET                                                * 00005000
*          is a required keyword input indicated the operation to be  * 00005100
*          performed                                                  * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*          OPERATION=SET                                              * 00005500
*              Set the current JES environment variables.             * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*      ENVIRN=J2MAINTASK|J2SUBTASK|J2FSS|J2USER|J3MAINTASK|J3SUBTASK * 00006300
*          |J3FSS|J3USER|JESXCF                                      * 00006400
*          is a required keyword input indicates the JES environment. * 00006500
*                                                                     * 00006600
*                                                                     * 00006700
*          ENVIRN=J2MAINTASK                                          * 00006800
*              JES2 main task.                                        * 00006900
*                                                                     * 00007000
*          ENVIRN=J2SUBTASK                                           * 00007100
*              JES2 subtask environment.                              * 00007200
*                                                                     * 00007300
*          ENVIRN=J2FSS                                               * 00007400
*              JES2 FSS environment.                                  * 00007500
*                                                                     * 00007600
*          ENVIRN=J2USER                                              * 00007700
*              JES2 user environment.                                 * 00007800
*                                                                     * 00007900
*          ENVIRN=J3MAINTASK                                          * 00008000
*              JES3 main task.                                        * 00008100
*                                                                     * 00008200
*          ENVIRN=J3SUBTASK                                           * 00008300
*              JES3 subtask environment.                              * 00008400
*                                                                     * 00008500
*          ENVIRN=J3FSS                                               * 00008600
*              JES3 FSS environment.                                  * 00008700
*                                                                     * 00008800
*          ENVIRN=J3USER                                              * 00008900
*              JES3 user environment.                                 * 00009000
*                                                                     * 00009100
*          ENVIRN=JESXCF                                              * 00009200
*              JESXCF environment.                                    * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*01* RETURN CODES:  None.                                             * 00009900
*                                                                     * 00010000
*01* REASON CODES:  None.                                             * 00010100
*                                                                     * 00010200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00010300
*                                                                     * 00010400
*02*   PROCESSOR:  ASSEM                                              * 00010500
*                                                                     * 00010600
*01* COMPONENT:  SCJSC                                                * 00010700
*                                                                     * 00010800
*01* MACRO USAGE NOTES:                                               * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00011200
*        global macro variable.  Any value other than 'NO' will       * 00011300
*        result in the macro expansion being printed.  The default is * 00011400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00011500
*        variable should be set.                                      * 00011600
*                                                                     * 00011700
*                    GBLC &ZPRINT                                     * 00011800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
****** END OF SPECIFICATIONS *****************************************/ 00012200
*/********************************************************************* 00012300
         MACRO                                                          00012400
&XLABEL  IXZXENVR &OPERATION=,&ENVIRN=                                  00012500
.*                                                                      00012600
*                MACDATE -93/07/13-<0>                                  00012700
.*                                                                      00012800
.*******************************************************************    00012900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00013000
.*******************************************************************    00013100
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00013200
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00013300
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00013400
.*                                                                      00013500
                GBLC  &ZIXZXENVR  YES=MACRO USED AT LEAST ONCE          00013600
.*******************************************************************    00013700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00013800
.*******************************************************************    00013900
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00014000
                LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS          00014100
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00014200
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00014300
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00014400
                LCLA  &ZAWRK      USED AS A WORK AREA                   00014500
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00014600
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00014700
                LCLC  &ZC         CHARACTER WORK VARIABLE               00014800
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00014900
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00015000
                LCLA  &ZMACRET    MACRO RETURN CODE                     00015100
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00015200
.*                                                                      00015300
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00015400
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00015500
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00015600
                LCLC  &ZENDBASEPL               End of base PL          00015700
.********************************************************************   00015800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00015900
.********************************************************************   00016000
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00016100
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00016200
.*                                                                      00016300
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00016400
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00016500
                SPLEVEL  TEST                                           00016600
.ZSYS2          ANOP  ,                                                 00016700
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00016800
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00016900
                SYSSTATE TEST                                           00017000
                AGO   .ZSYS4                                            00017100
.ZSYS3          ANOP  ,                                                 00017200
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00017300
.ZSYS4          ANOP  ,                                                 00017400
.*******************************************************************    00017500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00017600
.*******************************************************************    00017700
                LCLC  &XOPERATION               ++ VALUE                00017800
                LCLC  &XENVIRN    ++ VALUE                              00017900
.*******************************************************************    00018000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00018100
.*******************************************************************    00018200
                LCLC  &ZXOPERATION              ++ INPUT VALUE          00018300
                LCLC  &ZXENVIRN   ++ INPUT VALUE                        00018400
.********************************************************************   00018500
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00018600
.********************************************************************   00018700
                ACTR  10000                                             00018800
.*----------------------------------------------------------------***   00018900
.***AG.KKWRD01 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00019000
                AIF   (N'&OPERATION LE 1).ZG2A  CK NUM                  00019100
&ZMS            SETC  '"OPERATION='             *KPOSA* MNOTE           00019200
&ZMS            SETC  '&ZMS.&OPERATION"'                                00019300
&ZMS            SETC  '&ZMS "OPERATION"'                                00019400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00019500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00019600
.ZG2A           ANOP  ,                                                 00019700
.*-------------------------------------------------------------------   00019800
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00019900
&XOPERATION     SETC  ''          INITIALIZE XVARIABLE                  00020000
.ZG3A   AIF   ('&OPERATION(1)' NE 'SET').ZG4A                           00020100
&XOPERATION     SETC  'SET'       SET KEYWORD                           00020200
.*-------------------------------------------------------------------   00020300
.***AG.KKWRD03 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00020400
.ZG4A           AIF   (K'&XOPERATION GT 0).ZG4C  KEYWORD                00020500
                AIF   (K'&OPERATION(1) LE 0).ZG4B                       00020600
&ZMS            SETC  '"OPERATION='             *KUKWA* MNOTE           00020700
&ZMS            SETC  '&ZMS.&OPERATION"'                                00020800
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00020900
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00021000
&ZMS            SETC  '&ZMS "SET".'             VALID KEYWORD           00021100
                MNOTE 8,' &ZMS '                                        00021200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00021300
.ZG4B           ANOP  ,                                                 00021400
&XOPERATION     SETC  'SET'       SET DEFAULT KEYWORD                   00021500
.ZG4C           ANOP  ,                                                 00021600
&ZXOPERATION    SETC  'INPUT'     SET IN/OUTPUT                         00021700
.*-------------------------------------------------------------------   00021800
.***AG.KKWRD04 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00021900
                AIF   (K'&OPERATION(1) GT 0).ZG4D  VALID                00022000
&ZXOPERATION    SETC  ''          RESET IN/OUTPUT                       00022100
&ZMS            SETC  'THE'                                             00022200
&ZMS            SETC  '&ZMS "OPERATION" KEY AND ITS ARGUMENT'           00022300
&ZMS            SETC  '&ZMS ARE REQUIRED.'                              00022400
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00022500
&ZMS            SETC  '&ZMS "SET".'             VALID KEYWORD           00022600
                MNOTE 8,' &ZMS '                                        00022700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00022800
.ZG4D           ANOP  ,                                                 00022900
.*----------------------------------------------------------------***   00023000
.***AG.KKWRD01 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00023100
                AIF   (N'&ENVIRN LE 1).ZG6A     CK NUM                  00023200
&ZMS            SETC  '"ENVIRN='  *KPOSA* MNOTE                         00023300
&ZMS            SETC  '&ZMS.&ENVIRN"'                                   00023400
&ZMS            SETC  '&ZMS "ENVIRN"'                                   00023500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00023600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00023700
.ZG6A           ANOP  ,                                                 00023800
.*-------------------------------------------------------------------   00023900
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00024000
&XENVIRN        SETC  ''          INITIALIZE XVARIABLE                  00024100
.ZG7A   AIF   ('&ENVIRN(1)' NE 'J2MAINTASK').ZG8A                       00024200
&XENVIRN        SETC  'J2MAINTASK'              SET KEYWORD             00024300
.*-------------------------------------------------------------------   00024400
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00024500
.ZG8A   AIF   ('&ENVIRN(1)' NE 'J2SUBTASK').ZG9A                        00024600
&XENVIRN        SETC  'J2SUBTASK'               SET KEYWORD             00024700
.*-------------------------------------------------------------------   00024800
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00024900
.ZG9A   AIF   ('&ENVIRN(1)' NE 'J2FSS').ZG10A                           00025000
&XENVIRN        SETC  'J2FSS'     SET KEYWORD                           00025100
.*-------------------------------------------------------------------   00025200
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00025300
.ZG10A   AIF   ('&ENVIRN(1)' NE 'J2USER').ZG11A                         00025400
&XENVIRN        SETC  'J2USER'    SET KEYWORD                           00025500
.*-------------------------------------------------------------------   00025600
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00025700
.ZG11A   AIF   ('&ENVIRN(1)' NE 'J3MAINTASK').ZG12A                     00025800
&XENVIRN        SETC  'J3MAINTASK'              SET KEYWORD             00025900
.*-------------------------------------------------------------------   00026000
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00026100
.ZG12A   AIF   ('&ENVIRN(1)' NE 'J3SUBTASK').ZG13A                      00026200
&XENVIRN        SETC  'J3SUBTASK'               SET KEYWORD             00026300
.*-------------------------------------------------------------------   00026400
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00026500
.ZG13A   AIF   ('&ENVIRN(1)' NE 'J3FSS').ZG14A                          00026600
&XENVIRN        SETC  'J3FSS'     SET KEYWORD                           00026700
.*-------------------------------------------------------------------   00026800
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00026900
.ZG14A   AIF   ('&ENVIRN(1)' NE 'J3USER').ZG15A                         00027000
&XENVIRN        SETC  'J3USER'    SET KEYWORD                           00027100
.*-------------------------------------------------------------------   00027200
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00027300
.ZG15A   AIF   ('&ENVIRN(1)' NE 'JESXCF').ZG16A                         00027400
&XENVIRN        SETC  'JESXCF'    SET KEYWORD                           00027500
.*-------------------------------------------------------------------   00027600
.***AG.KKWRD03 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00027700
.ZG16A          AIF   (K'&XENVIRN GT 0).ZG16C   KEYWORD                 00027800
                AIF   (K'&ENVIRN(1) LE 0).ZG16B                         00027900
&ZMS            SETC  '"ENVIRN='  *KUKWA* MNOTE                         00028000
&ZMS            SETC  '&ZMS.&ENVIRN"'                                   00028100
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00028200
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00028300
&ZMS            SETC  '&ZMS "J2MAINTASK",'      VALID KEYWORD           00028400
&ZMS            SETC  '&ZMS "J2SUBTASK",'       VALID KEYWORD           00028500
&ZMS            SETC  '&ZMS "J2FSS",'           VALID KEYWORD           00028600
&ZMS            SETC  '&ZMS "J2USER",'          VALID KEYWORD           00028700
&ZMS            SETC  '&ZMS "J3MAINTASK",'      VALID KEYWORD           00028800
&ZMS            SETC  '&ZMS "J3SUBTASK",'       VALID KEYWORD           00028900
&ZMS            SETC  '&ZMS "J3FSS",'           VALID KEYWORD           00029000
&ZMS            SETC  '&ZMS "J3USER",'          VALID KEYWORD           00029100
&ZMS            SETC  '&ZMS OR "JESXCF".'       VALID KEYWORD           00029200
                MNOTE 8,' &ZMS '                                        00029300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00029400
.ZG16B          ANOP  ,                                                 00029500
&XENVIRN        SETC  'J2MAINTASK'              SET DEFAULT KEYWORD     00029600
.ZG16C          ANOP  ,                                                 00029700
&ZXENVIRN       SETC  'INPUT'     SET IN/OUTPUT                         00029800
.*-------------------------------------------------------------------   00029900
.***AG.KKWRD04 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00030000
                AIF   (K'&ENVIRN(1) GT 0).ZG16D  VALID                  00030100
&ZXENVIRN       SETC  ''          RESET IN/OUTPUT                       00030200
&ZMS            SETC  'THE'                                             00030300
&ZMS            SETC  '&ZMS "ENVIRN" KEY AND ITS ARGUMENT'              00030400
&ZMS            SETC  '&ZMS ARE REQUIRED.'                              00030500
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00030600
&ZMS            SETC  '&ZMS "J2MAINTASK",'      VALID KEYWORD           00030700
&ZMS            SETC  '&ZMS "J2SUBTASK",'       VALID KEYWORD           00030800
&ZMS            SETC  '&ZMS "J2FSS",'           VALID KEYWORD           00030900
&ZMS            SETC  '&ZMS "J2USER",'          VALID KEYWORD           00031000
&ZMS            SETC  '&ZMS "J3MAINTASK",'      VALID KEYWORD           00031100
&ZMS            SETC  '&ZMS "J3SUBTASK",'       VALID KEYWORD           00031200
&ZMS            SETC  '&ZMS "J3FSS",'           VALID KEYWORD           00031300
&ZMS            SETC  '&ZMS "J3USER",'          VALID KEYWORD           00031400
&ZMS            SETC  '&ZMS OR "JESXCF".'       VALID KEYWORD           00031500
                MNOTE 8,' &ZMS '                                        00031600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00031700
.ZG16D          ANOP  ,                                                 00031800
.******************************************************************     00031900
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00032000
.******************************************************************     00032100
                ACTR  10000                                             00032200
.*----------------------------------------------------------------***   00032300
.***AH.P02 EXTRA POSITIONALS                                            00032400
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00032500
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00032600
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00032700
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00032800
.ZGLISTX1       ANOP  ,                                                 00032900
&ZCVAL          SETC  ''          ERROR FIELD                           00033000
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00033100
.ZGLIST2        ANOP  ,                                                 00033200
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00033300
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00033400
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00033500
                AGO   .ZGLIST2                                          00033600
.*                                                                      00033700
.ZGLIST3        ANOP  ,                                                 00033800
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00033900
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          00034000
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00034100
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00034200
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00034300
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00034400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00034500
.ZGLISTX        ANOP  ,                                                 00034600
&ZASYSLNDX      SETA  0                                                 00034700
.*******************************************************************    00034800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00034900
.*******************************************************************    00035000
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00035100
.*******************************************************************    00035200
.***AE.01  START OF IXZXENVR MACRO CODE                                 00035300
.*******************************************************************    00035400
                LCLC  &M0M0001                 NAME                     00035500
&M0M0001        SETC  '&XLABEL'                SET NAME                 00035600
                AIF   (K'&XLABEL NE 0).XLAB2                            00035700
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00035800
.*                                                                      00035900
.XLAB2          ANOP  ,                                                 00036000
&M0M0001 DS    0H                             IXZXENVR-0                00036100
.*******************************************************************    00036200
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00036300
.*******************************************************************    00036400
              PUSH  PRINT                                               00036500
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00036600
                PRINT OFF         ++ PR01                               00036700
                AGO   .ZPRNTXX                                          00036800
.ZPRINTX        PRINT ON                                                00036900
.ZPRNTXX        ANOP  ,                                                 00037000
.********************************************************************   00037100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00037200
.********************************************************************   00037300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00037400
                      LCLA  &ZOPN1         INVOCATION INDEX             00037500
                      LCLC  &ZOPL(4095)    LABEL                        00037600
                      LCLC  &ZOPO(4095)    OPERATION                    00037700
                      LCLC  &ZOPV(4095)    VALUE                        00037800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00037900
.*                                                                      00038000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00038100
.*-------------------------------------------------------------------   00038200
&ZOPN1                SETA &ZOPN                                        00038300
.*******************************************************************    00038400
.***  PROCESS IXZXENVR OUTPUT PARAMETERS                                00038500
.*******************************************************************    00038600
                      ACTR  10000                                       00038700
.*******************************************************************    00038800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00038900
.*******************************************************************    00039000
                      ACTR  10000                                       00039100
.*                                                                      00039200
                      LCLA  &ZLC           COLUMN POSITION              00039300
                      LCLA  &ZOPX          LIST TABLE INDEX             00039400
                      LCLC  &ZLL           LABEL                        00039500
                      LCLC  &ZLOP          OPERATION                    00039600
                      LCLC  &ZLV           VALUE                        00039700
                      LCLC  &ZLD           DESCRIPTION                  00039800
.*                                                                      00039900
&ZOPX                 SETA  1                                           00040000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00040100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00040200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00040300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00040400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00040500
                      AIF   (K'&ZLD LE 0).ZL5                           00040600
&ZLC                  SETA  35             COMMENT COLUMN               00040700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00040800
&ZLC                  SETA  33             COMMMENT COLUMN              00040900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00041000
&ZLV                  SETC  '&ZLV'.' '                                  00041100
                      AGO   .ZL3                                        00041200
.*                                                                      00041300
.ZL4                  ANOP  ,                                           00041400
&ZLV                  SETC  '&ZLV'.' '                                  00041500
.ZL5                  ANOP  ,                                           00041600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00041700
.*                                                                      00041800
&ZLL     &ZLOP &ZLV                                                     00041900
.*                                                                      00042000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00042100
                      AGO   .ZL2           CONTINUE LOOPING             00042200
.*                                                                      00042300
.ZLX                  ANOP  ,                                           00042400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00042500
         GBLB  &J3MN              JES3 Main Task environment            00042600
         GBLB  &J3ST              JES3 Subtask environment              00042700
         GBLB  &J3FSS             JES3 FSS environment                  00042800
         GBLB  &J3USR             JES3 User environment                 00042900
         GBLB  &JSXCF             JESXCF environment                    00043000
&JSXCF   SETB  0                                                        00043100
&J3MN    SETB  0                                                        00043200
&J3ST    SETB  0                                                        00043300
&J3FSS   SETB  0                                                        00043400
&J3USR   SETB  0                                                        00043500
         AIF   ('&ENVIRN' NE 'JESXCF').ENV0500                          00043600
&JSXCF   SETB  1                                                        00043700
         AGO   .ENV9000                                                 00043800
.ENV0500 ANOP                                                           00043900
         AIF   ('&ENVIRN' NE 'J3MAINTASK').ENV0600                      00044000
&J3MN    SETB  1                                                        00044100
         AGO   .ENV9000                                                 00044200
.ENV0600 ANOP                                                           00044300
         AIF   ('&ENVIRN' NE 'J3SUBTASK').ENV0700                       00044400
&J3ST    SETB  1                                                        00044500
         AGO   .ENV9000                                                 00044600
.ENV0700 ANOP                                                           00044700
         AIF   ('&ENVIRN' NE 'J3FSS').ENV0800                           00044800
&J3FSS   SETB  1                                                        00044900
         AGO   .ENV9000                                                 00045000
.ENV0800 ANOP                                                           00045100
         AIF   ('&ENVIRN' NE 'J3USER').ENV0900                          00045200
&J3USR   SETB  1                                                        00045300
         AGO   .ENV9000                                                 00045400
.ENV0900 ANOP                                                           00045500
         MNOTE 8,'IXZ0001 Invalid environment specified'                00045600
         AGO   .ENV9000                                                 00045700
.ENV9000 ANOP                                                           00045800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00045900
.*******************************************************************    00046000
.***AP.X01  FORMAT GENERATED CODE                                       00046100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00046200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00046300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00046400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00046500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00046600
                      AIF   (K'&ZLD LE 0).ZL51                          00046700
&ZLC                  SETA  35             COMMENT COLUMN               00046800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00046900
&ZLC                  SETA  33             COMMENT COLUMN               00047000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00047100
&ZLV                  SETC  '&ZLV'.' '                                  00047200
                      AGO   .ZL31                                       00047300
.*                                                                      00047400
.ZL41                 ANOP  ,                                           00047500
&ZLV                  SETC  '&ZLV'.' '                                  00047600
.ZL51                 ANOP  ,                                           00047700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00047800
.*                                                                      00047900
&ZLL     &ZLOP &ZLV                                                     00048000
.*                                                                      00048100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00048200
                      AGO   .ZL21          CONTINUE LOOPING             00048300
.*                                                                      00048400
.ZLX1                 ANOP  ,                                           00048500
.*******************************************************************    00048600
.***AP.X02  END OF IXZXENVR MACRO                                       00048700
&ZIXZXENVR            SETC  'YES'          SET IXZXENVR USED            00048800
         POP   PRINT                                                    00048900
*                                            IXZXENVR-0                 00049000
         SPACE 1                                                        00049100
.ZLX2                 ANOP  ,                                           00049200
         MEND                                                           00049300
**********************************************************************/ 00049400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00049500
*%IXZXENVR: MACRO KEYS(OPERATION,ENVIRN);                               00049600
*  ANS('?'||MACLABEL||' '||'IXZPENVR '||MACLIST||                       00049700
*         ' '||MACKEYS||';') COL(MACLMAR);                              00049800
*%END IXZXENVR;                                                         00049900
