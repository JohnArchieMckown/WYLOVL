*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IWMECREA                              -09/05/96-<1> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  Create Enclave                                * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00600000
*     5645-001 (C) COPYRIGHT IBM CORP. 1994, 1997                     * 00650000
*                                                                     * 00750000
* STATUS= HBB6603                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*                                                                     * 00950000
*01* FUNCTION:                                                        * 01000000
*                                                                     * 01050000
*                                                                     * 01100000
*      The purpose of this service is to create an Enclave where      * 01150000
*      possibly multiple SRBs and/or TCBs may be simultaneously       * 01159300
*      executing or scheduled. For the duration of each Enclave, all  * 01168600
*      SRBs and TCBs associated with the Enclave are treated as part  * 01177900
*      of a single work request.  All SRBs and/or TCBs associated     * 01187200
*      with the Enclave accumulate service as a single entity and are * 01196500
*      managed as a single entity.  The address spaces where the      * 01205800
*      Enclave SRBs are dispatched, as defined by the ENV= parameter  * 01215100
*      of IEAMSCHD, should be non-swappable.                          * 01224400
*                                                                     * 01233700
*      For TYPE=INDEPENDENT Enclaves, a new work business unit of     * 01243000
*      work is created and classified according to the input Connect  * 01252300
*      token's subsystem type and subsystem name, along with whatever * 01261600
*      other attributes are passed via the Classify parameter list.   * 01270900
*      The current home address space is considered the owner.        * 01280200
*                                                                     * 01289500
*      For TYPE=DEPENDENT enclaves, SRM considers the enclave to be   * 01298800
*      part of the current home address space's transaction, which    * 01308100
*      then becomes the owning space.  This space need not be         * 01317400
*      connected to WLM via IWMCONN.                                  * 01326700
*                                                                     * 01336000
*      For TYPE=MONENV enclaves, SRM considers the enclave to be part * 01345300
*      of the address space's transaction which is delayed according  * 01354600
*      to the input monitoring environment, as set when IWMMINIT or   * 01363900
*      IWMMRELA was used. This space becomes the owning space.  This  * 01373200
*      space need not be connected to WLM via IWMCONN.                * 01382500
*                                                                     * 01391800
*      For both TYPE=MONENV and TYPE=DEPENDENT enclaves, SRM will     * 01401100
*      change the enclave to TYPE=INDEPENDENT if the owning address   * 01410400
*      space's transaction ends.                                      * 01419700
*                                                                     * 01429000
*      For both TYPE=MONENV and TYPE=DEPENDENT enclaves, SRM will     * 01438300
*      check the enclave for period switch when the owning address    * 01447600
*      space is swapped in.  If the owning address space is swapped   * 01456900
*      out SRM will continue to accumulate service for any enclaves   * 01466200
*      owned by the space, but will not check the address space and   * 01475500
*      any owned enclave for period switch until the address space is * 01484800
*      swapped in again.  The presence of enclaves does not make the  * 01494100
*      address space appear to be ready from an SRM point of view.    * 01503400
*                                                                     * 01512700
*      Enclaves are deleted if the owning address space terminates.   * 01522000
*      TYPE=INDEPENDENT enclaves are deleted if the owning address    * 01531300
*      space disconnects or the TCB which connected terminates.       * 01540600
*                                                                     * 01550000
*      Enclaves should only be created when this environment is ready * 01600000
*      for execution, and should not be used when prolonged queueing  * 01650000
*      effects are possible prior to the scheduling of the first SRB  * 01691600
*      (IEAMSCHD) or the first TCB join (IWMEJOIN).  "Prolonged"      * 01733200
*      would certainly include times measured in seconds.  The        * 01774800
*      service allows the caller to pass the queueing time prior to   * 01816400
*      creation of the Enclave so that this may be separately         * 01858000
*      reported.                                                      * 01900000
*                                                                     * 02450000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 02500000
*                                                                     * 02550000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 02600000
*                                                                     * 02650000
*01* ENVIRONMENT:                                                     * 02700000
*                                                                     * 02750000
*                                                                     * 02800000
*      Dispatchable unit mode: Task or SRB mode.                      * 02850000
*                                                                     * 02900000
*      Minimum authorization: Supervisor state or program key mask    * 02950000
*                        (PKM) allowing keys 0-7.                     * 03000000
*                                                                     * 03050000
*      AMODE:            31-bit.                                      * 03100000
*                                                                     * 03150000
*      ASC mode:         Primary or Access Register.                  * 03200000
*                                                                     * 03250000
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 03300000
*                                                                     * 03400000
*      Interrupt status: Enabled for I/O and external interrupts.     * 03414200
*                                                                     * 03428400
*      Locks:            No locks held.                               * 03442600
*                                                                     * 03456800
*      Control parameters: Control parameters must be in the primary  * 03471000
*                        address space.                               * 03485200
*                                                                     * 03500000
*                                                                     * 03550000
*                                                                     * 03750000
*01* PROGRAMMING REQUIREMENTS:                                        * 03800000
*                                                                     * 03900000
*                                                                     * 04150000
*    1.  The macro IWMYCON must be included to use this macro.        * 04200000
*                                                                     * 04500000
*    2.  The macro IWMPB must be in the library concatenation, since  * 04506500
*        it is included by IWMYCON.                                   * 04513000
*                                                                     * 04519500
*    3.  Note that the high order halfword of register 0, and the     * 04526000
*        reason code variable when specified, may be non-zero and     * 04532500
*        represents diagnostic data which is NOT part of the external * 04539000
*        interface.  The high order halfword should thus be excluded  * 04545500
*        from comparison with the reason code values described above. * 04552000
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 04558500
*        be used for this purpose.                                    * 04565000
*                                                                     * 04571500
*    4.  All character data, unless otherwise specified, is assumed   * 04578000
*        to be left justified and padded with blanks on the right, as * 04584500
*        needed, to occupy the specified number of bytes.             * 04591000
*                                                                     * 04597500
*                                                                     * 04604000
*                                                                     * 04610500
*01* RESTRICTIONS:                                                    * 04617000
*                                                                     * 04623500
*                                                                     * 04630000
*    1.  This macro may not be used prior to the completion of WLM    * 04636500
*        address space initialization.                                * 04643000
*                                                                     * 04649500
*    2.  This macro may only be used on MVS/ESA SP5.2 or higher       * 04656000
*        levels.                                                      * 04662500
*                                                                     * 04669000
*    3.  This macro may only be used on MVS/ESA HBB6603 or higher     * 04675500
*        levels for TYPE(DEPENDENT|MONENV).                           * 04682000
*                                                                     * 04688500
*    4.  The Connect token from the input classify parameter list     * 04695000
*        must be owned by the current home address space and must be  * 04701500
*        associated with a system key (0-7), as specified on IWMCONN. * 04708000
*        The Classify parameter list and hence the Connect token is   * 04714500
*        only relevant for TYPE=INDEPENDENT Enclaves.                 * 04721000
*                                                                     * 04727500
*    5.  Since this service may only be used by system-like code,     * 04734000
*        some validity checking on the parameter list is not          * 04740500
*        performed. These checks would only be needed if the macro    * 04747000
*        were not used to invoke the service routine.                 * 04753500
*                                                                     * 04760000
*    6.  The variable length fields associated with the classify      * 04766500
*        parameter list (the classify parameter list is only relevant * 04773000
*        for certain options) given by the CLSFY keyword have the     * 04779500
*        following limitations in addition to those documented in     * 04786000
*        IWMCLSFY:                                                    * 04792500
*                                                                     * 04800000
*                                                                     * 04850000
*        o   SUBSYSPM is limited to 255 bytes                         * 04900000
*                                                                     * 04950000
*        o   COLLECTION is limited to 18 bytes                        * 05000000
*                                                                     * 05050000
*        o   CORRELATION is limited to 12 bytes                       * 05100000
*                                                                     * 05150000
*                                                                     * 05200000
*                                                                     * 05250000
*    7.  When TYPE(MONENV) is specified the following apply:          * 05252900
*                                                                     * 05255800
*                                                                     * 05258700
*        o   If the key specified on IWMMCREA was a user key (8-F),   * 05261600
*            then primary or home addressability must exist to the    * 05264500
*            performance block IWMMCREA obtained.  This condition is  * 05267400
*            satisfied by ensuring that the current primary or home   * 05270300
*            address space matches primary (=home) at the time that   * 05273200
*            IWMMCREA was invoked.                                    * 05276100
*                                                                     * 05279000
*        o   The caller must serialize to prevent any delay           * 05281900
*            monitoring services from being invoked concurrently for  * 05284800
*            the environment represented by the monitoring token.     * 05287700
*                                                                     * 05290600
*        o   Only limited checking is done against the input          * 05293500
*            monitoring token.                                        * 05296400
*                                                                     * 05300000
*                                                                     * 05350000
*                                                                     * 05400000
*                                                                     * 05450000
*                                                                     * 05800000
*01* INPUT REGISTER INFORMATION:                                      * 05814200
*                                                                     * 05828400
*    Before issuing the IWMECREA macro, the caller does not have to   * 05842600
*    place any information into any register unless using it in       * 05856800
*    register notation for a particular parameter, or using it as a   * 05871000
*    base register.                                                   * 05885200
*                                                                     * 05899400
*01* OUTPUT REGISTER INFORMATION:                                     * 05913600
*                                                                     * 05927800
*    When control returns to the caller, the GPRs contain:            * 05942000
*                                                                     * 05956200
*                                                                     * 05970400
*    REGISTER  CONTENTS                                               * 05984600
*                                                                     * 05998800
*    0         Reason code if GR15 return code is non-zero            * 06013000
*                                                                     * 06027200
*    1         Used as work registers by the system                   * 06041400
*                                                                     * 06055600
*    2-13      Unchanged                                              * 06069800
*                                                                     * 06084000
*    14        Used as work registers by the system                   * 06098200
*                                                                     * 06112400
*    15        Return code                                            * 06126600
*                                                                     * 06140800
*                                                                     * 06155000
*                                                                     * 06169200
*    When control returns to the caller, the ARs contain:             * 06183400
*                                                                     * 06197600
*                                                                     * 06211800
*    REGISTER  CONTENTS                                               * 06226000
*                                                                     * 06240200
*    0-1       Used as work registers by the system                   * 06254400
*                                                                     * 06268600
*    2-13      Unchanged                                              * 06282800
*                                                                     * 06297000
*    14-15     Used as work registers by the system                   * 06311200
*                                                                     * 06325400
*                                                                     * 06339600
*                                                                     * 06353800
*    Some callers depend on register contents remaining the same      * 06368000
*    before and after issuing a service.  If the system changes the   * 06382200
*    contents of registers on which the caller depends, the caller    * 06396400
*    must save them before issuing the service, and restore them      * 06410600
*    after the system returns control.                                * 06424800
*                                                                     * 06439000
*01* PERFORMANCE IMPLICATIONS:                                        * 06453200
*                                                                     * 06467400
*    None                                                             * 06481600
*                                                                     * 06500000
*01* SYNTAX:                                                          * 06550000
*                                                                     * 06600000
*[xlabel]  IWMECREA  [ TYPE=INDEPENDENT                              * 06630000
*                    |     ,CLSFY=xclsfy                              * 06660000
*                    |     ,ARRIVALTIME=xarrivaltime                  * 06690000
*                    |     ,FUNCTION_NAME=xfunction_name]             * 06720000
*                    [,TYPE=DEPENDENT]                               * 06750000
*                    [,TYPE=MONENV                                   * 06780000
*                          ,MONTKN=xmontkn                            * 06810000
*                         ,ACCESS=PRIMARY                            * 06840000
*                         ,ACCESS=HOME]                              * 06870000
*                      ,ETOKEN=xetoken                                * 06900000
*                     [,RETCODE=xretcode]                             * 06950000
*                     [,RSNCODE=xrsncode]                             * 07000000
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 07025000
*                    [,MF=S]                                         * 07050000
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 07100000
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 07150000
*                                                                     * 07200000
*                                                                     * 07250000
*      Where:                                                         * 07300000
*                                                                     * 07350000
*                                                                     * 07400000
*      [xlabel]                                                       * 07450000
*          is an optional symbol, starting in column 1, that is the   * 07500000
*          name on the IWMECREA macro invocation.  The name must      * 07550000
*          conform to the rules for an ordinary assembler language    * 07600000
*          symbol.                                                    * 07650000
*          DEFAULT: No name.                                          * 07700000
*                                                                     * 07750000
*                                                                     * 07800000
*                                                                     * 07850000
*                                                                     * 07900000
*      [TYPE=INDEPENDENT|DEPENDENT|MONENV                           * 07950000
*          is an optional keyword input which indicates the type of   * 08000000
*          Enclave being created.                                     * 08050000
*          DEFAULT: INDEPENDENT                                       * 08100000
*                                                                     * 08900000
*                                                                     * 08911300
*          [TYPE=INDEPENDENT                                          * 08922600
*              indicates that the Enclave represents a new business   * 08933900
*              unit of work with its own business objectives.         * 08945200
*                                                                     * 08956500
*                                                                     * 08967800
*              CLSFY=xclsfy                                           * 08979100
*                  is the name (RS-type), or address in register      * 08990400
*                  (2)-(12), of a required character input which      * 09001700
*                  contains the classification information in the     * 09013000
*                  format of the parameter list for IWMCLSFY.  NOTE   * 09024300
*                  that this name is the data area name, not its      * 09035600
*                  pointer.  IWMCLSFY MF(M) should be used to         * 09046900
*                  initialize the area prior to invocation of         * 09058200
*                  IWMECREA.  The Classify parameter list must be     * 09069500
*                  from MVS/ESA SP5.2.0 or later.                     * 09080800
*                                                                     * 09092100
*                  Note that the variable length fields associated    * 09103400
*                  with the classify parameter list given by the      * 09114700
*                  CLSFY keyword have the following limitations in    * 09126000
*                  addition to those documented in IWMCLSFY:          * 09137300
*                                                                     * 09150000
*                                                                     * 09200000
*                  o   SUBSYSPM is limited to 255 bytes               * 09250000
*                                                                     * 09300000
*                  o   COLLECTION is limited to 18 bytes              * 09350000
*                                                                     * 09400000
*                  o   CORRELATION is limited to 12 bytes             * 09450000
*                                                                     * 09500000
*                                                                     * 09550000
*                                                                     * 09600000
*                                                                     * 09650000
*                                                                     * 09700000
*                                                                     * 09750000
*              ARRIVALTIME=xarrivaltime                               * 09800000
*                  is the name (RS-type), or address in register      * 09850000
*                  (2)-(12), of a required 64 bit input which         * 09900000
*                  contains the work arrival time in STCK format.     * 09950000
*                  This is the time at which the business work        * 10000000
*                  request is considered to have arrived and from     * 10050000
*                  which point the system evaluates elapsed time for  * 10100000
*                  the work request.                                  * 10150000
*                                                                     * 10650000
*                                                                     * 10700000
*                                                                     * 10750000
*                                                                     * 10800000
*              FUNCTION_NAME=xfunction_name]                          * 10804900
*                  is the name (RS-type), or address in register      * 10809800
*                  (2)-(12), of a required 8 character input which    * 10814700
*                  contains the descriptive name for the function for * 10819600
*                  which the Enclave was created.                     * 10824500
*                                                                     * 10829400
*                                                                     * 10834300
*                                                                     * 10839200
*          [TYPE=DEPENDENT]                                           * 10844100
*              indicates that the Enclave represents a continuation   * 10849000
*              of the business unit of work represented by the        * 10853900
*              current home address space.                            * 10858800
*                                                                     * 10863700
*          [TYPE=MONENV                                               * 10868600
*              indicates that the Enclave represents a continuation   * 10873500
*              of the business unit of work represented by the input  * 10878400
*              monitoring environment.                                * 10883300
*                                                                     * 10888200
*                                                                     * 10893100
*              MONTKN=xmontkn                                         * 10898000
*                  is the name (RS-type), or address in register      * 10902900
*                  (2)-(12), of a required 32 bit input which         * 10907800
*                  contains the delay monitoring token which          * 10912700
*                  describes the current business unit of work.  If   * 10917600
*                  the monitoring environment is related to an        * 10922500
*                  address space, then it must be the current home    * 10927400
*                  address space.                                     * 10932300
*                                                                     * 10937200
*                                                                     * 10942100
*                                                                     * 10947000
*                                                                     * 10951900
*              ACCESS=PRIMARY|HOME]                                 * 10956800
*                  is a required keyword input which describes how to * 10961700
*                  access the monitoring environment.                 * 10966600
*                                                                     * 10971500
*                                                                     * 10976400
*                  ACCESS=PRIMARY                                     * 10981300
*                                                                     * 10986200
*                      indicates that the monitoring environment can  * 10991100
*                      be accessed in the caller's primary address    * 10996000
*                      space.  This would be appropriate if the       * 11000900
*                      monitoring environment was established (by     * 11005800
*                      IWMMCREA) to be used by routines in a specific * 11010700
*                      system key or if it was established to be used * 11015600
*                      in a specific user key in the current primary. * 11020500
*                                                                     * 11025400
*                  ACCESS=HOME]                                       * 11030300
*                                                                     * 11035200
*                      indicates that the monitoring environment must * 11040100
*                      be accessed in the home address space, which   * 11045000
*                      is not the caller's primary address space.     * 11049900
*                      This would be appropriate if the monitoring    * 11054800
*                      environment was established (by IWMMCREA) for  * 11059700
*                      use by a specific user key.                    * 11064600
*                                                                     * 11069500
*                                                                     * 11074400
*                                                                     * 11079300
*                                                                     * 11084200
*                                                                     * 11089100
*                                                                     * 11094000
*                                                                     * 11100000
*                                                                     * 11150000
*                                                                     * 11200000
*                                                                     * 11250000
*      ETOKEN=xetoken                                                 * 11300000
*          is the name (RS-type), or address in register (2)-(12), of * 11350000
*          a required 8 character output which will receive the       * 11400000
*          Enclave token.                                             * 11450000
*                                                                     * 11500000
*                                                                     * 11550000
*                                                                     * 11600000
*                                                                     * 11650000
*      [RETCODE=xretcode]                                             * 11700000
*          is the name (RS-type) of an optional fullword output       * 11750000
*          variable, or register (2)-(12), into which the return code * 11800000
*          is to be copied from GPR 15.                               * 11850000
*                                                                     * 11900000
*                                                                     * 11950000
*                                                                     * 12000000
*                                                                     * 12050000
*      [RSNCODE=xrsncode]                                             * 12100000
*          is the name (RS-type) of an optional fullword output       * 12150000
*          variable, or register (2)-(12), into which the reason code * 12200000
*          is to be copied from GPR 0.                                * 12250000
*                                                                     * 12300000
*                                                                     * 12350000
*                                                                     * 12400000
*                                                                     * 12450000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 12452000
*          is an optional byte input decimal value in the "0-1" range * 12454000
*          that specifies the macro version.  PLISTVER is the only    * 12456000
*          key allowed on the list form of MF and determines which    * 12458000
*          parameter list is generated.  The macro keys associated    * 12460000
*          with each supported version of the macro are listed in     * 12462000
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 12464000
*          instead of a number, and the parameter list will be of the * 12466000
*          largest size currently supported. This size may grow from  * 12468000
*          release to release (thus possibly affecting the amount of  * 12470000
*          storage needed by your program).  If your program can      * 12472000
*          tolerate this, IBM recommends that you always specify MAX  * 12474000
*          when creating the list form parameter list as that will    * 12476000
*          ensure that the list form parameter list is always long    * 12478000
*          enough to hold whatever parameters might be specified on   * 12480000
*          the execute form.                                          * 12482000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 12484000
*          default is the lowest version which allows all of the      * 12486000
*          parameters specified on the invocation to be processed.    * 12488000
*                                                                     * 12490000
*                                                                     * 12492000
*                                                                     * 12494000
*                                                                     * 12496000
*      [MF=S|L|E]                                                   * 12500000
*          is an optional keyword input which specifies the macro     * 12550000
*          form.                                                      * 12600000
*          DEFAULT: S                                                 * 12650000
*                                                                     * 12700000
*                                                                     * 12750000
*          [MF=S]                                                     * 12800000
*              specifies the standard form of the macro.  The "S"     * 12850000
*              form generates code to put the parameters into an      * 12900000
*              in-line parameter list and invoke the desired service. * 12950000
*              Full checking for required macro keys is done along    * 13000000
*              with supplying defaults for omitted optional           * 13050000
*              parameters.                                            * 13100000
*                                                                     * 13150000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 13200000
*              specifies the list form of the macro.  The "L" form    * 13250000
*              defines an area to be used for the parameter list.     * 13300000
*              Only the PLISTVER key may be specified on the          * 13320000
*              invocation.  All other macro parameters are flagged as * 13340000
*              errors.  If PLISTVER is not specified, the original    * 13360000
*              parameter list definition is used.                     * 13380000
*                                                                     * 13400000
*            ,xmfctrl                                                 * 13450000
*              is a required input.  It is the name of a storage area * 13500000
*              for the parameter list.                                * 13550000
*                                                                     * 13600000
*            ,xmfattr|0D                                            * 13650000
*              is an optional 60 character input string that varies   * 13700000
*              from 1 to 60 characters. Use it to force boundary      * 13750000
*              alignment of the parameter list. Use any value that    * 13800000
*              represents a boundary and is valid on an assembler DS  * 13850000
*              pseudo op.                                             * 13900000
*              DEFAULT: 0D which forces the parameter list to a       * 13950000
*              doubleword boundary.                                   * 14000000
*                                                                     * 14050000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 14100000
*              specifies the execute form of the macro.  The "E" form * 14150000
*              generates code to put the parameters into the          * 14200000
*              parameter list specified by xmfctrl and provides full  * 14250000
*              syntax checking with default setting.                  * 14300000
*                                                                     * 14350000
*            ,xmfctrl                                                 * 14400000
*              is a required input.  It is the name (RS-type), or     * 14450000
*              address in register (1)-(12), of a storage area for    * 14500000
*              the parameter list.                                    * 14550000
*                                                                     * 14600000
*            ,COMPLETE                                              * 14650000
*              is an optional keyword input which specifies the       * 14700000
*              degree of macro parameter syntax checking.             * 14750000
*              DEFAULT: COMPLETE                                      * 14800000
*                                                                     * 14850000
*                                                                     * 14900000
*              COMPLETE                                               * 14940000
*                  Checking for required macro keys is done and       * 14980000
*                  defaults are supplied for omitted optional         * 15020000
*                  parameters.                                        * 15060000
*                                                                     * 15100000
*                                                                     * 15150000
*                                                                     * 15200000
*                                                                     * 15250000
*                                                                     * 15300000
*                                                                     * 15350000
*                                                                     * 15366600
*01* ABEND CODES:  None.                                              * 15383200
*                                                                     * 15400000
*01* RETURN CODES:                                                    * 15450000
*                                                                     * 15500000
*                                                                     * 15550000
*            0    Name: IwmRetCodeOk                                  * 15600000
*                                                                     * 15650000
*                 Meaning: Successful completion.                     * 15700000
*                                                                     * 15800000
*                 Action: None required.                              * 15810000
*                                                                     * 15820000
*            8    Name: IwmRetCodeInvocError                          * 15830000
*                                                                     * 15840000
*                 Meaning: Invalid invocation environment or          * 15850000
*                 parameters.                                         * 15860000
*                                                                     * 15870000
*                                                                     * 15880000
*                 HEX REASON  MEANING/ACTION                          * 15890000
*                 CODE                                                * 15900000
*                                                                     * 15950000
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 15975000
*                                                                     * 16000000
*                             Meaning: Caller is disabled.            * 16050000
*                                                                     * 16150000
*                             Action: Avoid requesting this function  * 16183300
*                             while disabled.                         * 16216600
*                                                                     * 16250000
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 16300000
*                                                                     * 16400000
*                             Meaning: Caller is locked.              * 16450000
*                                                                     * 16550000
*                             Action: Avoid requesting this function  * 16600000
*                             while locked.                           * 16650000
*                                                                     * 16750000
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 16800000
*                                                                     * 16900000
*                             Meaning:  Error accessing parameter     * 16950000
*                             list.                                   * 17000000
*                                                                     * 17100000
*                             Action: Check for possible storage      * 17150000
*                             overlay.                                * 17200000
*                                                                     * 17456200
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 17465500
*                                                                     * 17474800
*                             Meaning:  Monitoring environment does   * 17475000
*                             not pass short form verification.       * 17475200
*                                                                     * 17475400
*                             Action: Check for possible storage      * 17475600
*                             overlay.                                * 17475800
*                                                                     * 17476000
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 17476200
*                                                                     * 17476400
*                             Meaning:  Connect token from the input  * 17476600
*                             classify parameter list does not pass   * 17476800
*                             validity checking.                      * 17477000
*                                                                     * 17477200
*                             Action: Check for possible storage      * 17477400
*                             overlay.                                * 17477600
*                                                                     * 17477800
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 17478000
*                                                                     * 17478200
*                             Meaning: Caller invoked service but was * 17478400
*                             in 24 bit addressing mode.              * 17478600
*                                                                     * 17478800
*                             Action: Request this function only when * 17479000
*                             you are in 31 bit addressing mode.      * 17479200
*                                                                     * 17479400
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 17479600
*                                                                     * 17479800
*                             Meaning: Version number in parameter    * 17480000
*                             list is not valid.                      * 17480200
*                                                                     * 17480400
*                             Action: Check for possible storage      * 17480600
*                             overlay of the parameter list.          * 17480800
*                                                                     * 17481000
*                 xxxx0836    Name: IwmRsnCodeMaxEnclave              * 17481200
*                                                                     * 17481400
*                             Meaning:  Enclave could not be created  * 17481600
*                             because the Enclave limit has been      * 17481800
*                             reached.                                * 17482000
*                                                                     * 17482200
*                             Action: Check for possible problems     * 17482400
*                             wherein Enclaves are not being deleted  * 17482600
*                             as expected or excessive numbers of     * 17482800
*                             Enclaves are being created in a loop.   * 17483000
*                                                                     * 17483200
*                 xxxx0837    Name: IwmRsnCodeUserKeyConntkn          * 17483400
*                                                                     * 17483600
*                             Meaning:  Connect token from the input  * 17483800
*                             classify parameter list is associated   * 17484000
*                             with a user key.                        * 17484200
*                                                                     * 17484400
*                             Action: Invoke the function with a      * 17484600
*                             token associated with a system key.     * 17484800
*                                                                     * 17485000
*                 xxxx0838    Name: IwmRsnCodeClsfyAreaTooBig         * 17485200
*                                                                     * 17485400
*                             Meaning:  Input area associated with    * 17485600
*                             classification information is larger    * 17485800
*                             than supported.                         * 17486000
*                                                                     * 17486200
*                             Action: Invoke the function with an     * 17486400
*                             area of the proper size.  Check for     * 17486600
*                             possible storage overlay.               * 17486800
*                                                                     * 17487000
*                 xxxx0839    Name: IwmRsnCodeClsfyPlTooSmall         * 17487200
*                                                                     * 17487400
*                             Meaning:  Input Classify parameter list * 17487600
*                             is too small.                           * 17487800
*                                                                     * 17488000
*                             Action: Invoke the function with an     * 17488200
*                             area of the proper size.  Check for     * 17488400
*                             possible storage overlay.               * 17488600
*                                                                     * 17488800
*                 xxxx083B    Name: IwmRsnCodeHomeNotOwnConn          * 17489000
*                                                                     * 17489200
*                             Meaning:  Home address space does not   * 17489400
*                             own the connect token from the input    * 17489600
*                             classify parameter list.                * 17489800
*                                                                     * 17490000
*                             Action: Invoke the function with the    * 17490200
*                             correct home address space.             * 17490400
*                                                                     * 17490600
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 17490800
*                                                                     * 17491000
*                             Meaning:  Caller's space connection is  * 17491200
*                             not enabled for this service.           * 17491400
*                                                                     * 17491600
*                             Action: Avoid requesting this function  * 17491800
*                             under the input connection.  IWMCONN    * 17492000
*                             options must be specified previously to * 17492200
*                             enable this service.                    * 17492400
*                                                                     * 17492600
*                 xxxx085D    Name: IwmRsnCodeMonenvNotHome           * 17492800
*                                                                     * 17493000
*                             Meaning:  The input monitoring          * 17493200
*                             environment is related to an address    * 17493400
*                             space other than home.                  * 17493600
*                                                                     * 17493800
*                             Action: None required.                  * 17494000
*                                                                     * 17500000
*                                                                     * 17550000
*                                                                     * 17600000
*            C    Name: IwmRetCodeEnvError                            * 17625000
*                                                                     * 17650000
*                 Meaning: Environmental error.                       * 17700000
*                                                                     * 17750000
*                                                                     * 17783300
*                 HEX REASON  MEANING/ACTION                          * 17816600
*                 CODE                                                * 17850000
*                                                                     * 17900000
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 17925000
*                                                                     * 17950000
*                             Meaning:  Storage is not available for  * 17985000
*                             the request.                            * 18020000
*                                                                     * 18055000
*                             Action: There is a storage shortage.    * 18060000
*                             The function may work successfully at a * 18065000
*                             later time.                             * 18070000
*                                                                     * 18075000
*                 xxxx0C0C    Name: IwmRsnCodeClassifyFail            * 18075700
*                                                                     * 18076400
*                             Meaning:  Received a non-zero return    * 18077100
*                             code from the classification service,   * 18077800
*                             IWMCLSFY.                               * 18078500
*                                                                     * 18079200
*                             Action: No action required.  Reinvoking * 18079900
*                             the function later may succeed.         * 18080600
*                                                                     * 18081300
*                 xxxx0C0D    Name: IwmRsnCodeBadClsfy                * 18082000
*                                                                     * 18082700
*                             Meaning:  Classification apparently can * 18083400
*                             not access the current policy,          * 18084100
*                             possibly due to a policy switch in      * 18084800
*                             progress.                               * 18085500
*                                                                     * 18086200
*                             Action: Invoke the function when the    * 18086900
*                             conditions are alleviated.              * 18087600
*                                                                     * 18088300
*                 xxxx0C20    Name: IwmRsnCodeDepClassifyFail         * 18089000
*                                                                     * 18089700
*                             Meaning:  Unable to obtain              * 18090400
*                             classification attributes for a         * 18091100
*                             dependent enclave.                      * 18091800
*                                                                     * 18092500
*                             Action: None required.                  * 18093200
*                                                                     * 18093900
*                 xxxx0C21    Name: IwmRsnCodeNoMonEnvErr             * 18094600
*                                                                     * 18095300
*                             Meaning:  Input monitoring token        * 18096000
*                             indicates no monitoring environment was * 18096700
*                             established.                            * 18097400
*                                                                     * 18098100
*                             Action: None required.                  * 18098800
*                                                                     * 18100000
*                                                                     * 18150000
*                                                                     * 18200000
*            10   Name: IwmRetCodeCompError                           * 18225000
*                                                                     * 18250000
*                 Meaning: Component error.                           * 18300000
*                                                                     * 18350000
*                 Action: No action required.  The function may be    * 18366600
*                 successful if invoked again.                        * 18383200
*                                                                     * 18400000
*                                                                     * 18450000
*                                                                     * 18500000
*01* REASON CODES:                                                    * 18550000
*                                                                     * 18600000
*       A unique reason code will be returned whenever the return     * 18650000
*       code is non-zero.  Reason codes, as appropriate, are defined  * 18700000
*       under their corresponding return code.  Reason code and       * 18750000
*       return code constants are defined within IWMYCON.  Note that  * 18800000
*       the high order halfword of register 0, and the reason code    * 18850000
*       variable when specified, may be non-zero and represents       * 18900000
*       diagnostic data which is NOT part of the external interface.  * 18950000
*       The high order halfword should thus be excluded from          * 19000000
*       comparison with the reason code values described above.  The  * 19050000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 19100000
*       used for this purpose.                                        * 19150000
*                                                                     * 19200000
*01* MODULE TYPE:  ASSEM MACRO                                        * 19250000
*                                                                     * 19300000
*02*   PROCESSOR:  ASSEM                                              * 19350000
*                                                                     * 19400000
*01* COMPONENT:  SCWLM                                                * 19450000
*                                                                     * 19500000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 19550000
*                                                                     * 19600000
*01* EXAMPLES:                                                        * 19616600
*                                                                     * 19633200
*01* MACRO USAGE NOTES:                                               * 19650000
*                                                                     * 19700000
*                                                                     * 19750000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 19800000
*        global macro variable.  Any value other than 'NO' will       * 19850000
*        result in the macro expansion being printed.  The default is * 19900000
*        'YES'.  The following examples illustrate how the ZPRINT     * 19950000
*        variable should be set.                                      * 20000000
*                                                                     * 20050000
*                    GBLC &ZPRINT                                     * 20100000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 20150000
*                                                                     * 20200000
*                                                                     * 20350000
*    2.  The IWMECREA macro supports multiple versions. The macro key * 20359000
*        list  below  contains the version level in which the key was * 20368000
*        first  introduced.  Positionals  are  identified by the word * 20377000
*        'Positional'  followed by the numeric value of its position. * 20386000
*        Nested  positionals  are  preceded  by their outer key.  The * 20395000
*        lowest value represents the original version and the highest * 20404000
*        value  represents  the  most  recent version of the IWMECREA * 20413000
*        macro.    When  specifying  PLISTVER,  be sure that it is as * 20422000
*        least  as high as the highest version number of all the keys * 20431000
*        being used.                                                  * 20440000
*                                                                     * 20450000
*        VERSION   KEY                                                * 20500000
*                                                                     * 20600000
*              0      ARRIVALTIME                                     * 20650000
*                     CLSFY                                           * 20700000
*                     ETOKEN                                          * 20750000
*                     FUNCTION_NAME                                   * 20800000
*              1      ACCESS                                          * 20850000
*                     MONTKN                                          * 20900000
*                     TYPE                                            * 20950000
*                                                                     * 21200000
*                                                                     * 21250000
*                                                                     * 21300000
*01* CHANGE ACTIVITY:                                                 * 21350000
*                                                                     * 21400000
*   Flag LineItem  FMID    Date   ID    Comment                       * 21450000
*                                                                     * 21500000
*    $L0=ENCLV    HBB5520 940103 PD16:  Enclave Create                * 21550000
*    $L1=WLMP     HBB6603 950127 PDDE:  Business Unit-of-Work         * 21566600
*                                         Management                  * 21583200
****** END OF SPECIFICATIONS *****************************************/ 21600000
*/********************************************************************* 21650000
         MACRO                                                          21700000
&XLABEL  IWMECREA &TYPE=,&CLSFY=,&ARRIVALTIME=,&FUNCTION_NAME=,        *21737500
               &MONTKN=,&ACCESS=,&ETOKEN=,&RETCODE=,&RSNCODE=,         *21775000
               &PLISTVER=,&MF=                                          21812500
.*                                                                      21850000
*                   MACDATE -09/05/96-<1>                               21900000
.*                                                                      21950000
.*******************************************************************    22000000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        22050000
.*******************************************************************    22100000
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              22150000
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                22200000
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        22250000
.*                                                                      22300000
                   GBLC  &ZIWMECREA  YES=MACRO USED AT LEAST ONCE       22350000
.*******************************************************************    22400000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          22450000
.*******************************************************************    22500000
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            22550000
                   LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS       22600000
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         22650000
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        22700000
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        22750000
                   LCLA  &ZAWRK      USED AS A WORK AREA                22800000
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             22850000
                   LCLA  &ZN         NUMERIC WORK VARIABLE              22900000
                   LCLC  &ZC         CHARACTER WORK VARIABLE            22950000
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        23000000
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            23050000
                   LCLA  &ZMACRET    MACRO RETURN CODE                  23100000
&ZMACRET           SETA  0           ASSUME NO ERRORS                   23150000
.*                                                                      23200000
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      23250000
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         23300000
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              23350000
                   LCLC  &ZENDBASEPL            End of base PL          23354100
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              23358200
.*******************************************************************    23362300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             23366400
.*******************************************************************    23370500
                   LCLA  &ZI         INDEX FOR ARRAY                    23374600
                   LCLA  &ZJ         INDEX FOR PARMS                    23378700
                   LCLA  &ZK         INDEX FOR PARSE                    23382800
                   LCLA  &ZLO        LOW RANGE VALUE                    23386900
                   LCLA  &ZHI        HIGH RANGE VALUE                   23391000
                   LCLC  &ZW         WORK AREA FOR PARM                 23395100
.********************************************************************   23400000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 23450000
.********************************************************************   23500000
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            23550000
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     23600000
.*                                                                      23650000
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     23700000
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      23750000
                   SPLEVEL  TEST                                        23800000
.ZSYS2             ANOP  ,                                              23850000
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          23900000
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          23950000
                   SYSSTATE TEST                                        24000000
                   AGO   .ZSYS4                                         24050000
.ZSYS3             ANOP  ,                                              24100000
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            24150000
.ZSYS4             ANOP  ,                                              24200000
.*******************************************************************    24250000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   24300000
.*******************************************************************    24350000
                   LCLC  &XTYPE      ++ VALUE                           24400000
                   LCLC  &XCLSFY     ++ NAME                            24450000
                   LCLC  &XARRIVALTIME          ++ NAME                 24500000
                   LCLC  &XFUNCTION_NAME        ++ NAME                 24600000
                   LCLC  &XMONTKN    ++ NAME                            24616600
                   LCLC  &XACCESS    ++ VALUE                           24633200
                   LCLC  &XETOKEN    ++ NAME                            24650000
                   LCLC  &XRETCODE   ++ NAME                            24700000
                   LCLC  &XRSNCODE   ++ NAME                            24750000
                   LCLA  &XPLISTVER  ++ VALUE                           24775000
                   LCLC  &XMF        ++ VALUE                           24800000
                   LCLC  &XMFCTRL    ++ NAME                            24850000
                   LCLC  &XMFATTR    ++ VALUE                           24900000
                   LCLC  &XMFSCK     ++ VALUE                           24950000
.*******************************************************************    25000000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           25050000
.*******************************************************************    25100000
                   LCLC  &ZXTYPE     ++ INPUT VALUE                     25150000
                   LCLC  &ZXCLSFY    ++ INPUT NAME                      25200000
                   LCLC  &ZXARRIVALTIME         ++ INPUT NAME           25250000
                   LCLC  &ZXFUNCTION_NAME       ++ INPUT NAME           25350000
                   LCLC  &ZXMONTKN   ++ INPUT NAME                      25366600
                   LCLC  &ZXACCESS   ++ INPUT VALUE                     25383200
                   LCLC  &ZXETOKEN   ++ OUTPUT NAME                     25400000
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     25450000
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     25500000
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          25525000
                   LCLC  &ZXMF       ++ INPUT VALUE                     25550000
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      25600000
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     25650000
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     25700000
.********************************************************************   25700600
.***AC.PLV01  PROCESS PLISTVER                                      *   25701200
.********************************************************************   25701800
&XPLISTVER      SETA  0                                                 25702400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       25703000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   25703600
&XPLISTVER      SETA  1                                                 25704200
.ZPLV0          ANOP  ,                                                 25704800
.*                                                                      25705400
                AIF   ('&TYPE' EQ '').ZPLV1E                            25706000
                AIF   (&XPLISTVER GE 1).ZPLV1E                          25706600
&XPLISTVER      SETA  1                                                 25707200
.ZPLV1E         ANOP  ,                                                 25707800
.*                                                                      25708400
                AIF   ('&MONTKN' EQ '').ZPLV2E                          25709000
                AIF   (&XPLISTVER GE 1).ZPLV2E                          25709600
&XPLISTVER      SETA  1                                                 25710200
.ZPLV2E         ANOP  ,                                                 25710800
.*                                                                      25711400
                AIF   ('&ACCESS' EQ '').ZPLV3E                          25712000
                AIF   (&XPLISTVER GE 1).ZPLV3E                          25712600
&XPLISTVER      SETA  1                                                 25713200
.ZPLV3E         ANOP  ,                                                 25713800
.*                                                                      25714400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      25715000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      25715600
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  25716200
.*-------------------------------------------------------------------   25716800
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 25717400
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                25718000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 25718600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 25719200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               25719800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                25720400
                AGO   .ZPVCK2                                           25721000
.ZPVCK3         ANOP  ,                                                 25721600
.*-------------------------------------------------------------------   25722200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  25722800
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                25723400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 25724000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         25724600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 25725200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                25725800
                AGO   .ZPVCKE                                           25726400
.ZPVCK2         ANOP  ,                                                 25727000
.*-------------------------------------------------------------------   25727600
&ZCVAL          SETC  '&PLISTVER(1)'                                    25728200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             25728800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             25729400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        25729800
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      25730200
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     25730600
.ZPVCK6         ANOP  ,                                                 25731200
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                25731800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 25732400
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         25733000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         25733600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                25734200
&XPLISTVER      SETA  1                                                 25734800
                AGO   .ZPVCKE                                           25735400
.*-------------------------------------------------------------------   25736000
.ZPVCK4A        ANOP  ,                                                 25736600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        25737200
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                25737800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               25738400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          25739000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 25739600
                MNOTE 8,' &ZMS IS REQUIRED.'                            25740200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                25740800
                AGO   .ZPVCK5                                           25741400
.ZPVCK4         ANOP  ,                                                 25742000
&XPLISTVER      SETA  &PLISTVER(1)                                      25742600
.ZPVCK5         ANOP  ,                                                 25743200
.ZPVCKE         ANOP  ,                                                 25743800
.********************************************************************   25750000
.***AG.MF01 PROCESS MF MACRO FORMS                                      25800000
.********************************************************************   25850000
                   ACTR  10000                                          25900000
.*------------------------------------------------------------------    25950000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           26000000
&XMF               SETC  ''          INITIALIZE XVARIABLE               26050000
.*-------------------------------------------------------------------   26100000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           26150000
.ZG38              ANOP  ,                                              26200000
&ZTLC              SETC 'S'                                             26250000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG39                     26300000
&XMF               SETC  'S'         SET KEYWORD                        26350000
                   AIF   (N'&MF LE 1).ZG38A     CK NUM                  26400000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      26450000
&ZMS               SETC  '&ZMS.&MF"'                                    26500000
&ZMS               SETC  '&ZMS "MF"'                                    26550000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            26600000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        26650000
.ZG38A             ANOP  ,                                              26700000
.*-------------------------------------------------------------------   26750000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           26800000
.ZG39              ANOP  ,                                              26850000
&ZTLC              SETC 'L'                                             26900000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG46                     26950000
&XMF               SETC  'L'         SET KEYWORD                        27000000
                   AIF   (N'&MF LE 3).ZG39A     CK NUM                  27050000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      27100000
&ZMS               SETC  '&ZMS.&MF"'                                    27150000
&ZMS               SETC  '&ZMS "MF"'                                    27200000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           27250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        27300000
.ZG39A             ANOP  ,                                              27350000
.*-------------------------------------------------------------------   27400000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     27450000
                   AIF   (N'&SYSLIST NE 0).ZG39B  POSITIONALS?          27497000
                   AIF   ('&TYPE' NE '').ZG39B  KEYS?                   27544000
                   AIF   ('&CLSFY' NE '').ZG39B  KEYS?                  27591000
                   AIF   ('&ARRIVALTIME' NE '').ZG39B  KEYS?            27638000
                   AIF   ('&FUNCTION_NAME' NE '').ZG39B  KEYS?          27685000
                   AIF   ('&MONTKN' NE '').ZG39B  KEYS?                 27732000
                   AIF   ('&ACCESS' NE '').ZG39B  KEYS?                 27779000
                   AIF   ('&ETOKEN' NE '').ZG39B  KEYS?                 27826000
                   AIF   ('&RETCODE' NE '').ZG39B  KEYS?                27873000
                   AIF   ('&RSNCODE' NE '').ZG39B  KEYS?                27920000
                   AGO    .ZG39C     INVOCATION OKAY                    27967000
.ZG39B             ANOP  ,                                              28014000
&ZMS               SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE           28061000
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           28108000
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      28155000
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         28202000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        28250000
.ZG39C             ANOP  ,                                              28300000
.*-------------------------------------------------------------------   28350000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   28400000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      28450000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      28500000
                   AIF   (N'&MF(2) GT 1).ZG41B  MULTI PARMS             28550000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      28600000
.ZG41B             AIF   (K'&MF(2) GT 0).ZG41C                          28650000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    28700000
&ZMS               SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*               28750000
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            28800000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   28850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        28900000
.ZG41C             ANOP  ,                                              28950000
.*-------------------------------------------------------------------   29000000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               29050000
                   AIF   (K'&ZXMFCTRL LE 0).ZG41P  NOT I/O              29100000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG41P                 29150000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    29200000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      29250000
&ZMS               SETC  '&ZMS.&MF"'                                    29300000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      29350000
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              29400000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        29450000
.ZG41P             ANOP  ,                                              29500000
.*-------------------------------------------------------------------   29550000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      29600000
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      29650000
&XMFATTR           SETC  '0D'                                           29700000
                   AIF   (K'&MF(3) LE 0).ZG44B  PARM                    29750000
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      29800000
                   AIF   (N'&MF(3) GT 1).ZG44B  MULTI PARMS             29850000
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      29900000
.ZG44B             ANOP  ,                                              29950000
.*-------------------------------------------------------------------   30000000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  30050000
                   AIF   (K'&ZXMFATTR LE 0).ZG44P  NOT I/O              30100000
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG44P                 30150000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    30200000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      30250000
&ZMS               SETC  '&ZMS.&MF"'                                    30300000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      30350000
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              30400000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        30450000
.ZG44P             ANOP  ,                                              30500000
.*-------------------------------------------------------------------   30550000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 30600000
                   AIF   (K'&ZXMFATTR LE 0).ZG44S  NOT I/O              30650000
                   AIF   (K'&XMFATTR LE 60).ZG44S  LNG OK               30700000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    30750000
&ZMS               SETC  '"MF='      *KLNGA* MNOTE                      30800000
&ZMS               SETC  '&ZMS.&MF"'                                    30850000
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          30900000
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             30950000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        31000000
.ZG44S             ANOP  ,                                              31050000
.*-------------------------------------------------------------------   31100000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           31150000
.ZG46              ANOP  ,                                              31200000
&ZTLC              SETC 'E'                                             31250000
                   AIF   ('&MF(1)' NE '&ZTLC').ZG54                     31300000
&XMF               SETC  'E'         SET KEYWORD                        31350000
                   AIF   (N'&MF LE 3).ZG46A     CK NUM                  31400000
&ZMS               SETC  '"MF='      *KPOSA* MNOTE                      31450000
&ZMS               SETC  '&ZMS.&MF"'                                    31500000
&ZMS               SETC  '&ZMS "MF"'                                    31550000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           31600000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        31650000
.ZG46A             ANOP  ,                                              31700000
.*-------------------------------------------------------------------   31750000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   31800000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      31850000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      31900000
                   AIF   (N'&MF(2) GT 1).ZG48B  MULTI PARMS             31950000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      32000000
.ZG48B             AIF   (K'&MF(2) GT 0).ZG48C                          32050000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    32100000
&ZMS               SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*               32150000
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            32200000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   32250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        32300000
.ZG48C             ANOP  ,                                              32350000
.*-------------------------------------------------------------------   32400000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              32450000
                   AIF   (K'&ZXMFCTRL LE 0).ZG48R  NOT I/O              32500000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG48R                 32550000
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     32600000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG48P                   32650000
                   AIF   (K'&ZCGPR GT 2).ZG48Q                          32700000
                   AIF   ('&ZCGPR' EQ '0').ZG48Q                        32750000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  32800000
                   AIF   (T'&ZCGPR NE 'N').ZG48Q  INVALID REG NAME      32850000
.ZG48P             ANOP  ,                                              32900000
                   AIF   (T'&ZCGPR NE 'N').ZG48R  NON NUMERIC           32950000
                   AIF   ('&ZCGPR' LT '1').ZG48Q                        33000000
                   AIF   ('&ZCGPR' LE '12').ZG48R                       33050000
.ZG48Q             ANOP  ,                                              33100000
&ZMS               SETC  '"MF='      *KGPRA* MNOTE                      33150000
&ZMS               SETC  '&ZMS.&MF"'                                    33200000
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      33250000
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               33300000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        33350000
.ZG48R             ANOP  ,                                              33400000
.*-------------------------------------------------------------------   33450000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             33500000
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               33550000
.ZG52A   AIF   ('&MF(3)' NE 'COMPLETE').ZG53A                           33600000
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        33650000
.*-------------------------------------------------------------------   33700000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             33750000
.ZG53A             AIF   (K'&XMFSCK GT 0).ZG53C  KEYWORD                33800000
                   AIF   (K'&MF(3) LE 0).ZG53B                          33850000
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      33900000
&ZMS               SETC  '&ZMS.&MF"'                                    33950000
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      34000000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            34050000
&ZMS               SETC  '&ZMS "COMPLETE".'     VALID KEYWORD           34100000
                   MNOTE 8,' &ZMS '                                     34150000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        34200000
.ZG53B             ANOP  ,                                              34250000
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                34300000
.ZG53C             ANOP  ,                                              34350000
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      34400000
.*------------------------------------------------------------------    34450000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           34500000
.ZG54              ANOP  ,                                              34550000
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      34600000
                   AIF   (K'&XMF GT 0).ZG54E    VALID ARG               34650000
                   AIF   (T'&MF EQ 'O').ZG54D   OMITTED                 34700000
&ZASYSLNDX         SETA  0                                              34750000
.ZG54A             ANOP  ,           POSITIONAL MACRO KEY               34800000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   34850000
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG54C               34900000
&ZTLC              SETC 'MF'                                            34950000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG54A      35000000
.ZG54B             ANOP  ,                                              35050000
&ZXMF              SETC  ''          RESET IN/OUTPUT                    35100000
&ZMS               SETC  'THE "MF" KEY'         *KOPTA* MNOTE           35150000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        35200000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               35250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        35300000
                   AGO   .ZG54E                                         35350000
.ZG54C             ANOP  ,                                              35400000
&ZXMF              SETC  ''          RESET IN/OUTPUT                    35450000
&ZMS               SETC  '"MF='      *KUKWA* MNOTE                      35500000
&ZMS               SETC  '&ZMS.&MF"'                                    35550000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      35600000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            35650000
&ZMS               SETC  '&ZMS "S",'            VALID KEYWORD           35700000
&ZMS               SETC  '&ZMS "L",'            VALID KEYWORD           35750000
&ZMS               SETC  '&ZMS OR "E".'         VALID KEYWORD           35800000
                   MNOTE 8,' &ZMS '                                     35850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        35900000
                   AGO   .ZG54E                                         35950000
.ZG54D             ANOP  ,                                              36000000
&XMF               SETC  'S'         SET DEFAULT KEYWORD                36050000
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  36100000
.ZG54E             ANOP  ,                                              36150000
.********************************************************************   36200000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 36250000
.********************************************************************   36300000
                   ACTR  10000                                          36350000
.*-------------------------------------------------------------------   36400000
.***AG.MF03 MF=(SLE)                                                    36450000
                   AIF   ('&XMF' EQ 'L').ZGMFX                          36500000
.*------------------------------------------------------------------    36501500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36503000
&XTYPE             SETC  ''          INITIALIZE XVARIABLE               36504500
.*-------------------------------------------------------------------   36506000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36507500
.ZG3               ANOP  ,                                              36509000
                   AIF   (K'&TYPE(1) LE 0).ZG3A                         36510500
&ZTLC              SETC 'INDEPENDENT'                                   36512000
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZG13                   36513500
&XTYPE             SETC  'INDEPENDENT'          SET KEYWORD             36515000
                   AIF   (N'&TYPE LE 1).ZG3A    CK NUM                  36516500
&ZMS               SETC  '"TYPE='    *KPOSA* MNOTE                      36518000
&ZMS               SETC  '&ZMS.&TYPE"'                                  36519500
&ZMS               SETC  '&ZMS "TYPE"'                                  36521000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            36522500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        36524000
.ZG3A              ANOP  ,                                              36525500
.*------------------------------------------------------------------    36527000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36528500
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        36530000
.ZG3A0             AIF   (K'&MONTKN LE 0).ZG3A1  OK                     36531500
&ZCVAL             SETC '&ZCVAL MONTKN'         INCORRECT KEY USED      36533000
.ZG3A1             AIF   (K'&ACCESS LE 0).ZG3A2  OK                     36534500
&ZCVAL             SETC '&ZCVAL ACCESS'         INCORRECT KEY USED      36536000
.ZG3A2             AIF   (K'&ZCVAL LE 0).ZG3A3  OK                      36537500
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          36539000
&ZMS               SETC  '"TYPE'     *KMEIA* MNOTE                      36540500
&ZMS               SETC  '&ZMS.=&TYPE"'                                 36542000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           36543500
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           36545000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        36546500
.ZG3A3             ANOP  ,                                              36548000
.*----------------------------------------------------------------***   36550000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 36600000
                   AIF   (N'&CLSFY LE 1).ZG5A   CK NUM                  36650000
&ZMS               SETC  '"CLSFY='   *KPOSA* MNOTE                      36700000
&ZMS               SETC  '&ZMS.&CLSFY"'                                 36750000
&ZMS               SETC  '&ZMS "CLSFY"'                                 36800000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            36850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        36900000
.ZG5A              ANOP  ,                                              39100000
.*-------------------------------------------------------------------   39150000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     39200000
&ZXCLSFY           SETC  'INPUT'     SET IN/OUTPUT                      39250000
&XCLSFY            SETC  '&CLSFY(1)'            SET XVARIABLE           39300000
                   AIF   (N'&CLSFY GT 1).ZG5B   MULTI PARMS             39350000
&XCLSFY            SETC  '&CLSFY'    SET XVARIABLE                      39400000
.ZG5B              AIF   (K'&CLSFY(1) GT 0).ZG5C                        39450000
&ZXCLSFY           SETC  ''          RESET IN/OUTPUT                    39500000
&ZMS               SETC  'WHEN "INDEPENDENT" IS SPECIFIED'  *KRQDA*     39550000
&ZMS               SETC  '&ZMS , "CLSFY" KEY AND ITS ARGUMENT'          39600000
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        39650000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        39700000
.ZG5C              ANOP  ,                                              39750000
.*-------------------------------------------------------------------   39800000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                39850000
                   AIF   (K'&ZXCLSFY LE 0).ZG5R  NOT I/O                39900000
                   AIF   ('&XCLSFY'(1,1) NE '(').ZG5R                   39950000
&ZCGPR             SETC  '&XCLSFY'(2,K'&XCLSFY-2)                       40000000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                    40050000
                   AIF   (K'&ZCGPR GT 2).ZG5Q                           40100000
                   AIF   ('&ZCGPR' EQ '0').ZG5Q                         40150000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  40200000
                   AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME       40250000
.ZG5P              ANOP  ,                                              40300000
                   AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC            40350000
                   AIF   ('&ZCGPR' LT '2').ZG5Q                         40400000
                   AIF   ('&ZCGPR' LE '12').ZG5R                        40450000
.ZG5Q              ANOP  ,                                              40500000
&ZMS               SETC  '"CLSFY='   *KGPRA* MNOTE                      40550000
&ZMS               SETC  '&ZMS.&CLSFY"'                                 40600000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      40650000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               40700000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        40750000
.ZG5R              ANOP  ,                                              40800000
.*----------------------------------------------------------------***   40850000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 40900000
                   AIF   (N'&ARRIVALTIME LE 1).ZG8A  CK NUM             40950000
&ZMS               SETC  '"ARRIVALTIME='        *KPOSA* MNOTE           41000000
&ZMS               SETC  '&ZMS.&ARRIVALTIME"'                           41050000
&ZMS               SETC  '&ZMS "ARRIVALTIME"'                           41100000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            41150000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        41200000
.ZG8A              ANOP  ,                                              41250000
.*-------------------------------------------------------------------   41300000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     41350000
&ZXARRIVALTIME     SETC  'INPUT'     SET IN/OUTPUT                      41400000
&XARRIVALTIME      SETC  '&ARRIVALTIME(1)'      SET XVARIABLE           41450000
                   AIF   (N'&ARRIVALTIME GT 1).ZG8B  MULTI PARMS        41500000
&XARRIVALTIME      SETC  '&ARRIVALTIME'         SET XVARIABLE           41550000
.ZG8B              AIF   (K'&ARRIVALTIME(1) GT 0).ZG8C                  41600000
&ZXARRIVALTIME     SETC  ''          RESET IN/OUTPUT                    41650000
&ZMS               SETC  'WHEN "INDEPENDENT" IS SPECIFIED'  *KRQDA*     41700000
&ZMS               SETC  '&ZMS , "ARRIVALTIME" KEY AND ITS ARGUMENT'    41750000
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        41800000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        41850000
.ZG8C              ANOP  ,                                              41900000
.*-------------------------------------------------------------------   41950000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                42000000
                   AIF   (K'&ZXARRIVALTIME LE 0).ZG8R  NOT I/O          42050000
                   AIF   ('&XARRIVALTIME'(1,1) NE '(').ZG8R             42100000
&ZCGPR             SETC  '&XARRIVALTIME'(2,K'&XARRIVALTIME-2)           42150000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                    42200000
                   AIF   (K'&ZCGPR GT 2).ZG8Q                           42250000
                   AIF   ('&ZCGPR' EQ '0').ZG8Q                         42300000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  42350000
                   AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME       42400000
.ZG8P              ANOP  ,                                              42450000
                   AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC            42500000
                   AIF   ('&ZCGPR' LT '2').ZG8Q                         42550000
                   AIF   ('&ZCGPR' LE '12').ZG8R                        42600000
.ZG8Q              ANOP  ,                                              42650000
&ZMS               SETC  '"ARRIVALTIME='        *KGPRA* MNOTE           42700000
&ZMS               SETC  '&ZMS.&ARRIVALTIME"'                           42750000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      42800000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               42850000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        42900000
.ZG8R              ANOP  ,                                              42950000
.*----------------------------------------------------------------***   43000000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 43050000
                   AIF   (N'&FUNCTION_NAME LE 1).ZG11A  CK NUM          43100000
&ZMS               SETC  '"FUNCTION_NAME='      *KPOSA* MNOTE           43150000
&ZMS               SETC  '&ZMS.&FUNCTION_NAME"'                         43200000
&ZMS               SETC  '&ZMS "FUNCTION_NAME"'                         43250000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            43300000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        43350000
.ZG11A             ANOP  ,                                              43400000
.*-------------------------------------------------------------------   43450000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     43500000
&ZXFUNCTION_NAME   SETC  'INPUT'     SET IN/OUTPUT                      43550000
&XFUNCTION_NAME    SETC  '&FUNCTION_NAME(1)'    SET XVARIABLE           43600000
                   AIF   (N'&FUNCTION_NAME GT 1).ZG11B  MULTI PARMS     43650000
&XFUNCTION_NAME    SETC  '&FUNCTION_NAME'       SET XVARIABLE           43700000
.ZG11B             AIF   (K'&FUNCTION_NAME(1) GT 0).ZG11C               43750000
&ZXFUNCTION_NAME   SETC  ''          RESET IN/OUTPUT                    43800000
&ZMS               SETC  'WHEN "INDEPENDENT" IS SPECIFIED'  *KRQDA*     43850000
&ZMS               SETC  '&ZMS , "FUNCTION_NAME" KEY AND ITS ARGUMENT'  43900000
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        43950000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44000000
.ZG11C             ANOP  ,                                              44050000
.*-------------------------------------------------------------------   44100000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                44150000
                   AIF   (K'&ZXFUNCTION_NAME LE 0).ZG11R  NOT I/O       44200000
                   AIF   ('&XFUNCTION_NAME'(1,1) NE '(').ZG11R          44250000
&ZCGPR             SETC  '&XFUNCTION_NAME'(2,K'&XFUNCTION_NAME-2)       44300000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                   44350000
                   AIF   (K'&ZCGPR GT 2).ZG11Q                          44400000
                   AIF   ('&ZCGPR' EQ '0').ZG11Q                        44450000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  44500000
                   AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME      44550000
.ZG11P             ANOP  ,                                              44600000
                   AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC           44650000
                   AIF   ('&ZCGPR' LT '2').ZG11Q                        44700000
                   AIF   ('&ZCGPR' LE '12').ZG11R                       44750000
.ZG11Q             ANOP  ,                                              44800000
&ZMS               SETC  '"FUNCTION_NAME='      *KGPRA* MNOTE           44800100
&ZMS               SETC  '&ZMS.&FUNCTION_NAME"'                         44800200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      44800300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               44800400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44800500
.ZG11R             ANOP  ,                                              44800600
.*-------------------------------------------------------------------   44800700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           44800800
.ZG13              ANOP  ,                                              44800900
&ZTLC              SETC 'DEPENDENT'                                     44801000
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZG14                   44801100
&XTYPE             SETC  'DEPENDENT'            SET KEYWORD             44801200
                   AIF   (N'&TYPE LE 1).ZG13A   CK NUM                  44801300
&ZMS               SETC  '"TYPE='    *KPOSA* MNOTE                      44801400
&ZMS               SETC  '&ZMS.&TYPE"'                                  44801500
&ZMS               SETC  '&ZMS "TYPE"'                                  44801600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            44801700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44801800
.ZG13A             ANOP  ,                                              44801900
.*------------------------------------------------------------------    44802000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           44802100
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        44802200
.ZG13A0            AIF   (K'&CLSFY LE 0).ZG13A1  OK                     44802300
&ZCVAL             SETC '&ZCVAL CLSFY'          INCORRECT KEY USED      44802400
.ZG13A1            AIF   (K'&ARRIVALTIME LE 0).ZG13A2  OK               44802500
&ZCVAL             SETC '&ZCVAL ARRIVALTIME'    INCORRECT KEY USED      44802600
.ZG13A2            AIF   (K'&FUNCTION_NAME LE 0).ZG13A3  OK             44802700
&ZCVAL             SETC '&ZCVAL FUNCTION_NAME'  INCORRECT KEY USED      44802800
.ZG13A3            AIF   (K'&MONTKN LE 0).ZG13A4  OK                    44802900
&ZCVAL             SETC '&ZCVAL MONTKN'         INCORRECT KEY USED      44803000
.ZG13A4            AIF   (K'&ACCESS LE 0).ZG13A5  OK                    44803100
&ZCVAL             SETC '&ZCVAL ACCESS'         INCORRECT KEY USED      44803200
.ZG13A5            AIF   (K'&ZCVAL LE 0).ZG13A6  OK                     44803300
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          44803400
&ZMS               SETC  '"TYPE'     *KMEIA* MNOTE                      44803500
&ZMS               SETC  '&ZMS.=&TYPE"'                                 44803600
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           44803700
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           44803800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44803900
.ZG13A6            ANOP  ,                                              44804000
.*-------------------------------------------------------------------   44804100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           44804200
.ZG14              ANOP  ,                                              44804300
&ZTLC              SETC 'MONENV'                                        44804400
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZG23                   44804500
&XTYPE             SETC  'MONENV'    SET KEYWORD                        44804600
                   AIF   (N'&TYPE LE 1).ZG14A   CK NUM                  44804700
&ZMS               SETC  '"TYPE='    *KPOSA* MNOTE                      44804800
&ZMS               SETC  '&ZMS.&TYPE"'                                  44804900
&ZMS               SETC  '&ZMS "TYPE"'                                  44805000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            44805100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44805200
.ZG14A             ANOP  ,                                              44805300
.*------------------------------------------------------------------    44805400
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           44805500
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        44805600
.ZG14A0            AIF   (K'&CLSFY LE 0).ZG14A1  OK                     44805700
&ZCVAL             SETC '&ZCVAL CLSFY'          INCORRECT KEY USED      44805800
.ZG14A1            AIF   (K'&ARRIVALTIME LE 0).ZG14A2  OK               44805900
&ZCVAL             SETC '&ZCVAL ARRIVALTIME'    INCORRECT KEY USED      44806000
.ZG14A2            AIF   (K'&FUNCTION_NAME LE 0).ZG14A3  OK             44806100
&ZCVAL             SETC '&ZCVAL FUNCTION_NAME'  INCORRECT KEY USED      44806200
.ZG14A3            AIF   (K'&ZCVAL LE 0).ZG14A4  OK                     44806300
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          44806400
&ZMS               SETC  '"TYPE'     *KMEIA* MNOTE                      44806500
&ZMS               SETC  '&ZMS.=&TYPE"'                                 44806600
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           44806700
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           44806800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44806900
.ZG14A4            ANOP  ,                                              44807000
.*----------------------------------------------------------------***   44807100
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 44807200
                   AIF   (N'&MONTKN LE 1).ZG16A  CK NUM                 44807300
&ZMS               SETC  '"MONTKN='  *KPOSA* MNOTE                      44807400
&ZMS               SETC  '&ZMS.&MONTKN"'                                44807500
&ZMS               SETC  '&ZMS "MONTKN"'                                44807600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            44807700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44807800
.ZG16A             ANOP  ,                                              44807900
.*-------------------------------------------------------------------   44808000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     44808100
&ZXMONTKN          SETC  'INPUT'     SET IN/OUTPUT                      44808200
&XMONTKN           SETC  '&MONTKN(1)'           SET XVARIABLE           44808300
                   AIF   (N'&MONTKN GT 1).ZG16B  MULTI PARMS            44808400
&XMONTKN           SETC  '&MONTKN'   SET XVARIABLE                      44808500
.ZG16B             AIF   (K'&MONTKN(1) GT 0).ZG16C                      44808600
&ZXMONTKN          SETC  ''          RESET IN/OUTPUT                    44808700
&ZMS               SETC  'WHEN "MONENV" IS SPECIFIED'  *KRQDA*          44808800
&ZMS               SETC  '&ZMS , "MONTKN" KEY AND ITS ARGUMENT'         44808900
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        44809000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44809100
.ZG16C             ANOP  ,                                              44809200
.*-------------------------------------------------------------------   44809300
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                44809400
                   AIF   (K'&ZXMONTKN LE 0).ZG16R  NOT I/O              44809500
                   AIF   ('&XMONTKN'(1,1) NE '(').ZG16R                 44809600
&ZCGPR             SETC  '&XMONTKN'(2,K'&XMONTKN-2)                     44809700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                   44809800
                   AIF   (K'&ZCGPR GT 2).ZG16Q                          44809900
                   AIF   ('&ZCGPR' EQ '0').ZG16Q                        44810000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  44810100
                   AIF   (T'&ZCGPR NE 'N').ZG16Q  INVALID REG NAME      44810200
.ZG16P             ANOP  ,                                              44810300
                   AIF   (T'&ZCGPR NE 'N').ZG16R  NON NUMERIC           44810400
                   AIF   ('&ZCGPR' LT '2').ZG16Q                        44810500
                   AIF   ('&ZCGPR' LE '12').ZG16R                       44810600
.ZG16Q             ANOP  ,                                              44810700
&ZMS               SETC  '"MONTKN='  *KGPRA* MNOTE                      44810800
&ZMS               SETC  '&ZMS.&MONTKN"'                                44810900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      44811000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               44811100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44811200
.ZG16R             ANOP  ,                                              44811300
.*------------------------------------------------------------------    44811400
.***AG.KKCTL01 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       44811500
&XACCESS           SETC  ''          INITIALIZE XVARIABLE               44811600
.*-------------------------------------------------------------------   44811700
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       44811800
.ZG20              ANOP  ,                                              44811900
                   AIF   (K'&ACCESS(1) LE 0).ZG20A                      44812000
&ZTLC              SETC 'PRIMARY'                                       44812100
                   AIF   ('&ACCESS(1)' NE '&ZTLC').ZG21                 44812200
&XACCESS           SETC  'PRIMARY'   SET KEYWORD                        44812300
                   AIF   (N'&ACCESS LE 1).ZG20A  CK NUM                 44812400
&ZMS               SETC  '"ACCESS='  *KPOSA* MNOTE                      44812500
&ZMS               SETC  '&ZMS.&ACCESS"'                                44812600
&ZMS               SETC  '&ZMS "ACCESS"'                                44812700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            44812800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44812900
.ZG20A             ANOP  ,                                              44813000
.*-------------------------------------------------------------------   44813100
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       44813200
.ZG21              ANOP  ,                                              44813300
&ZTLC              SETC 'HOME'                                          44813400
                   AIF   ('&ACCESS(1)' NE '&ZTLC').ZG22                 44813500
&XACCESS           SETC  'HOME'      SET KEYWORD                        44813600
                   AIF   (N'&ACCESS LE 1).ZG21A  CK NUM                 44813700
&ZMS               SETC  '"ACCESS='  *KPOSA* MNOTE                      44813800
&ZMS               SETC  '&ZMS.&ACCESS"'                                44813900
&ZMS               SETC  '&ZMS "ACCESS"'                                44814000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            44814100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44814200
.ZG21A             ANOP  ,                                              44814300
.*------------------------------------------------------------------    44814400
.***AG.KKCTL04 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       44814500
.ZG22              ANOP  ,                                              44814600
&ZXACCESS          SETC  'INPUT'     SET IN/OUTPUT                      44814700
                   AIF   (K'&XACCESS GT 0).ZG22E  VALID ARG             44814800
                   AIF   (T'&ACCESS EQ 'O').ZG22D  OMITTED              44814900
&ZASYSLNDX         SETA  0                                              44815000
.ZG22A             ANOP  ,           POSITIONAL MACRO KEY               44815100
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   44815200
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG22C               44815300
&ZTLC              SETC 'ACCESS'                                        44815400
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG22A      44815500
.ZG22B             ANOP  ,                                              44815600
&ZXACCESS          SETC  ''          RESET IN/OUTPUT                    44815700
&ZMS               SETC  'THE "ACCESS" KEY'     *KOPTA* MNOTE           44815800
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        44815900
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               44816000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44816100
                   AGO   .ZG22E                                         44816200
.ZG22C             ANOP  ,                                              44816300
&ZXACCESS          SETC  ''          RESET IN/OUTPUT                    44816400
&ZMS               SETC  '"ACCESS='  *KUKWA* MNOTE                      44816500
&ZMS               SETC  '&ZMS.&ACCESS"'                                44816600
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      44816700
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            44816800
&ZMS               SETC  '&ZMS "PRIMARY"'       VALID KEYWORD           44816900
&ZMS               SETC  '&ZMS OR "HOME".'      VALID KEYWORD           44817000
                   MNOTE 8,' &ZMS '                                     44817100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44817200
                   AGO   .ZG22E                                         44817300
.ZG22D             ANOP  ,                                              44817400
&XACCESS           SETC  'PRIMARY'   SET DEFAULT KEYWORD                44817500
.ZG22E             ANOP  ,                                              44817600
.*------------------------------------------------------------------    44817700
.***AG.KKCTL05 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       44817800
                   AIF   (K'&ACCESS(1) GT 0).ZG22F  PARM                44817900
&XACCESS           SETC  ''          ENSURE NULL KEYWORD                44818000
&ZXACCESS          SETC  ''          RESET IN/OUTPUT                    44818100
&ZMS               SETC  'WHEN "MONENV" IS SPECIFIED, THE'              44818200
&ZMS               SETC  '&ZMS "ACCESS" KEY AND ITS ARGUMENT'           44818300
&ZMS               SETC  '&ZMS ARE REQUIRED.'                           44818400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            44818500
&ZMS               SETC  '&ZMS "PRIMARY"'       VALID KEYWORD           44818600
&ZMS               SETC  '&ZMS OR "HOME".'      VALID KEYWORD           44818700
                   MNOTE 8,' &ZMS '                                     44818800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44818900
.ZG22F             ANOP  ,                                              44819000
.*------------------------------------------------------------------    44819100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           44819200
.ZG23              ANOP  ,                                              44819300
&ZXTYPE            SETC  'INPUT'     SET IN/OUTPUT                      44819400
                   AIF   (K'&XTYPE GT 0).ZG23E  VALID ARG               44819500
                   AIF   (T'&TYPE EQ 'O').ZG23D  OMITTED                44819600
&ZASYSLNDX         SETA  0                                              44819700
.ZG23A             ANOP  ,           POSITIONAL MACRO KEY               44819800
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   44819900
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG23C               44820000
&ZTLC              SETC 'TYPE'                                          44820100
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG23A      44820200
.ZG23B             ANOP  ,                                              44820300
&ZXTYPE            SETC  ''          RESET IN/OUTPUT                    44820400
&ZMS               SETC  'THE "TYPE" KEY'       *KOPTA* MNOTE           44820500
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        44820600
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               44820700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44820800
                   AGO   .ZG23E                                         44820900
.ZG23C             ANOP  ,                                              44821000
&ZXTYPE            SETC  ''          RESET IN/OUTPUT                    44821100
&ZMS               SETC  '"TYPE='    *KUKWA* MNOTE                      44821200
&ZMS               SETC  '&ZMS.&TYPE"'                                  44821300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      44821400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            44821500
&ZMS               SETC  '&ZMS "INDEPENDENT",'  VALID KEYWORD           44821600
&ZMS               SETC  '&ZMS "DEPENDENT",'    VALID KEYWORD           44821700
&ZMS               SETC  '&ZMS OR "MONENV".'    VALID KEYWORD           44821800
                   MNOTE 8,' &ZMS '                                     44821900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44822000
                   AGO   .ZG23E                                         44822100
.ZG23D             ANOP  ,                                              44822200
&XTYPE             SETC  'INDEPENDENT'          SET DEFAULT KEYWORD     44822300
.ZG23E             ANOP  ,                                              44822400
.*----------------------------------------------------------------***   44822500
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    44822600
                   AIF   (N'&ETOKEN LE 1).ZG25A  CK NUM                 44822700
&ZMS               SETC  '"ETOKEN='  *KPOSA* MNOTE                      44822800
&ZMS               SETC  '&ZMS.&ETOKEN"'                                44822900
&ZMS               SETC  '&ZMS "ETOKEN"'                                44823000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            44823100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44823200
.ZG25A             ANOP  ,                                              44823300
.*-------------------------------------------------------------------   44823400
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        44823500
&ZXETOKEN          SETC  'OUTPUT'    SET IN/OUTPUT                      44823600
&XETOKEN           SETC  '&ETOKEN(1)'           SET XVARIABLE           44823700
                   AIF   (N'&ETOKEN GT 1).ZG25B  MULTI PARMS            44823800
&XETOKEN           SETC  '&ETOKEN'   SET XVARIABLE                      44823900
.ZG25B             AIF   (K'&ETOKEN(1) GT 0).ZG25C                      44824000
&ZXETOKEN          SETC  ''          RESET IN/OUTPUT                    44824100
&ZMS               SETC  ' '         *KRQDA*                            44824200
&ZMS               SETC  '&ZMS "ETOKEN" KEY AND ITS ARGUMENT'           44824300
                   MNOTE 8,' &ZMS ARE REQUIRED.'                        44824400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        44824500
.ZG25C             ANOP  ,                                              44824600
.*-------------------------------------------------------------------   44824700
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   44824800
                   AIF   (K'&ZXETOKEN LE 0).ZG25R  NOT I/O              44824900
                   AIF   ('&XETOKEN'(1,1) NE '(').ZG25R                 44825000
&ZCGPR             SETC  '&XETOKEN'(2,K'&XETOKEN-2)                     44825100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                   44825200
                   AIF   (K'&ZCGPR GT 2).ZG25Q                          44825300
                   AIF   ('&ZCGPR' EQ '0').ZG25Q                        44825400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  44825500
                   AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME      44825600
.ZG25P             ANOP  ,                                              44825700
                   AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC           44825800
                   AIF   ('&ZCGPR' LT '2').ZG25Q                        44825900
                   AIF   ('&ZCGPR' LE '12').ZG25R                       44826000
.ZG25Q             ANOP  ,                                              44826100
&ZMS               SETC  '"ETOKEN='  *KGPRA* MNOTE                      44850000
&ZMS               SETC  '&ZMS.&ETOKEN"'                                44900000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      44950000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               45000000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        45050000
.ZG25R             ANOP  ,                                              45100000
.*----------------------------------------------------------------***   45150000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    45200000
                   AIF   (N'&RETCODE LE 1).ZG28A  CK NUM                45250000
&ZMS               SETC  '"RETCODE='            *KPOSA* MNOTE           45300000
&ZMS               SETC  '&ZMS.&RETCODE"'                               45350000
&ZMS               SETC  '&ZMS "RETCODE"'                               45400000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            45450000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        45500000
.ZG28A             ANOP  ,                                              45550000
.*-------------------------------------------------------------------   45600000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        45650000
                   AIF   (K'&RETCODE(1) LE 0).ZG28C  NO PARM            45700000
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         45750000
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           45800000
                   AIF   (N'&RETCODE GT 1).ZG28C                        45850000
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      45900000
.ZG28C             ANOP  ,                                              45950000
.*-------------------------------------------------------------------   46250000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   46300000
                   AIF   (K'&ZXRETCODE LE 0).ZG28R  NOT I/O             46350000
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG28R                46400000
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   46450000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                   46500000
                   AIF   (K'&ZCGPR GT 2).ZG28Q                          46550000
                   AIF   ('&ZCGPR' EQ '0').ZG28Q                        46600000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  46650000
                   AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME      46700000
.ZG28P             ANOP  ,                                              46750000
                   AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC           46800000
                   AIF   ('&ZCGPR' LT '2').ZG28Q                        46850000
                   AIF   ('&ZCGPR' LE '12').ZG28R                       46900000
.ZG28Q             ANOP  ,                                              46950000
&ZMS               SETC  '"RETCODE='            *KGPRA* MNOTE           47000000
&ZMS               SETC  '&ZMS.&RETCODE"'                               47050000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      47100000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               47150000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        47200000
.ZG28R             ANOP  ,                                              47250000
.*----------------------------------------------------------------***   47300000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    47350000
                   AIF   (N'&RSNCODE LE 1).ZG31A  CK NUM                47400000
&ZMS               SETC  '"RSNCODE='            *KPOSA* MNOTE           47450000
&ZMS               SETC  '&ZMS.&RSNCODE"'                               47500000
&ZMS               SETC  '&ZMS "RSNCODE"'                               47550000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            47600000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        47650000
.ZG31A             ANOP  ,                                              47700000
.*-------------------------------------------------------------------   47750000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        47800000
                   AIF   (K'&RSNCODE(1) LE 0).ZG31C  NO PARM            47850000
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         47900000
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           47950000
                   AIF   (N'&RSNCODE GT 1).ZG31C                        48000000
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      48050000
.ZG31C             ANOP  ,                                              48100000
.*-------------------------------------------------------------------   48400000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   48450000
                   AIF   (K'&ZXRSNCODE LE 0).ZG31R  NOT I/O             48500000
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG31R                48550000
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   48600000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                   48650000
                   AIF   (K'&ZCGPR GT 2).ZG31Q                          48700000
                   AIF   ('&ZCGPR' EQ '0').ZG31Q                        48750000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  48800000
                   AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME      48850000
.ZG31P             ANOP  ,                                              48900000
                   AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC           48950000
                   AIF   ('&ZCGPR' LT '2').ZG31Q                        49000000
                   AIF   ('&ZCGPR' LE '12').ZG31R                       49050000
.ZG31Q             ANOP  ,                                              49100000
&ZMS               SETC  '"RSNCODE='            *KGPRA* MNOTE           52950000
&ZMS               SETC  '&ZMS.&RSNCODE"'                               53000000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      53050000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               53100000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        53150000
.ZG31R             ANOP  ,                                              53200000
.******************************************************************     53250000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        53300000
.******************************************************************     53350000
                   ACTR  10000                                          53400000
.*----------------------------------------------------------------***   53450000
.***AH.P02 EXTRA POSITIONALS                                            53500000
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           53550000
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           53560000
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       53570000
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        53580000
.ZGLISTX1          ANOP  ,                                              53590000
&ZCVAL             SETC  ''          ERROR FIELD                        53600000
&ZAWRK             SETA  0           POSITIONAL NUMBER                  53650000
.ZGLIST2           ANOP  ,                                              53700000
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    53750000
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           53800000
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                53850000
                   AGO   .ZGLIST2                                       53900000
.*                                                                      53950000
.ZGLIST3           ANOP  ,                                              54000000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             54050000
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE       54100000
&ZMS               SETC  '&ZMS "&ZCVAL"'                                54150000
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         54200000
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 54250000
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         54300000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        54350000
.ZGLISTX           ANOP  ,                                              54400000
&ZASYSLNDX         SETA  0                                              54450000
.*-------------------------------------------------------------------   54500000
.***AG.MF04 MF=(SLE)                                                    54550000
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           54600000
.*******************************************************************    54650000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       54700000
.*******************************************************************    54750000
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          54800000
.*******************************************************************    54850000
.***AE.01  START OF IWMECREA MACRO CODE                                 54900000
.*******************************************************************    54950000
                   LCLC  &M0M0001                 NAME                  55000000
&M0M0001           SETC  '&XLABEL'                SET NAME              55050000
                   AIF   (K'&XLABEL NE 0).XLAB2                         55100000
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          55150000
.*                                                                      55200000
.XLAB2             ANOP  ,                                              55250000
                   AIF   ('&XMF' EQ 'L').XLAB3                          55275000
&M0M0001 DS    0H                             IWMECREA-1                55300000
.XLAB3             ANOP  ,                                              55325000
.*******************************************************************    55350000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              55400000
.*******************************************************************    55450000
              PUSH  PRINT                                               55500000
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     55550000
                   PRINT OFF         ++ PR01                            55600000
                   AGO   .ZPRNTXX                                       55650000
.ZPRINTX           PRINT ON                                             55700000
.ZPRNTXX           ANOP  ,                                              55750000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  55800000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  55850000
.********************************************************************   55900000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     55950000
.********************************************************************   56000000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       56050000
                      LCLA  &ZOPN1         INVOCATION INDEX             56100000
                      LCLC  &ZOPL(4095)    LABEL                        56150000
                      LCLC  &ZOPO(4095)    OPERATION                    56200000
                      LCLC  &ZOPV(4095)    VALUE                        56250000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  56300000
.*                                                                      56350000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     56400000
.******************************************************************     56450000
.***AL.L10 IWMECREA FMT=LIST MF=S|L PARAMETERS                          56500000
.******************************************************************     56550000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     56600000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     56650000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     56700000
&XMFATTR              SETC  '0D'                                        56750000
.*                                                                      56800000
&ZOPN                 SETA  &ZOPN+1                                     56850000
&ZOPL(&ZOPN)          SETC  ' '                                         56900000
&ZOPO(&ZOPN)          SETC  'B'                                         56950000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                57000000
&ZOPD(&ZOPN)          SETC  '++ IWMECREA ARG PARMS'                     57050000
.*                                                                      57100000
&ZOPN                 SETA  &ZOPN+1                                     57150000
&ZOPL(&ZOPN)          SETC  ' '                                         57200000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     57250000
&ZOPV(&ZOPN)          SETC  '1'                                         57300000
&ZOPD(&ZOPN)          SETC  ' '                                         57350000
.*                                                                      57400000
.ZLMFSL2              ANOP  ,                                           57450000
.*-------------------------------------------------------------------   57500000
.***AM.L00  IWMECREA FMT=LIST name                                      57505000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    57510000
&ZOPN                 SETA &ZOPN+1                                      57515000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   57520000
&ZOPO(&ZOPN)          SETC 'EQU'                                        57525000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   57530000
&ZOPD(&ZOPN)          SETC '++ IWMECREA NAME'                           57535000
.ZLMFSL2M             ANOP  ,                                           57540000
.*-------------------------------------------------------------------   57545000
.***AM.L01  IWMECREA FMT=LIST PARAMETERS                                57550000
&ZOPN                 SETA &ZOPN+1                                      57600000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   57650000
&ZOPO(&ZOPN)          SETC 'DS'                                         57700000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   57750000
&ZOPD(&ZOPN)          SETC '++ IWMECREA PARM LIST'                      57800000
.*-------------------------------------------------------------------   57850000
.***AM.L02 XVERSION XL1                                                 57900000
&ZOPN                 SETA &ZOPN+1                                      57950000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         58000000
&ZOPO(&ZOPN)          SETC 'DS'                                         58050000
&ZOPV(&ZOPN)          SETC 'XL1'                                        58100000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          58150000
.*-------------------------------------------------------------------   58200000
.***AM.L09  XRSV0001 CL1                                                58250000
&ZOPN                 SETA &ZOPN+1                                      58300000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         58350000
&ZOPO(&ZOPN)          SETC 'DS'                                         58400000
&ZOPV(&ZOPN)          SETC 'CL1'                                        58450000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      58500000
.*-------------------------------------------------------------------   58506200
.***AM.L09  XPLISTLEN XL2                                               58512400
&ZOPN                 SETA &ZOPN+1                                      58518600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        58524800
&ZOPO(&ZOPN)          SETC 'DS'                                         58531000
&ZOPV(&ZOPN)          SETC 'XL2'                                        58537200
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        58543400
.*-------------------------------------------------------------------   58550000
.***AM.L09  XRSV0004 CL4                                                58600000
&ZOPN                 SETA &ZOPN+1                                      58650000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0004'                         58700000
&ZOPO(&ZOPN)          SETC 'DS'                                         58750000
&ZOPV(&ZOPN)          SETC 'CL4'                                        58800000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0004'                      58850000
.*-------------------------------------------------------------------   58900000
.***AM.L09 ADDR XCLSFY A                                                58950000
&ZOPN                 SETA &ZOPN+1                                      59000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCLSFY_ADDR'                      59050000
&ZOPO(&ZOPN)          SETC 'DS'                                         59100000
&ZOPV(&ZOPN)          SETC 'A'                                          59150000
&ZOPD(&ZOPN)          SETC '++ &ZXCLSFY ADDR XCLSFY'                    59200000
.*-------------------------------------------------------------------   59250000
.***AM.L09  XRSV000C CL4                                                59300000
&ZOPN                 SETA &ZOPN+1                                      59350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV000C'                         59400000
&ZOPO(&ZOPN)          SETC 'DS'                                         59450000
&ZOPV(&ZOPN)          SETC 'CL4'                                        59500000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV000C'                      59550000
.*-------------------------------------------------------------------   59600000
.***AM.L09  XARRIVALTIME BL.64                                          59650000
&ZOPN                 SETA &ZOPN+1                                      59700000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XARRIVALTIME'                     59750000
&ZOPO(&ZOPN)          SETC 'DS'                                         59800000
&ZOPV(&ZOPN)          SETC 'BL.64'                                      59850000
&ZOPD(&ZOPN)          SETC '++ &ZXARRIVALTIME  XARRIVALTIME'            59900000
.*-------------------------------------------------------------------   59950000
.***AM.L09  XRSV0018 CL8                                                60000000
&ZOPN                 SETA &ZOPN+1                                      60050000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0018'                         60100000
&ZOPO(&ZOPN)          SETC 'DS'                                         60150000
&ZOPV(&ZOPN)          SETC 'CL8'                                        60200000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0018'                      60250000
.*-------------------------------------------------------------------   60300000
.***AM.L09  XFUNCTION_NAME CL8                                          60350000
&ZOPN                 SETA &ZOPN+1                                      60400000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNCTION_NAME'                   60450000
&ZOPO(&ZOPN)          SETC 'DS'                                         60500000
&ZOPV(&ZOPN)          SETC 'CL8'                                        60550000
&ZOPD(&ZOPN)          SETC '++ &ZXFUNCTION_NAME  XFUNCTION_NAME'        60600000
.*-------------------------------------------------------------------   60650000
.***AM.L09  XETOKEN CL8                                                 60700000
&ZOPN                 SETA &ZOPN+1                                      60750000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XETOKEN'                          60800000
&ZOPO(&ZOPN)          SETC 'DS'                                         60850000
&ZOPV(&ZOPN)          SETC 'CL8'                                        60900000
&ZOPD(&ZOPN)          SETC '++ &ZXETOKEN  XETOKEN'                      60950000
.*-------------------------------------------------------------------   61000000
.***AM.L09  XRSV0030 CL4                                                61050000
&ZOPN                 SETA &ZOPN+1                                      61100000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0030'                         61150000
&ZOPO(&ZOPN)          SETC 'DS'                                         61200000
&ZOPV(&ZOPN)          SETC 'CL4'                                        61250000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0030'                      61300000
.*-------------------------------------------------------------------   61350000
.***AM.MLM2 SAVED LOCATION COUNTER                                      61350300
                      AIF  (&XPLISTVER GE 1).ZL11LA                     61350600
                      AIF  ('&ZENDBASEPL' NE '').ZL11LA                 61350900
&ZENDBASEPL           SETC 'YES'                                        61351200
&ZOPN                 SETA &ZOPN+1                                      61351500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           61351800
&ZOPO(&ZOPN)          SETC 'EQU'                                        61352100
&ZOPV(&ZOPN)          SETC '*'                                          61352400
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       61352700
.ZL11LA               ANOP  ,                                           61353000
.*-------------------------------------------------------------------   61353300
.***AM.LVER1                                                            61353600
                      AIF  (&XPLISTVER LT 1).ZL11L                      61353900
.*-------------------------------------------------------------------   61354200
.*-------------------------------------------------------------------   61354500
.***AM.L03 XTYPE_OPTIONS BL.8                                           61354800
&ZOPN                 SETA &ZOPN+1                                      61355100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTYPE_OPTIONS'                    61355400
&ZOPO(&ZOPN)          SETC 'DS'                                         61355700
&ZOPV(&ZOPN)          SETC 'BL.8'                                       61356000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             61356300
.*-------------------------------------------------------------------   61356600
.***AM.LVER2                                                            61356900
.ZL11L                ANOP  ,                                           61357200
.*-------------------------------------------------------------------   61357500
.*-------------------------------------------------------------------   61357800
.***AM.LVER1                                                            61358100
                      AIF  (&XPLISTVER LT 1).ZL12L                      61358400
.*-------------------------------------------------------------------   61358700
.*                                                                      61359000
&ZOPN                 SETA  &ZOPN+1                                     61359300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_INDEPENDENT'               61359600
&ZOPO(&ZOPN)          SETC  'EQU'                                       61359900
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             61360200
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 61360500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INDEPENDENT'                  61360800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      61361100
.*-------------------------------------------------------------------   61361400
.***AM.LVER2                                                            61361700
.ZL12L                ANOP  ,                                           61362000
.*-------------------------------------------------------------------   61362300
.*-------------------------------------------------------------------   61362600
.***AM.LVER1                                                            61362900
                      AIF  (&XPLISTVER LT 1).ZL13L                      61363200
.*-------------------------------------------------------------------   61363500
.*                                                                      61363800
&ZOPN                 SETA  &ZOPN+1                                     61364100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_DEPENDENT'                 61364400
&ZOPO(&ZOPN)          SETC  'EQU'                                       61364700
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             61365000
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 61365300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEPENDENT'                    61365600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      61365900
.*-------------------------------------------------------------------   61366200
.***AM.LVER2                                                            61366500
.ZL13L                ANOP  ,                                           61366800
.*-------------------------------------------------------------------   61367100
.*-------------------------------------------------------------------   61367400
.***AM.LVER1                                                            61367700
                      AIF  (&XPLISTVER LT 1).ZL14L                      61368000
.*-------------------------------------------------------------------   61368300
.*                                                                      61368600
&ZOPN                 SETA  &ZOPN+1                                     61368900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_MONENV'                    61369200
&ZOPO(&ZOPN)          SETC  'EQU'                                       61369500
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             61369800
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 61370100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MONENV'                       61370400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      61370700
.*-------------------------------------------------------------------   61371000
.***AM.LVER2                                                            61371300
.ZL14L                ANOP  ,                                           61371600
.*-------------------------------------------------------------------   61371900
.*-------------------------------------------------------------------   61372200
.***AM.LVER1                                                            61372500
                      AIF  (&XPLISTVER LT 1).ZL15L                      61372800
.*-------------------------------------------------------------------   61373100
.*                                                                      61373400
&ZOPN                 SETA  &ZOPN+1                                     61373700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XACCESS_PRIMARY'                 61374000
&ZOPO(&ZOPN)          SETC  'EQU'                                       61374300
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             61374600
&ZOPD(&ZOPN)          SETC  '++ XACCESS.'                               61374900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PRIMARY'                      61375200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      61375500
.*-------------------------------------------------------------------   61375800
.***AM.LVER2                                                            61376100
.ZL15L                ANOP  ,                                           61376400
.*-------------------------------------------------------------------   61376700
.*-------------------------------------------------------------------   61377000
.***AM.LVER1                                                            61377300
                      AIF  (&XPLISTVER LT 1).ZL16L                      61377600
.*-------------------------------------------------------------------   61377900
.*                                                                      61378200
&ZOPN                 SETA  &ZOPN+1                                     61378500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XACCESS_HOME'                    61378800
&ZOPO(&ZOPN)          SETC  'EQU'                                       61379100
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             61379400
&ZOPD(&ZOPN)          SETC  '++ XACCESS.'                               61379700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).HOME'                         61380000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      61380300
.*-------------------------------------------------------------------   61380600
.***AM.LVER2                                                            61380900
.ZL16L                ANOP  ,                                           61381200
.*-------------------------------------------------------------------   61381500
.*-------------------------------------------------------------------   61381800
.***AM.LVER1                                                            61382100
                      AIF  (&XPLISTVER LT 1).ZL17L                      61382400
.*-------------------------------------------------------------------   61382700
.*-------------------------------------------------------------------   61383000
.***AM.L09  XRSV0035 CL3                                                61383300
&ZOPN                 SETA &ZOPN+1                                      61383600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0035'                         61383900
&ZOPO(&ZOPN)          SETC 'DS'                                         61384200
&ZOPV(&ZOPN)          SETC 'CL3'                                        61384500
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0035'                      61384800
.*-------------------------------------------------------------------   61385100
.***AM.LVER2                                                            61385400
.ZL17L                ANOP  ,                                           61385700
.*-------------------------------------------------------------------   61386000
.*-------------------------------------------------------------------   61386300
.***AM.LVER1                                                            61386600
                      AIF  (&XPLISTVER LT 1).ZL18L                      61386900
.*-------------------------------------------------------------------   61387200
.*-------------------------------------------------------------------   61387500
.***AM.L09  XMONTKN BL.32                                               61387800
&ZOPN                 SETA &ZOPN+1                                      61388100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          61388400
&ZOPO(&ZOPN)          SETC 'DS'                                         61388700
&ZOPV(&ZOPN)          SETC 'BL.32'                                      61389000
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN  XMONTKN'                      61389300
.*-------------------------------------------------------------------   61389600
.***AM.LVER2                                                            61389900
.ZL18L                ANOP  ,                                           61390200
.*-------------------------------------------------------------------   61390500
.*-------------------------------------------------------------------   61390800
.***AM.L10 END OF IWMECREA LIST PARAMETERS                              61400000
&ZOPN                 SETA &ZOPN+1                                      61450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 61500000
&ZOPO(&ZOPN)          SETC 'EQU'                                        61550000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 61600000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         61650000
.*                                                                      61700000
&ZOPN                 SETA &ZOPN+1                                      61750000
&ZOPL(&ZOPN)          SETC ' '                                          61800000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      61850000
&ZOPV(&ZOPN)          SETC '1'                                          61900000
&ZOPD(&ZOPN)          SETC ' '                                          61950000
.*-------------------------------------------------------------------   62000000
.***AL.L12 IWMECREA FMT=LIST MF=S|L PARAMETERS                          62050000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         62100000
.*                                                                      62150000
&ZOPN                 SETA  &ZOPN+1                                     62200000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                62250000
&ZOPO(&ZOPN)          SETC  'DC'                                        62300000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   62350000
&ZOPD(&ZOPN)          SETC  '++ IWMECREA ARG PARMS'                     62400000
.*                                                                      62450000
.ZLMFSLX              ANOP  ,                                           62500000
.*-------------------------------------------------------------------   62550000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          62600000
&ZPLLEN               SETA 52                                           62650000
.*                                                                      62660000
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    62670000
&ZPLLEN               SETA 60                                           62680000
.ZLLEN2Z              ANOP  ,                                           62690000
.*                                                                      62700000
.******************************************************************     62750000
.***AI.L01 IWMECREA FMT=LIST FILL IN PARAMETER AREA                     62800000
.******************************************************************     62850000
                      ACTR  10000                                       62900000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               62950000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    63000000
&ZCVAL                SETC  'LAE'          XAX MODE                     63050000
.ZIMFXA               ANOP ,                                            63100000
.*                                                                      63150000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    63200000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         63250000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 63300000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                63350000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 63400000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                63450000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   63500000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    63550000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   63600000
&ZOPN                 SETA  &ZOPN+1                                     63650000
&ZOPL(&ZOPN)          SETC  ' '                                         63700000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    63750000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              63800000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       63850000
                      AGO   .ZIMFNX                                     63900000
.*                                                                      63950000
.ZIMFN2               ANOP ,                                            64000000
&ZOPN                 SETA  &ZOPN+1                                     64050000
&ZOPL(&ZOPN)          SETC  ' '                                         64100000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    64150000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                64200000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       64250000
.ZIMFNX               ANOP ,                                            64300000
.********************************************************************   64350000
.***AI.L02 IWMECREA FMT=LIST INITIALIZE PARAMETER AREA                  64400000
.********************************************************************   64450000
.***AI.L03 MF=(SLE)                                                     64500000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      64550000
.*                                                                      64600000
&ZOPN                 SETA  &ZOPN+1                                     64650000
&ZOPL(&ZOPN)          SETC  ' '                                         64700000
&ZOPO(&ZOPN)          SETC  'XC'                                        64750000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         64800000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             64850000
.ZIMFLX               ANOP  ,                                           64900000
.*-------------------------------------------------------------------   64950000
.***AI.L04A XVERSION XL1                                                65000000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    65050000
&ZOPN                 SETA  &ZOPN+1                                     65100000
&ZOPL(&ZOPN)          SETC  ' '                                         65150000
&ZOPO(&ZOPN)          SETC  'MVI'                                       65200000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           65250000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     65300000
.ZIMFVW               ANOP  ,                                           65350000
.*-------------------------------------------------------------------   65400000
.***AI.L04 XPLISTLEN XL2                                                65450000
&ZOPN                 SETA  &ZOPN+1                                     65500000
&ZOPL(&ZOPN)          SETC  ' '                                         65550000
&ZOPO(&ZOPN)          SETC  'MVC'                                       65600000
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      65650000
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    65700000
.*-------------------------------------------------------------------   65750000
.***AI.L19 ADDR XCLSFY A                                                66300000
                      AIF   ('&ZXCLSFY' EQ '').ZI5H                     66350000
&ZCLNG                SETC  '&XCLSFY'                                   66400000
&ZCGPR                SETC  '14'                                        66450000
         AIF   ('&XCLSFY'(1,1) EQ '(').ZI5F  IN GPR                     66500000
.*                                                                      66550000
&ZOPN                 SETA  &ZOPN+1                                     66600000
&ZOPL(&ZOPN)          SETC  ' '                                         66650000
&ZOPO(&ZOPN)          SETC  'LA'                                        66700000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             66750000
&ZOPD(&ZOPN)          SETC  '++ &ZXCLSFY XCLSFY'                        66800000
.*                                                                      66850000
                      AGO   .ZI5G                                       66900000
.*                                                                      66950000
.ZI5F                 ANOP  ,                                           67000000
&ZCGPR   SETC  '&XCLSFY'(2,K'&XCLSFY-2)                                 67050000
.*                                                                      67100000
.ZI5G                 ANOP  ,                                           67150000
.*                                                                      67200000
&ZOPN                 SETA  &ZOPN+1                                     67250000
&ZOPL(&ZOPN)          SETC  ' '                                         67300000
&ZOPO(&ZOPN)          SETC  'ST'                                        67350000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              67400000
&ZOPD(&ZOPN)          SETC  '++ &ZXCLSFY XCLSFY'                        67450000
.*                                                                      67500000
.ZI5H                 ANOP  ,                                           67550000
.*-------------------------------------------------------------------   67600000
.***AI.L25  XARRIVALTIME XL8                                            67650000
                      AIF   ('&ZXARRIVALTIME' EQ '').ZI7E               67700000
                      AIF   ('&ZXARRIVALTIME' EQ 'OUTPUT').ZI7E         67750000
&ZCGPR                SETC  '&XARRIVALTIME'                             67800000
.*                                                                      67850000
                      AIF   ('&XARRIVALTIME'(1,1) NE '(').ZI7B          67900000
&ZCGPR   SETC  '0('.'&XARRIVALTIME'(2,K'&XARRIVALTIME-2).')'            67950000
                      AGO   .ZI7D                                       68000000
.ZI7B                 ANOP  ,                                           68050000
.*                                                                      68100000
&ZC                   SETC  '&XARRIVALTIME'(1,1)                        68150000
                      AIF   (T'&ZC NE 'N').ZI7D                         68200000
&ZC                   SETC  '&XARRIVALTIME'                             68250000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                68300000
&ZCGPR                SETC  '=BL8''&XARRIVALTIME'''                     68350000
.*                                                                      68400000
.ZI7D                 ANOP  ,                                           68450000
.*                                                                      68500000
&ZOPN                 SETA  &ZOPN+1                                     68550000
&ZOPL(&ZOPN)          SETC  ' '                                         68600000
&ZOPO(&ZOPN)          SETC  'MVC'                                       68650000
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            68700000
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            68750000
.*                                                                      68800000
.ZI7E                 ANOP  ,                                           68850000
.*-------------------------------------------------------------------   70200000
.***AI.L25  XFUNCTION_NAME CL8                                          70250000
                      AIF   ('&ZXFUNCTION_NAME' EQ '').ZI9E             70300000
                      AIF   ('&ZXFUNCTION_NAME' EQ 'OUTPUT').ZI9E       70350000
&ZCGPR                SETC  '&XFUNCTION_NAME'                           70400000
.*                                                                      70450000
                      AIF   ('&XFUNCTION_NAME'(1,1) NE '(').ZI9B        70500000
&ZCGPR   SETC  '0('.'&XFUNCTION_NAME'(2,K'&XFUNCTION_NAME-2).')'        70550000
.ZI9B                 ANOP  ,                                           70600000
.*                                                                      70650000
&ZOPN                 SETA  &ZOPN+1                                     70700000
&ZOPL(&ZOPN)          SETC  ' '                                         70750000
&ZOPO(&ZOPN)          SETC  'MVC'                                       70800000
&ZOPV(&ZOPN)          SETC  '32(8,1),&ZCGPR'                            70850000
&ZOPD(&ZOPN)          SETC  '++ &ZXFUNCTION_NAME XFUNCTION_NAME'        70900000
.*                                                                      70950000
.ZI9E                 ANOP  ,                                           70950600
.*-------------------------------------------------------------------   70951200
.***AI.LVER01                                                           70951800
                      AIF  (&XPLISTVER LT 1).ZI12Z                      70952400
.*-------------------------------------------------------------------   70953000
.***AI.L05 XTYPE_OPTIONS BL1                                            70953600
&ZW                   SETC  ''                                          70954200
&ZCLNG                SETC  ''             RESET BIT ON FLAG            70954800
.*-------------------------------------------------------------------   70955400
.***AI.LVER02                                                           70956000
.ZI12Z                ANOP  ,                                           70956600
.*-------------------------------------------------------------------   70957200
.***AI.LVER01                                                           70957800
                      AIF  (&XPLISTVER LT 1).ZI13Z                      70958400
.*-------------------------------------------------------------------   70959000
.***AI.L08 XTYPE_OPTIONS "INDEPENDENT"                                  70959600
.***      BL1'1XXXXXXX'                                                 70960200
         AIF   ('&XTYPE' NE 'INDEPENDENT').ZI13A                        70960800
&ZW                   SETC  '&ZW.1'                                     70961400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              70962000
                      AGO   .ZI13C                                      70962600
.*                                                                      70963200
.ZI13A                ANOP  ,                                           70963800
&ZW                   SETC  '&ZW.0'                                     70964400
.ZI13C                ANOP  ,                                           70965000
.*-------------------------------------------------------------------   70965600
.***AI.LVER02                                                           70966200
.ZI13Z                ANOP  ,                                           70966800
.*-------------------------------------------------------------------   70967400
.***AI.LVER01                                                           70968000
                      AIF  (&XPLISTVER LT 1).ZI14Z                      70968600
.*-------------------------------------------------------------------   70969200
.***AI.L08 XTYPE_OPTIONS "DEPENDENT"                                    70969800
.***      BL1'X1XXXXXX'                                                 70970400
         AIF   ('&XTYPE' NE 'DEPENDENT').ZI14A                          70971000
&ZW                   SETC  '&ZW.1'                                     70971600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              70972200
                      AGO   .ZI14C                                      70972800
.*                                                                      70973400
.ZI14A                ANOP  ,                                           70974000
&ZW                   SETC  '&ZW.0'                                     70974600
.ZI14C                ANOP  ,                                           70975200
.*-------------------------------------------------------------------   70975800
.***AI.LVER02                                                           70976400
.ZI14Z                ANOP  ,                                           70977000
.*-------------------------------------------------------------------   70977600
.***AI.LVER01                                                           70978200
                      AIF  (&XPLISTVER LT 1).ZI15Z                      70978800
.*-------------------------------------------------------------------   70979400
.***AI.L08 XTYPE_OPTIONS "MONENV"                                       70980000
.***      BL1'XX1XXXXX'                                                 70980600
         AIF   ('&XTYPE' NE 'MONENV').ZI15A                             70981200
&ZW                   SETC  '&ZW.1'                                     70981800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              70982400
                      AGO   .ZI15C                                      70983000
.*                                                                      70983600
.ZI15A                ANOP  ,                                           70984200
&ZW                   SETC  '&ZW.0'                                     70984800
.ZI15C                ANOP  ,                                           70985400
.*-------------------------------------------------------------------   70986000
.***AI.LVER02                                                           70986600
.ZI15Z                ANOP  ,                                           70987200
.*-------------------------------------------------------------------   70987800
.***AI.LVER01                                                           70988400
                      AIF  (&XPLISTVER LT 1).ZI16Z                      70989000
.*-------------------------------------------------------------------   70989600
.***AI.L08 XTYPE_OPTIONS "PRIMARY"                                      70990200
.***      BL1'XXX1XXXX'                                                 70990800
         AIF   ('&XACCESS' NE 'PRIMARY').ZI16A                          70991400
&ZW                   SETC  '&ZW.1'                                     70992000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              70992600
                      AGO   .ZI16C                                      70993200
.*                                                                      70993800
.ZI16A                ANOP  ,                                           70994400
&ZW                   SETC  '&ZW.0'                                     70995000
.ZI16C                ANOP  ,                                           70995600
.*-------------------------------------------------------------------   70996200
.***AI.LVER02                                                           70996800
.ZI16Z                ANOP  ,                                           70997400
.*-------------------------------------------------------------------   70998000
.***AI.LVER01                                                           70998600
                      AIF  (&XPLISTVER LT 1).ZI17Z                      70999200
.*-------------------------------------------------------------------   70999800
.***AI.L08 XTYPE_OPTIONS "HOME"                                         71000400
.***      BL1'XXXX1XXX'                                                 71001000
         AIF   ('&XACCESS' NE 'HOME').ZI17A                             71001600
&ZW                   SETC  '&ZW.1000'                                  71002200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              71002800
                      AGO   .ZI17C                                      71003400
.*                                                                      71004000
.ZI17A                ANOP  ,                                           71004600
&ZW                   SETC  '&ZW.0000'                                  71005200
.ZI17C                ANOP  ,                                           71005800
.*-------------------------------------------------------------------   71006400
.***AI.L11 XTYPE_OPTIONS BL1                                            71007000
                      AIF   ('&ZCLNG' NE 'YES').ZI17E  ALL ZERO BITS    71007600
&ZOPN                 SETA  &ZOPN+1                                     71008200
&ZOPL(&ZOPN)          SETC  ' '                                         71008800
&ZOPO(&ZOPN)          SETC  'OI'                                        71009400
&ZOPV(&ZOPN)          SETC  '52(1),B''&ZW'''                            71010000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              71010600
.ZI17E                ANOP  ,                                           71011200
.*-------------------------------------------------------------------   71011800
.***AI.LVER02                                                           71012400
.ZI17Z                ANOP  ,                                           71013000
.*-------------------------------------------------------------------   71013600
.***AI.LVER01                                                           71014200
                      AIF  (&XPLISTVER LT 1).ZI18Z                      71014800
.*-------------------------------------------------------------------   71015400
.***AI.LVER02                                                           71016000
.ZI18Z                ANOP  ,                                           71016600
.*-------------------------------------------------------------------   71017200
.***AI.LVER01                                                           71017800
                      AIF  (&XPLISTVER LT 1).ZI19Z                      71018400
.*-------------------------------------------------------------------   71019000
.***AI.L25  XMONTKN XL4                                                 71019600
                      AIF   ('&ZXMONTKN' EQ '').ZI19E                   71020200
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI19E             71020800
&ZCGPR                SETC  '&XMONTKN'                                  71021400
.*                                                                      71022000
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI19B              71022600
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      71023200
                      AGO   .ZI19D                                      71023800
.ZI19B                ANOP  ,                                           71024400
.*                                                                      71025000
&ZC                   SETC  '&XMONTKN'(1,1)                             71025600
                      AIF   (T'&ZC NE 'N').ZI19D                        71026200
&ZC                   SETC  '&XMONTKN'                                  71026800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               71027400
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          71028000
.*                                                                      71028600
.ZI19D                ANOP  ,                                           71029200
.*                                                                      71029800
&ZOPN                 SETA  &ZOPN+1                                     71030400
&ZOPL(&ZOPN)          SETC  ' '                                         71031000
&ZOPO(&ZOPN)          SETC  'MVC'                                       71031600
&ZOPV(&ZOPN)          SETC  '56(4,1),&ZCGPR'                            71032200
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      71032800
.*                                                                      71033400
.ZI19E                ANOP  ,                                           71034000
.*-------------------------------------------------------------------   71034600
.***AI.LVER02                                                           71035200
.ZI19Z                ANOP  ,                                           71035800
.*-------------------------------------------------------------------   71050000
&ZOPN1                SETA &ZOPN                                        71100000
.*******************************************************************    71150000
.***  PROCESS IWMECREA OUTPUT PARAMETERS                                71200000
.*******************************************************************    71250000
                      ACTR  10000                                       71300000
.*------------------------------------------------------------------    71350000
.***AO.L02 XETOKEN CL8                                                  71400000
         AIF   ('&ZXETOKEN' EQ 'OUTPUT').ZO10A  OUTPUT                  71450000
         AIF   ('&ZXETOKEN' NE 'INOUT').ZO10C  INOUT                    71500000
.ZO10A    AIF   ('&XETOKEN'(1,1) NE '(').ZO10B  ADDR IN GPR             71550000
&ZCGPR   SETC  '&XETOKEN'(2,K'&XETOKEN-2)                               71600000
&ZOPN                 SETA  &ZOPN+1                                     71650000
&ZOPL(&ZOPN)          SETC  ' '                                         71700000
&ZOPO(&ZOPN)          SETC  'MVC'                                       71750000
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),40(1)'                         71800000
&ZOPD(&ZOPN)          SETC  '++ XETOKEN CL8'                            71850000
                      AGO   .ZO10C                                      71900000
.*                                                                      71950000
.ZO10B                ANOP  ,                                           72000000
&ZAWRK   SETA  K'&XETOKEN                                               72050000
         AIF   ('&XETOKEN'(&ZAWRK,1) NE ')').ZO10G                      72100000
&ZN      SETA  2                                                        72150000
.ZO10H    ANOP                                                          72200000
         AIF   (&ZN GE &ZAWRK).ZO10G                                    72250000
         AIF   ('&XETOKEN'(&ZN,1) NE '(').ZO10I                         72300000
&ZC      SETC  '&XETOKEN'(1,&ZN).'8'.','                                72350000
&ZC      SETC  '&ZC'.'&XETOKEN'(&ZN+1,&ZAWRK-&ZN).',40(1)'              72400000
         AGO   .ZO10J                                                   72450000
.ZO10I    ANOP                                                          72500000
&ZN      SETA  &ZN+1                                                    72550000
         AGO   .ZO10H                                                   72600000
.ZO10G    ANOP                                                          72650000
&ZC      SETC  '&XETOKEN.(8),40(1)'                                     72700000
.ZO10J    ANOP                                                          72750000
&ZOPN                 SETA  &ZOPN+1                                     72800000
&ZOPL(&ZOPN)          SETC  ' '                                         72850000
&ZOPO(&ZOPN)          SETC  'MVC'                                       72900000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       72950000
&ZOPD(&ZOPN)          SETC  '++ XETOKEN CL8'                            73000000
.ZO10C                ANOP  ,                                           73050000
.*******************************************************************    73100000
.***AO.X02  RETURN CODE PROCESSING                                      73150000
.*******************************************************************    73200000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    73250000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            73300000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             73350000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             73400000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               73450000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                73500000
&ZOPN                 SETA  &ZOPN+1                                     73550000
&ZOPL(&ZOPN)          SETC  ' '                                         73600000
&ZOPO(&ZOPN)          SETC  'ST'                                        73650000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              73700000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        73750000
                      AGO   .ZMRETX                                     73800000
.*                                                                      73850000
.ZMRET2               ANOP  ,                                           73900000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                73950000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                74000000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                74050000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  74100000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   74150000
&ZOPN                 SETA  &ZOPN+1                                     74200000
&ZOPL(&ZOPN)          SETC  ' '                                         74250000
&ZOPO(&ZOPN)          SETC  'LR'                                        74300000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 74350000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        74400000
.ZMRETX               ANOP  ,                                           74450000
.*******************************************************************    74500000
.***AO.X03  REASON CODE PROCESSING                                      74550000
.*******************************************************************    74600000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    74650000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            74700000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              74750000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             74800000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              74850000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             74900000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                74950000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 75000000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                75050000
&ZOPN                 SETA  &ZOPN+1                                     75100000
&ZOPL(&ZOPN)          SETC  ' '                                         75150000
&ZOPO(&ZOPN)          SETC  'ST'                                        75200000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               75250000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        75300000
                      AGO   .ZMRSNX                                     75350000
.*                                                                      75400000
.ZMRSN2               ANOP  ,                                           75450000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                75500000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 75550000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                75600000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 75650000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                75700000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   75750000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    75800000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   75850000
&ZOPN                 SETA  &ZOPN+1                                     75900000
&ZOPL(&ZOPN)          SETC  ' '                                         75950000
&ZOPO(&ZOPN)          SETC  'LR'                                        76000000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  76050000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        76100000
.ZMRSNX               ANOP  ,                                           76150000
.*******************************************************************    76200000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   76250000
.*******************************************************************    76300000
.ZMFLX                ANOP  ,              MF=L PROCESSING              76350000
.*******************************************************************    76400000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               76450000
.*******************************************************************    76500000
                      ACTR  10000                                       76550000
.*                                                                      76600000
                      LCLA  &ZLC           COLUMN POSITION              76650000
                      LCLA  &ZOPX          LIST TABLE INDEX             76700000
                      LCLC  &ZLL           LABEL                        76750000
                      LCLC  &ZLOP          OPERATION                    76800000
                      LCLC  &ZLV           VALUE                        76850000
                      LCLC  &ZLD           DESCRIPTION                  76900000
.*                                                                      76950000
&ZOPX                 SETA  1                                           77000000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            77050000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              77100000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              77150000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              77200000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              77250000
                      AIF   (K'&ZLD LE 0).ZL5                           77300000
&ZLC                  SETA  35             COMMENT COLUMN               77350000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    77400000
&ZLC                  SETA  33             COMMMENT COLUMN              77450000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   77500000
&ZLV                  SETC  '&ZLV'.' '                                  77550000
                      AGO   .ZL3                                        77600000
.*                                                                      77650000
.ZL4                  ANOP  ,                                           77700000
&ZLV                  SETC  '&ZLV'.' '                                  77750000
.ZL5                  ANOP  ,                                           77800000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               77850000
.*                                                                      77900000
&ZLL     &ZLOP &ZLV                                                     77950000
.*                                                                      78000000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               78050000
                      AGO   .ZL2           CONTINUE LOOPING             78100000
.*                                                                      78150000
.ZLX                  ANOP  ,                                           78200000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                78250000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  78300000
         L     14,16(0,0)              GET CVT ADDRESS                  78350000
.***CHECK FOR VERSION 0 @L1A                                            78353300
                      AIF  (&XPLISTVER EQ 0).VEROK                      78356600
.*-------------------------------------------------------------------   78359900
         TM    CVTOSLV1-CVT(14),X'04'  TEST FOR HBB6603 PRESENCE        78363200
         BNZ   VEROK&SYSNDX            BRANCH IF HBB6603 PRESENCE       78366500
         TM    52(1),X'80'             TEST FOR TYPE INDEPENDENT        78369800
         BNZ   VEROK&SYSNDX            BRANCH IF TYPE INDEPENDENT       78373100
         LA    0,IWMRSNCODEBADVERSION  SET REASON CODE = NO CONNECT     78376400
         LA    15,IWMRETCODEINVOCERROR SET WARNING RETURN CODE          78379700
         B     END&SYSNDX              BRANCH TO END LABEL              78383000
VEROK&SYSNDX DS    0H                  BRANCH LABEL FOR VERSION OK      78386300
.*-------------------------------------------------------------------   78389600
.VEROK                ANOP  ,                                           78392900
.*-------------------------------------------------------------------   78396200
         L     14,772(14,0)            GET SFT ADDRESS                  78400000
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       78450000
         LA    15,24                   GET EX FOR SERVICE ROUTINE       78500000
         OR    14,15                   GET PC NUMBER                    78550000
         PC    0(14)                                                    78600000
END&SYSNDX DS    0H                    END LABEL                        78700000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  78750000
.ZLINKX               ANOP  ,                                           78800000
.*******************************************************************    78850000
.***AP.X01  FORMAT GENERATED CODE                                       78900000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            78950000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              79000000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              79050000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              79100000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              79150000
                      AIF   (K'&ZLD LE 0).ZL51                          79200000
&ZLC                  SETA  35             COMMENT COLUMN               79250000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   79300000
&ZLC                  SETA  33             COMMENT COLUMN               79350000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  79400000
&ZLV                  SETC  '&ZLV'.' '                                  79450000
                      AGO   .ZL31                                       79500000
.*                                                                      79550000
.ZL41                 ANOP  ,                                           79600000
&ZLV                  SETC  '&ZLV'.' '                                  79650000
.ZL51                 ANOP  ,                                           79700000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               79750000
.*                                                                      79800000
&ZLL     &ZLOP &ZLV                                                     79850000
.*                                                                      79900000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               79950000
                      AGO   .ZL21          CONTINUE LOOPING             80000000
.*                                                                      80050000
.ZLX1                 ANOP  ,                                           80100000
.*******************************************************************    80150000
.***AP.X02  END OF IWMECREA MACRO                                       80200000
&ZIWMECREA            SETC  'YES'          SET IWMECREA USED            80250000
         POP   PRINT                                                    80300000
*                                            IWMECREA-1                 80350000
         SPACE 1                                                        80400000
.ZLX2                 ANOP  ,                                           80450000
         MEND                                                           80500000
**********************************************************************/ 80550000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  80600000
*%IWMECREA: MACRO KEYS(TYPE,CLSFY,ARRIVALTIME,FUNCTION_NAME,MONTKN,     80650000
*                 ACCESS,ETOKEN,RETCODE,RSNCODE,PLISTVER,MF);           80700000
*  ANS('?'||MACLABEL||' '||'IWMECREP '||MACLIST||                       80750000
*         ' '||MACKEYS||';') COL(MACLMAR);                              80800000
*%END IWMECREA;                                                         80850000
